<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6179149">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6179205">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6179259">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6179310">package</span>&nbsp;<span class="ident" id="6179318">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6179325">import</span>&nbsp;<span class="op" id="6179332">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179335">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179344">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179354">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179361">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179371">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179381">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179394">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179406">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179412">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179425">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179432">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179438">pathpkg</span>&nbsp;<span class="string" id="6179446">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179454">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179471">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179482">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179490">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179501">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179512">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6179523">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6179538">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6179541">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="6179600">type</span>&nbsp;<span class="ident" id="6179605">Context</span>&nbsp;<span class="keyword" id="6179613">struct</span>&nbsp;<span class="op" id="6179620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179623">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6179635">string</span>&nbsp;<span class="comment" id="6179642">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179666">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6179678">string</span>&nbsp;<span class="comment" id="6179685">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179713">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6179725">string</span>&nbsp;<span class="comment" id="6179732">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179744">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6179756">string</span>&nbsp;<span class="comment" id="6179763">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179775">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="6179787">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6179794">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179822">UseAllFiles</span>&nbsp;<span class="builtintype" id="6179834">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6179841">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179894">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6179906">string</span>&nbsp;<span class="comment" id="6179913">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6179965">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180022">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180092">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180158">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180234">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180320">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180388">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180450">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6180462">[</span><span class="op" id="6180463">]</span><span class="builtintype" id="6180464">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180472">ReleaseTags</span>&nbsp;<span class="op" id="6180484">[</span><span class="op" id="6180485">]</span><span class="builtintype" id="6180486">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180495">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180576">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180651">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180728">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180804">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180878">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180933">InstallSuffix</span>&nbsp;<span class="builtintype" id="6180947">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180956">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181025">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181089">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181157">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181228">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181284">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181354">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181405">JoinPath</span>&nbsp;<span class="keyword" id="6181414">func</span><span class="op" id="6181418">(</span><span class="ident" id="6181419">elem</span>&nbsp;<span class="op" id="6181424">...</span><span class="builtintype" id="6181427">string</span><span class="op" id="6181433">)</span>&nbsp;<span class="builtintype" id="6181435">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181444">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181517">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181578">SplitPathList</span>&nbsp;<span class="keyword" id="6181592">func</span><span class="op" id="6181596">(</span><span class="ident" id="6181597">list</span>&nbsp;<span class="builtintype" id="6181602">string</span><span class="op" id="6181608">)</span>&nbsp;<span class="op" id="6181610">[</span><span class="op" id="6181611">]</span><span class="builtintype" id="6181612">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181621">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181677">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181730">IsAbsPath</span>&nbsp;<span class="keyword" id="6181740">func</span><span class="op" id="6181744">(</span><span class="ident" id="6181745">path</span>&nbsp;<span class="builtintype" id="6181750">string</span><span class="op" id="6181756">)</span>&nbsp;<span class="builtintype" id="6181758">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181765">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181819">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181897">IsDir</span>&nbsp;<span class="keyword" id="6181903">func</span><span class="op" id="6181907">(</span><span class="ident" id="6181908">path</span>&nbsp;<span class="builtintype" id="6181913">string</span><span class="op" id="6181919">)</span>&nbsp;<span class="builtintype" id="6181921">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181928">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6181983">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182025">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182086">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182149">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182213">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182240">HasSubdir</span>&nbsp;<span class="keyword" id="6182250">func</span><span class="op" id="6182254">(</span><span class="ident" id="6182255">root</span><span class="op" id="6182259">,</span>&nbsp;<span class="ident" id="6182261">dir</span>&nbsp;<span class="builtintype" id="6182265">string</span><span class="op" id="6182271">)</span>&nbsp;<span class="op" id="6182273">(</span><span class="ident" id="6182274">rel</span>&nbsp;<span class="builtintype" id="6182278">string</span><span class="op" id="6182284">,</span>&nbsp;<span class="ident" id="6182286">ok</span>&nbsp;<span class="builtintype" id="6182289">bool</span><span class="op" id="6182293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182297">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182357">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182408">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182459">ReadDir</span>&nbsp;<span class="keyword" id="6182467">func</span><span class="op" id="6182471">(</span><span class="ident" id="6182472">dir</span>&nbsp;<span class="builtintype" id="6182476">string</span><span class="op" id="6182482">)</span>&nbsp;<span class="op" id="6182484">(</span><span class="ident" id="6182485">fi</span>&nbsp;<span class="op" id="6182488">[</span><span class="op" id="6182489">]</span><span class="ident" id="6182490">os</span><span class="op" id="6182492">.</span><span class="ident" id="6182493">FileInfo</span><span class="op" id="6182501">,</span>&nbsp;<span class="ident" id="6182503">err</span>&nbsp;<span class="builtintype" id="6182507">error</span><span class="op" id="6182512">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182516">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182573">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182618">OpenFile</span>&nbsp;<span class="keyword" id="6182627">func</span><span class="op" id="6182631">(</span><span class="ident" id="6182632">path</span>&nbsp;<span class="builtintype" id="6182637">string</span><span class="op" id="6182643">)</span>&nbsp;<span class="op" id="6182645">(</span><span class="ident" id="6182646">r</span>&nbsp;<span class="ident" id="6182648">io</span><span class="op" id="6182650">.</span><span class="ident" id="6182651">ReadCloser</span><span class="op" id="6182661">,</span>&nbsp;<span class="ident" id="6182663">err</span>&nbsp;<span class="builtintype" id="6182667">error</span><span class="op" id="6182672">)</span><br>
<span class="lineno">95</span><span class="op" id="6182674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6182677">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="6182745">func</span>&nbsp;<span class="op" id="6182750">(</span><span class="ident" id="6182751">ctxt</span>&nbsp;<span class="op" id="6182756">*</span><span class="ident" id="6182757">Context</span><span class="op" id="6182764">)</span>&nbsp;<span class="ident" id="6182766">joinPath</span><span class="op" id="6182774">(</span><span class="ident" id="6182775">elem</span>&nbsp;<span class="op" id="6182780">...</span><span class="builtintype" id="6182783">string</span><span class="op" id="6182789">)</span>&nbsp;<span class="builtintype" id="6182791">string</span>&nbsp;<span class="op" id="6182798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182801">if</span>&nbsp;<span class="ident" id="6182804">f</span>&nbsp;<span class="op" id="6182806">:=</span>&nbsp;<span class="ident" id="6182809">ctxt</span><span class="op" id="6182813">.</span><span class="ident" id="6182814">JoinPath</span><span class="op" id="6182822">;</span>&nbsp;<span class="ident" id="6182824">f</span>&nbsp;<span class="op" id="6182826">!=</span>&nbsp;<span class="ident" id="6182829">nil</span>&nbsp;<span class="op" id="6182833">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182837">return</span>&nbsp;<span class="ident" id="6182844">f</span><span class="op" id="6182845">(</span><span class="ident" id="6182846">elem</span><span class="op" id="6182850">...</span><span class="op" id="6182853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182859">return</span>&nbsp;<span class="ident" id="6182866">filepath</span><span class="op" id="6182874">.</span><span class="ident" id="6182875">Join</span><span class="op" id="6182879">(</span><span class="ident" id="6182880">elem</span><span class="op" id="6182884">...</span><span class="op" id="6182887">)</span><br>
<span class="lineno"></span><span class="op" id="6182889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6182892">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="6182975">func</span>&nbsp;<span class="op" id="6182980">(</span><span class="ident" id="6182981">ctxt</span>&nbsp;<span class="op" id="6182986">*</span><span class="ident" id="6182987">Context</span><span class="op" id="6182994">)</span>&nbsp;<span class="ident" id="6182996">splitPathList</span><span class="op" id="6183009">(</span><span class="ident" id="6183010">s</span>&nbsp;<span class="builtintype" id="6183012">string</span><span class="op" id="6183018">)</span>&nbsp;<span class="op" id="6183020">[</span><span class="op" id="6183021">]</span><span class="builtintype" id="6183022">string</span>&nbsp;<span class="op" id="6183029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183032">if</span>&nbsp;<span class="ident" id="6183035">f</span>&nbsp;<span class="op" id="6183037">:=</span>&nbsp;<span class="ident" id="6183040">ctxt</span><span class="op" id="6183044">.</span><span class="ident" id="6183045">SplitPathList</span><span class="op" id="6183058">;</span>&nbsp;<span class="ident" id="6183060">f</span>&nbsp;<span class="op" id="6183062">!=</span>&nbsp;<span class="ident" id="6183065">nil</span>&nbsp;<span class="op" id="6183069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183073">return</span>&nbsp;<span class="ident" id="6183080">f</span><span class="op" id="6183081">(</span><span class="ident" id="6183082">s</span><span class="op" id="6183083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183086">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183089">return</span>&nbsp;<span class="ident" id="6183096">filepath</span><span class="op" id="6183104">.</span><span class="ident" id="6183105">SplitList</span><span class="op" id="6183114">(</span><span class="ident" id="6183115">s</span><span class="op" id="6183116">)</span><br>
<span class="lineno"></span><span class="op" id="6183118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6183121">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="6183193">func</span>&nbsp;<span class="op" id="6183198">(</span><span class="ident" id="6183199">ctxt</span>&nbsp;<span class="op" id="6183204">*</span><span class="ident" id="6183205">Context</span><span class="op" id="6183212">)</span>&nbsp;<span class="ident" id="6183214">isAbsPath</span><span class="op" id="6183223">(</span><span class="ident" id="6183224">path</span>&nbsp;<span class="builtintype" id="6183229">string</span><span class="op" id="6183235">)</span>&nbsp;<span class="builtintype" id="6183237">bool</span>&nbsp;<span class="op" id="6183242">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183245">if</span>&nbsp;<span class="ident" id="6183248">f</span>&nbsp;<span class="op" id="6183250">:=</span>&nbsp;<span class="ident" id="6183253">ctxt</span><span class="op" id="6183257">.</span><span class="ident" id="6183258">IsAbsPath</span><span class="op" id="6183267">;</span>&nbsp;<span class="ident" id="6183269">f</span>&nbsp;<span class="op" id="6183271">!=</span>&nbsp;<span class="ident" id="6183274">nil</span>&nbsp;<span class="op" id="6183278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183282">return</span>&nbsp;<span class="ident" id="6183289">f</span><span class="op" id="6183290">(</span><span class="ident" id="6183291">path</span><span class="op" id="6183295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183301">return</span>&nbsp;<span class="ident" id="6183308">filepath</span><span class="op" id="6183316">.</span><span class="ident" id="6183317">IsAbs</span><span class="op" id="6183322">(</span><span class="ident" id="6183323">path</span><span class="op" id="6183327">)</span><br>
<span class="lineno"></span><span class="op" id="6183329">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="6183332">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="6183393">func</span>&nbsp;<span class="op" id="6183398">(</span><span class="ident" id="6183399">ctxt</span>&nbsp;<span class="op" id="6183404">*</span><span class="ident" id="6183405">Context</span><span class="op" id="6183412">)</span>&nbsp;<span class="ident" id="6183414">isDir</span><span class="op" id="6183419">(</span><span class="ident" id="6183420">path</span>&nbsp;<span class="builtintype" id="6183425">string</span><span class="op" id="6183431">)</span>&nbsp;<span class="builtintype" id="6183433">bool</span>&nbsp;<span class="op" id="6183438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183441">if</span>&nbsp;<span class="ident" id="6183444">f</span>&nbsp;<span class="op" id="6183446">:=</span>&nbsp;<span class="ident" id="6183449">ctxt</span><span class="op" id="6183453">.</span><span class="ident" id="6183454">IsDir</span><span class="op" id="6183459">;</span>&nbsp;<span class="ident" id="6183461">f</span>&nbsp;<span class="op" id="6183463">!=</span>&nbsp;<span class="ident" id="6183466">nil</span>&nbsp;<span class="op" id="6183470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183474">return</span>&nbsp;<span class="ident" id="6183481">f</span><span class="op" id="6183482">(</span><span class="ident" id="6183483">path</span><span class="op" id="6183487">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183493">fi</span><span class="op" id="6183495">,</span>&nbsp;<span class="ident" id="6183497">err</span>&nbsp;<span class="op" id="6183501">:=</span>&nbsp;<span class="ident" id="6183504">os</span><span class="op" id="6183506">.</span><span class="ident" id="6183507">Stat</span><span class="op" id="6183511">(</span><span class="ident" id="6183512">path</span><span class="op" id="6183516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183519">return</span>&nbsp;<span class="ident" id="6183526">err</span>&nbsp;<span class="op" id="6183530">==</span>&nbsp;<span class="ident" id="6183533">nil</span>&nbsp;<span class="op" id="6183537">&amp;&amp;</span>&nbsp;<span class="ident" id="6183540">fi</span><span class="op" id="6183542">.</span><span class="ident" id="6183543">IsDir</span><span class="op" id="6183548">(</span><span class="op" id="6183549">)</span><br>
<span class="lineno"></span><span class="op" id="6183551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6183554">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6183614">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="6183663">func</span>&nbsp;<span class="op" id="6183668">(</span><span class="ident" id="6183669">ctxt</span>&nbsp;<span class="op" id="6183674">*</span><span class="ident" id="6183675">Context</span><span class="op" id="6183682">)</span>&nbsp;<span class="ident" id="6183684">hasSubdir</span><span class="op" id="6183693">(</span><span class="ident" id="6183694">root</span><span class="op" id="6183698">,</span>&nbsp;<span class="ident" id="6183700">dir</span>&nbsp;<span class="builtintype" id="6183704">string</span><span class="op" id="6183710">)</span>&nbsp;<span class="op" id="6183712">(</span><span class="ident" id="6183713">rel</span>&nbsp;<span class="builtintype" id="6183717">string</span><span class="op" id="6183723">,</span>&nbsp;<span class="ident" id="6183725">ok</span>&nbsp;<span class="builtintype" id="6183728">bool</span><span class="op" id="6183732">)</span>&nbsp;<span class="op" id="6183734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183737">if</span>&nbsp;<span class="ident" id="6183740">f</span>&nbsp;<span class="op" id="6183742">:=</span>&nbsp;<span class="ident" id="6183745">ctxt</span><span class="op" id="6183749">.</span><span class="ident" id="6183750">HasSubdir</span><span class="op" id="6183759">;</span>&nbsp;<span class="ident" id="6183761">f</span>&nbsp;<span class="op" id="6183763">!=</span>&nbsp;<span class="ident" id="6183766">nil</span>&nbsp;<span class="op" id="6183770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183774">return</span>&nbsp;<span class="ident" id="6183781">f</span><span class="op" id="6183782">(</span><span class="ident" id="6183783">root</span><span class="op" id="6183787">,</span>&nbsp;<span class="ident" id="6183789">dir</span><span class="op" id="6183792">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183799">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183832">if</span>&nbsp;<span class="ident" id="6183835">rel</span><span class="op" id="6183838">,</span>&nbsp;<span class="ident" id="6183840">ok</span>&nbsp;<span class="op" id="6183843">=</span>&nbsp;<span class="ident" id="6183845">hasSubdir</span><span class="op" id="6183854">(</span><span class="ident" id="6183855">root</span><span class="op" id="6183859">,</span>&nbsp;<span class="ident" id="6183861">dir</span><span class="op" id="6183864">)</span><span class="op" id="6183865">;</span>&nbsp;<span class="ident" id="6183867">ok</span>&nbsp;<span class="op" id="6183870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183874">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183886">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183927">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183963">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183994">rootSym</span><span class="op" id="6184001">,</span>&nbsp;<span class="ident" id="6184003">_</span>&nbsp;<span class="op" id="6184005">:=</span>&nbsp;<span class="ident" id="6184008">filepath</span><span class="op" id="6184016">.</span><span class="ident" id="6184017">EvalSymlinks</span><span class="op" id="6184029">(</span><span class="ident" id="6184030">root</span><span class="op" id="6184034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184037">dirSym</span><span class="op" id="6184043">,</span>&nbsp;<span class="ident" id="6184045">_</span>&nbsp;<span class="op" id="6184047">:=</span>&nbsp;<span class="ident" id="6184050">filepath</span><span class="op" id="6184058">.</span><span class="ident" id="6184059">EvalSymlinks</span><span class="op" id="6184071">(</span><span class="ident" id="6184072">dir</span><span class="op" id="6184075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184079">if</span>&nbsp;<span class="ident" id="6184082">rel</span><span class="op" id="6184085">,</span>&nbsp;<span class="ident" id="6184087">ok</span>&nbsp;<span class="op" id="6184090">=</span>&nbsp;<span class="ident" id="6184092">hasSubdir</span><span class="op" id="6184101">(</span><span class="ident" id="6184102">rootSym</span><span class="op" id="6184109">,</span>&nbsp;<span class="ident" id="6184111">dir</span><span class="op" id="6184114">)</span><span class="op" id="6184115">;</span>&nbsp;<span class="ident" id="6184117">ok</span>&nbsp;<span class="op" id="6184120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184124">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184135">if</span>&nbsp;<span class="ident" id="6184138">rel</span><span class="op" id="6184141">,</span>&nbsp;<span class="ident" id="6184143">ok</span>&nbsp;<span class="op" id="6184146">=</span>&nbsp;<span class="ident" id="6184148">hasSubdir</span><span class="op" id="6184157">(</span><span class="ident" id="6184158">root</span><span class="op" id="6184162">,</span>&nbsp;<span class="ident" id="6184164">dirSym</span><span class="op" id="6184170">)</span><span class="op" id="6184171">;</span>&nbsp;<span class="ident" id="6184173">ok</span>&nbsp;<span class="op" id="6184176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184180">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184191">return</span>&nbsp;<span class="ident" id="6184198">hasSubdir</span><span class="op" id="6184207">(</span><span class="ident" id="6184208">rootSym</span><span class="op" id="6184215">,</span>&nbsp;<span class="ident" id="6184217">dirSym</span><span class="op" id="6184223">)</span><br>
<span class="lineno">155</span><span class="op" id="6184225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6184228">func</span>&nbsp;<span class="ident" id="6184233">hasSubdir</span><span class="op" id="6184242">(</span><span class="ident" id="6184243">root</span><span class="op" id="6184247">,</span>&nbsp;<span class="ident" id="6184249">dir</span>&nbsp;<span class="builtintype" id="6184253">string</span><span class="op" id="6184259">)</span>&nbsp;<span class="op" id="6184261">(</span><span class="ident" id="6184262">rel</span>&nbsp;<span class="builtintype" id="6184266">string</span><span class="op" id="6184272">,</span>&nbsp;<span class="ident" id="6184274">ok</span>&nbsp;<span class="builtintype" id="6184277">bool</span><span class="op" id="6184281">)</span>&nbsp;<span class="op" id="6184283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184286">const</span>&nbsp;<span class="ident" id="6184292">sep</span>&nbsp;<span class="op" id="6184296">=</span>&nbsp;<span class="builtintype" id="6184298">string</span><span class="op" id="6184304">(</span><span class="ident" id="6184305">filepath</span><span class="op" id="6184313">.</span><span class="ident" id="6184314">Separator</span><span class="op" id="6184323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184326">root</span>&nbsp;<span class="op" id="6184331">=</span>&nbsp;<span class="ident" id="6184333">filepath</span><span class="op" id="6184341">.</span><span class="ident" id="6184342">Clean</span><span class="op" id="6184347">(</span><span class="ident" id="6184348">root</span><span class="op" id="6184352">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184355">if</span>&nbsp;<span class="op" id="6184358">!</span><span class="ident" id="6184359">strings</span><span class="op" id="6184366">.</span><span class="ident" id="6184367">HasSuffix</span><span class="op" id="6184376">(</span><span class="ident" id="6184377">root</span><span class="op" id="6184381">,</span>&nbsp;<span class="ident" id="6184383">sep</span><span class="op" id="6184386">)</span>&nbsp;<span class="op" id="6184388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184392">root</span>&nbsp;<span class="op" id="6184397">+=</span>&nbsp;<span class="ident" id="6184400">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184408">dir</span>&nbsp;<span class="op" id="6184412">=</span>&nbsp;<span class="ident" id="6184414">filepath</span><span class="op" id="6184422">.</span><span class="ident" id="6184423">Clean</span><span class="op" id="6184428">(</span><span class="ident" id="6184429">dir</span><span class="op" id="6184432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184435">if</span>&nbsp;<span class="op" id="6184438">!</span><span class="ident" id="6184439">strings</span><span class="op" id="6184446">.</span><span class="ident" id="6184447">HasPrefix</span><span class="op" id="6184456">(</span><span class="ident" id="6184457">dir</span><span class="op" id="6184460">,</span>&nbsp;<span class="ident" id="6184462">root</span><span class="op" id="6184466">)</span>&nbsp;<span class="op" id="6184468">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184472">return</span>&nbsp;<span class="string" id="6184479">&#34;&#34;</span><span class="op" id="6184481">,</span>&nbsp;<span class="builtintype" id="6184483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184493">return</span>&nbsp;<span class="ident" id="6184500">filepath</span><span class="op" id="6184508">.</span><span class="ident" id="6184509">ToSlash</span><span class="op" id="6184516">(</span><span class="ident" id="6184517">dir</span><span class="op" id="6184520">[</span><span class="builtinfunc" id="6184521">len</span><span class="op" id="6184524">(</span><span class="ident" id="6184525">root</span><span class="op" id="6184529">)</span><span class="op" id="6184530">:</span><span class="op" id="6184531">]</span><span class="op" id="6184532">)</span><span class="op" id="6184533">,</span>&nbsp;<span class="builtintype" id="6184535">true</span><br>
<span class="lineno"></span><span class="op" id="6184540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="6184543">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6184610">func</span>&nbsp;<span class="op" id="6184615">(</span><span class="ident" id="6184616">ctxt</span>&nbsp;<span class="op" id="6184621">*</span><span class="ident" id="6184622">Context</span><span class="op" id="6184629">)</span>&nbsp;<span class="ident" id="6184631">readDir</span><span class="op" id="6184638">(</span><span class="ident" id="6184639">path</span>&nbsp;<span class="builtintype" id="6184644">string</span><span class="op" id="6184650">)</span>&nbsp;<span class="op" id="6184652">(</span><span class="op" id="6184653">[</span><span class="op" id="6184654">]</span><span class="ident" id="6184655">os</span><span class="op" id="6184657">.</span><span class="ident" id="6184658">FileInfo</span><span class="op" id="6184666">,</span>&nbsp;<span class="builtintype" id="6184668">error</span><span class="op" id="6184673">)</span>&nbsp;<span class="op" id="6184675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184678">if</span>&nbsp;<span class="ident" id="6184681">f</span>&nbsp;<span class="op" id="6184683">:=</span>&nbsp;<span class="ident" id="6184686">ctxt</span><span class="op" id="6184690">.</span><span class="ident" id="6184691">ReadDir</span><span class="op" id="6184698">;</span>&nbsp;<span class="ident" id="6184700">f</span>&nbsp;<span class="op" id="6184702">!=</span>&nbsp;<span class="ident" id="6184705">nil</span>&nbsp;<span class="op" id="6184709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184713">return</span>&nbsp;<span class="ident" id="6184720">f</span><span class="op" id="6184721">(</span><span class="ident" id="6184722">path</span><span class="op" id="6184726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184729">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184732">return</span>&nbsp;<span class="ident" id="6184739">ioutil</span><span class="op" id="6184745">.</span><span class="ident" id="6184746">ReadDir</span><span class="op" id="6184753">(</span><span class="ident" id="6184754">path</span><span class="op" id="6184758">)</span><br>
<span class="lineno"></span><span class="op" id="6184760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6184763">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="6184825">func</span>&nbsp;<span class="op" id="6184830">(</span><span class="ident" id="6184831">ctxt</span>&nbsp;<span class="op" id="6184836">*</span><span class="ident" id="6184837">Context</span><span class="op" id="6184844">)</span>&nbsp;<span class="ident" id="6184846">openFile</span><span class="op" id="6184854">(</span><span class="ident" id="6184855">path</span>&nbsp;<span class="builtintype" id="6184860">string</span><span class="op" id="6184866">)</span>&nbsp;<span class="op" id="6184868">(</span><span class="ident" id="6184869">io</span><span class="op" id="6184871">.</span><span class="ident" id="6184872">ReadCloser</span><span class="op" id="6184882">,</span>&nbsp;<span class="builtintype" id="6184884">error</span><span class="op" id="6184889">)</span>&nbsp;<span class="op" id="6184891">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184894">if</span>&nbsp;<span class="ident" id="6184897">fn</span>&nbsp;<span class="op" id="6184900">:=</span>&nbsp;<span class="ident" id="6184903">ctxt</span><span class="op" id="6184907">.</span><span class="ident" id="6184908">OpenFile</span><span class="op" id="6184916">;</span>&nbsp;<span class="ident" id="6184918">fn</span>&nbsp;<span class="op" id="6184921">!=</span>&nbsp;<span class="ident" id="6184924">nil</span>&nbsp;<span class="op" id="6184928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184932">return</span>&nbsp;<span class="ident" id="6184939">fn</span><span class="op" id="6184941">(</span><span class="ident" id="6184942">path</span><span class="op" id="6184946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184953">f</span><span class="op" id="6184954">,</span>&nbsp;<span class="ident" id="6184956">err</span>&nbsp;<span class="op" id="6184960">:=</span>&nbsp;<span class="ident" id="6184963">os</span><span class="op" id="6184965">.</span><span class="ident" id="6184966">Open</span><span class="op" id="6184970">(</span><span class="ident" id="6184971">path</span><span class="op" id="6184975">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184978">if</span>&nbsp;<span class="ident" id="6184981">err</span>&nbsp;<span class="op" id="6184985">!=</span>&nbsp;<span class="ident" id="6184988">nil</span>&nbsp;<span class="op" id="6184992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184996">return</span>&nbsp;<span class="ident" id="6185003">nil</span><span class="op" id="6185006">,</span>&nbsp;<span class="ident" id="6185008">err</span>&nbsp;<span class="comment" id="6185012">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6185030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185033">return</span>&nbsp;<span class="ident" id="6185040">f</span><span class="op" id="6185041">,</span>&nbsp;<span class="ident" id="6185043">nil</span><br>
<span class="lineno"></span><span class="op" id="6185047">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6185050">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6185116">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6185180">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="6185200">func</span>&nbsp;<span class="op" id="6185205">(</span><span class="ident" id="6185206">ctxt</span>&nbsp;<span class="op" id="6185211">*</span><span class="ident" id="6185212">Context</span><span class="op" id="6185219">)</span>&nbsp;<span class="ident" id="6185221">isFile</span><span class="op" id="6185227">(</span><span class="ident" id="6185228">path</span>&nbsp;<span class="builtintype" id="6185233">string</span><span class="op" id="6185239">)</span>&nbsp;<span class="builtintype" id="6185241">bool</span>&nbsp;<span class="op" id="6185246">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6185249">f</span><span class="op" id="6185250">,</span>&nbsp;<span class="ident" id="6185252">err</span>&nbsp;<span class="op" id="6185256">:=</span>&nbsp;<span class="ident" id="6185259">ctxt</span><span class="op" id="6185263">.</span><span class="ident" id="6185264">openFile</span><span class="op" id="6185272">(</span><span class="ident" id="6185273">path</span><span class="op" id="6185277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185280">if</span>&nbsp;<span class="ident" id="6185283">err</span>&nbsp;<span class="op" id="6185287">!=</span>&nbsp;<span class="ident" id="6185290">nil</span>&nbsp;<span class="op" id="6185294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185298">return</span>&nbsp;<span class="builtintype" id="6185305">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6185312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6185315">f</span><span class="op" id="6185316">.</span><span class="ident" id="6185317">Close</span><span class="op" id="6185322">(</span><span class="op" id="6185323">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185326">return</span>&nbsp;<span class="builtintype" id="6185333">true</span><br>
<span class="lineno"></span><span class="op" id="6185338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6185341">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="6185392">func</span>&nbsp;<span class="op" id="6185397">(</span><span class="ident" id="6185398">ctxt</span>&nbsp;<span class="op" id="6185403">*</span><span class="ident" id="6185404">Context</span><span class="op" id="6185411">)</span>&nbsp;<span class="ident" id="6185413">gopath</span><span class="op" id="6185419">(</span><span class="op" id="6185420">)</span>&nbsp;<span class="op" id="6185422">[</span><span class="op" id="6185423">]</span><span class="builtintype" id="6185424">string</span>&nbsp;<span class="op" id="6185431">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185434">var</span>&nbsp;<span class="ident" id="6185438">all</span>&nbsp;<span class="op" id="6185442">[</span><span class="op" id="6185443">]</span><span class="builtintype" id="6185444">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185452">for</span>&nbsp;<span class="ident" id="6185456">_</span><span class="op" id="6185457">,</span>&nbsp;<span class="ident" id="6185459">p</span>&nbsp;<span class="op" id="6185461">:=</span>&nbsp;<span class="keyword" id="6185464">range</span>&nbsp;<span class="ident" id="6185470">ctxt</span><span class="op" id="6185474">.</span><span class="ident" id="6185475">splitPathList</span><span class="op" id="6185488">(</span><span class="ident" id="6185489">ctxt</span><span class="op" id="6185493">.</span><span class="ident" id="6185494">GOPATH</span><span class="op" id="6185500">)</span>&nbsp;<span class="op" id="6185502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185506">if</span>&nbsp;<span class="ident" id="6185509">p</span>&nbsp;<span class="op" id="6185511">==</span>&nbsp;<span class="string" id="6185514">&#34;&#34;</span>&nbsp;<span class="op" id="6185517">||</span>&nbsp;<span class="ident" id="6185520">p</span>&nbsp;<span class="op" id="6185522">==</span>&nbsp;<span class="ident" id="6185525">ctxt</span><span class="op" id="6185529">.</span><span class="ident" id="6185530">GOROOT</span>&nbsp;<span class="op" id="6185537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185542">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185579">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185623">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185666">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185716">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6185727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185731">if</span>&nbsp;<span class="ident" id="6185734">strings</span><span class="op" id="6185741">.</span><span class="ident" id="6185742">HasPrefix</span><span class="op" id="6185751">(</span><span class="ident" id="6185752">p</span><span class="op" id="6185753">,</span>&nbsp;<span class="string" id="6185755">&#34;~&#34;</span><span class="op" id="6185758">)</span>&nbsp;<span class="op" id="6185760">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185765">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185827">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185891">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185936">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6185996">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186054">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186121">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186184">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186250">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186309">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186329">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186393">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186421">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186436">all</span>&nbsp;<span class="op" id="6186440">=</span>&nbsp;<span class="builtinfunc" id="6186442">append</span><span class="op" id="6186448">(</span><span class="ident" id="6186449">all</span><span class="op" id="6186452">,</span>&nbsp;<span class="ident" id="6186454">p</span><span class="op" id="6186455">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186461">return</span>&nbsp;<span class="ident" id="6186468">all</span><br>
<span class="lineno"></span><span class="op" id="6186472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6186475">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="6186537">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="6186608">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="6186630">func</span>&nbsp;<span class="op" id="6186635">(</span><span class="ident" id="6186636">ctxt</span>&nbsp;<span class="op" id="6186641">*</span><span class="ident" id="6186642">Context</span><span class="op" id="6186649">)</span>&nbsp;<span class="ident" id="6186651">SrcDirs</span><span class="op" id="6186658">(</span><span class="op" id="6186659">)</span>&nbsp;<span class="op" id="6186661">[</span><span class="op" id="6186662">]</span><span class="builtintype" id="6186663">string</span>&nbsp;<span class="op" id="6186670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186673">var</span>&nbsp;<span class="ident" id="6186677">all</span>&nbsp;<span class="op" id="6186681">[</span><span class="op" id="6186682">]</span><span class="builtintype" id="6186683">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186691">if</span>&nbsp;<span class="ident" id="6186694">ctxt</span><span class="op" id="6186698">.</span><span class="ident" id="6186699">GOROOT</span>&nbsp;<span class="op" id="6186706">!=</span>&nbsp;<span class="string" id="6186709">&#34;&#34;</span>&nbsp;<span class="op" id="6186712">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186716">dir</span>&nbsp;<span class="op" id="6186720">:=</span>&nbsp;<span class="ident" id="6186723">ctxt</span><span class="op" id="6186727">.</span><span class="ident" id="6186728">joinPath</span><span class="op" id="6186736">(</span><span class="ident" id="6186737">ctxt</span><span class="op" id="6186741">.</span><span class="ident" id="6186742">GOROOT</span><span class="op" id="6186748">,</span>&nbsp;<span class="string" id="6186750">&#34;src&#34;</span><span class="op" id="6186755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186759">if</span>&nbsp;<span class="ident" id="6186762">ctxt</span><span class="op" id="6186766">.</span><span class="ident" id="6186767">isDir</span><span class="op" id="6186772">(</span><span class="ident" id="6186773">dir</span><span class="op" id="6186776">)</span>&nbsp;<span class="op" id="6186778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186783">all</span>&nbsp;<span class="op" id="6186787">=</span>&nbsp;<span class="builtinfunc" id="6186789">append</span><span class="op" id="6186795">(</span><span class="ident" id="6186796">all</span><span class="op" id="6186799">,</span>&nbsp;<span class="ident" id="6186801">dir</span><span class="op" id="6186804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186811">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186814">for</span>&nbsp;<span class="ident" id="6186818">_</span><span class="op" id="6186819">,</span>&nbsp;<span class="ident" id="6186821">p</span>&nbsp;<span class="op" id="6186823">:=</span>&nbsp;<span class="keyword" id="6186826">range</span>&nbsp;<span class="ident" id="6186832">ctxt</span><span class="op" id="6186836">.</span><span class="ident" id="6186837">gopath</span><span class="op" id="6186843">(</span><span class="op" id="6186844">)</span>&nbsp;<span class="op" id="6186846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186850">dir</span>&nbsp;<span class="op" id="6186854">:=</span>&nbsp;<span class="ident" id="6186857">ctxt</span><span class="op" id="6186861">.</span><span class="ident" id="6186862">joinPath</span><span class="op" id="6186870">(</span><span class="ident" id="6186871">p</span><span class="op" id="6186872">,</span>&nbsp;<span class="string" id="6186874">&#34;src&#34;</span><span class="op" id="6186879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186883">if</span>&nbsp;<span class="ident" id="6186886">ctxt</span><span class="op" id="6186890">.</span><span class="ident" id="6186891">isDir</span><span class="op" id="6186896">(</span><span class="ident" id="6186897">dir</span><span class="op" id="6186900">)</span>&nbsp;<span class="op" id="6186902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186907">all</span>&nbsp;<span class="op" id="6186911">=</span>&nbsp;<span class="builtinfunc" id="6186913">append</span><span class="op" id="6186919">(</span><span class="ident" id="6186920">all</span><span class="op" id="6186923">,</span>&nbsp;<span class="ident" id="6186925">dir</span><span class="op" id="6186928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186932">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186938">return</span>&nbsp;<span class="ident" id="6186945">all</span><br>
<span class="lineno"></span><span class="op" id="6186949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6186952">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="6186998">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="6187068">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="6187133">var</span>&nbsp;<span class="ident" id="6187137">Default</span>&nbsp;<span class="ident" id="6187145">Context</span>&nbsp;<span class="op" id="6187153">=</span>&nbsp;<span class="ident" id="6187155">defaultContext</span><span class="op" id="6187169">(</span><span class="op" id="6187170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187173">var</span>&nbsp;<span class="ident" id="6187177">cgoEnabled</span>&nbsp;<span class="op" id="6187188">=</span>&nbsp;<span class="keyword" id="6187190">map</span><span class="op" id="6187193">[</span><span class="builtintype" id="6187194">string</span><span class="op" id="6187200">]</span><span class="builtintype" id="6187201">bool</span><span class="op" id="6187205">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187208">&#34;darwin/386&#34;</span><span class="op" id="6187220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187227">true</span><span class="op" id="6187231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187234">&#34;darwin/amd64&#34;</span><span class="op" id="6187248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187253">true</span><span class="op" id="6187257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187260">&#34;dragonfly/386&#34;</span><span class="op" id="6187275">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187279">true</span><span class="op" id="6187283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187286">&#34;dragonfly/amd64&#34;</span><span class="op" id="6187303">:</span>&nbsp;<span class="builtintype" id="6187305">true</span><span class="op" id="6187309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187312">&#34;freebsd/386&#34;</span><span class="op" id="6187325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187331">true</span><span class="op" id="6187335">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187338">&#34;freebsd/amd64&#34;</span><span class="op" id="6187353">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187357">true</span><span class="op" id="6187361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187364">&#34;freebsd/arm&#34;</span><span class="op" id="6187377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187383">true</span><span class="op" id="6187387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187390">&#34;linux/386&#34;</span><span class="op" id="6187401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187409">true</span><span class="op" id="6187413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187416">&#34;linux/amd64&#34;</span><span class="op" id="6187429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187435">true</span><span class="op" id="6187439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187442">&#34;linux/arm&#34;</span><span class="op" id="6187453">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187461">true</span><span class="op" id="6187465">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187468">&#34;android/386&#34;</span><span class="op" id="6187481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187487">true</span><span class="op" id="6187491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187494">&#34;android/amd64&#34;</span><span class="op" id="6187509">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187513">true</span><span class="op" id="6187517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187520">&#34;android/arm&#34;</span><span class="op" id="6187533">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187539">true</span><span class="op" id="6187543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187546">&#34;netbsd/386&#34;</span><span class="op" id="6187558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187565">true</span><span class="op" id="6187569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187572">&#34;netbsd/amd64&#34;</span><span class="op" id="6187586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187591">true</span><span class="op" id="6187595">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187598">&#34;netbsd/arm&#34;</span><span class="op" id="6187610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187617">true</span><span class="op" id="6187621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187624">&#34;openbsd/386&#34;</span><span class="op" id="6187637">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187643">true</span><span class="op" id="6187647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187650">&#34;openbsd/amd64&#34;</span><span class="op" id="6187665">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187669">true</span><span class="op" id="6187673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187676">&#34;windows/386&#34;</span><span class="op" id="6187689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187695">true</span><span class="op" id="6187699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187702">&#34;windows/amd64&#34;</span><span class="op" id="6187717">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6187721">true</span><span class="op" id="6187725">,</span><br>
<span class="lineno">280</span><span class="op" id="6187727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187730">func</span>&nbsp;<span class="ident" id="6187735">defaultContext</span><span class="op" id="6187749">(</span><span class="op" id="6187750">)</span>&nbsp;<span class="ident" id="6187752">Context</span>&nbsp;<span class="op" id="6187760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6187763">var</span>&nbsp;<span class="ident" id="6187767">c</span>&nbsp;<span class="ident" id="6187769">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187779">c</span><span class="op" id="6187780">.</span><span class="ident" id="6187781">GOARCH</span>&nbsp;<span class="op" id="6187788">=</span>&nbsp;<span class="ident" id="6187790">envOr</span><span class="op" id="6187795">(</span><span class="string" id="6187796">&#34;GOARCH&#34;</span><span class="op" id="6187804">,</span>&nbsp;<span class="ident" id="6187806">runtime</span><span class="op" id="6187813">.</span><span class="ident" id="6187814">GOARCH</span><span class="op" id="6187820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187823">c</span><span class="op" id="6187824">.</span><span class="ident" id="6187825">GOOS</span>&nbsp;<span class="op" id="6187830">=</span>&nbsp;<span class="ident" id="6187832">envOr</span><span class="op" id="6187837">(</span><span class="string" id="6187838">&#34;GOOS&#34;</span><span class="op" id="6187844">,</span>&nbsp;<span class="ident" id="6187846">runtime</span><span class="op" id="6187853">.</span><span class="ident" id="6187854">GOOS</span><span class="op" id="6187858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187861">c</span><span class="op" id="6187862">.</span><span class="ident" id="6187863">GOROOT</span>&nbsp;<span class="op" id="6187870">=</span>&nbsp;<span class="ident" id="6187872">runtime</span><span class="op" id="6187879">.</span><span class="ident" id="6187880">GOROOT</span><span class="op" id="6187886">(</span><span class="op" id="6187887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187890">c</span><span class="op" id="6187891">.</span><span class="ident" id="6187892">GOPATH</span>&nbsp;<span class="op" id="6187899">=</span>&nbsp;<span class="ident" id="6187901">envOr</span><span class="op" id="6187906">(</span><span class="string" id="6187907">&#34;GOPATH&#34;</span><span class="op" id="6187915">,</span>&nbsp;<span class="string" id="6187917">&#34;&#34;</span><span class="op" id="6187919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187922">c</span><span class="op" id="6187923">.</span><span class="ident" id="6187924">Compiler</span>&nbsp;<span class="op" id="6187933">=</span>&nbsp;<span class="ident" id="6187935">runtime</span><span class="op" id="6187942">.</span><span class="ident" id="6187943">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6187954">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188024">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188094">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188167">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188240">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188317">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188321">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188365">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188439">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188454">c</span><span class="op" id="6188455">.</span><span class="ident" id="6188456">ReleaseTags</span>&nbsp;<span class="op" id="6188468">=</span>&nbsp;<span class="op" id="6188470">[</span><span class="op" id="6188471">]</span><span class="builtintype" id="6188472">string</span><span class="op" id="6188478">{</span><span class="string" id="6188479">&#34;go1.1&#34;</span><span class="op" id="6188486">,</span>&nbsp;<span class="string" id="6188488">&#34;go1.2&#34;</span><span class="op" id="6188495">,</span>&nbsp;<span class="string" id="6188497">&#34;go1.3&#34;</span><span class="op" id="6188504">,</span>&nbsp;<span class="string" id="6188506">&#34;go1.4&#34;</span><span class="op" id="6188513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188517">switch</span>&nbsp;<span class="ident" id="6188524">os</span><span class="op" id="6188526">.</span><span class="ident" id="6188527">Getenv</span><span class="op" id="6188533">(</span><span class="string" id="6188534">&#34;CGO_ENABLED&#34;</span><span class="op" id="6188547">)</span>&nbsp;<span class="op" id="6188549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188552">case</span>&nbsp;<span class="string" id="6188557">&#34;1&#34;</span><span class="op" id="6188560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188564">c</span><span class="op" id="6188565">.</span><span class="ident" id="6188566">CgoEnabled</span>&nbsp;<span class="op" id="6188577">=</span>&nbsp;<span class="builtintype" id="6188579">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188585">case</span>&nbsp;<span class="string" id="6188590">&#34;0&#34;</span><span class="op" id="6188593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188597">c</span><span class="op" id="6188598">.</span><span class="ident" id="6188599">CgoEnabled</span>&nbsp;<span class="op" id="6188610">=</span>&nbsp;<span class="builtintype" id="6188612">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188619">default</span><span class="op" id="6188626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188630">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188695">if</span>&nbsp;<span class="ident" id="6188698">runtime</span><span class="op" id="6188705">.</span><span class="ident" id="6188706">GOARCH</span>&nbsp;<span class="op" id="6188713">==</span>&nbsp;<span class="ident" id="6188716">c</span><span class="op" id="6188717">.</span><span class="ident" id="6188718">GOARCH</span>&nbsp;<span class="op" id="6188725">&amp;&amp;</span>&nbsp;<span class="ident" id="6188728">runtime</span><span class="op" id="6188735">.</span><span class="ident" id="6188736">GOOS</span>&nbsp;<span class="op" id="6188741">==</span>&nbsp;<span class="ident" id="6188744">c</span><span class="op" id="6188745">.</span><span class="ident" id="6188746">GOOS</span>&nbsp;<span class="op" id="6188751">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188756">c</span><span class="op" id="6188757">.</span><span class="ident" id="6188758">CgoEnabled</span>&nbsp;<span class="op" id="6188769">=</span>&nbsp;<span class="ident" id="6188771">cgoEnabled</span><span class="op" id="6188781">[</span><span class="ident" id="6188782">c</span><span class="op" id="6188783">.</span><span class="ident" id="6188784">GOOS</span><span class="op" id="6188788">+</span><span class="string" id="6188789">&#34;/&#34;</span><span class="op" id="6188792">+</span><span class="ident" id="6188793">c</span><span class="op" id="6188794">.</span><span class="ident" id="6188795">GOARCH</span><span class="op" id="6188801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188806">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188818">c</span><span class="op" id="6188819">.</span><span class="ident" id="6188820">CgoEnabled</span>&nbsp;<span class="op" id="6188831">=</span>&nbsp;<span class="builtintype" id="6188833">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188840">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188844">return</span>&nbsp;<span class="ident" id="6188851">c</span><br>
<span class="lineno"></span><span class="op" id="6188853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6188856">func</span>&nbsp;<span class="ident" id="6188861">envOr</span><span class="op" id="6188866">(</span><span class="ident" id="6188867">name</span><span class="op" id="6188871">,</span>&nbsp;<span class="ident" id="6188873">def</span>&nbsp;<span class="builtintype" id="6188877">string</span><span class="op" id="6188883">)</span>&nbsp;<span class="builtintype" id="6188885">string</span>&nbsp;<span class="op" id="6188892">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188895">s</span>&nbsp;<span class="op" id="6188897">:=</span>&nbsp;<span class="ident" id="6188900">os</span><span class="op" id="6188902">.</span><span class="ident" id="6188903">Getenv</span><span class="op" id="6188909">(</span><span class="ident" id="6188910">name</span><span class="op" id="6188914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188917">if</span>&nbsp;<span class="ident" id="6188920">s</span>&nbsp;<span class="op" id="6188922">==</span>&nbsp;<span class="string" id="6188925">&#34;&#34;</span>&nbsp;<span class="op" id="6188928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188932">return</span>&nbsp;<span class="ident" id="6188939">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188947">return</span>&nbsp;<span class="ident" id="6188954">s</span><br>
<span class="lineno">325</span><span class="op" id="6188956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6188959">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6189020">type</span>&nbsp;<span class="ident" id="6189025">ImportMode</span>&nbsp;<span class="builtintype" id="6189036">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="6189042">const</span>&nbsp;<span class="op" id="6189048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189051">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189117">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189181">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189218">FindOnly</span>&nbsp;<span class="ident" id="6189227">ImportMode</span>&nbsp;<span class="op" id="6189238">=</span>&nbsp;<span class="num" id="6189240">1</span>&nbsp;<span class="op" id="6189242">&lt;&lt;</span>&nbsp;<span class="ident" id="6189245">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189252">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189317">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189367">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189381">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189455">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189526">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189586">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189646">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="6189660">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6189663">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="6189723">type</span>&nbsp;<span class="ident" id="6189728">Package</span>&nbsp;<span class="keyword" id="6189736">struct</span>&nbsp;<span class="op" id="6189743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189746">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6189760">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6189769">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189810">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6189824">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6189833">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189850">ImportComment</span>&nbsp;<span class="builtintype" id="6189864">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6189873">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189921">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6189935">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6189944">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189971">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6189985">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6189994">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190037">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190051">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190060">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190105">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190119">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190128">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190178">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190192">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190201">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190252">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190266">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190275">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190321">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190335">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190344">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190373">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190387">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190396">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190418">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190432">[</span><span class="op" id="6190433">]</span><span class="builtintype" id="6190434">string</span>&nbsp;<span class="comment" id="6190441">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190502">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6190516">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6190525">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6190568">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190585">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190600">[</span><span class="op" id="6190601">]</span><span class="builtintype" id="6190602">string</span>&nbsp;<span class="comment" id="6190609">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190678">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190693">[</span><span class="op" id="6190694">]</span><span class="builtintype" id="6190695">string</span>&nbsp;<span class="comment" id="6190702">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190739">IgnoredGoFiles</span>&nbsp;<span class="op" id="6190754">[</span><span class="op" id="6190755">]</span><span class="builtintype" id="6190756">string</span>&nbsp;<span class="comment" id="6190763">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190807">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190822">[</span><span class="op" id="6190823">]</span><span class="builtintype" id="6190824">string</span>&nbsp;<span class="comment" id="6190831">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190851">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190866">[</span><span class="op" id="6190867">]</span><span class="builtintype" id="6190868">string</span>&nbsp;<span class="comment" id="6190875">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190911">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190926">[</span><span class="op" id="6190927">]</span><span class="builtintype" id="6190928">string</span>&nbsp;<span class="comment" id="6190935">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190969">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190984">[</span><span class="op" id="6190985">]</span><span class="builtintype" id="6190986">string</span>&nbsp;<span class="comment" id="6190993">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191033">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191048">[</span><span class="op" id="6191049">]</span><span class="builtintype" id="6191050">string</span>&nbsp;<span class="comment" id="6191057">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191077">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191092">[</span><span class="op" id="6191093">]</span><span class="builtintype" id="6191094">string</span>&nbsp;<span class="comment" id="6191101">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191117">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6191132">[</span><span class="op" id="6191133">]</span><span class="builtintype" id="6191134">string</span>&nbsp;<span class="comment" id="6191141">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191160">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191175">[</span><span class="op" id="6191176">]</span><span class="builtintype" id="6191177">string</span>&nbsp;<span class="comment" id="6191184">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6191233">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191252">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191265">[</span><span class="op" id="6191266">]</span><span class="builtintype" id="6191267">string</span>&nbsp;<span class="comment" id="6191274">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191300">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="6191313">[</span><span class="op" id="6191314">]</span><span class="builtintype" id="6191315">string</span>&nbsp;<span class="comment" id="6191322">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191350">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="6191363">[</span><span class="op" id="6191364">]</span><span class="builtintype" id="6191365">string</span>&nbsp;<span class="comment" id="6191372">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191400">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6191413">[</span><span class="op" id="6191414">]</span><span class="builtintype" id="6191415">string</span>&nbsp;<span class="comment" id="6191422">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191449">CgoPkgConfig</span>&nbsp;<span class="op" id="6191462">[</span><span class="op" id="6191463">]</span><span class="builtintype" id="6191464">string</span>&nbsp;<span class="comment" id="6191471">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6191502">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191529">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6191539">[</span><span class="op" id="6191540">]</span><span class="builtintype" id="6191541">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6191567">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191602">ImportPos</span>&nbsp;<span class="keyword" id="6191612">map</span><span class="op" id="6191615">[</span><span class="builtintype" id="6191616">string</span><span class="op" id="6191622">]</span><span class="op" id="6191623">[</span><span class="op" id="6191624">]</span><span class="ident" id="6191625">token</span><span class="op" id="6191630">.</span><span class="ident" id="6191631">Position</span>&nbsp;<span class="comment" id="6191640">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6191674">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191695">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191710">[</span><span class="op" id="6191711">]</span><span class="builtintype" id="6191712">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6191738">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191768">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191783">[</span><span class="op" id="6191784">]</span><span class="builtintype" id="6191785">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6191811">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191840">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="6191855">map</span><span class="op" id="6191858">[</span><span class="builtintype" id="6191859">string</span><span class="op" id="6191865">]</span><span class="op" id="6191866">[</span><span class="op" id="6191867">]</span><span class="ident" id="6191868">token</span><span class="op" id="6191873">.</span><span class="ident" id="6191874">Position</span>&nbsp;<span class="comment" id="6191883">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191920">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6191935">[</span><span class="op" id="6191936">]</span><span class="builtintype" id="6191937">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6191963">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191998">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6192013">[</span><span class="op" id="6192014">]</span><span class="builtintype" id="6192015">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6192041">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192071">XTestImportPos</span>&nbsp;<span class="keyword" id="6192086">map</span><span class="op" id="6192089">[</span><span class="builtintype" id="6192090">string</span><span class="op" id="6192096">]</span><span class="op" id="6192097">[</span><span class="op" id="6192098">]</span><span class="ident" id="6192099">token</span><span class="op" id="6192104">.</span><span class="ident" id="6192105">Position</span>&nbsp;<span class="comment" id="6192114">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="6192151">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="6192154">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6192211">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="6192260">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="6192310">func</span>&nbsp;<span class="op" id="6192315">(</span><span class="ident" id="6192316">p</span>&nbsp;<span class="op" id="6192318">*</span><span class="ident" id="6192319">Package</span><span class="op" id="6192326">)</span>&nbsp;<span class="ident" id="6192328">IsCommand</span><span class="op" id="6192337">(</span><span class="op" id="6192338">)</span>&nbsp;<span class="builtintype" id="6192340">bool</span>&nbsp;<span class="op" id="6192345">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192348">return</span>&nbsp;<span class="ident" id="6192355">p</span><span class="op" id="6192356">.</span><span class="ident" id="6192357">Name</span>&nbsp;<span class="op" id="6192362">==</span>&nbsp;<span class="string" id="6192365">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="6192372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6192375">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6192441">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="6192465">func</span>&nbsp;<span class="op" id="6192470">(</span><span class="ident" id="6192471">ctxt</span>&nbsp;<span class="op" id="6192476">*</span><span class="ident" id="6192477">Context</span><span class="op" id="6192484">)</span>&nbsp;<span class="ident" id="6192486">ImportDir</span><span class="op" id="6192495">(</span><span class="ident" id="6192496">dir</span>&nbsp;<span class="builtintype" id="6192500">string</span><span class="op" id="6192506">,</span>&nbsp;<span class="ident" id="6192508">mode</span>&nbsp;<span class="ident" id="6192513">ImportMode</span><span class="op" id="6192523">)</span>&nbsp;<span class="op" id="6192525">(</span><span class="op" id="6192526">*</span><span class="ident" id="6192527">Package</span><span class="op" id="6192534">,</span>&nbsp;<span class="builtintype" id="6192536">error</span><span class="op" id="6192541">)</span>&nbsp;<span class="op" id="6192543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192546">return</span>&nbsp;<span class="ident" id="6192553">ctxt</span><span class="op" id="6192557">.</span><span class="ident" id="6192558">Import</span><span class="op" id="6192564">(</span><span class="string" id="6192565">&#34;.&#34;</span><span class="op" id="6192568">,</span>&nbsp;<span class="ident" id="6192570">dir</span><span class="op" id="6192573">,</span>&nbsp;<span class="ident" id="6192575">mode</span><span class="op" id="6192579">)</span><br>
<span class="lineno"></span><span class="op" id="6192581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6192584">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="6192649">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6192715">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="6192770">type</span>&nbsp;<span class="ident" id="6192775">NoGoError</span>&nbsp;<span class="keyword" id="6192785">struct</span>&nbsp;<span class="op" id="6192792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192795">Dir</span>&nbsp;<span class="builtintype" id="6192799">string</span><br>
<span class="lineno"></span><span class="op" id="6192806">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6192809">func</span>&nbsp;<span class="op" id="6192814">(</span><span class="ident" id="6192815">e</span>&nbsp;<span class="op" id="6192817">*</span><span class="ident" id="6192818">NoGoError</span><span class="op" id="6192827">)</span>&nbsp;<span class="ident" id="6192829">Error</span><span class="op" id="6192834">(</span><span class="op" id="6192835">)</span>&nbsp;<span class="builtintype" id="6192837">string</span>&nbsp;<span class="op" id="6192844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192847">return</span>&nbsp;<span class="string" id="6192854">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6192889">+</span>&nbsp;<span class="ident" id="6192891">e</span><span class="op" id="6192892">.</span><span class="ident" id="6192893">Dir</span><br>
<span class="lineno"></span><span class="op" id="6192897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="6192900">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="6192957">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="6193018">type</span>&nbsp;<span class="ident" id="6193023">MultiplePackageError</span>&nbsp;<span class="keyword" id="6193044">struct</span>&nbsp;<span class="op" id="6193051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193054">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6193063">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6193072">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193103">Packages</span>&nbsp;<span class="op" id="6193112">[</span><span class="op" id="6193113">]</span><span class="builtintype" id="6193114">string</span>&nbsp;<span class="comment" id="6193121">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193145">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193154">[</span><span class="op" id="6193155">]</span><span class="builtintype" id="6193156">string</span>&nbsp;<span class="comment" id="6193163">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="6193225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6193228">func</span>&nbsp;<span class="op" id="6193233">(</span><span class="ident" id="6193234">e</span>&nbsp;<span class="op" id="6193236">*</span><span class="ident" id="6193237">MultiplePackageError</span><span class="op" id="6193257">)</span>&nbsp;<span class="ident" id="6193259">Error</span><span class="op" id="6193264">(</span><span class="op" id="6193265">)</span>&nbsp;<span class="builtintype" id="6193267">string</span>&nbsp;<span class="op" id="6193274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6193277">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193336">return</span>&nbsp;<span class="ident" id="6193343">fmt</span><span class="op" id="6193346">.</span><span class="ident" id="6193347">Sprintf</span><span class="op" id="6193354">(</span><span class="string" id="6193355">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6193397">,</span>&nbsp;<span class="ident" id="6193399">e</span><span class="op" id="6193400">.</span><span class="ident" id="6193401">Packages</span><span class="op" id="6193409">[</span><span class="num" id="6193410">0</span><span class="op" id="6193411">]</span><span class="op" id="6193412">,</span>&nbsp;<span class="ident" id="6193414">e</span><span class="op" id="6193415">.</span><span class="ident" id="6193416">Files</span><span class="op" id="6193421">[</span><span class="num" id="6193422">0</span><span class="op" id="6193423">]</span><span class="op" id="6193424">,</span>&nbsp;<span class="ident" id="6193426">e</span><span class="op" id="6193427">.</span><span class="ident" id="6193428">Packages</span><span class="op" id="6193436">[</span><span class="num" id="6193437">1</span><span class="op" id="6193438">]</span><span class="op" id="6193439">,</span>&nbsp;<span class="ident" id="6193441">e</span><span class="op" id="6193442">.</span><span class="ident" id="6193443">Files</span><span class="op" id="6193448">[</span><span class="num" id="6193449">1</span><span class="op" id="6193450">]</span><span class="op" id="6193451">,</span>&nbsp;<span class="ident" id="6193453">e</span><span class="op" id="6193454">.</span><span class="ident" id="6193455">Dir</span><span class="op" id="6193458">)</span><br>
<span class="lineno"></span><span class="op" id="6193460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6193463">func</span>&nbsp;<span class="ident" id="6193468">nameExt</span><span class="op" id="6193475">(</span><span class="ident" id="6193476">name</span>&nbsp;<span class="builtintype" id="6193481">string</span><span class="op" id="6193487">)</span>&nbsp;<span class="builtintype" id="6193489">string</span>&nbsp;<span class="op" id="6193496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193499">i</span>&nbsp;<span class="op" id="6193501">:=</span>&nbsp;<span class="ident" id="6193504">strings</span><span class="op" id="6193511">.</span><span class="ident" id="6193512">LastIndex</span><span class="op" id="6193521">(</span><span class="ident" id="6193522">name</span><span class="op" id="6193526">,</span>&nbsp;<span class="string" id="6193528">&#34;.&#34;</span><span class="op" id="6193531">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193534">if</span>&nbsp;<span class="ident" id="6193537">i</span>&nbsp;<span class="op" id="6193539">&lt;</span>&nbsp;<span class="num" id="6193541">0</span>&nbsp;<span class="op" id="6193543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193547">return</span>&nbsp;<span class="string" id="6193554">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193561">return</span>&nbsp;<span class="ident" id="6193568">name</span><span class="op" id="6193572">[</span><span class="ident" id="6193573">i</span><span class="op" id="6193574">:</span><span class="op" id="6193575">]</span><br>
<span class="lineno"></span><span class="op" id="6193577">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="6193580">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="6193653">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6193722">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="6193798">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="6193874">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="6193891">//</span><br>
<span class="lineno"></span><span class="comment" id="6193894">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="6193968">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="6194014">//</span><br>
<span class="lineno">450</span><span class="comment" id="6194017">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="6194057">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="6194121">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="6194184">//</span><br>
<span class="lineno"></span><span class="comment" id="6194187">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="6194255">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="6194299">//</span><br>
<span class="lineno"></span><span class="keyword" id="6194302">func</span>&nbsp;<span class="op" id="6194307">(</span><span class="ident" id="6194308">ctxt</span>&nbsp;<span class="op" id="6194313">*</span><span class="ident" id="6194314">Context</span><span class="op" id="6194321">)</span>&nbsp;<span class="ident" id="6194323">Import</span><span class="op" id="6194329">(</span><span class="ident" id="6194330">path</span>&nbsp;<span class="builtintype" id="6194335">string</span><span class="op" id="6194341">,</span>&nbsp;<span class="ident" id="6194343">srcDir</span>&nbsp;<span class="builtintype" id="6194350">string</span><span class="op" id="6194356">,</span>&nbsp;<span class="ident" id="6194358">mode</span>&nbsp;<span class="ident" id="6194363">ImportMode</span><span class="op" id="6194373">)</span>&nbsp;<span class="op" id="6194375">(</span><span class="op" id="6194376">*</span><span class="ident" id="6194377">Package</span><span class="op" id="6194384">,</span>&nbsp;<span class="builtintype" id="6194386">error</span><span class="op" id="6194391">)</span>&nbsp;<span class="op" id="6194393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194396">p</span>&nbsp;<span class="op" id="6194398">:=</span>&nbsp;<span class="op" id="6194401">&amp;</span><span class="ident" id="6194402">Package</span><span class="op" id="6194409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194413">ImportPath</span><span class="op" id="6194423">:</span>&nbsp;<span class="ident" id="6194425">path</span><span class="op" id="6194429">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194435">if</span>&nbsp;<span class="ident" id="6194438">path</span>&nbsp;<span class="op" id="6194443">==</span>&nbsp;<span class="string" id="6194446">&#34;&#34;</span>&nbsp;<span class="op" id="6194449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194453">return</span>&nbsp;<span class="ident" id="6194460">p</span><span class="op" id="6194461">,</span>&nbsp;<span class="ident" id="6194463">fmt</span><span class="op" id="6194466">.</span><span class="ident" id="6194467">Errorf</span><span class="op" id="6194473">(</span><span class="string" id="6194474">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="6194506">,</span>&nbsp;<span class="ident" id="6194508">path</span><span class="op" id="6194512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194519">var</span>&nbsp;<span class="ident" id="6194523">pkga</span>&nbsp;<span class="builtintype" id="6194528">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194536">var</span>&nbsp;<span class="ident" id="6194540">pkgerr</span>&nbsp;<span class="builtintype" id="6194547">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194554">switch</span>&nbsp;<span class="ident" id="6194561">ctxt</span><span class="op" id="6194565">.</span><span class="ident" id="6194566">Compiler</span>&nbsp;<span class="op" id="6194575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194578">case</span>&nbsp;<span class="string" id="6194583">&#34;gccgo&#34;</span><span class="op" id="6194590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194594">dir</span><span class="op" id="6194597">,</span>&nbsp;<span class="ident" id="6194599">elem</span>&nbsp;<span class="op" id="6194604">:=</span>&nbsp;<span class="ident" id="6194607">pathpkg</span><span class="op" id="6194614">.</span><span class="ident" id="6194615">Split</span><span class="op" id="6194620">(</span><span class="ident" id="6194621">p</span><span class="op" id="6194622">.</span><span class="ident" id="6194623">ImportPath</span><span class="op" id="6194633">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194637">pkga</span>&nbsp;<span class="op" id="6194642">=</span>&nbsp;<span class="string" id="6194644">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="6194657">+</span>&nbsp;<span class="ident" id="6194659">ctxt</span><span class="op" id="6194663">.</span><span class="ident" id="6194664">GOOS</span>&nbsp;<span class="op" id="6194669">+</span>&nbsp;<span class="string" id="6194671">&#34;_&#34;</span>&nbsp;<span class="op" id="6194675">+</span>&nbsp;<span class="ident" id="6194677">ctxt</span><span class="op" id="6194681">.</span><span class="ident" id="6194682">GOARCH</span>&nbsp;<span class="op" id="6194689">+</span>&nbsp;<span class="string" id="6194691">&#34;/&#34;</span>&nbsp;<span class="op" id="6194695">+</span>&nbsp;<span class="ident" id="6194697">dir</span>&nbsp;<span class="op" id="6194701">+</span>&nbsp;<span class="string" id="6194703">&#34;lib&#34;</span>&nbsp;<span class="op" id="6194709">+</span>&nbsp;<span class="ident" id="6194711">elem</span>&nbsp;<span class="op" id="6194716">+</span>&nbsp;<span class="string" id="6194718">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194724">case</span>&nbsp;<span class="string" id="6194729">&#34;gc&#34;</span><span class="op" id="6194733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194737">suffix</span>&nbsp;<span class="op" id="6194744">:=</span>&nbsp;<span class="string" id="6194747">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194752">if</span>&nbsp;<span class="ident" id="6194755">ctxt</span><span class="op" id="6194759">.</span><span class="ident" id="6194760">InstallSuffix</span>&nbsp;<span class="op" id="6194774">!=</span>&nbsp;<span class="string" id="6194777">&#34;&#34;</span>&nbsp;<span class="op" id="6194780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194785">suffix</span>&nbsp;<span class="op" id="6194792">=</span>&nbsp;<span class="string" id="6194794">&#34;_&#34;</span>&nbsp;<span class="op" id="6194798">+</span>&nbsp;<span class="ident" id="6194800">ctxt</span><span class="op" id="6194804">.</span><span class="ident" id="6194805">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194825">pkga</span>&nbsp;<span class="op" id="6194830">=</span>&nbsp;<span class="string" id="6194832">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="6194839">+</span>&nbsp;<span class="ident" id="6194841">ctxt</span><span class="op" id="6194845">.</span><span class="ident" id="6194846">GOOS</span>&nbsp;<span class="op" id="6194851">+</span>&nbsp;<span class="string" id="6194853">&#34;_&#34;</span>&nbsp;<span class="op" id="6194857">+</span>&nbsp;<span class="ident" id="6194859">ctxt</span><span class="op" id="6194863">.</span><span class="ident" id="6194864">GOARCH</span>&nbsp;<span class="op" id="6194871">+</span>&nbsp;<span class="ident" id="6194873">suffix</span>&nbsp;<span class="op" id="6194880">+</span>&nbsp;<span class="string" id="6194882">&#34;/&#34;</span>&nbsp;<span class="op" id="6194886">+</span>&nbsp;<span class="ident" id="6194888">p</span><span class="op" id="6194889">.</span><span class="ident" id="6194890">ImportPath</span>&nbsp;<span class="op" id="6194901">+</span>&nbsp;<span class="string" id="6194903">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194909">default</span><span class="op" id="6194916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6194920">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194957">pkgerr</span>&nbsp;<span class="op" id="6194964">=</span>&nbsp;<span class="ident" id="6194966">fmt</span><span class="op" id="6194969">.</span><span class="ident" id="6194970">Errorf</span><span class="op" id="6194976">(</span><span class="string" id="6194977">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="6195009">,</span>&nbsp;<span class="ident" id="6195011">path</span><span class="op" id="6195015">,</span>&nbsp;<span class="ident" id="6195017">ctxt</span><span class="op" id="6195021">.</span><span class="ident" id="6195022">Compiler</span><span class="op" id="6195030">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195037">binaryOnly</span>&nbsp;<span class="op" id="6195048">:=</span>&nbsp;<span class="builtintype" id="6195051">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195058">if</span>&nbsp;<span class="ident" id="6195061">IsLocalImport</span><span class="op" id="6195074">(</span><span class="ident" id="6195075">path</span><span class="op" id="6195079">)</span>&nbsp;<span class="op" id="6195081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195085">pkga</span>&nbsp;<span class="op" id="6195090">=</span>&nbsp;<span class="string" id="6195092">&#34;&#34;</span>&nbsp;<span class="comment" id="6195095">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195137">if</span>&nbsp;<span class="ident" id="6195140">srcDir</span>&nbsp;<span class="op" id="6195147">==</span>&nbsp;<span class="string" id="6195150">&#34;&#34;</span>&nbsp;<span class="op" id="6195153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195158">return</span>&nbsp;<span class="ident" id="6195165">p</span><span class="op" id="6195166">,</span>&nbsp;<span class="ident" id="6195168">fmt</span><span class="op" id="6195171">.</span><span class="ident" id="6195172">Errorf</span><span class="op" id="6195178">(</span><span class="string" id="6195179">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="6195228">,</span>&nbsp;<span class="ident" id="6195230">path</span><span class="op" id="6195234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195242">if</span>&nbsp;<span class="op" id="6195245">!</span><span class="ident" id="6195246">ctxt</span><span class="op" id="6195250">.</span><span class="ident" id="6195251">isAbsPath</span><span class="op" id="6195260">(</span><span class="ident" id="6195261">path</span><span class="op" id="6195265">)</span>&nbsp;<span class="op" id="6195267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195272">p</span><span class="op" id="6195273">.</span><span class="ident" id="6195274">Dir</span>&nbsp;<span class="op" id="6195278">=</span>&nbsp;<span class="ident" id="6195280">ctxt</span><span class="op" id="6195284">.</span><span class="ident" id="6195285">joinPath</span><span class="op" id="6195293">(</span><span class="ident" id="6195294">srcDir</span><span class="op" id="6195300">,</span>&nbsp;<span class="ident" id="6195302">path</span><span class="op" id="6195306">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195314">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195360">if</span>&nbsp;<span class="ident" id="6195363">ctxt</span><span class="op" id="6195367">.</span><span class="ident" id="6195368">GOROOT</span>&nbsp;<span class="op" id="6195375">!=</span>&nbsp;<span class="string" id="6195378">&#34;&#34;</span>&nbsp;<span class="op" id="6195381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195386">root</span>&nbsp;<span class="op" id="6195391">:=</span>&nbsp;<span class="ident" id="6195394">ctxt</span><span class="op" id="6195398">.</span><span class="ident" id="6195399">joinPath</span><span class="op" id="6195407">(</span><span class="ident" id="6195408">ctxt</span><span class="op" id="6195412">.</span><span class="ident" id="6195413">GOROOT</span><span class="op" id="6195419">,</span>&nbsp;<span class="string" id="6195421">&#34;src&#34;</span><span class="op" id="6195426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195431">if</span>&nbsp;<span class="ident" id="6195434">sub</span><span class="op" id="6195437">,</span>&nbsp;<span class="ident" id="6195439">ok</span>&nbsp;<span class="op" id="6195442">:=</span>&nbsp;<span class="ident" id="6195445">ctxt</span><span class="op" id="6195449">.</span><span class="ident" id="6195450">hasSubdir</span><span class="op" id="6195459">(</span><span class="ident" id="6195460">root</span><span class="op" id="6195464">,</span>&nbsp;<span class="ident" id="6195466">p</span><span class="op" id="6195467">.</span><span class="ident" id="6195468">Dir</span><span class="op" id="6195471">)</span><span class="op" id="6195472">;</span>&nbsp;<span class="ident" id="6195474">ok</span>&nbsp;<span class="op" id="6195477">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195483">p</span><span class="op" id="6195484">.</span><span class="ident" id="6195485">Goroot</span>&nbsp;<span class="op" id="6195492">=</span>&nbsp;<span class="builtintype" id="6195494">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195503">p</span><span class="op" id="6195504">.</span><span class="ident" id="6195505">ImportPath</span>&nbsp;<span class="op" id="6195516">=</span>&nbsp;<span class="ident" id="6195518">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195526">p</span><span class="op" id="6195527">.</span><span class="ident" id="6195528">Root</span>&nbsp;<span class="op" id="6195533">=</span>&nbsp;<span class="ident" id="6195535">ctxt</span><span class="op" id="6195539">.</span><span class="ident" id="6195540">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195551">goto</span>&nbsp;<span class="ident" id="6195556">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195565">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195573">all</span>&nbsp;<span class="op" id="6195577">:=</span>&nbsp;<span class="ident" id="6195580">ctxt</span><span class="op" id="6195584">.</span><span class="ident" id="6195585">gopath</span><span class="op" id="6195591">(</span><span class="op" id="6195592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195596">for</span>&nbsp;<span class="ident" id="6195600">i</span><span class="op" id="6195601">,</span>&nbsp;<span class="ident" id="6195603">root</span>&nbsp;<span class="op" id="6195608">:=</span>&nbsp;<span class="keyword" id="6195611">range</span>&nbsp;<span class="ident" id="6195617">all</span>&nbsp;<span class="op" id="6195621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195626">rootsrc</span>&nbsp;<span class="op" id="6195634">:=</span>&nbsp;<span class="ident" id="6195637">ctxt</span><span class="op" id="6195641">.</span><span class="ident" id="6195642">joinPath</span><span class="op" id="6195650">(</span><span class="ident" id="6195651">root</span><span class="op" id="6195655">,</span>&nbsp;<span class="string" id="6195657">&#34;src&#34;</span><span class="op" id="6195662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195667">if</span>&nbsp;<span class="ident" id="6195670">sub</span><span class="op" id="6195673">,</span>&nbsp;<span class="ident" id="6195675">ok</span>&nbsp;<span class="op" id="6195678">:=</span>&nbsp;<span class="ident" id="6195681">ctxt</span><span class="op" id="6195685">.</span><span class="ident" id="6195686">hasSubdir</span><span class="op" id="6195695">(</span><span class="ident" id="6195696">rootsrc</span><span class="op" id="6195703">,</span>&nbsp;<span class="ident" id="6195705">p</span><span class="op" id="6195706">.</span><span class="ident" id="6195707">Dir</span><span class="op" id="6195710">)</span><span class="op" id="6195711">;</span>&nbsp;<span class="ident" id="6195713">ok</span>&nbsp;<span class="op" id="6195716">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195722">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195771">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195826">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195845">if</span>&nbsp;<span class="ident" id="6195848">ctxt</span><span class="op" id="6195852">.</span><span class="ident" id="6195853">GOROOT</span>&nbsp;<span class="op" id="6195860">!=</span>&nbsp;<span class="string" id="6195863">&#34;&#34;</span>&nbsp;<span class="op" id="6195866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195873">if</span>&nbsp;<span class="ident" id="6195876">dir</span>&nbsp;<span class="op" id="6195880">:=</span>&nbsp;<span class="ident" id="6195883">ctxt</span><span class="op" id="6195887">.</span><span class="ident" id="6195888">joinPath</span><span class="op" id="6195896">(</span><span class="ident" id="6195897">ctxt</span><span class="op" id="6195901">.</span><span class="ident" id="6195902">GOROOT</span><span class="op" id="6195908">,</span>&nbsp;<span class="string" id="6195910">&#34;src&#34;</span><span class="op" id="6195915">,</span>&nbsp;<span class="ident" id="6195917">sub</span><span class="op" id="6195920">)</span><span class="op" id="6195921">;</span>&nbsp;<span class="ident" id="6195923">ctxt</span><span class="op" id="6195927">.</span><span class="ident" id="6195928">isDir</span><span class="op" id="6195933">(</span><span class="ident" id="6195934">dir</span><span class="op" id="6195937">)</span>&nbsp;<span class="op" id="6195939">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195947">p</span><span class="op" id="6195948">.</span><span class="ident" id="6195949">ConflictDir</span>&nbsp;<span class="op" id="6195961">=</span>&nbsp;<span class="ident" id="6195963">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195973">goto</span>&nbsp;<span class="ident" id="6195978">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196001">for</span>&nbsp;<span class="ident" id="6196005">_</span><span class="op" id="6196006">,</span>&nbsp;<span class="ident" id="6196008">earlyRoot</span>&nbsp;<span class="op" id="6196018">:=</span>&nbsp;<span class="keyword" id="6196021">range</span>&nbsp;<span class="ident" id="6196027">all</span><span class="op" id="6196030">[</span><span class="op" id="6196031">:</span><span class="ident" id="6196032">i</span><span class="op" id="6196033">]</span>&nbsp;<span class="op" id="6196035">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196042">if</span>&nbsp;<span class="ident" id="6196045">dir</span>&nbsp;<span class="op" id="6196049">:=</span>&nbsp;<span class="ident" id="6196052">ctxt</span><span class="op" id="6196056">.</span><span class="ident" id="6196057">joinPath</span><span class="op" id="6196065">(</span><span class="ident" id="6196066">earlyRoot</span><span class="op" id="6196075">,</span>&nbsp;<span class="string" id="6196077">&#34;src&#34;</span><span class="op" id="6196082">,</span>&nbsp;<span class="ident" id="6196084">sub</span><span class="op" id="6196087">)</span><span class="op" id="6196088">;</span>&nbsp;<span class="ident" id="6196090">ctxt</span><span class="op" id="6196094">.</span><span class="ident" id="6196095">isDir</span><span class="op" id="6196100">(</span><span class="ident" id="6196101">dir</span><span class="op" id="6196104">)</span>&nbsp;<span class="op" id="6196106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196114">p</span><span class="op" id="6196115">.</span><span class="ident" id="6196116">ConflictDir</span>&nbsp;<span class="op" id="6196128">=</span>&nbsp;<span class="ident" id="6196130">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196140">goto</span>&nbsp;<span class="ident" id="6196145">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196162">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196169">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196237">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196255">p</span><span class="op" id="6196256">.</span><span class="ident" id="6196257">ImportPath</span>&nbsp;<span class="op" id="6196268">=</span>&nbsp;<span class="ident" id="6196270">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196278">p</span><span class="op" id="6196279">.</span><span class="ident" id="6196280">Root</span>&nbsp;<span class="op" id="6196285">=</span>&nbsp;<span class="ident" id="6196287">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196296">goto</span>&nbsp;<span class="ident" id="6196301">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196318">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196376">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196421">}</span>&nbsp;<span class="keyword" id="6196423">else</span>&nbsp;<span class="op" id="6196428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196432">if</span>&nbsp;<span class="ident" id="6196435">strings</span><span class="op" id="6196442">.</span><span class="ident" id="6196443">HasPrefix</span><span class="op" id="6196452">(</span><span class="ident" id="6196453">path</span><span class="op" id="6196457">,</span>&nbsp;<span class="string" id="6196459">&#34;/&#34;</span><span class="op" id="6196462">)</span>&nbsp;<span class="op" id="6196464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196469">return</span>&nbsp;<span class="ident" id="6196476">p</span><span class="op" id="6196477">,</span>&nbsp;<span class="ident" id="6196479">fmt</span><span class="op" id="6196482">.</span><span class="ident" id="6196483">Errorf</span><span class="op" id="6196489">(</span><span class="string" id="6196490">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="6196530">,</span>&nbsp;<span class="ident" id="6196532">path</span><span class="op" id="6196536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196545">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196609">var</span>&nbsp;<span class="ident" id="6196613">tried</span>&nbsp;<span class="keyword" id="6196619">struct</span>&nbsp;<span class="op" id="6196626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196631">goroot</span>&nbsp;<span class="builtintype" id="6196638">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196648">gopath</span>&nbsp;<span class="op" id="6196655">[</span><span class="op" id="6196656">]</span><span class="builtintype" id="6196657">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196666">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196671">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196714">if</span>&nbsp;<span class="ident" id="6196717">ctxt</span><span class="op" id="6196721">.</span><span class="ident" id="6196722">GOROOT</span>&nbsp;<span class="op" id="6196729">!=</span>&nbsp;<span class="string" id="6196732">&#34;&#34;</span>&nbsp;<span class="op" id="6196735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196740">dir</span>&nbsp;<span class="op" id="6196744">:=</span>&nbsp;<span class="ident" id="6196747">ctxt</span><span class="op" id="6196751">.</span><span class="ident" id="6196752">joinPath</span><span class="op" id="6196760">(</span><span class="ident" id="6196761">ctxt</span><span class="op" id="6196765">.</span><span class="ident" id="6196766">GOROOT</span><span class="op" id="6196772">,</span>&nbsp;<span class="string" id="6196774">&#34;src&#34;</span><span class="op" id="6196779">,</span>&nbsp;<span class="ident" id="6196781">path</span><span class="op" id="6196785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196790">isDir</span>&nbsp;<span class="op" id="6196796">:=</span>&nbsp;<span class="ident" id="6196799">ctxt</span><span class="op" id="6196803">.</span><span class="ident" id="6196804">isDir</span><span class="op" id="6196809">(</span><span class="ident" id="6196810">dir</span><span class="op" id="6196813">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196818">binaryOnly</span>&nbsp;<span class="op" id="6196829">=</span>&nbsp;<span class="op" id="6196831">!</span><span class="ident" id="6196832">isDir</span>&nbsp;<span class="op" id="6196838">&amp;&amp;</span>&nbsp;<span class="ident" id="6196841">mode</span><span class="op" id="6196845">&amp;</span><span class="ident" id="6196846">AllowBinary</span>&nbsp;<span class="op" id="6196858">!=</span>&nbsp;<span class="num" id="6196861">0</span>&nbsp;<span class="op" id="6196863">&amp;&amp;</span>&nbsp;<span class="ident" id="6196866">pkga</span>&nbsp;<span class="op" id="6196871">!=</span>&nbsp;<span class="string" id="6196874">&#34;&#34;</span>&nbsp;<span class="op" id="6196877">&amp;&amp;</span>&nbsp;<span class="ident" id="6196880">ctxt</span><span class="op" id="6196884">.</span><span class="ident" id="6196885">isFile</span><span class="op" id="6196891">(</span><span class="ident" id="6196892">ctxt</span><span class="op" id="6196896">.</span><span class="ident" id="6196897">joinPath</span><span class="op" id="6196905">(</span><span class="ident" id="6196906">ctxt</span><span class="op" id="6196910">.</span><span class="ident" id="6196911">GOROOT</span><span class="op" id="6196917">,</span>&nbsp;<span class="ident" id="6196919">pkga</span><span class="op" id="6196923">)</span><span class="op" id="6196924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196929">if</span>&nbsp;<span class="ident" id="6196932">isDir</span>&nbsp;<span class="op" id="6196938">||</span>&nbsp;<span class="ident" id="6196941">binaryOnly</span>&nbsp;<span class="op" id="6196952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196958">p</span><span class="op" id="6196959">.</span><span class="ident" id="6196960">Dir</span>&nbsp;<span class="op" id="6196964">=</span>&nbsp;<span class="ident" id="6196966">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196974">p</span><span class="op" id="6196975">.</span><span class="ident" id="6196976">Goroot</span>&nbsp;<span class="op" id="6196983">=</span>&nbsp;<span class="builtintype" id="6196985">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196994">p</span><span class="op" id="6196995">.</span><span class="ident" id="6196996">Root</span>&nbsp;<span class="op" id="6197001">=</span>&nbsp;<span class="ident" id="6197003">ctxt</span><span class="op" id="6197007">.</span><span class="ident" id="6197008">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197019">goto</span>&nbsp;<span class="ident" id="6197024">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197038">tried</span><span class="op" id="6197043">.</span><span class="ident" id="6197044">goroot</span>&nbsp;<span class="op" id="6197051">=</span>&nbsp;<span class="ident" id="6197053">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197063">for</span>&nbsp;<span class="ident" id="6197067">_</span><span class="op" id="6197068">,</span>&nbsp;<span class="ident" id="6197070">root</span>&nbsp;<span class="op" id="6197075">:=</span>&nbsp;<span class="keyword" id="6197078">range</span>&nbsp;<span class="ident" id="6197084">ctxt</span><span class="op" id="6197088">.</span><span class="ident" id="6197089">gopath</span><span class="op" id="6197095">(</span><span class="op" id="6197096">)</span>&nbsp;<span class="op" id="6197098">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197103">dir</span>&nbsp;<span class="op" id="6197107">:=</span>&nbsp;<span class="ident" id="6197110">ctxt</span><span class="op" id="6197114">.</span><span class="ident" id="6197115">joinPath</span><span class="op" id="6197123">(</span><span class="ident" id="6197124">root</span><span class="op" id="6197128">,</span>&nbsp;<span class="string" id="6197130">&#34;src&#34;</span><span class="op" id="6197135">,</span>&nbsp;<span class="ident" id="6197137">path</span><span class="op" id="6197141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197146">isDir</span>&nbsp;<span class="op" id="6197152">:=</span>&nbsp;<span class="ident" id="6197155">ctxt</span><span class="op" id="6197159">.</span><span class="ident" id="6197160">isDir</span><span class="op" id="6197165">(</span><span class="ident" id="6197166">dir</span><span class="op" id="6197169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197174">binaryOnly</span>&nbsp;<span class="op" id="6197185">=</span>&nbsp;<span class="op" id="6197187">!</span><span class="ident" id="6197188">isDir</span>&nbsp;<span class="op" id="6197194">&amp;&amp;</span>&nbsp;<span class="ident" id="6197197">mode</span><span class="op" id="6197201">&amp;</span><span class="ident" id="6197202">AllowBinary</span>&nbsp;<span class="op" id="6197214">!=</span>&nbsp;<span class="num" id="6197217">0</span>&nbsp;<span class="op" id="6197219">&amp;&amp;</span>&nbsp;<span class="ident" id="6197222">pkga</span>&nbsp;<span class="op" id="6197227">!=</span>&nbsp;<span class="string" id="6197230">&#34;&#34;</span>&nbsp;<span class="op" id="6197233">&amp;&amp;</span>&nbsp;<span class="ident" id="6197236">ctxt</span><span class="op" id="6197240">.</span><span class="ident" id="6197241">isFile</span><span class="op" id="6197247">(</span><span class="ident" id="6197248">ctxt</span><span class="op" id="6197252">.</span><span class="ident" id="6197253">joinPath</span><span class="op" id="6197261">(</span><span class="ident" id="6197262">root</span><span class="op" id="6197266">,</span>&nbsp;<span class="ident" id="6197268">pkga</span><span class="op" id="6197272">)</span><span class="op" id="6197273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197278">if</span>&nbsp;<span class="ident" id="6197281">isDir</span>&nbsp;<span class="op" id="6197287">||</span>&nbsp;<span class="ident" id="6197290">binaryOnly</span>&nbsp;<span class="op" id="6197301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197307">p</span><span class="op" id="6197308">.</span><span class="ident" id="6197309">Dir</span>&nbsp;<span class="op" id="6197313">=</span>&nbsp;<span class="ident" id="6197315">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197323">p</span><span class="op" id="6197324">.</span><span class="ident" id="6197325">Root</span>&nbsp;<span class="op" id="6197330">=</span>&nbsp;<span class="ident" id="6197332">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197341">goto</span>&nbsp;<span class="ident" id="6197346">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197360">tried</span><span class="op" id="6197365">.</span><span class="ident" id="6197366">gopath</span>&nbsp;<span class="op" id="6197373">=</span>&nbsp;<span class="builtinfunc" id="6197375">append</span><span class="op" id="6197381">(</span><span class="ident" id="6197382">tried</span><span class="op" id="6197387">.</span><span class="ident" id="6197388">gopath</span><span class="op" id="6197394">,</span>&nbsp;<span class="ident" id="6197396">dir</span><span class="op" id="6197399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197403">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197408">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197435">var</span>&nbsp;<span class="ident" id="6197439">paths</span>&nbsp;<span class="op" id="6197445">[</span><span class="op" id="6197446">]</span><span class="builtintype" id="6197447">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197456">if</span>&nbsp;<span class="ident" id="6197459">tried</span><span class="op" id="6197464">.</span><span class="ident" id="6197465">goroot</span>&nbsp;<span class="op" id="6197472">!=</span>&nbsp;<span class="string" id="6197475">&#34;&#34;</span>&nbsp;<span class="op" id="6197478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197483">paths</span>&nbsp;<span class="op" id="6197489">=</span>&nbsp;<span class="builtinfunc" id="6197491">append</span><span class="op" id="6197497">(</span><span class="ident" id="6197498">paths</span><span class="op" id="6197503">,</span>&nbsp;<span class="ident" id="6197505">fmt</span><span class="op" id="6197508">.</span><span class="ident" id="6197509">Sprintf</span><span class="op" id="6197516">(</span><span class="string" id="6197517">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="6197538">,</span>&nbsp;<span class="ident" id="6197540">tried</span><span class="op" id="6197545">.</span><span class="ident" id="6197546">goroot</span><span class="op" id="6197552">)</span><span class="op" id="6197553">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197557">}</span>&nbsp;<span class="keyword" id="6197559">else</span>&nbsp;<span class="op" id="6197564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197569">paths</span>&nbsp;<span class="op" id="6197575">=</span>&nbsp;<span class="builtinfunc" id="6197577">append</span><span class="op" id="6197583">(</span><span class="ident" id="6197584">paths</span><span class="op" id="6197589">,</span>&nbsp;<span class="string" id="6197591">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6197612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197620">var</span>&nbsp;<span class="ident" id="6197624">i</span>&nbsp;<span class="builtintype" id="6197626">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197632">var</span>&nbsp;<span class="ident" id="6197636">format</span>&nbsp;<span class="op" id="6197643">=</span>&nbsp;<span class="string" id="6197645">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197669">for</span>&nbsp;<span class="op" id="6197673">;</span>&nbsp;<span class="ident" id="6197675">i</span>&nbsp;<span class="op" id="6197677">&lt;</span>&nbsp;<span class="builtinfunc" id="6197679">len</span><span class="op" id="6197682">(</span><span class="ident" id="6197683">tried</span><span class="op" id="6197688">.</span><span class="ident" id="6197689">gopath</span><span class="op" id="6197695">)</span><span class="op" id="6197696">;</span>&nbsp;<span class="ident" id="6197698">i</span><span class="op" id="6197699">++</span>&nbsp;<span class="op" id="6197702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197707">if</span>&nbsp;<span class="ident" id="6197710">i</span>&nbsp;<span class="op" id="6197712">&gt;</span>&nbsp;<span class="num" id="6197714">0</span>&nbsp;<span class="op" id="6197716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197722">format</span>&nbsp;<span class="op" id="6197729">=</span>&nbsp;<span class="string" id="6197731">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197746">paths</span>&nbsp;<span class="op" id="6197752">=</span>&nbsp;<span class="builtinfunc" id="6197754">append</span><span class="op" id="6197760">(</span><span class="ident" id="6197761">paths</span><span class="op" id="6197766">,</span>&nbsp;<span class="ident" id="6197768">fmt</span><span class="op" id="6197771">.</span><span class="ident" id="6197772">Sprintf</span><span class="op" id="6197779">(</span><span class="ident" id="6197780">format</span><span class="op" id="6197786">,</span>&nbsp;<span class="ident" id="6197788">tried</span><span class="op" id="6197793">.</span><span class="ident" id="6197794">gopath</span><span class="op" id="6197800">[</span><span class="ident" id="6197801">i</span><span class="op" id="6197802">]</span><span class="op" id="6197803">)</span><span class="op" id="6197804">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197812">if</span>&nbsp;<span class="ident" id="6197815">i</span>&nbsp;<span class="op" id="6197817">==</span>&nbsp;<span class="num" id="6197820">0</span>&nbsp;<span class="op" id="6197822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197827">paths</span>&nbsp;<span class="op" id="6197833">=</span>&nbsp;<span class="builtinfunc" id="6197835">append</span><span class="op" id="6197841">(</span><span class="ident" id="6197842">paths</span><span class="op" id="6197847">,</span>&nbsp;<span class="string" id="6197849">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6197870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197878">return</span>&nbsp;<span class="ident" id="6197885">p</span><span class="op" id="6197886">,</span>&nbsp;<span class="ident" id="6197888">fmt</span><span class="op" id="6197891">.</span><span class="ident" id="6197892">Errorf</span><span class="op" id="6197898">(</span><span class="string" id="6197899">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="6197938">,</span>&nbsp;<span class="ident" id="6197940">path</span><span class="op" id="6197944">,</span>&nbsp;<span class="ident" id="6197946">strings</span><span class="op" id="6197953">.</span><span class="ident" id="6197954">Join</span><span class="op" id="6197958">(</span><span class="ident" id="6197959">paths</span><span class="op" id="6197964">,</span>&nbsp;<span class="string" id="6197966">&#34;\n&#34;</span><span class="op" id="6197970">)</span><span class="op" id="6197971">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6197977">Found</span><span class="op" id="6197982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197985">if</span>&nbsp;<span class="ident" id="6197988">p</span><span class="op" id="6197989">.</span><span class="ident" id="6197990">Root</span>&nbsp;<span class="op" id="6197995">!=</span>&nbsp;<span class="string" id="6197998">&#34;&#34;</span>&nbsp;<span class="op" id="6198001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198005">p</span><span class="op" id="6198006">.</span><span class="ident" id="6198007">SrcRoot</span>&nbsp;<span class="op" id="6198015">=</span>&nbsp;<span class="ident" id="6198017">ctxt</span><span class="op" id="6198021">.</span><span class="ident" id="6198022">joinPath</span><span class="op" id="6198030">(</span><span class="ident" id="6198031">p</span><span class="op" id="6198032">.</span><span class="ident" id="6198033">Root</span><span class="op" id="6198037">,</span>&nbsp;<span class="string" id="6198039">&#34;src&#34;</span><span class="op" id="6198044">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198048">p</span><span class="op" id="6198049">.</span><span class="ident" id="6198050">PkgRoot</span>&nbsp;<span class="op" id="6198058">=</span>&nbsp;<span class="ident" id="6198060">ctxt</span><span class="op" id="6198064">.</span><span class="ident" id="6198065">joinPath</span><span class="op" id="6198073">(</span><span class="ident" id="6198074">p</span><span class="op" id="6198075">.</span><span class="ident" id="6198076">Root</span><span class="op" id="6198080">,</span>&nbsp;<span class="string" id="6198082">&#34;pkg&#34;</span><span class="op" id="6198087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198091">p</span><span class="op" id="6198092">.</span><span class="ident" id="6198093">BinDir</span>&nbsp;<span class="op" id="6198100">=</span>&nbsp;<span class="ident" id="6198102">ctxt</span><span class="op" id="6198106">.</span><span class="ident" id="6198107">joinPath</span><span class="op" id="6198115">(</span><span class="ident" id="6198116">p</span><span class="op" id="6198117">.</span><span class="ident" id="6198118">Root</span><span class="op" id="6198122">,</span>&nbsp;<span class="string" id="6198124">&#34;bin&#34;</span><span class="op" id="6198129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198133">if</span>&nbsp;<span class="ident" id="6198136">pkga</span>&nbsp;<span class="op" id="6198141">!=</span>&nbsp;<span class="string" id="6198144">&#34;&#34;</span>&nbsp;<span class="op" id="6198147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198152">p</span><span class="op" id="6198153">.</span><span class="ident" id="6198154">PkgObj</span>&nbsp;<span class="op" id="6198161">=</span>&nbsp;<span class="ident" id="6198163">ctxt</span><span class="op" id="6198167">.</span><span class="ident" id="6198168">joinPath</span><span class="op" id="6198176">(</span><span class="ident" id="6198177">p</span><span class="op" id="6198178">.</span><span class="ident" id="6198179">Root</span><span class="op" id="6198183">,</span>&nbsp;<span class="ident" id="6198185">pkga</span><span class="op" id="6198189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198193">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198200">if</span>&nbsp;<span class="ident" id="6198203">mode</span><span class="op" id="6198207">&amp;</span><span class="ident" id="6198208">FindOnly</span>&nbsp;<span class="op" id="6198217">!=</span>&nbsp;<span class="num" id="6198220">0</span>&nbsp;<span class="op" id="6198222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198226">return</span>&nbsp;<span class="ident" id="6198233">p</span><span class="op" id="6198234">,</span>&nbsp;<span class="ident" id="6198236">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198244">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198247">if</span>&nbsp;<span class="ident" id="6198250">binaryOnly</span>&nbsp;<span class="op" id="6198261">&amp;&amp;</span>&nbsp;<span class="op" id="6198264">(</span><span class="ident" id="6198265">mode</span><span class="op" id="6198269">&amp;</span><span class="ident" id="6198270">AllowBinary</span><span class="op" id="6198281">)</span>&nbsp;<span class="op" id="6198283">!=</span>&nbsp;<span class="num" id="6198286">0</span>&nbsp;<span class="op" id="6198288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198292">return</span>&nbsp;<span class="ident" id="6198299">p</span><span class="op" id="6198300">,</span>&nbsp;<span class="ident" id="6198302">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198314">dirs</span><span class="op" id="6198318">,</span>&nbsp;<span class="ident" id="6198320">err</span>&nbsp;<span class="op" id="6198324">:=</span>&nbsp;<span class="ident" id="6198327">ctxt</span><span class="op" id="6198331">.</span><span class="ident" id="6198332">readDir</span><span class="op" id="6198339">(</span><span class="ident" id="6198340">p</span><span class="op" id="6198341">.</span><span class="ident" id="6198342">Dir</span><span class="op" id="6198345">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198348">if</span>&nbsp;<span class="ident" id="6198351">err</span>&nbsp;<span class="op" id="6198355">!=</span>&nbsp;<span class="ident" id="6198358">nil</span>&nbsp;<span class="op" id="6198362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198366">return</span>&nbsp;<span class="ident" id="6198373">p</span><span class="op" id="6198374">,</span>&nbsp;<span class="ident" id="6198376">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198385">var</span>&nbsp;<span class="ident" id="6198389">Sfiles</span>&nbsp;<span class="op" id="6198396">[</span><span class="op" id="6198397">]</span><span class="builtintype" id="6198398">string</span>&nbsp;<span class="comment" id="6198405">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198437">var</span>&nbsp;<span class="ident" id="6198441">firstFile</span><span class="op" id="6198450">,</span>&nbsp;<span class="ident" id="6198452">firstCommentFile</span>&nbsp;<span class="builtintype" id="6198469">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198477">imported</span>&nbsp;<span class="op" id="6198486">:=</span>&nbsp;<span class="builtinfunc" id="6198489">make</span><span class="op" id="6198493">(</span><span class="keyword" id="6198494">map</span><span class="op" id="6198497">[</span><span class="builtintype" id="6198498">string</span><span class="op" id="6198504">]</span><span class="op" id="6198505">[</span><span class="op" id="6198506">]</span><span class="ident" id="6198507">token</span><span class="op" id="6198512">.</span><span class="ident" id="6198513">Position</span><span class="op" id="6198521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198524">testImported</span>&nbsp;<span class="op" id="6198537">:=</span>&nbsp;<span class="builtinfunc" id="6198540">make</span><span class="op" id="6198544">(</span><span class="keyword" id="6198545">map</span><span class="op" id="6198548">[</span><span class="builtintype" id="6198549">string</span><span class="op" id="6198555">]</span><span class="op" id="6198556">[</span><span class="op" id="6198557">]</span><span class="ident" id="6198558">token</span><span class="op" id="6198563">.</span><span class="ident" id="6198564">Position</span><span class="op" id="6198572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198575">xTestImported</span>&nbsp;<span class="op" id="6198589">:=</span>&nbsp;<span class="builtinfunc" id="6198592">make</span><span class="op" id="6198596">(</span><span class="keyword" id="6198597">map</span><span class="op" id="6198600">[</span><span class="builtintype" id="6198601">string</span><span class="op" id="6198607">]</span><span class="op" id="6198608">[</span><span class="op" id="6198609">]</span><span class="ident" id="6198610">token</span><span class="op" id="6198615">.</span><span class="ident" id="6198616">Position</span><span class="op" id="6198624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198627">allTags</span>&nbsp;<span class="op" id="6198635">:=</span>&nbsp;<span class="builtinfunc" id="6198638">make</span><span class="op" id="6198642">(</span><span class="keyword" id="6198643">map</span><span class="op" id="6198646">[</span><span class="builtintype" id="6198647">string</span><span class="op" id="6198653">]</span><span class="builtintype" id="6198654">bool</span><span class="op" id="6198658">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198661">fset</span>&nbsp;<span class="op" id="6198666">:=</span>&nbsp;<span class="ident" id="6198669">token</span><span class="op" id="6198674">.</span><span class="ident" id="6198675">NewFileSet</span><span class="op" id="6198685">(</span><span class="op" id="6198686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198689">for</span>&nbsp;<span class="ident" id="6198693">_</span><span class="op" id="6198694">,</span>&nbsp;<span class="ident" id="6198696">d</span>&nbsp;<span class="op" id="6198698">:=</span>&nbsp;<span class="keyword" id="6198701">range</span>&nbsp;<span class="ident" id="6198707">dirs</span>&nbsp;<span class="op" id="6198712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198716">if</span>&nbsp;<span class="ident" id="6198719">d</span><span class="op" id="6198720">.</span><span class="ident" id="6198721">IsDir</span><span class="op" id="6198726">(</span><span class="op" id="6198727">)</span>&nbsp;<span class="op" id="6198729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198734">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198745">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198750">name</span>&nbsp;<span class="op" id="6198755">:=</span>&nbsp;<span class="ident" id="6198758">d</span><span class="op" id="6198759">.</span><span class="ident" id="6198760">Name</span><span class="op" id="6198764">(</span><span class="op" id="6198765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198769">ext</span>&nbsp;<span class="op" id="6198773">:=</span>&nbsp;<span class="ident" id="6198776">nameExt</span><span class="op" id="6198783">(</span><span class="ident" id="6198784">name</span><span class="op" id="6198788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198793">match</span><span class="op" id="6198798">,</span>&nbsp;<span class="ident" id="6198800">data</span><span class="op" id="6198804">,</span>&nbsp;<span class="ident" id="6198806">filename</span><span class="op" id="6198814">,</span>&nbsp;<span class="ident" id="6198816">err</span>&nbsp;<span class="op" id="6198820">:=</span>&nbsp;<span class="ident" id="6198823">ctxt</span><span class="op" id="6198827">.</span><span class="ident" id="6198828">matchFile</span><span class="op" id="6198837">(</span><span class="ident" id="6198838">p</span><span class="op" id="6198839">.</span><span class="ident" id="6198840">Dir</span><span class="op" id="6198843">,</span>&nbsp;<span class="ident" id="6198845">name</span><span class="op" id="6198849">,</span>&nbsp;<span class="builtintype" id="6198851">true</span><span class="op" id="6198855">,</span>&nbsp;<span class="ident" id="6198857">allTags</span><span class="op" id="6198864">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198868">if</span>&nbsp;<span class="ident" id="6198871">err</span>&nbsp;<span class="op" id="6198875">!=</span>&nbsp;<span class="ident" id="6198878">nil</span>&nbsp;<span class="op" id="6198882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198887">return</span>&nbsp;<span class="ident" id="6198894">p</span><span class="op" id="6198895">,</span>&nbsp;<span class="ident" id="6198897">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198907">if</span>&nbsp;<span class="op" id="6198910">!</span><span class="ident" id="6198911">match</span>&nbsp;<span class="op" id="6198917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198922">if</span>&nbsp;<span class="ident" id="6198925">ext</span>&nbsp;<span class="op" id="6198929">==</span>&nbsp;<span class="string" id="6198932">&#34;.go&#34;</span>&nbsp;<span class="op" id="6198938">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198944">p</span><span class="op" id="6198945">.</span><span class="ident" id="6198946">IgnoredGoFiles</span>&nbsp;<span class="op" id="6198961">=</span>&nbsp;<span class="builtinfunc" id="6198963">append</span><span class="op" id="6198969">(</span><span class="ident" id="6198970">p</span><span class="op" id="6198971">.</span><span class="ident" id="6198972">IgnoredGoFiles</span><span class="op" id="6198986">,</span>&nbsp;<span class="ident" id="6198988">name</span><span class="op" id="6198992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199002">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6199013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199018">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199081">switch</span>&nbsp;<span class="ident" id="6199088">ext</span>&nbsp;<span class="op" id="6199092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199096">case</span>&nbsp;<span class="string" id="6199101">&#34;.c&#34;</span><span class="op" id="6199105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199110">p</span><span class="op" id="6199111">.</span><span class="ident" id="6199112">CFiles</span>&nbsp;<span class="op" id="6199119">=</span>&nbsp;<span class="builtinfunc" id="6199121">append</span><span class="op" id="6199127">(</span><span class="ident" id="6199128">p</span><span class="op" id="6199129">.</span><span class="ident" id="6199130">CFiles</span><span class="op" id="6199136">,</span>&nbsp;<span class="ident" id="6199138">name</span><span class="op" id="6199142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199147">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199158">case</span>&nbsp;<span class="string" id="6199163">&#34;.cc&#34;</span><span class="op" id="6199168">,</span>&nbsp;<span class="string" id="6199170">&#34;.cpp&#34;</span><span class="op" id="6199176">,</span>&nbsp;<span class="string" id="6199178">&#34;.cxx&#34;</span><span class="op" id="6199184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199189">p</span><span class="op" id="6199190">.</span><span class="ident" id="6199191">CXXFiles</span>&nbsp;<span class="op" id="6199200">=</span>&nbsp;<span class="builtinfunc" id="6199202">append</span><span class="op" id="6199208">(</span><span class="ident" id="6199209">p</span><span class="op" id="6199210">.</span><span class="ident" id="6199211">CXXFiles</span><span class="op" id="6199219">,</span>&nbsp;<span class="ident" id="6199221">name</span><span class="op" id="6199225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199230">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199241">case</span>&nbsp;<span class="string" id="6199246">&#34;.m&#34;</span><span class="op" id="6199250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199255">p</span><span class="op" id="6199256">.</span><span class="ident" id="6199257">MFiles</span>&nbsp;<span class="op" id="6199264">=</span>&nbsp;<span class="builtinfunc" id="6199266">append</span><span class="op" id="6199272">(</span><span class="ident" id="6199273">p</span><span class="op" id="6199274">.</span><span class="ident" id="6199275">MFiles</span><span class="op" id="6199281">,</span>&nbsp;<span class="ident" id="6199283">name</span><span class="op" id="6199287">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199292">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199303">case</span>&nbsp;<span class="string" id="6199308">&#34;.h&#34;</span><span class="op" id="6199312">,</span>&nbsp;<span class="string" id="6199314">&#34;.hh&#34;</span><span class="op" id="6199319">,</span>&nbsp;<span class="string" id="6199321">&#34;.hpp&#34;</span><span class="op" id="6199327">,</span>&nbsp;<span class="string" id="6199329">&#34;.hxx&#34;</span><span class="op" id="6199335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199340">p</span><span class="op" id="6199341">.</span><span class="ident" id="6199342">HFiles</span>&nbsp;<span class="op" id="6199349">=</span>&nbsp;<span class="builtinfunc" id="6199351">append</span><span class="op" id="6199357">(</span><span class="ident" id="6199358">p</span><span class="op" id="6199359">.</span><span class="ident" id="6199360">HFiles</span><span class="op" id="6199366">,</span>&nbsp;<span class="ident" id="6199368">name</span><span class="op" id="6199372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199377">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199388">case</span>&nbsp;<span class="string" id="6199393">&#34;.s&#34;</span><span class="op" id="6199397">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199402">p</span><span class="op" id="6199403">.</span><span class="ident" id="6199404">SFiles</span>&nbsp;<span class="op" id="6199411">=</span>&nbsp;<span class="builtinfunc" id="6199413">append</span><span class="op" id="6199419">(</span><span class="ident" id="6199420">p</span><span class="op" id="6199421">.</span><span class="ident" id="6199422">SFiles</span><span class="op" id="6199428">,</span>&nbsp;<span class="ident" id="6199430">name</span><span class="op" id="6199434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199439">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199450">case</span>&nbsp;<span class="string" id="6199455">&#34;.S&#34;</span><span class="op" id="6199459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199464">Sfiles</span>&nbsp;<span class="op" id="6199471">=</span>&nbsp;<span class="builtinfunc" id="6199473">append</span><span class="op" id="6199479">(</span><span class="ident" id="6199480">Sfiles</span><span class="op" id="6199486">,</span>&nbsp;<span class="ident" id="6199488">name</span><span class="op" id="6199492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199497">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199508">case</span>&nbsp;<span class="string" id="6199513">&#34;.swig&#34;</span><span class="op" id="6199520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199525">p</span><span class="op" id="6199526">.</span><span class="ident" id="6199527">SwigFiles</span>&nbsp;<span class="op" id="6199537">=</span>&nbsp;<span class="builtinfunc" id="6199539">append</span><span class="op" id="6199545">(</span><span class="ident" id="6199546">p</span><span class="op" id="6199547">.</span><span class="ident" id="6199548">SwigFiles</span><span class="op" id="6199557">,</span>&nbsp;<span class="ident" id="6199559">name</span><span class="op" id="6199563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199568">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199579">case</span>&nbsp;<span class="string" id="6199584">&#34;.swigcxx&#34;</span><span class="op" id="6199594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199599">p</span><span class="op" id="6199600">.</span><span class="ident" id="6199601">SwigCXXFiles</span>&nbsp;<span class="op" id="6199614">=</span>&nbsp;<span class="builtinfunc" id="6199616">append</span><span class="op" id="6199622">(</span><span class="ident" id="6199623">p</span><span class="op" id="6199624">.</span><span class="ident" id="6199625">SwigCXXFiles</span><span class="op" id="6199637">,</span>&nbsp;<span class="ident" id="6199639">name</span><span class="op" id="6199643">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199648">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199659">case</span>&nbsp;<span class="string" id="6199664">&#34;.syso&#34;</span><span class="op" id="6199671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199676">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199723">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199770">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199823">p</span><span class="op" id="6199824">.</span><span class="ident" id="6199825">SysoFiles</span>&nbsp;<span class="op" id="6199835">=</span>&nbsp;<span class="builtinfunc" id="6199837">append</span><span class="op" id="6199843">(</span><span class="ident" id="6199844">p</span><span class="op" id="6199845">.</span><span class="ident" id="6199846">SysoFiles</span><span class="op" id="6199855">,</span>&nbsp;<span class="ident" id="6199857">name</span><span class="op" id="6199861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199866">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6199877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199882">pf</span><span class="op" id="6199884">,</span>&nbsp;<span class="ident" id="6199886">err</span>&nbsp;<span class="op" id="6199890">:=</span>&nbsp;<span class="ident" id="6199893">parser</span><span class="op" id="6199899">.</span><span class="ident" id="6199900">ParseFile</span><span class="op" id="6199909">(</span><span class="ident" id="6199910">fset</span><span class="op" id="6199914">,</span>&nbsp;<span class="ident" id="6199916">filename</span><span class="op" id="6199924">,</span>&nbsp;<span class="ident" id="6199926">data</span><span class="op" id="6199930">,</span>&nbsp;<span class="ident" id="6199932">parser</span><span class="op" id="6199938">.</span><span class="ident" id="6199939">ImportsOnly</span><span class="op" id="6199950">|</span><span class="ident" id="6199951">parser</span><span class="op" id="6199957">.</span><span class="ident" id="6199958">ParseComments</span><span class="op" id="6199971">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199975">if</span>&nbsp;<span class="ident" id="6199978">err</span>&nbsp;<span class="op" id="6199982">!=</span>&nbsp;<span class="ident" id="6199985">nil</span>&nbsp;<span class="op" id="6199989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199994">return</span>&nbsp;<span class="ident" id="6200001">p</span><span class="op" id="6200002">,</span>&nbsp;<span class="ident" id="6200004">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200015">pkg</span>&nbsp;<span class="op" id="6200019">:=</span>&nbsp;<span class="ident" id="6200022">pf</span><span class="op" id="6200024">.</span><span class="ident" id="6200025">Name</span><span class="op" id="6200029">.</span><span class="ident" id="6200030">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200037">if</span>&nbsp;<span class="ident" id="6200040">pkg</span>&nbsp;<span class="op" id="6200044">==</span>&nbsp;<span class="string" id="6200047">&#34;documentation&#34;</span>&nbsp;<span class="op" id="6200063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200068">p</span><span class="op" id="6200069">.</span><span class="ident" id="6200070">IgnoredGoFiles</span>&nbsp;<span class="op" id="6200085">=</span>&nbsp;<span class="builtinfunc" id="6200087">append</span><span class="op" id="6200093">(</span><span class="ident" id="6200094">p</span><span class="op" id="6200095">.</span><span class="ident" id="6200096">IgnoredGoFiles</span><span class="op" id="6200110">,</span>&nbsp;<span class="ident" id="6200112">name</span><span class="op" id="6200116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200121">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200137">isTest</span>&nbsp;<span class="op" id="6200144">:=</span>&nbsp;<span class="ident" id="6200147">strings</span><span class="op" id="6200154">.</span><span class="ident" id="6200155">HasSuffix</span><span class="op" id="6200164">(</span><span class="ident" id="6200165">name</span><span class="op" id="6200169">,</span>&nbsp;<span class="string" id="6200171">&#34;_test.go&#34;</span><span class="op" id="6200181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200185">isXTest</span>&nbsp;<span class="op" id="6200193">:=</span>&nbsp;<span class="builtintype" id="6200196">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200204">if</span>&nbsp;<span class="ident" id="6200207">isTest</span>&nbsp;<span class="op" id="6200214">&amp;&amp;</span>&nbsp;<span class="ident" id="6200217">strings</span><span class="op" id="6200224">.</span><span class="ident" id="6200225">HasSuffix</span><span class="op" id="6200234">(</span><span class="ident" id="6200235">pkg</span><span class="op" id="6200238">,</span>&nbsp;<span class="string" id="6200240">&#34;_test&#34;</span><span class="op" id="6200247">)</span>&nbsp;<span class="op" id="6200249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200254">isXTest</span>&nbsp;<span class="op" id="6200262">=</span>&nbsp;<span class="builtintype" id="6200264">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200272">pkg</span>&nbsp;<span class="op" id="6200276">=</span>&nbsp;<span class="ident" id="6200278">pkg</span><span class="op" id="6200281">[</span><span class="op" id="6200282">:</span><span class="builtinfunc" id="6200283">len</span><span class="op" id="6200286">(</span><span class="ident" id="6200287">pkg</span><span class="op" id="6200290">)</span><span class="op" id="6200291">-</span><span class="builtinfunc" id="6200292">len</span><span class="op" id="6200295">(</span><span class="string" id="6200296">&#34;_test&#34;</span><span class="op" id="6200303">)</span><span class="op" id="6200304">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200313">if</span>&nbsp;<span class="ident" id="6200316">p</span><span class="op" id="6200317">.</span><span class="ident" id="6200318">Name</span>&nbsp;<span class="op" id="6200323">==</span>&nbsp;<span class="string" id="6200326">&#34;&#34;</span>&nbsp;<span class="op" id="6200329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200334">p</span><span class="op" id="6200335">.</span><span class="ident" id="6200336">Name</span>&nbsp;<span class="op" id="6200341">=</span>&nbsp;<span class="ident" id="6200343">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200350">firstFile</span>&nbsp;<span class="op" id="6200360">=</span>&nbsp;<span class="ident" id="6200362">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200369">}</span>&nbsp;<span class="keyword" id="6200371">else</span>&nbsp;<span class="keyword" id="6200376">if</span>&nbsp;<span class="ident" id="6200379">pkg</span>&nbsp;<span class="op" id="6200383">!=</span>&nbsp;<span class="ident" id="6200386">p</span><span class="op" id="6200387">.</span><span class="ident" id="6200388">Name</span>&nbsp;<span class="op" id="6200393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200398">return</span>&nbsp;<span class="ident" id="6200405">p</span><span class="op" id="6200406">,</span>&nbsp;<span class="op" id="6200408">&amp;</span><span class="ident" id="6200409">MultiplePackageError</span><span class="op" id="6200429">{</span><span class="ident" id="6200430">p</span><span class="op" id="6200431">.</span><span class="ident" id="6200432">Dir</span><span class="op" id="6200435">,</span>&nbsp;<span class="op" id="6200437">[</span><span class="op" id="6200438">]</span><span class="builtintype" id="6200439">string</span><span class="op" id="6200445">{</span><span class="ident" id="6200446">firstFile</span><span class="op" id="6200455">,</span>&nbsp;<span class="ident" id="6200457">name</span><span class="op" id="6200461">}</span><span class="op" id="6200462">,</span>&nbsp;<span class="op" id="6200464">[</span><span class="op" id="6200465">]</span><span class="builtintype" id="6200466">string</span><span class="op" id="6200472">{</span><span class="ident" id="6200473">p</span><span class="op" id="6200474">.</span><span class="ident" id="6200475">Name</span><span class="op" id="6200479">,</span>&nbsp;<span class="ident" id="6200481">pkg</span><span class="op" id="6200484">}</span><span class="op" id="6200485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200493">if</span>&nbsp;<span class="ident" id="6200496">pf</span><span class="op" id="6200498">.</span><span class="ident" id="6200499">Doc</span>&nbsp;<span class="op" id="6200503">!=</span>&nbsp;<span class="ident" id="6200506">nil</span>&nbsp;<span class="op" id="6200510">&amp;&amp;</span>&nbsp;<span class="ident" id="6200513">p</span><span class="op" id="6200514">.</span><span class="ident" id="6200515">Doc</span>&nbsp;<span class="op" id="6200519">==</span>&nbsp;<span class="string" id="6200522">&#34;&#34;</span>&nbsp;<span class="op" id="6200525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200530">p</span><span class="op" id="6200531">.</span><span class="ident" id="6200532">Doc</span>&nbsp;<span class="op" id="6200536">=</span>&nbsp;<span class="ident" id="6200538">doc</span><span class="op" id="6200541">.</span><span class="ident" id="6200542">Synopsis</span><span class="op" id="6200550">(</span><span class="ident" id="6200551">pf</span><span class="op" id="6200553">.</span><span class="ident" id="6200554">Doc</span><span class="op" id="6200557">.</span><span class="ident" id="6200558">Text</span><span class="op" id="6200562">(</span><span class="op" id="6200563">)</span><span class="op" id="6200564">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200573">if</span>&nbsp;<span class="ident" id="6200576">mode</span><span class="op" id="6200580">&amp;</span><span class="ident" id="6200581">ImportComment</span>&nbsp;<span class="op" id="6200595">!=</span>&nbsp;<span class="num" id="6200598">0</span>&nbsp;<span class="op" id="6200600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200605">qcom</span><span class="op" id="6200609">,</span>&nbsp;<span class="ident" id="6200611">line</span>&nbsp;<span class="op" id="6200616">:=</span>&nbsp;<span class="ident" id="6200619">findImportComment</span><span class="op" id="6200636">(</span><span class="ident" id="6200637">data</span><span class="op" id="6200641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200646">if</span>&nbsp;<span class="ident" id="6200649">line</span>&nbsp;<span class="op" id="6200654">!=</span>&nbsp;<span class="num" id="6200657">0</span>&nbsp;<span class="op" id="6200659">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200665">com</span><span class="op" id="6200668">,</span>&nbsp;<span class="ident" id="6200670">err</span>&nbsp;<span class="op" id="6200674">:=</span>&nbsp;<span class="ident" id="6200677">strconv</span><span class="op" id="6200684">.</span><span class="ident" id="6200685">Unquote</span><span class="op" id="6200692">(</span><span class="ident" id="6200693">qcom</span><span class="op" id="6200697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200703">if</span>&nbsp;<span class="ident" id="6200706">err</span>&nbsp;<span class="op" id="6200710">!=</span>&nbsp;<span class="ident" id="6200713">nil</span>&nbsp;<span class="op" id="6200717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200724">return</span>&nbsp;<span class="ident" id="6200731">p</span><span class="op" id="6200732">,</span>&nbsp;<span class="ident" id="6200734">fmt</span><span class="op" id="6200737">.</span><span class="ident" id="6200738">Errorf</span><span class="op" id="6200744">(</span><span class="string" id="6200745">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="6200781">,</span>&nbsp;<span class="ident" id="6200783">filename</span><span class="op" id="6200791">,</span>&nbsp;<span class="ident" id="6200793">line</span><span class="op" id="6200797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200809">if</span>&nbsp;<span class="ident" id="6200812">p</span><span class="op" id="6200813">.</span><span class="ident" id="6200814">ImportComment</span>&nbsp;<span class="op" id="6200828">==</span>&nbsp;<span class="string" id="6200831">&#34;&#34;</span>&nbsp;<span class="op" id="6200834">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200841">p</span><span class="op" id="6200842">.</span><span class="ident" id="6200843">ImportComment</span>&nbsp;<span class="op" id="6200857">=</span>&nbsp;<span class="ident" id="6200859">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200868">firstCommentFile</span>&nbsp;<span class="op" id="6200885">=</span>&nbsp;<span class="ident" id="6200887">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200896">}</span>&nbsp;<span class="keyword" id="6200898">else</span>&nbsp;<span class="keyword" id="6200903">if</span>&nbsp;<span class="ident" id="6200906">p</span><span class="op" id="6200907">.</span><span class="ident" id="6200908">ImportComment</span>&nbsp;<span class="op" id="6200922">!=</span>&nbsp;<span class="ident" id="6200925">com</span>&nbsp;<span class="op" id="6200929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200936">return</span>&nbsp;<span class="ident" id="6200943">p</span><span class="op" id="6200944">,</span>&nbsp;<span class="ident" id="6200946">fmt</span><span class="op" id="6200949">.</span><span class="ident" id="6200950">Errorf</span><span class="op" id="6200956">(</span><span class="string" id="6200957">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6201006">,</span>&nbsp;<span class="ident" id="6201008">p</span><span class="op" id="6201009">.</span><span class="ident" id="6201010">ImportComment</span><span class="op" id="6201023">,</span>&nbsp;<span class="ident" id="6201025">firstCommentFile</span><span class="op" id="6201041">,</span>&nbsp;<span class="ident" id="6201043">com</span><span class="op" id="6201046">,</span>&nbsp;<span class="ident" id="6201048">name</span><span class="op" id="6201052">,</span>&nbsp;<span class="ident" id="6201054">p</span><span class="op" id="6201055">.</span><span class="ident" id="6201056">Dir</span><span class="op" id="6201059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201065">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201079">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201126">isCgo</span>&nbsp;<span class="op" id="6201132">:=</span>&nbsp;<span class="builtintype" id="6201135">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201143">for</span>&nbsp;<span class="ident" id="6201147">_</span><span class="op" id="6201148">,</span>&nbsp;<span class="ident" id="6201150">decl</span>&nbsp;<span class="op" id="6201155">:=</span>&nbsp;<span class="keyword" id="6201158">range</span>&nbsp;<span class="ident" id="6201164">pf</span><span class="op" id="6201166">.</span><span class="ident" id="6201167">Decls</span>&nbsp;<span class="op" id="6201173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201178">d</span><span class="op" id="6201179">,</span>&nbsp;<span class="ident" id="6201181">ok</span>&nbsp;<span class="op" id="6201184">:=</span>&nbsp;<span class="ident" id="6201187">decl</span><span class="op" id="6201191">.</span><span class="op" id="6201192">(</span><span class="op" id="6201193">*</span><span class="ident" id="6201194">ast</span><span class="op" id="6201197">.</span><span class="ident" id="6201198">GenDecl</span><span class="op" id="6201205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201210">if</span>&nbsp;<span class="op" id="6201213">!</span><span class="ident" id="6201214">ok</span>&nbsp;<span class="op" id="6201217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201223">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201235">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201240">for</span>&nbsp;<span class="ident" id="6201244">_</span><span class="op" id="6201245">,</span>&nbsp;<span class="ident" id="6201247">dspec</span>&nbsp;<span class="op" id="6201253">:=</span>&nbsp;<span class="keyword" id="6201256">range</span>&nbsp;<span class="ident" id="6201262">d</span><span class="op" id="6201263">.</span><span class="ident" id="6201264">Specs</span>&nbsp;<span class="op" id="6201270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201276">spec</span><span class="op" id="6201280">,</span>&nbsp;<span class="ident" id="6201282">ok</span>&nbsp;<span class="op" id="6201285">:=</span>&nbsp;<span class="ident" id="6201288">dspec</span><span class="op" id="6201293">.</span><span class="op" id="6201294">(</span><span class="op" id="6201295">*</span><span class="ident" id="6201296">ast</span><span class="op" id="6201299">.</span><span class="ident" id="6201300">ImportSpec</span><span class="op" id="6201310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201316">if</span>&nbsp;<span class="op" id="6201319">!</span><span class="ident" id="6201320">ok</span>&nbsp;<span class="op" id="6201323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201330">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201343">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201349">quoted</span>&nbsp;<span class="op" id="6201356">:=</span>&nbsp;<span class="ident" id="6201359">spec</span><span class="op" id="6201363">.</span><span class="ident" id="6201364">Path</span><span class="op" id="6201368">.</span><span class="ident" id="6201369">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201379">path</span><span class="op" id="6201383">,</span>&nbsp;<span class="ident" id="6201385">err</span>&nbsp;<span class="op" id="6201389">:=</span>&nbsp;<span class="ident" id="6201392">strconv</span><span class="op" id="6201399">.</span><span class="ident" id="6201400">Unquote</span><span class="op" id="6201407">(</span><span class="ident" id="6201408">quoted</span><span class="op" id="6201414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201420">if</span>&nbsp;<span class="ident" id="6201423">err</span>&nbsp;<span class="op" id="6201427">!=</span>&nbsp;<span class="ident" id="6201430">nil</span>&nbsp;<span class="op" id="6201434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201441">log</span><span class="op" id="6201444">.</span><span class="ident" id="6201445">Panicf</span><span class="op" id="6201451">(</span><span class="string" id="6201452">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6201501">,</span>&nbsp;<span class="ident" id="6201503">filename</span><span class="op" id="6201511">,</span>&nbsp;<span class="ident" id="6201513">quoted</span><span class="op" id="6201519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201525">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201531">if</span>&nbsp;<span class="ident" id="6201534">isXTest</span>&nbsp;<span class="op" id="6201542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201549">xTestImported</span><span class="op" id="6201562">[</span><span class="ident" id="6201563">path</span><span class="op" id="6201567">]</span>&nbsp;<span class="op" id="6201569">=</span>&nbsp;<span class="builtinfunc" id="6201571">append</span><span class="op" id="6201577">(</span><span class="ident" id="6201578">xTestImported</span><span class="op" id="6201591">[</span><span class="ident" id="6201592">path</span><span class="op" id="6201596">]</span><span class="op" id="6201597">,</span>&nbsp;<span class="ident" id="6201599">fset</span><span class="op" id="6201603">.</span><span class="ident" id="6201604">Position</span><span class="op" id="6201612">(</span><span class="ident" id="6201613">spec</span><span class="op" id="6201617">.</span><span class="ident" id="6201618">Pos</span><span class="op" id="6201621">(</span><span class="op" id="6201622">)</span><span class="op" id="6201623">)</span><span class="op" id="6201624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201630">}</span>&nbsp;<span class="keyword" id="6201632">else</span>&nbsp;<span class="keyword" id="6201637">if</span>&nbsp;<span class="ident" id="6201640">isTest</span>&nbsp;<span class="op" id="6201647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201654">testImported</span><span class="op" id="6201666">[</span><span class="ident" id="6201667">path</span><span class="op" id="6201671">]</span>&nbsp;<span class="op" id="6201673">=</span>&nbsp;<span class="builtinfunc" id="6201675">append</span><span class="op" id="6201681">(</span><span class="ident" id="6201682">testImported</span><span class="op" id="6201694">[</span><span class="ident" id="6201695">path</span><span class="op" id="6201699">]</span><span class="op" id="6201700">,</span>&nbsp;<span class="ident" id="6201702">fset</span><span class="op" id="6201706">.</span><span class="ident" id="6201707">Position</span><span class="op" id="6201715">(</span><span class="ident" id="6201716">spec</span><span class="op" id="6201720">.</span><span class="ident" id="6201721">Pos</span><span class="op" id="6201724">(</span><span class="op" id="6201725">)</span><span class="op" id="6201726">)</span><span class="op" id="6201727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201733">}</span>&nbsp;<span class="keyword" id="6201735">else</span>&nbsp;<span class="op" id="6201740">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201747">imported</span><span class="op" id="6201755">[</span><span class="ident" id="6201756">path</span><span class="op" id="6201760">]</span>&nbsp;<span class="op" id="6201762">=</span>&nbsp;<span class="builtinfunc" id="6201764">append</span><span class="op" id="6201770">(</span><span class="ident" id="6201771">imported</span><span class="op" id="6201779">[</span><span class="ident" id="6201780">path</span><span class="op" id="6201784">]</span><span class="op" id="6201785">,</span>&nbsp;<span class="ident" id="6201787">fset</span><span class="op" id="6201791">.</span><span class="ident" id="6201792">Position</span><span class="op" id="6201800">(</span><span class="ident" id="6201801">spec</span><span class="op" id="6201805">.</span><span class="ident" id="6201806">Pos</span><span class="op" id="6201809">(</span><span class="op" id="6201810">)</span><span class="op" id="6201811">)</span><span class="op" id="6201812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201824">if</span>&nbsp;<span class="ident" id="6201827">path</span>&nbsp;<span class="op" id="6201832">==</span>&nbsp;<span class="string" id="6201835">&#34;C&#34;</span>&nbsp;<span class="op" id="6201839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201846">if</span>&nbsp;<span class="ident" id="6201849">isTest</span>&nbsp;<span class="op" id="6201856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201864">return</span>&nbsp;<span class="ident" id="6201871">p</span><span class="op" id="6201872">,</span>&nbsp;<span class="ident" id="6201874">fmt</span><span class="op" id="6201877">.</span><span class="ident" id="6201878">Errorf</span><span class="op" id="6201884">(</span><span class="string" id="6201885">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6201922">,</span>&nbsp;<span class="ident" id="6201924">filename</span><span class="op" id="6201932">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201946">cg</span>&nbsp;<span class="op" id="6201949">:=</span>&nbsp;<span class="ident" id="6201952">spec</span><span class="op" id="6201956">.</span><span class="ident" id="6201957">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201966">if</span>&nbsp;<span class="ident" id="6201969">cg</span>&nbsp;<span class="op" id="6201972">==</span>&nbsp;<span class="ident" id="6201975">nil</span>&nbsp;<span class="op" id="6201979">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6201982">len</span><span class="op" id="6201985">(</span><span class="ident" id="6201986">d</span><span class="op" id="6201987">.</span><span class="ident" id="6201988">Specs</span><span class="op" id="6201993">)</span>&nbsp;<span class="op" id="6201995">==</span>&nbsp;<span class="num" id="6201998">1</span>&nbsp;<span class="op" id="6202000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202008">cg</span>&nbsp;<span class="op" id="6202011">=</span>&nbsp;<span class="ident" id="6202013">d</span><span class="op" id="6202014">.</span><span class="ident" id="6202015">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202024">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202031">if</span>&nbsp;<span class="ident" id="6202034">cg</span>&nbsp;<span class="op" id="6202037">!=</span>&nbsp;<span class="ident" id="6202040">nil</span>&nbsp;<span class="op" id="6202044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202052">if</span>&nbsp;<span class="ident" id="6202055">err</span>&nbsp;<span class="op" id="6202059">:=</span>&nbsp;<span class="ident" id="6202062">ctxt</span><span class="op" id="6202066">.</span><span class="ident" id="6202067">saveCgo</span><span class="op" id="6202074">(</span><span class="ident" id="6202075">filename</span><span class="op" id="6202083">,</span>&nbsp;<span class="ident" id="6202085">p</span><span class="op" id="6202086">,</span>&nbsp;<span class="ident" id="6202088">cg</span><span class="op" id="6202090">)</span><span class="op" id="6202091">;</span>&nbsp;<span class="ident" id="6202093">err</span>&nbsp;<span class="op" id="6202097">!=</span>&nbsp;<span class="ident" id="6202100">nil</span>&nbsp;<span class="op" id="6202104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202113">return</span>&nbsp;<span class="ident" id="6202120">p</span><span class="op" id="6202121">,</span>&nbsp;<span class="ident" id="6202123">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202140">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202147">isCgo</span>&nbsp;<span class="op" id="6202153">=</span>&nbsp;<span class="builtintype" id="6202155">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202177">if</span>&nbsp;<span class="ident" id="6202180">isCgo</span>&nbsp;<span class="op" id="6202186">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202191">allTags</span><span class="op" id="6202198">[</span><span class="string" id="6202199">&#34;cgo&#34;</span><span class="op" id="6202204">]</span>&nbsp;<span class="op" id="6202206">=</span>&nbsp;<span class="builtintype" id="6202208">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202216">if</span>&nbsp;<span class="ident" id="6202219">ctxt</span><span class="op" id="6202223">.</span><span class="ident" id="6202224">CgoEnabled</span>&nbsp;<span class="op" id="6202235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202241">p</span><span class="op" id="6202242">.</span><span class="ident" id="6202243">CgoFiles</span>&nbsp;<span class="op" id="6202252">=</span>&nbsp;<span class="builtinfunc" id="6202254">append</span><span class="op" id="6202260">(</span><span class="ident" id="6202261">p</span><span class="op" id="6202262">.</span><span class="ident" id="6202263">CgoFiles</span><span class="op" id="6202271">,</span>&nbsp;<span class="ident" id="6202273">name</span><span class="op" id="6202277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202282">}</span>&nbsp;<span class="keyword" id="6202284">else</span>&nbsp;<span class="op" id="6202289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202295">p</span><span class="op" id="6202296">.</span><span class="ident" id="6202297">IgnoredGoFiles</span>&nbsp;<span class="op" id="6202312">=</span>&nbsp;<span class="builtinfunc" id="6202314">append</span><span class="op" id="6202320">(</span><span class="ident" id="6202321">p</span><span class="op" id="6202322">.</span><span class="ident" id="6202323">IgnoredGoFiles</span><span class="op" id="6202337">,</span>&nbsp;<span class="ident" id="6202339">name</span><span class="op" id="6202343">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202352">}</span>&nbsp;<span class="keyword" id="6202354">else</span>&nbsp;<span class="keyword" id="6202359">if</span>&nbsp;<span class="ident" id="6202362">isXTest</span>&nbsp;<span class="op" id="6202370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202375">p</span><span class="op" id="6202376">.</span><span class="ident" id="6202377">XTestGoFiles</span>&nbsp;<span class="op" id="6202390">=</span>&nbsp;<span class="builtinfunc" id="6202392">append</span><span class="op" id="6202398">(</span><span class="ident" id="6202399">p</span><span class="op" id="6202400">.</span><span class="ident" id="6202401">XTestGoFiles</span><span class="op" id="6202413">,</span>&nbsp;<span class="ident" id="6202415">name</span><span class="op" id="6202419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202423">}</span>&nbsp;<span class="keyword" id="6202425">else</span>&nbsp;<span class="keyword" id="6202430">if</span>&nbsp;<span class="ident" id="6202433">isTest</span>&nbsp;<span class="op" id="6202440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202445">p</span><span class="op" id="6202446">.</span><span class="ident" id="6202447">TestGoFiles</span>&nbsp;<span class="op" id="6202459">=</span>&nbsp;<span class="builtinfunc" id="6202461">append</span><span class="op" id="6202467">(</span><span class="ident" id="6202468">p</span><span class="op" id="6202469">.</span><span class="ident" id="6202470">TestGoFiles</span><span class="op" id="6202481">,</span>&nbsp;<span class="ident" id="6202483">name</span><span class="op" id="6202487">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202491">}</span>&nbsp;<span class="keyword" id="6202493">else</span>&nbsp;<span class="op" id="6202498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202503">p</span><span class="op" id="6202504">.</span><span class="ident" id="6202505">GoFiles</span>&nbsp;<span class="op" id="6202513">=</span>&nbsp;<span class="builtinfunc" id="6202515">append</span><span class="op" id="6202521">(</span><span class="ident" id="6202522">p</span><span class="op" id="6202523">.</span><span class="ident" id="6202524">GoFiles</span><span class="op" id="6202531">,</span>&nbsp;<span class="ident" id="6202533">name</span><span class="op" id="6202537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202547">if</span>&nbsp;<span class="builtinfunc" id="6202550">len</span><span class="op" id="6202553">(</span><span class="ident" id="6202554">p</span><span class="op" id="6202555">.</span><span class="ident" id="6202556">GoFiles</span><span class="op" id="6202563">)</span><span class="op" id="6202564">+</span><span class="builtinfunc" id="6202565">len</span><span class="op" id="6202568">(</span><span class="ident" id="6202569">p</span><span class="op" id="6202570">.</span><span class="ident" id="6202571">CgoFiles</span><span class="op" id="6202579">)</span><span class="op" id="6202580">+</span><span class="builtinfunc" id="6202581">len</span><span class="op" id="6202584">(</span><span class="ident" id="6202585">p</span><span class="op" id="6202586">.</span><span class="ident" id="6202587">TestGoFiles</span><span class="op" id="6202598">)</span><span class="op" id="6202599">+</span><span class="builtinfunc" id="6202600">len</span><span class="op" id="6202603">(</span><span class="ident" id="6202604">p</span><span class="op" id="6202605">.</span><span class="ident" id="6202606">XTestGoFiles</span><span class="op" id="6202618">)</span>&nbsp;<span class="op" id="6202620">==</span>&nbsp;<span class="num" id="6202623">0</span>&nbsp;<span class="op" id="6202625">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202629">return</span>&nbsp;<span class="ident" id="6202636">p</span><span class="op" id="6202637">,</span>&nbsp;<span class="op" id="6202639">&amp;</span><span class="ident" id="6202640">NoGoError</span><span class="op" id="6202649">{</span><span class="ident" id="6202650">p</span><span class="op" id="6202651">.</span><span class="ident" id="6202652">Dir</span><span class="op" id="6202655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202662">for</span>&nbsp;<span class="ident" id="6202666">tag</span>&nbsp;<span class="op" id="6202670">:=</span>&nbsp;<span class="keyword" id="6202673">range</span>&nbsp;<span class="ident" id="6202679">allTags</span>&nbsp;<span class="op" id="6202687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202691">p</span><span class="op" id="6202692">.</span><span class="ident" id="6202693">AllTags</span>&nbsp;<span class="op" id="6202701">=</span>&nbsp;<span class="builtinfunc" id="6202703">append</span><span class="op" id="6202709">(</span><span class="ident" id="6202710">p</span><span class="op" id="6202711">.</span><span class="ident" id="6202712">AllTags</span><span class="op" id="6202719">,</span>&nbsp;<span class="ident" id="6202721">tag</span><span class="op" id="6202724">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202730">sort</span><span class="op" id="6202734">.</span><span class="ident" id="6202735">Strings</span><span class="op" id="6202742">(</span><span class="ident" id="6202743">p</span><span class="op" id="6202744">.</span><span class="ident" id="6202745">AllTags</span><span class="op" id="6202752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202756">p</span><span class="op" id="6202757">.</span><span class="ident" id="6202758">Imports</span><span class="op" id="6202765">,</span>&nbsp;<span class="ident" id="6202767">p</span><span class="op" id="6202768">.</span><span class="ident" id="6202769">ImportPos</span>&nbsp;<span class="op" id="6202779">=</span>&nbsp;<span class="ident" id="6202781">cleanImports</span><span class="op" id="6202793">(</span><span class="ident" id="6202794">imported</span><span class="op" id="6202802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202805">p</span><span class="op" id="6202806">.</span><span class="ident" id="6202807">TestImports</span><span class="op" id="6202818">,</span>&nbsp;<span class="ident" id="6202820">p</span><span class="op" id="6202821">.</span><span class="ident" id="6202822">TestImportPos</span>&nbsp;<span class="op" id="6202836">=</span>&nbsp;<span class="ident" id="6202838">cleanImports</span><span class="op" id="6202850">(</span><span class="ident" id="6202851">testImported</span><span class="op" id="6202863">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202866">p</span><span class="op" id="6202867">.</span><span class="ident" id="6202868">XTestImports</span><span class="op" id="6202880">,</span>&nbsp;<span class="ident" id="6202882">p</span><span class="op" id="6202883">.</span><span class="ident" id="6202884">XTestImportPos</span>&nbsp;<span class="op" id="6202899">=</span>&nbsp;<span class="ident" id="6202901">cleanImports</span><span class="op" id="6202913">(</span><span class="ident" id="6202914">xTestImported</span><span class="op" id="6202927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202931">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202977">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203018">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203063">if</span>&nbsp;<span class="builtinfunc" id="6203066">len</span><span class="op" id="6203069">(</span><span class="ident" id="6203070">p</span><span class="op" id="6203071">.</span><span class="ident" id="6203072">CgoFiles</span><span class="op" id="6203080">)</span>&nbsp;<span class="op" id="6203082">&gt;</span>&nbsp;<span class="num" id="6203084">0</span>&nbsp;<span class="op" id="6203086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203090">p</span><span class="op" id="6203091">.</span><span class="ident" id="6203092">SFiles</span>&nbsp;<span class="op" id="6203099">=</span>&nbsp;<span class="builtinfunc" id="6203101">append</span><span class="op" id="6203107">(</span><span class="ident" id="6203108">p</span><span class="op" id="6203109">.</span><span class="ident" id="6203110">SFiles</span><span class="op" id="6203116">,</span>&nbsp;<span class="ident" id="6203118">Sfiles</span><span class="op" id="6203124">...</span><span class="op" id="6203127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203131">sort</span><span class="op" id="6203135">.</span><span class="ident" id="6203136">Strings</span><span class="op" id="6203143">(</span><span class="ident" id="6203144">p</span><span class="op" id="6203145">.</span><span class="ident" id="6203146">SFiles</span><span class="op" id="6203152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203159">return</span>&nbsp;<span class="ident" id="6203166">p</span><span class="op" id="6203167">,</span>&nbsp;<span class="ident" id="6203169">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="6203176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6203179">func</span>&nbsp;<span class="ident" id="6203184">findImportComment</span><span class="op" id="6203201">(</span><span class="ident" id="6203202">data</span>&nbsp;<span class="op" id="6203207">[</span><span class="op" id="6203208">]</span><span class="builtintype" id="6203209">byte</span><span class="op" id="6203213">)</span>&nbsp;<span class="op" id="6203215">(</span><span class="ident" id="6203216">s</span>&nbsp;<span class="builtintype" id="6203218">string</span><span class="op" id="6203224">,</span>&nbsp;<span class="ident" id="6203226">line</span>&nbsp;<span class="builtintype" id="6203231">int</span><span class="op" id="6203234">)</span>&nbsp;<span class="op" id="6203236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203239">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203266">word</span><span class="op" id="6203270">,</span>&nbsp;<span class="ident" id="6203272">data</span>&nbsp;<span class="op" id="6203277">:=</span>&nbsp;<span class="ident" id="6203280">parseWord</span><span class="op" id="6203289">(</span><span class="ident" id="6203290">data</span><span class="op" id="6203294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203297">if</span>&nbsp;<span class="builtintype" id="6203300">string</span><span class="op" id="6203306">(</span><span class="ident" id="6203307">word</span><span class="op" id="6203311">)</span>&nbsp;<span class="op" id="6203313">!=</span>&nbsp;<span class="string" id="6203316">&#34;package&#34;</span>&nbsp;<span class="op" id="6203326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203330">return</span>&nbsp;<span class="string" id="6203337">&#34;&#34;</span><span class="op" id="6203339">,</span>&nbsp;<span class="num" id="6203341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203348">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203372">_</span><span class="op" id="6203373">,</span>&nbsp;<span class="ident" id="6203375">data</span>&nbsp;<span class="op" id="6203380">=</span>&nbsp;<span class="ident" id="6203382">parseWord</span><span class="op" id="6203391">(</span><span class="ident" id="6203392">data</span><span class="op" id="6203396">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203400">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203456">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203502">for</span>&nbsp;<span class="builtinfunc" id="6203506">len</span><span class="op" id="6203509">(</span><span class="ident" id="6203510">data</span><span class="op" id="6203514">)</span>&nbsp;<span class="op" id="6203516">&gt;</span>&nbsp;<span class="num" id="6203518">0</span>&nbsp;<span class="op" id="6203520">&amp;&amp;</span>&nbsp;<span class="op" id="6203523">(</span><span class="ident" id="6203524">data</span><span class="op" id="6203528">[</span><span class="num" id="6203529">0</span><span class="op" id="6203530">]</span>&nbsp;<span class="op" id="6203532">==</span>&nbsp;<span class="string" id="6203535">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6203539">||</span>&nbsp;<span class="ident" id="6203542">data</span><span class="op" id="6203546">[</span><span class="num" id="6203547">0</span><span class="op" id="6203548">]</span>&nbsp;<span class="op" id="6203550">==</span>&nbsp;<span class="string" id="6203553">&#39;\t&#39;</span>&nbsp;<span class="op" id="6203558">||</span>&nbsp;<span class="ident" id="6203561">data</span><span class="op" id="6203565">[</span><span class="num" id="6203566">0</span><span class="op" id="6203567">]</span>&nbsp;<span class="op" id="6203569">==</span>&nbsp;<span class="string" id="6203572">&#39;\r&#39;</span><span class="op" id="6203576">)</span>&nbsp;<span class="op" id="6203578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203582">data</span>&nbsp;<span class="op" id="6203587">=</span>&nbsp;<span class="ident" id="6203589">data</span><span class="op" id="6203593">[</span><span class="num" id="6203594">1</span><span class="op" id="6203595">:</span><span class="op" id="6203596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203603">var</span>&nbsp;<span class="ident" id="6203607">comment</span>&nbsp;<span class="op" id="6203615">[</span><span class="op" id="6203616">]</span><span class="builtintype" id="6203617">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203623">switch</span>&nbsp;<span class="op" id="6203630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203633">case</span>&nbsp;<span class="ident" id="6203638">bytes</span><span class="op" id="6203643">.</span><span class="ident" id="6203644">HasPrefix</span><span class="op" id="6203653">(</span><span class="ident" id="6203654">data</span><span class="op" id="6203658">,</span>&nbsp;<span class="ident" id="6203660">slashSlash</span><span class="op" id="6203670">)</span><span class="op" id="6203671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203675">i</span>&nbsp;<span class="op" id="6203677">:=</span>&nbsp;<span class="ident" id="6203680">bytes</span><span class="op" id="6203685">.</span><span class="ident" id="6203686">Index</span><span class="op" id="6203691">(</span><span class="ident" id="6203692">data</span><span class="op" id="6203696">,</span>&nbsp;<span class="ident" id="6203698">newline</span><span class="op" id="6203705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203709">if</span>&nbsp;<span class="ident" id="6203712">i</span>&nbsp;<span class="op" id="6203714">&lt;</span>&nbsp;<span class="num" id="6203716">0</span>&nbsp;<span class="op" id="6203718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203723">i</span>&nbsp;<span class="op" id="6203725">=</span>&nbsp;<span class="builtinfunc" id="6203727">len</span><span class="op" id="6203730">(</span><span class="ident" id="6203731">data</span><span class="op" id="6203735">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203743">comment</span>&nbsp;<span class="op" id="6203751">=</span>&nbsp;<span class="ident" id="6203753">data</span><span class="op" id="6203757">[</span><span class="num" id="6203758">2</span><span class="op" id="6203759">:</span><span class="ident" id="6203760">i</span><span class="op" id="6203761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203764">case</span>&nbsp;<span class="ident" id="6203769">bytes</span><span class="op" id="6203774">.</span><span class="ident" id="6203775">HasPrefix</span><span class="op" id="6203784">(</span><span class="ident" id="6203785">data</span><span class="op" id="6203789">,</span>&nbsp;<span class="ident" id="6203791">slashStar</span><span class="op" id="6203800">)</span><span class="op" id="6203801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203805">data</span>&nbsp;<span class="op" id="6203810">=</span>&nbsp;<span class="ident" id="6203812">data</span><span class="op" id="6203816">[</span><span class="num" id="6203817">2</span><span class="op" id="6203818">:</span><span class="op" id="6203819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203823">i</span>&nbsp;<span class="op" id="6203825">:=</span>&nbsp;<span class="ident" id="6203828">bytes</span><span class="op" id="6203833">.</span><span class="ident" id="6203834">Index</span><span class="op" id="6203839">(</span><span class="ident" id="6203840">data</span><span class="op" id="6203844">,</span>&nbsp;<span class="ident" id="6203846">starSlash</span><span class="op" id="6203855">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203859">if</span>&nbsp;<span class="ident" id="6203862">i</span>&nbsp;<span class="op" id="6203864">&lt;</span>&nbsp;<span class="num" id="6203866">0</span>&nbsp;<span class="op" id="6203868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203873">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203897">return</span>&nbsp;<span class="string" id="6203904">&#34;&#34;</span><span class="op" id="6203906">,</span>&nbsp;<span class="num" id="6203908">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203916">comment</span>&nbsp;<span class="op" id="6203924">=</span>&nbsp;<span class="ident" id="6203926">data</span><span class="op" id="6203930">[</span><span class="op" id="6203931">:</span><span class="ident" id="6203932">i</span><span class="op" id="6203933">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203937">if</span>&nbsp;<span class="ident" id="6203940">bytes</span><span class="op" id="6203945">.</span><span class="ident" id="6203946">Contains</span><span class="op" id="6203954">(</span><span class="ident" id="6203955">comment</span><span class="op" id="6203962">,</span>&nbsp;<span class="ident" id="6203964">newline</span><span class="op" id="6203971">)</span>&nbsp;<span class="op" id="6203973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203978">return</span>&nbsp;<span class="string" id="6203985">&#34;&#34;</span><span class="op" id="6203987">,</span>&nbsp;<span class="num" id="6203989">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203999">comment</span>&nbsp;<span class="op" id="6204007">=</span>&nbsp;<span class="ident" id="6204009">bytes</span><span class="op" id="6204014">.</span><span class="ident" id="6204015">TrimSpace</span><span class="op" id="6204024">(</span><span class="ident" id="6204025">comment</span><span class="op" id="6204032">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204036">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204077">word</span><span class="op" id="6204081">,</span>&nbsp;<span class="ident" id="6204083">arg</span>&nbsp;<span class="op" id="6204087">:=</span>&nbsp;<span class="ident" id="6204090">parseWord</span><span class="op" id="6204099">(</span><span class="ident" id="6204100">comment</span><span class="op" id="6204107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204110">if</span>&nbsp;<span class="builtintype" id="6204113">string</span><span class="op" id="6204119">(</span><span class="ident" id="6204120">word</span><span class="op" id="6204124">)</span>&nbsp;<span class="op" id="6204126">!=</span>&nbsp;<span class="string" id="6204129">&#34;import&#34;</span>&nbsp;<span class="op" id="6204138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204142">return</span>&nbsp;<span class="string" id="6204149">&#34;&#34;</span><span class="op" id="6204151">,</span>&nbsp;<span class="num" id="6204153">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204160">line</span>&nbsp;<span class="op" id="6204165">=</span>&nbsp;<span class="num" id="6204167">1</span>&nbsp;<span class="op" id="6204169">+</span>&nbsp;<span class="ident" id="6204171">bytes</span><span class="op" id="6204176">.</span><span class="ident" id="6204177">Count</span><span class="op" id="6204182">(</span><span class="ident" id="6204183">data</span><span class="op" id="6204187">[</span><span class="op" id="6204188">:</span><span class="builtinfunc" id="6204189">cap</span><span class="op" id="6204192">(</span><span class="ident" id="6204193">data</span><span class="op" id="6204197">)</span><span class="op" id="6204198">-</span><span class="builtinfunc" id="6204199">cap</span><span class="op" id="6204202">(</span><span class="ident" id="6204203">arg</span><span class="op" id="6204206">)</span><span class="op" id="6204207">]</span><span class="op" id="6204208">,</span>&nbsp;<span class="ident" id="6204210">newline</span><span class="op" id="6204217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204220">return</span>&nbsp;<span class="ident" id="6204227">strings</span><span class="op" id="6204234">.</span><span class="ident" id="6204235">TrimSpace</span><span class="op" id="6204244">(</span><span class="builtintype" id="6204245">string</span><span class="op" id="6204251">(</span><span class="ident" id="6204252">arg</span><span class="op" id="6204255">)</span><span class="op" id="6204256">)</span><span class="op" id="6204257">,</span>&nbsp;<span class="ident" id="6204259">line</span><br>
<span class="lineno"></span><span class="op" id="6204264">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6204267">var</span>&nbsp;<span class="op" id="6204271">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204274">slashSlash</span>&nbsp;<span class="op" id="6204285">=</span>&nbsp;<span class="op" id="6204287">[</span><span class="op" id="6204288">]</span><span class="builtintype" id="6204289">byte</span><span class="op" id="6204293">(</span><span class="string" id="6204294">&#34;//&#34;</span><span class="op" id="6204298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204301">slashStar</span>&nbsp;&nbsp;<span class="op" id="6204312">=</span>&nbsp;<span class="op" id="6204314">[</span><span class="op" id="6204315">]</span><span class="builtintype" id="6204316">byte</span><span class="op" id="6204320">(</span><span class="string" id="6204321">&#34;/*&#34;</span><span class="op" id="6204325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204328">starSlash</span>&nbsp;&nbsp;<span class="op" id="6204339">=</span>&nbsp;<span class="op" id="6204341">[</span><span class="op" id="6204342">]</span><span class="builtintype" id="6204343">byte</span><span class="op" id="6204347">(</span><span class="string" id="6204348">&#34;*/&#34;</span><span class="op" id="6204352">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204355">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6204366">=</span>&nbsp;<span class="op" id="6204368">[</span><span class="op" id="6204369">]</span><span class="builtintype" id="6204370">byte</span><span class="op" id="6204374">(</span><span class="string" id="6204375">&#34;\n&#34;</span><span class="op" id="6204379">)</span><br>
<span class="lineno"></span><span class="op" id="6204381">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6204384">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="6204464">func</span>&nbsp;<span class="ident" id="6204469">skipSpaceOrComment</span><span class="op" id="6204487">(</span><span class="ident" id="6204488">data</span>&nbsp;<span class="op" id="6204493">[</span><span class="op" id="6204494">]</span><span class="builtintype" id="6204495">byte</span><span class="op" id="6204499">)</span>&nbsp;<span class="op" id="6204501">[</span><span class="op" id="6204502">]</span><span class="builtintype" id="6204503">byte</span>&nbsp;<span class="op" id="6204508">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204511">for</span>&nbsp;<span class="builtinfunc" id="6204515">len</span><span class="op" id="6204518">(</span><span class="ident" id="6204519">data</span><span class="op" id="6204523">)</span>&nbsp;<span class="op" id="6204525">&gt;</span>&nbsp;<span class="num" id="6204527">0</span>&nbsp;<span class="op" id="6204529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204533">switch</span>&nbsp;<span class="ident" id="6204540">data</span><span class="op" id="6204544">[</span><span class="num" id="6204545">0</span><span class="op" id="6204546">]</span>&nbsp;<span class="op" id="6204548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204552">case</span>&nbsp;<span class="string" id="6204557">&#39;&nbsp;&#39;</span><span class="op" id="6204560">,</span>&nbsp;<span class="string" id="6204562">&#39;\t&#39;</span><span class="op" id="6204566">,</span>&nbsp;<span class="string" id="6204568">&#39;\r&#39;</span><span class="op" id="6204572">,</span>&nbsp;<span class="string" id="6204574">&#39;\n&#39;</span><span class="op" id="6204578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204583">data</span>&nbsp;<span class="op" id="6204588">=</span>&nbsp;<span class="ident" id="6204590">data</span><span class="op" id="6204594">[</span><span class="num" id="6204595">1</span><span class="op" id="6204596">:</span><span class="op" id="6204597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204602">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204613">case</span>&nbsp;<span class="string" id="6204618">&#39;/&#39;</span><span class="op" id="6204621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204626">if</span>&nbsp;<span class="ident" id="6204629">bytes</span><span class="op" id="6204634">.</span><span class="ident" id="6204635">HasPrefix</span><span class="op" id="6204644">(</span><span class="ident" id="6204645">data</span><span class="op" id="6204649">,</span>&nbsp;<span class="ident" id="6204651">slashSlash</span><span class="op" id="6204661">)</span>&nbsp;<span class="op" id="6204663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204669">i</span>&nbsp;<span class="op" id="6204671">:=</span>&nbsp;<span class="ident" id="6204674">bytes</span><span class="op" id="6204679">.</span><span class="ident" id="6204680">Index</span><span class="op" id="6204685">(</span><span class="ident" id="6204686">data</span><span class="op" id="6204690">,</span>&nbsp;<span class="ident" id="6204692">newline</span><span class="op" id="6204699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204705">if</span>&nbsp;<span class="ident" id="6204708">i</span>&nbsp;<span class="op" id="6204710">&lt;</span>&nbsp;<span class="num" id="6204712">0</span>&nbsp;<span class="op" id="6204714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204721">return</span>&nbsp;<span class="ident" id="6204728">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204742">data</span>&nbsp;<span class="op" id="6204747">=</span>&nbsp;<span class="ident" id="6204749">data</span><span class="op" id="6204753">[</span><span class="ident" id="6204754">i</span><span class="op" id="6204755">+</span><span class="num" id="6204756">1</span><span class="op" id="6204757">:</span><span class="op" id="6204758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204764">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204781">if</span>&nbsp;<span class="ident" id="6204784">bytes</span><span class="op" id="6204789">.</span><span class="ident" id="6204790">HasPrefix</span><span class="op" id="6204799">(</span><span class="ident" id="6204800">data</span><span class="op" id="6204804">,</span>&nbsp;<span class="ident" id="6204806">slashStar</span><span class="op" id="6204815">)</span>&nbsp;<span class="op" id="6204817">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204823">data</span>&nbsp;<span class="op" id="6204828">=</span>&nbsp;<span class="ident" id="6204830">data</span><span class="op" id="6204834">[</span><span class="num" id="6204835">2</span><span class="op" id="6204836">:</span><span class="op" id="6204837">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204843">i</span>&nbsp;<span class="op" id="6204845">:=</span>&nbsp;<span class="ident" id="6204848">bytes</span><span class="op" id="6204853">.</span><span class="ident" id="6204854">Index</span><span class="op" id="6204859">(</span><span class="ident" id="6204860">data</span><span class="op" id="6204864">,</span>&nbsp;<span class="ident" id="6204866">starSlash</span><span class="op" id="6204875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204881">if</span>&nbsp;<span class="ident" id="6204884">i</span>&nbsp;<span class="op" id="6204886">&lt;</span>&nbsp;<span class="num" id="6204888">0</span>&nbsp;<span class="op" id="6204890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204897">return</span>&nbsp;<span class="ident" id="6204904">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204912">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204918">data</span>&nbsp;<span class="op" id="6204923">=</span>&nbsp;<span class="ident" id="6204925">data</span><span class="op" id="6204929">[</span><span class="ident" id="6204930">i</span><span class="op" id="6204931">+</span><span class="num" id="6204932">2</span><span class="op" id="6204933">:</span><span class="op" id="6204934">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204940">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204960">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204970">return</span>&nbsp;<span class="ident" id="6204977">data</span><br>
<span class="lineno"></span><span class="op" id="6204982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6204985">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="6205043">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="6205113">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="6205169">func</span>&nbsp;<span class="ident" id="6205174">parseWord</span><span class="op" id="6205183">(</span><span class="ident" id="6205184">data</span>&nbsp;<span class="op" id="6205189">[</span><span class="op" id="6205190">]</span><span class="builtintype" id="6205191">byte</span><span class="op" id="6205195">)</span>&nbsp;<span class="op" id="6205197">(</span><span class="ident" id="6205198">word</span><span class="op" id="6205202">,</span>&nbsp;<span class="ident" id="6205204">rest</span>&nbsp;<span class="op" id="6205209">[</span><span class="op" id="6205210">]</span><span class="builtintype" id="6205211">byte</span><span class="op" id="6205215">)</span>&nbsp;<span class="op" id="6205217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205220">data</span>&nbsp;<span class="op" id="6205225">=</span>&nbsp;<span class="ident" id="6205227">skipSpaceOrComment</span><span class="op" id="6205245">(</span><span class="ident" id="6205246">data</span><span class="op" id="6205250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205254">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205294">rest</span>&nbsp;<span class="op" id="6205299">=</span>&nbsp;<span class="ident" id="6205301">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205307">for</span>&nbsp;<span class="op" id="6205311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205315">r</span><span class="op" id="6205316">,</span>&nbsp;<span class="ident" id="6205318">size</span>&nbsp;<span class="op" id="6205323">:=</span>&nbsp;<span class="ident" id="6205326">utf8</span><span class="op" id="6205330">.</span><span class="ident" id="6205331">DecodeRune</span><span class="op" id="6205341">(</span><span class="ident" id="6205342">rest</span><span class="op" id="6205346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205350">if</span>&nbsp;<span class="ident" id="6205353">unicode</span><span class="op" id="6205360">.</span><span class="ident" id="6205361">IsLetter</span><span class="op" id="6205369">(</span><span class="ident" id="6205370">r</span><span class="op" id="6205371">)</span>&nbsp;<span class="op" id="6205373">||</span>&nbsp;<span class="string" id="6205376">&#39;0&#39;</span>&nbsp;<span class="op" id="6205380">&lt;=</span>&nbsp;<span class="ident" id="6205383">r</span>&nbsp;<span class="op" id="6205385">&amp;&amp;</span>&nbsp;<span class="ident" id="6205388">r</span>&nbsp;<span class="op" id="6205390">&lt;=</span>&nbsp;<span class="string" id="6205393">&#39;9&#39;</span>&nbsp;<span class="op" id="6205397">||</span>&nbsp;<span class="ident" id="6205400">r</span>&nbsp;<span class="op" id="6205402">==</span>&nbsp;<span class="string" id="6205405">&#39;_&#39;</span>&nbsp;<span class="op" id="6205409">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205414">rest</span>&nbsp;<span class="op" id="6205419">=</span>&nbsp;<span class="ident" id="6205421">rest</span><span class="op" id="6205425">[</span><span class="ident" id="6205426">size</span><span class="op" id="6205430">:</span><span class="op" id="6205431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205436">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205451">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205458">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205462">word</span>&nbsp;<span class="op" id="6205467">=</span>&nbsp;<span class="ident" id="6205469">data</span><span class="op" id="6205473">[</span><span class="op" id="6205474">:</span><span class="builtinfunc" id="6205475">len</span><span class="op" id="6205478">(</span><span class="ident" id="6205479">data</span><span class="op" id="6205483">)</span><span class="op" id="6205484">-</span><span class="builtinfunc" id="6205485">len</span><span class="op" id="6205488">(</span><span class="ident" id="6205489">rest</span><span class="op" id="6205493">)</span><span class="op" id="6205494">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205497">if</span>&nbsp;<span class="builtinfunc" id="6205500">len</span><span class="op" id="6205503">(</span><span class="ident" id="6205504">word</span><span class="op" id="6205508">)</span>&nbsp;<span class="op" id="6205510">==</span>&nbsp;<span class="num" id="6205513">0</span>&nbsp;<span class="op" id="6205515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205519">return</span>&nbsp;<span class="ident" id="6205526">nil</span><span class="op" id="6205529">,</span>&nbsp;<span class="ident" id="6205531">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205536">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205540">return</span>&nbsp;<span class="ident" id="6205547">word</span><span class="op" id="6205551">,</span>&nbsp;<span class="ident" id="6205553">rest</span><br>
<span class="lineno"></span><span class="op" id="6205558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6205561">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="6205642">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="6205721">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6205743">//</span><br>
<span class="lineno"></span><span class="comment" id="6205746">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6205819">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="6205862">func</span>&nbsp;<span class="op" id="6205867">(</span><span class="ident" id="6205868">ctxt</span>&nbsp;<span class="op" id="6205873">*</span><span class="ident" id="6205874">Context</span><span class="op" id="6205881">)</span>&nbsp;<span class="ident" id="6205883">MatchFile</span><span class="op" id="6205892">(</span><span class="ident" id="6205893">dir</span><span class="op" id="6205896">,</span>&nbsp;<span class="ident" id="6205898">name</span>&nbsp;<span class="builtintype" id="6205903">string</span><span class="op" id="6205909">)</span>&nbsp;<span class="op" id="6205911">(</span><span class="ident" id="6205912">match</span>&nbsp;<span class="builtintype" id="6205918">bool</span><span class="op" id="6205922">,</span>&nbsp;<span class="ident" id="6205924">err</span>&nbsp;<span class="builtintype" id="6205928">error</span><span class="op" id="6205933">)</span>&nbsp;<span class="op" id="6205935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205938">match</span><span class="op" id="6205943">,</span>&nbsp;<span class="ident" id="6205945">_</span><span class="op" id="6205946">,</span>&nbsp;<span class="ident" id="6205948">_</span><span class="op" id="6205949">,</span>&nbsp;<span class="ident" id="6205951">err</span>&nbsp;<span class="op" id="6205955">=</span>&nbsp;<span class="ident" id="6205957">ctxt</span><span class="op" id="6205961">.</span><span class="ident" id="6205962">matchFile</span><span class="op" id="6205971">(</span><span class="ident" id="6205972">dir</span><span class="op" id="6205975">,</span>&nbsp;<span class="ident" id="6205977">name</span><span class="op" id="6205981">,</span>&nbsp;<span class="builtintype" id="6205983">false</span><span class="op" id="6205988">,</span>&nbsp;<span class="ident" id="6205990">nil</span><span class="op" id="6205993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205996">return</span><br>
<span class="lineno"></span><span class="op" id="6206003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="6206006">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="6206090">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="6206146">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6206189">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="6206264">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="6206340">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="6206387">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="6206457">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="6206492">func</span>&nbsp;<span class="op" id="6206497">(</span><span class="ident" id="6206498">ctxt</span>&nbsp;<span class="op" id="6206503">*</span><span class="ident" id="6206504">Context</span><span class="op" id="6206511">)</span>&nbsp;<span class="ident" id="6206513">matchFile</span><span class="op" id="6206522">(</span><span class="ident" id="6206523">dir</span><span class="op" id="6206526">,</span>&nbsp;<span class="ident" id="6206528">name</span>&nbsp;<span class="builtintype" id="6206533">string</span><span class="op" id="6206539">,</span>&nbsp;<span class="ident" id="6206541">returnImports</span>&nbsp;<span class="builtintype" id="6206555">bool</span><span class="op" id="6206559">,</span>&nbsp;<span class="ident" id="6206561">allTags</span>&nbsp;<span class="keyword" id="6206569">map</span><span class="op" id="6206572">[</span><span class="builtintype" id="6206573">string</span><span class="op" id="6206579">]</span><span class="builtintype" id="6206580">bool</span><span class="op" id="6206584">)</span>&nbsp;<span class="op" id="6206586">(</span><span class="ident" id="6206587">match</span>&nbsp;<span class="builtintype" id="6206593">bool</span><span class="op" id="6206597">,</span>&nbsp;<span class="ident" id="6206599">data</span>&nbsp;<span class="op" id="6206604">[</span><span class="op" id="6206605">]</span><span class="builtintype" id="6206606">byte</span><span class="op" id="6206610">,</span>&nbsp;<span class="ident" id="6206612">filename</span>&nbsp;<span class="builtintype" id="6206621">string</span><span class="op" id="6206627">,</span>&nbsp;<span class="ident" id="6206629">err</span>&nbsp;<span class="builtintype" id="6206633">error</span><span class="op" id="6206638">)</span>&nbsp;<span class="op" id="6206640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206643">if</span>&nbsp;<span class="ident" id="6206646">strings</span><span class="op" id="6206653">.</span><span class="ident" id="6206654">HasPrefix</span><span class="op" id="6206663">(</span><span class="ident" id="6206664">name</span><span class="op" id="6206668">,</span>&nbsp;<span class="string" id="6206670">&#34;_&#34;</span><span class="op" id="6206673">)</span>&nbsp;<span class="op" id="6206675">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206680">strings</span><span class="op" id="6206687">.</span><span class="ident" id="6206688">HasPrefix</span><span class="op" id="6206697">(</span><span class="ident" id="6206698">name</span><span class="op" id="6206702">,</span>&nbsp;<span class="string" id="6206704">&#34;.&#34;</span><span class="op" id="6206707">)</span>&nbsp;<span class="op" id="6206709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206713">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206725">i</span>&nbsp;<span class="op" id="6206727">:=</span>&nbsp;<span class="ident" id="6206730">strings</span><span class="op" id="6206737">.</span><span class="ident" id="6206738">LastIndex</span><span class="op" id="6206747">(</span><span class="ident" id="6206748">name</span><span class="op" id="6206752">,</span>&nbsp;<span class="string" id="6206754">&#34;.&#34;</span><span class="op" id="6206757">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206760">if</span>&nbsp;<span class="ident" id="6206763">i</span>&nbsp;<span class="op" id="6206765">&lt;</span>&nbsp;<span class="num" id="6206767">0</span>&nbsp;<span class="op" id="6206769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206773">i</span>&nbsp;<span class="op" id="6206775">=</span>&nbsp;<span class="builtinfunc" id="6206777">len</span><span class="op" id="6206780">(</span><span class="ident" id="6206781">name</span><span class="op" id="6206785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206791">ext</span>&nbsp;<span class="op" id="6206795">:=</span>&nbsp;<span class="ident" id="6206798">name</span><span class="op" id="6206802">[</span><span class="ident" id="6206803">i</span><span class="op" id="6206804">:</span><span class="op" id="6206805">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206809">if</span>&nbsp;<span class="op" id="6206812">!</span><span class="ident" id="6206813">ctxt</span><span class="op" id="6206817">.</span><span class="ident" id="6206818">goodOSArchFile</span><span class="op" id="6206832">(</span><span class="ident" id="6206833">name</span><span class="op" id="6206837">,</span>&nbsp;<span class="ident" id="6206839">allTags</span><span class="op" id="6206846">)</span>&nbsp;<span class="op" id="6206848">&amp;&amp;</span>&nbsp;<span class="op" id="6206851">!</span><span class="ident" id="6206852">ctxt</span><span class="op" id="6206856">.</span><span class="ident" id="6206857">UseAllFiles</span>&nbsp;<span class="op" id="6206869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206873">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206885">switch</span>&nbsp;<span class="ident" id="6206892">ext</span>&nbsp;<span class="op" id="6206896">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206899">case</span>&nbsp;<span class="string" id="6206904">&#34;.go&#34;</span><span class="op" id="6206909">,</span>&nbsp;<span class="string" id="6206911">&#34;.c&#34;</span><span class="op" id="6206915">,</span>&nbsp;<span class="string" id="6206917">&#34;.cc&#34;</span><span class="op" id="6206922">,</span>&nbsp;<span class="string" id="6206924">&#34;.cxx&#34;</span><span class="op" id="6206930">,</span>&nbsp;<span class="string" id="6206932">&#34;.cpp&#34;</span><span class="op" id="6206938">,</span>&nbsp;<span class="string" id="6206940">&#34;.m&#34;</span><span class="op" id="6206944">,</span>&nbsp;<span class="string" id="6206946">&#34;.s&#34;</span><span class="op" id="6206950">,</span>&nbsp;<span class="string" id="6206952">&#34;.h&#34;</span><span class="op" id="6206956">,</span>&nbsp;<span class="string" id="6206958">&#34;.hh&#34;</span><span class="op" id="6206963">,</span>&nbsp;<span class="string" id="6206965">&#34;.hpp&#34;</span><span class="op" id="6206971">,</span>&nbsp;<span class="string" id="6206973">&#34;.hxx&#34;</span><span class="op" id="6206979">,</span>&nbsp;<span class="string" id="6206981">&#34;.S&#34;</span><span class="op" id="6206985">,</span>&nbsp;<span class="string" id="6206987">&#34;.swig&#34;</span><span class="op" id="6206994">,</span>&nbsp;<span class="string" id="6206996">&#34;.swigcxx&#34;</span><span class="op" id="6207006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207010">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207051">case</span>&nbsp;<span class="string" id="6207056">&#34;.syso&#34;</span><span class="op" id="6207063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207067">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207091">match</span>&nbsp;<span class="op" id="6207097">=</span>&nbsp;<span class="builtintype" id="6207099">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207114">default</span><span class="op" id="6207121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207125">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207135">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207143">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207147">filename</span>&nbsp;<span class="op" id="6207156">=</span>&nbsp;<span class="ident" id="6207158">ctxt</span><span class="op" id="6207162">.</span><span class="ident" id="6207163">joinPath</span><span class="op" id="6207171">(</span><span class="ident" id="6207172">dir</span><span class="op" id="6207175">,</span>&nbsp;<span class="ident" id="6207177">name</span><span class="op" id="6207181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207184">f</span><span class="op" id="6207185">,</span>&nbsp;<span class="ident" id="6207187">err</span>&nbsp;<span class="op" id="6207191">:=</span>&nbsp;<span class="ident" id="6207194">ctxt</span><span class="op" id="6207198">.</span><span class="ident" id="6207199">openFile</span><span class="op" id="6207207">(</span><span class="ident" id="6207208">filename</span><span class="op" id="6207216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207219">if</span>&nbsp;<span class="ident" id="6207222">err</span>&nbsp;<span class="op" id="6207226">!=</span>&nbsp;<span class="ident" id="6207229">nil</span>&nbsp;<span class="op" id="6207233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207237">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207249">if</span>&nbsp;<span class="ident" id="6207252">strings</span><span class="op" id="6207259">.</span><span class="ident" id="6207260">HasSuffix</span><span class="op" id="6207269">(</span><span class="ident" id="6207270">filename</span><span class="op" id="6207278">,</span>&nbsp;<span class="string" id="6207280">&#34;.go&#34;</span><span class="op" id="6207285">)</span>&nbsp;<span class="op" id="6207287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207291">data</span><span class="op" id="6207295">,</span>&nbsp;<span class="ident" id="6207297">err</span>&nbsp;<span class="op" id="6207301">=</span>&nbsp;<span class="ident" id="6207303">readImports</span><span class="op" id="6207314">(</span><span class="ident" id="6207315">f</span><span class="op" id="6207316">,</span>&nbsp;<span class="builtintype" id="6207318">false</span><span class="op" id="6207323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207326">}</span>&nbsp;<span class="keyword" id="6207328">else</span>&nbsp;<span class="op" id="6207333">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207337">data</span><span class="op" id="6207341">,</span>&nbsp;<span class="ident" id="6207343">err</span>&nbsp;<span class="op" id="6207347">=</span>&nbsp;<span class="ident" id="6207349">readComments</span><span class="op" id="6207361">(</span><span class="ident" id="6207362">f</span><span class="op" id="6207363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207369">f</span><span class="op" id="6207370">.</span><span class="ident" id="6207371">Close</span><span class="op" id="6207376">(</span><span class="op" id="6207377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207380">if</span>&nbsp;<span class="ident" id="6207383">err</span>&nbsp;<span class="op" id="6207387">!=</span>&nbsp;<span class="ident" id="6207390">nil</span>&nbsp;<span class="op" id="6207394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207398">err</span>&nbsp;<span class="op" id="6207402">=</span>&nbsp;<span class="ident" id="6207404">fmt</span><span class="op" id="6207407">.</span><span class="ident" id="6207408">Errorf</span><span class="op" id="6207414">(</span><span class="string" id="6207415">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6207428">,</span>&nbsp;<span class="ident" id="6207430">filename</span><span class="op" id="6207438">,</span>&nbsp;<span class="ident" id="6207440">err</span><span class="op" id="6207443">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207447">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207459">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207518">if</span>&nbsp;<span class="op" id="6207521">!</span><span class="ident" id="6207522">ctxt</span><span class="op" id="6207526">.</span><span class="ident" id="6207527">shouldBuild</span><span class="op" id="6207538">(</span><span class="ident" id="6207539">data</span><span class="op" id="6207543">,</span>&nbsp;<span class="ident" id="6207545">allTags</span><span class="op" id="6207552">)</span>&nbsp;<span class="op" id="6207554">&amp;&amp;</span>&nbsp;<span class="op" id="6207557">!</span><span class="ident" id="6207558">ctxt</span><span class="op" id="6207562">.</span><span class="ident" id="6207563">UseAllFiles</span>&nbsp;<span class="op" id="6207575">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207591">match</span>&nbsp;<span class="op" id="6207597">=</span>&nbsp;<span class="builtintype" id="6207599">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207605">return</span><br>
<span class="lineno">975</span><span class="op" id="6207612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6207615">func</span>&nbsp;<span class="ident" id="6207620">cleanImports</span><span class="op" id="6207632">(</span><span class="ident" id="6207633">m</span>&nbsp;<span class="keyword" id="6207635">map</span><span class="op" id="6207638">[</span><span class="builtintype" id="6207639">string</span><span class="op" id="6207645">]</span><span class="op" id="6207646">[</span><span class="op" id="6207647">]</span><span class="ident" id="6207648">token</span><span class="op" id="6207653">.</span><span class="ident" id="6207654">Position</span><span class="op" id="6207662">)</span>&nbsp;<span class="op" id="6207664">(</span><span class="op" id="6207665">[</span><span class="op" id="6207666">]</span><span class="builtintype" id="6207667">string</span><span class="op" id="6207673">,</span>&nbsp;<span class="keyword" id="6207675">map</span><span class="op" id="6207678">[</span><span class="builtintype" id="6207679">string</span><span class="op" id="6207685">]</span><span class="op" id="6207686">[</span><span class="op" id="6207687">]</span><span class="ident" id="6207688">token</span><span class="op" id="6207693">.</span><span class="ident" id="6207694">Position</span><span class="op" id="6207702">)</span>&nbsp;<span class="op" id="6207704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207707">all</span>&nbsp;<span class="op" id="6207711">:=</span>&nbsp;<span class="builtinfunc" id="6207714">make</span><span class="op" id="6207718">(</span><span class="op" id="6207719">[</span><span class="op" id="6207720">]</span><span class="builtintype" id="6207721">string</span><span class="op" id="6207727">,</span>&nbsp;<span class="num" id="6207729">0</span><span class="op" id="6207730">,</span>&nbsp;<span class="builtinfunc" id="6207732">len</span><span class="op" id="6207735">(</span><span class="ident" id="6207736">m</span><span class="op" id="6207737">)</span><span class="op" id="6207738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207741">for</span>&nbsp;<span class="ident" id="6207745">path</span>&nbsp;<span class="op" id="6207750">:=</span>&nbsp;<span class="keyword" id="6207753">range</span>&nbsp;<span class="ident" id="6207759">m</span>&nbsp;<span class="op" id="6207761">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207765">all</span>&nbsp;<span class="op" id="6207769">=</span>&nbsp;<span class="builtinfunc" id="6207771">append</span><span class="op" id="6207777">(</span><span class="ident" id="6207778">all</span><span class="op" id="6207781">,</span>&nbsp;<span class="ident" id="6207783">path</span><span class="op" id="6207787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207793">sort</span><span class="op" id="6207797">.</span><span class="ident" id="6207798">Strings</span><span class="op" id="6207805">(</span><span class="ident" id="6207806">all</span><span class="op" id="6207809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207812">return</span>&nbsp;<span class="ident" id="6207819">all</span><span class="op" id="6207822">,</span>&nbsp;<span class="ident" id="6207824">m</span><br>
<span class="lineno"></span><span class="op" id="6207826">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="6207829">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="6207872">func</span>&nbsp;<span class="ident" id="6207877">Import</span><span class="op" id="6207883">(</span><span class="ident" id="6207884">path</span><span class="op" id="6207888">,</span>&nbsp;<span class="ident" id="6207890">srcDir</span>&nbsp;<span class="builtintype" id="6207897">string</span><span class="op" id="6207903">,</span>&nbsp;<span class="ident" id="6207905">mode</span>&nbsp;<span class="ident" id="6207910">ImportMode</span><span class="op" id="6207920">)</span>&nbsp;<span class="op" id="6207922">(</span><span class="op" id="6207923">*</span><span class="ident" id="6207924">Package</span><span class="op" id="6207931">,</span>&nbsp;<span class="builtintype" id="6207933">error</span><span class="op" id="6207938">)</span>&nbsp;<span class="op" id="6207940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207943">return</span>&nbsp;<span class="ident" id="6207950">Default</span><span class="op" id="6207957">.</span><span class="ident" id="6207958">Import</span><span class="op" id="6207964">(</span><span class="ident" id="6207965">path</span><span class="op" id="6207969">,</span>&nbsp;<span class="ident" id="6207971">srcDir</span><span class="op" id="6207977">,</span>&nbsp;<span class="ident" id="6207979">mode</span><span class="op" id="6207983">)</span><br>
<span class="lineno"></span><span class="op" id="6207985">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="6207988">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6208037">func</span>&nbsp;<span class="ident" id="6208042">ImportDir</span><span class="op" id="6208051">(</span><span class="ident" id="6208052">dir</span>&nbsp;<span class="builtintype" id="6208056">string</span><span class="op" id="6208062">,</span>&nbsp;<span class="ident" id="6208064">mode</span>&nbsp;<span class="ident" id="6208069">ImportMode</span><span class="op" id="6208079">)</span>&nbsp;<span class="op" id="6208081">(</span><span class="op" id="6208082">*</span><span class="ident" id="6208083">Package</span><span class="op" id="6208090">,</span>&nbsp;<span class="builtintype" id="6208092">error</span><span class="op" id="6208097">)</span>&nbsp;<span class="op" id="6208099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208102">return</span>&nbsp;<span class="ident" id="6208109">Default</span><span class="op" id="6208116">.</span><span class="ident" id="6208117">ImportDir</span><span class="op" id="6208126">(</span><span class="ident" id="6208127">dir</span><span class="op" id="6208130">,</span>&nbsp;<span class="ident" id="6208132">mode</span><span class="op" id="6208136">)</span><br>
<span class="lineno"></span><span class="op" id="6208138">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="6208141">var</span>&nbsp;<span class="ident" id="6208145">slashslash</span>&nbsp;<span class="op" id="6208156">=</span>&nbsp;<span class="op" id="6208158">[</span><span class="op" id="6208159">]</span><span class="builtintype" id="6208160">byte</span><span class="op" id="6208164">(</span><span class="string" id="6208165">&#34;//&#34;</span><span class="op" id="6208169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6208172">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="6208232">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="6208293">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="6208352">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="6208409">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="6208476">//</span><br>
<span class="lineno"></span><span class="comment" id="6208479">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="6208542">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6208578">//</span><br>
<span class="lineno"></span><span class="comment" id="6208581">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="6208608">//</span><br>
<span class="lineno"></span><span class="comment" id="6208611">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="6208670">//</span><br>
<span class="lineno"></span><span class="keyword" id="6208673">func</span>&nbsp;<span class="op" id="6208678">(</span><span class="ident" id="6208679">ctxt</span>&nbsp;<span class="op" id="6208684">*</span><span class="ident" id="6208685">Context</span><span class="op" id="6208692">)</span>&nbsp;<span class="ident" id="6208694">shouldBuild</span><span class="op" id="6208705">(</span><span class="ident" id="6208706">content</span>&nbsp;<span class="op" id="6208714">[</span><span class="op" id="6208715">]</span><span class="builtintype" id="6208716">byte</span><span class="op" id="6208720">,</span>&nbsp;<span class="ident" id="6208722">allTags</span>&nbsp;<span class="keyword" id="6208730">map</span><span class="op" id="6208733">[</span><span class="builtintype" id="6208734">string</span><span class="op" id="6208740">]</span><span class="builtintype" id="6208741">bool</span><span class="op" id="6208745">)</span>&nbsp;<span class="builtintype" id="6208747">bool</span>&nbsp;<span class="op" id="6208752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208755">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208820">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208864">end</span>&nbsp;<span class="op" id="6208868">:=</span>&nbsp;<span class="num" id="6208871">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208874">p</span>&nbsp;<span class="op" id="6208876">:=</span>&nbsp;<span class="ident" id="6208879">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208888">for</span>&nbsp;<span class="builtinfunc" id="6208892">len</span><span class="op" id="6208895">(</span><span class="ident" id="6208896">p</span><span class="op" id="6208897">)</span>&nbsp;<span class="op" id="6208899">&gt;</span>&nbsp;<span class="num" id="6208901">0</span>&nbsp;<span class="op" id="6208903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208907">line</span>&nbsp;<span class="op" id="6208912">:=</span>&nbsp;<span class="ident" id="6208915">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208919">if</span>&nbsp;<span class="ident" id="6208922">i</span>&nbsp;<span class="op" id="6208924">:=</span>&nbsp;<span class="ident" id="6208927">bytes</span><span class="op" id="6208932">.</span><span class="ident" id="6208933">IndexByte</span><span class="op" id="6208942">(</span><span class="ident" id="6208943">line</span><span class="op" id="6208947">,</span>&nbsp;<span class="string" id="6208949">&#39;\n&#39;</span><span class="op" id="6208953">)</span><span class="op" id="6208954">;</span>&nbsp;<span class="ident" id="6208956">i</span>&nbsp;<span class="op" id="6208958">&gt;=</span>&nbsp;<span class="num" id="6208961">0</span>&nbsp;<span class="op" id="6208963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208968">line</span><span class="op" id="6208972">,</span>&nbsp;<span class="ident" id="6208974">p</span>&nbsp;<span class="op" id="6208976">=</span>&nbsp;<span class="ident" id="6208978">line</span><span class="op" id="6208982">[</span><span class="op" id="6208983">:</span><span class="ident" id="6208984">i</span><span class="op" id="6208985">]</span><span class="op" id="6208986">,</span>&nbsp;<span class="ident" id="6208988">p</span><span class="op" id="6208989">[</span><span class="ident" id="6208990">i</span><span class="op" id="6208991">+</span><span class="num" id="6208992">1</span><span class="op" id="6208993">:</span><span class="op" id="6208994">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208998">}</span>&nbsp;<span class="keyword" id="6209000">else</span>&nbsp;<span class="op" id="6209005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209010">p</span>&nbsp;<span class="op" id="6209012">=</span>&nbsp;<span class="ident" id="6209014">p</span><span class="op" id="6209015">[</span><span class="builtinfunc" id="6209016">len</span><span class="op" id="6209019">(</span><span class="ident" id="6209020">p</span><span class="op" id="6209021">)</span><span class="op" id="6209022">:</span><span class="op" id="6209023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209031">line</span>&nbsp;<span class="op" id="6209036">=</span>&nbsp;<span class="ident" id="6209038">bytes</span><span class="op" id="6209043">.</span><span class="ident" id="6209044">TrimSpace</span><span class="op" id="6209053">(</span><span class="ident" id="6209054">line</span><span class="op" id="6209058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209062">if</span>&nbsp;<span class="builtinfunc" id="6209065">len</span><span class="op" id="6209068">(</span><span class="ident" id="6209069">line</span><span class="op" id="6209073">)</span>&nbsp;<span class="op" id="6209075">==</span>&nbsp;<span class="num" id="6209078">0</span>&nbsp;<span class="op" id="6209080">{</span>&nbsp;<span class="comment" id="6209082">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209099">end</span>&nbsp;<span class="op" id="6209103">=</span>&nbsp;<span class="builtinfunc" id="6209105">len</span><span class="op" id="6209108">(</span><span class="ident" id="6209109">content</span><span class="op" id="6209116">)</span>&nbsp;<span class="op" id="6209118">-</span>&nbsp;<span class="builtinfunc" id="6209120">len</span><span class="op" id="6209123">(</span><span class="ident" id="6209124">p</span><span class="op" id="6209125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209130">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209145">if</span>&nbsp;<span class="op" id="6209148">!</span><span class="ident" id="6209149">bytes</span><span class="op" id="6209154">.</span><span class="ident" id="6209155">HasPrefix</span><span class="op" id="6209164">(</span><span class="ident" id="6209165">line</span><span class="op" id="6209169">,</span>&nbsp;<span class="ident" id="6209171">slashslash</span><span class="op" id="6209181">)</span>&nbsp;<span class="op" id="6209183">{</span>&nbsp;<span class="comment" id="6209185">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209208">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209222">content</span>&nbsp;<span class="op" id="6209230">=</span>&nbsp;<span class="ident" id="6209232">content</span><span class="op" id="6209239">[</span><span class="op" id="6209240">:</span><span class="ident" id="6209241">end</span><span class="op" id="6209244">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6209248">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209291">p</span>&nbsp;<span class="op" id="6209293">=</span>&nbsp;<span class="ident" id="6209295">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209304">allok</span>&nbsp;<span class="op" id="6209310">:=</span>&nbsp;<span class="builtintype" id="6209313">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209319">for</span>&nbsp;<span class="builtinfunc" id="6209323">len</span><span class="op" id="6209326">(</span><span class="ident" id="6209327">p</span><span class="op" id="6209328">)</span>&nbsp;<span class="op" id="6209330">&gt;</span>&nbsp;<span class="num" id="6209332">0</span>&nbsp;<span class="op" id="6209334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209338">line</span>&nbsp;<span class="op" id="6209343">:=</span>&nbsp;<span class="ident" id="6209346">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209350">if</span>&nbsp;<span class="ident" id="6209353">i</span>&nbsp;<span class="op" id="6209355">:=</span>&nbsp;<span class="ident" id="6209358">bytes</span><span class="op" id="6209363">.</span><span class="ident" id="6209364">IndexByte</span><span class="op" id="6209373">(</span><span class="ident" id="6209374">line</span><span class="op" id="6209378">,</span>&nbsp;<span class="string" id="6209380">&#39;\n&#39;</span><span class="op" id="6209384">)</span><span class="op" id="6209385">;</span>&nbsp;<span class="ident" id="6209387">i</span>&nbsp;<span class="op" id="6209389">&gt;=</span>&nbsp;<span class="num" id="6209392">0</span>&nbsp;<span class="op" id="6209394">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209399">line</span><span class="op" id="6209403">,</span>&nbsp;<span class="ident" id="6209405">p</span>&nbsp;<span class="op" id="6209407">=</span>&nbsp;<span class="ident" id="6209409">line</span><span class="op" id="6209413">[</span><span class="op" id="6209414">:</span><span class="ident" id="6209415">i</span><span class="op" id="6209416">]</span><span class="op" id="6209417">,</span>&nbsp;<span class="ident" id="6209419">p</span><span class="op" id="6209420">[</span><span class="ident" id="6209421">i</span><span class="op" id="6209422">+</span><span class="num" id="6209423">1</span><span class="op" id="6209424">:</span><span class="op" id="6209425">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209429">}</span>&nbsp;<span class="keyword" id="6209431">else</span>&nbsp;<span class="op" id="6209436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209441">p</span>&nbsp;<span class="op" id="6209443">=</span>&nbsp;<span class="ident" id="6209445">p</span><span class="op" id="6209446">[</span><span class="builtinfunc" id="6209447">len</span><span class="op" id="6209450">(</span><span class="ident" id="6209451">p</span><span class="op" id="6209452">)</span><span class="op" id="6209453">:</span><span class="op" id="6209454">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209462">line</span>&nbsp;<span class="op" id="6209467">=</span>&nbsp;<span class="ident" id="6209469">bytes</span><span class="op" id="6209474">.</span><span class="ident" id="6209475">TrimSpace</span><span class="op" id="6209484">(</span><span class="ident" id="6209485">line</span><span class="op" id="6209489">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209493">if</span>&nbsp;<span class="ident" id="6209496">bytes</span><span class="op" id="6209501">.</span><span class="ident" id="6209502">HasPrefix</span><span class="op" id="6209511">(</span><span class="ident" id="6209512">line</span><span class="op" id="6209516">,</span>&nbsp;<span class="ident" id="6209518">slashslash</span><span class="op" id="6209528">)</span>&nbsp;<span class="op" id="6209530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209535">line</span>&nbsp;<span class="op" id="6209540">=</span>&nbsp;<span class="ident" id="6209542">bytes</span><span class="op" id="6209547">.</span><span class="ident" id="6209548">TrimSpace</span><span class="op" id="6209557">(</span><span class="ident" id="6209558">line</span><span class="op" id="6209562">[</span><span class="builtinfunc" id="6209563">len</span><span class="op" id="6209566">(</span><span class="ident" id="6209567">slashslash</span><span class="op" id="6209577">)</span><span class="op" id="6209578">:</span><span class="op" id="6209579">]</span><span class="op" id="6209580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209585">if</span>&nbsp;<span class="builtinfunc" id="6209588">len</span><span class="op" id="6209591">(</span><span class="ident" id="6209592">line</span><span class="op" id="6209596">)</span>&nbsp;<span class="op" id="6209598">&gt;</span>&nbsp;<span class="num" id="6209600">0</span>&nbsp;<span class="op" id="6209602">&amp;&amp;</span>&nbsp;<span class="ident" id="6209605">line</span><span class="op" id="6209609">[</span><span class="num" id="6209610">0</span><span class="op" id="6209611">]</span>&nbsp;<span class="op" id="6209613">==</span>&nbsp;<span class="string" id="6209616">&#39;+&#39;</span>&nbsp;<span class="op" id="6209620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6209626">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209661">f</span>&nbsp;<span class="op" id="6209663">:=</span>&nbsp;<span class="ident" id="6209666">strings</span><span class="op" id="6209673">.</span><span class="ident" id="6209674">Fields</span><span class="op" id="6209680">(</span><span class="builtintype" id="6209681">string</span><span class="op" id="6209687">(</span><span class="ident" id="6209688">line</span><span class="op" id="6209692">)</span><span class="op" id="6209693">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209699">if</span>&nbsp;<span class="ident" id="6209702">f</span><span class="op" id="6209703">[</span><span class="num" id="6209704">0</span><span class="op" id="6209705">]</span>&nbsp;<span class="op" id="6209707">==</span>&nbsp;<span class="string" id="6209710">&#34;+build&#34;</span>&nbsp;<span class="op" id="6209719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209726">ok</span>&nbsp;<span class="op" id="6209729">:=</span>&nbsp;<span class="builtintype" id="6209732">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209743">for</span>&nbsp;<span class="ident" id="6209747">_</span><span class="op" id="6209748">,</span>&nbsp;<span class="ident" id="6209750">tok</span>&nbsp;<span class="op" id="6209754">:=</span>&nbsp;<span class="keyword" id="6209757">range</span>&nbsp;<span class="ident" id="6209763">f</span><span class="op" id="6209764">[</span><span class="num" id="6209765">1</span><span class="op" id="6209766">:</span><span class="op" id="6209767">]</span>&nbsp;<span class="op" id="6209769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209777">if</span>&nbsp;<span class="ident" id="6209780">ctxt</span><span class="op" id="6209784">.</span><span class="ident" id="6209785">match</span><span class="op" id="6209790">(</span><span class="ident" id="6209791">tok</span><span class="op" id="6209794">,</span>&nbsp;<span class="ident" id="6209796">allTags</span><span class="op" id="6209803">)</span>&nbsp;<span class="op" id="6209805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209814">ok</span>&nbsp;<span class="op" id="6209817">=</span>&nbsp;<span class="builtintype" id="6209819">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209844">if</span>&nbsp;<span class="op" id="6209847">!</span><span class="ident" id="6209848">ok</span>&nbsp;<span class="op" id="6209851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209859">allok</span>&nbsp;<span class="op" id="6209865">=</span>&nbsp;<span class="builtintype" id="6209867">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209878">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209900">return</span>&nbsp;<span class="ident" id="6209907">allok</span><br>
<span class="lineno"></span><span class="op" id="6209913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6209916">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="6209996">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="6210080">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="6210126">//</span><br>
<span class="lineno"></span><span class="comment" id="6210129">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="6210172">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="6210225">func</span>&nbsp;<span class="op" id="6210230">(</span><span class="ident" id="6210231">ctxt</span>&nbsp;<span class="op" id="6210236">*</span><span class="ident" id="6210237">Context</span><span class="op" id="6210244">)</span>&nbsp;<span class="ident" id="6210246">saveCgo</span><span class="op" id="6210253">(</span><span class="ident" id="6210254">filename</span>&nbsp;<span class="builtintype" id="6210263">string</span><span class="op" id="6210269">,</span>&nbsp;<span class="ident" id="6210271">di</span>&nbsp;<span class="op" id="6210274">*</span><span class="ident" id="6210275">Package</span><span class="op" id="6210282">,</span>&nbsp;<span class="ident" id="6210284">cg</span>&nbsp;<span class="op" id="6210287">*</span><span class="ident" id="6210288">ast</span><span class="op" id="6210291">.</span><span class="ident" id="6210292">CommentGroup</span><span class="op" id="6210304">)</span>&nbsp;<span class="builtintype" id="6210306">error</span>&nbsp;<span class="op" id="6210312">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210315">text</span>&nbsp;<span class="op" id="6210320">:=</span>&nbsp;<span class="ident" id="6210323">cg</span><span class="op" id="6210325">.</span><span class="ident" id="6210326">Text</span><span class="op" id="6210330">(</span><span class="op" id="6210331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210334">for</span>&nbsp;<span class="ident" id="6210338">_</span><span class="op" id="6210339">,</span>&nbsp;<span class="ident" id="6210341">line</span>&nbsp;<span class="op" id="6210346">:=</span>&nbsp;<span class="keyword" id="6210349">range</span>&nbsp;<span class="ident" id="6210355">strings</span><span class="op" id="6210362">.</span><span class="ident" id="6210363">Split</span><span class="op" id="6210368">(</span><span class="ident" id="6210369">text</span><span class="op" id="6210373">,</span>&nbsp;<span class="string" id="6210375">&#34;\n&#34;</span><span class="op" id="6210379">)</span>&nbsp;<span class="op" id="6210381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210385">orig</span>&nbsp;<span class="op" id="6210390">:=</span>&nbsp;<span class="ident" id="6210393">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210401">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210414">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210456">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210461">line</span>&nbsp;<span class="op" id="6210466">=</span>&nbsp;<span class="ident" id="6210468">strings</span><span class="op" id="6210475">.</span><span class="ident" id="6210476">TrimSpace</span><span class="op" id="6210485">(</span><span class="ident" id="6210486">line</span><span class="op" id="6210490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210494">if</span>&nbsp;<span class="builtinfunc" id="6210497">len</span><span class="op" id="6210500">(</span><span class="ident" id="6210501">line</span><span class="op" id="6210505">)</span>&nbsp;<span class="op" id="6210507">&lt;</span>&nbsp;<span class="num" id="6210509">5</span>&nbsp;<span class="op" id="6210511">||</span>&nbsp;<span class="ident" id="6210514">line</span><span class="op" id="6210518">[</span><span class="op" id="6210519">:</span><span class="num" id="6210520">4</span><span class="op" id="6210521">]</span>&nbsp;<span class="op" id="6210523">!=</span>&nbsp;<span class="string" id="6210526">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="6210533">||</span>&nbsp;<span class="op" id="6210536">(</span><span class="ident" id="6210537">line</span><span class="op" id="6210541">[</span><span class="num" id="6210542">4</span><span class="op" id="6210543">]</span>&nbsp;<span class="op" id="6210545">!=</span>&nbsp;<span class="string" id="6210548">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6210552">&amp;&amp;</span>&nbsp;<span class="ident" id="6210555">line</span><span class="op" id="6210559">[</span><span class="num" id="6210560">4</span><span class="op" id="6210561">]</span>&nbsp;<span class="op" id="6210563">!=</span>&nbsp;<span class="string" id="6210566">&#39;\t&#39;</span><span class="op" id="6210570">)</span>&nbsp;<span class="op" id="6210572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210577">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210593">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210614">line</span>&nbsp;<span class="op" id="6210619">=</span>&nbsp;<span class="ident" id="6210621">strings</span><span class="op" id="6210628">.</span><span class="ident" id="6210629">TrimSpace</span><span class="op" id="6210638">(</span><span class="ident" id="6210639">line</span><span class="op" id="6210643">[</span><span class="num" id="6210644">4</span><span class="op" id="6210645">:</span><span class="op" id="6210646">]</span><span class="op" id="6210647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210651">i</span>&nbsp;<span class="op" id="6210653">:=</span>&nbsp;<span class="ident" id="6210656">strings</span><span class="op" id="6210663">.</span><span class="ident" id="6210664">Index</span><span class="op" id="6210669">(</span><span class="ident" id="6210670">line</span><span class="op" id="6210674">,</span>&nbsp;<span class="string" id="6210676">&#34;:&#34;</span><span class="op" id="6210679">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210683">if</span>&nbsp;<span class="ident" id="6210686">i</span>&nbsp;<span class="op" id="6210688">&lt;</span>&nbsp;<span class="num" id="6210690">0</span>&nbsp;<span class="op" id="6210692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210697">return</span>&nbsp;<span class="ident" id="6210704">fmt</span><span class="op" id="6210707">.</span><span class="ident" id="6210708">Errorf</span><span class="op" id="6210714">(</span><span class="string" id="6210715">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6210742">,</span>&nbsp;<span class="ident" id="6210744">filename</span><span class="op" id="6210752">,</span>&nbsp;<span class="ident" id="6210754">orig</span><span class="op" id="6210758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210766">line</span><span class="op" id="6210770">,</span>&nbsp;<span class="ident" id="6210772">argstr</span>&nbsp;<span class="op" id="6210779">:=</span>&nbsp;<span class="ident" id="6210782">line</span><span class="op" id="6210786">[</span><span class="op" id="6210787">:</span><span class="ident" id="6210788">i</span><span class="op" id="6210789">]</span><span class="op" id="6210790">,</span>&nbsp;<span class="ident" id="6210792">line</span><span class="op" id="6210796">[</span><span class="ident" id="6210797">i</span><span class="op" id="6210798">+</span><span class="num" id="6210799">1</span><span class="op" id="6210800">:</span><span class="op" id="6210801">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210806">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210836">f</span>&nbsp;<span class="op" id="6210838">:=</span>&nbsp;<span class="ident" id="6210841">strings</span><span class="op" id="6210848">.</span><span class="ident" id="6210849">Fields</span><span class="op" id="6210855">(</span><span class="ident" id="6210856">line</span><span class="op" id="6210860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210864">if</span>&nbsp;<span class="builtinfunc" id="6210867">len</span><span class="op" id="6210870">(</span><span class="ident" id="6210871">f</span><span class="op" id="6210872">)</span>&nbsp;<span class="op" id="6210874">&lt;</span>&nbsp;<span class="num" id="6210876">1</span>&nbsp;<span class="op" id="6210878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210883">return</span>&nbsp;<span class="ident" id="6210890">fmt</span><span class="op" id="6210893">.</span><span class="ident" id="6210894">Errorf</span><span class="op" id="6210900">(</span><span class="string" id="6210901">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6210928">,</span>&nbsp;<span class="ident" id="6210930">filename</span><span class="op" id="6210938">,</span>&nbsp;<span class="ident" id="6210940">orig</span><span class="op" id="6210944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210948">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210953">cond</span><span class="op" id="6210957">,</span>&nbsp;<span class="ident" id="6210959">verb</span>&nbsp;<span class="op" id="6210964">:=</span>&nbsp;<span class="ident" id="6210967">f</span><span class="op" id="6210968">[</span><span class="op" id="6210969">:</span><span class="builtinfunc" id="6210970">len</span><span class="op" id="6210973">(</span><span class="ident" id="6210974">f</span><span class="op" id="6210975">)</span><span class="op" id="6210976">-</span><span class="num" id="6210977">1</span><span class="op" id="6210978">]</span><span class="op" id="6210979">,</span>&nbsp;<span class="ident" id="6210981">f</span><span class="op" id="6210982">[</span><span class="builtinfunc" id="6210983">len</span><span class="op" id="6210986">(</span><span class="ident" id="6210987">f</span><span class="op" id="6210988">)</span><span class="op" id="6210989">-</span><span class="num" id="6210990">1</span><span class="op" id="6210991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210995">if</span>&nbsp;<span class="builtinfunc" id="6210998">len</span><span class="op" id="6211001">(</span><span class="ident" id="6211002">cond</span><span class="op" id="6211006">)</span>&nbsp;<span class="op" id="6211008">&gt;</span>&nbsp;<span class="num" id="6211010">0</span>&nbsp;<span class="op" id="6211012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211017">ok</span>&nbsp;<span class="op" id="6211020">:=</span>&nbsp;<span class="builtintype" id="6211023">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211032">for</span>&nbsp;<span class="ident" id="6211036">_</span><span class="op" id="6211037">,</span>&nbsp;<span class="ident" id="6211039">c</span>&nbsp;<span class="op" id="6211041">:=</span>&nbsp;<span class="keyword" id="6211044">range</span>&nbsp;<span class="ident" id="6211050">cond</span>&nbsp;<span class="op" id="6211055">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211061">if</span>&nbsp;<span class="ident" id="6211064">ctxt</span><span class="op" id="6211068">.</span><span class="ident" id="6211069">match</span><span class="op" id="6211074">(</span><span class="ident" id="6211075">c</span><span class="op" id="6211076">,</span>&nbsp;<span class="ident" id="6211078">nil</span><span class="op" id="6211081">)</span>&nbsp;<span class="op" id="6211083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211090">ok</span>&nbsp;<span class="op" id="6211093">=</span>&nbsp;<span class="builtintype" id="6211095">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211105">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211120">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211125">if</span>&nbsp;<span class="op" id="6211128">!</span><span class="ident" id="6211129">ok</span>&nbsp;<span class="op" id="6211132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211138">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211159">args</span><span class="op" id="6211163">,</span>&nbsp;<span class="ident" id="6211165">err</span>&nbsp;<span class="op" id="6211169">:=</span>&nbsp;<span class="ident" id="6211172">splitQuoted</span><span class="op" id="6211183">(</span><span class="ident" id="6211184">argstr</span><span class="op" id="6211190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211194">if</span>&nbsp;<span class="ident" id="6211197">err</span>&nbsp;<span class="op" id="6211201">!=</span>&nbsp;<span class="ident" id="6211204">nil</span>&nbsp;<span class="op" id="6211208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211213">return</span>&nbsp;<span class="ident" id="6211220">fmt</span><span class="op" id="6211223">.</span><span class="ident" id="6211224">Errorf</span><span class="op" id="6211230">(</span><span class="string" id="6211231">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6211258">,</span>&nbsp;<span class="ident" id="6211260">filename</span><span class="op" id="6211268">,</span>&nbsp;<span class="ident" id="6211270">orig</span><span class="op" id="6211274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211282">for</span>&nbsp;<span class="ident" id="6211286">_</span><span class="op" id="6211287">,</span>&nbsp;<span class="ident" id="6211289">arg</span>&nbsp;<span class="op" id="6211293">:=</span>&nbsp;<span class="keyword" id="6211296">range</span>&nbsp;<span class="ident" id="6211302">args</span>&nbsp;<span class="op" id="6211307">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211312">if</span>&nbsp;<span class="op" id="6211315">!</span><span class="ident" id="6211316">safeCgoName</span><span class="op" id="6211327">(</span><span class="ident" id="6211328">arg</span><span class="op" id="6211331">)</span>&nbsp;<span class="op" id="6211333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211339">return</span>&nbsp;<span class="ident" id="6211346">fmt</span><span class="op" id="6211349">.</span><span class="ident" id="6211350">Errorf</span><span class="op" id="6211356">(</span><span class="string" id="6211357">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="6211390">,</span>&nbsp;<span class="ident" id="6211392">filename</span><span class="op" id="6211400">,</span>&nbsp;<span class="ident" id="6211402">arg</span><span class="op" id="6211405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211419">switch</span>&nbsp;<span class="ident" id="6211426">verb</span>&nbsp;<span class="op" id="6211431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211435">case</span>&nbsp;<span class="string" id="6211440">&#34;CFLAGS&#34;</span><span class="op" id="6211448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211453">di</span><span class="op" id="6211455">.</span><span class="ident" id="6211456">CgoCFLAGS</span>&nbsp;<span class="op" id="6211466">=</span>&nbsp;<span class="builtinfunc" id="6211468">append</span><span class="op" id="6211474">(</span><span class="ident" id="6211475">di</span><span class="op" id="6211477">.</span><span class="ident" id="6211478">CgoCFLAGS</span><span class="op" id="6211487">,</span>&nbsp;<span class="ident" id="6211489">args</span><span class="op" id="6211493">...</span><span class="op" id="6211496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211500">case</span>&nbsp;<span class="string" id="6211505">&#34;CPPFLAGS&#34;</span><span class="op" id="6211515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211520">di</span><span class="op" id="6211522">.</span><span class="ident" id="6211523">CgoCPPFLAGS</span>&nbsp;<span class="op" id="6211535">=</span>&nbsp;<span class="builtinfunc" id="6211537">append</span><span class="op" id="6211543">(</span><span class="ident" id="6211544">di</span><span class="op" id="6211546">.</span><span class="ident" id="6211547">CgoCPPFLAGS</span><span class="op" id="6211558">,</span>&nbsp;<span class="ident" id="6211560">args</span><span class="op" id="6211564">...</span><span class="op" id="6211567">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211571">case</span>&nbsp;<span class="string" id="6211576">&#34;CXXFLAGS&#34;</span><span class="op" id="6211586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211591">di</span><span class="op" id="6211593">.</span><span class="ident" id="6211594">CgoCXXFLAGS</span>&nbsp;<span class="op" id="6211606">=</span>&nbsp;<span class="builtinfunc" id="6211608">append</span><span class="op" id="6211614">(</span><span class="ident" id="6211615">di</span><span class="op" id="6211617">.</span><span class="ident" id="6211618">CgoCXXFLAGS</span><span class="op" id="6211629">,</span>&nbsp;<span class="ident" id="6211631">args</span><span class="op" id="6211635">...</span><span class="op" id="6211638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211642">case</span>&nbsp;<span class="string" id="6211647">&#34;LDFLAGS&#34;</span><span class="op" id="6211656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211661">di</span><span class="op" id="6211663">.</span><span class="ident" id="6211664">CgoLDFLAGS</span>&nbsp;<span class="op" id="6211675">=</span>&nbsp;<span class="builtinfunc" id="6211677">append</span><span class="op" id="6211683">(</span><span class="ident" id="6211684">di</span><span class="op" id="6211686">.</span><span class="ident" id="6211687">CgoLDFLAGS</span><span class="op" id="6211697">,</span>&nbsp;<span class="ident" id="6211699">args</span><span class="op" id="6211703">...</span><span class="op" id="6211706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211710">case</span>&nbsp;<span class="string" id="6211715">&#34;pkg-config&#34;</span><span class="op" id="6211727">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211732">di</span><span class="op" id="6211734">.</span><span class="ident" id="6211735">CgoPkgConfig</span>&nbsp;<span class="op" id="6211748">=</span>&nbsp;<span class="builtinfunc" id="6211750">append</span><span class="op" id="6211756">(</span><span class="ident" id="6211757">di</span><span class="op" id="6211759">.</span><span class="ident" id="6211760">CgoPkgConfig</span><span class="op" id="6211772">,</span>&nbsp;<span class="ident" id="6211774">args</span><span class="op" id="6211778">...</span><span class="op" id="6211781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211785">default</span><span class="op" id="6211792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211797">return</span>&nbsp;<span class="ident" id="6211804">fmt</span><span class="op" id="6211807">.</span><span class="ident" id="6211808">Errorf</span><span class="op" id="6211814">(</span><span class="string" id="6211815">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="6211842">,</span>&nbsp;<span class="ident" id="6211844">filename</span><span class="op" id="6211852">,</span>&nbsp;<span class="ident" id="6211854">orig</span><span class="op" id="6211858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211865">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211868">return</span>&nbsp;<span class="ident" id="6211875">nil</span><br>
<span class="lineno"></span><span class="op" id="6211879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6211882">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="6211987">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="6212097">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="6212127">var</span>&nbsp;<span class="ident" id="6212131">safeBytes</span>&nbsp;<span class="op" id="6212141">=</span>&nbsp;<span class="op" id="6212143">[</span><span class="op" id="6212144">]</span><span class="builtintype" id="6212145">byte</span><span class="op" id="6212149">(</span><span class="string" id="6212150">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="6212223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6212226">func</span>&nbsp;<span class="ident" id="6212231">safeCgoName</span><span class="op" id="6212242">(</span><span class="ident" id="6212243">s</span>&nbsp;<span class="builtintype" id="6212245">string</span><span class="op" id="6212251">)</span>&nbsp;<span class="builtintype" id="6212253">bool</span>&nbsp;<span class="op" id="6212258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212261">if</span>&nbsp;<span class="ident" id="6212264">s</span>&nbsp;<span class="op" id="6212266">==</span>&nbsp;<span class="string" id="6212269">&#34;&#34;</span>&nbsp;<span class="op" id="6212272">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212276">return</span>&nbsp;<span class="builtintype" id="6212283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212293">for</span>&nbsp;<span class="ident" id="6212297">i</span>&nbsp;<span class="op" id="6212299">:=</span>&nbsp;<span class="num" id="6212302">0</span><span class="op" id="6212303">;</span>&nbsp;<span class="ident" id="6212305">i</span>&nbsp;<span class="op" id="6212307">&lt;</span>&nbsp;<span class="builtinfunc" id="6212309">len</span><span class="op" id="6212312">(</span><span class="ident" id="6212313">s</span><span class="op" id="6212314">)</span><span class="op" id="6212315">;</span>&nbsp;<span class="ident" id="6212317">i</span><span class="op" id="6212318">++</span>&nbsp;<span class="op" id="6212321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212325">if</span>&nbsp;<span class="ident" id="6212328">c</span>&nbsp;<span class="op" id="6212330">:=</span>&nbsp;<span class="ident" id="6212333">s</span><span class="op" id="6212334">[</span><span class="ident" id="6212335">i</span><span class="op" id="6212336">]</span><span class="op" id="6212337">;</span>&nbsp;<span class="ident" id="6212339">c</span>&nbsp;<span class="op" id="6212341">&lt;</span>&nbsp;<span class="num" id="6212343">0x80</span>&nbsp;<span class="op" id="6212348">&amp;&amp;</span>&nbsp;<span class="ident" id="6212351">bytes</span><span class="op" id="6212356">.</span><span class="ident" id="6212357">IndexByte</span><span class="op" id="6212366">(</span><span class="ident" id="6212367">safeBytes</span><span class="op" id="6212376">,</span>&nbsp;<span class="ident" id="6212378">c</span><span class="op" id="6212379">)</span>&nbsp;<span class="op" id="6212381">&lt;</span>&nbsp;<span class="num" id="6212383">0</span>&nbsp;<span class="op" id="6212385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212390">return</span>&nbsp;<span class="builtintype" id="6212397">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212411">return</span>&nbsp;<span class="builtintype" id="6212418">true</span><br>
<span class="lineno"></span><span class="op" id="6212423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="6212426">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="6212509">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6212586">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="6212674">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6212756">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="6212837">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6212914">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="6212968">//</span><br>
<span class="lineno"></span><span class="comment" id="6212971">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="6213009">//</span><br>
<span class="lineno">1170</span><span class="comment" id="6213012">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6213043">//</span><br>
<span class="lineno"></span><span class="comment" id="6213046">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="6213069">//</span><br>
<span class="lineno"></span><span class="comment" id="6213072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="6213114">//</span><br>
<span class="lineno"></span><span class="keyword" id="6213117">func</span>&nbsp;<span class="ident" id="6213122">splitQuoted</span><span class="op" id="6213133">(</span><span class="ident" id="6213134">s</span>&nbsp;<span class="builtintype" id="6213136">string</span><span class="op" id="6213142">)</span>&nbsp;<span class="op" id="6213144">(</span><span class="ident" id="6213145">r</span>&nbsp;<span class="op" id="6213147">[</span><span class="op" id="6213148">]</span><span class="builtintype" id="6213149">string</span><span class="op" id="6213155">,</span>&nbsp;<span class="ident" id="6213157">err</span>&nbsp;<span class="builtintype" id="6213161">error</span><span class="op" id="6213166">)</span>&nbsp;<span class="op" id="6213168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213171">var</span>&nbsp;<span class="ident" id="6213175">args</span>&nbsp;<span class="op" id="6213180">[</span><span class="op" id="6213181">]</span><span class="builtintype" id="6213182">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213190">arg</span>&nbsp;<span class="op" id="6213194">:=</span>&nbsp;<span class="builtinfunc" id="6213197">make</span><span class="op" id="6213201">(</span><span class="op" id="6213202">[</span><span class="op" id="6213203">]</span><span class="builtintype" id="6213204">rune</span><span class="op" id="6213208">,</span>&nbsp;<span class="builtinfunc" id="6213210">len</span><span class="op" id="6213213">(</span><span class="ident" id="6213214">s</span><span class="op" id="6213215">)</span><span class="op" id="6213216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213219">escaped</span>&nbsp;<span class="op" id="6213227">:=</span>&nbsp;<span class="builtintype" id="6213230">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213237">quoted</span>&nbsp;<span class="op" id="6213244">:=</span>&nbsp;<span class="builtintype" id="6213247">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213254">quote</span>&nbsp;<span class="op" id="6213260">:=</span>&nbsp;<span class="string" id="6213263">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213271">i</span>&nbsp;<span class="op" id="6213273">:=</span>&nbsp;<span class="num" id="6213276">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213279">for</span>&nbsp;<span class="ident" id="6213283">_</span><span class="op" id="6213284">,</span>&nbsp;<span class="builtintype" id="6213286">rune</span>&nbsp;<span class="op" id="6213291">:=</span>&nbsp;<span class="keyword" id="6213294">range</span>&nbsp;<span class="ident" id="6213300">s</span>&nbsp;<span class="op" id="6213302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213306">switch</span>&nbsp;<span class="op" id="6213313">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213317">case</span>&nbsp;<span class="ident" id="6213322">escaped</span><span class="op" id="6213329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213334">escaped</span>&nbsp;<span class="op" id="6213342">=</span>&nbsp;<span class="builtintype" id="6213344">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213352">case</span>&nbsp;<span class="builtintype" id="6213357">rune</span>&nbsp;<span class="op" id="6213362">==</span>&nbsp;<span class="string" id="6213365">&#39;\\&#39;</span><span class="op" id="6213369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213374">escaped</span>&nbsp;<span class="op" id="6213382">=</span>&nbsp;<span class="builtintype" id="6213384">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213392">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213403">case</span>&nbsp;<span class="ident" id="6213408">quote</span>&nbsp;<span class="op" id="6213414">!=</span>&nbsp;<span class="string" id="6213417">&#39;\x00&#39;</span><span class="op" id="6213423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213428">if</span>&nbsp;<span class="builtintype" id="6213431">rune</span>&nbsp;<span class="op" id="6213436">==</span>&nbsp;<span class="ident" id="6213439">quote</span>&nbsp;<span class="op" id="6213445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213451">quote</span>&nbsp;<span class="op" id="6213457">=</span>&nbsp;<span class="string" id="6213459">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213470">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213482">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213486">case</span>&nbsp;<span class="builtintype" id="6213491">rune</span>&nbsp;<span class="op" id="6213496">==</span>&nbsp;<span class="string" id="6213499">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6213503">||</span>&nbsp;<span class="builtintype" id="6213506">rune</span>&nbsp;<span class="op" id="6213511">==</span>&nbsp;<span class="string" id="6213514">&#39;\&#39;&#39;</span><span class="op" id="6213518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213523">quoted</span>&nbsp;<span class="op" id="6213530">=</span>&nbsp;<span class="builtintype" id="6213532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213540">quote</span>&nbsp;<span class="op" id="6213546">=</span>&nbsp;<span class="builtintype" id="6213548">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213556">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213567">case</span>&nbsp;<span class="ident" id="6213572">unicode</span><span class="op" id="6213579">.</span><span class="ident" id="6213580">IsSpace</span><span class="op" id="6213587">(</span><span class="builtintype" id="6213588">rune</span><span class="op" id="6213592">)</span><span class="op" id="6213593">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213598">if</span>&nbsp;<span class="ident" id="6213601">quoted</span>&nbsp;<span class="op" id="6213608">||</span>&nbsp;<span class="ident" id="6213611">i</span>&nbsp;<span class="op" id="6213613">&gt;</span>&nbsp;<span class="num" id="6213615">0</span>&nbsp;<span class="op" id="6213617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213623">quoted</span>&nbsp;<span class="op" id="6213630">=</span>&nbsp;<span class="builtintype" id="6213632">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213642">args</span>&nbsp;<span class="op" id="6213647">=</span>&nbsp;<span class="builtinfunc" id="6213649">append</span><span class="op" id="6213655">(</span><span class="ident" id="6213656">args</span><span class="op" id="6213660">,</span>&nbsp;<span class="builtintype" id="6213662">string</span><span class="op" id="6213668">(</span><span class="ident" id="6213669">arg</span><span class="op" id="6213672">[</span><span class="op" id="6213673">:</span><span class="ident" id="6213674">i</span><span class="op" id="6213675">]</span><span class="op" id="6213676">)</span><span class="op" id="6213677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213683">i</span>&nbsp;<span class="op" id="6213685">=</span>&nbsp;<span class="num" id="6213687">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213692">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213697">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213712">arg</span><span class="op" id="6213715">[</span><span class="ident" id="6213716">i</span><span class="op" id="6213717">]</span>&nbsp;<span class="op" id="6213719">=</span>&nbsp;<span class="builtintype" id="6213721">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213728">i</span><span class="op" id="6213729">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213733">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213736">if</span>&nbsp;<span class="ident" id="6213739">quoted</span>&nbsp;<span class="op" id="6213746">||</span>&nbsp;<span class="ident" id="6213749">i</span>&nbsp;<span class="op" id="6213751">&gt;</span>&nbsp;<span class="num" id="6213753">0</span>&nbsp;<span class="op" id="6213755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213759">args</span>&nbsp;<span class="op" id="6213764">=</span>&nbsp;<span class="builtinfunc" id="6213766">append</span><span class="op" id="6213772">(</span><span class="ident" id="6213773">args</span><span class="op" id="6213777">,</span>&nbsp;<span class="builtintype" id="6213779">string</span><span class="op" id="6213785">(</span><span class="ident" id="6213786">arg</span><span class="op" id="6213789">[</span><span class="op" id="6213790">:</span><span class="ident" id="6213791">i</span><span class="op" id="6213792">]</span><span class="op" id="6213793">)</span><span class="op" id="6213794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213800">if</span>&nbsp;<span class="ident" id="6213803">quote</span>&nbsp;<span class="op" id="6213809">!=</span>&nbsp;<span class="num" id="6213812">0</span>&nbsp;<span class="op" id="6213814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213818">err</span>&nbsp;<span class="op" id="6213822">=</span>&nbsp;<span class="ident" id="6213824">errors</span><span class="op" id="6213830">.</span><span class="ident" id="6213831">New</span><span class="op" id="6213834">(</span><span class="string" id="6213835">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="6213851">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213854">}</span>&nbsp;<span class="keyword" id="6213856">else</span>&nbsp;<span class="keyword" id="6213861">if</span>&nbsp;<span class="ident" id="6213864">escaped</span>&nbsp;<span class="op" id="6213872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213876">err</span>&nbsp;<span class="op" id="6213880">=</span>&nbsp;<span class="ident" id="6213882">errors</span><span class="op" id="6213888">.</span><span class="ident" id="6213889">New</span><span class="op" id="6213892">(</span><span class="string" id="6213893">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="6213914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213920">return</span>&nbsp;<span class="ident" id="6213927">args</span><span class="op" id="6213931">,</span>&nbsp;<span class="ident" id="6213933">err</span><br>
<span class="lineno"></span><span class="op" id="6213937">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="6213940">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="6213985">//</span><br>
<span class="lineno"></span><span class="comment" id="6213988">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="6213997">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="6214008">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="6214035">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="6214064">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6214081">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6214099">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="6214163">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="6214232">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="6214274">//</span><br>
<span class="lineno"></span><span class="keyword" id="6214277">func</span>&nbsp;<span class="op" id="6214282">(</span><span class="ident" id="6214283">ctxt</span>&nbsp;<span class="op" id="6214288">*</span><span class="ident" id="6214289">Context</span><span class="op" id="6214296">)</span>&nbsp;<span class="ident" id="6214298">match</span><span class="op" id="6214303">(</span><span class="ident" id="6214304">name</span>&nbsp;<span class="builtintype" id="6214309">string</span><span class="op" id="6214315">,</span>&nbsp;<span class="ident" id="6214317">allTags</span>&nbsp;<span class="keyword" id="6214325">map</span><span class="op" id="6214328">[</span><span class="builtintype" id="6214329">string</span><span class="op" id="6214335">]</span><span class="builtintype" id="6214336">bool</span><span class="op" id="6214340">)</span>&nbsp;<span class="builtintype" id="6214342">bool</span>&nbsp;<span class="op" id="6214347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214350">if</span>&nbsp;<span class="ident" id="6214353">name</span>&nbsp;<span class="op" id="6214358">==</span>&nbsp;<span class="string" id="6214361">&#34;&#34;</span>&nbsp;<span class="op" id="6214364">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214368">if</span>&nbsp;<span class="ident" id="6214371">allTags</span>&nbsp;<span class="op" id="6214379">!=</span>&nbsp;<span class="ident" id="6214382">nil</span>&nbsp;<span class="op" id="6214386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214391">allTags</span><span class="op" id="6214398">[</span><span class="ident" id="6214399">name</span><span class="op" id="6214403">]</span>&nbsp;<span class="op" id="6214405">=</span>&nbsp;<span class="builtintype" id="6214407">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214418">return</span>&nbsp;<span class="builtintype" id="6214425">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214432">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214435">if</span>&nbsp;<span class="ident" id="6214438">i</span>&nbsp;<span class="op" id="6214440">:=</span>&nbsp;<span class="ident" id="6214443">strings</span><span class="op" id="6214450">.</span><span class="ident" id="6214451">Index</span><span class="op" id="6214456">(</span><span class="ident" id="6214457">name</span><span class="op" id="6214461">,</span>&nbsp;<span class="string" id="6214463">&#34;,&#34;</span><span class="op" id="6214466">)</span><span class="op" id="6214467">;</span>&nbsp;<span class="ident" id="6214469">i</span>&nbsp;<span class="op" id="6214471">&gt;=</span>&nbsp;<span class="num" id="6214474">0</span>&nbsp;<span class="op" id="6214476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214480">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214506">ok1</span>&nbsp;<span class="op" id="6214510">:=</span>&nbsp;<span class="ident" id="6214513">ctxt</span><span class="op" id="6214517">.</span><span class="ident" id="6214518">match</span><span class="op" id="6214523">(</span><span class="ident" id="6214524">name</span><span class="op" id="6214528">[</span><span class="op" id="6214529">:</span><span class="ident" id="6214530">i</span><span class="op" id="6214531">]</span><span class="op" id="6214532">,</span>&nbsp;<span class="ident" id="6214534">allTags</span><span class="op" id="6214541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214545">ok2</span>&nbsp;<span class="op" id="6214549">:=</span>&nbsp;<span class="ident" id="6214552">ctxt</span><span class="op" id="6214556">.</span><span class="ident" id="6214557">match</span><span class="op" id="6214562">(</span><span class="ident" id="6214563">name</span><span class="op" id="6214567">[</span><span class="ident" id="6214568">i</span><span class="op" id="6214569">+</span><span class="num" id="6214570">1</span><span class="op" id="6214571">:</span><span class="op" id="6214572">]</span><span class="op" id="6214573">,</span>&nbsp;<span class="ident" id="6214575">allTags</span><span class="op" id="6214582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214586">return</span>&nbsp;<span class="ident" id="6214593">ok1</span>&nbsp;<span class="op" id="6214597">&amp;&amp;</span>&nbsp;<span class="ident" id="6214600">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214608">if</span>&nbsp;<span class="ident" id="6214611">strings</span><span class="op" id="6214618">.</span><span class="ident" id="6214619">HasPrefix</span><span class="op" id="6214628">(</span><span class="ident" id="6214629">name</span><span class="op" id="6214633">,</span>&nbsp;<span class="string" id="6214635">&#34;!!&#34;</span><span class="op" id="6214639">)</span>&nbsp;<span class="op" id="6214641">{</span>&nbsp;<span class="comment" id="6214643">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214674">return</span>&nbsp;<span class="builtintype" id="6214681">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214691">if</span>&nbsp;<span class="ident" id="6214694">strings</span><span class="op" id="6214701">.</span><span class="ident" id="6214702">HasPrefix</span><span class="op" id="6214711">(</span><span class="ident" id="6214712">name</span><span class="op" id="6214716">,</span>&nbsp;<span class="string" id="6214718">&#34;!&#34;</span><span class="op" id="6214721">)</span>&nbsp;<span class="op" id="6214723">{</span>&nbsp;<span class="comment" id="6214725">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214739">return</span>&nbsp;<span class="builtinfunc" id="6214746">len</span><span class="op" id="6214749">(</span><span class="ident" id="6214750">name</span><span class="op" id="6214754">)</span>&nbsp;<span class="op" id="6214756">&gt;</span>&nbsp;<span class="num" id="6214758">1</span>&nbsp;<span class="op" id="6214760">&amp;&amp;</span>&nbsp;<span class="op" id="6214763">!</span><span class="ident" id="6214764">ctxt</span><span class="op" id="6214768">.</span><span class="ident" id="6214769">match</span><span class="op" id="6214774">(</span><span class="ident" id="6214775">name</span><span class="op" id="6214779">[</span><span class="num" id="6214780">1</span><span class="op" id="6214781">:</span><span class="op" id="6214782">]</span><span class="op" id="6214783">,</span>&nbsp;<span class="ident" id="6214785">allTags</span><span class="op" id="6214792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214799">if</span>&nbsp;<span class="ident" id="6214802">allTags</span>&nbsp;<span class="op" id="6214810">!=</span>&nbsp;<span class="ident" id="6214813">nil</span>&nbsp;<span class="op" id="6214817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214821">allTags</span><span class="op" id="6214828">[</span><span class="ident" id="6214829">name</span><span class="op" id="6214833">]</span>&nbsp;<span class="op" id="6214835">=</span>&nbsp;<span class="builtintype" id="6214837">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214847">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214902">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214967">for</span>&nbsp;<span class="ident" id="6214971">_</span><span class="op" id="6214972">,</span>&nbsp;<span class="ident" id="6214974">c</span>&nbsp;<span class="op" id="6214976">:=</span>&nbsp;<span class="keyword" id="6214979">range</span>&nbsp;<span class="ident" id="6214985">name</span>&nbsp;<span class="op" id="6214990">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214994">if</span>&nbsp;<span class="op" id="6214997">!</span><span class="ident" id="6214998">unicode</span><span class="op" id="6215005">.</span><span class="ident" id="6215006">IsLetter</span><span class="op" id="6215014">(</span><span class="ident" id="6215015">c</span><span class="op" id="6215016">)</span>&nbsp;<span class="op" id="6215018">&amp;&amp;</span>&nbsp;<span class="op" id="6215021">!</span><span class="ident" id="6215022">unicode</span><span class="op" id="6215029">.</span><span class="ident" id="6215030">IsDigit</span><span class="op" id="6215037">(</span><span class="ident" id="6215038">c</span><span class="op" id="6215039">)</span>&nbsp;<span class="op" id="6215041">&amp;&amp;</span>&nbsp;<span class="ident" id="6215044">c</span>&nbsp;<span class="op" id="6215046">!=</span>&nbsp;<span class="string" id="6215049">&#39;_&#39;</span>&nbsp;<span class="op" id="6215053">&amp;&amp;</span>&nbsp;<span class="ident" id="6215056">c</span>&nbsp;<span class="op" id="6215058">!=</span>&nbsp;<span class="string" id="6215061">&#39;.&#39;</span>&nbsp;<span class="op" id="6215065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215070">return</span>&nbsp;<span class="builtintype" id="6215077">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215092">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215109">if</span>&nbsp;<span class="ident" id="6215112">ctxt</span><span class="op" id="6215116">.</span><span class="ident" id="6215117">CgoEnabled</span>&nbsp;<span class="op" id="6215128">&amp;&amp;</span>&nbsp;<span class="ident" id="6215131">name</span>&nbsp;<span class="op" id="6215136">==</span>&nbsp;<span class="string" id="6215139">&#34;cgo&#34;</span>&nbsp;<span class="op" id="6215145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215149">return</span>&nbsp;<span class="builtintype" id="6215156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215165">if</span>&nbsp;<span class="ident" id="6215168">name</span>&nbsp;<span class="op" id="6215173">==</span>&nbsp;<span class="ident" id="6215176">ctxt</span><span class="op" id="6215180">.</span><span class="ident" id="6215181">GOOS</span>&nbsp;<span class="op" id="6215186">||</span>&nbsp;<span class="ident" id="6215189">name</span>&nbsp;<span class="op" id="6215194">==</span>&nbsp;<span class="ident" id="6215197">ctxt</span><span class="op" id="6215201">.</span><span class="ident" id="6215202">GOARCH</span>&nbsp;<span class="op" id="6215209">||</span>&nbsp;<span class="ident" id="6215212">name</span>&nbsp;<span class="op" id="6215217">==</span>&nbsp;<span class="ident" id="6215220">ctxt</span><span class="op" id="6215224">.</span><span class="ident" id="6215225">Compiler</span>&nbsp;<span class="op" id="6215234">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215238">return</span>&nbsp;<span class="builtintype" id="6215245">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215254">if</span>&nbsp;<span class="ident" id="6215257">ctxt</span><span class="op" id="6215261">.</span><span class="ident" id="6215262">GOOS</span>&nbsp;<span class="op" id="6215267">==</span>&nbsp;<span class="string" id="6215270">&#34;android&#34;</span>&nbsp;<span class="op" id="6215280">&amp;&amp;</span>&nbsp;<span class="ident" id="6215283">name</span>&nbsp;<span class="op" id="6215288">==</span>&nbsp;<span class="string" id="6215291">&#34;linux&#34;</span>&nbsp;<span class="op" id="6215299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215303">return</span>&nbsp;<span class="builtintype" id="6215310">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215316">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215320">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215335">for</span>&nbsp;<span class="ident" id="6215339">_</span><span class="op" id="6215340">,</span>&nbsp;<span class="ident" id="6215342">tag</span>&nbsp;<span class="op" id="6215346">:=</span>&nbsp;<span class="keyword" id="6215349">range</span>&nbsp;<span class="ident" id="6215355">ctxt</span><span class="op" id="6215359">.</span><span class="ident" id="6215360">BuildTags</span>&nbsp;<span class="op" id="6215370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215374">if</span>&nbsp;<span class="ident" id="6215377">tag</span>&nbsp;<span class="op" id="6215381">==</span>&nbsp;<span class="ident" id="6215384">name</span>&nbsp;<span class="op" id="6215389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215394">return</span>&nbsp;<span class="builtintype" id="6215401">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215414">for</span>&nbsp;<span class="ident" id="6215418">_</span><span class="op" id="6215419">,</span>&nbsp;<span class="ident" id="6215421">tag</span>&nbsp;<span class="op" id="6215425">:=</span>&nbsp;<span class="keyword" id="6215428">range</span>&nbsp;<span class="ident" id="6215434">ctxt</span><span class="op" id="6215438">.</span><span class="ident" id="6215439">ReleaseTags</span>&nbsp;<span class="op" id="6215451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215455">if</span>&nbsp;<span class="ident" id="6215458">tag</span>&nbsp;<span class="op" id="6215462">==</span>&nbsp;<span class="ident" id="6215465">name</span>&nbsp;<span class="op" id="6215470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215475">return</span>&nbsp;<span class="builtintype" id="6215482">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215496">return</span>&nbsp;<span class="builtintype" id="6215503">false</span><br>
<span class="lineno"></span><span class="op" id="6215509">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="6215512">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="6215584">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="6215635">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6215671">//</span><br>
<span class="lineno">1295</span><span class="comment" id="6215674">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="6215696">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6215720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6215752">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6215779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="6215808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6215845">//</span><br>
<span class="lineno"></span><span class="comment" id="6215848">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="6215927">func</span>&nbsp;<span class="op" id="6215932">(</span><span class="ident" id="6215933">ctxt</span>&nbsp;<span class="op" id="6215938">*</span><span class="ident" id="6215939">Context</span><span class="op" id="6215946">)</span>&nbsp;<span class="ident" id="6215948">goodOSArchFile</span><span class="op" id="6215962">(</span><span class="ident" id="6215963">name</span>&nbsp;<span class="builtintype" id="6215968">string</span><span class="op" id="6215974">,</span>&nbsp;<span class="ident" id="6215976">allTags</span>&nbsp;<span class="keyword" id="6215984">map</span><span class="op" id="6215987">[</span><span class="builtintype" id="6215988">string</span><span class="op" id="6215994">]</span><span class="builtintype" id="6215995">bool</span><span class="op" id="6215999">)</span>&nbsp;<span class="builtintype" id="6216001">bool</span>&nbsp;<span class="op" id="6216006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216009">if</span>&nbsp;<span class="ident" id="6216012">dot</span>&nbsp;<span class="op" id="6216016">:=</span>&nbsp;<span class="ident" id="6216019">strings</span><span class="op" id="6216026">.</span><span class="ident" id="6216027">Index</span><span class="op" id="6216032">(</span><span class="ident" id="6216033">name</span><span class="op" id="6216037">,</span>&nbsp;<span class="string" id="6216039">&#34;.&#34;</span><span class="op" id="6216042">)</span><span class="op" id="6216043">;</span>&nbsp;<span class="ident" id="6216045">dot</span>&nbsp;<span class="op" id="6216049">!=</span>&nbsp;<span class="op" id="6216052">-</span><span class="num" id="6216053">1</span>&nbsp;<span class="op" id="6216055">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216059">name</span>&nbsp;<span class="op" id="6216064">=</span>&nbsp;<span class="ident" id="6216066">name</span><span class="op" id="6216070">[</span><span class="op" id="6216071">:</span><span class="ident" id="6216072">dot</span><span class="op" id="6216075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6216078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216082">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216158">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216233">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216301">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216379">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216454">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6216529">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216567">i</span>&nbsp;<span class="op" id="6216569">:=</span>&nbsp;<span class="ident" id="6216572">strings</span><span class="op" id="6216579">.</span><span class="ident" id="6216580">Index</span><span class="op" id="6216585">(</span><span class="ident" id="6216586">name</span><span class="op" id="6216590">,</span>&nbsp;<span class="string" id="6216592">&#34;_&#34;</span><span class="op" id="6216595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216598">if</span>&nbsp;<span class="ident" id="6216601">i</span>&nbsp;<span class="op" id="6216603">&lt;</span>&nbsp;<span class="num" id="6216605">0</span>&nbsp;<span class="op" id="6216607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216611">return</span>&nbsp;<span class="builtintype" id="6216618">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6216624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216627">name</span>&nbsp;<span class="op" id="6216632">=</span>&nbsp;<span class="ident" id="6216634">name</span><span class="op" id="6216638">[</span><span class="ident" id="6216639">i</span><span class="op" id="6216640">:</span><span class="op" id="6216641">]</span>&nbsp;<span class="comment" id="6216643">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216681">l</span>&nbsp;<span class="op" id="6216683">:=</span>&nbsp;<span class="ident" id="6216686">strings</span><span class="op" id="6216693">.</span><span class="ident" id="6216694">Split</span><span class="op" id="6216699">(</span><span class="ident" id="6216700">name</span><span class="op" id="6216704">,</span>&nbsp;<span class="string" id="6216706">&#34;_&#34;</span><span class="op" id="6216709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216712">if</span>&nbsp;<span class="ident" id="6216715">n</span>&nbsp;<span class="op" id="6216717">:=</span>&nbsp;<span class="builtinfunc" id="6216720">len</span><span class="op" id="6216723">(</span><span class="ident" id="6216724">l</span><span class="op" id="6216725">)</span><span class="op" id="6216726">;</span>&nbsp;<span class="ident" id="6216728">n</span>&nbsp;<span class="op" id="6216730">&gt;</span>&nbsp;<span class="num" id="6216732">0</span>&nbsp;<span class="op" id="6216734">&amp;&amp;</span>&nbsp;<span class="ident" id="6216737">l</span><span class="op" id="6216738">[</span><span class="ident" id="6216739">n</span><span class="op" id="6216740">-</span><span class="num" id="6216741">1</span><span class="op" id="6216742">]</span>&nbsp;<span class="op" id="6216744">==</span>&nbsp;<span class="string" id="6216747">&#34;test&#34;</span>&nbsp;<span class="op" id="6216754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216758">l</span>&nbsp;<span class="op" id="6216760">=</span>&nbsp;<span class="ident" id="6216762">l</span><span class="op" id="6216763">[</span><span class="op" id="6216764">:</span><span class="ident" id="6216765">n</span><span class="op" id="6216766">-</span><span class="num" id="6216767">1</span><span class="op" id="6216768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6216771">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216774">n</span>&nbsp;<span class="op" id="6216776">:=</span>&nbsp;<span class="builtinfunc" id="6216779">len</span><span class="op" id="6216782">(</span><span class="ident" id="6216783">l</span><span class="op" id="6216784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216787">if</span>&nbsp;<span class="ident" id="6216790">n</span>&nbsp;<span class="op" id="6216792">&gt;=</span>&nbsp;<span class="num" id="6216795">2</span>&nbsp;<span class="op" id="6216797">&amp;&amp;</span>&nbsp;<span class="ident" id="6216800">knownOS</span><span class="op" id="6216807">[</span><span class="ident" id="6216808">l</span><span class="op" id="6216809">[</span><span class="ident" id="6216810">n</span><span class="op" id="6216811">-</span><span class="num" id="6216812">2</span><span class="op" id="6216813">]</span><span class="op" id="6216814">]</span>&nbsp;<span class="op" id="6216816">&amp;&amp;</span>&nbsp;<span class="ident" id="6216819">knownArch</span><span class="op" id="6216828">[</span><span class="ident" id="6216829">l</span><span class="op" id="6216830">[</span><span class="ident" id="6216831">n</span><span class="op" id="6216832">-</span><span class="num" id="6216833">1</span><span class="op" id="6216834">]</span><span class="op" id="6216835">]</span>&nbsp;<span class="op" id="6216837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216841">if</span>&nbsp;<span class="ident" id="6216844">allTags</span>&nbsp;<span class="op" id="6216852">!=</span>&nbsp;<span class="ident" id="6216855">nil</span>&nbsp;<span class="op" id="6216859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216864">allTags</span><span class="op" id="6216871">[</span><span class="ident" id="6216872">l</span><span class="op" id="6216873">[</span><span class="ident" id="6216874">n</span><span class="op" id="6216875">-</span><span class="num" id="6216876">2</span><span class="op" id="6216877">]</span><span class="op" id="6216878">]</span>&nbsp;<span class="op" id="6216880">=</span>&nbsp;<span class="builtintype" id="6216882">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216890">allTags</span><span class="op" id="6216897">[</span><span class="ident" id="6216898">l</span><span class="op" id="6216899">[</span><span class="ident" id="6216900">n</span><span class="op" id="6216901">-</span><span class="num" id="6216902">1</span><span class="op" id="6216903">]</span><span class="op" id="6216904">]</span>&nbsp;<span class="op" id="6216906">=</span>&nbsp;<span class="builtintype" id="6216908">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6216915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216919">if</span>&nbsp;<span class="ident" id="6216922">l</span><span class="op" id="6216923">[</span><span class="ident" id="6216924">n</span><span class="op" id="6216925">-</span><span class="num" id="6216926">1</span><span class="op" id="6216927">]</span>&nbsp;<span class="op" id="6216929">!=</span>&nbsp;<span class="ident" id="6216932">ctxt</span><span class="op" id="6216936">.</span><span class="ident" id="6216937">GOARCH</span>&nbsp;<span class="op" id="6216944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216949">return</span>&nbsp;<span class="builtintype" id="6216956">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6216964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216968">if</span>&nbsp;<span class="ident" id="6216971">ctxt</span><span class="op" id="6216975">.</span><span class="ident" id="6216976">GOOS</span>&nbsp;<span class="op" id="6216981">==</span>&nbsp;<span class="string" id="6216984">&#34;android&#34;</span>&nbsp;<span class="op" id="6216994">&amp;&amp;</span>&nbsp;<span class="ident" id="6216997">l</span><span class="op" id="6216998">[</span><span class="ident" id="6216999">n</span><span class="op" id="6217000">-</span><span class="num" id="6217001">2</span><span class="op" id="6217002">]</span>&nbsp;<span class="op" id="6217004">==</span>&nbsp;<span class="string" id="6217007">&#34;linux&#34;</span>&nbsp;<span class="op" id="6217015">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217020">return</span>&nbsp;<span class="builtintype" id="6217027">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217038">return</span>&nbsp;<span class="ident" id="6217045">l</span><span class="op" id="6217046">[</span><span class="ident" id="6217047">n</span><span class="op" id="6217048">-</span><span class="num" id="6217049">2</span><span class="op" id="6217050">]</span>&nbsp;<span class="op" id="6217052">==</span>&nbsp;<span class="ident" id="6217055">ctxt</span><span class="op" id="6217059">.</span><span class="ident" id="6217060">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217069">if</span>&nbsp;<span class="ident" id="6217072">n</span>&nbsp;<span class="op" id="6217074">&gt;=</span>&nbsp;<span class="num" id="6217077">1</span>&nbsp;<span class="op" id="6217079">&amp;&amp;</span>&nbsp;<span class="ident" id="6217082">knownOS</span><span class="op" id="6217089">[</span><span class="ident" id="6217090">l</span><span class="op" id="6217091">[</span><span class="ident" id="6217092">n</span><span class="op" id="6217093">-</span><span class="num" id="6217094">1</span><span class="op" id="6217095">]</span><span class="op" id="6217096">]</span>&nbsp;<span class="op" id="6217098">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217102">if</span>&nbsp;<span class="ident" id="6217105">allTags</span>&nbsp;<span class="op" id="6217113">!=</span>&nbsp;<span class="ident" id="6217116">nil</span>&nbsp;<span class="op" id="6217120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217125">allTags</span><span class="op" id="6217132">[</span><span class="ident" id="6217133">l</span><span class="op" id="6217134">[</span><span class="ident" id="6217135">n</span><span class="op" id="6217136">-</span><span class="num" id="6217137">1</span><span class="op" id="6217138">]</span><span class="op" id="6217139">]</span>&nbsp;<span class="op" id="6217141">=</span>&nbsp;<span class="builtintype" id="6217143">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217154">if</span>&nbsp;<span class="ident" id="6217157">ctxt</span><span class="op" id="6217161">.</span><span class="ident" id="6217162">GOOS</span>&nbsp;<span class="op" id="6217167">==</span>&nbsp;<span class="string" id="6217170">&#34;android&#34;</span>&nbsp;<span class="op" id="6217180">&amp;&amp;</span>&nbsp;<span class="ident" id="6217183">l</span><span class="op" id="6217184">[</span><span class="ident" id="6217185">n</span><span class="op" id="6217186">-</span><span class="num" id="6217187">1</span><span class="op" id="6217188">]</span>&nbsp;<span class="op" id="6217190">==</span>&nbsp;<span class="string" id="6217193">&#34;linux&#34;</span>&nbsp;<span class="op" id="6217201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217206">return</span>&nbsp;<span class="builtintype" id="6217213">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217224">return</span>&nbsp;<span class="ident" id="6217231">l</span><span class="op" id="6217232">[</span><span class="ident" id="6217233">n</span><span class="op" id="6217234">-</span><span class="num" id="6217235">1</span><span class="op" id="6217236">]</span>&nbsp;<span class="op" id="6217238">==</span>&nbsp;<span class="ident" id="6217241">ctxt</span><span class="op" id="6217245">.</span><span class="ident" id="6217246">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217255">if</span>&nbsp;<span class="ident" id="6217258">n</span>&nbsp;<span class="op" id="6217260">&gt;=</span>&nbsp;<span class="num" id="6217263">1</span>&nbsp;<span class="op" id="6217265">&amp;&amp;</span>&nbsp;<span class="ident" id="6217268">knownArch</span><span class="op" id="6217277">[</span><span class="ident" id="6217278">l</span><span class="op" id="6217279">[</span><span class="ident" id="6217280">n</span><span class="op" id="6217281">-</span><span class="num" id="6217282">1</span><span class="op" id="6217283">]</span><span class="op" id="6217284">]</span>&nbsp;<span class="op" id="6217286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217290">if</span>&nbsp;<span class="ident" id="6217293">allTags</span>&nbsp;<span class="op" id="6217301">!=</span>&nbsp;<span class="ident" id="6217304">nil</span>&nbsp;<span class="op" id="6217308">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217313">allTags</span><span class="op" id="6217320">[</span><span class="ident" id="6217321">l</span><span class="op" id="6217322">[</span><span class="ident" id="6217323">n</span><span class="op" id="6217324">-</span><span class="num" id="6217325">1</span><span class="op" id="6217326">]</span><span class="op" id="6217327">]</span>&nbsp;<span class="op" id="6217329">=</span>&nbsp;<span class="builtintype" id="6217331">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217342">return</span>&nbsp;<span class="ident" id="6217349">l</span><span class="op" id="6217350">[</span><span class="ident" id="6217351">n</span><span class="op" id="6217352">-</span><span class="num" id="6217353">1</span><span class="op" id="6217354">]</span>&nbsp;<span class="op" id="6217356">==</span>&nbsp;<span class="ident" id="6217359">ctxt</span><span class="op" id="6217363">.</span><span class="ident" id="6217364">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217375">return</span>&nbsp;<span class="builtintype" id="6217382">true</span><br>
<span class="lineno">1355</span><span class="op" id="6217387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6217390">var</span>&nbsp;<span class="ident" id="6217394">knownOS</span>&nbsp;<span class="op" id="6217402">=</span>&nbsp;<span class="builtinfunc" id="6217404">make</span><span class="op" id="6217408">(</span><span class="keyword" id="6217409">map</span><span class="op" id="6217412">[</span><span class="builtintype" id="6217413">string</span><span class="op" id="6217419">]</span><span class="builtintype" id="6217420">bool</span><span class="op" id="6217424">)</span><br>
<span class="lineno"></span><span class="keyword" id="6217426">var</span>&nbsp;<span class="ident" id="6217430">knownArch</span>&nbsp;<span class="op" id="6217440">=</span>&nbsp;<span class="builtinfunc" id="6217442">make</span><span class="op" id="6217446">(</span><span class="keyword" id="6217447">map</span><span class="op" id="6217450">[</span><span class="builtintype" id="6217451">string</span><span class="op" id="6217457">]</span><span class="builtintype" id="6217458">bool</span><span class="op" id="6217462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="6217465">func</span>&nbsp;<span class="ident" id="6217470">init</span><span class="op" id="6217474">(</span><span class="op" id="6217475">)</span>&nbsp;<span class="op" id="6217477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217480">for</span>&nbsp;<span class="ident" id="6217484">_</span><span class="op" id="6217485">,</span>&nbsp;<span class="ident" id="6217487">v</span>&nbsp;<span class="op" id="6217489">:=</span>&nbsp;<span class="keyword" id="6217492">range</span>&nbsp;<span class="ident" id="6217498">strings</span><span class="op" id="6217505">.</span><span class="ident" id="6217506">Fields</span><span class="op" id="6217512">(</span><span class="ident" id="6217513">goosList</span><span class="op" id="6217521">)</span>&nbsp;<span class="op" id="6217523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217527">knownOS</span><span class="op" id="6217534">[</span><span class="ident" id="6217535">v</span><span class="op" id="6217536">]</span>&nbsp;<span class="op" id="6217538">=</span>&nbsp;<span class="builtintype" id="6217540">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217549">for</span>&nbsp;<span class="ident" id="6217553">_</span><span class="op" id="6217554">,</span>&nbsp;<span class="ident" id="6217556">v</span>&nbsp;<span class="op" id="6217558">:=</span>&nbsp;<span class="keyword" id="6217561">range</span>&nbsp;<span class="ident" id="6217567">strings</span><span class="op" id="6217574">.</span><span class="ident" id="6217575">Fields</span><span class="op" id="6217581">(</span><span class="ident" id="6217582">goarchList</span><span class="op" id="6217592">)</span>&nbsp;<span class="op" id="6217594">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217598">knownArch</span><span class="op" id="6217607">[</span><span class="ident" id="6217608">v</span><span class="op" id="6217609">]</span>&nbsp;<span class="op" id="6217611">=</span>&nbsp;<span class="builtintype" id="6217613">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217619">}</span><br>
<span class="lineno"></span><span class="op" id="6217621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6217624">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="6217676">var</span>&nbsp;<span class="ident" id="6217680">ToolDir</span>&nbsp;<span class="op" id="6217688">=</span>&nbsp;<span class="ident" id="6217690">filepath</span><span class="op" id="6217698">.</span><span class="ident" id="6217699">Join</span><span class="op" id="6217703">(</span><span class="ident" id="6217704">runtime</span><span class="op" id="6217711">.</span><span class="ident" id="6217712">GOROOT</span><span class="op" id="6217718">(</span><span class="op" id="6217719">)</span><span class="op" id="6217720">,</span>&nbsp;<span class="string" id="6217722">&#34;pkg/tool/&#34;</span><span class="op" id="6217733">+</span><span class="ident" id="6217734">runtime</span><span class="op" id="6217741">.</span><span class="ident" id="6217742">GOOS</span><span class="op" id="6217746">+</span><span class="string" id="6217747">&#34;_&#34;</span><span class="op" id="6217750">+</span><span class="ident" id="6217751">runtime</span><span class="op" id="6217758">.</span><span class="ident" id="6217759">GOARCH</span><span class="op" id="6217765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6217768">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6217820">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6217882">func</span>&nbsp;<span class="ident" id="6217887">IsLocalImport</span><span class="op" id="6217900">(</span><span class="ident" id="6217901">path</span>&nbsp;<span class="builtintype" id="6217906">string</span><span class="op" id="6217912">)</span>&nbsp;<span class="builtintype" id="6217914">bool</span>&nbsp;<span class="op" id="6217919">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217922">return</span>&nbsp;<span class="ident" id="6217929">path</span>&nbsp;<span class="op" id="6217934">==</span>&nbsp;<span class="string" id="6217937">&#34;.&#34;</span>&nbsp;<span class="op" id="6217941">||</span>&nbsp;<span class="ident" id="6217944">path</span>&nbsp;<span class="op" id="6217949">==</span>&nbsp;<span class="string" id="6217952">&#34;..&#34;</span>&nbsp;<span class="op" id="6217957">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217962">strings</span><span class="op" id="6217969">.</span><span class="ident" id="6217970">HasPrefix</span><span class="op" id="6217979">(</span><span class="ident" id="6217980">path</span><span class="op" id="6217984">,</span>&nbsp;<span class="string" id="6217986">&#34;./&#34;</span><span class="op" id="6217990">)</span>&nbsp;<span class="op" id="6217992">||</span>&nbsp;<span class="ident" id="6217995">strings</span><span class="op" id="6218002">.</span><span class="ident" id="6218003">HasPrefix</span><span class="op" id="6218012">(</span><span class="ident" id="6218013">path</span><span class="op" id="6218017">,</span>&nbsp;<span class="string" id="6218019">&#34;../&#34;</span><span class="op" id="6218024">)</span><br>
<span class="lineno"></span><span class="op" id="6218026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6218029">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="6218098">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6218145">func</span>&nbsp;<span class="ident" id="6218150">ArchChar</span><span class="op" id="6218158">(</span><span class="ident" id="6218159">goarch</span>&nbsp;<span class="builtintype" id="6218166">string</span><span class="op" id="6218172">)</span>&nbsp;<span class="op" id="6218174">(</span><span class="builtintype" id="6218175">string</span><span class="op" id="6218181">,</span>&nbsp;<span class="builtintype" id="6218183">error</span><span class="op" id="6218188">)</span>&nbsp;<span class="op" id="6218190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218193">switch</span>&nbsp;<span class="ident" id="6218200">goarch</span>&nbsp;<span class="op" id="6218207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218210">case</span>&nbsp;<span class="string" id="6218215">&#34;386&#34;</span><span class="op" id="6218220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218224">return</span>&nbsp;<span class="string" id="6218231">&#34;8&#34;</span><span class="op" id="6218234">,</span>&nbsp;<span class="ident" id="6218236">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218241">case</span>&nbsp;<span class="string" id="6218246">&#34;amd64&#34;</span><span class="op" id="6218253">,</span>&nbsp;<span class="string" id="6218255">&#34;amd64p32&#34;</span><span class="op" id="6218265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218269">return</span>&nbsp;<span class="string" id="6218276">&#34;6&#34;</span><span class="op" id="6218279">,</span>&nbsp;<span class="ident" id="6218281">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218286">case</span>&nbsp;<span class="string" id="6218291">&#34;arm&#34;</span><span class="op" id="6218296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218300">return</span>&nbsp;<span class="string" id="6218307">&#34;5&#34;</span><span class="op" id="6218310">,</span>&nbsp;<span class="ident" id="6218312">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218317">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218320">return</span>&nbsp;<span class="string" id="6218327">&#34;&#34;</span><span class="op" id="6218329">,</span>&nbsp;<span class="ident" id="6218331">errors</span><span class="op" id="6218337">.</span><span class="ident" id="6218338">New</span><span class="op" id="6218341">(</span><span class="string" id="6218342">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="6218364">+</span>&nbsp;<span class="ident" id="6218366">goarch</span><span class="op" id="6218372">)</span><br>
<span class="lineno"></span><span class="op" id="6218374">}</span>
</div>
</body>
</html>
