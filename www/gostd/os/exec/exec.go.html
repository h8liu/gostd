<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5520214">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5520269">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5520323">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5520374">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5520450">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5520524">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5520540">package</span>&nbsp;<span class="ident" id="5520548">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5520554">import</span>&nbsp;<span class="op" id="5520561">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520564">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520573">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520583">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520589">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520595">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520612">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520623">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520634">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520645">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5520653">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5520663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5520666">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5520731">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5520760">type</span>&nbsp;<span class="ident" id="5520765">Error</span>&nbsp;<span class="keyword" id="5520771">struct</span>&nbsp;<span class="op" id="5520778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5520781">Name</span>&nbsp;<span class="builtintype" id="5520786">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5520794">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5520799">error</span><br>
<span class="lineno"></span><span class="op" id="5520805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5520808">func</span>&nbsp;<span class="op" id="5520813">(</span><span class="ident" id="5520814">e</span>&nbsp;<span class="op" id="5520816">*</span><span class="ident" id="5520817">Error</span><span class="op" id="5520822">)</span>&nbsp;<span class="ident" id="5520824">Error</span><span class="op" id="5520829">(</span><span class="op" id="5520830">)</span>&nbsp;<span class="builtintype" id="5520832">string</span>&nbsp;<span class="op" id="5520839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5520842">return</span>&nbsp;<span class="string" id="5520849">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5520858">+</span>&nbsp;<span class="ident" id="5520860">strconv</span><span class="op" id="5520867">.</span><span class="ident" id="5520868">Quote</span><span class="op" id="5520873">(</span><span class="ident" id="5520874">e</span><span class="op" id="5520875">.</span><span class="ident" id="5520876">Name</span><span class="op" id="5520880">)</span>&nbsp;<span class="op" id="5520882">+</span>&nbsp;<span class="string" id="5520884">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5520889">+</span>&nbsp;<span class="ident" id="5520891">e</span><span class="op" id="5520892">.</span><span class="ident" id="5520893">Err</span><span class="op" id="5520896">.</span><span class="ident" id="5520897">Error</span><span class="op" id="5520902">(</span><span class="op" id="5520903">)</span><br>
<span class="lineno"></span><span class="op" id="5520905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5520908">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5520969">type</span>&nbsp;<span class="ident" id="5520974">Cmd</span>&nbsp;<span class="keyword" id="5520978">struct</span>&nbsp;<span class="op" id="5520985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5520988">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521032">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521036">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521094">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521151">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5521163">Path</span>&nbsp;<span class="builtintype" id="5521168">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521177">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521250">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521306">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521310">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5521377">Args</span>&nbsp;<span class="op" id="5521382">[</span><span class="op" id="5521383">]</span><span class="builtintype" id="5521384">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521393">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521443">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5521506">Env</span>&nbsp;<span class="op" id="5521510">[</span><span class="op" id="5521511">]</span><span class="builtintype" id="5521512">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521521">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521577">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521637">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5521678">Dir</span>&nbsp;<span class="builtintype" id="5521682">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521691">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521741">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521815">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521886">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521913">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5521975">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522044">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522118">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522184">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5522260">Stdin</span>&nbsp;<span class="ident" id="5522266">io</span><span class="op" id="5522268">.</span><span class="ident" id="5522269">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522278">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522349">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522353">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522422">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522459">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522463">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522521">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5522562">Stdout</span>&nbsp;<span class="ident" id="5522569">io</span><span class="op" id="5522571">.</span><span class="ident" id="5522572">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5522580">Stderr</span>&nbsp;<span class="ident" id="5522587">io</span><span class="op" id="5522589">.</span><span class="ident" id="5522590">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522599">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522669">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522742">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522811">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522815">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522890">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5522923">ExtraFiles</span>&nbsp;<span class="op" id="5522934">[</span><span class="op" id="5522935">]</span><span class="op" id="5522936">*</span><span class="ident" id="5522937">os</span><span class="op" id="5522939">.</span><span class="ident" id="5522940">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5522947">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5523017">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523086">SysProcAttr</span>&nbsp;<span class="op" id="5523098">*</span><span class="ident" id="5523099">syscall</span><span class="op" id="5523106">.</span><span class="ident" id="5523107">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5523121">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523174">Process</span>&nbsp;<span class="op" id="5523182">*</span><span class="ident" id="5523183">os</span><span class="op" id="5523185">.</span><span class="ident" id="5523186">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5523196">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5523259">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523302">ProcessState</span>&nbsp;<span class="op" id="5523315">*</span><span class="ident" id="5523316">os</span><span class="op" id="5523318">.</span><span class="ident" id="5523319">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523334">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5523350">error</span>&nbsp;<span class="comment" id="5523356">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523384">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5523400">bool</span>&nbsp;&nbsp;<span class="comment" id="5523406">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523431">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5523447">[</span><span class="op" id="5523448">]</span><span class="op" id="5523449">*</span><span class="ident" id="5523450">os</span><span class="op" id="5523452">.</span><span class="ident" id="5523453">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523459">closeAfterStart</span>&nbsp;<span class="op" id="5523475">[</span><span class="op" id="5523476">]</span><span class="ident" id="5523477">io</span><span class="op" id="5523479">.</span><span class="ident" id="5523480">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523488">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5523504">[</span><span class="op" id="5523505">]</span><span class="ident" id="5523506">io</span><span class="op" id="5523508">.</span><span class="ident" id="5523509">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523517">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5523533">[</span><span class="op" id="5523534">]</span><span class="keyword" id="5523535">func</span><span class="op" id="5523539">(</span><span class="op" id="5523540">)</span>&nbsp;<span class="builtintype" id="5523542">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5523549">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5523565">chan</span>&nbsp;<span class="builtintype" id="5523570">error</span>&nbsp;<span class="comment" id="5523576">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5523602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5523605">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5523673">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5523697">//</span><br>
<span class="lineno">110</span><span class="comment" id="5523700">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5523761">//</span><br>
<span class="lineno"></span><span class="comment" id="5523764">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5523829">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5523899">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5523917">//</span><br>
<span class="lineno"></span><span class="comment" id="5523920">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5523990">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5524056">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5524118">func</span>&nbsp;<span class="ident" id="5524123">Command</span><span class="op" id="5524130">(</span><span class="ident" id="5524131">name</span>&nbsp;<span class="builtintype" id="5524136">string</span><span class="op" id="5524142">,</span>&nbsp;<span class="ident" id="5524144">arg</span>&nbsp;<span class="op" id="5524148">...</span><span class="builtintype" id="5524151">string</span><span class="op" id="5524157">)</span>&nbsp;<span class="op" id="5524159">*</span><span class="ident" id="5524160">Cmd</span>&nbsp;<span class="op" id="5524164">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524167">cmd</span>&nbsp;<span class="op" id="5524171">:=</span>&nbsp;<span class="op" id="5524174">&amp;</span><span class="ident" id="5524175">Cmd</span><span class="op" id="5524178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524182">Path</span><span class="op" id="5524186">:</span>&nbsp;<span class="ident" id="5524188">name</span><span class="op" id="5524192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524196">Args</span><span class="op" id="5524200">:</span>&nbsp;<span class="builtinfunc" id="5524202">append</span><span class="op" id="5524208">(</span><span class="op" id="5524209">[</span><span class="op" id="5524210">]</span><span class="builtintype" id="5524211">string</span><span class="op" id="5524217">{</span><span class="ident" id="5524218">name</span><span class="op" id="5524222">}</span><span class="op" id="5524223">,</span>&nbsp;<span class="ident" id="5524225">arg</span><span class="op" id="5524228">...</span><span class="op" id="5524231">)</span><span class="op" id="5524232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524238">if</span>&nbsp;<span class="ident" id="5524241">filepath</span><span class="op" id="5524249">.</span><span class="ident" id="5524250">Base</span><span class="op" id="5524254">(</span><span class="ident" id="5524255">name</span><span class="op" id="5524259">)</span>&nbsp;<span class="op" id="5524261">==</span>&nbsp;<span class="ident" id="5524264">name</span>&nbsp;<span class="op" id="5524269">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524273">if</span>&nbsp;<span class="ident" id="5524276">lp</span><span class="op" id="5524278">,</span>&nbsp;<span class="ident" id="5524280">err</span>&nbsp;<span class="op" id="5524284">:=</span>&nbsp;<span class="ident" id="5524287">LookPath</span><span class="op" id="5524295">(</span><span class="ident" id="5524296">name</span><span class="op" id="5524300">)</span><span class="op" id="5524301">;</span>&nbsp;<span class="ident" id="5524303">err</span>&nbsp;<span class="op" id="5524307">!=</span>&nbsp;<span class="builtintype" id="5524310">nil</span>&nbsp;<span class="op" id="5524314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524319">cmd</span><span class="op" id="5524322">.</span><span class="ident" id="5524323">lookPathErr</span>&nbsp;<span class="op" id="5524335">=</span>&nbsp;<span class="ident" id="5524337">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524343">}</span>&nbsp;<span class="keyword" id="5524345">else</span>&nbsp;<span class="op" id="5524350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524355">cmd</span><span class="op" id="5524358">.</span><span class="ident" id="5524359">Path</span>&nbsp;<span class="op" id="5524364">=</span>&nbsp;<span class="ident" id="5524366">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524371">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524377">return</span>&nbsp;<span class="ident" id="5524384">cmd</span><br>
<span class="lineno"></span><span class="op" id="5524388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5524391">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5524462">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5524518">func</span>&nbsp;<span class="ident" id="5524523">interfaceEqual</span><span class="op" id="5524537">(</span><span class="ident" id="5524538">a</span><span class="op" id="5524539">,</span>&nbsp;<span class="ident" id="5524541">b</span>&nbsp;<span class="keyword" id="5524543">interface</span><span class="op" id="5524552">{</span><span class="op" id="5524553">}</span><span class="op" id="5524554">)</span>&nbsp;<span class="builtintype" id="5524556">bool</span>&nbsp;<span class="op" id="5524561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524564">defer</span>&nbsp;<span class="keyword" id="5524570">func</span><span class="op" id="5524574">(</span><span class="op" id="5524575">)</span>&nbsp;<span class="op" id="5524577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5524581">recover</span><span class="op" id="5524588">(</span><span class="op" id="5524589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524592">}</span><span class="op" id="5524593">(</span><span class="op" id="5524594">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524597">return</span>&nbsp;<span class="ident" id="5524604">a</span>&nbsp;<span class="op" id="5524606">==</span>&nbsp;<span class="ident" id="5524609">b</span><br>
<span class="lineno"></span><span class="op" id="5524611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5524614">func</span>&nbsp;<span class="op" id="5524619">(</span><span class="ident" id="5524620">c</span>&nbsp;<span class="op" id="5524622">*</span><span class="ident" id="5524623">Cmd</span><span class="op" id="5524626">)</span>&nbsp;<span class="ident" id="5524628">envv</span><span class="op" id="5524632">(</span><span class="op" id="5524633">)</span>&nbsp;<span class="op" id="5524635">[</span><span class="op" id="5524636">]</span><span class="builtintype" id="5524637">string</span>&nbsp;<span class="op" id="5524644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524647">if</span>&nbsp;<span class="ident" id="5524650">c</span><span class="op" id="5524651">.</span><span class="ident" id="5524652">Env</span>&nbsp;<span class="op" id="5524656">!=</span>&nbsp;<span class="builtintype" id="5524659">nil</span>&nbsp;<span class="op" id="5524663">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524667">return</span>&nbsp;<span class="ident" id="5524674">c</span><span class="op" id="5524675">.</span><span class="ident" id="5524676">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524684">return</span>&nbsp;<span class="ident" id="5524691">os</span><span class="op" id="5524693">.</span><span class="ident" id="5524694">Environ</span><span class="op" id="5524701">(</span><span class="op" id="5524702">)</span><br>
<span class="lineno"></span><span class="op" id="5524704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5524707">func</span>&nbsp;<span class="op" id="5524712">(</span><span class="ident" id="5524713">c</span>&nbsp;<span class="op" id="5524715">*</span><span class="ident" id="5524716">Cmd</span><span class="op" id="5524719">)</span>&nbsp;<span class="ident" id="5524721">argv</span><span class="op" id="5524725">(</span><span class="op" id="5524726">)</span>&nbsp;<span class="op" id="5524728">[</span><span class="op" id="5524729">]</span><span class="builtintype" id="5524730">string</span>&nbsp;<span class="op" id="5524737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524740">if</span>&nbsp;<span class="builtinfunc" id="5524743">len</span><span class="op" id="5524746">(</span><span class="ident" id="5524747">c</span><span class="op" id="5524748">.</span><span class="ident" id="5524749">Args</span><span class="op" id="5524753">)</span>&nbsp;<span class="op" id="5524755">&gt;</span>&nbsp;<span class="num" id="5524757">0</span>&nbsp;<span class="op" id="5524759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524763">return</span>&nbsp;<span class="ident" id="5524770">c</span><span class="op" id="5524771">.</span><span class="ident" id="5524772">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524781">return</span>&nbsp;<span class="op" id="5524788">[</span><span class="op" id="5524789">]</span><span class="builtintype" id="5524790">string</span><span class="op" id="5524796">{</span><span class="ident" id="5524797">c</span><span class="op" id="5524798">.</span><span class="ident" id="5524799">Path</span><span class="op" id="5524803">}</span><br>
<span class="lineno">155</span><span class="op" id="5524805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5524808">func</span>&nbsp;<span class="op" id="5524813">(</span><span class="ident" id="5524814">c</span>&nbsp;<span class="op" id="5524816">*</span><span class="ident" id="5524817">Cmd</span><span class="op" id="5524820">)</span>&nbsp;<span class="ident" id="5524822">stdin</span><span class="op" id="5524827">(</span><span class="op" id="5524828">)</span>&nbsp;<span class="op" id="5524830">(</span><span class="ident" id="5524831">f</span>&nbsp;<span class="op" id="5524833">*</span><span class="ident" id="5524834">os</span><span class="op" id="5524836">.</span><span class="ident" id="5524837">File</span><span class="op" id="5524841">,</span>&nbsp;<span class="ident" id="5524843">err</span>&nbsp;<span class="builtintype" id="5524847">error</span><span class="op" id="5524852">)</span>&nbsp;<span class="op" id="5524854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524857">if</span>&nbsp;<span class="ident" id="5524860">c</span><span class="op" id="5524861">.</span><span class="ident" id="5524862">Stdin</span>&nbsp;<span class="op" id="5524868">==</span>&nbsp;<span class="builtintype" id="5524871">nil</span>&nbsp;<span class="op" id="5524875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524879">f</span><span class="op" id="5524880">,</span>&nbsp;<span class="ident" id="5524882">err</span>&nbsp;<span class="op" id="5524886">=</span>&nbsp;<span class="ident" id="5524888">os</span><span class="op" id="5524890">.</span><span class="ident" id="5524891">Open</span><span class="op" id="5524895">(</span><span class="ident" id="5524896">os</span><span class="op" id="5524898">.</span><span class="ident" id="5524899">DevNull</span><span class="op" id="5524906">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524910">if</span>&nbsp;<span class="ident" id="5524913">err</span>&nbsp;<span class="op" id="5524917">!=</span>&nbsp;<span class="builtintype" id="5524920">nil</span>&nbsp;<span class="op" id="5524924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524929">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5524938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5524942">c</span><span class="op" id="5524943">.</span><span class="ident" id="5524944">closeAfterStart</span>&nbsp;<span class="op" id="5524960">=</span>&nbsp;<span class="builtinfunc" id="5524962">append</span><span class="op" id="5524968">(</span><span class="ident" id="5524969">c</span><span class="op" id="5524970">.</span><span class="ident" id="5524971">closeAfterStart</span><span class="op" id="5524986">,</span>&nbsp;<span class="ident" id="5524988">f</span><span class="op" id="5524989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5524993">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525005">if</span>&nbsp;<span class="ident" id="5525008">f</span><span class="op" id="5525009">,</span>&nbsp;<span class="ident" id="5525011">ok</span>&nbsp;<span class="op" id="5525014">:=</span>&nbsp;<span class="ident" id="5525017">c</span><span class="op" id="5525018">.</span><span class="ident" id="5525019">Stdin</span><span class="op" id="5525024">.</span><span class="op" id="5525025">(</span><span class="op" id="5525026">*</span><span class="ident" id="5525027">os</span><span class="op" id="5525029">.</span><span class="ident" id="5525030">File</span><span class="op" id="5525034">)</span><span class="op" id="5525035">;</span>&nbsp;<span class="ident" id="5525037">ok</span>&nbsp;<span class="op" id="5525040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525044">return</span>&nbsp;<span class="ident" id="5525051">f</span><span class="op" id="5525052">,</span>&nbsp;<span class="builtintype" id="5525054">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525059">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525063">pr</span><span class="op" id="5525065">,</span>&nbsp;<span class="ident" id="5525067">pw</span><span class="op" id="5525069">,</span>&nbsp;<span class="ident" id="5525071">err</span>&nbsp;<span class="op" id="5525075">:=</span>&nbsp;<span class="ident" id="5525078">os</span><span class="op" id="5525080">.</span><span class="ident" id="5525081">Pipe</span><span class="op" id="5525085">(</span><span class="op" id="5525086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525089">if</span>&nbsp;<span class="ident" id="5525092">err</span>&nbsp;<span class="op" id="5525096">!=</span>&nbsp;<span class="builtintype" id="5525099">nil</span>&nbsp;<span class="op" id="5525103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525107">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525115">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525119">c</span><span class="op" id="5525120">.</span><span class="ident" id="5525121">closeAfterStart</span>&nbsp;<span class="op" id="5525137">=</span>&nbsp;<span class="builtinfunc" id="5525139">append</span><span class="op" id="5525145">(</span><span class="ident" id="5525146">c</span><span class="op" id="5525147">.</span><span class="ident" id="5525148">closeAfterStart</span><span class="op" id="5525163">,</span>&nbsp;<span class="ident" id="5525165">pr</span><span class="op" id="5525167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525170">c</span><span class="op" id="5525171">.</span><span class="ident" id="5525172">closeAfterWait</span>&nbsp;<span class="op" id="5525187">=</span>&nbsp;<span class="builtinfunc" id="5525189">append</span><span class="op" id="5525195">(</span><span class="ident" id="5525196">c</span><span class="op" id="5525197">.</span><span class="ident" id="5525198">closeAfterWait</span><span class="op" id="5525212">,</span>&nbsp;<span class="ident" id="5525214">pw</span><span class="op" id="5525216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525219">c</span><span class="op" id="5525220">.</span><span class="ident" id="5525221">goroutine</span>&nbsp;<span class="op" id="5525231">=</span>&nbsp;<span class="builtinfunc" id="5525233">append</span><span class="op" id="5525239">(</span><span class="ident" id="5525240">c</span><span class="op" id="5525241">.</span><span class="ident" id="5525242">goroutine</span><span class="op" id="5525251">,</span>&nbsp;<span class="keyword" id="5525253">func</span><span class="op" id="5525257">(</span><span class="op" id="5525258">)</span>&nbsp;<span class="builtintype" id="5525260">error</span>&nbsp;<span class="op" id="5525266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525270">_</span><span class="op" id="5525271">,</span>&nbsp;<span class="ident" id="5525273">err</span>&nbsp;<span class="op" id="5525277">:=</span>&nbsp;<span class="ident" id="5525280">io</span><span class="op" id="5525282">.</span><span class="ident" id="5525283">Copy</span><span class="op" id="5525287">(</span><span class="ident" id="5525288">pw</span><span class="op" id="5525290">,</span>&nbsp;<span class="ident" id="5525292">c</span><span class="op" id="5525293">.</span><span class="ident" id="5525294">Stdin</span><span class="op" id="5525299">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525303">if</span>&nbsp;<span class="ident" id="5525306">err1</span>&nbsp;<span class="op" id="5525311">:=</span>&nbsp;<span class="ident" id="5525314">pw</span><span class="op" id="5525316">.</span><span class="ident" id="5525317">Close</span><span class="op" id="5525322">(</span><span class="op" id="5525323">)</span><span class="op" id="5525324">;</span>&nbsp;<span class="ident" id="5525326">err</span>&nbsp;<span class="op" id="5525330">==</span>&nbsp;<span class="builtintype" id="5525333">nil</span>&nbsp;<span class="op" id="5525337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525342">err</span>&nbsp;<span class="op" id="5525346">=</span>&nbsp;<span class="ident" id="5525348">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525359">return</span>&nbsp;<span class="ident" id="5525366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525371">}</span><span class="op" id="5525372">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525375">return</span>&nbsp;<span class="ident" id="5525382">pr</span><span class="op" id="5525384">,</span>&nbsp;<span class="builtintype" id="5525386">nil</span><br>
<span class="lineno"></span><span class="op" id="5525390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5525393">func</span>&nbsp;<span class="op" id="5525398">(</span><span class="ident" id="5525399">c</span>&nbsp;<span class="op" id="5525401">*</span><span class="ident" id="5525402">Cmd</span><span class="op" id="5525405">)</span>&nbsp;<span class="ident" id="5525407">stdout</span><span class="op" id="5525413">(</span><span class="op" id="5525414">)</span>&nbsp;<span class="op" id="5525416">(</span><span class="ident" id="5525417">f</span>&nbsp;<span class="op" id="5525419">*</span><span class="ident" id="5525420">os</span><span class="op" id="5525422">.</span><span class="ident" id="5525423">File</span><span class="op" id="5525427">,</span>&nbsp;<span class="ident" id="5525429">err</span>&nbsp;<span class="builtintype" id="5525433">error</span><span class="op" id="5525438">)</span>&nbsp;<span class="op" id="5525440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525443">return</span>&nbsp;<span class="ident" id="5525450">c</span><span class="op" id="5525451">.</span><span class="ident" id="5525452">writerDescriptor</span><span class="op" id="5525468">(</span><span class="ident" id="5525469">c</span><span class="op" id="5525470">.</span><span class="ident" id="5525471">Stdout</span><span class="op" id="5525477">)</span><br>
<span class="lineno">190</span><span class="op" id="5525479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5525482">func</span>&nbsp;<span class="op" id="5525487">(</span><span class="ident" id="5525488">c</span>&nbsp;<span class="op" id="5525490">*</span><span class="ident" id="5525491">Cmd</span><span class="op" id="5525494">)</span>&nbsp;<span class="ident" id="5525496">stderr</span><span class="op" id="5525502">(</span><span class="op" id="5525503">)</span>&nbsp;<span class="op" id="5525505">(</span><span class="ident" id="5525506">f</span>&nbsp;<span class="op" id="5525508">*</span><span class="ident" id="5525509">os</span><span class="op" id="5525511">.</span><span class="ident" id="5525512">File</span><span class="op" id="5525516">,</span>&nbsp;<span class="ident" id="5525518">err</span>&nbsp;<span class="builtintype" id="5525522">error</span><span class="op" id="5525527">)</span>&nbsp;<span class="op" id="5525529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525532">if</span>&nbsp;<span class="ident" id="5525535">c</span><span class="op" id="5525536">.</span><span class="ident" id="5525537">Stderr</span>&nbsp;<span class="op" id="5525544">!=</span>&nbsp;<span class="builtintype" id="5525547">nil</span>&nbsp;<span class="op" id="5525551">&amp;&amp;</span>&nbsp;<span class="ident" id="5525554">interfaceEqual</span><span class="op" id="5525568">(</span><span class="ident" id="5525569">c</span><span class="op" id="5525570">.</span><span class="ident" id="5525571">Stderr</span><span class="op" id="5525577">,</span>&nbsp;<span class="ident" id="5525579">c</span><span class="op" id="5525580">.</span><span class="ident" id="5525581">Stdout</span><span class="op" id="5525587">)</span>&nbsp;<span class="op" id="5525589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525593">return</span>&nbsp;<span class="ident" id="5525600">c</span><span class="op" id="5525601">.</span><span class="ident" id="5525602">childFiles</span><span class="op" id="5525612">[</span><span class="num" id="5525613">1</span><span class="op" id="5525614">]</span><span class="op" id="5525615">,</span>&nbsp;<span class="builtintype" id="5525617">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525625">return</span>&nbsp;<span class="ident" id="5525632">c</span><span class="op" id="5525633">.</span><span class="ident" id="5525634">writerDescriptor</span><span class="op" id="5525650">(</span><span class="ident" id="5525651">c</span><span class="op" id="5525652">.</span><span class="ident" id="5525653">Stderr</span><span class="op" id="5525659">)</span><br>
<span class="lineno"></span><span class="op" id="5525661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5525664">func</span>&nbsp;<span class="op" id="5525669">(</span><span class="ident" id="5525670">c</span>&nbsp;<span class="op" id="5525672">*</span><span class="ident" id="5525673">Cmd</span><span class="op" id="5525676">)</span>&nbsp;<span class="ident" id="5525678">writerDescriptor</span><span class="op" id="5525694">(</span><span class="ident" id="5525695">w</span>&nbsp;<span class="ident" id="5525697">io</span><span class="op" id="5525699">.</span><span class="ident" id="5525700">Writer</span><span class="op" id="5525706">)</span>&nbsp;<span class="op" id="5525708">(</span><span class="ident" id="5525709">f</span>&nbsp;<span class="op" id="5525711">*</span><span class="ident" id="5525712">os</span><span class="op" id="5525714">.</span><span class="ident" id="5525715">File</span><span class="op" id="5525719">,</span>&nbsp;<span class="ident" id="5525721">err</span>&nbsp;<span class="builtintype" id="5525725">error</span><span class="op" id="5525730">)</span>&nbsp;<span class="op" id="5525732">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525735">if</span>&nbsp;<span class="ident" id="5525738">w</span>&nbsp;<span class="op" id="5525740">==</span>&nbsp;<span class="builtintype" id="5525743">nil</span>&nbsp;<span class="op" id="5525747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525751">f</span><span class="op" id="5525752">,</span>&nbsp;<span class="ident" id="5525754">err</span>&nbsp;<span class="op" id="5525758">=</span>&nbsp;<span class="ident" id="5525760">os</span><span class="op" id="5525762">.</span><span class="ident" id="5525763">OpenFile</span><span class="op" id="5525771">(</span><span class="ident" id="5525772">os</span><span class="op" id="5525774">.</span><span class="ident" id="5525775">DevNull</span><span class="op" id="5525782">,</span>&nbsp;<span class="ident" id="5525784">os</span><span class="op" id="5525786">.</span><span class="ident" id="5525787">O_WRONLY</span><span class="op" id="5525795">,</span>&nbsp;<span class="num" id="5525797">0</span><span class="op" id="5525798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525802">if</span>&nbsp;<span class="ident" id="5525805">err</span>&nbsp;<span class="op" id="5525809">!=</span>&nbsp;<span class="builtintype" id="5525812">nil</span>&nbsp;<span class="op" id="5525816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525830">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525834">c</span><span class="op" id="5525835">.</span><span class="ident" id="5525836">closeAfterStart</span>&nbsp;<span class="op" id="5525852">=</span>&nbsp;<span class="builtinfunc" id="5525854">append</span><span class="op" id="5525860">(</span><span class="ident" id="5525861">c</span><span class="op" id="5525862">.</span><span class="ident" id="5525863">closeAfterStart</span><span class="op" id="5525878">,</span>&nbsp;<span class="ident" id="5525880">f</span><span class="op" id="5525881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525897">if</span>&nbsp;<span class="ident" id="5525900">f</span><span class="op" id="5525901">,</span>&nbsp;<span class="ident" id="5525903">ok</span>&nbsp;<span class="op" id="5525906">:=</span>&nbsp;<span class="ident" id="5525909">w</span><span class="op" id="5525910">.</span><span class="op" id="5525911">(</span><span class="op" id="5525912">*</span><span class="ident" id="5525913">os</span><span class="op" id="5525915">.</span><span class="ident" id="5525916">File</span><span class="op" id="5525920">)</span><span class="op" id="5525921">;</span>&nbsp;<span class="ident" id="5525923">ok</span>&nbsp;<span class="op" id="5525926">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525930">return</span>&nbsp;<span class="ident" id="5525937">f</span><span class="op" id="5525938">,</span>&nbsp;<span class="builtintype" id="5525940">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5525945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5525949">pr</span><span class="op" id="5525951">,</span>&nbsp;<span class="ident" id="5525953">pw</span><span class="op" id="5525955">,</span>&nbsp;<span class="ident" id="5525957">err</span>&nbsp;<span class="op" id="5525961">:=</span>&nbsp;<span class="ident" id="5525964">os</span><span class="op" id="5525966">.</span><span class="ident" id="5525967">Pipe</span><span class="op" id="5525971">(</span><span class="op" id="5525972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525975">if</span>&nbsp;<span class="ident" id="5525978">err</span>&nbsp;<span class="op" id="5525982">!=</span>&nbsp;<span class="builtintype" id="5525985">nil</span>&nbsp;<span class="op" id="5525989">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5525993">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5526005">c</span><span class="op" id="5526006">.</span><span class="ident" id="5526007">closeAfterStart</span>&nbsp;<span class="op" id="5526023">=</span>&nbsp;<span class="builtinfunc" id="5526025">append</span><span class="op" id="5526031">(</span><span class="ident" id="5526032">c</span><span class="op" id="5526033">.</span><span class="ident" id="5526034">closeAfterStart</span><span class="op" id="5526049">,</span>&nbsp;<span class="ident" id="5526051">pw</span><span class="op" id="5526053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5526056">c</span><span class="op" id="5526057">.</span><span class="ident" id="5526058">closeAfterWait</span>&nbsp;<span class="op" id="5526073">=</span>&nbsp;<span class="builtinfunc" id="5526075">append</span><span class="op" id="5526081">(</span><span class="ident" id="5526082">c</span><span class="op" id="5526083">.</span><span class="ident" id="5526084">closeAfterWait</span><span class="op" id="5526098">,</span>&nbsp;<span class="ident" id="5526100">pr</span><span class="op" id="5526102">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5526105">c</span><span class="op" id="5526106">.</span><span class="ident" id="5526107">goroutine</span>&nbsp;<span class="op" id="5526117">=</span>&nbsp;<span class="builtinfunc" id="5526119">append</span><span class="op" id="5526125">(</span><span class="ident" id="5526126">c</span><span class="op" id="5526127">.</span><span class="ident" id="5526128">goroutine</span><span class="op" id="5526137">,</span>&nbsp;<span class="keyword" id="5526139">func</span><span class="op" id="5526143">(</span><span class="op" id="5526144">)</span>&nbsp;<span class="builtintype" id="5526146">error</span>&nbsp;<span class="op" id="5526152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5526156">_</span><span class="op" id="5526157">,</span>&nbsp;<span class="ident" id="5526159">err</span>&nbsp;<span class="op" id="5526163">:=</span>&nbsp;<span class="ident" id="5526166">io</span><span class="op" id="5526168">.</span><span class="ident" id="5526169">Copy</span><span class="op" id="5526173">(</span><span class="ident" id="5526174">w</span><span class="op" id="5526175">,</span>&nbsp;<span class="ident" id="5526177">pr</span><span class="op" id="5526179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526183">return</span>&nbsp;<span class="ident" id="5526190">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526195">}</span><span class="op" id="5526196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526199">return</span>&nbsp;<span class="ident" id="5526206">pw</span><span class="op" id="5526208">,</span>&nbsp;<span class="builtintype" id="5526210">nil</span><br>
<span class="lineno">225</span><span class="op" id="5526214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5526217">func</span>&nbsp;<span class="op" id="5526222">(</span><span class="ident" id="5526223">c</span>&nbsp;<span class="op" id="5526225">*</span><span class="ident" id="5526226">Cmd</span><span class="op" id="5526229">)</span>&nbsp;<span class="ident" id="5526231">closeDescriptors</span><span class="op" id="5526247">(</span><span class="ident" id="5526248">closers</span>&nbsp;<span class="op" id="5526256">[</span><span class="op" id="5526257">]</span><span class="ident" id="5526258">io</span><span class="op" id="5526260">.</span><span class="ident" id="5526261">Closer</span><span class="op" id="5526267">)</span>&nbsp;<span class="op" id="5526269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526272">for</span>&nbsp;<span class="ident" id="5526276">_</span><span class="op" id="5526277">,</span>&nbsp;<span class="ident" id="5526279">fd</span>&nbsp;<span class="op" id="5526282">:=</span>&nbsp;<span class="keyword" id="5526285">range</span>&nbsp;<span class="ident" id="5526291">closers</span>&nbsp;<span class="op" id="5526299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5526303">fd</span><span class="op" id="5526305">.</span><span class="ident" id="5526306">Close</span><span class="op" id="5526311">(</span><span class="op" id="5526312">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526315">}</span><br>
<span class="lineno"></span><span class="op" id="5526317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5526320">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5526386">//</span><br>
<span class="lineno">235</span><span class="comment" id="5526389">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5526455">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5526520">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5526531">//</span><br>
<span class="lineno"></span><span class="comment" id="5526534">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5526603">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5526660">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5526690">func</span>&nbsp;<span class="op" id="5526695">(</span><span class="ident" id="5526696">c</span>&nbsp;<span class="op" id="5526698">*</span><span class="ident" id="5526699">Cmd</span><span class="op" id="5526702">)</span>&nbsp;<span class="ident" id="5526704">Run</span><span class="op" id="5526707">(</span><span class="op" id="5526708">)</span>&nbsp;<span class="builtintype" id="5526710">error</span>&nbsp;<span class="op" id="5526716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526719">if</span>&nbsp;<span class="ident" id="5526722">err</span>&nbsp;<span class="op" id="5526726">:=</span>&nbsp;<span class="ident" id="5526729">c</span><span class="op" id="5526730">.</span><span class="ident" id="5526731">Start</span><span class="op" id="5526736">(</span><span class="op" id="5526737">)</span><span class="op" id="5526738">;</span>&nbsp;<span class="ident" id="5526740">err</span>&nbsp;<span class="op" id="5526744">!=</span>&nbsp;<span class="builtintype" id="5526747">nil</span>&nbsp;<span class="op" id="5526751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526755">return</span>&nbsp;<span class="ident" id="5526762">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5526767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5526770">return</span>&nbsp;<span class="ident" id="5526777">c</span><span class="op" id="5526778">.</span><span class="ident" id="5526779">Wait</span><span class="op" id="5526783">(</span><span class="op" id="5526784">)</span><br>
<span class="lineno"></span><span class="op" id="5526786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5526789">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5526853">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5526904">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5526986">func</span>&nbsp;<span class="ident" id="5526991">lookExtensions</span><span class="op" id="5527005">(</span><span class="ident" id="5527006">path</span><span class="op" id="5527010">,</span>&nbsp;<span class="ident" id="5527012">dir</span>&nbsp;<span class="builtintype" id="5527016">string</span><span class="op" id="5527022">)</span>&nbsp;<span class="op" id="5527024">(</span><span class="builtintype" id="5527025">string</span><span class="op" id="5527031">,</span>&nbsp;<span class="builtintype" id="5527033">error</span><span class="op" id="5527038">)</span>&nbsp;<span class="op" id="5527040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527043">if</span>&nbsp;<span class="ident" id="5527046">filepath</span><span class="op" id="5527054">.</span><span class="ident" id="5527055">Base</span><span class="op" id="5527059">(</span><span class="ident" id="5527060">path</span><span class="op" id="5527064">)</span>&nbsp;<span class="op" id="5527066">==</span>&nbsp;<span class="ident" id="5527069">path</span>&nbsp;<span class="op" id="5527074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527078">path</span>&nbsp;<span class="op" id="5527083">=</span>&nbsp;<span class="ident" id="5527085">filepath</span><span class="op" id="5527093">.</span><span class="ident" id="5527094">Join</span><span class="op" id="5527098">(</span><span class="string" id="5527099">&#34;.&#34;</span><span class="op" id="5527102">,</span>&nbsp;<span class="ident" id="5527104">path</span><span class="op" id="5527108">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527114">if</span>&nbsp;<span class="ident" id="5527117">dir</span>&nbsp;<span class="op" id="5527121">==</span>&nbsp;<span class="string" id="5527124">&#34;&#34;</span>&nbsp;<span class="op" id="5527127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527131">return</span>&nbsp;<span class="ident" id="5527138">LookPath</span><span class="op" id="5527146">(</span><span class="ident" id="5527147">path</span><span class="op" id="5527151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527157">if</span>&nbsp;<span class="ident" id="5527160">filepath</span><span class="op" id="5527168">.</span><span class="ident" id="5527169">VolumeName</span><span class="op" id="5527179">(</span><span class="ident" id="5527180">path</span><span class="op" id="5527184">)</span>&nbsp;<span class="op" id="5527186">!=</span>&nbsp;<span class="string" id="5527189">&#34;&#34;</span>&nbsp;<span class="op" id="5527192">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527196">return</span>&nbsp;<span class="ident" id="5527203">LookPath</span><span class="op" id="5527211">(</span><span class="ident" id="5527212">path</span><span class="op" id="5527216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527222">if</span>&nbsp;<span class="builtinfunc" id="5527225">len</span><span class="op" id="5527228">(</span><span class="ident" id="5527229">path</span><span class="op" id="5527233">)</span>&nbsp;<span class="op" id="5527235">&gt;</span>&nbsp;<span class="num" id="5527237">1</span>&nbsp;<span class="op" id="5527239">&amp;&amp;</span>&nbsp;<span class="ident" id="5527242">os</span><span class="op" id="5527244">.</span><span class="ident" id="5527245">IsPathSeparator</span><span class="op" id="5527260">(</span><span class="ident" id="5527261">path</span><span class="op" id="5527265">[</span><span class="num" id="5527266">0</span><span class="op" id="5527267">]</span><span class="op" id="5527268">)</span>&nbsp;<span class="op" id="5527270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527274">return</span>&nbsp;<span class="ident" id="5527281">LookPath</span><span class="op" id="5527289">(</span><span class="ident" id="5527290">path</span><span class="op" id="5527294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527297">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527300">dirandpath</span>&nbsp;<span class="op" id="5527311">:=</span>&nbsp;<span class="ident" id="5527314">filepath</span><span class="op" id="5527322">.</span><span class="ident" id="5527323">Join</span><span class="op" id="5527327">(</span><span class="ident" id="5527328">dir</span><span class="op" id="5527331">,</span>&nbsp;<span class="ident" id="5527333">path</span><span class="op" id="5527337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5527340">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527398">lp</span><span class="op" id="5527400">,</span>&nbsp;<span class="ident" id="5527402">err</span>&nbsp;<span class="op" id="5527406">:=</span>&nbsp;<span class="ident" id="5527409">LookPath</span><span class="op" id="5527417">(</span><span class="ident" id="5527418">dirandpath</span><span class="op" id="5527428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527431">if</span>&nbsp;<span class="ident" id="5527434">err</span>&nbsp;<span class="op" id="5527438">!=</span>&nbsp;<span class="builtintype" id="5527441">nil</span>&nbsp;<span class="op" id="5527445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527449">return</span>&nbsp;<span class="string" id="5527456">&#34;&#34;</span><span class="op" id="5527458">,</span>&nbsp;<span class="ident" id="5527460">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527468">ext</span>&nbsp;<span class="op" id="5527472">:=</span>&nbsp;<span class="ident" id="5527475">strings</span><span class="op" id="5527482">.</span><span class="ident" id="5527483">TrimPrefix</span><span class="op" id="5527493">(</span><span class="ident" id="5527494">lp</span><span class="op" id="5527496">,</span>&nbsp;<span class="ident" id="5527498">dirandpath</span><span class="op" id="5527508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527511">return</span>&nbsp;<span class="ident" id="5527518">path</span>&nbsp;<span class="op" id="5527523">+</span>&nbsp;<span class="ident" id="5527525">ext</span><span class="op" id="5527528">,</span>&nbsp;<span class="builtintype" id="5527530">nil</span><br>
<span class="lineno"></span><span class="op" id="5527534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5527537">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5527613">//</span><br>
<span class="lineno"></span><span class="comment" id="5527616">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5527694">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5527721">func</span>&nbsp;<span class="op" id="5527726">(</span><span class="ident" id="5527727">c</span>&nbsp;<span class="op" id="5527729">*</span><span class="ident" id="5527730">Cmd</span><span class="op" id="5527733">)</span>&nbsp;<span class="ident" id="5527735">Start</span><span class="op" id="5527740">(</span><span class="op" id="5527741">)</span>&nbsp;<span class="builtintype" id="5527743">error</span>&nbsp;<span class="op" id="5527749">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527752">if</span>&nbsp;<span class="ident" id="5527755">c</span><span class="op" id="5527756">.</span><span class="ident" id="5527757">lookPathErr</span>&nbsp;<span class="op" id="5527769">!=</span>&nbsp;<span class="builtintype" id="5527772">nil</span>&nbsp;<span class="op" id="5527776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527780">c</span><span class="op" id="5527781">.</span><span class="ident" id="5527782">closeDescriptors</span><span class="op" id="5527798">(</span><span class="ident" id="5527799">c</span><span class="op" id="5527800">.</span><span class="ident" id="5527801">closeAfterStart</span><span class="op" id="5527816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527820">c</span><span class="op" id="5527821">.</span><span class="ident" id="5527822">closeDescriptors</span><span class="op" id="5527838">(</span><span class="ident" id="5527839">c</span><span class="op" id="5527840">.</span><span class="ident" id="5527841">closeAfterWait</span><span class="op" id="5527855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527859">return</span>&nbsp;<span class="ident" id="5527866">c</span><span class="op" id="5527867">.</span><span class="ident" id="5527868">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5527881">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527884">if</span>&nbsp;<span class="ident" id="5527887">runtime</span><span class="op" id="5527894">.</span><span class="ident" id="5527895">GOOS</span>&nbsp;<span class="op" id="5527900">==</span>&nbsp;<span class="string" id="5527903">&#34;windows&#34;</span>&nbsp;<span class="op" id="5527913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527917">lp</span><span class="op" id="5527919">,</span>&nbsp;<span class="ident" id="5527921">err</span>&nbsp;<span class="op" id="5527925">:=</span>&nbsp;<span class="ident" id="5527928">lookExtensions</span><span class="op" id="5527942">(</span><span class="ident" id="5527943">c</span><span class="op" id="5527944">.</span><span class="ident" id="5527945">Path</span><span class="op" id="5527949">,</span>&nbsp;<span class="ident" id="5527951">c</span><span class="op" id="5527952">.</span><span class="ident" id="5527953">Dir</span><span class="op" id="5527956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5527960">if</span>&nbsp;<span class="ident" id="5527963">err</span>&nbsp;<span class="op" id="5527967">!=</span>&nbsp;<span class="builtintype" id="5527970">nil</span>&nbsp;<span class="op" id="5527974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5527979">c</span><span class="op" id="5527980">.</span><span class="ident" id="5527981">closeDescriptors</span><span class="op" id="5527997">(</span><span class="ident" id="5527998">c</span><span class="op" id="5527999">.</span><span class="ident" id="5528000">closeAfterStart</span><span class="op" id="5528015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528020">c</span><span class="op" id="5528021">.</span><span class="ident" id="5528022">closeDescriptors</span><span class="op" id="5528038">(</span><span class="ident" id="5528039">c</span><span class="op" id="5528040">.</span><span class="ident" id="5528041">closeAfterWait</span><span class="op" id="5528055">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528060">return</span>&nbsp;<span class="ident" id="5528067">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528077">c</span><span class="op" id="5528078">.</span><span class="ident" id="5528079">Path</span>&nbsp;<span class="op" id="5528084">=</span>&nbsp;<span class="ident" id="5528086">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528093">if</span>&nbsp;<span class="ident" id="5528096">c</span><span class="op" id="5528097">.</span><span class="ident" id="5528098">Process</span>&nbsp;<span class="op" id="5528106">!=</span>&nbsp;<span class="builtintype" id="5528109">nil</span>&nbsp;<span class="op" id="5528113">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528117">return</span>&nbsp;<span class="ident" id="5528124">errors</span><span class="op" id="5528130">.</span><span class="ident" id="5528131">New</span><span class="op" id="5528134">(</span><span class="string" id="5528135">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5528158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528165">type</span>&nbsp;<span class="ident" id="5528170">F</span>&nbsp;<span class="keyword" id="5528172">func</span><span class="op" id="5528176">(</span><span class="op" id="5528177">*</span><span class="ident" id="5528178">Cmd</span><span class="op" id="5528181">)</span>&nbsp;<span class="op" id="5528183">(</span><span class="op" id="5528184">*</span><span class="ident" id="5528185">os</span><span class="op" id="5528187">.</span><span class="ident" id="5528188">File</span><span class="op" id="5528192">,</span>&nbsp;<span class="builtintype" id="5528194">error</span><span class="op" id="5528199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528202">for</span>&nbsp;<span class="ident" id="5528206">_</span><span class="op" id="5528207">,</span>&nbsp;<span class="ident" id="5528209">setupFd</span>&nbsp;<span class="op" id="5528217">:=</span>&nbsp;<span class="keyword" id="5528220">range</span>&nbsp;<span class="op" id="5528226">[</span><span class="op" id="5528227">]</span><span class="ident" id="5528228">F</span><span class="op" id="5528229">{</span><span class="op" id="5528230">(</span><span class="op" id="5528231">*</span><span class="ident" id="5528232">Cmd</span><span class="op" id="5528235">)</span><span class="op" id="5528236">.</span><span class="ident" id="5528237">stdin</span><span class="op" id="5528242">,</span>&nbsp;<span class="op" id="5528244">(</span><span class="op" id="5528245">*</span><span class="ident" id="5528246">Cmd</span><span class="op" id="5528249">)</span><span class="op" id="5528250">.</span><span class="ident" id="5528251">stdout</span><span class="op" id="5528257">,</span>&nbsp;<span class="op" id="5528259">(</span><span class="op" id="5528260">*</span><span class="ident" id="5528261">Cmd</span><span class="op" id="5528264">)</span><span class="op" id="5528265">.</span><span class="ident" id="5528266">stderr</span><span class="op" id="5528272">}</span>&nbsp;<span class="op" id="5528274">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528278">fd</span><span class="op" id="5528280">,</span>&nbsp;<span class="ident" id="5528282">err</span>&nbsp;<span class="op" id="5528286">:=</span>&nbsp;<span class="ident" id="5528289">setupFd</span><span class="op" id="5528296">(</span><span class="ident" id="5528297">c</span><span class="op" id="5528298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528302">if</span>&nbsp;<span class="ident" id="5528305">err</span>&nbsp;<span class="op" id="5528309">!=</span>&nbsp;<span class="builtintype" id="5528312">nil</span>&nbsp;<span class="op" id="5528316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528321">c</span><span class="op" id="5528322">.</span><span class="ident" id="5528323">closeDescriptors</span><span class="op" id="5528339">(</span><span class="ident" id="5528340">c</span><span class="op" id="5528341">.</span><span class="ident" id="5528342">closeAfterStart</span><span class="op" id="5528357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528362">c</span><span class="op" id="5528363">.</span><span class="ident" id="5528364">closeDescriptors</span><span class="op" id="5528380">(</span><span class="ident" id="5528381">c</span><span class="op" id="5528382">.</span><span class="ident" id="5528383">closeAfterWait</span><span class="op" id="5528397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528402">return</span>&nbsp;<span class="ident" id="5528409">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528419">c</span><span class="op" id="5528420">.</span><span class="ident" id="5528421">childFiles</span>&nbsp;<span class="op" id="5528432">=</span>&nbsp;<span class="builtinfunc" id="5528434">append</span><span class="op" id="5528440">(</span><span class="ident" id="5528441">c</span><span class="op" id="5528442">.</span><span class="ident" id="5528443">childFiles</span><span class="op" id="5528453">,</span>&nbsp;<span class="ident" id="5528455">fd</span><span class="op" id="5528457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528463">c</span><span class="op" id="5528464">.</span><span class="ident" id="5528465">childFiles</span>&nbsp;<span class="op" id="5528476">=</span>&nbsp;<span class="builtinfunc" id="5528478">append</span><span class="op" id="5528484">(</span><span class="ident" id="5528485">c</span><span class="op" id="5528486">.</span><span class="ident" id="5528487">childFiles</span><span class="op" id="5528497">,</span>&nbsp;<span class="ident" id="5528499">c</span><span class="op" id="5528500">.</span><span class="ident" id="5528501">ExtraFiles</span><span class="op" id="5528511">...</span><span class="op" id="5528514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528518">var</span>&nbsp;<span class="ident" id="5528522">err</span>&nbsp;<span class="builtintype" id="5528526">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528533">c</span><span class="op" id="5528534">.</span><span class="ident" id="5528535">Process</span><span class="op" id="5528542">,</span>&nbsp;<span class="ident" id="5528544">err</span>&nbsp;<span class="op" id="5528548">=</span>&nbsp;<span class="ident" id="5528550">os</span><span class="op" id="5528552">.</span><span class="ident" id="5528553">StartProcess</span><span class="op" id="5528565">(</span><span class="ident" id="5528566">c</span><span class="op" id="5528567">.</span><span class="ident" id="5528568">Path</span><span class="op" id="5528572">,</span>&nbsp;<span class="ident" id="5528574">c</span><span class="op" id="5528575">.</span><span class="ident" id="5528576">argv</span><span class="op" id="5528580">(</span><span class="op" id="5528581">)</span><span class="op" id="5528582">,</span>&nbsp;<span class="op" id="5528584">&amp;</span><span class="ident" id="5528585">os</span><span class="op" id="5528587">.</span><span class="ident" id="5528588">ProcAttr</span><span class="op" id="5528596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528600">Dir</span><span class="op" id="5528603">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5528607">c</span><span class="op" id="5528608">.</span><span class="ident" id="5528609">Dir</span><span class="op" id="5528612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528616">Files</span><span class="op" id="5528621">:</span>&nbsp;<span class="ident" id="5528623">c</span><span class="op" id="5528624">.</span><span class="ident" id="5528625">childFiles</span><span class="op" id="5528635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528639">Env</span><span class="op" id="5528642">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5528646">c</span><span class="op" id="5528647">.</span><span class="ident" id="5528648">envv</span><span class="op" id="5528652">(</span><span class="op" id="5528653">)</span><span class="op" id="5528654">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528658">Sys</span><span class="op" id="5528661">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5528665">c</span><span class="op" id="5528666">.</span><span class="ident" id="5528667">SysProcAttr</span><span class="op" id="5528678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528681">}</span><span class="op" id="5528682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528685">if</span>&nbsp;<span class="ident" id="5528688">err</span>&nbsp;<span class="op" id="5528692">!=</span>&nbsp;<span class="builtintype" id="5528695">nil</span>&nbsp;<span class="op" id="5528699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528703">c</span><span class="op" id="5528704">.</span><span class="ident" id="5528705">closeDescriptors</span><span class="op" id="5528721">(</span><span class="ident" id="5528722">c</span><span class="op" id="5528723">.</span><span class="ident" id="5528724">closeAfterStart</span><span class="op" id="5528739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528743">c</span><span class="op" id="5528744">.</span><span class="ident" id="5528745">closeDescriptors</span><span class="op" id="5528761">(</span><span class="ident" id="5528762">c</span><span class="op" id="5528763">.</span><span class="ident" id="5528764">closeAfterWait</span><span class="op" id="5528778">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528782">return</span>&nbsp;<span class="ident" id="5528789">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528798">c</span><span class="op" id="5528799">.</span><span class="ident" id="5528800">closeDescriptors</span><span class="op" id="5528816">(</span><span class="ident" id="5528817">c</span><span class="op" id="5528818">.</span><span class="ident" id="5528819">closeAfterStart</span><span class="op" id="5528834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528838">c</span><span class="op" id="5528839">.</span><span class="ident" id="5528840">errch</span>&nbsp;<span class="op" id="5528846">=</span>&nbsp;<span class="builtinfunc" id="5528848">make</span><span class="op" id="5528852">(</span><span class="keyword" id="5528853">chan</span>&nbsp;<span class="builtintype" id="5528858">error</span><span class="op" id="5528863">,</span>&nbsp;<span class="builtinfunc" id="5528865">len</span><span class="op" id="5528868">(</span><span class="ident" id="5528869">c</span><span class="op" id="5528870">.</span><span class="ident" id="5528871">goroutine</span><span class="op" id="5528880">)</span><span class="op" id="5528881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528884">for</span>&nbsp;<span class="ident" id="5528888">_</span><span class="op" id="5528889">,</span>&nbsp;<span class="ident" id="5528891">fn</span>&nbsp;<span class="op" id="5528894">:=</span>&nbsp;<span class="keyword" id="5528897">range</span>&nbsp;<span class="ident" id="5528903">c</span><span class="op" id="5528904">.</span><span class="ident" id="5528905">goroutine</span>&nbsp;<span class="op" id="5528915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528919">go</span>&nbsp;<span class="keyword" id="5528922">func</span><span class="op" id="5528926">(</span><span class="ident" id="5528927">fn</span>&nbsp;<span class="keyword" id="5528930">func</span><span class="op" id="5528934">(</span><span class="op" id="5528935">)</span>&nbsp;<span class="builtintype" id="5528937">error</span><span class="op" id="5528942">)</span>&nbsp;<span class="op" id="5528944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528949">c</span><span class="op" id="5528950">.</span><span class="ident" id="5528951">errch</span>&nbsp;<span class="op" id="5528957">&lt;-</span>&nbsp;<span class="ident" id="5528960">fn</span><span class="op" id="5528962">(</span><span class="op" id="5528963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528967">}</span><span class="op" id="5528968">(</span><span class="ident" id="5528969">fn</span><span class="op" id="5528971">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5528974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5528978">return</span>&nbsp;<span class="builtintype" id="5528985">nil</span><br>
<span class="lineno"></span><span class="op" id="5528989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5528992">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5529051">type</span>&nbsp;<span class="ident" id="5529056">ExitError</span>&nbsp;<span class="keyword" id="5529066">struct</span>&nbsp;<span class="op" id="5529073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5529076">*</span><span class="ident" id="5529077">os</span><span class="op" id="5529079">.</span><span class="ident" id="5529080">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5529093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5529096">func</span>&nbsp;<span class="op" id="5529101">(</span><span class="ident" id="5529102">e</span>&nbsp;<span class="op" id="5529104">*</span><span class="ident" id="5529105">ExitError</span><span class="op" id="5529114">)</span>&nbsp;<span class="ident" id="5529116">Error</span><span class="op" id="5529121">(</span><span class="op" id="5529122">)</span>&nbsp;<span class="builtintype" id="5529124">string</span>&nbsp;<span class="op" id="5529131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529134">return</span>&nbsp;<span class="ident" id="5529141">e</span><span class="op" id="5529142">.</span><span class="ident" id="5529143">ProcessState</span><span class="op" id="5529155">.</span><span class="ident" id="5529156">String</span><span class="op" id="5529162">(</span><span class="op" id="5529163">)</span><br>
<span class="lineno"></span><span class="op" id="5529165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5529168">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5529207">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5529246">//</span><br>
<span class="lineno"></span><span class="comment" id="5529249">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5529315">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5529380">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5529391">//</span><br>
<span class="lineno"></span><span class="comment" id="5529394">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5529463">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5529520">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5529550">//</span><br>
<span class="lineno">355</span><span class="comment" id="5529553">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5529609">func</span>&nbsp;<span class="op" id="5529614">(</span><span class="ident" id="5529615">c</span>&nbsp;<span class="op" id="5529617">*</span><span class="ident" id="5529618">Cmd</span><span class="op" id="5529621">)</span>&nbsp;<span class="ident" id="5529623">Wait</span><span class="op" id="5529627">(</span><span class="op" id="5529628">)</span>&nbsp;<span class="builtintype" id="5529630">error</span>&nbsp;<span class="op" id="5529636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529639">if</span>&nbsp;<span class="ident" id="5529642">c</span><span class="op" id="5529643">.</span><span class="ident" id="5529644">Process</span>&nbsp;<span class="op" id="5529652">==</span>&nbsp;<span class="builtintype" id="5529655">nil</span>&nbsp;<span class="op" id="5529659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529663">return</span>&nbsp;<span class="ident" id="5529670">errors</span><span class="op" id="5529676">.</span><span class="ident" id="5529677">New</span><span class="op" id="5529680">(</span><span class="string" id="5529681">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5529700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5529703">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529706">if</span>&nbsp;<span class="ident" id="5529709">c</span><span class="op" id="5529710">.</span><span class="ident" id="5529711">finished</span>&nbsp;<span class="op" id="5529720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529724">return</span>&nbsp;<span class="ident" id="5529731">errors</span><span class="op" id="5529737">.</span><span class="ident" id="5529738">New</span><span class="op" id="5529741">(</span><span class="string" id="5529742">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5529773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5529776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5529779">c</span><span class="op" id="5529780">.</span><span class="ident" id="5529781">finished</span>&nbsp;<span class="op" id="5529790">=</span>&nbsp;<span class="builtintype" id="5529792">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5529798">state</span><span class="op" id="5529803">,</span>&nbsp;<span class="ident" id="5529805">err</span>&nbsp;<span class="op" id="5529809">:=</span>&nbsp;<span class="ident" id="5529812">c</span><span class="op" id="5529813">.</span><span class="ident" id="5529814">Process</span><span class="op" id="5529821">.</span><span class="ident" id="5529822">Wait</span><span class="op" id="5529826">(</span><span class="op" id="5529827">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5529830">c</span><span class="op" id="5529831">.</span><span class="ident" id="5529832">ProcessState</span>&nbsp;<span class="op" id="5529845">=</span>&nbsp;<span class="ident" id="5529847">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529855">var</span>&nbsp;<span class="ident" id="5529859">copyError</span>&nbsp;<span class="builtintype" id="5529869">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529876">for</span>&nbsp;<span class="keyword" id="5529880">range</span>&nbsp;<span class="ident" id="5529886">c</span><span class="op" id="5529887">.</span><span class="ident" id="5529888">goroutine</span>&nbsp;<span class="op" id="5529898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5529902">if</span>&nbsp;<span class="ident" id="5529905">err</span>&nbsp;<span class="op" id="5529909">:=</span>&nbsp;<span class="op" id="5529912">&lt;-</span><span class="ident" id="5529914">c</span><span class="op" id="5529915">.</span><span class="ident" id="5529916">errch</span><span class="op" id="5529921">;</span>&nbsp;<span class="ident" id="5529923">err</span>&nbsp;<span class="op" id="5529927">!=</span>&nbsp;<span class="builtintype" id="5529930">nil</span>&nbsp;<span class="op" id="5529934">&amp;&amp;</span>&nbsp;<span class="ident" id="5529937">copyError</span>&nbsp;<span class="op" id="5529947">==</span>&nbsp;<span class="builtintype" id="5529950">nil</span>&nbsp;<span class="op" id="5529954">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5529959">copyError</span>&nbsp;<span class="op" id="5529969">=</span>&nbsp;<span class="ident" id="5529971">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5529977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5529980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5529984">c</span><span class="op" id="5529985">.</span><span class="ident" id="5529986">closeDescriptors</span><span class="op" id="5530002">(</span><span class="ident" id="5530003">c</span><span class="op" id="5530004">.</span><span class="ident" id="5530005">closeAfterWait</span><span class="op" id="5530019">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530023">if</span>&nbsp;<span class="ident" id="5530026">err</span>&nbsp;<span class="op" id="5530030">!=</span>&nbsp;<span class="builtintype" id="5530033">nil</span>&nbsp;<span class="op" id="5530037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530041">return</span>&nbsp;<span class="ident" id="5530048">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530053">}</span>&nbsp;<span class="keyword" id="5530055">else</span>&nbsp;<span class="keyword" id="5530060">if</span>&nbsp;<span class="op" id="5530063">!</span><span class="ident" id="5530064">state</span><span class="op" id="5530069">.</span><span class="ident" id="5530070">Success</span><span class="op" id="5530077">(</span><span class="op" id="5530078">)</span>&nbsp;<span class="op" id="5530080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530084">return</span>&nbsp;<span class="op" id="5530091">&amp;</span><span class="ident" id="5530092">ExitError</span><span class="op" id="5530101">{</span><span class="ident" id="5530102">state</span><span class="op" id="5530107">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530114">return</span>&nbsp;<span class="ident" id="5530121">copyError</span><br>
<span class="lineno"></span><span class="op" id="5530131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5530134">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5530194">func</span>&nbsp;<span class="op" id="5530199">(</span><span class="ident" id="5530200">c</span>&nbsp;<span class="op" id="5530202">*</span><span class="ident" id="5530203">Cmd</span><span class="op" id="5530206">)</span>&nbsp;<span class="ident" id="5530208">Output</span><span class="op" id="5530214">(</span><span class="op" id="5530215">)</span>&nbsp;<span class="op" id="5530217">(</span><span class="op" id="5530218">[</span><span class="op" id="5530219">]</span><span class="builtintype" id="5530220">byte</span><span class="op" id="5530224">,</span>&nbsp;<span class="builtintype" id="5530226">error</span><span class="op" id="5530231">)</span>&nbsp;<span class="op" id="5530233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530236">if</span>&nbsp;<span class="ident" id="5530239">c</span><span class="op" id="5530240">.</span><span class="ident" id="5530241">Stdout</span>&nbsp;<span class="op" id="5530248">!=</span>&nbsp;<span class="builtintype" id="5530251">nil</span>&nbsp;<span class="op" id="5530255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530259">return</span>&nbsp;<span class="builtintype" id="5530266">nil</span><span class="op" id="5530269">,</span>&nbsp;<span class="ident" id="5530271">errors</span><span class="op" id="5530277">.</span><span class="ident" id="5530278">New</span><span class="op" id="5530281">(</span><span class="string" id="5530282">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5530308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530311">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530314">var</span>&nbsp;<span class="ident" id="5530318">b</span>&nbsp;<span class="ident" id="5530320">bytes</span><span class="op" id="5530325">.</span><span class="ident" id="5530326">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5530334">c</span><span class="op" id="5530335">.</span><span class="ident" id="5530336">Stdout</span>&nbsp;<span class="op" id="5530343">=</span>&nbsp;<span class="op" id="5530345">&amp;</span><span class="ident" id="5530346">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5530349">err</span>&nbsp;<span class="op" id="5530353">:=</span>&nbsp;<span class="ident" id="5530356">c</span><span class="op" id="5530357">.</span><span class="ident" id="5530358">Run</span><span class="op" id="5530361">(</span><span class="op" id="5530362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530365">return</span>&nbsp;<span class="ident" id="5530372">b</span><span class="op" id="5530373">.</span><span class="ident" id="5530374">Bytes</span><span class="op" id="5530379">(</span><span class="op" id="5530380">)</span><span class="op" id="5530381">,</span>&nbsp;<span class="ident" id="5530383">err</span><br>
<span class="lineno"></span><span class="op" id="5530387">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5530390">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5530459">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5530489">func</span>&nbsp;<span class="op" id="5530494">(</span><span class="ident" id="5530495">c</span>&nbsp;<span class="op" id="5530497">*</span><span class="ident" id="5530498">Cmd</span><span class="op" id="5530501">)</span>&nbsp;<span class="ident" id="5530503">CombinedOutput</span><span class="op" id="5530517">(</span><span class="op" id="5530518">)</span>&nbsp;<span class="op" id="5530520">(</span><span class="op" id="5530521">[</span><span class="op" id="5530522">]</span><span class="builtintype" id="5530523">byte</span><span class="op" id="5530527">,</span>&nbsp;<span class="builtintype" id="5530529">error</span><span class="op" id="5530534">)</span>&nbsp;<span class="op" id="5530536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530539">if</span>&nbsp;<span class="ident" id="5530542">c</span><span class="op" id="5530543">.</span><span class="ident" id="5530544">Stdout</span>&nbsp;<span class="op" id="5530551">!=</span>&nbsp;<span class="builtintype" id="5530554">nil</span>&nbsp;<span class="op" id="5530558">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530562">return</span>&nbsp;<span class="builtintype" id="5530569">nil</span><span class="op" id="5530572">,</span>&nbsp;<span class="ident" id="5530574">errors</span><span class="op" id="5530580">.</span><span class="ident" id="5530581">New</span><span class="op" id="5530584">(</span><span class="string" id="5530585">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5530611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530617">if</span>&nbsp;<span class="ident" id="5530620">c</span><span class="op" id="5530621">.</span><span class="ident" id="5530622">Stderr</span>&nbsp;<span class="op" id="5530629">!=</span>&nbsp;<span class="builtintype" id="5530632">nil</span>&nbsp;<span class="op" id="5530636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530640">return</span>&nbsp;<span class="builtintype" id="5530647">nil</span><span class="op" id="5530650">,</span>&nbsp;<span class="ident" id="5530652">errors</span><span class="op" id="5530658">.</span><span class="ident" id="5530659">New</span><span class="op" id="5530662">(</span><span class="string" id="5530663">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5530689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530692">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530695">var</span>&nbsp;<span class="ident" id="5530699">b</span>&nbsp;<span class="ident" id="5530701">bytes</span><span class="op" id="5530706">.</span><span class="ident" id="5530707">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5530715">c</span><span class="op" id="5530716">.</span><span class="ident" id="5530717">Stdout</span>&nbsp;<span class="op" id="5530724">=</span>&nbsp;<span class="op" id="5530726">&amp;</span><span class="ident" id="5530727">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5530730">c</span><span class="op" id="5530731">.</span><span class="ident" id="5530732">Stderr</span>&nbsp;<span class="op" id="5530739">=</span>&nbsp;<span class="op" id="5530741">&amp;</span><span class="ident" id="5530742">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5530745">err</span>&nbsp;<span class="op" id="5530749">:=</span>&nbsp;<span class="ident" id="5530752">c</span><span class="op" id="5530753">.</span><span class="ident" id="5530754">Run</span><span class="op" id="5530757">(</span><span class="op" id="5530758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5530761">return</span>&nbsp;<span class="ident" id="5530768">b</span><span class="op" id="5530769">.</span><span class="ident" id="5530770">Bytes</span><span class="op" id="5530775">(</span><span class="op" id="5530776">)</span><span class="op" id="5530777">,</span>&nbsp;<span class="ident" id="5530779">err</span><br>
<span class="lineno">410</span><span class="op" id="5530783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530786">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5530854">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5530897">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5530972">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5531040">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5531116">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5531162">func</span>&nbsp;<span class="op" id="5531167">(</span><span class="ident" id="5531168">c</span>&nbsp;<span class="op" id="5531170">*</span><span class="ident" id="5531171">Cmd</span><span class="op" id="5531174">)</span>&nbsp;<span class="ident" id="5531176">StdinPipe</span><span class="op" id="5531185">(</span><span class="op" id="5531186">)</span>&nbsp;<span class="op" id="5531188">(</span><span class="ident" id="5531189">io</span><span class="op" id="5531191">.</span><span class="ident" id="5531192">WriteCloser</span><span class="op" id="5531203">,</span>&nbsp;<span class="builtintype" id="5531205">error</span><span class="op" id="5531210">)</span>&nbsp;<span class="op" id="5531212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531215">if</span>&nbsp;<span class="ident" id="5531218">c</span><span class="op" id="5531219">.</span><span class="ident" id="5531220">Stdin</span>&nbsp;<span class="op" id="5531226">!=</span>&nbsp;<span class="builtintype" id="5531229">nil</span>&nbsp;<span class="op" id="5531233">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531237">return</span>&nbsp;<span class="builtintype" id="5531244">nil</span><span class="op" id="5531247">,</span>&nbsp;<span class="ident" id="5531249">errors</span><span class="op" id="5531255">.</span><span class="ident" id="5531256">New</span><span class="op" id="5531259">(</span><span class="string" id="5531260">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5531285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5531288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531291">if</span>&nbsp;<span class="ident" id="5531294">c</span><span class="op" id="5531295">.</span><span class="ident" id="5531296">Process</span>&nbsp;<span class="op" id="5531304">!=</span>&nbsp;<span class="builtintype" id="5531307">nil</span>&nbsp;<span class="op" id="5531311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531315">return</span>&nbsp;<span class="builtintype" id="5531322">nil</span><span class="op" id="5531325">,</span>&nbsp;<span class="ident" id="5531327">errors</span><span class="op" id="5531333">.</span><span class="ident" id="5531334">New</span><span class="op" id="5531337">(</span><span class="string" id="5531338">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5531377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5531380">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531383">pr</span><span class="op" id="5531385">,</span>&nbsp;<span class="ident" id="5531387">pw</span><span class="op" id="5531389">,</span>&nbsp;<span class="ident" id="5531391">err</span>&nbsp;<span class="op" id="5531395">:=</span>&nbsp;<span class="ident" id="5531398">os</span><span class="op" id="5531400">.</span><span class="ident" id="5531401">Pipe</span><span class="op" id="5531405">(</span><span class="op" id="5531406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531409">if</span>&nbsp;<span class="ident" id="5531412">err</span>&nbsp;<span class="op" id="5531416">!=</span>&nbsp;<span class="builtintype" id="5531419">nil</span>&nbsp;<span class="op" id="5531423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531427">return</span>&nbsp;<span class="builtintype" id="5531434">nil</span><span class="op" id="5531437">,</span>&nbsp;<span class="ident" id="5531439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5531444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531447">c</span><span class="op" id="5531448">.</span><span class="ident" id="5531449">Stdin</span>&nbsp;<span class="op" id="5531455">=</span>&nbsp;<span class="ident" id="5531457">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531461">c</span><span class="op" id="5531462">.</span><span class="ident" id="5531463">closeAfterStart</span>&nbsp;<span class="op" id="5531479">=</span>&nbsp;<span class="builtinfunc" id="5531481">append</span><span class="op" id="5531487">(</span><span class="ident" id="5531488">c</span><span class="op" id="5531489">.</span><span class="ident" id="5531490">closeAfterStart</span><span class="op" id="5531505">,</span>&nbsp;<span class="ident" id="5531507">pr</span><span class="op" id="5531509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531512">wc</span>&nbsp;<span class="op" id="5531515">:=</span>&nbsp;<span class="op" id="5531518">&amp;</span><span class="ident" id="5531519">closeOnce</span><span class="op" id="5531528">{</span><span class="ident" id="5531529">File</span><span class="op" id="5531533">:</span>&nbsp;<span class="ident" id="5531535">pw</span><span class="op" id="5531537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531540">c</span><span class="op" id="5531541">.</span><span class="ident" id="5531542">closeAfterWait</span>&nbsp;<span class="op" id="5531557">=</span>&nbsp;<span class="builtinfunc" id="5531559">append</span><span class="op" id="5531565">(</span><span class="ident" id="5531566">c</span><span class="op" id="5531567">.</span><span class="ident" id="5531568">closeAfterWait</span><span class="op" id="5531582">,</span>&nbsp;<span class="ident" id="5531584">wc</span><span class="op" id="5531586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531589">return</span>&nbsp;<span class="ident" id="5531596">wc</span><span class="op" id="5531598">,</span>&nbsp;<span class="builtintype" id="5531600">nil</span><br>
<span class="lineno"></span><span class="op" id="5531604">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5531607">type</span>&nbsp;<span class="ident" id="5531612">closeOnce</span>&nbsp;<span class="keyword" id="5531622">struct</span>&nbsp;<span class="op" id="5531629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5531632">*</span><span class="ident" id="5531633">os</span><span class="op" id="5531635">.</span><span class="ident" id="5531636">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531643">once</span>&nbsp;<span class="ident" id="5531648">sync</span><span class="op" id="5531652">.</span><span class="ident" id="5531653">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531659">err</span>&nbsp;&nbsp;<span class="builtintype" id="5531664">error</span><br>
<span class="lineno"></span><span class="op" id="5531670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5531673">func</span>&nbsp;<span class="op" id="5531678">(</span><span class="ident" id="5531679">c</span>&nbsp;<span class="op" id="5531681">*</span><span class="ident" id="5531682">closeOnce</span><span class="op" id="5531691">)</span>&nbsp;<span class="ident" id="5531693">Close</span><span class="op" id="5531698">(</span><span class="op" id="5531699">)</span>&nbsp;<span class="builtintype" id="5531701">error</span>&nbsp;<span class="op" id="5531707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531710">c</span><span class="op" id="5531711">.</span><span class="ident" id="5531712">once</span><span class="op" id="5531716">.</span><span class="ident" id="5531717">Do</span><span class="op" id="5531719">(</span><span class="ident" id="5531720">c</span><span class="op" id="5531721">.</span><span class="builtinfunc" id="5531722">close</span><span class="op" id="5531727">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5531730">return</span>&nbsp;<span class="ident" id="5531737">c</span><span class="op" id="5531738">.</span><span class="ident" id="5531739">err</span><br>
<span class="lineno"></span><span class="op" id="5531743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5531746">func</span>&nbsp;<span class="op" id="5531751">(</span><span class="ident" id="5531752">c</span>&nbsp;<span class="op" id="5531754">*</span><span class="ident" id="5531755">closeOnce</span><span class="op" id="5531764">)</span>&nbsp;<span class="builtinfunc" id="5531766">close</span><span class="op" id="5531771">(</span><span class="op" id="5531772">)</span>&nbsp;<span class="op" id="5531774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5531777">c</span><span class="op" id="5531778">.</span><span class="ident" id="5531779">err</span>&nbsp;<span class="op" id="5531783">=</span>&nbsp;<span class="ident" id="5531785">c</span><span class="op" id="5531786">.</span><span class="ident" id="5531787">File</span><span class="op" id="5531791">.</span><span class="ident" id="5531792">Close</span><span class="op" id="5531797">(</span><span class="op" id="5531798">)</span><br>
<span class="lineno">450</span><span class="op" id="5531800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5531803">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5531872">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5531916">//</span><br>
<span class="lineno">455</span><span class="comment" id="5531919">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5531994">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5532065">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5532144">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5532219">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5532259">func</span>&nbsp;<span class="op" id="5532264">(</span><span class="ident" id="5532265">c</span>&nbsp;<span class="op" id="5532267">*</span><span class="ident" id="5532268">Cmd</span><span class="op" id="5532271">)</span>&nbsp;<span class="ident" id="5532273">StdoutPipe</span><span class="op" id="5532283">(</span><span class="op" id="5532284">)</span>&nbsp;<span class="op" id="5532286">(</span><span class="ident" id="5532287">io</span><span class="op" id="5532289">.</span><span class="ident" id="5532290">ReadCloser</span><span class="op" id="5532300">,</span>&nbsp;<span class="builtintype" id="5532302">error</span><span class="op" id="5532307">)</span>&nbsp;<span class="op" id="5532309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532312">if</span>&nbsp;<span class="ident" id="5532315">c</span><span class="op" id="5532316">.</span><span class="ident" id="5532317">Stdout</span>&nbsp;<span class="op" id="5532324">!=</span>&nbsp;<span class="builtintype" id="5532327">nil</span>&nbsp;<span class="op" id="5532331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532335">return</span>&nbsp;<span class="builtintype" id="5532342">nil</span><span class="op" id="5532345">,</span>&nbsp;<span class="ident" id="5532347">errors</span><span class="op" id="5532353">.</span><span class="ident" id="5532354">New</span><span class="op" id="5532357">(</span><span class="string" id="5532358">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5532384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5532387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532390">if</span>&nbsp;<span class="ident" id="5532393">c</span><span class="op" id="5532394">.</span><span class="ident" id="5532395">Process</span>&nbsp;<span class="op" id="5532403">!=</span>&nbsp;<span class="builtintype" id="5532406">nil</span>&nbsp;<span class="op" id="5532410">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532414">return</span>&nbsp;<span class="builtintype" id="5532421">nil</span><span class="op" id="5532424">,</span>&nbsp;<span class="ident" id="5532426">errors</span><span class="op" id="5532432">.</span><span class="ident" id="5532433">New</span><span class="op" id="5532436">(</span><span class="string" id="5532437">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5532477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5532480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5532483">pr</span><span class="op" id="5532485">,</span>&nbsp;<span class="ident" id="5532487">pw</span><span class="op" id="5532489">,</span>&nbsp;<span class="ident" id="5532491">err</span>&nbsp;<span class="op" id="5532495">:=</span>&nbsp;<span class="ident" id="5532498">os</span><span class="op" id="5532500">.</span><span class="ident" id="5532501">Pipe</span><span class="op" id="5532505">(</span><span class="op" id="5532506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532509">if</span>&nbsp;<span class="ident" id="5532512">err</span>&nbsp;<span class="op" id="5532516">!=</span>&nbsp;<span class="builtintype" id="5532519">nil</span>&nbsp;<span class="op" id="5532523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532527">return</span>&nbsp;<span class="builtintype" id="5532534">nil</span><span class="op" id="5532537">,</span>&nbsp;<span class="ident" id="5532539">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5532544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5532547">c</span><span class="op" id="5532548">.</span><span class="ident" id="5532549">Stdout</span>&nbsp;<span class="op" id="5532556">=</span>&nbsp;<span class="ident" id="5532558">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5532562">c</span><span class="op" id="5532563">.</span><span class="ident" id="5532564">closeAfterStart</span>&nbsp;<span class="op" id="5532580">=</span>&nbsp;<span class="builtinfunc" id="5532582">append</span><span class="op" id="5532588">(</span><span class="ident" id="5532589">c</span><span class="op" id="5532590">.</span><span class="ident" id="5532591">closeAfterStart</span><span class="op" id="5532606">,</span>&nbsp;<span class="ident" id="5532608">pw</span><span class="op" id="5532610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5532613">c</span><span class="op" id="5532614">.</span><span class="ident" id="5532615">closeAfterWait</span>&nbsp;<span class="op" id="5532630">=</span>&nbsp;<span class="builtinfunc" id="5532632">append</span><span class="op" id="5532638">(</span><span class="ident" id="5532639">c</span><span class="op" id="5532640">.</span><span class="ident" id="5532641">closeAfterWait</span><span class="op" id="5532655">,</span>&nbsp;<span class="ident" id="5532657">pr</span><span class="op" id="5532659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5532662">return</span>&nbsp;<span class="ident" id="5532669">pr</span><span class="op" id="5532671">,</span>&nbsp;<span class="builtintype" id="5532673">nil</span><br>
<span class="lineno">475</span><span class="op" id="5532677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5532680">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5532749">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5532792">//</span><br>
<span class="lineno">480</span><span class="comment" id="5532795">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5532870">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5532941">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5533020">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5533094">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5533145">func</span>&nbsp;<span class="op" id="5533150">(</span><span class="ident" id="5533151">c</span>&nbsp;<span class="op" id="5533153">*</span><span class="ident" id="5533154">Cmd</span><span class="op" id="5533157">)</span>&nbsp;<span class="ident" id="5533159">StderrPipe</span><span class="op" id="5533169">(</span><span class="op" id="5533170">)</span>&nbsp;<span class="op" id="5533172">(</span><span class="ident" id="5533173">io</span><span class="op" id="5533175">.</span><span class="ident" id="5533176">ReadCloser</span><span class="op" id="5533186">,</span>&nbsp;<span class="builtintype" id="5533188">error</span><span class="op" id="5533193">)</span>&nbsp;<span class="op" id="5533195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533198">if</span>&nbsp;<span class="ident" id="5533201">c</span><span class="op" id="5533202">.</span><span class="ident" id="5533203">Stderr</span>&nbsp;<span class="op" id="5533210">!=</span>&nbsp;<span class="builtintype" id="5533213">nil</span>&nbsp;<span class="op" id="5533217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533221">return</span>&nbsp;<span class="builtintype" id="5533228">nil</span><span class="op" id="5533231">,</span>&nbsp;<span class="ident" id="5533233">errors</span><span class="op" id="5533239">.</span><span class="ident" id="5533240">New</span><span class="op" id="5533243">(</span><span class="string" id="5533244">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5533270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5533273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533276">if</span>&nbsp;<span class="ident" id="5533279">c</span><span class="op" id="5533280">.</span><span class="ident" id="5533281">Process</span>&nbsp;<span class="op" id="5533289">!=</span>&nbsp;<span class="builtintype" id="5533292">nil</span>&nbsp;<span class="op" id="5533296">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533300">return</span>&nbsp;<span class="builtintype" id="5533307">nil</span><span class="op" id="5533310">,</span>&nbsp;<span class="ident" id="5533312">errors</span><span class="op" id="5533318">.</span><span class="ident" id="5533319">New</span><span class="op" id="5533322">(</span><span class="string" id="5533323">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5533363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5533366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5533369">pr</span><span class="op" id="5533371">,</span>&nbsp;<span class="ident" id="5533373">pw</span><span class="op" id="5533375">,</span>&nbsp;<span class="ident" id="5533377">err</span>&nbsp;<span class="op" id="5533381">:=</span>&nbsp;<span class="ident" id="5533384">os</span><span class="op" id="5533386">.</span><span class="ident" id="5533387">Pipe</span><span class="op" id="5533391">(</span><span class="op" id="5533392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533395">if</span>&nbsp;<span class="ident" id="5533398">err</span>&nbsp;<span class="op" id="5533402">!=</span>&nbsp;<span class="builtintype" id="5533405">nil</span>&nbsp;<span class="op" id="5533409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533413">return</span>&nbsp;<span class="builtintype" id="5533420">nil</span><span class="op" id="5533423">,</span>&nbsp;<span class="ident" id="5533425">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5533430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5533433">c</span><span class="op" id="5533434">.</span><span class="ident" id="5533435">Stderr</span>&nbsp;<span class="op" id="5533442">=</span>&nbsp;<span class="ident" id="5533444">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5533448">c</span><span class="op" id="5533449">.</span><span class="ident" id="5533450">closeAfterStart</span>&nbsp;<span class="op" id="5533466">=</span>&nbsp;<span class="builtinfunc" id="5533468">append</span><span class="op" id="5533474">(</span><span class="ident" id="5533475">c</span><span class="op" id="5533476">.</span><span class="ident" id="5533477">closeAfterStart</span><span class="op" id="5533492">,</span>&nbsp;<span class="ident" id="5533494">pw</span><span class="op" id="5533496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5533499">c</span><span class="op" id="5533500">.</span><span class="ident" id="5533501">closeAfterWait</span>&nbsp;<span class="op" id="5533516">=</span>&nbsp;<span class="builtinfunc" id="5533518">append</span><span class="op" id="5533524">(</span><span class="ident" id="5533525">c</span><span class="op" id="5533526">.</span><span class="ident" id="5533527">closeAfterWait</span><span class="op" id="5533541">,</span>&nbsp;<span class="ident" id="5533543">pr</span><span class="op" id="5533545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5533548">return</span>&nbsp;<span class="ident" id="5533555">pr</span><span class="op" id="5533557">,</span>&nbsp;<span class="builtintype" id="5533559">nil</span><br>
<span class="lineno">500</span><span class="op" id="5533563">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
