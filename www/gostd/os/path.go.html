<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2567412">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2567467">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2567521">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2567572">package</span>&nbsp;<span class="ident" id="2567580">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567584">import</span>&nbsp;<span class="op" id="2567591">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2567594">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2567600">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2567610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2567613">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2567657">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2567711">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2567740">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2567785">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2567823">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2567880">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2567900">func</span>&nbsp;<span class="ident" id="2567905">MkdirAll</span><span class="op" id="2567913">(</span><span class="ident" id="2567914">path</span>&nbsp;<span class="builtintype" id="2567919">string</span><span class="op" id="2567925">,</span>&nbsp;<span class="ident" id="2567927">perm</span>&nbsp;<span class="ident" id="2567932">FileMode</span><span class="op" id="2567940">)</span>&nbsp;<span class="builtintype" id="2567942">error</span>&nbsp;<span class="op" id="2567948">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2567951">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568046">dir</span><span class="op" id="2568049">,</span>&nbsp;<span class="ident" id="2568051">err</span>&nbsp;<span class="op" id="2568055">:=</span>&nbsp;<span class="ident" id="2568058">Stat</span><span class="op" id="2568062">(</span><span class="ident" id="2568063">path</span><span class="op" id="2568067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568070">if</span>&nbsp;<span class="ident" id="2568073">err</span>&nbsp;<span class="op" id="2568077">==</span>&nbsp;<span class="ident" id="2568080">nil</span>&nbsp;<span class="op" id="2568084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568088">if</span>&nbsp;<span class="ident" id="2568091">dir</span><span class="op" id="2568094">.</span><span class="ident" id="2568095">IsDir</span><span class="op" id="2568100">(</span><span class="op" id="2568101">)</span>&nbsp;<span class="op" id="2568103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568108">return</span>&nbsp;<span class="ident" id="2568115">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568125">return</span>&nbsp;<span class="op" id="2568132">&amp;</span><span class="ident" id="2568133">PathError</span><span class="op" id="2568142">{</span><span class="string" id="2568143">&#34;mkdir&#34;</span><span class="op" id="2568150">,</span>&nbsp;<span class="ident" id="2568152">path</span><span class="op" id="2568156">,</span>&nbsp;<span class="ident" id="2568158">syscall</span><span class="op" id="2568165">.</span><span class="ident" id="2568166">ENOTDIR</span><span class="op" id="2568173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2568180">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568249">i</span>&nbsp;<span class="op" id="2568251">:=</span>&nbsp;<span class="builtinfunc" id="2568254">len</span><span class="op" id="2568257">(</span><span class="ident" id="2568258">path</span><span class="op" id="2568262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568265">for</span>&nbsp;<span class="ident" id="2568269">i</span>&nbsp;<span class="op" id="2568271">&gt;</span>&nbsp;<span class="num" id="2568273">0</span>&nbsp;<span class="op" id="2568275">&amp;&amp;</span>&nbsp;<span class="ident" id="2568278">IsPathSeparator</span><span class="op" id="2568293">(</span><span class="ident" id="2568294">path</span><span class="op" id="2568298">[</span><span class="ident" id="2568299">i</span><span class="op" id="2568300">-</span><span class="num" id="2568301">1</span><span class="op" id="2568302">]</span><span class="op" id="2568303">)</span>&nbsp;<span class="op" id="2568305">{</span>&nbsp;<span class="comment" id="2568307">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568342">i</span><span class="op" id="2568343">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568351">j</span>&nbsp;<span class="op" id="2568353">:=</span>&nbsp;<span class="ident" id="2568356">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568359">for</span>&nbsp;<span class="ident" id="2568363">j</span>&nbsp;<span class="op" id="2568365">&gt;</span>&nbsp;<span class="num" id="2568367">0</span>&nbsp;<span class="op" id="2568369">&amp;&amp;</span>&nbsp;<span class="op" id="2568372">!</span><span class="ident" id="2568373">IsPathSeparator</span><span class="op" id="2568388">(</span><span class="ident" id="2568389">path</span><span class="op" id="2568393">[</span><span class="ident" id="2568394">j</span><span class="op" id="2568395">-</span><span class="num" id="2568396">1</span><span class="op" id="2568397">]</span><span class="op" id="2568398">)</span>&nbsp;<span class="op" id="2568400">{</span>&nbsp;<span class="comment" id="2568402">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568435">j</span><span class="op" id="2568436">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568444">if</span>&nbsp;<span class="ident" id="2568447">j</span>&nbsp;<span class="op" id="2568449">&gt;</span>&nbsp;<span class="num" id="2568451">1</span>&nbsp;<span class="op" id="2568453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2568457">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568476">err</span>&nbsp;<span class="op" id="2568480">=</span>&nbsp;<span class="ident" id="2568482">MkdirAll</span><span class="op" id="2568490">(</span><span class="ident" id="2568491">path</span><span class="op" id="2568495">[</span><span class="num" id="2568496">0</span><span class="op" id="2568497">:</span><span class="ident" id="2568498">j</span><span class="op" id="2568499">-</span><span class="num" id="2568500">1</span><span class="op" id="2568501">]</span><span class="op" id="2568502">,</span>&nbsp;<span class="ident" id="2568504">perm</span><span class="op" id="2568508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568512">if</span>&nbsp;<span class="ident" id="2568515">err</span>&nbsp;<span class="op" id="2568519">!=</span>&nbsp;<span class="ident" id="2568522">nil</span>&nbsp;<span class="op" id="2568526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568531">return</span>&nbsp;<span class="ident" id="2568538">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2568551">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568607">err</span>&nbsp;<span class="op" id="2568611">=</span>&nbsp;<span class="ident" id="2568613">Mkdir</span><span class="op" id="2568618">(</span><span class="ident" id="2568619">path</span><span class="op" id="2568623">,</span>&nbsp;<span class="ident" id="2568625">perm</span><span class="op" id="2568629">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568632">if</span>&nbsp;<span class="ident" id="2568635">err</span>&nbsp;<span class="op" id="2568639">!=</span>&nbsp;<span class="ident" id="2568642">nil</span>&nbsp;<span class="op" id="2568646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2568650">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2568688">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568739">dir</span><span class="op" id="2568742">,</span>&nbsp;<span class="ident" id="2568744">err1</span>&nbsp;<span class="op" id="2568749">:=</span>&nbsp;<span class="ident" id="2568752">Lstat</span><span class="op" id="2568757">(</span><span class="ident" id="2568758">path</span><span class="op" id="2568762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568766">if</span>&nbsp;<span class="ident" id="2568769">err1</span>&nbsp;<span class="op" id="2568774">==</span>&nbsp;<span class="ident" id="2568777">nil</span>&nbsp;<span class="op" id="2568781">&amp;&amp;</span>&nbsp;<span class="ident" id="2568784">dir</span><span class="op" id="2568787">.</span><span class="ident" id="2568788">IsDir</span><span class="op" id="2568793">(</span><span class="op" id="2568794">)</span>&nbsp;<span class="op" id="2568796">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568801">return</span>&nbsp;<span class="ident" id="2568808">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568818">return</span>&nbsp;<span class="ident" id="2568825">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568833">return</span>&nbsp;<span class="ident" id="2568840">nil</span><br>
<span class="lineno">60</span><span class="op" id="2568844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2568847">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2568903">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2568963">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2569020">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2569047">func</span>&nbsp;<span class="ident" id="2569052">RemoveAll</span><span class="op" id="2569061">(</span><span class="ident" id="2569062">path</span>&nbsp;<span class="builtintype" id="2569067">string</span><span class="op" id="2569073">)</span>&nbsp;<span class="builtintype" id="2569075">error</span>&nbsp;<span class="op" id="2569081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569084">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569130">err</span>&nbsp;<span class="op" id="2569134">:=</span>&nbsp;<span class="ident" id="2569137">Remove</span><span class="op" id="2569143">(</span><span class="ident" id="2569144">path</span><span class="op" id="2569148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569151">if</span>&nbsp;<span class="ident" id="2569154">err</span>&nbsp;<span class="op" id="2569158">==</span>&nbsp;<span class="ident" id="2569161">nil</span>&nbsp;<span class="op" id="2569165">||</span>&nbsp;<span class="ident" id="2569168">IsNotExist</span><span class="op" id="2569178">(</span><span class="ident" id="2569179">err</span><span class="op" id="2569182">)</span>&nbsp;<span class="op" id="2569184">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569188">return</span>&nbsp;<span class="ident" id="2569195">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569204">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569264">dir</span><span class="op" id="2569267">,</span>&nbsp;<span class="ident" id="2569269">serr</span>&nbsp;<span class="op" id="2569274">:=</span>&nbsp;<span class="ident" id="2569277">Lstat</span><span class="op" id="2569282">(</span><span class="ident" id="2569283">path</span><span class="op" id="2569287">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569290">if</span>&nbsp;<span class="ident" id="2569293">serr</span>&nbsp;<span class="op" id="2569298">!=</span>&nbsp;<span class="ident" id="2569301">nil</span>&nbsp;<span class="op" id="2569305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569309">if</span>&nbsp;<span class="ident" id="2569312">serr</span><span class="op" id="2569316">,</span>&nbsp;<span class="ident" id="2569318">ok</span>&nbsp;<span class="op" id="2569321">:=</span>&nbsp;<span class="ident" id="2569324">serr</span><span class="op" id="2569328">.</span><span class="op" id="2569329">(</span><span class="op" id="2569330">*</span><span class="ident" id="2569331">PathError</span><span class="op" id="2569340">)</span><span class="op" id="2569341">;</span>&nbsp;<span class="ident" id="2569343">ok</span>&nbsp;<span class="op" id="2569346">&amp;&amp;</span>&nbsp;<span class="op" id="2569349">(</span><span class="ident" id="2569350">IsNotExist</span><span class="op" id="2569360">(</span><span class="ident" id="2569361">serr</span><span class="op" id="2569365">.</span><span class="ident" id="2569366">Err</span><span class="op" id="2569369">)</span>&nbsp;<span class="op" id="2569371">||</span>&nbsp;<span class="ident" id="2569374">serr</span><span class="op" id="2569378">.</span><span class="ident" id="2569379">Err</span>&nbsp;<span class="op" id="2569383">==</span>&nbsp;<span class="ident" id="2569386">syscall</span><span class="op" id="2569393">.</span><span class="ident" id="2569394">ENOTDIR</span><span class="op" id="2569401">)</span>&nbsp;<span class="op" id="2569403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569408">return</span>&nbsp;<span class="ident" id="2569415">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569425">return</span>&nbsp;<span class="ident" id="2569432">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569441">if</span>&nbsp;<span class="op" id="2569444">!</span><span class="ident" id="2569445">dir</span><span class="op" id="2569448">.</span><span class="ident" id="2569449">IsDir</span><span class="op" id="2569454">(</span><span class="op" id="2569455">)</span>&nbsp;<span class="op" id="2569457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569461">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569513">return</span>&nbsp;<span class="ident" id="2569520">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569525">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569529">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569544">fd</span><span class="op" id="2569546">,</span>&nbsp;<span class="ident" id="2569548">err</span>&nbsp;<span class="op" id="2569552">:=</span>&nbsp;<span class="ident" id="2569555">Open</span><span class="op" id="2569559">(</span><span class="ident" id="2569560">path</span><span class="op" id="2569564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569567">if</span>&nbsp;<span class="ident" id="2569570">err</span>&nbsp;<span class="op" id="2569574">!=</span>&nbsp;<span class="ident" id="2569577">nil</span>&nbsp;<span class="op" id="2569581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569585">if</span>&nbsp;<span class="ident" id="2569588">IsNotExist</span><span class="op" id="2569598">(</span><span class="ident" id="2569599">err</span><span class="op" id="2569602">)</span>&nbsp;<span class="op" id="2569604">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569609">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569664">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569703">return</span>&nbsp;<span class="ident" id="2569710">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569720">return</span>&nbsp;<span class="ident" id="2569727">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2569736">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569778">err</span>&nbsp;<span class="op" id="2569782">=</span>&nbsp;<span class="ident" id="2569784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569789">for</span>&nbsp;<span class="op" id="2569793">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569797">names</span><span class="op" id="2569802">,</span>&nbsp;<span class="ident" id="2569804">err1</span>&nbsp;<span class="op" id="2569809">:=</span>&nbsp;<span class="ident" id="2569812">fd</span><span class="op" id="2569814">.</span><span class="ident" id="2569815">Readdirnames</span><span class="op" id="2569827">(</span><span class="num" id="2569828">100</span><span class="op" id="2569831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569835">for</span>&nbsp;<span class="ident" id="2569839">_</span><span class="op" id="2569840">,</span>&nbsp;<span class="ident" id="2569842">name</span>&nbsp;<span class="op" id="2569847">:=</span>&nbsp;<span class="keyword" id="2569850">range</span>&nbsp;<span class="ident" id="2569856">names</span>&nbsp;<span class="op" id="2569862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569867">err1</span>&nbsp;<span class="op" id="2569872">:=</span>&nbsp;<span class="ident" id="2569875">RemoveAll</span><span class="op" id="2569884">(</span><span class="ident" id="2569885">path</span>&nbsp;<span class="op" id="2569890">+</span>&nbsp;<span class="builtintype" id="2569892">string</span><span class="op" id="2569898">(</span><span class="ident" id="2569899">PathSeparator</span><span class="op" id="2569912">)</span>&nbsp;<span class="op" id="2569914">+</span>&nbsp;<span class="ident" id="2569916">name</span><span class="op" id="2569920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569925">if</span>&nbsp;<span class="ident" id="2569928">err</span>&nbsp;<span class="op" id="2569932">==</span>&nbsp;<span class="ident" id="2569935">nil</span>&nbsp;<span class="op" id="2569939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569945">err</span>&nbsp;<span class="op" id="2569949">=</span>&nbsp;<span class="ident" id="2569951">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569967">if</span>&nbsp;<span class="ident" id="2569970">err1</span>&nbsp;<span class="op" id="2569975">==</span>&nbsp;<span class="ident" id="2569978">io</span><span class="op" id="2569980">.</span><span class="ident" id="2569981">EOF</span>&nbsp;<span class="op" id="2569985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569990">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569998">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2570002">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570050">if</span>&nbsp;<span class="ident" id="2570053">err</span>&nbsp;<span class="op" id="2570057">==</span>&nbsp;<span class="ident" id="2570060">nil</span>&nbsp;<span class="op" id="2570064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570069">err</span>&nbsp;<span class="op" id="2570073">=</span>&nbsp;<span class="ident" id="2570075">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570086">if</span>&nbsp;<span class="builtinfunc" id="2570089">len</span><span class="op" id="2570092">(</span><span class="ident" id="2570093">names</span><span class="op" id="2570098">)</span>&nbsp;<span class="op" id="2570100">==</span>&nbsp;<span class="num" id="2570103">0</span>&nbsp;<span class="op" id="2570105">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570110">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2570125">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570193">fd</span><span class="op" id="2570195">.</span><span class="ident" id="2570196">Close</span><span class="op" id="2570201">(</span><span class="op" id="2570202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2570206">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570228">err1</span>&nbsp;<span class="op" id="2570233">:=</span>&nbsp;<span class="ident" id="2570236">Remove</span><span class="op" id="2570242">(</span><span class="ident" id="2570243">path</span><span class="op" id="2570247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570250">if</span>&nbsp;<span class="ident" id="2570253">err1</span>&nbsp;<span class="op" id="2570258">==</span>&nbsp;<span class="ident" id="2570261">nil</span>&nbsp;<span class="op" id="2570265">||</span>&nbsp;<span class="ident" id="2570268">IsNotExist</span><span class="op" id="2570278">(</span><span class="ident" id="2570279">err1</span><span class="op" id="2570283">)</span>&nbsp;<span class="op" id="2570285">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570289">return</span>&nbsp;<span class="ident" id="2570296">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570304">if</span>&nbsp;<span class="ident" id="2570307">err</span>&nbsp;<span class="op" id="2570311">==</span>&nbsp;<span class="ident" id="2570314">nil</span>&nbsp;<span class="op" id="2570318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570322">err</span>&nbsp;<span class="op" id="2570326">=</span>&nbsp;<span class="ident" id="2570328">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570334">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570337">return</span>&nbsp;<span class="ident" id="2570344">err</span><br>
<span class="lineno"></span><span class="op" id="2570348">}</span>
</div>
</body>
</html>
