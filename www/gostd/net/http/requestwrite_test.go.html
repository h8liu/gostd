<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7495525">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7495581">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7495635">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7495686">package</span>&nbsp;<span class="ident" id="7495694">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7495700">import</span>&nbsp;<span class="op" id="7495707">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495710">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495719">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495729">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495736">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495742">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495755">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495766">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495777">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7495787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7495790">type</span>&nbsp;<span class="ident" id="7495795">reqWriteTest</span>&nbsp;<span class="keyword" id="7495808">struct</span>&nbsp;<span class="op" id="7495815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495818">Req</span>&nbsp;&nbsp;<span class="ident" id="7495823">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495832">Body</span>&nbsp;<span class="keyword" id="7495837">interface</span><span class="op" id="7495846">{</span><span class="op" id="7495847">}</span>&nbsp;<span class="comment" id="7495849">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7495915">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495970">WantWrite</span>&nbsp;<span class="builtintype" id="7495980">string</span>&nbsp;<span class="comment" id="7495987">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496005">WantProxy</span>&nbsp;<span class="builtintype" id="7496015">string</span>&nbsp;<span class="comment" id="7496022">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496046">WantError</span>&nbsp;<span class="builtintype" id="7496056">error</span>&nbsp;<span class="comment" id="7496062">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7496097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7496100">var</span>&nbsp;<span class="ident" id="7496104">reqWriteTests</span>&nbsp;<span class="op" id="7496118">=</span>&nbsp;<span class="op" id="7496120">[</span><span class="op" id="7496121">]</span><span class="ident" id="7496122">reqWriteTest</span><span class="op" id="7496134">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7496137">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496193">Req</span><span class="op" id="7496196">:</span>&nbsp;<span class="ident" id="7496198">Request</span><span class="op" id="7496205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496210">Method</span><span class="op" id="7496216">:</span>&nbsp;<span class="string" id="7496218">&#34;GET&#34;</span><span class="op" id="7496223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496228">URL</span><span class="op" id="7496231">:</span>&nbsp;<span class="op" id="7496233">&amp;</span><span class="ident" id="7496234">url</span><span class="op" id="7496237">.</span><span class="ident" id="7496238">URL</span><span class="op" id="7496241">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496247">Scheme</span><span class="op" id="7496253">:</span>&nbsp;<span class="string" id="7496255">&#34;http&#34;</span><span class="op" id="7496261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496267">Host</span><span class="op" id="7496271">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7496275">&#34;www.techcrunch.com&#34;</span><span class="op" id="7496295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496301">Path</span><span class="op" id="7496305">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7496309">&#34;/&#34;</span><span class="op" id="7496312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496317">}</span><span class="op" id="7496318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496323">Proto</span><span class="op" id="7496328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496335">&#34;HTTP/1.1&#34;</span><span class="op" id="7496345">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496350">ProtoMajor</span><span class="op" id="7496360">:</span>&nbsp;<span class="num" id="7496362">1</span><span class="op" id="7496363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496368">ProtoMinor</span><span class="op" id="7496378">:</span>&nbsp;<span class="num" id="7496380">1</span><span class="op" id="7496381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496386">Header</span><span class="op" id="7496392">:</span>&nbsp;<span class="ident" id="7496394">Header</span><span class="op" id="7496400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496406">&#34;Accept&#34;</span><span class="op" id="7496414">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496426">{</span><span class="string" id="7496427">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7496492">}</span><span class="op" id="7496493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496499">&#34;Accept-Charset&#34;</span><span class="op" id="7496515">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7496519">{</span><span class="string" id="7496520">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7496552">}</span><span class="op" id="7496553">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496559">&#34;Accept-Encoding&#34;</span><span class="op" id="7496576">:</span>&nbsp;&nbsp;<span class="op" id="7496579">{</span><span class="string" id="7496580">&#34;gzip,deflate&#34;</span><span class="op" id="7496594">}</span><span class="op" id="7496595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496601">&#34;Accept-Language&#34;</span><span class="op" id="7496618">:</span>&nbsp;&nbsp;<span class="op" id="7496621">{</span><span class="string" id="7496622">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7496638">}</span><span class="op" id="7496639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496645">&#34;Keep-Alive&#34;</span><span class="op" id="7496657">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496665">{</span><span class="string" id="7496666">&#34;300&#34;</span><span class="op" id="7496671">}</span><span class="op" id="7496672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496678">&#34;Proxy-Connection&#34;</span><span class="op" id="7496696">:</span>&nbsp;<span class="op" id="7496698">{</span><span class="string" id="7496699">&#34;keep-alive&#34;</span><span class="op" id="7496711">}</span><span class="op" id="7496712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496718">&#34;User-Agent&#34;</span><span class="op" id="7496730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496738">{</span><span class="string" id="7496739">&#34;Fake&#34;</span><span class="op" id="7496745">}</span><span class="op" id="7496746">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496751">}</span><span class="op" id="7496752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496757">Body</span><span class="op" id="7496761">:</span>&nbsp;&nbsp;<span class="builtintype" id="7496764">nil</span><span class="op" id="7496767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496772">Close</span><span class="op" id="7496777">:</span>&nbsp;<span class="builtintype" id="7496779">false</span><span class="op" id="7496784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496789">Host</span><span class="op" id="7496793">:</span>&nbsp;&nbsp;<span class="string" id="7496796">&#34;www.techcrunch.com&#34;</span><span class="op" id="7496816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496821">Form</span><span class="op" id="7496825">:</span>&nbsp;&nbsp;<span class="keyword" id="7496828">map</span><span class="op" id="7496831">[</span><span class="builtintype" id="7496832">string</span><span class="op" id="7496838">]</span><span class="op" id="7496839">[</span><span class="op" id="7496840">]</span><span class="builtintype" id="7496841">string</span><span class="op" id="7496847">{</span><span class="op" id="7496848">}</span><span class="op" id="7496849">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496853">}</span><span class="op" id="7496854">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496859">WantWrite</span><span class="op" id="7496868">:</span>&nbsp;<span class="string" id="7496870">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7496891">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496896">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7496927">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496932">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7496955">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7496960">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7497038">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497043">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7497096">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497101">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7497137">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497142">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7497180">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497185">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7497207">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497212">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7497250">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497255">WantProxy</span><span class="op" id="7497264">:</span>&nbsp;<span class="string" id="7497266">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7497312">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497317">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7497348">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497353">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7497376">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497381">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7497459">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497464">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7497517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497522">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7497558">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497563">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7497601">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497606">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7497628">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7497633">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7497671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497674">}</span><span class="op" id="7497675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7497678">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497734">Req</span><span class="op" id="7497737">:</span>&nbsp;<span class="ident" id="7497739">Request</span><span class="op" id="7497746">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497751">Method</span><span class="op" id="7497757">:</span>&nbsp;<span class="string" id="7497759">&#34;GET&#34;</span><span class="op" id="7497764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497769">URL</span><span class="op" id="7497772">:</span>&nbsp;<span class="op" id="7497774">&amp;</span><span class="ident" id="7497775">url</span><span class="op" id="7497778">.</span><span class="ident" id="7497779">URL</span><span class="op" id="7497782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497788">Scheme</span><span class="op" id="7497794">:</span>&nbsp;<span class="string" id="7497796">&#34;http&#34;</span><span class="op" id="7497802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497808">Host</span><span class="op" id="7497812">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7497816">&#34;www.google.com&#34;</span><span class="op" id="7497832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497838">Path</span><span class="op" id="7497842">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7497846">&#34;/search&#34;</span><span class="op" id="7497855">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497860">}</span><span class="op" id="7497861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497866">ProtoMajor</span><span class="op" id="7497876">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7497884">1</span><span class="op" id="7497885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497890">ProtoMinor</span><span class="op" id="7497900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7497908">1</span><span class="op" id="7497909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497914">Header</span><span class="op" id="7497920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497932">Header</span><span class="op" id="7497938">{</span><span class="op" id="7497939">}</span><span class="op" id="7497940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497945">TransferEncoding</span><span class="op" id="7497961">:</span>&nbsp;<span class="op" id="7497963">[</span><span class="op" id="7497964">]</span><span class="builtintype" id="7497965">string</span><span class="op" id="7497971">{</span><span class="string" id="7497972">&#34;chunked&#34;</span><span class="op" id="7497981">}</span><span class="op" id="7497982">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497986">}</span><span class="op" id="7497987">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497992">Body</span><span class="op" id="7497996">:</span>&nbsp;<span class="op" id="7497998">[</span><span class="op" id="7497999">]</span><span class="builtintype" id="7498000">byte</span><span class="op" id="7498004">(</span><span class="string" id="7498005">&#34;abcdef&#34;</span><span class="op" id="7498013">)</span><span class="op" id="7498014">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498019">WantWrite</span><span class="op" id="7498028">:</span>&nbsp;<span class="string" id="7498030">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7498057">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498062">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7498089">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498094">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7498132">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498137">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7498174">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498179">chunk</span><span class="op" id="7498184">(</span><span class="string" id="7498185">&#34;abcdef&#34;</span><span class="op" id="7498193">)</span>&nbsp;<span class="op" id="7498195">+</span>&nbsp;<span class="ident" id="7498197">chunk</span><span class="op" id="7498202">(</span><span class="string" id="7498203">&#34;&#34;</span><span class="op" id="7498205">)</span><span class="op" id="7498206">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498211">WantProxy</span><span class="op" id="7498220">:</span>&nbsp;<span class="string" id="7498222">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7498270">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498275">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7498302">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498307">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7498345">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498350">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7498387">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498392">chunk</span><span class="op" id="7498397">(</span><span class="string" id="7498398">&#34;abcdef&#34;</span><span class="op" id="7498406">)</span>&nbsp;<span class="op" id="7498408">+</span>&nbsp;<span class="ident" id="7498410">chunk</span><span class="op" id="7498415">(</span><span class="string" id="7498416">&#34;&#34;</span><span class="op" id="7498418">)</span><span class="op" id="7498419">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498422">}</span><span class="op" id="7498423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7498426">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498487">Req</span><span class="op" id="7498490">:</span>&nbsp;<span class="ident" id="7498492">Request</span><span class="op" id="7498499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498504">Method</span><span class="op" id="7498510">:</span>&nbsp;<span class="string" id="7498512">&#34;POST&#34;</span><span class="op" id="7498518">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498523">URL</span><span class="op" id="7498526">:</span>&nbsp;<span class="op" id="7498528">&amp;</span><span class="ident" id="7498529">url</span><span class="op" id="7498532">.</span><span class="ident" id="7498533">URL</span><span class="op" id="7498536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498542">Scheme</span><span class="op" id="7498548">:</span>&nbsp;<span class="string" id="7498550">&#34;http&#34;</span><span class="op" id="7498556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498562">Host</span><span class="op" id="7498566">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7498570">&#34;www.google.com&#34;</span><span class="op" id="7498586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498592">Path</span><span class="op" id="7498596">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7498600">&#34;/search&#34;</span><span class="op" id="7498609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498614">}</span><span class="op" id="7498615">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498620">ProtoMajor</span><span class="op" id="7498630">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7498638">1</span><span class="op" id="7498639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498644">ProtoMinor</span><span class="op" id="7498654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7498662">1</span><span class="op" id="7498663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498668">Header</span><span class="op" id="7498674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498686">Header</span><span class="op" id="7498692">{</span><span class="op" id="7498693">}</span><span class="op" id="7498694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498699">Close</span><span class="op" id="7498704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7498717">true</span><span class="op" id="7498721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498726">TransferEncoding</span><span class="op" id="7498742">:</span>&nbsp;<span class="op" id="7498744">[</span><span class="op" id="7498745">]</span><span class="builtintype" id="7498746">string</span><span class="op" id="7498752">{</span><span class="string" id="7498753">&#34;chunked&#34;</span><span class="op" id="7498762">}</span><span class="op" id="7498763">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498767">}</span><span class="op" id="7498768">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498773">Body</span><span class="op" id="7498777">:</span>&nbsp;<span class="op" id="7498779">[</span><span class="op" id="7498780">]</span><span class="builtintype" id="7498781">byte</span><span class="op" id="7498785">(</span><span class="string" id="7498786">&#34;abcdef&#34;</span><span class="op" id="7498794">)</span><span class="op" id="7498795">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498800">WantWrite</span><span class="op" id="7498809">:</span>&nbsp;<span class="string" id="7498811">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7498839">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498844">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7498871">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498876">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7498914">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498919">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7498943">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7498948">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7498985">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498990">chunk</span><span class="op" id="7498995">(</span><span class="string" id="7498996">&#34;abcdef&#34;</span><span class="op" id="7499004">)</span>&nbsp;<span class="op" id="7499006">+</span>&nbsp;<span class="ident" id="7499008">chunk</span><span class="op" id="7499013">(</span><span class="string" id="7499014">&#34;&#34;</span><span class="op" id="7499016">)</span><span class="op" id="7499017">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499022">WantProxy</span><span class="op" id="7499031">:</span>&nbsp;<span class="string" id="7499033">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7499082">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499087">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7499114">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499119">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7499157">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499162">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7499186">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499191">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7499228">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499233">chunk</span><span class="op" id="7499238">(</span><span class="string" id="7499239">&#34;abcdef&#34;</span><span class="op" id="7499247">)</span>&nbsp;<span class="op" id="7499249">+</span>&nbsp;<span class="ident" id="7499251">chunk</span><span class="op" id="7499256">(</span><span class="string" id="7499257">&#34;&#34;</span><span class="op" id="7499259">)</span><span class="op" id="7499260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499263">}</span><span class="op" id="7499264">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7499268">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499323">Req</span><span class="op" id="7499326">:</span>&nbsp;<span class="ident" id="7499328">Request</span><span class="op" id="7499335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499340">Method</span><span class="op" id="7499346">:</span>&nbsp;<span class="string" id="7499348">&#34;POST&#34;</span><span class="op" id="7499354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499359">URL</span><span class="op" id="7499362">:</span>&nbsp;<span class="op" id="7499364">&amp;</span><span class="ident" id="7499365">url</span><span class="op" id="7499368">.</span><span class="ident" id="7499369">URL</span><span class="op" id="7499372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499378">Scheme</span><span class="op" id="7499384">:</span>&nbsp;<span class="string" id="7499386">&#34;http&#34;</span><span class="op" id="7499392">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499398">Host</span><span class="op" id="7499402">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7499406">&#34;www.google.com&#34;</span><span class="op" id="7499422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499428">Path</span><span class="op" id="7499432">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7499436">&#34;/search&#34;</span><span class="op" id="7499445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499450">}</span><span class="op" id="7499451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499456">ProtoMajor</span><span class="op" id="7499466">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7499471">1</span><span class="op" id="7499472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499477">ProtoMinor</span><span class="op" id="7499487">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7499492">1</span><span class="op" id="7499493">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499498">Header</span><span class="op" id="7499504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499513">Header</span><span class="op" id="7499519">{</span><span class="op" id="7499520">}</span><span class="op" id="7499521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499526">Close</span><span class="op" id="7499531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7499541">true</span><span class="op" id="7499545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499550">ContentLength</span><span class="op" id="7499563">:</span>&nbsp;<span class="num" id="7499565">6</span><span class="op" id="7499566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499570">}</span><span class="op" id="7499571">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499576">Body</span><span class="op" id="7499580">:</span>&nbsp;<span class="op" id="7499582">[</span><span class="op" id="7499583">]</span><span class="builtintype" id="7499584">byte</span><span class="op" id="7499588">(</span><span class="string" id="7499589">&#34;abcdef&#34;</span><span class="op" id="7499597">)</span><span class="op" id="7499598">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499603">WantWrite</span><span class="op" id="7499612">:</span>&nbsp;<span class="string" id="7499614">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7499642">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499647">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7499674">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499679">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7499717">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499722">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7499746">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499751">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7499775">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499780">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7499787">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499792">&#34;abcdef&#34;</span><span class="op" id="7499800">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499805">WantProxy</span><span class="op" id="7499814">:</span>&nbsp;<span class="string" id="7499816">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7499865">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499870">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7499897">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499902">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7499940">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499945">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7499969">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7499974">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7499998">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500003">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7500010">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500015">&#34;abcdef&#34;</span><span class="op" id="7500023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500026">}</span><span class="op" id="7500027">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500031">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500084">Req</span><span class="op" id="7500087">:</span>&nbsp;<span class="ident" id="7500089">Request</span><span class="op" id="7500096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500101">Method</span><span class="op" id="7500107">:</span>&nbsp;<span class="string" id="7500109">&#34;POST&#34;</span><span class="op" id="7500115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500120">URL</span><span class="op" id="7500123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500128">mustParseURL</span><span class="op" id="7500140">(</span><span class="string" id="7500141">&#34;http://example.com/&#34;</span><span class="op" id="7500162">)</span><span class="op" id="7500163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500168">Host</span><span class="op" id="7500172">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7500176">&#34;example.com&#34;</span><span class="op" id="7500189">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500194">Header</span><span class="op" id="7500200">:</span>&nbsp;<span class="ident" id="7500202">Header</span><span class="op" id="7500208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500214">&#34;Content-Length&#34;</span><span class="op" id="7500230">:</span>&nbsp;<span class="op" id="7500232">[</span><span class="op" id="7500233">]</span><span class="builtintype" id="7500234">string</span><span class="op" id="7500240">{</span><span class="string" id="7500241">&#34;10&#34;</span><span class="op" id="7500245">}</span><span class="op" id="7500246">,</span>&nbsp;<span class="comment" id="7500248">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500262">}</span><span class="op" id="7500263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500268">ContentLength</span><span class="op" id="7500281">:</span>&nbsp;<span class="num" id="7500283">6</span><span class="op" id="7500284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500288">}</span><span class="op" id="7500289">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500294">Body</span><span class="op" id="7500298">:</span>&nbsp;<span class="op" id="7500300">[</span><span class="op" id="7500301">]</span><span class="builtintype" id="7500302">byte</span><span class="op" id="7500306">(</span><span class="string" id="7500307">&#34;abcdef&#34;</span><span class="op" id="7500315">)</span><span class="op" id="7500316">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500321">WantWrite</span><span class="op" id="7500330">:</span>&nbsp;<span class="string" id="7500332">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7500354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500359">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7500383">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500388">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7500426">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500431">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7500455">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500460">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7500467">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500472">&#34;abcdef&#34;</span><span class="op" id="7500480">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500485">WantProxy</span><span class="op" id="7500494">:</span>&nbsp;<span class="string" id="7500496">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7500536">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500541">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7500565">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500570">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7500608">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500613">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7500637">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500642">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7500649">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500654">&#34;abcdef&#34;</span><span class="op" id="7500662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500665">}</span><span class="op" id="7500666">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500670">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500694">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500698">Req</span><span class="op" id="7500701">:</span>&nbsp;<span class="ident" id="7500703">Request</span><span class="op" id="7500710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500715">Method</span><span class="op" id="7500721">:</span>&nbsp;<span class="string" id="7500723">&#34;GET&#34;</span><span class="op" id="7500728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500733">URL</span><span class="op" id="7500736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500741">mustParseURL</span><span class="op" id="7500753">(</span><span class="string" id="7500754">&#34;/search&#34;</span><span class="op" id="7500763">)</span><span class="op" id="7500764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500769">Host</span><span class="op" id="7500773">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7500777">&#34;www.google.com&#34;</span><span class="op" id="7500793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500797">}</span><span class="op" id="7500798">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500803">WantWrite</span><span class="op" id="7500812">:</span>&nbsp;<span class="string" id="7500814">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7500841">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500846">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7500873">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500878">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7500916">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7500921">&#34;\r\n&#34;</span><span class="op" id="7500927">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500930">}</span><span class="op" id="7500931">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500935">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500993">Req</span><span class="op" id="7500996">:</span>&nbsp;<span class="ident" id="7500998">Request</span><span class="op" id="7501005">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501010">Method</span><span class="op" id="7501016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501025">&#34;POST&#34;</span><span class="op" id="7501031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501036">URL</span><span class="op" id="7501039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501051">mustParseURL</span><span class="op" id="7501063">(</span><span class="string" id="7501064">&#34;/&#34;</span><span class="op" id="7501067">)</span><span class="op" id="7501068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501073">Host</span><span class="op" id="7501077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501088">&#34;example.com&#34;</span><span class="op" id="7501101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501106">ProtoMajor</span><span class="op" id="7501116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7501121">1</span><span class="op" id="7501122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501127">ProtoMinor</span><span class="op" id="7501137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7501142">1</span><span class="op" id="7501143">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501148">ContentLength</span><span class="op" id="7501161">:</span>&nbsp;<span class="num" id="7501163">0</span><span class="op" id="7501164">,</span>&nbsp;<span class="comment" id="7501166">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501191">}</span><span class="op" id="7501192">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501197">Body</span><span class="op" id="7501201">:</span>&nbsp;<span class="keyword" id="7501203">func</span><span class="op" id="7501207">(</span><span class="op" id="7501208">)</span>&nbsp;<span class="ident" id="7501210">io</span><span class="op" id="7501212">.</span><span class="ident" id="7501213">ReadCloser</span>&nbsp;<span class="op" id="7501224">{</span>&nbsp;<span class="keyword" id="7501226">return</span>&nbsp;<span class="ident" id="7501233">ioutil</span><span class="op" id="7501239">.</span><span class="ident" id="7501240">NopCloser</span><span class="op" id="7501249">(</span><span class="ident" id="7501250">io</span><span class="op" id="7501252">.</span><span class="ident" id="7501253">LimitReader</span><span class="op" id="7501264">(</span><span class="ident" id="7501265">strings</span><span class="op" id="7501272">.</span><span class="ident" id="7501273">NewReader</span><span class="op" id="7501282">(</span><span class="string" id="7501283">&#34;xx&#34;</span><span class="op" id="7501287">)</span><span class="op" id="7501288">,</span>&nbsp;<span class="num" id="7501290">0</span><span class="op" id="7501291">)</span><span class="op" id="7501292">)</span>&nbsp;<span class="op" id="7501294">}</span><span class="op" id="7501295">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7501300">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7501368">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7501422">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501468">WantWrite</span><span class="op" id="7501477">:</span>&nbsp;<span class="string" id="7501479">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7501501">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501506">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7501530">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501535">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7501573">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501578">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7501602">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501607">&#34;\r\n&#34;</span><span class="op" id="7501613">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501618">WantProxy</span><span class="op" id="7501627">:</span>&nbsp;<span class="string" id="7501629">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7501651">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501656">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7501680">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501685">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7501723">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501728">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7501752">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501757">&#34;\r\n&#34;</span><span class="op" id="7501763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501766">}</span><span class="op" id="7501767">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7501771">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501829">Req</span><span class="op" id="7501832">:</span>&nbsp;<span class="ident" id="7501834">Request</span><span class="op" id="7501841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501846">Method</span><span class="op" id="7501852">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501861">&#34;POST&#34;</span><span class="op" id="7501867">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501872">URL</span><span class="op" id="7501875">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501887">mustParseURL</span><span class="op" id="7501899">(</span><span class="string" id="7501900">&#34;/&#34;</span><span class="op" id="7501903">)</span><span class="op" id="7501904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501909">Host</span><span class="op" id="7501913">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501924">&#34;example.com&#34;</span><span class="op" id="7501937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501942">ProtoMajor</span><span class="op" id="7501952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7501957">1</span><span class="op" id="7501958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501963">ProtoMinor</span><span class="op" id="7501973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7501978">1</span><span class="op" id="7501979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501984">ContentLength</span><span class="op" id="7501997">:</span>&nbsp;<span class="num" id="7501999">0</span><span class="op" id="7502000">,</span>&nbsp;<span class="comment" id="7502002">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502027">}</span><span class="op" id="7502028">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502033">Body</span><span class="op" id="7502037">:</span>&nbsp;<span class="keyword" id="7502039">func</span><span class="op" id="7502043">(</span><span class="op" id="7502044">)</span>&nbsp;<span class="ident" id="7502046">io</span><span class="op" id="7502048">.</span><span class="ident" id="7502049">ReadCloser</span>&nbsp;<span class="op" id="7502060">{</span>&nbsp;<span class="keyword" id="7502062">return</span>&nbsp;<span class="ident" id="7502069">ioutil</span><span class="op" id="7502075">.</span><span class="ident" id="7502076">NopCloser</span><span class="op" id="7502085">(</span><span class="ident" id="7502086">io</span><span class="op" id="7502088">.</span><span class="ident" id="7502089">LimitReader</span><span class="op" id="7502100">(</span><span class="ident" id="7502101">strings</span><span class="op" id="7502108">.</span><span class="ident" id="7502109">NewReader</span><span class="op" id="7502118">(</span><span class="string" id="7502119">&#34;xx&#34;</span><span class="op" id="7502123">)</span><span class="op" id="7502124">,</span>&nbsp;<span class="num" id="7502126">1</span><span class="op" id="7502127">)</span><span class="op" id="7502128">)</span>&nbsp;<span class="op" id="7502130">}</span><span class="op" id="7502131">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502136">WantWrite</span><span class="op" id="7502145">:</span>&nbsp;<span class="string" id="7502147">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7502169">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502174">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7502198">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502203">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7502241">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502246">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7502283">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502288">chunk</span><span class="op" id="7502293">(</span><span class="string" id="7502294">&#34;x&#34;</span><span class="op" id="7502297">)</span>&nbsp;<span class="op" id="7502299">+</span>&nbsp;<span class="ident" id="7502301">chunk</span><span class="op" id="7502306">(</span><span class="string" id="7502307">&#34;&#34;</span><span class="op" id="7502309">)</span><span class="op" id="7502310">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502315">WantProxy</span><span class="op" id="7502324">:</span>&nbsp;<span class="string" id="7502326">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7502348">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502353">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7502377">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502382">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7502420">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502425">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7502462">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502467">chunk</span><span class="op" id="7502472">(</span><span class="string" id="7502473">&#34;x&#34;</span><span class="op" id="7502476">)</span>&nbsp;<span class="op" id="7502478">+</span>&nbsp;<span class="ident" id="7502480">chunk</span><span class="op" id="7502485">(</span><span class="string" id="7502486">&#34;&#34;</span><span class="op" id="7502488">)</span><span class="op" id="7502489">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502492">}</span><span class="op" id="7502493">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7502497">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502559">Req</span><span class="op" id="7502562">:</span>&nbsp;<span class="ident" id="7502564">Request</span><span class="op" id="7502571">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502576">Method</span><span class="op" id="7502582">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502591">&#34;POST&#34;</span><span class="op" id="7502597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502602">URL</span><span class="op" id="7502605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502617">mustParseURL</span><span class="op" id="7502629">(</span><span class="string" id="7502630">&#34;/&#34;</span><span class="op" id="7502633">)</span><span class="op" id="7502634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502639">Host</span><span class="op" id="7502643">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502654">&#34;example.com&#34;</span><span class="op" id="7502667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502672">ProtoMajor</span><span class="op" id="7502682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7502687">1</span><span class="op" id="7502688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502693">ProtoMinor</span><span class="op" id="7502703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7502708">1</span><span class="op" id="7502709">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502714">ContentLength</span><span class="op" id="7502727">:</span>&nbsp;<span class="num" id="7502729">10</span><span class="op" id="7502731">,</span>&nbsp;<span class="comment" id="7502733">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502775">}</span><span class="op" id="7502776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502780">Body</span><span class="op" id="7502784">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502791">[</span><span class="op" id="7502792">]</span><span class="builtintype" id="7502793">byte</span><span class="op" id="7502797">(</span><span class="string" id="7502798">&#34;12345&#34;</span><span class="op" id="7502805">)</span><span class="op" id="7502806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502810">WantError</span><span class="op" id="7502819">:</span>&nbsp;<span class="ident" id="7502821">errors</span><span class="op" id="7502827">.</span><span class="ident" id="7502828">New</span><span class="op" id="7502831">(</span><span class="string" id="7502832">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7502875">)</span><span class="op" id="7502876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502879">}</span><span class="op" id="7502880">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7502884">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7502942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502946">Req</span><span class="op" id="7502949">:</span>&nbsp;<span class="ident" id="7502951">Request</span><span class="op" id="7502958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502963">Method</span><span class="op" id="7502969">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502978">&#34;POST&#34;</span><span class="op" id="7502984">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7502989">URL</span><span class="op" id="7502992">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503004">mustParseURL</span><span class="op" id="7503016">(</span><span class="string" id="7503017">&#34;/&#34;</span><span class="op" id="7503020">)</span><span class="op" id="7503021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503026">Host</span><span class="op" id="7503030">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503041">&#34;example.com&#34;</span><span class="op" id="7503054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503059">ProtoMajor</span><span class="op" id="7503069">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503074">1</span><span class="op" id="7503075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503080">ProtoMinor</span><span class="op" id="7503090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503095">1</span><span class="op" id="7503096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503101">ContentLength</span><span class="op" id="7503114">:</span>&nbsp;<span class="num" id="7503116">4</span><span class="op" id="7503117">,</span>&nbsp;<span class="comment" id="7503119">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503163">}</span><span class="op" id="7503164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503168">Body</span><span class="op" id="7503172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503179">[</span><span class="op" id="7503180">]</span><span class="builtintype" id="7503181">byte</span><span class="op" id="7503185">(</span><span class="string" id="7503186">&#34;12345678&#34;</span><span class="op" id="7503196">)</span><span class="op" id="7503197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503201">WantError</span><span class="op" id="7503210">:</span>&nbsp;<span class="ident" id="7503212">errors</span><span class="op" id="7503218">.</span><span class="ident" id="7503219">New</span><span class="op" id="7503222">(</span><span class="string" id="7503223">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7503265">)</span><span class="op" id="7503266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503269">}</span><span class="op" id="7503270">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7503274">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503327">Req</span><span class="op" id="7503330">:</span>&nbsp;<span class="ident" id="7503332">Request</span><span class="op" id="7503339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503344">Method</span><span class="op" id="7503350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503359">&#34;POST&#34;</span><span class="op" id="7503365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503370">URL</span><span class="op" id="7503373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503385">mustParseURL</span><span class="op" id="7503397">(</span><span class="string" id="7503398">&#34;/&#34;</span><span class="op" id="7503401">)</span><span class="op" id="7503402">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503407">Host</span><span class="op" id="7503411">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503422">&#34;example.com&#34;</span><span class="op" id="7503435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503440">ProtoMajor</span><span class="op" id="7503450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503455">1</span><span class="op" id="7503456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503461">ProtoMinor</span><span class="op" id="7503471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503476">1</span><span class="op" id="7503477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503482">ContentLength</span><span class="op" id="7503495">:</span>&nbsp;<span class="num" id="7503497">5</span><span class="op" id="7503498">,</span>&nbsp;<span class="comment" id="7503500">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503529">}</span><span class="op" id="7503530">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503534">WantError</span><span class="op" id="7503543">:</span>&nbsp;<span class="ident" id="7503545">errors</span><span class="op" id="7503551">.</span><span class="ident" id="7503552">New</span><span class="op" id="7503555">(</span><span class="string" id="7503556">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7503601">)</span><span class="op" id="7503602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503605">}</span><span class="op" id="7503606">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7503610">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503690">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503694">Req</span><span class="op" id="7503697">:</span>&nbsp;<span class="ident" id="7503699">Request</span><span class="op" id="7503706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503711">Method</span><span class="op" id="7503717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503726">&#34;POST&#34;</span><span class="op" id="7503732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503737">URL</span><span class="op" id="7503740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503752">mustParseURL</span><span class="op" id="7503764">(</span><span class="string" id="7503765">&#34;/&#34;</span><span class="op" id="7503768">)</span><span class="op" id="7503769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503774">Host</span><span class="op" id="7503778">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503789">&#34;example.com&#34;</span><span class="op" id="7503802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503807">ProtoMajor</span><span class="op" id="7503817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503822">1</span><span class="op" id="7503823">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503828">ProtoMinor</span><span class="op" id="7503838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7503843">1</span><span class="op" id="7503844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503849">ContentLength</span><span class="op" id="7503862">:</span>&nbsp;<span class="num" id="7503864">0</span><span class="op" id="7503865">,</span>&nbsp;<span class="comment" id="7503867">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7503892">}</span><span class="op" id="7503893">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503898">Body</span><span class="op" id="7503902">:</span>&nbsp;<span class="keyword" id="7503904">func</span><span class="op" id="7503908">(</span><span class="op" id="7503909">)</span>&nbsp;<span class="ident" id="7503911">io</span><span class="op" id="7503913">.</span><span class="ident" id="7503914">ReadCloser</span>&nbsp;<span class="op" id="7503925">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503930">err</span>&nbsp;<span class="op" id="7503934">:=</span>&nbsp;<span class="ident" id="7503937">errors</span><span class="op" id="7503943">.</span><span class="ident" id="7503944">New</span><span class="op" id="7503947">(</span><span class="string" id="7503948">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7503969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7503974">errReader</span>&nbsp;<span class="op" id="7503984">:=</span>&nbsp;<span class="op" id="7503987">&amp;</span><span class="ident" id="7503988">errorReader</span><span class="op" id="7503999">{</span><span class="ident" id="7504000">err</span><span class="op" id="7504003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504008">return</span>&nbsp;<span class="ident" id="7504015">ioutil</span><span class="op" id="7504021">.</span><span class="ident" id="7504022">NopCloser</span><span class="op" id="7504031">(</span><span class="ident" id="7504032">io</span><span class="op" id="7504034">.</span><span class="ident" id="7504035">MultiReader</span><span class="op" id="7504046">(</span><span class="ident" id="7504047">strings</span><span class="op" id="7504054">.</span><span class="ident" id="7504055">NewReader</span><span class="op" id="7504064">(</span><span class="string" id="7504065">&#34;x&#34;</span><span class="op" id="7504068">)</span><span class="op" id="7504069">,</span>&nbsp;<span class="ident" id="7504071">errReader</span><span class="op" id="7504080">)</span><span class="op" id="7504081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504085">}</span><span class="op" id="7504086">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504091">WantError</span><span class="op" id="7504100">:</span>&nbsp;<span class="ident" id="7504102">errors</span><span class="op" id="7504108">.</span><span class="ident" id="7504109">New</span><span class="op" id="7504112">(</span><span class="string" id="7504113">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7504134">)</span><span class="op" id="7504135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504138">}</span><span class="op" id="7504139">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7504143">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504219">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504223">Req</span><span class="op" id="7504226">:</span>&nbsp;<span class="ident" id="7504228">Request</span><span class="op" id="7504235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504240">Method</span><span class="op" id="7504246">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504255">&#34;POST&#34;</span><span class="op" id="7504261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504266">URL</span><span class="op" id="7504269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504281">mustParseURL</span><span class="op" id="7504293">(</span><span class="string" id="7504294">&#34;/&#34;</span><span class="op" id="7504297">)</span><span class="op" id="7504298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504303">Host</span><span class="op" id="7504307">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504318">&#34;example.com&#34;</span><span class="op" id="7504331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504336">ProtoMajor</span><span class="op" id="7504346">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7504351">1</span><span class="op" id="7504352">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504357">ProtoMinor</span><span class="op" id="7504367">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7504372">1</span><span class="op" id="7504373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504378">ContentLength</span><span class="op" id="7504391">:</span>&nbsp;<span class="num" id="7504393">0</span><span class="op" id="7504394">,</span>&nbsp;<span class="comment" id="7504396">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504421">}</span><span class="op" id="7504422">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504427">Body</span><span class="op" id="7504431">:</span>&nbsp;<span class="keyword" id="7504433">func</span><span class="op" id="7504437">(</span><span class="op" id="7504438">)</span>&nbsp;<span class="ident" id="7504440">io</span><span class="op" id="7504442">.</span><span class="ident" id="7504443">ReadCloser</span>&nbsp;<span class="op" id="7504454">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504459">err</span>&nbsp;<span class="op" id="7504463">:=</span>&nbsp;<span class="ident" id="7504466">errors</span><span class="op" id="7504472">.</span><span class="ident" id="7504473">New</span><span class="op" id="7504476">(</span><span class="string" id="7504477">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7504498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504503">errReader</span>&nbsp;<span class="op" id="7504513">:=</span>&nbsp;<span class="op" id="7504516">&amp;</span><span class="ident" id="7504517">errorReader</span><span class="op" id="7504528">{</span><span class="ident" id="7504529">err</span><span class="op" id="7504532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504537">return</span>&nbsp;<span class="ident" id="7504544">ioutil</span><span class="op" id="7504550">.</span><span class="ident" id="7504551">NopCloser</span><span class="op" id="7504560">(</span><span class="ident" id="7504561">errReader</span><span class="op" id="7504570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504574">}</span><span class="op" id="7504575">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504580">WantError</span><span class="op" id="7504589">:</span>&nbsp;<span class="ident" id="7504591">errors</span><span class="op" id="7504597">.</span><span class="ident" id="7504598">New</span><span class="op" id="7504601">(</span><span class="string" id="7504602">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7504623">)</span><span class="op" id="7504624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504627">}</span><span class="op" id="7504628">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7504632">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7504715">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504753">Req</span><span class="op" id="7504756">:</span>&nbsp;<span class="ident" id="7504758">Request</span><span class="op" id="7504765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504770">Method</span><span class="op" id="7504776">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504782">&#34;GET&#34;</span><span class="op" id="7504787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504792">URL</span><span class="op" id="7504795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504804">mustParseURL</span><span class="op" id="7504816">(</span><span class="string" id="7504817">&#34;/foo&#34;</span><span class="op" id="7504823">)</span><span class="op" id="7504824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504829">ProtoMajor</span><span class="op" id="7504839">:</span>&nbsp;<span class="num" id="7504841">1</span><span class="op" id="7504842">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504847">ProtoMinor</span><span class="op" id="7504857">:</span>&nbsp;<span class="num" id="7504859">0</span><span class="op" id="7504860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504865">Header</span><span class="op" id="7504871">:</span>&nbsp;<span class="ident" id="7504873">Header</span><span class="op" id="7504879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504885">&#34;X-Foo&#34;</span><span class="op" id="7504892">:</span>&nbsp;<span class="op" id="7504894">[</span><span class="op" id="7504895">]</span><span class="builtintype" id="7504896">string</span><span class="op" id="7504902">{</span><span class="string" id="7504903">&#34;X-Bar&#34;</span><span class="op" id="7504910">}</span><span class="op" id="7504911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504916">}</span><span class="op" id="7504917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504921">}</span><span class="op" id="7504922">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504927">WantWrite</span><span class="op" id="7504936">:</span>&nbsp;<span class="string" id="7504938">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7504962">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504967">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7504980">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504985">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7505023">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505028">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7505050">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505053">}</span><span class="op" id="7505054">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505058">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505114">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505154">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505208">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505249">Req</span><span class="op" id="7505252">:</span>&nbsp;<span class="ident" id="7505254">Request</span><span class="op" id="7505261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505266">Method</span><span class="op" id="7505272">:</span>&nbsp;<span class="string" id="7505274">&#34;GET&#34;</span><span class="op" id="7505279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505284">Host</span><span class="op" id="7505288">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7505292">&#34;&#34;</span><span class="op" id="7505294">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505299">URL</span><span class="op" id="7505302">:</span>&nbsp;<span class="op" id="7505304">&amp;</span><span class="ident" id="7505305">url</span><span class="op" id="7505308">.</span><span class="ident" id="7505309">URL</span><span class="op" id="7505312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505318">Scheme</span><span class="op" id="7505324">:</span>&nbsp;<span class="string" id="7505326">&#34;http&#34;</span><span class="op" id="7505332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505338">Host</span><span class="op" id="7505342">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7505346">&#34;&#34;</span><span class="op" id="7505348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505354">Path</span><span class="op" id="7505358">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7505362">&#34;/search&#34;</span><span class="op" id="7505371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505376">}</span><span class="op" id="7505377">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505382">ProtoMajor</span><span class="op" id="7505392">:</span>&nbsp;<span class="num" id="7505394">1</span><span class="op" id="7505395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505400">ProtoMinor</span><span class="op" id="7505410">:</span>&nbsp;<span class="num" id="7505412">1</span><span class="op" id="7505413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505418">Header</span><span class="op" id="7505424">:</span>&nbsp;<span class="ident" id="7505426">Header</span><span class="op" id="7505432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505438">&#34;Host&#34;</span><span class="op" id="7505444">:</span>&nbsp;<span class="op" id="7505446">[</span><span class="op" id="7505447">]</span><span class="builtintype" id="7505448">string</span><span class="op" id="7505454">{</span><span class="string" id="7505455">&#34;bad.example.com&#34;</span><span class="op" id="7505472">}</span><span class="op" id="7505473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505478">}</span><span class="op" id="7505479">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505483">}</span><span class="op" id="7505484">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505489">WantWrite</span><span class="op" id="7505498">:</span>&nbsp;<span class="string" id="7505500">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7505527">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505532">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7505545">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505550">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7505591">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505594">}</span><span class="op" id="7505595">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505599">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505649">Req</span><span class="op" id="7505652">:</span>&nbsp;<span class="ident" id="7505654">Request</span><span class="op" id="7505661">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505666">Method</span><span class="op" id="7505672">:</span>&nbsp;<span class="string" id="7505674">&#34;GET&#34;</span><span class="op" id="7505679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505684">URL</span><span class="op" id="7505687">:</span>&nbsp;<span class="op" id="7505689">&amp;</span><span class="ident" id="7505690">url</span><span class="op" id="7505693">.</span><span class="ident" id="7505694">URL</span><span class="op" id="7505697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505703">Scheme</span><span class="op" id="7505709">:</span>&nbsp;<span class="string" id="7505711">&#34;http&#34;</span><span class="op" id="7505717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505723">Host</span><span class="op" id="7505727">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7505731">&#34;www.google.com&#34;</span><span class="op" id="7505747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505753">Opaque</span><span class="op" id="7505759">:</span>&nbsp;<span class="string" id="7505761">&#34;/%2F/%2F/&#34;</span><span class="op" id="7505772">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505777">}</span><span class="op" id="7505778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505783">ProtoMajor</span><span class="op" id="7505793">:</span>&nbsp;<span class="num" id="7505795">1</span><span class="op" id="7505796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505801">ProtoMinor</span><span class="op" id="7505811">:</span>&nbsp;<span class="num" id="7505813">1</span><span class="op" id="7505814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505819">Header</span><span class="op" id="7505825">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505831">Header</span><span class="op" id="7505837">{</span><span class="op" id="7505838">}</span><span class="op" id="7505839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505843">}</span><span class="op" id="7505844">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505849">WantWrite</span><span class="op" id="7505858">:</span>&nbsp;<span class="string" id="7505860">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7505889">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505894">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7505921">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505926">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7505967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505970">}</span><span class="op" id="7505971">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505975">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506025">Req</span><span class="op" id="7506028">:</span>&nbsp;<span class="ident" id="7506030">Request</span><span class="op" id="7506037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506042">Method</span><span class="op" id="7506048">:</span>&nbsp;<span class="string" id="7506050">&#34;GET&#34;</span><span class="op" id="7506055">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506060">URL</span><span class="op" id="7506063">:</span>&nbsp;<span class="op" id="7506065">&amp;</span><span class="ident" id="7506066">url</span><span class="op" id="7506069">.</span><span class="ident" id="7506070">URL</span><span class="op" id="7506073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506079">Scheme</span><span class="op" id="7506085">:</span>&nbsp;<span class="string" id="7506087">&#34;http&#34;</span><span class="op" id="7506093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506099">Host</span><span class="op" id="7506103">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7506107">&#34;x.google.com&#34;</span><span class="op" id="7506121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506127">Opaque</span><span class="op" id="7506133">:</span>&nbsp;<span class="string" id="7506135">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7506160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506165">}</span><span class="op" id="7506166">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506171">ProtoMajor</span><span class="op" id="7506181">:</span>&nbsp;<span class="num" id="7506183">1</span><span class="op" id="7506184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506189">ProtoMinor</span><span class="op" id="7506199">:</span>&nbsp;<span class="num" id="7506201">1</span><span class="op" id="7506202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506207">Header</span><span class="op" id="7506213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506219">Header</span><span class="op" id="7506225">{</span><span class="op" id="7506226">}</span><span class="op" id="7506227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506231">}</span><span class="op" id="7506232">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506237">WantWrite</span><span class="op" id="7506246">:</span>&nbsp;<span class="string" id="7506248">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7506296">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506301">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7506326">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506331">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7506372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506375">}</span><span class="op" id="7506376">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7506380">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506436">Req</span><span class="op" id="7506439">:</span>&nbsp;<span class="ident" id="7506441">Request</span><span class="op" id="7506448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506453">Method</span><span class="op" id="7506459">:</span>&nbsp;<span class="string" id="7506461">&#34;GET&#34;</span><span class="op" id="7506466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506471">URL</span><span class="op" id="7506474">:</span>&nbsp;<span class="op" id="7506476">&amp;</span><span class="ident" id="7506477">url</span><span class="op" id="7506480">.</span><span class="ident" id="7506481">URL</span><span class="op" id="7506484">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506490">Scheme</span><span class="op" id="7506496">:</span>&nbsp;<span class="string" id="7506498">&#34;http&#34;</span><span class="op" id="7506504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506510">Host</span><span class="op" id="7506514">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7506518">&#34;www.google.com&#34;</span><span class="op" id="7506534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506540">Path</span><span class="op" id="7506544">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7506548">&#34;/&#34;</span><span class="op" id="7506551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506556">}</span><span class="op" id="7506557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506562">Proto</span><span class="op" id="7506567">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506574">&#34;HTTP/1.1&#34;</span><span class="op" id="7506584">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506589">ProtoMajor</span><span class="op" id="7506599">:</span>&nbsp;<span class="num" id="7506601">1</span><span class="op" id="7506602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506607">ProtoMinor</span><span class="op" id="7506617">:</span>&nbsp;<span class="num" id="7506619">1</span><span class="op" id="7506620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506625">Header</span><span class="op" id="7506631">:</span>&nbsp;<span class="ident" id="7506633">Header</span><span class="op" id="7506639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506645">&#34;ALL-CAPS&#34;</span><span class="op" id="7506655">:</span>&nbsp;<span class="op" id="7506657">{</span><span class="string" id="7506658">&#34;x&#34;</span><span class="op" id="7506661">}</span><span class="op" id="7506662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506667">}</span><span class="op" id="7506668">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506672">}</span><span class="op" id="7506673">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506678">WantWrite</span><span class="op" id="7506687">:</span>&nbsp;<span class="string" id="7506689">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7506710">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506715">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7506742">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506747">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7506785">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506790">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7506808">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7506813">&#34;\r\n&#34;</span><span class="op" id="7506819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506822">}</span><span class="op" id="7506823">,</span><br>
<span class="lineno"></span><span class="op" id="7506825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7506828">func</span>&nbsp;<span class="ident" id="7506833">TestRequestWrite</span><span class="op" id="7506849">(</span><span class="ident" id="7506850">t</span>&nbsp;<span class="op" id="7506852">*</span><span class="ident" id="7506853">testing</span><span class="op" id="7506860">.</span><span class="ident" id="7506861">T</span><span class="op" id="7506862">)</span>&nbsp;<span class="op" id="7506864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7506867">for</span>&nbsp;<span class="ident" id="7506871">i</span>&nbsp;<span class="op" id="7506873">:=</span>&nbsp;<span class="keyword" id="7506876">range</span>&nbsp;<span class="ident" id="7506882">reqWriteTests</span>&nbsp;<span class="op" id="7506896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506900">tt</span>&nbsp;<span class="op" id="7506903">:=</span>&nbsp;<span class="op" id="7506906">&amp;</span><span class="ident" id="7506907">reqWriteTests</span><span class="op" id="7506920">[</span><span class="ident" id="7506921">i</span><span class="op" id="7506922">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506927">setBody</span>&nbsp;<span class="op" id="7506935">:=</span>&nbsp;<span class="keyword" id="7506938">func</span><span class="op" id="7506942">(</span><span class="op" id="7506943">)</span>&nbsp;<span class="op" id="7506945">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7506950">if</span>&nbsp;<span class="ident" id="7506953">tt</span><span class="op" id="7506955">.</span><span class="ident" id="7506956">Body</span>&nbsp;<span class="op" id="7506961">==</span>&nbsp;<span class="builtintype" id="7506964">nil</span>&nbsp;<span class="op" id="7506968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7506974">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7506989">switch</span>&nbsp;<span class="ident" id="7506996">b</span>&nbsp;<span class="op" id="7506998">:=</span>&nbsp;<span class="ident" id="7507001">tt</span><span class="op" id="7507003">.</span><span class="ident" id="7507004">Body</span><span class="op" id="7507008">.</span><span class="op" id="7507009">(</span><span class="keyword" id="7507010">type</span><span class="op" id="7507014">)</span>&nbsp;<span class="op" id="7507016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507021">case</span>&nbsp;<span class="op" id="7507026">[</span><span class="op" id="7507027">]</span><span class="builtintype" id="7507028">byte</span><span class="op" id="7507032">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507038">tt</span><span class="op" id="7507040">.</span><span class="ident" id="7507041">Req</span><span class="op" id="7507044">.</span><span class="ident" id="7507045">Body</span>&nbsp;<span class="op" id="7507050">=</span>&nbsp;<span class="ident" id="7507052">ioutil</span><span class="op" id="7507058">.</span><span class="ident" id="7507059">NopCloser</span><span class="op" id="7507068">(</span><span class="ident" id="7507069">bytes</span><span class="op" id="7507074">.</span><span class="ident" id="7507075">NewReader</span><span class="op" id="7507084">(</span><span class="ident" id="7507085">b</span><span class="op" id="7507086">)</span><span class="op" id="7507087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507092">case</span>&nbsp;<span class="keyword" id="7507097">func</span><span class="op" id="7507101">(</span><span class="op" id="7507102">)</span>&nbsp;<span class="ident" id="7507104">io</span><span class="op" id="7507106">.</span><span class="ident" id="7507107">ReadCloser</span><span class="op" id="7507117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507123">tt</span><span class="op" id="7507125">.</span><span class="ident" id="7507126">Req</span><span class="op" id="7507129">.</span><span class="ident" id="7507130">Body</span>&nbsp;<span class="op" id="7507135">=</span>&nbsp;<span class="ident" id="7507137">b</span><span class="op" id="7507138">(</span><span class="op" id="7507139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507148">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507152">setBody</span><span class="op" id="7507159">(</span><span class="op" id="7507160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507164">if</span>&nbsp;<span class="ident" id="7507167">tt</span><span class="op" id="7507169">.</span><span class="ident" id="7507170">Req</span><span class="op" id="7507173">.</span><span class="ident" id="7507174">Header</span>&nbsp;<span class="op" id="7507181">==</span>&nbsp;<span class="builtintype" id="7507184">nil</span>&nbsp;<span class="op" id="7507188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507193">tt</span><span class="op" id="7507195">.</span><span class="ident" id="7507196">Req</span><span class="op" id="7507199">.</span><span class="ident" id="7507200">Header</span>&nbsp;<span class="op" id="7507207">=</span>&nbsp;<span class="builtinfunc" id="7507209">make</span><span class="op" id="7507213">(</span><span class="ident" id="7507214">Header</span><span class="op" id="7507220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507229">var</span>&nbsp;<span class="ident" id="7507233">braw</span>&nbsp;<span class="ident" id="7507238">bytes</span><span class="op" id="7507243">.</span><span class="ident" id="7507244">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507253">err</span>&nbsp;<span class="op" id="7507257">:=</span>&nbsp;<span class="ident" id="7507260">tt</span><span class="op" id="7507262">.</span><span class="ident" id="7507263">Req</span><span class="op" id="7507266">.</span><span class="ident" id="7507267">Write</span><span class="op" id="7507272">(</span><span class="op" id="7507273">&amp;</span><span class="ident" id="7507274">braw</span><span class="op" id="7507278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507282">if</span>&nbsp;<span class="ident" id="7507285">g</span><span class="op" id="7507286">,</span>&nbsp;<span class="ident" id="7507288">e</span>&nbsp;<span class="op" id="7507290">:=</span>&nbsp;<span class="ident" id="7507293">fmt</span><span class="op" id="7507296">.</span><span class="ident" id="7507297">Sprintf</span><span class="op" id="7507304">(</span><span class="string" id="7507305">&#34;%v&#34;</span><span class="op" id="7507309">,</span>&nbsp;<span class="ident" id="7507311">err</span><span class="op" id="7507314">)</span><span class="op" id="7507315">,</span>&nbsp;<span class="ident" id="7507317">fmt</span><span class="op" id="7507320">.</span><span class="ident" id="7507321">Sprintf</span><span class="op" id="7507328">(</span><span class="string" id="7507329">&#34;%v&#34;</span><span class="op" id="7507333">,</span>&nbsp;<span class="ident" id="7507335">tt</span><span class="op" id="7507337">.</span><span class="ident" id="7507338">WantError</span><span class="op" id="7507347">)</span><span class="op" id="7507348">;</span>&nbsp;<span class="ident" id="7507350">g</span>&nbsp;<span class="op" id="7507352">!=</span>&nbsp;<span class="ident" id="7507355">e</span>&nbsp;<span class="op" id="7507357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507362">t</span><span class="op" id="7507363">.</span><span class="ident" id="7507364">Errorf</span><span class="op" id="7507370">(</span><span class="string" id="7507371">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7507403">,</span>&nbsp;<span class="ident" id="7507405">i</span><span class="op" id="7507406">,</span>&nbsp;<span class="ident" id="7507408">g</span><span class="op" id="7507409">,</span>&nbsp;<span class="ident" id="7507411">e</span><span class="op" id="7507412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507417">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507432">if</span>&nbsp;<span class="ident" id="7507435">err</span>&nbsp;<span class="op" id="7507439">!=</span>&nbsp;<span class="builtintype" id="7507442">nil</span>&nbsp;<span class="op" id="7507446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507451">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507467">if</span>&nbsp;<span class="ident" id="7507470">tt</span><span class="op" id="7507472">.</span><span class="ident" id="7507473">WantWrite</span>&nbsp;<span class="op" id="7507483">!=</span>&nbsp;<span class="string" id="7507486">&#34;&#34;</span>&nbsp;<span class="op" id="7507489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507494">sraw</span>&nbsp;<span class="op" id="7507499">:=</span>&nbsp;<span class="ident" id="7507502">braw</span><span class="op" id="7507506">.</span><span class="ident" id="7507507">String</span><span class="op" id="7507513">(</span><span class="op" id="7507514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507519">if</span>&nbsp;<span class="ident" id="7507522">sraw</span>&nbsp;<span class="op" id="7507527">!=</span>&nbsp;<span class="ident" id="7507530">tt</span><span class="op" id="7507532">.</span><span class="ident" id="7507533">WantWrite</span>&nbsp;<span class="op" id="7507543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507549">t</span><span class="op" id="7507550">.</span><span class="ident" id="7507551">Errorf</span><span class="op" id="7507557">(</span><span class="string" id="7507558">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7507595">,</span>&nbsp;<span class="ident" id="7507597">i</span><span class="op" id="7507598">,</span>&nbsp;<span class="ident" id="7507600">tt</span><span class="op" id="7507602">.</span><span class="ident" id="7507603">WantWrite</span><span class="op" id="7507612">,</span>&nbsp;<span class="ident" id="7507614">sraw</span><span class="op" id="7507618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507624">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507645">if</span>&nbsp;<span class="ident" id="7507648">tt</span><span class="op" id="7507650">.</span><span class="ident" id="7507651">WantProxy</span>&nbsp;<span class="op" id="7507661">!=</span>&nbsp;<span class="string" id="7507664">&#34;&#34;</span>&nbsp;<span class="op" id="7507667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507672">setBody</span><span class="op" id="7507679">(</span><span class="op" id="7507680">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507685">var</span>&nbsp;<span class="ident" id="7507689">praw</span>&nbsp;<span class="ident" id="7507694">bytes</span><span class="op" id="7507699">.</span><span class="ident" id="7507700">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507710">err</span>&nbsp;<span class="op" id="7507714">=</span>&nbsp;<span class="ident" id="7507716">tt</span><span class="op" id="7507718">.</span><span class="ident" id="7507719">Req</span><span class="op" id="7507722">.</span><span class="ident" id="7507723">WriteProxy</span><span class="op" id="7507733">(</span><span class="op" id="7507734">&amp;</span><span class="ident" id="7507735">praw</span><span class="op" id="7507739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507744">if</span>&nbsp;<span class="ident" id="7507747">err</span>&nbsp;<span class="op" id="7507751">!=</span>&nbsp;<span class="builtintype" id="7507754">nil</span>&nbsp;<span class="op" id="7507758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507764">t</span><span class="op" id="7507765">.</span><span class="ident" id="7507766">Errorf</span><span class="op" id="7507772">(</span><span class="string" id="7507773">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7507793">,</span>&nbsp;<span class="ident" id="7507795">i</span><span class="op" id="7507796">,</span>&nbsp;<span class="ident" id="7507798">err</span><span class="op" id="7507801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507807">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507824">sraw</span>&nbsp;<span class="op" id="7507829">:=</span>&nbsp;<span class="ident" id="7507832">praw</span><span class="op" id="7507836">.</span><span class="ident" id="7507837">String</span><span class="op" id="7507843">(</span><span class="op" id="7507844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507849">if</span>&nbsp;<span class="ident" id="7507852">sraw</span>&nbsp;<span class="op" id="7507857">!=</span>&nbsp;<span class="ident" id="7507860">tt</span><span class="op" id="7507862">.</span><span class="ident" id="7507863">WantProxy</span>&nbsp;<span class="op" id="7507873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507879">t</span><span class="op" id="7507880">.</span><span class="ident" id="7507881">Errorf</span><span class="op" id="7507887">(</span><span class="string" id="7507888">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7507931">,</span>&nbsp;<span class="ident" id="7507933">i</span><span class="op" id="7507934">,</span>&nbsp;<span class="ident" id="7507936">tt</span><span class="op" id="7507938">.</span><span class="ident" id="7507939">WantProxy</span><span class="op" id="7507948">,</span>&nbsp;<span class="ident" id="7507950">sraw</span><span class="op" id="7507954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507960">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507979">}</span><br>
<span class="lineno"></span><span class="op" id="7507981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7507984">type</span>&nbsp;<span class="ident" id="7507989">closeChecker</span>&nbsp;<span class="keyword" id="7508002">struct</span>&nbsp;<span class="op" id="7508009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508012">io</span><span class="op" id="7508014">.</span><span class="ident" id="7508015">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508023">closed</span>&nbsp;<span class="builtintype" id="7508030">bool</span><br>
<span class="lineno"></span><span class="op" id="7508035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7508038">func</span>&nbsp;<span class="op" id="7508043">(</span><span class="ident" id="7508044">rc</span>&nbsp;<span class="op" id="7508047">*</span><span class="ident" id="7508048">closeChecker</span><span class="op" id="7508060">)</span>&nbsp;<span class="ident" id="7508062">Close</span><span class="op" id="7508067">(</span><span class="op" id="7508068">)</span>&nbsp;<span class="builtintype" id="7508070">error</span>&nbsp;<span class="op" id="7508076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508079">rc</span><span class="op" id="7508081">.</span><span class="ident" id="7508082">closed</span>&nbsp;<span class="op" id="7508089">=</span>&nbsp;<span class="builtintype" id="7508091">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508097">return</span>&nbsp;<span class="builtintype" id="7508104">nil</span><br>
<span class="lineno"></span><span class="op" id="7508108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7508111">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7508195">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7508278">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7508338">func</span>&nbsp;<span class="ident" id="7508343">TestRequestWriteClosesBody</span><span class="op" id="7508369">(</span><span class="ident" id="7508370">t</span>&nbsp;<span class="op" id="7508372">*</span><span class="ident" id="7508373">testing</span><span class="op" id="7508380">.</span><span class="ident" id="7508381">T</span><span class="op" id="7508382">)</span>&nbsp;<span class="op" id="7508384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508387">rc</span>&nbsp;<span class="op" id="7508390">:=</span>&nbsp;<span class="op" id="7508393">&amp;</span><span class="ident" id="7508394">closeChecker</span><span class="op" id="7508406">{</span><span class="ident" id="7508407">Reader</span><span class="op" id="7508413">:</span>&nbsp;<span class="ident" id="7508415">strings</span><span class="op" id="7508422">.</span><span class="ident" id="7508423">NewReader</span><span class="op" id="7508432">(</span><span class="string" id="7508433">&#34;my&nbsp;body&#34;</span><span class="op" id="7508442">)</span><span class="op" id="7508443">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508446">req</span><span class="op" id="7508449">,</span>&nbsp;<span class="ident" id="7508451">_</span>&nbsp;<span class="op" id="7508453">:=</span>&nbsp;<span class="ident" id="7508456">NewRequest</span><span class="op" id="7508466">(</span><span class="string" id="7508467">&#34;POST&#34;</span><span class="op" id="7508473">,</span>&nbsp;<span class="string" id="7508475">&#34;http://foo.com/&#34;</span><span class="op" id="7508492">,</span>&nbsp;<span class="ident" id="7508494">rc</span><span class="op" id="7508496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508499">if</span>&nbsp;<span class="ident" id="7508502">req</span><span class="op" id="7508505">.</span><span class="ident" id="7508506">ContentLength</span>&nbsp;<span class="op" id="7508520">!=</span>&nbsp;<span class="num" id="7508523">0</span>&nbsp;<span class="op" id="7508525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508529">t</span><span class="op" id="7508530">.</span><span class="ident" id="7508531">Errorf</span><span class="op" id="7508537">(</span><span class="string" id="7508538">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7508572">,</span>&nbsp;<span class="ident" id="7508574">req</span><span class="op" id="7508577">.</span><span class="ident" id="7508578">ContentLength</span><span class="op" id="7508591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508597">buf</span>&nbsp;<span class="op" id="7508601">:=</span>&nbsp;<span class="builtinfunc" id="7508604">new</span><span class="op" id="7508607">(</span><span class="ident" id="7508608">bytes</span><span class="op" id="7508613">.</span><span class="ident" id="7508614">Buffer</span><span class="op" id="7508620">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508623">req</span><span class="op" id="7508626">.</span><span class="ident" id="7508627">Write</span><span class="op" id="7508632">(</span><span class="ident" id="7508633">buf</span><span class="op" id="7508636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508639">if</span>&nbsp;<span class="op" id="7508642">!</span><span class="ident" id="7508643">rc</span><span class="op" id="7508645">.</span><span class="ident" id="7508646">closed</span>&nbsp;<span class="op" id="7508653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508657">t</span><span class="op" id="7508658">.</span><span class="ident" id="7508659">Error</span><span class="op" id="7508664">(</span><span class="string" id="7508665">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7508694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508700">expected</span>&nbsp;<span class="op" id="7508709">:=</span>&nbsp;<span class="string" id="7508712">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7508734">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7508738">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7508758">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7508762">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7508800">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7508804">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7508841">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7508845">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7508911">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7508981">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7509052">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509109">chunk</span><span class="op" id="7509114">(</span><span class="string" id="7509115">&#34;m&#34;</span><span class="op" id="7509118">)</span>&nbsp;<span class="op" id="7509120">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509124">chunk</span><span class="op" id="7509129">(</span><span class="string" id="7509130">&#34;y&nbsp;body&#34;</span><span class="op" id="7509138">)</span>&nbsp;<span class="op" id="7509140">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509144">chunk</span><span class="op" id="7509149">(</span><span class="string" id="7509150">&#34;&#34;</span><span class="op" id="7509152">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509155">if</span>&nbsp;<span class="ident" id="7509158">buf</span><span class="op" id="7509161">.</span><span class="ident" id="7509162">String</span><span class="op" id="7509168">(</span><span class="op" id="7509169">)</span>&nbsp;<span class="op" id="7509171">!=</span>&nbsp;<span class="ident" id="7509174">expected</span>&nbsp;<span class="op" id="7509183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509187">t</span><span class="op" id="7509188">.</span><span class="ident" id="7509189">Errorf</span><span class="op" id="7509195">(</span><span class="string" id="7509196">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7509224">,</span>&nbsp;<span class="ident" id="7509226">buf</span><span class="op" id="7509229">.</span><span class="ident" id="7509230">String</span><span class="op" id="7509236">(</span><span class="op" id="7509237">)</span><span class="op" id="7509238">,</span>&nbsp;<span class="ident" id="7509240">expected</span><span class="op" id="7509248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509251">}</span><br>
<span class="lineno"></span><span class="op" id="7509253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7509256">func</span>&nbsp;<span class="ident" id="7509261">chunk</span><span class="op" id="7509266">(</span><span class="ident" id="7509267">s</span>&nbsp;<span class="builtintype" id="7509269">string</span><span class="op" id="7509275">)</span>&nbsp;<span class="builtintype" id="7509277">string</span>&nbsp;<span class="op" id="7509284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509287">return</span>&nbsp;<span class="ident" id="7509294">fmt</span><span class="op" id="7509297">.</span><span class="ident" id="7509298">Sprintf</span><span class="op" id="7509305">(</span><span class="string" id="7509306">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7509320">,</span>&nbsp;<span class="builtinfunc" id="7509322">len</span><span class="op" id="7509325">(</span><span class="ident" id="7509326">s</span><span class="op" id="7509327">)</span><span class="op" id="7509328">,</span>&nbsp;<span class="ident" id="7509330">s</span><span class="op" id="7509331">)</span><br>
<span class="lineno"></span><span class="op" id="7509333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509336">func</span>&nbsp;<span class="ident" id="7509341">mustParseURL</span><span class="op" id="7509353">(</span><span class="ident" id="7509354">s</span>&nbsp;<span class="builtintype" id="7509356">string</span><span class="op" id="7509362">)</span>&nbsp;<span class="op" id="7509364">*</span><span class="ident" id="7509365">url</span><span class="op" id="7509368">.</span><span class="ident" id="7509369">URL</span>&nbsp;<span class="op" id="7509373">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509376">u</span><span class="op" id="7509377">,</span>&nbsp;<span class="ident" id="7509379">err</span>&nbsp;<span class="op" id="7509383">:=</span>&nbsp;<span class="ident" id="7509386">url</span><span class="op" id="7509389">.</span><span class="ident" id="7509390">Parse</span><span class="op" id="7509395">(</span><span class="ident" id="7509396">s</span><span class="op" id="7509397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509400">if</span>&nbsp;<span class="ident" id="7509403">err</span>&nbsp;<span class="op" id="7509407">!=</span>&nbsp;<span class="builtintype" id="7509410">nil</span>&nbsp;<span class="op" id="7509414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7509418">panic</span><span class="op" id="7509423">(</span><span class="ident" id="7509424">fmt</span><span class="op" id="7509427">.</span><span class="ident" id="7509428">Sprintf</span><span class="op" id="7509435">(</span><span class="string" id="7509436">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7509462">,</span>&nbsp;<span class="ident" id="7509464">s</span><span class="op" id="7509465">,</span>&nbsp;<span class="ident" id="7509467">err</span><span class="op" id="7509470">)</span><span class="op" id="7509471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509477">return</span>&nbsp;<span class="ident" id="7509484">u</span><br>
<span class="lineno">565</span><span class="op" id="7509486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509489">type</span>&nbsp;<span class="ident" id="7509494">writerFunc</span>&nbsp;<span class="keyword" id="7509505">func</span><span class="op" id="7509509">(</span><span class="op" id="7509510">[</span><span class="op" id="7509511">]</span><span class="builtintype" id="7509512">byte</span><span class="op" id="7509516">)</span>&nbsp;<span class="op" id="7509518">(</span><span class="builtintype" id="7509519">int</span><span class="op" id="7509522">,</span>&nbsp;<span class="builtintype" id="7509524">error</span><span class="op" id="7509529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509532">func</span>&nbsp;<span class="op" id="7509537">(</span><span class="ident" id="7509538">f</span>&nbsp;<span class="ident" id="7509540">writerFunc</span><span class="op" id="7509550">)</span>&nbsp;<span class="ident" id="7509552">Write</span><span class="op" id="7509557">(</span><span class="ident" id="7509558">p</span>&nbsp;<span class="op" id="7509560">[</span><span class="op" id="7509561">]</span><span class="builtintype" id="7509562">byte</span><span class="op" id="7509566">)</span>&nbsp;<span class="op" id="7509568">(</span><span class="builtintype" id="7509569">int</span><span class="op" id="7509572">,</span>&nbsp;<span class="builtintype" id="7509574">error</span><span class="op" id="7509579">)</span>&nbsp;<span class="op" id="7509581">{</span>&nbsp;<span class="keyword" id="7509583">return</span>&nbsp;<span class="ident" id="7509590">f</span><span class="op" id="7509591">(</span><span class="ident" id="7509592">p</span><span class="op" id="7509593">)</span>&nbsp;<span class="op" id="7509595">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7509598">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7509678">func</span>&nbsp;<span class="ident" id="7509683">TestRequestWriteError</span><span class="op" id="7509704">(</span><span class="ident" id="7509705">t</span>&nbsp;<span class="op" id="7509707">*</span><span class="ident" id="7509708">testing</span><span class="op" id="7509715">.</span><span class="ident" id="7509716">T</span><span class="op" id="7509717">)</span>&nbsp;<span class="op" id="7509719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509722">failAfter</span><span class="op" id="7509731">,</span>&nbsp;<span class="ident" id="7509733">writeCount</span>&nbsp;<span class="op" id="7509744">:=</span>&nbsp;<span class="num" id="7509747">0</span><span class="op" id="7509748">,</span>&nbsp;<span class="num" id="7509750">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509753">errFail</span>&nbsp;<span class="op" id="7509761">:=</span>&nbsp;<span class="ident" id="7509764">errors</span><span class="op" id="7509770">.</span><span class="ident" id="7509771">New</span><span class="op" id="7509774">(</span><span class="string" id="7509775">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7509795">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7509799">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7509860">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7509923">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7509976">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509992">w</span>&nbsp;<span class="op" id="7509994">:=</span>&nbsp;<span class="keyword" id="7509997">struct</span>&nbsp;<span class="op" id="7510004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510008">io</span><span class="op" id="7510010">.</span><span class="ident" id="7510011">ByteWriter</span>&nbsp;<span class="comment" id="7510022">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510068">io</span><span class="op" id="7510070">.</span><span class="ident" id="7510071">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510079">}</span><span class="op" id="7510080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7510084">nil</span><span class="op" id="7510087">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510091">writerFunc</span><span class="op" id="7510101">(</span><span class="keyword" id="7510102">func</span><span class="op" id="7510106">(</span><span class="ident" id="7510107">p</span>&nbsp;<span class="op" id="7510109">[</span><span class="op" id="7510110">]</span><span class="builtintype" id="7510111">byte</span><span class="op" id="7510115">)</span>&nbsp;<span class="op" id="7510117">(</span><span class="ident" id="7510118">n</span>&nbsp;<span class="builtintype" id="7510120">int</span><span class="op" id="7510123">,</span>&nbsp;<span class="ident" id="7510125">err</span>&nbsp;<span class="builtintype" id="7510129">error</span><span class="op" id="7510134">)</span>&nbsp;<span class="op" id="7510136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510141">writeCount</span><span class="op" id="7510151">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510157">if</span>&nbsp;<span class="ident" id="7510160">failAfter</span>&nbsp;<span class="op" id="7510170">==</span>&nbsp;<span class="num" id="7510173">0</span>&nbsp;<span class="op" id="7510175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510181">err</span>&nbsp;<span class="op" id="7510185">=</span>&nbsp;<span class="ident" id="7510187">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510198">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510203">failAfter</span><span class="op" id="7510212">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510218">return</span>&nbsp;<span class="builtinfunc" id="7510225">len</span><span class="op" id="7510228">(</span><span class="ident" id="7510229">p</span><span class="op" id="7510230">)</span><span class="op" id="7510231">,</span>&nbsp;<span class="ident" id="7510233">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510239">}</span><span class="op" id="7510240">)</span><span class="op" id="7510241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510248">req</span><span class="op" id="7510251">,</span>&nbsp;<span class="ident" id="7510253">_</span>&nbsp;<span class="op" id="7510255">:=</span>&nbsp;<span class="ident" id="7510258">NewRequest</span><span class="op" id="7510268">(</span><span class="string" id="7510269">&#34;GET&#34;</span><span class="op" id="7510274">,</span>&nbsp;<span class="string" id="7510276">&#34;http://example.com/&#34;</span><span class="op" id="7510297">,</span>&nbsp;<span class="builtintype" id="7510299">nil</span><span class="op" id="7510302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510305">const</span>&nbsp;<span class="ident" id="7510311">writeCalls</span>&nbsp;<span class="op" id="7510322">=</span>&nbsp;<span class="num" id="7510324">4</span>&nbsp;<span class="comment" id="7510326">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510378">sawGood</span>&nbsp;<span class="op" id="7510386">:=</span>&nbsp;<span class="builtintype" id="7510389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510396">for</span>&nbsp;<span class="ident" id="7510400">n</span>&nbsp;<span class="op" id="7510402">:=</span>&nbsp;<span class="num" id="7510405">0</span><span class="op" id="7510406">;</span>&nbsp;<span class="ident" id="7510408">n</span>&nbsp;<span class="op" id="7510410">&lt;=</span>&nbsp;<span class="ident" id="7510413">writeCalls</span><span class="op" id="7510423">+</span><span class="num" id="7510424">2</span><span class="op" id="7510425">;</span>&nbsp;<span class="ident" id="7510427">n</span><span class="op" id="7510428">++</span>&nbsp;<span class="op" id="7510431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510435">failAfter</span>&nbsp;<span class="op" id="7510445">=</span>&nbsp;<span class="ident" id="7510447">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510451">writeCount</span>&nbsp;<span class="op" id="7510462">=</span>&nbsp;<span class="num" id="7510464">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510468">err</span>&nbsp;<span class="op" id="7510472">:=</span>&nbsp;<span class="ident" id="7510475">req</span><span class="op" id="7510478">.</span><span class="ident" id="7510479">Write</span><span class="op" id="7510484">(</span><span class="ident" id="7510485">w</span><span class="op" id="7510486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510490">var</span>&nbsp;<span class="ident" id="7510494">wantErr</span>&nbsp;<span class="builtintype" id="7510502">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510510">if</span>&nbsp;<span class="ident" id="7510513">n</span>&nbsp;<span class="op" id="7510515">&lt;</span>&nbsp;<span class="ident" id="7510517">writeCalls</span>&nbsp;<span class="op" id="7510528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510533">wantErr</span>&nbsp;<span class="op" id="7510541">=</span>&nbsp;<span class="ident" id="7510543">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510557">if</span>&nbsp;<span class="ident" id="7510560">err</span>&nbsp;<span class="op" id="7510564">!=</span>&nbsp;<span class="ident" id="7510567">wantErr</span>&nbsp;<span class="op" id="7510575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510580">t</span><span class="op" id="7510581">.</span><span class="ident" id="7510582">Errorf</span><span class="op" id="7510588">(</span><span class="string" id="7510589">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7510634">,</span>&nbsp;<span class="ident" id="7510636">n</span><span class="op" id="7510637">,</span>&nbsp;<span class="ident" id="7510639">err</span><span class="op" id="7510642">,</span>&nbsp;<span class="ident" id="7510644">wantErr</span><span class="op" id="7510651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510656">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510667">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510671">if</span>&nbsp;<span class="ident" id="7510674">err</span>&nbsp;<span class="op" id="7510678">==</span>&nbsp;<span class="builtintype" id="7510681">nil</span>&nbsp;<span class="op" id="7510685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510690">sawGood</span>&nbsp;<span class="op" id="7510698">=</span>&nbsp;<span class="builtintype" id="7510700">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510708">if</span>&nbsp;<span class="ident" id="7510711">writeCount</span>&nbsp;<span class="op" id="7510722">!=</span>&nbsp;<span class="ident" id="7510725">writeCalls</span>&nbsp;<span class="op" id="7510736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510742">t</span><span class="op" id="7510743">.</span><span class="ident" id="7510744">Fatalf</span><span class="op" id="7510750">(</span><span class="string" id="7510751">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7510792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510797">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510805">if</span>&nbsp;<span class="ident" id="7510808">writeCount</span>&nbsp;<span class="op" id="7510819">&gt;</span>&nbsp;<span class="ident" id="7510821">writeCalls</span>&nbsp;<span class="op" id="7510832">||</span>&nbsp;<span class="ident" id="7510835">writeCount</span>&nbsp;<span class="op" id="7510846">&gt;</span>&nbsp;<span class="ident" id="7510848">n</span><span class="op" id="7510849">+</span><span class="num" id="7510850">1</span>&nbsp;<span class="op" id="7510852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510857">t</span><span class="op" id="7510858">.</span><span class="ident" id="7510859">Errorf</span><span class="op" id="7510865">(</span><span class="string" id="7510866">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7510925">,</span>&nbsp;<span class="ident" id="7510927">n</span><span class="op" id="7510928">,</span>&nbsp;<span class="ident" id="7510930">writeCount</span><span class="op" id="7510940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510947">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510950">if</span>&nbsp;<span class="op" id="7510953">!</span><span class="ident" id="7510954">sawGood</span>&nbsp;<span class="op" id="7510962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510966">t</span><span class="op" id="7510967">.</span><span class="ident" id="7510968">Fatalf</span><span class="op" id="7510974">(</span><span class="string" id="7510975">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7511016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511019">}</span><br>
<span class="lineno"></span><span class="op" id="7511021">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
