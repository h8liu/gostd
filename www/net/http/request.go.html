<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3364330">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3364385">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3364439">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3364490">//&nbsp;HTTP&nbsp;Request&nbsp;reading&nbsp;and&nbsp;parsing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364528">package</span>&nbsp;<span class="ident" id="3364536">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364542">import</span>&nbsp;<span class="op" id="3364549">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364552">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364561">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364570">&#34;crypto/tls&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364584">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364603">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364613">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364620">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364626">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364639">&#34;mime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364647">&#34;mime/multipart&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364665">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364682">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364693">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364704">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3364715">&#34;sync&#34;</span><br>
<span class="lineno">25</span><span class="op" id="3364722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364725">const</span>&nbsp;<span class="op" id="3364731">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364734">maxValueLength</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3364751">=</span>&nbsp;<span class="num" id="3364753">4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364759">maxHeaderLines</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3364776">=</span>&nbsp;<span class="num" id="3364778">1024</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364784">chunkSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364801">=</span>&nbsp;<span class="num" id="3364803">4</span>&nbsp;<span class="op" id="3364805">&lt;&lt;</span>&nbsp;<span class="num" id="3364808">10</span>&nbsp;&nbsp;<span class="comment" id="3364812">//&nbsp;4&nbsp;KB&nbsp;chunks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364828">defaultMaxMemory</span>&nbsp;<span class="op" id="3364845">=</span>&nbsp;<span class="num" id="3364847">32</span>&nbsp;<span class="op" id="3364850">&lt;&lt;</span>&nbsp;<span class="num" id="3364853">20</span>&nbsp;<span class="comment" id="3364856">//&nbsp;32&nbsp;MB</span><br>
<span class="lineno"></span><span class="op" id="3364865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3364868">//&nbsp;ErrMissingFile&nbsp;is&nbsp;returned&nbsp;by&nbsp;FormFile&nbsp;when&nbsp;the&nbsp;provided&nbsp;file&nbsp;field&nbsp;name</span><br>
<span class="lineno">35</span><span class="comment" id="3364944">//&nbsp;is&nbsp;either&nbsp;not&nbsp;present&nbsp;in&nbsp;the&nbsp;request&nbsp;or&nbsp;not&nbsp;a&nbsp;file&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="3365005">var</span>&nbsp;<span class="ident" id="3365009">ErrMissingFile</span>&nbsp;<span class="op" id="3365024">=</span>&nbsp;<span class="ident" id="3365026"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3365032">.</span><span class="ident" id="3365033">New</span><span class="op" id="3365036">(</span><span class="string" id="3365037">&#34;http:&nbsp;no&nbsp;such&nbsp;file&#34;</span><span class="op" id="3365057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3365060">//&nbsp;HTTP&nbsp;request&nbsp;parsing&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3365092">type</span>&nbsp;<span class="ident" id="3365097">ProtocolError</span>&nbsp;<span class="keyword" id="3365111">struct</span>&nbsp;<span class="op" id="3365118">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365121">ErrorString</span>&nbsp;<span class="builtintype" id="3365133">string</span><br>
<span class="lineno"></span><span class="op" id="3365140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3365143">func</span>&nbsp;<span class="op" id="3365148">(</span><span class="ident" id="3365149">err</span>&nbsp;<span class="op" id="3365153">*</span><span class="ident" id="3365154"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365167">)</span>&nbsp;<span class="ident" id="3365169">Error</span><span class="op" id="3365174">(</span><span class="op" id="3365175">)</span>&nbsp;<span class="builtintype" id="3365177">string</span>&nbsp;<span class="op" id="3365184">{</span>&nbsp;<span class="keyword" id="3365186">return</span>&nbsp;<span class="ident" id="3365193"><a href="/net/http/request.go.html#3365149">err</a></span><span class="op" id="3365196">.</span><span class="ident" id="3365197">ErrorString</span>&nbsp;<span class="op" id="3365209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="3365212">var</span>&nbsp;<span class="op" id="3365216">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365219">ErrHeaderTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365243">=</span>&nbsp;<span class="op" id="3365245">&amp;</span><span class="ident" id="3365246"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365259">{</span><span class="string" id="3365260">&#34;header&nbsp;too&nbsp;long&#34;</span><span class="op" id="3365277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365280">ErrShortBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365304">=</span>&nbsp;<span class="op" id="3365306">&amp;</span><span class="ident" id="3365307"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365320">{</span><span class="string" id="3365321">&#34;entity&nbsp;body&nbsp;too&nbsp;short&#34;</span><span class="op" id="3365344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365347">ErrNotSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365371">=</span>&nbsp;<span class="op" id="3365373">&amp;</span><span class="ident" id="3365374"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365387">{</span><span class="string" id="3365388">&#34;feature&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3365411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365414">ErrUnexpectedTrailer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365438">=</span>&nbsp;<span class="op" id="3365440">&amp;</span><span class="ident" id="3365441"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365454">{</span><span class="string" id="3365455">&#34;trailer&nbsp;header&nbsp;without&nbsp;chunked&nbsp;transfer&nbsp;encoding&#34;</span><span class="op" id="3365505">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365508">ErrMissingContentLength</span>&nbsp;<span class="op" id="3365532">=</span>&nbsp;<span class="op" id="3365534">&amp;</span><span class="ident" id="3365535"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365548">{</span><span class="string" id="3365549">&#34;missing&nbsp;ContentLength&nbsp;in&nbsp;HEAD&nbsp;response&#34;</span><span class="op" id="3365589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365592">ErrNotMultipart</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365616">=</span>&nbsp;<span class="op" id="3365618">&amp;</span><span class="ident" id="3365619"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365632">{</span><span class="string" id="3365633">&#34;request&nbsp;Content-Type&nbsp;isn&#39;t&nbsp;multipart/form-data&#34;</span><span class="op" id="3365681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365684">ErrMissingBoundary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365708">=</span>&nbsp;<span class="op" id="3365710">&amp;</span><span class="ident" id="3365711"><a href="/net/http/request.go.html#3365097">ProtocolError</a></span><span class="op" id="3365724">{</span><span class="string" id="3365725">&#34;no&nbsp;multipart&nbsp;boundary&nbsp;param&nbsp;in&nbsp;Content-Type&#34;</span><span class="op" id="3365770">}</span><br>
<span class="lineno"></span><span class="op" id="3365772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3365775">type</span>&nbsp;<span class="ident" id="3365780">badStringError</span>&nbsp;<span class="keyword" id="3365795">struct</span>&nbsp;<span class="op" id="3365802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365805">what</span>&nbsp;<span class="builtintype" id="3365810">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365818">str</span>&nbsp;&nbsp;<span class="builtintype" id="3365823">string</span><br>
<span class="lineno"></span><span class="op" id="3365830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3365833">func</span>&nbsp;<span class="op" id="3365838">(</span><span class="ident" id="3365839">e</span>&nbsp;<span class="op" id="3365841">*</span><span class="ident" id="3365842"><a href="/net/http/request.go.html#3365780">badStringError</a></span><span class="op" id="3365856">)</span>&nbsp;<span class="ident" id="3365858">Error</span><span class="op" id="3365863">(</span><span class="op" id="3365864">)</span>&nbsp;<span class="builtintype" id="3365866">string</span>&nbsp;<span class="op" id="3365873">{</span>&nbsp;<span class="keyword" id="3365875">return</span>&nbsp;<span class="ident" id="3365882"><a href="/net/http/request.go.html#3364613">fmt</a></span><span class="op" id="3365885">.</span><span class="ident" id="3365886">Sprintf</span><span class="op" id="3365893">(</span><span class="string" id="3365894">&#34;%s&nbsp;%q&#34;</span><span class="op" id="3365901">,</span>&nbsp;<span class="ident" id="3365903"><a href="/net/http/request.go.html#3365839">e</a></span><span class="op" id="3365904">.</span><span class="ident" id="3365905">what</span><span class="op" id="3365909">,</span>&nbsp;<span class="ident" id="3365911"><a href="/net/http/request.go.html#3365839">e</a></span><span class="op" id="3365912">.</span><span class="ident" id="3365913">str</span><span class="op" id="3365916">)</span>&nbsp;<span class="op" id="3365918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3365921">//&nbsp;Headers&nbsp;that&nbsp;Request.Write&nbsp;handles&nbsp;itself&nbsp;and&nbsp;should&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="3365989">var</span>&nbsp;<span class="ident" id="3365993">reqWriteExcludeHeader</span>&nbsp;<span class="op" id="3366015">=</span>&nbsp;<span class="keyword" id="3366017">map</span><span class="op" id="3366020">[</span><span class="builtintype" id="3366021">string</span><span class="op" id="3366027">]</span><span class="builtintype" id="3366028">bool</span><span class="op" id="3366032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3366035">&#34;Host&#34;</span><span class="op" id="3366041">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3366056">true</span><span class="op" id="3366060">,</span>&nbsp;<span class="comment" id="3366062">//&nbsp;not&nbsp;in&nbsp;Header&nbsp;map&nbsp;anyway</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3366091">&#34;User-Agent&#34;</span><span class="op" id="3366103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3366112">true</span><span class="op" id="3366116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3366119">&#34;Content-Length&#34;</span><span class="op" id="3366135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3366140">true</span><span class="op" id="3366144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3366147">&#34;Transfer-Encoding&#34;</span><span class="op" id="3366166">:</span>&nbsp;<span class="builtintype" id="3366168">true</span><span class="op" id="3366172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3366175">&#34;Trailer&#34;</span><span class="op" id="3366184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3366196">true</span><span class="op" id="3366200">,</span><br>
<span class="lineno"></span><span class="op" id="3366202">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3366205">//&nbsp;A&nbsp;Request&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;received&nbsp;by&nbsp;a&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="3366266">//&nbsp;or&nbsp;to&nbsp;be&nbsp;sent&nbsp;by&nbsp;a&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3366296">//</span><br>
<span class="lineno"></span><span class="comment" id="3366299">//&nbsp;The&nbsp;field&nbsp;semantics&nbsp;differ&nbsp;slightly&nbsp;between&nbsp;client&nbsp;and&nbsp;server</span><br>
<span class="lineno">75</span><span class="comment" id="3366364">//&nbsp;usage.&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;notes&nbsp;on&nbsp;the&nbsp;fields&nbsp;below,&nbsp;see&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3366428">//&nbsp;documentation&nbsp;for&nbsp;Request.Write&nbsp;and&nbsp;RoundTripper.</span><br>
<span class="lineno"></span><span class="keyword" id="3366481">type</span>&nbsp;<span class="ident" id="3366486">Request</span>&nbsp;<span class="keyword" id="3366494">struct</span>&nbsp;<span class="op" id="3366501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366504">//&nbsp;Method&nbsp;specifies&nbsp;the&nbsp;HTTP&nbsp;method&nbsp;(GET,&nbsp;POST,&nbsp;PUT,&nbsp;etc.).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366565">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;an&nbsp;empty&nbsp;string&nbsp;means&nbsp;GET.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3366616">Method</span>&nbsp;<span class="builtintype" id="3366623">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366632">//&nbsp;URL&nbsp;specifies&nbsp;either&nbsp;the&nbsp;URI&nbsp;being&nbsp;requested&nbsp;(for&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366693">//&nbsp;requests)&nbsp;or&nbsp;the&nbsp;URL&nbsp;to&nbsp;access&nbsp;(for&nbsp;client&nbsp;requests).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366751">//</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366755">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;URL&nbsp;is&nbsp;parsed&nbsp;from&nbsp;the&nbsp;URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366810">//&nbsp;supplied&nbsp;on&nbsp;the&nbsp;Request-Line&nbsp;as&nbsp;stored&nbsp;in&nbsp;RequestURI.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366873">//&nbsp;most&nbsp;requests,&nbsp;fields&nbsp;other&nbsp;than&nbsp;Path&nbsp;and&nbsp;RawQuery&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366936">//&nbsp;empty.&nbsp;(See&nbsp;RFC&nbsp;2616,&nbsp;Section&nbsp;5.1.2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366977">//</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3366981">//&nbsp;For&nbsp;client&nbsp;requests,&nbsp;the&nbsp;URL&#39;s&nbsp;Host&nbsp;specifies&nbsp;the&nbsp;server&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367045">//&nbsp;connect&nbsp;to,&nbsp;while&nbsp;the&nbsp;Request&#39;s&nbsp;Host&nbsp;field&nbsp;optionally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367103">//&nbsp;specifies&nbsp;the&nbsp;Host&nbsp;header&nbsp;value&nbsp;to&nbsp;send&nbsp;in&nbsp;the&nbsp;HTTP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367159">//&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367172">URL</span>&nbsp;<span class="op" id="3367176">*</span><span class="ident" id="3367177"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3367180">.</span><span class="ident" id="3367181">URL</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367187">//&nbsp;The&nbsp;protocol&nbsp;version&nbsp;for&nbsp;incoming&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367235">//&nbsp;Client&nbsp;requests&nbsp;always&nbsp;use&nbsp;HTTP/1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367276">Proto</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3367287">string</span>&nbsp;<span class="comment" id="3367294">//&nbsp;&#34;HTTP/1.0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367309">ProtoMajor</span>&nbsp;<span class="builtintype" id="3367320">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367327">//&nbsp;1</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367333">ProtoMinor</span>&nbsp;<span class="builtintype" id="3367344">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367351">//&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367358">//&nbsp;A&nbsp;header&nbsp;maps&nbsp;request&nbsp;lines&nbsp;to&nbsp;their&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367407">//&nbsp;If&nbsp;the&nbsp;header&nbsp;says</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367430">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367434">//&nbsp;&nbsp;&nbsp;&nbspaccept-encoding:&nbsp;gzip,&nbsp;deflate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367469">//&nbsp;&nbsp;&nbsp;&nbspAccept-Language:&nbsp;en-us</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367496">//&nbsp;&nbsp;&nbsp;&nbspConnection:&nbsp;keep-alive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367523">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367527">//&nbsp;then</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367536">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367540">//&nbsp;&nbsp;&nbsp;&nbspHeader&nbsp;=&nbsp;map[string][]string{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367574">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Accept-Encoding&#34;:&nbsp;{&#34;gzip,&nbsp;deflate&#34;},</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367617">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Accept-Language&#34;:&nbsp;{&#34;en-us&#34;},</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367652">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Connection&#34;:&nbsp;{&#34;keep-alive&#34;},</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367687">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367693">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367697">//&nbsp;HTTP&nbsp;defines&nbsp;that&nbsp;header&nbsp;names&nbsp;are&nbsp;case-insensitive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367754">//&nbsp;The&nbsp;request&nbsp;parser&nbsp;implements&nbsp;this&nbsp;by&nbsp;canonicalizing&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367815">//&nbsp;name,&nbsp;making&nbsp;the&nbsp;first&nbsp;character&nbsp;and&nbsp;any&nbsp;characters</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367871">//&nbsp;following&nbsp;a&nbsp;hyphen&nbsp;uppercase&nbsp;and&nbsp;the&nbsp;rest&nbsp;lowercase.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367928">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367932">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;certain&nbsp;headers&nbsp;are&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367990">//&nbsp;added&nbsp;and&nbsp;may&nbsp;override&nbsp;values&nbsp;in&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368035">//</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368039">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;Request.Write&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368095">Header</span>&nbsp;<span class="ident" id="3368102"><a href="/net/http/header.go.html#3356649">Header</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368111">//&nbsp;Body&nbsp;is&nbsp;the&nbsp;request&#39;s&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368143">//</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368147">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;a&nbsp;nil&nbsp;body&nbsp;means&nbsp;the&nbsp;request&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368207">//&nbsp;body,&nbsp;such&nbsp;as&nbsp;a&nbsp;GET&nbsp;request.&nbsp;The&nbsp;HTTP&nbsp;Client&#39;s&nbsp;Transport</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368268">//&nbsp;is&nbsp;responsible&nbsp;for&nbsp;calling&nbsp;the&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368317">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368321">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;Request&nbsp;Body&nbsp;is&nbsp;always&nbsp;non-nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368380">//&nbsp;but&nbsp;will&nbsp;return&nbsp;EOF&nbsp;immediately&nbsp;when&nbsp;no&nbsp;body&nbsp;is&nbsp;present.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368441">//&nbsp;The&nbsp;Server&nbsp;will&nbsp;close&nbsp;the&nbsp;request&nbsp;body.&nbsp;The&nbsp;ServeHTTP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368499">//&nbsp;Handler&nbsp;does&nbsp;not&nbsp;need&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368529">Body</span>&nbsp;<span class="ident" id="3368534"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3368536">.</span><span class="ident" id="3368537">ReadCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368550">//&nbsp;ContentLength&nbsp;records&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;associated&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368614">//&nbsp;The&nbsp;value&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;length&nbsp;is&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368669">//&nbsp;Values&nbsp;&gt;=&nbsp;0&nbsp;indicate&nbsp;that&nbsp;the&nbsp;given&nbsp;number&nbsp;of&nbsp;bytes&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368729">//&nbsp;be&nbsp;read&nbsp;from&nbsp;Body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368752">//&nbsp;For&nbsp;client&nbsp;requests,&nbsp;a&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;unknown&nbsp;if&nbsp;Body&nbsp;is&nbsp;not&nbsp;nil.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368824">ContentLength</span>&nbsp;<span class="ident" id="3368838">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368846">//&nbsp;TransferEncoding&nbsp;lists&nbsp;the&nbsp;transfer&nbsp;encodings&nbsp;from&nbsp;outermost&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368914">//&nbsp;innermost.&nbsp;An&nbsp;empty&nbsp;list&nbsp;denotes&nbsp;the&nbsp;&#34;identity&#34;&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368976">//&nbsp;TransferEncoding&nbsp;can&nbsp;usually&nbsp;be&nbsp;ignored;&nbsp;chunked&nbsp;encoding&nbsp;is</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369041">//&nbsp;automatically&nbsp;added&nbsp;and&nbsp;removed&nbsp;as&nbsp;necessary&nbsp;when&nbsp;sending&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369107">//&nbsp;receiving&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369131">TransferEncoding</span>&nbsp;<span class="op" id="3369148">[</span><span class="op" id="3369149">]</span><span class="builtintype" id="3369150">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369159">//&nbsp;Close&nbsp;indicates&nbsp;whether&nbsp;to&nbsp;close&nbsp;the&nbsp;connection&nbsp;after</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369217">//&nbsp;replying&nbsp;to&nbsp;this&nbsp;request&nbsp;(for&nbsp;servers)&nbsp;or&nbsp;after&nbsp;sending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369277">//&nbsp;the&nbsp;request&nbsp;(for&nbsp;clients).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369308">Close</span>&nbsp;<span class="builtintype" id="3369314">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369321">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;Host&nbsp;specifies&nbsp;the&nbsp;host&nbsp;on&nbsp;which&nbsp;the</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369382">//&nbsp;URL&nbsp;is&nbsp;sought.&nbsp;Per&nbsp;RFC&nbsp;2616,&nbsp;this&nbsp;is&nbsp;either&nbsp;the&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369443">//&nbsp;the&nbsp;&#34;Host&#34;&nbsp;header&nbsp;or&nbsp;the&nbsp;host&nbsp;name&nbsp;given&nbsp;in&nbsp;the&nbsp;URL&nbsp;itself.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369507">//&nbsp;It&nbsp;may&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host:port&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369546">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369550">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;Host&nbsp;optionally&nbsp;overrides&nbsp;the&nbsp;Host</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369609">//&nbsp;header&nbsp;to&nbsp;send.&nbsp;If&nbsp;empty,&nbsp;the&nbsp;Request.Write&nbsp;method&nbsp;uses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369669">//&nbsp;the&nbsp;value&nbsp;of&nbsp;URL.Host.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369696">Host</span>&nbsp;<span class="builtintype" id="3369701">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369710">//&nbsp;Form&nbsp;contains&nbsp;the&nbsp;parsed&nbsp;form&nbsp;data,&nbsp;including&nbsp;both&nbsp;the&nbsp;URL</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369773">//&nbsp;field&#39;s&nbsp;query&nbsp;parameters&nbsp;and&nbsp;the&nbsp;POST&nbsp;or&nbsp;PUT&nbsp;form&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369833">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369893">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;Form&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369949">Form</span>&nbsp;<span class="ident" id="3369954"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3369957">.</span><span class="ident" id="3369958">Values</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3369967">//&nbsp;PostForm&nbsp;contains&nbsp;the&nbsp;parsed&nbsp;form&nbsp;data&nbsp;from&nbsp;POST&nbsp;or&nbsp;PUT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370027">//&nbsp;body&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370048">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370108">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;PostForm&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3370168">PostForm</span>&nbsp;<span class="ident" id="3370177"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3370180">.</span><span class="ident" id="3370181">Values</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370190">//&nbsp;MultipartForm&nbsp;is&nbsp;the&nbsp;parsed&nbsp;multipart&nbsp;form,&nbsp;including&nbsp;file&nbsp;uploads.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370262">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseMultipartForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370331">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;MultipartForm&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3370396">MultipartForm</span>&nbsp;<span class="op" id="3370410">*</span><span class="ident" id="3370411"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3370420">.</span><span class="ident" id="3370421">Form</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370428">//&nbsp;Trailer&nbsp;specifies&nbsp;additional&nbsp;headers&nbsp;that&nbsp;are&nbsp;sent&nbsp;after&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370501">//&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370511">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370515">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;Trailer&nbsp;map&nbsp;initially&nbsp;contains&nbsp;only&nbsp;the</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370583">//&nbsp;trailer&nbsp;keys,&nbsp;with&nbsp;nil&nbsp;values.&nbsp;(The&nbsp;client&nbsp;declares&nbsp;which&nbsp;trailers&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370657">//&nbsp;will&nbsp;later&nbsp;send.)&nbsp;&nbsp;While&nbsp;the&nbsp;handler&nbsp;is&nbsp;reading&nbsp;from&nbsp;Body,&nbsp;it&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370728">//&nbsp;not&nbsp;reference&nbsp;Trailer.&nbsp;After&nbsp;reading&nbsp;from&nbsp;Body&nbsp;returns&nbsp;EOF,&nbsp;Trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370800">//&nbsp;can&nbsp;be&nbsp;read&nbsp;again&nbsp;and&nbsp;will&nbsp;contain&nbsp;non-nil&nbsp;values,&nbsp;if&nbsp;they&nbsp;were&nbsp;sent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370873">//&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370892">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370896">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;Trailer&nbsp;must&nbsp;be&nbsp;initialized&nbsp;to&nbsp;a&nbsp;map&nbsp;containing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370968">//&nbsp;the&nbsp;trailer&nbsp;keys&nbsp;to&nbsp;later&nbsp;send.&nbsp;The&nbsp;values&nbsp;may&nbsp;be&nbsp;nil&nbsp;or&nbsp;their&nbsp;final</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371041">//&nbsp;values.&nbsp;The&nbsp;ContentLength&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;-1,&nbsp;to&nbsp;send&nbsp;a&nbsp;chunked&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371115">//&nbsp;After&nbsp;the&nbsp;HTTP&nbsp;request&nbsp;is&nbsp;sent&nbsp;the&nbsp;map&nbsp;values&nbsp;can&nbsp;be&nbsp;updated&nbsp;while</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371186">//&nbsp;the&nbsp;request&nbsp;body&nbsp;is&nbsp;read.&nbsp;Once&nbsp;the&nbsp;body&nbsp;returns&nbsp;EOF,&nbsp;the&nbsp;caller&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371259">//&nbsp;not&nbsp;mutate&nbsp;Trailer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371283">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371287">//&nbsp;Few&nbsp;HTTP&nbsp;clients,&nbsp;servers,&nbsp;or&nbsp;proxies&nbsp;support&nbsp;HTTP&nbsp;trailers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3371352">Trailer</span>&nbsp;<span class="ident" id="3371360"><a href="/net/http/header.go.html#3356649">Header</a></span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371369">//&nbsp;RemoteAddr&nbsp;allows&nbsp;HTTP&nbsp;servers&nbsp;and&nbsp;other&nbsp;software&nbsp;to&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371433">//&nbsp;the&nbsp;network&nbsp;address&nbsp;that&nbsp;sent&nbsp;the&nbsp;request,&nbsp;usually&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371492">//&nbsp;logging.&nbsp;This&nbsp;field&nbsp;is&nbsp;not&nbsp;filled&nbsp;in&nbsp;by&nbsp;ReadRequest&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371552">//&nbsp;has&nbsp;no&nbsp;defined&nbsp;format.&nbsp;The&nbsp;HTTP&nbsp;server&nbsp;in&nbsp;this&nbsp;package</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371611">//&nbsp;sets&nbsp;RemoteAddr&nbsp;to&nbsp;an&nbsp;&#34;IP:port&#34;&nbsp;address&nbsp;before&nbsp;invoking&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371673">//&nbsp;handler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371686">//&nbsp;This&nbsp;field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;the&nbsp;HTTP&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3371732">RemoteAddr</span>&nbsp;<span class="builtintype" id="3371743">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371752">//&nbsp;RequestURI&nbsp;is&nbsp;the&nbsp;unmodified&nbsp;Request-URI&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371804">//&nbsp;Request-Line&nbsp;(RFC&nbsp;2616,&nbsp;Section&nbsp;5.1)&nbsp;as&nbsp;sent&nbsp;by&nbsp;the&nbsp;client</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371867">//&nbsp;to&nbsp;a&nbsp;server.&nbsp;Usually&nbsp;the&nbsp;URL&nbsp;field&nbsp;should&nbsp;be&nbsp;used&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371930">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;set&nbsp;this&nbsp;field&nbsp;in&nbsp;an&nbsp;HTTP&nbsp;client&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3371994">RequestURI</span>&nbsp;<span class="builtintype" id="3372005">string</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372014">//&nbsp;TLS&nbsp;allows&nbsp;HTTP&nbsp;servers&nbsp;and&nbsp;other&nbsp;software&nbsp;to&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372071">//&nbsp;information&nbsp;about&nbsp;the&nbsp;TLS&nbsp;connection&nbsp;on&nbsp;which&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372133">//&nbsp;was&nbsp;received.&nbsp;This&nbsp;field&nbsp;is&nbsp;not&nbsp;filled&nbsp;in&nbsp;by&nbsp;ReadRequest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372195">//&nbsp;The&nbsp;HTTP&nbsp;server&nbsp;in&nbsp;this&nbsp;package&nbsp;sets&nbsp;the&nbsp;field&nbsp;for</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372250">//&nbsp;TLS-enabled&nbsp;connections&nbsp;before&nbsp;invoking&nbsp;a&nbsp;handler;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372305">//&nbsp;otherwise&nbsp;it&nbsp;leaves&nbsp;the&nbsp;field&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372344">//&nbsp;This&nbsp;field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;the&nbsp;HTTP&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3372390">TLS</span>&nbsp;<span class="op" id="3372394">*</span><span class="ident" id="3372395"><a href="/net/http/request.go.html#3364570">tls</a></span><span class="op" id="3372398">.</span><span class="ident" id="3372399">ConnectionState</span><br>
<span class="lineno"></span><span class="op" id="3372415">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="3372418">//&nbsp;ProtoAtLeast&nbsp;reports&nbsp;whether&nbsp;the&nbsp;HTTP&nbsp;protocol&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3372473">//&nbsp;in&nbsp;the&nbsp;request&nbsp;is&nbsp;at&nbsp;least&nbsp;major.minor.</span><br>
<span class="lineno"></span><span class="keyword" id="3372516">func</span>&nbsp;<span class="op" id="3372521">(</span><span class="ident" id="3372522">r</span>&nbsp;<span class="op" id="3372524">*</span><span class="ident" id="3372525"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3372532">)</span>&nbsp;<span class="ident" id="3372534">ProtoAtLeast</span><span class="op" id="3372546">(</span><span class="ident" id="3372547">major</span><span class="op" id="3372552">,</span>&nbsp;<span class="ident" id="3372554">minor</span>&nbsp;<span class="builtintype" id="3372560">int</span><span class="op" id="3372563">)</span>&nbsp;<span class="builtintype" id="3372565">bool</span>&nbsp;<span class="op" id="3372570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372573">return</span>&nbsp;<span class="ident" id="3372580"><a href="/net/http/request.go.html#3372522">r</a></span><span class="op" id="3372581">.</span><span class="ident" id="3372582">ProtoMajor</span>&nbsp;<span class="op" id="3372593">&gt;</span>&nbsp;<span class="ident" id="3372595"><a href="/net/http/request.go.html#3372547">major</a></span>&nbsp;<span class="op" id="3372601">||</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3372606"><a href="/net/http/request.go.html#3372522">r</a></span><span class="op" id="3372607">.</span><span class="ident" id="3372608">ProtoMajor</span>&nbsp;<span class="op" id="3372619">==</span>&nbsp;<span class="ident" id="3372622"><a href="/net/http/request.go.html#3372547">major</a></span>&nbsp;<span class="op" id="3372628">&amp;&amp;</span>&nbsp;<span class="ident" id="3372631"><a href="/net/http/request.go.html#3372522">r</a></span><span class="op" id="3372632">.</span><span class="ident" id="3372633">ProtoMinor</span>&nbsp;<span class="op" id="3372644">&gt;=</span>&nbsp;<span class="ident" id="3372647"><a href="/net/http/request.go.html#3372554">minor</a></span><br>
<span class="lineno"></span><span class="op" id="3372653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3372656">//&nbsp;UserAgent&nbsp;returns&nbsp;the&nbsp;client&#39;s&nbsp;User-Agent,&nbsp;if&nbsp;sent&nbsp;in&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3372726">func</span>&nbsp;<span class="op" id="3372731">(</span><span class="ident" id="3372732">r</span>&nbsp;<span class="op" id="3372734">*</span><span class="ident" id="3372735"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3372742">)</span>&nbsp;<span class="ident" id="3372744">UserAgent</span><span class="op" id="3372753">(</span><span class="op" id="3372754">)</span>&nbsp;<span class="builtintype" id="3372756">string</span>&nbsp;<span class="op" id="3372763">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372766">return</span>&nbsp;<span class="ident" id="3372773"><a href="/net/http/request.go.html#3372732">r</a></span><span class="op" id="3372774">.</span><span class="ident" id="3372775">Header</span><span class="op" id="3372781">.</span><span class="ident" id="3372782">Get</span><span class="op" id="3372785">(</span><span class="string" id="3372786">&#34;User-Agent&#34;</span><span class="op" id="3372798">)</span><br>
<span class="lineno"></span><span class="op" id="3372800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3372803">//&nbsp;Cookies&nbsp;parses&nbsp;and&nbsp;returns&nbsp;the&nbsp;HTTP&nbsp;cookies&nbsp;sent&nbsp;with&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3372873">func</span>&nbsp;<span class="op" id="3372878">(</span><span class="ident" id="3372879">r</span>&nbsp;<span class="op" id="3372881">*</span><span class="ident" id="3372882"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3372889">)</span>&nbsp;<span class="ident" id="3372891">Cookies</span><span class="op" id="3372898">(</span><span class="op" id="3372899">)</span>&nbsp;<span class="op" id="3372901">[</span><span class="op" id="3372902">]</span><span class="op" id="3372903">*</span><span class="ident" id="3372904"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span>&nbsp;<span class="op" id="3372911">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372914">return</span>&nbsp;<span class="ident" id="3372921"><a href="/net/http/cookie.go.html#3330471">readCookies</a></span><span class="op" id="3372932">(</span><span class="ident" id="3372933"><a href="/net/http/request.go.html#3372879">r</a></span><span class="op" id="3372934">.</span><span class="ident" id="3372935">Header</span><span class="op" id="3372941">,</span>&nbsp;<span class="string" id="3372943">&#34;&#34;</span><span class="op" id="3372945">)</span><br>
<span class="lineno"></span><span class="op" id="3372947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3372950">var</span>&nbsp;<span class="ident" id="3372954">ErrNoCookie</span>&nbsp;<span class="op" id="3372966">=</span>&nbsp;<span class="ident" id="3372968"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3372974">.</span><span class="ident" id="3372975">New</span><span class="op" id="3372978">(</span><span class="string" id="3372979">&#34;http:&nbsp;named&nbsp;cookie&nbsp;not&nbsp;present&#34;</span><span class="op" id="3373011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="3373014">//&nbsp;Cookie&nbsp;returns&nbsp;the&nbsp;named&nbsp;cookie&nbsp;provided&nbsp;in&nbsp;the&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3373076">//&nbsp;ErrNoCookie&nbsp;if&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="3373105">func</span>&nbsp;<span class="op" id="3373110">(</span><span class="ident" id="3373111">r</span>&nbsp;<span class="op" id="3373113">*</span><span class="ident" id="3373114"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3373121">)</span>&nbsp;<span class="ident" id="3373123">Cookie</span><span class="op" id="3373129">(</span><span class="ident" id="3373130">name</span>&nbsp;<span class="builtintype" id="3373135">string</span><span class="op" id="3373141">)</span>&nbsp;<span class="op" id="3373143">(</span><span class="op" id="3373144">*</span><span class="ident" id="3373145"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3373151">,</span>&nbsp;<span class="builtintype" id="3373153">error</span><span class="op" id="3373158">)</span>&nbsp;<span class="op" id="3373160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373163">for</span>&nbsp;<span class="ident" id="3373167">_</span><span class="op" id="3373168">,</span>&nbsp;<span class="ident" id="3373170">c</span>&nbsp;<span class="op" id="3373172">:=</span>&nbsp;<span class="keyword" id="3373175">range</span>&nbsp;<span class="ident" id="3373181"><a href="/net/http/cookie.go.html#3330471">readCookies</a></span><span class="op" id="3373192">(</span><span class="ident" id="3373193"><a href="/net/http/request.go.html#3373111">r</a></span><span class="op" id="3373194">.</span><span class="ident" id="3373195">Header</span><span class="op" id="3373201">,</span>&nbsp;<span class="ident" id="3373203"><a href="/net/http/request.go.html#3373130">name</a></span><span class="op" id="3373207">)</span>&nbsp;<span class="op" id="3373209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373213">return</span>&nbsp;<span class="ident" id="3373220"><a href="/net/http/request.go.html#3373170">c</a></span><span class="op" id="3373221">,</span>&nbsp;<span class="ident" id="3373223">nil</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373231">return</span>&nbsp;<span class="ident" id="3373238">nil</span><span class="op" id="3373241">,</span>&nbsp;<span class="ident" id="3373243"><a href="/net/http/request.go.html#3372954">ErrNoCookie</a></span><br>
<span class="lineno"></span><span class="op" id="3373255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3373258">//&nbsp;AddCookie&nbsp;adds&nbsp;a&nbsp;cookie&nbsp;to&nbsp;the&nbsp;request.&nbsp;&nbsp;Per&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.4,</span><br>
<span class="lineno">260</span><span class="comment" id="3373328">//&nbsp;AddCookie&nbsp;does&nbsp;not&nbsp;attach&nbsp;more&nbsp;than&nbsp;one&nbsp;Cookie&nbsp;header&nbsp;field.&nbsp;&nbsp;That</span><br>
<span class="lineno"></span><span class="comment" id="3373398">//&nbsp;means&nbsp;all&nbsp;cookies,&nbsp;if&nbsp;any,&nbsp;are&nbsp;written&nbsp;into&nbsp;the&nbsp;same&nbsp;line,</span><br>
<span class="lineno"></span><span class="comment" id="3373460">//&nbsp;separated&nbsp;by&nbsp;semicolon.</span><br>
<span class="lineno"></span><span class="keyword" id="3373487">func</span>&nbsp;<span class="op" id="3373492">(</span><span class="ident" id="3373493">r</span>&nbsp;<span class="op" id="3373495">*</span><span class="ident" id="3373496"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3373503">)</span>&nbsp;<span class="ident" id="3373505">AddCookie</span><span class="op" id="3373514">(</span><span class="ident" id="3373515">c</span>&nbsp;<span class="op" id="3373517">*</span><span class="ident" id="3373518"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3373524">)</span>&nbsp;<span class="op" id="3373526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373529">s</span>&nbsp;<span class="op" id="3373531">:=</span>&nbsp;<span class="ident" id="3373534"><a href="/net/http/request.go.html#3364613">fmt</a></span><span class="op" id="3373537">.</span><span class="ident" id="3373538">Sprintf</span><span class="op" id="3373545">(</span><span class="string" id="3373546">&#34;%s=%s&#34;</span><span class="op" id="3373553">,</span>&nbsp;<span class="ident" id="3373555"><a href="/net/http/cookie.go.html#3332761">sanitizeCookieName</a></span><span class="op" id="3373573">(</span><span class="ident" id="3373574"><a href="/net/http/request.go.html#3373515">c</a></span><span class="op" id="3373575">.</span><span class="ident" id="3373576">Name</span><span class="op" id="3373580">)</span><span class="op" id="3373581">,</span>&nbsp;<span class="ident" id="3373583"><a href="/net/http/cookie.go.html#3333387">sanitizeCookieValue</a></span><span class="op" id="3373602">(</span><span class="ident" id="3373603"><a href="/net/http/request.go.html#3373515">c</a></span><span class="op" id="3373604">.</span><span class="ident" id="3373605">Value</span><span class="op" id="3373610">)</span><span class="op" id="3373611">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373614">if</span>&nbsp;<span class="ident" id="3373617">c</span>&nbsp;<span class="op" id="3373619">:=</span>&nbsp;<span class="ident" id="3373622"><a href="/net/http/request.go.html#3373493">r</a></span><span class="op" id="3373623">.</span><span class="ident" id="3373624">Header</span><span class="op" id="3373630">.</span><span class="ident" id="3373631">Get</span><span class="op" id="3373634">(</span><span class="string" id="3373635">&#34;Cookie&#34;</span><span class="op" id="3373643">)</span><span class="op" id="3373644">;</span>&nbsp;<span class="ident" id="3373646"><a href="/net/http/request.go.html#3373617">c</a></span>&nbsp;<span class="op" id="3373648">!=</span>&nbsp;<span class="string" id="3373651">&#34;&#34;</span>&nbsp;<span class="op" id="3373654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373658"><a href="/net/http/request.go.html#3373493">r</a></span><span class="op" id="3373659">.</span><span class="ident" id="3373660">Header</span><span class="op" id="3373666">.</span><span class="ident" id="3373667">Set</span><span class="op" id="3373670">(</span><span class="string" id="3373671">&#34;Cookie&#34;</span><span class="op" id="3373679">,</span>&nbsp;<span class="ident" id="3373681"><a href="/net/http/request.go.html#3373617">c</a></span><span class="op" id="3373682">+</span><span class="string" id="3373683">&#34;;&nbsp;&#34;</span><span class="op" id="3373687">+</span><span class="ident" id="3373688"><a href="/net/http/request.go.html#3373529">s</a></span><span class="op" id="3373689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373692">}</span>&nbsp;<span class="keyword" id="3373694">else</span>&nbsp;<span class="op" id="3373699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373703"><a href="/net/http/request.go.html#3373493">r</a></span><span class="op" id="3373704">.</span><span class="ident" id="3373705">Header</span><span class="op" id="3373711">.</span><span class="ident" id="3373712">Set</span><span class="op" id="3373715">(</span><span class="string" id="3373716">&#34;Cookie&#34;</span><span class="op" id="3373724">,</span>&nbsp;<span class="ident" id="3373726"><a href="/net/http/request.go.html#3373529">s</a></span><span class="op" id="3373727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373730">}</span><br>
<span class="lineno">270</span><span class="op" id="3373732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3373735">//&nbsp;Referer&nbsp;returns&nbsp;the&nbsp;referring&nbsp;URL,&nbsp;if&nbsp;sent&nbsp;in&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3373797">//</span><br>
<span class="lineno"></span><span class="comment" id="3373800">//&nbsp;Referer&nbsp;is&nbsp;misspelled&nbsp;as&nbsp;in&nbsp;the&nbsp;request&nbsp;itself,&nbsp;a&nbsp;mistake&nbsp;from&nbsp;the</span><br>
<span class="lineno">275</span><span class="comment" id="3373870">//&nbsp;earliest&nbsp;days&nbsp;of&nbsp;HTTP.&nbsp;&nbsp;This&nbsp;value&nbsp;can&nbsp;also&nbsp;be&nbsp;fetched&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3373937">//&nbsp;Header&nbsp;map&nbsp;as&nbsp;Header[&#34;Referer&#34;];&nbsp;the&nbsp;benefit&nbsp;of&nbsp;making&nbsp;it&nbsp;available</span><br>
<span class="lineno"></span><span class="comment" id="3374008">//&nbsp;as&nbsp;a&nbsp;method&nbsp;is&nbsp;that&nbsp;the&nbsp;compiler&nbsp;can&nbsp;diagnose&nbsp;programs&nbsp;that&nbsp;use&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3374079">//&nbsp;alternate&nbsp;(correct&nbsp;English)&nbsp;spelling&nbsp;req.Referrer()&nbsp;but&nbsp;cannot</span><br>
<span class="lineno"></span><span class="comment" id="3374145">//&nbsp;diagnose&nbsp;programs&nbsp;that&nbsp;use&nbsp;Header[&#34;Referrer&#34;].</span><br>
<span class="lineno">280</span><span class="keyword" id="3374195">func</span>&nbsp;<span class="op" id="3374200">(</span><span class="ident" id="3374201">r</span>&nbsp;<span class="op" id="3374203">*</span><span class="ident" id="3374204"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3374211">)</span>&nbsp;<span class="ident" id="3374213">Referer</span><span class="op" id="3374220">(</span><span class="op" id="3374221">)</span>&nbsp;<span class="builtintype" id="3374223">string</span>&nbsp;<span class="op" id="3374230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374233">return</span>&nbsp;<span class="ident" id="3374240"><a href="/net/http/request.go.html#3374201">r</a></span><span class="op" id="3374241">.</span><span class="ident" id="3374242">Header</span><span class="op" id="3374248">.</span><span class="ident" id="3374249">Get</span><span class="op" id="3374252">(</span><span class="string" id="3374253">&#34;Referer&#34;</span><span class="op" id="3374262">)</span><br>
<span class="lineno"></span><span class="op" id="3374264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3374267">//&nbsp;multipartByReader&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value.</span><br>
<span class="lineno">285</span><span class="comment" id="3374309">//&nbsp;Its&nbsp;presence&nbsp;in&nbsp;Request.MultipartForm&nbsp;indicates&nbsp;that&nbsp;parsing&nbsp;of&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="3374388">//&nbsp;body&nbsp;has&nbsp;been&nbsp;handed&nbsp;off&nbsp;to&nbsp;a&nbsp;MultipartReader&nbsp;instead&nbsp;of&nbsp;ParseMultipartFrom.</span><br>
<span class="lineno"></span><span class="keyword" id="3374468">var</span>&nbsp;<span class="ident" id="3374472">multipartByReader</span>&nbsp;<span class="op" id="3374490">=</span>&nbsp;<span class="op" id="3374492">&amp;</span><span class="ident" id="3374493"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3374502">.</span><span class="ident" id="3374503">Form</span><span class="op" id="3374507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374510">Value</span><span class="op" id="3374515">:</span>&nbsp;<span class="builtinfunc" id="3374517">make</span><span class="op" id="3374521">(</span><span class="keyword" id="3374522">map</span><span class="op" id="3374525">[</span><span class="builtintype" id="3374526">string</span><span class="op" id="3374532">]</span><span class="op" id="3374533">[</span><span class="op" id="3374534">]</span><span class="builtintype" id="3374535">string</span><span class="op" id="3374541">)</span><span class="op" id="3374542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374545">File</span><span class="op" id="3374549">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="3374552">make</span><span class="op" id="3374556">(</span><span class="keyword" id="3374557">map</span><span class="op" id="3374560">[</span><span class="builtintype" id="3374561">string</span><span class="op" id="3374567">]</span><span class="op" id="3374568">[</span><span class="op" id="3374569">]</span><span class="op" id="3374570">*</span><span class="ident" id="3374571"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3374580">.</span><span class="ident" id="3374581">FileHeader</span><span class="op" id="3374591">)</span><span class="op" id="3374592">,</span><br>
<span class="lineno">290</span><span class="op" id="3374594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3374597">//&nbsp;MultipartReader&nbsp;returns&nbsp;a&nbsp;MIME&nbsp;multipart&nbsp;reader&nbsp;if&nbsp;this&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3374661">//&nbsp;multipart/form-data&nbsp;POST&nbsp;request,&nbsp;else&nbsp;returns&nbsp;nil&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3374729">//&nbsp;Use&nbsp;this&nbsp;function&nbsp;instead&nbsp;of&nbsp;ParseMultipartForm&nbsp;to</span><br>
<span class="lineno">295</span><span class="comment" id="3374783">//&nbsp;process&nbsp;the&nbsp;request&nbsp;body&nbsp;as&nbsp;a&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="3374824">func</span>&nbsp;<span class="op" id="3374829">(</span><span class="ident" id="3374830">r</span>&nbsp;<span class="op" id="3374832">*</span><span class="ident" id="3374833"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3374840">)</span>&nbsp;<span class="ident" id="3374842">MultipartReader</span><span class="op" id="3374857">(</span><span class="op" id="3374858">)</span>&nbsp;<span class="op" id="3374860">(</span><span class="op" id="3374861">*</span><span class="ident" id="3374862"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3374871">.</span><span class="ident" id="3374872">Reader</span><span class="op" id="3374878">,</span>&nbsp;<span class="builtintype" id="3374880">error</span><span class="op" id="3374885">)</span>&nbsp;<span class="op" id="3374887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374890">if</span>&nbsp;<span class="ident" id="3374893"><a href="/net/http/request.go.html#3374830">r</a></span><span class="op" id="3374894">.</span><span class="ident" id="3374895">MultipartForm</span>&nbsp;<span class="op" id="3374909">==</span>&nbsp;<span class="ident" id="3374912"><a href="/net/http/request.go.html#3374472">multipartByReader</a></span>&nbsp;<span class="op" id="3374930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374934">return</span>&nbsp;<span class="ident" id="3374941">nil</span><span class="op" id="3374944">,</span>&nbsp;<span class="ident" id="3374946"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3374952">.</span><span class="ident" id="3374953">New</span><span class="op" id="3374956">(</span><span class="string" id="3374957">&#34;http:&nbsp;MultipartReader&nbsp;called&nbsp;twice&#34;</span><span class="op" id="3374993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374996">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374999">if</span>&nbsp;<span class="ident" id="3375002"><a href="/net/http/request.go.html#3374830">r</a></span><span class="op" id="3375003">.</span><span class="ident" id="3375004">MultipartForm</span>&nbsp;<span class="op" id="3375018">!=</span>&nbsp;<span class="ident" id="3375021">nil</span>&nbsp;<span class="op" id="3375025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375029">return</span>&nbsp;<span class="ident" id="3375036">nil</span><span class="op" id="3375039">,</span>&nbsp;<span class="ident" id="3375041"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3375047">.</span><span class="ident" id="3375048">New</span><span class="op" id="3375051">(</span><span class="string" id="3375052">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;ParseMultipartForm&#34;</span><span class="op" id="3375099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3375102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3375105"><a href="/net/http/request.go.html#3374830">r</a></span><span class="op" id="3375106">.</span><span class="ident" id="3375107">MultipartForm</span>&nbsp;<span class="op" id="3375121">=</span>&nbsp;<span class="ident" id="3375123"><a href="/net/http/request.go.html#3374472">multipartByReader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375142">return</span>&nbsp;<span class="ident" id="3375149"><a href="/net/http/request.go.html#3374830">r</a></span><span class="op" id="3375150">.</span><span class="ident" id="3375151">multipartReader</span><span class="op" id="3375166">(</span><span class="op" id="3375167">)</span><br>
<span class="lineno">305</span><span class="op" id="3375169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3375172">func</span>&nbsp;<span class="op" id="3375177">(</span><span class="ident" id="3375178">r</span>&nbsp;<span class="op" id="3375180">*</span><span class="ident" id="3375181"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3375188">)</span>&nbsp;<span class="ident" id="3375190">multipartReader</span><span class="op" id="3375205">(</span><span class="op" id="3375206">)</span>&nbsp;<span class="op" id="3375208">(</span><span class="op" id="3375209">*</span><span class="ident" id="3375210"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3375219">.</span><span class="ident" id="3375220">Reader</span><span class="op" id="3375226">,</span>&nbsp;<span class="builtintype" id="3375228">error</span><span class="op" id="3375233">)</span>&nbsp;<span class="op" id="3375235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3375238">v</span>&nbsp;<span class="op" id="3375240">:=</span>&nbsp;<span class="ident" id="3375243"><a href="/net/http/request.go.html#3375178">r</a></span><span class="op" id="3375244">.</span><span class="ident" id="3375245">Header</span><span class="op" id="3375251">.</span><span class="ident" id="3375252">Get</span><span class="op" id="3375255">(</span><span class="string" id="3375256">&#34;Content-Type&#34;</span><span class="op" id="3375270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375273">if</span>&nbsp;<span class="ident" id="3375276"><a href="/net/http/request.go.html#3375238">v</a></span>&nbsp;<span class="op" id="3375278">==</span>&nbsp;<span class="string" id="3375281">&#34;&#34;</span>&nbsp;<span class="op" id="3375284">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375288">return</span>&nbsp;<span class="ident" id="3375295">nil</span><span class="op" id="3375298">,</span>&nbsp;<span class="ident" id="3375300"><a href="/net/http/request.go.html#3365592">ErrNotMultipart</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3375317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3375320">d</span><span class="op" id="3375321">,</span>&nbsp;<span class="ident" id="3375323">params</span><span class="op" id="3375329">,</span>&nbsp;<span class="ident" id="3375331">err</span>&nbsp;<span class="op" id="3375335">:=</span>&nbsp;<span class="ident" id="3375338"><a href="/net/http/request.go.html#3364639">mime</a></span><span class="op" id="3375342">.</span><span class="ident" id="3375343">ParseMediaType</span><span class="op" id="3375357">(</span><span class="ident" id="3375358"><a href="/net/http/request.go.html#3375238">v</a></span><span class="op" id="3375359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375362">if</span>&nbsp;<span class="ident" id="3375365"><a href="/net/http/request.go.html#3375331">err</a></span>&nbsp;<span class="op" id="3375369">!=</span>&nbsp;<span class="ident" id="3375372">nil</span>&nbsp;<span class="op" id="3375376">||</span>&nbsp;<span class="ident" id="3375379"><a href="/net/http/request.go.html#3375320">d</a></span>&nbsp;<span class="op" id="3375381">!=</span>&nbsp;<span class="string" id="3375384">&#34;multipart/form-data&#34;</span>&nbsp;<span class="op" id="3375406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375410">return</span>&nbsp;<span class="ident" id="3375417">nil</span><span class="op" id="3375420">,</span>&nbsp;<span class="ident" id="3375422"><a href="/net/http/request.go.html#3365592">ErrNotMultipart</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3375439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3375442">boundary</span><span class="op" id="3375450">,</span>&nbsp;<span class="ident" id="3375452">ok</span>&nbsp;<span class="op" id="3375455">:=</span>&nbsp;<span class="ident" id="3375458"><a href="/net/http/request.go.html#3375323">params</a></span><span class="op" id="3375464">[</span><span class="string" id="3375465">&#34;boundary&#34;</span><span class="op" id="3375475">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375478">if</span>&nbsp;<span class="op" id="3375481">!</span><span class="ident" id="3375482"><a href="/net/http/request.go.html#3375452">ok</a></span>&nbsp;<span class="op" id="3375485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375489">return</span>&nbsp;<span class="ident" id="3375496">nil</span><span class="op" id="3375499">,</span>&nbsp;<span class="ident" id="3375501"><a href="/net/http/request.go.html#3365684">ErrMissingBoundary</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3375521">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375524">return</span>&nbsp;<span class="ident" id="3375531"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3375540">.</span><span class="ident" id="3375541">NewReader</span><span class="op" id="3375550">(</span><span class="ident" id="3375551"><a href="/net/http/request.go.html#3375178">r</a></span><span class="op" id="3375552">.</span><span class="ident" id="3375553">Body</span><span class="op" id="3375557">,</span>&nbsp;<span class="ident" id="3375559"><a href="/net/http/request.go.html#3375442">boundary</a></span><span class="op" id="3375567">)</span><span class="op" id="3375568">,</span>&nbsp;<span class="ident" id="3375570">nil</span><br>
<span class="lineno"></span><span class="op" id="3375574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3375577">//&nbsp;Return&nbsp;value&nbsp;if&nbsp;nonempty,&nbsp;def&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="3375621">func</span>&nbsp;<span class="ident" id="3375626">valueOrDefault</span><span class="op" id="3375640">(</span><span class="ident" id="3375641">value</span><span class="op" id="3375646">,</span>&nbsp;<span class="ident" id="3375648">def</span>&nbsp;<span class="builtintype" id="3375652">string</span><span class="op" id="3375658">)</span>&nbsp;<span class="builtintype" id="3375660">string</span>&nbsp;<span class="op" id="3375667">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375670">if</span>&nbsp;<span class="ident" id="3375673"><a href="/net/http/request.go.html#3375641">value</a></span>&nbsp;<span class="op" id="3375679">!=</span>&nbsp;<span class="string" id="3375682">&#34;&#34;</span>&nbsp;<span class="op" id="3375685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375689">return</span>&nbsp;<span class="ident" id="3375696"><a href="/net/http/request.go.html#3375641">value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3375703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375706">return</span>&nbsp;<span class="ident" id="3375713"><a href="/net/http/request.go.html#3375648">def</a></span><br>
<span class="lineno"></span><span class="op" id="3375717">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3375720">//&nbsp;NOTE:&nbsp;This&nbsp;is&nbsp;not&nbsp;intended&nbsp;to&nbsp;reflect&nbsp;the&nbsp;actual&nbsp;Go&nbsp;version&nbsp;being&nbsp;used.</span><br>
<span class="lineno"></span><span class="comment" id="3375795">//&nbsp;It&nbsp;was&nbsp;changed&nbsp;from&nbsp;&#34;Go&nbsp;http&nbsp;package&#34;&nbsp;to&nbsp;&#34;Go&nbsp;1.1&nbsp;package&nbsp;http&#34;&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3375868">//&nbsp;time&nbsp;of&nbsp;the&nbsp;Go&nbsp;1.1&nbsp;release&nbsp;because&nbsp;the&nbsp;former&nbsp;User-Agent&nbsp;had&nbsp;ended&nbsp;up</span><br>
<span class="lineno"></span><span class="comment" id="3375941">//&nbsp;on&nbsp;a&nbsp;blacklist&nbsp;for&nbsp;some&nbsp;intrusion&nbsp;detection&nbsp;systems.</span><br>
<span class="lineno">335</span><span class="comment" id="3375997">//&nbsp;See&nbsp;https://codereview.appspot.com/7532043.</span><br>
<span class="lineno"></span><span class="keyword" id="3376044">const</span>&nbsp;<span class="ident" id="3376050">defaultUserAgent</span>&nbsp;<span class="op" id="3376067">=</span>&nbsp;<span class="string" id="3376069">&#34;Go&nbsp;1.1&nbsp;package&nbsp;http&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3376092">//&nbsp;Write&nbsp;writes&nbsp;an&nbsp;HTTP/1.1&nbsp;request&nbsp;--&nbsp;header&nbsp;and&nbsp;body&nbsp;--&nbsp;in&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3376166">//&nbsp;This&nbsp;method&nbsp;consults&nbsp;the&nbsp;following&nbsp;fields&nbsp;of&nbsp;the&nbsp;request:</span><br>
<span class="lineno">340</span><span class="comment" id="3376227">//&nbsp;&nbsp;&nbsp;&nbspHost</span><br>
<span class="lineno"></span><span class="comment" id="3376235">//&nbsp;&nbsp;&nbsp;&nbspURL</span><br>
<span class="lineno"></span><span class="comment" id="3376242">//&nbsp;&nbsp;&nbsp;&nbspMethod&nbsp;(defaults&nbsp;to&nbsp;&#34;GET&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3376272">//&nbsp;&nbsp;&nbsp;&nbspHeader</span><br>
<span class="lineno"></span><span class="comment" id="3376282">//&nbsp;&nbsp;&nbsp;&nbspContentLength</span><br>
<span class="lineno">345</span><span class="comment" id="3376299">//&nbsp;&nbsp;&nbsp;&nbspTransferEncoding</span><br>
<span class="lineno"></span><span class="comment" id="3376319">//&nbsp;&nbsp;&nbsp;&nbspBody</span><br>
<span class="lineno"></span><span class="comment" id="3376327">//</span><br>
<span class="lineno"></span><span class="comment" id="3376330">//&nbsp;If&nbsp;Body&nbsp;is&nbsp;present,&nbsp;Content-Length&nbsp;is&nbsp;&lt;=&nbsp;0&nbsp;and&nbsp;TransferEncoding</span><br>
<span class="lineno"></span><span class="comment" id="3376397">//&nbsp;hasn&#39;t&nbsp;been&nbsp;set&nbsp;to&nbsp;&#34;identity&#34;,&nbsp;Write&nbsp;adds&nbsp;&#34;Transfer-Encoding:</span><br>
<span class="lineno">350</span><span class="comment" id="3376462">//&nbsp;chunked&#34;&nbsp;to&nbsp;the&nbsp;header.&nbsp;Body&nbsp;is&nbsp;closed&nbsp;after&nbsp;it&nbsp;is&nbsp;sent.</span><br>
<span class="lineno"></span><span class="keyword" id="3376522">func</span>&nbsp;<span class="op" id="3376527">(</span><span class="ident" id="3376528">r</span>&nbsp;<span class="op" id="3376530">*</span><span class="ident" id="3376531"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3376538">)</span>&nbsp;<span class="ident" id="3376540">Write</span><span class="op" id="3376545">(</span><span class="ident" id="3376546">w</span>&nbsp;<span class="ident" id="3376548"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3376550">.</span><span class="ident" id="3376551">Writer</span><span class="op" id="3376557">)</span>&nbsp;<span class="builtintype" id="3376559">error</span>&nbsp;<span class="op" id="3376565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3376568">return</span>&nbsp;<span class="ident" id="3376575"><a href="/net/http/request.go.html#3376528">r</a></span><span class="op" id="3376576">.</span><span class="ident" id="3376577">write</span><span class="op" id="3376582">(</span><span class="ident" id="3376583"><a href="/net/http/request.go.html#3376546">w</a></span><span class="op" id="3376584">,</span>&nbsp;<span class="builtintype" id="3376586">false</span><span class="op" id="3376591">,</span>&nbsp;<span class="ident" id="3376593">nil</span><span class="op" id="3376596">)</span><br>
<span class="lineno"></span><span class="op" id="3376598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3376601">//&nbsp;WriteProxy&nbsp;is&nbsp;like&nbsp;Write&nbsp;but&nbsp;writes&nbsp;the&nbsp;request&nbsp;in&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="3376664">//&nbsp;expected&nbsp;by&nbsp;an&nbsp;HTTP&nbsp;proxy.&nbsp;&nbsp;In&nbsp;particular,&nbsp;WriteProxy&nbsp;writes&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3376732">//&nbsp;initial&nbsp;Request-URI&nbsp;line&nbsp;of&nbsp;the&nbsp;request&nbsp;with&nbsp;an&nbsp;absolute&nbsp;URI,&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="3376801">//&nbsp;section&nbsp;5.1.2&nbsp;of&nbsp;RFC&nbsp;2616,&nbsp;including&nbsp;the&nbsp;scheme&nbsp;and&nbsp;host.</span><br>
<span class="lineno"></span><span class="comment" id="3376862">//&nbsp;In&nbsp;either&nbsp;case,&nbsp;WriteProxy&nbsp;also&nbsp;writes&nbsp;a&nbsp;Host&nbsp;header,&nbsp;using</span><br>
<span class="lineno">360</span><span class="comment" id="3376925">//&nbsp;either&nbsp;r.Host&nbsp;or&nbsp;r.URL.Host.</span><br>
<span class="lineno"></span><span class="keyword" id="3376957">func</span>&nbsp;<span class="op" id="3376962">(</span><span class="ident" id="3376963">r</span>&nbsp;<span class="op" id="3376965">*</span><span class="ident" id="3376966"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3376973">)</span>&nbsp;<span class="ident" id="3376975">WriteProxy</span><span class="op" id="3376985">(</span><span class="ident" id="3376986">w</span>&nbsp;<span class="ident" id="3376988"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3376990">.</span><span class="ident" id="3376991">Writer</span><span class="op" id="3376997">)</span>&nbsp;<span class="builtintype" id="3376999">error</span>&nbsp;<span class="op" id="3377005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377008">return</span>&nbsp;<span class="ident" id="3377015"><a href="/net/http/request.go.html#3376963">r</a></span><span class="op" id="3377016">.</span><span class="ident" id="3377017">write</span><span class="op" id="3377022">(</span><span class="ident" id="3377023"><a href="/net/http/request.go.html#3376986">w</a></span><span class="op" id="3377024">,</span>&nbsp;<span class="builtintype" id="3377026">true</span><span class="op" id="3377030">,</span>&nbsp;<span class="ident" id="3377032">nil</span><span class="op" id="3377035">)</span><br>
<span class="lineno"></span><span class="op" id="3377037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3377040">//&nbsp;extraHeaders&nbsp;may&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span><span class="keyword" id="3377067">func</span>&nbsp;<span class="op" id="3377072">(</span><span class="ident" id="3377073">req</span>&nbsp;<span class="op" id="3377077">*</span><span class="ident" id="3377078"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3377085">)</span>&nbsp;<span class="ident" id="3377087">write</span><span class="op" id="3377092">(</span><span class="ident" id="3377093">w</span>&nbsp;<span class="ident" id="3377095"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3377097">.</span><span class="ident" id="3377098">Writer</span><span class="op" id="3377104">,</span>&nbsp;<span class="ident" id="3377106">usingProxy</span>&nbsp;<span class="builtintype" id="3377117">bool</span><span class="op" id="3377121">,</span>&nbsp;<span class="ident" id="3377123">extraHeaders</span>&nbsp;<span class="ident" id="3377136"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3377142">)</span>&nbsp;<span class="builtintype" id="3377144">error</span>&nbsp;<span class="op" id="3377150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377153">host</span>&nbsp;<span class="op" id="3377158">:=</span>&nbsp;<span class="ident" id="3377161"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377164">.</span><span class="ident" id="3377165">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377171">if</span>&nbsp;<span class="ident" id="3377174"><a href="/net/http/request.go.html#3377153">host</a></span>&nbsp;<span class="op" id="3377179">==</span>&nbsp;<span class="string" id="3377182">&#34;&#34;</span>&nbsp;<span class="op" id="3377185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377189">if</span>&nbsp;<span class="ident" id="3377192"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377195">.</span><span class="ident" id="3377196">URL</span>&nbsp;<span class="op" id="3377200">==</span>&nbsp;<span class="ident" id="3377203">nil</span>&nbsp;<span class="op" id="3377207">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377212">return</span>&nbsp;<span class="ident" id="3377219"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3377225">.</span><span class="ident" id="3377226">New</span><span class="op" id="3377229">(</span><span class="string" id="3377230">&#34;http:&nbsp;Request.Write&nbsp;on&nbsp;Request&nbsp;with&nbsp;no&nbsp;Host&nbsp;or&nbsp;URL&nbsp;set&#34;</span><span class="op" id="3377286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3377290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377294"><a href="/net/http/request.go.html#3377153">host</a></span>&nbsp;<span class="op" id="3377299">=</span>&nbsp;<span class="ident" id="3377301"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377304">.</span><span class="ident" id="3377305">URL</span><span class="op" id="3377308">.</span><span class="ident" id="3377309">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3377315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377319">ruri</span>&nbsp;<span class="op" id="3377324">:=</span>&nbsp;<span class="ident" id="3377327"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377330">.</span><span class="ident" id="3377331">URL</span><span class="op" id="3377334">.</span><span class="ident" id="3377335">RequestURI</span><span class="op" id="3377345">(</span><span class="op" id="3377346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377349">if</span>&nbsp;<span class="ident" id="3377352"><a href="/net/http/request.go.html#3377106">usingProxy</a></span>&nbsp;<span class="op" id="3377363">&amp;&amp;</span>&nbsp;<span class="ident" id="3377366"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377369">.</span><span class="ident" id="3377370">URL</span><span class="op" id="3377373">.</span><span class="ident" id="3377374">Scheme</span>&nbsp;<span class="op" id="3377381">!=</span>&nbsp;<span class="string" id="3377384">&#34;&#34;</span>&nbsp;<span class="op" id="3377387">&amp;&amp;</span>&nbsp;<span class="ident" id="3377390"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377393">.</span><span class="ident" id="3377394">URL</span><span class="op" id="3377397">.</span><span class="ident" id="3377398">Opaque</span>&nbsp;<span class="op" id="3377405">==</span>&nbsp;<span class="string" id="3377408">&#34;&#34;</span>&nbsp;<span class="op" id="3377411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377415"><a href="/net/http/request.go.html#3377319">ruri</a></span>&nbsp;<span class="op" id="3377420">=</span>&nbsp;<span class="ident" id="3377422"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377425">.</span><span class="ident" id="3377426">URL</span><span class="op" id="3377429">.</span><span class="ident" id="3377430">Scheme</span>&nbsp;<span class="op" id="3377437">+</span>&nbsp;<span class="string" id="3377439">&#34;://&#34;</span>&nbsp;<span class="op" id="3377445">+</span>&nbsp;<span class="ident" id="3377447"><a href="/net/http/request.go.html#3377153">host</a></span>&nbsp;<span class="op" id="3377452">+</span>&nbsp;<span class="ident" id="3377454"><a href="/net/http/request.go.html#3377319">ruri</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3377460">}</span>&nbsp;<span class="keyword" id="3377462">else</span>&nbsp;<span class="keyword" id="3377467">if</span>&nbsp;<span class="ident" id="3377470"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377473">.</span><span class="ident" id="3377474">Method</span>&nbsp;<span class="op" id="3377481">==</span>&nbsp;<span class="string" id="3377484">&#34;CONNECT&#34;</span>&nbsp;<span class="op" id="3377494">&amp;&amp;</span>&nbsp;<span class="ident" id="3377497"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3377500">.</span><span class="ident" id="3377501">URL</span><span class="op" id="3377504">.</span><span class="ident" id="3377505">Path</span>&nbsp;<span class="op" id="3377510">==</span>&nbsp;<span class="string" id="3377513">&#34;&#34;</span>&nbsp;<span class="op" id="3377516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377520">//&nbsp;CONNECT&nbsp;requests&nbsp;normally&nbsp;give&nbsp;just&nbsp;the&nbsp;host&nbsp;and&nbsp;port,&nbsp;not&nbsp;a&nbsp;full&nbsp;URL.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377596"><a href="/net/http/request.go.html#3377319">ruri</a></span>&nbsp;<span class="op" id="3377601">=</span>&nbsp;<span class="ident" id="3377603"><a href="/net/http/request.go.html#3377153">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3377609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377612">//&nbsp;TODO(bradfitz):&nbsp;escape&nbsp;at&nbsp;least&nbsp;newlines&nbsp;in&nbsp;ruri?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377667">//&nbsp;Wrap&nbsp;the&nbsp;writer&nbsp;in&nbsp;a&nbsp;bufio&nbsp;Writer&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;already&nbsp;buffered.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377735">//&nbsp;Don&#39;t&nbsp;always&nbsp;call&nbsp;NewWriter,&nbsp;as&nbsp;that&nbsp;forces&nbsp;a&nbsp;bytes.Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377798">//&nbsp;and&nbsp;other&nbsp;small&nbsp;bufio&nbsp;Writers&nbsp;to&nbsp;have&nbsp;a&nbsp;minimum&nbsp;4k&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3377860">//&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377870">var</span>&nbsp;<span class="ident" id="3377874">bw</span>&nbsp;<span class="op" id="3377877">*</span><span class="ident" id="3377878"><a href="/net/http/request.go.html#3364552">bufio</a></span><span class="op" id="3377883">.</span><span class="ident" id="3377884">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3377892">if</span>&nbsp;<span class="ident" id="3377895">_</span><span class="op" id="3377896">,</span>&nbsp;<span class="ident" id="3377898">ok</span>&nbsp;<span class="op" id="3377901">:=</span>&nbsp;<span class="ident" id="3377904"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3377905">.</span><span class="op" id="3377906">(</span><span class="ident" id="3377907"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3377909">.</span><span class="ident" id="3377910">ByteWriter</span><span class="op" id="3377920">)</span><span class="op" id="3377921">;</span>&nbsp;<span class="op" id="3377923">!</span><span class="ident" id="3377924"><a href="/net/http/request.go.html#3377898">ok</a></span>&nbsp;<span class="op" id="3377927">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377931"><a href="/net/http/request.go.html#3377874">bw</a></span>&nbsp;<span class="op" id="3377934">=</span>&nbsp;<span class="ident" id="3377936"><a href="/net/http/request.go.html#3364552">bufio</a></span><span class="op" id="3377941">.</span><span class="ident" id="3377942">NewWriter</span><span class="op" id="3377951">(</span><span class="ident" id="3377952"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3377953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377957"><a href="/net/http/request.go.html#3377093">w</a></span>&nbsp;<span class="op" id="3377959">=</span>&nbsp;<span class="ident" id="3377961"><a href="/net/http/request.go.html#3377874">bw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3377965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3377969">_</span><span class="op" id="3377970">,</span>&nbsp;<span class="ident" id="3377972">err</span>&nbsp;<span class="op" id="3377976">:=</span>&nbsp;<span class="ident" id="3377979"><a href="/net/http/request.go.html#3364613">fmt</a></span><span class="op" id="3377982">.</span><span class="ident" id="3377983">Fprintf</span><span class="op" id="3377990">(</span><span class="ident" id="3377991"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3377992">,</span>&nbsp;<span class="string" id="3377994">&#34;%s&nbsp;%s&nbsp;HTTP/1.1\r\n&#34;</span><span class="op" id="3378014">,</span>&nbsp;<span class="ident" id="3378016"><a href="/net/http/request.go.html#3375626">valueOrDefault</a></span><span class="op" id="3378030">(</span><span class="ident" id="3378031"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3378034">.</span><span class="ident" id="3378035">Method</span><span class="op" id="3378041">,</span>&nbsp;<span class="string" id="3378043">&#34;GET&#34;</span><span class="op" id="3378048">)</span><span class="op" id="3378049">,</span>&nbsp;<span class="ident" id="3378051"><a href="/net/http/request.go.html#3377319">ruri</a></span><span class="op" id="3378055">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378058">if</span>&nbsp;<span class="ident" id="3378061"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378065">!=</span>&nbsp;<span class="ident" id="3378068">nil</span>&nbsp;<span class="op" id="3378072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378076">return</span>&nbsp;<span class="ident" id="3378083"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3378092">//&nbsp;Header&nbsp;lines</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378109">_</span><span class="op" id="3378110">,</span>&nbsp;<span class="ident" id="3378112"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378116">=</span>&nbsp;<span class="ident" id="3378118"><a href="/net/http/request.go.html#3364613">fmt</a></span><span class="op" id="3378121">.</span><span class="ident" id="3378122">Fprintf</span><span class="op" id="3378129">(</span><span class="ident" id="3378130"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378131">,</span>&nbsp;<span class="string" id="3378133">&#34;Host:&nbsp;%s\r\n&#34;</span><span class="op" id="3378147">,</span>&nbsp;<span class="ident" id="3378149"><a href="/net/http/request.go.html#3377153">host</a></span><span class="op" id="3378153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378156">if</span>&nbsp;<span class="ident" id="3378159"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378163">!=</span>&nbsp;<span class="ident" id="3378166">nil</span>&nbsp;<span class="op" id="3378170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378174">return</span>&nbsp;<span class="ident" id="3378181"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3378190">//&nbsp;Use&nbsp;the&nbsp;defaultUserAgent&nbsp;unless&nbsp;the&nbsp;Header&nbsp;contains&nbsp;one,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3378257">//&nbsp;may&nbsp;be&nbsp;blank&nbsp;to&nbsp;not&nbsp;send&nbsp;the&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378298">userAgent</span>&nbsp;<span class="op" id="3378308">:=</span>&nbsp;<span class="ident" id="3378311"><a href="/net/http/request.go.html#3376050">defaultUserAgent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378329">if</span>&nbsp;<span class="ident" id="3378332"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3378335">.</span><span class="ident" id="3378336">Header</span>&nbsp;<span class="op" id="3378343">!=</span>&nbsp;<span class="ident" id="3378346">nil</span>&nbsp;<span class="op" id="3378350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378354">if</span>&nbsp;<span class="ident" id="3378357">ua</span>&nbsp;<span class="op" id="3378360">:=</span>&nbsp;<span class="ident" id="3378363"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3378366">.</span><span class="ident" id="3378367">Header</span><span class="op" id="3378373">[</span><span class="string" id="3378374">&#34;User-Agent&#34;</span><span class="op" id="3378386">]</span><span class="op" id="3378387">;</span>&nbsp;<span class="builtinfunc" id="3378389">len</span><span class="op" id="3378392">(</span><span class="ident" id="3378393"><a href="/net/http/request.go.html#3378357">ua</a></span><span class="op" id="3378395">)</span>&nbsp;<span class="op" id="3378397">&gt;</span>&nbsp;<span class="num" id="3378399">0</span>&nbsp;<span class="op" id="3378401">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378406"><a href="/net/http/request.go.html#3378298">userAgent</a></span>&nbsp;<span class="op" id="3378416">=</span>&nbsp;<span class="ident" id="3378418"><a href="/net/http/request.go.html#3378357">ua</a></span><span class="op" id="3378420">[</span><span class="num" id="3378421">0</span><span class="op" id="3378422">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378432">if</span>&nbsp;<span class="ident" id="3378435"><a href="/net/http/request.go.html#3378298">userAgent</a></span>&nbsp;<span class="op" id="3378445">!=</span>&nbsp;<span class="string" id="3378448">&#34;&#34;</span>&nbsp;<span class="op" id="3378451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378455">_</span><span class="op" id="3378456">,</span>&nbsp;<span class="ident" id="3378458"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378462">=</span>&nbsp;<span class="ident" id="3378464"><a href="/net/http/request.go.html#3364613">fmt</a></span><span class="op" id="3378467">.</span><span class="ident" id="3378468">Fprintf</span><span class="op" id="3378475">(</span><span class="ident" id="3378476"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378477">,</span>&nbsp;<span class="string" id="3378479">&#34;User-Agent:&nbsp;%s\r\n&#34;</span><span class="op" id="3378499">,</span>&nbsp;<span class="ident" id="3378501"><a href="/net/http/request.go.html#3378298">userAgent</a></span><span class="op" id="3378510">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378514">if</span>&nbsp;<span class="ident" id="3378517"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378521">!=</span>&nbsp;<span class="ident" id="3378524">nil</span>&nbsp;<span class="op" id="3378528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378533">return</span>&nbsp;<span class="ident" id="3378540"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3378553">//&nbsp;Process&nbsp;Body,ContentLength,Close,Trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378598">tw</span><span class="op" id="3378600">,</span>&nbsp;<span class="ident" id="3378602"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378606">:=</span>&nbsp;<span class="ident" id="3378609"><a href="/net/http/transfer.go.html#3472205">newTransferWriter</a></span><span class="op" id="3378626">(</span><span class="ident" id="3378627"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3378630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378633">if</span>&nbsp;<span class="ident" id="3378636"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378640">!=</span>&nbsp;<span class="ident" id="3378643">nil</span>&nbsp;<span class="op" id="3378647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378651">return</span>&nbsp;<span class="ident" id="3378658"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378663">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378666"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378670">=</span>&nbsp;<span class="ident" id="3378672"><a href="/net/http/request.go.html#3378598">tw</a></span><span class="op" id="3378674">.</span><span class="ident" id="3378675">WriteHeader</span><span class="op" id="3378686">(</span><span class="ident" id="3378687"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378691">if</span>&nbsp;<span class="ident" id="3378694"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378698">!=</span>&nbsp;<span class="ident" id="3378701">nil</span>&nbsp;<span class="op" id="3378705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378709">return</span>&nbsp;<span class="ident" id="3378716"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378725"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378729">=</span>&nbsp;<span class="ident" id="3378731"><a href="/net/http/request.go.html#3377073">req</a></span><span class="op" id="3378734">.</span><span class="ident" id="3378735">Header</span><span class="op" id="3378741">.</span><span class="ident" id="3378742">WriteSubset</span><span class="op" id="3378753">(</span><span class="ident" id="3378754"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378755">,</span>&nbsp;<span class="ident" id="3378757"><a href="/net/http/request.go.html#3365993">reqWriteExcludeHeader</a></span><span class="op" id="3378778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378781">if</span>&nbsp;<span class="ident" id="3378784"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378788">!=</span>&nbsp;<span class="ident" id="3378791">nil</span>&nbsp;<span class="op" id="3378795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378799">return</span>&nbsp;<span class="ident" id="3378806"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378815">if</span>&nbsp;<span class="ident" id="3378818"><a href="/net/http/request.go.html#3377123">extraHeaders</a></span>&nbsp;<span class="op" id="3378831">!=</span>&nbsp;<span class="ident" id="3378834">nil</span>&nbsp;<span class="op" id="3378838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378842"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378846">=</span>&nbsp;<span class="ident" id="3378848"><a href="/net/http/request.go.html#3377123">extraHeaders</a></span><span class="op" id="3378860">.</span><span class="ident" id="3378861">Write</span><span class="op" id="3378866">(</span><span class="ident" id="3378867"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378872">if</span>&nbsp;<span class="ident" id="3378875"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378879">!=</span>&nbsp;<span class="ident" id="3378882">nil</span>&nbsp;<span class="op" id="3378886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378891">return</span>&nbsp;<span class="ident" id="3378898"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378904">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3378911">_</span><span class="op" id="3378912">,</span>&nbsp;<span class="ident" id="3378914"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378918">=</span>&nbsp;<span class="ident" id="3378920"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3378922">.</span><span class="ident" id="3378923">WriteString</span><span class="op" id="3378934">(</span><span class="ident" id="3378935"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3378936">,</span>&nbsp;<span class="string" id="3378938">&#34;\r\n&#34;</span><span class="op" id="3378944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378947">if</span>&nbsp;<span class="ident" id="3378950"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3378954">!=</span>&nbsp;<span class="ident" id="3378957">nil</span>&nbsp;<span class="op" id="3378961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3378965">return</span>&nbsp;<span class="ident" id="3378972"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3378977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3378981">//&nbsp;Write&nbsp;body&nbsp;and&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3379008"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3379012">=</span>&nbsp;<span class="ident" id="3379014"><a href="/net/http/request.go.html#3378598">tw</a></span><span class="op" id="3379016">.</span><span class="ident" id="3379017">WriteBody</span><span class="op" id="3379026">(</span><span class="ident" id="3379027"><a href="/net/http/request.go.html#3377093">w</a></span><span class="op" id="3379028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379031">if</span>&nbsp;<span class="ident" id="3379034"><a href="/net/http/request.go.html#3377972">err</a></span>&nbsp;<span class="op" id="3379038">!=</span>&nbsp;<span class="ident" id="3379041">nil</span>&nbsp;<span class="op" id="3379045">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379049">return</span>&nbsp;<span class="ident" id="3379056"><a href="/net/http/request.go.html#3377972">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379065">if</span>&nbsp;<span class="ident" id="3379068"><a href="/net/http/request.go.html#3377874">bw</a></span>&nbsp;<span class="op" id="3379071">!=</span>&nbsp;<span class="ident" id="3379074">nil</span>&nbsp;<span class="op" id="3379078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379082">return</span>&nbsp;<span class="ident" id="3379089"><a href="/net/http/request.go.html#3377874">bw</a></span><span class="op" id="3379091">.</span><span class="ident" id="3379092">Flush</span><span class="op" id="3379097">(</span><span class="op" id="3379098">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379104">return</span>&nbsp;<span class="ident" id="3379111">nil</span><br>
<span class="lineno"></span><span class="op" id="3379115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3379118">//&nbsp;ParseHTTPVersion&nbsp;parses&nbsp;a&nbsp;HTTP&nbsp;version&nbsp;string.</span><br>
<span class="lineno">460</span><span class="comment" id="3379168">//&nbsp;&#34;HTTP/1.0&#34;&nbsp;returns&nbsp;(1,&nbsp;0,&nbsp;true).</span><br>
<span class="lineno"></span><span class="keyword" id="3379204">func</span>&nbsp;<span class="ident" id="3379209">ParseHTTPVersion</span><span class="op" id="3379225">(</span><span class="ident" id="3379226">vers</span>&nbsp;<span class="builtintype" id="3379231">string</span><span class="op" id="3379237">)</span>&nbsp;<span class="op" id="3379239">(</span><span class="ident" id="3379240">major</span><span class="op" id="3379245">,</span>&nbsp;<span class="ident" id="3379247">minor</span>&nbsp;<span class="builtintype" id="3379253">int</span><span class="op" id="3379256">,</span>&nbsp;<span class="ident" id="3379258">ok</span>&nbsp;<span class="builtintype" id="3379261">bool</span><span class="op" id="3379265">)</span>&nbsp;<span class="op" id="3379267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379270">const</span>&nbsp;<span class="ident" id="3379276">Big</span>&nbsp;<span class="op" id="3379280">=</span>&nbsp;<span class="num" id="3379282">1000000</span>&nbsp;<span class="comment" id="3379290">//&nbsp;arbitrary&nbsp;upper&nbsp;bound</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379316">switch</span>&nbsp;<span class="ident" id="3379323"><a href="/net/http/request.go.html#3379226">vers</a></span>&nbsp;<span class="op" id="3379328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379331">case</span>&nbsp;<span class="string" id="3379336">&#34;HTTP/1.1&#34;</span><span class="op" id="3379346">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379350">return</span>&nbsp;<span class="num" id="3379357">1</span><span class="op" id="3379358">,</span>&nbsp;<span class="num" id="3379360">1</span><span class="op" id="3379361">,</span>&nbsp;<span class="builtintype" id="3379363">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379369">case</span>&nbsp;<span class="string" id="3379374">&#34;HTTP/1.0&#34;</span><span class="op" id="3379384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379388">return</span>&nbsp;<span class="num" id="3379395">1</span><span class="op" id="3379396">,</span>&nbsp;<span class="num" id="3379398">0</span><span class="op" id="3379399">,</span>&nbsp;<span class="builtintype" id="3379401">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379410">if</span>&nbsp;<span class="op" id="3379413">!</span><span class="ident" id="3379414"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3379421">.</span><span class="ident" id="3379422">HasPrefix</span><span class="op" id="3379431">(</span><span class="ident" id="3379432"><a href="/net/http/request.go.html#3379226">vers</a></span><span class="op" id="3379436">,</span>&nbsp;<span class="string" id="3379438">&#34;HTTP/&#34;</span><span class="op" id="3379445">)</span>&nbsp;<span class="op" id="3379447">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379451">return</span>&nbsp;<span class="num" id="3379458">0</span><span class="op" id="3379459">,</span>&nbsp;<span class="num" id="3379461">0</span><span class="op" id="3379462">,</span>&nbsp;<span class="builtintype" id="3379464">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3379474">dot</span>&nbsp;<span class="op" id="3379478">:=</span>&nbsp;<span class="ident" id="3379481"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3379488">.</span><span class="ident" id="3379489">Index</span><span class="op" id="3379494">(</span><span class="ident" id="3379495"><a href="/net/http/request.go.html#3379226">vers</a></span><span class="op" id="3379499">,</span>&nbsp;<span class="string" id="3379501">&#34;.&#34;</span><span class="op" id="3379504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379507">if</span>&nbsp;<span class="ident" id="3379510"><a href="/net/http/request.go.html#3379474">dot</a></span>&nbsp;<span class="op" id="3379514">&lt;</span>&nbsp;<span class="num" id="3379516">0</span>&nbsp;<span class="op" id="3379518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379522">return</span>&nbsp;<span class="num" id="3379529">0</span><span class="op" id="3379530">,</span>&nbsp;<span class="num" id="3379532">0</span><span class="op" id="3379533">,</span>&nbsp;<span class="builtintype" id="3379535">false</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3379545"><a href="/net/http/request.go.html#3379240">major</a></span><span class="op" id="3379550">,</span>&nbsp;<span class="ident" id="3379552">err</span>&nbsp;<span class="op" id="3379556">:=</span>&nbsp;<span class="ident" id="3379559"><a href="/net/http/request.go.html#3364693">strconv</a></span><span class="op" id="3379566">.</span><span class="ident" id="3379567">Atoi</span><span class="op" id="3379571">(</span><span class="ident" id="3379572"><a href="/net/http/request.go.html#3379226">vers</a></span><span class="op" id="3379576">[</span><span class="num" id="3379577">5</span><span class="op" id="3379578">:</span><span class="ident" id="3379579"><a href="/net/http/request.go.html#3379474">dot</a></span><span class="op" id="3379582">]</span><span class="op" id="3379583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379586">if</span>&nbsp;<span class="ident" id="3379589"><a href="/net/http/request.go.html#3379552">err</a></span>&nbsp;<span class="op" id="3379593">!=</span>&nbsp;<span class="ident" id="3379596">nil</span>&nbsp;<span class="op" id="3379600">||</span>&nbsp;<span class="ident" id="3379603"><a href="/net/http/request.go.html#3379240">major</a></span>&nbsp;<span class="op" id="3379609">&lt;</span>&nbsp;<span class="num" id="3379611">0</span>&nbsp;<span class="op" id="3379613">||</span>&nbsp;<span class="ident" id="3379616"><a href="/net/http/request.go.html#3379240">major</a></span>&nbsp;<span class="op" id="3379622">&gt;</span>&nbsp;<span class="ident" id="3379624"><a href="/net/http/request.go.html#3379276">Big</a></span>&nbsp;<span class="op" id="3379628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379632">return</span>&nbsp;<span class="num" id="3379639">0</span><span class="op" id="3379640">,</span>&nbsp;<span class="num" id="3379642">0</span><span class="op" id="3379643">,</span>&nbsp;<span class="builtintype" id="3379645">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379652">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3379655"><a href="/net/http/request.go.html#3379247">minor</a></span><span class="op" id="3379660">,</span>&nbsp;<span class="ident" id="3379662"><a href="/net/http/request.go.html#3379552">err</a></span>&nbsp;<span class="op" id="3379666">=</span>&nbsp;<span class="ident" id="3379668"><a href="/net/http/request.go.html#3364693">strconv</a></span><span class="op" id="3379675">.</span><span class="ident" id="3379676">Atoi</span><span class="op" id="3379680">(</span><span class="ident" id="3379681"><a href="/net/http/request.go.html#3379226">vers</a></span><span class="op" id="3379685">[</span><span class="ident" id="3379686"><a href="/net/http/request.go.html#3379474">dot</a></span><span class="op" id="3379689">+</span><span class="num" id="3379690">1</span><span class="op" id="3379691">:</span><span class="op" id="3379692">]</span><span class="op" id="3379693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379696">if</span>&nbsp;<span class="ident" id="3379699"><a href="/net/http/request.go.html#3379552">err</a></span>&nbsp;<span class="op" id="3379703">!=</span>&nbsp;<span class="ident" id="3379706">nil</span>&nbsp;<span class="op" id="3379710">||</span>&nbsp;<span class="ident" id="3379713"><a href="/net/http/request.go.html#3379247">minor</a></span>&nbsp;<span class="op" id="3379719">&lt;</span>&nbsp;<span class="num" id="3379721">0</span>&nbsp;<span class="op" id="3379723">||</span>&nbsp;<span class="ident" id="3379726"><a href="/net/http/request.go.html#3379247">minor</a></span>&nbsp;<span class="op" id="3379732">&gt;</span>&nbsp;<span class="ident" id="3379734"><a href="/net/http/request.go.html#3379276">Big</a></span>&nbsp;<span class="op" id="3379738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379742">return</span>&nbsp;<span class="num" id="3379749">0</span><span class="op" id="3379750">,</span>&nbsp;<span class="num" id="3379752">0</span><span class="op" id="3379753">,</span>&nbsp;<span class="builtintype" id="3379755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3379762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3379765">return</span>&nbsp;<span class="ident" id="3379772"><a href="/net/http/request.go.html#3379240">major</a></span><span class="op" id="3379777">,</span>&nbsp;<span class="ident" id="3379779"><a href="/net/http/request.go.html#3379247">minor</a></span><span class="op" id="3379784">,</span>&nbsp;<span class="builtintype" id="3379786">true</span><br>
<span class="lineno">485</span><span class="op" id="3379791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3379794">//&nbsp;NewRequest&nbsp;returns&nbsp;a&nbsp;new&nbsp;Request&nbsp;given&nbsp;a&nbsp;method,&nbsp;URL,&nbsp;and&nbsp;optional&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3379870">//</span><br>
<span class="lineno"></span><span class="comment" id="3379873">//&nbsp;If&nbsp;the&nbsp;provided&nbsp;body&nbsp;is&nbsp;also&nbsp;an&nbsp;io.Closer,&nbsp;the&nbsp;returned</span><br>
<span class="lineno">490</span><span class="comment" id="3379932">//&nbsp;Request.Body&nbsp;is&nbsp;set&nbsp;to&nbsp;body&nbsp;and&nbsp;will&nbsp;be&nbsp;closed&nbsp;by&nbsp;the&nbsp;Client</span><br>
<span class="lineno"></span><span class="comment" id="3379996">//&nbsp;methods&nbsp;Do,&nbsp;Post,&nbsp;and&nbsp;PostForm,&nbsp;and&nbsp;Transport.RoundTrip.</span><br>
<span class="lineno"></span><span class="keyword" id="3380056">func</span>&nbsp;<span class="ident" id="3380061">NewRequest</span><span class="op" id="3380071">(</span><span class="ident" id="3380072">method</span><span class="op" id="3380078">,</span>&nbsp;<span class="ident" id="3380080">urlStr</span>&nbsp;<span class="builtintype" id="3380087">string</span><span class="op" id="3380093">,</span>&nbsp;<span class="ident" id="3380095">body</span>&nbsp;<span class="ident" id="3380100"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3380102">.</span><span class="ident" id="3380103">Reader</span><span class="op" id="3380109">)</span>&nbsp;<span class="op" id="3380111">(</span><span class="op" id="3380112">*</span><span class="ident" id="3380113"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3380120">,</span>&nbsp;<span class="builtintype" id="3380122">error</span><span class="op" id="3380127">)</span>&nbsp;<span class="op" id="3380129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380132">u</span><span class="op" id="3380133">,</span>&nbsp;<span class="ident" id="3380135">err</span>&nbsp;<span class="op" id="3380139">:=</span>&nbsp;<span class="ident" id="3380142"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3380145">.</span><span class="ident" id="3380146">Parse</span><span class="op" id="3380151">(</span><span class="ident" id="3380152"><a href="/net/http/request.go.html#3380080">urlStr</a></span><span class="op" id="3380158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380161">if</span>&nbsp;<span class="ident" id="3380164"><a href="/net/http/request.go.html#3380135">err</a></span>&nbsp;<span class="op" id="3380168">!=</span>&nbsp;<span class="ident" id="3380171">nil</span>&nbsp;<span class="op" id="3380175">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380179">return</span>&nbsp;<span class="ident" id="3380186">nil</span><span class="op" id="3380189">,</span>&nbsp;<span class="ident" id="3380191"><a href="/net/http/request.go.html#3380135">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3380196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380199">rc</span><span class="op" id="3380201">,</span>&nbsp;<span class="ident" id="3380203">ok</span>&nbsp;<span class="op" id="3380206">:=</span>&nbsp;<span class="ident" id="3380209"><a href="/net/http/request.go.html#3380095">body</a></span><span class="op" id="3380213">.</span><span class="op" id="3380214">(</span><span class="ident" id="3380215"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3380217">.</span><span class="ident" id="3380218">ReadCloser</span><span class="op" id="3380228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380231">if</span>&nbsp;<span class="op" id="3380234">!</span><span class="ident" id="3380235"><a href="/net/http/request.go.html#3380203">ok</a></span>&nbsp;<span class="op" id="3380238">&amp;&amp;</span>&nbsp;<span class="ident" id="3380241"><a href="/net/http/request.go.html#3380095">body</a></span>&nbsp;<span class="op" id="3380246">!=</span>&nbsp;<span class="ident" id="3380249">nil</span>&nbsp;<span class="op" id="3380253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380257"><a href="/net/http/request.go.html#3380199">rc</a></span>&nbsp;<span class="op" id="3380260">=</span>&nbsp;<span class="ident" id="3380262"><a href="/net/http/request.go.html#3364626">ioutil</a></span><span class="op" id="3380268">.</span><span class="ident" id="3380269">NopCloser</span><span class="op" id="3380278">(</span><span class="ident" id="3380279"><a href="/net/http/request.go.html#3380095">body</a></span><span class="op" id="3380283">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3380286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380289">req</span>&nbsp;<span class="op" id="3380293">:=</span>&nbsp;<span class="op" id="3380296">&amp;</span><span class="ident" id="3380297"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3380304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380308">Method</span><span class="op" id="3380314">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380320"><a href="/net/http/request.go.html#3380072">method</a></span><span class="op" id="3380326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380330">URL</span><span class="op" id="3380333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380342"><a href="/net/http/request.go.html#3380132">u</a></span><span class="op" id="3380343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380347">Proto</span><span class="op" id="3380352">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3380359">&#34;HTTP/1.1&#34;</span><span class="op" id="3380369">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380373">ProtoMajor</span><span class="op" id="3380383">:</span>&nbsp;<span class="num" id="3380385">1</span><span class="op" id="3380386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380390">ProtoMinor</span><span class="op" id="3380400">:</span>&nbsp;<span class="num" id="3380402">1</span><span class="op" id="3380403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380407">Header</span><span class="op" id="3380413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3380419">make</span><span class="op" id="3380423">(</span><span class="ident" id="3380424"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3380430">)</span><span class="op" id="3380431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380435">Body</span><span class="op" id="3380439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380447"><a href="/net/http/request.go.html#3380199">rc</a></span><span class="op" id="3380449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380453">Host</span><span class="op" id="3380457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380465"><a href="/net/http/request.go.html#3380132">u</a></span><span class="op" id="3380466">.</span><span class="ident" id="3380467">Host</span><span class="op" id="3380471">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3380474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380477">if</span>&nbsp;<span class="ident" id="3380480"><a href="/net/http/request.go.html#3380095">body</a></span>&nbsp;<span class="op" id="3380485">!=</span>&nbsp;<span class="ident" id="3380488">nil</span>&nbsp;<span class="op" id="3380492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380496">switch</span>&nbsp;<span class="ident" id="3380503">v</span>&nbsp;<span class="op" id="3380505">:=</span>&nbsp;<span class="ident" id="3380508"><a href="/net/http/request.go.html#3380095">body</a></span><span class="op" id="3380512">.</span><span class="op" id="3380513">(</span><span class="keyword" id="3380514">type</span><span class="op" id="3380518">)</span>&nbsp;<span class="op" id="3380520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380524">case</span>&nbsp;<span class="op" id="3380529">*</span><span class="ident" id="3380530"><a href="/net/http/request.go.html#3364561">bytes</a></span><span class="op" id="3380535">.</span><span class="ident" id="3380536">Buffer</span><span class="op" id="3380542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380547"><a href="/net/http/request.go.html#3380289">req</a></span><span class="op" id="3380550">.</span><span class="ident" id="3380551">ContentLength</span>&nbsp;<span class="op" id="3380565">=</span>&nbsp;<span class="ident" id="3380567">int64</span><span class="op" id="3380572">(</span><span class="ident" id="3380573"><a href="/net/http/request.go.html#3380503">v</a></span><span class="op" id="3380574">.</span><span class="ident" id="3380575">Len</span><span class="op" id="3380578">(</span><span class="op" id="3380579">)</span><span class="op" id="3380580">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380584">case</span>&nbsp;<span class="op" id="3380589">*</span><span class="ident" id="3380590"><a href="/net/http/request.go.html#3364561">bytes</a></span><span class="op" id="3380595">.</span><span class="ident" id="3380596">Reader</span><span class="op" id="3380602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380607"><a href="/net/http/request.go.html#3380289">req</a></span><span class="op" id="3380610">.</span><span class="ident" id="3380611">ContentLength</span>&nbsp;<span class="op" id="3380625">=</span>&nbsp;<span class="ident" id="3380627">int64</span><span class="op" id="3380632">(</span><span class="ident" id="3380633"><a href="/net/http/request.go.html#3380503">v</a></span><span class="op" id="3380634">.</span><span class="ident" id="3380635">Len</span><span class="op" id="3380638">(</span><span class="op" id="3380639">)</span><span class="op" id="3380640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380644">case</span>&nbsp;<span class="op" id="3380649">*</span><span class="ident" id="3380650"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3380657">.</span><span class="ident" id="3380658">Reader</span><span class="op" id="3380664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380669"><a href="/net/http/request.go.html#3380289">req</a></span><span class="op" id="3380672">.</span><span class="ident" id="3380673">ContentLength</span>&nbsp;<span class="op" id="3380687">=</span>&nbsp;<span class="ident" id="3380689">int64</span><span class="op" id="3380694">(</span><span class="ident" id="3380695"><a href="/net/http/request.go.html#3380503">v</a></span><span class="op" id="3380696">.</span><span class="ident" id="3380697">Len</span><span class="op" id="3380700">(</span><span class="op" id="3380701">)</span><span class="op" id="3380702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3380706">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3380709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3380713">return</span>&nbsp;<span class="ident" id="3380720"><a href="/net/http/request.go.html#3380289">req</a></span><span class="op" id="3380723">,</span>&nbsp;<span class="ident" id="3380725">nil</span><br>
<span class="lineno"></span><span class="op" id="3380729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3380732">//&nbsp;BasicAuth&nbsp;returns&nbsp;the&nbsp;username&nbsp;and&nbsp;password&nbsp;provided&nbsp;in&nbsp;the&nbsp;request&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3380805">//&nbsp;Authorization&nbsp;header,&nbsp;if&nbsp;the&nbsp;request&nbsp;uses&nbsp;HTTP&nbsp;Basic&nbsp;Authentication.</span><br>
<span class="lineno"></span><span class="comment" id="3380877">//&nbsp;See&nbsp;RFC&nbsp;2617,&nbsp;Section&nbsp;2.</span><br>
<span class="lineno"></span><span class="keyword" id="3380905">func</span>&nbsp;<span class="op" id="3380910">(</span><span class="ident" id="3380911">r</span>&nbsp;<span class="op" id="3380913">*</span><span class="ident" id="3380914"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3380921">)</span>&nbsp;<span class="ident" id="3380923">BasicAuth</span><span class="op" id="3380932">(</span><span class="op" id="3380933">)</span>&nbsp;<span class="op" id="3380935">(</span><span class="ident" id="3380936">username</span><span class="op" id="3380944">,</span>&nbsp;<span class="ident" id="3380946">password</span>&nbsp;<span class="builtintype" id="3380955">string</span><span class="op" id="3380961">,</span>&nbsp;<span class="ident" id="3380963">ok</span>&nbsp;<span class="builtintype" id="3380966">bool</span><span class="op" id="3380970">)</span>&nbsp;<span class="op" id="3380972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3380975">auth</span>&nbsp;<span class="op" id="3380980">:=</span>&nbsp;<span class="ident" id="3380983"><a href="/net/http/request.go.html#3380911">r</a></span><span class="op" id="3380984">.</span><span class="ident" id="3380985">Header</span><span class="op" id="3380991">.</span><span class="ident" id="3380992">Get</span><span class="op" id="3380995">(</span><span class="string" id="3380996">&#34;Authorization&#34;</span><span class="op" id="3381011">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381014">if</span>&nbsp;<span class="ident" id="3381017"><a href="/net/http/request.go.html#3380975">auth</a></span>&nbsp;<span class="op" id="3381022">==</span>&nbsp;<span class="string" id="3381025">&#34;&#34;</span>&nbsp;<span class="op" id="3381028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3381040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381043">return</span>&nbsp;<span class="ident" id="3381050"><a href="/net/http/request.go.html#3381223">parseBasicAuth</a></span><span class="op" id="3381064">(</span><span class="ident" id="3381065"><a href="/net/http/request.go.html#3380975">auth</a></span><span class="op" id="3381069">)</span><br>
<span class="lineno"></span><span class="op" id="3381071">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="comment" id="3381074">//&nbsp;parseBasicAuth&nbsp;parses&nbsp;an&nbsp;HTTP&nbsp;Basic&nbsp;Authentication&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3381136">//&nbsp;&#34;Basic&nbsp;QWxhZGRpbjpvcGVuIHNlc2FtZQ==&#34;&nbsp;returns&nbsp;(&#34;Aladdin&#34;,&nbsp;&#34;open&nbsp;sesame&#34;,&nbsp;true).</span><br>
<span class="lineno"></span><span class="keyword" id="3381218">func</span>&nbsp;<span class="ident" id="3381223">parseBasicAuth</span><span class="op" id="3381237">(</span><span class="ident" id="3381238">auth</span>&nbsp;<span class="builtintype" id="3381243">string</span><span class="op" id="3381249">)</span>&nbsp;<span class="op" id="3381251">(</span><span class="ident" id="3381252">username</span><span class="op" id="3381260">,</span>&nbsp;<span class="ident" id="3381262">password</span>&nbsp;<span class="builtintype" id="3381271">string</span><span class="op" id="3381277">,</span>&nbsp;<span class="ident" id="3381279">ok</span>&nbsp;<span class="builtintype" id="3381282">bool</span><span class="op" id="3381286">)</span>&nbsp;<span class="op" id="3381288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381291">if</span>&nbsp;<span class="op" id="3381294">!</span><span class="ident" id="3381295"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3381302">.</span><span class="ident" id="3381303">HasPrefix</span><span class="op" id="3381312">(</span><span class="ident" id="3381313"><a href="/net/http/request.go.html#3381238">auth</a></span><span class="op" id="3381317">,</span>&nbsp;<span class="string" id="3381319">&#34;Basic&nbsp;&#34;</span><span class="op" id="3381327">)</span>&nbsp;<span class="op" id="3381329">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381333">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3381341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3381344">c</span><span class="op" id="3381345">,</span>&nbsp;<span class="ident" id="3381347">err</span>&nbsp;<span class="op" id="3381351">:=</span>&nbsp;<span class="ident" id="3381354"><a href="/net/http/request.go.html#3364584">base64</a></span><span class="op" id="3381360">.</span><span class="ident" id="3381361">StdEncoding</span><span class="op" id="3381372">.</span><span class="ident" id="3381373">DecodeString</span><span class="op" id="3381385">(</span><span class="ident" id="3381386"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3381393">.</span><span class="ident" id="3381394">TrimPrefix</span><span class="op" id="3381404">(</span><span class="ident" id="3381405"><a href="/net/http/request.go.html#3381238">auth</a></span><span class="op" id="3381409">,</span>&nbsp;<span class="string" id="3381411">&#34;Basic&nbsp;&#34;</span><span class="op" id="3381419">)</span><span class="op" id="3381420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381423">if</span>&nbsp;<span class="ident" id="3381426"><a href="/net/http/request.go.html#3381347">err</a></span>&nbsp;<span class="op" id="3381430">!=</span>&nbsp;<span class="ident" id="3381433">nil</span>&nbsp;<span class="op" id="3381437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381441">return</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3381449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3381452">cs</span>&nbsp;<span class="op" id="3381455">:=</span>&nbsp;<span class="builtintype" id="3381458">string</span><span class="op" id="3381464">(</span><span class="ident" id="3381465"><a href="/net/http/request.go.html#3381344">c</a></span><span class="op" id="3381466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3381469">s</span>&nbsp;<span class="op" id="3381471">:=</span>&nbsp;<span class="ident" id="3381474"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3381481">.</span><span class="ident" id="3381482">IndexByte</span><span class="op" id="3381491">(</span><span class="ident" id="3381492"><a href="/net/http/request.go.html#3381452">cs</a></span><span class="op" id="3381494">,</span>&nbsp;<span class="string" id="3381496">&#39;:&#39;</span><span class="op" id="3381499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381502">if</span>&nbsp;<span class="ident" id="3381505"><a href="/net/http/request.go.html#3381469">s</a></span>&nbsp;<span class="op" id="3381507">&lt;</span>&nbsp;<span class="num" id="3381509">0</span>&nbsp;<span class="op" id="3381511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381515">return</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3381523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3381526">return</span>&nbsp;<span class="ident" id="3381533"><a href="/net/http/request.go.html#3381452">cs</a></span><span class="op" id="3381535">[</span><span class="op" id="3381536">:</span><span class="ident" id="3381537"><a href="/net/http/request.go.html#3381469">s</a></span><span class="op" id="3381538">]</span><span class="op" id="3381539">,</span>&nbsp;<span class="ident" id="3381541"><a href="/net/http/request.go.html#3381452">cs</a></span><span class="op" id="3381543">[</span><span class="ident" id="3381544"><a href="/net/http/request.go.html#3381469">s</a></span><span class="op" id="3381545">+</span><span class="num" id="3381546">1</span><span class="op" id="3381547">:</span><span class="op" id="3381548">]</span><span class="op" id="3381549">,</span>&nbsp;<span class="builtintype" id="3381551">true</span><br>
<span class="lineno"></span><span class="op" id="3381556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3381559">//&nbsp;SetBasicAuth&nbsp;sets&nbsp;the&nbsp;request&#39;s&nbsp;Authorization&nbsp;header&nbsp;to&nbsp;use&nbsp;HTTP</span><br>
<span class="lineno">555</span><span class="comment" id="3381627">//&nbsp;Basic&nbsp;Authentication&nbsp;with&nbsp;the&nbsp;provided&nbsp;username&nbsp;and&nbsp;password.</span><br>
<span class="lineno"></span><span class="comment" id="3381692">//</span><br>
<span class="lineno"></span><span class="comment" id="3381695">//&nbsp;With&nbsp;HTTP&nbsp;Basic&nbsp;Authentication&nbsp;the&nbsp;provided&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span><span class="comment" id="3381764">//&nbsp;are&nbsp;not&nbsp;encrypted.</span><br>
<span class="lineno"></span><span class="keyword" id="3381786">func</span>&nbsp;<span class="op" id="3381791">(</span><span class="ident" id="3381792">r</span>&nbsp;<span class="op" id="3381794">*</span><span class="ident" id="3381795"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3381802">)</span>&nbsp;<span class="ident" id="3381804">SetBasicAuth</span><span class="op" id="3381816">(</span><span class="ident" id="3381817">username</span><span class="op" id="3381825">,</span>&nbsp;<span class="ident" id="3381827">password</span>&nbsp;<span class="builtintype" id="3381836">string</span><span class="op" id="3381842">)</span>&nbsp;<span class="op" id="3381844">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3381847"><a href="/net/http/request.go.html#3381792">r</a></span><span class="op" id="3381848">.</span><span class="ident" id="3381849">Header</span><span class="op" id="3381855">.</span><span class="ident" id="3381856">Set</span><span class="op" id="3381859">(</span><span class="string" id="3381860">&#34;Authorization&#34;</span><span class="op" id="3381875">,</span>&nbsp;<span class="string" id="3381877">&#34;Basic&nbsp;&#34;</span><span class="op" id="3381885">+</span><span class="ident" id="3381886"><a href="/net/http/client.go.html#3318213">basicAuth</a></span><span class="op" id="3381895">(</span><span class="ident" id="3381896"><a href="/net/http/request.go.html#3381817">username</a></span><span class="op" id="3381904">,</span>&nbsp;<span class="ident" id="3381906"><a href="/net/http/request.go.html#3381827">password</a></span><span class="op" id="3381914">)</span><span class="op" id="3381915">)</span><br>
<span class="lineno"></span><span class="op" id="3381917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3381920">//&nbsp;parseRequestLine&nbsp;parses&nbsp;&#34;GET&nbsp;/foo&nbsp;HTTP/1.1&#34;&nbsp;into&nbsp;its&nbsp;three&nbsp;parts.</span><br>
<span class="lineno"></span><span class="keyword" id="3381989">func</span>&nbsp;<span class="ident" id="3381994">parseRequestLine</span><span class="op" id="3382010">(</span><span class="ident" id="3382011">line</span>&nbsp;<span class="builtintype" id="3382016">string</span><span class="op" id="3382022">)</span>&nbsp;<span class="op" id="3382024">(</span><span class="ident" id="3382025">method</span><span class="op" id="3382031">,</span>&nbsp;<span class="ident" id="3382033">requestURI</span><span class="op" id="3382043">,</span>&nbsp;<span class="ident" id="3382045">proto</span>&nbsp;<span class="builtintype" id="3382051">string</span><span class="op" id="3382057">,</span>&nbsp;<span class="ident" id="3382059">ok</span>&nbsp;<span class="builtintype" id="3382062">bool</span><span class="op" id="3382066">)</span>&nbsp;<span class="op" id="3382068">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382071">s1</span>&nbsp;<span class="op" id="3382074">:=</span>&nbsp;<span class="ident" id="3382077"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3382084">.</span><span class="ident" id="3382085">Index</span><span class="op" id="3382090">(</span><span class="ident" id="3382091"><a href="/net/http/request.go.html#3382011">line</a></span><span class="op" id="3382095">,</span>&nbsp;<span class="string" id="3382097">&#34;&nbsp;&#34;</span><span class="op" id="3382100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382103">s2</span>&nbsp;<span class="op" id="3382106">:=</span>&nbsp;<span class="ident" id="3382109"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3382116">.</span><span class="ident" id="3382117">Index</span><span class="op" id="3382122">(</span><span class="ident" id="3382123"><a href="/net/http/request.go.html#3382011">line</a></span><span class="op" id="3382127">[</span><span class="ident" id="3382128"><a href="/net/http/request.go.html#3382071">s1</a></span><span class="op" id="3382130">+</span><span class="num" id="3382131">1</span><span class="op" id="3382132">:</span><span class="op" id="3382133">]</span><span class="op" id="3382134">,</span>&nbsp;<span class="string" id="3382136">&#34;&nbsp;&#34;</span><span class="op" id="3382139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382142">if</span>&nbsp;<span class="ident" id="3382145"><a href="/net/http/request.go.html#3382071">s1</a></span>&nbsp;<span class="op" id="3382148">&lt;</span>&nbsp;<span class="num" id="3382150">0</span>&nbsp;<span class="op" id="3382152">||</span>&nbsp;<span class="ident" id="3382155"><a href="/net/http/request.go.html#3382103">s2</a></span>&nbsp;<span class="op" id="3382158">&lt;</span>&nbsp;<span class="num" id="3382160">0</span>&nbsp;<span class="op" id="3382162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382166">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3382174">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382177"><a href="/net/http/request.go.html#3382103">s2</a></span>&nbsp;<span class="op" id="3382180">+=</span>&nbsp;<span class="ident" id="3382183"><a href="/net/http/request.go.html#3382071">s1</a></span>&nbsp;<span class="op" id="3382186">+</span>&nbsp;<span class="num" id="3382188">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382191">return</span>&nbsp;<span class="ident" id="3382198"><a href="/net/http/request.go.html#3382011">line</a></span><span class="op" id="3382202">[</span><span class="op" id="3382203">:</span><span class="ident" id="3382204"><a href="/net/http/request.go.html#3382071">s1</a></span><span class="op" id="3382206">]</span><span class="op" id="3382207">,</span>&nbsp;<span class="ident" id="3382209"><a href="/net/http/request.go.html#3382011">line</a></span><span class="op" id="3382213">[</span><span class="ident" id="3382214"><a href="/net/http/request.go.html#3382071">s1</a></span><span class="op" id="3382216">+</span><span class="num" id="3382217">1</span>&nbsp;<span class="op" id="3382219">:</span>&nbsp;<span class="ident" id="3382221"><a href="/net/http/request.go.html#3382103">s2</a></span><span class="op" id="3382223">]</span><span class="op" id="3382224">,</span>&nbsp;<span class="ident" id="3382226"><a href="/net/http/request.go.html#3382011">line</a></span><span class="op" id="3382230">[</span><span class="ident" id="3382231"><a href="/net/http/request.go.html#3382103">s2</a></span><span class="op" id="3382233">+</span><span class="num" id="3382234">1</span><span class="op" id="3382235">:</span><span class="op" id="3382236">]</span><span class="op" id="3382237">,</span>&nbsp;<span class="builtintype" id="3382239">true</span><br>
<span class="lineno"></span><span class="op" id="3382244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3382247">var</span>&nbsp;<span class="ident" id="3382251">textprotoReaderPool</span>&nbsp;<span class="ident" id="3382271"><a href="/net/http/request.go.html#3364715">sync</a></span><span class="op" id="3382275">.</span><span class="ident" id="3382276">Pool</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="keyword" id="3382282">func</span>&nbsp;<span class="ident" id="3382287">newTextprotoReader</span><span class="op" id="3382305">(</span><span class="ident" id="3382306">br</span>&nbsp;<span class="op" id="3382309">*</span><span class="ident" id="3382310"><a href="/net/http/request.go.html#3364552">bufio</a></span><span class="op" id="3382315">.</span><span class="ident" id="3382316">Reader</span><span class="op" id="3382322">)</span>&nbsp;<span class="op" id="3382324">*</span><span class="ident" id="3382325"><a href="/net/http/request.go.html#3364665">textproto</a></span><span class="op" id="3382334">.</span><span class="ident" id="3382335">Reader</span>&nbsp;<span class="op" id="3382342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382345">if</span>&nbsp;<span class="ident" id="3382348">v</span>&nbsp;<span class="op" id="3382350">:=</span>&nbsp;<span class="ident" id="3382353"><a href="/net/http/request.go.html#3382251">textprotoReaderPool</a></span><span class="op" id="3382372">.</span><span class="ident" id="3382373">Get</span><span class="op" id="3382376">(</span><span class="op" id="3382377">)</span><span class="op" id="3382378">;</span>&nbsp;<span class="ident" id="3382380"><a href="/net/http/request.go.html#3382348">v</a></span>&nbsp;<span class="op" id="3382382">!=</span>&nbsp;<span class="ident" id="3382385">nil</span>&nbsp;<span class="op" id="3382389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382393">tr</span>&nbsp;<span class="op" id="3382396">:=</span>&nbsp;<span class="ident" id="3382399"><a href="/net/http/request.go.html#3382348">v</a></span><span class="op" id="3382400">.</span><span class="op" id="3382401">(</span><span class="op" id="3382402">*</span><span class="ident" id="3382403"><a href="/net/http/request.go.html#3364665">textproto</a></span><span class="op" id="3382412">.</span><span class="ident" id="3382413">Reader</span><span class="op" id="3382419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382423"><a href="/net/http/request.go.html#3382393">tr</a></span><span class="op" id="3382425">.</span><span class="ident" id="3382426">R</span>&nbsp;<span class="op" id="3382428">=</span>&nbsp;<span class="ident" id="3382430"><a href="/net/http/request.go.html#3382306">br</a></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382435">return</span>&nbsp;<span class="ident" id="3382442"><a href="/net/http/request.go.html#3382393">tr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3382446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382449">return</span>&nbsp;<span class="ident" id="3382456"><a href="/net/http/request.go.html#3364665">textproto</a></span><span class="op" id="3382465">.</span><span class="ident" id="3382466">NewReader</span><span class="op" id="3382475">(</span><span class="ident" id="3382476"><a href="/net/http/request.go.html#3382306">br</a></span><span class="op" id="3382478">)</span><br>
<span class="lineno"></span><span class="op" id="3382480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="3382483">func</span>&nbsp;<span class="ident" id="3382488">putTextprotoReader</span><span class="op" id="3382506">(</span><span class="ident" id="3382507">r</span>&nbsp;<span class="op" id="3382509">*</span><span class="ident" id="3382510"><a href="/net/http/request.go.html#3364665">textproto</a></span><span class="op" id="3382519">.</span><span class="ident" id="3382520">Reader</span><span class="op" id="3382526">)</span>&nbsp;<span class="op" id="3382528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382531"><a href="/net/http/request.go.html#3382507">r</a></span><span class="op" id="3382532">.</span><span class="ident" id="3382533">R</span>&nbsp;<span class="op" id="3382535">=</span>&nbsp;<span class="ident" id="3382537">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382542"><a href="/net/http/request.go.html#3382251">textprotoReaderPool</a></span><span class="op" id="3382561">.</span><span class="ident" id="3382562">Put</span><span class="op" id="3382565">(</span><span class="ident" id="3382566"><a href="/net/http/request.go.html#3382507">r</a></span><span class="op" id="3382567">)</span><br>
<span class="lineno"></span><span class="op" id="3382569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="3382572">//&nbsp;ReadRequest&nbsp;reads&nbsp;and&nbsp;parses&nbsp;a&nbsp;request&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3382622">func</span>&nbsp;<span class="ident" id="3382627">ReadRequest</span><span class="op" id="3382638">(</span><span class="ident" id="3382639">b</span>&nbsp;<span class="op" id="3382641">*</span><span class="ident" id="3382642"><a href="/net/http/request.go.html#3364552">bufio</a></span><span class="op" id="3382647">.</span><span class="ident" id="3382648">Reader</span><span class="op" id="3382654">)</span>&nbsp;<span class="op" id="3382656">(</span><span class="ident" id="3382657">req</span>&nbsp;<span class="op" id="3382661">*</span><span class="ident" id="3382662"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3382669">,</span>&nbsp;<span class="ident" id="3382671">err</span>&nbsp;<span class="builtintype" id="3382675">error</span><span class="op" id="3382680">)</span>&nbsp;<span class="op" id="3382682">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382686">tp</span>&nbsp;<span class="op" id="3382689">:=</span>&nbsp;<span class="ident" id="3382692"><a href="/net/http/request.go.html#3382287">newTextprotoReader</a></span><span class="op" id="3382710">(</span><span class="ident" id="3382711"><a href="/net/http/request.go.html#3382639">b</a></span><span class="op" id="3382712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382715"><a href="/net/http/request.go.html#3382657">req</a></span>&nbsp;<span class="op" id="3382719">=</span>&nbsp;<span class="builtinfunc" id="3382721">new</span><span class="op" id="3382724">(</span><span class="ident" id="3382725"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3382732">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3382736">//&nbsp;First&nbsp;line:&nbsp;GET&nbsp;/index.html&nbsp;HTTP/1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382777">var</span>&nbsp;<span class="ident" id="3382781">s</span>&nbsp;<span class="builtintype" id="3382783">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382791">if</span>&nbsp;<span class="ident" id="3382794"><a href="/net/http/request.go.html#3382781">s</a></span><span class="op" id="3382795">,</span>&nbsp;<span class="ident" id="3382797"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3382801">=</span>&nbsp;<span class="ident" id="3382803"><a href="/net/http/request.go.html#3382686">tp</a></span><span class="op" id="3382805">.</span><span class="ident" id="3382806">ReadLine</span><span class="op" id="3382814">(</span><span class="op" id="3382815">)</span><span class="op" id="3382816">;</span>&nbsp;<span class="ident" id="3382818"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3382822">!=</span>&nbsp;<span class="ident" id="3382825">nil</span>&nbsp;<span class="op" id="3382829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382833">return</span>&nbsp;<span class="ident" id="3382840">nil</span><span class="op" id="3382843">,</span>&nbsp;<span class="ident" id="3382845"><a href="/net/http/request.go.html#3382671">err</a></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3382850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382853">defer</span>&nbsp;<span class="keyword" id="3382859">func</span><span class="op" id="3382863">(</span><span class="op" id="3382864">)</span>&nbsp;<span class="op" id="3382866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382870"><a href="/net/http/request.go.html#3382488">putTextprotoReader</a></span><span class="op" id="3382888">(</span><span class="ident" id="3382889"><a href="/net/http/request.go.html#3382686">tp</a></span><span class="op" id="3382891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382895">if</span>&nbsp;<span class="ident" id="3382898"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3382902">==</span>&nbsp;<span class="ident" id="3382905"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3382907">.</span><span class="ident" id="3382908">EOF</span>&nbsp;<span class="op" id="3382912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382917"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3382921">=</span>&nbsp;<span class="ident" id="3382923"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3382925">.</span><span class="ident" id="3382926">ErrUnexpectedEOF</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3382945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3382948">}</span><span class="op" id="3382949">(</span><span class="op" id="3382950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3382954">var</span>&nbsp;<span class="ident" id="3382958">ok</span>&nbsp;<span class="builtintype" id="3382961">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3382967"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3382970">.</span><span class="ident" id="3382971">Method</span><span class="op" id="3382977">,</span>&nbsp;<span class="ident" id="3382979"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3382982">.</span><span class="ident" id="3382983">RequestURI</span><span class="op" id="3382993">,</span>&nbsp;<span class="ident" id="3382995"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3382998">.</span><span class="ident" id="3382999">Proto</span><span class="op" id="3383004">,</span>&nbsp;<span class="ident" id="3383006"><a href="/net/http/request.go.html#3382958">ok</a></span>&nbsp;<span class="op" id="3383009">=</span>&nbsp;<span class="ident" id="3383011"><a href="/net/http/request.go.html#3381994">parseRequestLine</a></span><span class="op" id="3383027">(</span><span class="ident" id="3383028"><a href="/net/http/request.go.html#3382781">s</a></span><span class="op" id="3383029">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383032">if</span>&nbsp;<span class="op" id="3383035">!</span><span class="ident" id="3383036"><a href="/net/http/request.go.html#3382958">ok</a></span>&nbsp;<span class="op" id="3383039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383043">return</span>&nbsp;<span class="ident" id="3383050">nil</span><span class="op" id="3383053">,</span>&nbsp;<span class="op" id="3383055">&amp;</span><span class="ident" id="3383056"><a href="/net/http/request.go.html#3365780">badStringError</a></span><span class="op" id="3383070">{</span><span class="string" id="3383071">&#34;malformed&nbsp;HTTP&nbsp;request&#34;</span><span class="op" id="3383095">,</span>&nbsp;<span class="ident" id="3383097"><a href="/net/http/request.go.html#3382781">s</a></span><span class="op" id="3383098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3383101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3383104">rawurl</span>&nbsp;<span class="op" id="3383111">:=</span>&nbsp;<span class="ident" id="3383114"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383117">.</span><span class="ident" id="3383118">RequestURI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383130">if</span>&nbsp;<span class="ident" id="3383133"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383136">.</span><span class="ident" id="3383137">ProtoMajor</span><span class="op" id="3383147">,</span>&nbsp;<span class="ident" id="3383149"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383152">.</span><span class="ident" id="3383153">ProtoMinor</span><span class="op" id="3383163">,</span>&nbsp;<span class="ident" id="3383165"><a href="/net/http/request.go.html#3382958">ok</a></span>&nbsp;<span class="op" id="3383168">=</span>&nbsp;<span class="ident" id="3383170"><a href="/net/http/request.go.html#3379209">ParseHTTPVersion</a></span><span class="op" id="3383186">(</span><span class="ident" id="3383187"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383190">.</span><span class="ident" id="3383191">Proto</span><span class="op" id="3383196">)</span><span class="op" id="3383197">;</span>&nbsp;<span class="op" id="3383199">!</span><span class="ident" id="3383200"><a href="/net/http/request.go.html#3382958">ok</a></span>&nbsp;<span class="op" id="3383203">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383207">return</span>&nbsp;<span class="ident" id="3383214">nil</span><span class="op" id="3383217">,</span>&nbsp;<span class="op" id="3383219">&amp;</span><span class="ident" id="3383220"><a href="/net/http/request.go.html#3365780">badStringError</a></span><span class="op" id="3383234">{</span><span class="string" id="3383235">&#34;malformed&nbsp;HTTP&nbsp;version&#34;</span><span class="op" id="3383259">,</span>&nbsp;<span class="ident" id="3383261"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383264">.</span><span class="ident" id="3383265">Proto</span><span class="op" id="3383270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3383273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383277">//&nbsp;CONNECT&nbsp;requests&nbsp;are&nbsp;used&nbsp;two&nbsp;different&nbsp;ways,&nbsp;and&nbsp;neither&nbsp;uses&nbsp;a&nbsp;full&nbsp;URL:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383356">//&nbsp;The&nbsp;standard&nbsp;use&nbsp;is&nbsp;to&nbsp;tunnel&nbsp;HTTPS&nbsp;through&nbsp;an&nbsp;HTTP&nbsp;proxy.</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383419">//&nbsp;It&nbsp;looks&nbsp;like&nbsp;&#34;CONNECT&nbsp;www.google.com:443&nbsp;HTTP/1.1&#34;,&nbsp;and&nbsp;the&nbsp;parameter&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383497">//&nbsp;just&nbsp;the&nbsp;authority&nbsp;section&nbsp;of&nbsp;a&nbsp;URL.&nbsp;This&nbsp;information&nbsp;should&nbsp;go&nbsp;in&nbsp;req.URL.Host.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383582">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383586">//&nbsp;The&nbsp;net/rpc&nbsp;package&nbsp;also&nbsp;uses&nbsp;CONNECT,&nbsp;but&nbsp;there&nbsp;the&nbsp;parameter&nbsp;is&nbsp;a&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383663">//&nbsp;that&nbsp;starts&nbsp;with&nbsp;a&nbsp;slash.&nbsp;It&nbsp;can&nbsp;be&nbsp;parsed&nbsp;with&nbsp;the&nbsp;regular&nbsp;URL&nbsp;parser,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383739">//&nbsp;and&nbsp;the&nbsp;path&nbsp;will&nbsp;end&nbsp;up&nbsp;in&nbsp;req.URL.Path,&nbsp;where&nbsp;it&nbsp;needs&nbsp;to&nbsp;be&nbsp;in&nbsp;order&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3383819">//&nbsp;RPC&nbsp;to&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3383836">justAuthority</span>&nbsp;<span class="op" id="3383850">:=</span>&nbsp;<span class="ident" id="3383853"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383856">.</span><span class="ident" id="3383857">Method</span>&nbsp;<span class="op" id="3383864">==</span>&nbsp;<span class="string" id="3383867">&#34;CONNECT&#34;</span>&nbsp;<span class="op" id="3383877">&amp;&amp;</span>&nbsp;<span class="op" id="3383880">!</span><span class="ident" id="3383881"><a href="/net/http/request.go.html#3364704">strings</a></span><span class="op" id="3383888">.</span><span class="ident" id="3383889">HasPrefix</span><span class="op" id="3383898">(</span><span class="ident" id="3383899"><a href="/net/http/request.go.html#3383104">rawurl</a></span><span class="op" id="3383905">,</span>&nbsp;<span class="string" id="3383907">&#34;/&#34;</span><span class="op" id="3383910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383913">if</span>&nbsp;<span class="ident" id="3383916"><a href="/net/http/request.go.html#3383836">justAuthority</a></span>&nbsp;<span class="op" id="3383930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3383934"><a href="/net/http/request.go.html#3383104">rawurl</a></span>&nbsp;<span class="op" id="3383941">=</span>&nbsp;<span class="string" id="3383943">&#34;http://&#34;</span>&nbsp;<span class="op" id="3383953">+</span>&nbsp;<span class="ident" id="3383955"><a href="/net/http/request.go.html#3383104">rawurl</a></span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3383963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3383967">if</span>&nbsp;<span class="ident" id="3383970"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3383973">.</span><span class="ident" id="3383974">URL</span><span class="op" id="3383977">,</span>&nbsp;<span class="ident" id="3383979"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3383983">=</span>&nbsp;<span class="ident" id="3383985"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3383988">.</span><span class="ident" id="3383989">ParseRequestURI</span><span class="op" id="3384004">(</span><span class="ident" id="3384005"><a href="/net/http/request.go.html#3383104">rawurl</a></span><span class="op" id="3384011">)</span><span class="op" id="3384012">;</span>&nbsp;<span class="ident" id="3384014"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3384018">!=</span>&nbsp;<span class="ident" id="3384021">nil</span>&nbsp;<span class="op" id="3384025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384029">return</span>&nbsp;<span class="ident" id="3384036">nil</span><span class="op" id="3384039">,</span>&nbsp;<span class="ident" id="3384041"><a href="/net/http/request.go.html#3382671">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3384046">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384050">if</span>&nbsp;<span class="ident" id="3384053"><a href="/net/http/request.go.html#3383836">justAuthority</a></span>&nbsp;<span class="op" id="3384067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384071">//&nbsp;Strip&nbsp;the&nbsp;bogus&nbsp;&#34;http://&#34;&nbsp;back&nbsp;off.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384112"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384115">.</span><span class="ident" id="3384116">URL</span><span class="op" id="3384119">.</span><span class="ident" id="3384120">Scheme</span>&nbsp;<span class="op" id="3384127">=</span>&nbsp;<span class="string" id="3384129">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3384133">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384137">//&nbsp;Subsequent&nbsp;lines:&nbsp;Key:&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384171">mimeHeader</span><span class="op" id="3384181">,</span>&nbsp;<span class="ident" id="3384183"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3384187">:=</span>&nbsp;<span class="ident" id="3384190"><a href="/net/http/request.go.html#3382686">tp</a></span><span class="op" id="3384192">.</span><span class="ident" id="3384193">ReadMIMEHeader</span><span class="op" id="3384207">(</span><span class="op" id="3384208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384211">if</span>&nbsp;<span class="ident" id="3384214"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3384218">!=</span>&nbsp;<span class="ident" id="3384221">nil</span>&nbsp;<span class="op" id="3384225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384229">return</span>&nbsp;<span class="ident" id="3384236">nil</span><span class="op" id="3384239">,</span>&nbsp;<span class="ident" id="3384241"><a href="/net/http/request.go.html#3382671">err</a></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3384246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384249"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384252">.</span><span class="ident" id="3384253">Header</span>&nbsp;<span class="op" id="3384260">=</span>&nbsp;<span class="ident" id="3384262"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3384268">(</span><span class="ident" id="3384269"><a href="/net/http/request.go.html#3384171">mimeHeader</a></span><span class="op" id="3384279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384283">//&nbsp;RFC2616:&nbsp;Must&nbsp;treat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384307">//&nbsp;&nbsp;&nbsp;&nbspGET&nbsp;/index.html&nbsp;HTTP/1.1</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384336">//&nbsp;&nbsp;&nbsp;&nbspHost:&nbsp;www.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384361">//&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384369">//&nbsp;&nbsp;&nbsp;&nbspGET&nbsp;http://www.google.com/index.html&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384419">//&nbsp;&nbsp;&nbsp;&nbspHost:&nbsp;doesntmatter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3384442">//&nbsp;the&nbsp;same.&nbsp;&nbsp;In&nbsp;the&nbsp;second&nbsp;case,&nbsp;any&nbsp;Host&nbsp;line&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384503"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384506">.</span><span class="ident" id="3384507">Host</span>&nbsp;<span class="op" id="3384512">=</span>&nbsp;<span class="ident" id="3384514"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384517">.</span><span class="ident" id="3384518">URL</span><span class="op" id="3384521">.</span><span class="ident" id="3384522">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384528">if</span>&nbsp;<span class="ident" id="3384531"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384534">.</span><span class="ident" id="3384535">Host</span>&nbsp;<span class="op" id="3384540">==</span>&nbsp;<span class="string" id="3384543">&#34;&#34;</span>&nbsp;<span class="op" id="3384546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384550"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384553">.</span><span class="ident" id="3384554">Host</span>&nbsp;<span class="op" id="3384559">=</span>&nbsp;<span class="ident" id="3384561"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384564">.</span><span class="ident" id="3384565">Header</span><span class="op" id="3384571">.</span><span class="ident" id="3384572">get</span><span class="op" id="3384575">(</span><span class="string" id="3384576">&#34;Host&#34;</span><span class="op" id="3384582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3384585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3384588">delete</span><span class="op" id="3384594">(</span><span class="ident" id="3384595"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384598">.</span><span class="ident" id="3384599">Header</span><span class="op" id="3384605">,</span>&nbsp;<span class="string" id="3384607">&#34;Host&#34;</span><span class="op" id="3384613">)</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384617"><a href="/net/http/response.go.html#3396485">fixPragmaCacheControl</a></span><span class="op" id="3384638">(</span><span class="ident" id="3384639"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384642">.</span><span class="ident" id="3384643">Header</span><span class="op" id="3384649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384653"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3384657">=</span>&nbsp;<span class="ident" id="3384659"><a href="/net/http/transfer.go.html#3478328">readTransfer</a></span><span class="op" id="3384671">(</span><span class="ident" id="3384672"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384675">,</span>&nbsp;<span class="ident" id="3384677"><a href="/net/http/request.go.html#3382639">b</a></span><span class="op" id="3384678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384681">if</span>&nbsp;<span class="ident" id="3384684"><a href="/net/http/request.go.html#3382671">err</a></span>&nbsp;<span class="op" id="3384688">!=</span>&nbsp;<span class="ident" id="3384691">nil</span>&nbsp;<span class="op" id="3384695">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384699">return</span>&nbsp;<span class="ident" id="3384706">nil</span><span class="op" id="3384709">,</span>&nbsp;<span class="ident" id="3384711"><a href="/net/http/request.go.html#3382671">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3384716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3384720"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384723">.</span><span class="ident" id="3384724">Close</span>&nbsp;<span class="op" id="3384730">=</span>&nbsp;<span class="ident" id="3384732"><a href="/net/http/transfer.go.html#3484079">shouldClose</a></span><span class="op" id="3384743">(</span><span class="ident" id="3384744"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384747">.</span><span class="ident" id="3384748">ProtoMajor</span><span class="op" id="3384758">,</span>&nbsp;<span class="ident" id="3384760"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384763">.</span><span class="ident" id="3384764">ProtoMinor</span><span class="op" id="3384774">,</span>&nbsp;<span class="ident" id="3384776"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384779">.</span><span class="ident" id="3384780">Header</span><span class="op" id="3384786">,</span>&nbsp;<span class="builtintype" id="3384788">false</span><span class="op" id="3384793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3384796">return</span>&nbsp;<span class="ident" id="3384803"><a href="/net/http/request.go.html#3382657">req</a></span><span class="op" id="3384806">,</span>&nbsp;<span class="ident" id="3384808">nil</span><br>
<span class="lineno">670</span><span class="op" id="3384812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3384815">//&nbsp;MaxBytesReader&nbsp;is&nbsp;similar&nbsp;to&nbsp;io.LimitReader&nbsp;but&nbsp;is&nbsp;intended&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3384882">//&nbsp;limiting&nbsp;the&nbsp;size&nbsp;of&nbsp;incoming&nbsp;request&nbsp;bodies.&nbsp;In&nbsp;contrast&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3384946">//&nbsp;io.LimitReader,&nbsp;MaxBytesReader&#39;s&nbsp;result&nbsp;is&nbsp;a&nbsp;ReadCloser,&nbsp;returns&nbsp;a</span><br>
<span class="lineno">675</span><span class="comment" id="3385016">//&nbsp;non-EOF&nbsp;error&nbsp;for&nbsp;a&nbsp;Read&nbsp;beyond&nbsp;the&nbsp;limit,&nbsp;and&nbsp;Closes&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3385077">//&nbsp;underlying&nbsp;reader&nbsp;when&nbsp;its&nbsp;Close&nbsp;method&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span><span class="comment" id="3385131">//</span><br>
<span class="lineno"></span><span class="comment" id="3385134">//&nbsp;MaxBytesReader&nbsp;prevents&nbsp;clients&nbsp;from&nbsp;accidentally&nbsp;or&nbsp;maliciously</span><br>
<span class="lineno"></span><span class="comment" id="3385202">//&nbsp;sending&nbsp;a&nbsp;large&nbsp;request&nbsp;and&nbsp;wasting&nbsp;server&nbsp;resources.</span><br>
<span class="lineno">680</span><span class="keyword" id="3385259">func</span>&nbsp;<span class="ident" id="3385264">MaxBytesReader</span><span class="op" id="3385278">(</span><span class="ident" id="3385279">w</span>&nbsp;<span class="ident" id="3385281"><a href="/net/http/server.go.html#3401101">ResponseWriter</a></span><span class="op" id="3385295">,</span>&nbsp;<span class="ident" id="3385297">r</span>&nbsp;<span class="ident" id="3385299"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3385301">.</span><span class="ident" id="3385302">ReadCloser</span><span class="op" id="3385312">,</span>&nbsp;<span class="ident" id="3385314">n</span>&nbsp;<span class="ident" id="3385316">int64</span><span class="op" id="3385321">)</span>&nbsp;<span class="ident" id="3385323"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3385325">.</span><span class="ident" id="3385326">ReadCloser</span>&nbsp;<span class="op" id="3385337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385340">return</span>&nbsp;<span class="op" id="3385347">&amp;</span><span class="ident" id="3385348"><a href="/net/http/request.go.html#3385389">maxBytesReader</a></span><span class="op" id="3385362">{</span><span class="ident" id="3385363">w</span><span class="op" id="3385364">:</span>&nbsp;<span class="ident" id="3385366"><a href="/net/http/request.go.html#3385279">w</a></span><span class="op" id="3385367">,</span>&nbsp;<span class="ident" id="3385369">r</span><span class="op" id="3385370">:</span>&nbsp;<span class="ident" id="3385372"><a href="/net/http/request.go.html#3385297">r</a></span><span class="op" id="3385373">,</span>&nbsp;<span class="ident" id="3385375">n</span><span class="op" id="3385376">:</span>&nbsp;<span class="ident" id="3385378"><a href="/net/http/request.go.html#3385314">n</a></span><span class="op" id="3385379">}</span><br>
<span class="lineno"></span><span class="op" id="3385381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3385384">type</span>&nbsp;<span class="ident" id="3385389">maxBytesReader</span>&nbsp;<span class="keyword" id="3385404">struct</span>&nbsp;<span class="op" id="3385411">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385414">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3385422"><a href="/net/http/server.go.html#3401101">ResponseWriter</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385438">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3385446"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3385448">.</span><span class="ident" id="3385449">ReadCloser</span>&nbsp;<span class="comment" id="3385460">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385482">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3385490">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3385504">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385528">stopped</span>&nbsp;<span class="builtintype" id="3385536">bool</span><br>
<span class="lineno"></span><span class="op" id="3385541">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="keyword" id="3385544">func</span>&nbsp;<span class="op" id="3385549">(</span><span class="ident" id="3385550">l</span>&nbsp;<span class="op" id="3385552">*</span><span class="ident" id="3385553"><a href="/net/http/request.go.html#3385389">maxBytesReader</a></span><span class="op" id="3385567">)</span>&nbsp;<span class="ident" id="3385569">Read</span><span class="op" id="3385573">(</span><span class="ident" id="3385574">p</span>&nbsp;<span class="op" id="3385576">[</span><span class="op" id="3385577">]</span><span class="builtintype" id="3385578">byte</span><span class="op" id="3385582">)</span>&nbsp;<span class="op" id="3385584">(</span><span class="ident" id="3385585">n</span>&nbsp;<span class="builtintype" id="3385587">int</span><span class="op" id="3385590">,</span>&nbsp;<span class="ident" id="3385592">err</span>&nbsp;<span class="builtintype" id="3385596">error</span><span class="op" id="3385601">)</span>&nbsp;<span class="op" id="3385603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385606">if</span>&nbsp;<span class="ident" id="3385609"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385610">.</span><span class="ident" id="3385611">n</span>&nbsp;<span class="op" id="3385613">&lt;=</span>&nbsp;<span class="num" id="3385616">0</span>&nbsp;<span class="op" id="3385618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385622">if</span>&nbsp;<span class="op" id="3385625">!</span><span class="ident" id="3385626"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385627">.</span><span class="ident" id="3385628">stopped</span>&nbsp;<span class="op" id="3385636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385641"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385642">.</span><span class="ident" id="3385643">stopped</span>&nbsp;<span class="op" id="3385651">=</span>&nbsp;<span class="builtintype" id="3385653">true</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385661">if</span>&nbsp;<span class="ident" id="3385664">res</span><span class="op" id="3385667">,</span>&nbsp;<span class="ident" id="3385669">ok</span>&nbsp;<span class="op" id="3385672">:=</span>&nbsp;<span class="ident" id="3385675"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385676">.</span><span class="ident" id="3385677">w</span><span class="op" id="3385678">.</span><span class="op" id="3385679">(</span><span class="op" id="3385680">*</span><span class="ident" id="3385681"><a href="/net/http/server.go.html#3408205">response</a></span><span class="op" id="3385689">)</span><span class="op" id="3385690">;</span>&nbsp;<span class="ident" id="3385692"><a href="/net/http/request.go.html#3385669">ok</a></span>&nbsp;<span class="op" id="3385695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385701"><a href="/net/http/request.go.html#3385664">res</a></span><span class="op" id="3385704">.</span><span class="ident" id="3385705">requestTooLarge</span><span class="op" id="3385720">(</span><span class="op" id="3385721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3385726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3385730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385734">return</span>&nbsp;<span class="num" id="3385741">0</span><span class="op" id="3385742">,</span>&nbsp;<span class="ident" id="3385744"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3385750">.</span><span class="ident" id="3385751">New</span><span class="op" id="3385754">(</span><span class="string" id="3385755">&#34;http:&nbsp;request&nbsp;body&nbsp;too&nbsp;large&#34;</span><span class="op" id="3385785">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3385788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385791">if</span>&nbsp;<span class="ident" id="3385794">int64</span><span class="op" id="3385799">(</span><span class="builtinfunc" id="3385800">len</span><span class="op" id="3385803">(</span><span class="ident" id="3385804"><a href="/net/http/request.go.html#3385574">p</a></span><span class="op" id="3385805">)</span><span class="op" id="3385806">)</span>&nbsp;<span class="op" id="3385808">&gt;</span>&nbsp;<span class="ident" id="3385810"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385811">.</span><span class="ident" id="3385812">n</span>&nbsp;<span class="op" id="3385814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385818"><a href="/net/http/request.go.html#3385574">p</a></span>&nbsp;<span class="op" id="3385820">=</span>&nbsp;<span class="ident" id="3385822"><a href="/net/http/request.go.html#3385574">p</a></span><span class="op" id="3385823">[</span><span class="op" id="3385824">:</span><span class="ident" id="3385825"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385826">.</span><span class="ident" id="3385827">n</span><span class="op" id="3385828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3385831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385834"><a href="/net/http/request.go.html#3385585">n</a></span><span class="op" id="3385835">,</span>&nbsp;<span class="ident" id="3385837"><a href="/net/http/request.go.html#3385592">err</a></span>&nbsp;<span class="op" id="3385841">=</span>&nbsp;<span class="ident" id="3385843"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385844">.</span><span class="ident" id="3385845">r</span><span class="op" id="3385846">.</span><span class="ident" id="3385847">Read</span><span class="op" id="3385851">(</span><span class="ident" id="3385852"><a href="/net/http/request.go.html#3385574">p</a></span><span class="op" id="3385853">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3385856"><a href="/net/http/request.go.html#3385550">l</a></span><span class="op" id="3385857">.</span><span class="ident" id="3385858">n</span>&nbsp;<span class="op" id="3385860">-=</span>&nbsp;<span class="ident" id="3385863">int64</span><span class="op" id="3385868">(</span><span class="ident" id="3385869"><a href="/net/http/request.go.html#3385585">n</a></span><span class="op" id="3385870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385873">return</span><br>
<span class="lineno"></span><span class="op" id="3385880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3385883">func</span>&nbsp;<span class="op" id="3385888">(</span><span class="ident" id="3385889">l</span>&nbsp;<span class="op" id="3385891">*</span><span class="ident" id="3385892"><a href="/net/http/request.go.html#3385389">maxBytesReader</a></span><span class="op" id="3385906">)</span>&nbsp;<span class="ident" id="3385908">Close</span><span class="op" id="3385913">(</span><span class="op" id="3385914">)</span>&nbsp;<span class="builtintype" id="3385916">error</span>&nbsp;<span class="op" id="3385922">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385925">return</span>&nbsp;<span class="ident" id="3385932"><a href="/net/http/request.go.html#3385889">l</a></span><span class="op" id="3385933">.</span><span class="ident" id="3385934">r</span><span class="op" id="3385935">.</span><span class="ident" id="3385936">Close</span><span class="op" id="3385941">(</span><span class="op" id="3385942">)</span><br>
<span class="lineno"></span><span class="op" id="3385944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3385947">func</span>&nbsp;<span class="ident" id="3385952">copyValues</span><span class="op" id="3385962">(</span><span class="ident" id="3385963">dst</span><span class="op" id="3385966">,</span>&nbsp;<span class="ident" id="3385968">src</span>&nbsp;<span class="ident" id="3385972"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3385975">.</span><span class="ident" id="3385976">Values</span><span class="op" id="3385982">)</span>&nbsp;<span class="op" id="3385984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3385987">for</span>&nbsp;<span class="ident" id="3385991">k</span><span class="op" id="3385992">,</span>&nbsp;<span class="ident" id="3385994">vs</span>&nbsp;<span class="op" id="3385997">:=</span>&nbsp;<span class="keyword" id="3386000">range</span>&nbsp;<span class="ident" id="3386006"><a href="/net/http/request.go.html#3385968">src</a></span>&nbsp;<span class="op" id="3386010">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386014">for</span>&nbsp;<span class="ident" id="3386018">_</span><span class="op" id="3386019">,</span>&nbsp;<span class="ident" id="3386021">value</span>&nbsp;<span class="op" id="3386027">:=</span>&nbsp;<span class="keyword" id="3386030">range</span>&nbsp;<span class="ident" id="3386036"><a href="/net/http/request.go.html#3385994">vs</a></span>&nbsp;<span class="op" id="3386039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386044"><a href="/net/http/request.go.html#3385963">dst</a></span><span class="op" id="3386047">.</span><span class="ident" id="3386048">Add</span><span class="op" id="3386051">(</span><span class="ident" id="3386052"><a href="/net/http/request.go.html#3385991">k</a></span><span class="op" id="3386053">,</span>&nbsp;<span class="ident" id="3386055"><a href="/net/http/request.go.html#3386021">value</a></span><span class="op" id="3386060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386067">}</span><br>
<span class="lineno"></span><span class="op" id="3386069">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3386072">func</span>&nbsp;<span class="ident" id="3386077">parsePostForm</span><span class="op" id="3386090">(</span><span class="ident" id="3386091">r</span>&nbsp;<span class="op" id="3386093">*</span><span class="ident" id="3386094"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3386101">)</span>&nbsp;<span class="op" id="3386103">(</span><span class="ident" id="3386104">vs</span>&nbsp;<span class="ident" id="3386107"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3386110">.</span><span class="ident" id="3386111">Values</span><span class="op" id="3386117">,</span>&nbsp;<span class="ident" id="3386119">err</span>&nbsp;<span class="builtintype" id="3386123">error</span><span class="op" id="3386128">)</span>&nbsp;<span class="op" id="3386130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386133">if</span>&nbsp;<span class="ident" id="3386136"><a href="/net/http/request.go.html#3386091">r</a></span><span class="op" id="3386137">.</span><span class="ident" id="3386138">Body</span>&nbsp;<span class="op" id="3386143">==</span>&nbsp;<span class="ident" id="3386146">nil</span>&nbsp;<span class="op" id="3386150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386154"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386158">=</span>&nbsp;<span class="ident" id="3386160"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3386166">.</span><span class="ident" id="3386167">New</span><span class="op" id="3386170">(</span><span class="string" id="3386171">&#34;missing&nbsp;form&nbsp;body&#34;</span><span class="op" id="3386190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386194">return</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386205">ct</span>&nbsp;<span class="op" id="3386208">:=</span>&nbsp;<span class="ident" id="3386211"><a href="/net/http/request.go.html#3386091">r</a></span><span class="op" id="3386212">.</span><span class="ident" id="3386213">Header</span><span class="op" id="3386219">.</span><span class="ident" id="3386220">Get</span><span class="op" id="3386223">(</span><span class="string" id="3386224">&#34;Content-Type&#34;</span><span class="op" id="3386238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3386241">//&nbsp;RFC&nbsp;2616,&nbsp;section&nbsp;7.2.1&nbsp;-&nbsp;empty&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3386282">//&nbsp;&nbsp;&nbsp;SHOULD&nbsp;be&nbsp;treated&nbsp;as&nbsp;application/octet-stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386334">if</span>&nbsp;<span class="ident" id="3386337"><a href="/net/http/request.go.html#3386205">ct</a></span>&nbsp;<span class="op" id="3386340">==</span>&nbsp;<span class="string" id="3386343">&#34;&#34;</span>&nbsp;<span class="op" id="3386346">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386350"><a href="/net/http/request.go.html#3386205">ct</a></span>&nbsp;<span class="op" id="3386353">=</span>&nbsp;<span class="string" id="3386355">&#34;application/octet-stream&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386386"><a href="/net/http/request.go.html#3386205">ct</a></span><span class="op" id="3386388">,</span>&nbsp;<span class="ident" id="3386390">_</span><span class="op" id="3386391">,</span>&nbsp;<span class="ident" id="3386393"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386397">=</span>&nbsp;<span class="ident" id="3386399"><a href="/net/http/request.go.html#3364639">mime</a></span><span class="op" id="3386403">.</span><span class="ident" id="3386404">ParseMediaType</span><span class="op" id="3386418">(</span><span class="ident" id="3386419"><a href="/net/http/request.go.html#3386205">ct</a></span><span class="op" id="3386421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386424">switch</span>&nbsp;<span class="op" id="3386431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386434">case</span>&nbsp;<span class="ident" id="3386439"><a href="/net/http/request.go.html#3386205">ct</a></span>&nbsp;<span class="op" id="3386442">==</span>&nbsp;<span class="string" id="3386445">&#34;application/x-www-form-urlencoded&#34;</span><span class="op" id="3386480">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386484">var</span>&nbsp;<span class="ident" id="3386488">reader</span>&nbsp;<span class="ident" id="3386495"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3386497">.</span><span class="ident" id="3386498">Reader</span>&nbsp;<span class="op" id="3386505">=</span>&nbsp;<span class="ident" id="3386507"><a href="/net/http/request.go.html#3386091">r</a></span><span class="op" id="3386508">.</span><span class="ident" id="3386509">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386516">maxFormSize</span>&nbsp;<span class="op" id="3386528">:=</span>&nbsp;<span class="ident" id="3386531">int64</span><span class="op" id="3386536">(</span><span class="num" id="3386537">1</span><span class="op" id="3386538">&lt;&lt;</span><span class="num" id="3386540">63</span>&nbsp;<span class="op" id="3386543">-</span>&nbsp;<span class="num" id="3386545">1</span><span class="op" id="3386546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386550">if</span>&nbsp;<span class="ident" id="3386553">_</span><span class="op" id="3386554">,</span>&nbsp;<span class="ident" id="3386556">ok</span>&nbsp;<span class="op" id="3386559">:=</span>&nbsp;<span class="ident" id="3386562"><a href="/net/http/request.go.html#3386091">r</a></span><span class="op" id="3386563">.</span><span class="ident" id="3386564">Body</span><span class="op" id="3386568">.</span><span class="op" id="3386569">(</span><span class="op" id="3386570">*</span><span class="ident" id="3386571"><a href="/net/http/request.go.html#3385389">maxBytesReader</a></span><span class="op" id="3386585">)</span><span class="op" id="3386586">;</span>&nbsp;<span class="op" id="3386588">!</span><span class="ident" id="3386589"><a href="/net/http/request.go.html#3386556">ok</a></span>&nbsp;<span class="op" id="3386592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386597"><a href="/net/http/request.go.html#3386516">maxFormSize</a></span>&nbsp;<span class="op" id="3386609">=</span>&nbsp;<span class="ident" id="3386611">int64</span><span class="op" id="3386616">(</span><span class="num" id="3386617">10</span>&nbsp;<span class="op" id="3386620">&lt;&lt;</span>&nbsp;<span class="num" id="3386623">20</span><span class="op" id="3386625">)</span>&nbsp;<span class="comment" id="3386627">//&nbsp;10&nbsp;MB&nbsp;is&nbsp;a&nbsp;lot&nbsp;of&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386657"><a href="/net/http/request.go.html#3386488">reader</a></span>&nbsp;<span class="op" id="3386664">=</span>&nbsp;<span class="ident" id="3386666"><a href="/net/http/request.go.html#3364620">io</a></span><span class="op" id="3386668">.</span><span class="ident" id="3386669">LimitReader</span><span class="op" id="3386680">(</span><span class="ident" id="3386681"><a href="/net/http/request.go.html#3386091">r</a></span><span class="op" id="3386682">.</span><span class="ident" id="3386683">Body</span><span class="op" id="3386687">,</span>&nbsp;<span class="ident" id="3386689"><a href="/net/http/request.go.html#3386516">maxFormSize</a></span><span class="op" id="3386700">+</span><span class="num" id="3386701">1</span><span class="op" id="3386702">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386710">b</span><span class="op" id="3386711">,</span>&nbsp;<span class="ident" id="3386713">e</span>&nbsp;<span class="op" id="3386715">:=</span>&nbsp;<span class="ident" id="3386718"><a href="/net/http/request.go.html#3364626">ioutil</a></span><span class="op" id="3386724">.</span><span class="ident" id="3386725">ReadAll</span><span class="op" id="3386732">(</span><span class="ident" id="3386733"><a href="/net/http/request.go.html#3386488">reader</a></span><span class="op" id="3386739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386743">if</span>&nbsp;<span class="ident" id="3386746"><a href="/net/http/request.go.html#3386713">e</a></span>&nbsp;<span class="op" id="3386748">!=</span>&nbsp;<span class="ident" id="3386751">nil</span>&nbsp;<span class="op" id="3386755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386760">if</span>&nbsp;<span class="ident" id="3386763"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386767">==</span>&nbsp;<span class="ident" id="3386770">nil</span>&nbsp;<span class="op" id="3386774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386780"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386784">=</span>&nbsp;<span class="ident" id="3386786"><a href="/net/http/request.go.html#3386713">e</a></span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386796">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386808">if</span>&nbsp;<span class="ident" id="3386811">int64</span><span class="op" id="3386816">(</span><span class="builtinfunc" id="3386817">len</span><span class="op" id="3386820">(</span><span class="ident" id="3386821"><a href="/net/http/request.go.html#3386710">b</a></span><span class="op" id="3386822">)</span><span class="op" id="3386823">)</span>&nbsp;<span class="op" id="3386825">&gt;</span>&nbsp;<span class="ident" id="3386827"><a href="/net/http/request.go.html#3386516">maxFormSize</a></span>&nbsp;<span class="op" id="3386839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386844"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386848">=</span>&nbsp;<span class="ident" id="3386850"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3386856">.</span><span class="ident" id="3386857">New</span><span class="op" id="3386860">(</span><span class="string" id="3386861">&#34;http:&nbsp;POST&nbsp;too&nbsp;large&#34;</span><span class="op" id="3386883">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386888">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386901"><a href="/net/http/request.go.html#3386104">vs</a></span><span class="op" id="3386903">,</span>&nbsp;<span class="ident" id="3386905"><a href="/net/http/request.go.html#3386713">e</a></span>&nbsp;<span class="op" id="3386907">=</span>&nbsp;<span class="ident" id="3386909"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3386912">.</span><span class="ident" id="3386913">ParseQuery</span><span class="op" id="3386923">(</span><span class="builtintype" id="3386924">string</span><span class="op" id="3386930">(</span><span class="ident" id="3386931"><a href="/net/http/request.go.html#3386710">b</a></span><span class="op" id="3386932">)</span><span class="op" id="3386933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386937">if</span>&nbsp;<span class="ident" id="3386940"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386944">==</span>&nbsp;<span class="ident" id="3386947">nil</span>&nbsp;<span class="op" id="3386951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3386956"><a href="/net/http/request.go.html#3386119">err</a></span>&nbsp;<span class="op" id="3386960">=</span>&nbsp;<span class="ident" id="3386962"><a href="/net/http/request.go.html#3386713">e</a></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3386966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3386969">case</span>&nbsp;<span class="ident" id="3386974"><a href="/net/http/request.go.html#3386205">ct</a></span>&nbsp;<span class="op" id="3386977">==</span>&nbsp;<span class="string" id="3386980">&#34;multipart/form-data&#34;</span><span class="op" id="3387001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387005">//&nbsp;handled&nbsp;by&nbsp;ParseMultipartForm&nbsp;(which&nbsp;is&nbsp;calling&nbsp;us,&nbsp;or&nbsp;should&nbsp;be)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387076">//&nbsp;TODO(bradfitz):&nbsp;there&nbsp;are&nbsp;too&nbsp;many&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387125">//&nbsp;orders&nbsp;to&nbsp;call&nbsp;too&nbsp;many&nbsp;functions&nbsp;here.</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387170">//&nbsp;Clean&nbsp;this&nbsp;up&nbsp;and&nbsp;write&nbsp;more&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387211">//&nbsp;request_test.go&nbsp;contains&nbsp;the&nbsp;start&nbsp;of&nbsp;this,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3387260">//&nbsp;in&nbsp;TestParseMultipartFormOrder&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3387307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3387310">return</span><br>
<span class="lineno">765</span><span class="op" id="3387317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3387320">//&nbsp;ParseForm&nbsp;parses&nbsp;the&nbsp;raw&nbsp;query&nbsp;from&nbsp;the&nbsp;URL&nbsp;and&nbsp;updates&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3387387">//</span><br>
<span class="lineno"></span><span class="comment" id="3387390">//&nbsp;For&nbsp;POST&nbsp;or&nbsp;PUT&nbsp;requests,&nbsp;it&nbsp;also&nbsp;parses&nbsp;the&nbsp;request&nbsp;body&nbsp;as&nbsp;a&nbsp;form&nbsp;and</span><br>
<span class="lineno">770</span><span class="comment" id="3387465">//&nbsp;put&nbsp;the&nbsp;results&nbsp;into&nbsp;both&nbsp;r.PostForm&nbsp;and&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3387517">//&nbsp;POST&nbsp;and&nbsp;PUT&nbsp;body&nbsp;parameters&nbsp;take&nbsp;precedence&nbsp;over&nbsp;URL&nbsp;query&nbsp;string&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3387594">//&nbsp;in&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3387608">//</span><br>
<span class="lineno"></span><span class="comment" id="3387611">//&nbsp;If&nbsp;the&nbsp;request&nbsp;Body&#39;s&nbsp;size&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;limited&nbsp;by&nbsp;MaxBytesReader,</span><br>
<span class="lineno">775</span><span class="comment" id="3387689">//&nbsp;the&nbsp;size&nbsp;is&nbsp;capped&nbsp;at&nbsp;10MB.</span><br>
<span class="lineno"></span><span class="comment" id="3387720">//</span><br>
<span class="lineno"></span><span class="comment" id="3387723">//&nbsp;ParseMultipartForm&nbsp;calls&nbsp;ParseForm&nbsp;automatically.</span><br>
<span class="lineno"></span><span class="comment" id="3387776">//&nbsp;It&nbsp;is&nbsp;idempotent.</span><br>
<span class="lineno"></span><span class="keyword" id="3387797">func</span>&nbsp;<span class="op" id="3387802">(</span><span class="ident" id="3387803">r</span>&nbsp;<span class="op" id="3387805">*</span><span class="ident" id="3387806"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3387813">)</span>&nbsp;<span class="ident" id="3387815">ParseForm</span><span class="op" id="3387824">(</span><span class="op" id="3387825">)</span>&nbsp;<span class="builtintype" id="3387827">error</span>&nbsp;<span class="op" id="3387833">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3387836">var</span>&nbsp;<span class="ident" id="3387840">err</span>&nbsp;<span class="builtintype" id="3387844">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3387851">if</span>&nbsp;<span class="ident" id="3387854"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387855">.</span><span class="ident" id="3387856">PostForm</span>&nbsp;<span class="op" id="3387865">==</span>&nbsp;<span class="ident" id="3387868">nil</span>&nbsp;<span class="op" id="3387872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3387876">if</span>&nbsp;<span class="ident" id="3387879"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387880">.</span><span class="ident" id="3387881">Method</span>&nbsp;<span class="op" id="3387888">==</span>&nbsp;<span class="string" id="3387891">&#34;POST&#34;</span>&nbsp;<span class="op" id="3387898">||</span>&nbsp;<span class="ident" id="3387901"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387902">.</span><span class="ident" id="3387903">Method</span>&nbsp;<span class="op" id="3387910">==</span>&nbsp;<span class="string" id="3387913">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3387919">||</span>&nbsp;<span class="ident" id="3387922"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387923">.</span><span class="ident" id="3387924">Method</span>&nbsp;<span class="op" id="3387931">==</span>&nbsp;<span class="string" id="3387934">&#34;PATCH&#34;</span>&nbsp;<span class="op" id="3387942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3387947"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387948">.</span><span class="ident" id="3387949">PostForm</span><span class="op" id="3387957">,</span>&nbsp;<span class="ident" id="3387959"><a href="/net/http/request.go.html#3387840">err</a></span>&nbsp;<span class="op" id="3387963">=</span>&nbsp;<span class="ident" id="3387965"><a href="/net/http/request.go.html#3386077">parsePostForm</a></span><span class="op" id="3387978">(</span><span class="ident" id="3387979"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3387984">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3387988">if</span>&nbsp;<span class="ident" id="3387991"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3387992">.</span><span class="ident" id="3387993">PostForm</span>&nbsp;<span class="op" id="3388002">==</span>&nbsp;<span class="ident" id="3388005">nil</span>&nbsp;<span class="op" id="3388009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388014"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388015">.</span><span class="ident" id="3388016">PostForm</span>&nbsp;<span class="op" id="3388025">=</span>&nbsp;<span class="builtinfunc" id="3388027">make</span><span class="op" id="3388031">(</span><span class="ident" id="3388032"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3388035">.</span><span class="ident" id="3388036">Values</span><span class="op" id="3388042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388052">if</span>&nbsp;<span class="ident" id="3388055"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388056">.</span><span class="ident" id="3388057">Form</span>&nbsp;<span class="op" id="3388062">==</span>&nbsp;<span class="ident" id="3388065">nil</span>&nbsp;<span class="op" id="3388069">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388073">if</span>&nbsp;<span class="builtinfunc" id="3388076">len</span><span class="op" id="3388079">(</span><span class="ident" id="3388080"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388081">.</span><span class="ident" id="3388082">PostForm</span><span class="op" id="3388090">)</span>&nbsp;<span class="op" id="3388092">&gt;</span>&nbsp;<span class="num" id="3388094">0</span>&nbsp;<span class="op" id="3388096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388101"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388102">.</span><span class="ident" id="3388103">Form</span>&nbsp;<span class="op" id="3388108">=</span>&nbsp;<span class="builtinfunc" id="3388110">make</span><span class="op" id="3388114">(</span><span class="ident" id="3388115"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3388118">.</span><span class="ident" id="3388119">Values</span><span class="op" id="3388125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388130"><a href="/net/http/request.go.html#3385952">copyValues</a></span><span class="op" id="3388140">(</span><span class="ident" id="3388141"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388142">.</span><span class="ident" id="3388143">Form</span><span class="op" id="3388147">,</span>&nbsp;<span class="ident" id="3388149"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388150">.</span><span class="ident" id="3388151">PostForm</span><span class="op" id="3388159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388167">var</span>&nbsp;<span class="ident" id="3388171">newValues</span>&nbsp;<span class="ident" id="3388181"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3388184">.</span><span class="ident" id="3388185">Values</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388194">if</span>&nbsp;<span class="ident" id="3388197"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388198">.</span><span class="ident" id="3388199">URL</span>&nbsp;<span class="op" id="3388203">!=</span>&nbsp;<span class="ident" id="3388206">nil</span>&nbsp;<span class="op" id="3388210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388215">var</span>&nbsp;<span class="ident" id="3388219">e</span>&nbsp;<span class="builtintype" id="3388221">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388230"><a href="/net/http/request.go.html#3388171">newValues</a></span><span class="op" id="3388239">,</span>&nbsp;<span class="ident" id="3388241"><a href="/net/http/request.go.html#3388219">e</a></span>&nbsp;<span class="op" id="3388243">=</span>&nbsp;<span class="ident" id="3388245"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3388248">.</span><span class="ident" id="3388249">ParseQuery</span><span class="op" id="3388259">(</span><span class="ident" id="3388260"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388261">.</span><span class="ident" id="3388262">URL</span><span class="op" id="3388265">.</span><span class="ident" id="3388266">RawQuery</span><span class="op" id="3388274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388279">if</span>&nbsp;<span class="ident" id="3388282"><a href="/net/http/request.go.html#3387840">err</a></span>&nbsp;<span class="op" id="3388286">==</span>&nbsp;<span class="ident" id="3388289">nil</span>&nbsp;<span class="op" id="3388293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388299"><a href="/net/http/request.go.html#3387840">err</a></span>&nbsp;<span class="op" id="3388303">=</span>&nbsp;<span class="ident" id="3388305"><a href="/net/http/request.go.html#3388219">e</a></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388318">if</span>&nbsp;<span class="ident" id="3388321"><a href="/net/http/request.go.html#3388171">newValues</a></span>&nbsp;<span class="op" id="3388331">==</span>&nbsp;<span class="ident" id="3388334">nil</span>&nbsp;<span class="op" id="3388338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388343"><a href="/net/http/request.go.html#3388171">newValues</a></span>&nbsp;<span class="op" id="3388353">=</span>&nbsp;<span class="builtinfunc" id="3388355">make</span><span class="op" id="3388359">(</span><span class="ident" id="3388360"><a href="/net/http/request.go.html#3364682">url</a></span><span class="op" id="3388363">.</span><span class="ident" id="3388364">Values</span><span class="op" id="3388370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388374">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388378">if</span>&nbsp;<span class="ident" id="3388381"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388382">.</span><span class="ident" id="3388383">Form</span>&nbsp;<span class="op" id="3388388">==</span>&nbsp;<span class="ident" id="3388391">nil</span>&nbsp;<span class="op" id="3388395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388400"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388401">.</span><span class="ident" id="3388402">Form</span>&nbsp;<span class="op" id="3388407">=</span>&nbsp;<span class="ident" id="3388409"><a href="/net/http/request.go.html#3388171">newValues</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388421">}</span>&nbsp;<span class="keyword" id="3388423">else</span>&nbsp;<span class="op" id="3388428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3388433"><a href="/net/http/request.go.html#3385952">copyValues</a></span><span class="op" id="3388443">(</span><span class="ident" id="3388444"><a href="/net/http/request.go.html#3387803">r</a></span><span class="op" id="3388445">.</span><span class="ident" id="3388446">Form</span><span class="op" id="3388450">,</span>&nbsp;<span class="ident" id="3388452"><a href="/net/http/request.go.html#3388171">newValues</a></span><span class="op" id="3388461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388465">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3388468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388471">return</span>&nbsp;<span class="ident" id="3388478"><a href="/net/http/request.go.html#3387840">err</a></span><br>
<span class="lineno"></span><span class="op" id="3388482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3388485">//&nbsp;ParseMultipartForm&nbsp;parses&nbsp;a&nbsp;request&nbsp;body&nbsp;as&nbsp;multipart/form-data.</span><br>
<span class="lineno">815</span><span class="comment" id="3388553">//&nbsp;The&nbsp;whole&nbsp;request&nbsp;body&nbsp;is&nbsp;parsed&nbsp;and&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;of&nbsp;maxMemory&nbsp;bytes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3388629">//&nbsp;its&nbsp;file&nbsp;parts&nbsp;are&nbsp;stored&nbsp;in&nbsp;memory,&nbsp;with&nbsp;the&nbsp;remainder&nbsp;stored&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3388698">//&nbsp;disk&nbsp;in&nbsp;temporary&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="3388726">//&nbsp;ParseMultipartForm&nbsp;calls&nbsp;ParseForm&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="comment" id="3388778">//&nbsp;After&nbsp;one&nbsp;call&nbsp;to&nbsp;ParseMultipartForm,&nbsp;subsequent&nbsp;calls&nbsp;have&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">820</span><span class="keyword" id="3388852">func</span>&nbsp;<span class="op" id="3388857">(</span><span class="ident" id="3388858">r</span>&nbsp;<span class="op" id="3388860">*</span><span class="ident" id="3388861"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3388868">)</span>&nbsp;<span class="ident" id="3388870">ParseMultipartForm</span><span class="op" id="3388888">(</span><span class="ident" id="3388889">maxMemory</span>&nbsp;<span class="ident" id="3388899">int64</span><span class="op" id="3388904">)</span>&nbsp;<span class="builtintype" id="3388906">error</span>&nbsp;<span class="op" id="3388912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388915">if</span>&nbsp;<span class="ident" id="3388918"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3388919">.</span><span class="ident" id="3388920">MultipartForm</span>&nbsp;<span class="op" id="3388934">==</span>&nbsp;<span class="ident" id="3388937"><a href="/net/http/request.go.html#3374472">multipartByReader</a></span>&nbsp;<span class="op" id="3388955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3388959">return</span>&nbsp;<span class="ident" id="3388966"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3388972">.</span><span class="ident" id="3388973">New</span><span class="op" id="3388976">(</span><span class="string" id="3388977">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;MultipartReader&#34;</span><span class="op" id="3389021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389027">if</span>&nbsp;<span class="ident" id="3389030"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389031">.</span><span class="ident" id="3389032">Form</span>&nbsp;<span class="op" id="3389037">==</span>&nbsp;<span class="ident" id="3389040">nil</span>&nbsp;<span class="op" id="3389044">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389048">err</span>&nbsp;<span class="op" id="3389052">:=</span>&nbsp;<span class="ident" id="3389055"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389056">.</span><span class="ident" id="3389057">ParseForm</span><span class="op" id="3389066">(</span><span class="op" id="3389067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389071">if</span>&nbsp;<span class="ident" id="3389074"><a href="/net/http/request.go.html#3389048">err</a></span>&nbsp;<span class="op" id="3389078">!=</span>&nbsp;<span class="ident" id="3389081">nil</span>&nbsp;<span class="op" id="3389085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389090">return</span>&nbsp;<span class="ident" id="3389097"><a href="/net/http/request.go.html#3389048">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389106">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389109">if</span>&nbsp;<span class="ident" id="3389112"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389113">.</span><span class="ident" id="3389114">MultipartForm</span>&nbsp;<span class="op" id="3389128">!=</span>&nbsp;<span class="ident" id="3389131">nil</span>&nbsp;<span class="op" id="3389135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389139">return</span>&nbsp;<span class="ident" id="3389146">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389155">mr</span><span class="op" id="3389157">,</span>&nbsp;<span class="ident" id="3389159">err</span>&nbsp;<span class="op" id="3389163">:=</span>&nbsp;<span class="ident" id="3389166"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389167">.</span><span class="ident" id="3389168">multipartReader</span><span class="op" id="3389183">(</span><span class="op" id="3389184">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389187">if</span>&nbsp;<span class="ident" id="3389190"><a href="/net/http/request.go.html#3389159">err</a></span>&nbsp;<span class="op" id="3389194">!=</span>&nbsp;<span class="ident" id="3389197">nil</span>&nbsp;<span class="op" id="3389201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389205">return</span>&nbsp;<span class="ident" id="3389212"><a href="/net/http/request.go.html#3389159">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389221">f</span><span class="op" id="3389222">,</span>&nbsp;<span class="ident" id="3389224"><a href="/net/http/request.go.html#3389159">err</a></span>&nbsp;<span class="op" id="3389228">:=</span>&nbsp;<span class="ident" id="3389231"><a href="/net/http/request.go.html#3389155">mr</a></span><span class="op" id="3389233">.</span><span class="ident" id="3389234">ReadForm</span><span class="op" id="3389242">(</span><span class="ident" id="3389243"><a href="/net/http/request.go.html#3388889">maxMemory</a></span><span class="op" id="3389252">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389255">if</span>&nbsp;<span class="ident" id="3389258"><a href="/net/http/request.go.html#3389159">err</a></span>&nbsp;<span class="op" id="3389262">!=</span>&nbsp;<span class="ident" id="3389265">nil</span>&nbsp;<span class="op" id="3389269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389273">return</span>&nbsp;<span class="ident" id="3389280"><a href="/net/http/request.go.html#3389159">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389288">for</span>&nbsp;<span class="ident" id="3389292">k</span><span class="op" id="3389293">,</span>&nbsp;<span class="ident" id="3389295">v</span>&nbsp;<span class="op" id="3389297">:=</span>&nbsp;<span class="keyword" id="3389300">range</span>&nbsp;<span class="ident" id="3389306"><a href="/net/http/request.go.html#3389221">f</a></span><span class="op" id="3389307">.</span><span class="ident" id="3389308">Value</span>&nbsp;<span class="op" id="3389314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389318"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389319">.</span><span class="ident" id="3389320">Form</span><span class="op" id="3389324">[</span><span class="ident" id="3389325"><a href="/net/http/request.go.html#3389292">k</a></span><span class="op" id="3389326">]</span>&nbsp;<span class="op" id="3389328">=</span>&nbsp;<span class="builtinfunc" id="3389330">append</span><span class="op" id="3389336">(</span><span class="ident" id="3389337"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389338">.</span><span class="ident" id="3389339">Form</span><span class="op" id="3389343">[</span><span class="ident" id="3389344"><a href="/net/http/request.go.html#3389292">k</a></span><span class="op" id="3389345">]</span><span class="op" id="3389346">,</span>&nbsp;<span class="ident" id="3389348"><a href="/net/http/request.go.html#3389295">v</a></span><span class="op" id="3389349">...</span><span class="op" id="3389352">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389358"><a href="/net/http/request.go.html#3388858">r</a></span><span class="op" id="3389359">.</span><span class="ident" id="3389360">MultipartForm</span>&nbsp;<span class="op" id="3389374">=</span>&nbsp;<span class="ident" id="3389376"><a href="/net/http/request.go.html#3389221">f</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389380">return</span>&nbsp;<span class="ident" id="3389387">nil</span><br>
<span class="lineno"></span><span class="op" id="3389391">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="comment" id="3389394">//&nbsp;FormValue&nbsp;returns&nbsp;the&nbsp;first&nbsp;value&nbsp;for&nbsp;the&nbsp;named&nbsp;component&nbsp;of&nbsp;the&nbsp;query.</span><br>
<span class="lineno"></span><span class="comment" id="3389469">//&nbsp;POST&nbsp;and&nbsp;PUT&nbsp;body&nbsp;parameters&nbsp;take&nbsp;precedence&nbsp;over&nbsp;URL&nbsp;query&nbsp;string&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="3389547">//&nbsp;FormValue&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary&nbsp;and&nbsp;ignores</span><br>
<span class="lineno"></span><span class="comment" id="3389624">//&nbsp;any&nbsp;errors&nbsp;returned&nbsp;by&nbsp;these&nbsp;functions.</span><br>
<span class="lineno">855</span><span class="comment" id="3389667">//&nbsp;To&nbsp;access&nbsp;multiple&nbsp;values&nbsp;of&nbsp;the&nbsp;same&nbsp;key,&nbsp;call&nbsp;ParseForm&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3389732">//&nbsp;then&nbsp;inspect&nbsp;Request.Form&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="3389771">func</span>&nbsp;<span class="op" id="3389776">(</span><span class="ident" id="3389777">r</span>&nbsp;<span class="op" id="3389779">*</span><span class="ident" id="3389780"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3389787">)</span>&nbsp;<span class="ident" id="3389789">FormValue</span><span class="op" id="3389798">(</span><span class="ident" id="3389799">key</span>&nbsp;<span class="builtintype" id="3389803">string</span><span class="op" id="3389809">)</span>&nbsp;<span class="builtintype" id="3389811">string</span>&nbsp;<span class="op" id="3389818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389821">if</span>&nbsp;<span class="ident" id="3389824"><a href="/net/http/request.go.html#3389777">r</a></span><span class="op" id="3389825">.</span><span class="ident" id="3389826">Form</span>&nbsp;<span class="op" id="3389831">==</span>&nbsp;<span class="ident" id="3389834">nil</span>&nbsp;<span class="op" id="3389838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3389842"><a href="/net/http/request.go.html#3389777">r</a></span><span class="op" id="3389843">.</span><span class="ident" id="3389844">ParseMultipartForm</span><span class="op" id="3389862">(</span><span class="ident" id="3389863"><a href="/net/http/request.go.html#3364828">defaultMaxMemory</a></span><span class="op" id="3389879">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389885">if</span>&nbsp;<span class="ident" id="3389888">vs</span>&nbsp;<span class="op" id="3389891">:=</span>&nbsp;<span class="ident" id="3389894"><a href="/net/http/request.go.html#3389777">r</a></span><span class="op" id="3389895">.</span><span class="ident" id="3389896">Form</span><span class="op" id="3389900">[</span><span class="ident" id="3389901"><a href="/net/http/request.go.html#3389799">key</a></span><span class="op" id="3389904">]</span><span class="op" id="3389905">;</span>&nbsp;<span class="builtinfunc" id="3389907">len</span><span class="op" id="3389910">(</span><span class="ident" id="3389911"><a href="/net/http/request.go.html#3389888">vs</a></span><span class="op" id="3389913">)</span>&nbsp;<span class="op" id="3389915">&gt;</span>&nbsp;<span class="num" id="3389917">0</span>&nbsp;<span class="op" id="3389919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389923">return</span>&nbsp;<span class="ident" id="3389930"><a href="/net/http/request.go.html#3389888">vs</a></span><span class="op" id="3389932">[</span><span class="num" id="3389933">0</span><span class="op" id="3389934">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3389937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3389940">return</span>&nbsp;<span class="string" id="3389947">&#34;&#34;</span><br>
<span class="lineno">865</span><span class="op" id="3389950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3389953">//&nbsp;PostFormValue&nbsp;returns&nbsp;the&nbsp;first&nbsp;value&nbsp;for&nbsp;the&nbsp;named&nbsp;component&nbsp;of&nbsp;the&nbsp;POST</span><br>
<span class="lineno"></span><span class="comment" id="3390030">//&nbsp;or&nbsp;PUT&nbsp;request&nbsp;body.&nbsp;URL&nbsp;query&nbsp;parameters&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3390088">//&nbsp;PostFormValue&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary&nbsp;and&nbsp;ignores</span><br>
<span class="lineno">870</span><span class="comment" id="3390169">//&nbsp;any&nbsp;errors&nbsp;returned&nbsp;by&nbsp;these&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3390212">func</span>&nbsp;<span class="op" id="3390217">(</span><span class="ident" id="3390218">r</span>&nbsp;<span class="op" id="3390220">*</span><span class="ident" id="3390221"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3390228">)</span>&nbsp;<span class="ident" id="3390230">PostFormValue</span><span class="op" id="3390243">(</span><span class="ident" id="3390244">key</span>&nbsp;<span class="builtintype" id="3390248">string</span><span class="op" id="3390254">)</span>&nbsp;<span class="builtintype" id="3390256">string</span>&nbsp;<span class="op" id="3390263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390266">if</span>&nbsp;<span class="ident" id="3390269"><a href="/net/http/request.go.html#3390218">r</a></span><span class="op" id="3390270">.</span><span class="ident" id="3390271">PostForm</span>&nbsp;<span class="op" id="3390280">==</span>&nbsp;<span class="ident" id="3390283">nil</span>&nbsp;<span class="op" id="3390287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3390291"><a href="/net/http/request.go.html#3390218">r</a></span><span class="op" id="3390292">.</span><span class="ident" id="3390293">ParseMultipartForm</span><span class="op" id="3390311">(</span><span class="ident" id="3390312"><a href="/net/http/request.go.html#3364828">defaultMaxMemory</a></span><span class="op" id="3390328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3390331">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390334">if</span>&nbsp;<span class="ident" id="3390337">vs</span>&nbsp;<span class="op" id="3390340">:=</span>&nbsp;<span class="ident" id="3390343"><a href="/net/http/request.go.html#3390218">r</a></span><span class="op" id="3390344">.</span><span class="ident" id="3390345">PostForm</span><span class="op" id="3390353">[</span><span class="ident" id="3390354"><a href="/net/http/request.go.html#3390244">key</a></span><span class="op" id="3390357">]</span><span class="op" id="3390358">;</span>&nbsp;<span class="builtinfunc" id="3390360">len</span><span class="op" id="3390363">(</span><span class="ident" id="3390364"><a href="/net/http/request.go.html#3390337">vs</a></span><span class="op" id="3390366">)</span>&nbsp;<span class="op" id="3390368">&gt;</span>&nbsp;<span class="num" id="3390370">0</span>&nbsp;<span class="op" id="3390372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390376">return</span>&nbsp;<span class="ident" id="3390383"><a href="/net/http/request.go.html#3390337">vs</a></span><span class="op" id="3390385">[</span><span class="num" id="3390386">0</span><span class="op" id="3390387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3390390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390393">return</span>&nbsp;<span class="string" id="3390400">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3390403">}</span><br>
<span class="lineno">880</span><br>
<span class="lineno"></span><span class="comment" id="3390406">//&nbsp;FormFile&nbsp;returns&nbsp;the&nbsp;first&nbsp;file&nbsp;for&nbsp;the&nbsp;provided&nbsp;form&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3390468">//&nbsp;FormFile&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="3390533">func</span>&nbsp;<span class="op" id="3390538">(</span><span class="ident" id="3390539">r</span>&nbsp;<span class="op" id="3390541">*</span><span class="ident" id="3390542"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3390549">)</span>&nbsp;<span class="ident" id="3390551">FormFile</span><span class="op" id="3390559">(</span><span class="ident" id="3390560">key</span>&nbsp;<span class="builtintype" id="3390564">string</span><span class="op" id="3390570">)</span>&nbsp;<span class="op" id="3390572">(</span><span class="ident" id="3390573"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3390582">.</span><span class="ident" id="3390583">File</span><span class="op" id="3390587">,</span>&nbsp;<span class="op" id="3390589">*</span><span class="ident" id="3390590"><a href="/net/http/request.go.html#3364647">multipart</a></span><span class="op" id="3390599">.</span><span class="ident" id="3390600">FileHeader</span><span class="op" id="3390610">,</span>&nbsp;<span class="builtintype" id="3390612">error</span><span class="op" id="3390617">)</span>&nbsp;<span class="op" id="3390619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390622">if</span>&nbsp;<span class="ident" id="3390625"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390626">.</span><span class="ident" id="3390627">MultipartForm</span>&nbsp;<span class="op" id="3390641">==</span>&nbsp;<span class="ident" id="3390644"><a href="/net/http/request.go.html#3374472">multipartByReader</a></span>&nbsp;<span class="op" id="3390662">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390666">return</span>&nbsp;<span class="ident" id="3390673">nil</span><span class="op" id="3390676">,</span>&nbsp;<span class="ident" id="3390678">nil</span><span class="op" id="3390681">,</span>&nbsp;<span class="ident" id="3390683"><a href="/net/http/request.go.html#3364603">errors</a></span><span class="op" id="3390689">.</span><span class="ident" id="3390690">New</span><span class="op" id="3390693">(</span><span class="string" id="3390694">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;MultipartReader&#34;</span><span class="op" id="3390738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3390741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390744">if</span>&nbsp;<span class="ident" id="3390747"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390748">.</span><span class="ident" id="3390749">MultipartForm</span>&nbsp;<span class="op" id="3390763">==</span>&nbsp;<span class="ident" id="3390766">nil</span>&nbsp;<span class="op" id="3390770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3390774">err</span>&nbsp;<span class="op" id="3390778">:=</span>&nbsp;<span class="ident" id="3390781"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390782">.</span><span class="ident" id="3390783">ParseMultipartForm</span><span class="op" id="3390801">(</span><span class="ident" id="3390802"><a href="/net/http/request.go.html#3364828">defaultMaxMemory</a></span><span class="op" id="3390818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390822">if</span>&nbsp;<span class="ident" id="3390825"><a href="/net/http/request.go.html#3390774">err</a></span>&nbsp;<span class="op" id="3390829">!=</span>&nbsp;<span class="ident" id="3390832">nil</span>&nbsp;<span class="op" id="3390836">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390841">return</span>&nbsp;<span class="ident" id="3390848">nil</span><span class="op" id="3390851">,</span>&nbsp;<span class="ident" id="3390853">nil</span><span class="op" id="3390856">,</span>&nbsp;<span class="ident" id="3390858"><a href="/net/http/request.go.html#3390774">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3390864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3390867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390870">if</span>&nbsp;<span class="ident" id="3390873"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390874">.</span><span class="ident" id="3390875">MultipartForm</span>&nbsp;<span class="op" id="3390889">!=</span>&nbsp;<span class="ident" id="3390892">nil</span>&nbsp;<span class="op" id="3390896">&amp;&amp;</span>&nbsp;<span class="ident" id="3390899"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390900">.</span><span class="ident" id="3390901">MultipartForm</span><span class="op" id="3390914">.</span><span class="ident" id="3390915">File</span>&nbsp;<span class="op" id="3390920">!=</span>&nbsp;<span class="ident" id="3390923">nil</span>&nbsp;<span class="op" id="3390927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3390931">if</span>&nbsp;<span class="ident" id="3390934">fhs</span>&nbsp;<span class="op" id="3390938">:=</span>&nbsp;<span class="ident" id="3390941"><a href="/net/http/request.go.html#3390539">r</a></span><span class="op" id="3390942">.</span><span class="ident" id="3390943">MultipartForm</span><span class="op" id="3390956">.</span><span class="ident" id="3390957">File</span><span class="op" id="3390961">[</span><span class="ident" id="3390962"><a href="/net/http/request.go.html#3390560">key</a></span><span class="op" id="3390965">]</span><span class="op" id="3390966">;</span>&nbsp;<span class="builtinfunc" id="3390968">len</span><span class="op" id="3390971">(</span><span class="ident" id="3390972"><a href="/net/http/request.go.html#3390934">fhs</a></span><span class="op" id="3390975">)</span>&nbsp;<span class="op" id="3390977">&gt;</span>&nbsp;<span class="num" id="3390979">0</span>&nbsp;<span class="op" id="3390981">{</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3390986">f</span><span class="op" id="3390987">,</span>&nbsp;<span class="ident" id="3390989">err</span>&nbsp;<span class="op" id="3390993">:=</span>&nbsp;<span class="ident" id="3390996"><a href="/net/http/request.go.html#3390934">fhs</a></span><span class="op" id="3390999">[</span><span class="num" id="3391000">0</span><span class="op" id="3391001">]</span><span class="op" id="3391002">.</span><span class="ident" id="3391003">Open</span><span class="op" id="3391007">(</span><span class="op" id="3391008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391013">return</span>&nbsp;<span class="ident" id="3391020"><a href="/net/http/request.go.html#3390986">f</a></span><span class="op" id="3391021">,</span>&nbsp;<span class="ident" id="3391023"><a href="/net/http/request.go.html#3390934">fhs</a></span><span class="op" id="3391026">[</span><span class="num" id="3391027">0</span><span class="op" id="3391028">]</span><span class="op" id="3391029">,</span>&nbsp;<span class="ident" id="3391031"><a href="/net/http/request.go.html#3390989">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3391037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3391040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391043">return</span>&nbsp;<span class="ident" id="3391050">nil</span><span class="op" id="3391053">,</span>&nbsp;<span class="ident" id="3391055">nil</span><span class="op" id="3391058">,</span>&nbsp;<span class="ident" id="3391060"><a href="/net/http/request.go.html#3365009">ErrMissingFile</a></span><br>
<span class="lineno">900</span><span class="op" id="3391075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3391078">func</span>&nbsp;<span class="op" id="3391083">(</span><span class="ident" id="3391084">r</span>&nbsp;<span class="op" id="3391086">*</span><span class="ident" id="3391087"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3391094">)</span>&nbsp;<span class="ident" id="3391096">expectsContinue</span><span class="op" id="3391111">(</span><span class="op" id="3391112">)</span>&nbsp;<span class="builtintype" id="3391114">bool</span>&nbsp;<span class="op" id="3391119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391122">return</span>&nbsp;<span class="ident" id="3391129"><a href="/net/http/header.go.html#3361024">hasToken</a></span><span class="op" id="3391137">(</span><span class="ident" id="3391138"><a href="/net/http/request.go.html#3391084">r</a></span><span class="op" id="3391139">.</span><span class="ident" id="3391140">Header</span><span class="op" id="3391146">.</span><span class="ident" id="3391147">get</span><span class="op" id="3391150">(</span><span class="string" id="3391151">&#34;Expect&#34;</span><span class="op" id="3391159">)</span><span class="op" id="3391160">,</span>&nbsp;<span class="string" id="3391162">&#34;100-continue&#34;</span><span class="op" id="3391176">)</span><br>
<span class="lineno"></span><span class="op" id="3391178">}</span><br>
<span class="lineno">905</span><br>
<span class="lineno"></span><span class="keyword" id="3391181">func</span>&nbsp;<span class="op" id="3391186">(</span><span class="ident" id="3391187">r</span>&nbsp;<span class="op" id="3391189">*</span><span class="ident" id="3391190"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3391197">)</span>&nbsp;<span class="ident" id="3391199">wantsHttp10KeepAlive</span><span class="op" id="3391219">(</span><span class="op" id="3391220">)</span>&nbsp;<span class="builtintype" id="3391222">bool</span>&nbsp;<span class="op" id="3391227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391230">if</span>&nbsp;<span class="ident" id="3391233"><a href="/net/http/request.go.html#3391187">r</a></span><span class="op" id="3391234">.</span><span class="ident" id="3391235">ProtoMajor</span>&nbsp;<span class="op" id="3391246">!=</span>&nbsp;<span class="num" id="3391249">1</span>&nbsp;<span class="op" id="3391251">||</span>&nbsp;<span class="ident" id="3391254"><a href="/net/http/request.go.html#3391187">r</a></span><span class="op" id="3391255">.</span><span class="ident" id="3391256">ProtoMinor</span>&nbsp;<span class="op" id="3391267">!=</span>&nbsp;<span class="num" id="3391270">0</span>&nbsp;<span class="op" id="3391272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391276">return</span>&nbsp;<span class="builtintype" id="3391283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3391290">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391293">return</span>&nbsp;<span class="ident" id="3391300"><a href="/net/http/header.go.html#3361024">hasToken</a></span><span class="op" id="3391308">(</span><span class="ident" id="3391309"><a href="/net/http/request.go.html#3391187">r</a></span><span class="op" id="3391310">.</span><span class="ident" id="3391311">Header</span><span class="op" id="3391317">.</span><span class="ident" id="3391318">get</span><span class="op" id="3391321">(</span><span class="string" id="3391322">&#34;Connection&#34;</span><span class="op" id="3391334">)</span><span class="op" id="3391335">,</span>&nbsp;<span class="string" id="3391337">&#34;keep-alive&#34;</span><span class="op" id="3391349">)</span><br>
<span class="lineno"></span><span class="op" id="3391351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3391354">func</span>&nbsp;<span class="op" id="3391359">(</span><span class="ident" id="3391360">r</span>&nbsp;<span class="op" id="3391362">*</span><span class="ident" id="3391363"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3391370">)</span>&nbsp;<span class="ident" id="3391372">wantsClose</span><span class="op" id="3391382">(</span><span class="op" id="3391383">)</span>&nbsp;<span class="builtintype" id="3391385">bool</span>&nbsp;<span class="op" id="3391390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391393">return</span>&nbsp;<span class="ident" id="3391400"><a href="/net/http/header.go.html#3361024">hasToken</a></span><span class="op" id="3391408">(</span><span class="ident" id="3391409"><a href="/net/http/request.go.html#3391360">r</a></span><span class="op" id="3391410">.</span><span class="ident" id="3391411">Header</span><span class="op" id="3391417">.</span><span class="ident" id="3391418">get</span><span class="op" id="3391421">(</span><span class="string" id="3391422">&#34;Connection&#34;</span><span class="op" id="3391434">)</span><span class="op" id="3391435">,</span>&nbsp;<span class="string" id="3391437">&#34;close&#34;</span><span class="op" id="3391444">)</span><br>
<span class="lineno">915</span><span class="op" id="3391446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3391449">func</span>&nbsp;<span class="op" id="3391454">(</span><span class="ident" id="3391455">r</span>&nbsp;<span class="op" id="3391457">*</span><span class="ident" id="3391458"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3391465">)</span>&nbsp;<span class="ident" id="3391467">closeBody</span><span class="op" id="3391476">(</span><span class="op" id="3391477">)</span>&nbsp;<span class="op" id="3391479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3391482">if</span>&nbsp;<span class="ident" id="3391485"><a href="/net/http/request.go.html#3391455">r</a></span><span class="op" id="3391486">.</span><span class="ident" id="3391487">Body</span>&nbsp;<span class="op" id="3391492">!=</span>&nbsp;<span class="ident" id="3391495">nil</span>&nbsp;<span class="op" id="3391499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3391503"><a href="/net/http/request.go.html#3391455">r</a></span><span class="op" id="3391504">.</span><span class="ident" id="3391505">Body</span><span class="op" id="3391509">.</span><span class="ident" id="3391510">Close</span><span class="op" id="3391515">(</span><span class="op" id="3391516">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3391519">}</span><br>
<span class="lineno"></span><span class="op" id="3391521">}</span>
</div>
</body>
</html>
