<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4514195">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4514250">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4514304">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4514355">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4514433">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4514451">package</span>&nbsp;<span class="ident" id="4514459">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514467">import</span>&nbsp;<span class="op" id="4514474">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4514477">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4514487">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4514494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514497">func</span>&nbsp;<span class="ident" id="4514502">init</span><span class="op" id="4514506">(</span><span class="op" id="4514507">)</span>&nbsp;<span class="op" id="4514509">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514512">crypto</span><span class="op" id="4514518">.</span><span class="ident" id="4514519">RegisterHash</span><span class="op" id="4514531">(</span><span class="ident" id="4514532">crypto</span><span class="op" id="4514538">.</span><span class="ident" id="4514539">SHA224</span><span class="op" id="4514545">,</span>&nbsp;<span class="ident" id="4514547">New224</span><span class="op" id="4514553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514556">crypto</span><span class="op" id="4514562">.</span><span class="ident" id="4514563">RegisterHash</span><span class="op" id="4514575">(</span><span class="ident" id="4514576">crypto</span><span class="op" id="4514582">.</span><span class="ident" id="4514583">SHA256</span><span class="op" id="4514589">,</span>&nbsp;<span class="ident" id="4514591">New</span><span class="op" id="4514594">)</span><br>
<span class="lineno"></span><span class="op" id="4514596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4514599">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4514642">const</span>&nbsp;<span class="ident" id="4514648">Size</span>&nbsp;<span class="op" id="4514653">=</span>&nbsp;<span class="num" id="4514655">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4514659">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4514702">const</span>&nbsp;<span class="ident" id="4514708">Size224</span>&nbsp;<span class="op" id="4514716">=</span>&nbsp;<span class="num" id="4514718">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4514722">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4514770">const</span>&nbsp;<span class="ident" id="4514776">BlockSize</span>&nbsp;<span class="op" id="4514786">=</span>&nbsp;<span class="num" id="4514788">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4514792">const</span>&nbsp;<span class="op" id="4514798">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514801">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514811">=</span>&nbsp;<span class="num" id="4514813">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514817">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514827">=</span>&nbsp;<span class="num" id="4514829">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514841">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514851">=</span>&nbsp;<span class="num" id="4514853">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514865">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514875">=</span>&nbsp;<span class="num" id="4514877">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514889">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514899">=</span>&nbsp;<span class="num" id="4514901">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514913">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514923">=</span>&nbsp;<span class="num" id="4514925">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514937">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514947">=</span>&nbsp;<span class="num" id="4514949">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514961">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514971">=</span>&nbsp;<span class="num" id="4514973">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514985">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514995">=</span>&nbsp;<span class="num" id="4514997">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515009">init0_224</span>&nbsp;<span class="op" id="4515019">=</span>&nbsp;<span class="num" id="4515021">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515033">init1_224</span>&nbsp;<span class="op" id="4515043">=</span>&nbsp;<span class="num" id="4515045">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515057">init2_224</span>&nbsp;<span class="op" id="4515067">=</span>&nbsp;<span class="num" id="4515069">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515081">init3_224</span>&nbsp;<span class="op" id="4515091">=</span>&nbsp;<span class="num" id="4515093">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515105">init4_224</span>&nbsp;<span class="op" id="4515115">=</span>&nbsp;<span class="num" id="4515117">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515129">init5_224</span>&nbsp;<span class="op" id="4515139">=</span>&nbsp;<span class="num" id="4515141">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515153">init6_224</span>&nbsp;<span class="op" id="4515163">=</span>&nbsp;<span class="num" id="4515165">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515177">init7_224</span>&nbsp;<span class="op" id="4515187">=</span>&nbsp;<span class="num" id="4515189">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4515200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4515203">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4515262">type</span>&nbsp;<span class="ident" id="4515267">digest</span>&nbsp;<span class="keyword" id="4515274">struct</span>&nbsp;<span class="op" id="4515281">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515284">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515290">[</span><span class="num" id="4515291">8</span><span class="op" id="4515292">]</span><span class="builtintype" id="4515293">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515301">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515307">[</span><span class="ident" id="4515308">chunk</span><span class="op" id="4515313">]</span><span class="builtintype" id="4515314">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515320">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4515326">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4515331">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4515337">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515345">is224</span>&nbsp;<span class="builtintype" id="4515351">bool</span>&nbsp;<span class="comment" id="4515356">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4515390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4515393">func</span>&nbsp;<span class="op" id="4515398">(</span><span class="ident" id="4515399">d</span>&nbsp;<span class="op" id="4515401">*</span><span class="ident" id="4515402">digest</span><span class="op" id="4515408">)</span>&nbsp;<span class="ident" id="4515410">Reset</span><span class="op" id="4515415">(</span><span class="op" id="4515416">)</span>&nbsp;<span class="op" id="4515418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515421">if</span>&nbsp;<span class="op" id="4515424">!</span><span class="ident" id="4515425">d</span><span class="op" id="4515426">.</span><span class="ident" id="4515427">is224</span>&nbsp;<span class="op" id="4515433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515437">d</span><span class="op" id="4515438">.</span><span class="ident" id="4515439">h</span><span class="op" id="4515440">[</span><span class="num" id="4515441">0</span><span class="op" id="4515442">]</span>&nbsp;<span class="op" id="4515444">=</span>&nbsp;<span class="ident" id="4515446">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515454">d</span><span class="op" id="4515455">.</span><span class="ident" id="4515456">h</span><span class="op" id="4515457">[</span><span class="num" id="4515458">1</span><span class="op" id="4515459">]</span>&nbsp;<span class="op" id="4515461">=</span>&nbsp;<span class="ident" id="4515463">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515471">d</span><span class="op" id="4515472">.</span><span class="ident" id="4515473">h</span><span class="op" id="4515474">[</span><span class="num" id="4515475">2</span><span class="op" id="4515476">]</span>&nbsp;<span class="op" id="4515478">=</span>&nbsp;<span class="ident" id="4515480">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515488">d</span><span class="op" id="4515489">.</span><span class="ident" id="4515490">h</span><span class="op" id="4515491">[</span><span class="num" id="4515492">3</span><span class="op" id="4515493">]</span>&nbsp;<span class="op" id="4515495">=</span>&nbsp;<span class="ident" id="4515497">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515505">d</span><span class="op" id="4515506">.</span><span class="ident" id="4515507">h</span><span class="op" id="4515508">[</span><span class="num" id="4515509">4</span><span class="op" id="4515510">]</span>&nbsp;<span class="op" id="4515512">=</span>&nbsp;<span class="ident" id="4515514">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515522">d</span><span class="op" id="4515523">.</span><span class="ident" id="4515524">h</span><span class="op" id="4515525">[</span><span class="num" id="4515526">5</span><span class="op" id="4515527">]</span>&nbsp;<span class="op" id="4515529">=</span>&nbsp;<span class="ident" id="4515531">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515539">d</span><span class="op" id="4515540">.</span><span class="ident" id="4515541">h</span><span class="op" id="4515542">[</span><span class="num" id="4515543">6</span><span class="op" id="4515544">]</span>&nbsp;<span class="op" id="4515546">=</span>&nbsp;<span class="ident" id="4515548">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515556">d</span><span class="op" id="4515557">.</span><span class="ident" id="4515558">h</span><span class="op" id="4515559">[</span><span class="num" id="4515560">7</span><span class="op" id="4515561">]</span>&nbsp;<span class="op" id="4515563">=</span>&nbsp;<span class="ident" id="4515565">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515572">}</span>&nbsp;<span class="keyword" id="4515574">else</span>&nbsp;<span class="op" id="4515579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515583">d</span><span class="op" id="4515584">.</span><span class="ident" id="4515585">h</span><span class="op" id="4515586">[</span><span class="num" id="4515587">0</span><span class="op" id="4515588">]</span>&nbsp;<span class="op" id="4515590">=</span>&nbsp;<span class="ident" id="4515592">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515604">d</span><span class="op" id="4515605">.</span><span class="ident" id="4515606">h</span><span class="op" id="4515607">[</span><span class="num" id="4515608">1</span><span class="op" id="4515609">]</span>&nbsp;<span class="op" id="4515611">=</span>&nbsp;<span class="ident" id="4515613">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515625">d</span><span class="op" id="4515626">.</span><span class="ident" id="4515627">h</span><span class="op" id="4515628">[</span><span class="num" id="4515629">2</span><span class="op" id="4515630">]</span>&nbsp;<span class="op" id="4515632">=</span>&nbsp;<span class="ident" id="4515634">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515646">d</span><span class="op" id="4515647">.</span><span class="ident" id="4515648">h</span><span class="op" id="4515649">[</span><span class="num" id="4515650">3</span><span class="op" id="4515651">]</span>&nbsp;<span class="op" id="4515653">=</span>&nbsp;<span class="ident" id="4515655">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515667">d</span><span class="op" id="4515668">.</span><span class="ident" id="4515669">h</span><span class="op" id="4515670">[</span><span class="num" id="4515671">4</span><span class="op" id="4515672">]</span>&nbsp;<span class="op" id="4515674">=</span>&nbsp;<span class="ident" id="4515676">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515688">d</span><span class="op" id="4515689">.</span><span class="ident" id="4515690">h</span><span class="op" id="4515691">[</span><span class="num" id="4515692">5</span><span class="op" id="4515693">]</span>&nbsp;<span class="op" id="4515695">=</span>&nbsp;<span class="ident" id="4515697">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515709">d</span><span class="op" id="4515710">.</span><span class="ident" id="4515711">h</span><span class="op" id="4515712">[</span><span class="num" id="4515713">6</span><span class="op" id="4515714">]</span>&nbsp;<span class="op" id="4515716">=</span>&nbsp;<span class="ident" id="4515718">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515730">d</span><span class="op" id="4515731">.</span><span class="ident" id="4515732">h</span><span class="op" id="4515733">[</span><span class="num" id="4515734">7</span><span class="op" id="4515735">]</span>&nbsp;<span class="op" id="4515737">=</span>&nbsp;<span class="ident" id="4515739">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515753">d</span><span class="op" id="4515754">.</span><span class="ident" id="4515755">nx</span>&nbsp;<span class="op" id="4515758">=</span>&nbsp;<span class="num" id="4515760">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515763">d</span><span class="op" id="4515764">.</span><span class="builtinfunc" id="4515765">len</span>&nbsp;<span class="op" id="4515769">=</span>&nbsp;<span class="num" id="4515771">0</span><br>
<span class="lineno"></span><span class="op" id="4515773">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4515776">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4515838">func</span>&nbsp;<span class="ident" id="4515843">New</span><span class="op" id="4515846">(</span><span class="op" id="4515847">)</span>&nbsp;<span class="ident" id="4515849">hash</span><span class="op" id="4515853">.</span><span class="ident" id="4515854">Hash</span>&nbsp;<span class="op" id="4515859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515862">d</span>&nbsp;<span class="op" id="4515864">:=</span>&nbsp;<span class="builtinfunc" id="4515867">new</span><span class="op" id="4515870">(</span><span class="ident" id="4515871">digest</span><span class="op" id="4515877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515880">d</span><span class="op" id="4515881">.</span><span class="ident" id="4515882">Reset</span><span class="op" id="4515887">(</span><span class="op" id="4515888">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515891">return</span>&nbsp;<span class="ident" id="4515898">d</span><br>
<span class="lineno"></span><span class="op" id="4515900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4515903">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4515968">func</span>&nbsp;<span class="ident" id="4515973">New224</span><span class="op" id="4515979">(</span><span class="op" id="4515980">)</span>&nbsp;<span class="ident" id="4515982">hash</span><span class="op" id="4515986">.</span><span class="ident" id="4515987">Hash</span>&nbsp;<span class="op" id="4515992">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515995">d</span>&nbsp;<span class="op" id="4515997">:=</span>&nbsp;<span class="builtinfunc" id="4516000">new</span><span class="op" id="4516003">(</span><span class="ident" id="4516004">digest</span><span class="op" id="4516010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516013">d</span><span class="op" id="4516014">.</span><span class="ident" id="4516015">is224</span>&nbsp;<span class="op" id="4516021">=</span>&nbsp;<span class="builtintype" id="4516023">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516029">d</span><span class="op" id="4516030">.</span><span class="ident" id="4516031">Reset</span><span class="op" id="4516036">(</span><span class="op" id="4516037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516040">return</span>&nbsp;<span class="ident" id="4516047">d</span><br>
<span class="lineno"></span><span class="op" id="4516049">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4516052">func</span>&nbsp;<span class="op" id="4516057">(</span><span class="ident" id="4516058">d</span>&nbsp;<span class="op" id="4516060">*</span><span class="ident" id="4516061">digest</span><span class="op" id="4516067">)</span>&nbsp;<span class="ident" id="4516069">Size</span><span class="op" id="4516073">(</span><span class="op" id="4516074">)</span>&nbsp;<span class="builtintype" id="4516076">int</span>&nbsp;<span class="op" id="4516080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516083">if</span>&nbsp;<span class="op" id="4516086">!</span><span class="ident" id="4516087">d</span><span class="op" id="4516088">.</span><span class="ident" id="4516089">is224</span>&nbsp;<span class="op" id="4516095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516099">return</span>&nbsp;<span class="ident" id="4516106">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516112">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516115">return</span>&nbsp;<span class="ident" id="4516122">Size224</span><br>
<span class="lineno"></span><span class="op" id="4516130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4516133">func</span>&nbsp;<span class="op" id="4516138">(</span><span class="ident" id="4516139">d</span>&nbsp;<span class="op" id="4516141">*</span><span class="ident" id="4516142">digest</span><span class="op" id="4516148">)</span>&nbsp;<span class="ident" id="4516150">BlockSize</span><span class="op" id="4516159">(</span><span class="op" id="4516160">)</span>&nbsp;<span class="builtintype" id="4516162">int</span>&nbsp;<span class="op" id="4516166">{</span>&nbsp;<span class="keyword" id="4516168">return</span>&nbsp;<span class="ident" id="4516175">BlockSize</span>&nbsp;<span class="op" id="4516185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4516188">func</span>&nbsp;<span class="op" id="4516193">(</span><span class="ident" id="4516194">d</span>&nbsp;<span class="op" id="4516196">*</span><span class="ident" id="4516197">digest</span><span class="op" id="4516203">)</span>&nbsp;<span class="ident" id="4516205">Write</span><span class="op" id="4516210">(</span><span class="ident" id="4516211">p</span>&nbsp;<span class="op" id="4516213">[</span><span class="op" id="4516214">]</span><span class="builtintype" id="4516215">byte</span><span class="op" id="4516219">)</span>&nbsp;<span class="op" id="4516221">(</span><span class="ident" id="4516222">nn</span>&nbsp;<span class="builtintype" id="4516225">int</span><span class="op" id="4516228">,</span>&nbsp;<span class="ident" id="4516230">err</span>&nbsp;<span class="builtintype" id="4516234">error</span><span class="op" id="4516239">)</span>&nbsp;<span class="op" id="4516241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516244">nn</span>&nbsp;<span class="op" id="4516247">=</span>&nbsp;<span class="builtinfunc" id="4516249">len</span><span class="op" id="4516252">(</span><span class="ident" id="4516253">p</span><span class="op" id="4516254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516257">d</span><span class="op" id="4516258">.</span><span class="builtinfunc" id="4516259">len</span>&nbsp;<span class="op" id="4516263">+=</span>&nbsp;<span class="ident" id="4516266">uint64</span><span class="op" id="4516272">(</span><span class="ident" id="4516273">nn</span><span class="op" id="4516275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516278">if</span>&nbsp;<span class="ident" id="4516281">d</span><span class="op" id="4516282">.</span><span class="ident" id="4516283">nx</span>&nbsp;<span class="op" id="4516286">&gt;</span>&nbsp;<span class="num" id="4516288">0</span>&nbsp;<span class="op" id="4516290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516294">n</span>&nbsp;<span class="op" id="4516296">:=</span>&nbsp;<span class="builtinfunc" id="4516299">copy</span><span class="op" id="4516303">(</span><span class="ident" id="4516304">d</span><span class="op" id="4516305">.</span><span class="ident" id="4516306">x</span><span class="op" id="4516307">[</span><span class="ident" id="4516308">d</span><span class="op" id="4516309">.</span><span class="ident" id="4516310">nx</span><span class="op" id="4516312">:</span><span class="op" id="4516313">]</span><span class="op" id="4516314">,</span>&nbsp;<span class="ident" id="4516316">p</span><span class="op" id="4516317">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516321">d</span><span class="op" id="4516322">.</span><span class="ident" id="4516323">nx</span>&nbsp;<span class="op" id="4516326">+=</span>&nbsp;<span class="ident" id="4516329">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516333">if</span>&nbsp;<span class="ident" id="4516336">d</span><span class="op" id="4516337">.</span><span class="ident" id="4516338">nx</span>&nbsp;<span class="op" id="4516341">==</span>&nbsp;<span class="ident" id="4516344">chunk</span>&nbsp;<span class="op" id="4516350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516355">block</span><span class="op" id="4516360">(</span><span class="ident" id="4516361">d</span><span class="op" id="4516362">,</span>&nbsp;<span class="ident" id="4516364">d</span><span class="op" id="4516365">.</span><span class="ident" id="4516366">x</span><span class="op" id="4516367">[</span><span class="op" id="4516368">:</span><span class="op" id="4516369">]</span><span class="op" id="4516370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516375">d</span><span class="op" id="4516376">.</span><span class="ident" id="4516377">nx</span>&nbsp;<span class="op" id="4516380">=</span>&nbsp;<span class="num" id="4516382">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516386">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516390">p</span>&nbsp;<span class="op" id="4516392">=</span>&nbsp;<span class="ident" id="4516394">p</span><span class="op" id="4516395">[</span><span class="ident" id="4516396">n</span><span class="op" id="4516397">:</span><span class="op" id="4516398">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516404">if</span>&nbsp;<span class="builtinfunc" id="4516407">len</span><span class="op" id="4516410">(</span><span class="ident" id="4516411">p</span><span class="op" id="4516412">)</span>&nbsp;<span class="op" id="4516414">&gt;=</span>&nbsp;<span class="ident" id="4516417">chunk</span>&nbsp;<span class="op" id="4516423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516427">n</span>&nbsp;<span class="op" id="4516429">:=</span>&nbsp;<span class="builtinfunc" id="4516432">len</span><span class="op" id="4516435">(</span><span class="ident" id="4516436">p</span><span class="op" id="4516437">)</span>&nbsp;<span class="op" id="4516439">&amp;^</span>&nbsp;<span class="op" id="4516442">(</span><span class="ident" id="4516443">chunk</span>&nbsp;<span class="op" id="4516449">-</span>&nbsp;<span class="num" id="4516451">1</span><span class="op" id="4516452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516456">block</span><span class="op" id="4516461">(</span><span class="ident" id="4516462">d</span><span class="op" id="4516463">,</span>&nbsp;<span class="ident" id="4516465">p</span><span class="op" id="4516466">[</span><span class="op" id="4516467">:</span><span class="ident" id="4516468">n</span><span class="op" id="4516469">]</span><span class="op" id="4516470">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516474">p</span>&nbsp;<span class="op" id="4516476">=</span>&nbsp;<span class="ident" id="4516478">p</span><span class="op" id="4516479">[</span><span class="ident" id="4516480">n</span><span class="op" id="4516481">:</span><span class="op" id="4516482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516488">if</span>&nbsp;<span class="builtinfunc" id="4516491">len</span><span class="op" id="4516494">(</span><span class="ident" id="4516495">p</span><span class="op" id="4516496">)</span>&nbsp;<span class="op" id="4516498">&gt;</span>&nbsp;<span class="num" id="4516500">0</span>&nbsp;<span class="op" id="4516502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516506">d</span><span class="op" id="4516507">.</span><span class="ident" id="4516508">nx</span>&nbsp;<span class="op" id="4516511">=</span>&nbsp;<span class="builtinfunc" id="4516513">copy</span><span class="op" id="4516517">(</span><span class="ident" id="4516518">d</span><span class="op" id="4516519">.</span><span class="ident" id="4516520">x</span><span class="op" id="4516521">[</span><span class="op" id="4516522">:</span><span class="op" id="4516523">]</span><span class="op" id="4516524">,</span>&nbsp;<span class="ident" id="4516526">p</span><span class="op" id="4516527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516530">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516533">return</span><br>
<span class="lineno"></span><span class="op" id="4516540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4516543">func</span>&nbsp;<span class="op" id="4516548">(</span><span class="ident" id="4516549">d0</span>&nbsp;<span class="op" id="4516552">*</span><span class="ident" id="4516553">digest</span><span class="op" id="4516559">)</span>&nbsp;<span class="ident" id="4516561">Sum</span><span class="op" id="4516564">(</span><span class="ident" id="4516565">in</span>&nbsp;<span class="op" id="4516568">[</span><span class="op" id="4516569">]</span><span class="builtintype" id="4516570">byte</span><span class="op" id="4516574">)</span>&nbsp;<span class="op" id="4516576">[</span><span class="op" id="4516577">]</span><span class="builtintype" id="4516578">byte</span>&nbsp;<span class="op" id="4516583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4516586">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516653">d</span>&nbsp;<span class="op" id="4516655">:=</span>&nbsp;<span class="op" id="4516658">*</span><span class="ident" id="4516659">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516663">hash</span>&nbsp;<span class="op" id="4516668">:=</span>&nbsp;<span class="ident" id="4516671">d</span><span class="op" id="4516672">.</span><span class="ident" id="4516673">checkSum</span><span class="op" id="4516681">(</span><span class="op" id="4516682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516685">if</span>&nbsp;<span class="ident" id="4516688">d</span><span class="op" id="4516689">.</span><span class="ident" id="4516690">is224</span>&nbsp;<span class="op" id="4516696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516700">return</span>&nbsp;<span class="builtinfunc" id="4516707">append</span><span class="op" id="4516713">(</span><span class="ident" id="4516714">in</span><span class="op" id="4516716">,</span>&nbsp;<span class="ident" id="4516718">hash</span><span class="op" id="4516722">[</span><span class="op" id="4516723">:</span><span class="ident" id="4516724">Size224</span><span class="op" id="4516731">]</span><span class="op" id="4516732">...</span><span class="op" id="4516735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516738">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516741">return</span>&nbsp;<span class="builtinfunc" id="4516748">append</span><span class="op" id="4516754">(</span><span class="ident" id="4516755">in</span><span class="op" id="4516757">,</span>&nbsp;<span class="ident" id="4516759">hash</span><span class="op" id="4516763">[</span><span class="op" id="4516764">:</span><span class="op" id="4516765">]</span><span class="op" id="4516766">...</span><span class="op" id="4516769">)</span><br>
<span class="lineno"></span><span class="op" id="4516771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4516774">func</span>&nbsp;<span class="op" id="4516779">(</span><span class="ident" id="4516780">d</span>&nbsp;<span class="op" id="4516782">*</span><span class="ident" id="4516783">digest</span><span class="op" id="4516789">)</span>&nbsp;<span class="ident" id="4516791">checkSum</span><span class="op" id="4516799">(</span><span class="op" id="4516800">)</span>&nbsp;<span class="op" id="4516802">[</span><span class="ident" id="4516803">Size</span><span class="op" id="4516807">]</span><span class="builtintype" id="4516808">byte</span>&nbsp;<span class="op" id="4516813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4516816">len</span>&nbsp;<span class="op" id="4516820">:=</span>&nbsp;<span class="ident" id="4516823">d</span><span class="op" id="4516824">.</span><span class="builtinfunc" id="4516825">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4516830">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516890">var</span>&nbsp;<span class="ident" id="4516894">tmp</span>&nbsp;<span class="op" id="4516898">[</span><span class="num" id="4516899">64</span><span class="op" id="4516901">]</span><span class="builtintype" id="4516902">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516908">tmp</span><span class="op" id="4516911">[</span><span class="num" id="4516912">0</span><span class="op" id="4516913">]</span>&nbsp;<span class="op" id="4516915">=</span>&nbsp;<span class="num" id="4516917">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516923">if</span>&nbsp;<span class="builtinfunc" id="4516926">len</span><span class="op" id="4516929">%</span><span class="num" id="4516930">64</span>&nbsp;<span class="op" id="4516933">&lt;</span>&nbsp;<span class="num" id="4516935">56</span>&nbsp;<span class="op" id="4516938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516942">d</span><span class="op" id="4516943">.</span><span class="ident" id="4516944">Write</span><span class="op" id="4516949">(</span><span class="ident" id="4516950">tmp</span><span class="op" id="4516953">[</span><span class="num" id="4516954">0</span>&nbsp;<span class="op" id="4516956">:</span>&nbsp;<span class="num" id="4516958">56</span><span class="op" id="4516960">-</span><span class="builtinfunc" id="4516961">len</span><span class="op" id="4516964">%</span><span class="num" id="4516965">64</span><span class="op" id="4516967">]</span><span class="op" id="4516968">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4516971">}</span>&nbsp;<span class="keyword" id="4516973">else</span>&nbsp;<span class="op" id="4516978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516982">d</span><span class="op" id="4516983">.</span><span class="ident" id="4516984">Write</span><span class="op" id="4516989">(</span><span class="ident" id="4516990">tmp</span><span class="op" id="4516993">[</span><span class="num" id="4516994">0</span>&nbsp;<span class="op" id="4516996">:</span>&nbsp;<span class="num" id="4516998">64</span><span class="op" id="4517000">+</span><span class="num" id="4517001">56</span><span class="op" id="4517003">-</span><span class="builtinfunc" id="4517004">len</span><span class="op" id="4517007">%</span><span class="num" id="4517008">64</span><span class="op" id="4517010">]</span><span class="op" id="4517011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4517018">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4517038">len</span>&nbsp;<span class="op" id="4517042">&lt;&lt;=</span>&nbsp;<span class="num" id="4517046">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517049">for</span>&nbsp;<span class="ident" id="4517053">i</span>&nbsp;<span class="op" id="4517055">:=</span>&nbsp;<span class="builtintype" id="4517058">uint</span><span class="op" id="4517062">(</span><span class="num" id="4517063">0</span><span class="op" id="4517064">)</span><span class="op" id="4517065">;</span>&nbsp;<span class="ident" id="4517067">i</span>&nbsp;<span class="op" id="4517069">&lt;</span>&nbsp;<span class="num" id="4517071">8</span><span class="op" id="4517072">;</span>&nbsp;<span class="ident" id="4517074">i</span><span class="op" id="4517075">++</span>&nbsp;<span class="op" id="4517078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517082">tmp</span><span class="op" id="4517085">[</span><span class="ident" id="4517086">i</span><span class="op" id="4517087">]</span>&nbsp;<span class="op" id="4517089">=</span>&nbsp;<span class="builtintype" id="4517091">byte</span><span class="op" id="4517095">(</span><span class="builtinfunc" id="4517096">len</span>&nbsp;<span class="op" id="4517100">&gt;&gt;</span>&nbsp;<span class="op" id="4517103">(</span><span class="num" id="4517104">56</span>&nbsp;<span class="op" id="4517107">-</span>&nbsp;<span class="num" id="4517109">8</span><span class="op" id="4517110">*</span><span class="ident" id="4517111">i</span><span class="op" id="4517112">)</span><span class="op" id="4517113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517119">d</span><span class="op" id="4517120">.</span><span class="ident" id="4517121">Write</span><span class="op" id="4517126">(</span><span class="ident" id="4517127">tmp</span><span class="op" id="4517130">[</span><span class="num" id="4517131">0</span><span class="op" id="4517132">:</span><span class="num" id="4517133">8</span><span class="op" id="4517134">]</span><span class="op" id="4517135">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517139">if</span>&nbsp;<span class="ident" id="4517142">d</span><span class="op" id="4517143">.</span><span class="ident" id="4517144">nx</span>&nbsp;<span class="op" id="4517147">!=</span>&nbsp;<span class="num" id="4517150">0</span>&nbsp;<span class="op" id="4517152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4517156">panic</span><span class="op" id="4517161">(</span><span class="string" id="4517162">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4517173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517180">h</span>&nbsp;<span class="op" id="4517182">:=</span>&nbsp;<span class="ident" id="4517185">d</span><span class="op" id="4517186">.</span><span class="ident" id="4517187">h</span><span class="op" id="4517188">[</span><span class="op" id="4517189">:</span><span class="op" id="4517190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517193">if</span>&nbsp;<span class="ident" id="4517196">d</span><span class="op" id="4517197">.</span><span class="ident" id="4517198">is224</span>&nbsp;<span class="op" id="4517204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517208">h</span>&nbsp;<span class="op" id="4517210">=</span>&nbsp;<span class="ident" id="4517212">d</span><span class="op" id="4517213">.</span><span class="ident" id="4517214">h</span><span class="op" id="4517215">[</span><span class="op" id="4517216">:</span><span class="num" id="4517217">7</span><span class="op" id="4517218">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517225">var</span>&nbsp;<span class="ident" id="4517229">digest</span>&nbsp;<span class="op" id="4517236">[</span><span class="ident" id="4517237">Size</span><span class="op" id="4517241">]</span><span class="builtintype" id="4517242">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517248">for</span>&nbsp;<span class="ident" id="4517252">i</span><span class="op" id="4517253">,</span>&nbsp;<span class="ident" id="4517255">s</span>&nbsp;<span class="op" id="4517257">:=</span>&nbsp;<span class="keyword" id="4517260">range</span>&nbsp;<span class="ident" id="4517266">h</span>&nbsp;<span class="op" id="4517268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517272">digest</span><span class="op" id="4517278">[</span><span class="ident" id="4517279">i</span><span class="op" id="4517280">*</span><span class="num" id="4517281">4</span><span class="op" id="4517282">]</span>&nbsp;<span class="op" id="4517284">=</span>&nbsp;<span class="builtintype" id="4517286">byte</span><span class="op" id="4517290">(</span><span class="ident" id="4517291">s</span>&nbsp;<span class="op" id="4517293">&gt;&gt;</span>&nbsp;<span class="num" id="4517296">24</span><span class="op" id="4517298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517302">digest</span><span class="op" id="4517308">[</span><span class="ident" id="4517309">i</span><span class="op" id="4517310">*</span><span class="num" id="4517311">4</span><span class="op" id="4517312">+</span><span class="num" id="4517313">1</span><span class="op" id="4517314">]</span>&nbsp;<span class="op" id="4517316">=</span>&nbsp;<span class="builtintype" id="4517318">byte</span><span class="op" id="4517322">(</span><span class="ident" id="4517323">s</span>&nbsp;<span class="op" id="4517325">&gt;&gt;</span>&nbsp;<span class="num" id="4517328">16</span><span class="op" id="4517330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517334">digest</span><span class="op" id="4517340">[</span><span class="ident" id="4517341">i</span><span class="op" id="4517342">*</span><span class="num" id="4517343">4</span><span class="op" id="4517344">+</span><span class="num" id="4517345">2</span><span class="op" id="4517346">]</span>&nbsp;<span class="op" id="4517348">=</span>&nbsp;<span class="builtintype" id="4517350">byte</span><span class="op" id="4517354">(</span><span class="ident" id="4517355">s</span>&nbsp;<span class="op" id="4517357">&gt;&gt;</span>&nbsp;<span class="num" id="4517360">8</span><span class="op" id="4517361">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517365">digest</span><span class="op" id="4517371">[</span><span class="ident" id="4517372">i</span><span class="op" id="4517373">*</span><span class="num" id="4517374">4</span><span class="op" id="4517375">+</span><span class="num" id="4517376">3</span><span class="op" id="4517377">]</span>&nbsp;<span class="op" id="4517379">=</span>&nbsp;<span class="builtintype" id="4517381">byte</span><span class="op" id="4517385">(</span><span class="ident" id="4517386">s</span><span class="op" id="4517387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517394">return</span>&nbsp;<span class="ident" id="4517401">digest</span><br>
<span class="lineno"></span><span class="op" id="4517408">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4517411">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4517462">func</span>&nbsp;<span class="ident" id="4517467">Sum256</span><span class="op" id="4517473">(</span><span class="ident" id="4517474">data</span>&nbsp;<span class="op" id="4517479">[</span><span class="op" id="4517480">]</span><span class="builtintype" id="4517481">byte</span><span class="op" id="4517485">)</span>&nbsp;<span class="op" id="4517487">[</span><span class="ident" id="4517488">Size</span><span class="op" id="4517492">]</span><span class="builtintype" id="4517493">byte</span>&nbsp;<span class="op" id="4517498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517501">var</span>&nbsp;<span class="ident" id="4517505">d</span>&nbsp;<span class="ident" id="4517507">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517515">d</span><span class="op" id="4517516">.</span><span class="ident" id="4517517">Reset</span><span class="op" id="4517522">(</span><span class="op" id="4517523">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517526">d</span><span class="op" id="4517527">.</span><span class="ident" id="4517528">Write</span><span class="op" id="4517533">(</span><span class="ident" id="4517534">data</span><span class="op" id="4517538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517541">return</span>&nbsp;<span class="ident" id="4517548">d</span><span class="op" id="4517549">.</span><span class="ident" id="4517550">checkSum</span><span class="op" id="4517558">(</span><span class="op" id="4517559">)</span><br>
<span class="lineno"></span><span class="op" id="4517561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4517564">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4517615">func</span>&nbsp;<span class="ident" id="4517620">Sum224</span><span class="op" id="4517626">(</span><span class="ident" id="4517627">data</span>&nbsp;<span class="op" id="4517632">[</span><span class="op" id="4517633">]</span><span class="builtintype" id="4517634">byte</span><span class="op" id="4517638">)</span>&nbsp;<span class="op" id="4517640">(</span><span class="ident" id="4517641">sum224</span>&nbsp;<span class="op" id="4517648">[</span><span class="ident" id="4517649">Size224</span><span class="op" id="4517656">]</span><span class="builtintype" id="4517657">byte</span><span class="op" id="4517661">)</span>&nbsp;<span class="op" id="4517663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517666">var</span>&nbsp;<span class="ident" id="4517670">d</span>&nbsp;<span class="ident" id="4517672">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517680">d</span><span class="op" id="4517681">.</span><span class="ident" id="4517682">is224</span>&nbsp;<span class="op" id="4517688">=</span>&nbsp;<span class="builtintype" id="4517690">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517696">d</span><span class="op" id="4517697">.</span><span class="ident" id="4517698">Reset</span><span class="op" id="4517703">(</span><span class="op" id="4517704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517707">d</span><span class="op" id="4517708">.</span><span class="ident" id="4517709">Write</span><span class="op" id="4517714">(</span><span class="ident" id="4517715">data</span><span class="op" id="4517719">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517722">sum</span>&nbsp;<span class="op" id="4517726">:=</span>&nbsp;<span class="ident" id="4517729">d</span><span class="op" id="4517730">.</span><span class="ident" id="4517731">checkSum</span><span class="op" id="4517739">(</span><span class="op" id="4517740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4517743">copy</span><span class="op" id="4517747">(</span><span class="ident" id="4517748">sum224</span><span class="op" id="4517754">[</span><span class="op" id="4517755">:</span><span class="op" id="4517756">]</span><span class="op" id="4517757">,</span>&nbsp;<span class="ident" id="4517759">sum</span><span class="op" id="4517762">[</span><span class="op" id="4517763">:</span><span class="ident" id="4517764">Size224</span><span class="op" id="4517771">]</span><span class="op" id="4517772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517775">return</span><br>
<span class="lineno"></span><span class="op" id="4517782">}</span>
</div>
</body>
</html>
