<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7333669">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7333724">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7333778">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7333829">package</span>&nbsp;<span class="ident" id="7333837">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7333847">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7333902">import</span>&nbsp;<span class="op" id="7333909">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7333912">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7333921">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7333928">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7333939">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7333950">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7333972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7333975">const</span>&nbsp;<span class="op" id="7333981">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333984">noError</span>&nbsp;&nbsp;<span class="op" id="7333993">=</span>&nbsp;<span class="builtintype" id="7333995">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334001">hasError</span>&nbsp;<span class="op" id="7334010">=</span>&nbsp;<span class="builtintype" id="7334012">false</span><br>
<span class="lineno">20</span><span class="op" id="7334018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334021">type</span>&nbsp;<span class="ident" id="7334026">multiParseTest</span>&nbsp;<span class="keyword" id="7334041">struct</span>&nbsp;<span class="op" id="7334048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334051">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7334059">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334067">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7334075">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334083">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7334091">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334097">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7334105">[</span><span class="op" id="7334106">]</span><span class="builtintype" id="7334107">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334115">results</span>&nbsp;<span class="op" id="7334123">[</span><span class="op" id="7334124">]</span><span class="builtintype" id="7334125">string</span><br>
<span class="lineno"></span><span class="op" id="7334132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7334135">var</span>&nbsp;<span class="ident" id="7334139">multiParseTests</span>&nbsp;<span class="op" id="7334155">=</span>&nbsp;<span class="op" id="7334157">[</span><span class="op" id="7334158">]</span><span class="ident" id="7334159">multiParseTest</span><span class="op" id="7334173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334176">{</span><span class="string" id="7334177">&#34;empty&#34;</span><span class="op" id="7334184">,</span>&nbsp;<span class="string" id="7334186">&#34;&#34;</span><span class="op" id="7334188">,</span>&nbsp;<span class="ident" id="7334190">noError</span><span class="op" id="7334197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334201">nil</span><span class="op" id="7334204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334208">nil</span><span class="op" id="7334211">}</span><span class="op" id="7334212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334215">{</span><span class="string" id="7334216">&#34;one&#34;</span><span class="op" id="7334221">,</span>&nbsp;<span class="string" id="7334223">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7334253">,</span>&nbsp;<span class="ident" id="7334255">noError</span><span class="op" id="7334262">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334266">[</span><span class="op" id="7334267">]</span><span class="builtintype" id="7334268">string</span><span class="op" id="7334274">{</span><span class="string" id="7334275">&#34;foo&#34;</span><span class="op" id="7334280">}</span><span class="op" id="7334281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334285">[</span><span class="op" id="7334286">]</span><span class="builtintype" id="7334287">string</span><span class="op" id="7334293">{</span><span class="string" id="7334294">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7334301">}</span><span class="op" id="7334302">}</span><span class="op" id="7334303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334306">{</span><span class="string" id="7334307">&#34;two&#34;</span><span class="op" id="7334312">,</span>&nbsp;<span class="string" id="7334314">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7334372">,</span>&nbsp;<span class="ident" id="7334374">noError</span><span class="op" id="7334381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334385">[</span><span class="op" id="7334386">]</span><span class="builtintype" id="7334387">string</span><span class="op" id="7334393">{</span><span class="string" id="7334394">&#34;foo&#34;</span><span class="op" id="7334399">,</span>&nbsp;<span class="string" id="7334401">&#34;bar&#34;</span><span class="op" id="7334406">}</span><span class="op" id="7334407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334411">[</span><span class="op" id="7334412">]</span><span class="builtintype" id="7334413">string</span><span class="op" id="7334419">{</span><span class="string" id="7334420">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7334427">,</span>&nbsp;<span class="string" id="7334429">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7334436">}</span><span class="op" id="7334437">}</span><span class="op" id="7334438">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7334441">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334452">{</span><span class="string" id="7334453">&#34;missing&nbsp;end&#34;</span><span class="op" id="7334466">,</span>&nbsp;<span class="string" id="7334468">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7334491">,</span>&nbsp;<span class="ident" id="7334493">hasError</span><span class="op" id="7334501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334505">nil</span><span class="op" id="7334508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334512">nil</span><span class="op" id="7334515">}</span><span class="op" id="7334516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334519">{</span><span class="string" id="7334520">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7334536">,</span>&nbsp;<span class="string" id="7334538">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7334560">,</span>&nbsp;<span class="ident" id="7334562">hasError</span><span class="op" id="7334570">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334574">nil</span><span class="op" id="7334577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334581">nil</span><span class="op" id="7334584">}</span><span class="op" id="7334585">,</span><br>
<span class="lineno"></span><span class="op" id="7334587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334590">func</span>&nbsp;<span class="ident" id="7334595">TestMultiParse</span><span class="op" id="7334609">(</span><span class="ident" id="7334610">t</span>&nbsp;<span class="op" id="7334612">*</span><span class="ident" id="7334613">testing</span><span class="op" id="7334620">.</span><span class="ident" id="7334621">T</span><span class="op" id="7334622">)</span>&nbsp;<span class="op" id="7334624">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334627">for</span>&nbsp;<span class="ident" id="7334631">_</span><span class="op" id="7334632">,</span>&nbsp;<span class="ident" id="7334634">test</span>&nbsp;<span class="op" id="7334639">:=</span>&nbsp;<span class="keyword" id="7334642">range</span>&nbsp;<span class="ident" id="7334648">multiParseTests</span>&nbsp;<span class="op" id="7334664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334668">template</span><span class="op" id="7334676">,</span>&nbsp;<span class="ident" id="7334678">err</span>&nbsp;<span class="op" id="7334682">:=</span>&nbsp;<span class="ident" id="7334685">New</span><span class="op" id="7334688">(</span><span class="string" id="7334689">&#34;root&#34;</span><span class="op" id="7334695">)</span><span class="op" id="7334696">.</span><span class="ident" id="7334697">Parse</span><span class="op" id="7334702">(</span><span class="ident" id="7334703">test</span><span class="op" id="7334707">.</span><span class="ident" id="7334708">input</span><span class="op" id="7334713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334717">switch</span>&nbsp;<span class="op" id="7334724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334728">case</span>&nbsp;<span class="ident" id="7334733">err</span>&nbsp;<span class="op" id="7334737">==</span>&nbsp;<span class="ident" id="7334740">nil</span>&nbsp;<span class="op" id="7334744">&amp;&amp;</span>&nbsp;<span class="op" id="7334747">!</span><span class="ident" id="7334748">test</span><span class="op" id="7334752">.</span><span class="ident" id="7334753">ok</span><span class="op" id="7334755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334760">t</span><span class="op" id="7334761">.</span><span class="ident" id="7334762">Errorf</span><span class="op" id="7334768">(</span><span class="string" id="7334769">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7334799">,</span>&nbsp;<span class="ident" id="7334801">test</span><span class="op" id="7334805">.</span><span class="ident" id="7334806">name</span><span class="op" id="7334810">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334815">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334826">case</span>&nbsp;<span class="ident" id="7334831">err</span>&nbsp;<span class="op" id="7334835">!=</span>&nbsp;<span class="ident" id="7334838">nil</span>&nbsp;<span class="op" id="7334842">&amp;&amp;</span>&nbsp;<span class="ident" id="7334845">test</span><span class="op" id="7334849">.</span><span class="ident" id="7334850">ok</span><span class="op" id="7334852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334857">t</span><span class="op" id="7334858">.</span><span class="ident" id="7334859">Errorf</span><span class="op" id="7334865">(</span><span class="string" id="7334866">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7334892">,</span>&nbsp;<span class="ident" id="7334894">test</span><span class="op" id="7334898">.</span><span class="ident" id="7334899">name</span><span class="op" id="7334903">,</span>&nbsp;<span class="ident" id="7334905">err</span><span class="op" id="7334908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334913">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334924">case</span>&nbsp;<span class="ident" id="7334929">err</span>&nbsp;<span class="op" id="7334933">!=</span>&nbsp;<span class="ident" id="7334936">nil</span>&nbsp;<span class="op" id="7334940">&amp;&amp;</span>&nbsp;<span class="op" id="7334943">!</span><span class="ident" id="7334944">test</span><span class="op" id="7334948">.</span><span class="ident" id="7334949">ok</span><span class="op" id="7334951">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7334956">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334986">if</span>&nbsp;<span class="op" id="7334989">*</span><span class="ident" id="7334990">debug</span>&nbsp;<span class="op" id="7334996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335002">fmt</span><span class="op" id="7335005">.</span><span class="ident" id="7335006">Printf</span><span class="op" id="7335012">(</span><span class="string" id="7335013">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7335029">,</span>&nbsp;<span class="ident" id="7335031">test</span><span class="op" id="7335035">.</span><span class="ident" id="7335036">name</span><span class="op" id="7335040">,</span>&nbsp;<span class="ident" id="7335042">test</span><span class="op" id="7335046">.</span><span class="ident" id="7335047">input</span><span class="op" id="7335052">,</span>&nbsp;<span class="ident" id="7335054">err</span><span class="op" id="7335057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335067">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335082">if</span>&nbsp;<span class="ident" id="7335085">template</span>&nbsp;<span class="op" id="7335094">==</span>&nbsp;<span class="ident" id="7335097">nil</span>&nbsp;<span class="op" id="7335101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335106">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335121">if</span>&nbsp;<span class="builtinfunc" id="7335124">len</span><span class="op" id="7335127">(</span><span class="ident" id="7335128">template</span><span class="op" id="7335136">.</span><span class="ident" id="7335137">tmpl</span><span class="op" id="7335141">)</span>&nbsp;<span class="op" id="7335143">!=</span>&nbsp;<span class="builtinfunc" id="7335146">len</span><span class="op" id="7335149">(</span><span class="ident" id="7335150">test</span><span class="op" id="7335154">.</span><span class="ident" id="7335155">names</span><span class="op" id="7335160">)</span><span class="op" id="7335161">+</span><span class="num" id="7335162">1</span>&nbsp;<span class="op" id="7335164">{</span>&nbsp;<span class="comment" id="7335166">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335184">t</span><span class="op" id="7335185">.</span><span class="ident" id="7335186">Errorf</span><span class="op" id="7335192">(</span><span class="string" id="7335193">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7335242">,</span>&nbsp;<span class="ident" id="7335244">test</span><span class="op" id="7335248">.</span><span class="ident" id="7335249">name</span><span class="op" id="7335253">,</span>&nbsp;<span class="builtinfunc" id="7335255">len</span><span class="op" id="7335258">(</span><span class="ident" id="7335259">test</span><span class="op" id="7335263">.</span><span class="ident" id="7335264">names</span><span class="op" id="7335269">)</span><span class="op" id="7335270">,</span>&nbsp;<span class="builtinfunc" id="7335272">len</span><span class="op" id="7335275">(</span><span class="ident" id="7335276">template</span><span class="op" id="7335284">.</span><span class="ident" id="7335285">tmpl</span><span class="op" id="7335289">)</span><span class="op" id="7335290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335295">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335310">for</span>&nbsp;<span class="ident" id="7335314">i</span><span class="op" id="7335315">,</span>&nbsp;<span class="ident" id="7335317">name</span>&nbsp;<span class="op" id="7335322">:=</span>&nbsp;<span class="keyword" id="7335325">range</span>&nbsp;<span class="ident" id="7335331">test</span><span class="op" id="7335335">.</span><span class="ident" id="7335336">names</span>&nbsp;<span class="op" id="7335342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335347">tmpl</span><span class="op" id="7335351">,</span>&nbsp;<span class="ident" id="7335353">ok</span>&nbsp;<span class="op" id="7335356">:=</span>&nbsp;<span class="ident" id="7335359">template</span><span class="op" id="7335367">.</span><span class="ident" id="7335368">tmpl</span><span class="op" id="7335372">[</span><span class="ident" id="7335373">name</span><span class="op" id="7335377">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335382">if</span>&nbsp;<span class="op" id="7335385">!</span><span class="ident" id="7335386">ok</span>&nbsp;<span class="op" id="7335389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335395">t</span><span class="op" id="7335396">.</span><span class="ident" id="7335397">Errorf</span><span class="op" id="7335403">(</span><span class="string" id="7335404">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7335432">,</span>&nbsp;<span class="ident" id="7335434">test</span><span class="op" id="7335438">.</span><span class="ident" id="7335439">name</span><span class="op" id="7335443">,</span>&nbsp;<span class="ident" id="7335445">name</span><span class="op" id="7335449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335455">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335472">result</span>&nbsp;<span class="op" id="7335479">:=</span>&nbsp;<span class="ident" id="7335482">tmpl</span><span class="op" id="7335486">.</span><span class="ident" id="7335487">Root</span><span class="op" id="7335491">.</span><span class="ident" id="7335492">String</span><span class="op" id="7335498">(</span><span class="op" id="7335499">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335504">if</span>&nbsp;<span class="ident" id="7335507">result</span>&nbsp;<span class="op" id="7335514">!=</span>&nbsp;<span class="ident" id="7335517">test</span><span class="op" id="7335521">.</span><span class="ident" id="7335522">results</span><span class="op" id="7335529">[</span><span class="ident" id="7335530">i</span><span class="op" id="7335531">]</span>&nbsp;<span class="op" id="7335533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335539">t</span><span class="op" id="7335540">.</span><span class="ident" id="7335541">Errorf</span><span class="op" id="7335547">(</span><span class="string" id="7335548">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7335584">,</span>&nbsp;<span class="ident" id="7335586">test</span><span class="op" id="7335590">.</span><span class="ident" id="7335591">name</span><span class="op" id="7335595">,</span>&nbsp;<span class="ident" id="7335597">test</span><span class="op" id="7335601">.</span><span class="ident" id="7335602">input</span><span class="op" id="7335607">,</span>&nbsp;<span class="ident" id="7335609">result</span><span class="op" id="7335615">,</span>&nbsp;<span class="ident" id="7335617">test</span><span class="op" id="7335621">.</span><span class="ident" id="7335622">results</span><span class="op" id="7335629">[</span><span class="ident" id="7335630">i</span><span class="op" id="7335631">]</span><span class="op" id="7335632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335644">}</span><br>
<span class="lineno">85</span><span class="op" id="7335646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7335649">var</span>&nbsp;<span class="ident" id="7335653">multiExecTests</span>&nbsp;<span class="op" id="7335668">=</span>&nbsp;<span class="op" id="7335670">[</span><span class="op" id="7335671">]</span><span class="ident" id="7335672">execTest</span><span class="op" id="7335680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335683">{</span><span class="string" id="7335684">&#34;empty&#34;</span><span class="op" id="7335691">,</span>&nbsp;<span class="string" id="7335693">&#34;&#34;</span><span class="op" id="7335695">,</span>&nbsp;<span class="string" id="7335697">&#34;&#34;</span><span class="op" id="7335699">,</span>&nbsp;<span class="ident" id="7335701">nil</span><span class="op" id="7335704">,</span>&nbsp;<span class="builtintype" id="7335706">true</span><span class="op" id="7335710">}</span><span class="op" id="7335711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335714">{</span><span class="string" id="7335715">&#34;text&#34;</span><span class="op" id="7335721">,</span>&nbsp;<span class="string" id="7335723">&#34;some&nbsp;text&#34;</span><span class="op" id="7335734">,</span>&nbsp;<span class="string" id="7335736">&#34;some&nbsp;text&#34;</span><span class="op" id="7335747">,</span>&nbsp;<span class="ident" id="7335749">nil</span><span class="op" id="7335752">,</span>&nbsp;<span class="builtintype" id="7335754">true</span><span class="op" id="7335758">}</span><span class="op" id="7335759">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335762">{</span><span class="string" id="7335763">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7335773">,</span>&nbsp;<span class="string" id="7335775">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7335797">,</span>&nbsp;<span class="string" id="7335799">&#34;TEXT&#34;</span><span class="op" id="7335805">,</span>&nbsp;<span class="ident" id="7335807">tVal</span><span class="op" id="7335811">,</span>&nbsp;<span class="builtintype" id="7335813">true</span><span class="op" id="7335817">}</span><span class="op" id="7335818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335821">{</span><span class="string" id="7335822">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7335840">,</span>&nbsp;<span class="string" id="7335842">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7335860">,</span>&nbsp;<span class="string" id="7335862">&#34;TEXT&#34;</span><span class="op" id="7335868">,</span>&nbsp;<span class="ident" id="7335870">tVal</span><span class="op" id="7335874">,</span>&nbsp;<span class="builtintype" id="7335876">true</span><span class="op" id="7335880">}</span><span class="op" id="7335881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335884">{</span><span class="string" id="7335885">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7335901">,</span>&nbsp;<span class="string" id="7335903">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7335926">,</span>&nbsp;<span class="string" id="7335928">&#34;17&#34;</span><span class="op" id="7335932">,</span>&nbsp;<span class="ident" id="7335934">tVal</span><span class="op" id="7335938">,</span>&nbsp;<span class="builtintype" id="7335940">true</span><span class="op" id="7335944">}</span><span class="op" id="7335945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335948">{</span><span class="string" id="7335949">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7335967">,</span>&nbsp;<span class="string" id="7335969">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7335993">,</span>&nbsp;<span class="string" id="7335995">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7336004">,</span>&nbsp;<span class="ident" id="7336006">tVal</span><span class="op" id="7336010">,</span>&nbsp;<span class="builtintype" id="7336012">true</span><span class="op" id="7336016">}</span><span class="op" id="7336017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336020">{</span><span class="string" id="7336021">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7336034">,</span>&nbsp;<span class="string" id="7336036">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7336060">,</span>&nbsp;<span class="string" id="7336062">&#34;v&#34;</span><span class="op" id="7336065">,</span>&nbsp;<span class="ident" id="7336067">tVal</span><span class="op" id="7336071">,</span>&nbsp;<span class="builtintype" id="7336073">true</span><span class="op" id="7336077">}</span><span class="op" id="7336078">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336081">{</span><span class="string" id="7336082">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7336101">,</span>&nbsp;<span class="string" id="7336103">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7336129">,</span>&nbsp;<span class="string" id="7336131">&#34;17&#34;</span><span class="op" id="7336135">,</span>&nbsp;<span class="ident" id="7336137">tVal</span><span class="op" id="7336141">,</span>&nbsp;<span class="builtintype" id="7336143">true</span><span class="op" id="7336147">}</span><span class="op" id="7336148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336151">{</span><span class="string" id="7336152">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7336183">,</span>&nbsp;<span class="string" id="7336185">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7336231">,</span>&nbsp;<span class="string" id="7336233">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7336244">,</span>&nbsp;<span class="ident" id="7336246">tVal</span><span class="op" id="7336250">,</span>&nbsp;<span class="builtintype" id="7336252">true</span><span class="op" id="7336256">}</span><span class="op" id="7336257">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7336261">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336313">{</span><span class="string" id="7336314">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7336332">,</span>&nbsp;<span class="string" id="7336334">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7336352">,</span>&nbsp;<span class="string" id="7336354">&#34;oneArg=joe&#34;</span><span class="op" id="7336366">,</span>&nbsp;<span class="ident" id="7336368">tVal</span><span class="op" id="7336372">,</span>&nbsp;<span class="builtintype" id="7336374">true</span><span class="op" id="7336378">}</span><span class="op" id="7336379">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336382">{</span><span class="string" id="7336383">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7336395">,</span>&nbsp;<span class="string" id="7336397">`{{oneArg&nbsp;.}}`</span><span class="op" id="7336411">,</span>&nbsp;<span class="string" id="7336413">&#34;oneArg=joe&#34;</span><span class="op" id="7336425">,</span>&nbsp;<span class="string" id="7336427">&#34;joe&#34;</span><span class="op" id="7336432">,</span>&nbsp;<span class="builtintype" id="7336434">true</span><span class="op" id="7336438">}</span><span class="op" id="7336439">,</span><br>
<span class="lineno"></span><span class="op" id="7336441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7336444">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7336485">const</span>&nbsp;<span class="ident" id="7336491">multiText1</span>&nbsp;<span class="op" id="7336502">=</span>&nbsp;<span class="string" id="7336504">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7336568">const</span>&nbsp;<span class="ident" id="7336574">multiText2</span>&nbsp;<span class="op" id="7336585">=</span>&nbsp;<span class="string" id="7336587">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7336670">func</span>&nbsp;<span class="ident" id="7336675">TestMultiExecute</span><span class="op" id="7336691">(</span><span class="ident" id="7336692">t</span>&nbsp;<span class="op" id="7336694">*</span><span class="ident" id="7336695">testing</span><span class="op" id="7336702">.</span><span class="ident" id="7336703">T</span><span class="op" id="7336704">)</span>&nbsp;<span class="op" id="7336706">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7336709">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336750">template</span><span class="op" id="7336758">,</span>&nbsp;<span class="ident" id="7336760">err</span>&nbsp;<span class="op" id="7336764">:=</span>&nbsp;<span class="ident" id="7336767">New</span><span class="op" id="7336770">(</span><span class="string" id="7336771">&#34;root&#34;</span><span class="op" id="7336777">)</span><span class="op" id="7336778">.</span><span class="ident" id="7336779">Parse</span><span class="op" id="7336784">(</span><span class="ident" id="7336785">multiText1</span><span class="op" id="7336795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7336798">if</span>&nbsp;<span class="ident" id="7336801">err</span>&nbsp;<span class="op" id="7336805">!=</span>&nbsp;<span class="ident" id="7336808">nil</span>&nbsp;<span class="op" id="7336812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336816">t</span><span class="op" id="7336817">.</span><span class="ident" id="7336818">Fatalf</span><span class="op" id="7336824">(</span><span class="string" id="7336825">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7336848">,</span>&nbsp;<span class="ident" id="7336850">err</span><span class="op" id="7336853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336856">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336859">_</span><span class="op" id="7336860">,</span>&nbsp;<span class="ident" id="7336862">err</span>&nbsp;<span class="op" id="7336866">=</span>&nbsp;<span class="ident" id="7336868">template</span><span class="op" id="7336876">.</span><span class="ident" id="7336877">Parse</span><span class="op" id="7336882">(</span><span class="ident" id="7336883">multiText2</span><span class="op" id="7336893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7336896">if</span>&nbsp;<span class="ident" id="7336899">err</span>&nbsp;<span class="op" id="7336903">!=</span>&nbsp;<span class="ident" id="7336906">nil</span>&nbsp;<span class="op" id="7336910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336914">t</span><span class="op" id="7336915">.</span><span class="ident" id="7336916">Fatalf</span><span class="op" id="7336922">(</span><span class="string" id="7336923">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7336946">,</span>&nbsp;<span class="ident" id="7336948">err</span><span class="op" id="7336951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336957">testExecute</span><span class="op" id="7336968">(</span><span class="ident" id="7336969">multiExecTests</span><span class="op" id="7336983">,</span>&nbsp;<span class="ident" id="7336985">template</span><span class="op" id="7336993">,</span>&nbsp;<span class="ident" id="7336995">t</span><span class="op" id="7336996">)</span><br>
<span class="lineno">125</span><span class="op" id="7336998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337001">func</span>&nbsp;<span class="ident" id="7337006">TestParseFiles</span><span class="op" id="7337020">(</span><span class="ident" id="7337021">t</span>&nbsp;<span class="op" id="7337023">*</span><span class="ident" id="7337024">testing</span><span class="op" id="7337031">.</span><span class="ident" id="7337032">T</span><span class="op" id="7337033">)</span>&nbsp;<span class="op" id="7337035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337038">_</span><span class="op" id="7337039">,</span>&nbsp;<span class="ident" id="7337041">err</span>&nbsp;<span class="op" id="7337045">:=</span>&nbsp;<span class="ident" id="7337048">ParseFiles</span><span class="op" id="7337058">(</span><span class="string" id="7337059">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7337075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337078">if</span>&nbsp;<span class="ident" id="7337081">err</span>&nbsp;<span class="op" id="7337085">==</span>&nbsp;<span class="ident" id="7337088">nil</span>&nbsp;<span class="op" id="7337092">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337096">t</span><span class="op" id="7337097">.</span><span class="ident" id="7337098">Error</span><span class="op" id="7337103">(</span><span class="string" id="7337104">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7337152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337158">template</span>&nbsp;<span class="op" id="7337167">:=</span>&nbsp;<span class="ident" id="7337170">New</span><span class="op" id="7337173">(</span><span class="string" id="7337174">&#34;root&#34;</span><span class="op" id="7337180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337183">_</span><span class="op" id="7337184">,</span>&nbsp;<span class="ident" id="7337186">err</span>&nbsp;<span class="op" id="7337190">=</span>&nbsp;<span class="ident" id="7337192">template</span><span class="op" id="7337200">.</span><span class="ident" id="7337201">ParseFiles</span><span class="op" id="7337211">(</span><span class="string" id="7337212">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7337233">,</span>&nbsp;<span class="string" id="7337235">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7337256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337259">if</span>&nbsp;<span class="ident" id="7337262">err</span>&nbsp;<span class="op" id="7337266">!=</span>&nbsp;<span class="ident" id="7337269">nil</span>&nbsp;<span class="op" id="7337273">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337277">t</span><span class="op" id="7337278">.</span><span class="ident" id="7337279">Fatalf</span><span class="op" id="7337285">(</span><span class="string" id="7337286">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7337311">,</span>&nbsp;<span class="ident" id="7337313">err</span><span class="op" id="7337316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337322">testExecute</span><span class="op" id="7337333">(</span><span class="ident" id="7337334">multiExecTests</span><span class="op" id="7337348">,</span>&nbsp;<span class="ident" id="7337350">template</span><span class="op" id="7337358">,</span>&nbsp;<span class="ident" id="7337360">t</span><span class="op" id="7337361">)</span><br>
<span class="lineno"></span><span class="op" id="7337363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7337366">func</span>&nbsp;<span class="ident" id="7337371">TestParseGlob</span><span class="op" id="7337384">(</span><span class="ident" id="7337385">t</span>&nbsp;<span class="op" id="7337387">*</span><span class="ident" id="7337388">testing</span><span class="op" id="7337395">.</span><span class="ident" id="7337396">T</span><span class="op" id="7337397">)</span>&nbsp;<span class="op" id="7337399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337402">_</span><span class="op" id="7337403">,</span>&nbsp;<span class="ident" id="7337405">err</span>&nbsp;<span class="op" id="7337409">:=</span>&nbsp;<span class="ident" id="7337412">ParseGlob</span><span class="op" id="7337421">(</span><span class="string" id="7337422">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7337438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337441">if</span>&nbsp;<span class="ident" id="7337444">err</span>&nbsp;<span class="op" id="7337448">==</span>&nbsp;<span class="ident" id="7337451">nil</span>&nbsp;<span class="op" id="7337455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337459">t</span><span class="op" id="7337460">.</span><span class="ident" id="7337461">Error</span><span class="op" id="7337466">(</span><span class="string" id="7337467">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7337515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337518">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337521">_</span><span class="op" id="7337522">,</span>&nbsp;<span class="ident" id="7337524">err</span>&nbsp;<span class="op" id="7337528">=</span>&nbsp;<span class="ident" id="7337530">New</span><span class="op" id="7337533">(</span><span class="string" id="7337534">&#34;error&#34;</span><span class="op" id="7337541">)</span><span class="op" id="7337542">.</span><span class="ident" id="7337543">ParseGlob</span><span class="op" id="7337552">(</span><span class="string" id="7337553">&#34;[x&#34;</span><span class="op" id="7337557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337560">if</span>&nbsp;<span class="ident" id="7337563">err</span>&nbsp;<span class="op" id="7337567">==</span>&nbsp;<span class="ident" id="7337570">nil</span>&nbsp;<span class="op" id="7337574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337578">t</span><span class="op" id="7337579">.</span><span class="ident" id="7337580">Error</span><span class="op" id="7337585">(</span><span class="string" id="7337586">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7337628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337634">template</span>&nbsp;<span class="op" id="7337643">:=</span>&nbsp;<span class="ident" id="7337646">New</span><span class="op" id="7337649">(</span><span class="string" id="7337650">&#34;root&#34;</span><span class="op" id="7337656">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337659">_</span><span class="op" id="7337660">,</span>&nbsp;<span class="ident" id="7337662">err</span>&nbsp;<span class="op" id="7337666">=</span>&nbsp;<span class="ident" id="7337668">template</span><span class="op" id="7337676">.</span><span class="ident" id="7337677">ParseGlob</span><span class="op" id="7337686">(</span><span class="string" id="7337687">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7337708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337711">if</span>&nbsp;<span class="ident" id="7337714">err</span>&nbsp;<span class="op" id="7337718">!=</span>&nbsp;<span class="ident" id="7337721">nil</span>&nbsp;<span class="op" id="7337725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337729">t</span><span class="op" id="7337730">.</span><span class="ident" id="7337731">Fatalf</span><span class="op" id="7337737">(</span><span class="string" id="7337738">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7337763">,</span>&nbsp;<span class="ident" id="7337765">err</span><span class="op" id="7337768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337774">testExecute</span><span class="op" id="7337785">(</span><span class="ident" id="7337786">multiExecTests</span><span class="op" id="7337800">,</span>&nbsp;<span class="ident" id="7337802">template</span><span class="op" id="7337810">,</span>&nbsp;<span class="ident" id="7337812">t</span><span class="op" id="7337813">)</span><br>
<span class="lineno">155</span><span class="op" id="7337815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7337818">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337914">var</span>&nbsp;<span class="ident" id="7337918">templateFileExecTests</span>&nbsp;<span class="op" id="7337940">=</span>&nbsp;<span class="op" id="7337942">[</span><span class="op" id="7337943">]</span><span class="ident" id="7337944">execTest</span><span class="op" id="7337952">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337955">{</span><span class="string" id="7337956">&#34;test&#34;</span><span class="op" id="7337962">,</span>&nbsp;<span class="string" id="7337964">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7338016">,</span>&nbsp;<span class="string" id="7338018">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7338052">,</span>&nbsp;<span class="num" id="7338054">0</span><span class="op" id="7338055">,</span>&nbsp;<span class="builtintype" id="7338057">true</span><span class="op" id="7338061">}</span><span class="op" id="7338062">,</span><br>
<span class="lineno"></span><span class="op" id="7338064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7338067">func</span>&nbsp;<span class="ident" id="7338072">TestParseFilesWithData</span><span class="op" id="7338094">(</span><span class="ident" id="7338095">t</span>&nbsp;<span class="op" id="7338097">*</span><span class="ident" id="7338098">testing</span><span class="op" id="7338105">.</span><span class="ident" id="7338106">T</span><span class="op" id="7338107">)</span>&nbsp;<span class="op" id="7338109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338112">template</span><span class="op" id="7338120">,</span>&nbsp;<span class="ident" id="7338122">err</span>&nbsp;<span class="op" id="7338126">:=</span>&nbsp;<span class="ident" id="7338129">New</span><span class="op" id="7338132">(</span><span class="string" id="7338133">&#34;root&#34;</span><span class="op" id="7338139">)</span><span class="op" id="7338140">.</span><span class="ident" id="7338141">ParseFiles</span><span class="op" id="7338151">(</span><span class="string" id="7338152">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7338173">,</span>&nbsp;<span class="string" id="7338175">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7338196">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7338199">if</span>&nbsp;<span class="ident" id="7338202">err</span>&nbsp;<span class="op" id="7338206">!=</span>&nbsp;<span class="ident" id="7338209">nil</span>&nbsp;<span class="op" id="7338213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338217">t</span><span class="op" id="7338218">.</span><span class="ident" id="7338219">Fatalf</span><span class="op" id="7338225">(</span><span class="string" id="7338226">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7338251">,</span>&nbsp;<span class="ident" id="7338253">err</span><span class="op" id="7338256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338262">testExecute</span><span class="op" id="7338273">(</span><span class="ident" id="7338274">templateFileExecTests</span><span class="op" id="7338295">,</span>&nbsp;<span class="ident" id="7338297">template</span><span class="op" id="7338305">,</span>&nbsp;<span class="ident" id="7338307">t</span><span class="op" id="7338308">)</span><br>
<span class="lineno"></span><span class="op" id="7338310">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7338313">func</span>&nbsp;<span class="ident" id="7338318">TestParseGlobWithData</span><span class="op" id="7338339">(</span><span class="ident" id="7338340">t</span>&nbsp;<span class="op" id="7338342">*</span><span class="ident" id="7338343">testing</span><span class="op" id="7338350">.</span><span class="ident" id="7338351">T</span><span class="op" id="7338352">)</span>&nbsp;<span class="op" id="7338354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338357">template</span><span class="op" id="7338365">,</span>&nbsp;<span class="ident" id="7338367">err</span>&nbsp;<span class="op" id="7338371">:=</span>&nbsp;<span class="ident" id="7338374">New</span><span class="op" id="7338377">(</span><span class="string" id="7338378">&#34;root&#34;</span><span class="op" id="7338384">)</span><span class="op" id="7338385">.</span><span class="ident" id="7338386">ParseGlob</span><span class="op" id="7338395">(</span><span class="string" id="7338396">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7338417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7338420">if</span>&nbsp;<span class="ident" id="7338423">err</span>&nbsp;<span class="op" id="7338427">!=</span>&nbsp;<span class="ident" id="7338430">nil</span>&nbsp;<span class="op" id="7338434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338438">t</span><span class="op" id="7338439">.</span><span class="ident" id="7338440">Fatalf</span><span class="op" id="7338446">(</span><span class="string" id="7338447">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7338472">,</span>&nbsp;<span class="ident" id="7338474">err</span><span class="op" id="7338477">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338483">testExecute</span><span class="op" id="7338494">(</span><span class="ident" id="7338495">templateFileExecTests</span><span class="op" id="7338516">,</span>&nbsp;<span class="ident" id="7338518">template</span><span class="op" id="7338526">,</span>&nbsp;<span class="ident" id="7338528">t</span><span class="op" id="7338529">)</span><br>
<span class="lineno"></span><span class="op" id="7338531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7338534">const</span>&nbsp;<span class="op" id="7338540">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338543">cloneText1</span>&nbsp;<span class="op" id="7338554">=</span>&nbsp;<span class="string" id="7338556">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338613">cloneText2</span>&nbsp;<span class="op" id="7338624">=</span>&nbsp;<span class="string" id="7338626">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338652">cloneText3</span>&nbsp;<span class="op" id="7338663">=</span>&nbsp;<span class="string" id="7338665">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338694">cloneText4</span>&nbsp;<span class="op" id="7338705">=</span>&nbsp;<span class="string" id="7338707">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7338736">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7338739">func</span>&nbsp;<span class="ident" id="7338744">TestClone</span><span class="op" id="7338753">(</span><span class="ident" id="7338754">t</span>&nbsp;<span class="op" id="7338756">*</span><span class="ident" id="7338757">testing</span><span class="op" id="7338764">.</span><span class="ident" id="7338765">T</span><span class="op" id="7338766">)</span>&nbsp;<span class="op" id="7338768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7338771">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338817">root</span><span class="op" id="7338821">,</span>&nbsp;<span class="ident" id="7338823">err</span>&nbsp;<span class="op" id="7338827">:=</span>&nbsp;<span class="ident" id="7338830">New</span><span class="op" id="7338833">(</span><span class="string" id="7338834">&#34;root&#34;</span><span class="op" id="7338840">)</span><span class="op" id="7338841">.</span><span class="ident" id="7338842">Parse</span><span class="op" id="7338847">(</span><span class="ident" id="7338848">cloneText1</span><span class="op" id="7338858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7338861">if</span>&nbsp;<span class="ident" id="7338864">err</span>&nbsp;<span class="op" id="7338868">!=</span>&nbsp;<span class="ident" id="7338871">nil</span>&nbsp;<span class="op" id="7338875">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338879">t</span><span class="op" id="7338880">.</span><span class="ident" id="7338881">Fatal</span><span class="op" id="7338886">(</span><span class="ident" id="7338887">err</span><span class="op" id="7338890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338896">_</span><span class="op" id="7338897">,</span>&nbsp;<span class="ident" id="7338899">err</span>&nbsp;<span class="op" id="7338903">=</span>&nbsp;<span class="ident" id="7338905">root</span><span class="op" id="7338909">.</span><span class="ident" id="7338910">Parse</span><span class="op" id="7338915">(</span><span class="ident" id="7338916">cloneText2</span><span class="op" id="7338926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7338929">if</span>&nbsp;<span class="ident" id="7338932">err</span>&nbsp;<span class="op" id="7338936">!=</span>&nbsp;<span class="ident" id="7338939">nil</span>&nbsp;<span class="op" id="7338943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338947">t</span><span class="op" id="7338948">.</span><span class="ident" id="7338949">Fatal</span><span class="op" id="7338954">(</span><span class="ident" id="7338955">err</span><span class="op" id="7338958">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338964">clone</span>&nbsp;<span class="op" id="7338970">:=</span>&nbsp;<span class="ident" id="7338973">Must</span><span class="op" id="7338977">(</span><span class="ident" id="7338978">root</span><span class="op" id="7338982">.</span><span class="ident" id="7338983">Clone</span><span class="op" id="7338988">(</span><span class="op" id="7338989">)</span><span class="op" id="7338990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7338993">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339019">_</span><span class="op" id="7339020">,</span>&nbsp;<span class="ident" id="7339022">err</span>&nbsp;<span class="op" id="7339026">=</span>&nbsp;<span class="ident" id="7339028">root</span><span class="op" id="7339032">.</span><span class="ident" id="7339033">Parse</span><span class="op" id="7339038">(</span><span class="ident" id="7339039">cloneText3</span><span class="op" id="7339049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339052">if</span>&nbsp;<span class="ident" id="7339055">err</span>&nbsp;<span class="op" id="7339059">!=</span>&nbsp;<span class="ident" id="7339062">nil</span>&nbsp;<span class="op" id="7339066">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339070">t</span><span class="op" id="7339071">.</span><span class="ident" id="7339072">Fatal</span><span class="op" id="7339077">(</span><span class="ident" id="7339078">err</span><span class="op" id="7339081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339087">_</span><span class="op" id="7339088">,</span>&nbsp;<span class="ident" id="7339090">err</span>&nbsp;<span class="op" id="7339094">=</span>&nbsp;<span class="ident" id="7339096">clone</span><span class="op" id="7339101">.</span><span class="ident" id="7339102">Parse</span><span class="op" id="7339107">(</span><span class="ident" id="7339108">cloneText4</span><span class="op" id="7339118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339121">if</span>&nbsp;<span class="ident" id="7339124">err</span>&nbsp;<span class="op" id="7339128">!=</span>&nbsp;<span class="ident" id="7339131">nil</span>&nbsp;<span class="op" id="7339135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339139">t</span><span class="op" id="7339140">.</span><span class="ident" id="7339141">Fatal</span><span class="op" id="7339146">(</span><span class="ident" id="7339147">err</span><span class="op" id="7339150">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339156">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339202">for</span>&nbsp;<span class="ident" id="7339206">k</span><span class="op" id="7339207">,</span>&nbsp;<span class="ident" id="7339209">v</span>&nbsp;<span class="op" id="7339211">:=</span>&nbsp;<span class="keyword" id="7339214">range</span>&nbsp;<span class="ident" id="7339220">clone</span><span class="op" id="7339225">.</span><span class="ident" id="7339226">tmpl</span>&nbsp;<span class="op" id="7339231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339235">if</span>&nbsp;<span class="ident" id="7339238">k</span>&nbsp;<span class="op" id="7339240">==</span>&nbsp;<span class="ident" id="7339243">clone</span><span class="op" id="7339248">.</span><span class="ident" id="7339249">name</span>&nbsp;<span class="op" id="7339254">&amp;&amp;</span>&nbsp;<span class="ident" id="7339257">v</span><span class="op" id="7339258">.</span><span class="ident" id="7339259">tmpl</span><span class="op" id="7339263">[</span><span class="ident" id="7339264">k</span><span class="op" id="7339265">]</span>&nbsp;<span class="op" id="7339267">!=</span>&nbsp;<span class="ident" id="7339270">clone</span>&nbsp;<span class="op" id="7339276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339281">t</span><span class="op" id="7339282">.</span><span class="ident" id="7339283">Error</span><span class="op" id="7339288">(</span><span class="string" id="7339289">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7339318">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339326">if</span>&nbsp;<span class="ident" id="7339329">v</span>&nbsp;<span class="op" id="7339331">!=</span>&nbsp;<span class="ident" id="7339334">v</span><span class="op" id="7339335">.</span><span class="ident" id="7339336">tmpl</span><span class="op" id="7339340">[</span><span class="ident" id="7339341">v</span><span class="op" id="7339342">.</span><span class="ident" id="7339343">name</span><span class="op" id="7339347">]</span>&nbsp;<span class="op" id="7339349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339354">t</span><span class="op" id="7339355">.</span><span class="ident" id="7339356">Errorf</span><span class="op" id="7339362">(</span><span class="string" id="7339363">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7339399">,</span>&nbsp;<span class="ident" id="7339401">k</span><span class="op" id="7339402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339409">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339412">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339430">var</span>&nbsp;<span class="ident" id="7339434">b</span>&nbsp;<span class="ident" id="7339436">bytes</span><span class="op" id="7339441">.</span><span class="ident" id="7339442">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339450">err</span>&nbsp;<span class="op" id="7339454">=</span>&nbsp;<span class="ident" id="7339456">root</span><span class="op" id="7339460">.</span><span class="ident" id="7339461">ExecuteTemplate</span><span class="op" id="7339476">(</span><span class="op" id="7339477">&amp;</span><span class="ident" id="7339478">b</span><span class="op" id="7339479">,</span>&nbsp;<span class="string" id="7339481">&#34;a&#34;</span><span class="op" id="7339484">,</span>&nbsp;<span class="num" id="7339486">0</span><span class="op" id="7339487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339490">if</span>&nbsp;<span class="ident" id="7339493">err</span>&nbsp;<span class="op" id="7339497">!=</span>&nbsp;<span class="ident" id="7339500">nil</span>&nbsp;<span class="op" id="7339504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339508">t</span><span class="op" id="7339509">.</span><span class="ident" id="7339510">Fatal</span><span class="op" id="7339515">(</span><span class="ident" id="7339516">err</span><span class="op" id="7339519">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339525">if</span>&nbsp;<span class="ident" id="7339528">b</span><span class="op" id="7339529">.</span><span class="ident" id="7339530">String</span><span class="op" id="7339536">(</span><span class="op" id="7339537">)</span>&nbsp;<span class="op" id="7339539">!=</span>&nbsp;<span class="string" id="7339542">&#34;broot&#34;</span>&nbsp;<span class="op" id="7339550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339554">t</span><span class="op" id="7339555">.</span><span class="ident" id="7339556">Errorf</span><span class="op" id="7339562">(</span><span class="string" id="7339563">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7339583">,</span>&nbsp;<span class="string" id="7339585">&#34;broot&#34;</span><span class="op" id="7339592">,</span>&nbsp;<span class="ident" id="7339594">b</span><span class="op" id="7339595">.</span><span class="ident" id="7339596">String</span><span class="op" id="7339602">(</span><span class="op" id="7339603">)</span><span class="op" id="7339604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339610">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339628">b</span><span class="op" id="7339629">.</span><span class="ident" id="7339630">Reset</span><span class="op" id="7339635">(</span><span class="op" id="7339636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339639">err</span>&nbsp;<span class="op" id="7339643">=</span>&nbsp;<span class="ident" id="7339645">clone</span><span class="op" id="7339650">.</span><span class="ident" id="7339651">ExecuteTemplate</span><span class="op" id="7339666">(</span><span class="op" id="7339667">&amp;</span><span class="ident" id="7339668">b</span><span class="op" id="7339669">,</span>&nbsp;<span class="string" id="7339671">&#34;a&#34;</span><span class="op" id="7339674">,</span>&nbsp;<span class="num" id="7339676">0</span><span class="op" id="7339677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339680">if</span>&nbsp;<span class="ident" id="7339683">err</span>&nbsp;<span class="op" id="7339687">!=</span>&nbsp;<span class="ident" id="7339690">nil</span>&nbsp;<span class="op" id="7339694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339698">t</span><span class="op" id="7339699">.</span><span class="ident" id="7339700">Fatal</span><span class="op" id="7339705">(</span><span class="ident" id="7339706">err</span><span class="op" id="7339709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339712">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339715">if</span>&nbsp;<span class="ident" id="7339718">b</span><span class="op" id="7339719">.</span><span class="ident" id="7339720">String</span><span class="op" id="7339726">(</span><span class="op" id="7339727">)</span>&nbsp;<span class="op" id="7339729">!=</span>&nbsp;<span class="string" id="7339732">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7339741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339745">t</span><span class="op" id="7339746">.</span><span class="ident" id="7339747">Errorf</span><span class="op" id="7339753">(</span><span class="string" id="7339754">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7339774">,</span>&nbsp;<span class="string" id="7339776">&#34;bclone&#34;</span><span class="op" id="7339784">,</span>&nbsp;<span class="ident" id="7339786">b</span><span class="op" id="7339787">.</span><span class="ident" id="7339788">String</span><span class="op" id="7339794">(</span><span class="op" id="7339795">)</span><span class="op" id="7339796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339799">}</span><br>
<span class="lineno"></span><span class="op" id="7339801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7339804">func</span>&nbsp;<span class="ident" id="7339809">TestAddParseTree</span><span class="op" id="7339825">(</span><span class="ident" id="7339826">t</span>&nbsp;<span class="op" id="7339828">*</span><span class="ident" id="7339829">testing</span><span class="op" id="7339836">.</span><span class="ident" id="7339837">T</span><span class="op" id="7339838">)</span>&nbsp;<span class="op" id="7339840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339843">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339870">root</span><span class="op" id="7339874">,</span>&nbsp;<span class="ident" id="7339876">err</span>&nbsp;<span class="op" id="7339880">:=</span>&nbsp;<span class="ident" id="7339883">New</span><span class="op" id="7339886">(</span><span class="string" id="7339887">&#34;root&#34;</span><span class="op" id="7339893">)</span><span class="op" id="7339894">.</span><span class="ident" id="7339895">Parse</span><span class="op" id="7339900">(</span><span class="ident" id="7339901">cloneText1</span><span class="op" id="7339911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339914">if</span>&nbsp;<span class="ident" id="7339917">err</span>&nbsp;<span class="op" id="7339921">!=</span>&nbsp;<span class="ident" id="7339924">nil</span>&nbsp;<span class="op" id="7339928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339932">t</span><span class="op" id="7339933">.</span><span class="ident" id="7339934">Fatal</span><span class="op" id="7339939">(</span><span class="ident" id="7339940">err</span><span class="op" id="7339943">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339949">_</span><span class="op" id="7339950">,</span>&nbsp;<span class="ident" id="7339952">err</span>&nbsp;<span class="op" id="7339956">=</span>&nbsp;<span class="ident" id="7339958">root</span><span class="op" id="7339962">.</span><span class="ident" id="7339963">Parse</span><span class="op" id="7339968">(</span><span class="ident" id="7339969">cloneText2</span><span class="op" id="7339979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7339982">if</span>&nbsp;<span class="ident" id="7339985">err</span>&nbsp;<span class="op" id="7339989">!=</span>&nbsp;<span class="ident" id="7339992">nil</span>&nbsp;<span class="op" id="7339996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340000">t</span><span class="op" id="7340001">.</span><span class="ident" id="7340002">Fatal</span><span class="op" id="7340007">(</span><span class="ident" id="7340008">err</span><span class="op" id="7340011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340014">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7340017">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340043">tree</span><span class="op" id="7340047">,</span>&nbsp;<span class="ident" id="7340049">err</span>&nbsp;<span class="op" id="7340053">:=</span>&nbsp;<span class="ident" id="7340056">parse</span><span class="op" id="7340061">.</span><span class="ident" id="7340062">Parse</span><span class="op" id="7340067">(</span><span class="string" id="7340068">&#34;cloneText3&#34;</span><span class="op" id="7340080">,</span>&nbsp;<span class="ident" id="7340082">cloneText3</span><span class="op" id="7340092">,</span>&nbsp;<span class="string" id="7340094">&#34;&#34;</span><span class="op" id="7340096">,</span>&nbsp;<span class="string" id="7340098">&#34;&#34;</span><span class="op" id="7340100">,</span>&nbsp;<span class="ident" id="7340102">nil</span><span class="op" id="7340105">,</span>&nbsp;<span class="ident" id="7340107">builtins</span><span class="op" id="7340115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340118">if</span>&nbsp;<span class="ident" id="7340121">err</span>&nbsp;<span class="op" id="7340125">!=</span>&nbsp;<span class="ident" id="7340128">nil</span>&nbsp;<span class="op" id="7340132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340136">t</span><span class="op" id="7340137">.</span><span class="ident" id="7340138">Fatal</span><span class="op" id="7340143">(</span><span class="ident" id="7340144">err</span><span class="op" id="7340147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340150">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340153">added</span><span class="op" id="7340158">,</span>&nbsp;<span class="ident" id="7340160">err</span>&nbsp;<span class="op" id="7340164">:=</span>&nbsp;<span class="ident" id="7340167">root</span><span class="op" id="7340171">.</span><span class="ident" id="7340172">AddParseTree</span><span class="op" id="7340184">(</span><span class="string" id="7340185">&#34;c&#34;</span><span class="op" id="7340188">,</span>&nbsp;<span class="ident" id="7340190">tree</span><span class="op" id="7340194">[</span><span class="string" id="7340195">&#34;c&#34;</span><span class="op" id="7340198">]</span><span class="op" id="7340199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7340202">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340215">var</span>&nbsp;<span class="ident" id="7340219">b</span>&nbsp;<span class="ident" id="7340221">bytes</span><span class="op" id="7340226">.</span><span class="ident" id="7340227">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340235">err</span>&nbsp;<span class="op" id="7340239">=</span>&nbsp;<span class="ident" id="7340241">added</span><span class="op" id="7340246">.</span><span class="ident" id="7340247">ExecuteTemplate</span><span class="op" id="7340262">(</span><span class="op" id="7340263">&amp;</span><span class="ident" id="7340264">b</span><span class="op" id="7340265">,</span>&nbsp;<span class="string" id="7340267">&#34;a&#34;</span><span class="op" id="7340270">,</span>&nbsp;<span class="num" id="7340272">0</span><span class="op" id="7340273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340276">if</span>&nbsp;<span class="ident" id="7340279">err</span>&nbsp;<span class="op" id="7340283">!=</span>&nbsp;<span class="ident" id="7340286">nil</span>&nbsp;<span class="op" id="7340290">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340294">t</span><span class="op" id="7340295">.</span><span class="ident" id="7340296">Fatal</span><span class="op" id="7340301">(</span><span class="ident" id="7340302">err</span><span class="op" id="7340305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340311">if</span>&nbsp;<span class="ident" id="7340314">b</span><span class="op" id="7340315">.</span><span class="ident" id="7340316">String</span><span class="op" id="7340322">(</span><span class="op" id="7340323">)</span>&nbsp;<span class="op" id="7340325">!=</span>&nbsp;<span class="string" id="7340328">&#34;broot&#34;</span>&nbsp;<span class="op" id="7340336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340340">t</span><span class="op" id="7340341">.</span><span class="ident" id="7340342">Errorf</span><span class="op" id="7340348">(</span><span class="string" id="7340349">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7340369">,</span>&nbsp;<span class="string" id="7340371">&#34;broot&#34;</span><span class="op" id="7340378">,</span>&nbsp;<span class="ident" id="7340380">b</span><span class="op" id="7340381">.</span><span class="ident" id="7340382">String</span><span class="op" id="7340388">(</span><span class="op" id="7340389">)</span><span class="op" id="7340390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340393">}</span><br>
<span class="lineno">260</span><span class="op" id="7340395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7340398">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7340412">func</span>&nbsp;<span class="ident" id="7340417">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7340451">(</span><span class="ident" id="7340452">t</span>&nbsp;<span class="op" id="7340454">*</span><span class="ident" id="7340455">testing</span><span class="op" id="7340462">.</span><span class="ident" id="7340463">T</span><span class="op" id="7340464">)</span>&nbsp;<span class="op" id="7340466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340469">master</span>&nbsp;<span class="op" id="7340476">:=</span>&nbsp;<span class="string" id="7340479">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340511">tmpl</span>&nbsp;<span class="op" id="7340516">:=</span>&nbsp;<span class="ident" id="7340519">New</span><span class="op" id="7340522">(</span><span class="string" id="7340523">&#34;master&#34;</span><span class="op" id="7340531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340534">tree</span><span class="op" id="7340538">,</span>&nbsp;<span class="ident" id="7340540">err</span>&nbsp;<span class="op" id="7340544">:=</span>&nbsp;<span class="ident" id="7340547">parse</span><span class="op" id="7340552">.</span><span class="ident" id="7340553">Parse</span><span class="op" id="7340558">(</span><span class="string" id="7340559">&#34;master&#34;</span><span class="op" id="7340567">,</span>&nbsp;<span class="ident" id="7340569">master</span><span class="op" id="7340575">,</span>&nbsp;<span class="string" id="7340577">&#34;&#34;</span><span class="op" id="7340579">,</span>&nbsp;<span class="string" id="7340581">&#34;&#34;</span><span class="op" id="7340583">,</span>&nbsp;<span class="ident" id="7340585">nil</span><span class="op" id="7340588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340591">if</span>&nbsp;<span class="ident" id="7340594">err</span>&nbsp;<span class="op" id="7340598">!=</span>&nbsp;<span class="ident" id="7340601">nil</span>&nbsp;<span class="op" id="7340605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340609">t</span><span class="op" id="7340610">.</span><span class="ident" id="7340611">Fatalf</span><span class="op" id="7340617">(</span><span class="string" id="7340618">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7340644">,</span>&nbsp;<span class="ident" id="7340646">err</span><span class="op" id="7340649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340652">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340655">masterTree</span>&nbsp;<span class="op" id="7340666">:=</span>&nbsp;<span class="ident" id="7340669">tree</span><span class="op" id="7340673">[</span><span class="string" id="7340674">&#34;master&#34;</span><span class="op" id="7340682">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340685">tmpl</span><span class="op" id="7340689">.</span><span class="ident" id="7340690">AddParseTree</span><span class="op" id="7340702">(</span><span class="string" id="7340703">&#34;master&#34;</span><span class="op" id="7340711">,</span>&nbsp;<span class="ident" id="7340713">masterTree</span><span class="op" id="7340723">)</span>&nbsp;<span class="comment" id="7340725">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7340742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7340745">func</span>&nbsp;<span class="ident" id="7340750">TestRedefinition</span><span class="op" id="7340766">(</span><span class="ident" id="7340767">t</span>&nbsp;<span class="op" id="7340769">*</span><span class="ident" id="7340770">testing</span><span class="op" id="7340777">.</span><span class="ident" id="7340778">T</span><span class="op" id="7340779">)</span>&nbsp;<span class="op" id="7340781">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340784">var</span>&nbsp;<span class="ident" id="7340788">tmpl</span>&nbsp;<span class="op" id="7340793">*</span><span class="ident" id="7340794">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340804">var</span>&nbsp;<span class="ident" id="7340808">err</span>&nbsp;<span class="builtintype" id="7340812">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340819">if</span>&nbsp;<span class="ident" id="7340822">tmpl</span><span class="op" id="7340826">,</span>&nbsp;<span class="ident" id="7340828">err</span>&nbsp;<span class="op" id="7340832">=</span>&nbsp;<span class="ident" id="7340834">New</span><span class="op" id="7340837">(</span><span class="string" id="7340838">&#34;tmpl1&#34;</span><span class="op" id="7340845">)</span><span class="op" id="7340846">.</span><span class="ident" id="7340847">Parse</span><span class="op" id="7340852">(</span><span class="string" id="7340853">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7340882">)</span><span class="op" id="7340883">;</span>&nbsp;<span class="ident" id="7340885">err</span>&nbsp;<span class="op" id="7340889">!=</span>&nbsp;<span class="ident" id="7340892">nil</span>&nbsp;<span class="op" id="7340896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340900">t</span><span class="op" id="7340901">.</span><span class="ident" id="7340902">Fatalf</span><span class="op" id="7340908">(</span><span class="string" id="7340909">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7340922">,</span>&nbsp;<span class="ident" id="7340924">err</span><span class="op" id="7340927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340930">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7340933">if</span>&nbsp;<span class="ident" id="7340936">_</span><span class="op" id="7340937">,</span>&nbsp;<span class="ident" id="7340939">err</span>&nbsp;<span class="op" id="7340943">=</span>&nbsp;<span class="ident" id="7340945">tmpl</span><span class="op" id="7340949">.</span><span class="ident" id="7340950">Parse</span><span class="op" id="7340955">(</span><span class="string" id="7340956">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7340985">)</span><span class="op" id="7340986">;</span>&nbsp;<span class="ident" id="7340988">err</span>&nbsp;<span class="op" id="7340992">==</span>&nbsp;<span class="ident" id="7340995">nil</span>&nbsp;<span class="op" id="7340999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341003">t</span><span class="op" id="7341004">.</span><span class="ident" id="7341005">Fatal</span><span class="op" id="7341010">(</span><span class="string" id="7341011">&#34;expected&nbsp;error&#34;</span><span class="op" id="7341027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7341033">if</span>&nbsp;<span class="op" id="7341036">!</span><span class="ident" id="7341037">strings</span><span class="op" id="7341044">.</span><span class="ident" id="7341045">Contains</span><span class="op" id="7341053">(</span><span class="ident" id="7341054">err</span><span class="op" id="7341057">.</span><span class="ident" id="7341058">Error</span><span class="op" id="7341063">(</span><span class="op" id="7341064">)</span><span class="op" id="7341065">,</span>&nbsp;<span class="string" id="7341067">&#34;redefinition&#34;</span><span class="op" id="7341081">)</span>&nbsp;<span class="op" id="7341083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341087">t</span><span class="op" id="7341088">.</span><span class="ident" id="7341089">Fatalf</span><span class="op" id="7341095">(</span><span class="string" id="7341096">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7341133">,</span>&nbsp;<span class="ident" id="7341135">err</span><span class="op" id="7341138">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7341144">if</span>&nbsp;<span class="ident" id="7341147">_</span><span class="op" id="7341148">,</span>&nbsp;<span class="ident" id="7341150">err</span>&nbsp;<span class="op" id="7341154">=</span>&nbsp;<span class="ident" id="7341156">tmpl</span><span class="op" id="7341160">.</span><span class="ident" id="7341161">New</span><span class="op" id="7341164">(</span><span class="string" id="7341165">&#34;tmpl2&#34;</span><span class="op" id="7341172">)</span><span class="op" id="7341173">.</span><span class="ident" id="7341174">Parse</span><span class="op" id="7341179">(</span><span class="string" id="7341180">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7341209">)</span><span class="op" id="7341210">;</span>&nbsp;<span class="ident" id="7341212">err</span>&nbsp;<span class="op" id="7341216">==</span>&nbsp;<span class="ident" id="7341219">nil</span>&nbsp;<span class="op" id="7341223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341227">t</span><span class="op" id="7341228">.</span><span class="ident" id="7341229">Fatal</span><span class="op" id="7341234">(</span><span class="string" id="7341235">&#34;expected&nbsp;error&#34;</span><span class="op" id="7341251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7341257">if</span>&nbsp;<span class="op" id="7341260">!</span><span class="ident" id="7341261">strings</span><span class="op" id="7341268">.</span><span class="ident" id="7341269">Contains</span><span class="op" id="7341277">(</span><span class="ident" id="7341278">err</span><span class="op" id="7341281">.</span><span class="ident" id="7341282">Error</span><span class="op" id="7341287">(</span><span class="op" id="7341288">)</span><span class="op" id="7341289">,</span>&nbsp;<span class="string" id="7341291">&#34;redefinition&#34;</span><span class="op" id="7341305">)</span>&nbsp;<span class="op" id="7341307">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341311">t</span><span class="op" id="7341312">.</span><span class="ident" id="7341313">Fatalf</span><span class="op" id="7341319">(</span><span class="string" id="7341320">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7341357">,</span>&nbsp;<span class="ident" id="7341359">err</span><span class="op" id="7341362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341365">}</span><br>
<span class="lineno"></span><span class="op" id="7341367">}</span>
</div>
</body>
</html>
