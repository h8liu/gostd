<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5189186">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5189241">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5189295">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5189346">package</span>&nbsp;<span class="ident" id="5189354">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5189364">import</span>&nbsp;<span class="op" id="5189371">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189374">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189381">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189387">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189400">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189417">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189425">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5189442">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5189464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5189467">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5189547">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5189574">type</span>&nbsp;<span class="ident" id="5189579">Template</span>&nbsp;<span class="keyword" id="5189588">struct</span>&nbsp;<span class="op" id="5189595">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5189598">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5189634">escapeErr</span>&nbsp;<span class="builtintype" id="5189644">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5189651">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5189725">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5189794">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5189818">text</span>&nbsp;<span class="op" id="5189823">*</span><span class="ident" id="5189824">template</span><span class="op" id="5189832">.</span><span class="ident" id="5189833">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5189843">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5189910">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5189921">*</span><span class="ident" id="5189922">parse</span><span class="op" id="5189927">.</span><span class="ident" id="5189928">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5189934">*</span><span class="ident" id="5189935">nameSpace</span>&nbsp;<span class="comment" id="5189945">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5189983">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5189986">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5190051">var</span>&nbsp;<span class="ident" id="5190055">escapeOK</span>&nbsp;<span class="op" id="5190064">=</span>&nbsp;<span class="ident" id="5190066">fmt</span><span class="op" id="5190069">.</span><span class="ident" id="5190070">Errorf</span><span class="op" id="5190076">(</span><span class="string" id="5190077">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5190105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5190108">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5190186">type</span>&nbsp;<span class="ident" id="5190191">nameSpace</span>&nbsp;<span class="keyword" id="5190201">struct</span>&nbsp;<span class="op" id="5190208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190211">mu</span>&nbsp;&nbsp;<span class="ident" id="5190215">sync</span><span class="op" id="5190219">.</span><span class="ident" id="5190220">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190227">set</span>&nbsp;<span class="keyword" id="5190231">map</span><span class="op" id="5190234">[</span><span class="builtintype" id="5190235">string</span><span class="op" id="5190241">]</span><span class="op" id="5190242">*</span><span class="ident" id="5190243">Template</span><br>
<span class="lineno"></span><span class="op" id="5190252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5190255">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5190332">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5190343">func</span>&nbsp;<span class="op" id="5190348">(</span><span class="ident" id="5190349">t</span>&nbsp;<span class="op" id="5190351">*</span><span class="ident" id="5190352">Template</span><span class="op" id="5190360">)</span>&nbsp;<span class="ident" id="5190362">Templates</span><span class="op" id="5190371">(</span><span class="op" id="5190372">)</span>&nbsp;<span class="op" id="5190374">[</span><span class="op" id="5190375">]</span><span class="op" id="5190376">*</span><span class="ident" id="5190377">Template</span>&nbsp;<span class="op" id="5190386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190389">ns</span>&nbsp;<span class="op" id="5190392">:=</span>&nbsp;<span class="ident" id="5190395">t</span><span class="op" id="5190396">.</span><span class="ident" id="5190397">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190408">ns</span><span class="op" id="5190410">.</span><span class="ident" id="5190411">mu</span><span class="op" id="5190413">.</span><span class="ident" id="5190414">Lock</span><span class="op" id="5190418">(</span><span class="op" id="5190419">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190422">defer</span>&nbsp;<span class="ident" id="5190428">ns</span><span class="op" id="5190430">.</span><span class="ident" id="5190431">mu</span><span class="op" id="5190433">.</span><span class="ident" id="5190434">Unlock</span><span class="op" id="5190440">(</span><span class="op" id="5190441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5190444">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190491">m</span>&nbsp;<span class="op" id="5190493">:=</span>&nbsp;<span class="builtinfunc" id="5190496">make</span><span class="op" id="5190500">(</span><span class="op" id="5190501">[</span><span class="op" id="5190502">]</span><span class="op" id="5190503">*</span><span class="ident" id="5190504">Template</span><span class="op" id="5190512">,</span>&nbsp;<span class="num" id="5190514">0</span><span class="op" id="5190515">,</span>&nbsp;<span class="builtinfunc" id="5190517">len</span><span class="op" id="5190520">(</span><span class="ident" id="5190521">ns</span><span class="op" id="5190523">.</span><span class="ident" id="5190524">set</span><span class="op" id="5190527">)</span><span class="op" id="5190528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190531">for</span>&nbsp;<span class="ident" id="5190535">_</span><span class="op" id="5190536">,</span>&nbsp;<span class="ident" id="5190538">v</span>&nbsp;<span class="op" id="5190540">:=</span>&nbsp;<span class="keyword" id="5190543">range</span>&nbsp;<span class="ident" id="5190549">ns</span><span class="op" id="5190551">.</span><span class="ident" id="5190552">set</span>&nbsp;<span class="op" id="5190556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190560">m</span>&nbsp;<span class="op" id="5190562">=</span>&nbsp;<span class="builtinfunc" id="5190564">append</span><span class="op" id="5190570">(</span><span class="ident" id="5190571">m</span><span class="op" id="5190572">,</span>&nbsp;<span class="ident" id="5190574">v</span><span class="op" id="5190575">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190581">return</span>&nbsp;<span class="ident" id="5190588">m</span><br>
<span class="lineno"></span><span class="op" id="5190590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5190593">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5190637">func</span>&nbsp;<span class="op" id="5190642">(</span><span class="ident" id="5190643">t</span>&nbsp;<span class="op" id="5190645">*</span><span class="ident" id="5190646">Template</span><span class="op" id="5190654">)</span>&nbsp;<span class="ident" id="5190656">escape</span><span class="op" id="5190662">(</span><span class="op" id="5190663">)</span>&nbsp;<span class="builtintype" id="5190665">error</span>&nbsp;<span class="op" id="5190671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190674">t</span><span class="op" id="5190675">.</span><span class="ident" id="5190676">nameSpace</span><span class="op" id="5190685">.</span><span class="ident" id="5190686">mu</span><span class="op" id="5190688">.</span><span class="ident" id="5190689">Lock</span><span class="op" id="5190693">(</span><span class="op" id="5190694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190697">defer</span>&nbsp;<span class="ident" id="5190703">t</span><span class="op" id="5190704">.</span><span class="ident" id="5190705">nameSpace</span><span class="op" id="5190714">.</span><span class="ident" id="5190715">mu</span><span class="op" id="5190717">.</span><span class="ident" id="5190718">Unlock</span><span class="op" id="5190724">(</span><span class="op" id="5190725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190728">if</span>&nbsp;<span class="ident" id="5190731">t</span><span class="op" id="5190732">.</span><span class="ident" id="5190733">escapeErr</span>&nbsp;<span class="op" id="5190743">==</span>&nbsp;<span class="builtintype" id="5190746">nil</span>&nbsp;<span class="op" id="5190750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190754">if</span>&nbsp;<span class="ident" id="5190757">err</span>&nbsp;<span class="op" id="5190761">:=</span>&nbsp;<span class="ident" id="5190764">escapeTemplate</span><span class="op" id="5190778">(</span><span class="ident" id="5190779">t</span><span class="op" id="5190780">,</span>&nbsp;<span class="ident" id="5190782">t</span><span class="op" id="5190783">.</span><span class="ident" id="5190784">text</span><span class="op" id="5190788">.</span><span class="ident" id="5190789">Root</span><span class="op" id="5190793">,</span>&nbsp;<span class="ident" id="5190795">t</span><span class="op" id="5190796">.</span><span class="ident" id="5190797">Name</span><span class="op" id="5190801">(</span><span class="op" id="5190802">)</span><span class="op" id="5190803">)</span><span class="op" id="5190804">;</span>&nbsp;<span class="ident" id="5190806">err</span>&nbsp;<span class="op" id="5190810">!=</span>&nbsp;<span class="builtintype" id="5190813">nil</span>&nbsp;<span class="op" id="5190817">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190822">return</span>&nbsp;<span class="ident" id="5190829">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190838">}</span>&nbsp;<span class="keyword" id="5190840">else</span>&nbsp;<span class="keyword" id="5190845">if</span>&nbsp;<span class="ident" id="5190848">t</span><span class="op" id="5190849">.</span><span class="ident" id="5190850">escapeErr</span>&nbsp;<span class="op" id="5190860">!=</span>&nbsp;<span class="ident" id="5190863">escapeOK</span>&nbsp;<span class="op" id="5190872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190876">return</span>&nbsp;<span class="ident" id="5190883">t</span><span class="op" id="5190884">.</span><span class="ident" id="5190885">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190896">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190899">return</span>&nbsp;<span class="builtintype" id="5190906">nil</span><br>
<span class="lineno"></span><span class="op" id="5190910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5190913">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5190980">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5191009">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5191077">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5191150">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5191172">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5191222">func</span>&nbsp;<span class="op" id="5191227">(</span><span class="ident" id="5191228">t</span>&nbsp;<span class="op" id="5191230">*</span><span class="ident" id="5191231">Template</span><span class="op" id="5191239">)</span>&nbsp;<span class="ident" id="5191241">Execute</span><span class="op" id="5191248">(</span><span class="ident" id="5191249">wr</span>&nbsp;<span class="ident" id="5191252">io</span><span class="op" id="5191254">.</span><span class="ident" id="5191255">Writer</span><span class="op" id="5191261">,</span>&nbsp;<span class="ident" id="5191263">data</span>&nbsp;<span class="keyword" id="5191268">interface</span><span class="op" id="5191277">{</span><span class="op" id="5191278">}</span><span class="op" id="5191279">)</span>&nbsp;<span class="builtintype" id="5191281">error</span>&nbsp;<span class="op" id="5191287">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191290">if</span>&nbsp;<span class="ident" id="5191293">err</span>&nbsp;<span class="op" id="5191297">:=</span>&nbsp;<span class="ident" id="5191300">t</span><span class="op" id="5191301">.</span><span class="ident" id="5191302">escape</span><span class="op" id="5191308">(</span><span class="op" id="5191309">)</span><span class="op" id="5191310">;</span>&nbsp;<span class="ident" id="5191312">err</span>&nbsp;<span class="op" id="5191316">!=</span>&nbsp;<span class="builtintype" id="5191319">nil</span>&nbsp;<span class="op" id="5191323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191327">return</span>&nbsp;<span class="ident" id="5191334">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191342">return</span>&nbsp;<span class="ident" id="5191349">t</span><span class="op" id="5191350">.</span><span class="ident" id="5191351">text</span><span class="op" id="5191355">.</span><span class="ident" id="5191356">Execute</span><span class="op" id="5191363">(</span><span class="ident" id="5191364">wr</span><span class="op" id="5191366">,</span>&nbsp;<span class="ident" id="5191368">data</span><span class="op" id="5191372">)</span><br>
<span class="lineno"></span><span class="op" id="5191374">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5191377">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5191454">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5191520">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5191588">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5191661">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5191683">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5191733">func</span>&nbsp;<span class="op" id="5191738">(</span><span class="ident" id="5191739">t</span>&nbsp;<span class="op" id="5191741">*</span><span class="ident" id="5191742">Template</span><span class="op" id="5191750">)</span>&nbsp;<span class="ident" id="5191752">ExecuteTemplate</span><span class="op" id="5191767">(</span><span class="ident" id="5191768">wr</span>&nbsp;<span class="ident" id="5191771">io</span><span class="op" id="5191773">.</span><span class="ident" id="5191774">Writer</span><span class="op" id="5191780">,</span>&nbsp;<span class="ident" id="5191782">name</span>&nbsp;<span class="builtintype" id="5191787">string</span><span class="op" id="5191793">,</span>&nbsp;<span class="ident" id="5191795">data</span>&nbsp;<span class="keyword" id="5191800">interface</span><span class="op" id="5191809">{</span><span class="op" id="5191810">}</span><span class="op" id="5191811">)</span>&nbsp;<span class="builtintype" id="5191813">error</span>&nbsp;<span class="op" id="5191819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5191822">tmpl</span><span class="op" id="5191826">,</span>&nbsp;<span class="ident" id="5191828">err</span>&nbsp;<span class="op" id="5191832">:=</span>&nbsp;<span class="ident" id="5191835">t</span><span class="op" id="5191836">.</span><span class="ident" id="5191837">lookupAndEscapeTemplate</span><span class="op" id="5191860">(</span><span class="ident" id="5191861">name</span><span class="op" id="5191865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191868">if</span>&nbsp;<span class="ident" id="5191871">err</span>&nbsp;<span class="op" id="5191875">!=</span>&nbsp;<span class="builtintype" id="5191878">nil</span>&nbsp;<span class="op" id="5191882">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191886">return</span>&nbsp;<span class="ident" id="5191893">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191901">return</span>&nbsp;<span class="ident" id="5191908">tmpl</span><span class="op" id="5191912">.</span><span class="ident" id="5191913">text</span><span class="op" id="5191917">.</span><span class="ident" id="5191918">Execute</span><span class="op" id="5191925">(</span><span class="ident" id="5191926">wr</span><span class="op" id="5191928">,</span>&nbsp;<span class="ident" id="5191930">data</span><span class="op" id="5191934">)</span><br>
<span class="lineno"></span><span class="op" id="5191936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5191939">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5192015">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5192088">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5192101">func</span>&nbsp;<span class="op" id="5192106">(</span><span class="ident" id="5192107">t</span>&nbsp;<span class="op" id="5192109">*</span><span class="ident" id="5192110">Template</span><span class="op" id="5192118">)</span>&nbsp;<span class="ident" id="5192120">lookupAndEscapeTemplate</span><span class="op" id="5192143">(</span><span class="ident" id="5192144">name</span>&nbsp;<span class="builtintype" id="5192149">string</span><span class="op" id="5192155">)</span>&nbsp;<span class="op" id="5192157">(</span><span class="ident" id="5192158">tmpl</span>&nbsp;<span class="op" id="5192163">*</span><span class="ident" id="5192164">Template</span><span class="op" id="5192172">,</span>&nbsp;<span class="ident" id="5192174">err</span>&nbsp;<span class="builtintype" id="5192178">error</span><span class="op" id="5192183">)</span>&nbsp;<span class="op" id="5192185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192188">t</span><span class="op" id="5192189">.</span><span class="ident" id="5192190">nameSpace</span><span class="op" id="5192199">.</span><span class="ident" id="5192200">mu</span><span class="op" id="5192202">.</span><span class="ident" id="5192203">Lock</span><span class="op" id="5192207">(</span><span class="op" id="5192208">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192211">defer</span>&nbsp;<span class="ident" id="5192217">t</span><span class="op" id="5192218">.</span><span class="ident" id="5192219">nameSpace</span><span class="op" id="5192228">.</span><span class="ident" id="5192229">mu</span><span class="op" id="5192231">.</span><span class="ident" id="5192232">Unlock</span><span class="op" id="5192238">(</span><span class="op" id="5192239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192242">tmpl</span>&nbsp;<span class="op" id="5192247">=</span>&nbsp;<span class="ident" id="5192249">t</span><span class="op" id="5192250">.</span><span class="ident" id="5192251">set</span><span class="op" id="5192254">[</span><span class="ident" id="5192255">name</span><span class="op" id="5192259">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192262">if</span>&nbsp;<span class="ident" id="5192265">tmpl</span>&nbsp;<span class="op" id="5192270">==</span>&nbsp;<span class="builtintype" id="5192273">nil</span>&nbsp;<span class="op" id="5192277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192281">return</span>&nbsp;<span class="builtintype" id="5192288">nil</span><span class="op" id="5192291">,</span>&nbsp;<span class="ident" id="5192293">fmt</span><span class="op" id="5192296">.</span><span class="ident" id="5192297">Errorf</span><span class="op" id="5192303">(</span><span class="string" id="5192304">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5192336">,</span>&nbsp;<span class="ident" id="5192338">name</span><span class="op" id="5192342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192345">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192348">if</span>&nbsp;<span class="ident" id="5192351">tmpl</span><span class="op" id="5192355">.</span><span class="ident" id="5192356">escapeErr</span>&nbsp;<span class="op" id="5192366">!=</span>&nbsp;<span class="builtintype" id="5192369">nil</span>&nbsp;<span class="op" id="5192373">&amp;&amp;</span>&nbsp;<span class="ident" id="5192376">tmpl</span><span class="op" id="5192380">.</span><span class="ident" id="5192381">escapeErr</span>&nbsp;<span class="op" id="5192391">!=</span>&nbsp;<span class="ident" id="5192394">escapeOK</span>&nbsp;<span class="op" id="5192403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192407">return</span>&nbsp;<span class="builtintype" id="5192414">nil</span><span class="op" id="5192417">,</span>&nbsp;<span class="ident" id="5192419">tmpl</span><span class="op" id="5192423">.</span><span class="ident" id="5192424">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192438">if</span>&nbsp;<span class="ident" id="5192441">tmpl</span><span class="op" id="5192445">.</span><span class="ident" id="5192446">text</span><span class="op" id="5192450">.</span><span class="ident" id="5192451">Tree</span>&nbsp;<span class="op" id="5192456">==</span>&nbsp;<span class="builtintype" id="5192459">nil</span>&nbsp;<span class="op" id="5192463">||</span>&nbsp;<span class="ident" id="5192466">tmpl</span><span class="op" id="5192470">.</span><span class="ident" id="5192471">text</span><span class="op" id="5192475">.</span><span class="ident" id="5192476">Root</span>&nbsp;<span class="op" id="5192481">==</span>&nbsp;<span class="builtintype" id="5192484">nil</span>&nbsp;<span class="op" id="5192488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192492">return</span>&nbsp;<span class="builtintype" id="5192499">nil</span><span class="op" id="5192502">,</span>&nbsp;<span class="ident" id="5192504">fmt</span><span class="op" id="5192507">.</span><span class="ident" id="5192508">Errorf</span><span class="op" id="5192514">(</span><span class="string" id="5192515">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5192560">,</span>&nbsp;<span class="ident" id="5192562">name</span><span class="op" id="5192566">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192572">if</span>&nbsp;<span class="ident" id="5192575">t</span><span class="op" id="5192576">.</span><span class="ident" id="5192577">text</span><span class="op" id="5192581">.</span><span class="ident" id="5192582">Lookup</span><span class="op" id="5192588">(</span><span class="ident" id="5192589">name</span><span class="op" id="5192593">)</span>&nbsp;<span class="op" id="5192595">==</span>&nbsp;<span class="builtintype" id="5192598">nil</span>&nbsp;<span class="op" id="5192602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5192606">panic</span><span class="op" id="5192611">(</span><span class="string" id="5192612">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5192673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192679">if</span>&nbsp;<span class="ident" id="5192682">tmpl</span><span class="op" id="5192686">.</span><span class="ident" id="5192687">escapeErr</span>&nbsp;<span class="op" id="5192697">==</span>&nbsp;<span class="builtintype" id="5192700">nil</span>&nbsp;<span class="op" id="5192704">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192708">err</span>&nbsp;<span class="op" id="5192712">=</span>&nbsp;<span class="ident" id="5192714">escapeTemplate</span><span class="op" id="5192728">(</span><span class="ident" id="5192729">tmpl</span><span class="op" id="5192733">,</span>&nbsp;<span class="ident" id="5192735">tmpl</span><span class="op" id="5192739">.</span><span class="ident" id="5192740">text</span><span class="op" id="5192744">.</span><span class="ident" id="5192745">Root</span><span class="op" id="5192749">,</span>&nbsp;<span class="ident" id="5192751">name</span><span class="op" id="5192755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192761">return</span>&nbsp;<span class="ident" id="5192768">tmpl</span><span class="op" id="5192772">,</span>&nbsp;<span class="ident" id="5192774">err</span><br>
<span class="lineno"></span><span class="op" id="5192778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5192781">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5192851">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5192917">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5192989">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5193062">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5193126">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5193197">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5193264">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5193322">func</span>&nbsp;<span class="op" id="5193327">(</span><span class="ident" id="5193328">t</span>&nbsp;<span class="op" id="5193330">*</span><span class="ident" id="5193331">Template</span><span class="op" id="5193339">)</span>&nbsp;<span class="ident" id="5193341">Parse</span><span class="op" id="5193346">(</span><span class="ident" id="5193347">src</span>&nbsp;<span class="builtintype" id="5193351">string</span><span class="op" id="5193357">)</span>&nbsp;<span class="op" id="5193359">(</span><span class="op" id="5193360">*</span><span class="ident" id="5193361">Template</span><span class="op" id="5193369">,</span>&nbsp;<span class="builtintype" id="5193371">error</span><span class="op" id="5193376">)</span>&nbsp;<span class="op" id="5193378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193381">t</span><span class="op" id="5193382">.</span><span class="ident" id="5193383">nameSpace</span><span class="op" id="5193392">.</span><span class="ident" id="5193393">mu</span><span class="op" id="5193395">.</span><span class="ident" id="5193396">Lock</span><span class="op" id="5193400">(</span><span class="op" id="5193401">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193404">t</span><span class="op" id="5193405">.</span><span class="ident" id="5193406">escapeErr</span>&nbsp;<span class="op" id="5193416">=</span>&nbsp;<span class="builtintype" id="5193418">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193423">t</span><span class="op" id="5193424">.</span><span class="ident" id="5193425">nameSpace</span><span class="op" id="5193434">.</span><span class="ident" id="5193435">mu</span><span class="op" id="5193437">.</span><span class="ident" id="5193438">Unlock</span><span class="op" id="5193444">(</span><span class="op" id="5193445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193448">ret</span><span class="op" id="5193451">,</span>&nbsp;<span class="ident" id="5193453">err</span>&nbsp;<span class="op" id="5193457">:=</span>&nbsp;<span class="ident" id="5193460">t</span><span class="op" id="5193461">.</span><span class="ident" id="5193462">text</span><span class="op" id="5193466">.</span><span class="ident" id="5193467">Parse</span><span class="op" id="5193472">(</span><span class="ident" id="5193473">src</span><span class="op" id="5193476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193479">if</span>&nbsp;<span class="ident" id="5193482">err</span>&nbsp;<span class="op" id="5193486">!=</span>&nbsp;<span class="builtintype" id="5193489">nil</span>&nbsp;<span class="op" id="5193493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193497">return</span>&nbsp;<span class="builtintype" id="5193504">nil</span><span class="op" id="5193507">,</span>&nbsp;<span class="ident" id="5193509">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5193517">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5193587">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5193640">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193701">t</span><span class="op" id="5193702">.</span><span class="ident" id="5193703">nameSpace</span><span class="op" id="5193712">.</span><span class="ident" id="5193713">mu</span><span class="op" id="5193715">.</span><span class="ident" id="5193716">Lock</span><span class="op" id="5193720">(</span><span class="op" id="5193721">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193724">defer</span>&nbsp;<span class="ident" id="5193730">t</span><span class="op" id="5193731">.</span><span class="ident" id="5193732">nameSpace</span><span class="op" id="5193741">.</span><span class="ident" id="5193742">mu</span><span class="op" id="5193744">.</span><span class="ident" id="5193745">Unlock</span><span class="op" id="5193751">(</span><span class="op" id="5193752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193755">for</span>&nbsp;<span class="ident" id="5193759">_</span><span class="op" id="5193760">,</span>&nbsp;<span class="ident" id="5193762">v</span>&nbsp;<span class="op" id="5193764">:=</span>&nbsp;<span class="keyword" id="5193767">range</span>&nbsp;<span class="ident" id="5193773">ret</span><span class="op" id="5193776">.</span><span class="ident" id="5193777">Templates</span><span class="op" id="5193786">(</span><span class="op" id="5193787">)</span>&nbsp;<span class="op" id="5193789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193793">name</span>&nbsp;<span class="op" id="5193798">:=</span>&nbsp;<span class="ident" id="5193801">v</span><span class="op" id="5193802">.</span><span class="ident" id="5193803">Name</span><span class="op" id="5193807">(</span><span class="op" id="5193808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193812">tmpl</span>&nbsp;<span class="op" id="5193817">:=</span>&nbsp;<span class="ident" id="5193820">t</span><span class="op" id="5193821">.</span><span class="ident" id="5193822">set</span><span class="op" id="5193825">[</span><span class="ident" id="5193826">name</span><span class="op" id="5193830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193834">if</span>&nbsp;<span class="ident" id="5193837">tmpl</span>&nbsp;<span class="op" id="5193842">==</span>&nbsp;<span class="builtintype" id="5193845">nil</span>&nbsp;<span class="op" id="5193849">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193854">tmpl</span>&nbsp;<span class="op" id="5193859">=</span>&nbsp;<span class="ident" id="5193861">t</span><span class="op" id="5193862">.</span><span class="builtinfunc" id="5193863">new</span><span class="op" id="5193866">(</span><span class="ident" id="5193867">name</span><span class="op" id="5193871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5193879">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193958">tmpl</span><span class="op" id="5193962">.</span><span class="ident" id="5193963">escapeErr</span>&nbsp;<span class="op" id="5193973">=</span>&nbsp;<span class="builtintype" id="5193975">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193981">tmpl</span><span class="op" id="5193985">.</span><span class="ident" id="5193986">text</span>&nbsp;<span class="op" id="5193991">=</span>&nbsp;<span class="ident" id="5193993">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193997">tmpl</span><span class="op" id="5194001">.</span><span class="ident" id="5194002">Tree</span>&nbsp;<span class="op" id="5194007">=</span>&nbsp;<span class="ident" id="5194009">v</span><span class="op" id="5194010">.</span><span class="ident" id="5194011">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194020">return</span>&nbsp;<span class="ident" id="5194027">t</span><span class="op" id="5194028">,</span>&nbsp;<span class="builtintype" id="5194030">nil</span><br>
<span class="lineno"></span><span class="op" id="5194034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5194037">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5194105">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5194134">//</span><br>
<span class="lineno"></span><span class="comment" id="5194137">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5194192">func</span>&nbsp;<span class="op" id="5194197">(</span><span class="ident" id="5194198">t</span>&nbsp;<span class="op" id="5194200">*</span><span class="ident" id="5194201">Template</span><span class="op" id="5194209">)</span>&nbsp;<span class="ident" id="5194211">AddParseTree</span><span class="op" id="5194223">(</span><span class="ident" id="5194224">name</span>&nbsp;<span class="builtintype" id="5194229">string</span><span class="op" id="5194235">,</span>&nbsp;<span class="ident" id="5194237">tree</span>&nbsp;<span class="op" id="5194242">*</span><span class="ident" id="5194243">parse</span><span class="op" id="5194248">.</span><span class="ident" id="5194249">Tree</span><span class="op" id="5194253">)</span>&nbsp;<span class="op" id="5194255">(</span><span class="op" id="5194256">*</span><span class="ident" id="5194257">Template</span><span class="op" id="5194265">,</span>&nbsp;<span class="builtintype" id="5194267">error</span><span class="op" id="5194272">)</span>&nbsp;<span class="op" id="5194274">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194277">t</span><span class="op" id="5194278">.</span><span class="ident" id="5194279">nameSpace</span><span class="op" id="5194288">.</span><span class="ident" id="5194289">mu</span><span class="op" id="5194291">.</span><span class="ident" id="5194292">Lock</span><span class="op" id="5194296">(</span><span class="op" id="5194297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194300">defer</span>&nbsp;<span class="ident" id="5194306">t</span><span class="op" id="5194307">.</span><span class="ident" id="5194308">nameSpace</span><span class="op" id="5194317">.</span><span class="ident" id="5194318">mu</span><span class="op" id="5194320">.</span><span class="ident" id="5194321">Unlock</span><span class="op" id="5194327">(</span><span class="op" id="5194328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194331">if</span>&nbsp;<span class="ident" id="5194334">t</span><span class="op" id="5194335">.</span><span class="ident" id="5194336">escapeErr</span>&nbsp;<span class="op" id="5194346">!=</span>&nbsp;<span class="builtintype" id="5194349">nil</span>&nbsp;<span class="op" id="5194353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194357">return</span>&nbsp;<span class="builtintype" id="5194364">nil</span><span class="op" id="5194367">,</span>&nbsp;<span class="ident" id="5194369">fmt</span><span class="op" id="5194372">.</span><span class="ident" id="5194373">Errorf</span><span class="op" id="5194379">(</span><span class="string" id="5194380">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5194444">,</span>&nbsp;<span class="ident" id="5194446">t</span><span class="op" id="5194447">.</span><span class="ident" id="5194448">Name</span><span class="op" id="5194452">(</span><span class="op" id="5194453">)</span><span class="op" id="5194454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194457">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194460">text</span><span class="op" id="5194464">,</span>&nbsp;<span class="ident" id="5194466">err</span>&nbsp;<span class="op" id="5194470">:=</span>&nbsp;<span class="ident" id="5194473">t</span><span class="op" id="5194474">.</span><span class="ident" id="5194475">text</span><span class="op" id="5194479">.</span><span class="ident" id="5194480">AddParseTree</span><span class="op" id="5194492">(</span><span class="ident" id="5194493">name</span><span class="op" id="5194497">,</span>&nbsp;<span class="ident" id="5194499">tree</span><span class="op" id="5194503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194506">if</span>&nbsp;<span class="ident" id="5194509">err</span>&nbsp;<span class="op" id="5194513">!=</span>&nbsp;<span class="builtintype" id="5194516">nil</span>&nbsp;<span class="op" id="5194520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194524">return</span>&nbsp;<span class="builtintype" id="5194531">nil</span><span class="op" id="5194534">,</span>&nbsp;<span class="ident" id="5194536">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194544">ret</span>&nbsp;<span class="op" id="5194548">:=</span>&nbsp;<span class="op" id="5194551">&amp;</span><span class="ident" id="5194552">Template</span><span class="op" id="5194560">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194564">nil</span><span class="op" id="5194567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194571">text</span><span class="op" id="5194575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194579">text</span><span class="op" id="5194583">.</span><span class="ident" id="5194584">Tree</span><span class="op" id="5194588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194592">t</span><span class="op" id="5194593">.</span><span class="ident" id="5194594">nameSpace</span><span class="op" id="5194603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194606">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194609">t</span><span class="op" id="5194610">.</span><span class="ident" id="5194611">set</span><span class="op" id="5194614">[</span><span class="ident" id="5194615">name</span><span class="op" id="5194619">]</span>&nbsp;<span class="op" id="5194621">=</span>&nbsp;<span class="ident" id="5194623">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194628">return</span>&nbsp;<span class="ident" id="5194635">ret</span><span class="op" id="5194638">,</span>&nbsp;<span class="builtintype" id="5194640">nil</span><br>
<span class="lineno"></span><span class="op" id="5194644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5194647">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5194718">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5194795">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5194870">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5194949">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5195027">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5195078">//</span><br>
<span class="lineno"></span><span class="comment" id="5195081">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5195136">func</span>&nbsp;<span class="op" id="5195141">(</span><span class="ident" id="5195142">t</span>&nbsp;<span class="op" id="5195144">*</span><span class="ident" id="5195145">Template</span><span class="op" id="5195153">)</span>&nbsp;<span class="ident" id="5195155">Clone</span><span class="op" id="5195160">(</span><span class="op" id="5195161">)</span>&nbsp;<span class="op" id="5195163">(</span><span class="op" id="5195164">*</span><span class="ident" id="5195165">Template</span><span class="op" id="5195173">,</span>&nbsp;<span class="builtintype" id="5195175">error</span><span class="op" id="5195180">)</span>&nbsp;<span class="op" id="5195182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195185">t</span><span class="op" id="5195186">.</span><span class="ident" id="5195187">nameSpace</span><span class="op" id="5195196">.</span><span class="ident" id="5195197">mu</span><span class="op" id="5195199">.</span><span class="ident" id="5195200">Lock</span><span class="op" id="5195204">(</span><span class="op" id="5195205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195208">defer</span>&nbsp;<span class="ident" id="5195214">t</span><span class="op" id="5195215">.</span><span class="ident" id="5195216">nameSpace</span><span class="op" id="5195225">.</span><span class="ident" id="5195226">mu</span><span class="op" id="5195228">.</span><span class="ident" id="5195229">Unlock</span><span class="op" id="5195235">(</span><span class="op" id="5195236">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195239">if</span>&nbsp;<span class="ident" id="5195242">t</span><span class="op" id="5195243">.</span><span class="ident" id="5195244">escapeErr</span>&nbsp;<span class="op" id="5195254">!=</span>&nbsp;<span class="builtintype" id="5195257">nil</span>&nbsp;<span class="op" id="5195261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195265">return</span>&nbsp;<span class="builtintype" id="5195272">nil</span><span class="op" id="5195275">,</span>&nbsp;<span class="ident" id="5195277">fmt</span><span class="op" id="5195280">.</span><span class="ident" id="5195281">Errorf</span><span class="op" id="5195287">(</span><span class="string" id="5195288">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5195342">,</span>&nbsp;<span class="ident" id="5195344">t</span><span class="op" id="5195345">.</span><span class="ident" id="5195346">Name</span><span class="op" id="5195350">(</span><span class="op" id="5195351">)</span><span class="op" id="5195352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195358">textClone</span><span class="op" id="5195367">,</span>&nbsp;<span class="ident" id="5195369">err</span>&nbsp;<span class="op" id="5195373">:=</span>&nbsp;<span class="ident" id="5195376">t</span><span class="op" id="5195377">.</span><span class="ident" id="5195378">text</span><span class="op" id="5195382">.</span><span class="ident" id="5195383">Clone</span><span class="op" id="5195388">(</span><span class="op" id="5195389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195392">if</span>&nbsp;<span class="ident" id="5195395">err</span>&nbsp;<span class="op" id="5195399">!=</span>&nbsp;<span class="builtintype" id="5195402">nil</span>&nbsp;<span class="op" id="5195406">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195410">return</span>&nbsp;<span class="builtintype" id="5195417">nil</span><span class="op" id="5195420">,</span>&nbsp;<span class="ident" id="5195422">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195430">ret</span>&nbsp;<span class="op" id="5195434">:=</span>&nbsp;<span class="op" id="5195437">&amp;</span><span class="ident" id="5195438">Template</span><span class="op" id="5195446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5195450">nil</span><span class="op" id="5195453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195457">textClone</span><span class="op" id="5195466">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195470">textClone</span><span class="op" id="5195479">.</span><span class="ident" id="5195480">Tree</span><span class="op" id="5195484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195488">&amp;</span><span class="ident" id="5195489">nameSpace</span><span class="op" id="5195498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195503">set</span><span class="op" id="5195506">:</span>&nbsp;<span class="builtinfunc" id="5195508">make</span><span class="op" id="5195512">(</span><span class="keyword" id="5195513">map</span><span class="op" id="5195516">[</span><span class="builtintype" id="5195517">string</span><span class="op" id="5195523">]</span><span class="op" id="5195524">*</span><span class="ident" id="5195525">Template</span><span class="op" id="5195533">)</span><span class="op" id="5195534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195538">}</span><span class="op" id="5195539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195542">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195545">for</span>&nbsp;<span class="ident" id="5195549">_</span><span class="op" id="5195550">,</span>&nbsp;<span class="ident" id="5195552">x</span>&nbsp;<span class="op" id="5195554">:=</span>&nbsp;<span class="keyword" id="5195557">range</span>&nbsp;<span class="ident" id="5195563">textClone</span><span class="op" id="5195572">.</span><span class="ident" id="5195573">Templates</span><span class="op" id="5195582">(</span><span class="op" id="5195583">)</span>&nbsp;<span class="op" id="5195585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195589">name</span>&nbsp;<span class="op" id="5195594">:=</span>&nbsp;<span class="ident" id="5195597">x</span><span class="op" id="5195598">.</span><span class="ident" id="5195599">Name</span><span class="op" id="5195603">(</span><span class="op" id="5195604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195608">src</span>&nbsp;<span class="op" id="5195612">:=</span>&nbsp;<span class="ident" id="5195615">t</span><span class="op" id="5195616">.</span><span class="ident" id="5195617">set</span><span class="op" id="5195620">[</span><span class="ident" id="5195621">name</span><span class="op" id="5195625">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195629">if</span>&nbsp;<span class="ident" id="5195632">src</span>&nbsp;<span class="op" id="5195636">==</span>&nbsp;<span class="builtintype" id="5195639">nil</span>&nbsp;<span class="op" id="5195643">||</span>&nbsp;<span class="ident" id="5195646">src</span><span class="op" id="5195649">.</span><span class="ident" id="5195650">escapeErr</span>&nbsp;<span class="op" id="5195660">!=</span>&nbsp;<span class="builtintype" id="5195663">nil</span>&nbsp;<span class="op" id="5195667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195672">return</span>&nbsp;<span class="builtintype" id="5195679">nil</span><span class="op" id="5195682">,</span>&nbsp;<span class="ident" id="5195684">fmt</span><span class="op" id="5195687">.</span><span class="ident" id="5195688">Errorf</span><span class="op" id="5195694">(</span><span class="string" id="5195695">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5195749">,</span>&nbsp;<span class="ident" id="5195751">t</span><span class="op" id="5195752">.</span><span class="ident" id="5195753">Name</span><span class="op" id="5195757">(</span><span class="op" id="5195758">)</span><span class="op" id="5195759">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195767">x</span><span class="op" id="5195768">.</span><span class="ident" id="5195769">Tree</span>&nbsp;<span class="op" id="5195774">=</span>&nbsp;<span class="ident" id="5195776">x</span><span class="op" id="5195777">.</span><span class="ident" id="5195778">Tree</span><span class="op" id="5195782">.</span><span class="ident" id="5195783">Copy</span><span class="op" id="5195787">(</span><span class="op" id="5195788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195792">ret</span><span class="op" id="5195795">.</span><span class="ident" id="5195796">set</span><span class="op" id="5195799">[</span><span class="ident" id="5195800">name</span><span class="op" id="5195804">]</span>&nbsp;<span class="op" id="5195806">=</span>&nbsp;<span class="op" id="5195808">&amp;</span><span class="ident" id="5195809">Template</span><span class="op" id="5195817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5195822">nil</span><span class="op" id="5195825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195830">x</span><span class="op" id="5195831">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195836">x</span><span class="op" id="5195837">.</span><span class="ident" id="5195838">Tree</span><span class="op" id="5195842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195847">ret</span><span class="op" id="5195850">.</span><span class="ident" id="5195851">nameSpace</span><span class="op" id="5195860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195870">return</span>&nbsp;<span class="ident" id="5195877">ret</span><span class="op" id="5195880">,</span>&nbsp;<span class="builtintype" id="5195882">nil</span><br>
<span class="lineno">220</span><span class="op" id="5195886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195889">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5195947">func</span>&nbsp;<span class="ident" id="5195952">New</span><span class="op" id="5195955">(</span><span class="ident" id="5195956">name</span>&nbsp;<span class="builtintype" id="5195961">string</span><span class="op" id="5195967">)</span>&nbsp;<span class="op" id="5195969">*</span><span class="ident" id="5195970">Template</span>&nbsp;<span class="op" id="5195979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195982">tmpl</span>&nbsp;<span class="op" id="5195987">:=</span>&nbsp;<span class="op" id="5195990">&amp;</span><span class="ident" id="5195991">Template</span><span class="op" id="5195999">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5196003">nil</span><span class="op" id="5196006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196010">template</span><span class="op" id="5196018">.</span><span class="ident" id="5196019">New</span><span class="op" id="5196022">(</span><span class="ident" id="5196023">name</span><span class="op" id="5196027">)</span><span class="op" id="5196028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5196032">nil</span><span class="op" id="5196035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5196039">&amp;</span><span class="ident" id="5196040">nameSpace</span><span class="op" id="5196049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196054">set</span><span class="op" id="5196057">:</span>&nbsp;<span class="builtinfunc" id="5196059">make</span><span class="op" id="5196063">(</span><span class="keyword" id="5196064">map</span><span class="op" id="5196067">[</span><span class="builtintype" id="5196068">string</span><span class="op" id="5196074">]</span><span class="op" id="5196075">*</span><span class="ident" id="5196076">Template</span><span class="op" id="5196084">)</span><span class="op" id="5196085">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5196089">}</span><span class="op" id="5196090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5196093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196096">tmpl</span><span class="op" id="5196100">.</span><span class="ident" id="5196101">set</span><span class="op" id="5196104">[</span><span class="ident" id="5196105">name</span><span class="op" id="5196109">]</span>&nbsp;<span class="op" id="5196111">=</span>&nbsp;<span class="ident" id="5196113">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196119">return</span>&nbsp;<span class="ident" id="5196126">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5196131">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5196134">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5196201">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5196272">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5196341">func</span>&nbsp;<span class="op" id="5196346">(</span><span class="ident" id="5196347">t</span>&nbsp;<span class="op" id="5196349">*</span><span class="ident" id="5196350">Template</span><span class="op" id="5196358">)</span>&nbsp;<span class="ident" id="5196360">New</span><span class="op" id="5196363">(</span><span class="ident" id="5196364">name</span>&nbsp;<span class="builtintype" id="5196369">string</span><span class="op" id="5196375">)</span>&nbsp;<span class="op" id="5196377">*</span><span class="ident" id="5196378">Template</span>&nbsp;<span class="op" id="5196387">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196390">t</span><span class="op" id="5196391">.</span><span class="ident" id="5196392">nameSpace</span><span class="op" id="5196401">.</span><span class="ident" id="5196402">mu</span><span class="op" id="5196404">.</span><span class="ident" id="5196405">Lock</span><span class="op" id="5196409">(</span><span class="op" id="5196410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196413">defer</span>&nbsp;<span class="ident" id="5196419">t</span><span class="op" id="5196420">.</span><span class="ident" id="5196421">nameSpace</span><span class="op" id="5196430">.</span><span class="ident" id="5196431">mu</span><span class="op" id="5196433">.</span><span class="ident" id="5196434">Unlock</span><span class="op" id="5196440">(</span><span class="op" id="5196441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196444">return</span>&nbsp;<span class="ident" id="5196451">t</span><span class="op" id="5196452">.</span><span class="builtinfunc" id="5196453">new</span><span class="op" id="5196456">(</span><span class="ident" id="5196457">name</span><span class="op" id="5196461">)</span><br>
<span class="lineno"></span><span class="op" id="5196463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5196466">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5196521">func</span>&nbsp;<span class="op" id="5196526">(</span><span class="ident" id="5196527">t</span>&nbsp;<span class="op" id="5196529">*</span><span class="ident" id="5196530">Template</span><span class="op" id="5196538">)</span>&nbsp;<span class="builtinfunc" id="5196540">new</span><span class="op" id="5196543">(</span><span class="ident" id="5196544">name</span>&nbsp;<span class="builtintype" id="5196549">string</span><span class="op" id="5196555">)</span>&nbsp;<span class="op" id="5196557">*</span><span class="ident" id="5196558">Template</span>&nbsp;<span class="op" id="5196567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196570">tmpl</span>&nbsp;<span class="op" id="5196575">:=</span>&nbsp;<span class="op" id="5196578">&amp;</span><span class="ident" id="5196579">Template</span><span class="op" id="5196587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5196591">nil</span><span class="op" id="5196594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196598">t</span><span class="op" id="5196599">.</span><span class="ident" id="5196600">text</span><span class="op" id="5196604">.</span><span class="ident" id="5196605">New</span><span class="op" id="5196608">(</span><span class="ident" id="5196609">name</span><span class="op" id="5196613">)</span><span class="op" id="5196614">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5196618">nil</span><span class="op" id="5196621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196625">t</span><span class="op" id="5196626">.</span><span class="ident" id="5196627">nameSpace</span><span class="op" id="5196636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5196639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196642">tmpl</span><span class="op" id="5196646">.</span><span class="ident" id="5196647">set</span><span class="op" id="5196650">[</span><span class="ident" id="5196651">name</span><span class="op" id="5196655">]</span>&nbsp;<span class="op" id="5196657">=</span>&nbsp;<span class="ident" id="5196659">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196665">return</span>&nbsp;<span class="ident" id="5196672">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5196677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5196680">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5196722">func</span>&nbsp;<span class="op" id="5196727">(</span><span class="ident" id="5196728">t</span>&nbsp;<span class="op" id="5196730">*</span><span class="ident" id="5196731">Template</span><span class="op" id="5196739">)</span>&nbsp;<span class="ident" id="5196741">Name</span><span class="op" id="5196745">(</span><span class="op" id="5196746">)</span>&nbsp;<span class="builtintype" id="5196748">string</span>&nbsp;<span class="op" id="5196755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196758">return</span>&nbsp;<span class="ident" id="5196765">t</span><span class="op" id="5196766">.</span><span class="ident" id="5196767">text</span><span class="op" id="5196771">.</span><span class="ident" id="5196772">Name</span><span class="op" id="5196776">(</span><span class="op" id="5196777">)</span><br>
<span class="lineno">260</span><span class="op" id="5196779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5196782">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5196851">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5196926">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5197000">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5197076">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5197153">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5197226">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5197246">type</span>&nbsp;<span class="ident" id="5197251">FuncMap</span>&nbsp;<span class="keyword" id="5197259">map</span><span class="op" id="5197262">[</span><span class="builtintype" id="5197263">string</span><span class="op" id="5197269">]</span><span class="keyword" id="5197270">interface</span><span class="op" id="5197279">{</span><span class="op" id="5197280">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5197283">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5197362">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5197439">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5197514">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5197565">func</span>&nbsp;<span class="op" id="5197570">(</span><span class="ident" id="5197571">t</span>&nbsp;<span class="op" id="5197573">*</span><span class="ident" id="5197574">Template</span><span class="op" id="5197582">)</span>&nbsp;<span class="ident" id="5197584">Funcs</span><span class="op" id="5197589">(</span><span class="ident" id="5197590">funcMap</span>&nbsp;<span class="ident" id="5197598">FuncMap</span><span class="op" id="5197605">)</span>&nbsp;<span class="op" id="5197607">*</span><span class="ident" id="5197608">Template</span>&nbsp;<span class="op" id="5197617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197620">t</span><span class="op" id="5197621">.</span><span class="ident" id="5197622">text</span><span class="op" id="5197626">.</span><span class="ident" id="5197627">Funcs</span><span class="op" id="5197632">(</span><span class="ident" id="5197633">template</span><span class="op" id="5197641">.</span><span class="ident" id="5197642">FuncMap</span><span class="op" id="5197649">(</span><span class="ident" id="5197650">funcMap</span><span class="op" id="5197657">)</span><span class="op" id="5197658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197661">return</span>&nbsp;<span class="ident" id="5197668">t</span><br>
<span class="lineno"></span><span class="op" id="5197670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5197673">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5197750">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5197822">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5197898">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5197934">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5197996">func</span>&nbsp;<span class="op" id="5198001">(</span><span class="ident" id="5198002">t</span>&nbsp;<span class="op" id="5198004">*</span><span class="ident" id="5198005">Template</span><span class="op" id="5198013">)</span>&nbsp;<span class="ident" id="5198015">Delims</span><span class="op" id="5198021">(</span><span class="ident" id="5198022">left</span><span class="op" id="5198026">,</span>&nbsp;<span class="ident" id="5198028">right</span>&nbsp;<span class="builtintype" id="5198034">string</span><span class="op" id="5198040">)</span>&nbsp;<span class="op" id="5198042">*</span><span class="ident" id="5198043">Template</span>&nbsp;<span class="op" id="5198052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198055">t</span><span class="op" id="5198056">.</span><span class="ident" id="5198057">text</span><span class="op" id="5198061">.</span><span class="ident" id="5198062">Delims</span><span class="op" id="5198068">(</span><span class="ident" id="5198069">left</span><span class="op" id="5198073">,</span>&nbsp;<span class="ident" id="5198075">right</span><span class="op" id="5198080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198083">return</span>&nbsp;<span class="ident" id="5198090">t</span><br>
<span class="lineno"></span><span class="op" id="5198092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5198095">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5198173">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5198213">func</span>&nbsp;<span class="op" id="5198218">(</span><span class="ident" id="5198219">t</span>&nbsp;<span class="op" id="5198221">*</span><span class="ident" id="5198222">Template</span><span class="op" id="5198230">)</span>&nbsp;<span class="ident" id="5198232">Lookup</span><span class="op" id="5198238">(</span><span class="ident" id="5198239">name</span>&nbsp;<span class="builtintype" id="5198244">string</span><span class="op" id="5198250">)</span>&nbsp;<span class="op" id="5198252">*</span><span class="ident" id="5198253">Template</span>&nbsp;<span class="op" id="5198262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198265">t</span><span class="op" id="5198266">.</span><span class="ident" id="5198267">nameSpace</span><span class="op" id="5198276">.</span><span class="ident" id="5198277">mu</span><span class="op" id="5198279">.</span><span class="ident" id="5198280">Lock</span><span class="op" id="5198284">(</span><span class="op" id="5198285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198288">defer</span>&nbsp;<span class="ident" id="5198294">t</span><span class="op" id="5198295">.</span><span class="ident" id="5198296">nameSpace</span><span class="op" id="5198305">.</span><span class="ident" id="5198306">mu</span><span class="op" id="5198308">.</span><span class="ident" id="5198309">Unlock</span><span class="op" id="5198315">(</span><span class="op" id="5198316">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198319">return</span>&nbsp;<span class="ident" id="5198326">t</span><span class="op" id="5198327">.</span><span class="ident" id="5198328">set</span><span class="op" id="5198331">[</span><span class="ident" id="5198332">name</span><span class="op" id="5198336">]</span><br>
<span class="lineno"></span><span class="op" id="5198338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198341">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5198422">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5198512">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5198523">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5198584">func</span>&nbsp;<span class="ident" id="5198589">Must</span><span class="op" id="5198593">(</span><span class="ident" id="5198594">t</span>&nbsp;<span class="op" id="5198596">*</span><span class="ident" id="5198597">Template</span><span class="op" id="5198605">,</span>&nbsp;<span class="ident" id="5198607">err</span>&nbsp;<span class="builtintype" id="5198611">error</span><span class="op" id="5198616">)</span>&nbsp;<span class="op" id="5198618">*</span><span class="ident" id="5198619">Template</span>&nbsp;<span class="op" id="5198628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198631">if</span>&nbsp;<span class="ident" id="5198634">err</span>&nbsp;<span class="op" id="5198638">!=</span>&nbsp;<span class="builtintype" id="5198641">nil</span>&nbsp;<span class="op" id="5198645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5198649">panic</span><span class="op" id="5198654">(</span><span class="ident" id="5198655">err</span><span class="op" id="5198658">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198664">return</span>&nbsp;<span class="ident" id="5198671">t</span><br>
<span class="lineno"></span><span class="op" id="5198673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198676">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5198754">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5198833">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5198906">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5198978">func</span>&nbsp;<span class="ident" id="5198983">ParseFiles</span><span class="op" id="5198993">(</span><span class="ident" id="5198994">filenames</span>&nbsp;<span class="op" id="5199004">...</span><span class="builtintype" id="5199007">string</span><span class="op" id="5199013">)</span>&nbsp;<span class="op" id="5199015">(</span><span class="op" id="5199016">*</span><span class="ident" id="5199017">Template</span><span class="op" id="5199025">,</span>&nbsp;<span class="builtintype" id="5199027">error</span><span class="op" id="5199032">)</span>&nbsp;<span class="op" id="5199034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199037">return</span>&nbsp;<span class="ident" id="5199044">parseFiles</span><span class="op" id="5199054">(</span><span class="builtintype" id="5199055">nil</span><span class="op" id="5199058">,</span>&nbsp;<span class="ident" id="5199060">filenames</span><span class="op" id="5199069">...</span><span class="op" id="5199072">)</span><br>
<span class="lineno">315</span><span class="op" id="5199074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5199077">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5199158">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5199232">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5199287">func</span>&nbsp;<span class="op" id="5199292">(</span><span class="ident" id="5199293">t</span>&nbsp;<span class="op" id="5199295">*</span><span class="ident" id="5199296">Template</span><span class="op" id="5199304">)</span>&nbsp;<span class="ident" id="5199306">ParseFiles</span><span class="op" id="5199316">(</span><span class="ident" id="5199317">filenames</span>&nbsp;<span class="op" id="5199327">...</span><span class="builtintype" id="5199330">string</span><span class="op" id="5199336">)</span>&nbsp;<span class="op" id="5199338">(</span><span class="op" id="5199339">*</span><span class="ident" id="5199340">Template</span><span class="op" id="5199348">,</span>&nbsp;<span class="builtintype" id="5199350">error</span><span class="op" id="5199355">)</span>&nbsp;<span class="op" id="5199357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199360">return</span>&nbsp;<span class="ident" id="5199367">parseFiles</span><span class="op" id="5199377">(</span><span class="ident" id="5199378">t</span><span class="op" id="5199379">,</span>&nbsp;<span class="ident" id="5199381">filenames</span><span class="op" id="5199390">...</span><span class="op" id="5199393">)</span><br>
<span class="lineno"></span><span class="op" id="5199395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5199398">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5199471">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5199526">func</span>&nbsp;<span class="ident" id="5199531">parseFiles</span><span class="op" id="5199541">(</span><span class="ident" id="5199542">t</span>&nbsp;<span class="op" id="5199544">*</span><span class="ident" id="5199545">Template</span><span class="op" id="5199553">,</span>&nbsp;<span class="ident" id="5199555">filenames</span>&nbsp;<span class="op" id="5199565">...</span><span class="builtintype" id="5199568">string</span><span class="op" id="5199574">)</span>&nbsp;<span class="op" id="5199576">(</span><span class="op" id="5199577">*</span><span class="ident" id="5199578">Template</span><span class="op" id="5199586">,</span>&nbsp;<span class="builtintype" id="5199588">error</span><span class="op" id="5199593">)</span>&nbsp;<span class="op" id="5199595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199598">if</span>&nbsp;<span class="builtinfunc" id="5199601">len</span><span class="op" id="5199604">(</span><span class="ident" id="5199605">filenames</span><span class="op" id="5199614">)</span>&nbsp;<span class="op" id="5199616">==</span>&nbsp;<span class="num" id="5199619">0</span>&nbsp;<span class="op" id="5199621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5199625">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199671">return</span>&nbsp;<span class="builtintype" id="5199678">nil</span><span class="op" id="5199681">,</span>&nbsp;<span class="ident" id="5199683">fmt</span><span class="op" id="5199686">.</span><span class="ident" id="5199687">Errorf</span><span class="op" id="5199693">(</span><span class="string" id="5199694">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5199747">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199753">for</span>&nbsp;<span class="ident" id="5199757">_</span><span class="op" id="5199758">,</span>&nbsp;<span class="ident" id="5199760">filename</span>&nbsp;<span class="op" id="5199769">:=</span>&nbsp;<span class="keyword" id="5199772">range</span>&nbsp;<span class="ident" id="5199778">filenames</span>&nbsp;<span class="op" id="5199788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199792">b</span><span class="op" id="5199793">,</span>&nbsp;<span class="ident" id="5199795">err</span>&nbsp;<span class="op" id="5199799">:=</span>&nbsp;<span class="ident" id="5199802">ioutil</span><span class="op" id="5199808">.</span><span class="ident" id="5199809">ReadFile</span><span class="op" id="5199817">(</span><span class="ident" id="5199818">filename</span><span class="op" id="5199826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199830">if</span>&nbsp;<span class="ident" id="5199833">err</span>&nbsp;<span class="op" id="5199837">!=</span>&nbsp;<span class="builtintype" id="5199840">nil</span>&nbsp;<span class="op" id="5199844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199849">return</span>&nbsp;<span class="builtintype" id="5199856">nil</span><span class="op" id="5199859">,</span>&nbsp;<span class="ident" id="5199861">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199871">s</span>&nbsp;<span class="op" id="5199873">:=</span>&nbsp;<span class="builtintype" id="5199876">string</span><span class="op" id="5199882">(</span><span class="ident" id="5199883">b</span><span class="op" id="5199884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199888">name</span>&nbsp;<span class="op" id="5199893">:=</span>&nbsp;<span class="ident" id="5199896">filepath</span><span class="op" id="5199904">.</span><span class="ident" id="5199905">Base</span><span class="op" id="5199909">(</span><span class="ident" id="5199910">filename</span><span class="op" id="5199918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5199922">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5199987">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5200050">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5200120">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5200171">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5200225">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200291">var</span>&nbsp;<span class="ident" id="5200295">tmpl</span>&nbsp;<span class="op" id="5200300">*</span><span class="ident" id="5200301">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200312">if</span>&nbsp;<span class="ident" id="5200315">t</span>&nbsp;<span class="op" id="5200317">==</span>&nbsp;<span class="builtintype" id="5200320">nil</span>&nbsp;<span class="op" id="5200324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200329">t</span>&nbsp;<span class="op" id="5200331">=</span>&nbsp;<span class="ident" id="5200333">New</span><span class="op" id="5200336">(</span><span class="ident" id="5200337">name</span><span class="op" id="5200341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200349">if</span>&nbsp;<span class="ident" id="5200352">name</span>&nbsp;<span class="op" id="5200357">==</span>&nbsp;<span class="ident" id="5200360">t</span><span class="op" id="5200361">.</span><span class="ident" id="5200362">Name</span><span class="op" id="5200366">(</span><span class="op" id="5200367">)</span>&nbsp;<span class="op" id="5200369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200374">tmpl</span>&nbsp;<span class="op" id="5200379">=</span>&nbsp;<span class="ident" id="5200381">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200385">}</span>&nbsp;<span class="keyword" id="5200387">else</span>&nbsp;<span class="op" id="5200392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200397">tmpl</span>&nbsp;<span class="op" id="5200402">=</span>&nbsp;<span class="ident" id="5200404">t</span><span class="op" id="5200405">.</span><span class="ident" id="5200406">New</span><span class="op" id="5200409">(</span><span class="ident" id="5200410">name</span><span class="op" id="5200414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200422">_</span><span class="op" id="5200423">,</span>&nbsp;<span class="ident" id="5200425">err</span>&nbsp;<span class="op" id="5200429">=</span>&nbsp;<span class="ident" id="5200431">tmpl</span><span class="op" id="5200435">.</span><span class="ident" id="5200436">Parse</span><span class="op" id="5200441">(</span><span class="ident" id="5200442">s</span><span class="op" id="5200443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200447">if</span>&nbsp;<span class="ident" id="5200450">err</span>&nbsp;<span class="op" id="5200454">!=</span>&nbsp;<span class="builtintype" id="5200457">nil</span>&nbsp;<span class="op" id="5200461">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200466">return</span>&nbsp;<span class="builtintype" id="5200473">nil</span><span class="op" id="5200476">,</span>&nbsp;<span class="ident" id="5200478">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200490">return</span>&nbsp;<span class="ident" id="5200497">t</span><span class="op" id="5200498">,</span>&nbsp;<span class="builtintype" id="5200500">nil</span><br>
<span class="lineno"></span><span class="op" id="5200504">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5200507">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5200588">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5200664">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5200740">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5200813">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5200874">func</span>&nbsp;<span class="ident" id="5200879">ParseGlob</span><span class="op" id="5200888">(</span><span class="ident" id="5200889">pattern</span>&nbsp;<span class="builtintype" id="5200897">string</span><span class="op" id="5200903">)</span>&nbsp;<span class="op" id="5200905">(</span><span class="op" id="5200906">*</span><span class="ident" id="5200907">Template</span><span class="op" id="5200915">,</span>&nbsp;<span class="builtintype" id="5200917">error</span><span class="op" id="5200922">)</span>&nbsp;<span class="op" id="5200924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200927">return</span>&nbsp;<span class="ident" id="5200934">parseGlob</span><span class="op" id="5200943">(</span><span class="builtintype" id="5200944">nil</span><span class="op" id="5200947">,</span>&nbsp;<span class="ident" id="5200949">pattern</span><span class="op" id="5200956">)</span><br>
<span class="lineno"></span><span class="op" id="5200958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5200961">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5201037">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5201110">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5201187">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5201263">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5201275">func</span>&nbsp;<span class="op" id="5201280">(</span><span class="ident" id="5201281">t</span>&nbsp;<span class="op" id="5201283">*</span><span class="ident" id="5201284">Template</span><span class="op" id="5201292">)</span>&nbsp;<span class="ident" id="5201294">ParseGlob</span><span class="op" id="5201303">(</span><span class="ident" id="5201304">pattern</span>&nbsp;<span class="builtintype" id="5201312">string</span><span class="op" id="5201318">)</span>&nbsp;<span class="op" id="5201320">(</span><span class="op" id="5201321">*</span><span class="ident" id="5201322">Template</span><span class="op" id="5201330">,</span>&nbsp;<span class="builtintype" id="5201332">error</span><span class="op" id="5201337">)</span>&nbsp;<span class="op" id="5201339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201342">return</span>&nbsp;<span class="ident" id="5201349">parseGlob</span><span class="op" id="5201358">(</span><span class="ident" id="5201359">t</span><span class="op" id="5201360">,</span>&nbsp;<span class="ident" id="5201362">pattern</span><span class="op" id="5201369">)</span><br>
<span class="lineno"></span><span class="op" id="5201371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5201374">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5201447">func</span>&nbsp;<span class="ident" id="5201452">parseGlob</span><span class="op" id="5201461">(</span><span class="ident" id="5201462">t</span>&nbsp;<span class="op" id="5201464">*</span><span class="ident" id="5201465">Template</span><span class="op" id="5201473">,</span>&nbsp;<span class="ident" id="5201475">pattern</span>&nbsp;<span class="builtintype" id="5201483">string</span><span class="op" id="5201489">)</span>&nbsp;<span class="op" id="5201491">(</span><span class="op" id="5201492">*</span><span class="ident" id="5201493">Template</span><span class="op" id="5201501">,</span>&nbsp;<span class="builtintype" id="5201503">error</span><span class="op" id="5201508">)</span>&nbsp;<span class="op" id="5201510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5201513">filenames</span><span class="op" id="5201522">,</span>&nbsp;<span class="ident" id="5201524">err</span>&nbsp;<span class="op" id="5201528">:=</span>&nbsp;<span class="ident" id="5201531">filepath</span><span class="op" id="5201539">.</span><span class="ident" id="5201540">Glob</span><span class="op" id="5201544">(</span><span class="ident" id="5201545">pattern</span><span class="op" id="5201552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201555">if</span>&nbsp;<span class="ident" id="5201558">err</span>&nbsp;<span class="op" id="5201562">!=</span>&nbsp;<span class="builtintype" id="5201565">nil</span>&nbsp;<span class="op" id="5201569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201573">return</span>&nbsp;<span class="builtintype" id="5201580">nil</span><span class="op" id="5201583">,</span>&nbsp;<span class="ident" id="5201585">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201590">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201593">if</span>&nbsp;<span class="builtinfunc" id="5201596">len</span><span class="op" id="5201599">(</span><span class="ident" id="5201600">filenames</span><span class="op" id="5201609">)</span>&nbsp;<span class="op" id="5201611">==</span>&nbsp;<span class="num" id="5201614">0</span>&nbsp;<span class="op" id="5201616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201620">return</span>&nbsp;<span class="builtintype" id="5201627">nil</span><span class="op" id="5201630">,</span>&nbsp;<span class="ident" id="5201632">fmt</span><span class="op" id="5201635">.</span><span class="ident" id="5201636">Errorf</span><span class="op" id="5201642">(</span><span class="string" id="5201643">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5201689">,</span>&nbsp;<span class="ident" id="5201691">pattern</span><span class="op" id="5201698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201704">return</span>&nbsp;<span class="ident" id="5201711">parseFiles</span><span class="op" id="5201721">(</span><span class="ident" id="5201722">t</span><span class="op" id="5201723">,</span>&nbsp;<span class="ident" id="5201725">filenames</span><span class="op" id="5201734">...</span><span class="op" id="5201737">)</span><br>
<span class="lineno"></span><span class="op" id="5201739">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
