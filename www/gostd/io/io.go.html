<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html" class="current">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1365382">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1365437">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1365491">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1365542">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1365601">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1365676">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1365743">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1365810">//</span><br>
<span class="lineno">10</span><span class="comment" id="1365813">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1365889">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1365962">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1366010">package</span>&nbsp;<span class="ident" id="1366018">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1366022">import</span>&nbsp;<span class="op" id="1366029">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1366032">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1366041">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366044">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1366116">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1366159">var</span>&nbsp;<span class="ident" id="1366163">ErrShortWrite</span>&nbsp;<span class="op" id="1366177">=</span>&nbsp;<span class="ident" id="1366179">errors</span><span class="op" id="1366185">.</span><span class="ident" id="1366186">New</span><span class="op" id="1366189">(</span><span class="string" id="1366190">&#34;short&nbsp;write&#34;</span><span class="op" id="1366203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366206">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1366286">var</span>&nbsp;<span class="ident" id="1366290">ErrShortBuffer</span>&nbsp;<span class="op" id="1366305">=</span>&nbsp;<span class="ident" id="1366307">errors</span><span class="op" id="1366313">.</span><span class="ident" id="1366314">New</span><span class="op" id="1366317">(</span><span class="string" id="1366318">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1366332">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1366335">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1366405">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1366476">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1366539">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1366611">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1366634">var</span>&nbsp;<span class="ident" id="1366638">EOF</span>&nbsp;<span class="op" id="1366642">=</span>&nbsp;<span class="ident" id="1366644">errors</span><span class="op" id="1366650">.</span><span class="ident" id="1366651">New</span><span class="op" id="1366654">(</span><span class="string" id="1366655">&#34;EOF&#34;</span><span class="op" id="1366660">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366663">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1366721">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1366780">var</span>&nbsp;<span class="ident" id="1366784">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1366801">=</span>&nbsp;<span class="ident" id="1366803">errors</span><span class="op" id="1366809">.</span><span class="ident" id="1366810">New</span><span class="op" id="1366813">(</span><span class="string" id="1366814">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1366830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366833">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1366899">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1366962">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1367020">var</span>&nbsp;<span class="ident" id="1367024">ErrNoProgress</span>&nbsp;<span class="op" id="1367038">=</span>&nbsp;<span class="ident" id="1367040">errors</span><span class="op" id="1367046">.</span><span class="ident" id="1367047">New</span><span class="op" id="1367050">(</span><span class="string" id="1367051">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1367096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367099">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1367160">//</span><br>
<span class="lineno"></span><span class="comment" id="1367163">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1367236">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1367304">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1367381">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1367452">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1367510">//</span><br>
<span class="lineno">50</span><span class="comment" id="1367513">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1367577">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1367639">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1367708">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1367768">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1367831">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1367896">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1367961">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1367990">//</span><br>
<span class="lineno"></span><span class="comment" id="1367993">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1368058">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1368127">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1368188">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1368214">//</span><br>
<span class="lineno"></span><span class="comment" id="1368217">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1368277">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1368339">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1368404">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1368465">//</span><br>
<span class="lineno"></span><span class="comment" id="1368468">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1368506">type</span>&nbsp;<span class="ident" id="1368511">Reader</span>&nbsp;<span class="keyword" id="1368518">interface</span>&nbsp;<span class="op" id="1368528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1368531">Read</span><span class="op" id="1368535">(</span><span class="ident" id="1368536">p</span>&nbsp;<span class="op" id="1368538">[</span><span class="op" id="1368539">]</span><span class="builtintype" id="1368540">byte</span><span class="op" id="1368544">)</span>&nbsp;<span class="op" id="1368546">(</span><span class="ident" id="1368547">n</span>&nbsp;<span class="builtintype" id="1368549">int</span><span class="op" id="1368552">,</span>&nbsp;<span class="ident" id="1368554">err</span>&nbsp;<span class="builtintype" id="1368558">error</span><span class="op" id="1368563">)</span><br>
<span class="lineno"></span><span class="op" id="1368565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1368568">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1368630">//</span><br>
<span class="lineno"></span><span class="comment" id="1368633">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1368700">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1368768">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1368834">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1368897">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1368956">//</span><br>
<span class="lineno"></span><span class="comment" id="1368959">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1368997">type</span>&nbsp;<span class="ident" id="1369002">Writer</span>&nbsp;<span class="keyword" id="1369009">interface</span>&nbsp;<span class="op" id="1369019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369022">Write</span><span class="op" id="1369027">(</span><span class="ident" id="1369028">p</span>&nbsp;<span class="op" id="1369030">[</span><span class="op" id="1369031">]</span><span class="builtintype" id="1369032">byte</span><span class="op" id="1369036">)</span>&nbsp;<span class="op" id="1369038">(</span><span class="ident" id="1369039">n</span>&nbsp;<span class="builtintype" id="1369041">int</span><span class="op" id="1369044">,</span>&nbsp;<span class="ident" id="1369046">err</span>&nbsp;<span class="builtintype" id="1369050">error</span><span class="op" id="1369055">)</span><br>
<span class="lineno">85</span><span class="op" id="1369057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1369060">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1369122">//</span><br>
<span class="lineno"></span><span class="comment" id="1369125">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1369185">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1369246">type</span>&nbsp;<span class="ident" id="1369251">Closer</span>&nbsp;<span class="keyword" id="1369258">interface</span>&nbsp;<span class="op" id="1369268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369271">Close</span><span class="op" id="1369276">(</span><span class="op" id="1369277">)</span>&nbsp;<span class="builtintype" id="1369279">error</span><br>
<span class="lineno"></span><span class="op" id="1369285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1369288">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1369349">//</span><br>
<span class="lineno"></span><span class="comment" id="1369352">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1369414">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1369484">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1369549">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1369619">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1369627">//</span><br>
<span class="lineno"></span><span class="comment" id="1369630">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1369699">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1369768">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1369822">type</span>&nbsp;<span class="ident" id="1369827">Seeker</span>&nbsp;<span class="keyword" id="1369834">interface</span>&nbsp;<span class="op" id="1369844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369847">Seek</span><span class="op" id="1369851">(</span><span class="ident" id="1369852">offset</span>&nbsp;<span class="ident" id="1369859">int64</span><span class="op" id="1369864">,</span>&nbsp;<span class="ident" id="1369866">whence</span>&nbsp;<span class="builtintype" id="1369873">int</span><span class="op" id="1369876">)</span>&nbsp;<span class="op" id="1369878">(</span><span class="ident" id="1369879">int64</span><span class="op" id="1369884">,</span>&nbsp;<span class="builtintype" id="1369886">error</span><span class="op" id="1369891">)</span><br>
<span class="lineno"></span><span class="op" id="1369893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1369896">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1369973">type</span>&nbsp;<span class="ident" id="1369978">ReadWriter</span>&nbsp;<span class="keyword" id="1369989">interface</span>&nbsp;<span class="op" id="1369999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370002">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370010">Writer</span><br>
<span class="lineno"></span><span class="op" id="1370017">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1370020">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370097">type</span>&nbsp;<span class="ident" id="1370102">ReadCloser</span>&nbsp;<span class="keyword" id="1370113">interface</span>&nbsp;<span class="op" id="1370123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370126">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370134">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1370141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370144">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370223">type</span>&nbsp;<span class="ident" id="1370228">WriteCloser</span>&nbsp;<span class="keyword" id="1370240">interface</span>&nbsp;<span class="op" id="1370250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370253">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370261">Closer</span><br>
<span class="lineno"></span><span class="op" id="1370268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370271">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370360">type</span>&nbsp;<span class="ident" id="1370365">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1370381">interface</span>&nbsp;<span class="op" id="1370391">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370394">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370402">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370410">Closer</span><br>
<span class="lineno"></span><span class="op" id="1370417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1370420">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370496">type</span>&nbsp;<span class="ident" id="1370501">ReadSeeker</span>&nbsp;<span class="keyword" id="1370512">interface</span>&nbsp;<span class="op" id="1370522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370525">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370533">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1370540">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1370543">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370621">type</span>&nbsp;<span class="ident" id="1370626">WriteSeeker</span>&nbsp;<span class="keyword" id="1370638">interface</span>&nbsp;<span class="op" id="1370648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370651">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370659">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1370666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370669">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1370757">type</span>&nbsp;<span class="ident" id="1370762">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1370778">interface</span>&nbsp;<span class="op" id="1370788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370791">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370799">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370807">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1370814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370817">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1370880">//</span><br>
<span class="lineno"></span><span class="comment" id="1370883">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1370933">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1370984">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1371057">//</span><br>
<span class="lineno">160</span><span class="comment" id="1371060">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1371111">type</span>&nbsp;<span class="ident" id="1371116">ReaderFrom</span>&nbsp;<span class="keyword" id="1371127">interface</span>&nbsp;<span class="op" id="1371137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371140">ReadFrom</span><span class="op" id="1371148">(</span><span class="ident" id="1371149">r</span>&nbsp;<span class="ident" id="1371151">Reader</span><span class="op" id="1371157">)</span>&nbsp;<span class="op" id="1371159">(</span><span class="ident" id="1371160">n</span>&nbsp;<span class="ident" id="1371162">int64</span><span class="op" id="1371167">,</span>&nbsp;<span class="ident" id="1371169">err</span>&nbsp;<span class="builtintype" id="1371173">error</span><span class="op" id="1371178">)</span><br>
<span class="lineno"></span><span class="op" id="1371180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1371183">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1371243">//</span><br>
<span class="lineno"></span><span class="comment" id="1371246">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1371313">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1371380">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1371449">//</span><br>
<span class="lineno"></span><span class="comment" id="1371452">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1371501">type</span>&nbsp;<span class="ident" id="1371506">WriterTo</span>&nbsp;<span class="keyword" id="1371515">interface</span>&nbsp;<span class="op" id="1371525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371528">WriteTo</span><span class="op" id="1371535">(</span><span class="ident" id="1371536">w</span>&nbsp;<span class="ident" id="1371538">Writer</span><span class="op" id="1371544">)</span>&nbsp;<span class="op" id="1371546">(</span><span class="ident" id="1371547">n</span>&nbsp;<span class="ident" id="1371549">int64</span><span class="op" id="1371554">,</span>&nbsp;<span class="ident" id="1371556">err</span>&nbsp;<span class="builtintype" id="1371560">error</span><span class="op" id="1371565">)</span><br>
<span class="lineno"></span><span class="op" id="1371567">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1371570">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1371635">//</span><br>
<span class="lineno"></span><span class="comment" id="1371638">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1371704">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1371764">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1371818">//</span><br>
<span class="lineno"></span><span class="comment" id="1371821">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1371883">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1371949">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1371982">//</span><br>
<span class="lineno"></span><span class="comment" id="1371985">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1372054">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1372129">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1372205">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1372255">//</span><br>
<span class="lineno"></span><span class="comment" id="1372258">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1372326">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1372394">//</span><br>
<span class="lineno"></span><span class="comment" id="1372397">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1372462">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1372524">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1372540">//</span><br>
<span class="lineno"></span><span class="comment" id="1372543">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1372605">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1372627">//</span><br>
<span class="lineno"></span><span class="comment" id="1372630">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1372668">type</span>&nbsp;<span class="ident" id="1372673">ReaderAt</span>&nbsp;<span class="keyword" id="1372682">interface</span>&nbsp;<span class="op" id="1372692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372695">ReadAt</span><span class="op" id="1372701">(</span><span class="ident" id="1372702">p</span>&nbsp;<span class="op" id="1372704">[</span><span class="op" id="1372705">]</span><span class="builtintype" id="1372706">byte</span><span class="op" id="1372710">,</span>&nbsp;<span class="ident" id="1372712">off</span>&nbsp;<span class="ident" id="1372716">int64</span><span class="op" id="1372721">)</span>&nbsp;<span class="op" id="1372723">(</span><span class="ident" id="1372724">n</span>&nbsp;<span class="builtintype" id="1372726">int</span><span class="op" id="1372729">,</span>&nbsp;<span class="ident" id="1372731">err</span>&nbsp;<span class="builtintype" id="1372735">error</span><span class="op" id="1372740">)</span><br>
<span class="lineno"></span><span class="op" id="1372742">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1372745">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1372811">//</span><br>
<span class="lineno"></span><span class="comment" id="1372814">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1372882">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1372966">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1373032">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1373097">//</span><br>
<span class="lineno"></span><span class="comment" id="1373100">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1373162">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1373225">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1373241">//</span><br>
<span class="lineno"></span><span class="comment" id="1373244">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1373313">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1373358">//</span><br>
<span class="lineno">220</span><span class="comment" id="1373361">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1373399">type</span>&nbsp;<span class="ident" id="1373404">WriterAt</span>&nbsp;<span class="keyword" id="1373413">interface</span>&nbsp;<span class="op" id="1373423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1373426">WriteAt</span><span class="op" id="1373433">(</span><span class="ident" id="1373434">p</span>&nbsp;<span class="op" id="1373436">[</span><span class="op" id="1373437">]</span><span class="builtintype" id="1373438">byte</span><span class="op" id="1373442">,</span>&nbsp;<span class="ident" id="1373444">off</span>&nbsp;<span class="ident" id="1373448">int64</span><span class="op" id="1373453">)</span>&nbsp;<span class="op" id="1373455">(</span><span class="ident" id="1373456">n</span>&nbsp;<span class="builtintype" id="1373458">int</span><span class="op" id="1373461">,</span>&nbsp;<span class="ident" id="1373463">err</span>&nbsp;<span class="builtintype" id="1373467">error</span><span class="op" id="1373472">)</span><br>
<span class="lineno"></span><span class="op" id="1373474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1373477">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1373540">//</span><br>
<span class="lineno"></span><span class="comment" id="1373543">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1373603">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1373648">type</span>&nbsp;<span class="ident" id="1373653">ByteReader</span>&nbsp;<span class="keyword" id="1373664">interface</span>&nbsp;<span class="op" id="1373674">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1373677">ReadByte</span><span class="op" id="1373685">(</span><span class="op" id="1373686">)</span>&nbsp;<span class="op" id="1373688">(</span><span class="ident" id="1373689">c</span>&nbsp;<span class="builtintype" id="1373691">byte</span><span class="op" id="1373695">,</span>&nbsp;<span class="ident" id="1373697">err</span>&nbsp;<span class="builtintype" id="1373701">error</span><span class="op" id="1373706">)</span><br>
<span class="lineno"></span><span class="op" id="1373708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1373711">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1373782">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1373808">//</span><br>
<span class="lineno"></span><span class="comment" id="1373811">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1373882">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1373919">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1373989">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1374010">type</span>&nbsp;<span class="ident" id="1374015">ByteScanner</span>&nbsp;<span class="keyword" id="1374027">interface</span>&nbsp;<span class="op" id="1374037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374040">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374052">UnreadByte</span><span class="op" id="1374062">(</span><span class="op" id="1374063">)</span>&nbsp;<span class="builtintype" id="1374065">error</span><br>
<span class="lineno"></span><span class="op" id="1374071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1374074">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1374138">type</span>&nbsp;<span class="ident" id="1374143">ByteWriter</span>&nbsp;<span class="keyword" id="1374154">interface</span>&nbsp;<span class="op" id="1374164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374167">WriteByte</span><span class="op" id="1374176">(</span><span class="ident" id="1374177">c</span>&nbsp;<span class="builtintype" id="1374179">byte</span><span class="op" id="1374183">)</span>&nbsp;<span class="builtintype" id="1374185">error</span><br>
<span class="lineno"></span><span class="op" id="1374191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1374194">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1374257">//</span><br>
<span class="lineno"></span><span class="comment" id="1374260">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1374319">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1374385">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1374416">type</span>&nbsp;<span class="ident" id="1374421">RuneReader</span>&nbsp;<span class="keyword" id="1374432">interface</span>&nbsp;<span class="op" id="1374442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374445">ReadRune</span><span class="op" id="1374453">(</span><span class="op" id="1374454">)</span>&nbsp;<span class="op" id="1374456">(</span><span class="ident" id="1374457">r</span>&nbsp;<span class="builtintype" id="1374459">rune</span><span class="op" id="1374463">,</span>&nbsp;<span class="ident" id="1374465">size</span>&nbsp;<span class="builtintype" id="1374470">int</span><span class="op" id="1374473">,</span>&nbsp;<span class="ident" id="1374475">err</span>&nbsp;<span class="builtintype" id="1374479">error</span><span class="op" id="1374484">)</span><br>
<span class="lineno"></span><span class="op" id="1374486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1374489">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1374560">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1374586">//</span><br>
<span class="lineno"></span><span class="comment" id="1374589">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1374660">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1374697">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1374767">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1374788">type</span>&nbsp;<span class="ident" id="1374793">RuneScanner</span>&nbsp;<span class="keyword" id="1374805">interface</span>&nbsp;<span class="op" id="1374815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374818">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374830">UnreadRune</span><span class="op" id="1374840">(</span><span class="op" id="1374841">)</span>&nbsp;<span class="builtintype" id="1374843">error</span><br>
<span class="lineno"></span><span class="op" id="1374849">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1374852">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1374920">type</span>&nbsp;<span class="ident" id="1374925">stringWriter</span>&nbsp;<span class="keyword" id="1374938">interface</span>&nbsp;<span class="op" id="1374948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1374951">WriteString</span><span class="op" id="1374962">(</span><span class="ident" id="1374963">s</span>&nbsp;<span class="builtintype" id="1374965">string</span><span class="op" id="1374971">)</span>&nbsp;<span class="op" id="1374973">(</span><span class="ident" id="1374974">n</span>&nbsp;<span class="builtintype" id="1374976">int</span><span class="op" id="1374979">,</span>&nbsp;<span class="ident" id="1374981">err</span>&nbsp;<span class="builtintype" id="1374985">error</span><span class="op" id="1374990">)</span><br>
<span class="lineno"></span><span class="op" id="1374992">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1374995">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1375085">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1375158">func</span>&nbsp;<span class="ident" id="1375163">WriteString</span><span class="op" id="1375174">(</span><span class="ident" id="1375175">w</span>&nbsp;<span class="ident" id="1375177">Writer</span><span class="op" id="1375183">,</span>&nbsp;<span class="ident" id="1375185">s</span>&nbsp;<span class="builtintype" id="1375187">string</span><span class="op" id="1375193">)</span>&nbsp;<span class="op" id="1375195">(</span><span class="ident" id="1375196">n</span>&nbsp;<span class="builtintype" id="1375198">int</span><span class="op" id="1375201">,</span>&nbsp;<span class="ident" id="1375203">err</span>&nbsp;<span class="builtintype" id="1375207">error</span><span class="op" id="1375212">)</span>&nbsp;<span class="op" id="1375214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375217">if</span>&nbsp;<span class="ident" id="1375220">sw</span><span class="op" id="1375222">,</span>&nbsp;<span class="ident" id="1375224">ok</span>&nbsp;<span class="op" id="1375227">:=</span>&nbsp;<span class="ident" id="1375230">w</span><span class="op" id="1375231">.</span><span class="op" id="1375232">(</span><span class="ident" id="1375233">stringWriter</span><span class="op" id="1375245">)</span><span class="op" id="1375246">;</span>&nbsp;<span class="ident" id="1375248">ok</span>&nbsp;<span class="op" id="1375251">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375255">return</span>&nbsp;<span class="ident" id="1375262">sw</span><span class="op" id="1375264">.</span><span class="ident" id="1375265">WriteString</span><span class="op" id="1375276">(</span><span class="ident" id="1375277">s</span><span class="op" id="1375278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1375281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375284">return</span>&nbsp;<span class="ident" id="1375291">w</span><span class="op" id="1375292">.</span><span class="ident" id="1375293">Write</span><span class="op" id="1375298">(</span><span class="op" id="1375299">[</span><span class="op" id="1375300">]</span><span class="builtintype" id="1375301">byte</span><span class="op" id="1375305">(</span><span class="ident" id="1375306">s</span><span class="op" id="1375307">)</span><span class="op" id="1375308">)</span><br>
<span class="lineno"></span><span class="op" id="1375310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1375313">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1375388">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1375468">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1375516">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1375573">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1375614">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1375695">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1375745">func</span>&nbsp;<span class="ident" id="1375750">ReadAtLeast</span><span class="op" id="1375761">(</span><span class="ident" id="1375762">r</span>&nbsp;<span class="ident" id="1375764">Reader</span><span class="op" id="1375770">,</span>&nbsp;<span class="ident" id="1375772">buf</span>&nbsp;<span class="op" id="1375776">[</span><span class="op" id="1375777">]</span><span class="builtintype" id="1375778">byte</span><span class="op" id="1375782">,</span>&nbsp;<span class="ident" id="1375784">min</span>&nbsp;<span class="builtintype" id="1375788">int</span><span class="op" id="1375791">)</span>&nbsp;<span class="op" id="1375793">(</span><span class="ident" id="1375794">n</span>&nbsp;<span class="builtintype" id="1375796">int</span><span class="op" id="1375799">,</span>&nbsp;<span class="ident" id="1375801">err</span>&nbsp;<span class="builtintype" id="1375805">error</span><span class="op" id="1375810">)</span>&nbsp;<span class="op" id="1375812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375815">if</span>&nbsp;<span class="builtinfunc" id="1375818">len</span><span class="op" id="1375821">(</span><span class="ident" id="1375822">buf</span><span class="op" id="1375825">)</span>&nbsp;<span class="op" id="1375827">&lt;</span>&nbsp;<span class="ident" id="1375829">min</span>&nbsp;<span class="op" id="1375833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375837">return</span>&nbsp;<span class="num" id="1375844">0</span><span class="op" id="1375845">,</span>&nbsp;<span class="ident" id="1375847">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1375863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375866">for</span>&nbsp;<span class="ident" id="1375870">n</span>&nbsp;<span class="op" id="1375872">&lt;</span>&nbsp;<span class="ident" id="1375874">min</span>&nbsp;<span class="op" id="1375878">&amp;&amp;</span>&nbsp;<span class="ident" id="1375881">err</span>&nbsp;<span class="op" id="1375885">==</span>&nbsp;<span class="ident" id="1375888">nil</span>&nbsp;<span class="op" id="1375892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375896">var</span>&nbsp;<span class="ident" id="1375900">nn</span>&nbsp;<span class="builtintype" id="1375903">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1375909">nn</span><span class="op" id="1375911">,</span>&nbsp;<span class="ident" id="1375913">err</span>&nbsp;<span class="op" id="1375917">=</span>&nbsp;<span class="ident" id="1375919">r</span><span class="op" id="1375920">.</span><span class="ident" id="1375921">Read</span><span class="op" id="1375925">(</span><span class="ident" id="1375926">buf</span><span class="op" id="1375929">[</span><span class="ident" id="1375930">n</span><span class="op" id="1375931">:</span><span class="op" id="1375932">]</span><span class="op" id="1375933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1375937">n</span>&nbsp;<span class="op" id="1375939">+=</span>&nbsp;<span class="ident" id="1375942">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1375946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1375949">if</span>&nbsp;<span class="ident" id="1375952">n</span>&nbsp;<span class="op" id="1375954">&gt;=</span>&nbsp;<span class="ident" id="1375957">min</span>&nbsp;<span class="op" id="1375961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1375965">err</span>&nbsp;<span class="op" id="1375969">=</span>&nbsp;<span class="ident" id="1375971">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1375976">}</span>&nbsp;<span class="keyword" id="1375978">else</span>&nbsp;<span class="keyword" id="1375983">if</span>&nbsp;<span class="ident" id="1375986">n</span>&nbsp;<span class="op" id="1375988">&gt;</span>&nbsp;<span class="num" id="1375990">0</span>&nbsp;<span class="op" id="1375992">&amp;&amp;</span>&nbsp;<span class="ident" id="1375995">err</span>&nbsp;<span class="op" id="1375999">==</span>&nbsp;<span class="ident" id="1376002">EOF</span>&nbsp;<span class="op" id="1376006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1376010">err</span>&nbsp;<span class="op" id="1376014">=</span>&nbsp;<span class="ident" id="1376016">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1376034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1376037">return</span><br>
<span class="lineno"></span><span class="op" id="1376044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376047">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1376105">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1376185">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1376233">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1376296">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1376334">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1376389">func</span>&nbsp;<span class="ident" id="1376394">ReadFull</span><span class="op" id="1376402">(</span><span class="ident" id="1376403">r</span>&nbsp;<span class="ident" id="1376405">Reader</span><span class="op" id="1376411">,</span>&nbsp;<span class="ident" id="1376413">buf</span>&nbsp;<span class="op" id="1376417">[</span><span class="op" id="1376418">]</span><span class="builtintype" id="1376419">byte</span><span class="op" id="1376423">)</span>&nbsp;<span class="op" id="1376425">(</span><span class="ident" id="1376426">n</span>&nbsp;<span class="builtintype" id="1376428">int</span><span class="op" id="1376431">,</span>&nbsp;<span class="ident" id="1376433">err</span>&nbsp;<span class="builtintype" id="1376437">error</span><span class="op" id="1376442">)</span>&nbsp;<span class="op" id="1376444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1376447">return</span>&nbsp;<span class="ident" id="1376454">ReadAtLeast</span><span class="op" id="1376465">(</span><span class="ident" id="1376466">r</span><span class="op" id="1376467">,</span>&nbsp;<span class="ident" id="1376469">buf</span><span class="op" id="1376472">,</span>&nbsp;<span class="builtinfunc" id="1376474">len</span><span class="op" id="1376477">(</span><span class="ident" id="1376478">buf</span><span class="op" id="1376481">)</span><span class="op" id="1376482">)</span><br>
<span class="lineno"></span><span class="op" id="1376484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376487">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1376548">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1376606">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1376642">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1376696">//</span><br>
<span class="lineno"></span><span class="comment" id="1376699">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1376746">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1376783">func</span>&nbsp;<span class="ident" id="1376788">CopyN</span><span class="op" id="1376793">(</span><span class="ident" id="1376794">dst</span>&nbsp;<span class="ident" id="1376798">Writer</span><span class="op" id="1376804">,</span>&nbsp;<span class="ident" id="1376806">src</span>&nbsp;<span class="ident" id="1376810">Reader</span><span class="op" id="1376816">,</span>&nbsp;<span class="ident" id="1376818">n</span>&nbsp;<span class="ident" id="1376820">int64</span><span class="op" id="1376825">)</span>&nbsp;<span class="op" id="1376827">(</span><span class="ident" id="1376828">written</span>&nbsp;<span class="ident" id="1376836">int64</span><span class="op" id="1376841">,</span>&nbsp;<span class="ident" id="1376843">err</span>&nbsp;<span class="builtintype" id="1376847">error</span><span class="op" id="1376852">)</span>&nbsp;<span class="op" id="1376854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1376857">written</span><span class="op" id="1376864">,</span>&nbsp;<span class="ident" id="1376866">err</span>&nbsp;<span class="op" id="1376870">=</span>&nbsp;<span class="ident" id="1376872">Copy</span><span class="op" id="1376876">(</span><span class="ident" id="1376877">dst</span><span class="op" id="1376880">,</span>&nbsp;<span class="ident" id="1376882">LimitReader</span><span class="op" id="1376893">(</span><span class="ident" id="1376894">src</span><span class="op" id="1376897">,</span>&nbsp;<span class="ident" id="1376899">n</span><span class="op" id="1376900">)</span><span class="op" id="1376901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1376904">if</span>&nbsp;<span class="ident" id="1376907">written</span>&nbsp;<span class="op" id="1376915">==</span>&nbsp;<span class="ident" id="1376918">n</span>&nbsp;<span class="op" id="1376920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1376924">return</span>&nbsp;<span class="ident" id="1376931">n</span><span class="op" id="1376932">,</span>&nbsp;<span class="ident" id="1376934">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1376939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1376942">if</span>&nbsp;<span class="ident" id="1376945">written</span>&nbsp;<span class="op" id="1376953">&lt;</span>&nbsp;<span class="ident" id="1376955">n</span>&nbsp;<span class="op" id="1376957">&amp;&amp;</span>&nbsp;<span class="ident" id="1376960">err</span>&nbsp;<span class="op" id="1376964">==</span>&nbsp;<span class="ident" id="1376967">nil</span>&nbsp;<span class="op" id="1376971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1376975">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1377019">err</span>&nbsp;<span class="op" id="1377023">=</span>&nbsp;<span class="ident" id="1377025">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1377030">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1377033">return</span><br>
<span class="lineno"></span><span class="op" id="1377040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1377043">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1377102">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1377164">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1377229">//</span><br>
<span class="lineno"></span><span class="comment" id="1377232">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1377289">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1377352">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1377410">//</span><br>
<span class="lineno"></span><span class="comment" id="1377413">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1377458">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1377514">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1377572">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1377629">func</span>&nbsp;<span class="ident" id="1377634">Copy</span><span class="op" id="1377638">(</span><span class="ident" id="1377639">dst</span>&nbsp;<span class="ident" id="1377643">Writer</span><span class="op" id="1377649">,</span>&nbsp;<span class="ident" id="1377651">src</span>&nbsp;<span class="ident" id="1377655">Reader</span><span class="op" id="1377661">)</span>&nbsp;<span class="op" id="1377663">(</span><span class="ident" id="1377664">written</span>&nbsp;<span class="ident" id="1377672">int64</span><span class="op" id="1377677">,</span>&nbsp;<span class="ident" id="1377679">err</span>&nbsp;<span class="builtintype" id="1377683">error</span><span class="op" id="1377688">)</span>&nbsp;<span class="op" id="1377690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1377693">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1377756">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1377793">if</span>&nbsp;<span class="ident" id="1377796">wt</span><span class="op" id="1377798">,</span>&nbsp;<span class="ident" id="1377800">ok</span>&nbsp;<span class="op" id="1377803">:=</span>&nbsp;<span class="ident" id="1377806">src</span><span class="op" id="1377809">.</span><span class="op" id="1377810">(</span><span class="ident" id="1377811">WriterTo</span><span class="op" id="1377819">)</span><span class="op" id="1377820">;</span>&nbsp;<span class="ident" id="1377822">ok</span>&nbsp;<span class="op" id="1377825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1377829">return</span>&nbsp;<span class="ident" id="1377836">wt</span><span class="op" id="1377838">.</span><span class="ident" id="1377839">WriteTo</span><span class="op" id="1377846">(</span><span class="ident" id="1377847">dst</span><span class="op" id="1377850">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1377853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1377856">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1377931">if</span>&nbsp;<span class="ident" id="1377934">rt</span><span class="op" id="1377936">,</span>&nbsp;<span class="ident" id="1377938">ok</span>&nbsp;<span class="op" id="1377941">:=</span>&nbsp;<span class="ident" id="1377944">dst</span><span class="op" id="1377947">.</span><span class="op" id="1377948">(</span><span class="ident" id="1377949">ReaderFrom</span><span class="op" id="1377959">)</span><span class="op" id="1377960">;</span>&nbsp;<span class="ident" id="1377962">ok</span>&nbsp;<span class="op" id="1377965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1377969">return</span>&nbsp;<span class="ident" id="1377976">rt</span><span class="op" id="1377978">.</span><span class="ident" id="1377979">ReadFrom</span><span class="op" id="1377987">(</span><span class="ident" id="1377988">src</span><span class="op" id="1377991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1377994">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1377997">buf</span>&nbsp;<span class="op" id="1378001">:=</span>&nbsp;<span class="builtinfunc" id="1378004">make</span><span class="op" id="1378008">(</span><span class="op" id="1378009">[</span><span class="op" id="1378010">]</span><span class="builtintype" id="1378011">byte</span><span class="op" id="1378015">,</span>&nbsp;<span class="num" id="1378017">32</span><span class="op" id="1378019">*</span><span class="num" id="1378020">1024</span><span class="op" id="1378024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378027">for</span>&nbsp;<span class="op" id="1378031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378035">nr</span><span class="op" id="1378037">,</span>&nbsp;<span class="ident" id="1378039">er</span>&nbsp;<span class="op" id="1378042">:=</span>&nbsp;<span class="ident" id="1378045">src</span><span class="op" id="1378048">.</span><span class="ident" id="1378049">Read</span><span class="op" id="1378053">(</span><span class="ident" id="1378054">buf</span><span class="op" id="1378057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378061">if</span>&nbsp;<span class="ident" id="1378064">nr</span>&nbsp;<span class="op" id="1378067">&gt;</span>&nbsp;<span class="num" id="1378069">0</span>&nbsp;<span class="op" id="1378071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378076">nw</span><span class="op" id="1378078">,</span>&nbsp;<span class="ident" id="1378080">ew</span>&nbsp;<span class="op" id="1378083">:=</span>&nbsp;<span class="ident" id="1378086">dst</span><span class="op" id="1378089">.</span><span class="ident" id="1378090">Write</span><span class="op" id="1378095">(</span><span class="ident" id="1378096">buf</span><span class="op" id="1378099">[</span><span class="num" id="1378100">0</span><span class="op" id="1378101">:</span><span class="ident" id="1378102">nr</span><span class="op" id="1378104">]</span><span class="op" id="1378105">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378110">if</span>&nbsp;<span class="ident" id="1378113">nw</span>&nbsp;<span class="op" id="1378116">&gt;</span>&nbsp;<span class="num" id="1378118">0</span>&nbsp;<span class="op" id="1378120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378126">written</span>&nbsp;<span class="op" id="1378134">+=</span>&nbsp;<span class="ident" id="1378137">int64</span><span class="op" id="1378142">(</span><span class="ident" id="1378143">nw</span><span class="op" id="1378145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378155">if</span>&nbsp;<span class="ident" id="1378158">ew</span>&nbsp;<span class="op" id="1378161">!=</span>&nbsp;<span class="ident" id="1378164">nil</span>&nbsp;<span class="op" id="1378168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378174">err</span>&nbsp;<span class="op" id="1378178">=</span>&nbsp;<span class="ident" id="1378180">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378187">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378201">if</span>&nbsp;<span class="ident" id="1378204">nr</span>&nbsp;<span class="op" id="1378207">!=</span>&nbsp;<span class="ident" id="1378210">nw</span>&nbsp;<span class="op" id="1378213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378219">err</span>&nbsp;<span class="op" id="1378223">=</span>&nbsp;<span class="ident" id="1378225">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378243">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378260">if</span>&nbsp;<span class="ident" id="1378263">er</span>&nbsp;<span class="op" id="1378266">==</span>&nbsp;<span class="ident" id="1378269">EOF</span>&nbsp;<span class="op" id="1378273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378278">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378286">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378290">if</span>&nbsp;<span class="ident" id="1378293">er</span>&nbsp;<span class="op" id="1378296">!=</span>&nbsp;<span class="ident" id="1378299">nil</span>&nbsp;<span class="op" id="1378303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378308">err</span>&nbsp;<span class="op" id="1378312">=</span>&nbsp;<span class="ident" id="1378314">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378320">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378331">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378334">return</span>&nbsp;<span class="ident" id="1378341">written</span><span class="op" id="1378348">,</span>&nbsp;<span class="ident" id="1378350">err</span><br>
<span class="lineno"></span><span class="op" id="1378354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378357">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1378407">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1378444">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1378498">func</span>&nbsp;<span class="ident" id="1378503">LimitReader</span><span class="op" id="1378514">(</span><span class="ident" id="1378515">r</span>&nbsp;<span class="ident" id="1378517">Reader</span><span class="op" id="1378523">,</span>&nbsp;<span class="ident" id="1378525">n</span>&nbsp;<span class="ident" id="1378527">int64</span><span class="op" id="1378532">)</span>&nbsp;<span class="ident" id="1378534">Reader</span>&nbsp;<span class="op" id="1378541">{</span>&nbsp;<span class="keyword" id="1378543">return</span>&nbsp;<span class="op" id="1378550">&amp;</span><span class="ident" id="1378551">LimitedReader</span><span class="op" id="1378564">{</span><span class="ident" id="1378565">r</span><span class="op" id="1378566">,</span>&nbsp;<span class="ident" id="1378568">n</span><span class="op" id="1378569">}</span>&nbsp;<span class="op" id="1378571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378574">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1378631">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1378683">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1378733">type</span>&nbsp;<span class="ident" id="1378738">LimitedReader</span>&nbsp;<span class="keyword" id="1378752">struct</span>&nbsp;<span class="op" id="1378759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378762">R</span>&nbsp;<span class="ident" id="1378764">Reader</span>&nbsp;<span class="comment" id="1378771">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378793">N</span>&nbsp;<span class="ident" id="1378795">int64</span>&nbsp;&nbsp;<span class="comment" id="1378802">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1378825">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1378828">func</span>&nbsp;<span class="op" id="1378833">(</span><span class="ident" id="1378834">l</span>&nbsp;<span class="op" id="1378836">*</span><span class="ident" id="1378837">LimitedReader</span><span class="op" id="1378850">)</span>&nbsp;<span class="ident" id="1378852">Read</span><span class="op" id="1378856">(</span><span class="ident" id="1378857">p</span>&nbsp;<span class="op" id="1378859">[</span><span class="op" id="1378860">]</span><span class="builtintype" id="1378861">byte</span><span class="op" id="1378865">)</span>&nbsp;<span class="op" id="1378867">(</span><span class="ident" id="1378868">n</span>&nbsp;<span class="builtintype" id="1378870">int</span><span class="op" id="1378873">,</span>&nbsp;<span class="ident" id="1378875">err</span>&nbsp;<span class="builtintype" id="1378879">error</span><span class="op" id="1378884">)</span>&nbsp;<span class="op" id="1378886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378889">if</span>&nbsp;<span class="ident" id="1378892">l</span><span class="op" id="1378893">.</span><span class="ident" id="1378894">N</span>&nbsp;<span class="op" id="1378896">&lt;=</span>&nbsp;<span class="num" id="1378899">0</span>&nbsp;<span class="op" id="1378901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378905">return</span>&nbsp;<span class="num" id="1378912">0</span><span class="op" id="1378913">,</span>&nbsp;<span class="ident" id="1378915">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378920">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1378923">if</span>&nbsp;<span class="ident" id="1378926">int64</span><span class="op" id="1378931">(</span><span class="builtinfunc" id="1378932">len</span><span class="op" id="1378935">(</span><span class="ident" id="1378936">p</span><span class="op" id="1378937">)</span><span class="op" id="1378938">)</span>&nbsp;<span class="op" id="1378940">&gt;</span>&nbsp;<span class="ident" id="1378942">l</span><span class="op" id="1378943">.</span><span class="ident" id="1378944">N</span>&nbsp;<span class="op" id="1378946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378950">p</span>&nbsp;<span class="op" id="1378952">=</span>&nbsp;<span class="ident" id="1378954">p</span><span class="op" id="1378955">[</span><span class="num" id="1378956">0</span><span class="op" id="1378957">:</span><span class="ident" id="1378958">l</span><span class="op" id="1378959">.</span><span class="ident" id="1378960">N</span><span class="op" id="1378961">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1378964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378967">n</span><span class="op" id="1378968">,</span>&nbsp;<span class="ident" id="1378970">err</span>&nbsp;<span class="op" id="1378974">=</span>&nbsp;<span class="ident" id="1378976">l</span><span class="op" id="1378977">.</span><span class="ident" id="1378978">R</span><span class="op" id="1378979">.</span><span class="ident" id="1378980">Read</span><span class="op" id="1378984">(</span><span class="ident" id="1378985">p</span><span class="op" id="1378986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1378989">l</span><span class="op" id="1378990">.</span><span class="ident" id="1378991">N</span>&nbsp;<span class="op" id="1378993">-=</span>&nbsp;<span class="ident" id="1378996">int64</span><span class="op" id="1379001">(</span><span class="ident" id="1379002">n</span><span class="op" id="1379003">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379006">return</span><br>
<span class="lineno"></span><span class="op" id="1379013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379016">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1379078">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1379138">func</span>&nbsp;<span class="ident" id="1379143">NewSectionReader</span><span class="op" id="1379159">(</span><span class="ident" id="1379160">r</span>&nbsp;<span class="ident" id="1379162">ReaderAt</span><span class="op" id="1379170">,</span>&nbsp;<span class="ident" id="1379172">off</span>&nbsp;<span class="ident" id="1379176">int64</span><span class="op" id="1379181">,</span>&nbsp;<span class="ident" id="1379183">n</span>&nbsp;<span class="ident" id="1379185">int64</span><span class="op" id="1379190">)</span>&nbsp;<span class="op" id="1379192">*</span><span class="ident" id="1379193">SectionReader</span>&nbsp;<span class="op" id="1379207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379210">return</span>&nbsp;<span class="op" id="1379217">&amp;</span><span class="ident" id="1379218">SectionReader</span><span class="op" id="1379231">{</span><span class="ident" id="1379232">r</span><span class="op" id="1379233">,</span>&nbsp;<span class="ident" id="1379235">off</span><span class="op" id="1379238">,</span>&nbsp;<span class="ident" id="1379240">off</span><span class="op" id="1379243">,</span>&nbsp;<span class="ident" id="1379245">off</span>&nbsp;<span class="op" id="1379249">+</span>&nbsp;<span class="ident" id="1379251">n</span><span class="op" id="1379252">}</span><br>
<span class="lineno"></span><span class="op" id="1379254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379257">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1379321">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1379351">type</span>&nbsp;<span class="ident" id="1379356">SectionReader</span>&nbsp;<span class="keyword" id="1379370">struct</span>&nbsp;<span class="op" id="1379377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379380">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379386">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379396">base</span>&nbsp;&nbsp;<span class="ident" id="1379402">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379409">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1379415">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379422">limit</span>&nbsp;<span class="ident" id="1379428">int64</span><br>
<span class="lineno"></span><span class="op" id="1379434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1379437">func</span>&nbsp;<span class="op" id="1379442">(</span><span class="ident" id="1379443">s</span>&nbsp;<span class="op" id="1379445">*</span><span class="ident" id="1379446">SectionReader</span><span class="op" id="1379459">)</span>&nbsp;<span class="ident" id="1379461">Read</span><span class="op" id="1379465">(</span><span class="ident" id="1379466">p</span>&nbsp;<span class="op" id="1379468">[</span><span class="op" id="1379469">]</span><span class="builtintype" id="1379470">byte</span><span class="op" id="1379474">)</span>&nbsp;<span class="op" id="1379476">(</span><span class="ident" id="1379477">n</span>&nbsp;<span class="builtintype" id="1379479">int</span><span class="op" id="1379482">,</span>&nbsp;<span class="ident" id="1379484">err</span>&nbsp;<span class="builtintype" id="1379488">error</span><span class="op" id="1379493">)</span>&nbsp;<span class="op" id="1379495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379498">if</span>&nbsp;<span class="ident" id="1379501">s</span><span class="op" id="1379502">.</span><span class="ident" id="1379503">off</span>&nbsp;<span class="op" id="1379507">&gt;=</span>&nbsp;<span class="ident" id="1379510">s</span><span class="op" id="1379511">.</span><span class="ident" id="1379512">limit</span>&nbsp;<span class="op" id="1379518">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379522">return</span>&nbsp;<span class="num" id="1379529">0</span><span class="op" id="1379530">,</span>&nbsp;<span class="ident" id="1379532">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1379537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379540">if</span>&nbsp;<span class="ident" id="1379543">max</span>&nbsp;<span class="op" id="1379547">:=</span>&nbsp;<span class="ident" id="1379550">s</span><span class="op" id="1379551">.</span><span class="ident" id="1379552">limit</span>&nbsp;<span class="op" id="1379558">-</span>&nbsp;<span class="ident" id="1379560">s</span><span class="op" id="1379561">.</span><span class="ident" id="1379562">off</span><span class="op" id="1379565">;</span>&nbsp;<span class="ident" id="1379567">int64</span><span class="op" id="1379572">(</span><span class="builtinfunc" id="1379573">len</span><span class="op" id="1379576">(</span><span class="ident" id="1379577">p</span><span class="op" id="1379578">)</span><span class="op" id="1379579">)</span>&nbsp;<span class="op" id="1379581">&gt;</span>&nbsp;<span class="ident" id="1379583">max</span>&nbsp;<span class="op" id="1379587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379591">p</span>&nbsp;<span class="op" id="1379593">=</span>&nbsp;<span class="ident" id="1379595">p</span><span class="op" id="1379596">[</span><span class="num" id="1379597">0</span><span class="op" id="1379598">:</span><span class="ident" id="1379599">max</span><span class="op" id="1379602">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1379605">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379608">n</span><span class="op" id="1379609">,</span>&nbsp;<span class="ident" id="1379611">err</span>&nbsp;<span class="op" id="1379615">=</span>&nbsp;<span class="ident" id="1379617">s</span><span class="op" id="1379618">.</span><span class="ident" id="1379619">r</span><span class="op" id="1379620">.</span><span class="ident" id="1379621">ReadAt</span><span class="op" id="1379627">(</span><span class="ident" id="1379628">p</span><span class="op" id="1379629">,</span>&nbsp;<span class="ident" id="1379631">s</span><span class="op" id="1379632">.</span><span class="ident" id="1379633">off</span><span class="op" id="1379636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379639">s</span><span class="op" id="1379640">.</span><span class="ident" id="1379641">off</span>&nbsp;<span class="op" id="1379645">+=</span>&nbsp;<span class="ident" id="1379648">int64</span><span class="op" id="1379653">(</span><span class="ident" id="1379654">n</span><span class="op" id="1379655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379658">return</span><br>
<span class="lineno"></span><span class="op" id="1379665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1379668">var</span>&nbsp;<span class="ident" id="1379672">errWhence</span>&nbsp;<span class="op" id="1379682">=</span>&nbsp;<span class="ident" id="1379684">errors</span><span class="op" id="1379690">.</span><span class="ident" id="1379691">New</span><span class="op" id="1379694">(</span><span class="string" id="1379695">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1379717">)</span><br>
<span class="lineno"></span><span class="keyword" id="1379719">var</span>&nbsp;<span class="ident" id="1379723">errOffset</span>&nbsp;<span class="op" id="1379733">=</span>&nbsp;<span class="ident" id="1379735">errors</span><span class="op" id="1379741">.</span><span class="ident" id="1379742">New</span><span class="op" id="1379745">(</span><span class="string" id="1379746">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1379768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1379771">func</span>&nbsp;<span class="op" id="1379776">(</span><span class="ident" id="1379777">s</span>&nbsp;<span class="op" id="1379779">*</span><span class="ident" id="1379780">SectionReader</span><span class="op" id="1379793">)</span>&nbsp;<span class="ident" id="1379795">Seek</span><span class="op" id="1379799">(</span><span class="ident" id="1379800">offset</span>&nbsp;<span class="ident" id="1379807">int64</span><span class="op" id="1379812">,</span>&nbsp;<span class="ident" id="1379814">whence</span>&nbsp;<span class="builtintype" id="1379821">int</span><span class="op" id="1379824">)</span>&nbsp;<span class="op" id="1379826">(</span><span class="ident" id="1379827">int64</span><span class="op" id="1379832">,</span>&nbsp;<span class="builtintype" id="1379834">error</span><span class="op" id="1379839">)</span>&nbsp;<span class="op" id="1379841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379844">switch</span>&nbsp;<span class="ident" id="1379851">whence</span>&nbsp;<span class="op" id="1379858">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379861">default</span><span class="op" id="1379868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379872">return</span>&nbsp;<span class="num" id="1379879">0</span><span class="op" id="1379880">,</span>&nbsp;<span class="ident" id="1379882">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379893">case</span>&nbsp;<span class="num" id="1379898">0</span><span class="op" id="1379899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379903">offset</span>&nbsp;<span class="op" id="1379910">+=</span>&nbsp;<span class="ident" id="1379913">s</span><span class="op" id="1379914">.</span><span class="ident" id="1379915">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379921">case</span>&nbsp;<span class="num" id="1379926">1</span><span class="op" id="1379927">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379931">offset</span>&nbsp;<span class="op" id="1379938">+=</span>&nbsp;<span class="ident" id="1379941">s</span><span class="op" id="1379942">.</span><span class="ident" id="1379943">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379948">case</span>&nbsp;<span class="num" id="1379953">2</span><span class="op" id="1379954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1379958">offset</span>&nbsp;<span class="op" id="1379965">+=</span>&nbsp;<span class="ident" id="1379968">s</span><span class="op" id="1379969">.</span><span class="ident" id="1379970">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1379977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1379980">if</span>&nbsp;<span class="ident" id="1379983">offset</span>&nbsp;<span class="op" id="1379990">&lt;</span>&nbsp;<span class="ident" id="1379992">s</span><span class="op" id="1379993">.</span><span class="ident" id="1379994">base</span>&nbsp;<span class="op" id="1379999">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380003">return</span>&nbsp;<span class="num" id="1380010">0</span><span class="op" id="1380011">,</span>&nbsp;<span class="ident" id="1380013">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1380024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380027">s</span><span class="op" id="1380028">.</span><span class="ident" id="1380029">off</span>&nbsp;<span class="op" id="1380033">=</span>&nbsp;<span class="ident" id="1380035">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380043">return</span>&nbsp;<span class="ident" id="1380050">offset</span>&nbsp;<span class="op" id="1380057">-</span>&nbsp;<span class="ident" id="1380059">s</span><span class="op" id="1380060">.</span><span class="ident" id="1380061">base</span><span class="op" id="1380065">,</span>&nbsp;<span class="ident" id="1380067">nil</span><br>
<span class="lineno"></span><span class="op" id="1380071">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1380074">func</span>&nbsp;<span class="op" id="1380079">(</span><span class="ident" id="1380080">s</span>&nbsp;<span class="op" id="1380082">*</span><span class="ident" id="1380083">SectionReader</span><span class="op" id="1380096">)</span>&nbsp;<span class="ident" id="1380098">ReadAt</span><span class="op" id="1380104">(</span><span class="ident" id="1380105">p</span>&nbsp;<span class="op" id="1380107">[</span><span class="op" id="1380108">]</span><span class="builtintype" id="1380109">byte</span><span class="op" id="1380113">,</span>&nbsp;<span class="ident" id="1380115">off</span>&nbsp;<span class="ident" id="1380119">int64</span><span class="op" id="1380124">)</span>&nbsp;<span class="op" id="1380126">(</span><span class="ident" id="1380127">n</span>&nbsp;<span class="builtintype" id="1380129">int</span><span class="op" id="1380132">,</span>&nbsp;<span class="ident" id="1380134">err</span>&nbsp;<span class="builtintype" id="1380138">error</span><span class="op" id="1380143">)</span>&nbsp;<span class="op" id="1380145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380148">if</span>&nbsp;<span class="ident" id="1380151">off</span>&nbsp;<span class="op" id="1380155">&lt;</span>&nbsp;<span class="num" id="1380157">0</span>&nbsp;<span class="op" id="1380159">||</span>&nbsp;<span class="ident" id="1380162">off</span>&nbsp;<span class="op" id="1380166">&gt;=</span>&nbsp;<span class="ident" id="1380169">s</span><span class="op" id="1380170">.</span><span class="ident" id="1380171">limit</span><span class="op" id="1380176">-</span><span class="ident" id="1380177">s</span><span class="op" id="1380178">.</span><span class="ident" id="1380179">base</span>&nbsp;<span class="op" id="1380184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380188">return</span>&nbsp;<span class="num" id="1380195">0</span><span class="op" id="1380196">,</span>&nbsp;<span class="ident" id="1380198">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1380203">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380206">off</span>&nbsp;<span class="op" id="1380210">+=</span>&nbsp;<span class="ident" id="1380213">s</span><span class="op" id="1380214">.</span><span class="ident" id="1380215">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380221">if</span>&nbsp;<span class="ident" id="1380224">max</span>&nbsp;<span class="op" id="1380228">:=</span>&nbsp;<span class="ident" id="1380231">s</span><span class="op" id="1380232">.</span><span class="ident" id="1380233">limit</span>&nbsp;<span class="op" id="1380239">-</span>&nbsp;<span class="ident" id="1380241">off</span><span class="op" id="1380244">;</span>&nbsp;<span class="ident" id="1380246">int64</span><span class="op" id="1380251">(</span><span class="builtinfunc" id="1380252">len</span><span class="op" id="1380255">(</span><span class="ident" id="1380256">p</span><span class="op" id="1380257">)</span><span class="op" id="1380258">)</span>&nbsp;<span class="op" id="1380260">&gt;</span>&nbsp;<span class="ident" id="1380262">max</span>&nbsp;<span class="op" id="1380266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380270">p</span>&nbsp;<span class="op" id="1380272">=</span>&nbsp;<span class="ident" id="1380274">p</span><span class="op" id="1380275">[</span><span class="num" id="1380276">0</span><span class="op" id="1380277">:</span><span class="ident" id="1380278">max</span><span class="op" id="1380281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380285">n</span><span class="op" id="1380286">,</span>&nbsp;<span class="ident" id="1380288">err</span>&nbsp;<span class="op" id="1380292">=</span>&nbsp;<span class="ident" id="1380294">s</span><span class="op" id="1380295">.</span><span class="ident" id="1380296">r</span><span class="op" id="1380297">.</span><span class="ident" id="1380298">ReadAt</span><span class="op" id="1380304">(</span><span class="ident" id="1380305">p</span><span class="op" id="1380306">,</span>&nbsp;<span class="ident" id="1380308">off</span><span class="op" id="1380311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380315">if</span>&nbsp;<span class="ident" id="1380318">err</span>&nbsp;<span class="op" id="1380322">==</span>&nbsp;<span class="ident" id="1380325">nil</span>&nbsp;<span class="op" id="1380329">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380334">err</span>&nbsp;<span class="op" id="1380338">=</span>&nbsp;<span class="ident" id="1380340">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1380346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380350">return</span>&nbsp;<span class="ident" id="1380357">n</span><span class="op" id="1380358">,</span>&nbsp;<span class="ident" id="1380360">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1380365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380368">return</span>&nbsp;<span class="ident" id="1380375">s</span><span class="op" id="1380376">.</span><span class="ident" id="1380377">r</span><span class="op" id="1380378">.</span><span class="ident" id="1380379">ReadAt</span><span class="op" id="1380385">(</span><span class="ident" id="1380386">p</span><span class="op" id="1380387">,</span>&nbsp;<span class="ident" id="1380389">off</span><span class="op" id="1380392">)</span><br>
<span class="lineno">475</span><span class="op" id="1380394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1380397">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1380447">func</span>&nbsp;<span class="op" id="1380452">(</span><span class="ident" id="1380453">s</span>&nbsp;<span class="op" id="1380455">*</span><span class="ident" id="1380456">SectionReader</span><span class="op" id="1380469">)</span>&nbsp;<span class="ident" id="1380471">Size</span><span class="op" id="1380475">(</span><span class="op" id="1380476">)</span>&nbsp;<span class="ident" id="1380478">int64</span>&nbsp;<span class="op" id="1380484">{</span>&nbsp;<span class="keyword" id="1380486">return</span>&nbsp;<span class="ident" id="1380493">s</span><span class="op" id="1380494">.</span><span class="ident" id="1380495">limit</span>&nbsp;<span class="op" id="1380501">-</span>&nbsp;<span class="ident" id="1380503">s</span><span class="op" id="1380504">.</span><span class="ident" id="1380505">base</span>&nbsp;<span class="op" id="1380510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1380513">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1380582">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1380640">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1380704">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1380758">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1380826">func</span>&nbsp;<span class="ident" id="1380831">TeeReader</span><span class="op" id="1380840">(</span><span class="ident" id="1380841">r</span>&nbsp;<span class="ident" id="1380843">Reader</span><span class="op" id="1380849">,</span>&nbsp;<span class="ident" id="1380851">w</span>&nbsp;<span class="ident" id="1380853">Writer</span><span class="op" id="1380859">)</span>&nbsp;<span class="ident" id="1380861">Reader</span>&nbsp;<span class="op" id="1380868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1380871">return</span>&nbsp;<span class="op" id="1380878">&amp;</span><span class="ident" id="1380879">teeReader</span><span class="op" id="1380888">{</span><span class="ident" id="1380889">r</span><span class="op" id="1380890">,</span>&nbsp;<span class="ident" id="1380892">w</span><span class="op" id="1380893">}</span><br>
<span class="lineno"></span><span class="op" id="1380895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1380898">type</span>&nbsp;<span class="ident" id="1380903">teeReader</span>&nbsp;<span class="keyword" id="1380913">struct</span>&nbsp;<span class="op" id="1380920">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380923">r</span>&nbsp;<span class="ident" id="1380925">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1380933">w</span>&nbsp;<span class="ident" id="1380935">Writer</span><br>
<span class="lineno"></span><span class="op" id="1380942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1380945">func</span>&nbsp;<span class="op" id="1380950">(</span><span class="ident" id="1380951">t</span>&nbsp;<span class="op" id="1380953">*</span><span class="ident" id="1380954">teeReader</span><span class="op" id="1380963">)</span>&nbsp;<span class="ident" id="1380965">Read</span><span class="op" id="1380969">(</span><span class="ident" id="1380970">p</span>&nbsp;<span class="op" id="1380972">[</span><span class="op" id="1380973">]</span><span class="builtintype" id="1380974">byte</span><span class="op" id="1380978">)</span>&nbsp;<span class="op" id="1380980">(</span><span class="ident" id="1380981">n</span>&nbsp;<span class="builtintype" id="1380983">int</span><span class="op" id="1380986">,</span>&nbsp;<span class="ident" id="1380988">err</span>&nbsp;<span class="builtintype" id="1380992">error</span><span class="op" id="1380997">)</span>&nbsp;<span class="op" id="1380999">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1381002">n</span><span class="op" id="1381003">,</span>&nbsp;<span class="ident" id="1381005">err</span>&nbsp;<span class="op" id="1381009">=</span>&nbsp;<span class="ident" id="1381011">t</span><span class="op" id="1381012">.</span><span class="ident" id="1381013">r</span><span class="op" id="1381014">.</span><span class="ident" id="1381015">Read</span><span class="op" id="1381019">(</span><span class="ident" id="1381020">p</span><span class="op" id="1381021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1381024">if</span>&nbsp;<span class="ident" id="1381027">n</span>&nbsp;<span class="op" id="1381029">&gt;</span>&nbsp;<span class="num" id="1381031">0</span>&nbsp;<span class="op" id="1381033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1381037">if</span>&nbsp;<span class="ident" id="1381040">n</span><span class="op" id="1381041">,</span>&nbsp;<span class="ident" id="1381043">err</span>&nbsp;<span class="op" id="1381047">:=</span>&nbsp;<span class="ident" id="1381050">t</span><span class="op" id="1381051">.</span><span class="ident" id="1381052">w</span><span class="op" id="1381053">.</span><span class="ident" id="1381054">Write</span><span class="op" id="1381059">(</span><span class="ident" id="1381060">p</span><span class="op" id="1381061">[</span><span class="op" id="1381062">:</span><span class="ident" id="1381063">n</span><span class="op" id="1381064">]</span><span class="op" id="1381065">)</span><span class="op" id="1381066">;</span>&nbsp;<span class="ident" id="1381068">err</span>&nbsp;<span class="op" id="1381072">!=</span>&nbsp;<span class="ident" id="1381075">nil</span>&nbsp;<span class="op" id="1381079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1381084">return</span>&nbsp;<span class="ident" id="1381091">n</span><span class="op" id="1381092">,</span>&nbsp;<span class="ident" id="1381094">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1381100">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1381103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1381106">return</span><br>
<span class="lineno"></span><span class="op" id="1381113">}</span>
</div>
</body>
</html>
