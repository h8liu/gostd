<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4674497">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4674552">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4674606">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4674657">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4674716">package</span>&nbsp;<span class="ident" id="4674724">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674732">import</span>&nbsp;<span class="op" id="4674739">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4674742">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4674750">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4674756">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4674766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4674769">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="4674849">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4674861">type</span>&nbsp;<span class="ident" id="4674866">Hash</span>&nbsp;<span class="builtintype" id="4674871">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4674877">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4674955">func</span>&nbsp;<span class="op" id="4674960">(</span><span class="ident" id="4674961">h</span>&nbsp;<span class="ident" id="4674963">Hash</span><span class="op" id="4674967">)</span>&nbsp;<span class="ident" id="4674969">HashFunc</span><span class="op" id="4674977">(</span><span class="op" id="4674978">)</span>&nbsp;<span class="ident" id="4674980">Hash</span>&nbsp;<span class="op" id="4674985">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674988">return</span>&nbsp;<span class="ident" id="4674995">h</span><br>
<span class="lineno"></span><span class="op" id="4674997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675000">const</span>&nbsp;<span class="op" id="4675006">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675009">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675019">Hash</span>&nbsp;<span class="op" id="4675024">=</span>&nbsp;<span class="num" id="4675026">1</span>&nbsp;<span class="op" id="4675028">+</span>&nbsp;<span class="ident" id="4675030">iota</span>&nbsp;<span class="comment" id="4675035">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675070">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675096">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675118">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675144">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675167">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675193">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675218">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675244">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675269">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675295">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675320">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675346">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675371">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675397">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675446">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675472">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675513">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675539">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675575">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675601">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675637">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675663">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675699">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675725">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675761">maxHash</span><br>
<span class="lineno"></span><span class="op" id="4675769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4675772">var</span>&nbsp;<span class="ident" id="4675776">digestSizes</span>&nbsp;<span class="op" id="4675788">=</span>&nbsp;<span class="op" id="4675790">[</span><span class="op" id="4675791">]</span><span class="builtintype" id="4675792">uint8</span><span class="op" id="4675797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675800">MD4</span><span class="op" id="4675803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675811">16</span><span class="op" id="4675813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675816">MD5</span><span class="op" id="4675819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675827">16</span><span class="op" id="4675829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675832">SHA1</span><span class="op" id="4675836">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675843">20</span><span class="op" id="4675845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675848">SHA224</span><span class="op" id="4675854">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675859">28</span><span class="op" id="4675861">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675864">SHA256</span><span class="op" id="4675870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675875">32</span><span class="op" id="4675877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675880">SHA384</span><span class="op" id="4675886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675891">48</span><span class="op" id="4675893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675896">SHA512</span><span class="op" id="4675902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4675907">64</span><span class="op" id="4675909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675912">SHA3_224</span><span class="op" id="4675920">:</span>&nbsp;&nbsp;<span class="num" id="4675923">28</span><span class="op" id="4675925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675928">SHA3_256</span><span class="op" id="4675936">:</span>&nbsp;&nbsp;<span class="num" id="4675939">32</span><span class="op" id="4675941">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675944">SHA3_384</span><span class="op" id="4675952">:</span>&nbsp;&nbsp;<span class="num" id="4675955">48</span><span class="op" id="4675957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675960">SHA3_512</span><span class="op" id="4675968">:</span>&nbsp;&nbsp;<span class="num" id="4675971">64</span><span class="op" id="4675973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675976">MD5SHA1</span><span class="op" id="4675983">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4675987">36</span><span class="op" id="4675989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675992">RIPEMD160</span><span class="op" id="4676001">:</span>&nbsp;<span class="num" id="4676003">20</span><span class="op" id="4676005">,</span><br>
<span class="lineno"></span><span class="op" id="4676007">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4676010">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4676090">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="4676167">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="4676188">func</span>&nbsp;<span class="op" id="4676193">(</span><span class="ident" id="4676194">h</span>&nbsp;<span class="ident" id="4676196">Hash</span><span class="op" id="4676200">)</span>&nbsp;<span class="ident" id="4676202">Size</span><span class="op" id="4676206">(</span><span class="op" id="4676207">)</span>&nbsp;<span class="builtintype" id="4676209">int</span>&nbsp;<span class="op" id="4676213">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676216">if</span>&nbsp;<span class="ident" id="4676219">h</span>&nbsp;<span class="op" id="4676221">&gt;</span>&nbsp;<span class="num" id="4676223">0</span>&nbsp;<span class="op" id="4676225">&amp;&amp;</span>&nbsp;<span class="ident" id="4676228">h</span>&nbsp;<span class="op" id="4676230">&lt;</span>&nbsp;<span class="ident" id="4676232">maxHash</span>&nbsp;<span class="op" id="4676240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676244">return</span>&nbsp;<span class="builtintype" id="4676251">int</span><span class="op" id="4676254">(</span><span class="ident" id="4676255">digestSizes</span><span class="op" id="4676266">[</span><span class="ident" id="4676267">h</span><span class="op" id="4676268">]</span><span class="op" id="4676269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4676275">panic</span><span class="op" id="4676280">(</span><span class="string" id="4676281">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4676320">)</span><br>
<span class="lineno"></span><span class="op" id="4676322">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4676325">var</span>&nbsp;<span class="ident" id="4676329">hashes</span>&nbsp;<span class="op" id="4676336">=</span>&nbsp;<span class="builtinfunc" id="4676338">make</span><span class="op" id="4676342">(</span><span class="op" id="4676343">[</span><span class="op" id="4676344">]</span><span class="keyword" id="4676345">func</span><span class="op" id="4676349">(</span><span class="op" id="4676350">)</span>&nbsp;<span class="ident" id="4676352">hash</span><span class="op" id="4676356">.</span><span class="ident" id="4676357">Hash</span><span class="op" id="4676361">,</span>&nbsp;<span class="ident" id="4676363">maxHash</span><span class="op" id="4676370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4676373">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="4676452">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="4676507">func</span>&nbsp;<span class="op" id="4676512">(</span><span class="ident" id="4676513">h</span>&nbsp;<span class="ident" id="4676515">Hash</span><span class="op" id="4676519">)</span>&nbsp;<span class="ident" id="4676521">New</span><span class="op" id="4676524">(</span><span class="op" id="4676525">)</span>&nbsp;<span class="ident" id="4676527">hash</span><span class="op" id="4676531">.</span><span class="ident" id="4676532">Hash</span>&nbsp;<span class="op" id="4676537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676540">if</span>&nbsp;<span class="ident" id="4676543">h</span>&nbsp;<span class="op" id="4676545">&gt;</span>&nbsp;<span class="num" id="4676547">0</span>&nbsp;<span class="op" id="4676549">&amp;&amp;</span>&nbsp;<span class="ident" id="4676552">h</span>&nbsp;<span class="op" id="4676554">&lt;</span>&nbsp;<span class="ident" id="4676556">maxHash</span>&nbsp;<span class="op" id="4676564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676568">f</span>&nbsp;<span class="op" id="4676570">:=</span>&nbsp;<span class="ident" id="4676573">hashes</span><span class="op" id="4676579">[</span><span class="ident" id="4676580">h</span><span class="op" id="4676581">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676585">if</span>&nbsp;<span class="ident" id="4676588">f</span>&nbsp;<span class="op" id="4676590">!=</span>&nbsp;<span class="ident" id="4676593">nil</span>&nbsp;<span class="op" id="4676597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676602">return</span>&nbsp;<span class="ident" id="4676609">f</span><span class="op" id="4676610">(</span><span class="op" id="4676611">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4676621">panic</span><span class="op" id="4676626">(</span><span class="string" id="4676627">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="4676663">+</span>&nbsp;<span class="ident" id="4676665">strconv</span><span class="op" id="4676672">.</span><span class="ident" id="4676673">Itoa</span><span class="op" id="4676677">(</span><span class="builtintype" id="4676678">int</span><span class="op" id="4676681">(</span><span class="ident" id="4676682">h</span><span class="op" id="4676683">)</span><span class="op" id="4676684">)</span>&nbsp;<span class="op" id="4676686">+</span>&nbsp;<span class="string" id="4676688">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="4676705">)</span><br>
<span class="lineno"></span><span class="op" id="4676707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4676710">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4676790">func</span>&nbsp;<span class="op" id="4676795">(</span><span class="ident" id="4676796">h</span>&nbsp;<span class="ident" id="4676798">Hash</span><span class="op" id="4676802">)</span>&nbsp;<span class="ident" id="4676804">Available</span><span class="op" id="4676813">(</span><span class="op" id="4676814">)</span>&nbsp;<span class="builtintype" id="4676816">bool</span>&nbsp;<span class="op" id="4676821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676824">return</span>&nbsp;<span class="ident" id="4676831">h</span>&nbsp;<span class="op" id="4676833">&lt;</span>&nbsp;<span class="ident" id="4676835">maxHash</span>&nbsp;<span class="op" id="4676843">&amp;&amp;</span>&nbsp;<span class="ident" id="4676846">hashes</span><span class="op" id="4676852">[</span><span class="ident" id="4676853">h</span><span class="op" id="4676854">]</span>&nbsp;<span class="op" id="4676856">!=</span>&nbsp;<span class="ident" id="4676859">nil</span><br>
<span class="lineno"></span><span class="op" id="4676863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4676866">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4676944">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4677018">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="4677061">func</span>&nbsp;<span class="ident" id="4677066">RegisterHash</span><span class="op" id="4677078">(</span><span class="ident" id="4677079">h</span>&nbsp;<span class="ident" id="4677081">Hash</span><span class="op" id="4677085">,</span>&nbsp;<span class="ident" id="4677087">f</span>&nbsp;<span class="keyword" id="4677089">func</span><span class="op" id="4677093">(</span><span class="op" id="4677094">)</span>&nbsp;<span class="ident" id="4677096">hash</span><span class="op" id="4677100">.</span><span class="ident" id="4677101">Hash</span><span class="op" id="4677105">)</span>&nbsp;<span class="op" id="4677107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677110">if</span>&nbsp;<span class="ident" id="4677113">h</span>&nbsp;<span class="op" id="4677115">&gt;=</span>&nbsp;<span class="ident" id="4677118">maxHash</span>&nbsp;<span class="op" id="4677126">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4677130">panic</span><span class="op" id="4677135">(</span><span class="string" id="4677136">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4677183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677189">hashes</span><span class="op" id="4677195">[</span><span class="ident" id="4677196">h</span><span class="op" id="4677197">]</span>&nbsp;<span class="op" id="4677199">=</span>&nbsp;<span class="ident" id="4677201">f</span><br>
<span class="lineno"></span><span class="op" id="4677203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4677206">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4677275">type</span>&nbsp;<span class="ident" id="4677280">PublicKey</span>&nbsp;<span class="keyword" id="4677290">interface</span><span class="op" id="4677299">{</span><span class="op" id="4677300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4677303">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4677374">type</span>&nbsp;<span class="ident" id="4677379">PrivateKey</span>&nbsp;<span class="keyword" id="4677390">interface</span><span class="op" id="4677399">{</span><span class="op" id="4677400">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4677403">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4677476">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="4677550">type</span>&nbsp;<span class="ident" id="4677555">Signer</span>&nbsp;<span class="keyword" id="4677562">interface</span>&nbsp;<span class="op" id="4677572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677575">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677638">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677655">Public</span><span class="op" id="4677661">(</span><span class="op" id="4677662">)</span>&nbsp;<span class="ident" id="4677664">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677676">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677745">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677814">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677886">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677953">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4677957">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678030">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678103">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678171">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678243">Sign</span><span class="op" id="4678247">(</span><span class="ident" id="4678248">rand</span>&nbsp;<span class="ident" id="4678253">io</span><span class="op" id="4678255">.</span><span class="ident" id="4678256">Reader</span><span class="op" id="4678262">,</span>&nbsp;<span class="ident" id="4678264">msg</span>&nbsp;<span class="op" id="4678268">[</span><span class="op" id="4678269">]</span><span class="builtintype" id="4678270">byte</span><span class="op" id="4678274">,</span>&nbsp;<span class="ident" id="4678276">opts</span>&nbsp;<span class="ident" id="4678281">SignerOpts</span><span class="op" id="4678291">)</span>&nbsp;<span class="op" id="4678293">(</span><span class="ident" id="4678294">signature</span>&nbsp;<span class="op" id="4678304">[</span><span class="op" id="4678305">]</span><span class="builtintype" id="4678306">byte</span><span class="op" id="4678310">,</span>&nbsp;<span class="ident" id="4678312">err</span>&nbsp;<span class="builtintype" id="4678316">error</span><span class="op" id="4678321">)</span><br>
<span class="lineno"></span><span class="op" id="4678323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4678326">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="4678384">type</span>&nbsp;<span class="ident" id="4678389">SignerOpts</span>&nbsp;<span class="keyword" id="4678400">interface</span>&nbsp;<span class="op" id="4678410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678413">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678486">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4678558">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678580">HashFunc</span><span class="op" id="4678588">(</span><span class="op" id="4678589">)</span>&nbsp;<span class="ident" id="4678591">Hash</span><br>
<span class="lineno"></span><span class="op" id="4678596">}</span>
</div>
</body>
</html>
