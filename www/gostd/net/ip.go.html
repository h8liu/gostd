<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3645438">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3645493">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3645547">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3645598">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3645626">//</span><br>
<span class="lineno"></span><span class="comment" id="3645629">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3645689">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3645747">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3645797">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3645858">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3645889">package</span>&nbsp;<span class="ident" id="3645897">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3645902">import</span>&nbsp;<span class="string" id="3645909">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3645919">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3645950">const</span>&nbsp;<span class="op" id="3645956">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645959">IPv4len</span>&nbsp;<span class="op" id="3645967">=</span>&nbsp;<span class="num" id="3645969">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645972">IPv6len</span>&nbsp;<span class="op" id="3645980">=</span>&nbsp;<span class="num" id="3645982">16</span><br>
<span class="lineno"></span><span class="op" id="3645985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3645988">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3646039">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3646096">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3646134">//</span><br>
<span class="lineno"></span><span class="comment" id="3646137">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3646189">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3646241">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3646296">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3646351">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3646374">type</span>&nbsp;<span class="ident" id="3646379">IP</span>&nbsp;<span class="op" id="3646382">[</span><span class="op" id="3646383">]</span><span class="builtintype" id="3646384">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3646390">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3646422">type</span>&nbsp;<span class="ident" id="3646427">IPMask</span>&nbsp;<span class="op" id="3646434">[</span><span class="op" id="3646435">]</span><span class="builtintype" id="3646436">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3646442">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3646480">type</span>&nbsp;<span class="ident" id="3646485">IPNet</span>&nbsp;<span class="keyword" id="3646491">struct</span>&nbsp;<span class="op" id="3646498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646501">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3646506">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646513">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646532">Mask</span>&nbsp;<span class="ident" id="3646537">IPMask</span>&nbsp;<span class="comment" id="3646544">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3646560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3646563">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3646619">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3646644">func</span>&nbsp;<span class="ident" id="3646649">IPv4</span><span class="op" id="3646653">(</span><span class="ident" id="3646654">a</span><span class="op" id="3646655">,</span>&nbsp;<span class="ident" id="3646657">b</span><span class="op" id="3646658">,</span>&nbsp;<span class="ident" id="3646660">c</span><span class="op" id="3646661">,</span>&nbsp;<span class="ident" id="3646663">d</span>&nbsp;<span class="builtintype" id="3646665">byte</span><span class="op" id="3646669">)</span>&nbsp;<span class="ident" id="3646671">IP</span>&nbsp;<span class="op" id="3646674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646677">p</span>&nbsp;<span class="op" id="3646679">:=</span>&nbsp;<span class="builtinfunc" id="3646682">make</span><span class="op" id="3646686">(</span><span class="ident" id="3646687">IP</span><span class="op" id="3646689">,</span>&nbsp;<span class="ident" id="3646691">IPv6len</span><span class="op" id="3646698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3646701">copy</span><span class="op" id="3646705">(</span><span class="ident" id="3646706">p</span><span class="op" id="3646707">,</span>&nbsp;<span class="ident" id="3646709">v4InV6Prefix</span><span class="op" id="3646721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646724">p</span><span class="op" id="3646725">[</span><span class="num" id="3646726">12</span><span class="op" id="3646728">]</span>&nbsp;<span class="op" id="3646730">=</span>&nbsp;<span class="ident" id="3646732">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646735">p</span><span class="op" id="3646736">[</span><span class="num" id="3646737">13</span><span class="op" id="3646739">]</span>&nbsp;<span class="op" id="3646741">=</span>&nbsp;<span class="ident" id="3646743">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646746">p</span><span class="op" id="3646747">[</span><span class="num" id="3646748">14</span><span class="op" id="3646750">]</span>&nbsp;<span class="op" id="3646752">=</span>&nbsp;<span class="ident" id="3646754">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646757">p</span><span class="op" id="3646758">[</span><span class="num" id="3646759">15</span><span class="op" id="3646761">]</span>&nbsp;<span class="op" id="3646763">=</span>&nbsp;<span class="ident" id="3646765">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646768">return</span>&nbsp;<span class="ident" id="3646775">p</span><br>
<span class="lineno"></span><span class="op" id="3646777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3646780">var</span>&nbsp;<span class="ident" id="3646784">v4InV6Prefix</span>&nbsp;<span class="op" id="3646797">=</span>&nbsp;<span class="op" id="3646799">[</span><span class="op" id="3646800">]</span><span class="builtintype" id="3646801">byte</span><span class="op" id="3646805">{</span><span class="num" id="3646806">0</span><span class="op" id="3646807">,</span>&nbsp;<span class="num" id="3646809">0</span><span class="op" id="3646810">,</span>&nbsp;<span class="num" id="3646812">0</span><span class="op" id="3646813">,</span>&nbsp;<span class="num" id="3646815">0</span><span class="op" id="3646816">,</span>&nbsp;<span class="num" id="3646818">0</span><span class="op" id="3646819">,</span>&nbsp;<span class="num" id="3646821">0</span><span class="op" id="3646822">,</span>&nbsp;<span class="num" id="3646824">0</span><span class="op" id="3646825">,</span>&nbsp;<span class="num" id="3646827">0</span><span class="op" id="3646828">,</span>&nbsp;<span class="num" id="3646830">0</span><span class="op" id="3646831">,</span>&nbsp;<span class="num" id="3646833">0</span><span class="op" id="3646834">,</span>&nbsp;<span class="num" id="3646836">0xff</span><span class="op" id="3646840">,</span>&nbsp;<span class="num" id="3646842">0xff</span><span class="op" id="3646846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3646849">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3646905">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3646927">func</span>&nbsp;<span class="ident" id="3646932">IPv4Mask</span><span class="op" id="3646940">(</span><span class="ident" id="3646941">a</span><span class="op" id="3646942">,</span>&nbsp;<span class="ident" id="3646944">b</span><span class="op" id="3646945">,</span>&nbsp;<span class="ident" id="3646947">c</span><span class="op" id="3646948">,</span>&nbsp;<span class="ident" id="3646950">d</span>&nbsp;<span class="builtintype" id="3646952">byte</span><span class="op" id="3646956">)</span>&nbsp;<span class="ident" id="3646958">IPMask</span>&nbsp;<span class="op" id="3646965">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646968">p</span>&nbsp;<span class="op" id="3646970">:=</span>&nbsp;<span class="builtinfunc" id="3646973">make</span><span class="op" id="3646977">(</span><span class="ident" id="3646978">IPMask</span><span class="op" id="3646984">,</span>&nbsp;<span class="ident" id="3646986">IPv4len</span><span class="op" id="3646993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646996">p</span><span class="op" id="3646997">[</span><span class="num" id="3646998">0</span><span class="op" id="3646999">]</span>&nbsp;<span class="op" id="3647001">=</span>&nbsp;<span class="ident" id="3647003">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647006">p</span><span class="op" id="3647007">[</span><span class="num" id="3647008">1</span><span class="op" id="3647009">]</span>&nbsp;<span class="op" id="3647011">=</span>&nbsp;<span class="ident" id="3647013">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647016">p</span><span class="op" id="3647017">[</span><span class="num" id="3647018">2</span><span class="op" id="3647019">]</span>&nbsp;<span class="op" id="3647021">=</span>&nbsp;<span class="ident" id="3647023">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647026">p</span><span class="op" id="3647027">[</span><span class="num" id="3647028">3</span><span class="op" id="3647029">]</span>&nbsp;<span class="op" id="3647031">=</span>&nbsp;<span class="ident" id="3647033">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647036">return</span>&nbsp;<span class="ident" id="3647043">p</span><br>
<span class="lineno"></span><span class="op" id="3647045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3647048">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3647106">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3647161">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3647229">func</span>&nbsp;<span class="ident" id="3647234">CIDRMask</span><span class="op" id="3647242">(</span><span class="ident" id="3647243">ones</span><span class="op" id="3647247">,</span>&nbsp;<span class="ident" id="3647249">bits</span>&nbsp;<span class="builtintype" id="3647254">int</span><span class="op" id="3647257">)</span>&nbsp;<span class="ident" id="3647259">IPMask</span>&nbsp;<span class="op" id="3647266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647269">if</span>&nbsp;<span class="ident" id="3647272">bits</span>&nbsp;<span class="op" id="3647277">!=</span>&nbsp;<span class="num" id="3647280">8</span><span class="op" id="3647281">*</span><span class="ident" id="3647282">IPv4len</span>&nbsp;<span class="op" id="3647290">&amp;&amp;</span>&nbsp;<span class="ident" id="3647293">bits</span>&nbsp;<span class="op" id="3647298">!=</span>&nbsp;<span class="num" id="3647301">8</span><span class="op" id="3647302">*</span><span class="ident" id="3647303">IPv6len</span>&nbsp;<span class="op" id="3647311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647315">return</span>&nbsp;<span class="ident" id="3647322">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647327">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647330">if</span>&nbsp;<span class="ident" id="3647333">ones</span>&nbsp;<span class="op" id="3647338">&lt;</span>&nbsp;<span class="num" id="3647340">0</span>&nbsp;<span class="op" id="3647342">||</span>&nbsp;<span class="ident" id="3647345">ones</span>&nbsp;<span class="op" id="3647350">&gt;</span>&nbsp;<span class="ident" id="3647352">bits</span>&nbsp;<span class="op" id="3647357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647361">return</span>&nbsp;<span class="ident" id="3647368">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647376">l</span>&nbsp;<span class="op" id="3647378">:=</span>&nbsp;<span class="ident" id="3647381">bits</span>&nbsp;<span class="op" id="3647386">/</span>&nbsp;<span class="num" id="3647388">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647391">m</span>&nbsp;<span class="op" id="3647393">:=</span>&nbsp;<span class="builtinfunc" id="3647396">make</span><span class="op" id="3647400">(</span><span class="ident" id="3647401">IPMask</span><span class="op" id="3647407">,</span>&nbsp;<span class="ident" id="3647409">l</span><span class="op" id="3647410">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647413">n</span>&nbsp;<span class="op" id="3647415">:=</span>&nbsp;<span class="builtintype" id="3647418">uint</span><span class="op" id="3647422">(</span><span class="ident" id="3647423">ones</span><span class="op" id="3647427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647430">for</span>&nbsp;<span class="ident" id="3647434">i</span>&nbsp;<span class="op" id="3647436">:=</span>&nbsp;<span class="num" id="3647439">0</span><span class="op" id="3647440">;</span>&nbsp;<span class="ident" id="3647442">i</span>&nbsp;<span class="op" id="3647444">&lt;</span>&nbsp;<span class="ident" id="3647446">l</span><span class="op" id="3647447">;</span>&nbsp;<span class="ident" id="3647449">i</span><span class="op" id="3647450">++</span>&nbsp;<span class="op" id="3647453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647457">if</span>&nbsp;<span class="ident" id="3647460">n</span>&nbsp;<span class="op" id="3647462">&gt;=</span>&nbsp;<span class="num" id="3647465">8</span>&nbsp;<span class="op" id="3647467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647472">m</span><span class="op" id="3647473">[</span><span class="ident" id="3647474">i</span><span class="op" id="3647475">]</span>&nbsp;<span class="op" id="3647477">=</span>&nbsp;<span class="num" id="3647479">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647487">n</span>&nbsp;<span class="op" id="3647489">-=</span>&nbsp;<span class="num" id="3647492">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647497">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647512">m</span><span class="op" id="3647513">[</span><span class="ident" id="3647514">i</span><span class="op" id="3647515">]</span>&nbsp;<span class="op" id="3647517">=</span>&nbsp;<span class="op" id="3647519">^</span><span class="builtintype" id="3647520">byte</span><span class="op" id="3647524">(</span><span class="num" id="3647525">0xff</span>&nbsp;<span class="op" id="3647530">&gt;&gt;</span>&nbsp;<span class="ident" id="3647533">n</span><span class="op" id="3647534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647538">n</span>&nbsp;<span class="op" id="3647540">=</span>&nbsp;<span class="num" id="3647542">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647545">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647548">return</span>&nbsp;<span class="ident" id="3647555">m</span><br>
<span class="lineno"></span><span class="op" id="3647557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3647560">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3647589">var</span>&nbsp;<span class="op" id="3647593">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647596">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647610">=</span>&nbsp;<span class="ident" id="3647612">IPv4</span><span class="op" id="3647616">(</span><span class="num" id="3647617">255</span><span class="op" id="3647620">,</span>&nbsp;<span class="num" id="3647622">255</span><span class="op" id="3647625">,</span>&nbsp;<span class="num" id="3647627">255</span><span class="op" id="3647630">,</span>&nbsp;<span class="num" id="3647632">255</span><span class="op" id="3647635">)</span>&nbsp;<span class="comment" id="3647637">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647651">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647665">=</span>&nbsp;<span class="ident" id="3647667">IPv4</span><span class="op" id="3647671">(</span><span class="num" id="3647672">224</span><span class="op" id="3647675">,</span>&nbsp;<span class="num" id="3647677">0</span><span class="op" id="3647678">,</span>&nbsp;<span class="num" id="3647680">0</span><span class="op" id="3647681">,</span>&nbsp;<span class="num" id="3647683">1</span><span class="op" id="3647684">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647692">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647708">IPv4allrouter</span>&nbsp;<span class="op" id="3647722">=</span>&nbsp;<span class="ident" id="3647724">IPv4</span><span class="op" id="3647728">(</span><span class="num" id="3647729">224</span><span class="op" id="3647732">,</span>&nbsp;<span class="num" id="3647734">0</span><span class="op" id="3647735">,</span>&nbsp;<span class="num" id="3647737">0</span><span class="op" id="3647738">,</span>&nbsp;<span class="num" id="3647740">2</span><span class="op" id="3647741">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647749">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647765">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647779">=</span>&nbsp;<span class="ident" id="3647781">IPv4</span><span class="op" id="3647785">(</span><span class="num" id="3647786">0</span><span class="op" id="3647787">,</span>&nbsp;<span class="num" id="3647789">0</span><span class="op" id="3647790">,</span>&nbsp;<span class="num" id="3647792">0</span><span class="op" id="3647793">,</span>&nbsp;<span class="num" id="3647795">0</span><span class="op" id="3647796">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647806">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3647819">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3647822">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3647851">var</span>&nbsp;<span class="op" id="3647855">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647858">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647885">=</span>&nbsp;<span class="ident" id="3647887">IP</span><span class="op" id="3647889">{</span><span class="num" id="3647890">0</span><span class="op" id="3647891">,</span>&nbsp;<span class="num" id="3647893">0</span><span class="op" id="3647894">,</span>&nbsp;<span class="num" id="3647896">0</span><span class="op" id="3647897">,</span>&nbsp;<span class="num" id="3647899">0</span><span class="op" id="3647900">,</span>&nbsp;<span class="num" id="3647902">0</span><span class="op" id="3647903">,</span>&nbsp;<span class="num" id="3647905">0</span><span class="op" id="3647906">,</span>&nbsp;<span class="num" id="3647908">0</span><span class="op" id="3647909">,</span>&nbsp;<span class="num" id="3647911">0</span><span class="op" id="3647912">,</span>&nbsp;<span class="num" id="3647914">0</span><span class="op" id="3647915">,</span>&nbsp;<span class="num" id="3647917">0</span><span class="op" id="3647918">,</span>&nbsp;<span class="num" id="3647920">0</span><span class="op" id="3647921">,</span>&nbsp;<span class="num" id="3647923">0</span><span class="op" id="3647924">,</span>&nbsp;<span class="num" id="3647926">0</span><span class="op" id="3647927">,</span>&nbsp;<span class="num" id="3647929">0</span><span class="op" id="3647930">,</span>&nbsp;<span class="num" id="3647932">0</span><span class="op" id="3647933">,</span>&nbsp;<span class="num" id="3647935">0</span><span class="op" id="3647936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647939">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647966">=</span>&nbsp;<span class="ident" id="3647968">IP</span><span class="op" id="3647970">{</span><span class="num" id="3647971">0</span><span class="op" id="3647972">,</span>&nbsp;<span class="num" id="3647974">0</span><span class="op" id="3647975">,</span>&nbsp;<span class="num" id="3647977">0</span><span class="op" id="3647978">,</span>&nbsp;<span class="num" id="3647980">0</span><span class="op" id="3647981">,</span>&nbsp;<span class="num" id="3647983">0</span><span class="op" id="3647984">,</span>&nbsp;<span class="num" id="3647986">0</span><span class="op" id="3647987">,</span>&nbsp;<span class="num" id="3647989">0</span><span class="op" id="3647990">,</span>&nbsp;<span class="num" id="3647992">0</span><span class="op" id="3647993">,</span>&nbsp;<span class="num" id="3647995">0</span><span class="op" id="3647996">,</span>&nbsp;<span class="num" id="3647998">0</span><span class="op" id="3647999">,</span>&nbsp;<span class="num" id="3648001">0</span><span class="op" id="3648002">,</span>&nbsp;<span class="num" id="3648004">0</span><span class="op" id="3648005">,</span>&nbsp;<span class="num" id="3648007">0</span><span class="op" id="3648008">,</span>&nbsp;<span class="num" id="3648010">0</span><span class="op" id="3648011">,</span>&nbsp;<span class="num" id="3648013">0</span><span class="op" id="3648014">,</span>&nbsp;<span class="num" id="3648016">0</span><span class="op" id="3648017">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648020">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648047">=</span>&nbsp;<span class="ident" id="3648049">IP</span><span class="op" id="3648051">{</span><span class="num" id="3648052">0</span><span class="op" id="3648053">,</span>&nbsp;<span class="num" id="3648055">0</span><span class="op" id="3648056">,</span>&nbsp;<span class="num" id="3648058">0</span><span class="op" id="3648059">,</span>&nbsp;<span class="num" id="3648061">0</span><span class="op" id="3648062">,</span>&nbsp;<span class="num" id="3648064">0</span><span class="op" id="3648065">,</span>&nbsp;<span class="num" id="3648067">0</span><span class="op" id="3648068">,</span>&nbsp;<span class="num" id="3648070">0</span><span class="op" id="3648071">,</span>&nbsp;<span class="num" id="3648073">0</span><span class="op" id="3648074">,</span>&nbsp;<span class="num" id="3648076">0</span><span class="op" id="3648077">,</span>&nbsp;<span class="num" id="3648079">0</span><span class="op" id="3648080">,</span>&nbsp;<span class="num" id="3648082">0</span><span class="op" id="3648083">,</span>&nbsp;<span class="num" id="3648085">0</span><span class="op" id="3648086">,</span>&nbsp;<span class="num" id="3648088">0</span><span class="op" id="3648089">,</span>&nbsp;<span class="num" id="3648091">0</span><span class="op" id="3648092">,</span>&nbsp;<span class="num" id="3648094">0</span><span class="op" id="3648095">,</span>&nbsp;<span class="num" id="3648097">1</span><span class="op" id="3648098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648101">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3648128">=</span>&nbsp;<span class="ident" id="3648130">IP</span><span class="op" id="3648132">{</span><span class="num" id="3648133">0xff</span><span class="op" id="3648137">,</span>&nbsp;<span class="num" id="3648139">0x01</span><span class="op" id="3648143">,</span>&nbsp;<span class="num" id="3648145">0</span><span class="op" id="3648146">,</span>&nbsp;<span class="num" id="3648148">0</span><span class="op" id="3648149">,</span>&nbsp;<span class="num" id="3648151">0</span><span class="op" id="3648152">,</span>&nbsp;<span class="num" id="3648154">0</span><span class="op" id="3648155">,</span>&nbsp;<span class="num" id="3648157">0</span><span class="op" id="3648158">,</span>&nbsp;<span class="num" id="3648160">0</span><span class="op" id="3648161">,</span>&nbsp;<span class="num" id="3648163">0</span><span class="op" id="3648164">,</span>&nbsp;<span class="num" id="3648166">0</span><span class="op" id="3648167">,</span>&nbsp;<span class="num" id="3648169">0</span><span class="op" id="3648170">,</span>&nbsp;<span class="num" id="3648172">0</span><span class="op" id="3648173">,</span>&nbsp;<span class="num" id="3648175">0</span><span class="op" id="3648176">,</span>&nbsp;<span class="num" id="3648178">0</span><span class="op" id="3648179">,</span>&nbsp;<span class="num" id="3648181">0</span><span class="op" id="3648182">,</span>&nbsp;<span class="num" id="3648184">0x01</span><span class="op" id="3648188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648191">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648218">=</span>&nbsp;<span class="ident" id="3648220">IP</span><span class="op" id="3648222">{</span><span class="num" id="3648223">0xff</span><span class="op" id="3648227">,</span>&nbsp;<span class="num" id="3648229">0x02</span><span class="op" id="3648233">,</span>&nbsp;<span class="num" id="3648235">0</span><span class="op" id="3648236">,</span>&nbsp;<span class="num" id="3648238">0</span><span class="op" id="3648239">,</span>&nbsp;<span class="num" id="3648241">0</span><span class="op" id="3648242">,</span>&nbsp;<span class="num" id="3648244">0</span><span class="op" id="3648245">,</span>&nbsp;<span class="num" id="3648247">0</span><span class="op" id="3648248">,</span>&nbsp;<span class="num" id="3648250">0</span><span class="op" id="3648251">,</span>&nbsp;<span class="num" id="3648253">0</span><span class="op" id="3648254">,</span>&nbsp;<span class="num" id="3648256">0</span><span class="op" id="3648257">,</span>&nbsp;<span class="num" id="3648259">0</span><span class="op" id="3648260">,</span>&nbsp;<span class="num" id="3648262">0</span><span class="op" id="3648263">,</span>&nbsp;<span class="num" id="3648265">0</span><span class="op" id="3648266">,</span>&nbsp;<span class="num" id="3648268">0</span><span class="op" id="3648269">,</span>&nbsp;<span class="num" id="3648271">0</span><span class="op" id="3648272">,</span>&nbsp;<span class="num" id="3648274">0x01</span><span class="op" id="3648278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648281">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648308">=</span>&nbsp;<span class="ident" id="3648310">IP</span><span class="op" id="3648312">{</span><span class="num" id="3648313">0xff</span><span class="op" id="3648317">,</span>&nbsp;<span class="num" id="3648319">0x02</span><span class="op" id="3648323">,</span>&nbsp;<span class="num" id="3648325">0</span><span class="op" id="3648326">,</span>&nbsp;<span class="num" id="3648328">0</span><span class="op" id="3648329">,</span>&nbsp;<span class="num" id="3648331">0</span><span class="op" id="3648332">,</span>&nbsp;<span class="num" id="3648334">0</span><span class="op" id="3648335">,</span>&nbsp;<span class="num" id="3648337">0</span><span class="op" id="3648338">,</span>&nbsp;<span class="num" id="3648340">0</span><span class="op" id="3648341">,</span>&nbsp;<span class="num" id="3648343">0</span><span class="op" id="3648344">,</span>&nbsp;<span class="num" id="3648346">0</span><span class="op" id="3648347">,</span>&nbsp;<span class="num" id="3648349">0</span><span class="op" id="3648350">,</span>&nbsp;<span class="num" id="3648352">0</span><span class="op" id="3648353">,</span>&nbsp;<span class="num" id="3648355">0</span><span class="op" id="3648356">,</span>&nbsp;<span class="num" id="3648358">0</span><span class="op" id="3648359">,</span>&nbsp;<span class="num" id="3648361">0</span><span class="op" id="3648362">,</span>&nbsp;<span class="num" id="3648364">0x02</span><span class="op" id="3648368">}</span><br>
<span class="lineno"></span><span class="op" id="3648370">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3648373">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3648436">func</span>&nbsp;<span class="op" id="3648441">(</span><span class="ident" id="3648442">ip</span>&nbsp;<span class="ident" id="3648445">IP</span><span class="op" id="3648447">)</span>&nbsp;<span class="ident" id="3648449">IsUnspecified</span><span class="op" id="3648462">(</span><span class="op" id="3648463">)</span>&nbsp;<span class="builtintype" id="3648465">bool</span>&nbsp;<span class="op" id="3648470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648473">if</span>&nbsp;<span class="ident" id="3648476">ip</span><span class="op" id="3648478">.</span><span class="ident" id="3648479">Equal</span><span class="op" id="3648484">(</span><span class="ident" id="3648485">IPv4zero</span><span class="op" id="3648493">)</span>&nbsp;<span class="op" id="3648495">||</span>&nbsp;<span class="ident" id="3648498">ip</span><span class="op" id="3648500">.</span><span class="ident" id="3648501">Equal</span><span class="op" id="3648506">(</span><span class="ident" id="3648507">IPv6unspecified</span><span class="op" id="3648522">)</span>&nbsp;<span class="op" id="3648524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648528">return</span>&nbsp;<span class="builtintype" id="3648535">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648544">return</span>&nbsp;<span class="builtintype" id="3648551">false</span><br>
<span class="lineno"></span><span class="op" id="3648557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3648560">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3648616">func</span>&nbsp;<span class="op" id="3648621">(</span><span class="ident" id="3648622">ip</span>&nbsp;<span class="ident" id="3648625">IP</span><span class="op" id="3648627">)</span>&nbsp;<span class="ident" id="3648629">IsLoopback</span><span class="op" id="3648639">(</span><span class="op" id="3648640">)</span>&nbsp;<span class="builtintype" id="3648642">bool</span>&nbsp;<span class="op" id="3648647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648650">if</span>&nbsp;<span class="ident" id="3648653">ip4</span>&nbsp;<span class="op" id="3648657">:=</span>&nbsp;<span class="ident" id="3648660">ip</span><span class="op" id="3648662">.</span><span class="ident" id="3648663">To4</span><span class="op" id="3648666">(</span><span class="op" id="3648667">)</span><span class="op" id="3648668">;</span>&nbsp;<span class="ident" id="3648670">ip4</span>&nbsp;<span class="op" id="3648674">!=</span>&nbsp;<span class="ident" id="3648677">nil</span>&nbsp;<span class="op" id="3648681">&amp;&amp;</span>&nbsp;<span class="ident" id="3648684">ip4</span><span class="op" id="3648687">[</span><span class="num" id="3648688">0</span><span class="op" id="3648689">]</span>&nbsp;<span class="op" id="3648691">==</span>&nbsp;<span class="num" id="3648694">127</span>&nbsp;<span class="op" id="3648698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648702">return</span>&nbsp;<span class="builtintype" id="3648709">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648718">return</span>&nbsp;<span class="ident" id="3648725">ip</span><span class="op" id="3648727">.</span><span class="ident" id="3648728">Equal</span><span class="op" id="3648733">(</span><span class="ident" id="3648734">IPv6loopback</span><span class="op" id="3648746">)</span><br>
<span class="lineno">125</span><span class="op" id="3648748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3648751">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3648809">func</span>&nbsp;<span class="op" id="3648814">(</span><span class="ident" id="3648815">ip</span>&nbsp;<span class="ident" id="3648818">IP</span><span class="op" id="3648820">)</span>&nbsp;<span class="ident" id="3648822">IsMulticast</span><span class="op" id="3648833">(</span><span class="op" id="3648834">)</span>&nbsp;<span class="builtintype" id="3648836">bool</span>&nbsp;<span class="op" id="3648841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648844">if</span>&nbsp;<span class="ident" id="3648847">ip4</span>&nbsp;<span class="op" id="3648851">:=</span>&nbsp;<span class="ident" id="3648854">ip</span><span class="op" id="3648856">.</span><span class="ident" id="3648857">To4</span><span class="op" id="3648860">(</span><span class="op" id="3648861">)</span><span class="op" id="3648862">;</span>&nbsp;<span class="ident" id="3648864">ip4</span>&nbsp;<span class="op" id="3648868">!=</span>&nbsp;<span class="ident" id="3648871">nil</span>&nbsp;<span class="op" id="3648875">&amp;&amp;</span>&nbsp;<span class="ident" id="3648878">ip4</span><span class="op" id="3648881">[</span><span class="num" id="3648882">0</span><span class="op" id="3648883">]</span><span class="op" id="3648884">&amp;</span><span class="num" id="3648885">0xf0</span>&nbsp;<span class="op" id="3648890">==</span>&nbsp;<span class="num" id="3648893">0xe0</span>&nbsp;<span class="op" id="3648898">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648902">return</span>&nbsp;<span class="builtintype" id="3648909">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648918">return</span>&nbsp;<span class="ident" id="3648925">ip</span><span class="op" id="3648927">[</span><span class="num" id="3648928">0</span><span class="op" id="3648929">]</span>&nbsp;<span class="op" id="3648931">==</span>&nbsp;<span class="num" id="3648934">0xff</span><br>
<span class="lineno"></span><span class="op" id="3648939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3648942">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3648997">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3649038">func</span>&nbsp;<span class="op" id="3649043">(</span><span class="ident" id="3649044">ip</span>&nbsp;<span class="ident" id="3649047">IP</span><span class="op" id="3649049">)</span>&nbsp;<span class="ident" id="3649051">IsInterfaceLocalMulticast</span><span class="op" id="3649076">(</span><span class="op" id="3649077">)</span>&nbsp;<span class="builtintype" id="3649079">bool</span>&nbsp;<span class="op" id="3649084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649087">return</span>&nbsp;<span class="builtinfunc" id="3649094">len</span><span class="op" id="3649097">(</span><span class="ident" id="3649098">ip</span><span class="op" id="3649100">)</span>&nbsp;<span class="op" id="3649102">==</span>&nbsp;<span class="ident" id="3649105">IPv6len</span>&nbsp;<span class="op" id="3649113">&amp;&amp;</span>&nbsp;<span class="ident" id="3649116">ip</span><span class="op" id="3649118">[</span><span class="num" id="3649119">0</span><span class="op" id="3649120">]</span>&nbsp;<span class="op" id="3649122">==</span>&nbsp;<span class="num" id="3649125">0xff</span>&nbsp;<span class="op" id="3649130">&amp;&amp;</span>&nbsp;<span class="ident" id="3649133">ip</span><span class="op" id="3649135">[</span><span class="num" id="3649136">1</span><span class="op" id="3649137">]</span><span class="op" id="3649138">&amp;</span><span class="num" id="3649139">0x0f</span>&nbsp;<span class="op" id="3649144">==</span>&nbsp;<span class="num" id="3649147">0x01</span><br>
<span class="lineno"></span><span class="op" id="3649152">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3649155">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3649214">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3649236">func</span>&nbsp;<span class="op" id="3649241">(</span><span class="ident" id="3649242">ip</span>&nbsp;<span class="ident" id="3649245">IP</span><span class="op" id="3649247">)</span>&nbsp;<span class="ident" id="3649249">IsLinkLocalMulticast</span><span class="op" id="3649269">(</span><span class="op" id="3649270">)</span>&nbsp;<span class="builtintype" id="3649272">bool</span>&nbsp;<span class="op" id="3649277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649280">if</span>&nbsp;<span class="ident" id="3649283">ip4</span>&nbsp;<span class="op" id="3649287">:=</span>&nbsp;<span class="ident" id="3649290">ip</span><span class="op" id="3649292">.</span><span class="ident" id="3649293">To4</span><span class="op" id="3649296">(</span><span class="op" id="3649297">)</span><span class="op" id="3649298">;</span>&nbsp;<span class="ident" id="3649300">ip4</span>&nbsp;<span class="op" id="3649304">!=</span>&nbsp;<span class="ident" id="3649307">nil</span>&nbsp;<span class="op" id="3649311">&amp;&amp;</span>&nbsp;<span class="ident" id="3649314">ip4</span><span class="op" id="3649317">[</span><span class="num" id="3649318">0</span><span class="op" id="3649319">]</span>&nbsp;<span class="op" id="3649321">==</span>&nbsp;<span class="num" id="3649324">224</span>&nbsp;<span class="op" id="3649328">&amp;&amp;</span>&nbsp;<span class="ident" id="3649331">ip4</span><span class="op" id="3649334">[</span><span class="num" id="3649335">1</span><span class="op" id="3649336">]</span>&nbsp;<span class="op" id="3649338">==</span>&nbsp;<span class="num" id="3649341">0</span>&nbsp;<span class="op" id="3649343">&amp;&amp;</span>&nbsp;<span class="ident" id="3649346">ip4</span><span class="op" id="3649349">[</span><span class="num" id="3649350">2</span><span class="op" id="3649351">]</span>&nbsp;<span class="op" id="3649353">==</span>&nbsp;<span class="num" id="3649356">0</span>&nbsp;<span class="op" id="3649358">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649362">return</span>&nbsp;<span class="builtintype" id="3649369">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649378">return</span>&nbsp;<span class="ident" id="3649385">ip</span><span class="op" id="3649387">[</span><span class="num" id="3649388">0</span><span class="op" id="3649389">]</span>&nbsp;<span class="op" id="3649391">==</span>&nbsp;<span class="num" id="3649394">0xff</span>&nbsp;<span class="op" id="3649399">&amp;&amp;</span>&nbsp;<span class="ident" id="3649402">ip</span><span class="op" id="3649404">[</span><span class="num" id="3649405">1</span><span class="op" id="3649406">]</span><span class="op" id="3649407">&amp;</span><span class="num" id="3649408">0x0f</span>&nbsp;<span class="op" id="3649413">==</span>&nbsp;<span class="num" id="3649416">0x02</span><br>
<span class="lineno"></span><span class="op" id="3649421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3649424">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3649481">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3649501">func</span>&nbsp;<span class="op" id="3649506">(</span><span class="ident" id="3649507">ip</span>&nbsp;<span class="ident" id="3649510">IP</span><span class="op" id="3649512">)</span>&nbsp;<span class="ident" id="3649514">IsLinkLocalUnicast</span><span class="op" id="3649532">(</span><span class="op" id="3649533">)</span>&nbsp;<span class="builtintype" id="3649535">bool</span>&nbsp;<span class="op" id="3649540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649543">if</span>&nbsp;<span class="ident" id="3649546">ip4</span>&nbsp;<span class="op" id="3649550">:=</span>&nbsp;<span class="ident" id="3649553">ip</span><span class="op" id="3649555">.</span><span class="ident" id="3649556">To4</span><span class="op" id="3649559">(</span><span class="op" id="3649560">)</span><span class="op" id="3649561">;</span>&nbsp;<span class="ident" id="3649563">ip4</span>&nbsp;<span class="op" id="3649567">!=</span>&nbsp;<span class="ident" id="3649570">nil</span>&nbsp;<span class="op" id="3649574">&amp;&amp;</span>&nbsp;<span class="ident" id="3649577">ip4</span><span class="op" id="3649580">[</span><span class="num" id="3649581">0</span><span class="op" id="3649582">]</span>&nbsp;<span class="op" id="3649584">==</span>&nbsp;<span class="num" id="3649587">169</span>&nbsp;<span class="op" id="3649591">&amp;&amp;</span>&nbsp;<span class="ident" id="3649594">ip4</span><span class="op" id="3649597">[</span><span class="num" id="3649598">1</span><span class="op" id="3649599">]</span>&nbsp;<span class="op" id="3649601">==</span>&nbsp;<span class="num" id="3649604">254</span>&nbsp;<span class="op" id="3649608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649612">return</span>&nbsp;<span class="builtintype" id="3649619">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649628">return</span>&nbsp;<span class="ident" id="3649635">ip</span><span class="op" id="3649637">[</span><span class="num" id="3649638">0</span><span class="op" id="3649639">]</span>&nbsp;<span class="op" id="3649641">==</span>&nbsp;<span class="num" id="3649644">0xfe</span>&nbsp;<span class="op" id="3649649">&amp;&amp;</span>&nbsp;<span class="ident" id="3649652">ip</span><span class="op" id="3649654">[</span><span class="num" id="3649655">1</span><span class="op" id="3649656">]</span><span class="op" id="3649657">&amp;</span><span class="num" id="3649658">0xc0</span>&nbsp;<span class="op" id="3649663">==</span>&nbsp;<span class="num" id="3649666">0x80</span><br>
<span class="lineno"></span><span class="op" id="3649671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3649674">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3649732">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3649744">func</span>&nbsp;<span class="op" id="3649749">(</span><span class="ident" id="3649750">ip</span>&nbsp;<span class="ident" id="3649753">IP</span><span class="op" id="3649755">)</span>&nbsp;<span class="ident" id="3649757">IsGlobalUnicast</span><span class="op" id="3649772">(</span><span class="op" id="3649773">)</span>&nbsp;<span class="builtintype" id="3649775">bool</span>&nbsp;<span class="op" id="3649780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649783">return</span>&nbsp;<span class="op" id="3649790">!</span><span class="ident" id="3649791">ip</span><span class="op" id="3649793">.</span><span class="ident" id="3649794">IsUnspecified</span><span class="op" id="3649807">(</span><span class="op" id="3649808">)</span>&nbsp;<span class="op" id="3649810">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649815">!</span><span class="ident" id="3649816">ip</span><span class="op" id="3649818">.</span><span class="ident" id="3649819">IsLoopback</span><span class="op" id="3649829">(</span><span class="op" id="3649830">)</span>&nbsp;<span class="op" id="3649832">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649837">!</span><span class="ident" id="3649838">ip</span><span class="op" id="3649840">.</span><span class="ident" id="3649841">IsMulticast</span><span class="op" id="3649852">(</span><span class="op" id="3649853">)</span>&nbsp;<span class="op" id="3649855">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649860">!</span><span class="ident" id="3649861">ip</span><span class="op" id="3649863">.</span><span class="ident" id="3649864">IsLinkLocalUnicast</span><span class="op" id="3649882">(</span><span class="op" id="3649883">)</span><br>
<span class="lineno"></span><span class="op" id="3649885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3649888">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3649907">func</span>&nbsp;<span class="ident" id="3649912">isZeros</span><span class="op" id="3649919">(</span><span class="ident" id="3649920">p</span>&nbsp;<span class="ident" id="3649922">IP</span><span class="op" id="3649924">)</span>&nbsp;<span class="builtintype" id="3649926">bool</span>&nbsp;<span class="op" id="3649931">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649934">for</span>&nbsp;<span class="ident" id="3649938">i</span>&nbsp;<span class="op" id="3649940">:=</span>&nbsp;<span class="num" id="3649943">0</span><span class="op" id="3649944">;</span>&nbsp;<span class="ident" id="3649946">i</span>&nbsp;<span class="op" id="3649948">&lt;</span>&nbsp;<span class="builtinfunc" id="3649950">len</span><span class="op" id="3649953">(</span><span class="ident" id="3649954">p</span><span class="op" id="3649955">)</span><span class="op" id="3649956">;</span>&nbsp;<span class="ident" id="3649958">i</span><span class="op" id="3649959">++</span>&nbsp;<span class="op" id="3649962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649966">if</span>&nbsp;<span class="ident" id="3649969">p</span><span class="op" id="3649970">[</span><span class="ident" id="3649971">i</span><span class="op" id="3649972">]</span>&nbsp;<span class="op" id="3649974">!=</span>&nbsp;<span class="num" id="3649977">0</span>&nbsp;<span class="op" id="3649979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649984">return</span>&nbsp;<span class="builtintype" id="3649991">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650002">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650005">return</span>&nbsp;<span class="builtintype" id="3650012">true</span><br>
<span class="lineno"></span><span class="op" id="3650017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650020">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3650084">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3650134">func</span>&nbsp;<span class="op" id="3650139">(</span><span class="ident" id="3650140">ip</span>&nbsp;<span class="ident" id="3650143">IP</span><span class="op" id="3650145">)</span>&nbsp;<span class="ident" id="3650147">To4</span><span class="op" id="3650150">(</span><span class="op" id="3650151">)</span>&nbsp;<span class="ident" id="3650153">IP</span>&nbsp;<span class="op" id="3650156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650159">if</span>&nbsp;<span class="builtinfunc" id="3650162">len</span><span class="op" id="3650165">(</span><span class="ident" id="3650166">ip</span><span class="op" id="3650168">)</span>&nbsp;<span class="op" id="3650170">==</span>&nbsp;<span class="ident" id="3650173">IPv4len</span>&nbsp;<span class="op" id="3650181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650185">return</span>&nbsp;<span class="ident" id="3650192">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650199">if</span>&nbsp;<span class="builtinfunc" id="3650202">len</span><span class="op" id="3650205">(</span><span class="ident" id="3650206">ip</span><span class="op" id="3650208">)</span>&nbsp;<span class="op" id="3650210">==</span>&nbsp;<span class="ident" id="3650213">IPv6len</span>&nbsp;<span class="op" id="3650221">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650226">isZeros</span><span class="op" id="3650233">(</span><span class="ident" id="3650234">ip</span><span class="op" id="3650236">[</span><span class="num" id="3650237">0</span><span class="op" id="3650238">:</span><span class="num" id="3650239">10</span><span class="op" id="3650241">]</span><span class="op" id="3650242">)</span>&nbsp;<span class="op" id="3650244">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650249">ip</span><span class="op" id="3650251">[</span><span class="num" id="3650252">10</span><span class="op" id="3650254">]</span>&nbsp;<span class="op" id="3650256">==</span>&nbsp;<span class="num" id="3650259">0xff</span>&nbsp;<span class="op" id="3650264">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650269">ip</span><span class="op" id="3650271">[</span><span class="num" id="3650272">11</span><span class="op" id="3650274">]</span>&nbsp;<span class="op" id="3650276">==</span>&nbsp;<span class="num" id="3650279">0xff</span>&nbsp;<span class="op" id="3650284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650288">return</span>&nbsp;<span class="ident" id="3650295">ip</span><span class="op" id="3650297">[</span><span class="num" id="3650298">12</span><span class="op" id="3650300">:</span><span class="num" id="3650301">16</span><span class="op" id="3650303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650306">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650309">return</span>&nbsp;<span class="ident" id="3650316">nil</span><br>
<span class="lineno"></span><span class="op" id="3650320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650323">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3650387">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3650461">func</span>&nbsp;<span class="op" id="3650466">(</span><span class="ident" id="3650467">ip</span>&nbsp;<span class="ident" id="3650470">IP</span><span class="op" id="3650472">)</span>&nbsp;<span class="ident" id="3650474">To16</span><span class="op" id="3650478">(</span><span class="op" id="3650479">)</span>&nbsp;<span class="ident" id="3650481">IP</span>&nbsp;<span class="op" id="3650484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650487">if</span>&nbsp;<span class="builtinfunc" id="3650490">len</span><span class="op" id="3650493">(</span><span class="ident" id="3650494">ip</span><span class="op" id="3650496">)</span>&nbsp;<span class="op" id="3650498">==</span>&nbsp;<span class="ident" id="3650501">IPv4len</span>&nbsp;<span class="op" id="3650509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650513">return</span>&nbsp;<span class="ident" id="3650520">IPv4</span><span class="op" id="3650524">(</span><span class="ident" id="3650525">ip</span><span class="op" id="3650527">[</span><span class="num" id="3650528">0</span><span class="op" id="3650529">]</span><span class="op" id="3650530">,</span>&nbsp;<span class="ident" id="3650532">ip</span><span class="op" id="3650534">[</span><span class="num" id="3650535">1</span><span class="op" id="3650536">]</span><span class="op" id="3650537">,</span>&nbsp;<span class="ident" id="3650539">ip</span><span class="op" id="3650541">[</span><span class="num" id="3650542">2</span><span class="op" id="3650543">]</span><span class="op" id="3650544">,</span>&nbsp;<span class="ident" id="3650546">ip</span><span class="op" id="3650548">[</span><span class="num" id="3650549">3</span><span class="op" id="3650550">]</span><span class="op" id="3650551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650557">if</span>&nbsp;<span class="builtinfunc" id="3650560">len</span><span class="op" id="3650563">(</span><span class="ident" id="3650564">ip</span><span class="op" id="3650566">)</span>&nbsp;<span class="op" id="3650568">==</span>&nbsp;<span class="ident" id="3650571">IPv6len</span>&nbsp;<span class="op" id="3650579">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650583">return</span>&nbsp;<span class="ident" id="3650590">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650597">return</span>&nbsp;<span class="ident" id="3650604">nil</span><br>
<span class="lineno"></span><span class="op" id="3650608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3650611">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3650644">var</span>&nbsp;<span class="op" id="3650648">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650651">classAMask</span>&nbsp;<span class="op" id="3650662">=</span>&nbsp;<span class="ident" id="3650664">IPv4Mask</span><span class="op" id="3650672">(</span><span class="num" id="3650673">0xff</span><span class="op" id="3650677">,</span>&nbsp;<span class="num" id="3650679">0</span><span class="op" id="3650680">,</span>&nbsp;<span class="num" id="3650682">0</span><span class="op" id="3650683">,</span>&nbsp;<span class="num" id="3650685">0</span><span class="op" id="3650686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650689">classBMask</span>&nbsp;<span class="op" id="3650700">=</span>&nbsp;<span class="ident" id="3650702">IPv4Mask</span><span class="op" id="3650710">(</span><span class="num" id="3650711">0xff</span><span class="op" id="3650715">,</span>&nbsp;<span class="num" id="3650717">0xff</span><span class="op" id="3650721">,</span>&nbsp;<span class="num" id="3650723">0</span><span class="op" id="3650724">,</span>&nbsp;<span class="num" id="3650726">0</span><span class="op" id="3650727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650730">classCMask</span>&nbsp;<span class="op" id="3650741">=</span>&nbsp;<span class="ident" id="3650743">IPv4Mask</span><span class="op" id="3650751">(</span><span class="num" id="3650752">0xff</span><span class="op" id="3650756">,</span>&nbsp;<span class="num" id="3650758">0xff</span><span class="op" id="3650762">,</span>&nbsp;<span class="num" id="3650764">0xff</span><span class="op" id="3650768">,</span>&nbsp;<span class="num" id="3650770">0</span><span class="op" id="3650771">)</span><br>
<span class="lineno">210</span><span class="op" id="3650773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650776">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3650842">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3650905">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3650947">func</span>&nbsp;<span class="op" id="3650952">(</span><span class="ident" id="3650953">ip</span>&nbsp;<span class="ident" id="3650956">IP</span><span class="op" id="3650958">)</span>&nbsp;<span class="ident" id="3650960">DefaultMask</span><span class="op" id="3650971">(</span><span class="op" id="3650972">)</span>&nbsp;<span class="ident" id="3650974">IPMask</span>&nbsp;<span class="op" id="3650981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650984">if</span>&nbsp;<span class="ident" id="3650987">ip</span>&nbsp;<span class="op" id="3650990">=</span>&nbsp;<span class="ident" id="3650992">ip</span><span class="op" id="3650994">.</span><span class="ident" id="3650995">To4</span><span class="op" id="3650998">(</span><span class="op" id="3650999">)</span><span class="op" id="3651000">;</span>&nbsp;<span class="ident" id="3651002">ip</span>&nbsp;<span class="op" id="3651005">==</span>&nbsp;<span class="ident" id="3651008">nil</span>&nbsp;<span class="op" id="3651012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651016">return</span>&nbsp;<span class="ident" id="3651023">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651031">switch</span>&nbsp;<span class="builtintype" id="3651038">true</span>&nbsp;<span class="op" id="3651043">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651046">case</span>&nbsp;<span class="ident" id="3651051">ip</span><span class="op" id="3651053">[</span><span class="num" id="3651054">0</span><span class="op" id="3651055">]</span>&nbsp;<span class="op" id="3651057">&lt;</span>&nbsp;<span class="num" id="3651059">0x80</span><span class="op" id="3651063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651067">return</span>&nbsp;<span class="ident" id="3651074">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651086">case</span>&nbsp;<span class="ident" id="3651091">ip</span><span class="op" id="3651093">[</span><span class="num" id="3651094">0</span><span class="op" id="3651095">]</span>&nbsp;<span class="op" id="3651097">&lt;</span>&nbsp;<span class="num" id="3651099">0xC0</span><span class="op" id="3651103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651107">return</span>&nbsp;<span class="ident" id="3651114">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651126">default</span><span class="op" id="3651133">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651137">return</span>&nbsp;<span class="ident" id="3651144">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651156">}</span><br>
<span class="lineno"></span><span class="op" id="3651158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3651161">func</span>&nbsp;<span class="ident" id="3651166">allFF</span><span class="op" id="3651171">(</span><span class="ident" id="3651172">b</span>&nbsp;<span class="op" id="3651174">[</span><span class="op" id="3651175">]</span><span class="builtintype" id="3651176">byte</span><span class="op" id="3651180">)</span>&nbsp;<span class="builtintype" id="3651182">bool</span>&nbsp;<span class="op" id="3651187">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651190">for</span>&nbsp;<span class="ident" id="3651194">_</span><span class="op" id="3651195">,</span>&nbsp;<span class="ident" id="3651197">c</span>&nbsp;<span class="op" id="3651199">:=</span>&nbsp;<span class="keyword" id="3651202">range</span>&nbsp;<span class="ident" id="3651208">b</span>&nbsp;<span class="op" id="3651210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651214">if</span>&nbsp;<span class="ident" id="3651217">c</span>&nbsp;<span class="op" id="3651219">!=</span>&nbsp;<span class="num" id="3651222">0xff</span>&nbsp;<span class="op" id="3651227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651232">return</span>&nbsp;<span class="builtintype" id="3651239">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651250">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651253">return</span>&nbsp;<span class="builtintype" id="3651260">true</span><br>
<span class="lineno"></span><span class="op" id="3651265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3651268">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3651335">func</span>&nbsp;<span class="op" id="3651340">(</span><span class="ident" id="3651341">ip</span>&nbsp;<span class="ident" id="3651344">IP</span><span class="op" id="3651346">)</span>&nbsp;<span class="ident" id="3651348">Mask</span><span class="op" id="3651352">(</span><span class="ident" id="3651353">mask</span>&nbsp;<span class="ident" id="3651358">IPMask</span><span class="op" id="3651364">)</span>&nbsp;<span class="ident" id="3651366">IP</span>&nbsp;<span class="op" id="3651369">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651372">if</span>&nbsp;<span class="builtinfunc" id="3651375">len</span><span class="op" id="3651378">(</span><span class="ident" id="3651379">mask</span><span class="op" id="3651383">)</span>&nbsp;<span class="op" id="3651385">==</span>&nbsp;<span class="ident" id="3651388">IPv6len</span>&nbsp;<span class="op" id="3651396">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3651399">len</span><span class="op" id="3651402">(</span><span class="ident" id="3651403">ip</span><span class="op" id="3651405">)</span>&nbsp;<span class="op" id="3651407">==</span>&nbsp;<span class="ident" id="3651410">IPv4len</span>&nbsp;<span class="op" id="3651418">&amp;&amp;</span>&nbsp;<span class="ident" id="3651421">allFF</span><span class="op" id="3651426">(</span><span class="ident" id="3651427">mask</span><span class="op" id="3651431">[</span><span class="op" id="3651432">:</span><span class="num" id="3651433">12</span><span class="op" id="3651435">]</span><span class="op" id="3651436">)</span>&nbsp;<span class="op" id="3651438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651442">mask</span>&nbsp;<span class="op" id="3651447">=</span>&nbsp;<span class="ident" id="3651449">mask</span><span class="op" id="3651453">[</span><span class="num" id="3651454">12</span><span class="op" id="3651456">:</span><span class="op" id="3651457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651463">if</span>&nbsp;<span class="builtinfunc" id="3651466">len</span><span class="op" id="3651469">(</span><span class="ident" id="3651470">mask</span><span class="op" id="3651474">)</span>&nbsp;<span class="op" id="3651476">==</span>&nbsp;<span class="ident" id="3651479">IPv4len</span>&nbsp;<span class="op" id="3651487">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3651490">len</span><span class="op" id="3651493">(</span><span class="ident" id="3651494">ip</span><span class="op" id="3651496">)</span>&nbsp;<span class="op" id="3651498">==</span>&nbsp;<span class="ident" id="3651501">IPv6len</span>&nbsp;<span class="op" id="3651509">&amp;&amp;</span>&nbsp;<span class="ident" id="3651512">bytesEqual</span><span class="op" id="3651522">(</span><span class="ident" id="3651523">ip</span><span class="op" id="3651525">[</span><span class="op" id="3651526">:</span><span class="num" id="3651527">12</span><span class="op" id="3651529">]</span><span class="op" id="3651530">,</span>&nbsp;<span class="ident" id="3651532">v4InV6Prefix</span><span class="op" id="3651544">)</span>&nbsp;<span class="op" id="3651546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651550">ip</span>&nbsp;<span class="op" id="3651553">=</span>&nbsp;<span class="ident" id="3651555">ip</span><span class="op" id="3651557">[</span><span class="num" id="3651558">12</span><span class="op" id="3651560">:</span><span class="op" id="3651561">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651567">n</span>&nbsp;<span class="op" id="3651569">:=</span>&nbsp;<span class="builtinfunc" id="3651572">len</span><span class="op" id="3651575">(</span><span class="ident" id="3651576">ip</span><span class="op" id="3651578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651581">if</span>&nbsp;<span class="ident" id="3651584">n</span>&nbsp;<span class="op" id="3651586">!=</span>&nbsp;<span class="builtinfunc" id="3651589">len</span><span class="op" id="3651592">(</span><span class="ident" id="3651593">mask</span><span class="op" id="3651597">)</span>&nbsp;<span class="op" id="3651599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651603">return</span>&nbsp;<span class="ident" id="3651610">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651615">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651618">out</span>&nbsp;<span class="op" id="3651622">:=</span>&nbsp;<span class="builtinfunc" id="3651625">make</span><span class="op" id="3651629">(</span><span class="ident" id="3651630">IP</span><span class="op" id="3651632">,</span>&nbsp;<span class="ident" id="3651634">n</span><span class="op" id="3651635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651638">for</span>&nbsp;<span class="ident" id="3651642">i</span>&nbsp;<span class="op" id="3651644">:=</span>&nbsp;<span class="num" id="3651647">0</span><span class="op" id="3651648">;</span>&nbsp;<span class="ident" id="3651650">i</span>&nbsp;<span class="op" id="3651652">&lt;</span>&nbsp;<span class="ident" id="3651654">n</span><span class="op" id="3651655">;</span>&nbsp;<span class="ident" id="3651657">i</span><span class="op" id="3651658">++</span>&nbsp;<span class="op" id="3651661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651665">out</span><span class="op" id="3651668">[</span><span class="ident" id="3651669">i</span><span class="op" id="3651670">]</span>&nbsp;<span class="op" id="3651672">=</span>&nbsp;<span class="ident" id="3651674">ip</span><span class="op" id="3651676">[</span><span class="ident" id="3651677">i</span><span class="op" id="3651678">]</span>&nbsp;<span class="op" id="3651680">&amp;</span>&nbsp;<span class="ident" id="3651682">mask</span><span class="op" id="3651686">[</span><span class="ident" id="3651687">i</span><span class="op" id="3651688">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651694">return</span>&nbsp;<span class="ident" id="3651701">out</span><br>
<span class="lineno">255</span><span class="op" id="3651705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3651708">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3651764">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3651828">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3651897">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3651934">func</span>&nbsp;<span class="op" id="3651939">(</span><span class="ident" id="3651940">ip</span>&nbsp;<span class="ident" id="3651943">IP</span><span class="op" id="3651945">)</span>&nbsp;<span class="ident" id="3651947">String</span><span class="op" id="3651953">(</span><span class="op" id="3651954">)</span>&nbsp;<span class="builtintype" id="3651956">string</span>&nbsp;<span class="op" id="3651963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651966">p</span>&nbsp;<span class="op" id="3651968">:=</span>&nbsp;<span class="ident" id="3651971">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651976">if</span>&nbsp;<span class="builtinfunc" id="3651979">len</span><span class="op" id="3651982">(</span><span class="ident" id="3651983">ip</span><span class="op" id="3651985">)</span>&nbsp;<span class="op" id="3651987">==</span>&nbsp;<span class="num" id="3651990">0</span>&nbsp;<span class="op" id="3651992">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651996">return</span>&nbsp;<span class="string" id="3652003">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3652016">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652050">if</span>&nbsp;<span class="ident" id="3652053">p4</span>&nbsp;<span class="op" id="3652056">:=</span>&nbsp;<span class="ident" id="3652059">p</span><span class="op" id="3652060">.</span><span class="ident" id="3652061">To4</span><span class="op" id="3652064">(</span><span class="op" id="3652065">)</span><span class="op" id="3652066">;</span>&nbsp;<span class="builtinfunc" id="3652068">len</span><span class="op" id="3652071">(</span><span class="ident" id="3652072">p4</span><span class="op" id="3652074">)</span>&nbsp;<span class="op" id="3652076">==</span>&nbsp;<span class="ident" id="3652079">IPv4len</span>&nbsp;<span class="op" id="3652087">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652091">return</span>&nbsp;<span class="ident" id="3652098">itod</span><span class="op" id="3652102">(</span><span class="builtintype" id="3652103">uint</span><span class="op" id="3652107">(</span><span class="ident" id="3652108">p4</span><span class="op" id="3652110">[</span><span class="num" id="3652111">0</span><span class="op" id="3652112">]</span><span class="op" id="3652113">)</span><span class="op" id="3652114">)</span>&nbsp;<span class="op" id="3652116">+</span>&nbsp;<span class="string" id="3652118">&#34;.&#34;</span>&nbsp;<span class="op" id="3652122">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652127">itod</span><span class="op" id="3652131">(</span><span class="builtintype" id="3652132">uint</span><span class="op" id="3652136">(</span><span class="ident" id="3652137">p4</span><span class="op" id="3652139">[</span><span class="num" id="3652140">1</span><span class="op" id="3652141">]</span><span class="op" id="3652142">)</span><span class="op" id="3652143">)</span>&nbsp;<span class="op" id="3652145">+</span>&nbsp;<span class="string" id="3652147">&#34;.&#34;</span>&nbsp;<span class="op" id="3652151">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652156">itod</span><span class="op" id="3652160">(</span><span class="builtintype" id="3652161">uint</span><span class="op" id="3652165">(</span><span class="ident" id="3652166">p4</span><span class="op" id="3652168">[</span><span class="num" id="3652169">2</span><span class="op" id="3652170">]</span><span class="op" id="3652171">)</span><span class="op" id="3652172">)</span>&nbsp;<span class="op" id="3652174">+</span>&nbsp;<span class="string" id="3652176">&#34;.&#34;</span>&nbsp;<span class="op" id="3652180">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652185">itod</span><span class="op" id="3652189">(</span><span class="builtintype" id="3652190">uint</span><span class="op" id="3652194">(</span><span class="ident" id="3652195">p4</span><span class="op" id="3652197">[</span><span class="num" id="3652198">3</span><span class="op" id="3652199">]</span><span class="op" id="3652200">)</span><span class="op" id="3652201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652204">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652207">if</span>&nbsp;<span class="builtinfunc" id="3652210">len</span><span class="op" id="3652213">(</span><span class="ident" id="3652214">p</span><span class="op" id="3652215">)</span>&nbsp;<span class="op" id="3652217">!=</span>&nbsp;<span class="ident" id="3652220">IPv6len</span>&nbsp;<span class="op" id="3652228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652232">return</span>&nbsp;<span class="string" id="3652239">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3652248">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652279">e0</span>&nbsp;<span class="op" id="3652282">:=</span>&nbsp;<span class="op" id="3652285">-</span><span class="num" id="3652286">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652289">e1</span>&nbsp;<span class="op" id="3652292">:=</span>&nbsp;<span class="op" id="3652295">-</span><span class="num" id="3652296">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652299">for</span>&nbsp;<span class="ident" id="3652303">i</span>&nbsp;<span class="op" id="3652305">:=</span>&nbsp;<span class="num" id="3652308">0</span><span class="op" id="3652309">;</span>&nbsp;<span class="ident" id="3652311">i</span>&nbsp;<span class="op" id="3652313">&lt;</span>&nbsp;<span class="ident" id="3652315">IPv6len</span><span class="op" id="3652322">;</span>&nbsp;<span class="ident" id="3652324">i</span>&nbsp;<span class="op" id="3652326">+=</span>&nbsp;<span class="num" id="3652329">2</span>&nbsp;<span class="op" id="3652331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652335">j</span>&nbsp;<span class="op" id="3652337">:=</span>&nbsp;<span class="ident" id="3652340">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652344">for</span>&nbsp;<span class="ident" id="3652348">j</span>&nbsp;<span class="op" id="3652350">&lt;</span>&nbsp;<span class="ident" id="3652352">IPv6len</span>&nbsp;<span class="op" id="3652360">&amp;&amp;</span>&nbsp;<span class="ident" id="3652363">p</span><span class="op" id="3652364">[</span><span class="ident" id="3652365">j</span><span class="op" id="3652366">]</span>&nbsp;<span class="op" id="3652368">==</span>&nbsp;<span class="num" id="3652371">0</span>&nbsp;<span class="op" id="3652373">&amp;&amp;</span>&nbsp;<span class="ident" id="3652376">p</span><span class="op" id="3652377">[</span><span class="ident" id="3652378">j</span><span class="op" id="3652379">+</span><span class="num" id="3652380">1</span><span class="op" id="3652381">]</span>&nbsp;<span class="op" id="3652383">==</span>&nbsp;<span class="num" id="3652386">0</span>&nbsp;<span class="op" id="3652388">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652393">j</span>&nbsp;<span class="op" id="3652395">+=</span>&nbsp;<span class="num" id="3652398">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652406">if</span>&nbsp;<span class="ident" id="3652409">j</span>&nbsp;<span class="op" id="3652411">&gt;</span>&nbsp;<span class="ident" id="3652413">i</span>&nbsp;<span class="op" id="3652415">&amp;&amp;</span>&nbsp;<span class="ident" id="3652418">j</span><span class="op" id="3652419">-</span><span class="ident" id="3652420">i</span>&nbsp;<span class="op" id="3652422">&gt;</span>&nbsp;<span class="ident" id="3652424">e1</span><span class="op" id="3652426">-</span><span class="ident" id="3652427">e0</span>&nbsp;<span class="op" id="3652430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652435">e0</span>&nbsp;<span class="op" id="3652438">=</span>&nbsp;<span class="ident" id="3652440">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652445">e1</span>&nbsp;<span class="op" id="3652448">=</span>&nbsp;<span class="ident" id="3652450">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652455">i</span>&nbsp;<span class="op" id="3652457">=</span>&nbsp;<span class="ident" id="3652459">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3652469">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652542">if</span>&nbsp;<span class="ident" id="3652545">e1</span><span class="op" id="3652547">-</span><span class="ident" id="3652548">e0</span>&nbsp;<span class="op" id="3652551">&lt;=</span>&nbsp;<span class="num" id="3652554">2</span>&nbsp;<span class="op" id="3652556">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652560">e0</span>&nbsp;<span class="op" id="3652563">=</span>&nbsp;<span class="op" id="3652565">-</span><span class="num" id="3652566">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652570">e1</span>&nbsp;<span class="op" id="3652573">=</span>&nbsp;<span class="op" id="3652575">-</span><span class="num" id="3652576">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652583">const</span>&nbsp;<span class="ident" id="3652589">maxLen</span>&nbsp;<span class="op" id="3652596">=</span>&nbsp;<span class="builtinfunc" id="3652598">len</span><span class="op" id="3652601">(</span><span class="string" id="3652602">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3652643">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652646">b</span>&nbsp;<span class="op" id="3652648">:=</span>&nbsp;<span class="builtinfunc" id="3652651">make</span><span class="op" id="3652655">(</span><span class="op" id="3652656">[</span><span class="op" id="3652657">]</span><span class="builtintype" id="3652658">byte</span><span class="op" id="3652662">,</span>&nbsp;<span class="num" id="3652664">0</span><span class="op" id="3652665">,</span>&nbsp;<span class="ident" id="3652667">maxLen</span><span class="op" id="3652673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3652677">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652729">for</span>&nbsp;<span class="ident" id="3652733">i</span>&nbsp;<span class="op" id="3652735">:=</span>&nbsp;<span class="num" id="3652738">0</span><span class="op" id="3652739">;</span>&nbsp;<span class="ident" id="3652741">i</span>&nbsp;<span class="op" id="3652743">&lt;</span>&nbsp;<span class="ident" id="3652745">IPv6len</span><span class="op" id="3652752">;</span>&nbsp;<span class="ident" id="3652754">i</span>&nbsp;<span class="op" id="3652756">+=</span>&nbsp;<span class="num" id="3652759">2</span>&nbsp;<span class="op" id="3652761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652765">if</span>&nbsp;<span class="ident" id="3652768">i</span>&nbsp;<span class="op" id="3652770">==</span>&nbsp;<span class="ident" id="3652773">e0</span>&nbsp;<span class="op" id="3652776">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652781">b</span>&nbsp;<span class="op" id="3652783">=</span>&nbsp;<span class="builtinfunc" id="3652785">append</span><span class="op" id="3652791">(</span><span class="ident" id="3652792">b</span><span class="op" id="3652793">,</span>&nbsp;<span class="string" id="3652795">&#39;:&#39;</span><span class="op" id="3652798">,</span>&nbsp;<span class="string" id="3652800">&#39;:&#39;</span><span class="op" id="3652803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652808">i</span>&nbsp;<span class="op" id="3652810">=</span>&nbsp;<span class="ident" id="3652812">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652818">if</span>&nbsp;<span class="ident" id="3652821">i</span>&nbsp;<span class="op" id="3652823">&gt;=</span>&nbsp;<span class="ident" id="3652826">IPv6len</span>&nbsp;<span class="op" id="3652834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652840">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652849">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652853">}</span>&nbsp;<span class="keyword" id="3652855">else</span>&nbsp;<span class="keyword" id="3652860">if</span>&nbsp;<span class="ident" id="3652863">i</span>&nbsp;<span class="op" id="3652865">&gt;</span>&nbsp;<span class="num" id="3652867">0</span>&nbsp;<span class="op" id="3652869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652874">b</span>&nbsp;<span class="op" id="3652876">=</span>&nbsp;<span class="builtinfunc" id="3652878">append</span><span class="op" id="3652884">(</span><span class="ident" id="3652885">b</span><span class="op" id="3652886">,</span>&nbsp;<span class="string" id="3652888">&#39;:&#39;</span><span class="op" id="3652891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652899">b</span>&nbsp;<span class="op" id="3652901">=</span>&nbsp;<span class="ident" id="3652903">appendHex</span><span class="op" id="3652912">(</span><span class="ident" id="3652913">b</span><span class="op" id="3652914">,</span>&nbsp;<span class="op" id="3652916">(</span><span class="builtintype" id="3652917">uint32</span><span class="op" id="3652923">(</span><span class="ident" id="3652924">p</span><span class="op" id="3652925">[</span><span class="ident" id="3652926">i</span><span class="op" id="3652927">]</span><span class="op" id="3652928">)</span><span class="op" id="3652929">&lt;&lt;</span><span class="num" id="3652931">8</span><span class="op" id="3652932">)</span><span class="op" id="3652933">|</span><span class="builtintype" id="3652934">uint32</span><span class="op" id="3652940">(</span><span class="ident" id="3652941">p</span><span class="op" id="3652942">[</span><span class="ident" id="3652943">i</span><span class="op" id="3652944">+</span><span class="num" id="3652945">1</span><span class="op" id="3652946">]</span><span class="op" id="3652947">)</span><span class="op" id="3652948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652951">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652954">return</span>&nbsp;<span class="builtintype" id="3652961">string</span><span class="op" id="3652967">(</span><span class="ident" id="3652968">b</span><span class="op" id="3652969">)</span><br>
<span class="lineno"></span><span class="op" id="3652971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3652974">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3653032">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3653069">func</span>&nbsp;<span class="ident" id="3653074">ipEmptyString</span><span class="op" id="3653087">(</span><span class="ident" id="3653088">ip</span>&nbsp;<span class="ident" id="3653091">IP</span><span class="op" id="3653093">)</span>&nbsp;<span class="builtintype" id="3653095">string</span>&nbsp;<span class="op" id="3653102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653105">if</span>&nbsp;<span class="builtinfunc" id="3653108">len</span><span class="op" id="3653111">(</span><span class="ident" id="3653112">ip</span><span class="op" id="3653114">)</span>&nbsp;<span class="op" id="3653116">==</span>&nbsp;<span class="num" id="3653119">0</span>&nbsp;<span class="op" id="3653121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653125">return</span>&nbsp;<span class="string" id="3653132">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653139">return</span>&nbsp;<span class="ident" id="3653146">ip</span><span class="op" id="3653148">.</span><span class="ident" id="3653149">String</span><span class="op" id="3653155">(</span><span class="op" id="3653156">)</span><br>
<span class="lineno">325</span><span class="op" id="3653158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3653161">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3653225">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3653276">func</span>&nbsp;<span class="op" id="3653281">(</span><span class="ident" id="3653282">ip</span>&nbsp;<span class="ident" id="3653285">IP</span><span class="op" id="3653287">)</span>&nbsp;<span class="ident" id="3653289">MarshalText</span><span class="op" id="3653300">(</span><span class="op" id="3653301">)</span>&nbsp;<span class="op" id="3653303">(</span><span class="op" id="3653304">[</span><span class="op" id="3653305">]</span><span class="builtintype" id="3653306">byte</span><span class="op" id="3653310">,</span>&nbsp;<span class="builtintype" id="3653312">error</span><span class="op" id="3653317">)</span>&nbsp;<span class="op" id="3653319">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653322">if</span>&nbsp;<span class="builtinfunc" id="3653325">len</span><span class="op" id="3653328">(</span><span class="ident" id="3653329">ip</span><span class="op" id="3653331">)</span>&nbsp;<span class="op" id="3653333">==</span>&nbsp;<span class="num" id="3653336">0</span>&nbsp;<span class="op" id="3653338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653342">return</span>&nbsp;<span class="op" id="3653349">[</span><span class="op" id="3653350">]</span><span class="builtintype" id="3653351">byte</span><span class="op" id="3653355">(</span><span class="string" id="3653356">&#34;&#34;</span><span class="op" id="3653358">)</span><span class="op" id="3653359">,</span>&nbsp;<span class="ident" id="3653361">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653369">if</span>&nbsp;<span class="builtinfunc" id="3653372">len</span><span class="op" id="3653375">(</span><span class="ident" id="3653376">ip</span><span class="op" id="3653378">)</span>&nbsp;<span class="op" id="3653380">!=</span>&nbsp;<span class="ident" id="3653383">IPv4len</span>&nbsp;<span class="op" id="3653391">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3653394">len</span><span class="op" id="3653397">(</span><span class="ident" id="3653398">ip</span><span class="op" id="3653400">)</span>&nbsp;<span class="op" id="3653402">!=</span>&nbsp;<span class="ident" id="3653405">IPv6len</span>&nbsp;<span class="op" id="3653413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653417">return</span>&nbsp;<span class="ident" id="3653424">nil</span><span class="op" id="3653427">,</span>&nbsp;<span class="ident" id="3653429">errors</span><span class="op" id="3653435">.</span><span class="ident" id="3653436">New</span><span class="op" id="3653439">(</span><span class="string" id="3653440">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3653460">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653466">return</span>&nbsp;<span class="op" id="3653473">[</span><span class="op" id="3653474">]</span><span class="builtintype" id="3653475">byte</span><span class="op" id="3653479">(</span><span class="ident" id="3653480">ip</span><span class="op" id="3653482">.</span><span class="ident" id="3653483">String</span><span class="op" id="3653489">(</span><span class="op" id="3653490">)</span><span class="op" id="3653491">)</span><span class="op" id="3653492">,</span>&nbsp;<span class="ident" id="3653494">nil</span><br>
<span class="lineno"></span><span class="op" id="3653498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3653501">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3653569">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3653630">func</span>&nbsp;<span class="op" id="3653635">(</span><span class="ident" id="3653636">ip</span>&nbsp;<span class="op" id="3653639">*</span><span class="ident" id="3653640">IP</span><span class="op" id="3653642">)</span>&nbsp;<span class="ident" id="3653644">UnmarshalText</span><span class="op" id="3653657">(</span><span class="ident" id="3653658">text</span>&nbsp;<span class="op" id="3653663">[</span><span class="op" id="3653664">]</span><span class="builtintype" id="3653665">byte</span><span class="op" id="3653669">)</span>&nbsp;<span class="builtintype" id="3653671">error</span>&nbsp;<span class="op" id="3653677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653680">if</span>&nbsp;<span class="builtinfunc" id="3653683">len</span><span class="op" id="3653686">(</span><span class="ident" id="3653687">text</span><span class="op" id="3653691">)</span>&nbsp;<span class="op" id="3653693">==</span>&nbsp;<span class="num" id="3653696">0</span>&nbsp;<span class="op" id="3653698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653702">*</span><span class="ident" id="3653703">ip</span>&nbsp;<span class="op" id="3653706">=</span>&nbsp;<span class="ident" id="3653708">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653714">return</span>&nbsp;<span class="ident" id="3653721">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653729">s</span>&nbsp;<span class="op" id="3653731">:=</span>&nbsp;<span class="builtintype" id="3653734">string</span><span class="op" id="3653740">(</span><span class="ident" id="3653741">text</span><span class="op" id="3653745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653748">x</span>&nbsp;<span class="op" id="3653750">:=</span>&nbsp;<span class="ident" id="3653753">ParseIP</span><span class="op" id="3653760">(</span><span class="ident" id="3653761">s</span><span class="op" id="3653762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653765">if</span>&nbsp;<span class="ident" id="3653768">x</span>&nbsp;<span class="op" id="3653770">==</span>&nbsp;<span class="ident" id="3653773">nil</span>&nbsp;<span class="op" id="3653777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653781">return</span>&nbsp;<span class="op" id="3653788">&amp;</span><span class="ident" id="3653789">ParseError</span><span class="op" id="3653799">{</span><span class="string" id="3653800">&#34;IP&nbsp;address&#34;</span><span class="op" id="3653812">,</span>&nbsp;<span class="ident" id="3653814">s</span><span class="op" id="3653815">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653821">*</span><span class="ident" id="3653822">ip</span>&nbsp;<span class="op" id="3653825">=</span>&nbsp;<span class="ident" id="3653827">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653830">return</span>&nbsp;<span class="ident" id="3653837">nil</span><br>
<span class="lineno"></span><span class="op" id="3653841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3653844">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3653903">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3653961">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3653988">func</span>&nbsp;<span class="op" id="3653993">(</span><span class="ident" id="3653994">ip</span>&nbsp;<span class="ident" id="3653997">IP</span><span class="op" id="3653999">)</span>&nbsp;<span class="ident" id="3654001">Equal</span><span class="op" id="3654006">(</span><span class="ident" id="3654007">x</span>&nbsp;<span class="ident" id="3654009">IP</span><span class="op" id="3654011">)</span>&nbsp;<span class="builtintype" id="3654013">bool</span>&nbsp;<span class="op" id="3654018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654021">if</span>&nbsp;<span class="builtinfunc" id="3654024">len</span><span class="op" id="3654027">(</span><span class="ident" id="3654028">ip</span><span class="op" id="3654030">)</span>&nbsp;<span class="op" id="3654032">==</span>&nbsp;<span class="builtinfunc" id="3654035">len</span><span class="op" id="3654038">(</span><span class="ident" id="3654039">x</span><span class="op" id="3654040">)</span>&nbsp;<span class="op" id="3654042">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654046">return</span>&nbsp;<span class="ident" id="3654053">bytesEqual</span><span class="op" id="3654063">(</span><span class="ident" id="3654064">ip</span><span class="op" id="3654066">,</span>&nbsp;<span class="ident" id="3654068">x</span><span class="op" id="3654069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654075">if</span>&nbsp;<span class="builtinfunc" id="3654078">len</span><span class="op" id="3654081">(</span><span class="ident" id="3654082">ip</span><span class="op" id="3654084">)</span>&nbsp;<span class="op" id="3654086">==</span>&nbsp;<span class="ident" id="3654089">IPv4len</span>&nbsp;<span class="op" id="3654097">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3654100">len</span><span class="op" id="3654103">(</span><span class="ident" id="3654104">x</span><span class="op" id="3654105">)</span>&nbsp;<span class="op" id="3654107">==</span>&nbsp;<span class="ident" id="3654110">IPv6len</span>&nbsp;<span class="op" id="3654118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654122">return</span>&nbsp;<span class="ident" id="3654129">bytesEqual</span><span class="op" id="3654139">(</span><span class="ident" id="3654140">x</span><span class="op" id="3654141">[</span><span class="num" id="3654142">0</span><span class="op" id="3654143">:</span><span class="num" id="3654144">12</span><span class="op" id="3654146">]</span><span class="op" id="3654147">,</span>&nbsp;<span class="ident" id="3654149">v4InV6Prefix</span><span class="op" id="3654161">)</span>&nbsp;<span class="op" id="3654163">&amp;&amp;</span>&nbsp;<span class="ident" id="3654166">bytesEqual</span><span class="op" id="3654176">(</span><span class="ident" id="3654177">ip</span><span class="op" id="3654179">,</span>&nbsp;<span class="ident" id="3654181">x</span><span class="op" id="3654182">[</span><span class="num" id="3654183">12</span><span class="op" id="3654185">:</span><span class="op" id="3654186">]</span><span class="op" id="3654187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654190">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654193">if</span>&nbsp;<span class="builtinfunc" id="3654196">len</span><span class="op" id="3654199">(</span><span class="ident" id="3654200">ip</span><span class="op" id="3654202">)</span>&nbsp;<span class="op" id="3654204">==</span>&nbsp;<span class="ident" id="3654207">IPv6len</span>&nbsp;<span class="op" id="3654215">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3654218">len</span><span class="op" id="3654221">(</span><span class="ident" id="3654222">x</span><span class="op" id="3654223">)</span>&nbsp;<span class="op" id="3654225">==</span>&nbsp;<span class="ident" id="3654228">IPv4len</span>&nbsp;<span class="op" id="3654236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654240">return</span>&nbsp;<span class="ident" id="3654247">bytesEqual</span><span class="op" id="3654257">(</span><span class="ident" id="3654258">ip</span><span class="op" id="3654260">[</span><span class="num" id="3654261">0</span><span class="op" id="3654262">:</span><span class="num" id="3654263">12</span><span class="op" id="3654265">]</span><span class="op" id="3654266">,</span>&nbsp;<span class="ident" id="3654268">v4InV6Prefix</span><span class="op" id="3654280">)</span>&nbsp;<span class="op" id="3654282">&amp;&amp;</span>&nbsp;<span class="ident" id="3654285">bytesEqual</span><span class="op" id="3654295">(</span><span class="ident" id="3654296">ip</span><span class="op" id="3654298">[</span><span class="num" id="3654299">12</span><span class="op" id="3654301">:</span><span class="op" id="3654302">]</span><span class="op" id="3654303">,</span>&nbsp;<span class="ident" id="3654305">x</span><span class="op" id="3654306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654312">return</span>&nbsp;<span class="builtintype" id="3654319">false</span><br>
<span class="lineno"></span><span class="op" id="3654325">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3654328">func</span>&nbsp;<span class="ident" id="3654333">bytesEqual</span><span class="op" id="3654343">(</span><span class="ident" id="3654344">x</span><span class="op" id="3654345">,</span>&nbsp;<span class="ident" id="3654347">y</span>&nbsp;<span class="op" id="3654349">[</span><span class="op" id="3654350">]</span><span class="builtintype" id="3654351">byte</span><span class="op" id="3654355">)</span>&nbsp;<span class="builtintype" id="3654357">bool</span>&nbsp;<span class="op" id="3654362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654365">if</span>&nbsp;<span class="builtinfunc" id="3654368">len</span><span class="op" id="3654371">(</span><span class="ident" id="3654372">x</span><span class="op" id="3654373">)</span>&nbsp;<span class="op" id="3654375">!=</span>&nbsp;<span class="builtinfunc" id="3654378">len</span><span class="op" id="3654381">(</span><span class="ident" id="3654382">y</span><span class="op" id="3654383">)</span>&nbsp;<span class="op" id="3654385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654389">return</span>&nbsp;<span class="builtintype" id="3654396">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654403">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654406">for</span>&nbsp;<span class="ident" id="3654410">i</span><span class="op" id="3654411">,</span>&nbsp;<span class="ident" id="3654413">b</span>&nbsp;<span class="op" id="3654415">:=</span>&nbsp;<span class="keyword" id="3654418">range</span>&nbsp;<span class="ident" id="3654424">x</span>&nbsp;<span class="op" id="3654426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654430">if</span>&nbsp;<span class="ident" id="3654433">y</span><span class="op" id="3654434">[</span><span class="ident" id="3654435">i</span><span class="op" id="3654436">]</span>&nbsp;<span class="op" id="3654438">!=</span>&nbsp;<span class="ident" id="3654441">b</span>&nbsp;<span class="op" id="3654443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654448">return</span>&nbsp;<span class="builtintype" id="3654455">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654466">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654469">return</span>&nbsp;<span class="builtintype" id="3654476">true</span><br>
<span class="lineno"></span><span class="op" id="3654481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654484">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3654539">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3654571">func</span>&nbsp;<span class="ident" id="3654576">simpleMaskLength</span><span class="op" id="3654592">(</span><span class="ident" id="3654593">mask</span>&nbsp;<span class="ident" id="3654598">IPMask</span><span class="op" id="3654604">)</span>&nbsp;<span class="builtintype" id="3654606">int</span>&nbsp;<span class="op" id="3654610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654613">var</span>&nbsp;<span class="ident" id="3654617">n</span>&nbsp;<span class="builtintype" id="3654619">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654624">for</span>&nbsp;<span class="ident" id="3654628">i</span><span class="op" id="3654629">,</span>&nbsp;<span class="ident" id="3654631">v</span>&nbsp;<span class="op" id="3654633">:=</span>&nbsp;<span class="keyword" id="3654636">range</span>&nbsp;<span class="ident" id="3654642">mask</span>&nbsp;<span class="op" id="3654647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654651">if</span>&nbsp;<span class="ident" id="3654654">v</span>&nbsp;<span class="op" id="3654656">==</span>&nbsp;<span class="num" id="3654659">0xff</span>&nbsp;<span class="op" id="3654664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654669">n</span>&nbsp;<span class="op" id="3654671">+=</span>&nbsp;<span class="num" id="3654674">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654679">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3654694">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3654717">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654735">for</span>&nbsp;<span class="ident" id="3654739">v</span><span class="op" id="3654740">&amp;</span><span class="num" id="3654741">0x80</span>&nbsp;<span class="op" id="3654746">!=</span>&nbsp;<span class="num" id="3654749">0</span>&nbsp;<span class="op" id="3654751">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654756">n</span><span class="op" id="3654757">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654763">v</span>&nbsp;<span class="op" id="3654765">&lt;&lt;=</span>&nbsp;<span class="num" id="3654769">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3654777">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654802">if</span>&nbsp;<span class="ident" id="3654805">v</span>&nbsp;<span class="op" id="3654807">!=</span>&nbsp;<span class="num" id="3654810">0</span>&nbsp;<span class="op" id="3654812">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654817">return</span>&nbsp;<span class="op" id="3654824">-</span><span class="num" id="3654825">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654833">for</span>&nbsp;<span class="ident" id="3654837">i</span><span class="op" id="3654838">++</span><span class="op" id="3654840">;</span>&nbsp;<span class="ident" id="3654842">i</span>&nbsp;<span class="op" id="3654844">&lt;</span>&nbsp;<span class="builtinfunc" id="3654846">len</span><span class="op" id="3654849">(</span><span class="ident" id="3654850">mask</span><span class="op" id="3654854">)</span><span class="op" id="3654855">;</span>&nbsp;<span class="ident" id="3654857">i</span><span class="op" id="3654858">++</span>&nbsp;<span class="op" id="3654861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654866">if</span>&nbsp;<span class="ident" id="3654869">mask</span><span class="op" id="3654873">[</span><span class="ident" id="3654874">i</span><span class="op" id="3654875">]</span>&nbsp;<span class="op" id="3654877">!=</span>&nbsp;<span class="num" id="3654880">0</span>&nbsp;<span class="op" id="3654882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654888">return</span>&nbsp;<span class="op" id="3654895">-</span><span class="num" id="3654896">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654909">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654919">return</span>&nbsp;<span class="ident" id="3654926">n</span><br>
<span class="lineno">410</span><span class="op" id="3654928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654931">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3655002">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3655076">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3655098">func</span>&nbsp;<span class="op" id="3655103">(</span><span class="ident" id="3655104">m</span>&nbsp;<span class="ident" id="3655106">IPMask</span><span class="op" id="3655112">)</span>&nbsp;<span class="ident" id="3655114">Size</span><span class="op" id="3655118">(</span><span class="op" id="3655119">)</span>&nbsp;<span class="op" id="3655121">(</span><span class="ident" id="3655122">ones</span><span class="op" id="3655126">,</span>&nbsp;<span class="ident" id="3655128">bits</span>&nbsp;<span class="builtintype" id="3655133">int</span><span class="op" id="3655136">)</span>&nbsp;<span class="op" id="3655138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655141">ones</span><span class="op" id="3655145">,</span>&nbsp;<span class="ident" id="3655147">bits</span>&nbsp;<span class="op" id="3655152">=</span>&nbsp;<span class="ident" id="3655154">simpleMaskLength</span><span class="op" id="3655170">(</span><span class="ident" id="3655171">m</span><span class="op" id="3655172">)</span><span class="op" id="3655173">,</span>&nbsp;<span class="builtinfunc" id="3655175">len</span><span class="op" id="3655178">(</span><span class="ident" id="3655179">m</span><span class="op" id="3655180">)</span><span class="op" id="3655181">*</span><span class="num" id="3655182">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655185">if</span>&nbsp;<span class="ident" id="3655188">ones</span>&nbsp;<span class="op" id="3655193">==</span>&nbsp;<span class="op" id="3655196">-</span><span class="num" id="3655197">1</span>&nbsp;<span class="op" id="3655199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655203">return</span>&nbsp;<span class="num" id="3655210">0</span><span class="op" id="3655211">,</span>&nbsp;<span class="num" id="3655213">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655216">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655219">return</span><br>
<span class="lineno"></span><span class="op" id="3655226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3655229">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3655295">func</span>&nbsp;<span class="op" id="3655300">(</span><span class="ident" id="3655301">m</span>&nbsp;<span class="ident" id="3655303">IPMask</span><span class="op" id="3655309">)</span>&nbsp;<span class="ident" id="3655311">String</span><span class="op" id="3655317">(</span><span class="op" id="3655318">)</span>&nbsp;<span class="builtintype" id="3655320">string</span>&nbsp;<span class="op" id="3655327">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655330">if</span>&nbsp;<span class="builtinfunc" id="3655333">len</span><span class="op" id="3655336">(</span><span class="ident" id="3655337">m</span><span class="op" id="3655338">)</span>&nbsp;<span class="op" id="3655340">==</span>&nbsp;<span class="num" id="3655343">0</span>&nbsp;<span class="op" id="3655345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655349">return</span>&nbsp;<span class="string" id="3655356">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655368">buf</span>&nbsp;<span class="op" id="3655372">:=</span>&nbsp;<span class="builtinfunc" id="3655375">make</span><span class="op" id="3655379">(</span><span class="op" id="3655380">[</span><span class="op" id="3655381">]</span><span class="builtintype" id="3655382">byte</span><span class="op" id="3655386">,</span>&nbsp;<span class="builtinfunc" id="3655388">len</span><span class="op" id="3655391">(</span><span class="ident" id="3655392">m</span><span class="op" id="3655393">)</span><span class="op" id="3655394">*</span><span class="num" id="3655395">2</span><span class="op" id="3655396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655399">for</span>&nbsp;<span class="ident" id="3655403">i</span><span class="op" id="3655404">,</span>&nbsp;<span class="ident" id="3655406">b</span>&nbsp;<span class="op" id="3655408">:=</span>&nbsp;<span class="keyword" id="3655411">range</span>&nbsp;<span class="ident" id="3655417">m</span>&nbsp;<span class="op" id="3655419">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655423">buf</span><span class="op" id="3655426">[</span><span class="ident" id="3655427">i</span><span class="op" id="3655428">*</span><span class="num" id="3655429">2</span><span class="op" id="3655430">]</span><span class="op" id="3655431">,</span>&nbsp;<span class="ident" id="3655433">buf</span><span class="op" id="3655436">[</span><span class="ident" id="3655437">i</span><span class="op" id="3655438">*</span><span class="num" id="3655439">2</span><span class="op" id="3655440">+</span><span class="num" id="3655441">1</span><span class="op" id="3655442">]</span>&nbsp;<span class="op" id="3655444">=</span>&nbsp;<span class="ident" id="3655446">hexDigit</span><span class="op" id="3655454">[</span><span class="ident" id="3655455">b</span><span class="op" id="3655456">&gt;&gt;</span><span class="num" id="3655458">4</span><span class="op" id="3655459">]</span><span class="op" id="3655460">,</span>&nbsp;<span class="ident" id="3655462">hexDigit</span><span class="op" id="3655470">[</span><span class="ident" id="3655471">b</span><span class="op" id="3655472">&amp;</span><span class="num" id="3655473">0xf</span><span class="op" id="3655476">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655482">return</span>&nbsp;<span class="builtintype" id="3655489">string</span><span class="op" id="3655495">(</span><span class="ident" id="3655496">buf</span><span class="op" id="3655499">)</span><br>
<span class="lineno"></span><span class="op" id="3655501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3655504">func</span>&nbsp;<span class="ident" id="3655509">networkNumberAndMask</span><span class="op" id="3655529">(</span><span class="ident" id="3655530">n</span>&nbsp;<span class="op" id="3655532">*</span><span class="ident" id="3655533">IPNet</span><span class="op" id="3655538">)</span>&nbsp;<span class="op" id="3655540">(</span><span class="ident" id="3655541">ip</span>&nbsp;<span class="ident" id="3655544">IP</span><span class="op" id="3655546">,</span>&nbsp;<span class="ident" id="3655548">m</span>&nbsp;<span class="ident" id="3655550">IPMask</span><span class="op" id="3655556">)</span>&nbsp;<span class="op" id="3655558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655561">if</span>&nbsp;<span class="ident" id="3655564">ip</span>&nbsp;<span class="op" id="3655567">=</span>&nbsp;<span class="ident" id="3655569">n</span><span class="op" id="3655570">.</span><span class="ident" id="3655571">IP</span><span class="op" id="3655573">.</span><span class="ident" id="3655574">To4</span><span class="op" id="3655577">(</span><span class="op" id="3655578">)</span><span class="op" id="3655579">;</span>&nbsp;<span class="ident" id="3655581">ip</span>&nbsp;<span class="op" id="3655584">==</span>&nbsp;<span class="ident" id="3655587">nil</span>&nbsp;<span class="op" id="3655591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655595">ip</span>&nbsp;<span class="op" id="3655598">=</span>&nbsp;<span class="ident" id="3655600">n</span><span class="op" id="3655601">.</span><span class="ident" id="3655602">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655607">if</span>&nbsp;<span class="builtinfunc" id="3655610">len</span><span class="op" id="3655613">(</span><span class="ident" id="3655614">ip</span><span class="op" id="3655616">)</span>&nbsp;<span class="op" id="3655618">!=</span>&nbsp;<span class="ident" id="3655621">IPv6len</span>&nbsp;<span class="op" id="3655629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655634">return</span>&nbsp;<span class="ident" id="3655641">nil</span><span class="op" id="3655644">,</span>&nbsp;<span class="ident" id="3655646">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655658">m</span>&nbsp;<span class="op" id="3655660">=</span>&nbsp;<span class="ident" id="3655662">n</span><span class="op" id="3655663">.</span><span class="ident" id="3655664">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655670">switch</span>&nbsp;<span class="builtinfunc" id="3655677">len</span><span class="op" id="3655680">(</span><span class="ident" id="3655681">m</span><span class="op" id="3655682">)</span>&nbsp;<span class="op" id="3655684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655687">case</span>&nbsp;<span class="ident" id="3655692">IPv4len</span><span class="op" id="3655699">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655703">if</span>&nbsp;<span class="builtinfunc" id="3655706">len</span><span class="op" id="3655709">(</span><span class="ident" id="3655710">ip</span><span class="op" id="3655712">)</span>&nbsp;<span class="op" id="3655714">!=</span>&nbsp;<span class="ident" id="3655717">IPv4len</span>&nbsp;<span class="op" id="3655725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655730">return</span>&nbsp;<span class="ident" id="3655737">nil</span><span class="op" id="3655740">,</span>&nbsp;<span class="ident" id="3655742">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655751">case</span>&nbsp;<span class="ident" id="3655756">IPv6len</span><span class="op" id="3655763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655767">if</span>&nbsp;<span class="builtinfunc" id="3655770">len</span><span class="op" id="3655773">(</span><span class="ident" id="3655774">ip</span><span class="op" id="3655776">)</span>&nbsp;<span class="op" id="3655778">==</span>&nbsp;<span class="ident" id="3655781">IPv4len</span>&nbsp;<span class="op" id="3655789">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655794">m</span>&nbsp;<span class="op" id="3655796">=</span>&nbsp;<span class="ident" id="3655798">m</span><span class="op" id="3655799">[</span><span class="num" id="3655800">12</span><span class="op" id="3655802">:</span><span class="op" id="3655803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655810">default</span><span class="op" id="3655817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655821">return</span>&nbsp;<span class="ident" id="3655828">nil</span><span class="op" id="3655831">,</span>&nbsp;<span class="ident" id="3655833">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655838">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655841">return</span><br>
<span class="lineno"></span><span class="op" id="3655848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3655851">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3655904">func</span>&nbsp;<span class="op" id="3655909">(</span><span class="ident" id="3655910">n</span>&nbsp;<span class="op" id="3655912">*</span><span class="ident" id="3655913">IPNet</span><span class="op" id="3655918">)</span>&nbsp;<span class="ident" id="3655920">Contains</span><span class="op" id="3655928">(</span><span class="ident" id="3655929">ip</span>&nbsp;<span class="ident" id="3655932">IP</span><span class="op" id="3655934">)</span>&nbsp;<span class="builtintype" id="3655936">bool</span>&nbsp;<span class="op" id="3655941">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655944">nn</span><span class="op" id="3655946">,</span>&nbsp;<span class="ident" id="3655948">m</span>&nbsp;<span class="op" id="3655950">:=</span>&nbsp;<span class="ident" id="3655953">networkNumberAndMask</span><span class="op" id="3655973">(</span><span class="ident" id="3655974">n</span><span class="op" id="3655975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655978">if</span>&nbsp;<span class="ident" id="3655981">x</span>&nbsp;<span class="op" id="3655983">:=</span>&nbsp;<span class="ident" id="3655986">ip</span><span class="op" id="3655988">.</span><span class="ident" id="3655989">To4</span><span class="op" id="3655992">(</span><span class="op" id="3655993">)</span><span class="op" id="3655994">;</span>&nbsp;<span class="ident" id="3655996">x</span>&nbsp;<span class="op" id="3655998">!=</span>&nbsp;<span class="ident" id="3656001">nil</span>&nbsp;<span class="op" id="3656005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656009">ip</span>&nbsp;<span class="op" id="3656012">=</span>&nbsp;<span class="ident" id="3656014">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656020">l</span>&nbsp;<span class="op" id="3656022">:=</span>&nbsp;<span class="builtinfunc" id="3656025">len</span><span class="op" id="3656028">(</span><span class="ident" id="3656029">ip</span><span class="op" id="3656031">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656034">if</span>&nbsp;<span class="ident" id="3656037">l</span>&nbsp;<span class="op" id="3656039">!=</span>&nbsp;<span class="builtinfunc" id="3656042">len</span><span class="op" id="3656045">(</span><span class="ident" id="3656046">nn</span><span class="op" id="3656048">)</span>&nbsp;<span class="op" id="3656050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656054">return</span>&nbsp;<span class="builtintype" id="3656061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656071">for</span>&nbsp;<span class="ident" id="3656075">i</span>&nbsp;<span class="op" id="3656077">:=</span>&nbsp;<span class="num" id="3656080">0</span><span class="op" id="3656081">;</span>&nbsp;<span class="ident" id="3656083">i</span>&nbsp;<span class="op" id="3656085">&lt;</span>&nbsp;<span class="ident" id="3656087">l</span><span class="op" id="3656088">;</span>&nbsp;<span class="ident" id="3656090">i</span><span class="op" id="3656091">++</span>&nbsp;<span class="op" id="3656094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656098">if</span>&nbsp;<span class="ident" id="3656101">nn</span><span class="op" id="3656103">[</span><span class="ident" id="3656104">i</span><span class="op" id="3656105">]</span><span class="op" id="3656106">&amp;</span><span class="ident" id="3656107">m</span><span class="op" id="3656108">[</span><span class="ident" id="3656109">i</span><span class="op" id="3656110">]</span>&nbsp;<span class="op" id="3656112">!=</span>&nbsp;<span class="ident" id="3656115">ip</span><span class="op" id="3656117">[</span><span class="ident" id="3656118">i</span><span class="op" id="3656119">]</span><span class="op" id="3656120">&amp;</span><span class="ident" id="3656121">m</span><span class="op" id="3656122">[</span><span class="ident" id="3656123">i</span><span class="op" id="3656124">]</span>&nbsp;<span class="op" id="3656126">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656131">return</span>&nbsp;<span class="builtintype" id="3656138">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656152">return</span>&nbsp;<span class="builtintype" id="3656159">true</span><br>
<span class="lineno"></span><span class="op" id="3656164">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3656167">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3656224">func</span>&nbsp;<span class="op" id="3656229">(</span><span class="ident" id="3656230">n</span>&nbsp;<span class="op" id="3656232">*</span><span class="ident" id="3656233">IPNet</span><span class="op" id="3656238">)</span>&nbsp;<span class="ident" id="3656240">Network</span><span class="op" id="3656247">(</span><span class="op" id="3656248">)</span>&nbsp;<span class="builtintype" id="3656250">string</span>&nbsp;<span class="op" id="3656257">{</span>&nbsp;<span class="keyword" id="3656259">return</span>&nbsp;<span class="string" id="3656266">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3656275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3656278">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3656343">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3656402">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3656462">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3656525">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3656587">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3656633">func</span>&nbsp;<span class="op" id="3656638">(</span><span class="ident" id="3656639">n</span>&nbsp;<span class="op" id="3656641">*</span><span class="ident" id="3656642">IPNet</span><span class="op" id="3656647">)</span>&nbsp;<span class="ident" id="3656649">String</span><span class="op" id="3656655">(</span><span class="op" id="3656656">)</span>&nbsp;<span class="builtintype" id="3656658">string</span>&nbsp;<span class="op" id="3656665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656668">nn</span><span class="op" id="3656670">,</span>&nbsp;<span class="ident" id="3656672">m</span>&nbsp;<span class="op" id="3656674">:=</span>&nbsp;<span class="ident" id="3656677">networkNumberAndMask</span><span class="op" id="3656697">(</span><span class="ident" id="3656698">n</span><span class="op" id="3656699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656702">if</span>&nbsp;<span class="ident" id="3656705">nn</span>&nbsp;<span class="op" id="3656708">==</span>&nbsp;<span class="ident" id="3656711">nil</span>&nbsp;<span class="op" id="3656715">||</span>&nbsp;<span class="ident" id="3656718">m</span>&nbsp;<span class="op" id="3656720">==</span>&nbsp;<span class="ident" id="3656723">nil</span>&nbsp;<span class="op" id="3656727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656731">return</span>&nbsp;<span class="string" id="3656738">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656747">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656750">l</span>&nbsp;<span class="op" id="3656752">:=</span>&nbsp;<span class="ident" id="3656755">simpleMaskLength</span><span class="op" id="3656771">(</span><span class="ident" id="3656772">m</span><span class="op" id="3656773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656776">if</span>&nbsp;<span class="ident" id="3656779">l</span>&nbsp;<span class="op" id="3656781">==</span>&nbsp;<span class="op" id="3656784">-</span><span class="num" id="3656785">1</span>&nbsp;<span class="op" id="3656787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656791">return</span>&nbsp;<span class="ident" id="3656798">nn</span><span class="op" id="3656800">.</span><span class="ident" id="3656801">String</span><span class="op" id="3656807">(</span><span class="op" id="3656808">)</span>&nbsp;<span class="op" id="3656810">+</span>&nbsp;<span class="string" id="3656812">&#34;/&#34;</span>&nbsp;<span class="op" id="3656816">+</span>&nbsp;<span class="ident" id="3656818">m</span><span class="op" id="3656819">.</span><span class="ident" id="3656820">String</span><span class="op" id="3656826">(</span><span class="op" id="3656827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656833">return</span>&nbsp;<span class="ident" id="3656840">nn</span><span class="op" id="3656842">.</span><span class="ident" id="3656843">String</span><span class="op" id="3656849">(</span><span class="op" id="3656850">)</span>&nbsp;<span class="op" id="3656852">+</span>&nbsp;<span class="string" id="3656854">&#34;/&#34;</span>&nbsp;<span class="op" id="3656858">+</span>&nbsp;<span class="ident" id="3656860">itod</span><span class="op" id="3656864">(</span><span class="builtintype" id="3656865">uint</span><span class="op" id="3656869">(</span><span class="ident" id="3656870">l</span><span class="op" id="3656871">)</span><span class="op" id="3656872">)</span><br>
<span class="lineno">495</span><span class="op" id="3656874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3656877">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3656910">func</span>&nbsp;<span class="ident" id="3656915">parseIPv4</span><span class="op" id="3656924">(</span><span class="ident" id="3656925">s</span>&nbsp;<span class="builtintype" id="3656927">string</span><span class="op" id="3656933">)</span>&nbsp;<span class="ident" id="3656935">IP</span>&nbsp;<span class="op" id="3656938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656941">var</span>&nbsp;<span class="ident" id="3656945">p</span>&nbsp;<span class="op" id="3656947">[</span><span class="ident" id="3656948">IPv4len</span><span class="op" id="3656955">]</span><span class="builtintype" id="3656956">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656962">i</span>&nbsp;<span class="op" id="3656964">:=</span>&nbsp;<span class="num" id="3656967">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656970">for</span>&nbsp;<span class="ident" id="3656974">j</span>&nbsp;<span class="op" id="3656976">:=</span>&nbsp;<span class="num" id="3656979">0</span><span class="op" id="3656980">;</span>&nbsp;<span class="ident" id="3656982">j</span>&nbsp;<span class="op" id="3656984">&lt;</span>&nbsp;<span class="ident" id="3656986">IPv4len</span><span class="op" id="3656993">;</span>&nbsp;<span class="ident" id="3656995">j</span><span class="op" id="3656996">++</span>&nbsp;<span class="op" id="3656999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657003">if</span>&nbsp;<span class="ident" id="3657006">i</span>&nbsp;<span class="op" id="3657008">&gt;=</span>&nbsp;<span class="builtinfunc" id="3657011">len</span><span class="op" id="3657014">(</span><span class="ident" id="3657015">s</span><span class="op" id="3657016">)</span>&nbsp;<span class="op" id="3657018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657023">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657045">return</span>&nbsp;<span class="ident" id="3657052">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657062">if</span>&nbsp;<span class="ident" id="3657065">j</span>&nbsp;<span class="op" id="3657067">&gt;</span>&nbsp;<span class="num" id="3657069">0</span>&nbsp;<span class="op" id="3657071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657076">if</span>&nbsp;<span class="ident" id="3657079">s</span><span class="op" id="3657080">[</span><span class="ident" id="3657081">i</span><span class="op" id="3657082">]</span>&nbsp;<span class="op" id="3657084">!=</span>&nbsp;<span class="string" id="3657087">&#39;.&#39;</span>&nbsp;<span class="op" id="3657091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657097">return</span>&nbsp;<span class="ident" id="3657104">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657111">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657116">i</span><span class="op" id="3657117">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657126">var</span>&nbsp;<span class="op" id="3657130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657135">n</span>&nbsp;&nbsp;<span class="builtintype" id="3657138">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657145">ok</span>&nbsp;<span class="builtintype" id="3657148">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657159">n</span><span class="op" id="3657160">,</span>&nbsp;<span class="ident" id="3657162">i</span><span class="op" id="3657163">,</span>&nbsp;<span class="ident" id="3657165">ok</span>&nbsp;<span class="op" id="3657168">=</span>&nbsp;<span class="ident" id="3657170">dtoi</span><span class="op" id="3657174">(</span><span class="ident" id="3657175">s</span><span class="op" id="3657176">,</span>&nbsp;<span class="ident" id="3657178">i</span><span class="op" id="3657179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657183">if</span>&nbsp;<span class="op" id="3657186">!</span><span class="ident" id="3657187">ok</span>&nbsp;<span class="op" id="3657190">||</span>&nbsp;<span class="ident" id="3657193">n</span>&nbsp;<span class="op" id="3657195">&gt;</span>&nbsp;<span class="num" id="3657197">0xFF</span>&nbsp;<span class="op" id="3657202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657207">return</span>&nbsp;<span class="ident" id="3657214">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657220">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657224">p</span><span class="op" id="3657225">[</span><span class="ident" id="3657226">j</span><span class="op" id="3657227">]</span>&nbsp;<span class="op" id="3657229">=</span>&nbsp;<span class="builtintype" id="3657231">byte</span><span class="op" id="3657235">(</span><span class="ident" id="3657236">n</span><span class="op" id="3657237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657243">if</span>&nbsp;<span class="ident" id="3657246">i</span>&nbsp;<span class="op" id="3657248">!=</span>&nbsp;<span class="builtinfunc" id="3657251">len</span><span class="op" id="3657254">(</span><span class="ident" id="3657255">s</span><span class="op" id="3657256">)</span>&nbsp;<span class="op" id="3657258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657262">return</span>&nbsp;<span class="ident" id="3657269">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657274">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657277">return</span>&nbsp;<span class="ident" id="3657284">IPv4</span><span class="op" id="3657288">(</span><span class="ident" id="3657289">p</span><span class="op" id="3657290">[</span><span class="num" id="3657291">0</span><span class="op" id="3657292">]</span><span class="op" id="3657293">,</span>&nbsp;<span class="ident" id="3657295">p</span><span class="op" id="3657296">[</span><span class="num" id="3657297">1</span><span class="op" id="3657298">]</span><span class="op" id="3657299">,</span>&nbsp;<span class="ident" id="3657301">p</span><span class="op" id="3657302">[</span><span class="num" id="3657303">2</span><span class="op" id="3657304">]</span><span class="op" id="3657305">,</span>&nbsp;<span class="ident" id="3657307">p</span><span class="op" id="3657308">[</span><span class="num" id="3657309">3</span><span class="op" id="3657310">]</span><span class="op" id="3657311">)</span><br>
<span class="lineno"></span><span class="op" id="3657313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3657316">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3657386">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3657457">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3657527">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3657536">func</span>&nbsp;<span class="ident" id="3657541">parseIPv6</span><span class="op" id="3657550">(</span><span class="ident" id="3657551">s</span>&nbsp;<span class="builtintype" id="3657553">string</span><span class="op" id="3657559">,</span>&nbsp;<span class="ident" id="3657561">zoneAllowed</span>&nbsp;<span class="builtintype" id="3657573">bool</span><span class="op" id="3657577">)</span>&nbsp;<span class="op" id="3657579">(</span><span class="ident" id="3657580">ip</span>&nbsp;<span class="ident" id="3657583">IP</span><span class="op" id="3657585">,</span>&nbsp;<span class="ident" id="3657587">zone</span>&nbsp;<span class="builtintype" id="3657592">string</span><span class="op" id="3657598">)</span>&nbsp;<span class="op" id="3657600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657603">ip</span>&nbsp;<span class="op" id="3657606">=</span>&nbsp;<span class="builtinfunc" id="3657608">make</span><span class="op" id="3657612">(</span><span class="ident" id="3657613">IP</span><span class="op" id="3657615">,</span>&nbsp;<span class="ident" id="3657617">IPv6len</span><span class="op" id="3657624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657627">ellipsis</span>&nbsp;<span class="op" id="3657636">:=</span>&nbsp;<span class="op" id="3657639">-</span><span class="num" id="3657640">1</span>&nbsp;<span class="comment" id="3657642">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657672">i</span>&nbsp;<span class="op" id="3657674">:=</span>&nbsp;<span class="num" id="3657677">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3657687">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657710">if</span>&nbsp;<span class="ident" id="3657713">zoneAllowed</span>&nbsp;<span class="op" id="3657725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657729">s</span><span class="op" id="3657730">,</span>&nbsp;<span class="ident" id="3657732">zone</span>&nbsp;<span class="op" id="3657737">=</span>&nbsp;<span class="ident" id="3657739">splitHostZone</span><span class="op" id="3657752">(</span><span class="ident" id="3657753">s</span><span class="op" id="3657754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657757">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657761">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657793">if</span>&nbsp;<span class="builtinfunc" id="3657796">len</span><span class="op" id="3657799">(</span><span class="ident" id="3657800">s</span><span class="op" id="3657801">)</span>&nbsp;<span class="op" id="3657803">&gt;=</span>&nbsp;<span class="num" id="3657806">2</span>&nbsp;<span class="op" id="3657808">&amp;&amp;</span>&nbsp;<span class="ident" id="3657811">s</span><span class="op" id="3657812">[</span><span class="num" id="3657813">0</span><span class="op" id="3657814">]</span>&nbsp;<span class="op" id="3657816">==</span>&nbsp;<span class="string" id="3657819">&#39;:&#39;</span>&nbsp;<span class="op" id="3657823">&amp;&amp;</span>&nbsp;<span class="ident" id="3657826">s</span><span class="op" id="3657827">[</span><span class="num" id="3657828">1</span><span class="op" id="3657829">]</span>&nbsp;<span class="op" id="3657831">==</span>&nbsp;<span class="string" id="3657834">&#39;:&#39;</span>&nbsp;<span class="op" id="3657838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657842">ellipsis</span>&nbsp;<span class="op" id="3657851">=</span>&nbsp;<span class="num" id="3657853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657857">i</span>&nbsp;<span class="op" id="3657859">=</span>&nbsp;<span class="num" id="3657861">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657865">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657893">if</span>&nbsp;<span class="ident" id="3657896">i</span>&nbsp;<span class="op" id="3657898">==</span>&nbsp;<span class="builtinfunc" id="3657901">len</span><span class="op" id="3657904">(</span><span class="ident" id="3657905">s</span><span class="op" id="3657906">)</span>&nbsp;<span class="op" id="3657908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657913">return</span>&nbsp;<span class="ident" id="3657920">ip</span><span class="op" id="3657922">,</span>&nbsp;<span class="ident" id="3657924">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657934">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657938">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657987">j</span>&nbsp;<span class="op" id="3657989">:=</span>&nbsp;<span class="num" id="3657992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657995">for</span>&nbsp;<span class="ident" id="3657999">j</span>&nbsp;<span class="op" id="3658001">&lt;</span>&nbsp;<span class="ident" id="3658003">IPv6len</span>&nbsp;<span class="op" id="3658011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658015">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658032">n</span><span class="op" id="3658033">,</span>&nbsp;<span class="ident" id="3658035">i1</span><span class="op" id="3658037">,</span>&nbsp;<span class="ident" id="3658039">ok</span>&nbsp;<span class="op" id="3658042">:=</span>&nbsp;<span class="ident" id="3658045">xtoi</span><span class="op" id="3658049">(</span><span class="ident" id="3658050">s</span><span class="op" id="3658051">,</span>&nbsp;<span class="ident" id="3658053">i</span><span class="op" id="3658054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658058">if</span>&nbsp;<span class="op" id="3658061">!</span><span class="ident" id="3658062">ok</span>&nbsp;<span class="op" id="3658065">||</span>&nbsp;<span class="ident" id="3658068">n</span>&nbsp;<span class="op" id="3658070">&gt;</span>&nbsp;<span class="num" id="3658072">0xFFFF</span>&nbsp;<span class="op" id="3658079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658084">return</span>&nbsp;<span class="ident" id="3658091">nil</span><span class="op" id="3658094">,</span>&nbsp;<span class="ident" id="3658096">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658108">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658160">if</span>&nbsp;<span class="ident" id="3658163">i1</span>&nbsp;<span class="op" id="3658166">&lt;</span>&nbsp;<span class="builtinfunc" id="3658168">len</span><span class="op" id="3658171">(</span><span class="ident" id="3658172">s</span><span class="op" id="3658173">)</span>&nbsp;<span class="op" id="3658175">&amp;&amp;</span>&nbsp;<span class="ident" id="3658178">s</span><span class="op" id="3658179">[</span><span class="ident" id="3658180">i1</span><span class="op" id="3658182">]</span>&nbsp;<span class="op" id="3658184">==</span>&nbsp;<span class="string" id="3658187">&#39;.&#39;</span>&nbsp;<span class="op" id="3658191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658196">if</span>&nbsp;<span class="ident" id="3658199">ellipsis</span>&nbsp;<span class="op" id="3658208">&lt;</span>&nbsp;<span class="num" id="3658210">0</span>&nbsp;<span class="op" id="3658212">&amp;&amp;</span>&nbsp;<span class="ident" id="3658215">j</span>&nbsp;<span class="op" id="3658217">!=</span>&nbsp;<span class="ident" id="3658220">IPv6len</span><span class="op" id="3658227">-</span><span class="ident" id="3658228">IPv4len</span>&nbsp;<span class="op" id="3658236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658242">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658270">return</span>&nbsp;<span class="ident" id="3658277">nil</span><span class="op" id="3658280">,</span>&nbsp;<span class="ident" id="3658282">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658295">if</span>&nbsp;<span class="ident" id="3658298">j</span><span class="op" id="3658299">+</span><span class="ident" id="3658300">IPv4len</span>&nbsp;<span class="op" id="3658308">&gt;</span>&nbsp;<span class="ident" id="3658310">IPv6len</span>&nbsp;<span class="op" id="3658318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658324">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658348">return</span>&nbsp;<span class="ident" id="3658355">nil</span><span class="op" id="3658358">,</span>&nbsp;<span class="ident" id="3658360">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658368">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658373">ip4</span>&nbsp;<span class="op" id="3658377">:=</span>&nbsp;<span class="ident" id="3658380">parseIPv4</span><span class="op" id="3658389">(</span><span class="ident" id="3658390">s</span><span class="op" id="3658391">[</span><span class="ident" id="3658392">i</span><span class="op" id="3658393">:</span><span class="op" id="3658394">]</span><span class="op" id="3658395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658400">if</span>&nbsp;<span class="ident" id="3658403">ip4</span>&nbsp;<span class="op" id="3658407">==</span>&nbsp;<span class="ident" id="3658410">nil</span>&nbsp;<span class="op" id="3658414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658420">return</span>&nbsp;<span class="ident" id="3658427">nil</span><span class="op" id="3658430">,</span>&nbsp;<span class="ident" id="3658432">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658445">ip</span><span class="op" id="3658447">[</span><span class="ident" id="3658448">j</span><span class="op" id="3658449">]</span>&nbsp;<span class="op" id="3658451">=</span>&nbsp;<span class="ident" id="3658453">ip4</span><span class="op" id="3658456">[</span><span class="num" id="3658457">12</span><span class="op" id="3658459">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658464">ip</span><span class="op" id="3658466">[</span><span class="ident" id="3658467">j</span><span class="op" id="3658468">+</span><span class="num" id="3658469">1</span><span class="op" id="3658470">]</span>&nbsp;<span class="op" id="3658472">=</span>&nbsp;<span class="ident" id="3658474">ip4</span><span class="op" id="3658477">[</span><span class="num" id="3658478">13</span><span class="op" id="3658480">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658485">ip</span><span class="op" id="3658487">[</span><span class="ident" id="3658488">j</span><span class="op" id="3658489">+</span><span class="num" id="3658490">2</span><span class="op" id="3658491">]</span>&nbsp;<span class="op" id="3658493">=</span>&nbsp;<span class="ident" id="3658495">ip4</span><span class="op" id="3658498">[</span><span class="num" id="3658499">14</span><span class="op" id="3658501">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658506">ip</span><span class="op" id="3658508">[</span><span class="ident" id="3658509">j</span><span class="op" id="3658510">+</span><span class="num" id="3658511">3</span><span class="op" id="3658512">]</span>&nbsp;<span class="op" id="3658514">=</span>&nbsp;<span class="ident" id="3658516">ip4</span><span class="op" id="3658519">[</span><span class="num" id="3658520">15</span><span class="op" id="3658522">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658527">i</span>&nbsp;<span class="op" id="3658529">=</span>&nbsp;<span class="builtinfunc" id="3658531">len</span><span class="op" id="3658534">(</span><span class="ident" id="3658535">s</span><span class="op" id="3658536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658541">j</span>&nbsp;<span class="op" id="3658543">+=</span>&nbsp;<span class="ident" id="3658546">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658557">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658570">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658599">ip</span><span class="op" id="3658601">[</span><span class="ident" id="3658602">j</span><span class="op" id="3658603">]</span>&nbsp;<span class="op" id="3658605">=</span>&nbsp;<span class="builtintype" id="3658607">byte</span><span class="op" id="3658611">(</span><span class="ident" id="3658612">n</span>&nbsp;<span class="op" id="3658614">&gt;&gt;</span>&nbsp;<span class="num" id="3658617">8</span><span class="op" id="3658618">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658622">ip</span><span class="op" id="3658624">[</span><span class="ident" id="3658625">j</span><span class="op" id="3658626">+</span><span class="num" id="3658627">1</span><span class="op" id="3658628">]</span>&nbsp;<span class="op" id="3658630">=</span>&nbsp;<span class="builtintype" id="3658632">byte</span><span class="op" id="3658636">(</span><span class="ident" id="3658637">n</span><span class="op" id="3658638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658642">j</span>&nbsp;<span class="op" id="3658644">+=</span>&nbsp;<span class="num" id="3658647">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658652">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658680">i</span>&nbsp;<span class="op" id="3658682">=</span>&nbsp;<span class="ident" id="3658684">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658689">if</span>&nbsp;<span class="ident" id="3658692">i</span>&nbsp;<span class="op" id="3658694">==</span>&nbsp;<span class="builtinfunc" id="3658697">len</span><span class="op" id="3658700">(</span><span class="ident" id="3658701">s</span><span class="op" id="3658702">)</span>&nbsp;<span class="op" id="3658704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658709">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658722">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658773">if</span>&nbsp;<span class="ident" id="3658776">s</span><span class="op" id="3658777">[</span><span class="ident" id="3658778">i</span><span class="op" id="3658779">]</span>&nbsp;<span class="op" id="3658781">!=</span>&nbsp;<span class="string" id="3658784">&#39;:&#39;</span>&nbsp;<span class="op" id="3658788">||</span>&nbsp;<span class="ident" id="3658791">i</span><span class="op" id="3658792">+</span><span class="num" id="3658793">1</span>&nbsp;<span class="op" id="3658795">==</span>&nbsp;<span class="builtinfunc" id="3658798">len</span><span class="op" id="3658801">(</span><span class="ident" id="3658802">s</span><span class="op" id="3658803">)</span>&nbsp;<span class="op" id="3658805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658810">return</span>&nbsp;<span class="ident" id="3658817">nil</span><span class="op" id="3658820">,</span>&nbsp;<span class="ident" id="3658822">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658833">i</span><span class="op" id="3658834">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658840">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658864">if</span>&nbsp;<span class="ident" id="3658867">s</span><span class="op" id="3658868">[</span><span class="ident" id="3658869">i</span><span class="op" id="3658870">]</span>&nbsp;<span class="op" id="3658872">==</span>&nbsp;<span class="string" id="3658875">&#39;:&#39;</span>&nbsp;<span class="op" id="3658879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658884">if</span>&nbsp;<span class="ident" id="3658887">ellipsis</span>&nbsp;<span class="op" id="3658896">&gt;=</span>&nbsp;<span class="num" id="3658899">0</span>&nbsp;<span class="op" id="3658901">{</span>&nbsp;<span class="comment" id="3658903">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658927">return</span>&nbsp;<span class="ident" id="3658934">nil</span><span class="op" id="3658937">,</span>&nbsp;<span class="ident" id="3658939">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658947">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658952">ellipsis</span>&nbsp;<span class="op" id="3658961">=</span>&nbsp;<span class="ident" id="3658963">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658968">if</span>&nbsp;<span class="ident" id="3658971">i</span><span class="op" id="3658972">++</span><span class="op" id="3658974">;</span>&nbsp;<span class="ident" id="3658976">i</span>&nbsp;<span class="op" id="3658978">==</span>&nbsp;<span class="builtinfunc" id="3658981">len</span><span class="op" id="3658984">(</span><span class="ident" id="3658985">s</span><span class="op" id="3658986">)</span>&nbsp;<span class="op" id="3658988">{</span>&nbsp;<span class="comment" id="3658990">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659011">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659024">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659031">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659065">if</span>&nbsp;<span class="ident" id="3659068">i</span>&nbsp;<span class="op" id="3659070">!=</span>&nbsp;<span class="builtinfunc" id="3659073">len</span><span class="op" id="3659076">(</span><span class="ident" id="3659077">s</span><span class="op" id="3659078">)</span>&nbsp;<span class="op" id="3659080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659084">return</span>&nbsp;<span class="ident" id="3659091">nil</span><span class="op" id="3659094">,</span>&nbsp;<span class="ident" id="3659096">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659106">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659151">if</span>&nbsp;<span class="ident" id="3659154">j</span>&nbsp;<span class="op" id="3659156">&lt;</span>&nbsp;<span class="ident" id="3659158">IPv6len</span>&nbsp;<span class="op" id="3659166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659170">if</span>&nbsp;<span class="ident" id="3659173">ellipsis</span>&nbsp;<span class="op" id="3659182">&lt;</span>&nbsp;<span class="num" id="3659184">0</span>&nbsp;<span class="op" id="3659186">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659191">return</span>&nbsp;<span class="ident" id="3659198">nil</span><span class="op" id="3659201">,</span>&nbsp;<span class="ident" id="3659203">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659214">n</span>&nbsp;<span class="op" id="3659216">:=</span>&nbsp;<span class="ident" id="3659219">IPv6len</span>&nbsp;<span class="op" id="3659227">-</span>&nbsp;<span class="ident" id="3659229">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659233">for</span>&nbsp;<span class="ident" id="3659237">k</span>&nbsp;<span class="op" id="3659239">:=</span>&nbsp;<span class="ident" id="3659242">j</span>&nbsp;<span class="op" id="3659244">-</span>&nbsp;<span class="num" id="3659246">1</span><span class="op" id="3659247">;</span>&nbsp;<span class="ident" id="3659249">k</span>&nbsp;<span class="op" id="3659251">&gt;=</span>&nbsp;<span class="ident" id="3659254">ellipsis</span><span class="op" id="3659262">;</span>&nbsp;<span class="ident" id="3659264">k</span><span class="op" id="3659265">--</span>&nbsp;<span class="op" id="3659268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659273">ip</span><span class="op" id="3659275">[</span><span class="ident" id="3659276">k</span><span class="op" id="3659277">+</span><span class="ident" id="3659278">n</span><span class="op" id="3659279">]</span>&nbsp;<span class="op" id="3659281">=</span>&nbsp;<span class="ident" id="3659283">ip</span><span class="op" id="3659285">[</span><span class="ident" id="3659286">k</span><span class="op" id="3659287">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659295">for</span>&nbsp;<span class="ident" id="3659299">k</span>&nbsp;<span class="op" id="3659301">:=</span>&nbsp;<span class="ident" id="3659304">ellipsis</span>&nbsp;<span class="op" id="3659313">+</span>&nbsp;<span class="ident" id="3659315">n</span>&nbsp;<span class="op" id="3659317">-</span>&nbsp;<span class="num" id="3659319">1</span><span class="op" id="3659320">;</span>&nbsp;<span class="ident" id="3659322">k</span>&nbsp;<span class="op" id="3659324">&gt;=</span>&nbsp;<span class="ident" id="3659327">ellipsis</span><span class="op" id="3659335">;</span>&nbsp;<span class="ident" id="3659337">k</span><span class="op" id="3659338">--</span>&nbsp;<span class="op" id="3659341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659346">ip</span><span class="op" id="3659348">[</span><span class="ident" id="3659349">k</span><span class="op" id="3659350">]</span>&nbsp;<span class="op" id="3659352">=</span>&nbsp;<span class="num" id="3659354">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659361">}</span>&nbsp;<span class="keyword" id="3659363">else</span>&nbsp;<span class="keyword" id="3659368">if</span>&nbsp;<span class="ident" id="3659371">ellipsis</span>&nbsp;<span class="op" id="3659380">&gt;=</span>&nbsp;<span class="num" id="3659383">0</span>&nbsp;<span class="op" id="3659385">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659389">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659440">return</span>&nbsp;<span class="ident" id="3659447">nil</span><span class="op" id="3659450">,</span>&nbsp;<span class="ident" id="3659452">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659461">return</span>&nbsp;<span class="ident" id="3659468">ip</span><span class="op" id="3659470">,</span>&nbsp;<span class="ident" id="3659472">zone</span><br>
<span class="lineno"></span><span class="op" id="3659477">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3659480">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3659573">type</span>&nbsp;<span class="ident" id="3659578">ParseError</span>&nbsp;<span class="keyword" id="3659589">struct</span>&nbsp;<span class="op" id="3659596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659599">Type</span>&nbsp;<span class="builtintype" id="3659604">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659612">Text</span>&nbsp;<span class="builtintype" id="3659617">string</span><br>
<span class="lineno">640</span><span class="op" id="3659624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3659627">func</span>&nbsp;<span class="op" id="3659632">(</span><span class="ident" id="3659633">e</span>&nbsp;<span class="op" id="3659635">*</span><span class="ident" id="3659636">ParseError</span><span class="op" id="3659646">)</span>&nbsp;<span class="ident" id="3659648">Error</span><span class="op" id="3659653">(</span><span class="op" id="3659654">)</span>&nbsp;<span class="builtintype" id="3659656">string</span>&nbsp;<span class="op" id="3659663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659666">return</span>&nbsp;<span class="string" id="3659673">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3659684">+</span>&nbsp;<span class="ident" id="3659686">e</span><span class="op" id="3659687">.</span><span class="ident" id="3659688">Type</span>&nbsp;<span class="op" id="3659693">+</span>&nbsp;<span class="string" id="3659695">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3659700">+</span>&nbsp;<span class="ident" id="3659702">e</span><span class="op" id="3659703">.</span><span class="ident" id="3659704">Text</span><br>
<span class="lineno"></span><span class="op" id="3659709">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3659712">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3659772">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3659830">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3659872">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3659936">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3659960">func</span>&nbsp;<span class="ident" id="3659965">ParseIP</span><span class="op" id="3659972">(</span><span class="ident" id="3659973">s</span>&nbsp;<span class="builtintype" id="3659975">string</span><span class="op" id="3659981">)</span>&nbsp;<span class="ident" id="3659983">IP</span>&nbsp;<span class="op" id="3659986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659989">for</span>&nbsp;<span class="ident" id="3659993">i</span>&nbsp;<span class="op" id="3659995">:=</span>&nbsp;<span class="num" id="3659998">0</span><span class="op" id="3659999">;</span>&nbsp;<span class="ident" id="3660001">i</span>&nbsp;<span class="op" id="3660003">&lt;</span>&nbsp;<span class="builtinfunc" id="3660005">len</span><span class="op" id="3660008">(</span><span class="ident" id="3660009">s</span><span class="op" id="3660010">)</span><span class="op" id="3660011">;</span>&nbsp;<span class="ident" id="3660013">i</span><span class="op" id="3660014">++</span>&nbsp;<span class="op" id="3660017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660021">switch</span>&nbsp;<span class="ident" id="3660028">s</span><span class="op" id="3660029">[</span><span class="ident" id="3660030">i</span><span class="op" id="3660031">]</span>&nbsp;<span class="op" id="3660033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660037">case</span>&nbsp;<span class="string" id="3660042">&#39;.&#39;</span><span class="op" id="3660045">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660050">return</span>&nbsp;<span class="ident" id="3660057">parseIPv4</span><span class="op" id="3660066">(</span><span class="ident" id="3660067">s</span><span class="op" id="3660068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660072">case</span>&nbsp;<span class="string" id="3660077">&#39;:&#39;</span><span class="op" id="3660080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660085">ip</span><span class="op" id="3660087">,</span>&nbsp;<span class="ident" id="3660089">_</span>&nbsp;<span class="op" id="3660091">:=</span>&nbsp;<span class="ident" id="3660094">parseIPv6</span><span class="op" id="3660103">(</span><span class="ident" id="3660104">s</span><span class="op" id="3660105">,</span>&nbsp;<span class="builtintype" id="3660107">false</span><span class="op" id="3660112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660117">return</span>&nbsp;<span class="ident" id="3660124">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660129">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660135">return</span>&nbsp;<span class="ident" id="3660142">nil</span><br>
<span class="lineno"></span><span class="op" id="3660146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3660149">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3660211">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3660272">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3660298">//</span><br>
<span class="lineno"></span><span class="comment" id="3660301">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3660364">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3660429">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3660493">func</span>&nbsp;<span class="ident" id="3660498">ParseCIDR</span><span class="op" id="3660507">(</span><span class="ident" id="3660508">s</span>&nbsp;<span class="builtintype" id="3660510">string</span><span class="op" id="3660516">)</span>&nbsp;<span class="op" id="3660518">(</span><span class="ident" id="3660519">IP</span><span class="op" id="3660521">,</span>&nbsp;<span class="op" id="3660523">*</span><span class="ident" id="3660524">IPNet</span><span class="op" id="3660529">,</span>&nbsp;<span class="builtintype" id="3660531">error</span><span class="op" id="3660536">)</span>&nbsp;<span class="op" id="3660538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660541">i</span>&nbsp;<span class="op" id="3660543">:=</span>&nbsp;<span class="ident" id="3660546">byteIndex</span><span class="op" id="3660555">(</span><span class="ident" id="3660556">s</span><span class="op" id="3660557">,</span>&nbsp;<span class="string" id="3660559">&#39;/&#39;</span><span class="op" id="3660562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660565">if</span>&nbsp;<span class="ident" id="3660568">i</span>&nbsp;<span class="op" id="3660570">&lt;</span>&nbsp;<span class="num" id="3660572">0</span>&nbsp;<span class="op" id="3660574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660578">return</span>&nbsp;<span class="ident" id="3660585">nil</span><span class="op" id="3660588">,</span>&nbsp;<span class="ident" id="3660590">nil</span><span class="op" id="3660593">,</span>&nbsp;<span class="op" id="3660595">&amp;</span><span class="ident" id="3660596">ParseError</span><span class="op" id="3660606">{</span><span class="string" id="3660607">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3660621">,</span>&nbsp;<span class="ident" id="3660623">s</span><span class="op" id="3660624">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660630">addr</span><span class="op" id="3660634">,</span>&nbsp;<span class="ident" id="3660636">mask</span>&nbsp;<span class="op" id="3660641">:=</span>&nbsp;<span class="ident" id="3660644">s</span><span class="op" id="3660645">[</span><span class="op" id="3660646">:</span><span class="ident" id="3660647">i</span><span class="op" id="3660648">]</span><span class="op" id="3660649">,</span>&nbsp;<span class="ident" id="3660651">s</span><span class="op" id="3660652">[</span><span class="ident" id="3660653">i</span><span class="op" id="3660654">+</span><span class="num" id="3660655">1</span><span class="op" id="3660656">:</span><span class="op" id="3660657">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660660">iplen</span>&nbsp;<span class="op" id="3660666">:=</span>&nbsp;<span class="ident" id="3660669">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660678">ip</span>&nbsp;<span class="op" id="3660681">:=</span>&nbsp;<span class="ident" id="3660684">parseIPv4</span><span class="op" id="3660693">(</span><span class="ident" id="3660694">addr</span><span class="op" id="3660698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660701">if</span>&nbsp;<span class="ident" id="3660704">ip</span>&nbsp;<span class="op" id="3660707">==</span>&nbsp;<span class="ident" id="3660710">nil</span>&nbsp;<span class="op" id="3660714">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660718">iplen</span>&nbsp;<span class="op" id="3660724">=</span>&nbsp;<span class="ident" id="3660726">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660736">ip</span><span class="op" id="3660738">,</span>&nbsp;<span class="ident" id="3660740">_</span>&nbsp;<span class="op" id="3660742">=</span>&nbsp;<span class="ident" id="3660744">parseIPv6</span><span class="op" id="3660753">(</span><span class="ident" id="3660754">addr</span><span class="op" id="3660758">,</span>&nbsp;<span class="builtintype" id="3660760">false</span><span class="op" id="3660765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660771">n</span><span class="op" id="3660772">,</span>&nbsp;<span class="ident" id="3660774">i</span><span class="op" id="3660775">,</span>&nbsp;<span class="ident" id="3660777">ok</span>&nbsp;<span class="op" id="3660780">:=</span>&nbsp;<span class="ident" id="3660783">dtoi</span><span class="op" id="3660787">(</span><span class="ident" id="3660788">mask</span><span class="op" id="3660792">,</span>&nbsp;<span class="num" id="3660794">0</span><span class="op" id="3660795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660798">if</span>&nbsp;<span class="ident" id="3660801">ip</span>&nbsp;<span class="op" id="3660804">==</span>&nbsp;<span class="ident" id="3660807">nil</span>&nbsp;<span class="op" id="3660811">||</span>&nbsp;<span class="op" id="3660814">!</span><span class="ident" id="3660815">ok</span>&nbsp;<span class="op" id="3660818">||</span>&nbsp;<span class="ident" id="3660821">i</span>&nbsp;<span class="op" id="3660823">!=</span>&nbsp;<span class="builtinfunc" id="3660826">len</span><span class="op" id="3660829">(</span><span class="ident" id="3660830">mask</span><span class="op" id="3660834">)</span>&nbsp;<span class="op" id="3660836">||</span>&nbsp;<span class="ident" id="3660839">n</span>&nbsp;<span class="op" id="3660841">&lt;</span>&nbsp;<span class="num" id="3660843">0</span>&nbsp;<span class="op" id="3660845">||</span>&nbsp;<span class="ident" id="3660848">n</span>&nbsp;<span class="op" id="3660850">&gt;</span>&nbsp;<span class="num" id="3660852">8</span><span class="op" id="3660853">*</span><span class="ident" id="3660854">iplen</span>&nbsp;<span class="op" id="3660860">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660864">return</span>&nbsp;<span class="ident" id="3660871">nil</span><span class="op" id="3660874">,</span>&nbsp;<span class="ident" id="3660876">nil</span><span class="op" id="3660879">,</span>&nbsp;<span class="op" id="3660881">&amp;</span><span class="ident" id="3660882">ParseError</span><span class="op" id="3660892">{</span><span class="string" id="3660893">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3660907">,</span>&nbsp;<span class="ident" id="3660909">s</span><span class="op" id="3660910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660916">m</span>&nbsp;<span class="op" id="3660918">:=</span>&nbsp;<span class="ident" id="3660921">CIDRMask</span><span class="op" id="3660929">(</span><span class="ident" id="3660930">n</span><span class="op" id="3660931">,</span>&nbsp;<span class="num" id="3660933">8</span><span class="op" id="3660934">*</span><span class="ident" id="3660935">iplen</span><span class="op" id="3660940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660943">return</span>&nbsp;<span class="ident" id="3660950">ip</span><span class="op" id="3660952">,</span>&nbsp;<span class="op" id="3660954">&amp;</span><span class="ident" id="3660955">IPNet</span><span class="op" id="3660960">{</span><span class="ident" id="3660961">IP</span><span class="op" id="3660963">:</span>&nbsp;<span class="ident" id="3660965">ip</span><span class="op" id="3660967">.</span><span class="ident" id="3660968">Mask</span><span class="op" id="3660972">(</span><span class="ident" id="3660973">m</span><span class="op" id="3660974">)</span><span class="op" id="3660975">,</span>&nbsp;<span class="ident" id="3660977">Mask</span><span class="op" id="3660981">:</span>&nbsp;<span class="ident" id="3660983">m</span><span class="op" id="3660984">}</span><span class="op" id="3660985">,</span>&nbsp;<span class="ident" id="3660987">nil</span><br>
<span class="lineno"></span><span class="op" id="3660991">}</span>
</div>
</body>
</html>
