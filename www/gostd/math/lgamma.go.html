<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2254164">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2254219">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2254273">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2254324">package</span>&nbsp;<span class="ident" id="2254332">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2254338">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2254394">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2254448">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2254505">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2254560">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2254590">//</span><br>
<span class="lineno"></span><span class="comment" id="2254593">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2254649">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2254718">//</span><br>
<span class="lineno"></span><span class="comment" id="2254721">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2254780">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2254836">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2254893">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2254910">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2254966">//</span><br>
<span class="lineno">25</span><span class="comment" id="2254969">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2255004">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2255064">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2255120">//</span><br>
<span class="lineno"></span><span class="comment" id="2255123">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2255134">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2255176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2255236">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2255281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2255330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2255351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2255404">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2255461">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2255530">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2255584">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2255654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2255719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2255751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2255819">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2255870">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2255931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2255975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2256002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2256050">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2256072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2256125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2256187">//</span><br>
<span class="lineno"></span><span class="comment" id="2256190">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2256254">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2256324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2256379">//</span><br>
<span class="lineno"></span><span class="comment" id="2256382">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2256449">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2256479">//</span><br>
<span class="lineno"></span><span class="comment" id="2256482">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2256508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2256580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2256605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2256668">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2256711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2256764">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2256775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2256836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2256895">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2256909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2256948">//</span><br>
<span class="lineno"></span><span class="comment" id="2256951">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2257003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2257049">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2257065">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2257114">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2257184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2257238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2257282">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2257348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2257413">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2257456">//</span><br>
<span class="lineno"></span><span class="comment" id="2257459">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2257481">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2257534">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2257572">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2257619">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2257665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2257706">//</span><br>
<span class="lineno"></span><span class="comment" id="2257709">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2257713">var</span>&nbsp;<span class="ident" id="2257717">_lgamA</span>&nbsp;<span class="op" id="2257724">=</span>&nbsp;<span class="op" id="2257726">[</span><span class="op" id="2257727">...</span><span class="op" id="2257730">]</span><span class="builtintype" id="2257731">float64</span><span class="op" id="2257738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257741">7.72156649015328655494e-02</span><span class="op" id="2257767">,</span>&nbsp;<span class="comment" id="2257769">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257792">3.22467033424113591611e-01</span><span class="op" id="2257818">,</span>&nbsp;<span class="comment" id="2257820">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257843">6.73523010531292681824e-02</span><span class="op" id="2257869">,</span>&nbsp;<span class="comment" id="2257871">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257894">2.05808084325167332806e-02</span><span class="op" id="2257920">,</span>&nbsp;<span class="comment" id="2257922">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257945">7.38555086081402883957e-03</span><span class="op" id="2257971">,</span>&nbsp;<span class="comment" id="2257973">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2257996">2.89051383673415629091e-03</span><span class="op" id="2258022">,</span>&nbsp;<span class="comment" id="2258024">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258047">1.19270763183362067845e-03</span><span class="op" id="2258073">,</span>&nbsp;<span class="comment" id="2258075">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258098">5.10069792153511336608e-04</span><span class="op" id="2258124">,</span>&nbsp;<span class="comment" id="2258126">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258149">2.20862790713908385557e-04</span><span class="op" id="2258175">,</span>&nbsp;<span class="comment" id="2258177">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258200">1.08011567247583939954e-04</span><span class="op" id="2258226">,</span>&nbsp;<span class="comment" id="2258228">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258251">2.52144565451257326939e-05</span><span class="op" id="2258277">,</span>&nbsp;<span class="comment" id="2258279">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258302">4.48640949618915160150e-05</span><span class="op" id="2258328">,</span>&nbsp;<span class="comment" id="2258330">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2258352">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2258354">var</span>&nbsp;<span class="ident" id="2258358">_lgamR</span>&nbsp;<span class="op" id="2258365">=</span>&nbsp;<span class="op" id="2258367">[</span><span class="op" id="2258368">...</span><span class="op" id="2258371">]</span><span class="builtintype" id="2258372">float64</span><span class="op" id="2258379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258382">1.0</span><span class="op" id="2258385">,</span>&nbsp;<span class="comment" id="2258387">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258403">1.39200533467621045958e+00</span><span class="op" id="2258429">,</span>&nbsp;<span class="comment" id="2258431">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258454">7.21935547567138069525e-01</span><span class="op" id="2258480">,</span>&nbsp;<span class="comment" id="2258482">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258505">1.71933865632803078993e-01</span><span class="op" id="2258531">,</span>&nbsp;<span class="comment" id="2258533">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258556">1.86459191715652901344e-02</span><span class="op" id="2258582">,</span>&nbsp;<span class="comment" id="2258584">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258607">7.77942496381893596434e-04</span><span class="op" id="2258633">,</span>&nbsp;<span class="comment" id="2258635">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258658">7.32668430744625636189e-06</span><span class="op" id="2258684">,</span>&nbsp;<span class="comment" id="2258686">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2258708">}</span><br>
<span class="lineno"></span><span class="keyword" id="2258710">var</span>&nbsp;<span class="ident" id="2258714">_lgamS</span>&nbsp;<span class="op" id="2258721">=</span>&nbsp;<span class="op" id="2258723">[</span><span class="op" id="2258724">...</span><span class="op" id="2258727">]</span><span class="builtintype" id="2258728">float64</span><span class="op" id="2258735">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2258738">-</span><span class="num" id="2258739">7.72156649015328655494e-02</span><span class="op" id="2258765">,</span>&nbsp;<span class="comment" id="2258767">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258790">2.14982415960608852501e-01</span><span class="op" id="2258816">,</span>&nbsp;&nbsp;<span class="comment" id="2258819">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258842">3.25778796408930981787e-01</span><span class="op" id="2258868">,</span>&nbsp;&nbsp;<span class="comment" id="2258871">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258894">1.46350472652464452805e-01</span><span class="op" id="2258920">,</span>&nbsp;&nbsp;<span class="comment" id="2258923">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258946">2.66422703033638609560e-02</span><span class="op" id="2258972">,</span>&nbsp;&nbsp;<span class="comment" id="2258975">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2258998">1.84028451407337715652e-03</span><span class="op" id="2259024">,</span>&nbsp;&nbsp;<span class="comment" id="2259027">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259050">3.19475326584100867617e-05</span><span class="op" id="2259076">,</span>&nbsp;&nbsp;<span class="comment" id="2259079">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2259101">}</span><br>
<span class="lineno"></span><span class="keyword" id="2259103">var</span>&nbsp;<span class="ident" id="2259107">_lgamT</span>&nbsp;<span class="op" id="2259114">=</span>&nbsp;<span class="op" id="2259116">[</span><span class="op" id="2259117">...</span><span class="op" id="2259120">]</span><span class="builtintype" id="2259121">float64</span><span class="op" id="2259128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259131">4.83836122723810047042e-01</span><span class="op" id="2259157">,</span>&nbsp;&nbsp;<span class="comment" id="2259160">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259183">-</span><span class="num" id="2259184">1.47587722994593911752e-01</span><span class="op" id="2259210">,</span>&nbsp;<span class="comment" id="2259212">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259235">6.46249402391333854778e-02</span><span class="op" id="2259261">,</span>&nbsp;&nbsp;<span class="comment" id="2259264">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259287">-</span><span class="num" id="2259288">3.27885410759859649565e-02</span><span class="op" id="2259314">,</span>&nbsp;<span class="comment" id="2259316">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259339">1.79706750811820387126e-02</span><span class="op" id="2259365">,</span>&nbsp;&nbsp;<span class="comment" id="2259368">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259391">-</span><span class="num" id="2259392">1.03142241298341437450e-02</span><span class="op" id="2259418">,</span>&nbsp;<span class="comment" id="2259420">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259443">6.10053870246291332635e-03</span><span class="op" id="2259469">,</span>&nbsp;&nbsp;<span class="comment" id="2259472">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259495">-</span><span class="num" id="2259496">3.68452016781138256760e-03</span><span class="op" id="2259522">,</span>&nbsp;<span class="comment" id="2259524">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259547">2.25964780900612472250e-03</span><span class="op" id="2259573">,</span>&nbsp;&nbsp;<span class="comment" id="2259576">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259599">-</span><span class="num" id="2259600">1.40346469989232843813e-03</span><span class="op" id="2259626">,</span>&nbsp;<span class="comment" id="2259628">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259651">8.81081882437654011382e-04</span><span class="op" id="2259677">,</span>&nbsp;&nbsp;<span class="comment" id="2259680">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259703">-</span><span class="num" id="2259704">5.38595305356740546715e-04</span><span class="op" id="2259730">,</span>&nbsp;<span class="comment" id="2259732">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259755">3.15632070903625950361e-04</span><span class="op" id="2259781">,</span>&nbsp;&nbsp;<span class="comment" id="2259784">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259807">-</span><span class="num" id="2259808">3.12754168375120860518e-04</span><span class="op" id="2259834">,</span>&nbsp;<span class="comment" id="2259836">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259859">3.35529192635519073543e-04</span><span class="op" id="2259885">,</span>&nbsp;&nbsp;<span class="comment" id="2259888">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2259910">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2259912">var</span>&nbsp;<span class="ident" id="2259916">_lgamU</span>&nbsp;<span class="op" id="2259923">=</span>&nbsp;<span class="op" id="2259925">[</span><span class="op" id="2259926">...</span><span class="op" id="2259929">]</span><span class="builtintype" id="2259930">float64</span><span class="op" id="2259937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2259940">-</span><span class="num" id="2259941">7.72156649015328655494e-02</span><span class="op" id="2259967">,</span>&nbsp;<span class="comment" id="2259969">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2259992">6.32827064025093366517e-01</span><span class="op" id="2260018">,</span>&nbsp;&nbsp;<span class="comment" id="2260021">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260044">1.45492250137234768737e+00</span><span class="op" id="2260070">,</span>&nbsp;&nbsp;<span class="comment" id="2260073">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260096">9.77717527963372745603e-01</span><span class="op" id="2260122">,</span>&nbsp;&nbsp;<span class="comment" id="2260125">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260148">2.28963728064692451092e-01</span><span class="op" id="2260174">,</span>&nbsp;&nbsp;<span class="comment" id="2260177">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260200">1.33810918536787660377e-02</span><span class="op" id="2260226">,</span>&nbsp;&nbsp;<span class="comment" id="2260229">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2260251">}</span><br>
<span class="lineno"></span><span class="keyword" id="2260253">var</span>&nbsp;<span class="ident" id="2260257">_lgamV</span>&nbsp;<span class="op" id="2260264">=</span>&nbsp;<span class="op" id="2260266">[</span><span class="op" id="2260267">...</span><span class="op" id="2260270">]</span><span class="builtintype" id="2260271">float64</span><span class="op" id="2260278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260281">1.0</span><span class="op" id="2260284">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260287">2.45597793713041134822e+00</span><span class="op" id="2260313">,</span>&nbsp;<span class="comment" id="2260315">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260338">2.12848976379893395361e+00</span><span class="op" id="2260364">,</span>&nbsp;<span class="comment" id="2260366">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260389">7.69285150456672783825e-01</span><span class="op" id="2260415">,</span>&nbsp;<span class="comment" id="2260417">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260440">1.04222645593369134254e-01</span><span class="op" id="2260466">,</span>&nbsp;<span class="comment" id="2260468">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260491">3.21709242282423911810e-03</span><span class="op" id="2260517">,</span>&nbsp;<span class="comment" id="2260519">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2260541">}</span><br>
<span class="lineno"></span><span class="keyword" id="2260543">var</span>&nbsp;<span class="ident" id="2260547">_lgamW</span>&nbsp;<span class="op" id="2260554">=</span>&nbsp;<span class="op" id="2260556">[</span><span class="op" id="2260557">...</span><span class="op" id="2260560">]</span><span class="builtintype" id="2260561">float64</span><span class="op" id="2260568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260571">4.18938533204672725052e-01</span><span class="op" id="2260597">,</span>&nbsp;&nbsp;<span class="comment" id="2260600">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260623">8.33333333333329678849e-02</span><span class="op" id="2260649">,</span>&nbsp;&nbsp;<span class="comment" id="2260652">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2260675">-</span><span class="num" id="2260676">2.77777777728775536470e-03</span><span class="op" id="2260702">,</span>&nbsp;<span class="comment" id="2260704">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260727">7.93650558643019558500e-04</span><span class="op" id="2260753">,</span>&nbsp;&nbsp;<span class="comment" id="2260756">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2260779">-</span><span class="num" id="2260780">5.95187557450339963135e-04</span><span class="op" id="2260806">,</span>&nbsp;<span class="comment" id="2260808">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2260831">8.36339918996282139126e-04</span><span class="op" id="2260857">,</span>&nbsp;&nbsp;<span class="comment" id="2260860">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2260883">-</span><span class="num" id="2260884">1.63092934096575273989e-03</span><span class="op" id="2260910">,</span>&nbsp;<span class="comment" id="2260912">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2260934">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2260937">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2261010">//</span><br>
<span class="lineno"></span><span class="comment" id="2261013">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2261035">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2261058">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2261078">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2261105">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2261128">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2261149">func</span>&nbsp;<span class="ident" id="2261154">Lgamma</span><span class="op" id="2261160">(</span><span class="ident" id="2261161">x</span>&nbsp;<span class="builtintype" id="2261163">float64</span><span class="op" id="2261170">)</span>&nbsp;<span class="op" id="2261172">(</span><span class="ident" id="2261173">lgamma</span>&nbsp;<span class="builtintype" id="2261180">float64</span><span class="op" id="2261187">,</span>&nbsp;<span class="ident" id="2261189">sign</span>&nbsp;<span class="builtintype" id="2261194">int</span><span class="op" id="2261197">)</span>&nbsp;<span class="op" id="2261199">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261202">const</span>&nbsp;<span class="op" id="2261208">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261212">Ymin</span>&nbsp;&nbsp;<span class="op" id="2261218">=</span>&nbsp;<span class="num" id="2261220">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261243">Two52</span>&nbsp;<span class="op" id="2261249">=</span>&nbsp;<span class="num" id="2261251">1</span>&nbsp;<span class="op" id="2261253">&lt;&lt;</span>&nbsp;<span class="num" id="2261256">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261279">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261315">Two53</span>&nbsp;<span class="op" id="2261321">=</span>&nbsp;<span class="num" id="2261323">1</span>&nbsp;<span class="op" id="2261325">&lt;&lt;</span>&nbsp;<span class="num" id="2261328">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261351">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261387">Two58</span>&nbsp;<span class="op" id="2261393">=</span>&nbsp;<span class="num" id="2261395">1</span>&nbsp;<span class="op" id="2261397">&lt;&lt;</span>&nbsp;<span class="num" id="2261400">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261423">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261459">Tiny</span>&nbsp;&nbsp;<span class="op" id="2261465">=</span>&nbsp;<span class="num" id="2261467">1.0</span>&nbsp;<span class="op" id="2261471">/</span>&nbsp;<span class="op" id="2261473">(</span><span class="num" id="2261474">1</span>&nbsp;<span class="op" id="2261476">&lt;&lt;</span>&nbsp;<span class="num" id="2261479">70</span><span class="op" id="2261481">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261495">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261532">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2261538">=</span>&nbsp;<span class="num" id="2261540">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2261568">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261592">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2261598">=</span>&nbsp;<span class="op" id="2261600">-</span><span class="num" id="2261601">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2261628">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261652">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261676">Tt</span>&nbsp;<span class="op" id="2261679">=</span>&nbsp;<span class="op" id="2261681">-</span><span class="num" id="2261682">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2261709">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2261732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261735">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261753">sign</span>&nbsp;<span class="op" id="2261758">=</span>&nbsp;<span class="num" id="2261760">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261763">switch</span>&nbsp;<span class="op" id="2261770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261773">case</span>&nbsp;<span class="ident" id="2261778">IsNaN</span><span class="op" id="2261783">(</span><span class="ident" id="2261784">x</span><span class="op" id="2261785">)</span><span class="op" id="2261786">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261790">lgamma</span>&nbsp;<span class="op" id="2261797">=</span>&nbsp;<span class="ident" id="2261799">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261803">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261811">case</span>&nbsp;<span class="ident" id="2261816">IsInf</span><span class="op" id="2261821">(</span><span class="ident" id="2261822">x</span><span class="op" id="2261823">,</span>&nbsp;<span class="num" id="2261825">0</span><span class="op" id="2261826">)</span><span class="op" id="2261827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261831">lgamma</span>&nbsp;<span class="op" id="2261838">=</span>&nbsp;<span class="ident" id="2261840">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261844">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261852">case</span>&nbsp;<span class="ident" id="2261857">x</span>&nbsp;<span class="op" id="2261859">==</span>&nbsp;<span class="num" id="2261862">0</span><span class="op" id="2261863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261867">lgamma</span>&nbsp;<span class="op" id="2261874">=</span>&nbsp;<span class="ident" id="2261876">Inf</span><span class="op" id="2261879">(</span><span class="num" id="2261880">1</span><span class="op" id="2261881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2261893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261897">neg</span>&nbsp;<span class="op" id="2261901">:=</span>&nbsp;<span class="builtintype" id="2261904">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261911">if</span>&nbsp;<span class="ident" id="2261914">x</span>&nbsp;<span class="op" id="2261916">&lt;</span>&nbsp;<span class="num" id="2261918">0</span>&nbsp;<span class="op" id="2261920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261924">x</span>&nbsp;<span class="op" id="2261926">=</span>&nbsp;<span class="op" id="2261928">-</span><span class="ident" id="2261929">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2261933">neg</span>&nbsp;<span class="op" id="2261937">=</span>&nbsp;<span class="builtintype" id="2261939">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2261945">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2261949">if</span>&nbsp;<span class="ident" id="2261952">x</span>&nbsp;<span class="op" id="2261954">&lt;</span>&nbsp;<span class="ident" id="2261956">Tiny</span>&nbsp;<span class="op" id="2261961">{</span>&nbsp;<span class="comment" id="2261963">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262002">if</span>&nbsp;<span class="ident" id="2262005">neg</span>&nbsp;<span class="op" id="2262009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262014">sign</span>&nbsp;<span class="op" id="2262019">=</span>&nbsp;<span class="op" id="2262021">-</span><span class="num" id="2262022">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262026">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262030">lgamma</span>&nbsp;<span class="op" id="2262037">=</span>&nbsp;<span class="op" id="2262039">-</span><span class="ident" id="2262040">Log</span><span class="op" id="2262043">(</span><span class="ident" id="2262044">x</span><span class="op" id="2262045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262049">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262060">var</span>&nbsp;<span class="ident" id="2262064">nadj</span>&nbsp;<span class="builtintype" id="2262069">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262078">if</span>&nbsp;<span class="ident" id="2262081">neg</span>&nbsp;<span class="op" id="2262085">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262089">if</span>&nbsp;<span class="ident" id="2262092">x</span>&nbsp;<span class="op" id="2262094">&gt;=</span>&nbsp;<span class="ident" id="2262097">Two52</span>&nbsp;<span class="op" id="2262103">{</span>&nbsp;<span class="comment" id="2262105">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262142">lgamma</span>&nbsp;<span class="op" id="2262149">=</span>&nbsp;<span class="ident" id="2262151">Inf</span><span class="op" id="2262154">(</span><span class="num" id="2262155">1</span><span class="op" id="2262156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262174">t</span>&nbsp;<span class="op" id="2262176">:=</span>&nbsp;<span class="ident" id="2262179">sinPi</span><span class="op" id="2262184">(</span><span class="ident" id="2262185">x</span><span class="op" id="2262186">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262190">if</span>&nbsp;<span class="ident" id="2262193">t</span>&nbsp;<span class="op" id="2262195">==</span>&nbsp;<span class="num" id="2262198">0</span>&nbsp;<span class="op" id="2262200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262205">lgamma</span>&nbsp;<span class="op" id="2262212">=</span>&nbsp;<span class="ident" id="2262214">Inf</span><span class="op" id="2262217">(</span><span class="num" id="2262218">1</span><span class="op" id="2262219">)</span>&nbsp;<span class="comment" id="2262221">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262249">nadj</span>&nbsp;<span class="op" id="2262254">=</span>&nbsp;<span class="ident" id="2262256">Log</span><span class="op" id="2262259">(</span><span class="ident" id="2262260">Pi</span>&nbsp;<span class="op" id="2262263">/</span>&nbsp;<span class="ident" id="2262265">Abs</span><span class="op" id="2262268">(</span><span class="ident" id="2262269">t</span><span class="op" id="2262270">*</span><span class="ident" id="2262271">x</span><span class="op" id="2262272">)</span><span class="op" id="2262273">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262277">if</span>&nbsp;<span class="ident" id="2262280">t</span>&nbsp;<span class="op" id="2262282">&lt;</span>&nbsp;<span class="num" id="2262284">0</span>&nbsp;<span class="op" id="2262286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262291">sign</span>&nbsp;<span class="op" id="2262296">=</span>&nbsp;<span class="op" id="2262298">-</span><span class="num" id="2262299">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262310">switch</span>&nbsp;<span class="op" id="2262317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262320">case</span>&nbsp;<span class="ident" id="2262325">x</span>&nbsp;<span class="op" id="2262327">==</span>&nbsp;<span class="num" id="2262330">1</span>&nbsp;<span class="op" id="2262332">||</span>&nbsp;<span class="ident" id="2262335">x</span>&nbsp;<span class="op" id="2262337">==</span>&nbsp;<span class="num" id="2262340">2</span><span class="op" id="2262341">:</span>&nbsp;<span class="comment" id="2262343">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262366">lgamma</span>&nbsp;<span class="op" id="2262373">=</span>&nbsp;<span class="num" id="2262375">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262379">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262387">case</span>&nbsp;<span class="ident" id="2262392">x</span>&nbsp;<span class="op" id="2262394">&lt;</span>&nbsp;<span class="num" id="2262396">2</span><span class="op" id="2262397">:</span>&nbsp;<span class="comment" id="2262399">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262441">var</span>&nbsp;<span class="ident" id="2262445">y</span>&nbsp;<span class="builtintype" id="2262447">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262457">var</span>&nbsp;<span class="ident" id="2262461">i</span>&nbsp;<span class="builtintype" id="2262463">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262469">if</span>&nbsp;<span class="ident" id="2262472">x</span>&nbsp;<span class="op" id="2262474">&lt;=</span>&nbsp;<span class="num" id="2262477">0.9</span>&nbsp;<span class="op" id="2262481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262486">lgamma</span>&nbsp;<span class="op" id="2262493">=</span>&nbsp;<span class="op" id="2262495">-</span><span class="ident" id="2262496">Log</span><span class="op" id="2262499">(</span><span class="ident" id="2262500">x</span><span class="op" id="2262501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262506">switch</span>&nbsp;<span class="op" id="2262513">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262518">case</span>&nbsp;<span class="ident" id="2262523">x</span>&nbsp;<span class="op" id="2262525">&gt;=</span>&nbsp;<span class="op" id="2262528">(</span><span class="ident" id="2262529">Ymin</span>&nbsp;<span class="op" id="2262534">-</span>&nbsp;<span class="num" id="2262536">1</span>&nbsp;<span class="op" id="2262538">+</span>&nbsp;<span class="num" id="2262540">0.27</span><span class="op" id="2262544">)</span><span class="op" id="2262545">:</span>&nbsp;<span class="comment" id="2262547">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262574">y</span>&nbsp;<span class="op" id="2262576">=</span>&nbsp;<span class="num" id="2262578">1</span>&nbsp;<span class="op" id="2262580">-</span>&nbsp;<span class="ident" id="2262582">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262588">i</span>&nbsp;<span class="op" id="2262590">=</span>&nbsp;<span class="num" id="2262592">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262597">case</span>&nbsp;<span class="ident" id="2262602">x</span>&nbsp;<span class="op" id="2262604">&gt;=</span>&nbsp;<span class="op" id="2262607">(</span><span class="ident" id="2262608">Ymin</span>&nbsp;<span class="op" id="2262613">-</span>&nbsp;<span class="num" id="2262615">1</span>&nbsp;<span class="op" id="2262617">-</span>&nbsp;<span class="num" id="2262619">0.27</span><span class="op" id="2262623">)</span><span class="op" id="2262624">:</span>&nbsp;<span class="comment" id="2262626">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262654">y</span>&nbsp;<span class="op" id="2262656">=</span>&nbsp;<span class="ident" id="2262658">x</span>&nbsp;<span class="op" id="2262660">-</span>&nbsp;<span class="op" id="2262662">(</span><span class="ident" id="2262663">Tc</span>&nbsp;<span class="op" id="2262666">-</span>&nbsp;<span class="num" id="2262668">1</span><span class="op" id="2262669">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262675">i</span>&nbsp;<span class="op" id="2262677">=</span>&nbsp;<span class="num" id="2262679">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262684">default</span><span class="op" id="2262691">:</span>&nbsp;<span class="comment" id="2262693">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262715">y</span>&nbsp;<span class="op" id="2262717">=</span>&nbsp;<span class="ident" id="2262719">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262725">i</span>&nbsp;<span class="op" id="2262727">=</span>&nbsp;<span class="num" id="2262729">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262734">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262738">}</span>&nbsp;<span class="keyword" id="2262740">else</span>&nbsp;<span class="op" id="2262745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262750">lgamma</span>&nbsp;<span class="op" id="2262757">=</span>&nbsp;<span class="num" id="2262759">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262764">switch</span>&nbsp;<span class="op" id="2262771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262776">case</span>&nbsp;<span class="ident" id="2262781">x</span>&nbsp;<span class="op" id="2262783">&gt;=</span>&nbsp;<span class="op" id="2262786">(</span><span class="ident" id="2262787">Ymin</span>&nbsp;<span class="op" id="2262792">+</span>&nbsp;<span class="num" id="2262794">0.27</span><span class="op" id="2262798">)</span><span class="op" id="2262799">:</span>&nbsp;<span class="comment" id="2262801">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262824">y</span>&nbsp;<span class="op" id="2262826">=</span>&nbsp;<span class="num" id="2262828">2</span>&nbsp;<span class="op" id="2262830">-</span>&nbsp;<span class="ident" id="2262832">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262838">i</span>&nbsp;<span class="op" id="2262840">=</span>&nbsp;<span class="num" id="2262842">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262847">case</span>&nbsp;<span class="ident" id="2262852">x</span>&nbsp;<span class="op" id="2262854">&gt;=</span>&nbsp;<span class="op" id="2262857">(</span><span class="ident" id="2262858">Ymin</span>&nbsp;<span class="op" id="2262863">-</span>&nbsp;<span class="num" id="2262865">0.27</span><span class="op" id="2262869">)</span><span class="op" id="2262870">:</span>&nbsp;<span class="comment" id="2262872">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262900">y</span>&nbsp;<span class="op" id="2262902">=</span>&nbsp;<span class="ident" id="2262904">x</span>&nbsp;<span class="op" id="2262906">-</span>&nbsp;<span class="ident" id="2262908">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262915">i</span>&nbsp;<span class="op" id="2262917">=</span>&nbsp;<span class="num" id="2262919">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262924">default</span><span class="op" id="2262931">:</span>&nbsp;<span class="comment" id="2262933">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262957">y</span>&nbsp;<span class="op" id="2262959">=</span>&nbsp;<span class="ident" id="2262961">x</span>&nbsp;<span class="op" id="2262963">-</span>&nbsp;<span class="num" id="2262965">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2262971">i</span>&nbsp;<span class="op" id="2262973">=</span>&nbsp;<span class="num" id="2262975">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2262984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2262988">switch</span>&nbsp;<span class="ident" id="2262995">i</span>&nbsp;<span class="op" id="2262997">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2263001">case</span>&nbsp;<span class="num" id="2263006">0</span><span class="op" id="2263007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263012">z</span>&nbsp;<span class="op" id="2263014">:=</span>&nbsp;<span class="ident" id="2263017">y</span>&nbsp;<span class="op" id="2263019">*</span>&nbsp;<span class="ident" id="2263021">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263026">p1</span>&nbsp;<span class="op" id="2263029">:=</span>&nbsp;<span class="ident" id="2263032">_lgamA</span><span class="op" id="2263038">[</span><span class="num" id="2263039">0</span><span class="op" id="2263040">]</span>&nbsp;<span class="op" id="2263042">+</span>&nbsp;<span class="ident" id="2263044">z</span><span class="op" id="2263045">*</span><span class="op" id="2263046">(</span><span class="ident" id="2263047">_lgamA</span><span class="op" id="2263053">[</span><span class="num" id="2263054">2</span><span class="op" id="2263055">]</span><span class="op" id="2263056">+</span><span class="ident" id="2263057">z</span><span class="op" id="2263058">*</span><span class="op" id="2263059">(</span><span class="ident" id="2263060">_lgamA</span><span class="op" id="2263066">[</span><span class="num" id="2263067">4</span><span class="op" id="2263068">]</span><span class="op" id="2263069">+</span><span class="ident" id="2263070">z</span><span class="op" id="2263071">*</span><span class="op" id="2263072">(</span><span class="ident" id="2263073">_lgamA</span><span class="op" id="2263079">[</span><span class="num" id="2263080">6</span><span class="op" id="2263081">]</span><span class="op" id="2263082">+</span><span class="ident" id="2263083">z</span><span class="op" id="2263084">*</span><span class="op" id="2263085">(</span><span class="ident" id="2263086">_lgamA</span><span class="op" id="2263092">[</span><span class="num" id="2263093">8</span><span class="op" id="2263094">]</span><span class="op" id="2263095">+</span><span class="ident" id="2263096">z</span><span class="op" id="2263097">*</span><span class="ident" id="2263098">_lgamA</span><span class="op" id="2263104">[</span><span class="num" id="2263105">10</span><span class="op" id="2263107">]</span><span class="op" id="2263108">)</span><span class="op" id="2263109">)</span><span class="op" id="2263110">)</span><span class="op" id="2263111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263116">p2</span>&nbsp;<span class="op" id="2263119">:=</span>&nbsp;<span class="ident" id="2263122">z</span>&nbsp;<span class="op" id="2263124">*</span>&nbsp;<span class="op" id="2263126">(</span><span class="ident" id="2263127">_lgamA</span><span class="op" id="2263133">[</span><span class="num" id="2263134">1</span><span class="op" id="2263135">]</span>&nbsp;<span class="op" id="2263137">+</span>&nbsp;<span class="ident" id="2263139">z</span><span class="op" id="2263140">*</span><span class="op" id="2263141">(</span><span class="op" id="2263142">+</span><span class="ident" id="2263143">_lgamA</span><span class="op" id="2263149">[</span><span class="num" id="2263150">3</span><span class="op" id="2263151">]</span><span class="op" id="2263152">+</span><span class="ident" id="2263153">z</span><span class="op" id="2263154">*</span><span class="op" id="2263155">(</span><span class="ident" id="2263156">_lgamA</span><span class="op" id="2263162">[</span><span class="num" id="2263163">5</span><span class="op" id="2263164">]</span><span class="op" id="2263165">+</span><span class="ident" id="2263166">z</span><span class="op" id="2263167">*</span><span class="op" id="2263168">(</span><span class="ident" id="2263169">_lgamA</span><span class="op" id="2263175">[</span><span class="num" id="2263176">7</span><span class="op" id="2263177">]</span><span class="op" id="2263178">+</span><span class="ident" id="2263179">z</span><span class="op" id="2263180">*</span><span class="op" id="2263181">(</span><span class="ident" id="2263182">_lgamA</span><span class="op" id="2263188">[</span><span class="num" id="2263189">9</span><span class="op" id="2263190">]</span><span class="op" id="2263191">+</span><span class="ident" id="2263192">z</span><span class="op" id="2263193">*</span><span class="ident" id="2263194">_lgamA</span><span class="op" id="2263200">[</span><span class="num" id="2263201">11</span><span class="op" id="2263203">]</span><span class="op" id="2263204">)</span><span class="op" id="2263205">)</span><span class="op" id="2263206">)</span><span class="op" id="2263207">)</span><span class="op" id="2263208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263213">p</span>&nbsp;<span class="op" id="2263215">:=</span>&nbsp;<span class="ident" id="2263218">y</span><span class="op" id="2263219">*</span><span class="ident" id="2263220">p1</span>&nbsp;<span class="op" id="2263223">+</span>&nbsp;<span class="ident" id="2263225">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263231">lgamma</span>&nbsp;<span class="op" id="2263238">+=</span>&nbsp;<span class="op" id="2263241">(</span><span class="ident" id="2263242">p</span>&nbsp;<span class="op" id="2263244">-</span>&nbsp;<span class="num" id="2263246">0.5</span><span class="op" id="2263249">*</span><span class="ident" id="2263250">y</span><span class="op" id="2263251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2263255">case</span>&nbsp;<span class="num" id="2263260">1</span><span class="op" id="2263261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263266">z</span>&nbsp;<span class="op" id="2263268">:=</span>&nbsp;<span class="ident" id="2263271">y</span>&nbsp;<span class="op" id="2263273">*</span>&nbsp;<span class="ident" id="2263275">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263280">w</span>&nbsp;<span class="op" id="2263282">:=</span>&nbsp;<span class="ident" id="2263285">z</span>&nbsp;<span class="op" id="2263287">*</span>&nbsp;<span class="ident" id="2263289">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263294">p1</span>&nbsp;<span class="op" id="2263297">:=</span>&nbsp;<span class="ident" id="2263300">_lgamT</span><span class="op" id="2263306">[</span><span class="num" id="2263307">0</span><span class="op" id="2263308">]</span>&nbsp;<span class="op" id="2263310">+</span>&nbsp;<span class="ident" id="2263312">w</span><span class="op" id="2263313">*</span><span class="op" id="2263314">(</span><span class="ident" id="2263315">_lgamT</span><span class="op" id="2263321">[</span><span class="num" id="2263322">3</span><span class="op" id="2263323">]</span><span class="op" id="2263324">+</span><span class="ident" id="2263325">w</span><span class="op" id="2263326">*</span><span class="op" id="2263327">(</span><span class="ident" id="2263328">_lgamT</span><span class="op" id="2263334">[</span><span class="num" id="2263335">6</span><span class="op" id="2263336">]</span><span class="op" id="2263337">+</span><span class="ident" id="2263338">w</span><span class="op" id="2263339">*</span><span class="op" id="2263340">(</span><span class="ident" id="2263341">_lgamT</span><span class="op" id="2263347">[</span><span class="num" id="2263348">9</span><span class="op" id="2263349">]</span><span class="op" id="2263350">+</span><span class="ident" id="2263351">w</span><span class="op" id="2263352">*</span><span class="ident" id="2263353">_lgamT</span><span class="op" id="2263359">[</span><span class="num" id="2263360">12</span><span class="op" id="2263362">]</span><span class="op" id="2263363">)</span><span class="op" id="2263364">)</span><span class="op" id="2263365">)</span>&nbsp;<span class="comment" id="2263367">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263387">p2</span>&nbsp;<span class="op" id="2263390">:=</span>&nbsp;<span class="ident" id="2263393">_lgamT</span><span class="op" id="2263399">[</span><span class="num" id="2263400">1</span><span class="op" id="2263401">]</span>&nbsp;<span class="op" id="2263403">+</span>&nbsp;<span class="ident" id="2263405">w</span><span class="op" id="2263406">*</span><span class="op" id="2263407">(</span><span class="ident" id="2263408">_lgamT</span><span class="op" id="2263414">[</span><span class="num" id="2263415">4</span><span class="op" id="2263416">]</span><span class="op" id="2263417">+</span><span class="ident" id="2263418">w</span><span class="op" id="2263419">*</span><span class="op" id="2263420">(</span><span class="ident" id="2263421">_lgamT</span><span class="op" id="2263427">[</span><span class="num" id="2263428">7</span><span class="op" id="2263429">]</span><span class="op" id="2263430">+</span><span class="ident" id="2263431">w</span><span class="op" id="2263432">*</span><span class="op" id="2263433">(</span><span class="ident" id="2263434">_lgamT</span><span class="op" id="2263440">[</span><span class="num" id="2263441">10</span><span class="op" id="2263443">]</span><span class="op" id="2263444">+</span><span class="ident" id="2263445">w</span><span class="op" id="2263446">*</span><span class="ident" id="2263447">_lgamT</span><span class="op" id="2263453">[</span><span class="num" id="2263454">13</span><span class="op" id="2263456">]</span><span class="op" id="2263457">)</span><span class="op" id="2263458">)</span><span class="op" id="2263459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263464">p3</span>&nbsp;<span class="op" id="2263467">:=</span>&nbsp;<span class="ident" id="2263470">_lgamT</span><span class="op" id="2263476">[</span><span class="num" id="2263477">2</span><span class="op" id="2263478">]</span>&nbsp;<span class="op" id="2263480">+</span>&nbsp;<span class="ident" id="2263482">w</span><span class="op" id="2263483">*</span><span class="op" id="2263484">(</span><span class="ident" id="2263485">_lgamT</span><span class="op" id="2263491">[</span><span class="num" id="2263492">5</span><span class="op" id="2263493">]</span><span class="op" id="2263494">+</span><span class="ident" id="2263495">w</span><span class="op" id="2263496">*</span><span class="op" id="2263497">(</span><span class="ident" id="2263498">_lgamT</span><span class="op" id="2263504">[</span><span class="num" id="2263505">8</span><span class="op" id="2263506">]</span><span class="op" id="2263507">+</span><span class="ident" id="2263508">w</span><span class="op" id="2263509">*</span><span class="op" id="2263510">(</span><span class="ident" id="2263511">_lgamT</span><span class="op" id="2263517">[</span><span class="num" id="2263518">11</span><span class="op" id="2263520">]</span><span class="op" id="2263521">+</span><span class="ident" id="2263522">w</span><span class="op" id="2263523">*</span><span class="ident" id="2263524">_lgamT</span><span class="op" id="2263530">[</span><span class="num" id="2263531">14</span><span class="op" id="2263533">]</span><span class="op" id="2263534">)</span><span class="op" id="2263535">)</span><span class="op" id="2263536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263541">p</span>&nbsp;<span class="op" id="2263543">:=</span>&nbsp;<span class="ident" id="2263546">z</span><span class="op" id="2263547">*</span><span class="ident" id="2263548">p1</span>&nbsp;<span class="op" id="2263551">-</span>&nbsp;<span class="op" id="2263553">(</span><span class="ident" id="2263554">Tt</span>&nbsp;<span class="op" id="2263557">-</span>&nbsp;<span class="ident" id="2263559">w</span><span class="op" id="2263560">*</span><span class="op" id="2263561">(</span><span class="ident" id="2263562">p2</span><span class="op" id="2263564">+</span><span class="ident" id="2263565">y</span><span class="op" id="2263566">*</span><span class="ident" id="2263567">p3</span><span class="op" id="2263569">)</span><span class="op" id="2263570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263575">lgamma</span>&nbsp;<span class="op" id="2263582">+=</span>&nbsp;<span class="op" id="2263585">(</span><span class="ident" id="2263586">Tf</span>&nbsp;<span class="op" id="2263589">+</span>&nbsp;<span class="ident" id="2263591">p</span><span class="op" id="2263592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2263596">case</span>&nbsp;<span class="num" id="2263601">2</span><span class="op" id="2263602">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263607">p1</span>&nbsp;<span class="op" id="2263610">:=</span>&nbsp;<span class="ident" id="2263613">y</span>&nbsp;<span class="op" id="2263615">*</span>&nbsp;<span class="op" id="2263617">(</span><span class="ident" id="2263618">_lgamU</span><span class="op" id="2263624">[</span><span class="num" id="2263625">0</span><span class="op" id="2263626">]</span>&nbsp;<span class="op" id="2263628">+</span>&nbsp;<span class="ident" id="2263630">y</span><span class="op" id="2263631">*</span><span class="op" id="2263632">(</span><span class="ident" id="2263633">_lgamU</span><span class="op" id="2263639">[</span><span class="num" id="2263640">1</span><span class="op" id="2263641">]</span><span class="op" id="2263642">+</span><span class="ident" id="2263643">y</span><span class="op" id="2263644">*</span><span class="op" id="2263645">(</span><span class="ident" id="2263646">_lgamU</span><span class="op" id="2263652">[</span><span class="num" id="2263653">2</span><span class="op" id="2263654">]</span><span class="op" id="2263655">+</span><span class="ident" id="2263656">y</span><span class="op" id="2263657">*</span><span class="op" id="2263658">(</span><span class="ident" id="2263659">_lgamU</span><span class="op" id="2263665">[</span><span class="num" id="2263666">3</span><span class="op" id="2263667">]</span><span class="op" id="2263668">+</span><span class="ident" id="2263669">y</span><span class="op" id="2263670">*</span><span class="op" id="2263671">(</span><span class="ident" id="2263672">_lgamU</span><span class="op" id="2263678">[</span><span class="num" id="2263679">4</span><span class="op" id="2263680">]</span><span class="op" id="2263681">+</span><span class="ident" id="2263682">y</span><span class="op" id="2263683">*</span><span class="ident" id="2263684">_lgamU</span><span class="op" id="2263690">[</span><span class="num" id="2263691">5</span><span class="op" id="2263692">]</span><span class="op" id="2263693">)</span><span class="op" id="2263694">)</span><span class="op" id="2263695">)</span><span class="op" id="2263696">)</span><span class="op" id="2263697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263702">p2</span>&nbsp;<span class="op" id="2263705">:=</span>&nbsp;<span class="num" id="2263708">1</span>&nbsp;<span class="op" id="2263710">+</span>&nbsp;<span class="ident" id="2263712">y</span><span class="op" id="2263713">*</span><span class="op" id="2263714">(</span><span class="ident" id="2263715">_lgamV</span><span class="op" id="2263721">[</span><span class="num" id="2263722">1</span><span class="op" id="2263723">]</span><span class="op" id="2263724">+</span><span class="ident" id="2263725">y</span><span class="op" id="2263726">*</span><span class="op" id="2263727">(</span><span class="ident" id="2263728">_lgamV</span><span class="op" id="2263734">[</span><span class="num" id="2263735">2</span><span class="op" id="2263736">]</span><span class="op" id="2263737">+</span><span class="ident" id="2263738">y</span><span class="op" id="2263739">*</span><span class="op" id="2263740">(</span><span class="ident" id="2263741">_lgamV</span><span class="op" id="2263747">[</span><span class="num" id="2263748">3</span><span class="op" id="2263749">]</span><span class="op" id="2263750">+</span><span class="ident" id="2263751">y</span><span class="op" id="2263752">*</span><span class="op" id="2263753">(</span><span class="ident" id="2263754">_lgamV</span><span class="op" id="2263760">[</span><span class="num" id="2263761">4</span><span class="op" id="2263762">]</span><span class="op" id="2263763">+</span><span class="ident" id="2263764">y</span><span class="op" id="2263765">*</span><span class="ident" id="2263766">_lgamV</span><span class="op" id="2263772">[</span><span class="num" id="2263773">5</span><span class="op" id="2263774">]</span><span class="op" id="2263775">)</span><span class="op" id="2263776">)</span><span class="op" id="2263777">)</span><span class="op" id="2263778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263783">lgamma</span>&nbsp;<span class="op" id="2263790">+=</span>&nbsp;<span class="op" id="2263793">(</span><span class="op" id="2263794">-</span><span class="num" id="2263795">0.5</span><span class="op" id="2263798">*</span><span class="ident" id="2263799">y</span>&nbsp;<span class="op" id="2263801">+</span>&nbsp;<span class="ident" id="2263803">p1</span><span class="op" id="2263805">/</span><span class="ident" id="2263806">p2</span><span class="op" id="2263808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2263812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2263815">case</span>&nbsp;<span class="ident" id="2263820">x</span>&nbsp;<span class="op" id="2263822">&lt;</span>&nbsp;<span class="num" id="2263824">8</span><span class="op" id="2263825">:</span>&nbsp;<span class="comment" id="2263827">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263843">i</span>&nbsp;<span class="op" id="2263845">:=</span>&nbsp;<span class="builtintype" id="2263848">int</span><span class="op" id="2263851">(</span><span class="ident" id="2263852">x</span><span class="op" id="2263853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263857">y</span>&nbsp;<span class="op" id="2263859">:=</span>&nbsp;<span class="ident" id="2263862">x</span>&nbsp;<span class="op" id="2263864">-</span>&nbsp;<span class="builtintype" id="2263866">float64</span><span class="op" id="2263873">(</span><span class="ident" id="2263874">i</span><span class="op" id="2263875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263879">p</span>&nbsp;<span class="op" id="2263881">:=</span>&nbsp;<span class="ident" id="2263884">y</span>&nbsp;<span class="op" id="2263886">*</span>&nbsp;<span class="op" id="2263888">(</span><span class="ident" id="2263889">_lgamS</span><span class="op" id="2263895">[</span><span class="num" id="2263896">0</span><span class="op" id="2263897">]</span>&nbsp;<span class="op" id="2263899">+</span>&nbsp;<span class="ident" id="2263901">y</span><span class="op" id="2263902">*</span><span class="op" id="2263903">(</span><span class="ident" id="2263904">_lgamS</span><span class="op" id="2263910">[</span><span class="num" id="2263911">1</span><span class="op" id="2263912">]</span><span class="op" id="2263913">+</span><span class="ident" id="2263914">y</span><span class="op" id="2263915">*</span><span class="op" id="2263916">(</span><span class="ident" id="2263917">_lgamS</span><span class="op" id="2263923">[</span><span class="num" id="2263924">2</span><span class="op" id="2263925">]</span><span class="op" id="2263926">+</span><span class="ident" id="2263927">y</span><span class="op" id="2263928">*</span><span class="op" id="2263929">(</span><span class="ident" id="2263930">_lgamS</span><span class="op" id="2263936">[</span><span class="num" id="2263937">3</span><span class="op" id="2263938">]</span><span class="op" id="2263939">+</span><span class="ident" id="2263940">y</span><span class="op" id="2263941">*</span><span class="op" id="2263942">(</span><span class="ident" id="2263943">_lgamS</span><span class="op" id="2263949">[</span><span class="num" id="2263950">4</span><span class="op" id="2263951">]</span><span class="op" id="2263952">+</span><span class="ident" id="2263953">y</span><span class="op" id="2263954">*</span><span class="op" id="2263955">(</span><span class="ident" id="2263956">_lgamS</span><span class="op" id="2263962">[</span><span class="num" id="2263963">5</span><span class="op" id="2263964">]</span><span class="op" id="2263965">+</span><span class="ident" id="2263966">y</span><span class="op" id="2263967">*</span><span class="ident" id="2263968">_lgamS</span><span class="op" id="2263974">[</span><span class="num" id="2263975">6</span><span class="op" id="2263976">]</span><span class="op" id="2263977">)</span><span class="op" id="2263978">)</span><span class="op" id="2263979">)</span><span class="op" id="2263980">)</span><span class="op" id="2263981">)</span><span class="op" id="2263982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2263986">q</span>&nbsp;<span class="op" id="2263988">:=</span>&nbsp;<span class="num" id="2263991">1</span>&nbsp;<span class="op" id="2263993">+</span>&nbsp;<span class="ident" id="2263995">y</span><span class="op" id="2263996">*</span><span class="op" id="2263997">(</span><span class="ident" id="2263998">_lgamR</span><span class="op" id="2264004">[</span><span class="num" id="2264005">1</span><span class="op" id="2264006">]</span><span class="op" id="2264007">+</span><span class="ident" id="2264008">y</span><span class="op" id="2264009">*</span><span class="op" id="2264010">(</span><span class="ident" id="2264011">_lgamR</span><span class="op" id="2264017">[</span><span class="num" id="2264018">2</span><span class="op" id="2264019">]</span><span class="op" id="2264020">+</span><span class="ident" id="2264021">y</span><span class="op" id="2264022">*</span><span class="op" id="2264023">(</span><span class="ident" id="2264024">_lgamR</span><span class="op" id="2264030">[</span><span class="num" id="2264031">3</span><span class="op" id="2264032">]</span><span class="op" id="2264033">+</span><span class="ident" id="2264034">y</span><span class="op" id="2264035">*</span><span class="op" id="2264036">(</span><span class="ident" id="2264037">_lgamR</span><span class="op" id="2264043">[</span><span class="num" id="2264044">4</span><span class="op" id="2264045">]</span><span class="op" id="2264046">+</span><span class="ident" id="2264047">y</span><span class="op" id="2264048">*</span><span class="op" id="2264049">(</span><span class="ident" id="2264050">_lgamR</span><span class="op" id="2264056">[</span><span class="num" id="2264057">5</span><span class="op" id="2264058">]</span><span class="op" id="2264059">+</span><span class="ident" id="2264060">y</span><span class="op" id="2264061">*</span><span class="ident" id="2264062">_lgamR</span><span class="op" id="2264068">[</span><span class="num" id="2264069">6</span><span class="op" id="2264070">]</span><span class="op" id="2264071">)</span><span class="op" id="2264072">)</span><span class="op" id="2264073">)</span><span class="op" id="2264074">)</span><span class="op" id="2264075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264079">lgamma</span>&nbsp;<span class="op" id="2264086">=</span>&nbsp;<span class="num" id="2264088">0.5</span><span class="op" id="2264091">*</span><span class="ident" id="2264092">y</span>&nbsp;<span class="op" id="2264094">+</span>&nbsp;<span class="ident" id="2264096">p</span><span class="op" id="2264097">/</span><span class="ident" id="2264098">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264102">z</span>&nbsp;<span class="op" id="2264104">:=</span>&nbsp;<span class="num" id="2264107">1.0</span>&nbsp;<span class="comment" id="2264111">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264149">switch</span>&nbsp;<span class="ident" id="2264156">i</span>&nbsp;<span class="op" id="2264158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264162">case</span>&nbsp;<span class="num" id="2264167">7</span><span class="op" id="2264168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264173">z</span>&nbsp;<span class="op" id="2264175">*=</span>&nbsp;<span class="op" id="2264178">(</span><span class="ident" id="2264179">y</span>&nbsp;<span class="op" id="2264181">+</span>&nbsp;<span class="num" id="2264183">6</span><span class="op" id="2264184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264189">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264203">case</span>&nbsp;<span class="num" id="2264208">6</span><span class="op" id="2264209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264214">z</span>&nbsp;<span class="op" id="2264216">*=</span>&nbsp;<span class="op" id="2264219">(</span><span class="ident" id="2264220">y</span>&nbsp;<span class="op" id="2264222">+</span>&nbsp;<span class="num" id="2264224">5</span><span class="op" id="2264225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264230">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264244">case</span>&nbsp;<span class="num" id="2264249">5</span><span class="op" id="2264250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264255">z</span>&nbsp;<span class="op" id="2264257">*=</span>&nbsp;<span class="op" id="2264260">(</span><span class="ident" id="2264261">y</span>&nbsp;<span class="op" id="2264263">+</span>&nbsp;<span class="num" id="2264265">4</span><span class="op" id="2264266">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264271">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264285">case</span>&nbsp;<span class="num" id="2264290">4</span><span class="op" id="2264291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264296">z</span>&nbsp;<span class="op" id="2264298">*=</span>&nbsp;<span class="op" id="2264301">(</span><span class="ident" id="2264302">y</span>&nbsp;<span class="op" id="2264304">+</span>&nbsp;<span class="num" id="2264306">3</span><span class="op" id="2264307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264312">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264326">case</span>&nbsp;<span class="num" id="2264331">3</span><span class="op" id="2264332">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264337">z</span>&nbsp;<span class="op" id="2264339">*=</span>&nbsp;<span class="op" id="2264342">(</span><span class="ident" id="2264343">y</span>&nbsp;<span class="op" id="2264345">+</span>&nbsp;<span class="num" id="2264347">2</span><span class="op" id="2264348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264353">lgamma</span>&nbsp;<span class="op" id="2264360">+=</span>&nbsp;<span class="ident" id="2264363">Log</span><span class="op" id="2264366">(</span><span class="ident" id="2264367">z</span><span class="op" id="2264368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2264372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264375">case</span>&nbsp;<span class="ident" id="2264380">x</span>&nbsp;<span class="op" id="2264382">&lt;</span>&nbsp;<span class="ident" id="2264384">Two58</span><span class="op" id="2264389">:</span>&nbsp;<span class="comment" id="2264391">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264411">t</span>&nbsp;<span class="op" id="2264413">:=</span>&nbsp;<span class="ident" id="2264416">Log</span><span class="op" id="2264419">(</span><span class="ident" id="2264420">x</span><span class="op" id="2264421">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264425">z</span>&nbsp;<span class="op" id="2264427">:=</span>&nbsp;<span class="num" id="2264430">1</span>&nbsp;<span class="op" id="2264432">/</span>&nbsp;<span class="ident" id="2264434">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264438">y</span>&nbsp;<span class="op" id="2264440">:=</span>&nbsp;<span class="ident" id="2264443">z</span>&nbsp;<span class="op" id="2264445">*</span>&nbsp;<span class="ident" id="2264447">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264451">w</span>&nbsp;<span class="op" id="2264453">:=</span>&nbsp;<span class="ident" id="2264456">_lgamW</span><span class="op" id="2264462">[</span><span class="num" id="2264463">0</span><span class="op" id="2264464">]</span>&nbsp;<span class="op" id="2264466">+</span>&nbsp;<span class="ident" id="2264468">z</span><span class="op" id="2264469">*</span><span class="op" id="2264470">(</span><span class="ident" id="2264471">_lgamW</span><span class="op" id="2264477">[</span><span class="num" id="2264478">1</span><span class="op" id="2264479">]</span><span class="op" id="2264480">+</span><span class="ident" id="2264481">y</span><span class="op" id="2264482">*</span><span class="op" id="2264483">(</span><span class="ident" id="2264484">_lgamW</span><span class="op" id="2264490">[</span><span class="num" id="2264491">2</span><span class="op" id="2264492">]</span><span class="op" id="2264493">+</span><span class="ident" id="2264494">y</span><span class="op" id="2264495">*</span><span class="op" id="2264496">(</span><span class="ident" id="2264497">_lgamW</span><span class="op" id="2264503">[</span><span class="num" id="2264504">3</span><span class="op" id="2264505">]</span><span class="op" id="2264506">+</span><span class="ident" id="2264507">y</span><span class="op" id="2264508">*</span><span class="op" id="2264509">(</span><span class="ident" id="2264510">_lgamW</span><span class="op" id="2264516">[</span><span class="num" id="2264517">4</span><span class="op" id="2264518">]</span><span class="op" id="2264519">+</span><span class="ident" id="2264520">y</span><span class="op" id="2264521">*</span><span class="op" id="2264522">(</span><span class="ident" id="2264523">_lgamW</span><span class="op" id="2264529">[</span><span class="num" id="2264530">5</span><span class="op" id="2264531">]</span><span class="op" id="2264532">+</span><span class="ident" id="2264533">y</span><span class="op" id="2264534">*</span><span class="ident" id="2264535">_lgamW</span><span class="op" id="2264541">[</span><span class="num" id="2264542">6</span><span class="op" id="2264543">]</span><span class="op" id="2264544">)</span><span class="op" id="2264545">)</span><span class="op" id="2264546">)</span><span class="op" id="2264547">)</span><span class="op" id="2264548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264552">lgamma</span>&nbsp;<span class="op" id="2264559">=</span>&nbsp;<span class="op" id="2264561">(</span><span class="ident" id="2264562">x</span><span class="op" id="2264563">-</span><span class="num" id="2264564">0.5</span><span class="op" id="2264567">)</span><span class="op" id="2264568">*</span><span class="op" id="2264569">(</span><span class="ident" id="2264570">t</span><span class="op" id="2264571">-</span><span class="num" id="2264572">1</span><span class="op" id="2264573">)</span>&nbsp;<span class="op" id="2264575">+</span>&nbsp;<span class="ident" id="2264577">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264580">default</span><span class="op" id="2264587">:</span>&nbsp;<span class="comment" id="2264589">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264612">lgamma</span>&nbsp;<span class="op" id="2264619">=</span>&nbsp;<span class="ident" id="2264621">x</span>&nbsp;<span class="op" id="2264623">*</span>&nbsp;<span class="op" id="2264625">(</span><span class="ident" id="2264626">Log</span><span class="op" id="2264629">(</span><span class="ident" id="2264630">x</span><span class="op" id="2264631">)</span>&nbsp;<span class="op" id="2264633">-</span>&nbsp;<span class="num" id="2264635">1</span><span class="op" id="2264636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2264639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264642">if</span>&nbsp;<span class="ident" id="2264645">neg</span>&nbsp;<span class="op" id="2264649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264653">lgamma</span>&nbsp;<span class="op" id="2264660">=</span>&nbsp;<span class="ident" id="2264662">nadj</span>&nbsp;<span class="op" id="2264667">-</span>&nbsp;<span class="ident" id="2264669">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2264677">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264680">return</span><br>
<span class="lineno"></span><span class="op" id="2264687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2264690">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2264738">func</span>&nbsp;<span class="ident" id="2264743">sinPi</span><span class="op" id="2264748">(</span><span class="ident" id="2264749">x</span>&nbsp;<span class="builtintype" id="2264751">float64</span><span class="op" id="2264758">)</span>&nbsp;<span class="builtintype" id="2264760">float64</span>&nbsp;<span class="op" id="2264768">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264771">const</span>&nbsp;<span class="op" id="2264777">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264781">Two52</span>&nbsp;<span class="op" id="2264787">=</span>&nbsp;<span class="num" id="2264789">1</span>&nbsp;<span class="op" id="2264791">&lt;&lt;</span>&nbsp;<span class="num" id="2264794">52</span>&nbsp;<span class="comment" id="2264797">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264833">Two53</span>&nbsp;<span class="op" id="2264839">=</span>&nbsp;<span class="num" id="2264841">1</span>&nbsp;<span class="op" id="2264843">&lt;&lt;</span>&nbsp;<span class="num" id="2264846">53</span>&nbsp;<span class="comment" id="2264849">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2264884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264887">if</span>&nbsp;<span class="ident" id="2264890">x</span>&nbsp;<span class="op" id="2264892">&lt;</span>&nbsp;<span class="num" id="2264894">0.25</span>&nbsp;<span class="op" id="2264899">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264903">return</span>&nbsp;<span class="op" id="2264910">-</span><span class="ident" id="2264911">Sin</span><span class="op" id="2264914">(</span><span class="ident" id="2264915">Pi</span>&nbsp;<span class="op" id="2264918">*</span>&nbsp;<span class="ident" id="2264920">x</span><span class="op" id="2264921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2264924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2264928">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2264951">z</span>&nbsp;<span class="op" id="2264953">:=</span>&nbsp;<span class="ident" id="2264956">Floor</span><span class="op" id="2264961">(</span><span class="ident" id="2264962">x</span><span class="op" id="2264963">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264966">var</span>&nbsp;<span class="ident" id="2264970">n</span>&nbsp;<span class="builtintype" id="2264972">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2264977">if</span>&nbsp;<span class="ident" id="2264980">z</span>&nbsp;<span class="op" id="2264982">!=</span>&nbsp;<span class="ident" id="2264985">x</span>&nbsp;<span class="op" id="2264987">{</span>&nbsp;<span class="comment" id="2264989">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265002">x</span>&nbsp;<span class="op" id="2265004">=</span>&nbsp;<span class="ident" id="2265006">Mod</span><span class="op" id="2265009">(</span><span class="ident" id="2265010">x</span><span class="op" id="2265011">,</span>&nbsp;<span class="num" id="2265013">2</span><span class="op" id="2265014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265018">n</span>&nbsp;<span class="op" id="2265020">=</span>&nbsp;<span class="builtintype" id="2265022">int</span><span class="op" id="2265025">(</span><span class="ident" id="2265026">x</span>&nbsp;<span class="op" id="2265028">*</span>&nbsp;<span class="num" id="2265030">4</span><span class="op" id="2265031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265034">}</span>&nbsp;<span class="keyword" id="2265036">else</span>&nbsp;<span class="op" id="2265041">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265045">if</span>&nbsp;<span class="ident" id="2265048">x</span>&nbsp;<span class="op" id="2265050">&gt;=</span>&nbsp;<span class="ident" id="2265053">Two53</span>&nbsp;<span class="op" id="2265059">{</span>&nbsp;<span class="comment" id="2265061">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265082">x</span>&nbsp;<span class="op" id="2265084">=</span>&nbsp;<span class="num" id="2265086">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265091">n</span>&nbsp;<span class="op" id="2265093">=</span>&nbsp;<span class="num" id="2265095">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265099">}</span>&nbsp;<span class="keyword" id="2265101">else</span>&nbsp;<span class="op" id="2265106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265111">if</span>&nbsp;<span class="ident" id="2265114">x</span>&nbsp;<span class="op" id="2265116">&lt;</span>&nbsp;<span class="ident" id="2265118">Two52</span>&nbsp;<span class="op" id="2265124">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265130">z</span>&nbsp;<span class="op" id="2265132">=</span>&nbsp;<span class="ident" id="2265134">x</span>&nbsp;<span class="op" id="2265136">+</span>&nbsp;<span class="ident" id="2265138">Two52</span>&nbsp;<span class="comment" id="2265144">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265161">n</span>&nbsp;<span class="op" id="2265163">=</span>&nbsp;<span class="builtintype" id="2265165">int</span><span class="op" id="2265168">(</span><span class="num" id="2265169">1</span>&nbsp;<span class="op" id="2265171">&amp;</span>&nbsp;<span class="ident" id="2265173">Float64bits</span><span class="op" id="2265184">(</span><span class="ident" id="2265185">z</span><span class="op" id="2265186">)</span><span class="op" id="2265187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265192">x</span>&nbsp;<span class="op" id="2265194">=</span>&nbsp;<span class="builtintype" id="2265196">float64</span><span class="op" id="2265203">(</span><span class="ident" id="2265204">n</span><span class="op" id="2265205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265210">n</span>&nbsp;<span class="op" id="2265212">&lt;&lt;=</span>&nbsp;<span class="num" id="2265216">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265226">switch</span>&nbsp;<span class="ident" id="2265233">n</span>&nbsp;<span class="op" id="2265235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265238">case</span>&nbsp;<span class="num" id="2265243">0</span><span class="op" id="2265244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265248">x</span>&nbsp;<span class="op" id="2265250">=</span>&nbsp;<span class="ident" id="2265252">Sin</span><span class="op" id="2265255">(</span><span class="ident" id="2265256">Pi</span>&nbsp;<span class="op" id="2265259">*</span>&nbsp;<span class="ident" id="2265261">x</span><span class="op" id="2265262">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265265">case</span>&nbsp;<span class="num" id="2265270">1</span><span class="op" id="2265271">,</span>&nbsp;<span class="num" id="2265273">2</span><span class="op" id="2265274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265278">x</span>&nbsp;<span class="op" id="2265280">=</span>&nbsp;<span class="ident" id="2265282">Cos</span><span class="op" id="2265285">(</span><span class="ident" id="2265286">Pi</span>&nbsp;<span class="op" id="2265289">*</span>&nbsp;<span class="op" id="2265291">(</span><span class="num" id="2265292">0.5</span>&nbsp;<span class="op" id="2265296">-</span>&nbsp;<span class="ident" id="2265298">x</span><span class="op" id="2265299">)</span><span class="op" id="2265300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265303">case</span>&nbsp;<span class="num" id="2265308">3</span><span class="op" id="2265309">,</span>&nbsp;<span class="num" id="2265311">4</span><span class="op" id="2265312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265316">x</span>&nbsp;<span class="op" id="2265318">=</span>&nbsp;<span class="ident" id="2265320">Sin</span><span class="op" id="2265323">(</span><span class="ident" id="2265324">Pi</span>&nbsp;<span class="op" id="2265327">*</span>&nbsp;<span class="op" id="2265329">(</span><span class="num" id="2265330">1</span>&nbsp;<span class="op" id="2265332">-</span>&nbsp;<span class="ident" id="2265334">x</span><span class="op" id="2265335">)</span><span class="op" id="2265336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265339">case</span>&nbsp;<span class="num" id="2265344">5</span><span class="op" id="2265345">,</span>&nbsp;<span class="num" id="2265347">6</span><span class="op" id="2265348">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265352">x</span>&nbsp;<span class="op" id="2265354">=</span>&nbsp;<span class="op" id="2265356">-</span><span class="ident" id="2265357">Cos</span><span class="op" id="2265360">(</span><span class="ident" id="2265361">Pi</span>&nbsp;<span class="op" id="2265364">*</span>&nbsp;<span class="op" id="2265366">(</span><span class="ident" id="2265367">x</span>&nbsp;<span class="op" id="2265369">-</span>&nbsp;<span class="num" id="2265371">1.5</span><span class="op" id="2265374">)</span><span class="op" id="2265375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265378">default</span><span class="op" id="2265385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2265389">x</span>&nbsp;<span class="op" id="2265391">=</span>&nbsp;<span class="ident" id="2265393">Sin</span><span class="op" id="2265396">(</span><span class="ident" id="2265397">Pi</span>&nbsp;<span class="op" id="2265400">*</span>&nbsp;<span class="op" id="2265402">(</span><span class="ident" id="2265403">x</span>&nbsp;<span class="op" id="2265405">-</span>&nbsp;<span class="num" id="2265407">2</span><span class="op" id="2265408">)</span><span class="op" id="2265409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2265412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2265415">return</span>&nbsp;<span class="op" id="2265422">-</span><span class="ident" id="2265423">x</span><br>
<span class="lineno">365</span><span class="op" id="2265425">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
