<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3987154">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3987209">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3987263">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3987314">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="3987391">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="3987449">package</span>&nbsp;<span class="ident" id="3987457">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3987463">import</span>&nbsp;<span class="op" id="3987470">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3987473">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3987490">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3987502">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3987509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3987512">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3987592">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="3987618">type</span>&nbsp;<span class="ident" id="3987623">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="3987643">struct</span>&nbsp;<span class="op" id="3987650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987653">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="3987664">asn1</span><span class="op" id="3987668">.</span><span class="ident" id="3987669">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987687">Parameters</span>&nbsp;<span class="ident" id="3987698">asn1</span><span class="op" id="3987702">.</span><span class="ident" id="3987703">RawValue</span>&nbsp;<span class="string" id="3987712">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="3987730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3987733">type</span>&nbsp;<span class="ident" id="3987738">RDNSequence</span>&nbsp;<span class="op" id="3987750">[</span><span class="op" id="3987751">]</span><span class="ident" id="3987752">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3987782">type</span>&nbsp;<span class="ident" id="3987787">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="3987816">[</span><span class="op" id="3987817">]</span><span class="ident" id="3987818">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3987841">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3987914">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="3987968">type</span>&nbsp;<span class="ident" id="3987973">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="3987995">struct</span>&nbsp;<span class="op" id="3988002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988005">Type</span>&nbsp;&nbsp;<span class="ident" id="3988011">asn1</span><span class="op" id="3988015">.</span><span class="ident" id="3988016">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988034">Value</span>&nbsp;<span class="keyword" id="3988040">interface</span><span class="op" id="3988049">{</span><span class="op" id="3988050">}</span><br>
<span class="lineno"></span><span class="op" id="3988052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3988055">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3988122">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="3988183">type</span>&nbsp;<span class="ident" id="3988188">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="3988213">struct</span>&nbsp;<span class="op" id="3988220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988223">Type</span>&nbsp;&nbsp;<span class="ident" id="3988229">asn1</span><span class="op" id="3988233">.</span><span class="ident" id="3988234">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988252">Value</span>&nbsp;<span class="op" id="3988258">[</span><span class="op" id="3988259">]</span><span class="op" id="3988260">[</span><span class="op" id="3988261">]</span><span class="ident" id="3988262">AttributeTypeAndValue</span>&nbsp;<span class="string" id="3988284">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3988297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3988300">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3988370">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="3988392">type</span>&nbsp;<span class="ident" id="3988397">Extension</span>&nbsp;<span class="keyword" id="3988407">struct</span>&nbsp;<span class="op" id="3988414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988417">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988426">asn1</span><span class="op" id="3988430">.</span><span class="ident" id="3988431">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988449">Critical</span>&nbsp;<span class="builtintype" id="3988458">bool</span>&nbsp;<span class="string" id="3988463">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988482">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988491">[</span><span class="op" id="3988492">]</span><span class="builtintype" id="3988493">byte</span><br>
<span class="lineno"></span><span class="op" id="3988498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3988501">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="3988579">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="3988646">type</span>&nbsp;<span class="ident" id="3988651">Name</span>&nbsp;<span class="keyword" id="3988656">struct</span>&nbsp;<span class="op" id="3988663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988666">Country</span><span class="op" id="3988673">,</span>&nbsp;<span class="ident" id="3988675">Organization</span><span class="op" id="3988687">,</span>&nbsp;<span class="ident" id="3988689">OrganizationalUnit</span>&nbsp;<span class="op" id="3988708">[</span><span class="op" id="3988709">]</span><span class="builtintype" id="3988710">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988718">Locality</span><span class="op" id="3988726">,</span>&nbsp;<span class="ident" id="3988728">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988760">[</span><span class="op" id="3988761">]</span><span class="builtintype" id="3988762">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988770">StreetAddress</span><span class="op" id="3988783">,</span>&nbsp;<span class="ident" id="3988785">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988812">[</span><span class="op" id="3988813">]</span><span class="builtintype" id="3988814">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988822">SerialNumber</span><span class="op" id="3988834">,</span>&nbsp;<span class="ident" id="3988836">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3988864">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988873">Names</span>&nbsp;<span class="op" id="3988879">[</span><span class="op" id="3988880">]</span><span class="ident" id="3988881">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="3988903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3988906">func</span>&nbsp;<span class="op" id="3988911">(</span><span class="ident" id="3988912">n</span>&nbsp;<span class="op" id="3988914">*</span><span class="ident" id="3988915">Name</span><span class="op" id="3988919">)</span>&nbsp;<span class="ident" id="3988921">FillFromRDNSequence</span><span class="op" id="3988940">(</span><span class="ident" id="3988941">rdns</span>&nbsp;<span class="op" id="3988946">*</span><span class="ident" id="3988947">RDNSequence</span><span class="op" id="3988958">)</span>&nbsp;<span class="op" id="3988960">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3988963">for</span>&nbsp;<span class="ident" id="3988967">_</span><span class="op" id="3988968">,</span>&nbsp;<span class="ident" id="3988970">rdn</span>&nbsp;<span class="op" id="3988974">:=</span>&nbsp;<span class="keyword" id="3988977">range</span>&nbsp;<span class="op" id="3988983">*</span><span class="ident" id="3988984">rdns</span>&nbsp;<span class="op" id="3988989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3988993">if</span>&nbsp;<span class="builtinfunc" id="3988996">len</span><span class="op" id="3988999">(</span><span class="ident" id="3989000">rdn</span><span class="op" id="3989003">)</span>&nbsp;<span class="op" id="3989005">==</span>&nbsp;<span class="num" id="3989008">0</span>&nbsp;<span class="op" id="3989010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989015">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989030">atv</span>&nbsp;<span class="op" id="3989034">:=</span>&nbsp;<span class="ident" id="3989037">rdn</span><span class="op" id="3989040">[</span><span class="num" id="3989041">0</span><span class="op" id="3989042">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989046">n</span><span class="op" id="3989047">.</span><span class="ident" id="3989048">Names</span>&nbsp;<span class="op" id="3989054">=</span>&nbsp;<span class="builtinfunc" id="3989056">append</span><span class="op" id="3989062">(</span><span class="ident" id="3989063">n</span><span class="op" id="3989064">.</span><span class="ident" id="3989065">Names</span><span class="op" id="3989070">,</span>&nbsp;<span class="ident" id="3989072">atv</span><span class="op" id="3989075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989079">value</span><span class="op" id="3989084">,</span>&nbsp;<span class="ident" id="3989086">ok</span>&nbsp;<span class="op" id="3989089">:=</span>&nbsp;<span class="ident" id="3989092">atv</span><span class="op" id="3989095">.</span><span class="ident" id="3989096">Value</span><span class="op" id="3989101">.</span><span class="op" id="3989102">(</span><span class="builtintype" id="3989103">string</span><span class="op" id="3989109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989113">if</span>&nbsp;<span class="op" id="3989116">!</span><span class="ident" id="3989117">ok</span>&nbsp;<span class="op" id="3989120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989125">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989136">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989141">t</span>&nbsp;<span class="op" id="3989143">:=</span>&nbsp;<span class="ident" id="3989146">atv</span><span class="op" id="3989149">.</span><span class="ident" id="3989150">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989157">if</span>&nbsp;<span class="builtinfunc" id="3989160">len</span><span class="op" id="3989163">(</span><span class="ident" id="3989164">t</span><span class="op" id="3989165">)</span>&nbsp;<span class="op" id="3989167">==</span>&nbsp;<span class="num" id="3989170">4</span>&nbsp;<span class="op" id="3989172">&amp;&amp;</span>&nbsp;<span class="ident" id="3989175">t</span><span class="op" id="3989176">[</span><span class="num" id="3989177">0</span><span class="op" id="3989178">]</span>&nbsp;<span class="op" id="3989180">==</span>&nbsp;<span class="num" id="3989183">2</span>&nbsp;<span class="op" id="3989185">&amp;&amp;</span>&nbsp;<span class="ident" id="3989188">t</span><span class="op" id="3989189">[</span><span class="num" id="3989190">1</span><span class="op" id="3989191">]</span>&nbsp;<span class="op" id="3989193">==</span>&nbsp;<span class="num" id="3989196">5</span>&nbsp;<span class="op" id="3989198">&amp;&amp;</span>&nbsp;<span class="ident" id="3989201">t</span><span class="op" id="3989202">[</span><span class="num" id="3989203">2</span><span class="op" id="3989204">]</span>&nbsp;<span class="op" id="3989206">==</span>&nbsp;<span class="num" id="3989209">4</span>&nbsp;<span class="op" id="3989211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989216">switch</span>&nbsp;<span class="ident" id="3989223">t</span><span class="op" id="3989224">[</span><span class="num" id="3989225">3</span><span class="op" id="3989226">]</span>&nbsp;<span class="op" id="3989228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989233">case</span>&nbsp;<span class="num" id="3989238">3</span><span class="op" id="3989239">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989245">n</span><span class="op" id="3989246">.</span><span class="ident" id="3989247">CommonName</span>&nbsp;<span class="op" id="3989258">=</span>&nbsp;<span class="ident" id="3989260">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989269">case</span>&nbsp;<span class="num" id="3989274">5</span><span class="op" id="3989275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989281">n</span><span class="op" id="3989282">.</span><span class="ident" id="3989283">SerialNumber</span>&nbsp;<span class="op" id="3989296">=</span>&nbsp;<span class="ident" id="3989298">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989307">case</span>&nbsp;<span class="num" id="3989312">6</span><span class="op" id="3989313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989319">n</span><span class="op" id="3989320">.</span><span class="ident" id="3989321">Country</span>&nbsp;<span class="op" id="3989329">=</span>&nbsp;<span class="builtinfunc" id="3989331">append</span><span class="op" id="3989337">(</span><span class="ident" id="3989338">n</span><span class="op" id="3989339">.</span><span class="ident" id="3989340">Country</span><span class="op" id="3989347">,</span>&nbsp;<span class="ident" id="3989349">value</span><span class="op" id="3989354">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989359">case</span>&nbsp;<span class="num" id="3989364">7</span><span class="op" id="3989365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989371">n</span><span class="op" id="3989372">.</span><span class="ident" id="3989373">Locality</span>&nbsp;<span class="op" id="3989382">=</span>&nbsp;<span class="builtinfunc" id="3989384">append</span><span class="op" id="3989390">(</span><span class="ident" id="3989391">n</span><span class="op" id="3989392">.</span><span class="ident" id="3989393">Locality</span><span class="op" id="3989401">,</span>&nbsp;<span class="ident" id="3989403">value</span><span class="op" id="3989408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989413">case</span>&nbsp;<span class="num" id="3989418">8</span><span class="op" id="3989419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989425">n</span><span class="op" id="3989426">.</span><span class="ident" id="3989427">Province</span>&nbsp;<span class="op" id="3989436">=</span>&nbsp;<span class="builtinfunc" id="3989438">append</span><span class="op" id="3989444">(</span><span class="ident" id="3989445">n</span><span class="op" id="3989446">.</span><span class="ident" id="3989447">Province</span><span class="op" id="3989455">,</span>&nbsp;<span class="ident" id="3989457">value</span><span class="op" id="3989462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989467">case</span>&nbsp;<span class="num" id="3989472">9</span><span class="op" id="3989473">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989479">n</span><span class="op" id="3989480">.</span><span class="ident" id="3989481">StreetAddress</span>&nbsp;<span class="op" id="3989495">=</span>&nbsp;<span class="builtinfunc" id="3989497">append</span><span class="op" id="3989503">(</span><span class="ident" id="3989504">n</span><span class="op" id="3989505">.</span><span class="ident" id="3989506">StreetAddress</span><span class="op" id="3989519">,</span>&nbsp;<span class="ident" id="3989521">value</span><span class="op" id="3989526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989531">case</span>&nbsp;<span class="num" id="3989536">10</span><span class="op" id="3989538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989544">n</span><span class="op" id="3989545">.</span><span class="ident" id="3989546">Organization</span>&nbsp;<span class="op" id="3989559">=</span>&nbsp;<span class="builtinfunc" id="3989561">append</span><span class="op" id="3989567">(</span><span class="ident" id="3989568">n</span><span class="op" id="3989569">.</span><span class="ident" id="3989570">Organization</span><span class="op" id="3989582">,</span>&nbsp;<span class="ident" id="3989584">value</span><span class="op" id="3989589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989594">case</span>&nbsp;<span class="num" id="3989599">11</span><span class="op" id="3989601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989607">n</span><span class="op" id="3989608">.</span><span class="ident" id="3989609">OrganizationalUnit</span>&nbsp;<span class="op" id="3989628">=</span>&nbsp;<span class="builtinfunc" id="3989630">append</span><span class="op" id="3989636">(</span><span class="ident" id="3989637">n</span><span class="op" id="3989638">.</span><span class="ident" id="3989639">OrganizationalUnit</span><span class="op" id="3989657">,</span>&nbsp;<span class="ident" id="3989659">value</span><span class="op" id="3989664">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989669">case</span>&nbsp;<span class="num" id="3989674">17</span><span class="op" id="3989676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989682">n</span><span class="op" id="3989683">.</span><span class="ident" id="3989684">PostalCode</span>&nbsp;<span class="op" id="3989695">=</span>&nbsp;<span class="builtinfunc" id="3989697">append</span><span class="op" id="3989703">(</span><span class="ident" id="3989704">n</span><span class="op" id="3989705">.</span><span class="ident" id="3989706">PostalCode</span><span class="op" id="3989716">,</span>&nbsp;<span class="ident" id="3989718">value</span><span class="op" id="3989723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989735">}</span><br>
<span class="lineno">95</span><span class="op" id="3989737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3989740">var</span>&nbsp;<span class="op" id="3989744">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989747">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989769">=</span>&nbsp;<span class="op" id="3989771">[</span><span class="op" id="3989772">]</span><span class="builtintype" id="3989773">int</span><span class="op" id="3989776">{</span><span class="num" id="3989777">2</span><span class="op" id="3989778">,</span>&nbsp;<span class="num" id="3989780">5</span><span class="op" id="3989781">,</span>&nbsp;<span class="num" id="3989783">4</span><span class="op" id="3989784">,</span>&nbsp;<span class="num" id="3989786">6</span><span class="op" id="3989787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989790">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989812">=</span>&nbsp;<span class="op" id="3989814">[</span><span class="op" id="3989815">]</span><span class="builtintype" id="3989816">int</span><span class="op" id="3989819">{</span><span class="num" id="3989820">2</span><span class="op" id="3989821">,</span>&nbsp;<span class="num" id="3989823">5</span><span class="op" id="3989824">,</span>&nbsp;<span class="num" id="3989826">4</span><span class="op" id="3989827">,</span>&nbsp;<span class="num" id="3989829">10</span><span class="op" id="3989831">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989834">oidOrganizationalUnit</span>&nbsp;<span class="op" id="3989856">=</span>&nbsp;<span class="op" id="3989858">[</span><span class="op" id="3989859">]</span><span class="builtintype" id="3989860">int</span><span class="op" id="3989863">{</span><span class="num" id="3989864">2</span><span class="op" id="3989865">,</span>&nbsp;<span class="num" id="3989867">5</span><span class="op" id="3989868">,</span>&nbsp;<span class="num" id="3989870">4</span><span class="op" id="3989871">,</span>&nbsp;<span class="num" id="3989873">11</span><span class="op" id="3989875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989878">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989900">=</span>&nbsp;<span class="op" id="3989902">[</span><span class="op" id="3989903">]</span><span class="builtintype" id="3989904">int</span><span class="op" id="3989907">{</span><span class="num" id="3989908">2</span><span class="op" id="3989909">,</span>&nbsp;<span class="num" id="3989911">5</span><span class="op" id="3989912">,</span>&nbsp;<span class="num" id="3989914">4</span><span class="op" id="3989915">,</span>&nbsp;<span class="num" id="3989917">3</span><span class="op" id="3989918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989921">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989943">=</span>&nbsp;<span class="op" id="3989945">[</span><span class="op" id="3989946">]</span><span class="builtintype" id="3989947">int</span><span class="op" id="3989950">{</span><span class="num" id="3989951">2</span><span class="op" id="3989952">,</span>&nbsp;<span class="num" id="3989954">5</span><span class="op" id="3989955">,</span>&nbsp;<span class="num" id="3989957">4</span><span class="op" id="3989958">,</span>&nbsp;<span class="num" id="3989960">5</span><span class="op" id="3989961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989964">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989986">=</span>&nbsp;<span class="op" id="3989988">[</span><span class="op" id="3989989">]</span><span class="builtintype" id="3989990">int</span><span class="op" id="3989993">{</span><span class="num" id="3989994">2</span><span class="op" id="3989995">,</span>&nbsp;<span class="num" id="3989997">5</span><span class="op" id="3989998">,</span>&nbsp;<span class="num" id="3990000">4</span><span class="op" id="3990001">,</span>&nbsp;<span class="num" id="3990003">7</span><span class="op" id="3990004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990007">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990029">=</span>&nbsp;<span class="op" id="3990031">[</span><span class="op" id="3990032">]</span><span class="builtintype" id="3990033">int</span><span class="op" id="3990036">{</span><span class="num" id="3990037">2</span><span class="op" id="3990038">,</span>&nbsp;<span class="num" id="3990040">5</span><span class="op" id="3990041">,</span>&nbsp;<span class="num" id="3990043">4</span><span class="op" id="3990044">,</span>&nbsp;<span class="num" id="3990046">8</span><span class="op" id="3990047">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990050">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990072">=</span>&nbsp;<span class="op" id="3990074">[</span><span class="op" id="3990075">]</span><span class="builtintype" id="3990076">int</span><span class="op" id="3990079">{</span><span class="num" id="3990080">2</span><span class="op" id="3990081">,</span>&nbsp;<span class="num" id="3990083">5</span><span class="op" id="3990084">,</span>&nbsp;<span class="num" id="3990086">4</span><span class="op" id="3990087">,</span>&nbsp;<span class="num" id="3990089">9</span><span class="op" id="3990090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990093">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990115">=</span>&nbsp;<span class="op" id="3990117">[</span><span class="op" id="3990118">]</span><span class="builtintype" id="3990119">int</span><span class="op" id="3990122">{</span><span class="num" id="3990123">2</span><span class="op" id="3990124">,</span>&nbsp;<span class="num" id="3990126">5</span><span class="op" id="3990127">,</span>&nbsp;<span class="num" id="3990129">4</span><span class="op" id="3990130">,</span>&nbsp;<span class="num" id="3990132">17</span><span class="op" id="3990134">}</span><br>
<span class="lineno"></span><span class="op" id="3990136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3990139">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="3990217">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3990292">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3990370">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="3990407">func</span>&nbsp;<span class="ident" id="3990412">appendRDNs</span><span class="op" id="3990422">(</span><span class="ident" id="3990423">in</span>&nbsp;<span class="ident" id="3990426">RDNSequence</span><span class="op" id="3990437">,</span>&nbsp;<span class="ident" id="3990439">values</span>&nbsp;<span class="op" id="3990446">[</span><span class="op" id="3990447">]</span><span class="builtintype" id="3990448">string</span><span class="op" id="3990454">,</span>&nbsp;<span class="ident" id="3990456">oid</span>&nbsp;<span class="ident" id="3990460">asn1</span><span class="op" id="3990464">.</span><span class="ident" id="3990465">ObjectIdentifier</span><span class="op" id="3990481">)</span>&nbsp;<span class="ident" id="3990483">RDNSequence</span>&nbsp;<span class="op" id="3990495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990498">if</span>&nbsp;<span class="builtinfunc" id="3990501">len</span><span class="op" id="3990504">(</span><span class="ident" id="3990505">values</span><span class="op" id="3990511">)</span>&nbsp;<span class="op" id="3990513">==</span>&nbsp;<span class="num" id="3990516">0</span>&nbsp;<span class="op" id="3990518">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990522">return</span>&nbsp;<span class="ident" id="3990529">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990537">s</span>&nbsp;<span class="op" id="3990539">:=</span>&nbsp;<span class="builtinfunc" id="3990542">make</span><span class="op" id="3990546">(</span><span class="op" id="3990547">[</span><span class="op" id="3990548">]</span><span class="ident" id="3990549">AttributeTypeAndValue</span><span class="op" id="3990570">,</span>&nbsp;<span class="builtinfunc" id="3990572">len</span><span class="op" id="3990575">(</span><span class="ident" id="3990576">values</span><span class="op" id="3990582">)</span><span class="op" id="3990583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990586">for</span>&nbsp;<span class="ident" id="3990590">i</span><span class="op" id="3990591">,</span>&nbsp;<span class="ident" id="3990593">value</span>&nbsp;<span class="op" id="3990599">:=</span>&nbsp;<span class="keyword" id="3990602">range</span>&nbsp;<span class="ident" id="3990608">values</span>&nbsp;<span class="op" id="3990615">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990619">s</span><span class="op" id="3990620">[</span><span class="ident" id="3990621">i</span><span class="op" id="3990622">]</span><span class="op" id="3990623">.</span><span class="ident" id="3990624">Type</span>&nbsp;<span class="op" id="3990629">=</span>&nbsp;<span class="ident" id="3990631">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990637">s</span><span class="op" id="3990638">[</span><span class="ident" id="3990639">i</span><span class="op" id="3990640">]</span><span class="op" id="3990641">.</span><span class="ident" id="3990642">Value</span>&nbsp;<span class="op" id="3990648">=</span>&nbsp;<span class="ident" id="3990650">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990661">return</span>&nbsp;<span class="builtinfunc" id="3990668">append</span><span class="op" id="3990674">(</span><span class="ident" id="3990675">in</span><span class="op" id="3990677">,</span>&nbsp;<span class="ident" id="3990679">s</span><span class="op" id="3990680">)</span><br>
<span class="lineno">125</span><span class="op" id="3990682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3990685">func</span>&nbsp;<span class="op" id="3990690">(</span><span class="ident" id="3990691">n</span>&nbsp;<span class="ident" id="3990693">Name</span><span class="op" id="3990697">)</span>&nbsp;<span class="ident" id="3990699">ToRDNSequence</span><span class="op" id="3990712">(</span><span class="op" id="3990713">)</span>&nbsp;<span class="op" id="3990715">(</span><span class="ident" id="3990716">ret</span>&nbsp;<span class="ident" id="3990720">RDNSequence</span><span class="op" id="3990731">)</span>&nbsp;<span class="op" id="3990733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990736">ret</span>&nbsp;<span class="op" id="3990740">=</span>&nbsp;<span class="ident" id="3990742">appendRDNs</span><span class="op" id="3990752">(</span><span class="ident" id="3990753">ret</span><span class="op" id="3990756">,</span>&nbsp;<span class="ident" id="3990758">n</span><span class="op" id="3990759">.</span><span class="ident" id="3990760">Country</span><span class="op" id="3990767">,</span>&nbsp;<span class="ident" id="3990769">oidCountry</span><span class="op" id="3990779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990782">ret</span>&nbsp;<span class="op" id="3990786">=</span>&nbsp;<span class="ident" id="3990788">appendRDNs</span><span class="op" id="3990798">(</span><span class="ident" id="3990799">ret</span><span class="op" id="3990802">,</span>&nbsp;<span class="ident" id="3990804">n</span><span class="op" id="3990805">.</span><span class="ident" id="3990806">Organization</span><span class="op" id="3990818">,</span>&nbsp;<span class="ident" id="3990820">oidOrganization</span><span class="op" id="3990835">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990838">ret</span>&nbsp;<span class="op" id="3990842">=</span>&nbsp;<span class="ident" id="3990844">appendRDNs</span><span class="op" id="3990854">(</span><span class="ident" id="3990855">ret</span><span class="op" id="3990858">,</span>&nbsp;<span class="ident" id="3990860">n</span><span class="op" id="3990861">.</span><span class="ident" id="3990862">OrganizationalUnit</span><span class="op" id="3990880">,</span>&nbsp;<span class="ident" id="3990882">oidOrganizationalUnit</span><span class="op" id="3990903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990906">ret</span>&nbsp;<span class="op" id="3990910">=</span>&nbsp;<span class="ident" id="3990912">appendRDNs</span><span class="op" id="3990922">(</span><span class="ident" id="3990923">ret</span><span class="op" id="3990926">,</span>&nbsp;<span class="ident" id="3990928">n</span><span class="op" id="3990929">.</span><span class="ident" id="3990930">Locality</span><span class="op" id="3990938">,</span>&nbsp;<span class="ident" id="3990940">oidLocality</span><span class="op" id="3990951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990954">ret</span>&nbsp;<span class="op" id="3990958">=</span>&nbsp;<span class="ident" id="3990960">appendRDNs</span><span class="op" id="3990970">(</span><span class="ident" id="3990971">ret</span><span class="op" id="3990974">,</span>&nbsp;<span class="ident" id="3990976">n</span><span class="op" id="3990977">.</span><span class="ident" id="3990978">Province</span><span class="op" id="3990986">,</span>&nbsp;<span class="ident" id="3990988">oidProvince</span><span class="op" id="3990999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991002">ret</span>&nbsp;<span class="op" id="3991006">=</span>&nbsp;<span class="ident" id="3991008">appendRDNs</span><span class="op" id="3991018">(</span><span class="ident" id="3991019">ret</span><span class="op" id="3991022">,</span>&nbsp;<span class="ident" id="3991024">n</span><span class="op" id="3991025">.</span><span class="ident" id="3991026">StreetAddress</span><span class="op" id="3991039">,</span>&nbsp;<span class="ident" id="3991041">oidStreetAddress</span><span class="op" id="3991057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991060">ret</span>&nbsp;<span class="op" id="3991064">=</span>&nbsp;<span class="ident" id="3991066">appendRDNs</span><span class="op" id="3991076">(</span><span class="ident" id="3991077">ret</span><span class="op" id="3991080">,</span>&nbsp;<span class="ident" id="3991082">n</span><span class="op" id="3991083">.</span><span class="ident" id="3991084">PostalCode</span><span class="op" id="3991094">,</span>&nbsp;<span class="ident" id="3991096">oidPostalCode</span><span class="op" id="3991109">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991112">if</span>&nbsp;<span class="builtinfunc" id="3991115">len</span><span class="op" id="3991118">(</span><span class="ident" id="3991119">n</span><span class="op" id="3991120">.</span><span class="ident" id="3991121">CommonName</span><span class="op" id="3991131">)</span>&nbsp;<span class="op" id="3991133">&gt;</span>&nbsp;<span class="num" id="3991135">0</span>&nbsp;<span class="op" id="3991137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991141">ret</span>&nbsp;<span class="op" id="3991145">=</span>&nbsp;<span class="ident" id="3991147">appendRDNs</span><span class="op" id="3991157">(</span><span class="ident" id="3991158">ret</span><span class="op" id="3991161">,</span>&nbsp;<span class="op" id="3991163">[</span><span class="op" id="3991164">]</span><span class="builtintype" id="3991165">string</span><span class="op" id="3991171">{</span><span class="ident" id="3991172">n</span><span class="op" id="3991173">.</span><span class="ident" id="3991174">CommonName</span><span class="op" id="3991184">}</span><span class="op" id="3991185">,</span>&nbsp;<span class="ident" id="3991187">oidCommonName</span><span class="op" id="3991200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3991203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991206">if</span>&nbsp;<span class="builtinfunc" id="3991209">len</span><span class="op" id="3991212">(</span><span class="ident" id="3991213">n</span><span class="op" id="3991214">.</span><span class="ident" id="3991215">SerialNumber</span><span class="op" id="3991227">)</span>&nbsp;<span class="op" id="3991229">&gt;</span>&nbsp;<span class="num" id="3991231">0</span>&nbsp;<span class="op" id="3991233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991237">ret</span>&nbsp;<span class="op" id="3991241">=</span>&nbsp;<span class="ident" id="3991243">appendRDNs</span><span class="op" id="3991253">(</span><span class="ident" id="3991254">ret</span><span class="op" id="3991257">,</span>&nbsp;<span class="op" id="3991259">[</span><span class="op" id="3991260">]</span><span class="builtintype" id="3991261">string</span><span class="op" id="3991267">{</span><span class="ident" id="3991268">n</span><span class="op" id="3991269">.</span><span class="ident" id="3991270">SerialNumber</span><span class="op" id="3991282">}</span><span class="op" id="3991283">,</span>&nbsp;<span class="ident" id="3991285">oidSerialNumber</span><span class="op" id="3991300">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3991303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991307">return</span>&nbsp;<span class="ident" id="3991314">ret</span><br>
<span class="lineno"></span><span class="op" id="3991318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="3991321">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3991397">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3991467">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3991481">type</span>&nbsp;<span class="ident" id="3991486">CertificateList</span>&nbsp;<span class="keyword" id="3991502">struct</span>&nbsp;<span class="op" id="3991509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991512">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991531">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991551">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3991570">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991591">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991610">asn1</span><span class="op" id="3991614">.</span><span class="ident" id="3991615">BitString</span><br>
<span class="lineno"></span><span class="op" id="3991625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3991628">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="3991699">func</span>&nbsp;<span class="op" id="3991704">(</span><span class="ident" id="3991705">certList</span>&nbsp;<span class="op" id="3991714">*</span><span class="ident" id="3991715">CertificateList</span><span class="op" id="3991730">)</span>&nbsp;<span class="ident" id="3991732">HasExpired</span><span class="op" id="3991742">(</span><span class="ident" id="3991743">now</span>&nbsp;<span class="ident" id="3991747">time</span><span class="op" id="3991751">.</span><span class="ident" id="3991752">Time</span><span class="op" id="3991756">)</span>&nbsp;<span class="builtintype" id="3991758">bool</span>&nbsp;<span class="op" id="3991763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991766">return</span>&nbsp;<span class="ident" id="3991773">now</span><span class="op" id="3991776">.</span><span class="ident" id="3991777">After</span><span class="op" id="3991782">(</span><span class="ident" id="3991783">certList</span><span class="op" id="3991791">.</span><span class="ident" id="3991792">TBSCertList</span><span class="op" id="3991803">.</span><span class="ident" id="3991804">NextUpdate</span><span class="op" id="3991814">)</span><br>
<span class="lineno"></span><span class="op" id="3991816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3991819">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="3991898">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3991920">type</span>&nbsp;<span class="ident" id="3991925">TBSCertificateList</span>&nbsp;<span class="keyword" id="3991944">struct</span>&nbsp;<span class="op" id="3991951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991954">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991974">asn1</span><span class="op" id="3991978">.</span><span class="ident" id="3991979">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991991">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3992011">int</span>&nbsp;<span class="string" id="3992015">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992044">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992064">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992085">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992105">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992118">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992138">time</span><span class="op" id="3992142">.</span><span class="ident" id="3992143">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992149">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992169">time</span><span class="op" id="3992173">.</span><span class="ident" id="3992174">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3992190">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992209">RevokedCertificates</span>&nbsp;<span class="op" id="3992229">[</span><span class="op" id="3992230">]</span><span class="ident" id="3992231">RevokedCertificate</span>&nbsp;<span class="string" id="3992250">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992269">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992289">[</span><span class="op" id="3992290">]</span><span class="ident" id="3992291">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3992310">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="3992343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3992346">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3992425">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3992447">type</span>&nbsp;<span class="ident" id="3992452">RevokedCertificate</span>&nbsp;<span class="keyword" id="3992471">struct</span>&nbsp;<span class="op" id="3992478">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992481">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3992496">*</span><span class="ident" id="3992497">big</span><span class="op" id="3992500">.</span><span class="ident" id="3992501">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992506">RevocationTime</span>&nbsp;<span class="ident" id="3992521">time</span><span class="op" id="3992525">.</span><span class="ident" id="3992526">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992532">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992547">[</span><span class="op" id="3992548">]</span><span class="ident" id="3992549">Extension</span>&nbsp;<span class="string" id="3992559">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3992577">}</span>
</div>
</body>
</html>
