<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/hmac</h2>
<ul>
<li><a href="/gostd/crypto/hmac/hmac.go.html" class="current">hmac.go</a></li>
<li><a href="/gostd/crypto/hmac/hmac_test.go.html">hmac_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4603159">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4603214">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4603268">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4603319">/*<br>
<span class="lineno"></span>Package&nbsp;hmac&nbsp;implements&nbsp;the&nbsp;Keyed-Hash&nbsp;Message&nbsp;Authentication&nbsp;Code&nbsp;(HMAC)&nbsp;as<br>
<span class="lineno"></span>defined&nbsp;in&nbsp;U.S.&nbsp;Federal&nbsp;Information&nbsp;Processing&nbsp;Standards&nbsp;Publication&nbsp;198.<br>
<span class="lineno"></span>An&nbsp;HMAC&nbsp;is&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;that&nbsp;uses&nbsp;a&nbsp;key&nbsp;to&nbsp;sign&nbsp;a&nbsp;message.<br>
<span class="lineno"></span>The&nbsp;receiver&nbsp;verifies&nbsp;the&nbsp;hash&nbsp;by&nbsp;recomputing&nbsp;it&nbsp;using&nbsp;the&nbsp;same&nbsp;key.<br>
<span class="lineno">10</span><br>
<span class="lineno"></span>Receivers&nbsp;should&nbsp;be&nbsp;careful&nbsp;to&nbsp;use&nbsp;Equal&nbsp;to&nbsp;compare&nbsp;MACs&nbsp;in&nbsp;order&nbsp;to&nbsp;avoid<br>
<span class="lineno"></span>timing&nbsp;side-channels:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;CheckMAC&nbsp;returns&nbsp;true&nbsp;if&nbsp;messageMAC&nbsp;is&nbsp;a&nbsp;valid&nbsp;HMAC&nbsp;tag&nbsp;for&nbsp;message.<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;CheckMAC(message,&nbsp;messageMAC,&nbsp;key&nbsp;[]byte)&nbsp;bool&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mac&nbsp;:=&nbsp;hmac.New(sha256.New,&nbsp;key)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mac.Write(message)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expectedMAC&nbsp;:=&nbsp;mac.Sum(nil)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;hmac.Equal(messageMAC,&nbsp;expectedMAC)<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4603973">package</span>&nbsp;<span class="ident" id="4603981">hmac</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4603987">import</span>&nbsp;<span class="op" id="4603994">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4603997">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4604014">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4604021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4604024">//&nbsp;FIPS&nbsp;198:</span><br>
<span class="lineno">30</span><span class="comment" id="4604037">//&nbsp;http://csrc.nist.gov/publications/fips/fips198/fips-198a.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4604102">//&nbsp;key&nbsp;is&nbsp;zero&nbsp;padded&nbsp;to&nbsp;the&nbsp;block&nbsp;size&nbsp;of&nbsp;the&nbsp;hash&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4604163">//&nbsp;ipad&nbsp;=&nbsp;0x36&nbsp;byte&nbsp;repeated&nbsp;for&nbsp;key&nbsp;length</span><br>
<span class="lineno"></span><span class="comment" id="4604207">//&nbsp;opad&nbsp;=&nbsp;0x5c&nbsp;byte&nbsp;repeated&nbsp;for&nbsp;key&nbsp;length</span><br>
<span class="lineno">35</span><span class="comment" id="4604251">//&nbsp;hmac&nbsp;=&nbsp;H([key&nbsp;^&nbsp;opad]&nbsp;H([key&nbsp;^&nbsp;ipad]&nbsp;text))</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604299">type</span>&nbsp;<span class="ident" id="4604304">hmac</span>&nbsp;<span class="keyword" id="4604309">struct</span>&nbsp;<span class="op" id="4604316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604319">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4604332">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604337">blocksize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4604350">int</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604355">key</span><span class="op" id="4604358">,</span>&nbsp;<span class="ident" id="4604360">tmp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4604368">[</span><span class="op" id="4604369">]</span><span class="builtintype" id="4604370">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604376">outer</span><span class="op" id="4604381">,</span>&nbsp;<span class="ident" id="4604383">inner</span>&nbsp;<span class="ident" id="4604389"><a href="/gostd/crypto/hmac/hmac.go.html#4604014">hash</a></span><span class="op" id="4604393">.</span><span class="ident" id="4604394"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="4604399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604402">func</span>&nbsp;<span class="op" id="4604407">(</span><span class="ident" id="4604408">h</span>&nbsp;<span class="op" id="4604410">*</span><span class="ident" id="4604411"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604415">)</span>&nbsp;<span class="ident" id="4604417">tmpPad</span><span class="op" id="4604423">(</span><span class="ident" id="4604424">xor</span>&nbsp;<span class="builtintype" id="4604428">byte</span><span class="op" id="4604432">)</span>&nbsp;<span class="op" id="4604434">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4604437">for</span>&nbsp;<span class="ident" id="4604441">i</span><span class="op" id="4604442">,</span>&nbsp;<span class="ident" id="4604444">k</span>&nbsp;<span class="op" id="4604446">:=</span>&nbsp;<span class="keyword" id="4604449">range</span>&nbsp;<span class="ident" id="4604455"><a href="/gostd/crypto/hmac/hmac.go.html#4604408">h</a></span><span class="op" id="4604456">.</span><span class="ident" id="4604457"><a href="/gostd/crypto/hmac/hmac.go.html#4604355">key</a></span>&nbsp;<span class="op" id="4604461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604465"><a href="/gostd/crypto/hmac/hmac.go.html#4604408">h</a></span><span class="op" id="4604466">.</span><span class="ident" id="4604467"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span><span class="op" id="4604470">[</span><span class="ident" id="4604471"><a href="/gostd/crypto/hmac/hmac.go.html#4604441">i</a></span><span class="op" id="4604472">]</span>&nbsp;<span class="op" id="4604474">=</span>&nbsp;<span class="ident" id="4604476"><a href="/gostd/crypto/hmac/hmac.go.html#4604424">xor</a></span>&nbsp;<span class="op" id="4604480">^</span>&nbsp;<span class="ident" id="4604482"><a href="/gostd/crypto/hmac/hmac.go.html#4604444">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4604485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4604488">for</span>&nbsp;<span class="ident" id="4604492">i</span>&nbsp;<span class="op" id="4604494">:=</span>&nbsp;<span class="builtinfunc" id="4604497">len</span><span class="op" id="4604500">(</span><span class="ident" id="4604501"><a href="/gostd/crypto/hmac/hmac.go.html#4604408">h</a></span><span class="op" id="4604502">.</span><span class="ident" id="4604503"><a href="/gostd/crypto/hmac/hmac.go.html#4604355">key</a></span><span class="op" id="4604506">)</span><span class="op" id="4604507">;</span>&nbsp;<span class="ident" id="4604509"><a href="/gostd/crypto/hmac/hmac.go.html#4604492">i</a></span>&nbsp;<span class="op" id="4604511">&lt;</span>&nbsp;<span class="ident" id="4604513"><a href="/gostd/crypto/hmac/hmac.go.html#4604408">h</a></span><span class="op" id="4604514">.</span><span class="ident" id="4604515"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span><span class="op" id="4604524">;</span>&nbsp;<span class="ident" id="4604526"><a href="/gostd/crypto/hmac/hmac.go.html#4604492">i</a></span><span class="op" id="4604527">++</span>&nbsp;<span class="op" id="4604530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604534"><a href="/gostd/crypto/hmac/hmac.go.html#4604408">h</a></span><span class="op" id="4604535">.</span><span class="ident" id="4604536"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span><span class="op" id="4604539">[</span><span class="ident" id="4604540"><a href="/gostd/crypto/hmac/hmac.go.html#4604492">i</a></span><span class="op" id="4604541">]</span>&nbsp;<span class="op" id="4604543">=</span>&nbsp;<span class="ident" id="4604545"><a href="/gostd/crypto/hmac/hmac.go.html#4604424">xor</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4604550">}</span><br>
<span class="lineno"></span><span class="op" id="4604552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604555">func</span>&nbsp;<span class="op" id="4604560">(</span><span class="ident" id="4604561">h</span>&nbsp;<span class="op" id="4604563">*</span><span class="ident" id="4604564"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604568">)</span>&nbsp;<span class="ident" id="4604570">Sum</span><span class="op" id="4604573">(</span><span class="ident" id="4604574">in</span>&nbsp;<span class="op" id="4604577">[</span><span class="op" id="4604578">]</span><span class="builtintype" id="4604579">byte</span><span class="op" id="4604583">)</span>&nbsp;<span class="op" id="4604585">[</span><span class="op" id="4604586">]</span><span class="builtintype" id="4604587">byte</span>&nbsp;<span class="op" id="4604592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604595">origLen</span>&nbsp;<span class="op" id="4604603">:=</span>&nbsp;<span class="builtinfunc" id="4604606">len</span><span class="op" id="4604609">(</span><span class="ident" id="4604610"><a href="/gostd/crypto/hmac/hmac.go.html#4604574">in</a></span><span class="op" id="4604612">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604615"><a href="/gostd/crypto/hmac/hmac.go.html#4604574">in</a></span>&nbsp;<span class="op" id="4604618">=</span>&nbsp;<span class="ident" id="4604620"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604621">.</span><span class="ident" id="4604622"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4604627">.</span><span class="ident" id="4604628"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4604631">(</span><span class="ident" id="4604632"><a href="/gostd/crypto/hmac/hmac.go.html#4604574">in</a></span><span class="op" id="4604634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604637"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604638">.</span><span class="ident" id="4604639"><a href="/gostd/crypto/hmac/hmac.go.html#4604417">tmpPad</a></span><span class="op" id="4604645">(</span><span class="num" id="4604646">0x5c</span><span class="op" id="4604650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4604653">copy</span><span class="op" id="4604657">(</span><span class="ident" id="4604658"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604659">.</span><span class="ident" id="4604660"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span><span class="op" id="4604663">[</span><span class="ident" id="4604664"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604665">.</span><span class="ident" id="4604666"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span><span class="op" id="4604675">:</span><span class="op" id="4604676">]</span><span class="op" id="4604677">,</span>&nbsp;<span class="ident" id="4604679"><a href="/gostd/crypto/hmac/hmac.go.html#4604574">in</a></span><span class="op" id="4604681">[</span><span class="ident" id="4604682"><a href="/gostd/crypto/hmac/hmac.go.html#4604595">origLen</a></span><span class="op" id="4604689">:</span><span class="op" id="4604690">]</span><span class="op" id="4604691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604694"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604695">.</span><span class="ident" id="4604696"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span><span class="op" id="4604701">.</span><span class="ident" id="4604702"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4604707">(</span><span class="op" id="4604708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604711"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604712">.</span><span class="ident" id="4604713"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span><span class="op" id="4604718">.</span><span class="ident" id="4604719"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4604724">(</span><span class="ident" id="4604725"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604726">.</span><span class="ident" id="4604727"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span><span class="op" id="4604730">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4604733">return</span>&nbsp;<span class="ident" id="4604740"><a href="/gostd/crypto/hmac/hmac.go.html#4604561">h</a></span><span class="op" id="4604741">.</span><span class="ident" id="4604742"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span><span class="op" id="4604747">.</span><span class="ident" id="4604748"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4604751">(</span><span class="ident" id="4604752"><a href="/gostd/crypto/hmac/hmac.go.html#4604574">in</a></span><span class="op" id="4604754">[</span><span class="op" id="4604755">:</span><span class="ident" id="4604756"><a href="/gostd/crypto/hmac/hmac.go.html#4604595">origLen</a></span><span class="op" id="4604763">]</span><span class="op" id="4604764">)</span><br>
<span class="lineno"></span><span class="op" id="4604766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604769">func</span>&nbsp;<span class="op" id="4604774">(</span><span class="ident" id="4604775">h</span>&nbsp;<span class="op" id="4604777">*</span><span class="ident" id="4604778"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604782">)</span>&nbsp;<span class="ident" id="4604784">Write</span><span class="op" id="4604789">(</span><span class="ident" id="4604790">p</span>&nbsp;<span class="op" id="4604792">[</span><span class="op" id="4604793">]</span><span class="builtintype" id="4604794">byte</span><span class="op" id="4604798">)</span>&nbsp;<span class="op" id="4604800">(</span><span class="ident" id="4604801">n</span>&nbsp;<span class="builtintype" id="4604803">int</span><span class="op" id="4604806">,</span>&nbsp;<span class="ident" id="4604808">err</span>&nbsp;<span class="builtintype" id="4604812">error</span><span class="op" id="4604817">)</span>&nbsp;<span class="op" id="4604819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4604822">return</span>&nbsp;<span class="ident" id="4604829"><a href="/gostd/crypto/hmac/hmac.go.html#4604775">h</a></span><span class="op" id="4604830">.</span><span class="ident" id="4604831"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4604836">.</span><span class="ident" id="4604837"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4604842">(</span><span class="ident" id="4604843"><a href="/gostd/crypto/hmac/hmac.go.html#4604790">p</a></span><span class="op" id="4604844">)</span><br>
<span class="lineno">65</span><span class="op" id="4604846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604849">func</span>&nbsp;<span class="op" id="4604854">(</span><span class="ident" id="4604855">h</span>&nbsp;<span class="op" id="4604857">*</span><span class="ident" id="4604858"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604862">)</span>&nbsp;<span class="ident" id="4604864">Size</span><span class="op" id="4604868">(</span><span class="op" id="4604869">)</span>&nbsp;<span class="builtintype" id="4604871">int</span>&nbsp;<span class="op" id="4604875">{</span>&nbsp;<span class="keyword" id="4604877">return</span>&nbsp;<span class="ident" id="4604884"><a href="/gostd/crypto/hmac/hmac.go.html#4604855">h</a></span><span class="op" id="4604885">.</span><span class="ident" id="4604886"><a href="/gostd/crypto/hmac/hmac.go.html#4604319">size</a></span>&nbsp;<span class="op" id="4604891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4604894">func</span>&nbsp;<span class="op" id="4604899">(</span><span class="ident" id="4604900">h</span>&nbsp;<span class="op" id="4604902">*</span><span class="ident" id="4604903"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604907">)</span>&nbsp;<span class="ident" id="4604909">BlockSize</span><span class="op" id="4604918">(</span><span class="op" id="4604919">)</span>&nbsp;<span class="builtintype" id="4604921">int</span>&nbsp;<span class="op" id="4604925">{</span>&nbsp;<span class="keyword" id="4604927">return</span>&nbsp;<span class="ident" id="4604934"><a href="/gostd/crypto/hmac/hmac.go.html#4604900">h</a></span><span class="op" id="4604935">.</span><span class="ident" id="4604936"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span>&nbsp;<span class="op" id="4604946">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4604949">func</span>&nbsp;<span class="op" id="4604954">(</span><span class="ident" id="4604955">h</span>&nbsp;<span class="op" id="4604957">*</span><span class="ident" id="4604958"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4604962">)</span>&nbsp;<span class="ident" id="4604964">Reset</span><span class="op" id="4604969">(</span><span class="op" id="4604970">)</span>&nbsp;<span class="op" id="4604972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604975"><a href="/gostd/crypto/hmac/hmac.go.html#4604955">h</a></span><span class="op" id="4604976">.</span><span class="ident" id="4604977"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4604982">.</span><span class="ident" id="4604983"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4604988">(</span><span class="op" id="4604989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4604992"><a href="/gostd/crypto/hmac/hmac.go.html#4604955">h</a></span><span class="op" id="4604993">.</span><span class="ident" id="4604994"><a href="/gostd/crypto/hmac/hmac.go.html#4604417">tmpPad</a></span><span class="op" id="4605000">(</span><span class="num" id="4605001">0x36</span><span class="op" id="4605005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605008"><a href="/gostd/crypto/hmac/hmac.go.html#4604955">h</a></span><span class="op" id="4605009">.</span><span class="ident" id="4605010"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4605015">.</span><span class="ident" id="4605016"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4605021">(</span><span class="ident" id="4605022"><a href="/gostd/crypto/hmac/hmac.go.html#4604955">h</a></span><span class="op" id="4605023">.</span><span class="ident" id="4605024"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span><span class="op" id="4605027">[</span><span class="op" id="4605028">:</span><span class="ident" id="4605029"><a href="/gostd/crypto/hmac/hmac.go.html#4604955">h</a></span><span class="op" id="4605030">.</span><span class="ident" id="4605031"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span><span class="op" id="4605040">]</span><span class="op" id="4605041">)</span><br>
<span class="lineno">75</span><span class="op" id="4605043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4605046">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;HMAC&nbsp;hash&nbsp;using&nbsp;the&nbsp;given&nbsp;hash.Hash&nbsp;type&nbsp;and&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4605117">func</span>&nbsp;<span class="ident" id="4605122">New</span><span class="op" id="4605125">(</span><span class="ident" id="4605126">h</span>&nbsp;<span class="keyword" id="4605128">func</span><span class="op" id="4605132">(</span><span class="op" id="4605133">)</span>&nbsp;<span class="ident" id="4605135"><a href="/gostd/crypto/hmac/hmac.go.html#4604014">hash</a></span><span class="op" id="4605139">.</span><span class="ident" id="4605140"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4605144">,</span>&nbsp;<span class="ident" id="4605146">key</span>&nbsp;<span class="op" id="4605150">[</span><span class="op" id="4605151">]</span><span class="builtintype" id="4605152">byte</span><span class="op" id="4605156">)</span>&nbsp;<span class="ident" id="4605158"><a href="/gostd/crypto/hmac/hmac.go.html#4604014">hash</a></span><span class="op" id="4605162">.</span><span class="ident" id="4605163"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span>&nbsp;<span class="op" id="4605168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605171">hm</span>&nbsp;<span class="op" id="4605174">:=</span>&nbsp;<span class="builtinfunc" id="4605177">new</span><span class="op" id="4605180">(</span><span class="ident" id="4605181"><a href="/gostd/crypto/hmac/hmac.go.html#4604304">hmac</a></span><span class="op" id="4605185">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605188"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605190">.</span><span class="ident" id="4605191"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span>&nbsp;<span class="op" id="4605197">=</span>&nbsp;<span class="ident" id="4605199"><a href="/gostd/crypto/hmac/hmac.go.html#4605126">h</a></span><span class="op" id="4605200">(</span><span class="op" id="4605201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605204"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605206">.</span><span class="ident" id="4605207"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span>&nbsp;<span class="op" id="4605213">=</span>&nbsp;<span class="ident" id="4605215"><a href="/gostd/crypto/hmac/hmac.go.html#4605126">h</a></span><span class="op" id="4605216">(</span><span class="op" id="4605217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605220"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605222">.</span><span class="ident" id="4605223"><a href="/gostd/crypto/hmac/hmac.go.html#4604319">size</a></span>&nbsp;<span class="op" id="4605228">=</span>&nbsp;<span class="ident" id="4605230"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605232">.</span><span class="ident" id="4605233"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4605238">.</span><span class="ident" id="4605239"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4605243">(</span><span class="op" id="4605244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605247"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605249">.</span><span class="ident" id="4605250"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span>&nbsp;<span class="op" id="4605260">=</span>&nbsp;<span class="ident" id="4605262"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605264">.</span><span class="ident" id="4605265"><a href="/gostd/crypto/hmac/hmac.go.html#4604383">inner</a></span><span class="op" id="4605270">.</span><span class="ident" id="4605271"><a href="/gostd/hash/hash.go.html#3014732">BlockSize</a></span><span class="op" id="4605280">(</span><span class="op" id="4605281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605284"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605286">.</span><span class="ident" id="4605287"><a href="/gostd/crypto/hmac/hmac.go.html#4604360">tmp</a></span>&nbsp;<span class="op" id="4605291">=</span>&nbsp;<span class="builtinfunc" id="4605293">make</span><span class="op" id="4605297">(</span><span class="op" id="4605298">[</span><span class="op" id="4605299">]</span><span class="builtintype" id="4605300">byte</span><span class="op" id="4605304">,</span>&nbsp;<span class="ident" id="4605306"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605308">.</span><span class="ident" id="4605309"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span><span class="op" id="4605318">+</span><span class="ident" id="4605319"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605321">.</span><span class="ident" id="4605322"><a href="/gostd/crypto/hmac/hmac.go.html#4604319">size</a></span><span class="op" id="4605326">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4605329">if</span>&nbsp;<span class="builtinfunc" id="4605332">len</span><span class="op" id="4605335">(</span><span class="ident" id="4605336"><a href="/gostd/crypto/hmac/hmac.go.html#4605146">key</a></span><span class="op" id="4605339">)</span>&nbsp;<span class="op" id="4605341">&gt;</span>&nbsp;<span class="ident" id="4605343"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605345">.</span><span class="ident" id="4605346"><a href="/gostd/crypto/hmac/hmac.go.html#4604337">blocksize</a></span>&nbsp;<span class="op" id="4605356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4605360">//&nbsp;If&nbsp;key&nbsp;is&nbsp;too&nbsp;big,&nbsp;hash&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605393"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605395">.</span><span class="ident" id="4605396"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span><span class="op" id="4605401">.</span><span class="ident" id="4605402"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4605407">(</span><span class="ident" id="4605408"><a href="/gostd/crypto/hmac/hmac.go.html#4605146">key</a></span><span class="op" id="4605411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605415"><a href="/gostd/crypto/hmac/hmac.go.html#4605146">key</a></span>&nbsp;<span class="op" id="4605419">=</span>&nbsp;<span class="ident" id="4605421"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605423">.</span><span class="ident" id="4605424"><a href="/gostd/crypto/hmac/hmac.go.html#4604376">outer</a></span><span class="op" id="4605429">.</span><span class="ident" id="4605430"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4605433">(</span><span class="builtintype" id="4605434">nil</span><span class="op" id="4605437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4605440">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605443"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605445">.</span><span class="ident" id="4605446"><a href="/gostd/crypto/hmac/hmac.go.html#4604355">key</a></span>&nbsp;<span class="op" id="4605450">=</span>&nbsp;<span class="builtinfunc" id="4605452">make</span><span class="op" id="4605456">(</span><span class="op" id="4605457">[</span><span class="op" id="4605458">]</span><span class="builtintype" id="4605459">byte</span><span class="op" id="4605463">,</span>&nbsp;<span class="builtinfunc" id="4605465">len</span><span class="op" id="4605468">(</span><span class="ident" id="4605469"><a href="/gostd/crypto/hmac/hmac.go.html#4605146">key</a></span><span class="op" id="4605472">)</span><span class="op" id="4605473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4605476">copy</span><span class="op" id="4605480">(</span><span class="ident" id="4605481"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605483">.</span><span class="ident" id="4605484"><a href="/gostd/crypto/hmac/hmac.go.html#4604355">key</a></span><span class="op" id="4605487">,</span>&nbsp;<span class="ident" id="4605489"><a href="/gostd/crypto/hmac/hmac.go.html#4605146">key</a></span><span class="op" id="4605492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4605495"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><span class="op" id="4605497">.</span><span class="ident" id="4605498"><a href="/gostd/crypto/hmac/hmac.go.html#4604964">Reset</a></span><span class="op" id="4605503">(</span><span class="op" id="4605504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4605507">return</span>&nbsp;<span class="ident" id="4605514"><a href="/gostd/crypto/hmac/hmac.go.html#4605171">hm</a></span><br>
<span class="lineno"></span><span class="op" id="4605517">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="4605520">//&nbsp;Equal&nbsp;compares&nbsp;two&nbsp;MACs&nbsp;for&nbsp;equality&nbsp;without&nbsp;leaking&nbsp;timing&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4605596">func</span>&nbsp;<span class="ident" id="4605601">Equal</span><span class="op" id="4605606">(</span><span class="ident" id="4605607">mac1</span><span class="op" id="4605611">,</span>&nbsp;<span class="ident" id="4605613">mac2</span>&nbsp;<span class="op" id="4605618">[</span><span class="op" id="4605619">]</span><span class="builtintype" id="4605620">byte</span><span class="op" id="4605624">)</span>&nbsp;<span class="builtintype" id="4605626">bool</span>&nbsp;<span class="op" id="4605631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4605634">//&nbsp;We&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;constant&nbsp;time&nbsp;if&nbsp;the&nbsp;lengths&nbsp;of&nbsp;the&nbsp;MACs&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4605703">//&nbsp;different&nbsp;as&nbsp;that&nbsp;suggests&nbsp;that&nbsp;a&nbsp;completely&nbsp;different&nbsp;hash&nbsp;function</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4605776">//&nbsp;was&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4605790">return</span>&nbsp;<span class="builtinfunc" id="4605797">len</span><span class="op" id="4605800">(</span><span class="ident" id="4605801"><a href="/gostd/crypto/hmac/hmac.go.html#4605607">mac1</a></span><span class="op" id="4605805">)</span>&nbsp;<span class="op" id="4605807">==</span>&nbsp;<span class="builtinfunc" id="4605810">len</span><span class="op" id="4605813">(</span><span class="ident" id="4605814"><a href="/gostd/crypto/hmac/hmac.go.html#4605613">mac2</a></span><span class="op" id="4605818">)</span>&nbsp;<span class="op" id="4605820">&amp;&amp;</span>&nbsp;<span class="ident" id="4605823"><a href="/gostd/crypto/hmac/hmac.go.html#4603997">subtle</a></span><span class="op" id="4605829">.</span><span class="ident" id="4605830"><a href="/gostd/crypto/subtle/constant_time.go.html#4428560">ConstantTimeCompare</a></span><span class="op" id="4605849">(</span><span class="ident" id="4605850"><a href="/gostd/crypto/hmac/hmac.go.html#4605607">mac1</a></span><span class="op" id="4605854">,</span>&nbsp;<span class="ident" id="4605856"><a href="/gostd/crypto/hmac/hmac.go.html#4605613">mac2</a></span><span class="op" id="4605860">)</span>&nbsp;<span class="op" id="4605862">==</span>&nbsp;<span class="num" id="4605865">1</span><br>
<span class="lineno"></span><span class="op" id="4605867">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
