<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2345205">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2345260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2345314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2345365">package</span>&nbsp;<span class="ident" id="2345373">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2345379">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2345435">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2345489">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2345546">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2345601">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2345631">//</span><br>
<span class="lineno"></span><span class="comment" id="2345634">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2345690">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2345759">//</span><br>
<span class="lineno"></span><span class="comment" id="2345762">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2345821">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2345877">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2345934">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2345951">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2346007">//</span><br>
<span class="lineno">25</span><span class="comment" id="2346010">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2346045">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2346105">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2346161">//</span><br>
<span class="lineno"></span><span class="comment" id="2346164">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2346175">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2346217">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2346277">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2346322">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2346371">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2346392">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2346445">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2346502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2346571">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2346625">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2346695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2346760">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2346792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2346860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2346911">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2346972">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2347016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2347043">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2347091">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2347113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2347166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2347228">//</span><br>
<span class="lineno"></span><span class="comment" id="2347231">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2347295">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2347365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2347420">//</span><br>
<span class="lineno"></span><span class="comment" id="2347423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2347490">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2347520">//</span><br>
<span class="lineno"></span><span class="comment" id="2347523">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2347549">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2347621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2347646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2347709">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2347752">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2347805">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2347816">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2347877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2347936">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2347950">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2347989">//</span><br>
<span class="lineno"></span><span class="comment" id="2347992">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2348044">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2348090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2348106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2348155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2348225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2348279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2348323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2348389">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2348454">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2348497">//</span><br>
<span class="lineno"></span><span class="comment" id="2348500">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2348522">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2348575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2348613">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2348660">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2348706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2348747">//</span><br>
<span class="lineno"></span><span class="comment" id="2348750">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2348754">var</span>&nbsp;<span class="ident" id="2348758">_lgamA</span>&nbsp;<span class="op" id="2348765">=</span>&nbsp;<span class="op" id="2348767">[</span><span class="op" id="2348768">...</span><span class="op" id="2348771">]</span><span class="builtintype" id="2348772">float64</span><span class="op" id="2348779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2348782">7.72156649015328655494e-02</span><span class="op" id="2348808">,</span>&nbsp;<span class="comment" id="2348810">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2348833">3.22467033424113591611e-01</span><span class="op" id="2348859">,</span>&nbsp;<span class="comment" id="2348861">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2348884">6.73523010531292681824e-02</span><span class="op" id="2348910">,</span>&nbsp;<span class="comment" id="2348912">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2348935">2.05808084325167332806e-02</span><span class="op" id="2348961">,</span>&nbsp;<span class="comment" id="2348963">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2348986">7.38555086081402883957e-03</span><span class="op" id="2349012">,</span>&nbsp;<span class="comment" id="2349014">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349037">2.89051383673415629091e-03</span><span class="op" id="2349063">,</span>&nbsp;<span class="comment" id="2349065">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349088">1.19270763183362067845e-03</span><span class="op" id="2349114">,</span>&nbsp;<span class="comment" id="2349116">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349139">5.10069792153511336608e-04</span><span class="op" id="2349165">,</span>&nbsp;<span class="comment" id="2349167">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349190">2.20862790713908385557e-04</span><span class="op" id="2349216">,</span>&nbsp;<span class="comment" id="2349218">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349241">1.08011567247583939954e-04</span><span class="op" id="2349267">,</span>&nbsp;<span class="comment" id="2349269">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349292">2.52144565451257326939e-05</span><span class="op" id="2349318">,</span>&nbsp;<span class="comment" id="2349320">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349343">4.48640949618915160150e-05</span><span class="op" id="2349369">,</span>&nbsp;<span class="comment" id="2349371">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2349393">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2349395">var</span>&nbsp;<span class="ident" id="2349399">_lgamR</span>&nbsp;<span class="op" id="2349406">=</span>&nbsp;<span class="op" id="2349408">[</span><span class="op" id="2349409">...</span><span class="op" id="2349412">]</span><span class="builtintype" id="2349413">float64</span><span class="op" id="2349420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349423">1.0</span><span class="op" id="2349426">,</span>&nbsp;<span class="comment" id="2349428">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349444">1.39200533467621045958e+00</span><span class="op" id="2349470">,</span>&nbsp;<span class="comment" id="2349472">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349495">7.21935547567138069525e-01</span><span class="op" id="2349521">,</span>&nbsp;<span class="comment" id="2349523">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349546">1.71933865632803078993e-01</span><span class="op" id="2349572">,</span>&nbsp;<span class="comment" id="2349574">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349597">1.86459191715652901344e-02</span><span class="op" id="2349623">,</span>&nbsp;<span class="comment" id="2349625">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349648">7.77942496381893596434e-04</span><span class="op" id="2349674">,</span>&nbsp;<span class="comment" id="2349676">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349699">7.32668430744625636189e-06</span><span class="op" id="2349725">,</span>&nbsp;<span class="comment" id="2349727">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2349749">}</span><br>
<span class="lineno"></span><span class="keyword" id="2349751">var</span>&nbsp;<span class="ident" id="2349755">_lgamS</span>&nbsp;<span class="op" id="2349762">=</span>&nbsp;<span class="op" id="2349764">[</span><span class="op" id="2349765">...</span><span class="op" id="2349768">]</span><span class="builtintype" id="2349769">float64</span><span class="op" id="2349776">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349779">-</span><span class="num" id="2349780">7.72156649015328655494e-02</span><span class="op" id="2349806">,</span>&nbsp;<span class="comment" id="2349808">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349831">2.14982415960608852501e-01</span><span class="op" id="2349857">,</span>&nbsp;&nbsp;<span class="comment" id="2349860">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349883">3.25778796408930981787e-01</span><span class="op" id="2349909">,</span>&nbsp;&nbsp;<span class="comment" id="2349912">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349935">1.46350472652464452805e-01</span><span class="op" id="2349961">,</span>&nbsp;&nbsp;<span class="comment" id="2349964">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2349987">2.66422703033638609560e-02</span><span class="op" id="2350013">,</span>&nbsp;&nbsp;<span class="comment" id="2350016">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350039">1.84028451407337715652e-03</span><span class="op" id="2350065">,</span>&nbsp;&nbsp;<span class="comment" id="2350068">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350091">3.19475326584100867617e-05</span><span class="op" id="2350117">,</span>&nbsp;&nbsp;<span class="comment" id="2350120">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2350142">}</span><br>
<span class="lineno"></span><span class="keyword" id="2350144">var</span>&nbsp;<span class="ident" id="2350148">_lgamT</span>&nbsp;<span class="op" id="2350155">=</span>&nbsp;<span class="op" id="2350157">[</span><span class="op" id="2350158">...</span><span class="op" id="2350161">]</span><span class="builtintype" id="2350162">float64</span><span class="op" id="2350169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350172">4.83836122723810047042e-01</span><span class="op" id="2350198">,</span>&nbsp;&nbsp;<span class="comment" id="2350201">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350224">-</span><span class="num" id="2350225">1.47587722994593911752e-01</span><span class="op" id="2350251">,</span>&nbsp;<span class="comment" id="2350253">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350276">6.46249402391333854778e-02</span><span class="op" id="2350302">,</span>&nbsp;&nbsp;<span class="comment" id="2350305">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350328">-</span><span class="num" id="2350329">3.27885410759859649565e-02</span><span class="op" id="2350355">,</span>&nbsp;<span class="comment" id="2350357">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350380">1.79706750811820387126e-02</span><span class="op" id="2350406">,</span>&nbsp;&nbsp;<span class="comment" id="2350409">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350432">-</span><span class="num" id="2350433">1.03142241298341437450e-02</span><span class="op" id="2350459">,</span>&nbsp;<span class="comment" id="2350461">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350484">6.10053870246291332635e-03</span><span class="op" id="2350510">,</span>&nbsp;&nbsp;<span class="comment" id="2350513">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350536">-</span><span class="num" id="2350537">3.68452016781138256760e-03</span><span class="op" id="2350563">,</span>&nbsp;<span class="comment" id="2350565">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350588">2.25964780900612472250e-03</span><span class="op" id="2350614">,</span>&nbsp;&nbsp;<span class="comment" id="2350617">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350640">-</span><span class="num" id="2350641">1.40346469989232843813e-03</span><span class="op" id="2350667">,</span>&nbsp;<span class="comment" id="2350669">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350692">8.81081882437654011382e-04</span><span class="op" id="2350718">,</span>&nbsp;&nbsp;<span class="comment" id="2350721">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350744">-</span><span class="num" id="2350745">5.38595305356740546715e-04</span><span class="op" id="2350771">,</span>&nbsp;<span class="comment" id="2350773">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350796">3.15632070903625950361e-04</span><span class="op" id="2350822">,</span>&nbsp;&nbsp;<span class="comment" id="2350825">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350848">-</span><span class="num" id="2350849">3.12754168375120860518e-04</span><span class="op" id="2350875">,</span>&nbsp;<span class="comment" id="2350877">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2350900">3.35529192635519073543e-04</span><span class="op" id="2350926">,</span>&nbsp;&nbsp;<span class="comment" id="2350929">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2350951">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2350953">var</span>&nbsp;<span class="ident" id="2350957">_lgamU</span>&nbsp;<span class="op" id="2350964">=</span>&nbsp;<span class="op" id="2350966">[</span><span class="op" id="2350967">...</span><span class="op" id="2350970">]</span><span class="builtintype" id="2350971">float64</span><span class="op" id="2350978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350981">-</span><span class="num" id="2350982">7.72156649015328655494e-02</span><span class="op" id="2351008">,</span>&nbsp;<span class="comment" id="2351010">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351033">6.32827064025093366517e-01</span><span class="op" id="2351059">,</span>&nbsp;&nbsp;<span class="comment" id="2351062">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351085">1.45492250137234768737e+00</span><span class="op" id="2351111">,</span>&nbsp;&nbsp;<span class="comment" id="2351114">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351137">9.77717527963372745603e-01</span><span class="op" id="2351163">,</span>&nbsp;&nbsp;<span class="comment" id="2351166">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351189">2.28963728064692451092e-01</span><span class="op" id="2351215">,</span>&nbsp;&nbsp;<span class="comment" id="2351218">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351241">1.33810918536787660377e-02</span><span class="op" id="2351267">,</span>&nbsp;&nbsp;<span class="comment" id="2351270">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2351292">}</span><br>
<span class="lineno"></span><span class="keyword" id="2351294">var</span>&nbsp;<span class="ident" id="2351298">_lgamV</span>&nbsp;<span class="op" id="2351305">=</span>&nbsp;<span class="op" id="2351307">[</span><span class="op" id="2351308">...</span><span class="op" id="2351311">]</span><span class="builtintype" id="2351312">float64</span><span class="op" id="2351319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351322">1.0</span><span class="op" id="2351325">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351328">2.45597793713041134822e+00</span><span class="op" id="2351354">,</span>&nbsp;<span class="comment" id="2351356">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351379">2.12848976379893395361e+00</span><span class="op" id="2351405">,</span>&nbsp;<span class="comment" id="2351407">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351430">7.69285150456672783825e-01</span><span class="op" id="2351456">,</span>&nbsp;<span class="comment" id="2351458">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351481">1.04222645593369134254e-01</span><span class="op" id="2351507">,</span>&nbsp;<span class="comment" id="2351509">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351532">3.21709242282423911810e-03</span><span class="op" id="2351558">,</span>&nbsp;<span class="comment" id="2351560">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2351582">}</span><br>
<span class="lineno"></span><span class="keyword" id="2351584">var</span>&nbsp;<span class="ident" id="2351588">_lgamW</span>&nbsp;<span class="op" id="2351595">=</span>&nbsp;<span class="op" id="2351597">[</span><span class="op" id="2351598">...</span><span class="op" id="2351601">]</span><span class="builtintype" id="2351602">float64</span><span class="op" id="2351609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351612">4.18938533204672725052e-01</span><span class="op" id="2351638">,</span>&nbsp;&nbsp;<span class="comment" id="2351641">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351664">8.33333333333329678849e-02</span><span class="op" id="2351690">,</span>&nbsp;&nbsp;<span class="comment" id="2351693">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351716">-</span><span class="num" id="2351717">2.77777777728775536470e-03</span><span class="op" id="2351743">,</span>&nbsp;<span class="comment" id="2351745">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351768">7.93650558643019558500e-04</span><span class="op" id="2351794">,</span>&nbsp;&nbsp;<span class="comment" id="2351797">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351820">-</span><span class="num" id="2351821">5.95187557450339963135e-04</span><span class="op" id="2351847">,</span>&nbsp;<span class="comment" id="2351849">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2351872">8.36339918996282139126e-04</span><span class="op" id="2351898">,</span>&nbsp;&nbsp;<span class="comment" id="2351901">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351924">-</span><span class="num" id="2351925">1.63092934096575273989e-03</span><span class="op" id="2351951">,</span>&nbsp;<span class="comment" id="2351953">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2351975">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2351978">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2352051">//</span><br>
<span class="lineno"></span><span class="comment" id="2352054">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2352076">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2352099">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2352119">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2352146">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2352169">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2352190">func</span>&nbsp;<span class="ident" id="2352195">Lgamma</span><span class="op" id="2352201">(</span><span class="ident" id="2352202">x</span>&nbsp;<span class="builtintype" id="2352204">float64</span><span class="op" id="2352211">)</span>&nbsp;<span class="op" id="2352213">(</span><span class="ident" id="2352214">lgamma</span>&nbsp;<span class="builtintype" id="2352221">float64</span><span class="op" id="2352228">,</span>&nbsp;<span class="ident" id="2352230">sign</span>&nbsp;<span class="builtintype" id="2352235">int</span><span class="op" id="2352238">)</span>&nbsp;<span class="op" id="2352240">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352243">const</span>&nbsp;<span class="op" id="2352249">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352253">Ymin</span>&nbsp;&nbsp;<span class="op" id="2352259">=</span>&nbsp;<span class="num" id="2352261">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352284">Two52</span>&nbsp;<span class="op" id="2352290">=</span>&nbsp;<span class="num" id="2352292">1</span>&nbsp;<span class="op" id="2352294">&lt;&lt;</span>&nbsp;<span class="num" id="2352297">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2352320">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352356">Two53</span>&nbsp;<span class="op" id="2352362">=</span>&nbsp;<span class="num" id="2352364">1</span>&nbsp;<span class="op" id="2352366">&lt;&lt;</span>&nbsp;<span class="num" id="2352369">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2352392">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352428">Two58</span>&nbsp;<span class="op" id="2352434">=</span>&nbsp;<span class="num" id="2352436">1</span>&nbsp;<span class="op" id="2352438">&lt;&lt;</span>&nbsp;<span class="num" id="2352441">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2352464">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352500">Tiny</span>&nbsp;&nbsp;<span class="op" id="2352506">=</span>&nbsp;<span class="num" id="2352508">1.0</span>&nbsp;<span class="op" id="2352512">/</span>&nbsp;<span class="op" id="2352514">(</span><span class="num" id="2352515">1</span>&nbsp;<span class="op" id="2352517">&lt;&lt;</span>&nbsp;<span class="num" id="2352520">70</span><span class="op" id="2352522">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2352536">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352573">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352579">=</span>&nbsp;<span class="num" id="2352581">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2352609">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352633">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352639">=</span>&nbsp;<span class="op" id="2352641">-</span><span class="num" id="2352642">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2352669">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2352693">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352717">Tt</span>&nbsp;<span class="op" id="2352720">=</span>&nbsp;<span class="op" id="2352722">-</span><span class="num" id="2352723">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2352750">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2352773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2352776">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352794">sign</span>&nbsp;<span class="op" id="2352799">=</span>&nbsp;<span class="num" id="2352801">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352804">switch</span>&nbsp;<span class="op" id="2352811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352814">case</span>&nbsp;<span class="ident" id="2352819">IsNaN</span><span class="op" id="2352824">(</span><span class="ident" id="2352825">x</span><span class="op" id="2352826">)</span><span class="op" id="2352827">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352831">lgamma</span>&nbsp;<span class="op" id="2352838">=</span>&nbsp;<span class="ident" id="2352840">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352852">case</span>&nbsp;<span class="ident" id="2352857">IsInf</span><span class="op" id="2352862">(</span><span class="ident" id="2352863">x</span><span class="op" id="2352864">,</span>&nbsp;<span class="num" id="2352866">0</span><span class="op" id="2352867">)</span><span class="op" id="2352868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352872">lgamma</span>&nbsp;<span class="op" id="2352879">=</span>&nbsp;<span class="ident" id="2352881">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352885">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352893">case</span>&nbsp;<span class="ident" id="2352898">x</span>&nbsp;<span class="op" id="2352900">==</span>&nbsp;<span class="num" id="2352903">0</span><span class="op" id="2352904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352908">lgamma</span>&nbsp;<span class="op" id="2352915">=</span>&nbsp;<span class="ident" id="2352917">Inf</span><span class="op" id="2352920">(</span><span class="num" id="2352921">1</span><span class="op" id="2352922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352926">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2352934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352938">neg</span>&nbsp;<span class="op" id="2352942">:=</span>&nbsp;<span class="builtintype" id="2352945">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352952">if</span>&nbsp;<span class="ident" id="2352955">x</span>&nbsp;<span class="op" id="2352957">&lt;</span>&nbsp;<span class="num" id="2352959">0</span>&nbsp;<span class="op" id="2352961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352965">x</span>&nbsp;<span class="op" id="2352967">=</span>&nbsp;<span class="op" id="2352969">-</span><span class="ident" id="2352970">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2352974">neg</span>&nbsp;<span class="op" id="2352978">=</span>&nbsp;<span class="builtintype" id="2352980">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2352986">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2352990">if</span>&nbsp;<span class="ident" id="2352993">x</span>&nbsp;<span class="op" id="2352995">&lt;</span>&nbsp;<span class="ident" id="2352997">Tiny</span>&nbsp;<span class="op" id="2353002">{</span>&nbsp;<span class="comment" id="2353004">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353043">if</span>&nbsp;<span class="ident" id="2353046">neg</span>&nbsp;<span class="op" id="2353050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353055">sign</span>&nbsp;<span class="op" id="2353060">=</span>&nbsp;<span class="op" id="2353062">-</span><span class="num" id="2353063">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353067">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353071">lgamma</span>&nbsp;<span class="op" id="2353078">=</span>&nbsp;<span class="op" id="2353080">-</span><span class="ident" id="2353081">Log</span><span class="op" id="2353084">(</span><span class="ident" id="2353085">x</span><span class="op" id="2353086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353090">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353101">var</span>&nbsp;<span class="ident" id="2353105">nadj</span>&nbsp;<span class="builtintype" id="2353110">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353119">if</span>&nbsp;<span class="ident" id="2353122">neg</span>&nbsp;<span class="op" id="2353126">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353130">if</span>&nbsp;<span class="ident" id="2353133">x</span>&nbsp;<span class="op" id="2353135">&gt;=</span>&nbsp;<span class="ident" id="2353138">Two52</span>&nbsp;<span class="op" id="2353144">{</span>&nbsp;<span class="comment" id="2353146">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353183">lgamma</span>&nbsp;<span class="op" id="2353190">=</span>&nbsp;<span class="ident" id="2353192">Inf</span><span class="op" id="2353195">(</span><span class="num" id="2353196">1</span><span class="op" id="2353197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353202">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353215">t</span>&nbsp;<span class="op" id="2353217">:=</span>&nbsp;<span class="ident" id="2353220">sinPi</span><span class="op" id="2353225">(</span><span class="ident" id="2353226">x</span><span class="op" id="2353227">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353231">if</span>&nbsp;<span class="ident" id="2353234">t</span>&nbsp;<span class="op" id="2353236">==</span>&nbsp;<span class="num" id="2353239">0</span>&nbsp;<span class="op" id="2353241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353246">lgamma</span>&nbsp;<span class="op" id="2353253">=</span>&nbsp;<span class="ident" id="2353255">Inf</span><span class="op" id="2353258">(</span><span class="num" id="2353259">1</span><span class="op" id="2353260">)</span>&nbsp;<span class="comment" id="2353262">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353277">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353290">nadj</span>&nbsp;<span class="op" id="2353295">=</span>&nbsp;<span class="ident" id="2353297">Log</span><span class="op" id="2353300">(</span><span class="ident" id="2353301">Pi</span>&nbsp;<span class="op" id="2353304">/</span>&nbsp;<span class="ident" id="2353306">Abs</span><span class="op" id="2353309">(</span><span class="ident" id="2353310">t</span><span class="op" id="2353311">*</span><span class="ident" id="2353312">x</span><span class="op" id="2353313">)</span><span class="op" id="2353314">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353318">if</span>&nbsp;<span class="ident" id="2353321">t</span>&nbsp;<span class="op" id="2353323">&lt;</span>&nbsp;<span class="num" id="2353325">0</span>&nbsp;<span class="op" id="2353327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353332">sign</span>&nbsp;<span class="op" id="2353337">=</span>&nbsp;<span class="op" id="2353339">-</span><span class="num" id="2353340">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353351">switch</span>&nbsp;<span class="op" id="2353358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353361">case</span>&nbsp;<span class="ident" id="2353366">x</span>&nbsp;<span class="op" id="2353368">==</span>&nbsp;<span class="num" id="2353371">1</span>&nbsp;<span class="op" id="2353373">||</span>&nbsp;<span class="ident" id="2353376">x</span>&nbsp;<span class="op" id="2353378">==</span>&nbsp;<span class="num" id="2353381">2</span><span class="op" id="2353382">:</span>&nbsp;<span class="comment" id="2353384">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353407">lgamma</span>&nbsp;<span class="op" id="2353414">=</span>&nbsp;<span class="num" id="2353416">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353420">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353428">case</span>&nbsp;<span class="ident" id="2353433">x</span>&nbsp;<span class="op" id="2353435">&lt;</span>&nbsp;<span class="num" id="2353437">2</span><span class="op" id="2353438">:</span>&nbsp;<span class="comment" id="2353440">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353482">var</span>&nbsp;<span class="ident" id="2353486">y</span>&nbsp;<span class="builtintype" id="2353488">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353498">var</span>&nbsp;<span class="ident" id="2353502">i</span>&nbsp;<span class="builtintype" id="2353504">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353510">if</span>&nbsp;<span class="ident" id="2353513">x</span>&nbsp;<span class="op" id="2353515">&lt;=</span>&nbsp;<span class="num" id="2353518">0.9</span>&nbsp;<span class="op" id="2353522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353527">lgamma</span>&nbsp;<span class="op" id="2353534">=</span>&nbsp;<span class="op" id="2353536">-</span><span class="ident" id="2353537">Log</span><span class="op" id="2353540">(</span><span class="ident" id="2353541">x</span><span class="op" id="2353542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353547">switch</span>&nbsp;<span class="op" id="2353554">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353559">case</span>&nbsp;<span class="ident" id="2353564">x</span>&nbsp;<span class="op" id="2353566">&gt;=</span>&nbsp;<span class="op" id="2353569">(</span><span class="ident" id="2353570">Ymin</span>&nbsp;<span class="op" id="2353575">-</span>&nbsp;<span class="num" id="2353577">1</span>&nbsp;<span class="op" id="2353579">+</span>&nbsp;<span class="num" id="2353581">0.27</span><span class="op" id="2353585">)</span><span class="op" id="2353586">:</span>&nbsp;<span class="comment" id="2353588">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353615">y</span>&nbsp;<span class="op" id="2353617">=</span>&nbsp;<span class="num" id="2353619">1</span>&nbsp;<span class="op" id="2353621">-</span>&nbsp;<span class="ident" id="2353623">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353629">i</span>&nbsp;<span class="op" id="2353631">=</span>&nbsp;<span class="num" id="2353633">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353638">case</span>&nbsp;<span class="ident" id="2353643">x</span>&nbsp;<span class="op" id="2353645">&gt;=</span>&nbsp;<span class="op" id="2353648">(</span><span class="ident" id="2353649">Ymin</span>&nbsp;<span class="op" id="2353654">-</span>&nbsp;<span class="num" id="2353656">1</span>&nbsp;<span class="op" id="2353658">-</span>&nbsp;<span class="num" id="2353660">0.27</span><span class="op" id="2353664">)</span><span class="op" id="2353665">:</span>&nbsp;<span class="comment" id="2353667">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353695">y</span>&nbsp;<span class="op" id="2353697">=</span>&nbsp;<span class="ident" id="2353699">x</span>&nbsp;<span class="op" id="2353701">-</span>&nbsp;<span class="op" id="2353703">(</span><span class="ident" id="2353704">Tc</span>&nbsp;<span class="op" id="2353707">-</span>&nbsp;<span class="num" id="2353709">1</span><span class="op" id="2353710">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353716">i</span>&nbsp;<span class="op" id="2353718">=</span>&nbsp;<span class="num" id="2353720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353725">default</span><span class="op" id="2353732">:</span>&nbsp;<span class="comment" id="2353734">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353756">y</span>&nbsp;<span class="op" id="2353758">=</span>&nbsp;<span class="ident" id="2353760">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353766">i</span>&nbsp;<span class="op" id="2353768">=</span>&nbsp;<span class="num" id="2353770">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353775">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353779">}</span>&nbsp;<span class="keyword" id="2353781">else</span>&nbsp;<span class="op" id="2353786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353791">lgamma</span>&nbsp;<span class="op" id="2353798">=</span>&nbsp;<span class="num" id="2353800">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353805">switch</span>&nbsp;<span class="op" id="2353812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353817">case</span>&nbsp;<span class="ident" id="2353822">x</span>&nbsp;<span class="op" id="2353824">&gt;=</span>&nbsp;<span class="op" id="2353827">(</span><span class="ident" id="2353828">Ymin</span>&nbsp;<span class="op" id="2353833">+</span>&nbsp;<span class="num" id="2353835">0.27</span><span class="op" id="2353839">)</span><span class="op" id="2353840">:</span>&nbsp;<span class="comment" id="2353842">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353865">y</span>&nbsp;<span class="op" id="2353867">=</span>&nbsp;<span class="num" id="2353869">2</span>&nbsp;<span class="op" id="2353871">-</span>&nbsp;<span class="ident" id="2353873">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353879">i</span>&nbsp;<span class="op" id="2353881">=</span>&nbsp;<span class="num" id="2353883">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353888">case</span>&nbsp;<span class="ident" id="2353893">x</span>&nbsp;<span class="op" id="2353895">&gt;=</span>&nbsp;<span class="op" id="2353898">(</span><span class="ident" id="2353899">Ymin</span>&nbsp;<span class="op" id="2353904">-</span>&nbsp;<span class="num" id="2353906">0.27</span><span class="op" id="2353910">)</span><span class="op" id="2353911">:</span>&nbsp;<span class="comment" id="2353913">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353941">y</span>&nbsp;<span class="op" id="2353943">=</span>&nbsp;<span class="ident" id="2353945">x</span>&nbsp;<span class="op" id="2353947">-</span>&nbsp;<span class="ident" id="2353949">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353956">i</span>&nbsp;<span class="op" id="2353958">=</span>&nbsp;<span class="num" id="2353960">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353965">default</span><span class="op" id="2353972">:</span>&nbsp;<span class="comment" id="2353974">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353998">y</span>&nbsp;<span class="op" id="2354000">=</span>&nbsp;<span class="ident" id="2354002">x</span>&nbsp;<span class="op" id="2354004">-</span>&nbsp;<span class="num" id="2354006">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354012">i</span>&nbsp;<span class="op" id="2354014">=</span>&nbsp;<span class="num" id="2354016">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354029">switch</span>&nbsp;<span class="ident" id="2354036">i</span>&nbsp;<span class="op" id="2354038">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354042">case</span>&nbsp;<span class="num" id="2354047">0</span><span class="op" id="2354048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354053">z</span>&nbsp;<span class="op" id="2354055">:=</span>&nbsp;<span class="ident" id="2354058">y</span>&nbsp;<span class="op" id="2354060">*</span>&nbsp;<span class="ident" id="2354062">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354067">p1</span>&nbsp;<span class="op" id="2354070">:=</span>&nbsp;<span class="ident" id="2354073">_lgamA</span><span class="op" id="2354079">[</span><span class="num" id="2354080">0</span><span class="op" id="2354081">]</span>&nbsp;<span class="op" id="2354083">+</span>&nbsp;<span class="ident" id="2354085">z</span><span class="op" id="2354086">*</span><span class="op" id="2354087">(</span><span class="ident" id="2354088">_lgamA</span><span class="op" id="2354094">[</span><span class="num" id="2354095">2</span><span class="op" id="2354096">]</span><span class="op" id="2354097">+</span><span class="ident" id="2354098">z</span><span class="op" id="2354099">*</span><span class="op" id="2354100">(</span><span class="ident" id="2354101">_lgamA</span><span class="op" id="2354107">[</span><span class="num" id="2354108">4</span><span class="op" id="2354109">]</span><span class="op" id="2354110">+</span><span class="ident" id="2354111">z</span><span class="op" id="2354112">*</span><span class="op" id="2354113">(</span><span class="ident" id="2354114">_lgamA</span><span class="op" id="2354120">[</span><span class="num" id="2354121">6</span><span class="op" id="2354122">]</span><span class="op" id="2354123">+</span><span class="ident" id="2354124">z</span><span class="op" id="2354125">*</span><span class="op" id="2354126">(</span><span class="ident" id="2354127">_lgamA</span><span class="op" id="2354133">[</span><span class="num" id="2354134">8</span><span class="op" id="2354135">]</span><span class="op" id="2354136">+</span><span class="ident" id="2354137">z</span><span class="op" id="2354138">*</span><span class="ident" id="2354139">_lgamA</span><span class="op" id="2354145">[</span><span class="num" id="2354146">10</span><span class="op" id="2354148">]</span><span class="op" id="2354149">)</span><span class="op" id="2354150">)</span><span class="op" id="2354151">)</span><span class="op" id="2354152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354157">p2</span>&nbsp;<span class="op" id="2354160">:=</span>&nbsp;<span class="ident" id="2354163">z</span>&nbsp;<span class="op" id="2354165">*</span>&nbsp;<span class="op" id="2354167">(</span><span class="ident" id="2354168">_lgamA</span><span class="op" id="2354174">[</span><span class="num" id="2354175">1</span><span class="op" id="2354176">]</span>&nbsp;<span class="op" id="2354178">+</span>&nbsp;<span class="ident" id="2354180">z</span><span class="op" id="2354181">*</span><span class="op" id="2354182">(</span><span class="op" id="2354183">+</span><span class="ident" id="2354184">_lgamA</span><span class="op" id="2354190">[</span><span class="num" id="2354191">3</span><span class="op" id="2354192">]</span><span class="op" id="2354193">+</span><span class="ident" id="2354194">z</span><span class="op" id="2354195">*</span><span class="op" id="2354196">(</span><span class="ident" id="2354197">_lgamA</span><span class="op" id="2354203">[</span><span class="num" id="2354204">5</span><span class="op" id="2354205">]</span><span class="op" id="2354206">+</span><span class="ident" id="2354207">z</span><span class="op" id="2354208">*</span><span class="op" id="2354209">(</span><span class="ident" id="2354210">_lgamA</span><span class="op" id="2354216">[</span><span class="num" id="2354217">7</span><span class="op" id="2354218">]</span><span class="op" id="2354219">+</span><span class="ident" id="2354220">z</span><span class="op" id="2354221">*</span><span class="op" id="2354222">(</span><span class="ident" id="2354223">_lgamA</span><span class="op" id="2354229">[</span><span class="num" id="2354230">9</span><span class="op" id="2354231">]</span><span class="op" id="2354232">+</span><span class="ident" id="2354233">z</span><span class="op" id="2354234">*</span><span class="ident" id="2354235">_lgamA</span><span class="op" id="2354241">[</span><span class="num" id="2354242">11</span><span class="op" id="2354244">]</span><span class="op" id="2354245">)</span><span class="op" id="2354246">)</span><span class="op" id="2354247">)</span><span class="op" id="2354248">)</span><span class="op" id="2354249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354254">p</span>&nbsp;<span class="op" id="2354256">:=</span>&nbsp;<span class="ident" id="2354259">y</span><span class="op" id="2354260">*</span><span class="ident" id="2354261">p1</span>&nbsp;<span class="op" id="2354264">+</span>&nbsp;<span class="ident" id="2354266">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354272">lgamma</span>&nbsp;<span class="op" id="2354279">+=</span>&nbsp;<span class="op" id="2354282">(</span><span class="ident" id="2354283">p</span>&nbsp;<span class="op" id="2354285">-</span>&nbsp;<span class="num" id="2354287">0.5</span><span class="op" id="2354290">*</span><span class="ident" id="2354291">y</span><span class="op" id="2354292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354296">case</span>&nbsp;<span class="num" id="2354301">1</span><span class="op" id="2354302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354307">z</span>&nbsp;<span class="op" id="2354309">:=</span>&nbsp;<span class="ident" id="2354312">y</span>&nbsp;<span class="op" id="2354314">*</span>&nbsp;<span class="ident" id="2354316">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354321">w</span>&nbsp;<span class="op" id="2354323">:=</span>&nbsp;<span class="ident" id="2354326">z</span>&nbsp;<span class="op" id="2354328">*</span>&nbsp;<span class="ident" id="2354330">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354335">p1</span>&nbsp;<span class="op" id="2354338">:=</span>&nbsp;<span class="ident" id="2354341">_lgamT</span><span class="op" id="2354347">[</span><span class="num" id="2354348">0</span><span class="op" id="2354349">]</span>&nbsp;<span class="op" id="2354351">+</span>&nbsp;<span class="ident" id="2354353">w</span><span class="op" id="2354354">*</span><span class="op" id="2354355">(</span><span class="ident" id="2354356">_lgamT</span><span class="op" id="2354362">[</span><span class="num" id="2354363">3</span><span class="op" id="2354364">]</span><span class="op" id="2354365">+</span><span class="ident" id="2354366">w</span><span class="op" id="2354367">*</span><span class="op" id="2354368">(</span><span class="ident" id="2354369">_lgamT</span><span class="op" id="2354375">[</span><span class="num" id="2354376">6</span><span class="op" id="2354377">]</span><span class="op" id="2354378">+</span><span class="ident" id="2354379">w</span><span class="op" id="2354380">*</span><span class="op" id="2354381">(</span><span class="ident" id="2354382">_lgamT</span><span class="op" id="2354388">[</span><span class="num" id="2354389">9</span><span class="op" id="2354390">]</span><span class="op" id="2354391">+</span><span class="ident" id="2354392">w</span><span class="op" id="2354393">*</span><span class="ident" id="2354394">_lgamT</span><span class="op" id="2354400">[</span><span class="num" id="2354401">12</span><span class="op" id="2354403">]</span><span class="op" id="2354404">)</span><span class="op" id="2354405">)</span><span class="op" id="2354406">)</span>&nbsp;<span class="comment" id="2354408">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354428">p2</span>&nbsp;<span class="op" id="2354431">:=</span>&nbsp;<span class="ident" id="2354434">_lgamT</span><span class="op" id="2354440">[</span><span class="num" id="2354441">1</span><span class="op" id="2354442">]</span>&nbsp;<span class="op" id="2354444">+</span>&nbsp;<span class="ident" id="2354446">w</span><span class="op" id="2354447">*</span><span class="op" id="2354448">(</span><span class="ident" id="2354449">_lgamT</span><span class="op" id="2354455">[</span><span class="num" id="2354456">4</span><span class="op" id="2354457">]</span><span class="op" id="2354458">+</span><span class="ident" id="2354459">w</span><span class="op" id="2354460">*</span><span class="op" id="2354461">(</span><span class="ident" id="2354462">_lgamT</span><span class="op" id="2354468">[</span><span class="num" id="2354469">7</span><span class="op" id="2354470">]</span><span class="op" id="2354471">+</span><span class="ident" id="2354472">w</span><span class="op" id="2354473">*</span><span class="op" id="2354474">(</span><span class="ident" id="2354475">_lgamT</span><span class="op" id="2354481">[</span><span class="num" id="2354482">10</span><span class="op" id="2354484">]</span><span class="op" id="2354485">+</span><span class="ident" id="2354486">w</span><span class="op" id="2354487">*</span><span class="ident" id="2354488">_lgamT</span><span class="op" id="2354494">[</span><span class="num" id="2354495">13</span><span class="op" id="2354497">]</span><span class="op" id="2354498">)</span><span class="op" id="2354499">)</span><span class="op" id="2354500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354505">p3</span>&nbsp;<span class="op" id="2354508">:=</span>&nbsp;<span class="ident" id="2354511">_lgamT</span><span class="op" id="2354517">[</span><span class="num" id="2354518">2</span><span class="op" id="2354519">]</span>&nbsp;<span class="op" id="2354521">+</span>&nbsp;<span class="ident" id="2354523">w</span><span class="op" id="2354524">*</span><span class="op" id="2354525">(</span><span class="ident" id="2354526">_lgamT</span><span class="op" id="2354532">[</span><span class="num" id="2354533">5</span><span class="op" id="2354534">]</span><span class="op" id="2354535">+</span><span class="ident" id="2354536">w</span><span class="op" id="2354537">*</span><span class="op" id="2354538">(</span><span class="ident" id="2354539">_lgamT</span><span class="op" id="2354545">[</span><span class="num" id="2354546">8</span><span class="op" id="2354547">]</span><span class="op" id="2354548">+</span><span class="ident" id="2354549">w</span><span class="op" id="2354550">*</span><span class="op" id="2354551">(</span><span class="ident" id="2354552">_lgamT</span><span class="op" id="2354558">[</span><span class="num" id="2354559">11</span><span class="op" id="2354561">]</span><span class="op" id="2354562">+</span><span class="ident" id="2354563">w</span><span class="op" id="2354564">*</span><span class="ident" id="2354565">_lgamT</span><span class="op" id="2354571">[</span><span class="num" id="2354572">14</span><span class="op" id="2354574">]</span><span class="op" id="2354575">)</span><span class="op" id="2354576">)</span><span class="op" id="2354577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354582">p</span>&nbsp;<span class="op" id="2354584">:=</span>&nbsp;<span class="ident" id="2354587">z</span><span class="op" id="2354588">*</span><span class="ident" id="2354589">p1</span>&nbsp;<span class="op" id="2354592">-</span>&nbsp;<span class="op" id="2354594">(</span><span class="ident" id="2354595">Tt</span>&nbsp;<span class="op" id="2354598">-</span>&nbsp;<span class="ident" id="2354600">w</span><span class="op" id="2354601">*</span><span class="op" id="2354602">(</span><span class="ident" id="2354603">p2</span><span class="op" id="2354605">+</span><span class="ident" id="2354606">y</span><span class="op" id="2354607">*</span><span class="ident" id="2354608">p3</span><span class="op" id="2354610">)</span><span class="op" id="2354611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354616">lgamma</span>&nbsp;<span class="op" id="2354623">+=</span>&nbsp;<span class="op" id="2354626">(</span><span class="ident" id="2354627">Tf</span>&nbsp;<span class="op" id="2354630">+</span>&nbsp;<span class="ident" id="2354632">p</span><span class="op" id="2354633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354637">case</span>&nbsp;<span class="num" id="2354642">2</span><span class="op" id="2354643">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354648">p1</span>&nbsp;<span class="op" id="2354651">:=</span>&nbsp;<span class="ident" id="2354654">y</span>&nbsp;<span class="op" id="2354656">*</span>&nbsp;<span class="op" id="2354658">(</span><span class="ident" id="2354659">_lgamU</span><span class="op" id="2354665">[</span><span class="num" id="2354666">0</span><span class="op" id="2354667">]</span>&nbsp;<span class="op" id="2354669">+</span>&nbsp;<span class="ident" id="2354671">y</span><span class="op" id="2354672">*</span><span class="op" id="2354673">(</span><span class="ident" id="2354674">_lgamU</span><span class="op" id="2354680">[</span><span class="num" id="2354681">1</span><span class="op" id="2354682">]</span><span class="op" id="2354683">+</span><span class="ident" id="2354684">y</span><span class="op" id="2354685">*</span><span class="op" id="2354686">(</span><span class="ident" id="2354687">_lgamU</span><span class="op" id="2354693">[</span><span class="num" id="2354694">2</span><span class="op" id="2354695">]</span><span class="op" id="2354696">+</span><span class="ident" id="2354697">y</span><span class="op" id="2354698">*</span><span class="op" id="2354699">(</span><span class="ident" id="2354700">_lgamU</span><span class="op" id="2354706">[</span><span class="num" id="2354707">3</span><span class="op" id="2354708">]</span><span class="op" id="2354709">+</span><span class="ident" id="2354710">y</span><span class="op" id="2354711">*</span><span class="op" id="2354712">(</span><span class="ident" id="2354713">_lgamU</span><span class="op" id="2354719">[</span><span class="num" id="2354720">4</span><span class="op" id="2354721">]</span><span class="op" id="2354722">+</span><span class="ident" id="2354723">y</span><span class="op" id="2354724">*</span><span class="ident" id="2354725">_lgamU</span><span class="op" id="2354731">[</span><span class="num" id="2354732">5</span><span class="op" id="2354733">]</span><span class="op" id="2354734">)</span><span class="op" id="2354735">)</span><span class="op" id="2354736">)</span><span class="op" id="2354737">)</span><span class="op" id="2354738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354743">p2</span>&nbsp;<span class="op" id="2354746">:=</span>&nbsp;<span class="num" id="2354749">1</span>&nbsp;<span class="op" id="2354751">+</span>&nbsp;<span class="ident" id="2354753">y</span><span class="op" id="2354754">*</span><span class="op" id="2354755">(</span><span class="ident" id="2354756">_lgamV</span><span class="op" id="2354762">[</span><span class="num" id="2354763">1</span><span class="op" id="2354764">]</span><span class="op" id="2354765">+</span><span class="ident" id="2354766">y</span><span class="op" id="2354767">*</span><span class="op" id="2354768">(</span><span class="ident" id="2354769">_lgamV</span><span class="op" id="2354775">[</span><span class="num" id="2354776">2</span><span class="op" id="2354777">]</span><span class="op" id="2354778">+</span><span class="ident" id="2354779">y</span><span class="op" id="2354780">*</span><span class="op" id="2354781">(</span><span class="ident" id="2354782">_lgamV</span><span class="op" id="2354788">[</span><span class="num" id="2354789">3</span><span class="op" id="2354790">]</span><span class="op" id="2354791">+</span><span class="ident" id="2354792">y</span><span class="op" id="2354793">*</span><span class="op" id="2354794">(</span><span class="ident" id="2354795">_lgamV</span><span class="op" id="2354801">[</span><span class="num" id="2354802">4</span><span class="op" id="2354803">]</span><span class="op" id="2354804">+</span><span class="ident" id="2354805">y</span><span class="op" id="2354806">*</span><span class="ident" id="2354807">_lgamV</span><span class="op" id="2354813">[</span><span class="num" id="2354814">5</span><span class="op" id="2354815">]</span><span class="op" id="2354816">)</span><span class="op" id="2354817">)</span><span class="op" id="2354818">)</span><span class="op" id="2354819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354824">lgamma</span>&nbsp;<span class="op" id="2354831">+=</span>&nbsp;<span class="op" id="2354834">(</span><span class="op" id="2354835">-</span><span class="num" id="2354836">0.5</span><span class="op" id="2354839">*</span><span class="ident" id="2354840">y</span>&nbsp;<span class="op" id="2354842">+</span>&nbsp;<span class="ident" id="2354844">p1</span><span class="op" id="2354846">/</span><span class="ident" id="2354847">p2</span><span class="op" id="2354849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354856">case</span>&nbsp;<span class="ident" id="2354861">x</span>&nbsp;<span class="op" id="2354863">&lt;</span>&nbsp;<span class="num" id="2354865">8</span><span class="op" id="2354866">:</span>&nbsp;<span class="comment" id="2354868">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354884">i</span>&nbsp;<span class="op" id="2354886">:=</span>&nbsp;<span class="builtintype" id="2354889">int</span><span class="op" id="2354892">(</span><span class="ident" id="2354893">x</span><span class="op" id="2354894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354898">y</span>&nbsp;<span class="op" id="2354900">:=</span>&nbsp;<span class="ident" id="2354903">x</span>&nbsp;<span class="op" id="2354905">-</span>&nbsp;<span class="builtintype" id="2354907">float64</span><span class="op" id="2354914">(</span><span class="ident" id="2354915">i</span><span class="op" id="2354916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354920">p</span>&nbsp;<span class="op" id="2354922">:=</span>&nbsp;<span class="ident" id="2354925">y</span>&nbsp;<span class="op" id="2354927">*</span>&nbsp;<span class="op" id="2354929">(</span><span class="ident" id="2354930">_lgamS</span><span class="op" id="2354936">[</span><span class="num" id="2354937">0</span><span class="op" id="2354938">]</span>&nbsp;<span class="op" id="2354940">+</span>&nbsp;<span class="ident" id="2354942">y</span><span class="op" id="2354943">*</span><span class="op" id="2354944">(</span><span class="ident" id="2354945">_lgamS</span><span class="op" id="2354951">[</span><span class="num" id="2354952">1</span><span class="op" id="2354953">]</span><span class="op" id="2354954">+</span><span class="ident" id="2354955">y</span><span class="op" id="2354956">*</span><span class="op" id="2354957">(</span><span class="ident" id="2354958">_lgamS</span><span class="op" id="2354964">[</span><span class="num" id="2354965">2</span><span class="op" id="2354966">]</span><span class="op" id="2354967">+</span><span class="ident" id="2354968">y</span><span class="op" id="2354969">*</span><span class="op" id="2354970">(</span><span class="ident" id="2354971">_lgamS</span><span class="op" id="2354977">[</span><span class="num" id="2354978">3</span><span class="op" id="2354979">]</span><span class="op" id="2354980">+</span><span class="ident" id="2354981">y</span><span class="op" id="2354982">*</span><span class="op" id="2354983">(</span><span class="ident" id="2354984">_lgamS</span><span class="op" id="2354990">[</span><span class="num" id="2354991">4</span><span class="op" id="2354992">]</span><span class="op" id="2354993">+</span><span class="ident" id="2354994">y</span><span class="op" id="2354995">*</span><span class="op" id="2354996">(</span><span class="ident" id="2354997">_lgamS</span><span class="op" id="2355003">[</span><span class="num" id="2355004">5</span><span class="op" id="2355005">]</span><span class="op" id="2355006">+</span><span class="ident" id="2355007">y</span><span class="op" id="2355008">*</span><span class="ident" id="2355009">_lgamS</span><span class="op" id="2355015">[</span><span class="num" id="2355016">6</span><span class="op" id="2355017">]</span><span class="op" id="2355018">)</span><span class="op" id="2355019">)</span><span class="op" id="2355020">)</span><span class="op" id="2355021">)</span><span class="op" id="2355022">)</span><span class="op" id="2355023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355027">q</span>&nbsp;<span class="op" id="2355029">:=</span>&nbsp;<span class="num" id="2355032">1</span>&nbsp;<span class="op" id="2355034">+</span>&nbsp;<span class="ident" id="2355036">y</span><span class="op" id="2355037">*</span><span class="op" id="2355038">(</span><span class="ident" id="2355039">_lgamR</span><span class="op" id="2355045">[</span><span class="num" id="2355046">1</span><span class="op" id="2355047">]</span><span class="op" id="2355048">+</span><span class="ident" id="2355049">y</span><span class="op" id="2355050">*</span><span class="op" id="2355051">(</span><span class="ident" id="2355052">_lgamR</span><span class="op" id="2355058">[</span><span class="num" id="2355059">2</span><span class="op" id="2355060">]</span><span class="op" id="2355061">+</span><span class="ident" id="2355062">y</span><span class="op" id="2355063">*</span><span class="op" id="2355064">(</span><span class="ident" id="2355065">_lgamR</span><span class="op" id="2355071">[</span><span class="num" id="2355072">3</span><span class="op" id="2355073">]</span><span class="op" id="2355074">+</span><span class="ident" id="2355075">y</span><span class="op" id="2355076">*</span><span class="op" id="2355077">(</span><span class="ident" id="2355078">_lgamR</span><span class="op" id="2355084">[</span><span class="num" id="2355085">4</span><span class="op" id="2355086">]</span><span class="op" id="2355087">+</span><span class="ident" id="2355088">y</span><span class="op" id="2355089">*</span><span class="op" id="2355090">(</span><span class="ident" id="2355091">_lgamR</span><span class="op" id="2355097">[</span><span class="num" id="2355098">5</span><span class="op" id="2355099">]</span><span class="op" id="2355100">+</span><span class="ident" id="2355101">y</span><span class="op" id="2355102">*</span><span class="ident" id="2355103">_lgamR</span><span class="op" id="2355109">[</span><span class="num" id="2355110">6</span><span class="op" id="2355111">]</span><span class="op" id="2355112">)</span><span class="op" id="2355113">)</span><span class="op" id="2355114">)</span><span class="op" id="2355115">)</span><span class="op" id="2355116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355120">lgamma</span>&nbsp;<span class="op" id="2355127">=</span>&nbsp;<span class="num" id="2355129">0.5</span><span class="op" id="2355132">*</span><span class="ident" id="2355133">y</span>&nbsp;<span class="op" id="2355135">+</span>&nbsp;<span class="ident" id="2355137">p</span><span class="op" id="2355138">/</span><span class="ident" id="2355139">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355143">z</span>&nbsp;<span class="op" id="2355145">:=</span>&nbsp;<span class="num" id="2355148">1.0</span>&nbsp;<span class="comment" id="2355152">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355190">switch</span>&nbsp;<span class="ident" id="2355197">i</span>&nbsp;<span class="op" id="2355199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355203">case</span>&nbsp;<span class="num" id="2355208">7</span><span class="op" id="2355209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355214">z</span>&nbsp;<span class="op" id="2355216">*=</span>&nbsp;<span class="op" id="2355219">(</span><span class="ident" id="2355220">y</span>&nbsp;<span class="op" id="2355222">+</span>&nbsp;<span class="num" id="2355224">6</span><span class="op" id="2355225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355230">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355244">case</span>&nbsp;<span class="num" id="2355249">6</span><span class="op" id="2355250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355255">z</span>&nbsp;<span class="op" id="2355257">*=</span>&nbsp;<span class="op" id="2355260">(</span><span class="ident" id="2355261">y</span>&nbsp;<span class="op" id="2355263">+</span>&nbsp;<span class="num" id="2355265">5</span><span class="op" id="2355266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355271">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355285">case</span>&nbsp;<span class="num" id="2355290">5</span><span class="op" id="2355291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355296">z</span>&nbsp;<span class="op" id="2355298">*=</span>&nbsp;<span class="op" id="2355301">(</span><span class="ident" id="2355302">y</span>&nbsp;<span class="op" id="2355304">+</span>&nbsp;<span class="num" id="2355306">4</span><span class="op" id="2355307">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355312">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355326">case</span>&nbsp;<span class="num" id="2355331">4</span><span class="op" id="2355332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355337">z</span>&nbsp;<span class="op" id="2355339">*=</span>&nbsp;<span class="op" id="2355342">(</span><span class="ident" id="2355343">y</span>&nbsp;<span class="op" id="2355345">+</span>&nbsp;<span class="num" id="2355347">3</span><span class="op" id="2355348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355353">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355367">case</span>&nbsp;<span class="num" id="2355372">3</span><span class="op" id="2355373">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355378">z</span>&nbsp;<span class="op" id="2355380">*=</span>&nbsp;<span class="op" id="2355383">(</span><span class="ident" id="2355384">y</span>&nbsp;<span class="op" id="2355386">+</span>&nbsp;<span class="num" id="2355388">2</span><span class="op" id="2355389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355394">lgamma</span>&nbsp;<span class="op" id="2355401">+=</span>&nbsp;<span class="ident" id="2355404">Log</span><span class="op" id="2355407">(</span><span class="ident" id="2355408">z</span><span class="op" id="2355409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355416">case</span>&nbsp;<span class="ident" id="2355421">x</span>&nbsp;<span class="op" id="2355423">&lt;</span>&nbsp;<span class="ident" id="2355425">Two58</span><span class="op" id="2355430">:</span>&nbsp;<span class="comment" id="2355432">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355452">t</span>&nbsp;<span class="op" id="2355454">:=</span>&nbsp;<span class="ident" id="2355457">Log</span><span class="op" id="2355460">(</span><span class="ident" id="2355461">x</span><span class="op" id="2355462">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355466">z</span>&nbsp;<span class="op" id="2355468">:=</span>&nbsp;<span class="num" id="2355471">1</span>&nbsp;<span class="op" id="2355473">/</span>&nbsp;<span class="ident" id="2355475">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355479">y</span>&nbsp;<span class="op" id="2355481">:=</span>&nbsp;<span class="ident" id="2355484">z</span>&nbsp;<span class="op" id="2355486">*</span>&nbsp;<span class="ident" id="2355488">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355492">w</span>&nbsp;<span class="op" id="2355494">:=</span>&nbsp;<span class="ident" id="2355497">_lgamW</span><span class="op" id="2355503">[</span><span class="num" id="2355504">0</span><span class="op" id="2355505">]</span>&nbsp;<span class="op" id="2355507">+</span>&nbsp;<span class="ident" id="2355509">z</span><span class="op" id="2355510">*</span><span class="op" id="2355511">(</span><span class="ident" id="2355512">_lgamW</span><span class="op" id="2355518">[</span><span class="num" id="2355519">1</span><span class="op" id="2355520">]</span><span class="op" id="2355521">+</span><span class="ident" id="2355522">y</span><span class="op" id="2355523">*</span><span class="op" id="2355524">(</span><span class="ident" id="2355525">_lgamW</span><span class="op" id="2355531">[</span><span class="num" id="2355532">2</span><span class="op" id="2355533">]</span><span class="op" id="2355534">+</span><span class="ident" id="2355535">y</span><span class="op" id="2355536">*</span><span class="op" id="2355537">(</span><span class="ident" id="2355538">_lgamW</span><span class="op" id="2355544">[</span><span class="num" id="2355545">3</span><span class="op" id="2355546">]</span><span class="op" id="2355547">+</span><span class="ident" id="2355548">y</span><span class="op" id="2355549">*</span><span class="op" id="2355550">(</span><span class="ident" id="2355551">_lgamW</span><span class="op" id="2355557">[</span><span class="num" id="2355558">4</span><span class="op" id="2355559">]</span><span class="op" id="2355560">+</span><span class="ident" id="2355561">y</span><span class="op" id="2355562">*</span><span class="op" id="2355563">(</span><span class="ident" id="2355564">_lgamW</span><span class="op" id="2355570">[</span><span class="num" id="2355571">5</span><span class="op" id="2355572">]</span><span class="op" id="2355573">+</span><span class="ident" id="2355574">y</span><span class="op" id="2355575">*</span><span class="ident" id="2355576">_lgamW</span><span class="op" id="2355582">[</span><span class="num" id="2355583">6</span><span class="op" id="2355584">]</span><span class="op" id="2355585">)</span><span class="op" id="2355586">)</span><span class="op" id="2355587">)</span><span class="op" id="2355588">)</span><span class="op" id="2355589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355593">lgamma</span>&nbsp;<span class="op" id="2355600">=</span>&nbsp;<span class="op" id="2355602">(</span><span class="ident" id="2355603">x</span><span class="op" id="2355604">-</span><span class="num" id="2355605">0.5</span><span class="op" id="2355608">)</span><span class="op" id="2355609">*</span><span class="op" id="2355610">(</span><span class="ident" id="2355611">t</span><span class="op" id="2355612">-</span><span class="num" id="2355613">1</span><span class="op" id="2355614">)</span>&nbsp;<span class="op" id="2355616">+</span>&nbsp;<span class="ident" id="2355618">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355621">default</span><span class="op" id="2355628">:</span>&nbsp;<span class="comment" id="2355630">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355653">lgamma</span>&nbsp;<span class="op" id="2355660">=</span>&nbsp;<span class="ident" id="2355662">x</span>&nbsp;<span class="op" id="2355664">*</span>&nbsp;<span class="op" id="2355666">(</span><span class="ident" id="2355667">Log</span><span class="op" id="2355670">(</span><span class="ident" id="2355671">x</span><span class="op" id="2355672">)</span>&nbsp;<span class="op" id="2355674">-</span>&nbsp;<span class="num" id="2355676">1</span><span class="op" id="2355677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355683">if</span>&nbsp;<span class="ident" id="2355686">neg</span>&nbsp;<span class="op" id="2355690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355694">lgamma</span>&nbsp;<span class="op" id="2355701">=</span>&nbsp;<span class="ident" id="2355703">nadj</span>&nbsp;<span class="op" id="2355708">-</span>&nbsp;<span class="ident" id="2355710">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355718">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355721">return</span><br>
<span class="lineno"></span><span class="op" id="2355728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2355731">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2355779">func</span>&nbsp;<span class="ident" id="2355784">sinPi</span><span class="op" id="2355789">(</span><span class="ident" id="2355790">x</span>&nbsp;<span class="builtintype" id="2355792">float64</span><span class="op" id="2355799">)</span>&nbsp;<span class="builtintype" id="2355801">float64</span>&nbsp;<span class="op" id="2355809">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355812">const</span>&nbsp;<span class="op" id="2355818">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355822">Two52</span>&nbsp;<span class="op" id="2355828">=</span>&nbsp;<span class="num" id="2355830">1</span>&nbsp;<span class="op" id="2355832">&lt;&lt;</span>&nbsp;<span class="num" id="2355835">52</span>&nbsp;<span class="comment" id="2355838">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355874">Two53</span>&nbsp;<span class="op" id="2355880">=</span>&nbsp;<span class="num" id="2355882">1</span>&nbsp;<span class="op" id="2355884">&lt;&lt;</span>&nbsp;<span class="num" id="2355887">53</span>&nbsp;<span class="comment" id="2355890">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355928">if</span>&nbsp;<span class="ident" id="2355931">x</span>&nbsp;<span class="op" id="2355933">&lt;</span>&nbsp;<span class="num" id="2355935">0.25</span>&nbsp;<span class="op" id="2355940">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355944">return</span>&nbsp;<span class="op" id="2355951">-</span><span class="ident" id="2355952">Sin</span><span class="op" id="2355955">(</span><span class="ident" id="2355956">Pi</span>&nbsp;<span class="op" id="2355959">*</span>&nbsp;<span class="ident" id="2355961">x</span><span class="op" id="2355962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355969">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355992">z</span>&nbsp;<span class="op" id="2355994">:=</span>&nbsp;<span class="ident" id="2355997">Floor</span><span class="op" id="2356002">(</span><span class="ident" id="2356003">x</span><span class="op" id="2356004">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356007">var</span>&nbsp;<span class="ident" id="2356011">n</span>&nbsp;<span class="builtintype" id="2356013">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356018">if</span>&nbsp;<span class="ident" id="2356021">z</span>&nbsp;<span class="op" id="2356023">!=</span>&nbsp;<span class="ident" id="2356026">x</span>&nbsp;<span class="op" id="2356028">{</span>&nbsp;<span class="comment" id="2356030">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356043">x</span>&nbsp;<span class="op" id="2356045">=</span>&nbsp;<span class="ident" id="2356047">Mod</span><span class="op" id="2356050">(</span><span class="ident" id="2356051">x</span><span class="op" id="2356052">,</span>&nbsp;<span class="num" id="2356054">2</span><span class="op" id="2356055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356059">n</span>&nbsp;<span class="op" id="2356061">=</span>&nbsp;<span class="builtintype" id="2356063">int</span><span class="op" id="2356066">(</span><span class="ident" id="2356067">x</span>&nbsp;<span class="op" id="2356069">*</span>&nbsp;<span class="num" id="2356071">4</span><span class="op" id="2356072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356075">}</span>&nbsp;<span class="keyword" id="2356077">else</span>&nbsp;<span class="op" id="2356082">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356086">if</span>&nbsp;<span class="ident" id="2356089">x</span>&nbsp;<span class="op" id="2356091">&gt;=</span>&nbsp;<span class="ident" id="2356094">Two53</span>&nbsp;<span class="op" id="2356100">{</span>&nbsp;<span class="comment" id="2356102">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356123">x</span>&nbsp;<span class="op" id="2356125">=</span>&nbsp;<span class="num" id="2356127">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356132">n</span>&nbsp;<span class="op" id="2356134">=</span>&nbsp;<span class="num" id="2356136">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356140">}</span>&nbsp;<span class="keyword" id="2356142">else</span>&nbsp;<span class="op" id="2356147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356152">if</span>&nbsp;<span class="ident" id="2356155">x</span>&nbsp;<span class="op" id="2356157">&lt;</span>&nbsp;<span class="ident" id="2356159">Two52</span>&nbsp;<span class="op" id="2356165">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356171">z</span>&nbsp;<span class="op" id="2356173">=</span>&nbsp;<span class="ident" id="2356175">x</span>&nbsp;<span class="op" id="2356177">+</span>&nbsp;<span class="ident" id="2356179">Two52</span>&nbsp;<span class="comment" id="2356185">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356202">n</span>&nbsp;<span class="op" id="2356204">=</span>&nbsp;<span class="builtintype" id="2356206">int</span><span class="op" id="2356209">(</span><span class="num" id="2356210">1</span>&nbsp;<span class="op" id="2356212">&amp;</span>&nbsp;<span class="ident" id="2356214">Float64bits</span><span class="op" id="2356225">(</span><span class="ident" id="2356226">z</span><span class="op" id="2356227">)</span><span class="op" id="2356228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356233">x</span>&nbsp;<span class="op" id="2356235">=</span>&nbsp;<span class="builtintype" id="2356237">float64</span><span class="op" id="2356244">(</span><span class="ident" id="2356245">n</span><span class="op" id="2356246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356251">n</span>&nbsp;<span class="op" id="2356253">&lt;&lt;=</span>&nbsp;<span class="num" id="2356257">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356267">switch</span>&nbsp;<span class="ident" id="2356274">n</span>&nbsp;<span class="op" id="2356276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356279">case</span>&nbsp;<span class="num" id="2356284">0</span><span class="op" id="2356285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356289">x</span>&nbsp;<span class="op" id="2356291">=</span>&nbsp;<span class="ident" id="2356293">Sin</span><span class="op" id="2356296">(</span><span class="ident" id="2356297">Pi</span>&nbsp;<span class="op" id="2356300">*</span>&nbsp;<span class="ident" id="2356302">x</span><span class="op" id="2356303">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356306">case</span>&nbsp;<span class="num" id="2356311">1</span><span class="op" id="2356312">,</span>&nbsp;<span class="num" id="2356314">2</span><span class="op" id="2356315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356319">x</span>&nbsp;<span class="op" id="2356321">=</span>&nbsp;<span class="ident" id="2356323">Cos</span><span class="op" id="2356326">(</span><span class="ident" id="2356327">Pi</span>&nbsp;<span class="op" id="2356330">*</span>&nbsp;<span class="op" id="2356332">(</span><span class="num" id="2356333">0.5</span>&nbsp;<span class="op" id="2356337">-</span>&nbsp;<span class="ident" id="2356339">x</span><span class="op" id="2356340">)</span><span class="op" id="2356341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356344">case</span>&nbsp;<span class="num" id="2356349">3</span><span class="op" id="2356350">,</span>&nbsp;<span class="num" id="2356352">4</span><span class="op" id="2356353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356357">x</span>&nbsp;<span class="op" id="2356359">=</span>&nbsp;<span class="ident" id="2356361">Sin</span><span class="op" id="2356364">(</span><span class="ident" id="2356365">Pi</span>&nbsp;<span class="op" id="2356368">*</span>&nbsp;<span class="op" id="2356370">(</span><span class="num" id="2356371">1</span>&nbsp;<span class="op" id="2356373">-</span>&nbsp;<span class="ident" id="2356375">x</span><span class="op" id="2356376">)</span><span class="op" id="2356377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356380">case</span>&nbsp;<span class="num" id="2356385">5</span><span class="op" id="2356386">,</span>&nbsp;<span class="num" id="2356388">6</span><span class="op" id="2356389">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356393">x</span>&nbsp;<span class="op" id="2356395">=</span>&nbsp;<span class="op" id="2356397">-</span><span class="ident" id="2356398">Cos</span><span class="op" id="2356401">(</span><span class="ident" id="2356402">Pi</span>&nbsp;<span class="op" id="2356405">*</span>&nbsp;<span class="op" id="2356407">(</span><span class="ident" id="2356408">x</span>&nbsp;<span class="op" id="2356410">-</span>&nbsp;<span class="num" id="2356412">1.5</span><span class="op" id="2356415">)</span><span class="op" id="2356416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356419">default</span><span class="op" id="2356426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356430">x</span>&nbsp;<span class="op" id="2356432">=</span>&nbsp;<span class="ident" id="2356434">Sin</span><span class="op" id="2356437">(</span><span class="ident" id="2356438">Pi</span>&nbsp;<span class="op" id="2356441">*</span>&nbsp;<span class="op" id="2356443">(</span><span class="ident" id="2356444">x</span>&nbsp;<span class="op" id="2356446">-</span>&nbsp;<span class="num" id="2356448">2</span><span class="op" id="2356449">)</span><span class="op" id="2356450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356456">return</span>&nbsp;<span class="op" id="2356463">-</span><span class="ident" id="2356464">x</span><br>
<span class="lineno">365</span><span class="op" id="2356466">}</span>
</div>
</body>
</html>
