<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6742673">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6742729">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6742783">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6742834">package</span>&nbsp;<span class="ident" id="6742842">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6742847">import</span>&nbsp;<span class="op" id="6742854">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6742857">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6742868">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6742879">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6742890">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6742901">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6742908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6742911">func</span>&nbsp;<span class="ident" id="6742916">TestResolveUDPAddr</span><span class="op" id="6742934">(</span><span class="ident" id="6742935">t</span>&nbsp;<span class="op" id="6742937">*</span><span class="ident" id="6742938">testing</span><span class="op" id="6742945">.</span><span class="ident" id="6742946">T</span><span class="op" id="6742947">)</span>&nbsp;<span class="op" id="6742949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6742952">for</span>&nbsp;<span class="ident" id="6742956">_</span><span class="op" id="6742957">,</span>&nbsp;<span class="ident" id="6742959">tt</span>&nbsp;<span class="op" id="6742962">:=</span>&nbsp;<span class="keyword" id="6742965">range</span>&nbsp;<span class="ident" id="6742971">resolveTCPAddrTests</span>&nbsp;<span class="op" id="6742991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6742995">net</span>&nbsp;<span class="op" id="6742999">:=</span>&nbsp;<span class="ident" id="6743002">strings</span><span class="op" id="6743009">.</span><span class="ident" id="6743010">Replace</span><span class="op" id="6743017">(</span><span class="ident" id="6743018">tt</span><span class="op" id="6743020">.</span><span class="ident" id="6743021">net</span><span class="op" id="6743024">,</span>&nbsp;<span class="string" id="6743026">&#34;tcp&#34;</span><span class="op" id="6743031">,</span>&nbsp;<span class="string" id="6743033">&#34;udp&#34;</span><span class="op" id="6743038">,</span>&nbsp;<span class="op" id="6743040">-</span><span class="num" id="6743041">1</span><span class="op" id="6743042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743046">addr</span><span class="op" id="6743050">,</span>&nbsp;<span class="ident" id="6743052">err</span>&nbsp;<span class="op" id="6743056">:=</span>&nbsp;<span class="ident" id="6743059">ResolveUDPAddr</span><span class="op" id="6743073">(</span><span class="ident" id="6743074">net</span><span class="op" id="6743077">,</span>&nbsp;<span class="ident" id="6743079">tt</span><span class="op" id="6743081">.</span><span class="ident" id="6743082">litAddrOrName</span><span class="op" id="6743095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743099">if</span>&nbsp;<span class="ident" id="6743102">err</span>&nbsp;<span class="op" id="6743106">!=</span>&nbsp;<span class="ident" id="6743109">tt</span><span class="op" id="6743111">.</span><span class="ident" id="6743112">err</span>&nbsp;<span class="op" id="6743116">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743121">t</span><span class="op" id="6743122">.</span><span class="ident" id="6743123">Fatalf</span><span class="op" id="6743129">(</span><span class="string" id="6743130">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743165">,</span>&nbsp;<span class="ident" id="6743167">net</span><span class="op" id="6743170">,</span>&nbsp;<span class="ident" id="6743172">tt</span><span class="op" id="6743174">.</span><span class="ident" id="6743175">litAddrOrName</span><span class="op" id="6743188">,</span>&nbsp;<span class="ident" id="6743190">err</span><span class="op" id="6743193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743201">if</span>&nbsp;<span class="op" id="6743204">!</span><span class="ident" id="6743205">reflect</span><span class="op" id="6743212">.</span><span class="ident" id="6743213">DeepEqual</span><span class="op" id="6743222">(</span><span class="ident" id="6743223">addr</span><span class="op" id="6743227">,</span>&nbsp;<span class="op" id="6743229">(</span><span class="op" id="6743230">*</span><span class="ident" id="6743231">UDPAddr</span><span class="op" id="6743238">)</span><span class="op" id="6743239">(</span><span class="ident" id="6743240">tt</span><span class="op" id="6743242">.</span><span class="ident" id="6743243">addr</span><span class="op" id="6743247">)</span><span class="op" id="6743248">)</span>&nbsp;<span class="op" id="6743250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743255">t</span><span class="op" id="6743256">.</span><span class="ident" id="6743257">Fatalf</span><span class="op" id="6743263">(</span><span class="string" id="6743264">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6743304">,</span>&nbsp;<span class="ident" id="6743306">net</span><span class="op" id="6743309">,</span>&nbsp;<span class="ident" id="6743311">tt</span><span class="op" id="6743313">.</span><span class="ident" id="6743314">litAddrOrName</span><span class="op" id="6743327">,</span>&nbsp;<span class="ident" id="6743329">addr</span><span class="op" id="6743333">,</span>&nbsp;<span class="ident" id="6743335">tt</span><span class="op" id="6743337">.</span><span class="ident" id="6743338">addr</span><span class="op" id="6743342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743346">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743350">if</span>&nbsp;<span class="ident" id="6743353">err</span>&nbsp;<span class="op" id="6743357">==</span>&nbsp;<span class="ident" id="6743360">nil</span>&nbsp;<span class="op" id="6743364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743369">str</span>&nbsp;<span class="op" id="6743373">:=</span>&nbsp;<span class="ident" id="6743376">addr</span><span class="op" id="6743380">.</span><span class="ident" id="6743381">String</span><span class="op" id="6743387">(</span><span class="op" id="6743388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743393">addr1</span><span class="op" id="6743398">,</span>&nbsp;<span class="ident" id="6743400">err</span>&nbsp;<span class="op" id="6743404">:=</span>&nbsp;<span class="ident" id="6743407">ResolveUDPAddr</span><span class="op" id="6743421">(</span><span class="ident" id="6743422">net</span><span class="op" id="6743425">,</span>&nbsp;<span class="ident" id="6743427">str</span><span class="op" id="6743430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743435">if</span>&nbsp;<span class="ident" id="6743438">err</span>&nbsp;<span class="op" id="6743442">!=</span>&nbsp;<span class="ident" id="6743445">nil</span>&nbsp;<span class="op" id="6743449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743455">t</span><span class="op" id="6743456">.</span><span class="ident" id="6743457">Fatalf</span><span class="op" id="6743463">(</span><span class="string" id="6743464">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="6743502">,</span>&nbsp;<span class="ident" id="6743504">net</span><span class="op" id="6743507">,</span>&nbsp;<span class="ident" id="6743509">str</span><span class="op" id="6743512">,</span>&nbsp;<span class="ident" id="6743514">tt</span><span class="op" id="6743516">.</span><span class="ident" id="6743517">litAddrOrName</span><span class="op" id="6743530">,</span>&nbsp;<span class="ident" id="6743532">err</span><span class="op" id="6743535">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743545">if</span>&nbsp;<span class="op" id="6743548">!</span><span class="ident" id="6743549">reflect</span><span class="op" id="6743556">.</span><span class="ident" id="6743557">DeepEqual</span><span class="op" id="6743566">(</span><span class="ident" id="6743567">addr1</span><span class="op" id="6743572">,</span>&nbsp;<span class="ident" id="6743574">addr</span><span class="op" id="6743578">)</span>&nbsp;<span class="op" id="6743580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743586">t</span><span class="op" id="6743587">.</span><span class="ident" id="6743588">Fatalf</span><span class="op" id="6743594">(</span><span class="string" id="6743595">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6743645">,</span>&nbsp;<span class="ident" id="6743647">net</span><span class="op" id="6743650">,</span>&nbsp;<span class="ident" id="6743652">str</span><span class="op" id="6743655">,</span>&nbsp;<span class="ident" id="6743657">tt</span><span class="op" id="6743659">.</span><span class="ident" id="6743660">litAddrOrName</span><span class="op" id="6743673">,</span>&nbsp;<span class="ident" id="6743675">addr1</span><span class="op" id="6743680">,</span>&nbsp;<span class="ident" id="6743682">addr</span><span class="op" id="6743686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743695">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743698">}</span><br>
<span class="lineno"></span><span class="op" id="6743700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6743703">func</span>&nbsp;<span class="ident" id="6743708">TestReadFromUDP</span><span class="op" id="6743723">(</span><span class="ident" id="6743724">t</span>&nbsp;<span class="op" id="6743726">*</span><span class="ident" id="6743727">testing</span><span class="op" id="6743734">.</span><span class="ident" id="6743735">T</span><span class="op" id="6743736">)</span>&nbsp;<span class="op" id="6743738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743741">switch</span>&nbsp;<span class="ident" id="6743748">runtime</span><span class="op" id="6743755">.</span><span class="ident" id="6743756">GOOS</span>&nbsp;<span class="op" id="6743761">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743764">case</span>&nbsp;<span class="string" id="6743769">&#34;nacl&#34;</span><span class="op" id="6743775">,</span>&nbsp;<span class="string" id="6743777">&#34;plan9&#34;</span><span class="op" id="6743784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743788">t</span><span class="op" id="6743789">.</span><span class="ident" id="6743790">Skipf</span><span class="op" id="6743795">(</span><span class="string" id="6743796">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="6743833">,</span>&nbsp;<span class="ident" id="6743835">runtime</span><span class="op" id="6743842">.</span><span class="ident" id="6743843">GOOS</span><span class="op" id="6743847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743854">ra</span><span class="op" id="6743856">,</span>&nbsp;<span class="ident" id="6743858">err</span>&nbsp;<span class="op" id="6743862">:=</span>&nbsp;<span class="ident" id="6743865">ResolveUDPAddr</span><span class="op" id="6743879">(</span><span class="string" id="6743880">&#34;udp&#34;</span><span class="op" id="6743885">,</span>&nbsp;<span class="string" id="6743887">&#34;127.0.0.1:7&#34;</span><span class="op" id="6743900">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743903">if</span>&nbsp;<span class="ident" id="6743906">err</span>&nbsp;<span class="op" id="6743910">!=</span>&nbsp;<span class="ident" id="6743913">nil</span>&nbsp;<span class="op" id="6743917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743921">t</span><span class="op" id="6743922">.</span><span class="ident" id="6743923">Fatal</span><span class="op" id="6743928">(</span><span class="ident" id="6743929">err</span><span class="op" id="6743932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6743935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6743939">la</span><span class="op" id="6743941">,</span>&nbsp;<span class="ident" id="6743943">err</span>&nbsp;<span class="op" id="6743947">:=</span>&nbsp;<span class="ident" id="6743950">ResolveUDPAddr</span><span class="op" id="6743964">(</span><span class="string" id="6743965">&#34;udp&#34;</span><span class="op" id="6743970">,</span>&nbsp;<span class="string" id="6743972">&#34;127.0.0.1:0&#34;</span><span class="op" id="6743985">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6743988">if</span>&nbsp;<span class="ident" id="6743991">err</span>&nbsp;<span class="op" id="6743995">!=</span>&nbsp;<span class="ident" id="6743998">nil</span>&nbsp;<span class="op" id="6744002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744006">t</span><span class="op" id="6744007">.</span><span class="ident" id="6744008">Fatal</span><span class="op" id="6744013">(</span><span class="ident" id="6744014">err</span><span class="op" id="6744017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744024">c</span><span class="op" id="6744025">,</span>&nbsp;<span class="ident" id="6744027">err</span>&nbsp;<span class="op" id="6744031">:=</span>&nbsp;<span class="ident" id="6744034">ListenUDP</span><span class="op" id="6744043">(</span><span class="string" id="6744044">&#34;udp&#34;</span><span class="op" id="6744049">,</span>&nbsp;<span class="ident" id="6744051">la</span><span class="op" id="6744053">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744056">if</span>&nbsp;<span class="ident" id="6744059">err</span>&nbsp;<span class="op" id="6744063">!=</span>&nbsp;<span class="ident" id="6744066">nil</span>&nbsp;<span class="op" id="6744070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744074">t</span><span class="op" id="6744075">.</span><span class="ident" id="6744076">Fatal</span><span class="op" id="6744081">(</span><span class="ident" id="6744082">err</span><span class="op" id="6744085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744091">defer</span>&nbsp;<span class="ident" id="6744097">c</span><span class="op" id="6744098">.</span><span class="ident" id="6744099">Close</span><span class="op" id="6744104">(</span><span class="op" id="6744105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744109">_</span><span class="op" id="6744110">,</span>&nbsp;<span class="ident" id="6744112">err</span>&nbsp;<span class="op" id="6744116">=</span>&nbsp;<span class="ident" id="6744118">c</span><span class="op" id="6744119">.</span><span class="ident" id="6744120">WriteToUDP</span><span class="op" id="6744130">(</span><span class="op" id="6744131">[</span><span class="op" id="6744132">]</span><span class="builtintype" id="6744133">byte</span><span class="op" id="6744137">(</span><span class="string" id="6744138">&#34;a&#34;</span><span class="op" id="6744141">)</span><span class="op" id="6744142">,</span>&nbsp;<span class="ident" id="6744144">ra</span><span class="op" id="6744146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744149">if</span>&nbsp;<span class="ident" id="6744152">err</span>&nbsp;<span class="op" id="6744156">!=</span>&nbsp;<span class="ident" id="6744159">nil</span>&nbsp;<span class="op" id="6744163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744167">t</span><span class="op" id="6744168">.</span><span class="ident" id="6744169">Fatal</span><span class="op" id="6744174">(</span><span class="ident" id="6744175">err</span><span class="op" id="6744178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744185">err</span>&nbsp;<span class="op" id="6744189">=</span>&nbsp;<span class="ident" id="6744191">c</span><span class="op" id="6744192">.</span><span class="ident" id="6744193">SetDeadline</span><span class="op" id="6744204">(</span><span class="ident" id="6744205">time</span><span class="op" id="6744209">.</span><span class="ident" id="6744210">Now</span><span class="op" id="6744213">(</span><span class="op" id="6744214">)</span><span class="op" id="6744215">.</span><span class="ident" id="6744216">Add</span><span class="op" id="6744219">(</span><span class="num" id="6744220">100</span>&nbsp;<span class="op" id="6744224">*</span>&nbsp;<span class="ident" id="6744226">time</span><span class="op" id="6744230">.</span><span class="ident" id="6744231">Millisecond</span><span class="op" id="6744242">)</span><span class="op" id="6744243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744246">if</span>&nbsp;<span class="ident" id="6744249">err</span>&nbsp;<span class="op" id="6744253">!=</span>&nbsp;<span class="ident" id="6744256">nil</span>&nbsp;<span class="op" id="6744260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744264">t</span><span class="op" id="6744265">.</span><span class="ident" id="6744266">Fatal</span><span class="op" id="6744271">(</span><span class="ident" id="6744272">err</span><span class="op" id="6744275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744281">b</span>&nbsp;<span class="op" id="6744283">:=</span>&nbsp;<span class="builtinfunc" id="6744286">make</span><span class="op" id="6744290">(</span><span class="op" id="6744291">[</span><span class="op" id="6744292">]</span><span class="builtintype" id="6744293">byte</span><span class="op" id="6744297">,</span>&nbsp;<span class="num" id="6744299">1</span><span class="op" id="6744300">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744303">_</span><span class="op" id="6744304">,</span>&nbsp;<span class="ident" id="6744306">_</span><span class="op" id="6744307">,</span>&nbsp;<span class="ident" id="6744309">err</span>&nbsp;<span class="op" id="6744313">=</span>&nbsp;<span class="ident" id="6744315">c</span><span class="op" id="6744316">.</span><span class="ident" id="6744317">ReadFromUDP</span><span class="op" id="6744328">(</span><span class="ident" id="6744329">b</span><span class="op" id="6744330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744333">if</span>&nbsp;<span class="ident" id="6744336">err</span>&nbsp;<span class="op" id="6744340">==</span>&nbsp;<span class="ident" id="6744343">nil</span>&nbsp;<span class="op" id="6744347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744351">t</span><span class="op" id="6744352">.</span><span class="ident" id="6744353">Fatal</span><span class="op" id="6744358">(</span><span class="string" id="6744359">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6744384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744387">}</span>&nbsp;<span class="keyword" id="6744389">else</span>&nbsp;<span class="keyword" id="6744394">if</span>&nbsp;<span class="op" id="6744397">!</span><span class="ident" id="6744398">isTimeout</span><span class="op" id="6744407">(</span><span class="ident" id="6744408">err</span><span class="op" id="6744411">)</span>&nbsp;<span class="op" id="6744413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744417">t</span><span class="op" id="6744418">.</span><span class="ident" id="6744419">Fatal</span><span class="op" id="6744424">(</span><span class="ident" id="6744425">err</span><span class="op" id="6744428">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744431">}</span><br>
<span class="lineno"></span><span class="op" id="6744433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6744436">func</span>&nbsp;<span class="ident" id="6744441">TestWriteToUDP</span><span class="op" id="6744455">(</span><span class="ident" id="6744456">t</span>&nbsp;<span class="op" id="6744458">*</span><span class="ident" id="6744459">testing</span><span class="op" id="6744466">.</span><span class="ident" id="6744467">T</span><span class="op" id="6744468">)</span>&nbsp;<span class="op" id="6744470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744473">switch</span>&nbsp;<span class="ident" id="6744480">runtime</span><span class="op" id="6744487">.</span><span class="ident" id="6744488">GOOS</span>&nbsp;<span class="op" id="6744493">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744496">case</span>&nbsp;<span class="string" id="6744501">&#34;plan9&#34;</span><span class="op" id="6744508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744512">t</span><span class="op" id="6744513">.</span><span class="ident" id="6744514">Skipf</span><span class="op" id="6744519">(</span><span class="string" id="6744520">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6744541">,</span>&nbsp;<span class="ident" id="6744543">runtime</span><span class="op" id="6744550">.</span><span class="ident" id="6744551">GOOS</span><span class="op" id="6744555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744562">l</span><span class="op" id="6744563">,</span>&nbsp;<span class="ident" id="6744565">err</span>&nbsp;<span class="op" id="6744569">:=</span>&nbsp;<span class="ident" id="6744572">ListenPacket</span><span class="op" id="6744584">(</span><span class="string" id="6744585">&#34;udp&#34;</span><span class="op" id="6744590">,</span>&nbsp;<span class="string" id="6744592">&#34;127.0.0.1:0&#34;</span><span class="op" id="6744605">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744608">if</span>&nbsp;<span class="ident" id="6744611">err</span>&nbsp;<span class="op" id="6744615">!=</span>&nbsp;<span class="ident" id="6744618">nil</span>&nbsp;<span class="op" id="6744622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744626">t</span><span class="op" id="6744627">.</span><span class="ident" id="6744628">Fatalf</span><span class="op" id="6744634">(</span><span class="string" id="6744635">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744654">,</span>&nbsp;<span class="ident" id="6744656">err</span><span class="op" id="6744659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744665">defer</span>&nbsp;<span class="ident" id="6744671">l</span><span class="op" id="6744672">.</span><span class="ident" id="6744673">Close</span><span class="op" id="6744678">(</span><span class="op" id="6744679">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744683">testWriteToConn</span><span class="op" id="6744698">(</span><span class="ident" id="6744699">t</span><span class="op" id="6744700">,</span>&nbsp;<span class="ident" id="6744702">l</span><span class="op" id="6744703">.</span><span class="ident" id="6744704">LocalAddr</span><span class="op" id="6744713">(</span><span class="op" id="6744714">)</span><span class="op" id="6744715">.</span><span class="ident" id="6744716">String</span><span class="op" id="6744722">(</span><span class="op" id="6744723">)</span><span class="op" id="6744724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744727">testWriteToPacketConn</span><span class="op" id="6744748">(</span><span class="ident" id="6744749">t</span><span class="op" id="6744750">,</span>&nbsp;<span class="ident" id="6744752">l</span><span class="op" id="6744753">.</span><span class="ident" id="6744754">LocalAddr</span><span class="op" id="6744763">(</span><span class="op" id="6744764">)</span><span class="op" id="6744765">.</span><span class="ident" id="6744766">String</span><span class="op" id="6744772">(</span><span class="op" id="6744773">)</span><span class="op" id="6744774">)</span><br>
<span class="lineno"></span><span class="op" id="6744776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6744779">func</span>&nbsp;<span class="ident" id="6744784">testWriteToConn</span><span class="op" id="6744799">(</span><span class="ident" id="6744800">t</span>&nbsp;<span class="op" id="6744802">*</span><span class="ident" id="6744803">testing</span><span class="op" id="6744810">.</span><span class="ident" id="6744811">T</span><span class="op" id="6744812">,</span>&nbsp;<span class="ident" id="6744814">raddr</span>&nbsp;<span class="builtintype" id="6744820">string</span><span class="op" id="6744826">)</span>&nbsp;<span class="op" id="6744828">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744831">c</span><span class="op" id="6744832">,</span>&nbsp;<span class="ident" id="6744834">err</span>&nbsp;<span class="op" id="6744838">:=</span>&nbsp;<span class="ident" id="6744841">Dial</span><span class="op" id="6744845">(</span><span class="string" id="6744846">&#34;udp&#34;</span><span class="op" id="6744851">,</span>&nbsp;<span class="ident" id="6744853">raddr</span><span class="op" id="6744858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744861">if</span>&nbsp;<span class="ident" id="6744864">err</span>&nbsp;<span class="op" id="6744868">!=</span>&nbsp;<span class="ident" id="6744871">nil</span>&nbsp;<span class="op" id="6744875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744879">t</span><span class="op" id="6744880">.</span><span class="ident" id="6744881">Fatalf</span><span class="op" id="6744887">(</span><span class="string" id="6744888">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744905">,</span>&nbsp;<span class="ident" id="6744907">err</span><span class="op" id="6744910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6744913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744916">defer</span>&nbsp;<span class="ident" id="6744922">c</span><span class="op" id="6744923">.</span><span class="ident" id="6744924">Close</span><span class="op" id="6744929">(</span><span class="op" id="6744930">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744934">ra</span><span class="op" id="6744936">,</span>&nbsp;<span class="ident" id="6744938">err</span>&nbsp;<span class="op" id="6744942">:=</span>&nbsp;<span class="ident" id="6744945">ResolveUDPAddr</span><span class="op" id="6744959">(</span><span class="string" id="6744960">&#34;udp&#34;</span><span class="op" id="6744965">,</span>&nbsp;<span class="ident" id="6744967">raddr</span><span class="op" id="6744972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6744975">if</span>&nbsp;<span class="ident" id="6744978">err</span>&nbsp;<span class="op" id="6744982">!=</span>&nbsp;<span class="ident" id="6744985">nil</span>&nbsp;<span class="op" id="6744989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6744993">t</span><span class="op" id="6744994">.</span><span class="ident" id="6744995">Fatalf</span><span class="op" id="6745001">(</span><span class="string" id="6745002">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745029">,</span>&nbsp;<span class="ident" id="6745031">err</span><span class="op" id="6745034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745037">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745041">_</span><span class="op" id="6745042">,</span>&nbsp;<span class="ident" id="6745044">err</span>&nbsp;<span class="op" id="6745048">=</span>&nbsp;<span class="ident" id="6745050">c</span><span class="op" id="6745051">.</span><span class="op" id="6745052">(</span><span class="op" id="6745053">*</span><span class="ident" id="6745054">UDPConn</span><span class="op" id="6745061">)</span><span class="op" id="6745062">.</span><span class="ident" id="6745063">WriteToUDP</span><span class="op" id="6745073">(</span><span class="op" id="6745074">[</span><span class="op" id="6745075">]</span><span class="builtintype" id="6745076">byte</span><span class="op" id="6745080">(</span><span class="string" id="6745081">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6745114">)</span><span class="op" id="6745115">,</span>&nbsp;<span class="ident" id="6745117">ra</span><span class="op" id="6745119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745122">if</span>&nbsp;<span class="ident" id="6745125">err</span>&nbsp;<span class="op" id="6745129">==</span>&nbsp;<span class="ident" id="6745132">nil</span>&nbsp;<span class="op" id="6745136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745140">t</span><span class="op" id="6745141">.</span><span class="ident" id="6745142">Fatal</span><span class="op" id="6745147">(</span><span class="string" id="6745148">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6745172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745175">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745178">if</span>&nbsp;<span class="ident" id="6745181">err</span>&nbsp;<span class="op" id="6745185">!=</span>&nbsp;<span class="ident" id="6745188">nil</span>&nbsp;<span class="op" id="6745192">&amp;&amp;</span>&nbsp;<span class="ident" id="6745195">err</span><span class="op" id="6745198">.</span><span class="op" id="6745199">(</span><span class="op" id="6745200">*</span><span class="ident" id="6745201">OpError</span><span class="op" id="6745208">)</span><span class="op" id="6745209">.</span><span class="ident" id="6745210">Err</span>&nbsp;<span class="op" id="6745214">!=</span>&nbsp;<span class="ident" id="6745217">ErrWriteToConnected</span>&nbsp;<span class="op" id="6745237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745241">t</span><span class="op" id="6745242">.</span><span class="ident" id="6745243">Fatalf</span><span class="op" id="6745249">(</span><span class="string" id="6745250">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6745301">,</span>&nbsp;<span class="ident" id="6745303">err</span><span class="op" id="6745306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745313">_</span><span class="op" id="6745314">,</span>&nbsp;<span class="ident" id="6745316">err</span>&nbsp;<span class="op" id="6745320">=</span>&nbsp;<span class="ident" id="6745322">c</span><span class="op" id="6745323">.</span><span class="op" id="6745324">(</span><span class="op" id="6745325">*</span><span class="ident" id="6745326">UDPConn</span><span class="op" id="6745333">)</span><span class="op" id="6745334">.</span><span class="ident" id="6745335">WriteTo</span><span class="op" id="6745342">(</span><span class="op" id="6745343">[</span><span class="op" id="6745344">]</span><span class="builtintype" id="6745345">byte</span><span class="op" id="6745349">(</span><span class="string" id="6745350">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6745383">)</span><span class="op" id="6745384">,</span>&nbsp;<span class="ident" id="6745386">ra</span><span class="op" id="6745388">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745391">if</span>&nbsp;<span class="ident" id="6745394">err</span>&nbsp;<span class="op" id="6745398">==</span>&nbsp;<span class="ident" id="6745401">nil</span>&nbsp;<span class="op" id="6745405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745409">t</span><span class="op" id="6745410">.</span><span class="ident" id="6745411">Fatal</span><span class="op" id="6745416">(</span><span class="string" id="6745417">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6745438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745444">if</span>&nbsp;<span class="ident" id="6745447">err</span>&nbsp;<span class="op" id="6745451">!=</span>&nbsp;<span class="ident" id="6745454">nil</span>&nbsp;<span class="op" id="6745458">&amp;&amp;</span>&nbsp;<span class="ident" id="6745461">err</span><span class="op" id="6745464">.</span><span class="op" id="6745465">(</span><span class="op" id="6745466">*</span><span class="ident" id="6745467">OpError</span><span class="op" id="6745474">)</span><span class="op" id="6745475">.</span><span class="ident" id="6745476">Err</span>&nbsp;<span class="op" id="6745480">!=</span>&nbsp;<span class="ident" id="6745483">ErrWriteToConnected</span>&nbsp;<span class="op" id="6745503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745507">t</span><span class="op" id="6745508">.</span><span class="ident" id="6745509">Fatalf</span><span class="op" id="6745515">(</span><span class="string" id="6745516">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6745564">,</span>&nbsp;<span class="ident" id="6745566">err</span><span class="op" id="6745569">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745576">_</span><span class="op" id="6745577">,</span>&nbsp;<span class="ident" id="6745579">err</span>&nbsp;<span class="op" id="6745583">=</span>&nbsp;<span class="ident" id="6745585">c</span><span class="op" id="6745586">.</span><span class="ident" id="6745587">Write</span><span class="op" id="6745592">(</span><span class="op" id="6745593">[</span><span class="op" id="6745594">]</span><span class="builtintype" id="6745595">byte</span><span class="op" id="6745599">(</span><span class="string" id="6745600">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6745633">)</span><span class="op" id="6745634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745637">if</span>&nbsp;<span class="ident" id="6745640">err</span>&nbsp;<span class="op" id="6745644">!=</span>&nbsp;<span class="ident" id="6745647">nil</span>&nbsp;<span class="op" id="6745651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745655">t</span><span class="op" id="6745656">.</span><span class="ident" id="6745657">Fatalf</span><span class="op" id="6745663">(</span><span class="string" id="6745664">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745682">,</span>&nbsp;<span class="ident" id="6745684">err</span><span class="op" id="6745687">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745690">}</span><br>
<span class="lineno"></span><span class="op" id="6745692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6745695">func</span>&nbsp;<span class="ident" id="6745700">testWriteToPacketConn</span><span class="op" id="6745721">(</span><span class="ident" id="6745722">t</span>&nbsp;<span class="op" id="6745724">*</span><span class="ident" id="6745725">testing</span><span class="op" id="6745732">.</span><span class="ident" id="6745733">T</span><span class="op" id="6745734">,</span>&nbsp;<span class="ident" id="6745736">raddr</span>&nbsp;<span class="builtintype" id="6745742">string</span><span class="op" id="6745748">)</span>&nbsp;<span class="op" id="6745750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745753">c</span><span class="op" id="6745754">,</span>&nbsp;<span class="ident" id="6745756">err</span>&nbsp;<span class="op" id="6745760">:=</span>&nbsp;<span class="ident" id="6745763">ListenPacket</span><span class="op" id="6745775">(</span><span class="string" id="6745776">&#34;udp&#34;</span><span class="op" id="6745781">,</span>&nbsp;<span class="string" id="6745783">&#34;127.0.0.1:0&#34;</span><span class="op" id="6745796">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745799">if</span>&nbsp;<span class="ident" id="6745802">err</span>&nbsp;<span class="op" id="6745806">!=</span>&nbsp;<span class="ident" id="6745809">nil</span>&nbsp;<span class="op" id="6745813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745817">t</span><span class="op" id="6745818">.</span><span class="ident" id="6745819">Fatalf</span><span class="op" id="6745825">(</span><span class="string" id="6745826">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745851">,</span>&nbsp;<span class="ident" id="6745853">err</span><span class="op" id="6745856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745862">defer</span>&nbsp;<span class="ident" id="6745868">c</span><span class="op" id="6745869">.</span><span class="ident" id="6745870">Close</span><span class="op" id="6745875">(</span><span class="op" id="6745876">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745880">ra</span><span class="op" id="6745882">,</span>&nbsp;<span class="ident" id="6745884">err</span>&nbsp;<span class="op" id="6745888">:=</span>&nbsp;<span class="ident" id="6745891">ResolveUDPAddr</span><span class="op" id="6745905">(</span><span class="string" id="6745906">&#34;udp&#34;</span><span class="op" id="6745911">,</span>&nbsp;<span class="ident" id="6745913">raddr</span><span class="op" id="6745918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6745921">if</span>&nbsp;<span class="ident" id="6745924">err</span>&nbsp;<span class="op" id="6745928">!=</span>&nbsp;<span class="ident" id="6745931">nil</span>&nbsp;<span class="op" id="6745935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745939">t</span><span class="op" id="6745940">.</span><span class="ident" id="6745941">Fatalf</span><span class="op" id="6745947">(</span><span class="string" id="6745948">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745975">,</span>&nbsp;<span class="ident" id="6745977">err</span><span class="op" id="6745980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6745983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6745987">_</span><span class="op" id="6745988">,</span>&nbsp;<span class="ident" id="6745990">err</span>&nbsp;<span class="op" id="6745994">=</span>&nbsp;<span class="ident" id="6745996">c</span><span class="op" id="6745997">.</span><span class="op" id="6745998">(</span><span class="op" id="6745999">*</span><span class="ident" id="6746000">UDPConn</span><span class="op" id="6746007">)</span><span class="op" id="6746008">.</span><span class="ident" id="6746009">WriteToUDP</span><span class="op" id="6746019">(</span><span class="op" id="6746020">[</span><span class="op" id="6746021">]</span><span class="builtintype" id="6746022">byte</span><span class="op" id="6746026">(</span><span class="string" id="6746027">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6746056">)</span><span class="op" id="6746057">,</span>&nbsp;<span class="ident" id="6746059">ra</span><span class="op" id="6746061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746064">if</span>&nbsp;<span class="ident" id="6746067">err</span>&nbsp;<span class="op" id="6746071">!=</span>&nbsp;<span class="ident" id="6746074">nil</span>&nbsp;<span class="op" id="6746078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746082">t</span><span class="op" id="6746083">.</span><span class="ident" id="6746084">Fatalf</span><span class="op" id="6746090">(</span><span class="string" id="6746091">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746114">,</span>&nbsp;<span class="ident" id="6746116">err</span><span class="op" id="6746119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746126">_</span><span class="op" id="6746127">,</span>&nbsp;<span class="ident" id="6746129">err</span>&nbsp;<span class="op" id="6746133">=</span>&nbsp;<span class="ident" id="6746135">c</span><span class="op" id="6746136">.</span><span class="ident" id="6746137">WriteTo</span><span class="op" id="6746144">(</span><span class="op" id="6746145">[</span><span class="op" id="6746146">]</span><span class="builtintype" id="6746147">byte</span><span class="op" id="6746151">(</span><span class="string" id="6746152">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6746181">)</span><span class="op" id="6746182">,</span>&nbsp;<span class="ident" id="6746184">ra</span><span class="op" id="6746186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746189">if</span>&nbsp;<span class="ident" id="6746192">err</span>&nbsp;<span class="op" id="6746196">!=</span>&nbsp;<span class="ident" id="6746199">nil</span>&nbsp;<span class="op" id="6746203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746207">t</span><span class="op" id="6746208">.</span><span class="ident" id="6746209">Fatalf</span><span class="op" id="6746215">(</span><span class="string" id="6746216">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746236">,</span>&nbsp;<span class="ident" id="6746238">err</span><span class="op" id="6746241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746248">_</span><span class="op" id="6746249">,</span>&nbsp;<span class="ident" id="6746251">err</span>&nbsp;<span class="op" id="6746255">=</span>&nbsp;<span class="ident" id="6746257">c</span><span class="op" id="6746258">.</span><span class="op" id="6746259">(</span><span class="op" id="6746260">*</span><span class="ident" id="6746261">UDPConn</span><span class="op" id="6746268">)</span><span class="op" id="6746269">.</span><span class="ident" id="6746270">Write</span><span class="op" id="6746275">(</span><span class="op" id="6746276">[</span><span class="op" id="6746277">]</span><span class="builtintype" id="6746278">byte</span><span class="op" id="6746282">(</span><span class="string" id="6746283">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6746312">)</span><span class="op" id="6746313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746316">if</span>&nbsp;<span class="ident" id="6746319">err</span>&nbsp;<span class="op" id="6746323">==</span>&nbsp;<span class="ident" id="6746326">nil</span>&nbsp;<span class="op" id="6746330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746334">t</span><span class="op" id="6746335">.</span><span class="ident" id="6746336">Fatal</span><span class="op" id="6746341">(</span><span class="string" id="6746342">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6746361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746364">}</span><br>
<span class="lineno"></span><span class="op" id="6746366">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6746369">var</span>&nbsp;<span class="ident" id="6746373">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6746395">=</span>&nbsp;<span class="op" id="6746397">[</span><span class="op" id="6746398">]</span><span class="keyword" id="6746399">struct</span>&nbsp;<span class="op" id="6746406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746409">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6746415">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746423">laddr</span>&nbsp;<span class="op" id="6746429">*</span><span class="ident" id="6746430">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="6746438">}</span><span class="op" id="6746439">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746442">{</span><span class="string" id="6746443">&#34;udp4&#34;</span><span class="op" id="6746449">,</span>&nbsp;<span class="op" id="6746451">&amp;</span><span class="ident" id="6746452">UDPAddr</span><span class="op" id="6746459">{</span><span class="ident" id="6746460">IP</span><span class="op" id="6746462">:</span>&nbsp;<span class="ident" id="6746464">IPv4</span><span class="op" id="6746468">(</span><span class="num" id="6746469">127</span><span class="op" id="6746472">,</span>&nbsp;<span class="num" id="6746474">0</span><span class="op" id="6746475">,</span>&nbsp;<span class="num" id="6746477">0</span><span class="op" id="6746478">,</span>&nbsp;<span class="num" id="6746480">1</span><span class="op" id="6746481">)</span><span class="op" id="6746482">}</span><span class="op" id="6746483">}</span><span class="op" id="6746484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746487">{</span><span class="string" id="6746488">&#34;udp4&#34;</span><span class="op" id="6746494">,</span>&nbsp;<span class="op" id="6746496">&amp;</span><span class="ident" id="6746497">UDPAddr</span><span class="op" id="6746504">{</span><span class="op" id="6746505">}</span><span class="op" id="6746506">}</span><span class="op" id="6746507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746510">{</span><span class="string" id="6746511">&#34;udp4&#34;</span><span class="op" id="6746517">,</span>&nbsp;<span class="ident" id="6746519">nil</span><span class="op" id="6746522">}</span><span class="op" id="6746523">,</span><br>
<span class="lineno"></span><span class="op" id="6746525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6746528">func</span>&nbsp;<span class="ident" id="6746533">TestUDPConnLocalName</span><span class="op" id="6746553">(</span><span class="ident" id="6746554">t</span>&nbsp;<span class="op" id="6746556">*</span><span class="ident" id="6746557">testing</span><span class="op" id="6746564">.</span><span class="ident" id="6746565">T</span><span class="op" id="6746566">)</span>&nbsp;<span class="op" id="6746568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746571">if</span>&nbsp;<span class="ident" id="6746574">testing</span><span class="op" id="6746581">.</span><span class="ident" id="6746582">Short</span><span class="op" id="6746587">(</span><span class="op" id="6746588">)</span>&nbsp;<span class="op" id="6746590">||</span>&nbsp;<span class="op" id="6746593">!</span><span class="op" id="6746594">*</span><span class="ident" id="6746595">testExternal</span>&nbsp;<span class="op" id="6746608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746612">t</span><span class="op" id="6746613">.</span><span class="ident" id="6746614">Skip</span><span class="op" id="6746618">(</span><span class="string" id="6746619">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6746660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746667">for</span>&nbsp;<span class="ident" id="6746671">_</span><span class="op" id="6746672">,</span>&nbsp;<span class="ident" id="6746674">tt</span>&nbsp;<span class="op" id="6746677">:=</span>&nbsp;<span class="keyword" id="6746680">range</span>&nbsp;<span class="ident" id="6746686">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6746708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746712">c</span><span class="op" id="6746713">,</span>&nbsp;<span class="ident" id="6746715">err</span>&nbsp;<span class="op" id="6746719">:=</span>&nbsp;<span class="ident" id="6746722">ListenUDP</span><span class="op" id="6746731">(</span><span class="ident" id="6746732">tt</span><span class="op" id="6746734">.</span><span class="ident" id="6746735">net</span><span class="op" id="6746738">,</span>&nbsp;<span class="ident" id="6746740">tt</span><span class="op" id="6746742">.</span><span class="ident" id="6746743">laddr</span><span class="op" id="6746748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746752">if</span>&nbsp;<span class="ident" id="6746755">err</span>&nbsp;<span class="op" id="6746759">!=</span>&nbsp;<span class="ident" id="6746762">nil</span>&nbsp;<span class="op" id="6746766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746771">t</span><span class="op" id="6746772">.</span><span class="ident" id="6746773">Fatalf</span><span class="op" id="6746779">(</span><span class="string" id="6746780">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746802">,</span>&nbsp;<span class="ident" id="6746804">err</span><span class="op" id="6746807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746811">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746815">defer</span>&nbsp;<span class="ident" id="6746821">c</span><span class="op" id="6746822">.</span><span class="ident" id="6746823">Close</span><span class="op" id="6746828">(</span><span class="op" id="6746829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746833">la</span>&nbsp;<span class="op" id="6746836">:=</span>&nbsp;<span class="ident" id="6746839">c</span><span class="op" id="6746840">.</span><span class="ident" id="6746841">LocalAddr</span><span class="op" id="6746850">(</span><span class="op" id="6746851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6746855">if</span>&nbsp;<span class="ident" id="6746858">a</span><span class="op" id="6746859">,</span>&nbsp;<span class="ident" id="6746861">ok</span>&nbsp;<span class="op" id="6746864">:=</span>&nbsp;<span class="ident" id="6746867">la</span><span class="op" id="6746869">.</span><span class="op" id="6746870">(</span><span class="op" id="6746871">*</span><span class="ident" id="6746872">UDPAddr</span><span class="op" id="6746879">)</span><span class="op" id="6746880">;</span>&nbsp;<span class="op" id="6746882">!</span><span class="ident" id="6746883">ok</span>&nbsp;<span class="op" id="6746886">||</span>&nbsp;<span class="ident" id="6746889">a</span><span class="op" id="6746890">.</span><span class="ident" id="6746891">Port</span>&nbsp;<span class="op" id="6746896">==</span>&nbsp;<span class="num" id="6746899">0</span>&nbsp;<span class="op" id="6746901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6746906">t</span><span class="op" id="6746907">.</span><span class="ident" id="6746908">Fatalf</span><span class="op" id="6746914">(</span><span class="string" id="6746915">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6746976">,</span>&nbsp;<span class="ident" id="6746978">la</span><span class="op" id="6746980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746984">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6746987">}</span><br>
<span class="lineno"></span><span class="op" id="6746989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6746992">func</span>&nbsp;<span class="ident" id="6746997">TestUDPConnLocalAndRemoteNames</span><span class="op" id="6747027">(</span><span class="ident" id="6747028">t</span>&nbsp;<span class="op" id="6747030">*</span><span class="ident" id="6747031">testing</span><span class="op" id="6747038">.</span><span class="ident" id="6747039">T</span><span class="op" id="6747040">)</span>&nbsp;<span class="op" id="6747042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747045">for</span>&nbsp;<span class="ident" id="6747049">_</span><span class="op" id="6747050">,</span>&nbsp;<span class="ident" id="6747052">laddr</span>&nbsp;<span class="op" id="6747058">:=</span>&nbsp;<span class="keyword" id="6747061">range</span>&nbsp;<span class="op" id="6747067">[</span><span class="op" id="6747068">]</span><span class="builtintype" id="6747069">string</span><span class="op" id="6747075">{</span><span class="string" id="6747076">&#34;&#34;</span><span class="op" id="6747078">,</span>&nbsp;<span class="string" id="6747080">&#34;127.0.0.1:0&#34;</span><span class="op" id="6747093">}</span>&nbsp;<span class="op" id="6747095">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747099">c1</span><span class="op" id="6747101">,</span>&nbsp;<span class="ident" id="6747103">err</span>&nbsp;<span class="op" id="6747107">:=</span>&nbsp;<span class="ident" id="6747110">ListenPacket</span><span class="op" id="6747122">(</span><span class="string" id="6747123">&#34;udp&#34;</span><span class="op" id="6747128">,</span>&nbsp;<span class="string" id="6747130">&#34;127.0.0.1:0&#34;</span><span class="op" id="6747143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747147">if</span>&nbsp;<span class="ident" id="6747150">err</span>&nbsp;<span class="op" id="6747154">!=</span>&nbsp;<span class="ident" id="6747157">nil</span>&nbsp;<span class="op" id="6747161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747166">t</span><span class="op" id="6747167">.</span><span class="ident" id="6747168">Fatalf</span><span class="op" id="6747174">(</span><span class="string" id="6747175">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747197">,</span>&nbsp;<span class="ident" id="6747199">err</span><span class="op" id="6747202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747210">defer</span>&nbsp;<span class="ident" id="6747216">c1</span><span class="op" id="6747218">.</span><span class="ident" id="6747219">Close</span><span class="op" id="6747224">(</span><span class="op" id="6747225">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747230">var</span>&nbsp;<span class="ident" id="6747234">la</span>&nbsp;<span class="op" id="6747237">*</span><span class="ident" id="6747238">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747248">if</span>&nbsp;<span class="ident" id="6747251">laddr</span>&nbsp;<span class="op" id="6747257">!=</span>&nbsp;<span class="string" id="6747260">&#34;&#34;</span>&nbsp;<span class="op" id="6747263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747268">var</span>&nbsp;<span class="ident" id="6747272">err</span>&nbsp;<span class="builtintype" id="6747276">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747285">if</span>&nbsp;<span class="ident" id="6747288">la</span><span class="op" id="6747290">,</span>&nbsp;<span class="ident" id="6747292">err</span>&nbsp;<span class="op" id="6747296">=</span>&nbsp;<span class="ident" id="6747298">ResolveUDPAddr</span><span class="op" id="6747312">(</span><span class="string" id="6747313">&#34;udp&#34;</span><span class="op" id="6747318">,</span>&nbsp;<span class="ident" id="6747320">laddr</span><span class="op" id="6747325">)</span><span class="op" id="6747326">;</span>&nbsp;<span class="ident" id="6747328">err</span>&nbsp;<span class="op" id="6747332">!=</span>&nbsp;<span class="ident" id="6747335">nil</span>&nbsp;<span class="op" id="6747339">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747345">t</span><span class="op" id="6747346">.</span><span class="ident" id="6747347">Fatalf</span><span class="op" id="6747353">(</span><span class="string" id="6747354">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747381">,</span>&nbsp;<span class="ident" id="6747383">err</span><span class="op" id="6747386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747399">c2</span><span class="op" id="6747401">,</span>&nbsp;<span class="ident" id="6747403">err</span>&nbsp;<span class="op" id="6747407">:=</span>&nbsp;<span class="ident" id="6747410">DialUDP</span><span class="op" id="6747417">(</span><span class="string" id="6747418">&#34;udp&#34;</span><span class="op" id="6747423">,</span>&nbsp;<span class="ident" id="6747425">la</span><span class="op" id="6747427">,</span>&nbsp;<span class="ident" id="6747429">c1</span><span class="op" id="6747431">.</span><span class="ident" id="6747432">LocalAddr</span><span class="op" id="6747441">(</span><span class="op" id="6747442">)</span><span class="op" id="6747443">.</span><span class="op" id="6747444">(</span><span class="op" id="6747445">*</span><span class="ident" id="6747446">UDPAddr</span><span class="op" id="6747453">)</span><span class="op" id="6747454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747458">if</span>&nbsp;<span class="ident" id="6747461">err</span>&nbsp;<span class="op" id="6747465">!=</span>&nbsp;<span class="ident" id="6747468">nil</span>&nbsp;<span class="op" id="6747472">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747477">t</span><span class="op" id="6747478">.</span><span class="ident" id="6747479">Fatalf</span><span class="op" id="6747485">(</span><span class="string" id="6747486">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747506">,</span>&nbsp;<span class="ident" id="6747508">err</span><span class="op" id="6747511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747519">defer</span>&nbsp;<span class="ident" id="6747525">c2</span><span class="op" id="6747527">.</span><span class="ident" id="6747528">Close</span><span class="op" id="6747533">(</span><span class="op" id="6747534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747539">var</span>&nbsp;<span class="ident" id="6747543">connAddrs</span>&nbsp;<span class="op" id="6747553">=</span>&nbsp;<span class="op" id="6747555">[</span><span class="num" id="6747556">4</span><span class="op" id="6747557">]</span><span class="keyword" id="6747558">struct</span>&nbsp;<span class="op" id="6747565">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747570">got</span>&nbsp;<span class="ident" id="6747574">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747582">ok</span>&nbsp;&nbsp;<span class="builtintype" id="6747586">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747593">}</span><span class="op" id="6747594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747599">{</span><span class="ident" id="6747600">c1</span><span class="op" id="6747602">.</span><span class="ident" id="6747603">LocalAddr</span><span class="op" id="6747612">(</span><span class="op" id="6747613">)</span><span class="op" id="6747614">,</span>&nbsp;<span class="builtintype" id="6747616">true</span><span class="op" id="6747620">}</span><span class="op" id="6747621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747626">{</span><span class="ident" id="6747627">c1</span><span class="op" id="6747629">.</span><span class="op" id="6747630">(</span><span class="op" id="6747631">*</span><span class="ident" id="6747632">UDPConn</span><span class="op" id="6747639">)</span><span class="op" id="6747640">.</span><span class="ident" id="6747641">RemoteAddr</span><span class="op" id="6747651">(</span><span class="op" id="6747652">)</span><span class="op" id="6747653">,</span>&nbsp;<span class="builtintype" id="6747655">false</span><span class="op" id="6747660">}</span><span class="op" id="6747661">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747666">{</span><span class="ident" id="6747667">c2</span><span class="op" id="6747669">.</span><span class="ident" id="6747670">LocalAddr</span><span class="op" id="6747679">(</span><span class="op" id="6747680">)</span><span class="op" id="6747681">,</span>&nbsp;<span class="builtintype" id="6747683">true</span><span class="op" id="6747687">}</span><span class="op" id="6747688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747693">{</span><span class="ident" id="6747694">c2</span><span class="op" id="6747696">.</span><span class="ident" id="6747697">RemoteAddr</span><span class="op" id="6747707">(</span><span class="op" id="6747708">)</span><span class="op" id="6747709">,</span>&nbsp;<span class="builtintype" id="6747711">true</span><span class="op" id="6747715">}</span><span class="op" id="6747716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747724">for</span>&nbsp;<span class="ident" id="6747728">_</span><span class="op" id="6747729">,</span>&nbsp;<span class="ident" id="6747731">ca</span>&nbsp;<span class="op" id="6747734">:=</span>&nbsp;<span class="keyword" id="6747737">range</span>&nbsp;<span class="ident" id="6747743">connAddrs</span>&nbsp;<span class="op" id="6747753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747758">if</span>&nbsp;<span class="ident" id="6747761">a</span><span class="op" id="6747762">,</span>&nbsp;<span class="ident" id="6747764">ok</span>&nbsp;<span class="op" id="6747767">:=</span>&nbsp;<span class="ident" id="6747770">ca</span><span class="op" id="6747772">.</span><span class="ident" id="6747773">got</span><span class="op" id="6747776">.</span><span class="op" id="6747777">(</span><span class="op" id="6747778">*</span><span class="ident" id="6747779">UDPAddr</span><span class="op" id="6747786">)</span><span class="op" id="6747787">;</span>&nbsp;<span class="ident" id="6747789">ok</span>&nbsp;<span class="op" id="6747792">!=</span>&nbsp;<span class="ident" id="6747795">ca</span><span class="op" id="6747797">.</span><span class="ident" id="6747798">ok</span>&nbsp;<span class="op" id="6747801">||</span>&nbsp;<span class="ident" id="6747804">ok</span>&nbsp;<span class="op" id="6747807">&amp;&amp;</span>&nbsp;<span class="ident" id="6747810">a</span><span class="op" id="6747811">.</span><span class="ident" id="6747812">Port</span>&nbsp;<span class="op" id="6747817">==</span>&nbsp;<span class="num" id="6747820">0</span>&nbsp;<span class="op" id="6747822">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6747828">t</span><span class="op" id="6747829">.</span><span class="ident" id="6747830">Fatalf</span><span class="op" id="6747836">(</span><span class="string" id="6747837">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6747898">,</span>&nbsp;<span class="ident" id="6747900">ca</span><span class="op" id="6747902">.</span><span class="ident" id="6747903">got</span><span class="op" id="6747906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6747918">}</span><br>
<span class="lineno"></span><span class="op" id="6747920">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6747923">func</span>&nbsp;<span class="ident" id="6747928">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="6747955">(</span><span class="ident" id="6747956">t</span>&nbsp;<span class="op" id="6747958">*</span><span class="ident" id="6747959">testing</span><span class="op" id="6747966">.</span><span class="ident" id="6747967">T</span><span class="op" id="6747968">)</span>&nbsp;<span class="op" id="6747970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6747973">if</span>&nbsp;<span class="ident" id="6747976">testing</span><span class="op" id="6747983">.</span><span class="ident" id="6747984">Short</span><span class="op" id="6747989">(</span><span class="op" id="6747990">)</span>&nbsp;<span class="op" id="6747992">||</span>&nbsp;<span class="op" id="6747995">!</span><span class="op" id="6747996">*</span><span class="ident" id="6747997">testExternal</span>&nbsp;<span class="op" id="6748010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748014">t</span><span class="op" id="6748015">.</span><span class="ident" id="6748016">Skip</span><span class="op" id="6748020">(</span><span class="string" id="6748021">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6748062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748065">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748068">if</span>&nbsp;<span class="op" id="6748071">!</span><span class="ident" id="6748072">supportsIPv6</span>&nbsp;<span class="op" id="6748085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748089">t</span><span class="op" id="6748090">.</span><span class="ident" id="6748091">Skip</span><span class="op" id="6748095">(</span><span class="string" id="6748096">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6748119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748125">ifi</span>&nbsp;<span class="op" id="6748129">:=</span>&nbsp;<span class="ident" id="6748132">loopbackInterface</span><span class="op" id="6748149">(</span><span class="op" id="6748150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748153">if</span>&nbsp;<span class="ident" id="6748156">ifi</span>&nbsp;<span class="op" id="6748160">==</span>&nbsp;<span class="ident" id="6748163">nil</span>&nbsp;<span class="op" id="6748167">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748171">t</span><span class="op" id="6748172">.</span><span class="ident" id="6748173">Skip</span><span class="op" id="6748177">(</span><span class="string" id="6748178">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="6748208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748214">laddr</span>&nbsp;<span class="op" id="6748220">:=</span>&nbsp;<span class="ident" id="6748223">ipv6LinkLocalUnicastAddr</span><span class="op" id="6748247">(</span><span class="ident" id="6748248">ifi</span><span class="op" id="6748251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748254">if</span>&nbsp;<span class="ident" id="6748257">laddr</span>&nbsp;<span class="op" id="6748263">==</span>&nbsp;<span class="string" id="6748266">&#34;&#34;</span>&nbsp;<span class="op" id="6748269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748273">t</span><span class="op" id="6748274">.</span><span class="ident" id="6748275">Skip</span><span class="op" id="6748279">(</span><span class="string" id="6748280">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="6748324">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748331">type</span>&nbsp;<span class="ident" id="6748336">test</span>&nbsp;<span class="keyword" id="6748341">struct</span>&nbsp;<span class="op" id="6748348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748352">net</span><span class="op" id="6748355">,</span>&nbsp;<span class="ident" id="6748357">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6748363">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748372">nameLookup</span>&nbsp;<span class="builtintype" id="6748383">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748392">var</span>&nbsp;<span class="ident" id="6748396">tests</span>&nbsp;<span class="op" id="6748402">=</span>&nbsp;<span class="op" id="6748404">[</span><span class="op" id="6748405">]</span><span class="ident" id="6748406">test</span><span class="op" id="6748410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748414">{</span><span class="string" id="6748415">&#34;udp&#34;</span><span class="op" id="6748420">,</span>&nbsp;<span class="string" id="6748422">&#34;[&#34;</span>&nbsp;<span class="op" id="6748426">+</span>&nbsp;<span class="ident" id="6748428">laddr</span>&nbsp;<span class="op" id="6748434">+</span>&nbsp;<span class="string" id="6748436">&#34;%&#34;</span>&nbsp;<span class="op" id="6748440">+</span>&nbsp;<span class="ident" id="6748442">ifi</span><span class="op" id="6748445">.</span><span class="ident" id="6748446">Name</span>&nbsp;<span class="op" id="6748451">+</span>&nbsp;<span class="string" id="6748453">&#34;]:0&#34;</span><span class="op" id="6748458">,</span>&nbsp;<span class="builtintype" id="6748460">false</span><span class="op" id="6748465">}</span><span class="op" id="6748466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748470">{</span><span class="string" id="6748471">&#34;udp6&#34;</span><span class="op" id="6748477">,</span>&nbsp;<span class="string" id="6748479">&#34;[&#34;</span>&nbsp;<span class="op" id="6748483">+</span>&nbsp;<span class="ident" id="6748485">laddr</span>&nbsp;<span class="op" id="6748491">+</span>&nbsp;<span class="string" id="6748493">&#34;%&#34;</span>&nbsp;<span class="op" id="6748497">+</span>&nbsp;<span class="ident" id="6748499">ifi</span><span class="op" id="6748502">.</span><span class="ident" id="6748503">Name</span>&nbsp;<span class="op" id="6748508">+</span>&nbsp;<span class="string" id="6748510">&#34;]:0&#34;</span><span class="op" id="6748515">,</span>&nbsp;<span class="builtintype" id="6748517">false</span><span class="op" id="6748522">}</span><span class="op" id="6748523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748526">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6748529">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748589">if</span>&nbsp;<span class="ident" id="6748592">runtime</span><span class="op" id="6748599">.</span><span class="ident" id="6748600">GOOS</span>&nbsp;<span class="op" id="6748605">==</span>&nbsp;<span class="string" id="6748608">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="6748620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748624">tests</span>&nbsp;<span class="op" id="6748630">=</span>&nbsp;<span class="ident" id="6748632">tests</span><span class="op" id="6748637">[</span><span class="num" id="6748638">1</span><span class="op" id="6748639">:</span><span class="op" id="6748640">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748646">switch</span>&nbsp;<span class="ident" id="6748653">runtime</span><span class="op" id="6748660">.</span><span class="ident" id="6748661">GOOS</span>&nbsp;<span class="op" id="6748666">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748669">case</span>&nbsp;<span class="string" id="6748674">&#34;darwin&#34;</span><span class="op" id="6748682">,</span>&nbsp;<span class="string" id="6748684">&#34;dragonfly&#34;</span><span class="op" id="6748695">,</span>&nbsp;<span class="string" id="6748697">&#34;freebsd&#34;</span><span class="op" id="6748706">,</span>&nbsp;<span class="string" id="6748708">&#34;openbsd&#34;</span><span class="op" id="6748717">,</span>&nbsp;<span class="string" id="6748719">&#34;netbsd&#34;</span><span class="op" id="6748727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748731">tests</span>&nbsp;<span class="op" id="6748737">=</span>&nbsp;<span class="builtinfunc" id="6748739">append</span><span class="op" id="6748745">(</span><span class="ident" id="6748746">tests</span><span class="op" id="6748751">,</span>&nbsp;<span class="op" id="6748753">[</span><span class="op" id="6748754">]</span><span class="ident" id="6748755">test</span><span class="op" id="6748759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748764">{</span><span class="string" id="6748765">&#34;udp&#34;</span><span class="op" id="6748770">,</span>&nbsp;<span class="string" id="6748772">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6748786">+</span>&nbsp;<span class="ident" id="6748788">ifi</span><span class="op" id="6748791">.</span><span class="ident" id="6748792">Name</span>&nbsp;<span class="op" id="6748797">+</span>&nbsp;<span class="string" id="6748799">&#34;]:0&#34;</span><span class="op" id="6748804">,</span>&nbsp;<span class="builtintype" id="6748806">true</span><span class="op" id="6748810">}</span><span class="op" id="6748811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748816">{</span><span class="string" id="6748817">&#34;udp6&#34;</span><span class="op" id="6748823">,</span>&nbsp;<span class="string" id="6748825">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6748839">+</span>&nbsp;<span class="ident" id="6748841">ifi</span><span class="op" id="6748844">.</span><span class="ident" id="6748845">Name</span>&nbsp;<span class="op" id="6748850">+</span>&nbsp;<span class="string" id="6748852">&#34;]:0&#34;</span><span class="op" id="6748857">,</span>&nbsp;<span class="builtintype" id="6748859">true</span><span class="op" id="6748863">}</span><span class="op" id="6748864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748868">}</span><span class="op" id="6748869">...</span><span class="op" id="6748872">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6748875">case</span>&nbsp;<span class="string" id="6748880">&#34;linux&#34;</span><span class="op" id="6748887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6748891">tests</span>&nbsp;<span class="op" id="6748897">=</span>&nbsp;<span class="builtinfunc" id="6748899">append</span><span class="op" id="6748905">(</span><span class="ident" id="6748906">tests</span><span class="op" id="6748911">,</span>&nbsp;<span class="op" id="6748913">[</span><span class="op" id="6748914">]</span><span class="ident" id="6748915">test</span><span class="op" id="6748919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748924">{</span><span class="string" id="6748925">&#34;udp&#34;</span><span class="op" id="6748930">,</span>&nbsp;<span class="string" id="6748932">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6748950">+</span>&nbsp;<span class="ident" id="6748952">ifi</span><span class="op" id="6748955">.</span><span class="ident" id="6748956">Name</span>&nbsp;<span class="op" id="6748961">+</span>&nbsp;<span class="string" id="6748963">&#34;]:0&#34;</span><span class="op" id="6748968">,</span>&nbsp;<span class="builtintype" id="6748970">true</span><span class="op" id="6748974">}</span><span class="op" id="6748975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6748980">{</span><span class="string" id="6748981">&#34;udp6&#34;</span><span class="op" id="6748987">,</span>&nbsp;<span class="string" id="6748989">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6749007">+</span>&nbsp;<span class="ident" id="6749009">ifi</span><span class="op" id="6749012">.</span><span class="ident" id="6749013">Name</span>&nbsp;<span class="op" id="6749018">+</span>&nbsp;<span class="string" id="6749020">&#34;]:0&#34;</span><span class="op" id="6749025">,</span>&nbsp;<span class="builtintype" id="6749027">true</span><span class="op" id="6749031">}</span><span class="op" id="6749032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749036">}</span><span class="op" id="6749037">...</span><span class="op" id="6749040">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749046">for</span>&nbsp;<span class="ident" id="6749050">_</span><span class="op" id="6749051">,</span>&nbsp;<span class="ident" id="6749053">tt</span>&nbsp;<span class="op" id="6749056">:=</span>&nbsp;<span class="keyword" id="6749059">range</span>&nbsp;<span class="ident" id="6749065">tests</span>&nbsp;<span class="op" id="6749071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749075">c1</span><span class="op" id="6749077">,</span>&nbsp;<span class="ident" id="6749079">err</span>&nbsp;<span class="op" id="6749083">:=</span>&nbsp;<span class="ident" id="6749086">ListenPacket</span><span class="op" id="6749098">(</span><span class="ident" id="6749099">tt</span><span class="op" id="6749101">.</span><span class="ident" id="6749102">net</span><span class="op" id="6749105">,</span>&nbsp;<span class="ident" id="6749107">tt</span><span class="op" id="6749109">.</span><span class="ident" id="6749110">addr</span><span class="op" id="6749114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749118">if</span>&nbsp;<span class="ident" id="6749121">err</span>&nbsp;<span class="op" id="6749125">!=</span>&nbsp;<span class="ident" id="6749128">nil</span>&nbsp;<span class="op" id="6749132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6749137">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6749183">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749232">t</span><span class="op" id="6749233">.</span><span class="ident" id="6749234">Logf</span><span class="op" id="6749238">(</span><span class="string" id="6749239">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6749264">,</span>&nbsp;<span class="ident" id="6749266">err</span><span class="op" id="6749269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749274">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749289">defer</span>&nbsp;<span class="ident" id="6749295">c1</span><span class="op" id="6749297">.</span><span class="ident" id="6749298">Close</span><span class="op" id="6749303">(</span><span class="op" id="6749304">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749308">if</span>&nbsp;<span class="ident" id="6749311">la</span><span class="op" id="6749313">,</span>&nbsp;<span class="ident" id="6749315">ok</span>&nbsp;<span class="op" id="6749318">:=</span>&nbsp;<span class="ident" id="6749321">c1</span><span class="op" id="6749323">.</span><span class="ident" id="6749324">LocalAddr</span><span class="op" id="6749333">(</span><span class="op" id="6749334">)</span><span class="op" id="6749335">.</span><span class="op" id="6749336">(</span><span class="op" id="6749337">*</span><span class="ident" id="6749338">UDPAddr</span><span class="op" id="6749345">)</span><span class="op" id="6749346">;</span>&nbsp;<span class="op" id="6749348">!</span><span class="ident" id="6749349">ok</span>&nbsp;<span class="op" id="6749352">||</span>&nbsp;<span class="op" id="6749355">!</span><span class="ident" id="6749356">tt</span><span class="op" id="6749358">.</span><span class="ident" id="6749359">nameLookup</span>&nbsp;<span class="op" id="6749370">&amp;&amp;</span>&nbsp;<span class="ident" id="6749373">la</span><span class="op" id="6749375">.</span><span class="ident" id="6749376">Zone</span>&nbsp;<span class="op" id="6749381">==</span>&nbsp;<span class="string" id="6749384">&#34;&#34;</span>&nbsp;<span class="op" id="6749387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749392">t</span><span class="op" id="6749393">.</span><span class="ident" id="6749394">Fatalf</span><span class="op" id="6749400">(</span><span class="string" id="6749401">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6749457">,</span>&nbsp;<span class="ident" id="6749459">la</span><span class="op" id="6749461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749470">c2</span><span class="op" id="6749472">,</span>&nbsp;<span class="ident" id="6749474">err</span>&nbsp;<span class="op" id="6749478">:=</span>&nbsp;<span class="ident" id="6749481">Dial</span><span class="op" id="6749485">(</span><span class="ident" id="6749486">tt</span><span class="op" id="6749488">.</span><span class="ident" id="6749489">net</span><span class="op" id="6749492">,</span>&nbsp;<span class="ident" id="6749494">c1</span><span class="op" id="6749496">.</span><span class="ident" id="6749497">LocalAddr</span><span class="op" id="6749506">(</span><span class="op" id="6749507">)</span><span class="op" id="6749508">.</span><span class="ident" id="6749509">String</span><span class="op" id="6749515">(</span><span class="op" id="6749516">)</span><span class="op" id="6749517">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749521">if</span>&nbsp;<span class="ident" id="6749524">err</span>&nbsp;<span class="op" id="6749528">!=</span>&nbsp;<span class="ident" id="6749531">nil</span>&nbsp;<span class="op" id="6749535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749540">t</span><span class="op" id="6749541">.</span><span class="ident" id="6749542">Fatalf</span><span class="op" id="6749548">(</span><span class="string" id="6749549">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6749566">,</span>&nbsp;<span class="ident" id="6749568">err</span><span class="op" id="6749571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749579">defer</span>&nbsp;<span class="ident" id="6749585">c2</span><span class="op" id="6749587">.</span><span class="ident" id="6749588">Close</span><span class="op" id="6749593">(</span><span class="op" id="6749594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749598">if</span>&nbsp;<span class="ident" id="6749601">la</span><span class="op" id="6749603">,</span>&nbsp;<span class="ident" id="6749605">ok</span>&nbsp;<span class="op" id="6749608">:=</span>&nbsp;<span class="ident" id="6749611">c2</span><span class="op" id="6749613">.</span><span class="ident" id="6749614">LocalAddr</span><span class="op" id="6749623">(</span><span class="op" id="6749624">)</span><span class="op" id="6749625">.</span><span class="op" id="6749626">(</span><span class="op" id="6749627">*</span><span class="ident" id="6749628">UDPAddr</span><span class="op" id="6749635">)</span><span class="op" id="6749636">;</span>&nbsp;<span class="op" id="6749638">!</span><span class="ident" id="6749639">ok</span>&nbsp;<span class="op" id="6749642">||</span>&nbsp;<span class="op" id="6749645">!</span><span class="ident" id="6749646">tt</span><span class="op" id="6749648">.</span><span class="ident" id="6749649">nameLookup</span>&nbsp;<span class="op" id="6749660">&amp;&amp;</span>&nbsp;<span class="ident" id="6749663">la</span><span class="op" id="6749665">.</span><span class="ident" id="6749666">Zone</span>&nbsp;<span class="op" id="6749671">==</span>&nbsp;<span class="string" id="6749674">&#34;&#34;</span>&nbsp;<span class="op" id="6749677">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749682">t</span><span class="op" id="6749683">.</span><span class="ident" id="6749684">Fatalf</span><span class="op" id="6749690">(</span><span class="string" id="6749691">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6749747">,</span>&nbsp;<span class="ident" id="6749749">la</span><span class="op" id="6749751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749759">if</span>&nbsp;<span class="ident" id="6749762">ra</span><span class="op" id="6749764">,</span>&nbsp;<span class="ident" id="6749766">ok</span>&nbsp;<span class="op" id="6749769">:=</span>&nbsp;<span class="ident" id="6749772">c2</span><span class="op" id="6749774">.</span><span class="ident" id="6749775">RemoteAddr</span><span class="op" id="6749785">(</span><span class="op" id="6749786">)</span><span class="op" id="6749787">.</span><span class="op" id="6749788">(</span><span class="op" id="6749789">*</span><span class="ident" id="6749790">UDPAddr</span><span class="op" id="6749797">)</span><span class="op" id="6749798">;</span>&nbsp;<span class="op" id="6749800">!</span><span class="ident" id="6749801">ok</span>&nbsp;<span class="op" id="6749804">||</span>&nbsp;<span class="op" id="6749807">!</span><span class="ident" id="6749808">tt</span><span class="op" id="6749810">.</span><span class="ident" id="6749811">nameLookup</span>&nbsp;<span class="op" id="6749822">&amp;&amp;</span>&nbsp;<span class="ident" id="6749825">ra</span><span class="op" id="6749827">.</span><span class="ident" id="6749828">Zone</span>&nbsp;<span class="op" id="6749833">==</span>&nbsp;<span class="string" id="6749836">&#34;&#34;</span>&nbsp;<span class="op" id="6749839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6749844">t</span><span class="op" id="6749845">.</span><span class="ident" id="6749846">Fatalf</span><span class="op" id="6749852">(</span><span class="string" id="6749853">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6749909">,</span>&nbsp;<span class="ident" id="6749911">ra</span><span class="op" id="6749913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6749917">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6749922">if</span>&nbsp;<span class="ident" id="6749925">_</span><span class="op" id="6749926">,</span>&nbsp;<span class="ident" id="6749928">err</span>&nbsp;<span class="op" id="6749932">:=</span>&nbsp;<span class="ident" id="6749935">c2</span><span class="op" id="6749937">.</span><span class="ident" id="6749938">Write</span><span class="op" id="6749943">(</span><span class="op" id="6749944">[</span><span class="op" id="6749945">]</span><span class="builtintype" id="6749946">byte</span><span class="op" id="6749950">(</span><span class="string" id="6749951">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="6749981">)</span><span class="op" id="6749982">)</span><span class="op" id="6749983">;</span>&nbsp;<span class="ident" id="6749985">err</span>&nbsp;<span class="op" id="6749989">!=</span>&nbsp;<span class="ident" id="6749992">nil</span>&nbsp;<span class="op" id="6749996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6750001">t</span><span class="op" id="6750002">.</span><span class="ident" id="6750003">Fatalf</span><span class="op" id="6750009">(</span><span class="string" id="6750010">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6750033">,</span>&nbsp;<span class="ident" id="6750035">err</span><span class="op" id="6750038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6750042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6750046">b</span>&nbsp;<span class="op" id="6750048">:=</span>&nbsp;<span class="builtinfunc" id="6750051">make</span><span class="op" id="6750055">(</span><span class="op" id="6750056">[</span><span class="op" id="6750057">]</span><span class="builtintype" id="6750058">byte</span><span class="op" id="6750062">,</span>&nbsp;<span class="num" id="6750064">32</span><span class="op" id="6750066">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6750070">if</span>&nbsp;<span class="ident" id="6750073">_</span><span class="op" id="6750074">,</span>&nbsp;<span class="ident" id="6750076">from</span><span class="op" id="6750080">,</span>&nbsp;<span class="ident" id="6750082">err</span>&nbsp;<span class="op" id="6750086">:=</span>&nbsp;<span class="ident" id="6750089">c1</span><span class="op" id="6750091">.</span><span class="ident" id="6750092">ReadFrom</span><span class="op" id="6750100">(</span><span class="ident" id="6750101">b</span><span class="op" id="6750102">)</span><span class="op" id="6750103">;</span>&nbsp;<span class="ident" id="6750105">err</span>&nbsp;<span class="op" id="6750109">!=</span>&nbsp;<span class="ident" id="6750112">nil</span>&nbsp;<span class="op" id="6750116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6750121">t</span><span class="op" id="6750122">.</span><span class="ident" id="6750123">Fatalf</span><span class="op" id="6750129">(</span><span class="string" id="6750130">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6750162">,</span>&nbsp;<span class="ident" id="6750164">err</span><span class="op" id="6750167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6750171">}</span>&nbsp;<span class="keyword" id="6750173">else</span>&nbsp;<span class="op" id="6750178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6750183">if</span>&nbsp;<span class="ident" id="6750186">ra</span><span class="op" id="6750188">,</span>&nbsp;<span class="ident" id="6750190">ok</span>&nbsp;<span class="op" id="6750193">:=</span>&nbsp;<span class="ident" id="6750196">from</span><span class="op" id="6750200">.</span><span class="op" id="6750201">(</span><span class="op" id="6750202">*</span><span class="ident" id="6750203">UDPAddr</span><span class="op" id="6750210">)</span><span class="op" id="6750211">;</span>&nbsp;<span class="op" id="6750213">!</span><span class="ident" id="6750214">ok</span>&nbsp;<span class="op" id="6750217">||</span>&nbsp;<span class="op" id="6750220">!</span><span class="ident" id="6750221">tt</span><span class="op" id="6750223">.</span><span class="ident" id="6750224">nameLookup</span>&nbsp;<span class="op" id="6750235">&amp;&amp;</span>&nbsp;<span class="ident" id="6750238">ra</span><span class="op" id="6750240">.</span><span class="ident" id="6750241">Zone</span>&nbsp;<span class="op" id="6750246">==</span>&nbsp;<span class="string" id="6750249">&#34;&#34;</span>&nbsp;<span class="op" id="6750252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6750258">t</span><span class="op" id="6750259">.</span><span class="ident" id="6750260">Fatalf</span><span class="op" id="6750266">(</span><span class="string" id="6750267">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6750323">,</span>&nbsp;<span class="ident" id="6750325">ra</span><span class="op" id="6750327">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6750332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6750336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6750339">}</span><br>
<span class="lineno"></span><span class="op" id="6750341">}</span>
</div>
</body>
</html>
