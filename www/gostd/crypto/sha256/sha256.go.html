<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3700824">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3700879">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3700933">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3700984">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3701062">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="3701080">package</span>&nbsp;<span class="ident" id="3701088">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3701096">import</span>&nbsp;<span class="op" id="3701103">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3701106">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3701116">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3701123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3701126">func</span>&nbsp;<span class="ident" id="3701131">init</span><span class="op" id="3701135">(</span><span class="op" id="3701136">)</span>&nbsp;<span class="op" id="3701138">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701141">crypto</span><span class="op" id="3701147">.</span><span class="ident" id="3701148">RegisterHash</span><span class="op" id="3701160">(</span><span class="ident" id="3701161">crypto</span><span class="op" id="3701167">.</span><span class="ident" id="3701168">SHA224</span><span class="op" id="3701174">,</span>&nbsp;<span class="ident" id="3701176">New224</span><span class="op" id="3701182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701185">crypto</span><span class="op" id="3701191">.</span><span class="ident" id="3701192">RegisterHash</span><span class="op" id="3701204">(</span><span class="ident" id="3701205">crypto</span><span class="op" id="3701211">.</span><span class="ident" id="3701212">SHA256</span><span class="op" id="3701218">,</span>&nbsp;<span class="ident" id="3701220">New</span><span class="op" id="3701223">)</span><br>
<span class="lineno"></span><span class="op" id="3701225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3701228">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="3701271">const</span>&nbsp;<span class="ident" id="3701277">Size</span>&nbsp;<span class="op" id="3701282">=</span>&nbsp;<span class="num" id="3701284">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3701288">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3701331">const</span>&nbsp;<span class="ident" id="3701337">Size224</span>&nbsp;<span class="op" id="3701345">=</span>&nbsp;<span class="num" id="3701347">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3701351">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3701399">const</span>&nbsp;<span class="ident" id="3701405">BlockSize</span>&nbsp;<span class="op" id="3701415">=</span>&nbsp;<span class="num" id="3701417">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3701421">const</span>&nbsp;<span class="op" id="3701427">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701430">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701440">=</span>&nbsp;<span class="num" id="3701442">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701446">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701456">=</span>&nbsp;<span class="num" id="3701458">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701470">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701480">=</span>&nbsp;<span class="num" id="3701482">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701494">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701504">=</span>&nbsp;<span class="num" id="3701506">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701518">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701528">=</span>&nbsp;<span class="num" id="3701530">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701542">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701552">=</span>&nbsp;<span class="num" id="3701554">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701566">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701576">=</span>&nbsp;<span class="num" id="3701578">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701590">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701600">=</span>&nbsp;<span class="num" id="3701602">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701614">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701624">=</span>&nbsp;<span class="num" id="3701626">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701638">init0_224</span>&nbsp;<span class="op" id="3701648">=</span>&nbsp;<span class="num" id="3701650">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701662">init1_224</span>&nbsp;<span class="op" id="3701672">=</span>&nbsp;<span class="num" id="3701674">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701686">init2_224</span>&nbsp;<span class="op" id="3701696">=</span>&nbsp;<span class="num" id="3701698">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701710">init3_224</span>&nbsp;<span class="op" id="3701720">=</span>&nbsp;<span class="num" id="3701722">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701734">init4_224</span>&nbsp;<span class="op" id="3701744">=</span>&nbsp;<span class="num" id="3701746">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701758">init5_224</span>&nbsp;<span class="op" id="3701768">=</span>&nbsp;<span class="num" id="3701770">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701782">init6_224</span>&nbsp;<span class="op" id="3701792">=</span>&nbsp;<span class="num" id="3701794">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701806">init7_224</span>&nbsp;<span class="op" id="3701816">=</span>&nbsp;<span class="num" id="3701818">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="3701829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3701832">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3701891">type</span>&nbsp;<span class="ident" id="3701896">digest</span>&nbsp;<span class="keyword" id="3701903">struct</span>&nbsp;<span class="op" id="3701910">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701913">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701919">[</span><span class="num" id="3701920">8</span><span class="op" id="3701921">]</span><span class="builtintype" id="3701922">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701930">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701936">[</span><span class="ident" id="3701937">chunk</span><span class="op" id="3701942">]</span><span class="builtintype" id="3701943">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701949">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3701955">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3701960">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3701966">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701974">is224</span>&nbsp;<span class="builtintype" id="3701980">bool</span>&nbsp;<span class="comment" id="3701985">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="3702019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702022">func</span>&nbsp;<span class="op" id="3702027">(</span><span class="ident" id="3702028">d</span>&nbsp;<span class="op" id="3702030">*</span><span class="ident" id="3702031">digest</span><span class="op" id="3702037">)</span>&nbsp;<span class="ident" id="3702039">Reset</span><span class="op" id="3702044">(</span><span class="op" id="3702045">)</span>&nbsp;<span class="op" id="3702047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702050">if</span>&nbsp;<span class="op" id="3702053">!</span><span class="ident" id="3702054">d</span><span class="op" id="3702055">.</span><span class="ident" id="3702056">is224</span>&nbsp;<span class="op" id="3702062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702066">d</span><span class="op" id="3702067">.</span><span class="ident" id="3702068">h</span><span class="op" id="3702069">[</span><span class="num" id="3702070">0</span><span class="op" id="3702071">]</span>&nbsp;<span class="op" id="3702073">=</span>&nbsp;<span class="ident" id="3702075">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702083">d</span><span class="op" id="3702084">.</span><span class="ident" id="3702085">h</span><span class="op" id="3702086">[</span><span class="num" id="3702087">1</span><span class="op" id="3702088">]</span>&nbsp;<span class="op" id="3702090">=</span>&nbsp;<span class="ident" id="3702092">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702100">d</span><span class="op" id="3702101">.</span><span class="ident" id="3702102">h</span><span class="op" id="3702103">[</span><span class="num" id="3702104">2</span><span class="op" id="3702105">]</span>&nbsp;<span class="op" id="3702107">=</span>&nbsp;<span class="ident" id="3702109">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702117">d</span><span class="op" id="3702118">.</span><span class="ident" id="3702119">h</span><span class="op" id="3702120">[</span><span class="num" id="3702121">3</span><span class="op" id="3702122">]</span>&nbsp;<span class="op" id="3702124">=</span>&nbsp;<span class="ident" id="3702126">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702134">d</span><span class="op" id="3702135">.</span><span class="ident" id="3702136">h</span><span class="op" id="3702137">[</span><span class="num" id="3702138">4</span><span class="op" id="3702139">]</span>&nbsp;<span class="op" id="3702141">=</span>&nbsp;<span class="ident" id="3702143">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702151">d</span><span class="op" id="3702152">.</span><span class="ident" id="3702153">h</span><span class="op" id="3702154">[</span><span class="num" id="3702155">5</span><span class="op" id="3702156">]</span>&nbsp;<span class="op" id="3702158">=</span>&nbsp;<span class="ident" id="3702160">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702168">d</span><span class="op" id="3702169">.</span><span class="ident" id="3702170">h</span><span class="op" id="3702171">[</span><span class="num" id="3702172">6</span><span class="op" id="3702173">]</span>&nbsp;<span class="op" id="3702175">=</span>&nbsp;<span class="ident" id="3702177">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702185">d</span><span class="op" id="3702186">.</span><span class="ident" id="3702187">h</span><span class="op" id="3702188">[</span><span class="num" id="3702189">7</span><span class="op" id="3702190">]</span>&nbsp;<span class="op" id="3702192">=</span>&nbsp;<span class="ident" id="3702194">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702201">}</span>&nbsp;<span class="keyword" id="3702203">else</span>&nbsp;<span class="op" id="3702208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702212">d</span><span class="op" id="3702213">.</span><span class="ident" id="3702214">h</span><span class="op" id="3702215">[</span><span class="num" id="3702216">0</span><span class="op" id="3702217">]</span>&nbsp;<span class="op" id="3702219">=</span>&nbsp;<span class="ident" id="3702221">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702233">d</span><span class="op" id="3702234">.</span><span class="ident" id="3702235">h</span><span class="op" id="3702236">[</span><span class="num" id="3702237">1</span><span class="op" id="3702238">]</span>&nbsp;<span class="op" id="3702240">=</span>&nbsp;<span class="ident" id="3702242">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702254">d</span><span class="op" id="3702255">.</span><span class="ident" id="3702256">h</span><span class="op" id="3702257">[</span><span class="num" id="3702258">2</span><span class="op" id="3702259">]</span>&nbsp;<span class="op" id="3702261">=</span>&nbsp;<span class="ident" id="3702263">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702275">d</span><span class="op" id="3702276">.</span><span class="ident" id="3702277">h</span><span class="op" id="3702278">[</span><span class="num" id="3702279">3</span><span class="op" id="3702280">]</span>&nbsp;<span class="op" id="3702282">=</span>&nbsp;<span class="ident" id="3702284">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702296">d</span><span class="op" id="3702297">.</span><span class="ident" id="3702298">h</span><span class="op" id="3702299">[</span><span class="num" id="3702300">4</span><span class="op" id="3702301">]</span>&nbsp;<span class="op" id="3702303">=</span>&nbsp;<span class="ident" id="3702305">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702317">d</span><span class="op" id="3702318">.</span><span class="ident" id="3702319">h</span><span class="op" id="3702320">[</span><span class="num" id="3702321">5</span><span class="op" id="3702322">]</span>&nbsp;<span class="op" id="3702324">=</span>&nbsp;<span class="ident" id="3702326">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702338">d</span><span class="op" id="3702339">.</span><span class="ident" id="3702340">h</span><span class="op" id="3702341">[</span><span class="num" id="3702342">6</span><span class="op" id="3702343">]</span>&nbsp;<span class="op" id="3702345">=</span>&nbsp;<span class="ident" id="3702347">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702359">d</span><span class="op" id="3702360">.</span><span class="ident" id="3702361">h</span><span class="op" id="3702362">[</span><span class="num" id="3702363">7</span><span class="op" id="3702364">]</span>&nbsp;<span class="op" id="3702366">=</span>&nbsp;<span class="ident" id="3702368">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702382">d</span><span class="op" id="3702383">.</span><span class="ident" id="3702384">nx</span>&nbsp;<span class="op" id="3702387">=</span>&nbsp;<span class="num" id="3702389">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702392">d</span><span class="op" id="3702393">.</span><span class="builtinfunc" id="3702394">len</span>&nbsp;<span class="op" id="3702398">=</span>&nbsp;<span class="num" id="3702400">0</span><br>
<span class="lineno"></span><span class="op" id="3702402">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3702405">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3702467">func</span>&nbsp;<span class="ident" id="3702472">New</span><span class="op" id="3702475">(</span><span class="op" id="3702476">)</span>&nbsp;<span class="ident" id="3702478">hash</span><span class="op" id="3702482">.</span><span class="ident" id="3702483">Hash</span>&nbsp;<span class="op" id="3702488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702491">d</span>&nbsp;<span class="op" id="3702493">:=</span>&nbsp;<span class="builtinfunc" id="3702496">new</span><span class="op" id="3702499">(</span><span class="ident" id="3702500">digest</span><span class="op" id="3702506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702509">d</span><span class="op" id="3702510">.</span><span class="ident" id="3702511">Reset</span><span class="op" id="3702516">(</span><span class="op" id="3702517">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702520">return</span>&nbsp;<span class="ident" id="3702527">d</span><br>
<span class="lineno"></span><span class="op" id="3702529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3702532">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3702597">func</span>&nbsp;<span class="ident" id="3702602">New224</span><span class="op" id="3702608">(</span><span class="op" id="3702609">)</span>&nbsp;<span class="ident" id="3702611">hash</span><span class="op" id="3702615">.</span><span class="ident" id="3702616">Hash</span>&nbsp;<span class="op" id="3702621">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702624">d</span>&nbsp;<span class="op" id="3702626">:=</span>&nbsp;<span class="builtinfunc" id="3702629">new</span><span class="op" id="3702632">(</span><span class="ident" id="3702633">digest</span><span class="op" id="3702639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702642">d</span><span class="op" id="3702643">.</span><span class="ident" id="3702644">is224</span>&nbsp;<span class="op" id="3702650">=</span>&nbsp;<span class="builtintype" id="3702652">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702658">d</span><span class="op" id="3702659">.</span><span class="ident" id="3702660">Reset</span><span class="op" id="3702665">(</span><span class="op" id="3702666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702669">return</span>&nbsp;<span class="ident" id="3702676">d</span><br>
<span class="lineno"></span><span class="op" id="3702678">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3702681">func</span>&nbsp;<span class="op" id="3702686">(</span><span class="ident" id="3702687">d</span>&nbsp;<span class="op" id="3702689">*</span><span class="ident" id="3702690">digest</span><span class="op" id="3702696">)</span>&nbsp;<span class="ident" id="3702698">Size</span><span class="op" id="3702702">(</span><span class="op" id="3702703">)</span>&nbsp;<span class="builtintype" id="3702705">int</span>&nbsp;<span class="op" id="3702709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702712">if</span>&nbsp;<span class="op" id="3702715">!</span><span class="ident" id="3702716">d</span><span class="op" id="3702717">.</span><span class="ident" id="3702718">is224</span>&nbsp;<span class="op" id="3702724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702728">return</span>&nbsp;<span class="ident" id="3702735">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702741">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702744">return</span>&nbsp;<span class="ident" id="3702751">Size224</span><br>
<span class="lineno"></span><span class="op" id="3702759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702762">func</span>&nbsp;<span class="op" id="3702767">(</span><span class="ident" id="3702768">d</span>&nbsp;<span class="op" id="3702770">*</span><span class="ident" id="3702771">digest</span><span class="op" id="3702777">)</span>&nbsp;<span class="ident" id="3702779">BlockSize</span><span class="op" id="3702788">(</span><span class="op" id="3702789">)</span>&nbsp;<span class="builtintype" id="3702791">int</span>&nbsp;<span class="op" id="3702795">{</span>&nbsp;<span class="keyword" id="3702797">return</span>&nbsp;<span class="ident" id="3702804">BlockSize</span>&nbsp;<span class="op" id="3702814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="3702817">func</span>&nbsp;<span class="op" id="3702822">(</span><span class="ident" id="3702823">d</span>&nbsp;<span class="op" id="3702825">*</span><span class="ident" id="3702826">digest</span><span class="op" id="3702832">)</span>&nbsp;<span class="ident" id="3702834">Write</span><span class="op" id="3702839">(</span><span class="ident" id="3702840">p</span>&nbsp;<span class="op" id="3702842">[</span><span class="op" id="3702843">]</span><span class="builtintype" id="3702844">byte</span><span class="op" id="3702848">)</span>&nbsp;<span class="op" id="3702850">(</span><span class="ident" id="3702851">nn</span>&nbsp;<span class="builtintype" id="3702854">int</span><span class="op" id="3702857">,</span>&nbsp;<span class="ident" id="3702859">err</span>&nbsp;<span class="builtintype" id="3702863">error</span><span class="op" id="3702868">)</span>&nbsp;<span class="op" id="3702870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702873">nn</span>&nbsp;<span class="op" id="3702876">=</span>&nbsp;<span class="builtinfunc" id="3702878">len</span><span class="op" id="3702881">(</span><span class="ident" id="3702882">p</span><span class="op" id="3702883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702886">d</span><span class="op" id="3702887">.</span><span class="builtinfunc" id="3702888">len</span>&nbsp;<span class="op" id="3702892">+=</span>&nbsp;<span class="ident" id="3702895">uint64</span><span class="op" id="3702901">(</span><span class="ident" id="3702902">nn</span><span class="op" id="3702904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702907">if</span>&nbsp;<span class="ident" id="3702910">d</span><span class="op" id="3702911">.</span><span class="ident" id="3702912">nx</span>&nbsp;<span class="op" id="3702915">&gt;</span>&nbsp;<span class="num" id="3702917">0</span>&nbsp;<span class="op" id="3702919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702923">n</span>&nbsp;<span class="op" id="3702925">:=</span>&nbsp;<span class="builtinfunc" id="3702928">copy</span><span class="op" id="3702932">(</span><span class="ident" id="3702933">d</span><span class="op" id="3702934">.</span><span class="ident" id="3702935">x</span><span class="op" id="3702936">[</span><span class="ident" id="3702937">d</span><span class="op" id="3702938">.</span><span class="ident" id="3702939">nx</span><span class="op" id="3702941">:</span><span class="op" id="3702942">]</span><span class="op" id="3702943">,</span>&nbsp;<span class="ident" id="3702945">p</span><span class="op" id="3702946">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702950">d</span><span class="op" id="3702951">.</span><span class="ident" id="3702952">nx</span>&nbsp;<span class="op" id="3702955">+=</span>&nbsp;<span class="ident" id="3702958">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702962">if</span>&nbsp;<span class="ident" id="3702965">d</span><span class="op" id="3702966">.</span><span class="ident" id="3702967">nx</span>&nbsp;<span class="op" id="3702970">==</span>&nbsp;<span class="ident" id="3702973">chunk</span>&nbsp;<span class="op" id="3702979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702984">block</span><span class="op" id="3702989">(</span><span class="ident" id="3702990">d</span><span class="op" id="3702991">,</span>&nbsp;<span class="ident" id="3702993">d</span><span class="op" id="3702994">.</span><span class="ident" id="3702995">x</span><span class="op" id="3702996">[</span><span class="op" id="3702997">:</span><span class="op" id="3702998">]</span><span class="op" id="3702999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703004">d</span><span class="op" id="3703005">.</span><span class="ident" id="3703006">nx</span>&nbsp;<span class="op" id="3703009">=</span>&nbsp;<span class="num" id="3703011">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703015">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703019">p</span>&nbsp;<span class="op" id="3703021">=</span>&nbsp;<span class="ident" id="3703023">p</span><span class="op" id="3703024">[</span><span class="ident" id="3703025">n</span><span class="op" id="3703026">:</span><span class="op" id="3703027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703033">if</span>&nbsp;<span class="builtinfunc" id="3703036">len</span><span class="op" id="3703039">(</span><span class="ident" id="3703040">p</span><span class="op" id="3703041">)</span>&nbsp;<span class="op" id="3703043">&gt;=</span>&nbsp;<span class="ident" id="3703046">chunk</span>&nbsp;<span class="op" id="3703052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703056">n</span>&nbsp;<span class="op" id="3703058">:=</span>&nbsp;<span class="builtinfunc" id="3703061">len</span><span class="op" id="3703064">(</span><span class="ident" id="3703065">p</span><span class="op" id="3703066">)</span>&nbsp;<span class="op" id="3703068">&amp;^</span>&nbsp;<span class="op" id="3703071">(</span><span class="ident" id="3703072">chunk</span>&nbsp;<span class="op" id="3703078">-</span>&nbsp;<span class="num" id="3703080">1</span><span class="op" id="3703081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703085">block</span><span class="op" id="3703090">(</span><span class="ident" id="3703091">d</span><span class="op" id="3703092">,</span>&nbsp;<span class="ident" id="3703094">p</span><span class="op" id="3703095">[</span><span class="op" id="3703096">:</span><span class="ident" id="3703097">n</span><span class="op" id="3703098">]</span><span class="op" id="3703099">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703103">p</span>&nbsp;<span class="op" id="3703105">=</span>&nbsp;<span class="ident" id="3703107">p</span><span class="op" id="3703108">[</span><span class="ident" id="3703109">n</span><span class="op" id="3703110">:</span><span class="op" id="3703111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703117">if</span>&nbsp;<span class="builtinfunc" id="3703120">len</span><span class="op" id="3703123">(</span><span class="ident" id="3703124">p</span><span class="op" id="3703125">)</span>&nbsp;<span class="op" id="3703127">&gt;</span>&nbsp;<span class="num" id="3703129">0</span>&nbsp;<span class="op" id="3703131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703135">d</span><span class="op" id="3703136">.</span><span class="ident" id="3703137">nx</span>&nbsp;<span class="op" id="3703140">=</span>&nbsp;<span class="builtinfunc" id="3703142">copy</span><span class="op" id="3703146">(</span><span class="ident" id="3703147">d</span><span class="op" id="3703148">.</span><span class="ident" id="3703149">x</span><span class="op" id="3703150">[</span><span class="op" id="3703151">:</span><span class="op" id="3703152">]</span><span class="op" id="3703153">,</span>&nbsp;<span class="ident" id="3703155">p</span><span class="op" id="3703156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703159">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703162">return</span><br>
<span class="lineno"></span><span class="op" id="3703169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703172">func</span>&nbsp;<span class="op" id="3703177">(</span><span class="ident" id="3703178">d0</span>&nbsp;<span class="op" id="3703181">*</span><span class="ident" id="3703182">digest</span><span class="op" id="3703188">)</span>&nbsp;<span class="ident" id="3703190">Sum</span><span class="op" id="3703193">(</span><span class="ident" id="3703194">in</span>&nbsp;<span class="op" id="3703197">[</span><span class="op" id="3703198">]</span><span class="builtintype" id="3703199">byte</span><span class="op" id="3703203">)</span>&nbsp;<span class="op" id="3703205">[</span><span class="op" id="3703206">]</span><span class="builtintype" id="3703207">byte</span>&nbsp;<span class="op" id="3703212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703215">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703282">d</span>&nbsp;<span class="op" id="3703284">:=</span>&nbsp;<span class="op" id="3703287">*</span><span class="ident" id="3703288">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703292">hash</span>&nbsp;<span class="op" id="3703297">:=</span>&nbsp;<span class="ident" id="3703300">d</span><span class="op" id="3703301">.</span><span class="ident" id="3703302">checkSum</span><span class="op" id="3703310">(</span><span class="op" id="3703311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703314">if</span>&nbsp;<span class="ident" id="3703317">d</span><span class="op" id="3703318">.</span><span class="ident" id="3703319">is224</span>&nbsp;<span class="op" id="3703325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703329">return</span>&nbsp;<span class="builtinfunc" id="3703336">append</span><span class="op" id="3703342">(</span><span class="ident" id="3703343">in</span><span class="op" id="3703345">,</span>&nbsp;<span class="ident" id="3703347">hash</span><span class="op" id="3703351">[</span><span class="op" id="3703352">:</span><span class="ident" id="3703353">Size224</span><span class="op" id="3703360">]</span><span class="op" id="3703361">...</span><span class="op" id="3703364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703367">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703370">return</span>&nbsp;<span class="builtinfunc" id="3703377">append</span><span class="op" id="3703383">(</span><span class="ident" id="3703384">in</span><span class="op" id="3703386">,</span>&nbsp;<span class="ident" id="3703388">hash</span><span class="op" id="3703392">[</span><span class="op" id="3703393">:</span><span class="op" id="3703394">]</span><span class="op" id="3703395">...</span><span class="op" id="3703398">)</span><br>
<span class="lineno"></span><span class="op" id="3703400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703403">func</span>&nbsp;<span class="op" id="3703408">(</span><span class="ident" id="3703409">d</span>&nbsp;<span class="op" id="3703411">*</span><span class="ident" id="3703412">digest</span><span class="op" id="3703418">)</span>&nbsp;<span class="ident" id="3703420">checkSum</span><span class="op" id="3703428">(</span><span class="op" id="3703429">)</span>&nbsp;<span class="op" id="3703431">[</span><span class="ident" id="3703432">Size</span><span class="op" id="3703436">]</span><span class="builtintype" id="3703437">byte</span>&nbsp;<span class="op" id="3703442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703445">len</span>&nbsp;<span class="op" id="3703449">:=</span>&nbsp;<span class="ident" id="3703452">d</span><span class="op" id="3703453">.</span><span class="builtinfunc" id="3703454">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703459">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703519">var</span>&nbsp;<span class="ident" id="3703523">tmp</span>&nbsp;<span class="op" id="3703527">[</span><span class="num" id="3703528">64</span><span class="op" id="3703530">]</span><span class="builtintype" id="3703531">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703537">tmp</span><span class="op" id="3703540">[</span><span class="num" id="3703541">0</span><span class="op" id="3703542">]</span>&nbsp;<span class="op" id="3703544">=</span>&nbsp;<span class="num" id="3703546">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703552">if</span>&nbsp;<span class="builtinfunc" id="3703555">len</span><span class="op" id="3703558">%</span><span class="num" id="3703559">64</span>&nbsp;<span class="op" id="3703562">&lt;</span>&nbsp;<span class="num" id="3703564">56</span>&nbsp;<span class="op" id="3703567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703571">d</span><span class="op" id="3703572">.</span><span class="ident" id="3703573">Write</span><span class="op" id="3703578">(</span><span class="ident" id="3703579">tmp</span><span class="op" id="3703582">[</span><span class="num" id="3703583">0</span>&nbsp;<span class="op" id="3703585">:</span>&nbsp;<span class="num" id="3703587">56</span><span class="op" id="3703589">-</span><span class="builtinfunc" id="3703590">len</span><span class="op" id="3703593">%</span><span class="num" id="3703594">64</span><span class="op" id="3703596">]</span><span class="op" id="3703597">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703600">}</span>&nbsp;<span class="keyword" id="3703602">else</span>&nbsp;<span class="op" id="3703607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703611">d</span><span class="op" id="3703612">.</span><span class="ident" id="3703613">Write</span><span class="op" id="3703618">(</span><span class="ident" id="3703619">tmp</span><span class="op" id="3703622">[</span><span class="num" id="3703623">0</span>&nbsp;<span class="op" id="3703625">:</span>&nbsp;<span class="num" id="3703627">64</span><span class="op" id="3703629">+</span><span class="num" id="3703630">56</span><span class="op" id="3703632">-</span><span class="builtinfunc" id="3703633">len</span><span class="op" id="3703636">%</span><span class="num" id="3703637">64</span><span class="op" id="3703639">]</span><span class="op" id="3703640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703647">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703667">len</span>&nbsp;<span class="op" id="3703671">&lt;&lt;=</span>&nbsp;<span class="num" id="3703675">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703678">for</span>&nbsp;<span class="ident" id="3703682">i</span>&nbsp;<span class="op" id="3703684">:=</span>&nbsp;<span class="builtintype" id="3703687">uint</span><span class="op" id="3703691">(</span><span class="num" id="3703692">0</span><span class="op" id="3703693">)</span><span class="op" id="3703694">;</span>&nbsp;<span class="ident" id="3703696">i</span>&nbsp;<span class="op" id="3703698">&lt;</span>&nbsp;<span class="num" id="3703700">8</span><span class="op" id="3703701">;</span>&nbsp;<span class="ident" id="3703703">i</span><span class="op" id="3703704">++</span>&nbsp;<span class="op" id="3703707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703711">tmp</span><span class="op" id="3703714">[</span><span class="ident" id="3703715">i</span><span class="op" id="3703716">]</span>&nbsp;<span class="op" id="3703718">=</span>&nbsp;<span class="builtintype" id="3703720">byte</span><span class="op" id="3703724">(</span><span class="builtinfunc" id="3703725">len</span>&nbsp;<span class="op" id="3703729">&gt;&gt;</span>&nbsp;<span class="op" id="3703732">(</span><span class="num" id="3703733">56</span>&nbsp;<span class="op" id="3703736">-</span>&nbsp;<span class="num" id="3703738">8</span><span class="op" id="3703739">*</span><span class="ident" id="3703740">i</span><span class="op" id="3703741">)</span><span class="op" id="3703742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703748">d</span><span class="op" id="3703749">.</span><span class="ident" id="3703750">Write</span><span class="op" id="3703755">(</span><span class="ident" id="3703756">tmp</span><span class="op" id="3703759">[</span><span class="num" id="3703760">0</span><span class="op" id="3703761">:</span><span class="num" id="3703762">8</span><span class="op" id="3703763">]</span><span class="op" id="3703764">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703768">if</span>&nbsp;<span class="ident" id="3703771">d</span><span class="op" id="3703772">.</span><span class="ident" id="3703773">nx</span>&nbsp;<span class="op" id="3703776">!=</span>&nbsp;<span class="num" id="3703779">0</span>&nbsp;<span class="op" id="3703781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703785">panic</span><span class="op" id="3703790">(</span><span class="string" id="3703791">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="3703802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703809">h</span>&nbsp;<span class="op" id="3703811">:=</span>&nbsp;<span class="ident" id="3703814">d</span><span class="op" id="3703815">.</span><span class="ident" id="3703816">h</span><span class="op" id="3703817">[</span><span class="op" id="3703818">:</span><span class="op" id="3703819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703822">if</span>&nbsp;<span class="ident" id="3703825">d</span><span class="op" id="3703826">.</span><span class="ident" id="3703827">is224</span>&nbsp;<span class="op" id="3703833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703837">h</span>&nbsp;<span class="op" id="3703839">=</span>&nbsp;<span class="ident" id="3703841">d</span><span class="op" id="3703842">.</span><span class="ident" id="3703843">h</span><span class="op" id="3703844">[</span><span class="op" id="3703845">:</span><span class="num" id="3703846">7</span><span class="op" id="3703847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703854">var</span>&nbsp;<span class="ident" id="3703858">digest</span>&nbsp;<span class="op" id="3703865">[</span><span class="ident" id="3703866">Size</span><span class="op" id="3703870">]</span><span class="builtintype" id="3703871">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703877">for</span>&nbsp;<span class="ident" id="3703881">i</span><span class="op" id="3703882">,</span>&nbsp;<span class="ident" id="3703884">s</span>&nbsp;<span class="op" id="3703886">:=</span>&nbsp;<span class="keyword" id="3703889">range</span>&nbsp;<span class="ident" id="3703895">h</span>&nbsp;<span class="op" id="3703897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703901">digest</span><span class="op" id="3703907">[</span><span class="ident" id="3703908">i</span><span class="op" id="3703909">*</span><span class="num" id="3703910">4</span><span class="op" id="3703911">]</span>&nbsp;<span class="op" id="3703913">=</span>&nbsp;<span class="builtintype" id="3703915">byte</span><span class="op" id="3703919">(</span><span class="ident" id="3703920">s</span>&nbsp;<span class="op" id="3703922">&gt;&gt;</span>&nbsp;<span class="num" id="3703925">24</span><span class="op" id="3703927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703931">digest</span><span class="op" id="3703937">[</span><span class="ident" id="3703938">i</span><span class="op" id="3703939">*</span><span class="num" id="3703940">4</span><span class="op" id="3703941">+</span><span class="num" id="3703942">1</span><span class="op" id="3703943">]</span>&nbsp;<span class="op" id="3703945">=</span>&nbsp;<span class="builtintype" id="3703947">byte</span><span class="op" id="3703951">(</span><span class="ident" id="3703952">s</span>&nbsp;<span class="op" id="3703954">&gt;&gt;</span>&nbsp;<span class="num" id="3703957">16</span><span class="op" id="3703959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703963">digest</span><span class="op" id="3703969">[</span><span class="ident" id="3703970">i</span><span class="op" id="3703971">*</span><span class="num" id="3703972">4</span><span class="op" id="3703973">+</span><span class="num" id="3703974">2</span><span class="op" id="3703975">]</span>&nbsp;<span class="op" id="3703977">=</span>&nbsp;<span class="builtintype" id="3703979">byte</span><span class="op" id="3703983">(</span><span class="ident" id="3703984">s</span>&nbsp;<span class="op" id="3703986">&gt;&gt;</span>&nbsp;<span class="num" id="3703989">8</span><span class="op" id="3703990">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703994">digest</span><span class="op" id="3704000">[</span><span class="ident" id="3704001">i</span><span class="op" id="3704002">*</span><span class="num" id="3704003">4</span><span class="op" id="3704004">+</span><span class="num" id="3704005">3</span><span class="op" id="3704006">]</span>&nbsp;<span class="op" id="3704008">=</span>&nbsp;<span class="builtintype" id="3704010">byte</span><span class="op" id="3704014">(</span><span class="ident" id="3704015">s</span><span class="op" id="3704016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704023">return</span>&nbsp;<span class="ident" id="3704030">digest</span><br>
<span class="lineno"></span><span class="op" id="3704037">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="3704040">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3704091">func</span>&nbsp;<span class="ident" id="3704096">Sum256</span><span class="op" id="3704102">(</span><span class="ident" id="3704103">data</span>&nbsp;<span class="op" id="3704108">[</span><span class="op" id="3704109">]</span><span class="builtintype" id="3704110">byte</span><span class="op" id="3704114">)</span>&nbsp;<span class="op" id="3704116">[</span><span class="ident" id="3704117">Size</span><span class="op" id="3704121">]</span><span class="builtintype" id="3704122">byte</span>&nbsp;<span class="op" id="3704127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704130">var</span>&nbsp;<span class="ident" id="3704134">d</span>&nbsp;<span class="ident" id="3704136">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704144">d</span><span class="op" id="3704145">.</span><span class="ident" id="3704146">Reset</span><span class="op" id="3704151">(</span><span class="op" id="3704152">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704155">d</span><span class="op" id="3704156">.</span><span class="ident" id="3704157">Write</span><span class="op" id="3704162">(</span><span class="ident" id="3704163">data</span><span class="op" id="3704167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704170">return</span>&nbsp;<span class="ident" id="3704177">d</span><span class="op" id="3704178">.</span><span class="ident" id="3704179">checkSum</span><span class="op" id="3704187">(</span><span class="op" id="3704188">)</span><br>
<span class="lineno"></span><span class="op" id="3704190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3704193">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="3704244">func</span>&nbsp;<span class="ident" id="3704249">Sum224</span><span class="op" id="3704255">(</span><span class="ident" id="3704256">data</span>&nbsp;<span class="op" id="3704261">[</span><span class="op" id="3704262">]</span><span class="builtintype" id="3704263">byte</span><span class="op" id="3704267">)</span>&nbsp;<span class="op" id="3704269">(</span><span class="ident" id="3704270">sum224</span>&nbsp;<span class="op" id="3704277">[</span><span class="ident" id="3704278">Size224</span><span class="op" id="3704285">]</span><span class="builtintype" id="3704286">byte</span><span class="op" id="3704290">)</span>&nbsp;<span class="op" id="3704292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704295">var</span>&nbsp;<span class="ident" id="3704299">d</span>&nbsp;<span class="ident" id="3704301">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704309">d</span><span class="op" id="3704310">.</span><span class="ident" id="3704311">is224</span>&nbsp;<span class="op" id="3704317">=</span>&nbsp;<span class="builtintype" id="3704319">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704325">d</span><span class="op" id="3704326">.</span><span class="ident" id="3704327">Reset</span><span class="op" id="3704332">(</span><span class="op" id="3704333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704336">d</span><span class="op" id="3704337">.</span><span class="ident" id="3704338">Write</span><span class="op" id="3704343">(</span><span class="ident" id="3704344">data</span><span class="op" id="3704348">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704351">sum</span>&nbsp;<span class="op" id="3704355">:=</span>&nbsp;<span class="ident" id="3704358">d</span><span class="op" id="3704359">.</span><span class="ident" id="3704360">checkSum</span><span class="op" id="3704368">(</span><span class="op" id="3704369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3704372">copy</span><span class="op" id="3704376">(</span><span class="ident" id="3704377">sum224</span><span class="op" id="3704383">[</span><span class="op" id="3704384">:</span><span class="op" id="3704385">]</span><span class="op" id="3704386">,</span>&nbsp;<span class="ident" id="3704388">sum</span><span class="op" id="3704391">[</span><span class="op" id="3704392">:</span><span class="ident" id="3704393">Size224</span><span class="op" id="3704400">]</span><span class="op" id="3704401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704404">return</span><br>
<span class="lineno"></span><span class="op" id="3704411">}</span>
</div>
</body>
</html>
