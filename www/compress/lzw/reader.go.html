<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6325079">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6325134">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6325188">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6325239">//&nbsp;Package&nbsp;lzw&nbsp;implements&nbsp;the&nbsp;Lempel-Ziv-Welch&nbsp;compressed&nbsp;data&nbsp;format,</span><br>
<span class="lineno"></span><span class="comment" id="6325310">//&nbsp;described&nbsp;in&nbsp;T.&nbsp;A.&nbsp;Welch,&nbsp;``A&nbsp;Technique&nbsp;for&nbsp;High-Performance&nbsp;Data</span><br>
<span class="lineno"></span><span class="comment" id="6325379">//&nbsp;Compression&#39;&#39;,&nbsp;Computer,&nbsp;17(6)&nbsp;(June&nbsp;1984),&nbsp;pp&nbsp;8-19.</span><br>
<span class="lineno"></span><span class="comment" id="6325435">//</span><br>
<span class="lineno"></span><span class="comment" id="6325438">//&nbsp;In&nbsp;particular,&nbsp;it&nbsp;implements&nbsp;LZW&nbsp;as&nbsp;used&nbsp;by&nbsp;the&nbsp;GIF&nbsp;and&nbsp;PDF&nbsp;file</span><br>
<span class="lineno">10</span><span class="comment" id="6325506">//&nbsp;formats,&nbsp;which&nbsp;means&nbsp;variable-width&nbsp;codes&nbsp;up&nbsp;to&nbsp;12&nbsp;bits&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="6325579">//&nbsp;two&nbsp;non-literal&nbsp;codes&nbsp;are&nbsp;a&nbsp;clear&nbsp;code&nbsp;and&nbsp;an&nbsp;EOF&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="6325638">//</span><br>
<span class="lineno"></span><span class="comment" id="6325641">//&nbsp;The&nbsp;TIFF&nbsp;file&nbsp;format&nbsp;uses&nbsp;a&nbsp;similar&nbsp;but&nbsp;incompatible&nbsp;version&nbsp;of&nbsp;the&nbsp;LZW</span><br>
<span class="lineno"></span><span class="comment" id="6325716">//&nbsp;algorithm.&nbsp;See&nbsp;the&nbsp;golang.org/x/image/tiff/lzw&nbsp;package&nbsp;for&nbsp;an</span><br>
<span class="lineno">15</span><span class="comment" id="6325781">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="6325800">package</span>&nbsp;<span class="ident" id="6325808">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6325813">//&nbsp;TODO(nigeltao):&nbsp;check&nbsp;that&nbsp;PDF&nbsp;uses&nbsp;LZW&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;as&nbsp;GIF,</span><br>
<span class="lineno"></span><span class="comment" id="6325880">//&nbsp;modulo&nbsp;LSB/MSB&nbsp;packing&nbsp;order.</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6325914">import</span>&nbsp;<span class="op" id="6325921">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6325924">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6325933">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6325943">&#34;fmt&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6325950">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6325955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6325958">//&nbsp;Order&nbsp;specifies&nbsp;the&nbsp;bit&nbsp;ordering&nbsp;in&nbsp;an&nbsp;LZW&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6326017">type</span>&nbsp;<span class="ident" id="6326022">Order</span>&nbsp;<span class="builtintype" id="6326028">int</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6326033">const</span>&nbsp;<span class="op" id="6326039">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326042">//&nbsp;LSB&nbsp;means&nbsp;Least&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;GIF&nbsp;file&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326118">LSB</span>&nbsp;<span class="ident" id="6326122"><a href="/compress/lzw/reader.go.html#6326022">Order</a></span>&nbsp;<span class="op" id="6326128">=</span>&nbsp;<span class="ident" id="6326130">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326136">//&nbsp;MSB&nbsp;means&nbsp;Most&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;TIFF&nbsp;and&nbsp;PDF</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326207">//&nbsp;file&nbsp;formats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326225">MSB</span><br>
<span class="lineno"></span><span class="op" id="6326229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6326232">const</span>&nbsp;<span class="op" id="6326238">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326241">maxWidth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6326260">=</span>&nbsp;<span class="num" id="6326262">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326266">decoderInvalidCode</span>&nbsp;<span class="op" id="6326285">=</span>&nbsp;<span class="num" id="6326287">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326295">flushBuffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6326314">=</span>&nbsp;<span class="num" id="6326316">1</span>&nbsp;<span class="op" id="6326318">&lt;&lt;</span>&nbsp;<span class="ident" id="6326321"><a href="/compress/lzw/reader.go.html#6326241">maxWidth</a></span><br>
<span class="lineno"></span><span class="op" id="6326330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6326333">//&nbsp;decoder&nbsp;is&nbsp;the&nbsp;state&nbsp;from&nbsp;which&nbsp;the&nbsp;readXxx&nbsp;method&nbsp;converts&nbsp;a&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="6326403">//&nbsp;stream&nbsp;into&nbsp;a&nbsp;code&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6326433">type</span>&nbsp;<span class="ident" id="6326438">decoder</span>&nbsp;<span class="keyword" id="6326446">struct</span>&nbsp;<span class="op" id="6326453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326456">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6326465"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6326467">.</span><span class="ident" id="6326468">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326480">bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6326489">uint32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326497">nBits</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6326506">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326512">width</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6326521">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326527">read</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6326536">func</span><span class="op" id="6326540">(</span><span class="op" id="6326541">*</span><span class="ident" id="6326542"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6326549">)</span>&nbsp;<span class="op" id="6326551">(</span><span class="builtintype" id="6326552">uint16</span><span class="op" id="6326558">,</span>&nbsp;<span class="builtintype" id="6326560">error</span><span class="op" id="6326565">)</span>&nbsp;<span class="comment" id="6326567">//&nbsp;readLSB&nbsp;or&nbsp;readMSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326590">litWidth</span>&nbsp;<span class="builtintype" id="6326599">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6326630">//&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326665">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6326674">error</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326682">//&nbsp;The&nbsp;first&nbsp;1&lt;&lt;litWidth&nbsp;codes&nbsp;are&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326733">//&nbsp;The&nbsp;next&nbsp;two&nbsp;codes&nbsp;mean&nbsp;clear&nbsp;and&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326776">//&nbsp;Other&nbsp;valid&nbsp;codes&nbsp;are&nbsp;in&nbsp;the&nbsp;range&nbsp;[lo,&nbsp;hi]&nbsp;where&nbsp;lo&nbsp;:=&nbsp;clear&nbsp;+&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326847">//&nbsp;with&nbsp;the&nbsp;upper&nbsp;bound&nbsp;incrementing&nbsp;on&nbsp;each&nbsp;code&nbsp;seen.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326904">//&nbsp;overflow&nbsp;is&nbsp;the&nbsp;code&nbsp;at&nbsp;which&nbsp;hi&nbsp;overflows&nbsp;the&nbsp;code&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326967">//&nbsp;last&nbsp;is&nbsp;the&nbsp;most&nbsp;recently&nbsp;seen&nbsp;code,&nbsp;or&nbsp;decoderInvalidCode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327031">clear</span><span class="op" id="6327036">,</span>&nbsp;<span class="ident" id="6327038">eof</span><span class="op" id="6327041">,</span>&nbsp;<span class="ident" id="6327043">hi</span><span class="op" id="6327045">,</span>&nbsp;<span class="ident" id="6327047">overflow</span><span class="op" id="6327055">,</span>&nbsp;<span class="ident" id="6327057">last</span>&nbsp;<span class="builtintype" id="6327062">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327071">//&nbsp;Each&nbsp;code&nbsp;c&nbsp;in&nbsp;[lo,&nbsp;hi]&nbsp;expands&nbsp;to&nbsp;two&nbsp;or&nbsp;more&nbsp;bytes.&nbsp;For&nbsp;c&nbsp;!=&nbsp;hi:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327142">//&nbsp;&nbsp;&nbsp;suffix[c]&nbsp;is&nbsp;the&nbsp;last&nbsp;of&nbsp;these&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327186">//&nbsp;&nbsp;&nbsp;prefix[c]&nbsp;is&nbsp;the&nbsp;code&nbsp;for&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327241">//&nbsp;&nbsp;&nbsp;This&nbsp;code&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;literal&nbsp;code&nbsp;or&nbsp;another&nbsp;code&nbsp;in&nbsp;[lo,&nbsp;c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327314">//&nbsp;The&nbsp;c&nbsp;==&nbsp;hi&nbsp;case&nbsp;is&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327354">suffix</span>&nbsp;<span class="op" id="6327361">[</span><span class="num" id="6327362">1</span>&nbsp;<span class="op" id="6327364">&lt;&lt;</span>&nbsp;<span class="ident" id="6327367"><a href="/compress/lzw/reader.go.html#6326241">maxWidth</a></span><span class="op" id="6327375">]</span><span class="builtintype" id="6327376">uint8</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327383">prefix</span>&nbsp;<span class="op" id="6327390">[</span><span class="num" id="6327391">1</span>&nbsp;<span class="op" id="6327393">&lt;&lt;</span>&nbsp;<span class="ident" id="6327396"><a href="/compress/lzw/reader.go.html#6326241">maxWidth</a></span><span class="op" id="6327404">]</span><span class="builtintype" id="6327405">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327414">//&nbsp;output&nbsp;is&nbsp;the&nbsp;temporary&nbsp;output&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327457">//&nbsp;Literal&nbsp;codes&nbsp;are&nbsp;accumulated&nbsp;from&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327521">//&nbsp;Non-literal&nbsp;codes&nbsp;decode&nbsp;to&nbsp;a&nbsp;sequence&nbsp;of&nbsp;suffixes&nbsp;that&nbsp;are&nbsp;first</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327591">//&nbsp;written&nbsp;right-to-left&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;buffer&nbsp;before&nbsp;being&nbsp;copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327664">//&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327696">//&nbsp;It&nbsp;is&nbsp;flushed&nbsp;when&nbsp;it&nbsp;contains&nbsp;&gt;=&nbsp;1&lt;&lt;maxWidth&nbsp;bytes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327753">//&nbsp;so&nbsp;that&nbsp;there&nbsp;is&nbsp;always&nbsp;room&nbsp;to&nbsp;decode&nbsp;an&nbsp;entire&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327812">output</span>&nbsp;<span class="op" id="6327819">[</span><span class="num" id="6327820">2</span>&nbsp;<span class="op" id="6327822">*</span>&nbsp;<span class="num" id="6327824">1</span>&nbsp;<span class="op" id="6327826">&lt;&lt;</span>&nbsp;<span class="ident" id="6327829"><a href="/compress/lzw/reader.go.html#6326241">maxWidth</a></span><span class="op" id="6327837">]</span><span class="builtintype" id="6327838">byte</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327844">o</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6327851">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6327858">//&nbsp;write&nbsp;index&nbsp;into&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327886">toRead</span>&nbsp;<span class="op" id="6327893">[</span><span class="op" id="6327894">]</span><span class="builtintype" id="6327895">byte</span>&nbsp;<span class="comment" id="6327900">//&nbsp;bytes&nbsp;to&nbsp;return&nbsp;from&nbsp;Read</span><br>
<span class="lineno"></span><span class="op" id="6327929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327932">//&nbsp;readLSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Least&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno">85</span><span class="keyword" id="6328006">func</span>&nbsp;<span class="op" id="6328011">(</span><span class="ident" id="6328012">d</span>&nbsp;<span class="op" id="6328014">*</span><span class="ident" id="6328015"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6328022">)</span>&nbsp;<span class="ident" id="6328024">readLSB</span><span class="op" id="6328031">(</span><span class="op" id="6328032">)</span>&nbsp;<span class="op" id="6328034">(</span><span class="builtintype" id="6328035">uint16</span><span class="op" id="6328041">,</span>&nbsp;<span class="builtintype" id="6328043">error</span><span class="op" id="6328048">)</span>&nbsp;<span class="op" id="6328050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328053">for</span>&nbsp;<span class="ident" id="6328057"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328058">.</span><span class="ident" id="6328059">nBits</span>&nbsp;<span class="op" id="6328065">&lt;</span>&nbsp;<span class="ident" id="6328067"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328068">.</span><span class="ident" id="6328069">width</span>&nbsp;<span class="op" id="6328075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328079">x</span><span class="op" id="6328080">,</span>&nbsp;<span class="ident" id="6328082">err</span>&nbsp;<span class="op" id="6328086">:=</span>&nbsp;<span class="ident" id="6328089"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328090">.</span><span class="ident" id="6328091">r</span><span class="op" id="6328092">.</span><span class="ident" id="6328093">ReadByte</span><span class="op" id="6328101">(</span><span class="op" id="6328102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328106">if</span>&nbsp;<span class="ident" id="6328109"><a href="/compress/lzw/reader.go.html#6328082">err</a></span>&nbsp;<span class="op" id="6328113">!=</span>&nbsp;<span class="ident" id="6328116">nil</span>&nbsp;<span class="op" id="6328120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328125">return</span>&nbsp;<span class="num" id="6328132">0</span><span class="op" id="6328133">,</span>&nbsp;<span class="ident" id="6328135"><a href="/compress/lzw/reader.go.html#6328082">err</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328145"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328146">.</span><span class="ident" id="6328147">bits</span>&nbsp;<span class="op" id="6328152">|=</span>&nbsp;<span class="builtintype" id="6328155">uint32</span><span class="op" id="6328161">(</span><span class="ident" id="6328162"><a href="/compress/lzw/reader.go.html#6328079">x</a></span><span class="op" id="6328163">)</span>&nbsp;<span class="op" id="6328165">&lt;&lt;</span>&nbsp;<span class="ident" id="6328168"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328169">.</span><span class="ident" id="6328170">nBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328178"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328179">.</span><span class="ident" id="6328180">nBits</span>&nbsp;<span class="op" id="6328186">+=</span>&nbsp;<span class="num" id="6328189">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328195">code</span>&nbsp;<span class="op" id="6328200">:=</span>&nbsp;<span class="builtintype" id="6328203">uint16</span><span class="op" id="6328209">(</span><span class="ident" id="6328210"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328211">.</span><span class="ident" id="6328212">bits</span>&nbsp;<span class="op" id="6328217">&amp;</span>&nbsp;<span class="op" id="6328219">(</span><span class="num" id="6328220">1</span><span class="op" id="6328221">&lt;&lt;</span><span class="ident" id="6328223"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328224">.</span><span class="ident" id="6328225">width</span>&nbsp;<span class="op" id="6328231">-</span>&nbsp;<span class="num" id="6328233">1</span><span class="op" id="6328234">)</span><span class="op" id="6328235">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328238"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328239">.</span><span class="ident" id="6328240">bits</span>&nbsp;<span class="op" id="6328245">&gt;&gt;=</span>&nbsp;<span class="ident" id="6328249"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328250">.</span><span class="ident" id="6328251">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328258"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328259">.</span><span class="ident" id="6328260">nBits</span>&nbsp;<span class="op" id="6328266">-=</span>&nbsp;<span class="ident" id="6328269"><a href="/compress/lzw/reader.go.html#6328012">d</a></span><span class="op" id="6328270">.</span><span class="ident" id="6328271">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328278">return</span>&nbsp;<span class="ident" id="6328285"><a href="/compress/lzw/reader.go.html#6328195">code</a></span><span class="op" id="6328289">,</span>&nbsp;<span class="ident" id="6328291">nil</span><br>
<span class="lineno"></span><span class="op" id="6328295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6328298">//&nbsp;readMSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Most&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6328371">func</span>&nbsp;<span class="op" id="6328376">(</span><span class="ident" id="6328377">d</span>&nbsp;<span class="op" id="6328379">*</span><span class="ident" id="6328380"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6328387">)</span>&nbsp;<span class="ident" id="6328389">readMSB</span><span class="op" id="6328396">(</span><span class="op" id="6328397">)</span>&nbsp;<span class="op" id="6328399">(</span><span class="builtintype" id="6328400">uint16</span><span class="op" id="6328406">,</span>&nbsp;<span class="builtintype" id="6328408">error</span><span class="op" id="6328413">)</span>&nbsp;<span class="op" id="6328415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328418">for</span>&nbsp;<span class="ident" id="6328422"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328423">.</span><span class="ident" id="6328424">nBits</span>&nbsp;<span class="op" id="6328430">&lt;</span>&nbsp;<span class="ident" id="6328432"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328433">.</span><span class="ident" id="6328434">width</span>&nbsp;<span class="op" id="6328440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328444">x</span><span class="op" id="6328445">,</span>&nbsp;<span class="ident" id="6328447">err</span>&nbsp;<span class="op" id="6328451">:=</span>&nbsp;<span class="ident" id="6328454"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328455">.</span><span class="ident" id="6328456">r</span><span class="op" id="6328457">.</span><span class="ident" id="6328458">ReadByte</span><span class="op" id="6328466">(</span><span class="op" id="6328467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328471">if</span>&nbsp;<span class="ident" id="6328474"><a href="/compress/lzw/reader.go.html#6328447">err</a></span>&nbsp;<span class="op" id="6328478">!=</span>&nbsp;<span class="ident" id="6328481">nil</span>&nbsp;<span class="op" id="6328485">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328490">return</span>&nbsp;<span class="num" id="6328497">0</span><span class="op" id="6328498">,</span>&nbsp;<span class="ident" id="6328500"><a href="/compress/lzw/reader.go.html#6328447">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328510"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328511">.</span><span class="ident" id="6328512">bits</span>&nbsp;<span class="op" id="6328517">|=</span>&nbsp;<span class="builtintype" id="6328520">uint32</span><span class="op" id="6328526">(</span><span class="ident" id="6328527"><a href="/compress/lzw/reader.go.html#6328444">x</a></span><span class="op" id="6328528">)</span>&nbsp;<span class="op" id="6328530">&lt;&lt;</span>&nbsp;<span class="op" id="6328533">(</span><span class="num" id="6328534">24</span>&nbsp;<span class="op" id="6328537">-</span>&nbsp;<span class="ident" id="6328539"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328540">.</span><span class="ident" id="6328541">nBits</span><span class="op" id="6328546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328550"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328551">.</span><span class="ident" id="6328552">nBits</span>&nbsp;<span class="op" id="6328558">+=</span>&nbsp;<span class="num" id="6328561">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328564">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328567">code</span>&nbsp;<span class="op" id="6328572">:=</span>&nbsp;<span class="builtintype" id="6328575">uint16</span><span class="op" id="6328581">(</span><span class="ident" id="6328582"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328583">.</span><span class="ident" id="6328584">bits</span>&nbsp;<span class="op" id="6328589">&gt;&gt;</span>&nbsp;<span class="op" id="6328592">(</span><span class="num" id="6328593">32</span>&nbsp;<span class="op" id="6328596">-</span>&nbsp;<span class="ident" id="6328598"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328599">.</span><span class="ident" id="6328600">width</span><span class="op" id="6328605">)</span><span class="op" id="6328606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328609"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328610">.</span><span class="ident" id="6328611">bits</span>&nbsp;<span class="op" id="6328616">&lt;&lt;=</span>&nbsp;<span class="ident" id="6328620"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328621">.</span><span class="ident" id="6328622">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328629"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328630">.</span><span class="ident" id="6328631">nBits</span>&nbsp;<span class="op" id="6328637">-=</span>&nbsp;<span class="ident" id="6328640"><a href="/compress/lzw/reader.go.html#6328377">d</a></span><span class="op" id="6328641">.</span><span class="ident" id="6328642">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328649">return</span>&nbsp;<span class="ident" id="6328656"><a href="/compress/lzw/reader.go.html#6328567">code</a></span><span class="op" id="6328660">,</span>&nbsp;<span class="ident" id="6328662">nil</span><br>
<span class="lineno"></span><span class="op" id="6328666">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="6328669">func</span>&nbsp;<span class="op" id="6328674">(</span><span class="ident" id="6328675">d</span>&nbsp;<span class="op" id="6328677">*</span><span class="ident" id="6328678"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6328685">)</span>&nbsp;<span class="ident" id="6328687">Read</span><span class="op" id="6328691">(</span><span class="ident" id="6328692">b</span>&nbsp;<span class="op" id="6328694">[</span><span class="op" id="6328695">]</span><span class="builtintype" id="6328696">byte</span><span class="op" id="6328700">)</span>&nbsp;<span class="op" id="6328702">(</span><span class="builtintype" id="6328703">int</span><span class="op" id="6328706">,</span>&nbsp;<span class="builtintype" id="6328708">error</span><span class="op" id="6328713">)</span>&nbsp;<span class="op" id="6328715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328718">for</span>&nbsp;<span class="op" id="6328722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328726">if</span>&nbsp;<span class="builtinfunc" id="6328729">len</span><span class="op" id="6328732">(</span><span class="ident" id="6328733"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328734">.</span><span class="ident" id="6328735">toRead</span><span class="op" id="6328741">)</span>&nbsp;<span class="op" id="6328743">&gt;</span>&nbsp;<span class="num" id="6328745">0</span>&nbsp;<span class="op" id="6328747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328752">n</span>&nbsp;<span class="op" id="6328754">:=</span>&nbsp;<span class="builtinfunc" id="6328757">copy</span><span class="op" id="6328761">(</span><span class="ident" id="6328762"><a href="/compress/lzw/reader.go.html#6328692">b</a></span><span class="op" id="6328763">,</span>&nbsp;<span class="ident" id="6328765"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328766">.</span><span class="ident" id="6328767">toRead</span><span class="op" id="6328773">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328778"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328779">.</span><span class="ident" id="6328780">toRead</span>&nbsp;<span class="op" id="6328787">=</span>&nbsp;<span class="ident" id="6328789"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328790">.</span><span class="ident" id="6328791">toRead</span><span class="op" id="6328797">[</span><span class="ident" id="6328798"><a href="/compress/lzw/reader.go.html#6328752">n</a></span><span class="op" id="6328799">:</span><span class="op" id="6328800">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328805">return</span>&nbsp;<span class="ident" id="6328812"><a href="/compress/lzw/reader.go.html#6328752">n</a></span><span class="op" id="6328813">,</span>&nbsp;<span class="ident" id="6328815">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328825">if</span>&nbsp;<span class="ident" id="6328828"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328829">.</span><span class="ident" id="6328830">err</span>&nbsp;<span class="op" id="6328834">!=</span>&nbsp;<span class="ident" id="6328837">nil</span>&nbsp;<span class="op" id="6328841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328846">return</span>&nbsp;<span class="num" id="6328853">0</span><span class="op" id="6328854">,</span>&nbsp;<span class="ident" id="6328856"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328857">.</span><span class="ident" id="6328858">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328868"><a href="/compress/lzw/reader.go.html#6328675">d</a></span><span class="op" id="6328869">.</span><span class="ident" id="6328870">decode</span><span class="op" id="6328876">(</span><span class="op" id="6328877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328880">}</span><br>
<span class="lineno"></span><span class="op" id="6328882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6328885">//&nbsp;decode&nbsp;decompresses&nbsp;bytes&nbsp;from&nbsp;r&nbsp;and&nbsp;leaves&nbsp;them&nbsp;in&nbsp;d.toRead.</span><br>
<span class="lineno"></span><span class="comment" id="6328950">//&nbsp;read&nbsp;specifies&nbsp;how&nbsp;to&nbsp;decode&nbsp;bytes&nbsp;into&nbsp;codes.</span><br>
<span class="lineno"></span><span class="comment" id="6329000">//&nbsp;litWidth&nbsp;is&nbsp;the&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span><span class="keyword" id="6329051">func</span>&nbsp;<span class="op" id="6329056">(</span><span class="ident" id="6329057">d</span>&nbsp;<span class="op" id="6329059">*</span><span class="ident" id="6329060"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6329067">)</span>&nbsp;<span class="ident" id="6329069">decode</span><span class="op" id="6329075">(</span><span class="op" id="6329076">)</span>&nbsp;<span class="op" id="6329078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329081">//&nbsp;Loop&nbsp;over&nbsp;the&nbsp;code&nbsp;stream,&nbsp;converting&nbsp;codes&nbsp;into&nbsp;decompressed&nbsp;bytes.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329154">for</span>&nbsp;<span class="op" id="6329158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329162">code</span><span class="op" id="6329166">,</span>&nbsp;<span class="ident" id="6329168">err</span>&nbsp;<span class="op" id="6329172">:=</span>&nbsp;<span class="ident" id="6329175"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329176">.</span><span class="ident" id="6329177">read</span><span class="op" id="6329181">(</span><span class="ident" id="6329182"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329187">if</span>&nbsp;<span class="ident" id="6329190"><a href="/compress/lzw/reader.go.html#6329168">err</a></span>&nbsp;<span class="op" id="6329194">!=</span>&nbsp;<span class="ident" id="6329197">nil</span>&nbsp;<span class="op" id="6329201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329206">if</span>&nbsp;<span class="ident" id="6329209"><a href="/compress/lzw/reader.go.html#6329168">err</a></span>&nbsp;<span class="op" id="6329213">==</span>&nbsp;<span class="ident" id="6329216"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6329218">.</span><span class="ident" id="6329219">EOF</span>&nbsp;<span class="op" id="6329223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329229"><a href="/compress/lzw/reader.go.html#6329168">err</a></span>&nbsp;<span class="op" id="6329233">=</span>&nbsp;<span class="ident" id="6329235"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6329237">.</span><span class="ident" id="6329238">ErrUnexpectedEOF</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6329258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329263"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329264">.</span><span class="ident" id="6329265">err</span>&nbsp;<span class="op" id="6329269">=</span>&nbsp;<span class="ident" id="6329271"><a href="/compress/lzw/reader.go.html#6329168">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329278">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6329287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329291">switch</span>&nbsp;<span class="op" id="6329298">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329302">case</span>&nbsp;<span class="ident" id="6329307"><a href="/compress/lzw/reader.go.html#6329162">code</a></span>&nbsp;<span class="op" id="6329312">&lt;</span>&nbsp;<span class="ident" id="6329314"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329315">.</span><span class="ident" id="6329316">clear</span><span class="op" id="6329321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329326">//&nbsp;We&nbsp;have&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329356"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329357">.</span><span class="ident" id="6329358">output</span><span class="op" id="6329364">[</span><span class="ident" id="6329365"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329366">.</span><span class="ident" id="6329367">o</span><span class="op" id="6329368">]</span>&nbsp;<span class="op" id="6329370">=</span>&nbsp;<span class="builtintype" id="6329372">uint8</span><span class="op" id="6329377">(</span><span class="ident" id="6329378"><a href="/compress/lzw/reader.go.html#6329162">code</a></span><span class="op" id="6329382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329387"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329388">.</span><span class="ident" id="6329389">o</span><span class="op" id="6329390">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329396">if</span>&nbsp;<span class="ident" id="6329399"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329400">.</span><span class="ident" id="6329401">last</span>&nbsp;<span class="op" id="6329406">!=</span>&nbsp;<span class="ident" id="6329409"><a href="/compress/lzw/reader.go.html#6326266">decoderInvalidCode</a></span>&nbsp;<span class="op" id="6329428">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329434">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329475"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329476">.</span><span class="ident" id="6329477">suffix</span><span class="op" id="6329483">[</span><span class="ident" id="6329484"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329485">.</span><span class="ident" id="6329486">hi</span><span class="op" id="6329488">]</span>&nbsp;<span class="op" id="6329490">=</span>&nbsp;<span class="builtintype" id="6329492">uint8</span><span class="op" id="6329497">(</span><span class="ident" id="6329498"><a href="/compress/lzw/reader.go.html#6329162">code</a></span><span class="op" id="6329502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329508"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329509">.</span><span class="ident" id="6329510">prefix</span><span class="op" id="6329516">[</span><span class="ident" id="6329517"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329518">.</span><span class="ident" id="6329519">hi</span><span class="op" id="6329521">]</span>&nbsp;<span class="op" id="6329523">=</span>&nbsp;<span class="ident" id="6329525"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329526">.</span><span class="ident" id="6329527">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6329535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329539">case</span>&nbsp;<span class="ident" id="6329544"><a href="/compress/lzw/reader.go.html#6329162">code</a></span>&nbsp;<span class="op" id="6329549">==</span>&nbsp;<span class="ident" id="6329552"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329553">.</span><span class="ident" id="6329554">clear</span><span class="op" id="6329559">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329564"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329565">.</span><span class="ident" id="6329566">width</span>&nbsp;<span class="op" id="6329572">=</span>&nbsp;<span class="num" id="6329574">1</span>&nbsp;<span class="op" id="6329576">+</span>&nbsp;<span class="builtintype" id="6329578">uint</span><span class="op" id="6329582">(</span><span class="ident" id="6329583"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329584">.</span><span class="ident" id="6329585">litWidth</span><span class="op" id="6329593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329598"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329599">.</span><span class="ident" id="6329600">hi</span>&nbsp;<span class="op" id="6329603">=</span>&nbsp;<span class="ident" id="6329605"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329606">.</span><span class="ident" id="6329607">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329614"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329615">.</span><span class="ident" id="6329616">overflow</span>&nbsp;<span class="op" id="6329625">=</span>&nbsp;<span class="num" id="6329627">1</span>&nbsp;<span class="op" id="6329629">&lt;&lt;</span>&nbsp;<span class="ident" id="6329632"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329633">.</span><span class="ident" id="6329634">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329643"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329644">.</span><span class="ident" id="6329645">last</span>&nbsp;<span class="op" id="6329650">=</span>&nbsp;<span class="ident" id="6329652"><a href="/compress/lzw/reader.go.html#6326266">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329674">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329685">case</span>&nbsp;<span class="ident" id="6329690"><a href="/compress/lzw/reader.go.html#6329162">code</a></span>&nbsp;<span class="op" id="6329695">==</span>&nbsp;<span class="ident" id="6329698"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329699">.</span><span class="ident" id="6329700">eof</span><span class="op" id="6329703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329708"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329709">.</span><span class="ident" id="6329710">flush</span><span class="op" id="6329715">(</span><span class="op" id="6329716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329721"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329722">.</span><span class="ident" id="6329723">err</span>&nbsp;<span class="op" id="6329727">=</span>&nbsp;<span class="ident" id="6329729"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6329731">.</span><span class="ident" id="6329732">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329739">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329748">case</span>&nbsp;<span class="ident" id="6329753"><a href="/compress/lzw/reader.go.html#6329162">code</a></span>&nbsp;<span class="op" id="6329758">&lt;=</span>&nbsp;<span class="ident" id="6329761"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329762">.</span><span class="ident" id="6329763">hi</span><span class="op" id="6329765">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329770">c</span><span class="op" id="6329771">,</span>&nbsp;<span class="ident" id="6329773">i</span>&nbsp;<span class="op" id="6329775">:=</span>&nbsp;<span class="ident" id="6329778"><a href="/compress/lzw/reader.go.html#6329162">code</a></span><span class="op" id="6329782">,</span>&nbsp;<span class="builtinfunc" id="6329784">len</span><span class="op" id="6329787">(</span><span class="ident" id="6329788"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329789">.</span><span class="ident" id="6329790">output</span><span class="op" id="6329796">)</span><span class="op" id="6329797">-</span><span class="num" id="6329798">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6329803">if</span>&nbsp;<span class="ident" id="6329806"><a href="/compress/lzw/reader.go.html#6329162">code</a></span>&nbsp;<span class="op" id="6329811">==</span>&nbsp;<span class="ident" id="6329814"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6329815">.</span><span class="ident" id="6329816">hi</span>&nbsp;<span class="op" id="6329819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329825">//&nbsp;code&nbsp;==&nbsp;hi&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;which&nbsp;expands&nbsp;to&nbsp;the&nbsp;last&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329897">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;head&nbsp;of&nbsp;the&nbsp;last&nbsp;expansion.&nbsp;To&nbsp;find&nbsp;the&nbsp;head,&nbsp;we&nbsp;walk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329974">//&nbsp;the&nbsp;prefix&nbsp;chain&nbsp;until&nbsp;we&nbsp;find&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330028"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330030">=</span>&nbsp;<span class="ident" id="6330032"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330033">.</span><span class="ident" id="6330034">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330043">for</span>&nbsp;<span class="ident" id="6330047"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330049">&gt;=</span>&nbsp;<span class="ident" id="6330052"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330053">.</span><span class="ident" id="6330054">clear</span>&nbsp;<span class="op" id="6330060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330067"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330069">=</span>&nbsp;<span class="ident" id="6330071"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330072">.</span><span class="ident" id="6330073">prefix</span><span class="op" id="6330079">[</span><span class="ident" id="6330080"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330093"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330094">.</span><span class="ident" id="6330095">output</span><span class="op" id="6330101">[</span><span class="ident" id="6330102"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330103">]</span>&nbsp;<span class="op" id="6330105">=</span>&nbsp;<span class="builtintype" id="6330107">uint8</span><span class="op" id="6330112">(</span><span class="ident" id="6330113"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330114">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330120"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330121">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330128"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330130">=</span>&nbsp;<span class="ident" id="6330132"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330133">.</span><span class="ident" id="6330134">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6330147">//&nbsp;Copy&nbsp;the&nbsp;suffix&nbsp;chain&nbsp;into&nbsp;output&nbsp;and&nbsp;then&nbsp;write&nbsp;that&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330213">for</span>&nbsp;<span class="ident" id="6330217"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330219">&gt;=</span>&nbsp;<span class="ident" id="6330222"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330223">.</span><span class="ident" id="6330224">clear</span>&nbsp;<span class="op" id="6330230">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330236"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330237">.</span><span class="ident" id="6330238">output</span><span class="op" id="6330244">[</span><span class="ident" id="6330245"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330246">]</span>&nbsp;<span class="op" id="6330248">=</span>&nbsp;<span class="ident" id="6330250"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330251">.</span><span class="ident" id="6330252">suffix</span><span class="op" id="6330258">[</span><span class="ident" id="6330259"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330260">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330266"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330267">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330274"><a href="/compress/lzw/reader.go.html#6329770">c</a></span>&nbsp;<span class="op" id="6330276">=</span>&nbsp;<span class="ident" id="6330278"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330279">.</span><span class="ident" id="6330280">prefix</span><span class="op" id="6330286">[</span><span class="ident" id="6330287"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330288">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330298"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330299">.</span><span class="ident" id="6330300">output</span><span class="op" id="6330306">[</span><span class="ident" id="6330307"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330308">]</span>&nbsp;<span class="op" id="6330310">=</span>&nbsp;<span class="builtintype" id="6330312">uint8</span><span class="op" id="6330317">(</span><span class="ident" id="6330318"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330319">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330324"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330325">.</span><span class="ident" id="6330326">o</span>&nbsp;<span class="op" id="6330328">+=</span>&nbsp;<span class="builtinfunc" id="6330331">copy</span><span class="op" id="6330335">(</span><span class="ident" id="6330336"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330337">.</span><span class="ident" id="6330338">output</span><span class="op" id="6330344">[</span><span class="ident" id="6330345"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330346">.</span><span class="ident" id="6330347">o</span><span class="op" id="6330348">:</span><span class="op" id="6330349">]</span><span class="op" id="6330350">,</span>&nbsp;<span class="ident" id="6330352"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330353">.</span><span class="ident" id="6330354">output</span><span class="op" id="6330360">[</span><span class="ident" id="6330361"><a href="/compress/lzw/reader.go.html#6329773">i</a></span><span class="op" id="6330362">:</span><span class="op" id="6330363">]</span><span class="op" id="6330364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330369">if</span>&nbsp;<span class="ident" id="6330372"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330373">.</span><span class="ident" id="6330374">last</span>&nbsp;<span class="op" id="6330379">!=</span>&nbsp;<span class="ident" id="6330382"><a href="/compress/lzw/reader.go.html#6326266">decoderInvalidCode</a></span>&nbsp;<span class="op" id="6330401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6330407">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330448"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330449">.</span><span class="ident" id="6330450">suffix</span><span class="op" id="6330456">[</span><span class="ident" id="6330457"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330458">.</span><span class="ident" id="6330459">hi</span><span class="op" id="6330461">]</span>&nbsp;<span class="op" id="6330463">=</span>&nbsp;<span class="builtintype" id="6330465">uint8</span><span class="op" id="6330470">(</span><span class="ident" id="6330471"><a href="/compress/lzw/reader.go.html#6329770">c</a></span><span class="op" id="6330472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330478"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330479">.</span><span class="ident" id="6330480">prefix</span><span class="op" id="6330486">[</span><span class="ident" id="6330487"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330488">.</span><span class="ident" id="6330489">hi</span><span class="op" id="6330491">]</span>&nbsp;<span class="op" id="6330493">=</span>&nbsp;<span class="ident" id="6330495"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330496">.</span><span class="ident" id="6330497">last</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330509">default</span><span class="op" id="6330516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330521"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330522">.</span><span class="ident" id="6330523">err</span>&nbsp;<span class="op" id="6330527">=</span>&nbsp;<span class="ident" id="6330529"><a href="/compress/lzw/reader.go.html#6325933">errors</a></span><span class="op" id="6330535">.</span><span class="ident" id="6330536">New</span><span class="op" id="6330539">(</span><span class="string" id="6330540">&#34;lzw:&nbsp;invalid&nbsp;code&#34;</span><span class="op" id="6330559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330564">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330573">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330577"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330578">.</span><span class="ident" id="6330579">last</span><span class="op" id="6330583">,</span>&nbsp;<span class="ident" id="6330585"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330586">.</span><span class="ident" id="6330587">hi</span>&nbsp;<span class="op" id="6330590">=</span>&nbsp;<span class="ident" id="6330592"><a href="/compress/lzw/reader.go.html#6329162">code</a></span><span class="op" id="6330596">,</span>&nbsp;<span class="ident" id="6330598"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330599">.</span><span class="ident" id="6330600">hi</span><span class="op" id="6330602">+</span><span class="num" id="6330603">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330607">if</span>&nbsp;<span class="ident" id="6330610"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330611">.</span><span class="ident" id="6330612">hi</span>&nbsp;<span class="op" id="6330615">&gt;=</span>&nbsp;<span class="ident" id="6330618"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330619">.</span><span class="ident" id="6330620">overflow</span>&nbsp;<span class="op" id="6330629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330634">if</span>&nbsp;<span class="ident" id="6330637"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330638">.</span><span class="ident" id="6330639">width</span>&nbsp;<span class="op" id="6330645">==</span>&nbsp;<span class="ident" id="6330648"><a href="/compress/lzw/reader.go.html#6326241">maxWidth</a></span>&nbsp;<span class="op" id="6330657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330663"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330664">.</span><span class="ident" id="6330665">last</span>&nbsp;<span class="op" id="6330670">=</span>&nbsp;<span class="ident" id="6330672"><a href="/compress/lzw/reader.go.html#6326266">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330694">}</span>&nbsp;<span class="keyword" id="6330696">else</span>&nbsp;<span class="op" id="6330701">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330707"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330708">.</span><span class="ident" id="6330709">width</span><span class="op" id="6330714">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330721"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330722">.</span><span class="ident" id="6330723">overflow</span>&nbsp;<span class="op" id="6330732">&lt;&lt;=</span>&nbsp;<span class="num" id="6330736">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330749">if</span>&nbsp;<span class="ident" id="6330752"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330753">.</span><span class="ident" id="6330754">o</span>&nbsp;<span class="op" id="6330756">&gt;=</span>&nbsp;<span class="ident" id="6330759"><a href="/compress/lzw/reader.go.html#6326295">flushBuffer</a></span>&nbsp;<span class="op" id="6330771">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330776"><a href="/compress/lzw/reader.go.html#6329057">d</a></span><span class="op" id="6330777">.</span><span class="ident" id="6330778">flush</span><span class="op" id="6330783">(</span><span class="op" id="6330784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330789">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330801">}</span><br>
<span class="lineno"></span><span class="op" id="6330803">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="6330806">func</span>&nbsp;<span class="op" id="6330811">(</span><span class="ident" id="6330812">d</span>&nbsp;<span class="op" id="6330814">*</span><span class="ident" id="6330815"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6330822">)</span>&nbsp;<span class="ident" id="6330824">flush</span><span class="op" id="6330829">(</span><span class="op" id="6330830">)</span>&nbsp;<span class="op" id="6330832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330835"><a href="/compress/lzw/reader.go.html#6330812">d</a></span><span class="op" id="6330836">.</span><span class="ident" id="6330837">toRead</span>&nbsp;<span class="op" id="6330844">=</span>&nbsp;<span class="ident" id="6330846"><a href="/compress/lzw/reader.go.html#6330812">d</a></span><span class="op" id="6330847">.</span><span class="ident" id="6330848">output</span><span class="op" id="6330854">[</span><span class="op" id="6330855">:</span><span class="ident" id="6330856"><a href="/compress/lzw/reader.go.html#6330812">d</a></span><span class="op" id="6330857">.</span><span class="ident" id="6330858">o</span><span class="op" id="6330859">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330862"><a href="/compress/lzw/reader.go.html#6330812">d</a></span><span class="op" id="6330863">.</span><span class="ident" id="6330864">o</span>&nbsp;<span class="op" id="6330866">=</span>&nbsp;<span class="num" id="6330868">0</span><br>
<span class="lineno"></span><span class="op" id="6330870">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6330873">var</span>&nbsp;<span class="ident" id="6330877">errClosed</span>&nbsp;<span class="op" id="6330887">=</span>&nbsp;<span class="ident" id="6330889"><a href="/compress/lzw/reader.go.html#6325933">errors</a></span><span class="op" id="6330895">.</span><span class="ident" id="6330896">New</span><span class="op" id="6330899">(</span><span class="string" id="6330900">&#34;compress/lzw:&nbsp;reader/writer&nbsp;is&nbsp;closed&#34;</span><span class="op" id="6330939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6330942">func</span>&nbsp;<span class="op" id="6330947">(</span><span class="ident" id="6330948">d</span>&nbsp;<span class="op" id="6330950">*</span><span class="ident" id="6330951"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6330958">)</span>&nbsp;<span class="ident" id="6330960">Close</span><span class="op" id="6330965">(</span><span class="op" id="6330966">)</span>&nbsp;<span class="builtintype" id="6330968">error</span>&nbsp;<span class="op" id="6330974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330977"><a href="/compress/lzw/reader.go.html#6330948">d</a></span><span class="op" id="6330978">.</span><span class="ident" id="6330979">err</span>&nbsp;<span class="op" id="6330983">=</span>&nbsp;<span class="ident" id="6330985"><a href="/compress/lzw/reader.go.html#6330877">errClosed</a></span>&nbsp;<span class="comment" id="6330995">//&nbsp;in&nbsp;case&nbsp;any&nbsp;Reads&nbsp;come&nbsp;along</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331028">return</span>&nbsp;<span class="ident" id="6331035">nil</span><br>
<span class="lineno"></span><span class="op" id="6331039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6331042">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;io.ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="6331084">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;io.ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">225</span><span class="comment" id="6331158">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,</span><br>
<span class="lineno"></span><span class="comment" id="6331205">//&nbsp;the&nbsp;decompressor&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6331267">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6331341">//&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="comment" id="6331362">//&nbsp;The&nbsp;number&nbsp;of&nbsp;bits&nbsp;to&nbsp;use&nbsp;for&nbsp;literal&nbsp;codes,&nbsp;litWidth,&nbsp;must&nbsp;be&nbsp;in&nbsp;the</span><br>
<span class="lineno">230</span><span class="comment" id="6331435">//&nbsp;range&nbsp;[2,8]&nbsp;and&nbsp;is&nbsp;typically&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="6331470">func</span>&nbsp;<span class="ident" id="6331475">NewReader</span><span class="op" id="6331484">(</span><span class="ident" id="6331485">r</span>&nbsp;<span class="ident" id="6331487"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6331489">.</span><span class="ident" id="6331490">Reader</span><span class="op" id="6331496">,</span>&nbsp;<span class="ident" id="6331498">order</span>&nbsp;<span class="ident" id="6331504"><a href="/compress/lzw/reader.go.html#6326022">Order</a></span><span class="op" id="6331509">,</span>&nbsp;<span class="ident" id="6331511">litWidth</span>&nbsp;<span class="builtintype" id="6331520">int</span><span class="op" id="6331523">)</span>&nbsp;<span class="ident" id="6331525"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6331527">.</span><span class="ident" id="6331528">ReadCloser</span>&nbsp;<span class="op" id="6331539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331542">d</span>&nbsp;<span class="op" id="6331544">:=</span>&nbsp;<span class="builtinfunc" id="6331547">new</span><span class="op" id="6331550">(</span><span class="ident" id="6331551"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6331558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331561">switch</span>&nbsp;<span class="ident" id="6331568"><a href="/compress/lzw/reader.go.html#6331498">order</a></span>&nbsp;<span class="op" id="6331574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331577">case</span>&nbsp;<span class="ident" id="6331582"><a href="/compress/lzw/reader.go.html#6326118">LSB</a></span><span class="op" id="6331585">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331589"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331590">.</span><span class="ident" id="6331591">read</span>&nbsp;<span class="op" id="6331596">=</span>&nbsp;<span class="op" id="6331598">(</span><span class="op" id="6331599">*</span><span class="ident" id="6331600"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6331607">)</span><span class="op" id="6331608">.</span><span class="ident" id="6331609">readLSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331618">case</span>&nbsp;<span class="ident" id="6331623"><a href="/compress/lzw/reader.go.html#6326225">MSB</a></span><span class="op" id="6331626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331630"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331631">.</span><span class="ident" id="6331632">read</span>&nbsp;<span class="op" id="6331637">=</span>&nbsp;<span class="op" id="6331639">(</span><span class="op" id="6331640">*</span><span class="ident" id="6331641"><a href="/compress/lzw/reader.go.html#6326438">decoder</a></span><span class="op" id="6331648">)</span><span class="op" id="6331649">.</span><span class="ident" id="6331650">readMSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331659">default</span><span class="op" id="6331666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331670"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331671">.</span><span class="ident" id="6331672">err</span>&nbsp;<span class="op" id="6331676">=</span>&nbsp;<span class="ident" id="6331678"><a href="/compress/lzw/reader.go.html#6325933">errors</a></span><span class="op" id="6331684">.</span><span class="ident" id="6331685">New</span><span class="op" id="6331688">(</span><span class="string" id="6331689">&#34;lzw:&nbsp;unknown&nbsp;order&#34;</span><span class="op" id="6331709">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331713">return</span>&nbsp;<span class="ident" id="6331720"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331726">if</span>&nbsp;<span class="ident" id="6331729"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span>&nbsp;<span class="op" id="6331738">&lt;</span>&nbsp;<span class="num" id="6331740">2</span>&nbsp;<span class="op" id="6331742">||</span>&nbsp;<span class="num" id="6331745">8</span>&nbsp;<span class="op" id="6331747">&lt;</span>&nbsp;<span class="ident" id="6331749"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span>&nbsp;<span class="op" id="6331758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331762"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331763">.</span><span class="ident" id="6331764">err</span>&nbsp;<span class="op" id="6331768">=</span>&nbsp;<span class="ident" id="6331770"><a href="/compress/lzw/reader.go.html#6325943">fmt</a></span><span class="op" id="6331773">.</span><span class="ident" id="6331774">Errorf</span><span class="op" id="6331780">(</span><span class="string" id="6331781">&#34;lzw:&nbsp;litWidth&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="6331812">,</span>&nbsp;<span class="ident" id="6331814"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span><span class="op" id="6331822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331826">return</span>&nbsp;<span class="ident" id="6331833"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331839">if</span>&nbsp;<span class="ident" id="6331842">br</span><span class="op" id="6331844">,</span>&nbsp;<span class="ident" id="6331846">ok</span>&nbsp;<span class="op" id="6331849">:=</span>&nbsp;<span class="ident" id="6331852"><a href="/compress/lzw/reader.go.html#6331485">r</a></span><span class="op" id="6331853">.</span><span class="op" id="6331854">(</span><span class="ident" id="6331855"><a href="/compress/lzw/reader.go.html#6325950">io</a></span><span class="op" id="6331857">.</span><span class="ident" id="6331858">ByteReader</span><span class="op" id="6331868">)</span><span class="op" id="6331869">;</span>&nbsp;<span class="ident" id="6331871"><a href="/compress/lzw/reader.go.html#6331846">ok</a></span>&nbsp;<span class="op" id="6331874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331878"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331879">.</span><span class="ident" id="6331880">r</span>&nbsp;<span class="op" id="6331882">=</span>&nbsp;<span class="ident" id="6331884"><a href="/compress/lzw/reader.go.html#6331842">br</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331888">}</span>&nbsp;<span class="keyword" id="6331890">else</span>&nbsp;<span class="op" id="6331895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331899"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331900">.</span><span class="ident" id="6331901">r</span>&nbsp;<span class="op" id="6331903">=</span>&nbsp;<span class="ident" id="6331905"><a href="/compress/lzw/reader.go.html#6325924">bufio</a></span><span class="op" id="6331910">.</span><span class="ident" id="6331911">NewReader</span><span class="op" id="6331920">(</span><span class="ident" id="6331921"><a href="/compress/lzw/reader.go.html#6331485">r</a></span><span class="op" id="6331922">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331928"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331929">.</span><span class="ident" id="6331930">litWidth</span>&nbsp;<span class="op" id="6331939">=</span>&nbsp;<span class="ident" id="6331941"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331951"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331952">.</span><span class="ident" id="6331953">width</span>&nbsp;<span class="op" id="6331959">=</span>&nbsp;<span class="num" id="6331961">1</span>&nbsp;<span class="op" id="6331963">+</span>&nbsp;<span class="builtintype" id="6331965">uint</span><span class="op" id="6331969">(</span><span class="ident" id="6331970"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span><span class="op" id="6331978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331981"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6331982">.</span><span class="ident" id="6331983">clear</span>&nbsp;<span class="op" id="6331989">=</span>&nbsp;<span class="builtintype" id="6331991">uint16</span><span class="op" id="6331997">(</span><span class="num" id="6331998">1</span><span class="op" id="6331999">)</span>&nbsp;<span class="op" id="6332001">&lt;&lt;</span>&nbsp;<span class="builtintype" id="6332004">uint</span><span class="op" id="6332008">(</span><span class="ident" id="6332009"><a href="/compress/lzw/reader.go.html#6331511">litWidth</a></span><span class="op" id="6332017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332020"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332021">.</span><span class="ident" id="6332022">eof</span><span class="op" id="6332025">,</span>&nbsp;<span class="ident" id="6332027"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332028">.</span><span class="ident" id="6332029">hi</span>&nbsp;<span class="op" id="6332032">=</span>&nbsp;<span class="ident" id="6332034"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332035">.</span><span class="ident" id="6332036">clear</span><span class="op" id="6332041">+</span><span class="num" id="6332042">1</span><span class="op" id="6332043">,</span>&nbsp;<span class="ident" id="6332045"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332046">.</span><span class="ident" id="6332047">clear</span><span class="op" id="6332052">+</span><span class="num" id="6332053">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332056"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332057">.</span><span class="ident" id="6332058">overflow</span>&nbsp;<span class="op" id="6332067">=</span>&nbsp;<span class="builtintype" id="6332069">uint16</span><span class="op" id="6332075">(</span><span class="num" id="6332076">1</span><span class="op" id="6332077">)</span>&nbsp;<span class="op" id="6332079">&lt;&lt;</span>&nbsp;<span class="ident" id="6332082"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332083">.</span><span class="ident" id="6332084">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332091"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><span class="op" id="6332092">.</span><span class="ident" id="6332093">last</span>&nbsp;<span class="op" id="6332098">=</span>&nbsp;<span class="ident" id="6332100"><a href="/compress/lzw/reader.go.html#6326266">decoderInvalidCode</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332121">return</span>&nbsp;<span class="ident" id="6332128"><a href="/compress/lzw/reader.go.html#6331542">d</a></span><br>
<span class="lineno"></span><span class="op" id="6332130">}</span>
</div>
</body>
</html>
