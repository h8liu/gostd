<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4247729">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4247784">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4247838">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4247889">package</span>&nbsp;<span class="ident" id="4247897">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4247903">import</span>&nbsp;<span class="op" id="4247910">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4247913">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4247933">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4247950">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4247960">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4247966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4247969">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4248020">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4248080">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4248096">type</span>&nbsp;<span class="ident" id="4248101">pkcs8</span>&nbsp;<span class="keyword" id="4248107">struct</span>&nbsp;<span class="op" id="4248114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248117">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4248128">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248133">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248144">pkix</span><span class="op" id="4248148">.</span><span class="ident" id="4248149">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248170">PrivateKey</span>&nbsp;<span class="op" id="4248181">[</span><span class="op" id="4248182">]</span><span class="builtintype" id="4248183">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4248189">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4248221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4248224">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4248295">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4248355">func</span>&nbsp;<span class="ident" id="4248360">ParsePKCS8PrivateKey</span><span class="op" id="4248380">(</span><span class="ident" id="4248381">der</span>&nbsp;<span class="op" id="4248385">[</span><span class="op" id="4248386">]</span><span class="builtintype" id="4248387">byte</span><span class="op" id="4248391">)</span>&nbsp;<span class="op" id="4248393">(</span><span class="ident" id="4248394">key</span>&nbsp;<span class="keyword" id="4248398">interface</span><span class="op" id="4248407">{</span><span class="op" id="4248408">}</span><span class="op" id="4248409">,</span>&nbsp;<span class="ident" id="4248411">err</span>&nbsp;<span class="builtintype" id="4248415">error</span><span class="op" id="4248420">)</span>&nbsp;<span class="op" id="4248422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248425">var</span>&nbsp;<span class="ident" id="4248429">privKey</span>&nbsp;<span class="ident" id="4248437">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248444">if</span>&nbsp;<span class="ident" id="4248447">_</span><span class="op" id="4248448">,</span>&nbsp;<span class="ident" id="4248450">err</span>&nbsp;<span class="op" id="4248454">:=</span>&nbsp;<span class="ident" id="4248457">asn1</span><span class="op" id="4248461">.</span><span class="ident" id="4248462">Unmarshal</span><span class="op" id="4248471">(</span><span class="ident" id="4248472">der</span><span class="op" id="4248475">,</span>&nbsp;<span class="op" id="4248477">&amp;</span><span class="ident" id="4248478">privKey</span><span class="op" id="4248485">)</span><span class="op" id="4248486">;</span>&nbsp;<span class="ident" id="4248488">err</span>&nbsp;<span class="op" id="4248492">!=</span>&nbsp;<span class="ident" id="4248495">nil</span>&nbsp;<span class="op" id="4248499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248503">return</span>&nbsp;<span class="ident" id="4248510">nil</span><span class="op" id="4248513">,</span>&nbsp;<span class="ident" id="4248515">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4248520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248523">switch</span>&nbsp;<span class="op" id="4248530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248533">case</span>&nbsp;<span class="ident" id="4248538">privKey</span><span class="op" id="4248545">.</span><span class="ident" id="4248546">Algo</span><span class="op" id="4248550">.</span><span class="ident" id="4248551">Algorithm</span><span class="op" id="4248560">.</span><span class="ident" id="4248561">Equal</span><span class="op" id="4248566">(</span><span class="ident" id="4248567">oidPublicKeyRSA</span><span class="op" id="4248582">)</span><span class="op" id="4248583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248587">key</span><span class="op" id="4248590">,</span>&nbsp;<span class="ident" id="4248592">err</span>&nbsp;<span class="op" id="4248596">=</span>&nbsp;<span class="ident" id="4248598">ParsePKCS1PrivateKey</span><span class="op" id="4248618">(</span><span class="ident" id="4248619">privKey</span><span class="op" id="4248626">.</span><span class="ident" id="4248627">PrivateKey</span><span class="op" id="4248637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248641">if</span>&nbsp;<span class="ident" id="4248644">err</span>&nbsp;<span class="op" id="4248648">!=</span>&nbsp;<span class="ident" id="4248651">nil</span>&nbsp;<span class="op" id="4248655">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248660">return</span>&nbsp;<span class="ident" id="4248667">nil</span><span class="op" id="4248670">,</span>&nbsp;<span class="ident" id="4248672">errors</span><span class="op" id="4248678">.</span><span class="ident" id="4248679">New</span><span class="op" id="4248682">(</span><span class="string" id="4248683">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4248744">+</span>&nbsp;<span class="ident" id="4248746">err</span><span class="op" id="4248749">.</span><span class="ident" id="4248750">Error</span><span class="op" id="4248755">(</span><span class="op" id="4248756">)</span><span class="op" id="4248757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4248761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248765">return</span>&nbsp;<span class="ident" id="4248772">key</span><span class="op" id="4248775">,</span>&nbsp;<span class="ident" id="4248777">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248783">case</span>&nbsp;<span class="ident" id="4248788">privKey</span><span class="op" id="4248795">.</span><span class="ident" id="4248796">Algo</span><span class="op" id="4248800">.</span><span class="ident" id="4248801">Algorithm</span><span class="op" id="4248810">.</span><span class="ident" id="4248811">Equal</span><span class="op" id="4248816">(</span><span class="ident" id="4248817">oidPublicKeyECDSA</span><span class="op" id="4248834">)</span><span class="op" id="4248835">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248839">bytes</span>&nbsp;<span class="op" id="4248845">:=</span>&nbsp;<span class="ident" id="4248848">privKey</span><span class="op" id="4248855">.</span><span class="ident" id="4248856">Algo</span><span class="op" id="4248860">.</span><span class="ident" id="4248861">Parameters</span><span class="op" id="4248871">.</span><span class="ident" id="4248872">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248884">namedCurveOID</span>&nbsp;<span class="op" id="4248898">:=</span>&nbsp;<span class="builtinfunc" id="4248901">new</span><span class="op" id="4248904">(</span><span class="ident" id="4248905">asn1</span><span class="op" id="4248909">.</span><span class="ident" id="4248910">ObjectIdentifier</span><span class="op" id="4248926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248930">if</span>&nbsp;<span class="ident" id="4248933">_</span><span class="op" id="4248934">,</span>&nbsp;<span class="ident" id="4248936">err</span>&nbsp;<span class="op" id="4248940">:=</span>&nbsp;<span class="ident" id="4248943">asn1</span><span class="op" id="4248947">.</span><span class="ident" id="4248948">Unmarshal</span><span class="op" id="4248957">(</span><span class="ident" id="4248958">bytes</span><span class="op" id="4248963">,</span>&nbsp;<span class="ident" id="4248965">namedCurveOID</span><span class="op" id="4248978">)</span><span class="op" id="4248979">;</span>&nbsp;<span class="ident" id="4248981">err</span>&nbsp;<span class="op" id="4248985">!=</span>&nbsp;<span class="ident" id="4248988">nil</span>&nbsp;<span class="op" id="4248992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248997">namedCurveOID</span>&nbsp;<span class="op" id="4249011">=</span>&nbsp;<span class="ident" id="4249013">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4249019">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249023">key</span><span class="op" id="4249026">,</span>&nbsp;<span class="ident" id="4249028">err</span>&nbsp;<span class="op" id="4249032">=</span>&nbsp;<span class="ident" id="4249034">parseECPrivateKey</span><span class="op" id="4249051">(</span><span class="ident" id="4249052">namedCurveOID</span><span class="op" id="4249065">,</span>&nbsp;<span class="ident" id="4249067">privKey</span><span class="op" id="4249074">.</span><span class="ident" id="4249075">PrivateKey</span><span class="op" id="4249085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4249089">if</span>&nbsp;<span class="ident" id="4249092">err</span>&nbsp;<span class="op" id="4249096">!=</span>&nbsp;<span class="ident" id="4249099">nil</span>&nbsp;<span class="op" id="4249103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4249108">return</span>&nbsp;<span class="ident" id="4249115">nil</span><span class="op" id="4249118">,</span>&nbsp;<span class="ident" id="4249120">errors</span><span class="op" id="4249126">.</span><span class="ident" id="4249127">New</span><span class="op" id="4249130">(</span><span class="string" id="4249131">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4249191">+</span>&nbsp;<span class="ident" id="4249193">err</span><span class="op" id="4249196">.</span><span class="ident" id="4249197">Error</span><span class="op" id="4249202">(</span><span class="op" id="4249203">)</span><span class="op" id="4249204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4249208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4249212">return</span>&nbsp;<span class="ident" id="4249219">key</span><span class="op" id="4249222">,</span>&nbsp;<span class="ident" id="4249224">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4249230">default</span><span class="op" id="4249237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4249241">return</span>&nbsp;<span class="ident" id="4249248">nil</span><span class="op" id="4249251">,</span>&nbsp;<span class="ident" id="4249253">fmt</span><span class="op" id="4249256">.</span><span class="ident" id="4249257">Errorf</span><span class="op" id="4249263">(</span><span class="string" id="4249264">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4249336">,</span>&nbsp;<span class="ident" id="4249338">privKey</span><span class="op" id="4249345">.</span><span class="ident" id="4249346">Algo</span><span class="op" id="4249350">.</span><span class="ident" id="4249351">Algorithm</span><span class="op" id="4249360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4249363">}</span><br>
<span class="lineno"></span><span class="op" id="4249365">}</span>
</div>
</body>
</html>
