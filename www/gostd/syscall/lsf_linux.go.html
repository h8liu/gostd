<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2487905">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2487961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2488015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2488066">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488090">package</span>&nbsp;<span class="ident" id="2488098">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488107">import</span>&nbsp;<span class="op" id="2488114">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2488117">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2488126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488129">func</span>&nbsp;<span class="ident" id="2488134">LsfStmt</span><span class="op" id="2488141">(</span><span class="ident" id="2488142">code</span><span class="op" id="2488146">,</span>&nbsp;<span class="ident" id="2488148">k</span>&nbsp;<span class="builtintype" id="2488150">int</span><span class="op" id="2488153">)</span>&nbsp;<span class="op" id="2488155">*</span><span class="ident" id="2488156">SockFilter</span>&nbsp;<span class="op" id="2488167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488170">return</span>&nbsp;<span class="op" id="2488177">&amp;</span><span class="ident" id="2488178">SockFilter</span><span class="op" id="2488188">{</span><span class="ident" id="2488189">Code</span><span class="op" id="2488193">:</span>&nbsp;<span class="builtintype" id="2488195">uint16</span><span class="op" id="2488201">(</span><span class="ident" id="2488202">code</span><span class="op" id="2488206">)</span><span class="op" id="2488207">,</span>&nbsp;<span class="ident" id="2488209">K</span><span class="op" id="2488210">:</span>&nbsp;<span class="builtintype" id="2488212">uint32</span><span class="op" id="2488218">(</span><span class="ident" id="2488219">k</span><span class="op" id="2488220">)</span><span class="op" id="2488221">}</span><br>
<span class="lineno">15</span><span class="op" id="2488223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488226">func</span>&nbsp;<span class="ident" id="2488231">LsfJump</span><span class="op" id="2488238">(</span><span class="ident" id="2488239">code</span><span class="op" id="2488243">,</span>&nbsp;<span class="ident" id="2488245">k</span><span class="op" id="2488246">,</span>&nbsp;<span class="ident" id="2488248">jt</span><span class="op" id="2488250">,</span>&nbsp;<span class="ident" id="2488252">jf</span>&nbsp;<span class="builtintype" id="2488255">int</span><span class="op" id="2488258">)</span>&nbsp;<span class="op" id="2488260">*</span><span class="ident" id="2488261">SockFilter</span>&nbsp;<span class="op" id="2488272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488275">return</span>&nbsp;<span class="op" id="2488282">&amp;</span><span class="ident" id="2488283">SockFilter</span><span class="op" id="2488293">{</span><span class="ident" id="2488294">Code</span><span class="op" id="2488298">:</span>&nbsp;<span class="builtintype" id="2488300">uint16</span><span class="op" id="2488306">(</span><span class="ident" id="2488307">code</span><span class="op" id="2488311">)</span><span class="op" id="2488312">,</span>&nbsp;<span class="ident" id="2488314">Jt</span><span class="op" id="2488316">:</span>&nbsp;<span class="builtintype" id="2488318">uint8</span><span class="op" id="2488323">(</span><span class="ident" id="2488324">jt</span><span class="op" id="2488326">)</span><span class="op" id="2488327">,</span>&nbsp;<span class="ident" id="2488329">Jf</span><span class="op" id="2488331">:</span>&nbsp;<span class="builtintype" id="2488333">uint8</span><span class="op" id="2488338">(</span><span class="ident" id="2488339">jf</span><span class="op" id="2488341">)</span><span class="op" id="2488342">,</span>&nbsp;<span class="ident" id="2488344">K</span><span class="op" id="2488345">:</span>&nbsp;<span class="builtintype" id="2488347">uint32</span><span class="op" id="2488353">(</span><span class="ident" id="2488354">k</span><span class="op" id="2488355">)</span><span class="op" id="2488356">}</span><br>
<span class="lineno"></span><span class="op" id="2488358">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2488361">func</span>&nbsp;<span class="ident" id="2488366">LsfSocket</span><span class="op" id="2488375">(</span><span class="ident" id="2488376">ifindex</span><span class="op" id="2488383">,</span>&nbsp;<span class="ident" id="2488385">proto</span>&nbsp;<span class="builtintype" id="2488391">int</span><span class="op" id="2488394">)</span>&nbsp;<span class="op" id="2488396">(</span><span class="builtintype" id="2488397">int</span><span class="op" id="2488400">,</span>&nbsp;<span class="builtintype" id="2488402">error</span><span class="op" id="2488407">)</span>&nbsp;<span class="op" id="2488409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488412">var</span>&nbsp;<span class="ident" id="2488416">lsall</span>&nbsp;<span class="ident" id="2488422">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488441">s</span><span class="op" id="2488442">,</span>&nbsp;<span class="ident" id="2488444">e</span>&nbsp;<span class="op" id="2488446">:=</span>&nbsp;<span class="ident" id="2488449">Socket</span><span class="op" id="2488455">(</span><span class="ident" id="2488456">AF_PACKET</span><span class="op" id="2488465">,</span>&nbsp;<span class="ident" id="2488467">SOCK_RAW</span><span class="op" id="2488475">,</span>&nbsp;<span class="ident" id="2488477">proto</span><span class="op" id="2488482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488485">if</span>&nbsp;<span class="ident" id="2488488">e</span>&nbsp;<span class="op" id="2488490">!=</span>&nbsp;<span class="builtintype" id="2488493">nil</span>&nbsp;<span class="op" id="2488497">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488501">return</span>&nbsp;<span class="num" id="2488508">0</span><span class="op" id="2488509">,</span>&nbsp;<span class="ident" id="2488511">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488517">p</span>&nbsp;<span class="op" id="2488519">:=</span>&nbsp;<span class="op" id="2488522">(</span><span class="op" id="2488523">*</span><span class="op" id="2488524">[</span><span class="num" id="2488525">2</span><span class="op" id="2488526">]</span><span class="builtintype" id="2488527">byte</span><span class="op" id="2488531">)</span><span class="op" id="2488532">(</span><span class="ident" id="2488533">unsafe</span><span class="op" id="2488539">.</span><span class="ident" id="2488540">Pointer</span><span class="op" id="2488547">(</span><span class="op" id="2488548">&amp;</span><span class="ident" id="2488549">lsall</span><span class="op" id="2488554">.</span><span class="ident" id="2488555">Protocol</span><span class="op" id="2488563">)</span><span class="op" id="2488564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488567">p</span><span class="op" id="2488568">[</span><span class="num" id="2488569">0</span><span class="op" id="2488570">]</span>&nbsp;<span class="op" id="2488572">=</span>&nbsp;<span class="builtintype" id="2488574">byte</span><span class="op" id="2488578">(</span><span class="ident" id="2488579">proto</span>&nbsp;<span class="op" id="2488585">&gt;&gt;</span>&nbsp;<span class="num" id="2488588">8</span><span class="op" id="2488589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488592">p</span><span class="op" id="2488593">[</span><span class="num" id="2488594">1</span><span class="op" id="2488595">]</span>&nbsp;<span class="op" id="2488597">=</span>&nbsp;<span class="builtintype" id="2488599">byte</span><span class="op" id="2488603">(</span><span class="ident" id="2488604">proto</span><span class="op" id="2488609">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488612">lsall</span><span class="op" id="2488617">.</span><span class="ident" id="2488618">Ifindex</span>&nbsp;<span class="op" id="2488626">=</span>&nbsp;<span class="ident" id="2488628">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488637">e</span>&nbsp;<span class="op" id="2488639">=</span>&nbsp;<span class="ident" id="2488641">Bind</span><span class="op" id="2488645">(</span><span class="ident" id="2488646">s</span><span class="op" id="2488647">,</span>&nbsp;<span class="op" id="2488649">&amp;</span><span class="ident" id="2488650">lsall</span><span class="op" id="2488655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488658">if</span>&nbsp;<span class="ident" id="2488661">e</span>&nbsp;<span class="op" id="2488663">!=</span>&nbsp;<span class="builtintype" id="2488666">nil</span>&nbsp;<span class="op" id="2488670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488674">Close</span><span class="op" id="2488679">(</span><span class="ident" id="2488680">s</span><span class="op" id="2488681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488685">return</span>&nbsp;<span class="num" id="2488692">0</span><span class="op" id="2488693">,</span>&nbsp;<span class="ident" id="2488695">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488701">return</span>&nbsp;<span class="ident" id="2488708">s</span><span class="op" id="2488709">,</span>&nbsp;<span class="builtintype" id="2488711">nil</span><br>
<span class="lineno"></span><span class="op" id="2488715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488718">type</span>&nbsp;<span class="ident" id="2488723">iflags</span>&nbsp;<span class="keyword" id="2488730">struct</span>&nbsp;<span class="op" id="2488737">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488740">name</span>&nbsp;&nbsp;<span class="op" id="2488746">[</span><span class="ident" id="2488747">IFNAMSIZ</span><span class="op" id="2488755">]</span><span class="builtintype" id="2488756">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488762">flags</span>&nbsp;<span class="builtintype" id="2488768">uint16</span><br>
<span class="lineno"></span><span class="op" id="2488775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488778">func</span>&nbsp;<span class="ident" id="2488783">SetLsfPromisc</span><span class="op" id="2488796">(</span><span class="ident" id="2488797">name</span>&nbsp;<span class="builtintype" id="2488802">string</span><span class="op" id="2488808">,</span>&nbsp;<span class="ident" id="2488810">m</span>&nbsp;<span class="builtintype" id="2488812">bool</span><span class="op" id="2488816">)</span>&nbsp;<span class="builtintype" id="2488818">error</span>&nbsp;<span class="op" id="2488824">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488827">s</span><span class="op" id="2488828">,</span>&nbsp;<span class="ident" id="2488830">e</span>&nbsp;<span class="op" id="2488832">:=</span>&nbsp;<span class="ident" id="2488835">Socket</span><span class="op" id="2488841">(</span><span class="ident" id="2488842">AF_INET</span><span class="op" id="2488849">,</span>&nbsp;<span class="ident" id="2488851">SOCK_DGRAM</span><span class="op" id="2488861">,</span>&nbsp;<span class="num" id="2488863">0</span><span class="op" id="2488864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488867">if</span>&nbsp;<span class="ident" id="2488870">e</span>&nbsp;<span class="op" id="2488872">!=</span>&nbsp;<span class="builtintype" id="2488875">nil</span>&nbsp;<span class="op" id="2488879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488883">return</span>&nbsp;<span class="ident" id="2488890">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488896">defer</span>&nbsp;<span class="ident" id="2488902">Close</span><span class="op" id="2488907">(</span><span class="ident" id="2488908">s</span><span class="op" id="2488909">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488912">var</span>&nbsp;<span class="ident" id="2488916">ifl</span>&nbsp;<span class="ident" id="2488920">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2488928">copy</span><span class="op" id="2488932">(</span><span class="ident" id="2488933">ifl</span><span class="op" id="2488936">.</span><span class="ident" id="2488937">name</span><span class="op" id="2488941">[</span><span class="op" id="2488942">:</span><span class="op" id="2488943">]</span><span class="op" id="2488944">,</span>&nbsp;<span class="op" id="2488946">[</span><span class="op" id="2488947">]</span><span class="builtintype" id="2488948">byte</span><span class="op" id="2488952">(</span><span class="ident" id="2488953">name</span><span class="op" id="2488957">)</span><span class="op" id="2488958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488961">_</span><span class="op" id="2488962">,</span>&nbsp;<span class="ident" id="2488964">_</span><span class="op" id="2488965">,</span>&nbsp;<span class="ident" id="2488967">ep</span>&nbsp;<span class="op" id="2488970">:=</span>&nbsp;<span class="ident" id="2488973">Syscall</span><span class="op" id="2488980">(</span><span class="ident" id="2488981">SYS_IOCTL</span><span class="op" id="2488990">,</span>&nbsp;<span class="builtintype" id="2488992">uintptr</span><span class="op" id="2488999">(</span><span class="ident" id="2489000">s</span><span class="op" id="2489001">)</span><span class="op" id="2489002">,</span>&nbsp;<span class="ident" id="2489004">SIOCGIFFLAGS</span><span class="op" id="2489016">,</span>&nbsp;<span class="builtintype" id="2489018">uintptr</span><span class="op" id="2489025">(</span><span class="ident" id="2489026">unsafe</span><span class="op" id="2489032">.</span><span class="ident" id="2489033">Pointer</span><span class="op" id="2489040">(</span><span class="op" id="2489041">&amp;</span><span class="ident" id="2489042">ifl</span><span class="op" id="2489045">)</span><span class="op" id="2489046">)</span><span class="op" id="2489047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489050">if</span>&nbsp;<span class="ident" id="2489053">ep</span>&nbsp;<span class="op" id="2489056">!=</span>&nbsp;<span class="num" id="2489059">0</span>&nbsp;<span class="op" id="2489061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489065">return</span>&nbsp;<span class="ident" id="2489072">Errno</span><span class="op" id="2489077">(</span><span class="ident" id="2489078">ep</span><span class="op" id="2489080">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489086">if</span>&nbsp;<span class="ident" id="2489089">m</span>&nbsp;<span class="op" id="2489091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489095">ifl</span><span class="op" id="2489098">.</span><span class="ident" id="2489099">flags</span>&nbsp;<span class="op" id="2489105">|=</span>&nbsp;<span class="builtintype" id="2489108">uint16</span><span class="op" id="2489114">(</span><span class="ident" id="2489115">IFF_PROMISC</span><span class="op" id="2489126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489129">}</span>&nbsp;<span class="keyword" id="2489131">else</span>&nbsp;<span class="op" id="2489136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489140">ifl</span><span class="op" id="2489143">.</span><span class="ident" id="2489144">flags</span>&nbsp;<span class="op" id="2489150">&amp;=</span>&nbsp;<span class="op" id="2489153">^</span><span class="builtintype" id="2489154">uint16</span><span class="op" id="2489160">(</span><span class="ident" id="2489161">IFF_PROMISC</span><span class="op" id="2489172">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489178">_</span><span class="op" id="2489179">,</span>&nbsp;<span class="ident" id="2489181">_</span><span class="op" id="2489182">,</span>&nbsp;<span class="ident" id="2489184">ep</span>&nbsp;<span class="op" id="2489187">=</span>&nbsp;<span class="ident" id="2489189">Syscall</span><span class="op" id="2489196">(</span><span class="ident" id="2489197">SYS_IOCTL</span><span class="op" id="2489206">,</span>&nbsp;<span class="builtintype" id="2489208">uintptr</span><span class="op" id="2489215">(</span><span class="ident" id="2489216">s</span><span class="op" id="2489217">)</span><span class="op" id="2489218">,</span>&nbsp;<span class="ident" id="2489220">SIOCSIFFLAGS</span><span class="op" id="2489232">,</span>&nbsp;<span class="builtintype" id="2489234">uintptr</span><span class="op" id="2489241">(</span><span class="ident" id="2489242">unsafe</span><span class="op" id="2489248">.</span><span class="ident" id="2489249">Pointer</span><span class="op" id="2489256">(</span><span class="op" id="2489257">&amp;</span><span class="ident" id="2489258">ifl</span><span class="op" id="2489261">)</span><span class="op" id="2489262">)</span><span class="op" id="2489263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489266">if</span>&nbsp;<span class="ident" id="2489269">ep</span>&nbsp;<span class="op" id="2489272">!=</span>&nbsp;<span class="num" id="2489275">0</span>&nbsp;<span class="op" id="2489277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489281">return</span>&nbsp;<span class="ident" id="2489288">Errno</span><span class="op" id="2489293">(</span><span class="ident" id="2489294">ep</span><span class="op" id="2489296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489299">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489302">return</span>&nbsp;<span class="builtintype" id="2489309">nil</span><br>
<span class="lineno"></span><span class="op" id="2489313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2489316">func</span>&nbsp;<span class="ident" id="2489321">AttachLsf</span><span class="op" id="2489330">(</span><span class="ident" id="2489331">fd</span>&nbsp;<span class="builtintype" id="2489334">int</span><span class="op" id="2489337">,</span>&nbsp;<span class="ident" id="2489339">i</span>&nbsp;<span class="op" id="2489341">[</span><span class="op" id="2489342">]</span><span class="ident" id="2489343">SockFilter</span><span class="op" id="2489353">)</span>&nbsp;<span class="builtintype" id="2489355">error</span>&nbsp;<span class="op" id="2489361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489364">var</span>&nbsp;<span class="ident" id="2489368">p</span>&nbsp;<span class="ident" id="2489370">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489381">p</span><span class="op" id="2489382">.</span><span class="ident" id="2489383">Len</span>&nbsp;<span class="op" id="2489387">=</span>&nbsp;<span class="builtintype" id="2489389">uint16</span><span class="op" id="2489395">(</span><span class="builtinfunc" id="2489396">len</span><span class="op" id="2489399">(</span><span class="ident" id="2489400">i</span><span class="op" id="2489401">)</span><span class="op" id="2489402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489405">p</span><span class="op" id="2489406">.</span><span class="ident" id="2489407">Filter</span>&nbsp;<span class="op" id="2489414">=</span>&nbsp;<span class="op" id="2489416">(</span><span class="op" id="2489417">*</span><span class="ident" id="2489418">SockFilter</span><span class="op" id="2489428">)</span><span class="op" id="2489429">(</span><span class="ident" id="2489430">unsafe</span><span class="op" id="2489436">.</span><span class="ident" id="2489437">Pointer</span><span class="op" id="2489444">(</span><span class="op" id="2489445">&amp;</span><span class="ident" id="2489446">i</span><span class="op" id="2489447">[</span><span class="num" id="2489448">0</span><span class="op" id="2489449">]</span><span class="op" id="2489450">)</span><span class="op" id="2489451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489454">return</span>&nbsp;<span class="ident" id="2489461">setsockopt</span><span class="op" id="2489471">(</span><span class="ident" id="2489472">fd</span><span class="op" id="2489474">,</span>&nbsp;<span class="ident" id="2489476">SOL_SOCKET</span><span class="op" id="2489486">,</span>&nbsp;<span class="ident" id="2489488">SO_ATTACH_FILTER</span><span class="op" id="2489504">,</span>&nbsp;<span class="ident" id="2489506">unsafe</span><span class="op" id="2489512">.</span><span class="ident" id="2489513">Pointer</span><span class="op" id="2489520">(</span><span class="op" id="2489521">&amp;</span><span class="ident" id="2489522">p</span><span class="op" id="2489523">)</span><span class="op" id="2489524">,</span>&nbsp;<span class="ident" id="2489526">unsafe</span><span class="op" id="2489532">.</span><span class="ident" id="2489533">Sizeof</span><span class="op" id="2489539">(</span><span class="ident" id="2489540">p</span><span class="op" id="2489541">)</span><span class="op" id="2489542">)</span><br>
<span class="lineno"></span><span class="op" id="2489544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2489547">func</span>&nbsp;<span class="ident" id="2489552">DetachLsf</span><span class="op" id="2489561">(</span><span class="ident" id="2489562">fd</span>&nbsp;<span class="builtintype" id="2489565">int</span><span class="op" id="2489568">)</span>&nbsp;<span class="builtintype" id="2489570">error</span>&nbsp;<span class="op" id="2489576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489579">var</span>&nbsp;<span class="ident" id="2489583">dummy</span>&nbsp;<span class="builtintype" id="2489589">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489594">return</span>&nbsp;<span class="ident" id="2489601">setsockopt</span><span class="op" id="2489611">(</span><span class="ident" id="2489612">fd</span><span class="op" id="2489614">,</span>&nbsp;<span class="ident" id="2489616">SOL_SOCKET</span><span class="op" id="2489626">,</span>&nbsp;<span class="ident" id="2489628">SO_DETACH_FILTER</span><span class="op" id="2489644">,</span>&nbsp;<span class="ident" id="2489646">unsafe</span><span class="op" id="2489652">.</span><span class="ident" id="2489653">Pointer</span><span class="op" id="2489660">(</span><span class="op" id="2489661">&amp;</span><span class="ident" id="2489662">dummy</span><span class="op" id="2489667">)</span><span class="op" id="2489668">,</span>&nbsp;<span class="ident" id="2489670">unsafe</span><span class="op" id="2489676">.</span><span class="ident" id="2489677">Sizeof</span><span class="op" id="2489683">(</span><span class="ident" id="2489684">dummy</span><span class="op" id="2489689">)</span><span class="op" id="2489690">)</span><br>
<span class="lineno"></span><span class="op" id="2489692">}</span>
</div>
</body>
</html>
