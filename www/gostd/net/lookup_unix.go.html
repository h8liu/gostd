<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3210838">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3210894">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3210948">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3210999">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211064">package</span>&nbsp;<span class="ident" id="3211072">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211077">import</span>&nbsp;<span class="op" id="3211084">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3211087">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3211097">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3211104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211107">var</span>&nbsp;<span class="ident" id="3211111">onceReadProtocols</span>&nbsp;<span class="ident" id="3211129">sync</span><span class="op" id="3211133">.</span><span class="ident" id="3211134">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3211140">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3211209">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3211230">func</span>&nbsp;<span class="ident" id="3211235">readProtocols</span><span class="op" id="3211248">(</span><span class="op" id="3211249">)</span>&nbsp;<span class="op" id="3211251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211254">if</span>&nbsp;<span class="ident" id="3211257">file</span><span class="op" id="3211261">,</span>&nbsp;<span class="ident" id="3211263">err</span>&nbsp;<span class="op" id="3211267">:=</span>&nbsp;<span class="ident" id="3211270">open</span><span class="op" id="3211274">(</span><span class="string" id="3211275">&#34;/etc/protocols&#34;</span><span class="op" id="3211291">)</span><span class="op" id="3211292">;</span>&nbsp;<span class="ident" id="3211294">err</span>&nbsp;<span class="op" id="3211298">==</span>&nbsp;<span class="ident" id="3211301">nil</span>&nbsp;<span class="op" id="3211305">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211309">for</span>&nbsp;<span class="ident" id="3211313">line</span><span class="op" id="3211317">,</span>&nbsp;<span class="ident" id="3211319">ok</span>&nbsp;<span class="op" id="3211322">:=</span>&nbsp;<span class="ident" id="3211325">file</span><span class="op" id="3211329">.</span><span class="ident" id="3211330">readLine</span><span class="op" id="3211338">(</span><span class="op" id="3211339">)</span><span class="op" id="3211340">;</span>&nbsp;<span class="ident" id="3211342">ok</span><span class="op" id="3211344">;</span>&nbsp;<span class="ident" id="3211346">line</span><span class="op" id="3211350">,</span>&nbsp;<span class="ident" id="3211352">ok</span>&nbsp;<span class="op" id="3211355">=</span>&nbsp;<span class="ident" id="3211357">file</span><span class="op" id="3211361">.</span><span class="ident" id="3211362">readLine</span><span class="op" id="3211370">(</span><span class="op" id="3211371">)</span>&nbsp;<span class="op" id="3211373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211378">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211434">if</span>&nbsp;<span class="ident" id="3211437">i</span>&nbsp;<span class="op" id="3211439">:=</span>&nbsp;<span class="ident" id="3211442">byteIndex</span><span class="op" id="3211451">(</span><span class="ident" id="3211452">line</span><span class="op" id="3211456">,</span>&nbsp;<span class="string" id="3211458">&#39;#&#39;</span><span class="op" id="3211461">)</span><span class="op" id="3211462">;</span>&nbsp;<span class="ident" id="3211464">i</span>&nbsp;<span class="op" id="3211466">&gt;=</span>&nbsp;<span class="num" id="3211469">0</span>&nbsp;<span class="op" id="3211471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211477">line</span>&nbsp;<span class="op" id="3211482">=</span>&nbsp;<span class="ident" id="3211484">line</span><span class="op" id="3211488">[</span><span class="num" id="3211489">0</span><span class="op" id="3211490">:</span><span class="ident" id="3211491">i</span><span class="op" id="3211492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211497">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211502">f</span>&nbsp;<span class="op" id="3211504">:=</span>&nbsp;<span class="ident" id="3211507">getFields</span><span class="op" id="3211516">(</span><span class="ident" id="3211517">line</span><span class="op" id="3211521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211526">if</span>&nbsp;<span class="builtinfunc" id="3211529">len</span><span class="op" id="3211532">(</span><span class="ident" id="3211533">f</span><span class="op" id="3211534">)</span>&nbsp;<span class="op" id="3211536">&lt;</span>&nbsp;<span class="num" id="3211538">2</span>&nbsp;<span class="op" id="3211540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211546">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211563">if</span>&nbsp;<span class="ident" id="3211566">proto</span><span class="op" id="3211571">,</span>&nbsp;<span class="ident" id="3211573">_</span><span class="op" id="3211574">,</span>&nbsp;<span class="ident" id="3211576">ok</span>&nbsp;<span class="op" id="3211579">:=</span>&nbsp;<span class="ident" id="3211582">dtoi</span><span class="op" id="3211586">(</span><span class="ident" id="3211587">f</span><span class="op" id="3211588">[</span><span class="num" id="3211589">1</span><span class="op" id="3211590">]</span><span class="op" id="3211591">,</span>&nbsp;<span class="num" id="3211593">0</span><span class="op" id="3211594">)</span><span class="op" id="3211595">;</span>&nbsp;<span class="ident" id="3211597">ok</span>&nbsp;<span class="op" id="3211600">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211606">if</span>&nbsp;<span class="ident" id="3211609">_</span><span class="op" id="3211610">,</span>&nbsp;<span class="ident" id="3211612">ok</span>&nbsp;<span class="op" id="3211615">:=</span>&nbsp;<span class="ident" id="3211618">protocols</span><span class="op" id="3211627">[</span><span class="ident" id="3211628">f</span><span class="op" id="3211629">[</span><span class="num" id="3211630">0</span><span class="op" id="3211631">]</span><span class="op" id="3211632">]</span><span class="op" id="3211633">;</span>&nbsp;<span class="op" id="3211635">!</span><span class="ident" id="3211636">ok</span>&nbsp;<span class="op" id="3211639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211646">protocols</span><span class="op" id="3211655">[</span><span class="ident" id="3211656">f</span><span class="op" id="3211657">[</span><span class="num" id="3211658">0</span><span class="op" id="3211659">]</span><span class="op" id="3211660">]</span>&nbsp;<span class="op" id="3211662">=</span>&nbsp;<span class="ident" id="3211664">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211680">for</span>&nbsp;<span class="ident" id="3211684">_</span><span class="op" id="3211685">,</span>&nbsp;<span class="ident" id="3211687">alias</span>&nbsp;<span class="op" id="3211693">:=</span>&nbsp;<span class="keyword" id="3211696">range</span>&nbsp;<span class="ident" id="3211702">f</span><span class="op" id="3211703">[</span><span class="num" id="3211704">2</span><span class="op" id="3211705">:</span><span class="op" id="3211706">]</span>&nbsp;<span class="op" id="3211708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211715">if</span>&nbsp;<span class="ident" id="3211718">_</span><span class="op" id="3211719">,</span>&nbsp;<span class="ident" id="3211721">ok</span>&nbsp;<span class="op" id="3211724">:=</span>&nbsp;<span class="ident" id="3211727">protocols</span><span class="op" id="3211736">[</span><span class="ident" id="3211737">alias</span><span class="op" id="3211742">]</span><span class="op" id="3211743">;</span>&nbsp;<span class="op" id="3211745">!</span><span class="ident" id="3211746">ok</span>&nbsp;<span class="op" id="3211749">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211757">protocols</span><span class="op" id="3211766">[</span><span class="ident" id="3211767">alias</span><span class="op" id="3211772">]</span>&nbsp;<span class="op" id="3211774">=</span>&nbsp;<span class="ident" id="3211776">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211802">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211806">file</span><span class="op" id="3211810">.</span><span class="builtinfunc" id="3211811">close</span><span class="op" id="3211816">(</span><span class="op" id="3211817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211820">}</span><br>
<span class="lineno"></span><span class="op" id="3211822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211825">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3211891">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3211933">func</span>&nbsp;<span class="ident" id="3211938">lookupProtocol</span><span class="op" id="3211952">(</span><span class="ident" id="3211953">name</span>&nbsp;<span class="builtintype" id="3211958">string</span><span class="op" id="3211964">)</span>&nbsp;<span class="op" id="3211966">(</span><span class="ident" id="3211967">proto</span>&nbsp;<span class="builtintype" id="3211973">int</span><span class="op" id="3211976">,</span>&nbsp;<span class="ident" id="3211978">err</span>&nbsp;<span class="builtintype" id="3211982">error</span><span class="op" id="3211987">)</span>&nbsp;<span class="op" id="3211989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211992">onceReadProtocols</span><span class="op" id="3212009">.</span><span class="ident" id="3212010">Do</span><span class="op" id="3212012">(</span><span class="ident" id="3212013">readProtocols</span><span class="op" id="3212026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212029">proto</span><span class="op" id="3212034">,</span>&nbsp;<span class="ident" id="3212036">found</span>&nbsp;<span class="op" id="3212042">:=</span>&nbsp;<span class="ident" id="3212045">protocols</span><span class="op" id="3212054">[</span><span class="ident" id="3212055">name</span><span class="op" id="3212059">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212062">if</span>&nbsp;<span class="op" id="3212065">!</span><span class="ident" id="3212066">found</span>&nbsp;<span class="op" id="3212072">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212076">return</span>&nbsp;<span class="num" id="3212083">0</span><span class="op" id="3212084">,</span>&nbsp;<span class="ident" id="3212086">errors</span><span class="op" id="3212092">.</span><span class="ident" id="3212093">New</span><span class="op" id="3212096">(</span><span class="string" id="3212097">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3212131">+</span>&nbsp;<span class="ident" id="3212133">name</span><span class="op" id="3212137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212143">return</span><br>
<span class="lineno"></span><span class="op" id="3212150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3212153">func</span>&nbsp;<span class="ident" id="3212158">lookupHost</span><span class="op" id="3212168">(</span><span class="ident" id="3212169">host</span>&nbsp;<span class="builtintype" id="3212174">string</span><span class="op" id="3212180">)</span>&nbsp;<span class="op" id="3212182">(</span><span class="ident" id="3212183">addrs</span>&nbsp;<span class="op" id="3212189">[</span><span class="op" id="3212190">]</span><span class="builtintype" id="3212191">string</span><span class="op" id="3212197">,</span>&nbsp;<span class="ident" id="3212199">err</span>&nbsp;<span class="builtintype" id="3212203">error</span><span class="op" id="3212208">)</span>&nbsp;<span class="op" id="3212210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212213">addrs</span><span class="op" id="3212218">,</span>&nbsp;<span class="ident" id="3212220">err</span><span class="op" id="3212223">,</span>&nbsp;<span class="ident" id="3212225">ok</span>&nbsp;<span class="op" id="3212228">:=</span>&nbsp;<span class="ident" id="3212231">cgoLookupHost</span><span class="op" id="3212244">(</span><span class="ident" id="3212245">host</span><span class="op" id="3212249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212252">if</span>&nbsp;<span class="op" id="3212255">!</span><span class="ident" id="3212256">ok</span>&nbsp;<span class="op" id="3212259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212263">addrs</span><span class="op" id="3212268">,</span>&nbsp;<span class="ident" id="3212270">err</span>&nbsp;<span class="op" id="3212274">=</span>&nbsp;<span class="ident" id="3212276">goLookupHost</span><span class="op" id="3212288">(</span><span class="ident" id="3212289">host</span><span class="op" id="3212293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212296">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212299">return</span><br>
<span class="lineno"></span><span class="op" id="3212306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3212309">func</span>&nbsp;<span class="ident" id="3212314">lookupIP</span><span class="op" id="3212322">(</span><span class="ident" id="3212323">host</span>&nbsp;<span class="builtintype" id="3212328">string</span><span class="op" id="3212334">)</span>&nbsp;<span class="op" id="3212336">(</span><span class="ident" id="3212337">addrs</span>&nbsp;<span class="op" id="3212343">[</span><span class="op" id="3212344">]</span><span class="ident" id="3212345">IP</span><span class="op" id="3212347">,</span>&nbsp;<span class="ident" id="3212349">err</span>&nbsp;<span class="builtintype" id="3212353">error</span><span class="op" id="3212358">)</span>&nbsp;<span class="op" id="3212360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212363">addrs</span><span class="op" id="3212368">,</span>&nbsp;<span class="ident" id="3212370">err</span><span class="op" id="3212373">,</span>&nbsp;<span class="ident" id="3212375">ok</span>&nbsp;<span class="op" id="3212378">:=</span>&nbsp;<span class="ident" id="3212381">cgoLookupIP</span><span class="op" id="3212392">(</span><span class="ident" id="3212393">host</span><span class="op" id="3212397">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212400">if</span>&nbsp;<span class="op" id="3212403">!</span><span class="ident" id="3212404">ok</span>&nbsp;<span class="op" id="3212407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212411">addrs</span><span class="op" id="3212416">,</span>&nbsp;<span class="ident" id="3212418">err</span>&nbsp;<span class="op" id="3212422">=</span>&nbsp;<span class="ident" id="3212424">goLookupIP</span><span class="op" id="3212434">(</span><span class="ident" id="3212435">host</span><span class="op" id="3212439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212445">return</span><br>
<span class="lineno"></span><span class="op" id="3212452">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3212455">func</span>&nbsp;<span class="ident" id="3212460">lookupPort</span><span class="op" id="3212470">(</span><span class="ident" id="3212471">network</span><span class="op" id="3212478">,</span>&nbsp;<span class="ident" id="3212480">service</span>&nbsp;<span class="builtintype" id="3212488">string</span><span class="op" id="3212494">)</span>&nbsp;<span class="op" id="3212496">(</span><span class="ident" id="3212497">port</span>&nbsp;<span class="builtintype" id="3212502">int</span><span class="op" id="3212505">,</span>&nbsp;<span class="ident" id="3212507">err</span>&nbsp;<span class="builtintype" id="3212511">error</span><span class="op" id="3212516">)</span>&nbsp;<span class="op" id="3212518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212521">port</span><span class="op" id="3212525">,</span>&nbsp;<span class="ident" id="3212527">err</span><span class="op" id="3212530">,</span>&nbsp;<span class="ident" id="3212532">ok</span>&nbsp;<span class="op" id="3212535">:=</span>&nbsp;<span class="ident" id="3212538">cgoLookupPort</span><span class="op" id="3212551">(</span><span class="ident" id="3212552">network</span><span class="op" id="3212559">,</span>&nbsp;<span class="ident" id="3212561">service</span><span class="op" id="3212568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212571">if</span>&nbsp;<span class="op" id="3212574">!</span><span class="ident" id="3212575">ok</span>&nbsp;<span class="op" id="3212578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212582">port</span><span class="op" id="3212586">,</span>&nbsp;<span class="ident" id="3212588">err</span>&nbsp;<span class="op" id="3212592">=</span>&nbsp;<span class="ident" id="3212594">goLookupPort</span><span class="op" id="3212606">(</span><span class="ident" id="3212607">network</span><span class="op" id="3212614">,</span>&nbsp;<span class="ident" id="3212616">service</span><span class="op" id="3212623">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212629">return</span><br>
<span class="lineno"></span><span class="op" id="3212636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3212639">func</span>&nbsp;<span class="ident" id="3212644">lookupCNAME</span><span class="op" id="3212655">(</span><span class="ident" id="3212656">name</span>&nbsp;<span class="builtintype" id="3212661">string</span><span class="op" id="3212667">)</span>&nbsp;<span class="op" id="3212669">(</span><span class="ident" id="3212670">cname</span>&nbsp;<span class="builtintype" id="3212676">string</span><span class="op" id="3212682">,</span>&nbsp;<span class="ident" id="3212684">err</span>&nbsp;<span class="builtintype" id="3212688">error</span><span class="op" id="3212693">)</span>&nbsp;<span class="op" id="3212695">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212698">cname</span><span class="op" id="3212703">,</span>&nbsp;<span class="ident" id="3212705">err</span><span class="op" id="3212708">,</span>&nbsp;<span class="ident" id="3212710">ok</span>&nbsp;<span class="op" id="3212713">:=</span>&nbsp;<span class="ident" id="3212716">cgoLookupCNAME</span><span class="op" id="3212730">(</span><span class="ident" id="3212731">name</span><span class="op" id="3212735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212738">if</span>&nbsp;<span class="op" id="3212741">!</span><span class="ident" id="3212742">ok</span>&nbsp;<span class="op" id="3212745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212749">cname</span><span class="op" id="3212754">,</span>&nbsp;<span class="ident" id="3212756">err</span>&nbsp;<span class="op" id="3212760">=</span>&nbsp;<span class="ident" id="3212762">goLookupCNAME</span><span class="op" id="3212775">(</span><span class="ident" id="3212776">name</span><span class="op" id="3212780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212786">return</span><br>
<span class="lineno">85</span><span class="op" id="3212793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3212796">func</span>&nbsp;<span class="ident" id="3212801">lookupSRV</span><span class="op" id="3212810">(</span><span class="ident" id="3212811">service</span><span class="op" id="3212818">,</span>&nbsp;<span class="ident" id="3212820">proto</span><span class="op" id="3212825">,</span>&nbsp;<span class="ident" id="3212827">name</span>&nbsp;<span class="builtintype" id="3212832">string</span><span class="op" id="3212838">)</span>&nbsp;<span class="op" id="3212840">(</span><span class="ident" id="3212841">cname</span>&nbsp;<span class="builtintype" id="3212847">string</span><span class="op" id="3212853">,</span>&nbsp;<span class="ident" id="3212855">addrs</span>&nbsp;<span class="op" id="3212861">[</span><span class="op" id="3212862">]</span><span class="op" id="3212863">*</span><span class="ident" id="3212864">SRV</span><span class="op" id="3212867">,</span>&nbsp;<span class="ident" id="3212869">err</span>&nbsp;<span class="builtintype" id="3212873">error</span><span class="op" id="3212878">)</span>&nbsp;<span class="op" id="3212880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212883">var</span>&nbsp;<span class="ident" id="3212887">target</span>&nbsp;<span class="builtintype" id="3212894">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212902">if</span>&nbsp;<span class="ident" id="3212905">service</span>&nbsp;<span class="op" id="3212913">==</span>&nbsp;<span class="string" id="3212916">&#34;&#34;</span>&nbsp;<span class="op" id="3212919">&amp;&amp;</span>&nbsp;<span class="ident" id="3212922">proto</span>&nbsp;<span class="op" id="3212928">==</span>&nbsp;<span class="string" id="3212931">&#34;&#34;</span>&nbsp;<span class="op" id="3212934">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212938">target</span>&nbsp;<span class="op" id="3212945">=</span>&nbsp;<span class="ident" id="3212947">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212953">}</span>&nbsp;<span class="keyword" id="3212955">else</span>&nbsp;<span class="op" id="3212960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212964">target</span>&nbsp;<span class="op" id="3212971">=</span>&nbsp;<span class="string" id="3212973">&#34;_&#34;</span>&nbsp;<span class="op" id="3212977">+</span>&nbsp;<span class="ident" id="3212979">service</span>&nbsp;<span class="op" id="3212987">+</span>&nbsp;<span class="string" id="3212989">&#34;._&#34;</span>&nbsp;<span class="op" id="3212994">+</span>&nbsp;<span class="ident" id="3212996">proto</span>&nbsp;<span class="op" id="3213002">+</span>&nbsp;<span class="string" id="3213004">&#34;.&#34;</span>&nbsp;<span class="op" id="3213008">+</span>&nbsp;<span class="ident" id="3213010">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213019">var</span>&nbsp;<span class="ident" id="3213023">records</span>&nbsp;<span class="op" id="3213031">[</span><span class="op" id="3213032">]</span><span class="ident" id="3213033">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213040">cname</span><span class="op" id="3213045">,</span>&nbsp;<span class="ident" id="3213047">records</span><span class="op" id="3213054">,</span>&nbsp;<span class="ident" id="3213056">err</span>&nbsp;<span class="op" id="3213060">=</span>&nbsp;<span class="ident" id="3213062">lookup</span><span class="op" id="3213068">(</span><span class="ident" id="3213069">target</span><span class="op" id="3213075">,</span>&nbsp;<span class="ident" id="3213077">dnsTypeSRV</span><span class="op" id="3213087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213090">if</span>&nbsp;<span class="ident" id="3213093">err</span>&nbsp;<span class="op" id="3213097">!=</span>&nbsp;<span class="ident" id="3213100">nil</span>&nbsp;<span class="op" id="3213104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213108">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213119">addrs</span>&nbsp;<span class="op" id="3213125">=</span>&nbsp;<span class="builtinfunc" id="3213127">make</span><span class="op" id="3213131">(</span><span class="op" id="3213132">[</span><span class="op" id="3213133">]</span><span class="op" id="3213134">*</span><span class="ident" id="3213135">SRV</span><span class="op" id="3213138">,</span>&nbsp;<span class="builtinfunc" id="3213140">len</span><span class="op" id="3213143">(</span><span class="ident" id="3213144">records</span><span class="op" id="3213151">)</span><span class="op" id="3213152">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213155">for</span>&nbsp;<span class="ident" id="3213159">i</span><span class="op" id="3213160">,</span>&nbsp;<span class="ident" id="3213162">rr</span>&nbsp;<span class="op" id="3213165">:=</span>&nbsp;<span class="keyword" id="3213168">range</span>&nbsp;<span class="ident" id="3213174">records</span>&nbsp;<span class="op" id="3213182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213186">r</span>&nbsp;<span class="op" id="3213188">:=</span>&nbsp;<span class="ident" id="3213191">rr</span><span class="op" id="3213193">.</span><span class="op" id="3213194">(</span><span class="op" id="3213195">*</span><span class="ident" id="3213196">dnsRR_SRV</span><span class="op" id="3213205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213209">addrs</span><span class="op" id="3213214">[</span><span class="ident" id="3213215">i</span><span class="op" id="3213216">]</span>&nbsp;<span class="op" id="3213218">=</span>&nbsp;<span class="op" id="3213220">&amp;</span><span class="ident" id="3213221">SRV</span><span class="op" id="3213224">{</span><span class="ident" id="3213225">r</span><span class="op" id="3213226">.</span><span class="ident" id="3213227">Target</span><span class="op" id="3213233">,</span>&nbsp;<span class="ident" id="3213235">r</span><span class="op" id="3213236">.</span><span class="ident" id="3213237">Port</span><span class="op" id="3213241">,</span>&nbsp;<span class="ident" id="3213243">r</span><span class="op" id="3213244">.</span><span class="ident" id="3213245">Priority</span><span class="op" id="3213253">,</span>&nbsp;<span class="ident" id="3213255">r</span><span class="op" id="3213256">.</span><span class="ident" id="3213257">Weight</span><span class="op" id="3213263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213269">byPriorityWeight</span><span class="op" id="3213285">(</span><span class="ident" id="3213286">addrs</span><span class="op" id="3213291">)</span><span class="op" id="3213292">.</span><span class="ident" id="3213293">sort</span><span class="op" id="3213297">(</span><span class="op" id="3213298">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213301">return</span><br>
<span class="lineno"></span><span class="op" id="3213308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3213311">func</span>&nbsp;<span class="ident" id="3213316">lookupMX</span><span class="op" id="3213324">(</span><span class="ident" id="3213325">name</span>&nbsp;<span class="builtintype" id="3213330">string</span><span class="op" id="3213336">)</span>&nbsp;<span class="op" id="3213338">(</span><span class="ident" id="3213339">mx</span>&nbsp;<span class="op" id="3213342">[</span><span class="op" id="3213343">]</span><span class="op" id="3213344">*</span><span class="ident" id="3213345">MX</span><span class="op" id="3213347">,</span>&nbsp;<span class="ident" id="3213349">err</span>&nbsp;<span class="builtintype" id="3213353">error</span><span class="op" id="3213358">)</span>&nbsp;<span class="op" id="3213360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213363">_</span><span class="op" id="3213364">,</span>&nbsp;<span class="ident" id="3213366">records</span><span class="op" id="3213373">,</span>&nbsp;<span class="ident" id="3213375">err</span>&nbsp;<span class="op" id="3213379">:=</span>&nbsp;<span class="ident" id="3213382">lookup</span><span class="op" id="3213388">(</span><span class="ident" id="3213389">name</span><span class="op" id="3213393">,</span>&nbsp;<span class="ident" id="3213395">dnsTypeMX</span><span class="op" id="3213404">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213407">if</span>&nbsp;<span class="ident" id="3213410">err</span>&nbsp;<span class="op" id="3213414">!=</span>&nbsp;<span class="ident" id="3213417">nil</span>&nbsp;<span class="op" id="3213421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213425">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213436">mx</span>&nbsp;<span class="op" id="3213439">=</span>&nbsp;<span class="builtinfunc" id="3213441">make</span><span class="op" id="3213445">(</span><span class="op" id="3213446">[</span><span class="op" id="3213447">]</span><span class="op" id="3213448">*</span><span class="ident" id="3213449">MX</span><span class="op" id="3213451">,</span>&nbsp;<span class="builtinfunc" id="3213453">len</span><span class="op" id="3213456">(</span><span class="ident" id="3213457">records</span><span class="op" id="3213464">)</span><span class="op" id="3213465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213468">for</span>&nbsp;<span class="ident" id="3213472">i</span><span class="op" id="3213473">,</span>&nbsp;<span class="ident" id="3213475">rr</span>&nbsp;<span class="op" id="3213478">:=</span>&nbsp;<span class="keyword" id="3213481">range</span>&nbsp;<span class="ident" id="3213487">records</span>&nbsp;<span class="op" id="3213495">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213499">r</span>&nbsp;<span class="op" id="3213501">:=</span>&nbsp;<span class="ident" id="3213504">rr</span><span class="op" id="3213506">.</span><span class="op" id="3213507">(</span><span class="op" id="3213508">*</span><span class="ident" id="3213509">dnsRR_MX</span><span class="op" id="3213517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213521">mx</span><span class="op" id="3213523">[</span><span class="ident" id="3213524">i</span><span class="op" id="3213525">]</span>&nbsp;<span class="op" id="3213527">=</span>&nbsp;<span class="op" id="3213529">&amp;</span><span class="ident" id="3213530">MX</span><span class="op" id="3213532">{</span><span class="ident" id="3213533">r</span><span class="op" id="3213534">.</span><span class="ident" id="3213535">Mx</span><span class="op" id="3213537">,</span>&nbsp;<span class="ident" id="3213539">r</span><span class="op" id="3213540">.</span><span class="ident" id="3213541">Pref</span><span class="op" id="3213545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213551">byPref</span><span class="op" id="3213557">(</span><span class="ident" id="3213558">mx</span><span class="op" id="3213560">)</span><span class="op" id="3213561">.</span><span class="ident" id="3213562">sort</span><span class="op" id="3213566">(</span><span class="op" id="3213567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213570">return</span><br>
<span class="lineno">120</span><span class="op" id="3213577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3213580">func</span>&nbsp;<span class="ident" id="3213585">lookupNS</span><span class="op" id="3213593">(</span><span class="ident" id="3213594">name</span>&nbsp;<span class="builtintype" id="3213599">string</span><span class="op" id="3213605">)</span>&nbsp;<span class="op" id="3213607">(</span><span class="ident" id="3213608">ns</span>&nbsp;<span class="op" id="3213611">[</span><span class="op" id="3213612">]</span><span class="op" id="3213613">*</span><span class="ident" id="3213614">NS</span><span class="op" id="3213616">,</span>&nbsp;<span class="ident" id="3213618">err</span>&nbsp;<span class="builtintype" id="3213622">error</span><span class="op" id="3213627">)</span>&nbsp;<span class="op" id="3213629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213632">_</span><span class="op" id="3213633">,</span>&nbsp;<span class="ident" id="3213635">records</span><span class="op" id="3213642">,</span>&nbsp;<span class="ident" id="3213644">err</span>&nbsp;<span class="op" id="3213648">:=</span>&nbsp;<span class="ident" id="3213651">lookup</span><span class="op" id="3213657">(</span><span class="ident" id="3213658">name</span><span class="op" id="3213662">,</span>&nbsp;<span class="ident" id="3213664">dnsTypeNS</span><span class="op" id="3213673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213676">if</span>&nbsp;<span class="ident" id="3213679">err</span>&nbsp;<span class="op" id="3213683">!=</span>&nbsp;<span class="ident" id="3213686">nil</span>&nbsp;<span class="op" id="3213690">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213705">ns</span>&nbsp;<span class="op" id="3213708">=</span>&nbsp;<span class="builtinfunc" id="3213710">make</span><span class="op" id="3213714">(</span><span class="op" id="3213715">[</span><span class="op" id="3213716">]</span><span class="op" id="3213717">*</span><span class="ident" id="3213718">NS</span><span class="op" id="3213720">,</span>&nbsp;<span class="builtinfunc" id="3213722">len</span><span class="op" id="3213725">(</span><span class="ident" id="3213726">records</span><span class="op" id="3213733">)</span><span class="op" id="3213734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213737">for</span>&nbsp;<span class="ident" id="3213741">i</span><span class="op" id="3213742">,</span>&nbsp;<span class="ident" id="3213744">r</span>&nbsp;<span class="op" id="3213746">:=</span>&nbsp;<span class="keyword" id="3213749">range</span>&nbsp;<span class="ident" id="3213755">records</span>&nbsp;<span class="op" id="3213763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213767">r</span>&nbsp;<span class="op" id="3213769">:=</span>&nbsp;<span class="ident" id="3213772">r</span><span class="op" id="3213773">.</span><span class="op" id="3213774">(</span><span class="op" id="3213775">*</span><span class="ident" id="3213776">dnsRR_NS</span><span class="op" id="3213784">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213788">ns</span><span class="op" id="3213790">[</span><span class="ident" id="3213791">i</span><span class="op" id="3213792">]</span>&nbsp;<span class="op" id="3213794">=</span>&nbsp;<span class="op" id="3213796">&amp;</span><span class="ident" id="3213797">NS</span><span class="op" id="3213799">{</span><span class="ident" id="3213800">r</span><span class="op" id="3213801">.</span><span class="ident" id="3213802">Ns</span><span class="op" id="3213804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213810">return</span><br>
<span class="lineno"></span><span class="op" id="3213817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3213820">func</span>&nbsp;<span class="ident" id="3213825">lookupTXT</span><span class="op" id="3213834">(</span><span class="ident" id="3213835">name</span>&nbsp;<span class="builtintype" id="3213840">string</span><span class="op" id="3213846">)</span>&nbsp;<span class="op" id="3213848">(</span><span class="ident" id="3213849">txt</span>&nbsp;<span class="op" id="3213853">[</span><span class="op" id="3213854">]</span><span class="builtintype" id="3213855">string</span><span class="op" id="3213861">,</span>&nbsp;<span class="ident" id="3213863">err</span>&nbsp;<span class="builtintype" id="3213867">error</span><span class="op" id="3213872">)</span>&nbsp;<span class="op" id="3213874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213877">_</span><span class="op" id="3213878">,</span>&nbsp;<span class="ident" id="3213880">records</span><span class="op" id="3213887">,</span>&nbsp;<span class="ident" id="3213889">err</span>&nbsp;<span class="op" id="3213893">:=</span>&nbsp;<span class="ident" id="3213896">lookup</span><span class="op" id="3213902">(</span><span class="ident" id="3213903">name</span><span class="op" id="3213907">,</span>&nbsp;<span class="ident" id="3213909">dnsTypeTXT</span><span class="op" id="3213919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213922">if</span>&nbsp;<span class="ident" id="3213925">err</span>&nbsp;<span class="op" id="3213929">!=</span>&nbsp;<span class="ident" id="3213932">nil</span>&nbsp;<span class="op" id="3213936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213940">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213948">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213951">txt</span>&nbsp;<span class="op" id="3213955">=</span>&nbsp;<span class="builtinfunc" id="3213957">make</span><span class="op" id="3213961">(</span><span class="op" id="3213962">[</span><span class="op" id="3213963">]</span><span class="builtintype" id="3213964">string</span><span class="op" id="3213970">,</span>&nbsp;<span class="builtinfunc" id="3213972">len</span><span class="op" id="3213975">(</span><span class="ident" id="3213976">records</span><span class="op" id="3213983">)</span><span class="op" id="3213984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213987">for</span>&nbsp;<span class="ident" id="3213991">i</span><span class="op" id="3213992">,</span>&nbsp;<span class="ident" id="3213994">r</span>&nbsp;<span class="op" id="3213996">:=</span>&nbsp;<span class="keyword" id="3213999">range</span>&nbsp;<span class="ident" id="3214005">records</span>&nbsp;<span class="op" id="3214013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214017">txt</span><span class="op" id="3214020">[</span><span class="ident" id="3214021">i</span><span class="op" id="3214022">]</span>&nbsp;<span class="op" id="3214024">=</span>&nbsp;<span class="ident" id="3214026">r</span><span class="op" id="3214027">.</span><span class="op" id="3214028">(</span><span class="op" id="3214029">*</span><span class="ident" id="3214030">dnsRR_TXT</span><span class="op" id="3214039">)</span><span class="op" id="3214040">.</span><span class="ident" id="3214041">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214049">return</span><br>
<span class="lineno">145</span><span class="op" id="3214056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3214059">func</span>&nbsp;<span class="ident" id="3214064">lookupAddr</span><span class="op" id="3214074">(</span><span class="ident" id="3214075">addr</span>&nbsp;<span class="builtintype" id="3214080">string</span><span class="op" id="3214086">)</span>&nbsp;<span class="op" id="3214088">(</span><span class="ident" id="3214089">name</span>&nbsp;<span class="op" id="3214094">[</span><span class="op" id="3214095">]</span><span class="builtintype" id="3214096">string</span><span class="op" id="3214102">,</span>&nbsp;<span class="ident" id="3214104">err</span>&nbsp;<span class="builtintype" id="3214108">error</span><span class="op" id="3214113">)</span>&nbsp;<span class="op" id="3214115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214118">name</span>&nbsp;<span class="op" id="3214123">=</span>&nbsp;<span class="ident" id="3214125">lookupStaticAddr</span><span class="op" id="3214141">(</span><span class="ident" id="3214142">addr</span><span class="op" id="3214146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214149">if</span>&nbsp;<span class="builtinfunc" id="3214152">len</span><span class="op" id="3214155">(</span><span class="ident" id="3214156">name</span><span class="op" id="3214160">)</span>&nbsp;<span class="op" id="3214162">&gt;</span>&nbsp;<span class="num" id="3214164">0</span>&nbsp;<span class="op" id="3214166">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214181">var</span>&nbsp;<span class="ident" id="3214185">arpa</span>&nbsp;<span class="builtintype" id="3214190">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214198">arpa</span><span class="op" id="3214202">,</span>&nbsp;<span class="ident" id="3214204">err</span>&nbsp;<span class="op" id="3214208">=</span>&nbsp;<span class="ident" id="3214210">reverseaddr</span><span class="op" id="3214221">(</span><span class="ident" id="3214222">addr</span><span class="op" id="3214226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214229">if</span>&nbsp;<span class="ident" id="3214232">err</span>&nbsp;<span class="op" id="3214236">!=</span>&nbsp;<span class="ident" id="3214239">nil</span>&nbsp;<span class="op" id="3214243">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214247">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214258">var</span>&nbsp;<span class="ident" id="3214262">records</span>&nbsp;<span class="op" id="3214270">[</span><span class="op" id="3214271">]</span><span class="ident" id="3214272">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214279">_</span><span class="op" id="3214280">,</span>&nbsp;<span class="ident" id="3214282">records</span><span class="op" id="3214289">,</span>&nbsp;<span class="ident" id="3214291">err</span>&nbsp;<span class="op" id="3214295">=</span>&nbsp;<span class="ident" id="3214297">lookup</span><span class="op" id="3214303">(</span><span class="ident" id="3214304">arpa</span><span class="op" id="3214308">,</span>&nbsp;<span class="ident" id="3214310">dnsTypePTR</span><span class="op" id="3214320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214323">if</span>&nbsp;<span class="ident" id="3214326">err</span>&nbsp;<span class="op" id="3214330">!=</span>&nbsp;<span class="ident" id="3214333">nil</span>&nbsp;<span class="op" id="3214337">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214352">name</span>&nbsp;<span class="op" id="3214357">=</span>&nbsp;<span class="builtinfunc" id="3214359">make</span><span class="op" id="3214363">(</span><span class="op" id="3214364">[</span><span class="op" id="3214365">]</span><span class="builtintype" id="3214366">string</span><span class="op" id="3214372">,</span>&nbsp;<span class="builtinfunc" id="3214374">len</span><span class="op" id="3214377">(</span><span class="ident" id="3214378">records</span><span class="op" id="3214385">)</span><span class="op" id="3214386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214389">for</span>&nbsp;<span class="ident" id="3214393">i</span>&nbsp;<span class="op" id="3214395">:=</span>&nbsp;<span class="keyword" id="3214398">range</span>&nbsp;<span class="ident" id="3214404">records</span>&nbsp;<span class="op" id="3214412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214416">r</span>&nbsp;<span class="op" id="3214418">:=</span>&nbsp;<span class="ident" id="3214421">records</span><span class="op" id="3214428">[</span><span class="ident" id="3214429">i</span><span class="op" id="3214430">]</span><span class="op" id="3214431">.</span><span class="op" id="3214432">(</span><span class="op" id="3214433">*</span><span class="ident" id="3214434">dnsRR_PTR</span><span class="op" id="3214443">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214447">name</span><span class="op" id="3214451">[</span><span class="ident" id="3214452">i</span><span class="op" id="3214453">]</span>&nbsp;<span class="op" id="3214455">=</span>&nbsp;<span class="ident" id="3214457">r</span><span class="op" id="3214458">.</span><span class="ident" id="3214459">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214467">return</span><br>
<span class="lineno"></span><span class="op" id="3214474">}</span>
</div>
</body>
</html>
