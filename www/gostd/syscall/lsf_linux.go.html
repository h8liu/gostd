<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2554240">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2554296">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2554350">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2554401">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554425">package</span>&nbsp;<span class="ident" id="2554433">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554442">import</span>&nbsp;<span class="op" id="2554449">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2554452">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2554461">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554464">func</span>&nbsp;<span class="ident" id="2554469">LsfStmt</span><span class="op" id="2554476">(</span><span class="ident" id="2554477">code</span><span class="op" id="2554481">,</span>&nbsp;<span class="ident" id="2554483">k</span>&nbsp;<span class="builtintype" id="2554485">int</span><span class="op" id="2554488">)</span>&nbsp;<span class="op" id="2554490">*</span><span class="ident" id="2554491">SockFilter</span>&nbsp;<span class="op" id="2554502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554505">return</span>&nbsp;<span class="op" id="2554512">&amp;</span><span class="ident" id="2554513">SockFilter</span><span class="op" id="2554523">{</span><span class="ident" id="2554524">Code</span><span class="op" id="2554528">:</span>&nbsp;<span class="builtintype" id="2554530">uint16</span><span class="op" id="2554536">(</span><span class="ident" id="2554537">code</span><span class="op" id="2554541">)</span><span class="op" id="2554542">,</span>&nbsp;<span class="ident" id="2554544">K</span><span class="op" id="2554545">:</span>&nbsp;<span class="builtintype" id="2554547">uint32</span><span class="op" id="2554553">(</span><span class="ident" id="2554554">k</span><span class="op" id="2554555">)</span><span class="op" id="2554556">}</span><br>
<span class="lineno">15</span><span class="op" id="2554558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554561">func</span>&nbsp;<span class="ident" id="2554566">LsfJump</span><span class="op" id="2554573">(</span><span class="ident" id="2554574">code</span><span class="op" id="2554578">,</span>&nbsp;<span class="ident" id="2554580">k</span><span class="op" id="2554581">,</span>&nbsp;<span class="ident" id="2554583">jt</span><span class="op" id="2554585">,</span>&nbsp;<span class="ident" id="2554587">jf</span>&nbsp;<span class="builtintype" id="2554590">int</span><span class="op" id="2554593">)</span>&nbsp;<span class="op" id="2554595">*</span><span class="ident" id="2554596">SockFilter</span>&nbsp;<span class="op" id="2554607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554610">return</span>&nbsp;<span class="op" id="2554617">&amp;</span><span class="ident" id="2554618">SockFilter</span><span class="op" id="2554628">{</span><span class="ident" id="2554629">Code</span><span class="op" id="2554633">:</span>&nbsp;<span class="builtintype" id="2554635">uint16</span><span class="op" id="2554641">(</span><span class="ident" id="2554642">code</span><span class="op" id="2554646">)</span><span class="op" id="2554647">,</span>&nbsp;<span class="ident" id="2554649">Jt</span><span class="op" id="2554651">:</span>&nbsp;<span class="builtintype" id="2554653">uint8</span><span class="op" id="2554658">(</span><span class="ident" id="2554659">jt</span><span class="op" id="2554661">)</span><span class="op" id="2554662">,</span>&nbsp;<span class="ident" id="2554664">Jf</span><span class="op" id="2554666">:</span>&nbsp;<span class="builtintype" id="2554668">uint8</span><span class="op" id="2554673">(</span><span class="ident" id="2554674">jf</span><span class="op" id="2554676">)</span><span class="op" id="2554677">,</span>&nbsp;<span class="ident" id="2554679">K</span><span class="op" id="2554680">:</span>&nbsp;<span class="builtintype" id="2554682">uint32</span><span class="op" id="2554688">(</span><span class="ident" id="2554689">k</span><span class="op" id="2554690">)</span><span class="op" id="2554691">}</span><br>
<span class="lineno"></span><span class="op" id="2554693">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2554696">func</span>&nbsp;<span class="ident" id="2554701">LsfSocket</span><span class="op" id="2554710">(</span><span class="ident" id="2554711">ifindex</span><span class="op" id="2554718">,</span>&nbsp;<span class="ident" id="2554720">proto</span>&nbsp;<span class="builtintype" id="2554726">int</span><span class="op" id="2554729">)</span>&nbsp;<span class="op" id="2554731">(</span><span class="builtintype" id="2554732">int</span><span class="op" id="2554735">,</span>&nbsp;<span class="builtintype" id="2554737">error</span><span class="op" id="2554742">)</span>&nbsp;<span class="op" id="2554744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554747">var</span>&nbsp;<span class="ident" id="2554751">lsall</span>&nbsp;<span class="ident" id="2554757">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554776">s</span><span class="op" id="2554777">,</span>&nbsp;<span class="ident" id="2554779">e</span>&nbsp;<span class="op" id="2554781">:=</span>&nbsp;<span class="ident" id="2554784">Socket</span><span class="op" id="2554790">(</span><span class="ident" id="2554791">AF_PACKET</span><span class="op" id="2554800">,</span>&nbsp;<span class="ident" id="2554802">SOCK_RAW</span><span class="op" id="2554810">,</span>&nbsp;<span class="ident" id="2554812">proto</span><span class="op" id="2554817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554820">if</span>&nbsp;<span class="ident" id="2554823">e</span>&nbsp;<span class="op" id="2554825">!=</span>&nbsp;<span class="ident" id="2554828">nil</span>&nbsp;<span class="op" id="2554832">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554836">return</span>&nbsp;<span class="num" id="2554843">0</span><span class="op" id="2554844">,</span>&nbsp;<span class="ident" id="2554846">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2554849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554852">p</span>&nbsp;<span class="op" id="2554854">:=</span>&nbsp;<span class="op" id="2554857">(</span><span class="op" id="2554858">*</span><span class="op" id="2554859">[</span><span class="num" id="2554860">2</span><span class="op" id="2554861">]</span><span class="builtintype" id="2554862">byte</span><span class="op" id="2554866">)</span><span class="op" id="2554867">(</span><span class="ident" id="2554868">unsafe</span><span class="op" id="2554874">.</span><span class="ident" id="2554875">Pointer</span><span class="op" id="2554882">(</span><span class="op" id="2554883">&amp;</span><span class="ident" id="2554884">lsall</span><span class="op" id="2554889">.</span><span class="ident" id="2554890">Protocol</span><span class="op" id="2554898">)</span><span class="op" id="2554899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554902">p</span><span class="op" id="2554903">[</span><span class="num" id="2554904">0</span><span class="op" id="2554905">]</span>&nbsp;<span class="op" id="2554907">=</span>&nbsp;<span class="builtintype" id="2554909">byte</span><span class="op" id="2554913">(</span><span class="ident" id="2554914">proto</span>&nbsp;<span class="op" id="2554920">&gt;&gt;</span>&nbsp;<span class="num" id="2554923">8</span><span class="op" id="2554924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554927">p</span><span class="op" id="2554928">[</span><span class="num" id="2554929">1</span><span class="op" id="2554930">]</span>&nbsp;<span class="op" id="2554932">=</span>&nbsp;<span class="builtintype" id="2554934">byte</span><span class="op" id="2554938">(</span><span class="ident" id="2554939">proto</span><span class="op" id="2554944">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554947">lsall</span><span class="op" id="2554952">.</span><span class="ident" id="2554953">Ifindex</span>&nbsp;<span class="op" id="2554961">=</span>&nbsp;<span class="ident" id="2554963">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554972">e</span>&nbsp;<span class="op" id="2554974">=</span>&nbsp;<span class="ident" id="2554976">Bind</span><span class="op" id="2554980">(</span><span class="ident" id="2554981">s</span><span class="op" id="2554982">,</span>&nbsp;<span class="op" id="2554984">&amp;</span><span class="ident" id="2554985">lsall</span><span class="op" id="2554990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554993">if</span>&nbsp;<span class="ident" id="2554996">e</span>&nbsp;<span class="op" id="2554998">!=</span>&nbsp;<span class="ident" id="2555001">nil</span>&nbsp;<span class="op" id="2555005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555009">Close</span><span class="op" id="2555014">(</span><span class="ident" id="2555015">s</span><span class="op" id="2555016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555020">return</span>&nbsp;<span class="num" id="2555027">0</span><span class="op" id="2555028">,</span>&nbsp;<span class="ident" id="2555030">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555036">return</span>&nbsp;<span class="ident" id="2555043">s</span><span class="op" id="2555044">,</span>&nbsp;<span class="ident" id="2555046">nil</span><br>
<span class="lineno"></span><span class="op" id="2555050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2555053">type</span>&nbsp;<span class="ident" id="2555058">iflags</span>&nbsp;<span class="keyword" id="2555065">struct</span>&nbsp;<span class="op" id="2555072">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555075">name</span>&nbsp;&nbsp;<span class="op" id="2555081">[</span><span class="ident" id="2555082">IFNAMSIZ</span><span class="op" id="2555090">]</span><span class="builtintype" id="2555091">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555097">flags</span>&nbsp;<span class="builtintype" id="2555103">uint16</span><br>
<span class="lineno"></span><span class="op" id="2555110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2555113">func</span>&nbsp;<span class="ident" id="2555118">SetLsfPromisc</span><span class="op" id="2555131">(</span><span class="ident" id="2555132">name</span>&nbsp;<span class="builtintype" id="2555137">string</span><span class="op" id="2555143">,</span>&nbsp;<span class="ident" id="2555145">m</span>&nbsp;<span class="builtintype" id="2555147">bool</span><span class="op" id="2555151">)</span>&nbsp;<span class="builtintype" id="2555153">error</span>&nbsp;<span class="op" id="2555159">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555162">s</span><span class="op" id="2555163">,</span>&nbsp;<span class="ident" id="2555165">e</span>&nbsp;<span class="op" id="2555167">:=</span>&nbsp;<span class="ident" id="2555170">Socket</span><span class="op" id="2555176">(</span><span class="ident" id="2555177">AF_INET</span><span class="op" id="2555184">,</span>&nbsp;<span class="ident" id="2555186">SOCK_DGRAM</span><span class="op" id="2555196">,</span>&nbsp;<span class="num" id="2555198">0</span><span class="op" id="2555199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555202">if</span>&nbsp;<span class="ident" id="2555205">e</span>&nbsp;<span class="op" id="2555207">!=</span>&nbsp;<span class="ident" id="2555210">nil</span>&nbsp;<span class="op" id="2555214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555218">return</span>&nbsp;<span class="ident" id="2555225">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555231">defer</span>&nbsp;<span class="ident" id="2555237">Close</span><span class="op" id="2555242">(</span><span class="ident" id="2555243">s</span><span class="op" id="2555244">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555247">var</span>&nbsp;<span class="ident" id="2555251">ifl</span>&nbsp;<span class="ident" id="2555255">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2555263">copy</span><span class="op" id="2555267">(</span><span class="ident" id="2555268">ifl</span><span class="op" id="2555271">.</span><span class="ident" id="2555272">name</span><span class="op" id="2555276">[</span><span class="op" id="2555277">:</span><span class="op" id="2555278">]</span><span class="op" id="2555279">,</span>&nbsp;<span class="op" id="2555281">[</span><span class="op" id="2555282">]</span><span class="builtintype" id="2555283">byte</span><span class="op" id="2555287">(</span><span class="ident" id="2555288">name</span><span class="op" id="2555292">)</span><span class="op" id="2555293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555296">_</span><span class="op" id="2555297">,</span>&nbsp;<span class="ident" id="2555299">_</span><span class="op" id="2555300">,</span>&nbsp;<span class="ident" id="2555302">ep</span>&nbsp;<span class="op" id="2555305">:=</span>&nbsp;<span class="ident" id="2555308">Syscall</span><span class="op" id="2555315">(</span><span class="ident" id="2555316">SYS_IOCTL</span><span class="op" id="2555325">,</span>&nbsp;<span class="builtintype" id="2555327">uintptr</span><span class="op" id="2555334">(</span><span class="ident" id="2555335">s</span><span class="op" id="2555336">)</span><span class="op" id="2555337">,</span>&nbsp;<span class="ident" id="2555339">SIOCGIFFLAGS</span><span class="op" id="2555351">,</span>&nbsp;<span class="builtintype" id="2555353">uintptr</span><span class="op" id="2555360">(</span><span class="ident" id="2555361">unsafe</span><span class="op" id="2555367">.</span><span class="ident" id="2555368">Pointer</span><span class="op" id="2555375">(</span><span class="op" id="2555376">&amp;</span><span class="ident" id="2555377">ifl</span><span class="op" id="2555380">)</span><span class="op" id="2555381">)</span><span class="op" id="2555382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555385">if</span>&nbsp;<span class="ident" id="2555388">ep</span>&nbsp;<span class="op" id="2555391">!=</span>&nbsp;<span class="num" id="2555394">0</span>&nbsp;<span class="op" id="2555396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555400">return</span>&nbsp;<span class="ident" id="2555407">Errno</span><span class="op" id="2555412">(</span><span class="ident" id="2555413">ep</span><span class="op" id="2555415">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555421">if</span>&nbsp;<span class="ident" id="2555424">m</span>&nbsp;<span class="op" id="2555426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555430">ifl</span><span class="op" id="2555433">.</span><span class="ident" id="2555434">flags</span>&nbsp;<span class="op" id="2555440">|=</span>&nbsp;<span class="builtintype" id="2555443">uint16</span><span class="op" id="2555449">(</span><span class="ident" id="2555450">IFF_PROMISC</span><span class="op" id="2555461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555464">}</span>&nbsp;<span class="keyword" id="2555466">else</span>&nbsp;<span class="op" id="2555471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555475">ifl</span><span class="op" id="2555478">.</span><span class="ident" id="2555479">flags</span>&nbsp;<span class="op" id="2555485">&amp;=</span>&nbsp;<span class="op" id="2555488">^</span><span class="builtintype" id="2555489">uint16</span><span class="op" id="2555495">(</span><span class="ident" id="2555496">IFF_PROMISC</span><span class="op" id="2555507">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555513">_</span><span class="op" id="2555514">,</span>&nbsp;<span class="ident" id="2555516">_</span><span class="op" id="2555517">,</span>&nbsp;<span class="ident" id="2555519">ep</span>&nbsp;<span class="op" id="2555522">=</span>&nbsp;<span class="ident" id="2555524">Syscall</span><span class="op" id="2555531">(</span><span class="ident" id="2555532">SYS_IOCTL</span><span class="op" id="2555541">,</span>&nbsp;<span class="builtintype" id="2555543">uintptr</span><span class="op" id="2555550">(</span><span class="ident" id="2555551">s</span><span class="op" id="2555552">)</span><span class="op" id="2555553">,</span>&nbsp;<span class="ident" id="2555555">SIOCSIFFLAGS</span><span class="op" id="2555567">,</span>&nbsp;<span class="builtintype" id="2555569">uintptr</span><span class="op" id="2555576">(</span><span class="ident" id="2555577">unsafe</span><span class="op" id="2555583">.</span><span class="ident" id="2555584">Pointer</span><span class="op" id="2555591">(</span><span class="op" id="2555592">&amp;</span><span class="ident" id="2555593">ifl</span><span class="op" id="2555596">)</span><span class="op" id="2555597">)</span><span class="op" id="2555598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555601">if</span>&nbsp;<span class="ident" id="2555604">ep</span>&nbsp;<span class="op" id="2555607">!=</span>&nbsp;<span class="num" id="2555610">0</span>&nbsp;<span class="op" id="2555612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555616">return</span>&nbsp;<span class="ident" id="2555623">Errno</span><span class="op" id="2555628">(</span><span class="ident" id="2555629">ep</span><span class="op" id="2555631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555634">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555637">return</span>&nbsp;<span class="ident" id="2555644">nil</span><br>
<span class="lineno"></span><span class="op" id="2555648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2555651">func</span>&nbsp;<span class="ident" id="2555656">AttachLsf</span><span class="op" id="2555665">(</span><span class="ident" id="2555666">fd</span>&nbsp;<span class="builtintype" id="2555669">int</span><span class="op" id="2555672">,</span>&nbsp;<span class="ident" id="2555674">i</span>&nbsp;<span class="op" id="2555676">[</span><span class="op" id="2555677">]</span><span class="ident" id="2555678">SockFilter</span><span class="op" id="2555688">)</span>&nbsp;<span class="builtintype" id="2555690">error</span>&nbsp;<span class="op" id="2555696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555699">var</span>&nbsp;<span class="ident" id="2555703">p</span>&nbsp;<span class="ident" id="2555705">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555716">p</span><span class="op" id="2555717">.</span><span class="ident" id="2555718">Len</span>&nbsp;<span class="op" id="2555722">=</span>&nbsp;<span class="builtintype" id="2555724">uint16</span><span class="op" id="2555730">(</span><span class="builtinfunc" id="2555731">len</span><span class="op" id="2555734">(</span><span class="ident" id="2555735">i</span><span class="op" id="2555736">)</span><span class="op" id="2555737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555740">p</span><span class="op" id="2555741">.</span><span class="ident" id="2555742">Filter</span>&nbsp;<span class="op" id="2555749">=</span>&nbsp;<span class="op" id="2555751">(</span><span class="op" id="2555752">*</span><span class="ident" id="2555753">SockFilter</span><span class="op" id="2555763">)</span><span class="op" id="2555764">(</span><span class="ident" id="2555765">unsafe</span><span class="op" id="2555771">.</span><span class="ident" id="2555772">Pointer</span><span class="op" id="2555779">(</span><span class="op" id="2555780">&amp;</span><span class="ident" id="2555781">i</span><span class="op" id="2555782">[</span><span class="num" id="2555783">0</span><span class="op" id="2555784">]</span><span class="op" id="2555785">)</span><span class="op" id="2555786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555789">return</span>&nbsp;<span class="ident" id="2555796">setsockopt</span><span class="op" id="2555806">(</span><span class="ident" id="2555807">fd</span><span class="op" id="2555809">,</span>&nbsp;<span class="ident" id="2555811">SOL_SOCKET</span><span class="op" id="2555821">,</span>&nbsp;<span class="ident" id="2555823">SO_ATTACH_FILTER</span><span class="op" id="2555839">,</span>&nbsp;<span class="ident" id="2555841">unsafe</span><span class="op" id="2555847">.</span><span class="ident" id="2555848">Pointer</span><span class="op" id="2555855">(</span><span class="op" id="2555856">&amp;</span><span class="ident" id="2555857">p</span><span class="op" id="2555858">)</span><span class="op" id="2555859">,</span>&nbsp;<span class="ident" id="2555861">unsafe</span><span class="op" id="2555867">.</span><span class="ident" id="2555868">Sizeof</span><span class="op" id="2555874">(</span><span class="ident" id="2555875">p</span><span class="op" id="2555876">)</span><span class="op" id="2555877">)</span><br>
<span class="lineno"></span><span class="op" id="2555879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2555882">func</span>&nbsp;<span class="ident" id="2555887">DetachLsf</span><span class="op" id="2555896">(</span><span class="ident" id="2555897">fd</span>&nbsp;<span class="builtintype" id="2555900">int</span><span class="op" id="2555903">)</span>&nbsp;<span class="builtintype" id="2555905">error</span>&nbsp;<span class="op" id="2555911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555914">var</span>&nbsp;<span class="ident" id="2555918">dummy</span>&nbsp;<span class="builtintype" id="2555924">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555929">return</span>&nbsp;<span class="ident" id="2555936">setsockopt</span><span class="op" id="2555946">(</span><span class="ident" id="2555947">fd</span><span class="op" id="2555949">,</span>&nbsp;<span class="ident" id="2555951">SOL_SOCKET</span><span class="op" id="2555961">,</span>&nbsp;<span class="ident" id="2555963">SO_DETACH_FILTER</span><span class="op" id="2555979">,</span>&nbsp;<span class="ident" id="2555981">unsafe</span><span class="op" id="2555987">.</span><span class="ident" id="2555988">Pointer</span><span class="op" id="2555995">(</span><span class="op" id="2555996">&amp;</span><span class="ident" id="2555997">dummy</span><span class="op" id="2556002">)</span><span class="op" id="2556003">,</span>&nbsp;<span class="ident" id="2556005">unsafe</span><span class="op" id="2556011">.</span><span class="ident" id="2556012">Sizeof</span><span class="op" id="2556018">(</span><span class="ident" id="2556019">dummy</span><span class="op" id="2556024">)</span><span class="op" id="2556025">)</span><br>
<span class="lineno"></span><span class="op" id="2556027">}</span>
</div>
</body>
</html>
