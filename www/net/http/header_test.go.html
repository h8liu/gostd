<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7988750">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7988806">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7988860">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7988911">package</span>&nbsp;<span class="ident" id="7988919">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7988925">import</span>&nbsp;<span class="op" id="7988932">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7988935">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7988944">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7988955">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7988966">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7988973">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7988976">var</span>&nbsp;<span class="ident" id="7988980">headerWriteTests</span>&nbsp;<span class="op" id="7988997">=</span>&nbsp;<span class="op" id="7988999">[</span><span class="op" id="7989000">]</span><span class="keyword" id="7989001">struct</span>&nbsp;<span class="op" id="7989008">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989011">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7989020">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989028">exclude</span>&nbsp;&nbsp;<span class="keyword" id="7989037">map</span><span class="op" id="7989040">[</span><span class="builtintype" id="7989041">string</span><span class="op" id="7989047">]</span><span class="builtintype" id="7989048">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989054">expected</span>&nbsp;<span class="builtintype" id="7989063">string</span><br>
<span class="lineno"></span><span class="op" id="7989070">}</span><span class="op" id="7989071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989074">{</span><span class="ident" id="7989075">Header</span><span class="op" id="7989081">{</span><span class="op" id="7989082">}</span><span class="op" id="7989083">,</span>&nbsp;<span class="ident" id="7989085">nil</span><span class="op" id="7989088">,</span>&nbsp;<span class="string" id="7989090">&#34;&#34;</span><span class="op" id="7989092">}</span><span class="op" id="7989093">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989100">Header</span><span class="op" id="7989106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989111">&#34;Content-Type&#34;</span><span class="op" id="7989125">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7989129">{</span><span class="string" id="7989130">&#34;text/html;&nbsp;charset=UTF-8&#34;</span><span class="op" id="7989156">}</span><span class="op" id="7989157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989162">&#34;Content-Length&#34;</span><span class="op" id="7989178">:</span>&nbsp;<span class="op" id="7989180">{</span><span class="string" id="7989181">&#34;0&#34;</span><span class="op" id="7989184">}</span><span class="op" id="7989185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989189">}</span><span class="op" id="7989190">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989194">nil</span><span class="op" id="7989197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989201">&#34;Content-Length:&nbsp;0\r\nContent-Type:&nbsp;text/html;&nbsp;charset=UTF-8\r\n&#34;</span><span class="op" id="7989266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989269">}</span><span class="op" id="7989270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989277">Header</span><span class="op" id="7989283">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989288">&#34;Content-Length&#34;</span><span class="op" id="7989304">:</span>&nbsp;<span class="op" id="7989306">{</span><span class="string" id="7989307">&#34;0&#34;</span><span class="op" id="7989310">,</span>&nbsp;<span class="string" id="7989312">&#34;1&#34;</span><span class="op" id="7989315">,</span>&nbsp;<span class="string" id="7989317">&#34;2&#34;</span><span class="op" id="7989320">}</span><span class="op" id="7989321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989325">}</span><span class="op" id="7989326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989330">nil</span><span class="op" id="7989333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989337">&#34;Content-Length:&nbsp;0\r\nContent-Length:&nbsp;1\r\nContent-Length:&nbsp;2\r\n&#34;</span><span class="op" id="7989402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989405">}</span><span class="op" id="7989406">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989413">Header</span><span class="op" id="7989419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989424">&#34;Expires&#34;</span><span class="op" id="7989433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7989444">{</span><span class="string" id="7989445">&#34;-1&#34;</span><span class="op" id="7989449">}</span><span class="op" id="7989450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989455">&#34;Content-Length&#34;</span><span class="op" id="7989471">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7989475">{</span><span class="string" id="7989476">&#34;0&#34;</span><span class="op" id="7989479">}</span><span class="op" id="7989480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989485">&#34;Content-Encoding&#34;</span><span class="op" id="7989503">:</span>&nbsp;<span class="op" id="7989505">{</span><span class="string" id="7989506">&#34;gzip&#34;</span><span class="op" id="7989512">}</span><span class="op" id="7989513">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989517">}</span><span class="op" id="7989518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989522">map</span><span class="op" id="7989525">[</span><span class="builtintype" id="7989526">string</span><span class="op" id="7989532">]</span><span class="builtintype" id="7989533">bool</span><span class="op" id="7989537">{</span><span class="string" id="7989538">&#34;Content-Length&#34;</span><span class="op" id="7989554">:</span>&nbsp;<span class="ident" id="7989556">true</span><span class="op" id="7989560">}</span><span class="op" id="7989561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989565">&#34;Content-Encoding:&nbsp;gzip\r\nExpires:&nbsp;-1\r\n&#34;</span><span class="op" id="7989608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989611">}</span><span class="op" id="7989612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989615">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989619">Header</span><span class="op" id="7989625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989630">&#34;Expires&#34;</span><span class="op" id="7989639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7989650">{</span><span class="string" id="7989651">&#34;-1&#34;</span><span class="op" id="7989655">}</span><span class="op" id="7989656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989661">&#34;Content-Length&#34;</span><span class="op" id="7989677">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7989681">{</span><span class="string" id="7989682">&#34;0&#34;</span><span class="op" id="7989685">,</span>&nbsp;<span class="string" id="7989687">&#34;1&#34;</span><span class="op" id="7989690">,</span>&nbsp;<span class="string" id="7989692">&#34;2&#34;</span><span class="op" id="7989695">}</span><span class="op" id="7989696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989701">&#34;Content-Encoding&#34;</span><span class="op" id="7989719">:</span>&nbsp;<span class="op" id="7989721">{</span><span class="string" id="7989722">&#34;gzip&#34;</span><span class="op" id="7989728">}</span><span class="op" id="7989729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989733">}</span><span class="op" id="7989734">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989738">map</span><span class="op" id="7989741">[</span><span class="builtintype" id="7989742">string</span><span class="op" id="7989748">]</span><span class="builtintype" id="7989749">bool</span><span class="op" id="7989753">{</span><span class="string" id="7989754">&#34;Content-Length&#34;</span><span class="op" id="7989770">:</span>&nbsp;<span class="ident" id="7989772">true</span><span class="op" id="7989776">}</span><span class="op" id="7989777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989781">&#34;Content-Encoding:&nbsp;gzip\r\nExpires:&nbsp;-1\r\n&#34;</span><span class="op" id="7989824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989827">}</span><span class="op" id="7989828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7989835">Header</span><span class="op" id="7989841">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989846">&#34;Expires&#34;</span><span class="op" id="7989855">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7989866">{</span><span class="string" id="7989867">&#34;-1&#34;</span><span class="op" id="7989871">}</span><span class="op" id="7989872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989877">&#34;Content-Length&#34;</span><span class="op" id="7989893">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7989897">{</span><span class="string" id="7989898">&#34;0&#34;</span><span class="op" id="7989901">}</span><span class="op" id="7989902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7989907">&#34;Content-Encoding&#34;</span><span class="op" id="7989925">:</span>&nbsp;<span class="op" id="7989927">{</span><span class="string" id="7989928">&#34;gzip&#34;</span><span class="op" id="7989934">}</span><span class="op" id="7989935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7989939">}</span><span class="op" id="7989940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7989944">map</span><span class="op" id="7989947">[</span><span class="builtintype" id="7989948">string</span><span class="op" id="7989954">]</span><span class="builtintype" id="7989955">bool</span><span class="op" id="7989959">{</span><span class="string" id="7989960">&#34;Content-Length&#34;</span><span class="op" id="7989976">:</span>&nbsp;<span class="ident" id="7989978">true</span><span class="op" id="7989982">,</span>&nbsp;<span class="string" id="7989984">&#34;Expires&#34;</span><span class="op" id="7989993">:</span>&nbsp;<span class="ident" id="7989995">true</span><span class="op" id="7989999">,</span>&nbsp;<span class="string" id="7990001">&#34;Content-Encoding&#34;</span><span class="op" id="7990019">:</span>&nbsp;<span class="ident" id="7990021">true</span><span class="op" id="7990025">}</span><span class="op" id="7990026">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990030">&#34;&#34;</span><span class="op" id="7990032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990035">}</span><span class="op" id="7990036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990043">Header</span><span class="op" id="7990049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990054">&#34;Nil&#34;</span><span class="op" id="7990059">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7990070">nil</span><span class="op" id="7990073">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990078">&#34;Empty&#34;</span><span class="op" id="7990085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7990094">{</span><span class="op" id="7990095">}</span><span class="op" id="7990096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990101">&#34;Blank&#34;</span><span class="op" id="7990108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7990117">{</span><span class="string" id="7990118">&#34;&#34;</span><span class="op" id="7990120">}</span><span class="op" id="7990121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990126">&#34;Double-Blank&#34;</span><span class="op" id="7990140">:</span>&nbsp;<span class="op" id="7990142">{</span><span class="string" id="7990143">&#34;&#34;</span><span class="op" id="7990145">,</span>&nbsp;<span class="string" id="7990147">&#34;&#34;</span><span class="op" id="7990149">}</span><span class="op" id="7990150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990154">}</span><span class="op" id="7990155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990159">nil</span><span class="op" id="7990162">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990166">&#34;Blank:&nbsp;\r\nDouble-Blank:&nbsp;\r\nDouble-Blank:&nbsp;\r\n&#34;</span><span class="op" id="7990215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990218">}</span><span class="op" id="7990219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7990222">//&nbsp;Tests&nbsp;header&nbsp;sorting&nbsp;when&nbsp;over&nbsp;the&nbsp;insertion&nbsp;sort&nbsp;threshold&nbsp;side:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990296">Header</span><span class="op" id="7990302">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990307">&#34;k1&#34;</span><span class="op" id="7990311">:</span>&nbsp;<span class="op" id="7990313">{</span><span class="string" id="7990314">&#34;1a&#34;</span><span class="op" id="7990318">,</span>&nbsp;<span class="string" id="7990320">&#34;1b&#34;</span><span class="op" id="7990324">}</span><span class="op" id="7990325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990330">&#34;k2&#34;</span><span class="op" id="7990334">:</span>&nbsp;<span class="op" id="7990336">{</span><span class="string" id="7990337">&#34;2a&#34;</span><span class="op" id="7990341">,</span>&nbsp;<span class="string" id="7990343">&#34;2b&#34;</span><span class="op" id="7990347">}</span><span class="op" id="7990348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990353">&#34;k3&#34;</span><span class="op" id="7990357">:</span>&nbsp;<span class="op" id="7990359">{</span><span class="string" id="7990360">&#34;3a&#34;</span><span class="op" id="7990364">,</span>&nbsp;<span class="string" id="7990366">&#34;3b&#34;</span><span class="op" id="7990370">}</span><span class="op" id="7990371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990376">&#34;k4&#34;</span><span class="op" id="7990380">:</span>&nbsp;<span class="op" id="7990382">{</span><span class="string" id="7990383">&#34;4a&#34;</span><span class="op" id="7990387">,</span>&nbsp;<span class="string" id="7990389">&#34;4b&#34;</span><span class="op" id="7990393">}</span><span class="op" id="7990394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990399">&#34;k5&#34;</span><span class="op" id="7990403">:</span>&nbsp;<span class="op" id="7990405">{</span><span class="string" id="7990406">&#34;5a&#34;</span><span class="op" id="7990410">,</span>&nbsp;<span class="string" id="7990412">&#34;5b&#34;</span><span class="op" id="7990416">}</span><span class="op" id="7990417">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990422">&#34;k6&#34;</span><span class="op" id="7990426">:</span>&nbsp;<span class="op" id="7990428">{</span><span class="string" id="7990429">&#34;6a&#34;</span><span class="op" id="7990433">,</span>&nbsp;<span class="string" id="7990435">&#34;6b&#34;</span><span class="op" id="7990439">}</span><span class="op" id="7990440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990445">&#34;k7&#34;</span><span class="op" id="7990449">:</span>&nbsp;<span class="op" id="7990451">{</span><span class="string" id="7990452">&#34;7a&#34;</span><span class="op" id="7990456">,</span>&nbsp;<span class="string" id="7990458">&#34;7b&#34;</span><span class="op" id="7990462">}</span><span class="op" id="7990463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990468">&#34;k8&#34;</span><span class="op" id="7990472">:</span>&nbsp;<span class="op" id="7990474">{</span><span class="string" id="7990475">&#34;8a&#34;</span><span class="op" id="7990479">,</span>&nbsp;<span class="string" id="7990481">&#34;8b&#34;</span><span class="op" id="7990485">}</span><span class="op" id="7990486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990491">&#34;k9&#34;</span><span class="op" id="7990495">:</span>&nbsp;<span class="op" id="7990497">{</span><span class="string" id="7990498">&#34;9a&#34;</span><span class="op" id="7990502">,</span>&nbsp;<span class="string" id="7990504">&#34;9b&#34;</span><span class="op" id="7990508">}</span><span class="op" id="7990509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990513">}</span><span class="op" id="7990514">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990518">map</span><span class="op" id="7990521">[</span><span class="builtintype" id="7990522">string</span><span class="op" id="7990528">]</span><span class="builtintype" id="7990529">bool</span><span class="op" id="7990533">{</span><span class="string" id="7990534">&#34;k5&#34;</span><span class="op" id="7990538">:</span>&nbsp;<span class="ident" id="7990540">true</span><span class="op" id="7990544">}</span><span class="op" id="7990545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990549">&#34;k1:&nbsp;1a\r\nk1:&nbsp;1b\r\nk2:&nbsp;2a\r\nk2:&nbsp;2b\r\nk3:&nbsp;3a\r\nk3:&nbsp;3b\r\n&#34;</span>&nbsp;<span class="op" id="7990612">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990617">&#34;k4:&nbsp;4a\r\nk4:&nbsp;4b\r\nk6:&nbsp;6a\r\nk6:&nbsp;6b\r\n&#34;</span>&nbsp;<span class="op" id="7990660">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7990665">&#34;k7:&nbsp;7a\r\nk7:&nbsp;7b\r\nk8:&nbsp;8a\r\nk8:&nbsp;8b\r\nk9:&nbsp;9a\r\nk9:&nbsp;9b\r\n&#34;</span><span class="op" id="7990727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990730">}</span><span class="op" id="7990731">,</span><br>
<span class="lineno">90</span><span class="op" id="7990733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7990736">func</span>&nbsp;<span class="ident" id="7990741">TestHeaderWrite</span><span class="op" id="7990756">(</span><span class="ident" id="7990757">t</span>&nbsp;<span class="op" id="7990759">*</span><span class="ident" id="7990760">testing</span><span class="op" id="7990767">.</span><span class="ident" id="7990768">T</span><span class="op" id="7990769">)</span>&nbsp;<span class="op" id="7990771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990774">var</span>&nbsp;<span class="ident" id="7990778">buf</span>&nbsp;<span class="ident" id="7990782">bytes</span><span class="op" id="7990787">.</span><span class="ident" id="7990788">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990796">for</span>&nbsp;<span class="ident" id="7990800">i</span><span class="op" id="7990801">,</span>&nbsp;<span class="ident" id="7990803">test</span>&nbsp;<span class="op" id="7990808">:=</span>&nbsp;<span class="keyword" id="7990811">range</span>&nbsp;<span class="ident" id="7990817">headerWriteTests</span>&nbsp;<span class="op" id="7990834">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990838">test</span><span class="op" id="7990842">.</span><span class="ident" id="7990843">h</span><span class="op" id="7990844">.</span><span class="ident" id="7990845">WriteSubset</span><span class="op" id="7990856">(</span><span class="op" id="7990857">&amp;</span><span class="ident" id="7990858">buf</span><span class="op" id="7990861">,</span>&nbsp;<span class="ident" id="7990863">test</span><span class="op" id="7990867">.</span><span class="ident" id="7990868">exclude</span><span class="op" id="7990875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7990879">if</span>&nbsp;<span class="ident" id="7990882">buf</span><span class="op" id="7990885">.</span><span class="ident" id="7990886">String</span><span class="op" id="7990892">(</span><span class="op" id="7990893">)</span>&nbsp;<span class="op" id="7990895">!=</span>&nbsp;<span class="ident" id="7990898">test</span><span class="op" id="7990902">.</span><span class="ident" id="7990903">expected</span>&nbsp;<span class="op" id="7990912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990917">t</span><span class="op" id="7990918">.</span><span class="ident" id="7990919">Errorf</span><span class="op" id="7990925">(</span><span class="string" id="7990926">&#34;#%d:\n&nbsp;got:&nbsp;%q\nwant:&nbsp;%q&#34;</span><span class="op" id="7990952">,</span>&nbsp;<span class="ident" id="7990954">i</span><span class="op" id="7990955">,</span>&nbsp;<span class="ident" id="7990957">buf</span><span class="op" id="7990960">.</span><span class="ident" id="7990961">String</span><span class="op" id="7990967">(</span><span class="op" id="7990968">)</span><span class="op" id="7990969">,</span>&nbsp;<span class="ident" id="7990971">test</span><span class="op" id="7990975">.</span><span class="ident" id="7990976">expected</span><span class="op" id="7990984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7990988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7990992">buf</span><span class="op" id="7990995">.</span><span class="ident" id="7990996">Reset</span><span class="op" id="7991001">(</span><span class="op" id="7991002">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991005">}</span><br>
<span class="lineno"></span><span class="op" id="7991007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7991010">var</span>&nbsp;<span class="ident" id="7991014">parseTimeTests</span>&nbsp;<span class="op" id="7991029">=</span>&nbsp;<span class="op" id="7991031">[</span><span class="op" id="7991032">]</span><span class="keyword" id="7991033">struct</span>&nbsp;<span class="op" id="7991040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991043">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7991047">Header</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991055">err</span>&nbsp;<span class="builtintype" id="7991059">bool</span><br>
<span class="lineno"></span><span class="op" id="7991064">}</span><span class="op" id="7991065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991068">{</span><span class="ident" id="7991069">Header</span><span class="op" id="7991075">{</span><span class="string" id="7991076">&#34;Date&#34;</span><span class="op" id="7991082">:</span>&nbsp;<span class="op" id="7991084">{</span><span class="string" id="7991085">&#34;&#34;</span><span class="op" id="7991087">}</span><span class="op" id="7991088">}</span><span class="op" id="7991089">,</span>&nbsp;<span class="ident" id="7991091">true</span><span class="op" id="7991095">}</span><span class="op" id="7991096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991099">{</span><span class="ident" id="7991100">Header</span><span class="op" id="7991106">{</span><span class="string" id="7991107">&#34;Date&#34;</span><span class="op" id="7991113">:</span>&nbsp;<span class="op" id="7991115">{</span><span class="string" id="7991116">&#34;invalid&#34;</span><span class="op" id="7991125">}</span><span class="op" id="7991126">}</span><span class="op" id="7991127">,</span>&nbsp;<span class="ident" id="7991129">true</span><span class="op" id="7991133">}</span><span class="op" id="7991134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991137">{</span><span class="ident" id="7991138">Header</span><span class="op" id="7991144">{</span><span class="string" id="7991145">&#34;Date&#34;</span><span class="op" id="7991151">:</span>&nbsp;<span class="op" id="7991153">{</span><span class="string" id="7991154">&#34;1994-11-06T08:49:37Z00:00&#34;</span><span class="op" id="7991181">}</span><span class="op" id="7991182">}</span><span class="op" id="7991183">,</span>&nbsp;<span class="ident" id="7991185">true</span><span class="op" id="7991189">}</span><span class="op" id="7991190">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991193">{</span><span class="ident" id="7991194">Header</span><span class="op" id="7991200">{</span><span class="string" id="7991201">&#34;Date&#34;</span><span class="op" id="7991207">:</span>&nbsp;<span class="op" id="7991209">{</span><span class="string" id="7991210">&#34;Sun,&nbsp;06&nbsp;Nov&nbsp;1994&nbsp;08:49:37&nbsp;GMT&#34;</span><span class="op" id="7991241">}</span><span class="op" id="7991242">}</span><span class="op" id="7991243">,</span>&nbsp;<span class="ident" id="7991245">false</span><span class="op" id="7991250">}</span><span class="op" id="7991251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991254">{</span><span class="ident" id="7991255">Header</span><span class="op" id="7991261">{</span><span class="string" id="7991262">&#34;Date&#34;</span><span class="op" id="7991268">:</span>&nbsp;<span class="op" id="7991270">{</span><span class="string" id="7991271">&#34;Sunday,&nbsp;06-Nov-94&nbsp;08:49:37&nbsp;GMT&#34;</span><span class="op" id="7991303">}</span><span class="op" id="7991304">}</span><span class="op" id="7991305">,</span>&nbsp;<span class="ident" id="7991307">false</span><span class="op" id="7991312">}</span><span class="op" id="7991313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991316">{</span><span class="ident" id="7991317">Header</span><span class="op" id="7991323">{</span><span class="string" id="7991324">&#34;Date&#34;</span><span class="op" id="7991330">:</span>&nbsp;<span class="op" id="7991332">{</span><span class="string" id="7991333">&#34;Sun&nbsp;Nov&nbsp;&nbsp;6&nbsp;08:49:37&nbsp;1994&#34;</span><span class="op" id="7991359">}</span><span class="op" id="7991360">}</span><span class="op" id="7991361">,</span>&nbsp;<span class="ident" id="7991363">false</span><span class="op" id="7991368">}</span><span class="op" id="7991369">,</span><br>
<span class="lineno"></span><span class="op" id="7991371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7991374">func</span>&nbsp;<span class="ident" id="7991379">TestParseTime</span><span class="op" id="7991392">(</span><span class="ident" id="7991393">t</span>&nbsp;<span class="op" id="7991395">*</span><span class="ident" id="7991396">testing</span><span class="op" id="7991403">.</span><span class="ident" id="7991404">T</span><span class="op" id="7991405">)</span>&nbsp;<span class="op" id="7991407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991410">expect</span>&nbsp;<span class="op" id="7991417">:=</span>&nbsp;<span class="ident" id="7991420">time</span><span class="op" id="7991424">.</span><span class="ident" id="7991425">Date</span><span class="op" id="7991429">(</span><span class="num" id="7991430">1994</span><span class="op" id="7991434">,</span>&nbsp;<span class="num" id="7991436">11</span><span class="op" id="7991438">,</span>&nbsp;<span class="num" id="7991440">6</span><span class="op" id="7991441">,</span>&nbsp;<span class="num" id="7991443">8</span><span class="op" id="7991444">,</span>&nbsp;<span class="num" id="7991446">49</span><span class="op" id="7991448">,</span>&nbsp;<span class="num" id="7991450">37</span><span class="op" id="7991452">,</span>&nbsp;<span class="num" id="7991454">0</span><span class="op" id="7991455">,</span>&nbsp;<span class="ident" id="7991457">time</span><span class="op" id="7991461">.</span><span class="ident" id="7991462">UTC</span><span class="op" id="7991465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991468">for</span>&nbsp;<span class="ident" id="7991472">i</span><span class="op" id="7991473">,</span>&nbsp;<span class="ident" id="7991475">test</span>&nbsp;<span class="op" id="7991480">:=</span>&nbsp;<span class="keyword" id="7991483">range</span>&nbsp;<span class="ident" id="7991489">parseTimeTests</span>&nbsp;<span class="op" id="7991504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991508">d</span><span class="op" id="7991509">,</span>&nbsp;<span class="ident" id="7991511">err</span>&nbsp;<span class="op" id="7991515">:=</span>&nbsp;<span class="ident" id="7991518">ParseTime</span><span class="op" id="7991527">(</span><span class="ident" id="7991528">test</span><span class="op" id="7991532">.</span><span class="ident" id="7991533">h</span><span class="op" id="7991534">.</span><span class="ident" id="7991535">Get</span><span class="op" id="7991538">(</span><span class="string" id="7991539">&#34;Date&#34;</span><span class="op" id="7991545">)</span><span class="op" id="7991546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991550">if</span>&nbsp;<span class="ident" id="7991553">err</span>&nbsp;<span class="op" id="7991557">!=</span>&nbsp;<span class="ident" id="7991560">nil</span>&nbsp;<span class="op" id="7991564">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991569">if</span>&nbsp;<span class="op" id="7991572">!</span><span class="ident" id="7991573">test</span><span class="op" id="7991577">.</span><span class="ident" id="7991578">err</span>&nbsp;<span class="op" id="7991582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991588">t</span><span class="op" id="7991589">.</span><span class="ident" id="7991590">Errorf</span><span class="op" id="7991596">(</span><span class="string" id="7991597">&#34;#%d:\n&nbsp;got&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7991617">,</span>&nbsp;<span class="ident" id="7991619">i</span><span class="op" id="7991620">,</span>&nbsp;<span class="ident" id="7991622">err</span><span class="op" id="7991625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991635">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991646">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991650">if</span>&nbsp;<span class="ident" id="7991653">test</span><span class="op" id="7991657">.</span><span class="ident" id="7991658">err</span>&nbsp;<span class="op" id="7991662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991667">t</span><span class="op" id="7991668">.</span><span class="ident" id="7991669">Errorf</span><span class="op" id="7991675">(</span><span class="string" id="7991676">&#34;#%d:\n&nbsp;&nbsp;should&nbsp;err&#34;</span><span class="op" id="7991696">,</span>&nbsp;<span class="ident" id="7991698">i</span><span class="op" id="7991699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991704">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7991719">if</span>&nbsp;<span class="op" id="7991722">!</span><span class="ident" id="7991723">expect</span><span class="op" id="7991729">.</span><span class="ident" id="7991730">Equal</span><span class="op" id="7991735">(</span><span class="ident" id="7991736">d</span><span class="op" id="7991737">)</span>&nbsp;<span class="op" id="7991739">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991744">t</span><span class="op" id="7991745">.</span><span class="ident" id="7991746">Errorf</span><span class="op" id="7991752">(</span><span class="string" id="7991753">&#34;#%d:\n&nbsp;got:&nbsp;%v\nwant:&nbsp;%v&#34;</span><span class="op" id="7991779">,</span>&nbsp;<span class="ident" id="7991781">i</span><span class="op" id="7991782">,</span>&nbsp;<span class="ident" id="7991784">d</span><span class="op" id="7991785">,</span>&nbsp;<span class="ident" id="7991787">expect</span><span class="op" id="7991793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991800">}</span><br>
<span class="lineno"></span><span class="op" id="7991802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="7991805">type</span>&nbsp;<span class="ident" id="7991810">hasTokenTest</span>&nbsp;<span class="keyword" id="7991823">struct</span>&nbsp;<span class="op" id="7991830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991833">header</span>&nbsp;<span class="builtintype" id="7991840">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991848">token</span>&nbsp;&nbsp;<span class="builtintype" id="7991855">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7991863">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7991870">bool</span><br>
<span class="lineno"></span><span class="op" id="7991875">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7991878">var</span>&nbsp;<span class="ident" id="7991882">hasTokenTests</span>&nbsp;<span class="op" id="7991896">=</span>&nbsp;<span class="op" id="7991898">[</span><span class="op" id="7991899">]</span><span class="ident" id="7991900">hasTokenTest</span><span class="op" id="7991912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991915">{</span><span class="string" id="7991916">&#34;&#34;</span><span class="op" id="7991918">,</span>&nbsp;<span class="string" id="7991920">&#34;&#34;</span><span class="op" id="7991922">,</span>&nbsp;<span class="ident" id="7991924">false</span><span class="op" id="7991929">}</span><span class="op" id="7991930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991933">{</span><span class="string" id="7991934">&#34;&#34;</span><span class="op" id="7991936">,</span>&nbsp;<span class="string" id="7991938">&#34;foo&#34;</span><span class="op" id="7991943">,</span>&nbsp;<span class="ident" id="7991945">false</span><span class="op" id="7991950">}</span><span class="op" id="7991951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991954">{</span><span class="string" id="7991955">&#34;foo&#34;</span><span class="op" id="7991960">,</span>&nbsp;<span class="string" id="7991962">&#34;foo&#34;</span><span class="op" id="7991967">,</span>&nbsp;<span class="ident" id="7991969">true</span><span class="op" id="7991973">}</span><span class="op" id="7991974">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7991977">{</span><span class="string" id="7991978">&#34;foo&nbsp;&#34;</span><span class="op" id="7991984">,</span>&nbsp;<span class="string" id="7991986">&#34;foo&#34;</span><span class="op" id="7991991">,</span>&nbsp;<span class="ident" id="7991993">true</span><span class="op" id="7991997">}</span><span class="op" id="7991998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992001">{</span><span class="string" id="7992002">&#34;&nbsp;foo&#34;</span><span class="op" id="7992008">,</span>&nbsp;<span class="string" id="7992010">&#34;foo&#34;</span><span class="op" id="7992015">,</span>&nbsp;<span class="ident" id="7992017">true</span><span class="op" id="7992021">}</span><span class="op" id="7992022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992025">{</span><span class="string" id="7992026">&#34;&nbsp;foo&nbsp;&#34;</span><span class="op" id="7992033">,</span>&nbsp;<span class="string" id="7992035">&#34;foo&#34;</span><span class="op" id="7992040">,</span>&nbsp;<span class="ident" id="7992042">true</span><span class="op" id="7992046">}</span><span class="op" id="7992047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992050">{</span><span class="string" id="7992051">&#34;foo,bar&#34;</span><span class="op" id="7992060">,</span>&nbsp;<span class="string" id="7992062">&#34;foo&#34;</span><span class="op" id="7992067">,</span>&nbsp;<span class="ident" id="7992069">true</span><span class="op" id="7992073">}</span><span class="op" id="7992074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992077">{</span><span class="string" id="7992078">&#34;bar,foo&#34;</span><span class="op" id="7992087">,</span>&nbsp;<span class="string" id="7992089">&#34;foo&#34;</span><span class="op" id="7992094">,</span>&nbsp;<span class="ident" id="7992096">true</span><span class="op" id="7992100">}</span><span class="op" id="7992101">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992104">{</span><span class="string" id="7992105">&#34;bar,&nbsp;foo&#34;</span><span class="op" id="7992115">,</span>&nbsp;<span class="string" id="7992117">&#34;foo&#34;</span><span class="op" id="7992122">,</span>&nbsp;<span class="ident" id="7992124">true</span><span class="op" id="7992128">}</span><span class="op" id="7992129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992132">{</span><span class="string" id="7992133">&#34;bar,foo,&nbsp;baz&#34;</span><span class="op" id="7992147">,</span>&nbsp;<span class="string" id="7992149">&#34;foo&#34;</span><span class="op" id="7992154">,</span>&nbsp;<span class="ident" id="7992156">true</span><span class="op" id="7992160">}</span><span class="op" id="7992161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992164">{</span><span class="string" id="7992165">&#34;bar,&nbsp;foo,baz&#34;</span><span class="op" id="7992179">,</span>&nbsp;<span class="string" id="7992181">&#34;foo&#34;</span><span class="op" id="7992186">,</span>&nbsp;<span class="ident" id="7992188">true</span><span class="op" id="7992192">}</span><span class="op" id="7992193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992196">{</span><span class="string" id="7992197">&#34;bar,foo,&nbsp;baz&#34;</span><span class="op" id="7992211">,</span>&nbsp;<span class="string" id="7992213">&#34;foo&#34;</span><span class="op" id="7992218">,</span>&nbsp;<span class="ident" id="7992220">true</span><span class="op" id="7992224">}</span><span class="op" id="7992225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992228">{</span><span class="string" id="7992229">&#34;bar,&nbsp;foo,&nbsp;baz&#34;</span><span class="op" id="7992244">,</span>&nbsp;<span class="string" id="7992246">&#34;foo&#34;</span><span class="op" id="7992251">,</span>&nbsp;<span class="ident" id="7992253">true</span><span class="op" id="7992257">}</span><span class="op" id="7992258">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992261">{</span><span class="string" id="7992262">&#34;FOO&#34;</span><span class="op" id="7992267">,</span>&nbsp;<span class="string" id="7992269">&#34;foo&#34;</span><span class="op" id="7992274">,</span>&nbsp;<span class="ident" id="7992276">true</span><span class="op" id="7992280">}</span><span class="op" id="7992281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992284">{</span><span class="string" id="7992285">&#34;FOO&nbsp;&#34;</span><span class="op" id="7992291">,</span>&nbsp;<span class="string" id="7992293">&#34;foo&#34;</span><span class="op" id="7992298">,</span>&nbsp;<span class="ident" id="7992300">true</span><span class="op" id="7992304">}</span><span class="op" id="7992305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992308">{</span><span class="string" id="7992309">&#34;&nbsp;FOO&#34;</span><span class="op" id="7992315">,</span>&nbsp;<span class="string" id="7992317">&#34;foo&#34;</span><span class="op" id="7992322">,</span>&nbsp;<span class="ident" id="7992324">true</span><span class="op" id="7992328">}</span><span class="op" id="7992329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992332">{</span><span class="string" id="7992333">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7992340">,</span>&nbsp;<span class="string" id="7992342">&#34;foo&#34;</span><span class="op" id="7992347">,</span>&nbsp;<span class="ident" id="7992349">true</span><span class="op" id="7992353">}</span><span class="op" id="7992354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992357">{</span><span class="string" id="7992358">&#34;FOO,BAR&#34;</span><span class="op" id="7992367">,</span>&nbsp;<span class="string" id="7992369">&#34;foo&#34;</span><span class="op" id="7992374">,</span>&nbsp;<span class="ident" id="7992376">true</span><span class="op" id="7992380">}</span><span class="op" id="7992381">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992384">{</span><span class="string" id="7992385">&#34;BAR,FOO&#34;</span><span class="op" id="7992394">,</span>&nbsp;<span class="string" id="7992396">&#34;foo&#34;</span><span class="op" id="7992401">,</span>&nbsp;<span class="ident" id="7992403">true</span><span class="op" id="7992407">}</span><span class="op" id="7992408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992411">{</span><span class="string" id="7992412">&#34;BAR,&nbsp;FOO&#34;</span><span class="op" id="7992422">,</span>&nbsp;<span class="string" id="7992424">&#34;foo&#34;</span><span class="op" id="7992429">,</span>&nbsp;<span class="ident" id="7992431">true</span><span class="op" id="7992435">}</span><span class="op" id="7992436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992439">{</span><span class="string" id="7992440">&#34;BAR,FOO,&nbsp;baz&#34;</span><span class="op" id="7992454">,</span>&nbsp;<span class="string" id="7992456">&#34;foo&#34;</span><span class="op" id="7992461">,</span>&nbsp;<span class="ident" id="7992463">true</span><span class="op" id="7992467">}</span><span class="op" id="7992468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992471">{</span><span class="string" id="7992472">&#34;BAR,&nbsp;FOO,BAZ&#34;</span><span class="op" id="7992486">,</span>&nbsp;<span class="string" id="7992488">&#34;foo&#34;</span><span class="op" id="7992493">,</span>&nbsp;<span class="ident" id="7992495">true</span><span class="op" id="7992499">}</span><span class="op" id="7992500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992503">{</span><span class="string" id="7992504">&#34;BAR,FOO,&nbsp;BAZ&#34;</span><span class="op" id="7992518">,</span>&nbsp;<span class="string" id="7992520">&#34;foo&#34;</span><span class="op" id="7992525">,</span>&nbsp;<span class="ident" id="7992527">true</span><span class="op" id="7992531">}</span><span class="op" id="7992532">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992535">{</span><span class="string" id="7992536">&#34;BAR,&nbsp;FOO,&nbsp;BAZ&#34;</span><span class="op" id="7992551">,</span>&nbsp;<span class="string" id="7992553">&#34;foo&#34;</span><span class="op" id="7992558">,</span>&nbsp;<span class="ident" id="7992560">true</span><span class="op" id="7992564">}</span><span class="op" id="7992565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992568">{</span><span class="string" id="7992569">&#34;foobar&#34;</span><span class="op" id="7992577">,</span>&nbsp;<span class="string" id="7992579">&#34;foo&#34;</span><span class="op" id="7992584">,</span>&nbsp;<span class="ident" id="7992586">false</span><span class="op" id="7992591">}</span><span class="op" id="7992592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992595">{</span><span class="string" id="7992596">&#34;barfoo&nbsp;&#34;</span><span class="op" id="7992605">,</span>&nbsp;<span class="string" id="7992607">&#34;foo&#34;</span><span class="op" id="7992612">,</span>&nbsp;<span class="ident" id="7992614">false</span><span class="op" id="7992619">}</span><span class="op" id="7992620">,</span><br>
<span class="lineno"></span><span class="op" id="7992622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7992625">func</span>&nbsp;<span class="ident" id="7992630">TestHasToken</span><span class="op" id="7992642">(</span><span class="ident" id="7992643">t</span>&nbsp;<span class="op" id="7992645">*</span><span class="ident" id="7992646">testing</span><span class="op" id="7992653">.</span><span class="ident" id="7992654">T</span><span class="op" id="7992655">)</span>&nbsp;<span class="op" id="7992657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992660">for</span>&nbsp;<span class="ident" id="7992664">_</span><span class="op" id="7992665">,</span>&nbsp;<span class="ident" id="7992667">tt</span>&nbsp;<span class="op" id="7992670">:=</span>&nbsp;<span class="keyword" id="7992673">range</span>&nbsp;<span class="ident" id="7992679">hasTokenTests</span>&nbsp;<span class="op" id="7992693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7992697">if</span>&nbsp;<span class="ident" id="7992700">hasToken</span><span class="op" id="7992708">(</span><span class="ident" id="7992709">tt</span><span class="op" id="7992711">.</span><span class="ident" id="7992712">header</span><span class="op" id="7992718">,</span>&nbsp;<span class="ident" id="7992720">tt</span><span class="op" id="7992722">.</span><span class="ident" id="7992723">token</span><span class="op" id="7992728">)</span>&nbsp;<span class="op" id="7992730">!=</span>&nbsp;<span class="ident" id="7992733">tt</span><span class="op" id="7992735">.</span><span class="ident" id="7992736">want</span>&nbsp;<span class="op" id="7992741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7992746">t</span><span class="op" id="7992747">.</span><span class="ident" id="7992748">Errorf</span><span class="op" id="7992754">(</span><span class="string" id="7992755">&#34;hasToken(%q,&nbsp;%q)&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7992787">,</span>&nbsp;<span class="ident" id="7992789">tt</span><span class="op" id="7992791">.</span><span class="ident" id="7992792">header</span><span class="op" id="7992798">,</span>&nbsp;<span class="ident" id="7992800">tt</span><span class="op" id="7992802">.</span><span class="ident" id="7992803">token</span><span class="op" id="7992808">,</span>&nbsp;<span class="op" id="7992810">!</span><span class="ident" id="7992811">tt</span><span class="op" id="7992813">.</span><span class="ident" id="7992814">want</span><span class="op" id="7992818">,</span>&nbsp;<span class="ident" id="7992820">tt</span><span class="op" id="7992822">.</span><span class="ident" id="7992823">want</span><span class="op" id="7992827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992831">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7992834">}</span><br>
<span class="lineno"></span><span class="op" id="7992836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7992839">var</span>&nbsp;<span class="ident" id="7992843">testHeader</span>&nbsp;<span class="op" id="7992854">=</span>&nbsp;<span class="ident" id="7992856">Header</span><span class="op" id="7992862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7992865">&#34;Content-Length&#34;</span><span class="op" id="7992881">:</span>&nbsp;<span class="op" id="7992883">{</span><span class="string" id="7992884">&#34;123&#34;</span><span class="op" id="7992889">}</span><span class="op" id="7992890">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7992893">&#34;Content-Type&#34;</span><span class="op" id="7992907">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7992911">{</span><span class="string" id="7992912">&#34;text/plain&#34;</span><span class="op" id="7992924">}</span><span class="op" id="7992925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7992928">&#34;Date&#34;</span><span class="op" id="7992934">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7992946">{</span><span class="string" id="7992947">&#34;some&nbsp;date&nbsp;at&nbsp;some&nbsp;time&nbsp;Z&#34;</span><span class="op" id="7992973">}</span><span class="op" id="7992974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7992977">&#34;Server&#34;</span><span class="op" id="7992985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7992995">{</span><span class="ident" id="7992996">DefaultUserAgent</span><span class="op" id="7993012">}</span><span class="op" id="7993013">,</span><br>
<span class="lineno"></span><span class="op" id="7993015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="7993018">var</span>&nbsp;<span class="ident" id="7993022">buf</span>&nbsp;<span class="ident" id="7993026">bytes</span><span class="op" id="7993031">.</span><span class="ident" id="7993032">Buffer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7993040">func</span>&nbsp;<span class="ident" id="7993045">BenchmarkHeaderWriteSubset</span><span class="op" id="7993071">(</span><span class="ident" id="7993072">b</span>&nbsp;<span class="op" id="7993074">*</span><span class="ident" id="7993075">testing</span><span class="op" id="7993082">.</span><span class="ident" id="7993083">B</span><span class="op" id="7993084">)</span>&nbsp;<span class="op" id="7993086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993089">b</span><span class="op" id="7993090">.</span><span class="ident" id="7993091">ReportAllocs</span><span class="op" id="7993103">(</span><span class="op" id="7993104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993107">for</span>&nbsp;<span class="ident" id="7993111">i</span>&nbsp;<span class="op" id="7993113">:=</span>&nbsp;<span class="num" id="7993116">0</span><span class="op" id="7993117">;</span>&nbsp;<span class="ident" id="7993119">i</span>&nbsp;<span class="op" id="7993121">&lt;</span>&nbsp;<span class="ident" id="7993123">b</span><span class="op" id="7993124">.</span><span class="ident" id="7993125">N</span><span class="op" id="7993126">;</span>&nbsp;<span class="ident" id="7993128">i</span><span class="op" id="7993129">++</span>&nbsp;<span class="op" id="7993132">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993136">buf</span><span class="op" id="7993139">.</span><span class="ident" id="7993140">Reset</span><span class="op" id="7993145">(</span><span class="op" id="7993146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993150">testHeader</span><span class="op" id="7993160">.</span><span class="ident" id="7993161">WriteSubset</span><span class="op" id="7993172">(</span><span class="op" id="7993173">&amp;</span><span class="ident" id="7993174">buf</span><span class="op" id="7993177">,</span>&nbsp;<span class="ident" id="7993179">nil</span><span class="op" id="7993182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993185">}</span><br>
<span class="lineno"></span><span class="op" id="7993187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="keyword" id="7993190">func</span>&nbsp;<span class="ident" id="7993195">TestHeaderWriteSubsetAllocs</span><span class="op" id="7993222">(</span><span class="ident" id="7993223">t</span>&nbsp;<span class="op" id="7993225">*</span><span class="ident" id="7993226">testing</span><span class="op" id="7993233">.</span><span class="ident" id="7993234">T</span><span class="op" id="7993235">)</span>&nbsp;<span class="op" id="7993237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993240">if</span>&nbsp;<span class="ident" id="7993243">testing</span><span class="op" id="7993250">.</span><span class="ident" id="7993251">Short</span><span class="op" id="7993256">(</span><span class="op" id="7993257">)</span>&nbsp;<span class="op" id="7993259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993263">t</span><span class="op" id="7993264">.</span><span class="ident" id="7993265">Skip</span><span class="op" id="7993269">(</span><span class="string" id="7993270">&#34;skipping&nbsp;alloc&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7993305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993311">if</span>&nbsp;<span class="ident" id="7993314">raceEnabled</span>&nbsp;<span class="op" id="7993326">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993330">t</span><span class="op" id="7993331">.</span><span class="ident" id="7993332">Skip</span><span class="op" id="7993336">(</span><span class="string" id="7993337">&#34;skipping&nbsp;test&nbsp;under&nbsp;race&nbsp;detector&#34;</span><span class="op" id="7993372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993378">if</span>&nbsp;<span class="ident" id="7993381">runtime</span><span class="op" id="7993388">.</span><span class="ident" id="7993389">GOMAXPROCS</span><span class="op" id="7993399">(</span><span class="num" id="7993400">0</span><span class="op" id="7993401">)</span>&nbsp;<span class="op" id="7993403">&gt;</span>&nbsp;<span class="num" id="7993405">1</span>&nbsp;<span class="op" id="7993407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993411">t</span><span class="op" id="7993412">.</span><span class="ident" id="7993413">Skip</span><span class="op" id="7993417">(</span><span class="string" id="7993418">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7993442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993445">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993448">n</span>&nbsp;<span class="op" id="7993450">:=</span>&nbsp;<span class="ident" id="7993453">testing</span><span class="op" id="7993460">.</span><span class="ident" id="7993461">AllocsPerRun</span><span class="op" id="7993473">(</span><span class="num" id="7993474">100</span><span class="op" id="7993477">,</span>&nbsp;<span class="keyword" id="7993479">func</span><span class="op" id="7993483">(</span><span class="op" id="7993484">)</span>&nbsp;<span class="op" id="7993486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993490">buf</span><span class="op" id="7993493">.</span><span class="ident" id="7993494">Reset</span><span class="op" id="7993499">(</span><span class="op" id="7993500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993504">testHeader</span><span class="op" id="7993514">.</span><span class="ident" id="7993515">WriteSubset</span><span class="op" id="7993526">(</span><span class="op" id="7993527">&amp;</span><span class="ident" id="7993528">buf</span><span class="op" id="7993531">,</span>&nbsp;<span class="ident" id="7993533">nil</span><span class="op" id="7993536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993539">}</span><span class="op" id="7993540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7993543">if</span>&nbsp;<span class="ident" id="7993546">n</span>&nbsp;<span class="op" id="7993548">&gt;</span>&nbsp;<span class="num" id="7993550">0</span>&nbsp;<span class="op" id="7993552">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7993556">t</span><span class="op" id="7993557">.</span><span class="ident" id="7993558">Errorf</span><span class="op" id="7993564">(</span><span class="string" id="7993565">&#34;allocs&nbsp;=&nbsp;%g;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7993586">,</span>&nbsp;<span class="ident" id="7993588">n</span><span class="op" id="7993589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7993592">}</span><br>
<span class="lineno"></span><span class="op" id="7993594">}</span>
</div>
</body>
</html>
