<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path/filepath</h2>
<ul>
<li><a href="/gostd/path/filepath/example_unix_test.go.html">example_unix_test.go</a></li>
<li><a href="/gostd/path/filepath/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/path/filepath/match.go.html">match.go</a></li>
<li><a href="/gostd/path/filepath/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/filepath/path.go.html">path.go</a></li>
<li><a href="/gostd/path/filepath/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/path/filepath/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/path/filepath/symlink.go.html">symlink.go</a></li>
<li><a href="/gostd/path/filepath/symlink_unix.go.html">symlink_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3013269">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3013324">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3013378">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3013429">package</span>&nbsp;<span class="ident" id="3013437">filepath</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3013447">import</span>&nbsp;<span class="op" id="3013454">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013457">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013467">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013473">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013484">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013492">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013503">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3013518">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3013521">//&nbsp;ErrBadPattern&nbsp;indicates&nbsp;a&nbsp;globbing&nbsp;pattern&nbsp;was&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="keyword" id="3013582">var</span>&nbsp;<span class="ident" id="3013586">ErrBadPattern</span>&nbsp;<span class="op" id="3013600">=</span>&nbsp;<span class="ident" id="3013602">errors</span><span class="op" id="3013608">.</span><span class="ident" id="3013609">New</span><span class="op" id="3013612">(</span><span class="string" id="3013613">&#34;syntax&nbsp;error&nbsp;in&nbsp;pattern&#34;</span><span class="op" id="3013638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3013641">//&nbsp;Match&nbsp;returns&nbsp;true&nbsp;if&nbsp;name&nbsp;matches&nbsp;the&nbsp;shell&nbsp;file&nbsp;name&nbsp;pattern.</span><br>
<span class="lineno">20</span><span class="comment" id="3013708">//&nbsp;The&nbsp;pattern&nbsp;syntax&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="3013734">//</span><br>
<span class="lineno"></span><span class="comment" id="3013737">//&nbsp;&nbsp;&nbsp;&nbsppattern:</span><br>
<span class="lineno"></span><span class="comment" id="3013749">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{&nbsp;term&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3013762">//&nbsp;&nbsp;&nbsp;&nbspterm:</span><br>
<span class="lineno">25</span><span class="comment" id="3013771">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;*&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;sequence&nbsp;of&nbsp;non-Separator&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="3013836">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;?&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;single&nbsp;non-Separator&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3013895">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;[&#39;&nbsp;[&nbsp;&#39;^&#39;&nbsp;]&nbsp;{&nbsp;character-range&nbsp;}&nbsp;&#39;]&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3013935">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character&nbsp;class&nbsp;(must&nbsp;be&nbsp;non-empty)</span><br>
<span class="lineno"></span><span class="comment" id="3013987">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;*&#39;,&nbsp;&#39;?&#39;,&nbsp;&#39;\\&#39;,&nbsp;&#39;[&#39;)</span><br>
<span class="lineno">30</span><span class="comment" id="3014050">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno"></span><span class="comment" id="3014086">//</span><br>
<span class="lineno"></span><span class="comment" id="3014089">//&nbsp;&nbsp;&nbsp;&nbspcharacter-range:</span><br>
<span class="lineno"></span><span class="comment" id="3014109">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;\\&#39;,&nbsp;&#39;-&#39;,&nbsp;&#39;]&#39;)</span><br>
<span class="lineno"></span><span class="comment" id="3014167">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno">35</span><span class="comment" id="3014203">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplo&nbsp;&#39;-&#39;&nbsp;hi&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;for&nbsp;lo&nbsp;&lt;=&nbsp;c&nbsp;&lt;=&nbsp;hi</span><br>
<span class="lineno"></span><span class="comment" id="3014257">//</span><br>
<span class="lineno"></span><span class="comment" id="3014260">//&nbsp;Match&nbsp;requires&nbsp;pattern&nbsp;to&nbsp;match&nbsp;all&nbsp;of&nbsp;name,&nbsp;not&nbsp;just&nbsp;a&nbsp;substring.</span><br>
<span class="lineno"></span><span class="comment" id="3014330">//&nbsp;The&nbsp;only&nbsp;possible&nbsp;returned&nbsp;error&nbsp;is&nbsp;ErrBadPattern,&nbsp;when&nbsp;pattern</span><br>
<span class="lineno"></span><span class="comment" id="3014397">//&nbsp;is&nbsp;malformed.</span><br>
<span class="lineno">40</span><span class="comment" id="3014414">//</span><br>
<span class="lineno"></span><span class="comment" id="3014417">//&nbsp;On&nbsp;Windows,&nbsp;escaping&nbsp;is&nbsp;disabled.&nbsp;Instead,&nbsp;&#39;\\&#39;&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3014482">//&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span><span class="comment" id="3014501">//</span><br>
<span class="lineno"></span><span class="keyword" id="3014504">func</span>&nbsp;<span class="ident" id="3014509">Match</span><span class="op" id="3014514">(</span><span class="ident" id="3014515">pattern</span><span class="op" id="3014522">,</span>&nbsp;<span class="ident" id="3014524">name</span>&nbsp;<span class="builtintype" id="3014529">string</span><span class="op" id="3014535">)</span>&nbsp;<span class="op" id="3014537">(</span><span class="ident" id="3014538">matched</span>&nbsp;<span class="builtintype" id="3014546">bool</span><span class="op" id="3014550">,</span>&nbsp;<span class="ident" id="3014552">err</span>&nbsp;<span class="builtintype" id="3014556">error</span><span class="op" id="3014561">)</span>&nbsp;<span class="op" id="3014563">{</span><br>
<span class="lineno">45</span><span class="ident" id="3014565">Pattern</span><span class="op" id="3014572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014575">for</span>&nbsp;<span class="builtinfunc" id="3014579">len</span><span class="op" id="3014582">(</span><span class="ident" id="3014583">pattern</span><span class="op" id="3014590">)</span>&nbsp;<span class="op" id="3014592">&gt;</span>&nbsp;<span class="num" id="3014594">0</span>&nbsp;<span class="op" id="3014596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014600">var</span>&nbsp;<span class="ident" id="3014604">star</span>&nbsp;<span class="builtintype" id="3014609">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014616">var</span>&nbsp;<span class="ident" id="3014620">chunk</span>&nbsp;<span class="builtintype" id="3014626">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014635">star</span><span class="op" id="3014639">,</span>&nbsp;<span class="ident" id="3014641">chunk</span><span class="op" id="3014646">,</span>&nbsp;<span class="ident" id="3014648">pattern</span>&nbsp;<span class="op" id="3014656">=</span>&nbsp;<span class="ident" id="3014658">scanChunk</span><span class="op" id="3014667">(</span><span class="ident" id="3014668">pattern</span><span class="op" id="3014675">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014679">if</span>&nbsp;<span class="ident" id="3014682">star</span>&nbsp;<span class="op" id="3014687">&amp;&amp;</span>&nbsp;<span class="ident" id="3014690">chunk</span>&nbsp;<span class="op" id="3014696">==</span>&nbsp;<span class="string" id="3014699">&#34;&#34;</span>&nbsp;<span class="op" id="3014702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014707">//&nbsp;Trailing&nbsp;*&nbsp;matches&nbsp;rest&nbsp;of&nbsp;string&nbsp;unless&nbsp;it&nbsp;has&nbsp;a&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014766">return</span>&nbsp;<span class="ident" id="3014773">strings</span><span class="op" id="3014780">.</span><span class="ident" id="3014781">Index</span><span class="op" id="3014786">(</span><span class="ident" id="3014787">name</span><span class="op" id="3014791">,</span>&nbsp;<span class="builtintype" id="3014793">string</span><span class="op" id="3014799">(</span><span class="ident" id="3014800">Separator</span><span class="op" id="3014809">)</span><span class="op" id="3014810">)</span>&nbsp;<span class="op" id="3014812">&lt;</span>&nbsp;<span class="num" id="3014814">0</span><span class="op" id="3014815">,</span>&nbsp;<span class="ident" id="3014817">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014827">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;at&nbsp;current&nbsp;position.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014868">t</span><span class="op" id="3014869">,</span>&nbsp;<span class="ident" id="3014871">ok</span><span class="op" id="3014873">,</span>&nbsp;<span class="ident" id="3014875">err</span>&nbsp;<span class="op" id="3014879">:=</span>&nbsp;<span class="ident" id="3014882">matchChunk</span><span class="op" id="3014892">(</span><span class="ident" id="3014893">chunk</span><span class="op" id="3014898">,</span>&nbsp;<span class="ident" id="3014900">name</span><span class="op" id="3014904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014908">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&#39;ve&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014973">//&nbsp;otherwise&nbsp;we&#39;ll&nbsp;give&nbsp;a&nbsp;false&nbsp;result&nbsp;even&nbsp;if&nbsp;we&nbsp;could&nbsp;still&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015043">//&nbsp;using&nbsp;the&nbsp;star</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015063">if</span>&nbsp;<span class="ident" id="3015066">ok</span>&nbsp;<span class="op" id="3015069">&amp;&amp;</span>&nbsp;<span class="op" id="3015072">(</span><span class="builtinfunc" id="3015073">len</span><span class="op" id="3015076">(</span><span class="ident" id="3015077">t</span><span class="op" id="3015078">)</span>&nbsp;<span class="op" id="3015080">==</span>&nbsp;<span class="num" id="3015083">0</span>&nbsp;<span class="op" id="3015085">||</span>&nbsp;<span class="builtinfunc" id="3015088">len</span><span class="op" id="3015091">(</span><span class="ident" id="3015092">pattern</span><span class="op" id="3015099">)</span>&nbsp;<span class="op" id="3015101">&gt;</span>&nbsp;<span class="num" id="3015103">0</span><span class="op" id="3015104">)</span>&nbsp;<span class="op" id="3015106">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015111">name</span>&nbsp;<span class="op" id="3015116">=</span>&nbsp;<span class="ident" id="3015118">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015123">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015138">if</span>&nbsp;<span class="ident" id="3015141">err</span>&nbsp;<span class="op" id="3015145">!=</span>&nbsp;<span class="ident" id="3015148">nil</span>&nbsp;<span class="op" id="3015152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015157">return</span>&nbsp;<span class="builtintype" id="3015164">false</span><span class="op" id="3015169">,</span>&nbsp;<span class="ident" id="3015171">err</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015181">if</span>&nbsp;<span class="ident" id="3015184">star</span>&nbsp;<span class="op" id="3015189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015194">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;skipping&nbsp;i+1&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015235">//&nbsp;Cannot&nbsp;skip&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015256">for</span>&nbsp;<span class="ident" id="3015260">i</span>&nbsp;<span class="op" id="3015262">:=</span>&nbsp;<span class="num" id="3015265">0</span><span class="op" id="3015266">;</span>&nbsp;<span class="ident" id="3015268">i</span>&nbsp;<span class="op" id="3015270">&lt;</span>&nbsp;<span class="builtinfunc" id="3015272">len</span><span class="op" id="3015275">(</span><span class="ident" id="3015276">name</span><span class="op" id="3015280">)</span>&nbsp;<span class="op" id="3015282">&amp;&amp;</span>&nbsp;<span class="ident" id="3015285">name</span><span class="op" id="3015289">[</span><span class="ident" id="3015290">i</span><span class="op" id="3015291">]</span>&nbsp;<span class="op" id="3015293">!=</span>&nbsp;<span class="ident" id="3015296">Separator</span><span class="op" id="3015305">;</span>&nbsp;<span class="ident" id="3015307">i</span><span class="op" id="3015308">++</span>&nbsp;<span class="op" id="3015311">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015317">t</span><span class="op" id="3015318">,</span>&nbsp;<span class="ident" id="3015320">ok</span><span class="op" id="3015322">,</span>&nbsp;<span class="ident" id="3015324">err</span>&nbsp;<span class="op" id="3015328">:=</span>&nbsp;<span class="ident" id="3015331">matchChunk</span><span class="op" id="3015341">(</span><span class="ident" id="3015342">chunk</span><span class="op" id="3015347">,</span>&nbsp;<span class="ident" id="3015349">name</span><span class="op" id="3015353">[</span><span class="ident" id="3015354">i</span><span class="op" id="3015355">+</span><span class="num" id="3015356">1</span><span class="op" id="3015357">:</span><span class="op" id="3015358">]</span><span class="op" id="3015359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015365">if</span>&nbsp;<span class="ident" id="3015368">ok</span>&nbsp;<span class="op" id="3015371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015378">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015443">if</span>&nbsp;<span class="builtinfunc" id="3015446">len</span><span class="op" id="3015449">(</span><span class="ident" id="3015450">pattern</span><span class="op" id="3015457">)</span>&nbsp;<span class="op" id="3015459">==</span>&nbsp;<span class="num" id="3015462">0</span>&nbsp;<span class="op" id="3015464">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3015467">len</span><span class="op" id="3015470">(</span><span class="ident" id="3015471">t</span><span class="op" id="3015472">)</span>&nbsp;<span class="op" id="3015474">&gt;</span>&nbsp;<span class="num" id="3015476">0</span>&nbsp;<span class="op" id="3015478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015486">continue</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015507">name</span>&nbsp;<span class="op" id="3015512">=</span>&nbsp;<span class="ident" id="3015514">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015521">continue</span>&nbsp;<span class="ident" id="3015530">Pattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015548">if</span>&nbsp;<span class="ident" id="3015551">err</span>&nbsp;<span class="op" id="3015555">!=</span>&nbsp;<span class="ident" id="3015558">nil</span>&nbsp;<span class="op" id="3015562">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015569">return</span>&nbsp;<span class="builtintype" id="3015576">false</span><span class="op" id="3015581">,</span>&nbsp;<span class="ident" id="3015583">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015604">return</span>&nbsp;<span class="builtintype" id="3015611">false</span><span class="op" id="3015616">,</span>&nbsp;<span class="ident" id="3015618">nil</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015626">return</span>&nbsp;<span class="builtinfunc" id="3015633">len</span><span class="op" id="3015636">(</span><span class="ident" id="3015637">name</span><span class="op" id="3015641">)</span>&nbsp;<span class="op" id="3015643">==</span>&nbsp;<span class="num" id="3015646">0</span><span class="op" id="3015647">,</span>&nbsp;<span class="ident" id="3015649">nil</span><br>
<span class="lineno"></span><span class="op" id="3015653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3015656">//&nbsp;scanChunk&nbsp;gets&nbsp;the&nbsp;next&nbsp;segment&nbsp;of&nbsp;pattern,&nbsp;which&nbsp;is&nbsp;a&nbsp;non-star&nbsp;string</span><br>
<span class="lineno">90</span><span class="comment" id="3015730">//&nbsp;possibly&nbsp;preceded&nbsp;by&nbsp;a&nbsp;star.</span><br>
<span class="lineno"></span><span class="keyword" id="3015762">func</span>&nbsp;<span class="ident" id="3015767">scanChunk</span><span class="op" id="3015776">(</span><span class="ident" id="3015777">pattern</span>&nbsp;<span class="builtintype" id="3015785">string</span><span class="op" id="3015791">)</span>&nbsp;<span class="op" id="3015793">(</span><span class="ident" id="3015794">star</span>&nbsp;<span class="builtintype" id="3015799">bool</span><span class="op" id="3015803">,</span>&nbsp;<span class="ident" id="3015805">chunk</span><span class="op" id="3015810">,</span>&nbsp;<span class="ident" id="3015812">rest</span>&nbsp;<span class="builtintype" id="3015817">string</span><span class="op" id="3015823">)</span>&nbsp;<span class="op" id="3015825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015828">for</span>&nbsp;<span class="builtinfunc" id="3015832">len</span><span class="op" id="3015835">(</span><span class="ident" id="3015836">pattern</span><span class="op" id="3015843">)</span>&nbsp;<span class="op" id="3015845">&gt;</span>&nbsp;<span class="num" id="3015847">0</span>&nbsp;<span class="op" id="3015849">&amp;&amp;</span>&nbsp;<span class="ident" id="3015852">pattern</span><span class="op" id="3015859">[</span><span class="num" id="3015860">0</span><span class="op" id="3015861">]</span>&nbsp;<span class="op" id="3015863">==</span>&nbsp;<span class="string" id="3015866">&#39;*&#39;</span>&nbsp;<span class="op" id="3015870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015874">pattern</span>&nbsp;<span class="op" id="3015882">=</span>&nbsp;<span class="ident" id="3015884">pattern</span><span class="op" id="3015891">[</span><span class="num" id="3015892">1</span><span class="op" id="3015893">:</span><span class="op" id="3015894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015898">star</span>&nbsp;<span class="op" id="3015903">=</span>&nbsp;<span class="builtintype" id="3015905">true</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015914">inrange</span>&nbsp;<span class="op" id="3015922">:=</span>&nbsp;<span class="builtintype" id="3015925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015932">var</span>&nbsp;<span class="ident" id="3015936">i</span>&nbsp;<span class="builtintype" id="3015938">int</span><br>
<span class="lineno"></span><span class="ident" id="3015942">Scan</span><span class="op" id="3015946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015949">for</span>&nbsp;<span class="ident" id="3015953">i</span>&nbsp;<span class="op" id="3015955">=</span>&nbsp;<span class="num" id="3015957">0</span><span class="op" id="3015958">;</span>&nbsp;<span class="ident" id="3015960">i</span>&nbsp;<span class="op" id="3015962">&lt;</span>&nbsp;<span class="builtinfunc" id="3015964">len</span><span class="op" id="3015967">(</span><span class="ident" id="3015968">pattern</span><span class="op" id="3015975">)</span><span class="op" id="3015976">;</span>&nbsp;<span class="ident" id="3015978">i</span><span class="op" id="3015979">++</span>&nbsp;<span class="op" id="3015982">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015986">switch</span>&nbsp;<span class="ident" id="3015993">pattern</span><span class="op" id="3016000">[</span><span class="ident" id="3016001">i</span><span class="op" id="3016002">]</span>&nbsp;<span class="op" id="3016004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016008">case</span>&nbsp;<span class="string" id="3016013">&#39;\\&#39;</span><span class="op" id="3016017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016022">if</span>&nbsp;<span class="ident" id="3016025">runtime</span><span class="op" id="3016032">.</span><span class="ident" id="3016033">GOOS</span>&nbsp;<span class="op" id="3016038">!=</span>&nbsp;<span class="string" id="3016041">&#34;windows&#34;</span>&nbsp;<span class="op" id="3016051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016057">//&nbsp;error&nbsp;check&nbsp;handled&nbsp;in&nbsp;matchChunk:&nbsp;bad&nbsp;pattern.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016112">if</span>&nbsp;<span class="ident" id="3016115">i</span><span class="op" id="3016116">+</span><span class="num" id="3016117">1</span>&nbsp;<span class="op" id="3016119">&lt;</span>&nbsp;<span class="builtinfunc" id="3016121">len</span><span class="op" id="3016124">(</span><span class="ident" id="3016125">pattern</span><span class="op" id="3016132">)</span>&nbsp;<span class="op" id="3016134">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016141">i</span><span class="op" id="3016142">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016158">case</span>&nbsp;<span class="string" id="3016163">&#39;[&#39;</span><span class="op" id="3016166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016171">inrange</span>&nbsp;<span class="op" id="3016179">=</span>&nbsp;<span class="builtintype" id="3016181">true</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016188">case</span>&nbsp;<span class="string" id="3016193">&#39;]&#39;</span><span class="op" id="3016196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016201">inrange</span>&nbsp;<span class="op" id="3016209">=</span>&nbsp;<span class="builtintype" id="3016211">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016219">case</span>&nbsp;<span class="string" id="3016224">&#39;*&#39;</span><span class="op" id="3016227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016232">if</span>&nbsp;<span class="op" id="3016235">!</span><span class="ident" id="3016236">inrange</span>&nbsp;<span class="op" id="3016244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016250">break</span>&nbsp;<span class="ident" id="3016256">Scan</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016274">return</span>&nbsp;<span class="ident" id="3016281">star</span><span class="op" id="3016285">,</span>&nbsp;<span class="ident" id="3016287">pattern</span><span class="op" id="3016294">[</span><span class="num" id="3016295">0</span><span class="op" id="3016296">:</span><span class="ident" id="3016297">i</span><span class="op" id="3016298">]</span><span class="op" id="3016299">,</span>&nbsp;<span class="ident" id="3016301">pattern</span><span class="op" id="3016308">[</span><span class="ident" id="3016309">i</span><span class="op" id="3016310">:</span><span class="op" id="3016311">]</span><br>
<span class="lineno"></span><span class="op" id="3016313">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3016316">//&nbsp;matchChunk&nbsp;checks&nbsp;whether&nbsp;chunk&nbsp;matches&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="3016379">//&nbsp;If&nbsp;so,&nbsp;it&nbsp;returns&nbsp;the&nbsp;remainder&nbsp;of&nbsp;s&nbsp;(after&nbsp;the&nbsp;match).</span><br>
<span class="lineno"></span><span class="comment" id="3016438">//&nbsp;Chunk&nbsp;is&nbsp;all&nbsp;single-character&nbsp;operators:&nbsp;literals,&nbsp;char&nbsp;classes,&nbsp;and&nbsp;?.</span><br>
<span class="lineno"></span><span class="keyword" id="3016513">func</span>&nbsp;<span class="ident" id="3016518">matchChunk</span><span class="op" id="3016528">(</span><span class="ident" id="3016529">chunk</span><span class="op" id="3016534">,</span>&nbsp;<span class="ident" id="3016536">s</span>&nbsp;<span class="builtintype" id="3016538">string</span><span class="op" id="3016544">)</span>&nbsp;<span class="op" id="3016546">(</span><span class="ident" id="3016547">rest</span>&nbsp;<span class="builtintype" id="3016552">string</span><span class="op" id="3016558">,</span>&nbsp;<span class="ident" id="3016560">ok</span>&nbsp;<span class="builtintype" id="3016563">bool</span><span class="op" id="3016567">,</span>&nbsp;<span class="ident" id="3016569">err</span>&nbsp;<span class="builtintype" id="3016573">error</span><span class="op" id="3016578">)</span>&nbsp;<span class="op" id="3016580">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016583">for</span>&nbsp;<span class="builtinfunc" id="3016587">len</span><span class="op" id="3016590">(</span><span class="ident" id="3016591">chunk</span><span class="op" id="3016596">)</span>&nbsp;<span class="op" id="3016598">&gt;</span>&nbsp;<span class="num" id="3016600">0</span>&nbsp;<span class="op" id="3016602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016606">if</span>&nbsp;<span class="builtinfunc" id="3016609">len</span><span class="op" id="3016612">(</span><span class="ident" id="3016613">s</span><span class="op" id="3016614">)</span>&nbsp;<span class="op" id="3016616">==</span>&nbsp;<span class="num" id="3016619">0</span>&nbsp;<span class="op" id="3016621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016639">switch</span>&nbsp;<span class="ident" id="3016646">chunk</span><span class="op" id="3016651">[</span><span class="num" id="3016652">0</span><span class="op" id="3016653">]</span>&nbsp;<span class="op" id="3016655">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016659">case</span>&nbsp;<span class="string" id="3016664">&#39;[&#39;</span><span class="op" id="3016667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016672">//&nbsp;character&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016694">r</span><span class="op" id="3016695">,</span>&nbsp;<span class="ident" id="3016697">n</span>&nbsp;<span class="op" id="3016699">:=</span>&nbsp;<span class="ident" id="3016702">utf8</span><span class="op" id="3016706">.</span><span class="ident" id="3016707">DecodeRuneInString</span><span class="op" id="3016725">(</span><span class="ident" id="3016726">s</span><span class="op" id="3016727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016732">s</span>&nbsp;<span class="op" id="3016734">=</span>&nbsp;<span class="ident" id="3016736">s</span><span class="op" id="3016737">[</span><span class="ident" id="3016738">n</span><span class="op" id="3016739">:</span><span class="op" id="3016740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016745">chunk</span>&nbsp;<span class="op" id="3016751">=</span>&nbsp;<span class="ident" id="3016753">chunk</span><span class="op" id="3016758">[</span><span class="num" id="3016759">1</span><span class="op" id="3016760">:</span><span class="op" id="3016761">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016766">//&nbsp;We&nbsp;can&#39;t&nbsp;end&nbsp;right&nbsp;after&nbsp;&#39;[&#39;,&nbsp;we&#39;re&nbsp;expecting&nbsp;at&nbsp;least</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016827">//&nbsp;a&nbsp;closing&nbsp;bracket&nbsp;and&nbsp;possibly&nbsp;a&nbsp;caret.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016873">if</span>&nbsp;<span class="builtinfunc" id="3016876">len</span><span class="op" id="3016879">(</span><span class="ident" id="3016880">chunk</span><span class="op" id="3016885">)</span>&nbsp;<span class="op" id="3016887">==</span>&nbsp;<span class="num" id="3016890">0</span>&nbsp;<span class="op" id="3016892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016898">err</span>&nbsp;<span class="op" id="3016902">=</span>&nbsp;<span class="ident" id="3016904">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016922">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016937">//&nbsp;possibly&nbsp;negated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016960">negated</span>&nbsp;<span class="op" id="3016968">:=</span>&nbsp;<span class="ident" id="3016971">chunk</span><span class="op" id="3016976">[</span><span class="num" id="3016977">0</span><span class="op" id="3016978">]</span>&nbsp;<span class="op" id="3016980">==</span>&nbsp;<span class="string" id="3016983">&#39;^&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016990">if</span>&nbsp;<span class="ident" id="3016993">negated</span>&nbsp;<span class="op" id="3017001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017007">chunk</span>&nbsp;<span class="op" id="3017013">=</span>&nbsp;<span class="ident" id="3017015">chunk</span><span class="op" id="3017020">[</span><span class="num" id="3017021">1</span><span class="op" id="3017022">:</span><span class="op" id="3017023">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017033">//&nbsp;parse&nbsp;all&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017056">match</span>&nbsp;<span class="op" id="3017062">:=</span>&nbsp;<span class="builtintype" id="3017065">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017074">nrange</span>&nbsp;<span class="op" id="3017081">:=</span>&nbsp;<span class="num" id="3017084">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017089">for</span>&nbsp;<span class="op" id="3017093">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017099">if</span>&nbsp;<span class="builtinfunc" id="3017102">len</span><span class="op" id="3017105">(</span><span class="ident" id="3017106">chunk</span><span class="op" id="3017111">)</span>&nbsp;<span class="op" id="3017113">&gt;</span>&nbsp;<span class="num" id="3017115">0</span>&nbsp;<span class="op" id="3017117">&amp;&amp;</span>&nbsp;<span class="ident" id="3017120">chunk</span><span class="op" id="3017125">[</span><span class="num" id="3017126">0</span><span class="op" id="3017127">]</span>&nbsp;<span class="op" id="3017129">==</span>&nbsp;<span class="string" id="3017132">&#39;]&#39;</span>&nbsp;<span class="op" id="3017136">&amp;&amp;</span>&nbsp;<span class="ident" id="3017139">nrange</span>&nbsp;<span class="op" id="3017146">&gt;</span>&nbsp;<span class="num" id="3017148">0</span>&nbsp;<span class="op" id="3017150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017157">chunk</span>&nbsp;<span class="op" id="3017163">=</span>&nbsp;<span class="ident" id="3017165">chunk</span><span class="op" id="3017170">[</span><span class="num" id="3017171">1</span><span class="op" id="3017172">:</span><span class="op" id="3017173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017180">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017196">var</span>&nbsp;<span class="ident" id="3017200">lo</span><span class="op" id="3017202">,</span>&nbsp;<span class="ident" id="3017204">hi</span>&nbsp;<span class="builtintype" id="3017207">rune</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017216">if</span>&nbsp;<span class="ident" id="3017219">lo</span><span class="op" id="3017221">,</span>&nbsp;<span class="ident" id="3017223">chunk</span><span class="op" id="3017228">,</span>&nbsp;<span class="ident" id="3017230">err</span>&nbsp;<span class="op" id="3017234">=</span>&nbsp;<span class="ident" id="3017236">getEsc</span><span class="op" id="3017242">(</span><span class="ident" id="3017243">chunk</span><span class="op" id="3017248">)</span><span class="op" id="3017249">;</span>&nbsp;<span class="ident" id="3017251">err</span>&nbsp;<span class="op" id="3017255">!=</span>&nbsp;<span class="ident" id="3017258">nil</span>&nbsp;<span class="op" id="3017262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017269">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017286">hi</span>&nbsp;<span class="op" id="3017289">=</span>&nbsp;<span class="ident" id="3017291">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017298">if</span>&nbsp;<span class="ident" id="3017301">chunk</span><span class="op" id="3017306">[</span><span class="num" id="3017307">0</span><span class="op" id="3017308">]</span>&nbsp;<span class="op" id="3017310">==</span>&nbsp;<span class="string" id="3017313">&#39;-&#39;</span>&nbsp;<span class="op" id="3017317">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017324">if</span>&nbsp;<span class="ident" id="3017327">hi</span><span class="op" id="3017329">,</span>&nbsp;<span class="ident" id="3017331">chunk</span><span class="op" id="3017336">,</span>&nbsp;<span class="ident" id="3017338">err</span>&nbsp;<span class="op" id="3017342">=</span>&nbsp;<span class="ident" id="3017344">getEsc</span><span class="op" id="3017350">(</span><span class="ident" id="3017351">chunk</span><span class="op" id="3017356">[</span><span class="num" id="3017357">1</span><span class="op" id="3017358">:</span><span class="op" id="3017359">]</span><span class="op" id="3017360">)</span><span class="op" id="3017361">;</span>&nbsp;<span class="ident" id="3017363">err</span>&nbsp;<span class="op" id="3017367">!=</span>&nbsp;<span class="ident" id="3017370">nil</span>&nbsp;<span class="op" id="3017374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017406">if</span>&nbsp;<span class="ident" id="3017409">lo</span>&nbsp;<span class="op" id="3017412">&lt;=</span>&nbsp;<span class="ident" id="3017415">r</span>&nbsp;<span class="op" id="3017417">&amp;&amp;</span>&nbsp;<span class="ident" id="3017420">r</span>&nbsp;<span class="op" id="3017422">&lt;=</span>&nbsp;<span class="ident" id="3017425">hi</span>&nbsp;<span class="op" id="3017428">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017435">match</span>&nbsp;<span class="op" id="3017441">=</span>&nbsp;<span class="builtintype" id="3017443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017458">nrange</span><span class="op" id="3017464">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017475">if</span>&nbsp;<span class="ident" id="3017478">match</span>&nbsp;<span class="op" id="3017484">==</span>&nbsp;<span class="ident" id="3017487">negated</span>&nbsp;<span class="op" id="3017495">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017501">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017516">case</span>&nbsp;<span class="string" id="3017521">&#39;?&#39;</span><span class="op" id="3017524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017529">if</span>&nbsp;<span class="ident" id="3017532">s</span><span class="op" id="3017533">[</span><span class="num" id="3017534">0</span><span class="op" id="3017535">]</span>&nbsp;<span class="op" id="3017537">==</span>&nbsp;<span class="ident" id="3017540">Separator</span>&nbsp;<span class="op" id="3017550">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017556">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017571">_</span><span class="op" id="3017572">,</span>&nbsp;<span class="ident" id="3017574">n</span>&nbsp;<span class="op" id="3017576">:=</span>&nbsp;<span class="ident" id="3017579">utf8</span><span class="op" id="3017583">.</span><span class="ident" id="3017584">DecodeRuneInString</span><span class="op" id="3017602">(</span><span class="ident" id="3017603">s</span><span class="op" id="3017604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017609">s</span>&nbsp;<span class="op" id="3017611">=</span>&nbsp;<span class="ident" id="3017613">s</span><span class="op" id="3017614">[</span><span class="ident" id="3017615">n</span><span class="op" id="3017616">:</span><span class="op" id="3017617">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017622">chunk</span>&nbsp;<span class="op" id="3017628">=</span>&nbsp;<span class="ident" id="3017630">chunk</span><span class="op" id="3017635">[</span><span class="num" id="3017636">1</span><span class="op" id="3017637">:</span><span class="op" id="3017638">]</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017643">case</span>&nbsp;<span class="string" id="3017648">&#39;\\&#39;</span><span class="op" id="3017652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017657">if</span>&nbsp;<span class="ident" id="3017660">runtime</span><span class="op" id="3017667">.</span><span class="ident" id="3017668">GOOS</span>&nbsp;<span class="op" id="3017673">!=</span>&nbsp;<span class="string" id="3017676">&#34;windows&#34;</span>&nbsp;<span class="op" id="3017686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017692">chunk</span>&nbsp;<span class="op" id="3017698">=</span>&nbsp;<span class="ident" id="3017700">chunk</span><span class="op" id="3017705">[</span><span class="num" id="3017706">1</span><span class="op" id="3017707">:</span><span class="op" id="3017708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017714">if</span>&nbsp;<span class="builtinfunc" id="3017717">len</span><span class="op" id="3017720">(</span><span class="ident" id="3017721">chunk</span><span class="op" id="3017726">)</span>&nbsp;<span class="op" id="3017728">==</span>&nbsp;<span class="num" id="3017731">0</span>&nbsp;<span class="op" id="3017733">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017740">err</span>&nbsp;<span class="op" id="3017744">=</span>&nbsp;<span class="ident" id="3017746">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017765">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017786">fallthrough</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017801">default</span><span class="op" id="3017808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017813">if</span>&nbsp;<span class="ident" id="3017816">chunk</span><span class="op" id="3017821">[</span><span class="num" id="3017822">0</span><span class="op" id="3017823">]</span>&nbsp;<span class="op" id="3017825">!=</span>&nbsp;<span class="ident" id="3017828">s</span><span class="op" id="3017829">[</span><span class="num" id="3017830">0</span><span class="op" id="3017831">]</span>&nbsp;<span class="op" id="3017833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017839">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017849">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017854">s</span>&nbsp;<span class="op" id="3017856">=</span>&nbsp;<span class="ident" id="3017858">s</span><span class="op" id="3017859">[</span><span class="num" id="3017860">1</span><span class="op" id="3017861">:</span><span class="op" id="3017862">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017867">chunk</span>&nbsp;<span class="op" id="3017873">=</span>&nbsp;<span class="ident" id="3017875">chunk</span><span class="op" id="3017880">[</span><span class="num" id="3017881">1</span><span class="op" id="3017882">:</span><span class="op" id="3017883">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017893">return</span>&nbsp;<span class="ident" id="3017900">s</span><span class="op" id="3017901">,</span>&nbsp;<span class="builtintype" id="3017903">true</span><span class="op" id="3017907">,</span>&nbsp;<span class="ident" id="3017909">nil</span><br>
<span class="lineno">200</span><span class="op" id="3017913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3017916">//&nbsp;getEsc&nbsp;gets&nbsp;a&nbsp;possibly-escaped&nbsp;character&nbsp;from&nbsp;chunk,&nbsp;for&nbsp;a&nbsp;character&nbsp;class.</span><br>
<span class="lineno"></span><span class="keyword" id="3017995">func</span>&nbsp;<span class="ident" id="3018000">getEsc</span><span class="op" id="3018006">(</span><span class="ident" id="3018007">chunk</span>&nbsp;<span class="builtintype" id="3018013">string</span><span class="op" id="3018019">)</span>&nbsp;<span class="op" id="3018021">(</span><span class="ident" id="3018022">r</span>&nbsp;<span class="builtintype" id="3018024">rune</span><span class="op" id="3018028">,</span>&nbsp;<span class="ident" id="3018030">nchunk</span>&nbsp;<span class="builtintype" id="3018037">string</span><span class="op" id="3018043">,</span>&nbsp;<span class="ident" id="3018045">err</span>&nbsp;<span class="builtintype" id="3018049">error</span><span class="op" id="3018054">)</span>&nbsp;<span class="op" id="3018056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018059">if</span>&nbsp;<span class="builtinfunc" id="3018062">len</span><span class="op" id="3018065">(</span><span class="ident" id="3018066">chunk</span><span class="op" id="3018071">)</span>&nbsp;<span class="op" id="3018073">==</span>&nbsp;<span class="num" id="3018076">0</span>&nbsp;<span class="op" id="3018078">||</span>&nbsp;<span class="ident" id="3018081">chunk</span><span class="op" id="3018086">[</span><span class="num" id="3018087">0</span><span class="op" id="3018088">]</span>&nbsp;<span class="op" id="3018090">==</span>&nbsp;<span class="string" id="3018093">&#39;-&#39;</span>&nbsp;<span class="op" id="3018097">||</span>&nbsp;<span class="ident" id="3018100">chunk</span><span class="op" id="3018105">[</span><span class="num" id="3018106">0</span><span class="op" id="3018107">]</span>&nbsp;<span class="op" id="3018109">==</span>&nbsp;<span class="string" id="3018112">&#39;]&#39;</span>&nbsp;<span class="op" id="3018116">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018120">err</span>&nbsp;<span class="op" id="3018124">=</span>&nbsp;<span class="ident" id="3018126">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018153">if</span>&nbsp;<span class="ident" id="3018156">chunk</span><span class="op" id="3018161">[</span><span class="num" id="3018162">0</span><span class="op" id="3018163">]</span>&nbsp;<span class="op" id="3018165">==</span>&nbsp;<span class="string" id="3018168">&#39;\\&#39;</span>&nbsp;<span class="op" id="3018173">&amp;&amp;</span>&nbsp;<span class="ident" id="3018176">runtime</span><span class="op" id="3018183">.</span><span class="ident" id="3018184">GOOS</span>&nbsp;<span class="op" id="3018189">!=</span>&nbsp;<span class="string" id="3018192">&#34;windows&#34;</span>&nbsp;<span class="op" id="3018202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018206">chunk</span>&nbsp;<span class="op" id="3018212">=</span>&nbsp;<span class="ident" id="3018214">chunk</span><span class="op" id="3018219">[</span><span class="num" id="3018220">1</span><span class="op" id="3018221">:</span><span class="op" id="3018222">]</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018226">if</span>&nbsp;<span class="builtinfunc" id="3018229">len</span><span class="op" id="3018232">(</span><span class="ident" id="3018233">chunk</span><span class="op" id="3018238">)</span>&nbsp;<span class="op" id="3018240">==</span>&nbsp;<span class="num" id="3018243">0</span>&nbsp;<span class="op" id="3018245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018250">err</span>&nbsp;<span class="op" id="3018254">=</span>&nbsp;<span class="ident" id="3018256">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018273">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018285">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018288">r</span><span class="op" id="3018289">,</span>&nbsp;<span class="ident" id="3018291">n</span>&nbsp;<span class="op" id="3018293">:=</span>&nbsp;<span class="ident" id="3018296">utf8</span><span class="op" id="3018300">.</span><span class="ident" id="3018301">DecodeRuneInString</span><span class="op" id="3018319">(</span><span class="ident" id="3018320">chunk</span><span class="op" id="3018325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018328">if</span>&nbsp;<span class="ident" id="3018331">r</span>&nbsp;<span class="op" id="3018333">==</span>&nbsp;<span class="ident" id="3018336">utf8</span><span class="op" id="3018340">.</span><span class="ident" id="3018341">RuneError</span>&nbsp;<span class="op" id="3018351">&amp;&amp;</span>&nbsp;<span class="ident" id="3018354">n</span>&nbsp;<span class="op" id="3018356">==</span>&nbsp;<span class="num" id="3018359">1</span>&nbsp;<span class="op" id="3018361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018365">err</span>&nbsp;<span class="op" id="3018369">=</span>&nbsp;<span class="ident" id="3018371">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018389">nchunk</span>&nbsp;<span class="op" id="3018396">=</span>&nbsp;<span class="ident" id="3018398">chunk</span><span class="op" id="3018403">[</span><span class="ident" id="3018404">n</span><span class="op" id="3018405">:</span><span class="op" id="3018406">]</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018409">if</span>&nbsp;<span class="builtinfunc" id="3018412">len</span><span class="op" id="3018415">(</span><span class="ident" id="3018416">nchunk</span><span class="op" id="3018422">)</span>&nbsp;<span class="op" id="3018424">==</span>&nbsp;<span class="num" id="3018427">0</span>&nbsp;<span class="op" id="3018429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018433">err</span>&nbsp;<span class="op" id="3018437">=</span>&nbsp;<span class="ident" id="3018439">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018457">return</span><br>
<span class="lineno"></span><span class="op" id="3018464">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3018467">//&nbsp;Glob&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;files&nbsp;matching&nbsp;pattern&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="3018530">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;matching&nbsp;file.&nbsp;The&nbsp;syntax&nbsp;of&nbsp;patterns&nbsp;is&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="3018598">//&nbsp;as&nbsp;in&nbsp;Match.&nbsp;The&nbsp;pattern&nbsp;may&nbsp;describe&nbsp;hierarchical&nbsp;names&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3018666">//&nbsp;/usr/*/bin/ed&nbsp;(assuming&nbsp;the&nbsp;Separator&nbsp;is&nbsp;&#39;/&#39;).</span><br>
<span class="lineno">230</span><span class="comment" id="3018716">//</span><br>
<span class="lineno"></span><span class="comment" id="3018719">//&nbsp;Glob&nbsp;ignores&nbsp;file&nbsp;system&nbsp;errors&nbsp;such&nbsp;as&nbsp;I/O&nbsp;errors&nbsp;reading&nbsp;directories.</span><br>
<span class="lineno"></span><span class="comment" id="3018794">//&nbsp;The&nbsp;only&nbsp;possible&nbsp;returned&nbsp;error&nbsp;is&nbsp;ErrBadPattern,&nbsp;when&nbsp;pattern</span><br>
<span class="lineno"></span><span class="comment" id="3018861">//&nbsp;is&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="keyword" id="3018878">func</span>&nbsp;<span class="ident" id="3018883">Glob</span><span class="op" id="3018887">(</span><span class="ident" id="3018888">pattern</span>&nbsp;<span class="builtintype" id="3018896">string</span><span class="op" id="3018902">)</span>&nbsp;<span class="op" id="3018904">(</span><span class="ident" id="3018905">matches</span>&nbsp;<span class="op" id="3018913">[</span><span class="op" id="3018914">]</span><span class="builtintype" id="3018915">string</span><span class="op" id="3018921">,</span>&nbsp;<span class="ident" id="3018923">err</span>&nbsp;<span class="builtintype" id="3018927">error</span><span class="op" id="3018932">)</span>&nbsp;<span class="op" id="3018934">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018937">if</span>&nbsp;<span class="op" id="3018940">!</span><span class="ident" id="3018941">hasMeta</span><span class="op" id="3018948">(</span><span class="ident" id="3018949">pattern</span><span class="op" id="3018956">)</span>&nbsp;<span class="op" id="3018958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018962">if</span>&nbsp;<span class="ident" id="3018965">_</span><span class="op" id="3018966">,</span>&nbsp;<span class="ident" id="3018968">err</span>&nbsp;<span class="op" id="3018972">=</span>&nbsp;<span class="ident" id="3018974">os</span><span class="op" id="3018976">.</span><span class="ident" id="3018977">Lstat</span><span class="op" id="3018982">(</span><span class="ident" id="3018983">pattern</span><span class="op" id="3018990">)</span><span class="op" id="3018991">;</span>&nbsp;<span class="ident" id="3018993">err</span>&nbsp;<span class="op" id="3018997">!=</span>&nbsp;<span class="ident" id="3019000">nil</span>&nbsp;<span class="op" id="3019004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019009">return</span>&nbsp;<span class="ident" id="3019016">nil</span><span class="op" id="3019019">,</span>&nbsp;<span class="ident" id="3019021">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019031">return</span>&nbsp;<span class="op" id="3019038">[</span><span class="op" id="3019039">]</span><span class="builtintype" id="3019040">string</span><span class="op" id="3019046">{</span><span class="ident" id="3019047">pattern</span><span class="op" id="3019054">}</span><span class="op" id="3019055">,</span>&nbsp;<span class="ident" id="3019057">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019066">dir</span><span class="op" id="3019069">,</span>&nbsp;<span class="ident" id="3019071">file</span>&nbsp;<span class="op" id="3019076">:=</span>&nbsp;<span class="ident" id="3019079">Split</span><span class="op" id="3019084">(</span><span class="ident" id="3019085">pattern</span><span class="op" id="3019092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019095">switch</span>&nbsp;<span class="ident" id="3019102">dir</span>&nbsp;<span class="op" id="3019106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019109">case</span>&nbsp;<span class="string" id="3019114">&#34;&#34;</span><span class="op" id="3019116">:</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019120">dir</span>&nbsp;<span class="op" id="3019124">=</span>&nbsp;<span class="string" id="3019126">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019131">case</span>&nbsp;<span class="builtintype" id="3019136">string</span><span class="op" id="3019142">(</span><span class="ident" id="3019143">Separator</span><span class="op" id="3019152">)</span><span class="op" id="3019153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3019157">//&nbsp;nothing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019169">default</span><span class="op" id="3019176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019180">dir</span>&nbsp;<span class="op" id="3019184">=</span>&nbsp;<span class="ident" id="3019186">dir</span><span class="op" id="3019189">[</span><span class="num" id="3019190">0</span>&nbsp;<span class="op" id="3019192">:</span>&nbsp;<span class="builtinfunc" id="3019194">len</span><span class="op" id="3019197">(</span><span class="ident" id="3019198">dir</span><span class="op" id="3019201">)</span><span class="op" id="3019202">-</span><span class="num" id="3019203">1</span><span class="op" id="3019204">]</span>&nbsp;<span class="comment" id="3019206">//&nbsp;chop&nbsp;off&nbsp;trailing&nbsp;separator</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019242">if</span>&nbsp;<span class="op" id="3019245">!</span><span class="ident" id="3019246">hasMeta</span><span class="op" id="3019253">(</span><span class="ident" id="3019254">dir</span><span class="op" id="3019257">)</span>&nbsp;<span class="op" id="3019259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019263">return</span>&nbsp;<span class="ident" id="3019270">glob</span><span class="op" id="3019274">(</span><span class="ident" id="3019275">dir</span><span class="op" id="3019278">,</span>&nbsp;<span class="ident" id="3019280">file</span><span class="op" id="3019284">,</span>&nbsp;<span class="ident" id="3019286">nil</span><span class="op" id="3019289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019292">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019296">var</span>&nbsp;<span class="ident" id="3019300">m</span>&nbsp;<span class="op" id="3019302">[</span><span class="op" id="3019303">]</span><span class="builtintype" id="3019304">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019312">m</span><span class="op" id="3019313">,</span>&nbsp;<span class="ident" id="3019315">err</span>&nbsp;<span class="op" id="3019319">=</span>&nbsp;<span class="ident" id="3019321">Glob</span><span class="op" id="3019325">(</span><span class="ident" id="3019326">dir</span><span class="op" id="3019329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019332">if</span>&nbsp;<span class="ident" id="3019335">err</span>&nbsp;<span class="op" id="3019339">!=</span>&nbsp;<span class="ident" id="3019342">nil</span>&nbsp;<span class="op" id="3019346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019350">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019361">for</span>&nbsp;<span class="ident" id="3019365">_</span><span class="op" id="3019366">,</span>&nbsp;<span class="ident" id="3019368">d</span>&nbsp;<span class="op" id="3019370">:=</span>&nbsp;<span class="keyword" id="3019373">range</span>&nbsp;<span class="ident" id="3019379">m</span>&nbsp;<span class="op" id="3019381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019385">matches</span><span class="op" id="3019392">,</span>&nbsp;<span class="ident" id="3019394">err</span>&nbsp;<span class="op" id="3019398">=</span>&nbsp;<span class="ident" id="3019400">glob</span><span class="op" id="3019404">(</span><span class="ident" id="3019405">d</span><span class="op" id="3019406">,</span>&nbsp;<span class="ident" id="3019408">file</span><span class="op" id="3019412">,</span>&nbsp;<span class="ident" id="3019414">matches</span><span class="op" id="3019421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019425">if</span>&nbsp;<span class="ident" id="3019428">err</span>&nbsp;<span class="op" id="3019432">!=</span>&nbsp;<span class="ident" id="3019435">nil</span>&nbsp;<span class="op" id="3019439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019444">return</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019459">return</span><br>
<span class="lineno"></span><span class="op" id="3019466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="3019469">//&nbsp;glob&nbsp;searches&nbsp;for&nbsp;files&nbsp;matching&nbsp;pattern&nbsp;in&nbsp;the&nbsp;directory&nbsp;dir</span><br>
<span class="lineno"></span><span class="comment" id="3019534">//&nbsp;and&nbsp;appends&nbsp;them&nbsp;to&nbsp;matches.&nbsp;If&nbsp;the&nbsp;directory&nbsp;cannot&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3019593">//&nbsp;opened,&nbsp;it&nbsp;returns&nbsp;the&nbsp;existing&nbsp;matches.&nbsp;New&nbsp;matches&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3019653">//&nbsp;added&nbsp;in&nbsp;lexicographical&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="3019688">func</span>&nbsp;<span class="ident" id="3019693">glob</span><span class="op" id="3019697">(</span><span class="ident" id="3019698">dir</span><span class="op" id="3019701">,</span>&nbsp;<span class="ident" id="3019703">pattern</span>&nbsp;<span class="builtintype" id="3019711">string</span><span class="op" id="3019717">,</span>&nbsp;<span class="ident" id="3019719">matches</span>&nbsp;<span class="op" id="3019727">[</span><span class="op" id="3019728">]</span><span class="builtintype" id="3019729">string</span><span class="op" id="3019735">)</span>&nbsp;<span class="op" id="3019737">(</span><span class="ident" id="3019738">m</span>&nbsp;<span class="op" id="3019740">[</span><span class="op" id="3019741">]</span><span class="builtintype" id="3019742">string</span><span class="op" id="3019748">,</span>&nbsp;<span class="ident" id="3019750">e</span>&nbsp;<span class="builtintype" id="3019752">error</span><span class="op" id="3019757">)</span>&nbsp;<span class="op" id="3019759">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019762">m</span>&nbsp;<span class="op" id="3019764">=</span>&nbsp;<span class="ident" id="3019766">matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019775">fi</span><span class="op" id="3019777">,</span>&nbsp;<span class="ident" id="3019779">err</span>&nbsp;<span class="op" id="3019783">:=</span>&nbsp;<span class="ident" id="3019786">os</span><span class="op" id="3019788">.</span><span class="ident" id="3019789">Stat</span><span class="op" id="3019793">(</span><span class="ident" id="3019794">dir</span><span class="op" id="3019797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019800">if</span>&nbsp;<span class="ident" id="3019803">err</span>&nbsp;<span class="op" id="3019807">!=</span>&nbsp;<span class="ident" id="3019810">nil</span>&nbsp;<span class="op" id="3019814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019826">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019829">if</span>&nbsp;<span class="op" id="3019832">!</span><span class="ident" id="3019833">fi</span><span class="op" id="3019835">.</span><span class="ident" id="3019836">IsDir</span><span class="op" id="3019841">(</span><span class="op" id="3019842">)</span>&nbsp;<span class="op" id="3019844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019859">d</span><span class="op" id="3019860">,</span>&nbsp;<span class="ident" id="3019862">err</span>&nbsp;<span class="op" id="3019866">:=</span>&nbsp;<span class="ident" id="3019869">os</span><span class="op" id="3019871">.</span><span class="ident" id="3019872">Open</span><span class="op" id="3019876">(</span><span class="ident" id="3019877">dir</span><span class="op" id="3019880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019883">if</span>&nbsp;<span class="ident" id="3019886">err</span>&nbsp;<span class="op" id="3019890">!=</span>&nbsp;<span class="ident" id="3019893">nil</span>&nbsp;<span class="op" id="3019897">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019912">defer</span>&nbsp;<span class="ident" id="3019918">d</span><span class="op" id="3019919">.</span><span class="ident" id="3019920">Close</span><span class="op" id="3019925">(</span><span class="op" id="3019926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019930">names</span><span class="op" id="3019935">,</span>&nbsp;<span class="ident" id="3019937">_</span>&nbsp;<span class="op" id="3019939">:=</span>&nbsp;<span class="ident" id="3019942">d</span><span class="op" id="3019943">.</span><span class="ident" id="3019944">Readdirnames</span><span class="op" id="3019956">(</span><span class="op" id="3019957">-</span><span class="num" id="3019958">1</span><span class="op" id="3019959">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019962">sort</span><span class="op" id="3019966">.</span><span class="ident" id="3019967">Strings</span><span class="op" id="3019974">(</span><span class="ident" id="3019975">names</span><span class="op" id="3019980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019984">for</span>&nbsp;<span class="ident" id="3019988">_</span><span class="op" id="3019989">,</span>&nbsp;<span class="ident" id="3019991">n</span>&nbsp;<span class="op" id="3019993">:=</span>&nbsp;<span class="keyword" id="3019996">range</span>&nbsp;<span class="ident" id="3020002">names</span>&nbsp;<span class="op" id="3020008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020012">matched</span><span class="op" id="3020019">,</span>&nbsp;<span class="ident" id="3020021">err</span>&nbsp;<span class="op" id="3020025">:=</span>&nbsp;<span class="ident" id="3020028">Match</span><span class="op" id="3020033">(</span><span class="ident" id="3020034">pattern</span><span class="op" id="3020041">,</span>&nbsp;<span class="ident" id="3020043">n</span><span class="op" id="3020044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020048">if</span>&nbsp;<span class="ident" id="3020051">err</span>&nbsp;<span class="op" id="3020055">!=</span>&nbsp;<span class="ident" id="3020058">nil</span>&nbsp;<span class="op" id="3020062">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020067">return</span>&nbsp;<span class="ident" id="3020074">m</span><span class="op" id="3020075">,</span>&nbsp;<span class="ident" id="3020077">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020087">if</span>&nbsp;<span class="ident" id="3020090">matched</span>&nbsp;<span class="op" id="3020098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020103">m</span>&nbsp;<span class="op" id="3020105">=</span>&nbsp;<span class="builtinfunc" id="3020107">append</span><span class="op" id="3020113">(</span><span class="ident" id="3020114">m</span><span class="op" id="3020115">,</span>&nbsp;<span class="ident" id="3020117">Join</span><span class="op" id="3020121">(</span><span class="ident" id="3020122">dir</span><span class="op" id="3020125">,</span>&nbsp;<span class="ident" id="3020127">n</span><span class="op" id="3020128">)</span><span class="op" id="3020129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020133">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020139">return</span><br>
<span class="lineno"></span><span class="op" id="3020146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3020149">//&nbsp;hasMeta&nbsp;returns&nbsp;true&nbsp;if&nbsp;path&nbsp;contains&nbsp;any&nbsp;of&nbsp;the&nbsp;magic&nbsp;characters</span><br>
<span class="lineno">305</span><span class="comment" id="3020218">//&nbsp;recognized&nbsp;by&nbsp;Match.</span><br>
<span class="lineno"></span><span class="keyword" id="3020242">func</span>&nbsp;<span class="ident" id="3020247">hasMeta</span><span class="op" id="3020254">(</span><span class="ident" id="3020255">path</span>&nbsp;<span class="builtintype" id="3020260">string</span><span class="op" id="3020266">)</span>&nbsp;<span class="builtintype" id="3020268">bool</span>&nbsp;<span class="op" id="3020273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020276">//&nbsp;TODO(niemeyer):&nbsp;Should&nbsp;other&nbsp;magic&nbsp;characters&nbsp;be&nbsp;added&nbsp;here?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020341">return</span>&nbsp;<span class="ident" id="3020348">strings</span><span class="op" id="3020355">.</span><span class="ident" id="3020356">IndexAny</span><span class="op" id="3020364">(</span><span class="ident" id="3020365">path</span><span class="op" id="3020369">,</span>&nbsp;<span class="string" id="3020371">&#34;*?[&#34;</span><span class="op" id="3020376">)</span>&nbsp;<span class="op" id="3020378">&gt;=</span>&nbsp;<span class="num" id="3020381">0</span><br>
<span class="lineno"></span><span class="op" id="3020383">}</span>
</div>
</body>
</html>
