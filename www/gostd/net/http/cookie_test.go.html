<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7022653">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7022709">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7022763">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7022814">package</span>&nbsp;<span class="ident" id="7022822">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7022828">import</span>&nbsp;<span class="op" id="7022835">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022838">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022847">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022864">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022871">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022878">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022884">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022895">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022906">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7022917">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7022924">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7022927">var</span>&nbsp;<span class="ident" id="7022931">writeSetCookiesTests</span>&nbsp;<span class="op" id="7022952">=</span>&nbsp;<span class="op" id="7022954">[</span><span class="op" id="7022955">]</span><span class="keyword" id="7022956">struct</span>&nbsp;<span class="op" id="7022963">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022966">Cookie</span>&nbsp;<span class="op" id="7022973">*</span><span class="ident" id="7022974">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022982">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7022989">string</span><br>
<span class="lineno"></span><span class="op" id="7022996">}</span><span class="op" id="7022997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023004">&amp;</span><span class="ident" id="7023005">Cookie</span><span class="op" id="7023011">{</span><span class="ident" id="7023012">Name</span><span class="op" id="7023016">:</span>&nbsp;<span class="string" id="7023018">&#34;cookie-1&#34;</span><span class="op" id="7023028">,</span>&nbsp;<span class="ident" id="7023030">Value</span><span class="op" id="7023035">:</span>&nbsp;<span class="string" id="7023037">&#34;v$1&#34;</span><span class="op" id="7023042">}</span><span class="op" id="7023043">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023047">&#34;cookie-1=v$1&#34;</span><span class="op" id="7023061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023064">}</span><span class="op" id="7023065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023072">&amp;</span><span class="ident" id="7023073">Cookie</span><span class="op" id="7023079">{</span><span class="ident" id="7023080">Name</span><span class="op" id="7023084">:</span>&nbsp;<span class="string" id="7023086">&#34;cookie-2&#34;</span><span class="op" id="7023096">,</span>&nbsp;<span class="ident" id="7023098">Value</span><span class="op" id="7023103">:</span>&nbsp;<span class="string" id="7023105">&#34;two&#34;</span><span class="op" id="7023110">,</span>&nbsp;<span class="ident" id="7023112">MaxAge</span><span class="op" id="7023118">:</span>&nbsp;<span class="num" id="7023120">3600</span><span class="op" id="7023124">}</span><span class="op" id="7023125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023129">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7023157">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023160">}</span><span class="op" id="7023161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023168">&amp;</span><span class="ident" id="7023169">Cookie</span><span class="op" id="7023175">{</span><span class="ident" id="7023176">Name</span><span class="op" id="7023180">:</span>&nbsp;<span class="string" id="7023182">&#34;cookie-3&#34;</span><span class="op" id="7023192">,</span>&nbsp;<span class="ident" id="7023194">Value</span><span class="op" id="7023199">:</span>&nbsp;<span class="string" id="7023201">&#34;three&#34;</span><span class="op" id="7023208">,</span>&nbsp;<span class="ident" id="7023210">Domain</span><span class="op" id="7023216">:</span>&nbsp;<span class="string" id="7023218">&#34;.example.com&#34;</span><span class="op" id="7023232">}</span><span class="op" id="7023233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023237">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7023273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023276">}</span><span class="op" id="7023277">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023284">&amp;</span><span class="ident" id="7023285">Cookie</span><span class="op" id="7023291">{</span><span class="ident" id="7023292">Name</span><span class="op" id="7023296">:</span>&nbsp;<span class="string" id="7023298">&#34;cookie-4&#34;</span><span class="op" id="7023308">,</span>&nbsp;<span class="ident" id="7023310">Value</span><span class="op" id="7023315">:</span>&nbsp;<span class="string" id="7023317">&#34;four&#34;</span><span class="op" id="7023323">,</span>&nbsp;<span class="ident" id="7023325">Path</span><span class="op" id="7023329">:</span>&nbsp;<span class="string" id="7023331">&#34;/restricted/&#34;</span><span class="op" id="7023345">}</span><span class="op" id="7023346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023350">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7023384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023387">}</span><span class="op" id="7023388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023391">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023395">&amp;</span><span class="ident" id="7023396">Cookie</span><span class="op" id="7023402">{</span><span class="ident" id="7023403">Name</span><span class="op" id="7023407">:</span>&nbsp;<span class="string" id="7023409">&#34;cookie-5&#34;</span><span class="op" id="7023419">,</span>&nbsp;<span class="ident" id="7023421">Value</span><span class="op" id="7023426">:</span>&nbsp;<span class="string" id="7023428">&#34;five&#34;</span><span class="op" id="7023434">,</span>&nbsp;<span class="ident" id="7023436">Domain</span><span class="op" id="7023442">:</span>&nbsp;<span class="string" id="7023444">&#34;wrong;bad.abc&#34;</span><span class="op" id="7023459">}</span><span class="op" id="7023460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023464">&#34;cookie-5=five&#34;</span><span class="op" id="7023479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023482">}</span><span class="op" id="7023483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023490">&amp;</span><span class="ident" id="7023491">Cookie</span><span class="op" id="7023497">{</span><span class="ident" id="7023498">Name</span><span class="op" id="7023502">:</span>&nbsp;<span class="string" id="7023504">&#34;cookie-6&#34;</span><span class="op" id="7023514">,</span>&nbsp;<span class="ident" id="7023516">Value</span><span class="op" id="7023521">:</span>&nbsp;<span class="string" id="7023523">&#34;six&#34;</span><span class="op" id="7023528">,</span>&nbsp;<span class="ident" id="7023530">Domain</span><span class="op" id="7023536">:</span>&nbsp;<span class="string" id="7023538">&#34;bad-.abc&#34;</span><span class="op" id="7023548">}</span><span class="op" id="7023549">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023553">&#34;cookie-6=six&#34;</span><span class="op" id="7023567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023570">}</span><span class="op" id="7023571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023578">&amp;</span><span class="ident" id="7023579">Cookie</span><span class="op" id="7023585">{</span><span class="ident" id="7023586">Name</span><span class="op" id="7023590">:</span>&nbsp;<span class="string" id="7023592">&#34;cookie-7&#34;</span><span class="op" id="7023602">,</span>&nbsp;<span class="ident" id="7023604">Value</span><span class="op" id="7023609">:</span>&nbsp;<span class="string" id="7023611">&#34;seven&#34;</span><span class="op" id="7023618">,</span>&nbsp;<span class="ident" id="7023620">Domain</span><span class="op" id="7023626">:</span>&nbsp;<span class="string" id="7023628">&#34;127.0.0.1&#34;</span><span class="op" id="7023639">}</span><span class="op" id="7023640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023644">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7023678">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023681">}</span><span class="op" id="7023682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023689">&amp;</span><span class="ident" id="7023690">Cookie</span><span class="op" id="7023696">{</span><span class="ident" id="7023697">Name</span><span class="op" id="7023701">:</span>&nbsp;<span class="string" id="7023703">&#34;cookie-8&#34;</span><span class="op" id="7023713">,</span>&nbsp;<span class="ident" id="7023715">Value</span><span class="op" id="7023720">:</span>&nbsp;<span class="string" id="7023722">&#34;eight&#34;</span><span class="op" id="7023729">,</span>&nbsp;<span class="ident" id="7023731">Domain</span><span class="op" id="7023737">:</span>&nbsp;<span class="string" id="7023739">&#34;::1&#34;</span><span class="op" id="7023744">}</span><span class="op" id="7023745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023749">&#34;cookie-8=eight&#34;</span><span class="op" id="7023765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023768">}</span><span class="op" id="7023769">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7023772">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7023844">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023907">&amp;</span><span class="ident" id="7023908">Cookie</span><span class="op" id="7023914">{</span><span class="ident" id="7023915">Name</span><span class="op" id="7023919">:</span>&nbsp;<span class="string" id="7023921">&#34;special-1&#34;</span><span class="op" id="7023932">,</span>&nbsp;<span class="ident" id="7023934">Value</span><span class="op" id="7023939">:</span>&nbsp;<span class="string" id="7023941">&#34;a&nbsp;z&#34;</span><span class="op" id="7023946">}</span><span class="op" id="7023947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023951">`special-1=a&nbsp;z`</span><span class="op" id="7023966">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023969">}</span><span class="op" id="7023970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023977">&amp;</span><span class="ident" id="7023978">Cookie</span><span class="op" id="7023984">{</span><span class="ident" id="7023985">Name</span><span class="op" id="7023989">:</span>&nbsp;<span class="string" id="7023991">&#34;special-2&#34;</span><span class="op" id="7024002">,</span>&nbsp;<span class="ident" id="7024004">Value</span><span class="op" id="7024009">:</span>&nbsp;<span class="string" id="7024011">&#34;&nbsp;z&#34;</span><span class="op" id="7024015">}</span><span class="op" id="7024016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024020">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7024036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024039">}</span><span class="op" id="7024040">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024047">&amp;</span><span class="ident" id="7024048">Cookie</span><span class="op" id="7024054">{</span><span class="ident" id="7024055">Name</span><span class="op" id="7024059">:</span>&nbsp;<span class="string" id="7024061">&#34;special-3&#34;</span><span class="op" id="7024072">,</span>&nbsp;<span class="ident" id="7024074">Value</span><span class="op" id="7024079">:</span>&nbsp;<span class="string" id="7024081">&#34;a&nbsp;&#34;</span><span class="op" id="7024085">}</span><span class="op" id="7024086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024090">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7024106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024109">}</span><span class="op" id="7024110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024113">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024117">&amp;</span><span class="ident" id="7024118">Cookie</span><span class="op" id="7024124">{</span><span class="ident" id="7024125">Name</span><span class="op" id="7024129">:</span>&nbsp;<span class="string" id="7024131">&#34;special-4&#34;</span><span class="op" id="7024142">,</span>&nbsp;<span class="ident" id="7024144">Value</span><span class="op" id="7024149">:</span>&nbsp;<span class="string" id="7024151">&#34;&nbsp;&#34;</span><span class="op" id="7024154">}</span><span class="op" id="7024155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024159">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7024174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024177">}</span><span class="op" id="7024178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024185">&amp;</span><span class="ident" id="7024186">Cookie</span><span class="op" id="7024192">{</span><span class="ident" id="7024193">Name</span><span class="op" id="7024197">:</span>&nbsp;<span class="string" id="7024199">&#34;special-5&#34;</span><span class="op" id="7024210">,</span>&nbsp;<span class="ident" id="7024212">Value</span><span class="op" id="7024217">:</span>&nbsp;<span class="string" id="7024219">&#34;a,z&#34;</span><span class="op" id="7024224">}</span><span class="op" id="7024225">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024229">`special-5=a,z`</span><span class="op" id="7024244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024247">}</span><span class="op" id="7024248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024255">&amp;</span><span class="ident" id="7024256">Cookie</span><span class="op" id="7024262">{</span><span class="ident" id="7024263">Name</span><span class="op" id="7024267">:</span>&nbsp;<span class="string" id="7024269">&#34;special-6&#34;</span><span class="op" id="7024280">,</span>&nbsp;<span class="ident" id="7024282">Value</span><span class="op" id="7024287">:</span>&nbsp;<span class="string" id="7024289">&#34;,z&#34;</span><span class="op" id="7024293">}</span><span class="op" id="7024294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024298">`special-6=&#34;,z&#34;`</span><span class="op" id="7024314">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024317">}</span><span class="op" id="7024318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024325">&amp;</span><span class="ident" id="7024326">Cookie</span><span class="op" id="7024332">{</span><span class="ident" id="7024333">Name</span><span class="op" id="7024337">:</span>&nbsp;<span class="string" id="7024339">&#34;special-7&#34;</span><span class="op" id="7024350">,</span>&nbsp;<span class="ident" id="7024352">Value</span><span class="op" id="7024357">:</span>&nbsp;<span class="string" id="7024359">&#34;a,&#34;</span><span class="op" id="7024363">}</span><span class="op" id="7024364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024368">`special-7=&#34;a,&#34;`</span><span class="op" id="7024384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024387">}</span><span class="op" id="7024388">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024395">&amp;</span><span class="ident" id="7024396">Cookie</span><span class="op" id="7024402">{</span><span class="ident" id="7024403">Name</span><span class="op" id="7024407">:</span>&nbsp;<span class="string" id="7024409">&#34;special-8&#34;</span><span class="op" id="7024420">,</span>&nbsp;<span class="ident" id="7024422">Value</span><span class="op" id="7024427">:</span>&nbsp;<span class="string" id="7024429">&#34;,&#34;</span><span class="op" id="7024432">}</span><span class="op" id="7024433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024437">`special-8=&#34;,&#34;`</span><span class="op" id="7024452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024455">}</span><span class="op" id="7024456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024459">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024463">&amp;</span><span class="ident" id="7024464">Cookie</span><span class="op" id="7024470">{</span><span class="ident" id="7024471">Name</span><span class="op" id="7024475">:</span>&nbsp;<span class="string" id="7024477">&#34;empty-value&#34;</span><span class="op" id="7024490">,</span>&nbsp;<span class="ident" id="7024492">Value</span><span class="op" id="7024497">:</span>&nbsp;<span class="string" id="7024499">&#34;&#34;</span><span class="op" id="7024501">}</span><span class="op" id="7024502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7024506">`empty-value=`</span><span class="op" id="7024520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024523">}</span><span class="op" id="7024524">,</span><br>
<span class="lineno"></span><span class="op" id="7024526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7024529">func</span>&nbsp;<span class="ident" id="7024534">TestWriteSetCookies</span><span class="op" id="7024553">(</span><span class="ident" id="7024554">t</span>&nbsp;<span class="op" id="7024556">*</span><span class="ident" id="7024557">testing</span><span class="op" id="7024564">.</span><span class="ident" id="7024565">T</span><span class="op" id="7024566">)</span>&nbsp;<span class="op" id="7024568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024571">defer</span>&nbsp;<span class="ident" id="7024577">log</span><span class="op" id="7024580">.</span><span class="ident" id="7024581">SetOutput</span><span class="op" id="7024590">(</span><span class="ident" id="7024591">os</span><span class="op" id="7024593">.</span><span class="ident" id="7024594">Stderr</span><span class="op" id="7024600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024603">var</span>&nbsp;<span class="ident" id="7024607">logbuf</span>&nbsp;<span class="ident" id="7024614">bytes</span><span class="op" id="7024619">.</span><span class="ident" id="7024620">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7024628">log</span><span class="op" id="7024631">.</span><span class="ident" id="7024632">SetOutput</span><span class="op" id="7024641">(</span><span class="op" id="7024642">&amp;</span><span class="ident" id="7024643">logbuf</span><span class="op" id="7024649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024653">for</span>&nbsp;<span class="ident" id="7024657">i</span><span class="op" id="7024658">,</span>&nbsp;<span class="ident" id="7024660">tt</span>&nbsp;<span class="op" id="7024663">:=</span>&nbsp;<span class="keyword" id="7024666">range</span>&nbsp;<span class="ident" id="7024672">writeSetCookiesTests</span>&nbsp;<span class="op" id="7024693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024697">if</span>&nbsp;<span class="ident" id="7024700">g</span><span class="op" id="7024701">,</span>&nbsp;<span class="ident" id="7024703">e</span>&nbsp;<span class="op" id="7024705">:=</span>&nbsp;<span class="ident" id="7024708">tt</span><span class="op" id="7024710">.</span><span class="ident" id="7024711">Cookie</span><span class="op" id="7024717">.</span><span class="ident" id="7024718">String</span><span class="op" id="7024724">(</span><span class="op" id="7024725">)</span><span class="op" id="7024726">,</span>&nbsp;<span class="ident" id="7024728">tt</span><span class="op" id="7024730">.</span><span class="ident" id="7024731">Raw</span><span class="op" id="7024734">;</span>&nbsp;<span class="ident" id="7024736">g</span>&nbsp;<span class="op" id="7024738">!=</span>&nbsp;<span class="ident" id="7024741">e</span>&nbsp;<span class="op" id="7024743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7024748">t</span><span class="op" id="7024749">.</span><span class="ident" id="7024750">Errorf</span><span class="op" id="7024756">(</span><span class="string" id="7024757">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7024794">,</span>&nbsp;<span class="ident" id="7024796">i</span><span class="op" id="7024797">,</span>&nbsp;<span class="ident" id="7024799">e</span><span class="op" id="7024800">,</span>&nbsp;<span class="ident" id="7024802">g</span><span class="op" id="7024803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024808">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024819">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7024826">if</span>&nbsp;<span class="ident" id="7024829">got</span><span class="op" id="7024832">,</span>&nbsp;<span class="ident" id="7024834">sub</span>&nbsp;<span class="op" id="7024838">:=</span>&nbsp;<span class="ident" id="7024841">logbuf</span><span class="op" id="7024847">.</span><span class="ident" id="7024848">String</span><span class="op" id="7024854">(</span><span class="op" id="7024855">)</span><span class="op" id="7024856">,</span>&nbsp;<span class="string" id="7024858">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7024885">;</span>&nbsp;<span class="op" id="7024887">!</span><span class="ident" id="7024888">strings</span><span class="op" id="7024895">.</span><span class="ident" id="7024896">Contains</span><span class="op" id="7024904">(</span><span class="ident" id="7024905">got</span><span class="op" id="7024908">,</span>&nbsp;<span class="ident" id="7024910">sub</span><span class="op" id="7024913">)</span>&nbsp;<span class="op" id="7024915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7024919">t</span><span class="op" id="7024920">.</span><span class="ident" id="7024921">Errorf</span><span class="op" id="7024927">(</span><span class="string" id="7024928">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7024975">,</span>&nbsp;<span class="ident" id="7024977">sub</span><span class="op" id="7024980">,</span>&nbsp;<span class="ident" id="7024982">got</span><span class="op" id="7024985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024988">}</span><br>
<span class="lineno">110</span><span class="op" id="7024990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7024993">type</span>&nbsp;<span class="ident" id="7024998">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7025023">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7025031">func</span>&nbsp;<span class="op" id="7025036">(</span><span class="ident" id="7025037">ho</span>&nbsp;<span class="ident" id="7025040">headerOnlyResponseWriter</span><span class="op" id="7025064">)</span>&nbsp;<span class="ident" id="7025066">Header</span><span class="op" id="7025072">(</span><span class="op" id="7025073">)</span>&nbsp;<span class="ident" id="7025075">Header</span>&nbsp;<span class="op" id="7025082">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025085">return</span>&nbsp;<span class="ident" id="7025092">Header</span><span class="op" id="7025098">(</span><span class="ident" id="7025099">ho</span><span class="op" id="7025101">)</span><br>
<span class="lineno"></span><span class="op" id="7025103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7025106">func</span>&nbsp;<span class="op" id="7025111">(</span><span class="ident" id="7025112">ho</span>&nbsp;<span class="ident" id="7025115">headerOnlyResponseWriter</span><span class="op" id="7025139">)</span>&nbsp;<span class="ident" id="7025141">Write</span><span class="op" id="7025146">(</span><span class="op" id="7025147">[</span><span class="op" id="7025148">]</span><span class="builtintype" id="7025149">byte</span><span class="op" id="7025153">)</span>&nbsp;<span class="op" id="7025155">(</span><span class="builtintype" id="7025156">int</span><span class="op" id="7025159">,</span>&nbsp;<span class="builtintype" id="7025161">error</span><span class="op" id="7025166">)</span>&nbsp;<span class="op" id="7025168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7025171">panic</span><span class="op" id="7025176">(</span><span class="string" id="7025177">&#34;NOIMPL&#34;</span><span class="op" id="7025185">)</span><br>
<span class="lineno">120</span><span class="op" id="7025187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7025190">func</span>&nbsp;<span class="op" id="7025195">(</span><span class="ident" id="7025196">ho</span>&nbsp;<span class="ident" id="7025199">headerOnlyResponseWriter</span><span class="op" id="7025223">)</span>&nbsp;<span class="ident" id="7025225">WriteHeader</span><span class="op" id="7025236">(</span><span class="builtintype" id="7025237">int</span><span class="op" id="7025240">)</span>&nbsp;<span class="op" id="7025242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7025245">panic</span><span class="op" id="7025250">(</span><span class="string" id="7025251">&#34;NOIMPL&#34;</span><span class="op" id="7025259">)</span><br>
<span class="lineno"></span><span class="op" id="7025261">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7025264">func</span>&nbsp;<span class="ident" id="7025269">TestSetCookie</span><span class="op" id="7025282">(</span><span class="ident" id="7025283">t</span>&nbsp;<span class="op" id="7025285">*</span><span class="ident" id="7025286">testing</span><span class="op" id="7025293">.</span><span class="ident" id="7025294">T</span><span class="op" id="7025295">)</span>&nbsp;<span class="op" id="7025297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025300">m</span>&nbsp;<span class="op" id="7025302">:=</span>&nbsp;<span class="builtinfunc" id="7025305">make</span><span class="op" id="7025309">(</span><span class="ident" id="7025310">Header</span><span class="op" id="7025316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025319">SetCookie</span><span class="op" id="7025328">(</span><span class="ident" id="7025329">headerOnlyResponseWriter</span><span class="op" id="7025353">(</span><span class="ident" id="7025354">m</span><span class="op" id="7025355">)</span><span class="op" id="7025356">,</span>&nbsp;<span class="op" id="7025358">&amp;</span><span class="ident" id="7025359">Cookie</span><span class="op" id="7025365">{</span><span class="ident" id="7025366">Name</span><span class="op" id="7025370">:</span>&nbsp;<span class="string" id="7025372">&#34;cookie-1&#34;</span><span class="op" id="7025382">,</span>&nbsp;<span class="ident" id="7025384">Value</span><span class="op" id="7025389">:</span>&nbsp;<span class="string" id="7025391">&#34;one&#34;</span><span class="op" id="7025396">,</span>&nbsp;<span class="ident" id="7025398">Path</span><span class="op" id="7025402">:</span>&nbsp;<span class="string" id="7025404">&#34;/restricted/&#34;</span><span class="op" id="7025418">}</span><span class="op" id="7025419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025422">SetCookie</span><span class="op" id="7025431">(</span><span class="ident" id="7025432">headerOnlyResponseWriter</span><span class="op" id="7025456">(</span><span class="ident" id="7025457">m</span><span class="op" id="7025458">)</span><span class="op" id="7025459">,</span>&nbsp;<span class="op" id="7025461">&amp;</span><span class="ident" id="7025462">Cookie</span><span class="op" id="7025468">{</span><span class="ident" id="7025469">Name</span><span class="op" id="7025473">:</span>&nbsp;<span class="string" id="7025475">&#34;cookie-2&#34;</span><span class="op" id="7025485">,</span>&nbsp;<span class="ident" id="7025487">Value</span><span class="op" id="7025492">:</span>&nbsp;<span class="string" id="7025494">&#34;two&#34;</span><span class="op" id="7025499">,</span>&nbsp;<span class="ident" id="7025501">MaxAge</span><span class="op" id="7025507">:</span>&nbsp;<span class="num" id="7025509">3600</span><span class="op" id="7025513">}</span><span class="op" id="7025514">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025517">if</span>&nbsp;<span class="ident" id="7025520">l</span>&nbsp;<span class="op" id="7025522">:=</span>&nbsp;<span class="builtinfunc" id="7025525">len</span><span class="op" id="7025528">(</span><span class="ident" id="7025529">m</span><span class="op" id="7025530">[</span><span class="string" id="7025531">&#34;Set-Cookie&#34;</span><span class="op" id="7025543">]</span><span class="op" id="7025544">)</span><span class="op" id="7025545">;</span>&nbsp;<span class="ident" id="7025547">l</span>&nbsp;<span class="op" id="7025549">!=</span>&nbsp;<span class="num" id="7025552">2</span>&nbsp;<span class="op" id="7025554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025558">t</span><span class="op" id="7025559">.</span><span class="ident" id="7025560">Fatalf</span><span class="op" id="7025566">(</span><span class="string" id="7025567">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7025596">,</span>&nbsp;<span class="num" id="7025598">2</span><span class="op" id="7025599">,</span>&nbsp;<span class="ident" id="7025601">l</span><span class="op" id="7025602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025608">if</span>&nbsp;<span class="ident" id="7025611">g</span><span class="op" id="7025612">,</span>&nbsp;<span class="ident" id="7025614">e</span>&nbsp;<span class="op" id="7025616">:=</span>&nbsp;<span class="ident" id="7025619">m</span><span class="op" id="7025620">[</span><span class="string" id="7025621">&#34;Set-Cookie&#34;</span><span class="op" id="7025633">]</span><span class="op" id="7025634">[</span><span class="num" id="7025635">0</span><span class="op" id="7025636">]</span><span class="op" id="7025637">,</span>&nbsp;<span class="string" id="7025639">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7025672">;</span>&nbsp;<span class="ident" id="7025674">g</span>&nbsp;<span class="op" id="7025676">!=</span>&nbsp;<span class="ident" id="7025679">e</span>&nbsp;<span class="op" id="7025681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025685">t</span><span class="op" id="7025686">.</span><span class="ident" id="7025687">Errorf</span><span class="op" id="7025693">(</span><span class="string" id="7025694">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7025722">,</span>&nbsp;<span class="ident" id="7025724">e</span><span class="op" id="7025725">,</span>&nbsp;<span class="ident" id="7025727">g</span><span class="op" id="7025728">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025734">if</span>&nbsp;<span class="ident" id="7025737">g</span><span class="op" id="7025738">,</span>&nbsp;<span class="ident" id="7025740">e</span>&nbsp;<span class="op" id="7025742">:=</span>&nbsp;<span class="ident" id="7025745">m</span><span class="op" id="7025746">[</span><span class="string" id="7025747">&#34;Set-Cookie&#34;</span><span class="op" id="7025759">]</span><span class="op" id="7025760">[</span><span class="num" id="7025761">1</span><span class="op" id="7025762">]</span><span class="op" id="7025763">,</span>&nbsp;<span class="string" id="7025765">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7025793">;</span>&nbsp;<span class="ident" id="7025795">g</span>&nbsp;<span class="op" id="7025797">!=</span>&nbsp;<span class="ident" id="7025800">e</span>&nbsp;<span class="op" id="7025802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025806">t</span><span class="op" id="7025807">.</span><span class="ident" id="7025808">Errorf</span><span class="op" id="7025814">(</span><span class="string" id="7025815">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7025843">,</span>&nbsp;<span class="ident" id="7025845">e</span><span class="op" id="7025846">,</span>&nbsp;<span class="ident" id="7025848">g</span><span class="op" id="7025849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025852">}</span><br>
<span class="lineno"></span><span class="op" id="7025854">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7025857">var</span>&nbsp;<span class="ident" id="7025861">addCookieTests</span>&nbsp;<span class="op" id="7025876">=</span>&nbsp;<span class="op" id="7025878">[</span><span class="op" id="7025879">]</span><span class="keyword" id="7025880">struct</span>&nbsp;<span class="op" id="7025887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025890">Cookies</span>&nbsp;<span class="op" id="7025898">[</span><span class="op" id="7025899">]</span><span class="op" id="7025900">*</span><span class="ident" id="7025901">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025909">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7025917">string</span><br>
<span class="lineno"></span><span class="op" id="7025924">}</span><span class="op" id="7025925">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025932">[</span><span class="op" id="7025933">]</span><span class="op" id="7025934">*</span><span class="ident" id="7025935">Cookie</span><span class="op" id="7025941">{</span><span class="op" id="7025942">}</span><span class="op" id="7025943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7025947">&#34;&#34;</span><span class="op" id="7025949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025952">}</span><span class="op" id="7025953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025956">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025960">[</span><span class="op" id="7025961">]</span><span class="op" id="7025962">*</span><span class="ident" id="7025963">Cookie</span><span class="op" id="7025969">{</span><span class="op" id="7025970">{</span><span class="ident" id="7025971">Name</span><span class="op" id="7025975">:</span>&nbsp;<span class="string" id="7025977">&#34;cookie-1&#34;</span><span class="op" id="7025987">,</span>&nbsp;<span class="ident" id="7025989">Value</span><span class="op" id="7025994">:</span>&nbsp;<span class="string" id="7025996">&#34;v$1&#34;</span><span class="op" id="7026001">}</span><span class="op" id="7026002">}</span><span class="op" id="7026003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7026007">&#34;cookie-1=v$1&#34;</span><span class="op" id="7026021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026024">}</span><span class="op" id="7026025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026032">[</span><span class="op" id="7026033">]</span><span class="op" id="7026034">*</span><span class="ident" id="7026035">Cookie</span><span class="op" id="7026041">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026046">{</span><span class="ident" id="7026047">Name</span><span class="op" id="7026051">:</span>&nbsp;<span class="string" id="7026053">&#34;cookie-1&#34;</span><span class="op" id="7026063">,</span>&nbsp;<span class="ident" id="7026065">Value</span><span class="op" id="7026070">:</span>&nbsp;<span class="string" id="7026072">&#34;v$1&#34;</span><span class="op" id="7026077">}</span><span class="op" id="7026078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026083">{</span><span class="ident" id="7026084">Name</span><span class="op" id="7026088">:</span>&nbsp;<span class="string" id="7026090">&#34;cookie-2&#34;</span><span class="op" id="7026100">,</span>&nbsp;<span class="ident" id="7026102">Value</span><span class="op" id="7026107">:</span>&nbsp;<span class="string" id="7026109">&#34;v$2&#34;</span><span class="op" id="7026114">}</span><span class="op" id="7026115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026120">{</span><span class="ident" id="7026121">Name</span><span class="op" id="7026125">:</span>&nbsp;<span class="string" id="7026127">&#34;cookie-3&#34;</span><span class="op" id="7026137">,</span>&nbsp;<span class="ident" id="7026139">Value</span><span class="op" id="7026144">:</span>&nbsp;<span class="string" id="7026146">&#34;v$3&#34;</span><span class="op" id="7026151">}</span><span class="op" id="7026152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026156">}</span><span class="op" id="7026157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7026161">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7026203">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026206">}</span><span class="op" id="7026207">,</span><br>
<span class="lineno"></span><span class="op" id="7026209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7026212">func</span>&nbsp;<span class="ident" id="7026217">TestAddCookie</span><span class="op" id="7026230">(</span><span class="ident" id="7026231">t</span>&nbsp;<span class="op" id="7026233">*</span><span class="ident" id="7026234">testing</span><span class="op" id="7026241">.</span><span class="ident" id="7026242">T</span><span class="op" id="7026243">)</span>&nbsp;<span class="op" id="7026245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026248">for</span>&nbsp;<span class="ident" id="7026252">i</span><span class="op" id="7026253">,</span>&nbsp;<span class="ident" id="7026255">tt</span>&nbsp;<span class="op" id="7026258">:=</span>&nbsp;<span class="keyword" id="7026261">range</span>&nbsp;<span class="ident" id="7026267">addCookieTests</span>&nbsp;<span class="op" id="7026282">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026286">req</span><span class="op" id="7026289">,</span>&nbsp;<span class="ident" id="7026291">_</span>&nbsp;<span class="op" id="7026293">:=</span>&nbsp;<span class="ident" id="7026296">NewRequest</span><span class="op" id="7026306">(</span><span class="string" id="7026307">&#34;GET&#34;</span><span class="op" id="7026312">,</span>&nbsp;<span class="string" id="7026314">&#34;http://example.com/&#34;</span><span class="op" id="7026335">,</span>&nbsp;<span class="ident" id="7026337">nil</span><span class="op" id="7026340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026344">for</span>&nbsp;<span class="ident" id="7026348">_</span><span class="op" id="7026349">,</span>&nbsp;<span class="ident" id="7026351">c</span>&nbsp;<span class="op" id="7026353">:=</span>&nbsp;<span class="keyword" id="7026356">range</span>&nbsp;<span class="ident" id="7026362">tt</span><span class="op" id="7026364">.</span><span class="ident" id="7026365">Cookies</span>&nbsp;<span class="op" id="7026373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026378">req</span><span class="op" id="7026381">.</span><span class="ident" id="7026382">AddCookie</span><span class="op" id="7026391">(</span><span class="ident" id="7026392">c</span><span class="op" id="7026393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026401">if</span>&nbsp;<span class="ident" id="7026404">g</span>&nbsp;<span class="op" id="7026406">:=</span>&nbsp;<span class="ident" id="7026409">req</span><span class="op" id="7026412">.</span><span class="ident" id="7026413">Header</span><span class="op" id="7026419">.</span><span class="ident" id="7026420">Get</span><span class="op" id="7026423">(</span><span class="string" id="7026424">&#34;Cookie&#34;</span><span class="op" id="7026432">)</span><span class="op" id="7026433">;</span>&nbsp;<span class="ident" id="7026435">g</span>&nbsp;<span class="op" id="7026437">!=</span>&nbsp;<span class="ident" id="7026440">tt</span><span class="op" id="7026442">.</span><span class="ident" id="7026443">Raw</span>&nbsp;<span class="op" id="7026447">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026452">t</span><span class="op" id="7026453">.</span><span class="ident" id="7026454">Errorf</span><span class="op" id="7026460">(</span><span class="string" id="7026461">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7026493">,</span>&nbsp;<span class="ident" id="7026495">i</span><span class="op" id="7026496">,</span>&nbsp;<span class="ident" id="7026498">tt</span><span class="op" id="7026500">.</span><span class="ident" id="7026501">Raw</span><span class="op" id="7026504">,</span>&nbsp;<span class="ident" id="7026506">g</span><span class="op" id="7026507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026512">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026526">}</span><br>
<span class="lineno"></span><span class="op" id="7026528">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7026531">var</span>&nbsp;<span class="ident" id="7026535">readSetCookiesTests</span>&nbsp;<span class="op" id="7026555">=</span>&nbsp;<span class="op" id="7026557">[</span><span class="op" id="7026558">]</span><span class="keyword" id="7026559">struct</span>&nbsp;<span class="op" id="7026566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026569">Header</span>&nbsp;&nbsp;<span class="ident" id="7026577">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026585">Cookies</span>&nbsp;<span class="op" id="7026593">[</span><span class="op" id="7026594">]</span><span class="op" id="7026595">*</span><span class="ident" id="7026596">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7026603">}</span><span class="op" id="7026604">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026611">Header</span><span class="op" id="7026617">{</span><span class="string" id="7026618">&#34;Set-Cookie&#34;</span><span class="op" id="7026630">:</span>&nbsp;<span class="op" id="7026632">{</span><span class="string" id="7026633">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7026647">}</span><span class="op" id="7026648">}</span><span class="op" id="7026649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026653">[</span><span class="op" id="7026654">]</span><span class="op" id="7026655">*</span><span class="ident" id="7026656">Cookie</span><span class="op" id="7026662">{</span><span class="op" id="7026663">{</span><span class="ident" id="7026664">Name</span><span class="op" id="7026668">:</span>&nbsp;<span class="string" id="7026670">&#34;Cookie-1&#34;</span><span class="op" id="7026680">,</span>&nbsp;<span class="ident" id="7026682">Value</span><span class="op" id="7026687">:</span>&nbsp;<span class="string" id="7026689">&#34;v$1&#34;</span><span class="op" id="7026694">,</span>&nbsp;<span class="ident" id="7026696">Raw</span><span class="op" id="7026699">:</span>&nbsp;<span class="string" id="7026701">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7026715">}</span><span class="op" id="7026716">}</span><span class="op" id="7026717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026720">}</span><span class="op" id="7026721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026724">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026728">Header</span><span class="op" id="7026734">{</span><span class="string" id="7026735">&#34;Set-Cookie&#34;</span><span class="op" id="7026747">:</span>&nbsp;<span class="op" id="7026749">{</span><span class="string" id="7026750">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7026849">}</span><span class="op" id="7026850">}</span><span class="op" id="7026851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026855">[</span><span class="op" id="7026856">]</span><span class="op" id="7026857">*</span><span class="ident" id="7026858">Cookie</span><span class="op" id="7026864">{</span><span class="op" id="7026865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026870">Name</span><span class="op" id="7026874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7026882">&#34;NID&#34;</span><span class="op" id="7026887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026892">Value</span><span class="op" id="7026897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7026904">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7026923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026928">Path</span><span class="op" id="7026932">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7026940">&#34;/&#34;</span><span class="op" id="7026943">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026948">Domain</span><span class="op" id="7026954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7026960">&#34;.google.ch&#34;</span><span class="op" id="7026972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026977">HttpOnly</span><span class="op" id="7026985">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7026989">true</span><span class="op" id="7026993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026998">Expires</span><span class="op" id="7027005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7027010">time</span><span class="op" id="7027014">.</span><span class="ident" id="7027015">Date</span><span class="op" id="7027019">(</span><span class="num" id="7027020">2011</span><span class="op" id="7027024">,</span>&nbsp;<span class="num" id="7027026">11</span><span class="op" id="7027028">,</span>&nbsp;<span class="num" id="7027030">23</span><span class="op" id="7027032">,</span>&nbsp;<span class="num" id="7027034">1</span><span class="op" id="7027035">,</span>&nbsp;<span class="num" id="7027037">5</span><span class="op" id="7027038">,</span>&nbsp;<span class="num" id="7027040">3</span><span class="op" id="7027041">,</span>&nbsp;<span class="num" id="7027043">0</span><span class="op" id="7027044">,</span>&nbsp;<span class="ident" id="7027046">time</span><span class="op" id="7027050">.</span><span class="ident" id="7027051">UTC</span><span class="op" id="7027054">)</span><span class="op" id="7027055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027060">RawExpires</span><span class="op" id="7027070">:</span>&nbsp;<span class="string" id="7027072">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7027103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027108">Raw</span><span class="op" id="7027111">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027120">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7027219">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027223">}</span><span class="op" id="7027224">}</span><span class="op" id="7027225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027228">}</span><span class="op" id="7027229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027236">Header</span><span class="op" id="7027242">{</span><span class="string" id="7027243">&#34;Set-Cookie&#34;</span><span class="op" id="7027255">:</span>&nbsp;<span class="op" id="7027257">{</span><span class="string" id="7027258">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7027332">}</span><span class="op" id="7027333">}</span><span class="op" id="7027334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027338">[</span><span class="op" id="7027339">]</span><span class="op" id="7027340">*</span><span class="ident" id="7027341">Cookie</span><span class="op" id="7027347">{</span><span class="op" id="7027348">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027353">Name</span><span class="op" id="7027357">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027365">&#34;.ASPXAUTH&#34;</span><span class="op" id="7027376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027381">Value</span><span class="op" id="7027386">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027393">&#34;7E3AA&#34;</span><span class="op" id="7027400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027405">Path</span><span class="op" id="7027409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027417">&#34;/&#34;</span><span class="op" id="7027420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027425">Expires</span><span class="op" id="7027432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7027437">time</span><span class="op" id="7027441">.</span><span class="ident" id="7027442">Date</span><span class="op" id="7027446">(</span><span class="num" id="7027447">2012</span><span class="op" id="7027451">,</span>&nbsp;<span class="num" id="7027453">3</span><span class="op" id="7027454">,</span>&nbsp;<span class="num" id="7027456">7</span><span class="op" id="7027457">,</span>&nbsp;<span class="num" id="7027459">14</span><span class="op" id="7027461">,</span>&nbsp;<span class="num" id="7027463">25</span><span class="op" id="7027465">,</span>&nbsp;<span class="num" id="7027467">6</span><span class="op" id="7027468">,</span>&nbsp;<span class="num" id="7027470">0</span><span class="op" id="7027471">,</span>&nbsp;<span class="ident" id="7027473">time</span><span class="op" id="7027477">.</span><span class="ident" id="7027478">UTC</span><span class="op" id="7027481">)</span><span class="op" id="7027482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027487">RawExpires</span><span class="op" id="7027497">:</span>&nbsp;<span class="string" id="7027499">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7027530">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027535">HttpOnly</span><span class="op" id="7027543">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7027547">true</span><span class="op" id="7027551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027556">Raw</span><span class="op" id="7027559">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027568">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7027642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027646">}</span><span class="op" id="7027647">}</span><span class="op" id="7027648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027651">}</span><span class="op" id="7027652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027655">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027659">Header</span><span class="op" id="7027665">{</span><span class="string" id="7027666">&#34;Set-Cookie&#34;</span><span class="op" id="7027678">:</span>&nbsp;<span class="op" id="7027680">{</span><span class="string" id="7027681">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7027722">}</span><span class="op" id="7027723">}</span><span class="op" id="7027724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027728">[</span><span class="op" id="7027729">]</span><span class="op" id="7027730">*</span><span class="ident" id="7027731">Cookie</span><span class="op" id="7027737">{</span><span class="op" id="7027738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027743">Name</span><span class="op" id="7027747">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027753">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7027772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027777">Value</span><span class="op" id="7027782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027787">&#34;foo&#34;</span><span class="op" id="7027792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027797">Path</span><span class="op" id="7027801">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027807">&#34;/&#34;</span><span class="op" id="7027810">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027815">HttpOnly</span><span class="op" id="7027823">:</span>&nbsp;<span class="builtintype" id="7027825">true</span><span class="op" id="7027829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027834">Raw</span><span class="op" id="7027837">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7027844">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7027885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027889">}</span><span class="op" id="7027890">}</span><span class="op" id="7027891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027894">}</span><span class="op" id="7027895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7027898">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7027971">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028019">Header</span><span class="op" id="7028025">{</span><span class="string" id="7028026">&#34;Set-Cookie&#34;</span><span class="op" id="7028038">:</span>&nbsp;<span class="op" id="7028040">{</span><span class="string" id="7028041">`special-1=a&nbsp;z`</span><span class="op" id="7028056">}</span><span class="op" id="7028057">}</span><span class="op" id="7028058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028062">[</span><span class="op" id="7028063">]</span><span class="op" id="7028064">*</span><span class="ident" id="7028065">Cookie</span><span class="op" id="7028071">{</span><span class="op" id="7028072">{</span><span class="ident" id="7028073">Name</span><span class="op" id="7028077">:</span>&nbsp;<span class="string" id="7028079">&#34;special-1&#34;</span><span class="op" id="7028090">,</span>&nbsp;<span class="ident" id="7028092">Value</span><span class="op" id="7028097">:</span>&nbsp;<span class="string" id="7028099">&#34;a&nbsp;z&#34;</span><span class="op" id="7028104">,</span>&nbsp;<span class="ident" id="7028106">Raw</span><span class="op" id="7028109">:</span>&nbsp;<span class="string" id="7028111">`special-1=a&nbsp;z`</span><span class="op" id="7028126">}</span><span class="op" id="7028127">}</span><span class="op" id="7028128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028131">}</span><span class="op" id="7028132">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028139">Header</span><span class="op" id="7028145">{</span><span class="string" id="7028146">&#34;Set-Cookie&#34;</span><span class="op" id="7028158">:</span>&nbsp;<span class="op" id="7028160">{</span><span class="string" id="7028161">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7028177">}</span><span class="op" id="7028178">}</span><span class="op" id="7028179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028183">[</span><span class="op" id="7028184">]</span><span class="op" id="7028185">*</span><span class="ident" id="7028186">Cookie</span><span class="op" id="7028192">{</span><span class="op" id="7028193">{</span><span class="ident" id="7028194">Name</span><span class="op" id="7028198">:</span>&nbsp;<span class="string" id="7028200">&#34;special-2&#34;</span><span class="op" id="7028211">,</span>&nbsp;<span class="ident" id="7028213">Value</span><span class="op" id="7028218">:</span>&nbsp;<span class="string" id="7028220">&#34;&nbsp;z&#34;</span><span class="op" id="7028224">,</span>&nbsp;<span class="ident" id="7028226">Raw</span><span class="op" id="7028229">:</span>&nbsp;<span class="string" id="7028231">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7028247">}</span><span class="op" id="7028248">}</span><span class="op" id="7028249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028252">}</span><span class="op" id="7028253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028256">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028260">Header</span><span class="op" id="7028266">{</span><span class="string" id="7028267">&#34;Set-Cookie&#34;</span><span class="op" id="7028279">:</span>&nbsp;<span class="op" id="7028281">{</span><span class="string" id="7028282">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7028298">}</span><span class="op" id="7028299">}</span><span class="op" id="7028300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028304">[</span><span class="op" id="7028305">]</span><span class="op" id="7028306">*</span><span class="ident" id="7028307">Cookie</span><span class="op" id="7028313">{</span><span class="op" id="7028314">{</span><span class="ident" id="7028315">Name</span><span class="op" id="7028319">:</span>&nbsp;<span class="string" id="7028321">&#34;special-3&#34;</span><span class="op" id="7028332">,</span>&nbsp;<span class="ident" id="7028334">Value</span><span class="op" id="7028339">:</span>&nbsp;<span class="string" id="7028341">&#34;a&nbsp;&#34;</span><span class="op" id="7028345">,</span>&nbsp;<span class="ident" id="7028347">Raw</span><span class="op" id="7028350">:</span>&nbsp;<span class="string" id="7028352">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7028368">}</span><span class="op" id="7028369">}</span><span class="op" id="7028370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028373">}</span><span class="op" id="7028374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028381">Header</span><span class="op" id="7028387">{</span><span class="string" id="7028388">&#34;Set-Cookie&#34;</span><span class="op" id="7028400">:</span>&nbsp;<span class="op" id="7028402">{</span><span class="string" id="7028403">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7028418">}</span><span class="op" id="7028419">}</span><span class="op" id="7028420">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028424">[</span><span class="op" id="7028425">]</span><span class="op" id="7028426">*</span><span class="ident" id="7028427">Cookie</span><span class="op" id="7028433">{</span><span class="op" id="7028434">{</span><span class="ident" id="7028435">Name</span><span class="op" id="7028439">:</span>&nbsp;<span class="string" id="7028441">&#34;special-4&#34;</span><span class="op" id="7028452">,</span>&nbsp;<span class="ident" id="7028454">Value</span><span class="op" id="7028459">:</span>&nbsp;<span class="string" id="7028461">&#34;&nbsp;&#34;</span><span class="op" id="7028464">,</span>&nbsp;<span class="ident" id="7028466">Raw</span><span class="op" id="7028469">:</span>&nbsp;<span class="string" id="7028471">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7028486">}</span><span class="op" id="7028487">}</span><span class="op" id="7028488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028491">}</span><span class="op" id="7028492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028499">Header</span><span class="op" id="7028505">{</span><span class="string" id="7028506">&#34;Set-Cookie&#34;</span><span class="op" id="7028518">:</span>&nbsp;<span class="op" id="7028520">{</span><span class="string" id="7028521">`special-5=a,z`</span><span class="op" id="7028536">}</span><span class="op" id="7028537">}</span><span class="op" id="7028538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028542">[</span><span class="op" id="7028543">]</span><span class="op" id="7028544">*</span><span class="ident" id="7028545">Cookie</span><span class="op" id="7028551">{</span><span class="op" id="7028552">{</span><span class="ident" id="7028553">Name</span><span class="op" id="7028557">:</span>&nbsp;<span class="string" id="7028559">&#34;special-5&#34;</span><span class="op" id="7028570">,</span>&nbsp;<span class="ident" id="7028572">Value</span><span class="op" id="7028577">:</span>&nbsp;<span class="string" id="7028579">&#34;a,z&#34;</span><span class="op" id="7028584">,</span>&nbsp;<span class="ident" id="7028586">Raw</span><span class="op" id="7028589">:</span>&nbsp;<span class="string" id="7028591">`special-5=a,z`</span><span class="op" id="7028606">}</span><span class="op" id="7028607">}</span><span class="op" id="7028608">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028611">}</span><span class="op" id="7028612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028619">Header</span><span class="op" id="7028625">{</span><span class="string" id="7028626">&#34;Set-Cookie&#34;</span><span class="op" id="7028638">:</span>&nbsp;<span class="op" id="7028640">{</span><span class="string" id="7028641">`special-6=&#34;,z&#34;`</span><span class="op" id="7028657">}</span><span class="op" id="7028658">}</span><span class="op" id="7028659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028663">[</span><span class="op" id="7028664">]</span><span class="op" id="7028665">*</span><span class="ident" id="7028666">Cookie</span><span class="op" id="7028672">{</span><span class="op" id="7028673">{</span><span class="ident" id="7028674">Name</span><span class="op" id="7028678">:</span>&nbsp;<span class="string" id="7028680">&#34;special-6&#34;</span><span class="op" id="7028691">,</span>&nbsp;<span class="ident" id="7028693">Value</span><span class="op" id="7028698">:</span>&nbsp;<span class="string" id="7028700">&#34;,z&#34;</span><span class="op" id="7028704">,</span>&nbsp;<span class="ident" id="7028706">Raw</span><span class="op" id="7028709">:</span>&nbsp;<span class="string" id="7028711">`special-6=&#34;,z&#34;`</span><span class="op" id="7028727">}</span><span class="op" id="7028728">}</span><span class="op" id="7028729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028732">}</span><span class="op" id="7028733">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028740">Header</span><span class="op" id="7028746">{</span><span class="string" id="7028747">&#34;Set-Cookie&#34;</span><span class="op" id="7028759">:</span>&nbsp;<span class="op" id="7028761">{</span><span class="string" id="7028762">`special-7=a,`</span><span class="op" id="7028776">}</span><span class="op" id="7028777">}</span><span class="op" id="7028778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028782">[</span><span class="op" id="7028783">]</span><span class="op" id="7028784">*</span><span class="ident" id="7028785">Cookie</span><span class="op" id="7028791">{</span><span class="op" id="7028792">{</span><span class="ident" id="7028793">Name</span><span class="op" id="7028797">:</span>&nbsp;<span class="string" id="7028799">&#34;special-7&#34;</span><span class="op" id="7028810">,</span>&nbsp;<span class="ident" id="7028812">Value</span><span class="op" id="7028817">:</span>&nbsp;<span class="string" id="7028819">&#34;a,&#34;</span><span class="op" id="7028823">,</span>&nbsp;<span class="ident" id="7028825">Raw</span><span class="op" id="7028828">:</span>&nbsp;<span class="string" id="7028830">`special-7=a,`</span><span class="op" id="7028844">}</span><span class="op" id="7028845">}</span><span class="op" id="7028846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028849">}</span><span class="op" id="7028850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028853">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028857">Header</span><span class="op" id="7028863">{</span><span class="string" id="7028864">&#34;Set-Cookie&#34;</span><span class="op" id="7028876">:</span>&nbsp;<span class="op" id="7028878">{</span><span class="string" id="7028879">`special-8=&#34;,&#34;`</span><span class="op" id="7028894">}</span><span class="op" id="7028895">}</span><span class="op" id="7028896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028900">[</span><span class="op" id="7028901">]</span><span class="op" id="7028902">*</span><span class="ident" id="7028903">Cookie</span><span class="op" id="7028909">{</span><span class="op" id="7028910">{</span><span class="ident" id="7028911">Name</span><span class="op" id="7028915">:</span>&nbsp;<span class="string" id="7028917">&#34;special-8&#34;</span><span class="op" id="7028928">,</span>&nbsp;<span class="ident" id="7028930">Value</span><span class="op" id="7028935">:</span>&nbsp;<span class="string" id="7028937">&#34;,&#34;</span><span class="op" id="7028940">,</span>&nbsp;<span class="ident" id="7028942">Raw</span><span class="op" id="7028945">:</span>&nbsp;<span class="string" id="7028947">`special-8=&#34;,&#34;`</span><span class="op" id="7028962">}</span><span class="op" id="7028963">}</span><span class="op" id="7028964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7028967">}</span><span class="op" id="7028968">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7028972">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7029031">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7029094">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7029158">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7029169">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7029313">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7029316">func</span>&nbsp;<span class="ident" id="7029321">toJSON</span><span class="op" id="7029327">(</span><span class="ident" id="7029328">v</span>&nbsp;<span class="keyword" id="7029330">interface</span><span class="op" id="7029339">{</span><span class="op" id="7029340">}</span><span class="op" id="7029341">)</span>&nbsp;<span class="builtintype" id="7029343">string</span>&nbsp;<span class="op" id="7029350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029353">b</span><span class="op" id="7029354">,</span>&nbsp;<span class="ident" id="7029356">err</span>&nbsp;<span class="op" id="7029360">:=</span>&nbsp;<span class="ident" id="7029363">json</span><span class="op" id="7029367">.</span><span class="ident" id="7029368">Marshal</span><span class="op" id="7029375">(</span><span class="ident" id="7029376">v</span><span class="op" id="7029377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029380">if</span>&nbsp;<span class="ident" id="7029383">err</span>&nbsp;<span class="op" id="7029387">!=</span>&nbsp;<span class="ident" id="7029390">nil</span>&nbsp;<span class="op" id="7029394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029398">return</span>&nbsp;<span class="ident" id="7029405">fmt</span><span class="op" id="7029408">.</span><span class="ident" id="7029409">Sprintf</span><span class="op" id="7029416">(</span><span class="string" id="7029417">&#34;%#v&#34;</span><span class="op" id="7029422">,</span>&nbsp;<span class="ident" id="7029424">v</span><span class="op" id="7029425">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029431">return</span>&nbsp;<span class="builtintype" id="7029438">string</span><span class="op" id="7029444">(</span><span class="ident" id="7029445">b</span><span class="op" id="7029446">)</span><br>
<span class="lineno"></span><span class="op" id="7029448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7029451">func</span>&nbsp;<span class="ident" id="7029456">TestReadSetCookies</span><span class="op" id="7029474">(</span><span class="ident" id="7029475">t</span>&nbsp;<span class="op" id="7029477">*</span><span class="ident" id="7029478">testing</span><span class="op" id="7029485">.</span><span class="ident" id="7029486">T</span><span class="op" id="7029487">)</span>&nbsp;<span class="op" id="7029489">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029492">for</span>&nbsp;<span class="ident" id="7029496">i</span><span class="op" id="7029497">,</span>&nbsp;<span class="ident" id="7029499">tt</span>&nbsp;<span class="op" id="7029502">:=</span>&nbsp;<span class="keyword" id="7029505">range</span>&nbsp;<span class="ident" id="7029511">readSetCookiesTests</span>&nbsp;<span class="op" id="7029531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029535">for</span>&nbsp;<span class="ident" id="7029539">n</span>&nbsp;<span class="op" id="7029541">:=</span>&nbsp;<span class="num" id="7029544">0</span><span class="op" id="7029545">;</span>&nbsp;<span class="ident" id="7029547">n</span>&nbsp;<span class="op" id="7029549">&lt;</span>&nbsp;<span class="num" id="7029551">2</span><span class="op" id="7029552">;</span>&nbsp;<span class="ident" id="7029554">n</span><span class="op" id="7029555">++</span>&nbsp;<span class="op" id="7029558">{</span>&nbsp;<span class="comment" id="7029560">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029616">c</span>&nbsp;<span class="op" id="7029618">:=</span>&nbsp;<span class="ident" id="7029621">readSetCookies</span><span class="op" id="7029635">(</span><span class="ident" id="7029636">tt</span><span class="op" id="7029638">.</span><span class="ident" id="7029639">Header</span><span class="op" id="7029645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029650">if</span>&nbsp;<span class="op" id="7029653">!</span><span class="ident" id="7029654">reflect</span><span class="op" id="7029661">.</span><span class="ident" id="7029662">DeepEqual</span><span class="op" id="7029671">(</span><span class="ident" id="7029672">c</span><span class="op" id="7029673">,</span>&nbsp;<span class="ident" id="7029675">tt</span><span class="op" id="7029677">.</span><span class="ident" id="7029678">Cookies</span><span class="op" id="7029685">)</span>&nbsp;<span class="op" id="7029687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029693">t</span><span class="op" id="7029694">.</span><span class="ident" id="7029695">Errorf</span><span class="op" id="7029701">(</span><span class="string" id="7029702">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7029744">,</span>&nbsp;<span class="ident" id="7029746">i</span><span class="op" id="7029747">,</span>&nbsp;<span class="ident" id="7029749">toJSON</span><span class="op" id="7029755">(</span><span class="ident" id="7029756">c</span><span class="op" id="7029757">)</span><span class="op" id="7029758">,</span>&nbsp;<span class="ident" id="7029760">toJSON</span><span class="op" id="7029766">(</span><span class="ident" id="7029767">tt</span><span class="op" id="7029769">.</span><span class="ident" id="7029770">Cookies</span><span class="op" id="7029777">)</span><span class="op" id="7029778">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7029784">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029803">}</span><br>
<span class="lineno"></span><span class="op" id="7029805">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7029808">var</span>&nbsp;<span class="ident" id="7029812">readCookiesTests</span>&nbsp;<span class="op" id="7029829">=</span>&nbsp;<span class="op" id="7029831">[</span><span class="op" id="7029832">]</span><span class="keyword" id="7029833">struct</span>&nbsp;<span class="op" id="7029840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029843">Header</span>&nbsp;&nbsp;<span class="ident" id="7029851">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029859">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7029867">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029875">Cookies</span>&nbsp;<span class="op" id="7029883">[</span><span class="op" id="7029884">]</span><span class="op" id="7029885">*</span><span class="ident" id="7029886">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7029893">}</span><span class="op" id="7029894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7029901">Header</span><span class="op" id="7029907">{</span><span class="string" id="7029908">&#34;Cookie&#34;</span><span class="op" id="7029916">:</span>&nbsp;<span class="op" id="7029918">{</span><span class="string" id="7029919">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7029933">,</span>&nbsp;<span class="string" id="7029935">&#34;c2=v2&#34;</span><span class="op" id="7029942">}</span><span class="op" id="7029943">}</span><span class="op" id="7029944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7029948">&#34;&#34;</span><span class="op" id="7029950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029954">[</span><span class="op" id="7029955">]</span><span class="op" id="7029956">*</span><span class="ident" id="7029957">Cookie</span><span class="op" id="7029963">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7029968">{</span><span class="ident" id="7029969">Name</span><span class="op" id="7029973">:</span>&nbsp;<span class="string" id="7029975">&#34;Cookie-1&#34;</span><span class="op" id="7029985">,</span>&nbsp;<span class="ident" id="7029987">Value</span><span class="op" id="7029992">:</span>&nbsp;<span class="string" id="7029994">&#34;v$1&#34;</span><span class="op" id="7029999">}</span><span class="op" id="7030000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030005">{</span><span class="ident" id="7030006">Name</span><span class="op" id="7030010">:</span>&nbsp;<span class="string" id="7030012">&#34;c2&#34;</span><span class="op" id="7030016">,</span>&nbsp;<span class="ident" id="7030018">Value</span><span class="op" id="7030023">:</span>&nbsp;<span class="string" id="7030025">&#34;v2&#34;</span><span class="op" id="7030029">}</span><span class="op" id="7030030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030034">}</span><span class="op" id="7030035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030038">}</span><span class="op" id="7030039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030042">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030046">Header</span><span class="op" id="7030052">{</span><span class="string" id="7030053">&#34;Cookie&#34;</span><span class="op" id="7030061">:</span>&nbsp;<span class="op" id="7030063">{</span><span class="string" id="7030064">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7030078">,</span>&nbsp;<span class="string" id="7030080">&#34;c2=v2&#34;</span><span class="op" id="7030087">}</span><span class="op" id="7030088">}</span><span class="op" id="7030089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7030093">&#34;c2&#34;</span><span class="op" id="7030097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030101">[</span><span class="op" id="7030102">]</span><span class="op" id="7030103">*</span><span class="ident" id="7030104">Cookie</span><span class="op" id="7030110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030115">{</span><span class="ident" id="7030116">Name</span><span class="op" id="7030120">:</span>&nbsp;<span class="string" id="7030122">&#34;c2&#34;</span><span class="op" id="7030126">,</span>&nbsp;<span class="ident" id="7030128">Value</span><span class="op" id="7030133">:</span>&nbsp;<span class="string" id="7030135">&#34;v2&#34;</span><span class="op" id="7030139">}</span><span class="op" id="7030140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030144">}</span><span class="op" id="7030145">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030148">}</span><span class="op" id="7030149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030156">Header</span><span class="op" id="7030162">{</span><span class="string" id="7030163">&#34;Cookie&#34;</span><span class="op" id="7030171">:</span>&nbsp;<span class="op" id="7030173">{</span><span class="string" id="7030174">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7030195">}</span><span class="op" id="7030196">}</span><span class="op" id="7030197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7030201">&#34;&#34;</span><span class="op" id="7030203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030207">[</span><span class="op" id="7030208">]</span><span class="op" id="7030209">*</span><span class="ident" id="7030210">Cookie</span><span class="op" id="7030216">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030221">{</span><span class="ident" id="7030222">Name</span><span class="op" id="7030226">:</span>&nbsp;<span class="string" id="7030228">&#34;Cookie-1&#34;</span><span class="op" id="7030238">,</span>&nbsp;<span class="ident" id="7030240">Value</span><span class="op" id="7030245">:</span>&nbsp;<span class="string" id="7030247">&#34;v$1&#34;</span><span class="op" id="7030252">}</span><span class="op" id="7030253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030258">{</span><span class="ident" id="7030259">Name</span><span class="op" id="7030263">:</span>&nbsp;<span class="string" id="7030265">&#34;c2&#34;</span><span class="op" id="7030269">,</span>&nbsp;<span class="ident" id="7030271">Value</span><span class="op" id="7030276">:</span>&nbsp;<span class="string" id="7030278">&#34;v2&#34;</span><span class="op" id="7030282">}</span><span class="op" id="7030283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030287">}</span><span class="op" id="7030288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030291">}</span><span class="op" id="7030292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030295">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030299">Header</span><span class="op" id="7030305">{</span><span class="string" id="7030306">&#34;Cookie&#34;</span><span class="op" id="7030314">:</span>&nbsp;<span class="op" id="7030316">{</span><span class="string" id="7030317">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7030338">}</span><span class="op" id="7030339">}</span><span class="op" id="7030340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7030344">&#34;c2&#34;</span><span class="op" id="7030348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030352">[</span><span class="op" id="7030353">]</span><span class="op" id="7030354">*</span><span class="ident" id="7030355">Cookie</span><span class="op" id="7030361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030366">{</span><span class="ident" id="7030367">Name</span><span class="op" id="7030371">:</span>&nbsp;<span class="string" id="7030373">&#34;c2&#34;</span><span class="op" id="7030377">,</span>&nbsp;<span class="ident" id="7030379">Value</span><span class="op" id="7030384">:</span>&nbsp;<span class="string" id="7030386">&#34;v2&#34;</span><span class="op" id="7030390">}</span><span class="op" id="7030391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030395">}</span><span class="op" id="7030396">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030399">}</span><span class="op" id="7030400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030407">Header</span><span class="op" id="7030413">{</span><span class="string" id="7030414">&#34;Cookie&#34;</span><span class="op" id="7030422">:</span>&nbsp;<span class="op" id="7030424">{</span><span class="string" id="7030425">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7030450">}</span><span class="op" id="7030451">}</span><span class="op" id="7030452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7030456">&#34;&#34;</span><span class="op" id="7030458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030462">[</span><span class="op" id="7030463">]</span><span class="op" id="7030464">*</span><span class="ident" id="7030465">Cookie</span><span class="op" id="7030471">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030476">{</span><span class="ident" id="7030477">Name</span><span class="op" id="7030481">:</span>&nbsp;<span class="string" id="7030483">&#34;Cookie-1&#34;</span><span class="op" id="7030493">,</span>&nbsp;<span class="ident" id="7030495">Value</span><span class="op" id="7030500">:</span>&nbsp;<span class="string" id="7030502">&#34;v$1&#34;</span><span class="op" id="7030507">}</span><span class="op" id="7030508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030513">{</span><span class="ident" id="7030514">Name</span><span class="op" id="7030518">:</span>&nbsp;<span class="string" id="7030520">&#34;c2&#34;</span><span class="op" id="7030524">,</span>&nbsp;<span class="ident" id="7030526">Value</span><span class="op" id="7030531">:</span>&nbsp;<span class="string" id="7030533">&#34;v2&#34;</span><span class="op" id="7030537">}</span><span class="op" id="7030538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030542">}</span><span class="op" id="7030543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030546">}</span><span class="op" id="7030547">,</span><br>
<span class="lineno"></span><span class="op" id="7030549">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7030552">func</span>&nbsp;<span class="ident" id="7030557">TestReadCookies</span><span class="op" id="7030572">(</span><span class="ident" id="7030573">t</span>&nbsp;<span class="op" id="7030575">*</span><span class="ident" id="7030576">testing</span><span class="op" id="7030583">.</span><span class="ident" id="7030584">T</span><span class="op" id="7030585">)</span>&nbsp;<span class="op" id="7030587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7030590">for</span>&nbsp;<span class="ident" id="7030594">i</span><span class="op" id="7030595">,</span>&nbsp;<span class="ident" id="7030597">tt</span>&nbsp;<span class="op" id="7030600">:=</span>&nbsp;<span class="keyword" id="7030603">range</span>&nbsp;<span class="ident" id="7030609">readCookiesTests</span>&nbsp;<span class="op" id="7030626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7030630">for</span>&nbsp;<span class="ident" id="7030634">n</span>&nbsp;<span class="op" id="7030636">:=</span>&nbsp;<span class="num" id="7030639">0</span><span class="op" id="7030640">;</span>&nbsp;<span class="ident" id="7030642">n</span>&nbsp;<span class="op" id="7030644">&lt;</span>&nbsp;<span class="num" id="7030646">2</span><span class="op" id="7030647">;</span>&nbsp;<span class="ident" id="7030649">n</span><span class="op" id="7030650">++</span>&nbsp;<span class="op" id="7030653">{</span>&nbsp;<span class="comment" id="7030655">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030708">c</span>&nbsp;<span class="op" id="7030710">:=</span>&nbsp;<span class="ident" id="7030713">readCookies</span><span class="op" id="7030724">(</span><span class="ident" id="7030725">tt</span><span class="op" id="7030727">.</span><span class="ident" id="7030728">Header</span><span class="op" id="7030734">,</span>&nbsp;<span class="ident" id="7030736">tt</span><span class="op" id="7030738">.</span><span class="ident" id="7030739">Filter</span><span class="op" id="7030745">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7030750">if</span>&nbsp;<span class="op" id="7030753">!</span><span class="ident" id="7030754">reflect</span><span class="op" id="7030761">.</span><span class="ident" id="7030762">DeepEqual</span><span class="op" id="7030771">(</span><span class="ident" id="7030772">c</span><span class="op" id="7030773">,</span>&nbsp;<span class="ident" id="7030775">tt</span><span class="op" id="7030777">.</span><span class="ident" id="7030778">Cookies</span><span class="op" id="7030785">)</span>&nbsp;<span class="op" id="7030787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030793">t</span><span class="op" id="7030794">.</span><span class="ident" id="7030795">Errorf</span><span class="op" id="7030801">(</span><span class="string" id="7030802">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7030842">,</span>&nbsp;<span class="ident" id="7030844">i</span><span class="op" id="7030845">,</span>&nbsp;<span class="ident" id="7030847">toJSON</span><span class="op" id="7030853">(</span><span class="ident" id="7030854">c</span><span class="op" id="7030855">)</span><span class="op" id="7030856">,</span>&nbsp;<span class="ident" id="7030858">toJSON</span><span class="op" id="7030864">(</span><span class="ident" id="7030865">tt</span><span class="op" id="7030867">.</span><span class="ident" id="7030868">Cookies</span><span class="op" id="7030875">)</span><span class="op" id="7030876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7030882">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030898">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7030901">}</span><br>
<span class="lineno"></span><span class="op" id="7030903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7030906">func</span>&nbsp;<span class="ident" id="7030911">TestSetCookieDoubleQuotes</span><span class="op" id="7030936">(</span><span class="ident" id="7030937">t</span>&nbsp;<span class="op" id="7030939">*</span><span class="ident" id="7030940">testing</span><span class="op" id="7030947">.</span><span class="ident" id="7030948">T</span><span class="op" id="7030949">)</span>&nbsp;<span class="op" id="7030951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030954">res</span>&nbsp;<span class="op" id="7030958">:=</span>&nbsp;<span class="op" id="7030961">&amp;</span><span class="ident" id="7030962">Response</span><span class="op" id="7030970">{</span><span class="ident" id="7030971">Header</span><span class="op" id="7030977">:</span>&nbsp;<span class="ident" id="7030979">Header</span><span class="op" id="7030985">{</span><span class="op" id="7030986">}</span><span class="op" id="7030987">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7030990">res</span><span class="op" id="7030993">.</span><span class="ident" id="7030994">Header</span><span class="op" id="7031000">.</span><span class="ident" id="7031001">Add</span><span class="op" id="7031004">(</span><span class="string" id="7031005">&#34;Set-Cookie&#34;</span><span class="op" id="7031017">,</span>&nbsp;<span class="string" id="7031019">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7031045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031048">res</span><span class="op" id="7031051">.</span><span class="ident" id="7031052">Header</span><span class="op" id="7031058">.</span><span class="ident" id="7031059">Add</span><span class="op" id="7031062">(</span><span class="string" id="7031063">&#34;Set-Cookie&#34;</span><span class="op" id="7031075">,</span>&nbsp;<span class="string" id="7031077">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7031112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031115">res</span><span class="op" id="7031118">.</span><span class="ident" id="7031119">Header</span><span class="op" id="7031125">.</span><span class="ident" id="7031126">Add</span><span class="op" id="7031129">(</span><span class="string" id="7031130">&#34;Set-Cookie&#34;</span><span class="op" id="7031142">,</span>&nbsp;<span class="string" id="7031144">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7031176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031179">res</span><span class="op" id="7031182">.</span><span class="ident" id="7031183">Header</span><span class="op" id="7031189">.</span><span class="ident" id="7031190">Add</span><span class="op" id="7031193">(</span><span class="string" id="7031194">&#34;Set-Cookie&#34;</span><span class="op" id="7031206">,</span>&nbsp;<span class="string" id="7031208">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7031238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031241">got</span>&nbsp;<span class="op" id="7031245">:=</span>&nbsp;<span class="ident" id="7031248">res</span><span class="op" id="7031251">.</span><span class="ident" id="7031252">Cookies</span><span class="op" id="7031259">(</span><span class="op" id="7031260">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031263">want</span>&nbsp;<span class="op" id="7031268">:=</span>&nbsp;<span class="op" id="7031271">[</span><span class="op" id="7031272">]</span><span class="op" id="7031273">*</span><span class="ident" id="7031274">Cookie</span><span class="op" id="7031280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031284">{</span><span class="ident" id="7031285">Name</span><span class="op" id="7031289">:</span>&nbsp;<span class="string" id="7031291">&#34;quoted0&#34;</span><span class="op" id="7031300">,</span>&nbsp;<span class="ident" id="7031302">Value</span><span class="op" id="7031307">:</span>&nbsp;<span class="string" id="7031309">&#34;none&#34;</span><span class="op" id="7031315">,</span>&nbsp;<span class="ident" id="7031317">MaxAge</span><span class="op" id="7031323">:</span>&nbsp;<span class="num" id="7031325">30</span><span class="op" id="7031327">}</span><span class="op" id="7031328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031332">{</span><span class="ident" id="7031333">Name</span><span class="op" id="7031337">:</span>&nbsp;<span class="string" id="7031339">&#34;quoted1&#34;</span><span class="op" id="7031348">,</span>&nbsp;<span class="ident" id="7031350">Value</span><span class="op" id="7031355">:</span>&nbsp;<span class="string" id="7031357">&#34;cookieValue&#34;</span><span class="op" id="7031370">,</span>&nbsp;<span class="ident" id="7031372">MaxAge</span><span class="op" id="7031378">:</span>&nbsp;<span class="num" id="7031380">31</span><span class="op" id="7031382">}</span><span class="op" id="7031383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031387">{</span><span class="ident" id="7031388">Name</span><span class="op" id="7031392">:</span>&nbsp;<span class="string" id="7031394">&#34;quoted2&#34;</span><span class="op" id="7031403">,</span>&nbsp;<span class="ident" id="7031405">Value</span><span class="op" id="7031410">:</span>&nbsp;<span class="string" id="7031412">&#34;cookieAV&#34;</span><span class="op" id="7031422">}</span><span class="op" id="7031423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031427">{</span><span class="ident" id="7031428">Name</span><span class="op" id="7031432">:</span>&nbsp;<span class="string" id="7031434">&#34;quoted3&#34;</span><span class="op" id="7031443">,</span>&nbsp;<span class="ident" id="7031445">Value</span><span class="op" id="7031450">:</span>&nbsp;<span class="string" id="7031452">&#34;both&#34;</span><span class="op" id="7031458">}</span><span class="op" id="7031459">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7031465">if</span>&nbsp;<span class="builtinfunc" id="7031468">len</span><span class="op" id="7031471">(</span><span class="ident" id="7031472">got</span><span class="op" id="7031475">)</span>&nbsp;<span class="op" id="7031477">!=</span>&nbsp;<span class="builtinfunc" id="7031480">len</span><span class="op" id="7031483">(</span><span class="ident" id="7031484">want</span><span class="op" id="7031488">)</span>&nbsp;<span class="op" id="7031490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031494">t</span><span class="op" id="7031495">.</span><span class="ident" id="7031496">Fatal</span><span class="op" id="7031501">(</span><span class="string" id="7031502">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7031527">,</span>&nbsp;<span class="builtinfunc" id="7031529">len</span><span class="op" id="7031532">(</span><span class="ident" id="7031533">got</span><span class="op" id="7031536">)</span><span class="op" id="7031537">,</span>&nbsp;<span class="builtinfunc" id="7031539">len</span><span class="op" id="7031542">(</span><span class="ident" id="7031543">want</span><span class="op" id="7031547">)</span><span class="op" id="7031548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7031554">for</span>&nbsp;<span class="ident" id="7031558">i</span><span class="op" id="7031559">,</span>&nbsp;<span class="ident" id="7031561">w</span>&nbsp;<span class="op" id="7031563">:=</span>&nbsp;<span class="keyword" id="7031566">range</span>&nbsp;<span class="ident" id="7031572">want</span>&nbsp;<span class="op" id="7031577">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031581">g</span>&nbsp;<span class="op" id="7031583">:=</span>&nbsp;<span class="ident" id="7031586">got</span><span class="op" id="7031589">[</span><span class="ident" id="7031590">i</span><span class="op" id="7031591">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7031595">if</span>&nbsp;<span class="ident" id="7031598">g</span><span class="op" id="7031599">.</span><span class="ident" id="7031600">Name</span>&nbsp;<span class="op" id="7031605">!=</span>&nbsp;<span class="ident" id="7031608">w</span><span class="op" id="7031609">.</span><span class="ident" id="7031610">Name</span>&nbsp;<span class="op" id="7031615">||</span>&nbsp;<span class="ident" id="7031618">g</span><span class="op" id="7031619">.</span><span class="ident" id="7031620">Value</span>&nbsp;<span class="op" id="7031626">!=</span>&nbsp;<span class="ident" id="7031629">w</span><span class="op" id="7031630">.</span><span class="ident" id="7031631">Value</span>&nbsp;<span class="op" id="7031637">||</span>&nbsp;<span class="ident" id="7031640">g</span><span class="op" id="7031641">.</span><span class="ident" id="7031642">MaxAge</span>&nbsp;<span class="op" id="7031649">!=</span>&nbsp;<span class="ident" id="7031652">w</span><span class="op" id="7031653">.</span><span class="ident" id="7031654">MaxAge</span>&nbsp;<span class="op" id="7031661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031666">t</span><span class="op" id="7031667">.</span><span class="ident" id="7031668">Errorf</span><span class="op" id="7031674">(</span><span class="string" id="7031675">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7031706">,</span>&nbsp;<span class="ident" id="7031708">i</span><span class="op" id="7031709">,</span>&nbsp;<span class="ident" id="7031711">g</span><span class="op" id="7031712">,</span>&nbsp;<span class="ident" id="7031714">w</span><span class="op" id="7031715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031722">}</span><br>
<span class="lineno">360</span><span class="op" id="7031724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7031727">func</span>&nbsp;<span class="ident" id="7031732">TestCookieSanitizeValue</span><span class="op" id="7031755">(</span><span class="ident" id="7031756">t</span>&nbsp;<span class="op" id="7031758">*</span><span class="ident" id="7031759">testing</span><span class="op" id="7031766">.</span><span class="ident" id="7031767">T</span><span class="op" id="7031768">)</span>&nbsp;<span class="op" id="7031770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7031773">defer</span>&nbsp;<span class="ident" id="7031779">log</span><span class="op" id="7031782">.</span><span class="ident" id="7031783">SetOutput</span><span class="op" id="7031792">(</span><span class="ident" id="7031793">os</span><span class="op" id="7031795">.</span><span class="ident" id="7031796">Stderr</span><span class="op" id="7031802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7031805">var</span>&nbsp;<span class="ident" id="7031809">logbuf</span>&nbsp;<span class="ident" id="7031816">bytes</span><span class="op" id="7031821">.</span><span class="ident" id="7031822">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031830">log</span><span class="op" id="7031833">.</span><span class="ident" id="7031834">SetOutput</span><span class="op" id="7031843">(</span><span class="op" id="7031844">&amp;</span><span class="ident" id="7031845">logbuf</span><span class="op" id="7031851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031855">tests</span>&nbsp;<span class="op" id="7031861">:=</span>&nbsp;<span class="op" id="7031864">[</span><span class="op" id="7031865">]</span><span class="keyword" id="7031866">struct</span>&nbsp;<span class="op" id="7031873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7031877">in</span><span class="op" id="7031879">,</span>&nbsp;<span class="ident" id="7031881">want</span>&nbsp;<span class="builtintype" id="7031886">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031894">}</span><span class="op" id="7031895">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031899">{</span><span class="string" id="7031900">&#34;foo&#34;</span><span class="op" id="7031905">,</span>&nbsp;<span class="string" id="7031907">&#34;foo&#34;</span><span class="op" id="7031912">}</span><span class="op" id="7031913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031917">{</span><span class="string" id="7031918">&#34;foo;bar&#34;</span><span class="op" id="7031927">,</span>&nbsp;<span class="string" id="7031929">&#34;foobar&#34;</span><span class="op" id="7031937">}</span><span class="op" id="7031938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031942">{</span><span class="string" id="7031943">&#34;foo\\bar&#34;</span><span class="op" id="7031953">,</span>&nbsp;<span class="string" id="7031955">&#34;foobar&#34;</span><span class="op" id="7031963">}</span><span class="op" id="7031964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031968">{</span><span class="string" id="7031969">&#34;foo\&#34;bar&#34;</span><span class="op" id="7031979">,</span>&nbsp;<span class="string" id="7031981">&#34;foobar&#34;</span><span class="op" id="7031989">}</span><span class="op" id="7031990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7031994">{</span><span class="string" id="7031995">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7032013">,</span>&nbsp;<span class="string" id="7032015">&#34;\x7e&#34;</span><span class="op" id="7032021">}</span><span class="op" id="7032022">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032026">{</span><span class="string" id="7032027">`&#34;withquotes&#34;`</span><span class="op" id="7032041">,</span>&nbsp;<span class="string" id="7032043">&#34;withquotes&#34;</span><span class="op" id="7032055">}</span><span class="op" id="7032056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032060">{</span><span class="string" id="7032061">&#34;a&nbsp;z&#34;</span><span class="op" id="7032066">,</span>&nbsp;<span class="string" id="7032068">&#34;a&nbsp;z&#34;</span><span class="op" id="7032073">}</span><span class="op" id="7032074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032078">{</span><span class="string" id="7032079">&#34;&nbsp;z&#34;</span><span class="op" id="7032083">,</span>&nbsp;<span class="string" id="7032085">`&#34;&nbsp;z&#34;`</span><span class="op" id="7032091">}</span><span class="op" id="7032092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032096">{</span><span class="string" id="7032097">&#34;a&nbsp;&#34;</span><span class="op" id="7032101">,</span>&nbsp;<span class="string" id="7032103">`&#34;a&nbsp;&#34;`</span><span class="op" id="7032109">}</span><span class="op" id="7032110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032113">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032116">for</span>&nbsp;<span class="ident" id="7032120">_</span><span class="op" id="7032121">,</span>&nbsp;<span class="ident" id="7032123">tt</span>&nbsp;<span class="op" id="7032126">:=</span>&nbsp;<span class="keyword" id="7032129">range</span>&nbsp;<span class="ident" id="7032135">tests</span>&nbsp;<span class="op" id="7032141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032145">if</span>&nbsp;<span class="ident" id="7032148">got</span>&nbsp;<span class="op" id="7032152">:=</span>&nbsp;<span class="ident" id="7032155">sanitizeCookieValue</span><span class="op" id="7032174">(</span><span class="ident" id="7032175">tt</span><span class="op" id="7032177">.</span><span class="ident" id="7032178">in</span><span class="op" id="7032180">)</span><span class="op" id="7032181">;</span>&nbsp;<span class="ident" id="7032183">got</span>&nbsp;<span class="op" id="7032187">!=</span>&nbsp;<span class="ident" id="7032190">tt</span><span class="op" id="7032192">.</span><span class="ident" id="7032193">want</span>&nbsp;<span class="op" id="7032198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032203">t</span><span class="op" id="7032204">.</span><span class="ident" id="7032205">Errorf</span><span class="op" id="7032211">(</span><span class="string" id="7032212">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7032251">,</span>&nbsp;<span class="ident" id="7032253">tt</span><span class="op" id="7032255">.</span><span class="ident" id="7032256">in</span><span class="op" id="7032258">,</span>&nbsp;<span class="ident" id="7032260">got</span><span class="op" id="7032263">,</span>&nbsp;<span class="ident" id="7032265">tt</span><span class="op" id="7032267">.</span><span class="ident" id="7032268">want</span><span class="op" id="7032272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032279">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032283">if</span>&nbsp;<span class="ident" id="7032286">got</span><span class="op" id="7032289">,</span>&nbsp;<span class="ident" id="7032291">sub</span>&nbsp;<span class="op" id="7032295">:=</span>&nbsp;<span class="ident" id="7032298">logbuf</span><span class="op" id="7032304">.</span><span class="ident" id="7032305">String</span><span class="op" id="7032311">(</span><span class="op" id="7032312">)</span><span class="op" id="7032313">,</span>&nbsp;<span class="string" id="7032315">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7032339">;</span>&nbsp;<span class="op" id="7032341">!</span><span class="ident" id="7032342">strings</span><span class="op" id="7032349">.</span><span class="ident" id="7032350">Contains</span><span class="op" id="7032358">(</span><span class="ident" id="7032359">got</span><span class="op" id="7032362">,</span>&nbsp;<span class="ident" id="7032364">sub</span><span class="op" id="7032367">)</span>&nbsp;<span class="op" id="7032369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032373">t</span><span class="op" id="7032374">.</span><span class="ident" id="7032375">Errorf</span><span class="op" id="7032381">(</span><span class="string" id="7032382">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7032429">,</span>&nbsp;<span class="ident" id="7032431">sub</span><span class="op" id="7032434">,</span>&nbsp;<span class="ident" id="7032436">got</span><span class="op" id="7032439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032442">}</span><br>
<span class="lineno"></span><span class="op" id="7032444">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7032447">func</span>&nbsp;<span class="ident" id="7032452">TestCookieSanitizePath</span><span class="op" id="7032474">(</span><span class="ident" id="7032475">t</span>&nbsp;<span class="op" id="7032477">*</span><span class="ident" id="7032478">testing</span><span class="op" id="7032485">.</span><span class="ident" id="7032486">T</span><span class="op" id="7032487">)</span>&nbsp;<span class="op" id="7032489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032492">defer</span>&nbsp;<span class="ident" id="7032498">log</span><span class="op" id="7032501">.</span><span class="ident" id="7032502">SetOutput</span><span class="op" id="7032511">(</span><span class="ident" id="7032512">os</span><span class="op" id="7032514">.</span><span class="ident" id="7032515">Stderr</span><span class="op" id="7032521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032524">var</span>&nbsp;<span class="ident" id="7032528">logbuf</span>&nbsp;<span class="ident" id="7032535">bytes</span><span class="op" id="7032540">.</span><span class="ident" id="7032541">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032549">log</span><span class="op" id="7032552">.</span><span class="ident" id="7032553">SetOutput</span><span class="op" id="7032562">(</span><span class="op" id="7032563">&amp;</span><span class="ident" id="7032564">logbuf</span><span class="op" id="7032570">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032574">tests</span>&nbsp;<span class="op" id="7032580">:=</span>&nbsp;<span class="op" id="7032583">[</span><span class="op" id="7032584">]</span><span class="keyword" id="7032585">struct</span>&nbsp;<span class="op" id="7032592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032596">in</span><span class="op" id="7032598">,</span>&nbsp;<span class="ident" id="7032600">want</span>&nbsp;<span class="builtintype" id="7032605">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032613">}</span><span class="op" id="7032614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032618">{</span><span class="string" id="7032619">&#34;/path&#34;</span><span class="op" id="7032626">,</span>&nbsp;<span class="string" id="7032628">&#34;/path&#34;</span><span class="op" id="7032635">}</span><span class="op" id="7032636">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032640">{</span><span class="string" id="7032641">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7032660">,</span>&nbsp;<span class="string" id="7032662">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7032681">}</span><span class="op" id="7032682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032686">{</span><span class="string" id="7032687">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7032719">,</span>&nbsp;<span class="string" id="7032721">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7032747">}</span><span class="op" id="7032748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032754">for</span>&nbsp;<span class="ident" id="7032758">_</span><span class="op" id="7032759">,</span>&nbsp;<span class="ident" id="7032761">tt</span>&nbsp;<span class="op" id="7032764">:=</span>&nbsp;<span class="keyword" id="7032767">range</span>&nbsp;<span class="ident" id="7032773">tests</span>&nbsp;<span class="op" id="7032779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032783">if</span>&nbsp;<span class="ident" id="7032786">got</span>&nbsp;<span class="op" id="7032790">:=</span>&nbsp;<span class="ident" id="7032793">sanitizeCookiePath</span><span class="op" id="7032811">(</span><span class="ident" id="7032812">tt</span><span class="op" id="7032814">.</span><span class="ident" id="7032815">in</span><span class="op" id="7032817">)</span><span class="op" id="7032818">;</span>&nbsp;<span class="ident" id="7032820">got</span>&nbsp;<span class="op" id="7032824">!=</span>&nbsp;<span class="ident" id="7032827">tt</span><span class="op" id="7032829">.</span><span class="ident" id="7032830">want</span>&nbsp;<span class="op" id="7032835">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7032840">t</span><span class="op" id="7032841">.</span><span class="ident" id="7032842">Errorf</span><span class="op" id="7032848">(</span><span class="string" id="7032849">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7032887">,</span>&nbsp;<span class="ident" id="7032889">tt</span><span class="op" id="7032891">.</span><span class="ident" id="7032892">in</span><span class="op" id="7032894">,</span>&nbsp;<span class="ident" id="7032896">got</span><span class="op" id="7032899">,</span>&nbsp;<span class="ident" id="7032901">tt</span><span class="op" id="7032903">.</span><span class="ident" id="7032904">want</span><span class="op" id="7032908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7032915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7032919">if</span>&nbsp;<span class="ident" id="7032922">got</span><span class="op" id="7032925">,</span>&nbsp;<span class="ident" id="7032927">sub</span>&nbsp;<span class="op" id="7032931">:=</span>&nbsp;<span class="ident" id="7032934">logbuf</span><span class="op" id="7032940">.</span><span class="ident" id="7032941">String</span><span class="op" id="7032947">(</span><span class="op" id="7032948">)</span><span class="op" id="7032949">,</span>&nbsp;<span class="string" id="7032951">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7032975">;</span>&nbsp;<span class="op" id="7032977">!</span><span class="ident" id="7032978">strings</span><span class="op" id="7032985">.</span><span class="ident" id="7032986">Contains</span><span class="op" id="7032994">(</span><span class="ident" id="7032995">got</span><span class="op" id="7032998">,</span>&nbsp;<span class="ident" id="7033000">sub</span><span class="op" id="7033003">)</span>&nbsp;<span class="op" id="7033005">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7033009">t</span><span class="op" id="7033010">.</span><span class="ident" id="7033011">Errorf</span><span class="op" id="7033017">(</span><span class="string" id="7033018">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7033065">,</span>&nbsp;<span class="ident" id="7033067">sub</span><span class="op" id="7033070">,</span>&nbsp;<span class="ident" id="7033072">got</span><span class="op" id="7033075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7033078">}</span><br>
<span class="lineno"></span><span class="op" id="7033080">}</span>
</div>
</body>
</html>
