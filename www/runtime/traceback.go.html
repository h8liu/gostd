<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1992728">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1992783">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1992837">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1992888">package</span>&nbsp;<span class="ident" id="1992896">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1992905">import</span>&nbsp;<span class="string" id="1992912">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1992922">//&nbsp;The&nbsp;code&nbsp;in&nbsp;this&nbsp;file&nbsp;implements&nbsp;stack&nbsp;trace&nbsp;walking&nbsp;for&nbsp;all&nbsp;architectures.</span><br>
<span class="lineno">10</span><span class="comment" id="1993001">//&nbsp;The&nbsp;most&nbsp;important&nbsp;fact&nbsp;about&nbsp;a&nbsp;given&nbsp;architecture&nbsp;is&nbsp;whether&nbsp;it&nbsp;uses&nbsp;a&nbsp;link&nbsp;register.</span><br>
<span class="lineno"></span><span class="comment" id="1993091">//&nbsp;On&nbsp;systems&nbsp;with&nbsp;link&nbsp;registers,&nbsp;the&nbsp;prologue&nbsp;for&nbsp;a&nbsp;non-leaf&nbsp;function&nbsp;stores&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1993174">//&nbsp;incoming&nbsp;value&nbsp;of&nbsp;LR&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;the&nbsp;newly&nbsp;allocated&nbsp;stack&nbsp;frame.</span><br>
<span class="lineno"></span><span class="comment" id="1993248">//&nbsp;On&nbsp;systems&nbsp;without&nbsp;link&nbsp;registers,&nbsp;the&nbsp;architecture&nbsp;pushes&nbsp;a&nbsp;return&nbsp;PC&nbsp;during</span><br>
<span class="lineno"></span><span class="comment" id="1993329">//&nbsp;the&nbsp;call&nbsp;instruction,&nbsp;so&nbsp;the&nbsp;return&nbsp;PC&nbsp;ends&nbsp;up&nbsp;above&nbsp;the&nbsp;stack&nbsp;frame.</span><br>
<span class="lineno">15</span><span class="comment" id="1993402">//&nbsp;In&nbsp;this&nbsp;file,&nbsp;the&nbsp;return&nbsp;PC&nbsp;is&nbsp;always&nbsp;called&nbsp;LR,&nbsp;no&nbsp;matter&nbsp;how&nbsp;it&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="1993482">//</span><br>
<span class="lineno"></span><span class="comment" id="1993485">//&nbsp;To&nbsp;date,&nbsp;the&nbsp;opposite&nbsp;of&nbsp;a&nbsp;link&nbsp;register&nbsp;architecture&nbsp;is&nbsp;an&nbsp;x86&nbsp;architecture.</span><br>
<span class="lineno"></span><span class="comment" id="1993566">//&nbsp;This&nbsp;code&nbsp;may&nbsp;need&nbsp;to&nbsp;change&nbsp;if&nbsp;some&nbsp;other&nbsp;kind&nbsp;of&nbsp;non-link-register</span><br>
<span class="lineno"></span><span class="comment" id="1993638">//&nbsp;architecture&nbsp;comes&nbsp;along.</span><br>
<span class="lineno">20</span><span class="comment" id="1993667">//</span><br>
<span class="lineno"></span><span class="comment" id="1993670">//&nbsp;The&nbsp;other&nbsp;important&nbsp;fact&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;pointer:&nbsp;on&nbsp;32-bit&nbsp;systems&nbsp;the&nbsp;LR</span><br>
<span class="lineno"></span><span class="comment" id="1993749">//&nbsp;takes&nbsp;up&nbsp;only&nbsp;4&nbsp;bytes&nbsp;on&nbsp;the&nbsp;stack,&nbsp;while&nbsp;on&nbsp;64-bit&nbsp;systems&nbsp;it&nbsp;takes&nbsp;up&nbsp;8&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1993833">//&nbsp;Typically&nbsp;this&nbsp;is&nbsp;ptrSize.</span><br>
<span class="lineno"></span><span class="comment" id="1993863">//</span><br>
<span class="lineno">25</span><span class="comment" id="1993866">//&nbsp;As&nbsp;an&nbsp;exception,&nbsp;amd64p32&nbsp;has&nbsp;ptrSize&nbsp;==&nbsp;4&nbsp;but&nbsp;the&nbsp;CALL&nbsp;instruction&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="1993943">//&nbsp;stores&nbsp;an&nbsp;8-byte&nbsp;return&nbsp;PC&nbsp;onto&nbsp;the&nbsp;stack.&nbsp;To&nbsp;accommodate&nbsp;this,&nbsp;we&nbsp;use&nbsp;regSize</span><br>
<span class="lineno"></span><span class="comment" id="1994025">//&nbsp;as&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;architecture-pushed&nbsp;return&nbsp;PC.</span><br>
<span class="lineno"></span><span class="comment" id="1994078">//</span><br>
<span class="lineno"></span><span class="comment" id="1994081">//&nbsp;usesLR&nbsp;is&nbsp;defined&nbsp;below.&nbsp;ptrSize&nbsp;and&nbsp;regSize&nbsp;are&nbsp;defined&nbsp;in&nbsp;stubs.go.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="1994155">const</span>&nbsp;<span class="ident" id="1994161">usesLR</span>&nbsp;<span class="op" id="1994168">=</span>&nbsp;<span class="ident" id="1994170"><a href="/runtime/extern.go.html#1763748">GOARCH</a></span>&nbsp;<span class="op" id="1994177">!=</span>&nbsp;<span class="string" id="1994180">&#34;amd64&#34;</span>&nbsp;<span class="op" id="1994188">&amp;&amp;</span>&nbsp;<span class="ident" id="1994191"><a href="/runtime/extern.go.html#1763748">GOARCH</a></span>&nbsp;<span class="op" id="1994198">!=</span>&nbsp;<span class="string" id="1994201">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="1994212">&amp;&amp;</span>&nbsp;<span class="ident" id="1994215"><a href="/runtime/extern.go.html#1763748">GOARCH</a></span>&nbsp;<span class="op" id="1994222">!=</span>&nbsp;<span class="string" id="1994225">&#34;386&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1994232">var</span>&nbsp;<span class="op" id="1994236">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994239">//&nbsp;initialized&nbsp;in&nbsp;tracebackinit</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994272">deferprocPC</span>&nbsp;<span class="builtintype" id="1994284">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994293">goexitPC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1994305">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994314">jmpdeferPC</span>&nbsp;&nbsp;<span class="builtintype" id="1994326">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994335">mcallPC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1994347">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994356">morestackPC</span>&nbsp;<span class="builtintype" id="1994368">uintptr</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994377">mstartPC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1994389">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994398">newprocPC</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1994410">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994419">rt0_goPC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1994431">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994440">sigpanicPC</span>&nbsp;&nbsp;<span class="builtintype" id="1994452">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994462">externalthreadhandlerp</span>&nbsp;<span class="builtintype" id="1994485">uintptr</span>&nbsp;<span class="comment" id="1994493">//&nbsp;initialized&nbsp;elsewhere</span><br>
<span class="lineno"></span><span class="op" id="1994518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1994521">func</span>&nbsp;<span class="ident" id="1994526">tracebackinit</span><span class="op" id="1994539">(</span><span class="op" id="1994540">)</span>&nbsp;<span class="op" id="1994542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994545">//&nbsp;Go&nbsp;variable&nbsp;initialization&nbsp;happens&nbsp;late&nbsp;during&nbsp;runtime&nbsp;startup.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994613">//&nbsp;Instead&nbsp;of&nbsp;initializing&nbsp;the&nbsp;variables&nbsp;above&nbsp;in&nbsp;the&nbsp;declarations,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994682">//&nbsp;schedinit&nbsp;calls&nbsp;this&nbsp;function&nbsp;so&nbsp;that&nbsp;the&nbsp;variables&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994742">//&nbsp;initialized&nbsp;and&nbsp;available&nbsp;earlier&nbsp;in&nbsp;the&nbsp;startup&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994805"><a href="/runtime/traceback.go.html#1994272">deferprocPC</a></span>&nbsp;<span class="op" id="1994817">=</span>&nbsp;<span class="ident" id="1994819"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994825">(</span><span class="ident" id="1994826"><a href="/runtime/panic.go.html#1882593">deferproc</a></span><span class="op" id="1994835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994838"><a href="/runtime/traceback.go.html#1994293">goexitPC</a></span>&nbsp;<span class="op" id="1994847">=</span>&nbsp;<span class="ident" id="1994849"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994855">(</span><span class="ident" id="1994856"><a href="/runtime/stubs.go.html#1974611">goexit</a></span><span class="op" id="1994862">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994865"><a href="/runtime/traceback.go.html#1994314">jmpdeferPC</a></span>&nbsp;<span class="op" id="1994876">=</span>&nbsp;<span class="ident" id="1994878"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994884">(</span><span class="ident" id="1994885"><a href="/runtime/stubs.go.html#1973767">jmpdefer</a></span><span class="op" id="1994893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994896"><a href="/runtime/traceback.go.html#1994335">mcallPC</a></span>&nbsp;<span class="op" id="1994904">=</span>&nbsp;<span class="ident" id="1994906"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994912">(</span><span class="ident" id="1994913"><a href="/runtime/stubs.go.html#1969611">mcall</a></span><span class="op" id="1994918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994921"><a href="/runtime/traceback.go.html#1994356">morestackPC</a></span>&nbsp;<span class="op" id="1994933">=</span>&nbsp;<span class="ident" id="1994935"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994941">(</span><span class="ident" id="1994942"><a href="/runtime/stubs.go.html#1976760">morestack</a></span><span class="op" id="1994951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994954"><a href="/runtime/traceback.go.html#1994377">mstartPC</a></span>&nbsp;<span class="op" id="1994963">=</span>&nbsp;<span class="ident" id="1994965"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994971">(</span><span class="ident" id="1994972"><a href="/runtime/stubs.go.html#1976777">mstart</a></span><span class="op" id="1994978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994981"><a href="/runtime/traceback.go.html#1994398">newprocPC</a></span>&nbsp;<span class="op" id="1994991">=</span>&nbsp;<span class="ident" id="1994993"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1994999">(</span><span class="ident" id="1995000"><a href="/runtime/stubs.go.html#1976745">newproc</a></span><span class="op" id="1995007">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995010"><a href="/runtime/traceback.go.html#1994419">rt0_goPC</a></span>&nbsp;<span class="op" id="1995019">=</span>&nbsp;<span class="ident" id="1995021"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1995027">(</span><span class="ident" id="1995028"><a href="/runtime/stubs.go.html#1976791">rt0_go</a></span><span class="op" id="1995034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995037"><a href="/runtime/traceback.go.html#1994440">sigpanicPC</a></span>&nbsp;<span class="op" id="1995048">=</span>&nbsp;<span class="ident" id="1995050"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1995056">(</span><span class="ident" id="1995057"><a href="/runtime/sigpanic_unix.go.html#1937876">sigpanic</a></span><span class="op" id="1995065">)</span><br>
<span class="lineno"></span><span class="op" id="1995067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1995070">//&nbsp;Traceback&nbsp;over&nbsp;the&nbsp;deferred&nbsp;function&nbsp;calls.</span><br>
<span class="lineno">65</span><span class="comment" id="1995117">//&nbsp;Report&nbsp;them&nbsp;like&nbsp;calls&nbsp;that&nbsp;have&nbsp;been&nbsp;invoked&nbsp;but&nbsp;not&nbsp;started&nbsp;executing&nbsp;yet.</span><br>
<span class="lineno"></span><span class="keyword" id="1995197">func</span>&nbsp;<span class="ident" id="1995202">tracebackdefers</span><span class="op" id="1995217">(</span><span class="ident" id="1995218">gp</span>&nbsp;<span class="op" id="1995221">*</span><span class="ident" id="1995222"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="1995223">,</span>&nbsp;<span class="ident" id="1995225">callback</span>&nbsp;<span class="keyword" id="1995234">func</span><span class="op" id="1995238">(</span><span class="op" id="1995239">*</span><span class="ident" id="1995240"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><span class="op" id="1995248">,</span>&nbsp;<span class="ident" id="1995250"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1995256">.</span><span class="ident" id="1995257">Pointer</span><span class="op" id="1995264">)</span>&nbsp;<span class="builtintype" id="1995266">bool</span><span class="op" id="1995270">,</span>&nbsp;<span class="ident" id="1995272">v</span>&nbsp;<span class="ident" id="1995274"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1995280">.</span><span class="ident" id="1995281">Pointer</span><span class="op" id="1995288">)</span>&nbsp;<span class="op" id="1995290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995293">var</span>&nbsp;<span class="ident" id="1995297">frame</span>&nbsp;<span class="ident" id="1995303"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995313">for</span>&nbsp;<span class="ident" id="1995317">d</span>&nbsp;<span class="op" id="1995319">:=</span>&nbsp;<span class="ident" id="1995322"><a href="/runtime/traceback.go.html#1995218">gp</a></span><span class="op" id="1995324">.</span><span class="ident" id="1995325">_defer</span><span class="op" id="1995331">;</span>&nbsp;<span class="ident" id="1995333"><a href="/runtime/traceback.go.html#1995317">d</a></span>&nbsp;<span class="op" id="1995335">!=</span>&nbsp;<span class="ident" id="1995338">nil</span><span class="op" id="1995341">;</span>&nbsp;<span class="ident" id="1995343"><a href="/runtime/traceback.go.html#1995317">d</a></span>&nbsp;<span class="op" id="1995345">=</span>&nbsp;<span class="ident" id="1995347"><a href="/runtime/traceback.go.html#1995317">d</a></span><span class="op" id="1995348">.</span><span class="ident" id="1995349">link</span>&nbsp;<span class="op" id="1995354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995358">fn</span>&nbsp;<span class="op" id="1995361">:=</span>&nbsp;<span class="ident" id="1995364"><a href="/runtime/traceback.go.html#1995317">d</a></span><span class="op" id="1995365">.</span><span class="ident" id="1995366">fn</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995371">if</span>&nbsp;<span class="ident" id="1995374"><a href="/runtime/traceback.go.html#1995358">fn</a></span>&nbsp;<span class="op" id="1995377">==</span>&nbsp;<span class="ident" id="1995380">nil</span>&nbsp;<span class="op" id="1995384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995389">//&nbsp;Defer&nbsp;of&nbsp;nil&nbsp;function.&nbsp;Args&nbsp;don&#39;t&nbsp;matter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995437"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995442">.</span><span class="ident" id="1995443">pc</span>&nbsp;<span class="op" id="1995446">=</span>&nbsp;<span class="num" id="1995448">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995453"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995458">.</span><span class="ident" id="1995459">fn</span>&nbsp;<span class="op" id="1995462">=</span>&nbsp;<span class="ident" id="1995464">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995471"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995476">.</span><span class="ident" id="1995477">argp</span>&nbsp;<span class="op" id="1995482">=</span>&nbsp;<span class="num" id="1995484">0</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995489"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995494">.</span><span class="ident" id="1995495">arglen</span>&nbsp;<span class="op" id="1995502">=</span>&nbsp;<span class="num" id="1995504">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995509"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995514">.</span><span class="ident" id="1995515">argmap</span>&nbsp;<span class="op" id="1995522">=</span>&nbsp;<span class="ident" id="1995524">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995530">}</span>&nbsp;<span class="keyword" id="1995532">else</span>&nbsp;<span class="op" id="1995537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995542"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995547">.</span><span class="ident" id="1995548">pc</span>&nbsp;<span class="op" id="1995551">=</span>&nbsp;<span class="builtintype" id="1995553">uintptr</span><span class="op" id="1995560">(</span><span class="ident" id="1995561"><a href="/runtime/traceback.go.html#1995358">fn</a></span><span class="op" id="1995563">.</span><span class="ident" id="1995564">fn</span><span class="op" id="1995566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995571">f</span>&nbsp;<span class="op" id="1995573">:=</span>&nbsp;<span class="ident" id="1995576"><a href="/runtime/symtab.go.html#1982993">findfunc</a></span><span class="op" id="1995584">(</span><span class="ident" id="1995585"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995590">.</span><span class="ident" id="1995591">pc</span><span class="op" id="1995593">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995598">if</span>&nbsp;<span class="ident" id="1995601"><a href="/runtime/traceback.go.html#1995571">f</a></span>&nbsp;<span class="op" id="1995603">==</span>&nbsp;<span class="ident" id="1995606">nil</span>&nbsp;<span class="op" id="1995610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1995616">print</span><span class="op" id="1995621">(</span><span class="string" id="1995622">&#34;runtime:&nbsp;unknown&nbsp;pc&nbsp;in&nbsp;defer&nbsp;&#34;</span><span class="op" id="1995653">,</span>&nbsp;<span class="ident" id="1995655"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="1995658">(</span><span class="ident" id="1995659"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995664">.</span><span class="ident" id="1995665">pc</span><span class="op" id="1995667">)</span><span class="op" id="1995668">,</span>&nbsp;<span class="string" id="1995670">&#34;\n&#34;</span><span class="op" id="1995674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995680"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1995687">(</span><span class="string" id="1995688">&#34;unknown&nbsp;pc&#34;</span><span class="op" id="1995700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995710"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995715">.</span><span class="ident" id="1995716">fn</span>&nbsp;<span class="op" id="1995719">=</span>&nbsp;<span class="ident" id="1995721"><a href="/runtime/traceback.go.html#1995571">f</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995726"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995731">.</span><span class="ident" id="1995732">argp</span>&nbsp;<span class="op" id="1995737">=</span>&nbsp;<span class="builtintype" id="1995739">uintptr</span><span class="op" id="1995746">(</span><span class="ident" id="1995747"><a href="/runtime/panic.go.html#1885206">deferArgs</a></span><span class="op" id="1995756">(</span><span class="ident" id="1995757"><a href="/runtime/traceback.go.html#1995317">d</a></span><span class="op" id="1995758">)</span><span class="op" id="1995759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995764"><a href="/runtime/traceback.go.html#2008083">setArgInfo</a></span><span class="op" id="1995774">(</span><span class="op" id="1995775">&amp;</span><span class="ident" id="1995776"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995781">,</span>&nbsp;<span class="ident" id="1995783"><a href="/runtime/traceback.go.html#1995571">f</a></span><span class="op" id="1995784">,</span>&nbsp;<span class="ident" id="1995786">true</span><span class="op" id="1995790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995798"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995803">.</span><span class="ident" id="1995804">continpc</span>&nbsp;<span class="op" id="1995813">=</span>&nbsp;<span class="ident" id="1995815"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995820">.</span><span class="ident" id="1995821">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995826">if</span>&nbsp;<span class="op" id="1995829">!</span><span class="ident" id="1995830"><a href="/runtime/traceback.go.html#1995225">callback</a></span><span class="op" id="1995838">(</span><span class="op" id="1995839">(</span><span class="op" id="1995840">*</span><span class="ident" id="1995841"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><span class="op" id="1995849">)</span><span class="op" id="1995850">(</span><span class="ident" id="1995851"><a href="/runtime/stubs.go.html#1973287">noescape</a></span><span class="op" id="1995859">(</span><span class="ident" id="1995860"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1995866">.</span><span class="ident" id="1995867">Pointer</span><span class="op" id="1995874">(</span><span class="op" id="1995875">&amp;</span><span class="ident" id="1995876"><a href="/runtime/traceback.go.html#1995297">frame</a></span><span class="op" id="1995881">)</span><span class="op" id="1995882">)</span><span class="op" id="1995883">)</span><span class="op" id="1995884">,</span>&nbsp;<span class="ident" id="1995886"><a href="/runtime/traceback.go.html#1995272">v</a></span><span class="op" id="1995887">)</span>&nbsp;<span class="op" id="1995889">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995894">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995906">}</span><br>
<span class="lineno"></span><span class="op" id="1995908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1995911">//&nbsp;Generic&nbsp;traceback.&nbsp;&nbsp;Handles&nbsp;runtime&nbsp;stack&nbsp;prints&nbsp;(pcbuf&nbsp;==&nbsp;nil),</span><br>
<span class="lineno"></span><span class="comment" id="1995979">//&nbsp;the&nbsp;runtime.Callers&nbsp;function&nbsp;(pcbuf&nbsp;!=&nbsp;nil),&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;garbage</span><br>
<span class="lineno"></span><span class="comment" id="1996050">//&nbsp;collector&nbsp;(callback&nbsp;!=&nbsp;nil).&nbsp;&nbsp;A&nbsp;little&nbsp;clunky&nbsp;to&nbsp;merge&nbsp;these,&nbsp;but&nbsp;avoids</span><br>
<span class="lineno"></span><span class="comment" id="1996126">//&nbsp;duplicating&nbsp;the&nbsp;code&nbsp;and&nbsp;all&nbsp;its&nbsp;subtlety.</span><br>
<span class="lineno"></span><span class="keyword" id="1996172">func</span>&nbsp;<span class="ident" id="1996177">gentraceback</span><span class="op" id="1996189">(</span><span class="ident" id="1996190">pc0</span>&nbsp;<span class="builtintype" id="1996194">uintptr</span><span class="op" id="1996201">,</span>&nbsp;<span class="ident" id="1996203">sp0</span>&nbsp;<span class="builtintype" id="1996207">uintptr</span><span class="op" id="1996214">,</span>&nbsp;<span class="ident" id="1996216">lr0</span>&nbsp;<span class="builtintype" id="1996220">uintptr</span><span class="op" id="1996227">,</span>&nbsp;<span class="ident" id="1996229">gp</span>&nbsp;<span class="op" id="1996232">*</span><span class="ident" id="1996233"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="1996234">,</span>&nbsp;<span class="ident" id="1996236">skip</span>&nbsp;<span class="builtintype" id="1996241">int</span><span class="op" id="1996244">,</span>&nbsp;<span class="ident" id="1996246">pcbuf</span>&nbsp;<span class="op" id="1996252">*</span><span class="builtintype" id="1996253">uintptr</span><span class="op" id="1996260">,</span>&nbsp;<span class="ident" id="1996262">max</span>&nbsp;<span class="builtintype" id="1996266">int</span><span class="op" id="1996269">,</span>&nbsp;<span class="ident" id="1996271">callback</span>&nbsp;<span class="keyword" id="1996280">func</span><span class="op" id="1996284">(</span><span class="op" id="1996285">*</span><span class="ident" id="1996286"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><span class="op" id="1996294">,</span>&nbsp;<span class="ident" id="1996296"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1996302">.</span><span class="ident" id="1996303">Pointer</span><span class="op" id="1996310">)</span>&nbsp;<span class="builtintype" id="1996312">bool</span><span class="op" id="1996316">,</span>&nbsp;<span class="ident" id="1996318">v</span>&nbsp;<span class="ident" id="1996320"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1996326">.</span><span class="ident" id="1996327">Pointer</span><span class="op" id="1996334">,</span>&nbsp;<span class="ident" id="1996336">flags</span>&nbsp;<span class="builtintype" id="1996342">uint</span><span class="op" id="1996346">)</span>&nbsp;<span class="builtintype" id="1996348">int</span>&nbsp;<span class="op" id="1996352">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996355">if</span>&nbsp;<span class="ident" id="1996358"><a href="/runtime/traceback.go.html#1994293">goexitPC</a></span>&nbsp;<span class="op" id="1996367">==</span>&nbsp;<span class="num" id="1996370">0</span>&nbsp;<span class="op" id="1996372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996376"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1996383">(</span><span class="string" id="1996384">&#34;gentraceback&nbsp;before&nbsp;goexitPC&nbsp;initialization&#34;</span><span class="op" id="1996429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996435">g</span>&nbsp;<span class="op" id="1996437">:=</span>&nbsp;<span class="ident" id="1996440"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1996444">(</span><span class="op" id="1996445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996448">if</span>&nbsp;<span class="ident" id="1996451"><a href="/runtime/traceback.go.html#1996435">g</a></span>&nbsp;<span class="op" id="1996453">==</span>&nbsp;<span class="ident" id="1996456"><a href="/runtime/traceback.go.html#1996229">gp</a></span>&nbsp;<span class="op" id="1996459">&amp;&amp;</span>&nbsp;<span class="ident" id="1996462"><a href="/runtime/traceback.go.html#1996435">g</a></span>&nbsp;<span class="op" id="1996464">==</span>&nbsp;<span class="ident" id="1996467"><a href="/runtime/traceback.go.html#1996435">g</a></span><span class="op" id="1996468">.</span><span class="ident" id="1996469">m</span><span class="op" id="1996470">.</span><span class="ident" id="1996471">curg</span>&nbsp;<span class="op" id="1996476">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996480">//&nbsp;The&nbsp;starting&nbsp;sp&nbsp;has&nbsp;been&nbsp;passed&nbsp;in&nbsp;as&nbsp;a&nbsp;uintptr,&nbsp;and&nbsp;the&nbsp;caller&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996553">//&nbsp;have&nbsp;other&nbsp;uintptr-typed&nbsp;stack&nbsp;references&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996609">//&nbsp;If&nbsp;during&nbsp;one&nbsp;of&nbsp;the&nbsp;calls&nbsp;that&nbsp;got&nbsp;us&nbsp;here&nbsp;or&nbsp;during&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996679">//&nbsp;callbacks&nbsp;below&nbsp;the&nbsp;stack&nbsp;must&nbsp;be&nbsp;grown,&nbsp;all&nbsp;these&nbsp;uintptr&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996754">//&nbsp;to&nbsp;the&nbsp;stack&nbsp;will&nbsp;not&nbsp;be&nbsp;updated,&nbsp;and&nbsp;gentraceback&nbsp;will&nbsp;continue</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996824">//&nbsp;to&nbsp;inspect&nbsp;the&nbsp;old&nbsp;stack&nbsp;memory,&nbsp;which&nbsp;may&nbsp;no&nbsp;longer&nbsp;be&nbsp;valid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996892">//&nbsp;Even&nbsp;if&nbsp;all&nbsp;the&nbsp;variables&nbsp;were&nbsp;updated&nbsp;correctly,&nbsp;it&nbsp;is&nbsp;not&nbsp;clear&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996968">//&nbsp;we&nbsp;want&nbsp;to&nbsp;expose&nbsp;a&nbsp;traceback&nbsp;that&nbsp;begins&nbsp;on&nbsp;one&nbsp;stack&nbsp;and&nbsp;ends</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997037">//&nbsp;on&nbsp;another&nbsp;stack.&nbsp;That&nbsp;could&nbsp;confuse&nbsp;callers&nbsp;quite&nbsp;a&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997100">//&nbsp;Instead,&nbsp;we&nbsp;require&nbsp;that&nbsp;gentraceback&nbsp;and&nbsp;any&nbsp;other&nbsp;function&nbsp;that</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997171">//&nbsp;accepts&nbsp;an&nbsp;sp&nbsp;for&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;(typically&nbsp;obtained&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997239">//&nbsp;calling&nbsp;getcallersp)&nbsp;must&nbsp;not&nbsp;run&nbsp;on&nbsp;that&nbsp;goroutine&#39;s&nbsp;stack&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997308">//&nbsp;instead&nbsp;on&nbsp;the&nbsp;g0&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997338"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1997345">(</span><span class="string" id="1997346">&#34;gentraceback&nbsp;cannot&nbsp;trace&nbsp;user&nbsp;goroutine&nbsp;on&nbsp;its&nbsp;own&nbsp;stack&#34;</span><span class="op" id="1997405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997408">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997411">gotraceback</span>&nbsp;<span class="op" id="1997423">:=</span>&nbsp;<span class="ident" id="1997426"><a href="/runtime/stubs.go.html#1976669">gotraceback</a></span><span class="op" id="1997437">(</span><span class="ident" id="1997438">nil</span><span class="op" id="1997441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997444">if</span>&nbsp;<span class="ident" id="1997447"><a href="/runtime/traceback.go.html#1996190">pc0</a></span>&nbsp;<span class="op" id="1997451">==</span>&nbsp;<span class="op" id="1997454">^</span><span class="builtintype" id="1997455">uintptr</span><span class="op" id="1997462">(</span><span class="num" id="1997463">0</span><span class="op" id="1997464">)</span>&nbsp;<span class="op" id="1997466">&amp;&amp;</span>&nbsp;<span class="ident" id="1997469"><a href="/runtime/traceback.go.html#1996203">sp0</a></span>&nbsp;<span class="op" id="1997473">==</span>&nbsp;<span class="op" id="1997476">^</span><span class="builtintype" id="1997477">uintptr</span><span class="op" id="1997484">(</span><span class="num" id="1997485">0</span><span class="op" id="1997486">)</span>&nbsp;<span class="op" id="1997488">{</span>&nbsp;<span class="comment" id="1997490">//&nbsp;Signal&nbsp;to&nbsp;fetch&nbsp;saved&nbsp;values&nbsp;from&nbsp;gp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997533">if</span>&nbsp;<span class="ident" id="1997536"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997538">.</span><span class="ident" id="1997539">syscallsp</span>&nbsp;<span class="op" id="1997549">!=</span>&nbsp;<span class="num" id="1997552">0</span>&nbsp;<span class="op" id="1997554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997559"><a href="/runtime/traceback.go.html#1996190">pc0</a></span>&nbsp;<span class="op" id="1997563">=</span>&nbsp;<span class="ident" id="1997565"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997567">.</span><span class="ident" id="1997568">syscallpc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997581"><a href="/runtime/traceback.go.html#1996203">sp0</a></span>&nbsp;<span class="op" id="1997585">=</span>&nbsp;<span class="ident" id="1997587"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997589">.</span><span class="ident" id="1997590">syscallsp</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997603">if</span>&nbsp;<span class="ident" id="1997606"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1997613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997619"><a href="/runtime/traceback.go.html#1996216">lr0</a></span>&nbsp;<span class="op" id="1997623">=</span>&nbsp;<span class="num" id="1997625">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997634">}</span>&nbsp;<span class="keyword" id="1997636">else</span>&nbsp;<span class="op" id="1997641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997646"><a href="/runtime/traceback.go.html#1996190">pc0</a></span>&nbsp;<span class="op" id="1997650">=</span>&nbsp;<span class="ident" id="1997652"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997654">.</span><span class="ident" id="1997655">sched</span><span class="op" id="1997660">.</span><span class="ident" id="1997661">pc</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997667"><a href="/runtime/traceback.go.html#1996203">sp0</a></span>&nbsp;<span class="op" id="1997671">=</span>&nbsp;<span class="ident" id="1997673"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997675">.</span><span class="ident" id="1997676">sched</span><span class="op" id="1997681">.</span><span class="ident" id="1997682">sp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997688">if</span>&nbsp;<span class="ident" id="1997691"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1997698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997704"><a href="/runtime/traceback.go.html#1996216">lr0</a></span>&nbsp;<span class="op" id="1997708">=</span>&nbsp;<span class="ident" id="1997710"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997712">.</span><span class="ident" id="1997713">sched</span><span class="op" id="1997718">.</span><span class="ident" id="1997719">lr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997729">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997736">nprint</span>&nbsp;<span class="op" id="1997743">:=</span>&nbsp;<span class="num" id="1997746">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997749">var</span>&nbsp;<span class="ident" id="1997753">frame</span>&nbsp;<span class="ident" id="1997759"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997769"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1997774">.</span><span class="ident" id="1997775">pc</span>&nbsp;<span class="op" id="1997778">=</span>&nbsp;<span class="ident" id="1997780"><a href="/runtime/traceback.go.html#1996190">pc0</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997785"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1997790">.</span><span class="ident" id="1997791">sp</span>&nbsp;<span class="op" id="1997794">=</span>&nbsp;<span class="ident" id="1997796"><a href="/runtime/traceback.go.html#1996203">sp0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997801">if</span>&nbsp;<span class="ident" id="1997804"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1997811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997815"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1997820">.</span><span class="ident" id="1997821">lr</span>&nbsp;<span class="op" id="1997824">=</span>&nbsp;<span class="ident" id="1997826"><a href="/runtime/traceback.go.html#1996216">lr0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997834">waspanic</span>&nbsp;<span class="op" id="1997843">:=</span>&nbsp;<span class="ident" id="1997846">false</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997853">wasnewproc</span>&nbsp;<span class="op" id="1997864">:=</span>&nbsp;<span class="ident" id="1997867">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997874">printing</span>&nbsp;<span class="op" id="1997883">:=</span>&nbsp;<span class="ident" id="1997886"><a href="/runtime/traceback.go.html#1996246">pcbuf</a></span>&nbsp;<span class="op" id="1997892">==</span>&nbsp;<span class="ident" id="1997895">nil</span>&nbsp;<span class="op" id="1997899">&amp;&amp;</span>&nbsp;<span class="ident" id="1997902"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="1997911">==</span>&nbsp;<span class="ident" id="1997914">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997919">_defer</span>&nbsp;<span class="op" id="1997926">:=</span>&nbsp;<span class="ident" id="1997929"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="1997931">.</span><span class="ident" id="1997932">_defer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997941">for</span>&nbsp;<span class="ident" id="1997945"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="1997952">!=</span>&nbsp;<span class="ident" id="1997955">nil</span>&nbsp;<span class="op" id="1997959">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1997962">uintptr</span><span class="op" id="1997969">(</span><span class="ident" id="1997970"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="1997976">.</span><span class="ident" id="1997977">argp</span><span class="op" id="1997981">)</span>&nbsp;<span class="op" id="1997983">==</span>&nbsp;<span class="ident" id="1997986"><a href="/runtime/stubs.go.html#1976701">_NoArgs</a></span>&nbsp;<span class="op" id="1997994">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997998"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="1998005">=</span>&nbsp;<span class="ident" id="1998007"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="1998013">.</span><span class="ident" id="1998014">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998024">//&nbsp;If&nbsp;the&nbsp;PC&nbsp;is&nbsp;zero,&nbsp;it&#39;s&nbsp;likely&nbsp;a&nbsp;nil&nbsp;function&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998080">//&nbsp;Start&nbsp;in&nbsp;the&nbsp;caller&#39;s&nbsp;frame.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998113">if</span>&nbsp;<span class="ident" id="1998116"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998121">.</span><span class="ident" id="1998122">pc</span>&nbsp;<span class="op" id="1998125">==</span>&nbsp;<span class="num" id="1998128">0</span>&nbsp;<span class="op" id="1998130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998134">if</span>&nbsp;<span class="ident" id="1998137"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1998144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998149"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998154">.</span><span class="ident" id="1998155">pc</span>&nbsp;<span class="op" id="1998158">=</span>&nbsp;<span class="op" id="1998160">*</span><span class="op" id="1998161">(</span><span class="op" id="1998162">*</span><span class="builtintype" id="1998163">uintptr</span><span class="op" id="1998170">)</span><span class="op" id="1998171">(</span><span class="ident" id="1998172"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1998178">.</span><span class="ident" id="1998179">Pointer</span><span class="op" id="1998186">(</span><span class="ident" id="1998187"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998192">.</span><span class="ident" id="1998193">sp</span><span class="op" id="1998195">)</span><span class="op" id="1998196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998201"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998206">.</span><span class="ident" id="1998207">lr</span>&nbsp;<span class="op" id="1998210">=</span>&nbsp;<span class="num" id="1998212">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998216">}</span>&nbsp;<span class="keyword" id="1998218">else</span>&nbsp;<span class="op" id="1998223">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998228"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998233">.</span><span class="ident" id="1998234">pc</span>&nbsp;<span class="op" id="1998237">=</span>&nbsp;<span class="builtintype" id="1998239">uintptr</span><span class="op" id="1998246">(</span><span class="op" id="1998247">*</span><span class="op" id="1998248">(</span><span class="op" id="1998249">*</span><span class="ident" id="1998250"><a href="/runtime/arch_amd64.go.html#1710630">uintreg</a></span><span class="op" id="1998257">)</span><span class="op" id="1998258">(</span><span class="ident" id="1998259"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1998265">.</span><span class="ident" id="1998266">Pointer</span><span class="op" id="1998273">(</span><span class="ident" id="1998274"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998279">.</span><span class="ident" id="1998280">sp</span><span class="op" id="1998282">)</span><span class="op" id="1998283">)</span><span class="op" id="1998284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998289"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998294">.</span><span class="ident" id="1998295">sp</span>&nbsp;<span class="op" id="1998298">+=</span>&nbsp;<span class="ident" id="1998301"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998318">f</span>&nbsp;<span class="op" id="1998320">:=</span>&nbsp;<span class="ident" id="1998323"><a href="/runtime/symtab.go.html#1982993">findfunc</a></span><span class="op" id="1998331">(</span><span class="ident" id="1998332"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998337">.</span><span class="ident" id="1998338">pc</span><span class="op" id="1998340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998343">if</span>&nbsp;<span class="ident" id="1998346"><a href="/runtime/traceback.go.html#1998318">f</a></span>&nbsp;<span class="op" id="1998348">==</span>&nbsp;<span class="ident" id="1998351">nil</span>&nbsp;<span class="op" id="1998355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998359">if</span>&nbsp;<span class="ident" id="1998362"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="1998371">!=</span>&nbsp;<span class="ident" id="1998374">nil</span>&nbsp;<span class="op" id="1998378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1998383">print</span><span class="op" id="1998388">(</span><span class="string" id="1998389">&#34;runtime:&nbsp;unknown&nbsp;pc&nbsp;&#34;</span><span class="op" id="1998411">,</span>&nbsp;<span class="ident" id="1998413"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="1998416">(</span><span class="ident" id="1998417"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998422">.</span><span class="ident" id="1998423">pc</span><span class="op" id="1998425">)</span><span class="op" id="1998426">,</span>&nbsp;<span class="string" id="1998428">&#34;\n&#34;</span><span class="op" id="1998432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998437"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1998444">(</span><span class="string" id="1998445">&#34;unknown&nbsp;pc&#34;</span><span class="op" id="1998457">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998465">return</span>&nbsp;<span class="num" id="1998472">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998478"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998483">.</span><span class="ident" id="1998484">fn</span>&nbsp;<span class="op" id="1998487">=</span>&nbsp;<span class="ident" id="1998489"><a href="/runtime/traceback.go.html#1998318">f</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998493">n</span>&nbsp;<span class="op" id="1998495">:=</span>&nbsp;<span class="num" id="1998498">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998501">for</span>&nbsp;<span class="ident" id="1998505"><a href="/runtime/traceback.go.html#1998493">n</a></span>&nbsp;<span class="op" id="1998507">&lt;</span>&nbsp;<span class="ident" id="1998509"><a href="/runtime/traceback.go.html#1996262">max</a></span>&nbsp;<span class="op" id="1998513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998517">//&nbsp;Typically:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998533">//&nbsp;&nbsp;&nbsp;&nbsppc&nbsp;is&nbsp;the&nbsp;PC&nbsp;of&nbsp;the&nbsp;running&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998576">//&nbsp;&nbsp;&nbsp;&nbspsp&nbsp;is&nbsp;the&nbsp;stack&nbsp;pointer&nbsp;at&nbsp;that&nbsp;program&nbsp;counter.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998630">//&nbsp;&nbsp;&nbsp;&nbspfp&nbsp;is&nbsp;the&nbsp;frame&nbsp;pointer&nbsp;(caller&#39;s&nbsp;stack&nbsp;pointer)&nbsp;at&nbsp;that&nbsp;program&nbsp;counter,&nbsp;or&nbsp;nil&nbsp;if&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998728">//&nbsp;&nbsp;&nbsp;&nbspstk&nbsp;is&nbsp;the&nbsp;stack&nbsp;containing&nbsp;sp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998765">//&nbsp;&nbsp;&nbsp;&nbspThe&nbsp;caller&#39;s&nbsp;program&nbsp;counter&nbsp;is&nbsp;lr,&nbsp;unless&nbsp;lr&nbsp;is&nbsp;zero,&nbsp;in&nbsp;which&nbsp;case&nbsp;it&nbsp;is&nbsp;*(uintptr*)sp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998860"><a href="/runtime/traceback.go.html#1998318">f</a></span>&nbsp;<span class="op" id="1998862">=</span>&nbsp;<span class="ident" id="1998864"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998869">.</span><span class="ident" id="1998870">fn</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998876">//&nbsp;Found&nbsp;an&nbsp;actual&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998907">//&nbsp;Derive&nbsp;frame&nbsp;pointer&nbsp;and&nbsp;link&nbsp;register.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998952">if</span>&nbsp;<span class="ident" id="1998955"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998960">.</span><span class="ident" id="1998961">fp</span>&nbsp;<span class="op" id="1998964">==</span>&nbsp;<span class="num" id="1998967">0</span>&nbsp;<span class="op" id="1998969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998974"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998979">.</span><span class="ident" id="1998980">fp</span>&nbsp;<span class="op" id="1998983">=</span>&nbsp;<span class="ident" id="1998985"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1998990">.</span><span class="ident" id="1998991">sp</span>&nbsp;<span class="op" id="1998994">+</span>&nbsp;<span class="builtintype" id="1998996">uintptr</span><span class="op" id="1999003">(</span><span class="ident" id="1999004"><a href="/runtime/symtab.go.html#1985126">funcspdelta</a></span><span class="op" id="1999015">(</span><span class="ident" id="1999016"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="1999017">,</span>&nbsp;<span class="ident" id="1999019"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999024">.</span><span class="ident" id="1999025">pc</span><span class="op" id="1999027">)</span><span class="op" id="1999028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999033">if</span>&nbsp;<span class="op" id="1999036">!</span><span class="ident" id="1999037"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1999044">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999050">//&nbsp;On&nbsp;x86,&nbsp;call&nbsp;instruction&nbsp;pushes&nbsp;return&nbsp;PC&nbsp;before&nbsp;entering&nbsp;new&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999129"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999134">.</span><span class="ident" id="1999135">fp</span>&nbsp;<span class="op" id="1999138">+=</span>&nbsp;<span class="ident" id="1999141"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999160">var</span>&nbsp;<span class="ident" id="1999164">flr</span>&nbsp;<span class="op" id="1999168">*</span><span class="ident" id="1999169"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2019504">_func</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999177">if</span>&nbsp;<span class="ident" id="1999180"><a href="/runtime/traceback.go.html#2013890">topofstack</a></span><span class="op" id="1999190">(</span><span class="ident" id="1999191"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="1999192">)</span>&nbsp;<span class="op" id="1999194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999199"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999204">.</span><span class="ident" id="1999205">lr</span>&nbsp;<span class="op" id="1999208">=</span>&nbsp;<span class="num" id="1999210">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999215"><a href="/runtime/traceback.go.html#1999164">flr</a></span>&nbsp;<span class="op" id="1999219">=</span>&nbsp;<span class="ident" id="1999221">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999227">}</span>&nbsp;<span class="keyword" id="1999229">else</span>&nbsp;<span class="keyword" id="1999234">if</span>&nbsp;<span class="ident" id="1999237"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1999244">&amp;&amp;</span>&nbsp;<span class="ident" id="1999247"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="1999248">.</span><span class="ident" id="1999249">entry</span>&nbsp;<span class="op" id="1999255">==</span>&nbsp;<span class="ident" id="1999258"><a href="/runtime/traceback.go.html#1994314">jmpdeferPC</a></span>&nbsp;<span class="op" id="1999269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999274">//&nbsp;jmpdefer&nbsp;modifies&nbsp;SP/LR/PC&nbsp;non-atomically.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999323">//&nbsp;If&nbsp;a&nbsp;profiling&nbsp;interrupt&nbsp;arrives&nbsp;during&nbsp;jmpdefer,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999379">//&nbsp;the&nbsp;stack&nbsp;unwind&nbsp;may&nbsp;see&nbsp;a&nbsp;mismatched&nbsp;register&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999436">//&nbsp;and&nbsp;get&nbsp;confused.&nbsp;Stop&nbsp;if&nbsp;we&nbsp;see&nbsp;PC&nbsp;within&nbsp;jmpdefer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999494">//&nbsp;to&nbsp;avoid&nbsp;that&nbsp;confusion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999525">//&nbsp;See&nbsp;golang.org/issue/8153.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999558">if</span>&nbsp;<span class="ident" id="1999561"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="1999570">!=</span>&nbsp;<span class="ident" id="1999573">nil</span>&nbsp;<span class="op" id="1999577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999583"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1999590">(</span><span class="string" id="1999591">&#34;traceback_arm:&nbsp;found&nbsp;jmpdefer&nbsp;when&nbsp;tracing&nbsp;with&nbsp;callback&#34;</span><span class="op" id="1999649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999659"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999664">.</span><span class="ident" id="1999665">lr</span>&nbsp;<span class="op" id="1999668">=</span>&nbsp;<span class="num" id="1999670">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999674">}</span>&nbsp;<span class="keyword" id="1999676">else</span>&nbsp;<span class="op" id="1999681">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999686">if</span>&nbsp;<span class="ident" id="1999689"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="1999696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999702">if</span>&nbsp;<span class="ident" id="1999705"><a href="/runtime/traceback.go.html#1998493">n</a></span>&nbsp;<span class="op" id="1999707">==</span>&nbsp;<span class="num" id="1999710">0</span>&nbsp;<span class="op" id="1999712">&amp;&amp;</span>&nbsp;<span class="ident" id="1999715"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999720">.</span><span class="ident" id="1999721">sp</span>&nbsp;<span class="op" id="1999724">&lt;</span>&nbsp;<span class="ident" id="1999726"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999731">.</span><span class="ident" id="1999732">fp</span>&nbsp;<span class="op" id="1999735">||</span>&nbsp;<span class="ident" id="1999738"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999743">.</span><span class="ident" id="1999744">lr</span>&nbsp;<span class="op" id="1999747">==</span>&nbsp;<span class="num" id="1999750">0</span>&nbsp;<span class="op" id="1999752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999759"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999764">.</span><span class="ident" id="1999765">lr</span>&nbsp;<span class="op" id="1999768">=</span>&nbsp;<span class="op" id="1999770">*</span><span class="op" id="1999771">(</span><span class="op" id="1999772">*</span><span class="builtintype" id="1999773">uintptr</span><span class="op" id="1999780">)</span><span class="op" id="1999781">(</span><span class="ident" id="1999782"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1999788">.</span><span class="ident" id="1999789">Pointer</span><span class="op" id="1999796">(</span><span class="ident" id="1999797"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999802">.</span><span class="ident" id="1999803">sp</span><span class="op" id="1999805">)</span><span class="op" id="1999806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999817">}</span>&nbsp;<span class="keyword" id="1999819">else</span>&nbsp;<span class="op" id="1999824">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999830">if</span>&nbsp;<span class="ident" id="1999833"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999838">.</span><span class="ident" id="1999839">lr</span>&nbsp;<span class="op" id="1999842">==</span>&nbsp;<span class="num" id="1999845">0</span>&nbsp;<span class="op" id="1999847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999854"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999859">.</span><span class="ident" id="1999860">lr</span>&nbsp;<span class="op" id="1999863">=</span>&nbsp;<span class="builtintype" id="1999865">uintptr</span><span class="op" id="1999872">(</span><span class="op" id="1999873">*</span><span class="op" id="1999874">(</span><span class="op" id="1999875">*</span><span class="ident" id="1999876"><a href="/runtime/arch_amd64.go.html#1710630">uintreg</a></span><span class="op" id="1999883">)</span><span class="op" id="1999884">(</span><span class="ident" id="1999885"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="1999891">.</span><span class="ident" id="1999892">Pointer</span><span class="op" id="1999899">(</span><span class="ident" id="1999900"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999905">.</span><span class="ident" id="1999906">fp</span>&nbsp;<span class="op" id="1999909">-</span>&nbsp;<span class="ident" id="1999911"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><span class="op" id="1999918">)</span><span class="op" id="1999919">)</span><span class="op" id="1999920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999936"><a href="/runtime/traceback.go.html#1999164">flr</a></span>&nbsp;<span class="op" id="1999940">=</span>&nbsp;<span class="ident" id="1999942"><a href="/runtime/symtab.go.html#1982993">findfunc</a></span><span class="op" id="1999950">(</span><span class="ident" id="1999951"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="1999956">.</span><span class="ident" id="1999957">lr</span><span class="op" id="1999959">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999964">if</span>&nbsp;<span class="ident" id="1999967"><a href="/runtime/traceback.go.html#1999164">flr</a></span>&nbsp;<span class="op" id="1999971">==</span>&nbsp;<span class="ident" id="1999974">nil</span>&nbsp;<span class="op" id="1999978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999984">//&nbsp;This&nbsp;happens&nbsp;if&nbsp;you&nbsp;get&nbsp;a&nbsp;profiling&nbsp;interrupt&nbsp;at&nbsp;just&nbsp;the&nbsp;wrong&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000061">//&nbsp;In&nbsp;that&nbsp;context&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000110">//&nbsp;But&nbsp;if&nbsp;callback&nbsp;is&nbsp;set,&nbsp;we&#39;re&nbsp;doing&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;and&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000183">//&nbsp;get&nbsp;everything,&nbsp;so&nbsp;crash&nbsp;loudly.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000223">if</span>&nbsp;<span class="ident" id="2000226"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2000235">!=</span>&nbsp;<span class="ident" id="2000238">nil</span>&nbsp;<span class="op" id="2000242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2000249">print</span><span class="op" id="2000254">(</span><span class="string" id="2000255">&#34;runtime:&nbsp;unexpected&nbsp;return&nbsp;pc&nbsp;for&nbsp;&#34;</span><span class="op" id="2000291">,</span>&nbsp;<span class="ident" id="2000293"><a href="/runtime/symtab.go.html#1984497">gofuncname</a></span><span class="op" id="2000303">(</span><span class="ident" id="2000304"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2000305">)</span><span class="op" id="2000306">,</span>&nbsp;<span class="string" id="2000308">&#34;&nbsp;called&nbsp;from&nbsp;&#34;</span><span class="op" id="2000323">,</span>&nbsp;<span class="ident" id="2000325"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2000328">(</span><span class="ident" id="2000329"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000334">.</span><span class="ident" id="2000335">lr</span><span class="op" id="2000337">)</span><span class="op" id="2000338">,</span>&nbsp;<span class="string" id="2000340">&#34;\n&#34;</span><span class="op" id="2000344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000351"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="2000358">(</span><span class="string" id="2000359">&#34;unknown&nbsp;caller&nbsp;pc&#34;</span><span class="op" id="2000378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000389">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000398"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000403">.</span><span class="ident" id="2000404">varp</span>&nbsp;<span class="op" id="2000409">=</span>&nbsp;<span class="ident" id="2000411"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000416">.</span><span class="ident" id="2000417">fp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000422">if</span>&nbsp;<span class="op" id="2000425">!</span><span class="ident" id="2000426"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="2000433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000438">//&nbsp;On&nbsp;x86,&nbsp;call&nbsp;instruction&nbsp;pushes&nbsp;return&nbsp;PC&nbsp;before&nbsp;entering&nbsp;new&nbsp;function.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000516"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000521">.</span><span class="ident" id="2000522">varp</span>&nbsp;<span class="op" id="2000527">-=</span>&nbsp;<span class="ident" id="2000530"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000545">//&nbsp;Derive&nbsp;size&nbsp;of&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000576">//&nbsp;Most&nbsp;functions&nbsp;have&nbsp;a&nbsp;fixed-size&nbsp;argument&nbsp;block,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000630">//&nbsp;so&nbsp;we&nbsp;can&nbsp;use&nbsp;metadata&nbsp;about&nbsp;the&nbsp;function&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000680">//&nbsp;Not&nbsp;all,&nbsp;though:&nbsp;there&nbsp;are&nbsp;some&nbsp;variadic&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000736">//&nbsp;in&nbsp;package&nbsp;runtime&nbsp;and&nbsp;reflect,&nbsp;and&nbsp;for&nbsp;those&nbsp;we&nbsp;use&nbsp;call-specific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000808">//&nbsp;metadata&nbsp;recorded&nbsp;by&nbsp;f&#39;s&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000846">if</span>&nbsp;<span class="ident" id="2000849"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2000858">!=</span>&nbsp;<span class="ident" id="2000861">nil</span>&nbsp;<span class="op" id="2000865">||</span>&nbsp;<span class="ident" id="2000868"><a href="/runtime/traceback.go.html#1997874">printing</a></span>&nbsp;<span class="op" id="2000877">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000882"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000887">.</span><span class="ident" id="2000888">argp</span>&nbsp;<span class="op" id="2000893">=</span>&nbsp;<span class="ident" id="2000895"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000900">.</span><span class="ident" id="2000901">fp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000907">if</span>&nbsp;<span class="ident" id="2000910"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="2000917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000923"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000928">.</span><span class="ident" id="2000929">argp</span>&nbsp;<span class="op" id="2000934">+=</span>&nbsp;<span class="ident" id="2000937"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000953"><a href="/runtime/traceback.go.html#2008083">setArgInfo</a></span><span class="op" id="2000963">(</span><span class="op" id="2000964">&amp;</span><span class="ident" id="2000965"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2000970">,</span>&nbsp;<span class="ident" id="2000972"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2000973">,</span>&nbsp;<span class="ident" id="2000975"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2000984">!=</span>&nbsp;<span class="ident" id="2000987">nil</span><span class="op" id="2000990">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000999">//&nbsp;Determine&nbsp;function&nbsp;SP&nbsp;where&nbsp;deferproc&nbsp;would&nbsp;find&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001068">var</span>&nbsp;<span class="ident" id="2001072">sparg</span>&nbsp;<span class="builtintype" id="2001078">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001088">if</span>&nbsp;<span class="ident" id="2001091"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="2001098">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001103">//&nbsp;On&nbsp;link&nbsp;register&nbsp;architectures,&nbsp;that&#39;s&nbsp;the&nbsp;standard&nbsp;bottom-of-stack&nbsp;plus&nbsp;1&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001189">//&nbsp;for&nbsp;the&nbsp;saved&nbsp;LR.&nbsp;If&nbsp;the&nbsp;previous&nbsp;frame&nbsp;was&nbsp;a&nbsp;direct&nbsp;call&nbsp;to&nbsp;newproc/deferproc,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001275">//&nbsp;however,&nbsp;the&nbsp;SP&nbsp;is&nbsp;three&nbsp;words&nbsp;lower&nbsp;than&nbsp;normal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001331">//&nbsp;If&nbsp;the&nbsp;function&nbsp;has&nbsp;no&nbsp;frame&nbsp;at&nbsp;all&nbsp;-&nbsp;perhaps&nbsp;it&nbsp;just&nbsp;started,&nbsp;or&nbsp;perhaps</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001411">//&nbsp;it&nbsp;is&nbsp;a&nbsp;leaf&nbsp;with&nbsp;no&nbsp;local&nbsp;variables&nbsp;-&nbsp;then&nbsp;we&nbsp;cannot&nbsp;possibly&nbsp;find&nbsp;its</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001489">//&nbsp;SP&nbsp;in&nbsp;a&nbsp;defer,&nbsp;and&nbsp;we&nbsp;might&nbsp;confuse&nbsp;its&nbsp;SP&nbsp;for&nbsp;its&nbsp;caller&#39;s&nbsp;SP,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001562">//&nbsp;leave&nbsp;sparg=0&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001596">if</span>&nbsp;<span class="ident" id="2001599"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2001604">.</span><span class="ident" id="2001605">fp</span>&nbsp;<span class="op" id="2001608">!=</span>&nbsp;<span class="ident" id="2001611"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2001616">.</span><span class="ident" id="2001617">sp</span>&nbsp;<span class="op" id="2001620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001626"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2001632">=</span>&nbsp;<span class="ident" id="2001634"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2001639">.</span><span class="ident" id="2001640">sp</span>&nbsp;<span class="op" id="2001643">+</span>&nbsp;<span class="ident" id="2001645"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001657">if</span>&nbsp;<span class="ident" id="2001660"><a href="/runtime/traceback.go.html#1997853">wasnewproc</a></span>&nbsp;<span class="op" id="2001671">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001678"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2001684">+=</span>&nbsp;<span class="num" id="2001687">3</span>&nbsp;<span class="op" id="2001689">*</span>&nbsp;<span class="ident" id="2001691"><a href="/runtime/stubs.go.html#1968464">regSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001712">}</span>&nbsp;<span class="keyword" id="2001714">else</span>&nbsp;<span class="op" id="2001719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001724">//&nbsp;On&nbsp;x86&nbsp;that&#39;s&nbsp;the&nbsp;standard&nbsp;bottom-of-stack,&nbsp;so&nbsp;SP&nbsp;exactly.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001789">//&nbsp;If&nbsp;the&nbsp;previous&nbsp;frame&nbsp;was&nbsp;a&nbsp;direct&nbsp;call&nbsp;to&nbsp;newproc/deferproc,&nbsp;however,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001866">//&nbsp;the&nbsp;SP&nbsp;is&nbsp;two&nbsp;words&nbsp;lower&nbsp;than&nbsp;normal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001911"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2001917">=</span>&nbsp;<span class="ident" id="2001919"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2001924">.</span><span class="ident" id="2001925">sp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001931">if</span>&nbsp;<span class="ident" id="2001934"><a href="/runtime/traceback.go.html#1997853">wasnewproc</a></span>&nbsp;<span class="op" id="2001945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001951"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2001957">+=</span>&nbsp;<span class="num" id="2001960">2</span>&nbsp;<span class="op" id="2001962">*</span>&nbsp;<span class="ident" id="2001964"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001984">//&nbsp;Determine&nbsp;frame&#39;s&nbsp;&#39;continuation&nbsp;PC&#39;,&nbsp;where&nbsp;it&nbsp;can&nbsp;continue.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002049">//&nbsp;Normally&nbsp;this&nbsp;is&nbsp;the&nbsp;return&nbsp;address&nbsp;on&nbsp;the&nbsp;stack,&nbsp;but&nbsp;if&nbsp;sigpanic</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002120">//&nbsp;is&nbsp;immediately&nbsp;below&nbsp;this&nbsp;function&nbsp;on&nbsp;the&nbsp;stack,&nbsp;then&nbsp;the&nbsp;frame</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002189">//&nbsp;stopped&nbsp;executing&nbsp;due&nbsp;to&nbsp;a&nbsp;trap,&nbsp;and&nbsp;frame.pc&nbsp;is&nbsp;probably&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002256">//&nbsp;a&nbsp;safe&nbsp;point&nbsp;for&nbsp;looking&nbsp;up&nbsp;liveness&nbsp;information.&nbsp;In&nbsp;this&nbsp;panicking&nbsp;case,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002335">//&nbsp;the&nbsp;function&nbsp;either&nbsp;doesn&#39;t&nbsp;return&nbsp;at&nbsp;all&nbsp;(if&nbsp;it&nbsp;has&nbsp;no&nbsp;defers&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002413">//&nbsp;defers&nbsp;do&nbsp;not&nbsp;recover)&nbsp;or&nbsp;it&nbsp;returns&nbsp;from&nbsp;one&nbsp;of&nbsp;the&nbsp;calls&nbsp;to</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002480">//&nbsp;deferproc&nbsp;a&nbsp;second&nbsp;time&nbsp;(if&nbsp;the&nbsp;corresponding&nbsp;deferred&nbsp;func&nbsp;recovers).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002556">//&nbsp;It&nbsp;suffices&nbsp;to&nbsp;assume&nbsp;that&nbsp;the&nbsp;most&nbsp;recent&nbsp;deferproc&nbsp;is&nbsp;the&nbsp;one&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002630">//&nbsp;returns;&nbsp;everything&nbsp;live&nbsp;at&nbsp;earlier&nbsp;deferprocs&nbsp;is&nbsp;still&nbsp;live&nbsp;at&nbsp;that&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002709"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2002714">.</span><span class="ident" id="2002715">continpc</span>&nbsp;<span class="op" id="2002724">=</span>&nbsp;<span class="ident" id="2002726"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2002731">.</span><span class="ident" id="2002732">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002737">if</span>&nbsp;<span class="ident" id="2002740"><a href="/runtime/traceback.go.html#1997834">waspanic</a></span>&nbsp;<span class="op" id="2002749">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002754">if</span>&nbsp;<span class="ident" id="2002757"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2002764">!=</span>&nbsp;<span class="ident" id="2002767">nil</span>&nbsp;<span class="op" id="2002771">&amp;&amp;</span>&nbsp;<span class="ident" id="2002774"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2002780">.</span><span class="ident" id="2002781">argp</span>&nbsp;<span class="op" id="2002786">==</span>&nbsp;<span class="ident" id="2002789"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2002795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002801"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2002806">.</span><span class="ident" id="2002807">continpc</span>&nbsp;<span class="op" id="2002816">=</span>&nbsp;<span class="ident" id="2002818"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2002824">.</span><span class="ident" id="2002825">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002831">}</span>&nbsp;<span class="keyword" id="2002833">else</span>&nbsp;<span class="op" id="2002838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002844"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2002849">.</span><span class="ident" id="2002850">continpc</span>&nbsp;<span class="op" id="2002859">=</span>&nbsp;<span class="num" id="2002861">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002866">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002875">//&nbsp;Unwind&nbsp;our&nbsp;local&nbsp;defer&nbsp;stack&nbsp;past&nbsp;this&nbsp;frame.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002926">for</span>&nbsp;<span class="ident" id="2002930"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2002937">!=</span>&nbsp;<span class="ident" id="2002940">nil</span>&nbsp;<span class="op" id="2002944">&amp;&amp;</span>&nbsp;<span class="op" id="2002947">(</span><span class="ident" id="2002948"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2002954">.</span><span class="ident" id="2002955">argp</span>&nbsp;<span class="op" id="2002960">==</span>&nbsp;<span class="ident" id="2002963"><a href="/runtime/traceback.go.html#2001072">sparg</a></span>&nbsp;<span class="op" id="2002969">||</span>&nbsp;<span class="ident" id="2002972"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2002978">.</span><span class="ident" id="2002979">argp</span>&nbsp;<span class="op" id="2002984">==</span>&nbsp;<span class="ident" id="2002987"><a href="/runtime/stubs.go.html#1976701">_NoArgs</a></span><span class="op" id="2002994">)</span>&nbsp;<span class="op" id="2002996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003001"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2003008">=</span>&nbsp;<span class="ident" id="2003010"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2003016">.</span><span class="ident" id="2003017">link</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003029">if</span>&nbsp;<span class="ident" id="2003032"><a href="/runtime/traceback.go.html#1996236">skip</a></span>&nbsp;<span class="op" id="2003037">&gt;</span>&nbsp;<span class="num" id="2003039">0</span>&nbsp;<span class="op" id="2003041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003046"><a href="/runtime/traceback.go.html#1996236">skip</a></span><span class="op" id="2003050">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003056">goto</span>&nbsp;<span class="ident" id="2003061">skipped</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003076">if</span>&nbsp;<span class="ident" id="2003079"><a href="/runtime/traceback.go.html#1996246">pcbuf</a></span>&nbsp;<span class="op" id="2003085">!=</span>&nbsp;<span class="ident" id="2003088">nil</span>&nbsp;<span class="op" id="2003092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003097">(</span><span class="op" id="2003098">*</span><span class="op" id="2003099">[</span><span class="num" id="2003100">1</span>&nbsp;<span class="op" id="2003102">&lt;&lt;</span>&nbsp;<span class="num" id="2003105">20</span><span class="op" id="2003107">]</span><span class="builtintype" id="2003108">uintptr</span><span class="op" id="2003115">)</span><span class="op" id="2003116">(</span><span class="ident" id="2003117"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2003123">.</span><span class="ident" id="2003124">Pointer</span><span class="op" id="2003131">(</span><span class="ident" id="2003132"><a href="/runtime/traceback.go.html#1996246">pcbuf</a></span><span class="op" id="2003137">)</span><span class="op" id="2003138">)</span><span class="op" id="2003139">[</span><span class="ident" id="2003140"><a href="/runtime/traceback.go.html#1998493">n</a></span><span class="op" id="2003141">]</span>&nbsp;<span class="op" id="2003143">=</span>&nbsp;<span class="ident" id="2003145"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003150">.</span><span class="ident" id="2003151">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003156">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003160">if</span>&nbsp;<span class="ident" id="2003163"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2003172">!=</span>&nbsp;<span class="ident" id="2003175">nil</span>&nbsp;<span class="op" id="2003179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003184">if</span>&nbsp;<span class="op" id="2003187">!</span><span class="ident" id="2003188"><a href="/runtime/traceback.go.html#1996271">callback</a></span><span class="op" id="2003196">(</span><span class="op" id="2003197">(</span><span class="op" id="2003198">*</span><span class="ident" id="2003199"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><span class="op" id="2003207">)</span><span class="op" id="2003208">(</span><span class="ident" id="2003209"><a href="/runtime/stubs.go.html#1973287">noescape</a></span><span class="op" id="2003217">(</span><span class="ident" id="2003218"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2003224">.</span><span class="ident" id="2003225">Pointer</span><span class="op" id="2003232">(</span><span class="op" id="2003233">&amp;</span><span class="ident" id="2003234"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003239">)</span><span class="op" id="2003240">)</span><span class="op" id="2003241">)</span><span class="op" id="2003242">,</span>&nbsp;<span class="ident" id="2003244"><a href="/runtime/traceback.go.html#1996318">v</a></span><span class="op" id="2003245">)</span>&nbsp;<span class="op" id="2003247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003253">return</span>&nbsp;<span class="ident" id="2003260"><a href="/runtime/traceback.go.html#1998493">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003269">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003273">if</span>&nbsp;<span class="ident" id="2003276"><a href="/runtime/traceback.go.html#1997874">printing</a></span>&nbsp;<span class="op" id="2003285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003290">if</span>&nbsp;<span class="op" id="2003293">(</span><span class="ident" id="2003294"><a href="/runtime/traceback.go.html#1996336">flags</a></span><span class="op" id="2003299">&amp;</span><span class="ident" id="2003300"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021059">_TraceRuntimeFrames</a></span><span class="op" id="2003319">)</span>&nbsp;<span class="op" id="2003321">!=</span>&nbsp;<span class="num" id="2003324">0</span>&nbsp;<span class="op" id="2003326">||</span>&nbsp;<span class="ident" id="2003329"><a href="/runtime/traceback.go.html#2010959">showframe</a></span><span class="op" id="2003338">(</span><span class="ident" id="2003339"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2003340">,</span>&nbsp;<span class="ident" id="2003342"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="2003344">)</span>&nbsp;<span class="op" id="2003346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2003352">//&nbsp;Print&nbsp;during&nbsp;crash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2003379">//&nbsp;&nbsp;&nbsp;&nbspmain(0x1,&nbsp;0x2,&nbsp;0x3)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2003406">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/home/rsc/go/src/runtime/x.go:23&nbsp;+0xf</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2003452">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003459">tracepc</span>&nbsp;<span class="op" id="2003467">:=</span>&nbsp;<span class="ident" id="2003470"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003475">.</span><span class="ident" id="2003476">pc</span>&nbsp;<span class="comment" id="2003479">//&nbsp;back&nbsp;up&nbsp;to&nbsp;CALL&nbsp;instruction&nbsp;for&nbsp;funcline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003528">if</span>&nbsp;<span class="op" id="2003531">(</span><span class="ident" id="2003532"><a href="/runtime/traceback.go.html#1998493">n</a></span>&nbsp;<span class="op" id="2003534">&gt;</span>&nbsp;<span class="num" id="2003536">0</span>&nbsp;<span class="op" id="2003538">||</span>&nbsp;<span class="ident" id="2003541"><a href="/runtime/traceback.go.html#1996336">flags</a></span><span class="op" id="2003546">&amp;</span><span class="ident" id="2003547"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021089">_TraceTrap</a></span>&nbsp;<span class="op" id="2003558">==</span>&nbsp;<span class="num" id="2003561">0</span><span class="op" id="2003562">)</span>&nbsp;<span class="op" id="2003564">&amp;&amp;</span>&nbsp;<span class="ident" id="2003567"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003572">.</span><span class="ident" id="2003573">pc</span>&nbsp;<span class="op" id="2003576">&gt;</span>&nbsp;<span class="ident" id="2003578"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2003579">.</span><span class="ident" id="2003580">entry</span>&nbsp;<span class="op" id="2003586">&amp;&amp;</span>&nbsp;<span class="op" id="2003589">!</span><span class="ident" id="2003590"><a href="/runtime/traceback.go.html#1997834">waspanic</a></span>&nbsp;<span class="op" id="2003599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003606"><a href="/runtime/traceback.go.html#2003459">tracepc</a></span><span class="op" id="2003613">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003620">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003626">print</span><span class="op" id="2003631">(</span><span class="ident" id="2003632"><a href="/runtime/symtab.go.html#1984497">gofuncname</a></span><span class="op" id="2003642">(</span><span class="ident" id="2003643"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2003644">)</span><span class="op" id="2003645">,</span>&nbsp;<span class="string" id="2003647">&#34;(&#34;</span><span class="op" id="2003650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003656">argp</span>&nbsp;<span class="op" id="2003661">:=</span>&nbsp;<span class="op" id="2003664">(</span><span class="op" id="2003665">*</span><span class="op" id="2003666">[</span><span class="num" id="2003667">100</span><span class="op" id="2003670">]</span><span class="builtintype" id="2003671">uintptr</span><span class="op" id="2003678">)</span><span class="op" id="2003679">(</span><span class="ident" id="2003680"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2003686">.</span><span class="ident" id="2003687">Pointer</span><span class="op" id="2003694">(</span><span class="ident" id="2003695"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003700">.</span><span class="ident" id="2003701">argp</span><span class="op" id="2003705">)</span><span class="op" id="2003706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003712">for</span>&nbsp;<span class="ident" id="2003716">i</span>&nbsp;<span class="op" id="2003718">:=</span>&nbsp;<span class="builtintype" id="2003721">uintptr</span><span class="op" id="2003728">(</span><span class="num" id="2003729">0</span><span class="op" id="2003730">)</span><span class="op" id="2003731">;</span>&nbsp;<span class="ident" id="2003733"><a href="/runtime/traceback.go.html#2003716">i</a></span>&nbsp;<span class="op" id="2003735">&lt;</span>&nbsp;<span class="ident" id="2003737"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2003742">.</span><span class="ident" id="2003743">arglen</span><span class="op" id="2003749">/</span><span class="ident" id="2003750"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="2003757">;</span>&nbsp;<span class="ident" id="2003759"><a href="/runtime/traceback.go.html#2003716">i</a></span><span class="op" id="2003760">++</span>&nbsp;<span class="op" id="2003763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003770">if</span>&nbsp;<span class="ident" id="2003773"><a href="/runtime/traceback.go.html#2003716">i</a></span>&nbsp;<span class="op" id="2003775">&gt;=</span>&nbsp;<span class="num" id="2003778">10</span>&nbsp;<span class="op" id="2003781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003789">print</span><span class="op" id="2003794">(</span><span class="string" id="2003795">&#34;,&nbsp;...&#34;</span><span class="op" id="2003802">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003810">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003828">if</span>&nbsp;<span class="ident" id="2003831"><a href="/runtime/traceback.go.html#2003716">i</a></span>&nbsp;<span class="op" id="2003833">!=</span>&nbsp;<span class="num" id="2003836">0</span>&nbsp;<span class="op" id="2003838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003846">print</span><span class="op" id="2003851">(</span><span class="string" id="2003852">&#34;,&nbsp;&#34;</span><span class="op" id="2003856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003863">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003870">print</span><span class="op" id="2003875">(</span><span class="ident" id="2003876"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2003879">(</span><span class="ident" id="2003880"><a href="/runtime/traceback.go.html#2003656">argp</a></span><span class="op" id="2003884">[</span><span class="ident" id="2003885"><a href="/runtime/traceback.go.html#2003716">i</a></span><span class="op" id="2003886">]</span><span class="op" id="2003887">)</span><span class="op" id="2003888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003900">print</span><span class="op" id="2003905">(</span><span class="string" id="2003906">&#34;)\n&#34;</span><span class="op" id="2003911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003917">var</span>&nbsp;<span class="ident" id="2003921">file</span>&nbsp;<span class="builtintype" id="2003926">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003937">line</span>&nbsp;<span class="op" id="2003942">:=</span>&nbsp;<span class="ident" id="2003945"><a href="/runtime/symtab.go.html#1985016">funcline</a></span><span class="op" id="2003953">(</span><span class="ident" id="2003954"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2003955">,</span>&nbsp;<span class="ident" id="2003957"><a href="/runtime/traceback.go.html#2003459">tracepc</a></span><span class="op" id="2003964">,</span>&nbsp;<span class="op" id="2003966">&amp;</span><span class="ident" id="2003967"><a href="/runtime/traceback.go.html#2003921">file</a></span><span class="op" id="2003971">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003977">print</span><span class="op" id="2003982">(</span><span class="string" id="2003983">&#34;\t&#34;</span><span class="op" id="2003987">,</span>&nbsp;<span class="ident" id="2003989"><a href="/runtime/traceback.go.html#2003921">file</a></span><span class="op" id="2003993">,</span>&nbsp;<span class="string" id="2003995">&#34;:&#34;</span><span class="op" id="2003998">,</span>&nbsp;<span class="ident" id="2004000"><a href="/runtime/traceback.go.html#2003937">line</a></span><span class="op" id="2004004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004010">if</span>&nbsp;<span class="ident" id="2004013"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004018">.</span><span class="ident" id="2004019">pc</span>&nbsp;<span class="op" id="2004022">&gt;</span>&nbsp;<span class="ident" id="2004024"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004025">.</span><span class="ident" id="2004026">entry</span>&nbsp;<span class="op" id="2004032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2004039">print</span><span class="op" id="2004044">(</span><span class="string" id="2004045">&#34;&nbsp;+&#34;</span><span class="op" id="2004049">,</span>&nbsp;<span class="ident" id="2004051"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2004054">(</span><span class="ident" id="2004055"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004060">.</span><span class="ident" id="2004061">pc</span><span class="op" id="2004063">-</span><span class="ident" id="2004064"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004065">.</span><span class="ident" id="2004066">entry</span><span class="op" id="2004071">)</span><span class="op" id="2004072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004084">if</span>&nbsp;<span class="ident" id="2004087"><a href="/runtime/traceback.go.html#1996435">g</a></span><span class="op" id="2004088">.</span><span class="ident" id="2004089">m</span><span class="op" id="2004090">.</span><span class="ident" id="2004091">throwing</span>&nbsp;<span class="op" id="2004100">&gt;</span>&nbsp;<span class="num" id="2004102">0</span>&nbsp;<span class="op" id="2004104">&amp;&amp;</span>&nbsp;<span class="ident" id="2004107"><a href="/runtime/traceback.go.html#1996229">gp</a></span>&nbsp;<span class="op" id="2004110">==</span>&nbsp;<span class="ident" id="2004113"><a href="/runtime/traceback.go.html#1996435">g</a></span><span class="op" id="2004114">.</span><span class="ident" id="2004115">m</span><span class="op" id="2004116">.</span><span class="ident" id="2004117">curg</span>&nbsp;<span class="op" id="2004122">||</span>&nbsp;<span class="ident" id="2004125"><a href="/runtime/traceback.go.html#1997411">gotraceback</a></span>&nbsp;<span class="op" id="2004137">&gt;=</span>&nbsp;<span class="num" id="2004140">2</span>&nbsp;<span class="op" id="2004142">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2004149">print</span><span class="op" id="2004154">(</span><span class="string" id="2004155">&#34;&nbsp;fp=&#34;</span><span class="op" id="2004161">,</span>&nbsp;<span class="ident" id="2004163"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2004166">(</span><span class="ident" id="2004167"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004172">.</span><span class="ident" id="2004173">fp</span><span class="op" id="2004175">)</span><span class="op" id="2004176">,</span>&nbsp;<span class="string" id="2004178">&#34;&nbsp;sp=&#34;</span><span class="op" id="2004184">,</span>&nbsp;<span class="ident" id="2004186"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2004189">(</span><span class="ident" id="2004190"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004195">.</span><span class="ident" id="2004196">sp</span><span class="op" id="2004198">)</span><span class="op" id="2004199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2004211">print</span><span class="op" id="2004216">(</span><span class="string" id="2004217">&#34;\n&#34;</span><span class="op" id="2004221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004227"><a href="/runtime/traceback.go.html#1997736">nprint</a></span><span class="op" id="2004233">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004239">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004247"><a href="/runtime/traceback.go.html#1998493">n</a></span><span class="op" id="2004248">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004253">skipped</span><span class="op" id="2004260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004264"><a href="/runtime/traceback.go.html#1997834">waspanic</a></span>&nbsp;<span class="op" id="2004273">=</span>&nbsp;<span class="ident" id="2004275"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004276">.</span><span class="ident" id="2004277">entry</span>&nbsp;<span class="op" id="2004283">==</span>&nbsp;<span class="ident" id="2004286"><a href="/runtime/traceback.go.html#1994440">sigpanicPC</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004299"><a href="/runtime/traceback.go.html#1997853">wasnewproc</a></span>&nbsp;<span class="op" id="2004310">=</span>&nbsp;<span class="ident" id="2004312"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004313">.</span><span class="ident" id="2004314">entry</span>&nbsp;<span class="op" id="2004320">==</span>&nbsp;<span class="ident" id="2004323"><a href="/runtime/traceback.go.html#1994398">newprocPC</a></span>&nbsp;<span class="op" id="2004333">||</span>&nbsp;<span class="ident" id="2004336"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004337">.</span><span class="ident" id="2004338">entry</span>&nbsp;<span class="op" id="2004344">==</span>&nbsp;<span class="ident" id="2004347"><a href="/runtime/traceback.go.html#1994272">deferprocPC</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004362">//&nbsp;Do&nbsp;not&nbsp;unwind&nbsp;past&nbsp;the&nbsp;bottom&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004411">if</span>&nbsp;<span class="ident" id="2004414"><a href="/runtime/traceback.go.html#1999164">flr</a></span>&nbsp;<span class="op" id="2004418">==</span>&nbsp;<span class="ident" id="2004421">nil</span>&nbsp;<span class="op" id="2004425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004430">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004443">//&nbsp;Unwind&nbsp;to&nbsp;next&nbsp;frame.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004470"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004475">.</span><span class="ident" id="2004476">fn</span>&nbsp;<span class="op" id="2004479">=</span>&nbsp;<span class="ident" id="2004481"><a href="/runtime/traceback.go.html#1999164">flr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004487"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004492">.</span><span class="ident" id="2004493">pc</span>&nbsp;<span class="op" id="2004496">=</span>&nbsp;<span class="ident" id="2004498"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004503">.</span><span class="ident" id="2004504">lr</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004509"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004514">.</span><span class="ident" id="2004515">lr</span>&nbsp;<span class="op" id="2004518">=</span>&nbsp;<span class="num" id="2004520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004524"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004529">.</span><span class="ident" id="2004530">sp</span>&nbsp;<span class="op" id="2004533">=</span>&nbsp;<span class="ident" id="2004535"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004540">.</span><span class="ident" id="2004541">fp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004546"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004551">.</span><span class="ident" id="2004552">fp</span>&nbsp;<span class="op" id="2004555">=</span>&nbsp;<span class="num" id="2004557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004561"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004566">.</span><span class="ident" id="2004567">argmap</span>&nbsp;<span class="op" id="2004574">=</span>&nbsp;<span class="ident" id="2004576">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004583">//&nbsp;On&nbsp;link&nbsp;register&nbsp;architectures,&nbsp;sighandler&nbsp;saves&nbsp;the&nbsp;LR&nbsp;on&nbsp;stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004653">//&nbsp;before&nbsp;faking&nbsp;a&nbsp;call&nbsp;to&nbsp;sigpanic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004692">if</span>&nbsp;<span class="ident" id="2004695"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="2004702">&amp;&amp;</span>&nbsp;<span class="ident" id="2004705"><a href="/runtime/traceback.go.html#1997834">waspanic</a></span>&nbsp;<span class="op" id="2004714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004719">x</span>&nbsp;<span class="op" id="2004721">:=</span>&nbsp;<span class="op" id="2004724">*</span><span class="op" id="2004725">(</span><span class="op" id="2004726">*</span><span class="builtintype" id="2004727">uintptr</span><span class="op" id="2004734">)</span><span class="op" id="2004735">(</span><span class="ident" id="2004736"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2004742">.</span><span class="ident" id="2004743">Pointer</span><span class="op" id="2004750">(</span><span class="ident" id="2004751"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004756">.</span><span class="ident" id="2004757">sp</span><span class="op" id="2004759">)</span><span class="op" id="2004760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004765"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004770">.</span><span class="ident" id="2004771">sp</span>&nbsp;<span class="op" id="2004774">+=</span>&nbsp;<span class="ident" id="2004777"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004788"><a href="/runtime/traceback.go.html#1998318">f</a></span>&nbsp;<span class="op" id="2004790">=</span>&nbsp;<span class="ident" id="2004792"><a href="/runtime/symtab.go.html#1982993">findfunc</a></span><span class="op" id="2004800">(</span><span class="ident" id="2004801"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004806">.</span><span class="ident" id="2004807">pc</span><span class="op" id="2004809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004814"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004819">.</span><span class="ident" id="2004820">fn</span>&nbsp;<span class="op" id="2004823">=</span>&nbsp;<span class="ident" id="2004825"><a href="/runtime/traceback.go.html#1998318">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004830">if</span>&nbsp;<span class="ident" id="2004833"><a href="/runtime/traceback.go.html#1998318">f</a></span>&nbsp;<span class="op" id="2004835">==</span>&nbsp;<span class="ident" id="2004838">nil</span>&nbsp;<span class="op" id="2004842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004848"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004853">.</span><span class="ident" id="2004854">pc</span>&nbsp;<span class="op" id="2004857">=</span>&nbsp;<span class="ident" id="2004859"><a href="/runtime/traceback.go.html#2004719">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004864">}</span>&nbsp;<span class="keyword" id="2004866">else</span>&nbsp;<span class="keyword" id="2004871">if</span>&nbsp;<span class="ident" id="2004874"><a href="/runtime/traceback.go.html#1998318">f</a></span><span class="op" id="2004875">.</span><span class="ident" id="2004876">frame</span>&nbsp;<span class="op" id="2004882">==</span>&nbsp;<span class="num" id="2004885">0</span>&nbsp;<span class="op" id="2004887">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004893"><a href="/runtime/traceback.go.html#1997753">frame</a></span><span class="op" id="2004898">.</span><span class="ident" id="2004899">lr</span>&nbsp;<span class="op" id="2004902">=</span>&nbsp;<span class="ident" id="2004904"><a href="/runtime/traceback.go.html#2004719">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004920">if</span>&nbsp;<span class="ident" id="2004923"><a href="/runtime/traceback.go.html#1996246">pcbuf</a></span>&nbsp;<span class="op" id="2004929">==</span>&nbsp;<span class="ident" id="2004932">nil</span>&nbsp;<span class="op" id="2004936">&amp;&amp;</span>&nbsp;<span class="ident" id="2004939"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2004948">==</span>&nbsp;<span class="ident" id="2004951">nil</span>&nbsp;<span class="op" id="2004955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004959"><a href="/runtime/traceback.go.html#1998493">n</a></span>&nbsp;<span class="op" id="2004961">=</span>&nbsp;<span class="ident" id="2004963"><a href="/runtime/traceback.go.html#1997736">nprint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004975">//&nbsp;If&nbsp;callback&nbsp;!=&nbsp;nil,&nbsp;we&#39;re&nbsp;being&nbsp;called&nbsp;to&nbsp;gather&nbsp;stack&nbsp;information&nbsp;during</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005053">//&nbsp;garbage&nbsp;collection&nbsp;or&nbsp;stack&nbsp;growth.&nbsp;In&nbsp;that&nbsp;context,&nbsp;require&nbsp;that&nbsp;we&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005131">//&nbsp;up&nbsp;the&nbsp;entire&nbsp;defer&nbsp;stack.&nbsp;If&nbsp;not,&nbsp;then&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;somewhere&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005208">//&nbsp;garbage&nbsp;collection&nbsp;or&nbsp;stack&nbsp;growth&nbsp;may&nbsp;not&nbsp;have&nbsp;seen&nbsp;the&nbsp;correct&nbsp;picture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005285">//&nbsp;of&nbsp;the&nbsp;stack.&nbsp;Crash&nbsp;now&nbsp;instead&nbsp;of&nbsp;silently&nbsp;executing&nbsp;the&nbsp;garbage&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005366">//&nbsp;or&nbsp;stack&nbsp;copy&nbsp;incorrectly&nbsp;and&nbsp;setting&nbsp;up&nbsp;for&nbsp;a&nbsp;mysterious&nbsp;crash&nbsp;later.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005441">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005445">//&nbsp;Note&nbsp;that&nbsp;panic&nbsp;!=&nbsp;nil&nbsp;is&nbsp;okay&nbsp;here:&nbsp;there&nbsp;can&nbsp;be&nbsp;leftover&nbsp;panics,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005516">//&nbsp;because&nbsp;the&nbsp;defers&nbsp;on&nbsp;the&nbsp;panic&nbsp;stack&nbsp;do&nbsp;not&nbsp;nest&nbsp;in&nbsp;frame&nbsp;order&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005588">//&nbsp;they&nbsp;do&nbsp;on&nbsp;the&nbsp;defer&nbsp;stack.&nbsp;If&nbsp;you&nbsp;have:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005633">//</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005637">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;1&nbsp;defers&nbsp;d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005659">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;2&nbsp;defers&nbsp;d2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005681">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;3&nbsp;defers&nbsp;d3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005703">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;4&nbsp;panics</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005722">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;4&#39;s&nbsp;panic&nbsp;starts&nbsp;running&nbsp;defers</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005764">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;5,&nbsp;running&nbsp;d3,&nbsp;defers&nbsp;d4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005799">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;5&nbsp;panics</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005818">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;5&#39;s&nbsp;panic&nbsp;starts&nbsp;running&nbsp;defers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005860">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;6,&nbsp;running&nbsp;d4,&nbsp;garbage&nbsp;collects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005902">//&nbsp;&nbsp;&nbsp;&nbspframe&nbsp;6,&nbsp;running&nbsp;d2,&nbsp;garbage&nbsp;collects</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005944">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005948">//&nbsp;During&nbsp;the&nbsp;execution&nbsp;of&nbsp;d4,&nbsp;the&nbsp;panic&nbsp;stack&nbsp;is&nbsp;d4&nbsp;-&gt;&nbsp;d3,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006015">//&nbsp;is&nbsp;nested&nbsp;properly,&nbsp;and&nbsp;we&#39;ll&nbsp;treat&nbsp;frame&nbsp;3&nbsp;as&nbsp;resumable,&nbsp;because&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006088">//&nbsp;can&nbsp;find&nbsp;d3.&nbsp;(And&nbsp;in&nbsp;fact&nbsp;frame&nbsp;3&nbsp;is&nbsp;resumable.&nbsp;If&nbsp;d4&nbsp;recovers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006155">//&nbsp;and&nbsp;frame&nbsp;5&nbsp;continues&nbsp;running,&nbsp;d3,&nbsp;d3&nbsp;can&nbsp;recover&nbsp;and&nbsp;we&#39;ll</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006219">//&nbsp;resume&nbsp;execution&nbsp;in&nbsp;(returning&nbsp;from)&nbsp;frame&nbsp;3.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006270">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006274">//&nbsp;During&nbsp;the&nbsp;execution&nbsp;of&nbsp;d2,&nbsp;however,&nbsp;the&nbsp;panic&nbsp;stack&nbsp;is&nbsp;d2&nbsp;-&gt;&nbsp;d3,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006344">//&nbsp;which&nbsp;is&nbsp;inverted.&nbsp;The&nbsp;scan&nbsp;will&nbsp;match&nbsp;d2&nbsp;to&nbsp;frame&nbsp;2&nbsp;but&nbsp;having</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006412">//&nbsp;d2&nbsp;on&nbsp;the&nbsp;stack&nbsp;until&nbsp;then&nbsp;means&nbsp;it&nbsp;will&nbsp;not&nbsp;match&nbsp;d3&nbsp;to&nbsp;frame&nbsp;3.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006482">//&nbsp;This&nbsp;is&nbsp;okay:&nbsp;if&nbsp;we&#39;re&nbsp;running&nbsp;d2,&nbsp;then&nbsp;all&nbsp;the&nbsp;defers&nbsp;after&nbsp;d2&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006555">//&nbsp;completed&nbsp;and&nbsp;their&nbsp;corresponding&nbsp;frames&nbsp;are&nbsp;dead.&nbsp;Not&nbsp;finding&nbsp;d3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006625">//&nbsp;for&nbsp;frame&nbsp;3&nbsp;means&nbsp;we&#39;ll&nbsp;set&nbsp;frame&nbsp;3&#39;s&nbsp;continpc&nbsp;==&nbsp;0,&nbsp;which&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006699">//&nbsp;(frame&nbsp;3&nbsp;is&nbsp;dead).&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;walk&nbsp;the&nbsp;panic&nbsp;stack&nbsp;can&nbsp;thus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006770">//&nbsp;contain&nbsp;defers&nbsp;(d3&nbsp;in&nbsp;this&nbsp;case)&nbsp;for&nbsp;dead&nbsp;frames.&nbsp;The&nbsp;inversion&nbsp;here</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006843">//&nbsp;always&nbsp;indicates&nbsp;a&nbsp;dead&nbsp;frame,&nbsp;and&nbsp;the&nbsp;effect&nbsp;of&nbsp;the&nbsp;inversion&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006917">//&nbsp;scan&nbsp;is&nbsp;to&nbsp;hide&nbsp;those&nbsp;dead&nbsp;frames,&nbsp;so&nbsp;the&nbsp;scan&nbsp;is&nbsp;still&nbsp;okay:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006983">//&nbsp;what&#39;s&nbsp;left&nbsp;on&nbsp;the&nbsp;panic&nbsp;stack&nbsp;are&nbsp;exactly&nbsp;(and&nbsp;only)&nbsp;the&nbsp;dead&nbsp;frames.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007058">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007062">//&nbsp;We&nbsp;require&nbsp;callback&nbsp;!=&nbsp;nil&nbsp;here&nbsp;because&nbsp;only&nbsp;when&nbsp;callback&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007132">//&nbsp;do&nbsp;we&nbsp;know&nbsp;that&nbsp;gentraceback&nbsp;is&nbsp;being&nbsp;called&nbsp;in&nbsp;a&nbsp;&#34;must&nbsp;be&nbsp;correct&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007204">//&nbsp;context&nbsp;as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;&#34;best&nbsp;effort&#34;&nbsp;context.&nbsp;The&nbsp;tracebacks&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007275">//&nbsp;callbacks&nbsp;only&nbsp;happen&nbsp;when&nbsp;everything&nbsp;is&nbsp;stopped&nbsp;nicely.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007336">//&nbsp;At&nbsp;other&nbsp;times,&nbsp;such&nbsp;as&nbsp;when&nbsp;gathering&nbsp;a&nbsp;stack&nbsp;for&nbsp;a&nbsp;profiling&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007410">//&nbsp;or&nbsp;when&nbsp;printing&nbsp;a&nbsp;traceback&nbsp;during&nbsp;a&nbsp;crash,&nbsp;everything&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007481">//&nbsp;stopped&nbsp;nicely,&nbsp;and&nbsp;the&nbsp;stack&nbsp;walk&nbsp;may&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007549">//&nbsp;It&#39;s&nbsp;okay&nbsp;in&nbsp;those&nbsp;situations&nbsp;not&nbsp;to&nbsp;use&nbsp;up&nbsp;the&nbsp;entire&nbsp;defer&nbsp;stack:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007621">//&nbsp;incomplete&nbsp;information&nbsp;then&nbsp;is&nbsp;still&nbsp;better&nbsp;than&nbsp;nothing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007683">if</span>&nbsp;<span class="ident" id="2007686"><a href="/runtime/traceback.go.html#1996271">callback</a></span>&nbsp;<span class="op" id="2007695">!=</span>&nbsp;<span class="ident" id="2007698">nil</span>&nbsp;<span class="op" id="2007702">&amp;&amp;</span>&nbsp;<span class="ident" id="2007705"><a href="/runtime/traceback.go.html#1998493">n</a></span>&nbsp;<span class="op" id="2007707">&lt;</span>&nbsp;<span class="ident" id="2007709"><a href="/runtime/traceback.go.html#1996262">max</a></span>&nbsp;<span class="op" id="2007713">&amp;&amp;</span>&nbsp;<span class="ident" id="2007716"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2007723">!=</span>&nbsp;<span class="ident" id="2007726">nil</span>&nbsp;<span class="op" id="2007730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007734">if</span>&nbsp;<span class="ident" id="2007737"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2007744">!=</span>&nbsp;<span class="ident" id="2007747">nil</span>&nbsp;<span class="op" id="2007751">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2007756">print</span><span class="op" id="2007761">(</span><span class="string" id="2007762">&#34;runtime:&nbsp;g&#34;</span><span class="op" id="2007774">,</span>&nbsp;<span class="ident" id="2007776"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="2007778">.</span><span class="ident" id="2007779">goid</span><span class="op" id="2007783">,</span>&nbsp;<span class="string" id="2007785">&#34;:&nbsp;leftover&nbsp;defer&nbsp;argp=&#34;</span><span class="op" id="2007809">,</span>&nbsp;<span class="ident" id="2007811"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2007814">(</span><span class="ident" id="2007815"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2007821">.</span><span class="ident" id="2007822">argp</span><span class="op" id="2007826">)</span><span class="op" id="2007827">,</span>&nbsp;<span class="string" id="2007829">&#34;&nbsp;pc=&#34;</span><span class="op" id="2007835">,</span>&nbsp;<span class="ident" id="2007837"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2007840">(</span><span class="ident" id="2007841"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2007847">.</span><span class="ident" id="2007848">pc</span><span class="op" id="2007850">)</span><span class="op" id="2007851">,</span>&nbsp;<span class="string" id="2007853">&#34;\n&#34;</span><span class="op" id="2007857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007865">for</span>&nbsp;<span class="ident" id="2007869"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2007876">=</span>&nbsp;<span class="ident" id="2007878"><a href="/runtime/traceback.go.html#1996229">gp</a></span><span class="op" id="2007880">.</span><span class="ident" id="2007881">_defer</span><span class="op" id="2007887">;</span>&nbsp;<span class="ident" id="2007889"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2007896">!=</span>&nbsp;<span class="ident" id="2007899">nil</span><span class="op" id="2007902">;</span>&nbsp;<span class="ident" id="2007904"><a href="/runtime/traceback.go.html#1997919">_defer</a></span>&nbsp;<span class="op" id="2007911">=</span>&nbsp;<span class="ident" id="2007913"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2007919">.</span><span class="ident" id="2007920">link</span>&nbsp;<span class="op" id="2007925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2007930">print</span><span class="op" id="2007935">(</span><span class="string" id="2007936">&#34;\tdefer&nbsp;&#34;</span><span class="op" id="2007946">,</span>&nbsp;<span class="ident" id="2007948"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2007954">,</span>&nbsp;<span class="string" id="2007956">&#34;&nbsp;argp=&#34;</span><span class="op" id="2007964">,</span>&nbsp;<span class="ident" id="2007966"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2007969">(</span><span class="ident" id="2007970"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2007976">.</span><span class="ident" id="2007977">argp</span><span class="op" id="2007981">)</span><span class="op" id="2007982">,</span>&nbsp;<span class="string" id="2007984">&#34;&nbsp;pc=&#34;</span><span class="op" id="2007990">,</span>&nbsp;<span class="ident" id="2007992"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2007995">(</span><span class="ident" id="2007996"><a href="/runtime/traceback.go.html#1997919">_defer</a></span><span class="op" id="2008002">.</span><span class="ident" id="2008003">pc</span><span class="op" id="2008005">)</span><span class="op" id="2008006">,</span>&nbsp;<span class="string" id="2008008">&#34;\n&#34;</span><span class="op" id="2008012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008016">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008020"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="2008027">(</span><span class="string" id="2008028">&#34;traceback&nbsp;has&nbsp;leftover&nbsp;defers&#34;</span><span class="op" id="2008059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008066">return</span>&nbsp;<span class="ident" id="2008073"><a href="/runtime/traceback.go.html#1998493">n</a></span><br>
<span class="lineno"></span><span class="op" id="2008075">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2008078">func</span>&nbsp;<span class="ident" id="2008083">setArgInfo</span><span class="op" id="2008093">(</span><span class="ident" id="2008094">frame</span>&nbsp;<span class="op" id="2008100">*</span><span class="ident" id="2008101"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020892">stkframe</a></span><span class="op" id="2008109">,</span>&nbsp;<span class="ident" id="2008111">f</span>&nbsp;<span class="op" id="2008113">*</span><span class="ident" id="2008114"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2019504">_func</a></span><span class="op" id="2008119">,</span>&nbsp;<span class="ident" id="2008121">needArgMap</span>&nbsp;<span class="builtintype" id="2008132">bool</span><span class="op" id="2008136">)</span>&nbsp;<span class="op" id="2008138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008141"><a href="/runtime/traceback.go.html#2008094">frame</a></span><span class="op" id="2008146">.</span><span class="ident" id="2008147">arglen</span>&nbsp;<span class="op" id="2008154">=</span>&nbsp;<span class="builtintype" id="2008156">uintptr</span><span class="op" id="2008163">(</span><span class="ident" id="2008164"><a href="/runtime/traceback.go.html#2008111">f</a></span><span class="op" id="2008165">.</span><span class="ident" id="2008166">args</span><span class="op" id="2008170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008173">if</span>&nbsp;<span class="ident" id="2008176"><a href="/runtime/traceback.go.html#2008121">needArgMap</a></span>&nbsp;<span class="op" id="2008187">&amp;&amp;</span>&nbsp;<span class="ident" id="2008190"><a href="/runtime/traceback.go.html#2008111">f</a></span><span class="op" id="2008191">.</span><span class="ident" id="2008192">args</span>&nbsp;<span class="op" id="2008197">==</span>&nbsp;<span class="ident" id="2008200"><a href="/runtime/symtab.go.html#1979671">_ArgsSizeUnknown</a></span>&nbsp;<span class="op" id="2008217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008221">//&nbsp;Extract&nbsp;argument&nbsp;bitmaps&nbsp;for&nbsp;reflect&nbsp;stubs&nbsp;from&nbsp;the&nbsp;calls&nbsp;they&nbsp;made&nbsp;to&nbsp;reflect.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008306">switch</span>&nbsp;<span class="ident" id="2008313"><a href="/runtime/symtab.go.html#1984497">gofuncname</a></span><span class="op" id="2008323">(</span><span class="ident" id="2008324"><a href="/runtime/traceback.go.html#2008111">f</a></span><span class="op" id="2008325">)</span>&nbsp;<span class="op" id="2008327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008331">case</span>&nbsp;<span class="string" id="2008336">&#34;reflect.makeFuncStub&#34;</span><span class="op" id="2008358">,</span>&nbsp;<span class="string" id="2008360">&#34;reflect.methodValueCall&#34;</span><span class="op" id="2008385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008390">arg0</span>&nbsp;<span class="op" id="2008395">:=</span>&nbsp;<span class="ident" id="2008398"><a href="/runtime/traceback.go.html#2008094">frame</a></span><span class="op" id="2008403">.</span><span class="ident" id="2008404">sp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008410">if</span>&nbsp;<span class="ident" id="2008413"><a href="/runtime/traceback.go.html#1994161">usesLR</a></span>&nbsp;<span class="op" id="2008420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008426"><a href="/runtime/traceback.go.html#2008390">arg0</a></span>&nbsp;<span class="op" id="2008431">+=</span>&nbsp;<span class="ident" id="2008434"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008450">fn</span>&nbsp;<span class="op" id="2008453">:=</span>&nbsp;<span class="op" id="2008456">*</span><span class="op" id="2008457">(</span><span class="op" id="2008458">*</span><span class="op" id="2008459">*</span><span class="op" id="2008460">[</span><span class="num" id="2008461">2</span><span class="op" id="2008462">]</span><span class="builtintype" id="2008463">uintptr</span><span class="op" id="2008470">)</span><span class="op" id="2008471">(</span><span class="ident" id="2008472"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2008478">.</span><span class="ident" id="2008479">Pointer</span><span class="op" id="2008486">(</span><span class="ident" id="2008487"><a href="/runtime/traceback.go.html#2008390">arg0</a></span><span class="op" id="2008491">)</span><span class="op" id="2008492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008497">if</span>&nbsp;<span class="ident" id="2008500"><a href="/runtime/traceback.go.html#2008450">fn</a></span><span class="op" id="2008502">[</span><span class="num" id="2008503">0</span><span class="op" id="2008504">]</span>&nbsp;<span class="op" id="2008506">!=</span>&nbsp;<span class="ident" id="2008509"><a href="/runtime/traceback.go.html#2008111">f</a></span><span class="op" id="2008510">.</span><span class="ident" id="2008511">entry</span>&nbsp;<span class="op" id="2008517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2008523">print</span><span class="op" id="2008528">(</span><span class="string" id="2008529">&#34;runtime:&nbsp;confused&nbsp;by&nbsp;&#34;</span><span class="op" id="2008552">,</span>&nbsp;<span class="ident" id="2008554"><a href="/runtime/symtab.go.html#1984497">gofuncname</a></span><span class="op" id="2008564">(</span><span class="ident" id="2008565"><a href="/runtime/traceback.go.html#2008111">f</a></span><span class="op" id="2008566">)</span><span class="op" id="2008567">,</span>&nbsp;<span class="string" id="2008569">&#34;\n&#34;</span><span class="op" id="2008573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008579"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="2008586">(</span><span class="string" id="2008587">&#34;reflect&nbsp;mismatch&#34;</span><span class="op" id="2008605">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008615">bv</span>&nbsp;<span class="op" id="2008618">:=</span>&nbsp;<span class="op" id="2008621">(</span><span class="op" id="2008622">*</span><span class="ident" id="2008623"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2025404">bitvector</a></span><span class="op" id="2008632">)</span><span class="op" id="2008633">(</span><span class="ident" id="2008634"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2008640">.</span><span class="ident" id="2008641">Pointer</span><span class="op" id="2008648">(</span><span class="ident" id="2008649"><a href="/runtime/traceback.go.html#2008450">fn</a></span><span class="op" id="2008651">[</span><span class="num" id="2008652">1</span><span class="op" id="2008653">]</span><span class="op" id="2008654">)</span><span class="op" id="2008655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008660"><a href="/runtime/traceback.go.html#2008094">frame</a></span><span class="op" id="2008665">.</span><span class="ident" id="2008666">arglen</span>&nbsp;<span class="op" id="2008673">=</span>&nbsp;<span class="builtintype" id="2008675">uintptr</span><span class="op" id="2008682">(</span><span class="ident" id="2008683"><a href="/runtime/traceback.go.html#2008615">bv</a></span><span class="op" id="2008685">.</span><span class="ident" id="2008686">n</span>&nbsp;<span class="op" id="2008688">/</span>&nbsp;<span class="num" id="2008690">2</span>&nbsp;<span class="op" id="2008692">*</span>&nbsp;<span class="ident" id="2008694"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="2008701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008706"><a href="/runtime/traceback.go.html#2008094">frame</a></span><span class="op" id="2008711">.</span><span class="ident" id="2008712">argmap</span>&nbsp;<span class="op" id="2008719">=</span>&nbsp;<span class="ident" id="2008721"><a href="/runtime/traceback.go.html#2008615">bv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008726">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008729">}</span><br>
<span class="lineno"></span><span class="op" id="2008731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2008734">func</span>&nbsp;<span class="ident" id="2008739">printcreatedby</span><span class="op" id="2008753">(</span><span class="ident" id="2008754">gp</span>&nbsp;<span class="op" id="2008757">*</span><span class="ident" id="2008758"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2008759">)</span>&nbsp;<span class="op" id="2008761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008764">//&nbsp;Show&nbsp;what&nbsp;created&nbsp;goroutine,&nbsp;except&nbsp;main&nbsp;goroutine&nbsp;(goid&nbsp;1).</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008829">pc</span>&nbsp;<span class="op" id="2008832">:=</span>&nbsp;<span class="ident" id="2008835"><a href="/runtime/traceback.go.html#2008754">gp</a></span><span class="op" id="2008837">.</span><span class="ident" id="2008838">gopc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008844">f</span>&nbsp;<span class="op" id="2008846">:=</span>&nbsp;<span class="ident" id="2008849"><a href="/runtime/symtab.go.html#1982993">findfunc</a></span><span class="op" id="2008857">(</span><span class="ident" id="2008858"><a href="/runtime/traceback.go.html#2008829">pc</a></span><span class="op" id="2008860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008863">if</span>&nbsp;<span class="ident" id="2008866"><a href="/runtime/traceback.go.html#2008844">f</a></span>&nbsp;<span class="op" id="2008868">!=</span>&nbsp;<span class="ident" id="2008871">nil</span>&nbsp;<span class="op" id="2008875">&amp;&amp;</span>&nbsp;<span class="ident" id="2008878"><a href="/runtime/traceback.go.html#2010959">showframe</a></span><span class="op" id="2008887">(</span><span class="ident" id="2008888"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2008889">,</span>&nbsp;<span class="ident" id="2008891"><a href="/runtime/traceback.go.html#2008754">gp</a></span><span class="op" id="2008893">)</span>&nbsp;<span class="op" id="2008895">&amp;&amp;</span>&nbsp;<span class="ident" id="2008898"><a href="/runtime/traceback.go.html#2008754">gp</a></span><span class="op" id="2008900">.</span><span class="ident" id="2008901">goid</span>&nbsp;<span class="op" id="2008906">!=</span>&nbsp;<span class="num" id="2008909">1</span>&nbsp;<span class="op" id="2008911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2008915">print</span><span class="op" id="2008920">(</span><span class="string" id="2008921">&#34;created&nbsp;by&nbsp;&#34;</span><span class="op" id="2008934">,</span>&nbsp;<span class="ident" id="2008936"><a href="/runtime/symtab.go.html#1984497">gofuncname</a></span><span class="op" id="2008946">(</span><span class="ident" id="2008947"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2008948">)</span><span class="op" id="2008949">,</span>&nbsp;<span class="string" id="2008951">&#34;\n&#34;</span><span class="op" id="2008955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008959">tracepc</span>&nbsp;<span class="op" id="2008967">:=</span>&nbsp;<span class="ident" id="2008970"><a href="/runtime/traceback.go.html#2008829">pc</a></span>&nbsp;<span class="comment" id="2008973">//&nbsp;back&nbsp;up&nbsp;to&nbsp;CALL&nbsp;instruction&nbsp;for&nbsp;funcline.</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009020">if</span>&nbsp;<span class="ident" id="2009023"><a href="/runtime/traceback.go.html#2008829">pc</a></span>&nbsp;<span class="op" id="2009026">&gt;</span>&nbsp;<span class="ident" id="2009028"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2009029">.</span><span class="ident" id="2009030">entry</span>&nbsp;<span class="op" id="2009036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009041"><a href="/runtime/traceback.go.html#2008959">tracepc</a></span>&nbsp;<span class="op" id="2009049">-=</span>&nbsp;<span class="ident" id="2009052"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021783">_PCQuantum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009069">var</span>&nbsp;<span class="ident" id="2009073">file</span>&nbsp;<span class="builtintype" id="2009078">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009087">line</span>&nbsp;<span class="op" id="2009092">:=</span>&nbsp;<span class="ident" id="2009095"><a href="/runtime/symtab.go.html#1985016">funcline</a></span><span class="op" id="2009103">(</span><span class="ident" id="2009104"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2009105">,</span>&nbsp;<span class="ident" id="2009107"><a href="/runtime/traceback.go.html#2008959">tracepc</a></span><span class="op" id="2009114">,</span>&nbsp;<span class="op" id="2009116">&amp;</span><span class="ident" id="2009117"><a href="/runtime/traceback.go.html#2009073">file</a></span><span class="op" id="2009121">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2009125">print</span><span class="op" id="2009130">(</span><span class="string" id="2009131">&#34;\t&#34;</span><span class="op" id="2009135">,</span>&nbsp;<span class="ident" id="2009137"><a href="/runtime/traceback.go.html#2009073">file</a></span><span class="op" id="2009141">,</span>&nbsp;<span class="string" id="2009143">&#34;:&#34;</span><span class="op" id="2009146">,</span>&nbsp;<span class="ident" id="2009148"><a href="/runtime/traceback.go.html#2009087">line</a></span><span class="op" id="2009152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009156">if</span>&nbsp;<span class="ident" id="2009159"><a href="/runtime/traceback.go.html#2008829">pc</a></span>&nbsp;<span class="op" id="2009162">&gt;</span>&nbsp;<span class="ident" id="2009164"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2009165">.</span><span class="ident" id="2009166">entry</span>&nbsp;<span class="op" id="2009172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2009177">print</span><span class="op" id="2009182">(</span><span class="string" id="2009183">&#34;&nbsp;+&#34;</span><span class="op" id="2009187">,</span>&nbsp;<span class="ident" id="2009189"><a href="/runtime/print1.go.html#1894784">hex</a></span><span class="op" id="2009192">(</span><span class="ident" id="2009193"><a href="/runtime/traceback.go.html#2008829">pc</a></span><span class="op" id="2009195">-</span><span class="ident" id="2009196"><a href="/runtime/traceback.go.html#2008844">f</a></span><span class="op" id="2009197">.</span><span class="ident" id="2009198">entry</span><span class="op" id="2009203">)</span><span class="op" id="2009204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2009212">print</span><span class="op" id="2009217">(</span><span class="string" id="2009218">&#34;\n&#34;</span><span class="op" id="2009222">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009225">}</span><br>
<span class="lineno"></span><span class="op" id="2009227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2009230">func</span>&nbsp;<span class="ident" id="2009235">traceback</span><span class="op" id="2009244">(</span><span class="ident" id="2009245">pc</span>&nbsp;<span class="builtintype" id="2009248">uintptr</span><span class="op" id="2009255">,</span>&nbsp;<span class="ident" id="2009257">sp</span>&nbsp;<span class="builtintype" id="2009260">uintptr</span><span class="op" id="2009267">,</span>&nbsp;<span class="ident" id="2009269">lr</span>&nbsp;<span class="builtintype" id="2009272">uintptr</span><span class="op" id="2009279">,</span>&nbsp;<span class="ident" id="2009281">gp</span>&nbsp;<span class="op" id="2009284">*</span><span class="ident" id="2009285"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2009286">)</span>&nbsp;<span class="op" id="2009288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009291"><a href="/runtime/traceback.go.html#2009848">traceback1</a></span><span class="op" id="2009301">(</span><span class="ident" id="2009302"><a href="/runtime/traceback.go.html#2009245">pc</a></span><span class="op" id="2009304">,</span>&nbsp;<span class="ident" id="2009306"><a href="/runtime/traceback.go.html#2009257">sp</a></span><span class="op" id="2009308">,</span>&nbsp;<span class="ident" id="2009310"><a href="/runtime/traceback.go.html#2009269">lr</a></span><span class="op" id="2009312">,</span>&nbsp;<span class="ident" id="2009314"><a href="/runtime/traceback.go.html#2009281">gp</a></span><span class="op" id="2009316">,</span>&nbsp;<span class="num" id="2009318">0</span><span class="op" id="2009319">)</span><br>
<span class="lineno">495</span><span class="op" id="2009321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2009324">//&nbsp;tracebacktrap&nbsp;is&nbsp;like&nbsp;traceback&nbsp;but&nbsp;expects&nbsp;that&nbsp;the&nbsp;PC&nbsp;and&nbsp;SP&nbsp;were&nbsp;obtained</span><br>
<span class="lineno"></span><span class="comment" id="2009404">//&nbsp;from&nbsp;a&nbsp;trap,&nbsp;not&nbsp;from&nbsp;gp-&gt;sched&nbsp;or&nbsp;gp-&gt;syscallpc/gp-&gt;syscallsp&nbsp;or&nbsp;getcallerpc/getcallersp.</span><br>
<span class="lineno"></span><span class="comment" id="2009498">//&nbsp;Because&nbsp;they&nbsp;are&nbsp;from&nbsp;a&nbsp;trap&nbsp;instead&nbsp;of&nbsp;from&nbsp;a&nbsp;saved&nbsp;pair,</span><br>
<span class="lineno">500</span><span class="comment" id="2009560">//&nbsp;the&nbsp;initial&nbsp;PC&nbsp;must&nbsp;not&nbsp;be&nbsp;rewound&nbsp;to&nbsp;the&nbsp;previous&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="comment" id="2009627">//&nbsp;(All&nbsp;the&nbsp;saved&nbsp;pairs&nbsp;record&nbsp;a&nbsp;PC&nbsp;that&nbsp;is&nbsp;a&nbsp;return&nbsp;address,&nbsp;so&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="2009695">//&nbsp;rewind&nbsp;it&nbsp;into&nbsp;the&nbsp;CALL&nbsp;instruction.)</span><br>
<span class="lineno"></span><span class="keyword" id="2009736">func</span>&nbsp;<span class="ident" id="2009741">tracebacktrap</span><span class="op" id="2009754">(</span><span class="ident" id="2009755">pc</span>&nbsp;<span class="builtintype" id="2009758">uintptr</span><span class="op" id="2009765">,</span>&nbsp;<span class="ident" id="2009767">sp</span>&nbsp;<span class="builtintype" id="2009770">uintptr</span><span class="op" id="2009777">,</span>&nbsp;<span class="ident" id="2009779">lr</span>&nbsp;<span class="builtintype" id="2009782">uintptr</span><span class="op" id="2009789">,</span>&nbsp;<span class="ident" id="2009791">gp</span>&nbsp;<span class="op" id="2009794">*</span><span class="ident" id="2009795"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2009796">)</span>&nbsp;<span class="op" id="2009798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009801"><a href="/runtime/traceback.go.html#2009848">traceback1</a></span><span class="op" id="2009811">(</span><span class="ident" id="2009812"><a href="/runtime/traceback.go.html#2009755">pc</a></span><span class="op" id="2009814">,</span>&nbsp;<span class="ident" id="2009816"><a href="/runtime/traceback.go.html#2009767">sp</a></span><span class="op" id="2009818">,</span>&nbsp;<span class="ident" id="2009820"><a href="/runtime/traceback.go.html#2009779">lr</a></span><span class="op" id="2009822">,</span>&nbsp;<span class="ident" id="2009824"><a href="/runtime/traceback.go.html#2009791">gp</a></span><span class="op" id="2009826">,</span>&nbsp;<span class="ident" id="2009828"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021089">_TraceTrap</a></span><span class="op" id="2009838">)</span><br>
<span class="lineno">505</span><span class="op" id="2009840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2009843">func</span>&nbsp;<span class="ident" id="2009848">traceback1</span><span class="op" id="2009858">(</span><span class="ident" id="2009859">pc</span>&nbsp;<span class="builtintype" id="2009862">uintptr</span><span class="op" id="2009869">,</span>&nbsp;<span class="ident" id="2009871">sp</span>&nbsp;<span class="builtintype" id="2009874">uintptr</span><span class="op" id="2009881">,</span>&nbsp;<span class="ident" id="2009883">lr</span>&nbsp;<span class="builtintype" id="2009886">uintptr</span><span class="op" id="2009893">,</span>&nbsp;<span class="ident" id="2009895">gp</span>&nbsp;<span class="op" id="2009898">*</span><span class="ident" id="2009899"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2009900">,</span>&nbsp;<span class="ident" id="2009902">flags</span>&nbsp;<span class="builtintype" id="2009908">uint</span><span class="op" id="2009912">)</span>&nbsp;<span class="op" id="2009914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009917">var</span>&nbsp;<span class="ident" id="2009921">n</span>&nbsp;<span class="builtintype" id="2009923">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009928">if</span>&nbsp;<span class="ident" id="2009931"><a href="/runtime/stubs.go.html#1968965">readgstatus</a></span><span class="op" id="2009942">(</span><span class="ident" id="2009943"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2009945">)</span><span class="op" id="2009946">&amp;^</span><span class="ident" id="2009948"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="op" id="2009955">==</span>&nbsp;<span class="ident" id="2009958"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015781">_Gsyscall</a></span>&nbsp;<span class="op" id="2009968">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009972">//&nbsp;Override&nbsp;registers&nbsp;if&nbsp;blocked&nbsp;in&nbsp;system&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010023"><a href="/runtime/traceback.go.html#2009859">pc</a></span>&nbsp;<span class="op" id="2010026">=</span>&nbsp;<span class="ident" id="2010028"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2010030">.</span><span class="ident" id="2010031">syscallpc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010043"><a href="/runtime/traceback.go.html#2009871">sp</a></span>&nbsp;<span class="op" id="2010046">=</span>&nbsp;<span class="ident" id="2010048"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2010050">.</span><span class="ident" id="2010051">syscallsp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010063"><a href="/runtime/traceback.go.html#2009902">flags</a></span>&nbsp;<span class="op" id="2010069">&amp;^=</span>&nbsp;<span class="ident" id="2010073"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021089">_TraceTrap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010085">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010088">//&nbsp;Print&nbsp;traceback.&nbsp;By&nbsp;default,&nbsp;omits&nbsp;runtime&nbsp;frames.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010143">//&nbsp;If&nbsp;that&nbsp;means&nbsp;we&nbsp;print&nbsp;nothing&nbsp;at&nbsp;all,&nbsp;repeat&nbsp;forcing&nbsp;all&nbsp;frames&nbsp;printed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010221"><a href="/runtime/traceback.go.html#2009921">n</a></span>&nbsp;<span class="op" id="2010223">=</span>&nbsp;<span class="ident" id="2010225"><a href="/runtime/traceback.go.html#1996177">gentraceback</a></span><span class="op" id="2010237">(</span><span class="ident" id="2010238"><a href="/runtime/traceback.go.html#2009859">pc</a></span><span class="op" id="2010240">,</span>&nbsp;<span class="ident" id="2010242"><a href="/runtime/traceback.go.html#2009871">sp</a></span><span class="op" id="2010244">,</span>&nbsp;<span class="ident" id="2010246"><a href="/runtime/traceback.go.html#2009883">lr</a></span><span class="op" id="2010248">,</span>&nbsp;<span class="ident" id="2010250"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2010252">,</span>&nbsp;<span class="num" id="2010254">0</span><span class="op" id="2010255">,</span>&nbsp;<span class="ident" id="2010257">nil</span><span class="op" id="2010260">,</span>&nbsp;<span class="ident" id="2010262"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021110">_TracebackMaxFrames</a></span><span class="op" id="2010281">,</span>&nbsp;<span class="ident" id="2010283">nil</span><span class="op" id="2010286">,</span>&nbsp;<span class="ident" id="2010288">nil</span><span class="op" id="2010291">,</span>&nbsp;<span class="ident" id="2010293"><a href="/runtime/traceback.go.html#2009902">flags</a></span><span class="op" id="2010298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010301">if</span>&nbsp;<span class="ident" id="2010304"><a href="/runtime/traceback.go.html#2009921">n</a></span>&nbsp;<span class="op" id="2010306">==</span>&nbsp;<span class="num" id="2010309">0</span>&nbsp;<span class="op" id="2010311">&amp;&amp;</span>&nbsp;<span class="op" id="2010314">(</span><span class="ident" id="2010315"><a href="/runtime/traceback.go.html#2009902">flags</a></span><span class="op" id="2010320">&amp;</span><span class="ident" id="2010321"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021059">_TraceRuntimeFrames</a></span><span class="op" id="2010340">)</span>&nbsp;<span class="op" id="2010342">==</span>&nbsp;<span class="num" id="2010345">0</span>&nbsp;<span class="op" id="2010347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010351"><a href="/runtime/traceback.go.html#2009921">n</a></span>&nbsp;<span class="op" id="2010353">=</span>&nbsp;<span class="ident" id="2010355"><a href="/runtime/traceback.go.html#1996177">gentraceback</a></span><span class="op" id="2010367">(</span><span class="ident" id="2010368"><a href="/runtime/traceback.go.html#2009859">pc</a></span><span class="op" id="2010370">,</span>&nbsp;<span class="ident" id="2010372"><a href="/runtime/traceback.go.html#2009871">sp</a></span><span class="op" id="2010374">,</span>&nbsp;<span class="ident" id="2010376"><a href="/runtime/traceback.go.html#2009883">lr</a></span><span class="op" id="2010378">,</span>&nbsp;<span class="ident" id="2010380"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2010382">,</span>&nbsp;<span class="num" id="2010384">0</span><span class="op" id="2010385">,</span>&nbsp;<span class="ident" id="2010387">nil</span><span class="op" id="2010390">,</span>&nbsp;<span class="ident" id="2010392"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021110">_TracebackMaxFrames</a></span><span class="op" id="2010411">,</span>&nbsp;<span class="ident" id="2010413">nil</span><span class="op" id="2010416">,</span>&nbsp;<span class="ident" id="2010418">nil</span><span class="op" id="2010421">,</span>&nbsp;<span class="ident" id="2010423"><a href="/runtime/traceback.go.html#2009902">flags</a></span><span class="op" id="2010428">|</span><span class="ident" id="2010429"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021059">_TraceRuntimeFrames</a></span><span class="op" id="2010448">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010454">if</span>&nbsp;<span class="ident" id="2010457"><a href="/runtime/traceback.go.html#2009921">n</a></span>&nbsp;<span class="op" id="2010459">==</span>&nbsp;<span class="ident" id="2010462"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021110">_TracebackMaxFrames</a></span>&nbsp;<span class="op" id="2010482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2010486">print</span><span class="op" id="2010491">(</span><span class="string" id="2010492">&#34;...additional&nbsp;frames&nbsp;elided...\n&#34;</span><span class="op" id="2010526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010532"><a href="/runtime/traceback.go.html#2008739">printcreatedby</a></span><span class="op" id="2010546">(</span><span class="ident" id="2010547"><a href="/runtime/traceback.go.html#2009895">gp</a></span><span class="op" id="2010549">)</span><br>
<span class="lineno">525</span><span class="op" id="2010551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2010554">func</span>&nbsp;<span class="ident" id="2010559">callers</span><span class="op" id="2010566">(</span><span class="ident" id="2010567">skip</span>&nbsp;<span class="builtintype" id="2010572">int</span><span class="op" id="2010575">,</span>&nbsp;<span class="ident" id="2010577">pcbuf</span>&nbsp;<span class="op" id="2010583">*</span><span class="builtintype" id="2010584">uintptr</span><span class="op" id="2010591">,</span>&nbsp;<span class="ident" id="2010593">m</span>&nbsp;<span class="builtintype" id="2010595">int</span><span class="op" id="2010598">)</span>&nbsp;<span class="builtintype" id="2010600">int</span>&nbsp;<span class="op" id="2010604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010607">sp</span>&nbsp;<span class="op" id="2010610">:=</span>&nbsp;<span class="ident" id="2010613"><a href="/runtime/stubs.go.html#1976425">getcallersp</a></span><span class="op" id="2010624">(</span><span class="ident" id="2010625"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2010631">.</span><span class="ident" id="2010632">Pointer</span><span class="op" id="2010639">(</span><span class="op" id="2010640">&amp;</span><span class="ident" id="2010641"><a href="/runtime/traceback.go.html#2010567">skip</a></span><span class="op" id="2010645">)</span><span class="op" id="2010646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010649">pc</span>&nbsp;<span class="op" id="2010652">:=</span>&nbsp;<span class="builtintype" id="2010655">uintptr</span><span class="op" id="2010662">(</span><span class="ident" id="2010663"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="2010674">(</span><span class="ident" id="2010675"><a href="/runtime/traceback.go.html#1992912">unsafe</a></span><span class="op" id="2010681">.</span><span class="ident" id="2010682">Pointer</span><span class="op" id="2010689">(</span><span class="op" id="2010690">&amp;</span><span class="ident" id="2010691"><a href="/runtime/traceback.go.html#2010567">skip</a></span><span class="op" id="2010695">)</span><span class="op" id="2010696">)</span><span class="op" id="2010697">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010700">var</span>&nbsp;<span class="ident" id="2010704">n</span>&nbsp;<span class="builtintype" id="2010706">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010711"><a href="/runtime/stubs.go.html#1971002">onM</a></span><span class="op" id="2010714">(</span><span class="keyword" id="2010715">func</span><span class="op" id="2010719">(</span><span class="op" id="2010720">)</span>&nbsp;<span class="op" id="2010722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010726"><a href="/runtime/traceback.go.html#2010704">n</a></span>&nbsp;<span class="op" id="2010728">=</span>&nbsp;<span class="ident" id="2010730"><a href="/runtime/traceback.go.html#1996177">gentraceback</a></span><span class="op" id="2010742">(</span><span class="ident" id="2010743"><a href="/runtime/traceback.go.html#2010649">pc</a></span><span class="op" id="2010745">,</span>&nbsp;<span class="ident" id="2010747"><a href="/runtime/traceback.go.html#2010607">sp</a></span><span class="op" id="2010749">,</span>&nbsp;<span class="num" id="2010751">0</span><span class="op" id="2010752">,</span>&nbsp;<span class="ident" id="2010754"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="2010758">(</span><span class="op" id="2010759">)</span><span class="op" id="2010760">,</span>&nbsp;<span class="ident" id="2010762"><a href="/runtime/traceback.go.html#2010567">skip</a></span><span class="op" id="2010766">,</span>&nbsp;<span class="ident" id="2010768"><a href="/runtime/traceback.go.html#2010577">pcbuf</a></span><span class="op" id="2010773">,</span>&nbsp;<span class="ident" id="2010775"><a href="/runtime/traceback.go.html#2010593">m</a></span><span class="op" id="2010776">,</span>&nbsp;<span class="ident" id="2010778">nil</span><span class="op" id="2010781">,</span>&nbsp;<span class="ident" id="2010783">nil</span><span class="op" id="2010786">,</span>&nbsp;<span class="num" id="2010788">0</span><span class="op" id="2010789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010792">}</span><span class="op" id="2010793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010796">return</span>&nbsp;<span class="ident" id="2010803"><a href="/runtime/traceback.go.html#2010704">n</a></span><br>
<span class="lineno">535</span><span class="op" id="2010805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2010808">func</span>&nbsp;<span class="ident" id="2010813">gcallers</span><span class="op" id="2010821">(</span><span class="ident" id="2010822">gp</span>&nbsp;<span class="op" id="2010825">*</span><span class="ident" id="2010826"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2010827">,</span>&nbsp;<span class="ident" id="2010829">skip</span>&nbsp;<span class="builtintype" id="2010834">int</span><span class="op" id="2010837">,</span>&nbsp;<span class="ident" id="2010839">pcbuf</span>&nbsp;<span class="op" id="2010845">*</span><span class="builtintype" id="2010846">uintptr</span><span class="op" id="2010853">,</span>&nbsp;<span class="ident" id="2010855">m</span>&nbsp;<span class="builtintype" id="2010857">int</span><span class="op" id="2010860">)</span>&nbsp;<span class="builtintype" id="2010862">int</span>&nbsp;<span class="op" id="2010866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010869">return</span>&nbsp;<span class="ident" id="2010876"><a href="/runtime/traceback.go.html#1996177">gentraceback</a></span><span class="op" id="2010888">(</span><span class="op" id="2010889">^</span><span class="builtintype" id="2010890">uintptr</span><span class="op" id="2010897">(</span><span class="num" id="2010898">0</span><span class="op" id="2010899">)</span><span class="op" id="2010900">,</span>&nbsp;<span class="op" id="2010902">^</span><span class="builtintype" id="2010903">uintptr</span><span class="op" id="2010910">(</span><span class="num" id="2010911">0</span><span class="op" id="2010912">)</span><span class="op" id="2010913">,</span>&nbsp;<span class="num" id="2010915">0</span><span class="op" id="2010916">,</span>&nbsp;<span class="ident" id="2010918"><a href="/runtime/traceback.go.html#2010822">gp</a></span><span class="op" id="2010920">,</span>&nbsp;<span class="ident" id="2010922"><a href="/runtime/traceback.go.html#2010829">skip</a></span><span class="op" id="2010926">,</span>&nbsp;<span class="ident" id="2010928"><a href="/runtime/traceback.go.html#2010839">pcbuf</a></span><span class="op" id="2010933">,</span>&nbsp;<span class="ident" id="2010935"><a href="/runtime/traceback.go.html#2010855">m</a></span><span class="op" id="2010936">,</span>&nbsp;<span class="ident" id="2010938">nil</span><span class="op" id="2010941">,</span>&nbsp;<span class="ident" id="2010943">nil</span><span class="op" id="2010946">,</span>&nbsp;<span class="num" id="2010948">0</span><span class="op" id="2010949">)</span><br>
<span class="lineno"></span><span class="op" id="2010951">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span><span class="keyword" id="2010954">func</span>&nbsp;<span class="ident" id="2010959">showframe</span><span class="op" id="2010968">(</span><span class="ident" id="2010969">f</span>&nbsp;<span class="op" id="2010971">*</span><span class="ident" id="2010972"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2019504">_func</a></span><span class="op" id="2010977">,</span>&nbsp;<span class="ident" id="2010979">gp</span>&nbsp;<span class="op" id="2010982">*</span><span class="ident" id="2010983"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2010984">)</span>&nbsp;<span class="builtintype" id="2010986">bool</span>&nbsp;<span class="op" id="2010991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010994">g</span>&nbsp;<span class="op" id="2010996">:=</span>&nbsp;<span class="ident" id="2010999"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="2011003">(</span><span class="op" id="2011004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011007">if</span>&nbsp;<span class="ident" id="2011010"><a href="/runtime/traceback.go.html#2010994">g</a></span><span class="op" id="2011011">.</span><span class="ident" id="2011012">m</span><span class="op" id="2011013">.</span><span class="ident" id="2011014">throwing</span>&nbsp;<span class="op" id="2011023">&gt;</span>&nbsp;<span class="num" id="2011025">0</span>&nbsp;<span class="op" id="2011027">&amp;&amp;</span>&nbsp;<span class="ident" id="2011030"><a href="/runtime/traceback.go.html#2010979">gp</a></span>&nbsp;<span class="op" id="2011033">!=</span>&nbsp;<span class="ident" id="2011036">nil</span>&nbsp;<span class="op" id="2011040">&amp;&amp;</span>&nbsp;<span class="op" id="2011043">(</span><span class="ident" id="2011044"><a href="/runtime/traceback.go.html#2010979">gp</a></span>&nbsp;<span class="op" id="2011047">==</span>&nbsp;<span class="ident" id="2011050"><a href="/runtime/traceback.go.html#2010994">g</a></span><span class="op" id="2011051">.</span><span class="ident" id="2011052">m</span><span class="op" id="2011053">.</span><span class="ident" id="2011054">curg</span>&nbsp;<span class="op" id="2011059">||</span>&nbsp;<span class="ident" id="2011062"><a href="/runtime/traceback.go.html#2010979">gp</a></span>&nbsp;<span class="op" id="2011065">==</span>&nbsp;<span class="ident" id="2011068"><a href="/runtime/traceback.go.html#2010994">g</a></span><span class="op" id="2011069">.</span><span class="ident" id="2011070">m</span><span class="op" id="2011071">.</span><span class="ident" id="2011072">caughtsig</span><span class="op" id="2011081">)</span>&nbsp;<span class="op" id="2011083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011087">return</span>&nbsp;<span class="ident" id="2011094">true</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011103">traceback</span>&nbsp;<span class="op" id="2011113">:=</span>&nbsp;<span class="ident" id="2011116"><a href="/runtime/stubs.go.html#1976669">gotraceback</a></span><span class="op" id="2011127">(</span><span class="ident" id="2011128">nil</span><span class="op" id="2011131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011134">name</span>&nbsp;<span class="op" id="2011139">:=</span>&nbsp;<span class="ident" id="2011142"><a href="/runtime/stubs.go.html#1974575">gostringnocopy</a></span><span class="op" id="2011156">(</span><span class="ident" id="2011157"><a href="/runtime/symtab.go.html#1984358">funcname</a></span><span class="op" id="2011165">(</span><span class="ident" id="2011166"><a href="/runtime/traceback.go.html#2010969">f</a></span><span class="op" id="2011167">)</span><span class="op" id="2011168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2011172">//&nbsp;Special&nbsp;case:&nbsp;always&nbsp;show&nbsp;runtime.panic&nbsp;frame,&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2011238">//&nbsp;see&nbsp;where&nbsp;a&nbsp;panic&nbsp;started&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;a&nbsp;stack&nbsp;trace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2011300">//&nbsp;See&nbsp;golang.org/issue/5832.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011331">if</span>&nbsp;<span class="ident" id="2011334"><a href="/runtime/traceback.go.html#2011134">name</a></span>&nbsp;<span class="op" id="2011339">==</span>&nbsp;<span class="string" id="2011342">&#34;runtime.panic&#34;</span>&nbsp;<span class="op" id="2011358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011362">return</span>&nbsp;<span class="ident" id="2011369">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011375">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011379">return</span>&nbsp;<span class="ident" id="2011386"><a href="/runtime/traceback.go.html#2011103">traceback</a></span>&nbsp;<span class="op" id="2011396">&gt;</span>&nbsp;<span class="num" id="2011398">1</span>&nbsp;<span class="op" id="2011400">||</span>&nbsp;<span class="ident" id="2011403"><a href="/runtime/traceback.go.html#2010969">f</a></span>&nbsp;<span class="op" id="2011405">!=</span>&nbsp;<span class="ident" id="2011408">nil</span>&nbsp;<span class="op" id="2011412">&amp;&amp;</span>&nbsp;<span class="ident" id="2011415"><a href="/runtime/string.go.html#1967968">contains</a></span><span class="op" id="2011423">(</span><span class="ident" id="2011424"><a href="/runtime/traceback.go.html#2011134">name</a></span><span class="op" id="2011428">,</span>&nbsp;<span class="string" id="2011430">&#34;.&#34;</span><span class="op" id="2011433">)</span>&nbsp;<span class="op" id="2011435">&amp;&amp;</span>&nbsp;<span class="op" id="2011438">(</span><span class="op" id="2011439">!</span><span class="ident" id="2011440"><a href="/runtime/string.go.html#1968030">hasprefix</a></span><span class="op" id="2011449">(</span><span class="ident" id="2011450"><a href="/runtime/traceback.go.html#2011134">name</a></span><span class="op" id="2011454">,</span>&nbsp;<span class="string" id="2011456">&#34;runtime.&#34;</span><span class="op" id="2011466">)</span>&nbsp;<span class="op" id="2011468">||</span>&nbsp;<span class="ident" id="2011471"><a href="/runtime/traceback.go.html#2011638">isExportedRuntime</a></span><span class="op" id="2011488">(</span><span class="ident" id="2011489"><a href="/runtime/traceback.go.html#2011134">name</a></span><span class="op" id="2011493">)</span><span class="op" id="2011494">)</span><br>
<span class="lineno"></span><span class="op" id="2011496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2011499">//&nbsp;isExportedRuntime&nbsp;reports&nbsp;whether&nbsp;name&nbsp;is&nbsp;an&nbsp;exported&nbsp;runtime&nbsp;function.</span><br>
<span class="lineno">560</span><span class="comment" id="2011574">//&nbsp;It&nbsp;is&nbsp;only&nbsp;for&nbsp;runtime&nbsp;functions,&nbsp;so&nbsp;ASCII&nbsp;A-Z&nbsp;is&nbsp;fine.</span><br>
<span class="lineno"></span><span class="keyword" id="2011633">func</span>&nbsp;<span class="ident" id="2011638">isExportedRuntime</span><span class="op" id="2011655">(</span><span class="ident" id="2011656">name</span>&nbsp;<span class="builtintype" id="2011661">string</span><span class="op" id="2011667">)</span>&nbsp;<span class="builtintype" id="2011669">bool</span>&nbsp;<span class="op" id="2011674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011677">const</span>&nbsp;<span class="ident" id="2011683">n</span>&nbsp;<span class="op" id="2011685">=</span>&nbsp;<span class="builtinfunc" id="2011687">len</span><span class="op" id="2011690">(</span><span class="string" id="2011691">&#34;runtime.&#34;</span><span class="op" id="2011701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011704">return</span>&nbsp;<span class="builtinfunc" id="2011711">len</span><span class="op" id="2011714">(</span><span class="ident" id="2011715"><a href="/runtime/traceback.go.html#2011656">name</a></span><span class="op" id="2011719">)</span>&nbsp;<span class="op" id="2011721">&gt;</span>&nbsp;<span class="ident" id="2011723"><a href="/runtime/traceback.go.html#2011683">n</a></span>&nbsp;<span class="op" id="2011725">&amp;&amp;</span>&nbsp;<span class="ident" id="2011728"><a href="/runtime/traceback.go.html#2011656">name</a></span><span class="op" id="2011732">[</span><span class="op" id="2011733">:</span><span class="ident" id="2011734"><a href="/runtime/traceback.go.html#2011683">n</a></span><span class="op" id="2011735">]</span>&nbsp;<span class="op" id="2011737">==</span>&nbsp;<span class="string" id="2011740">&#34;runtime.&#34;</span>&nbsp;<span class="op" id="2011751">&amp;&amp;</span>&nbsp;<span class="string" id="2011754">&#39;A&#39;</span>&nbsp;<span class="op" id="2011758">&lt;=</span>&nbsp;<span class="ident" id="2011761"><a href="/runtime/traceback.go.html#2011656">name</a></span><span class="op" id="2011765">[</span><span class="ident" id="2011766"><a href="/runtime/traceback.go.html#2011683">n</a></span><span class="op" id="2011767">]</span>&nbsp;<span class="op" id="2011769">&amp;&amp;</span>&nbsp;<span class="ident" id="2011772"><a href="/runtime/traceback.go.html#2011656">name</a></span><span class="op" id="2011776">[</span><span class="ident" id="2011777"><a href="/runtime/traceback.go.html#2011683">n</a></span><span class="op" id="2011778">]</span>&nbsp;<span class="op" id="2011780">&lt;=</span>&nbsp;<span class="string" id="2011783">&#39;Z&#39;</span><br>
<span class="lineno"></span><span class="op" id="2011787">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="keyword" id="2011790">var</span>&nbsp;<span class="ident" id="2011794">gStatusStrings</span>&nbsp;<span class="op" id="2011809">=</span>&nbsp;<span class="op" id="2011811">[</span><span class="op" id="2011812">...</span><span class="op" id="2011815">]</span><span class="builtintype" id="2011816">string</span><span class="op" id="2011822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011825"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015723">_Gidle</a></span><span class="op" id="2011831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2011838">&#34;idle&#34;</span><span class="op" id="2011844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011847"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015740">_Grunnable</a></span><span class="op" id="2011857">:</span>&nbsp;&nbsp;<span class="string" id="2011860">&#34;runnable&#34;</span><span class="op" id="2011870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011873"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015761">_Grunning</a></span><span class="op" id="2011882">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2011886">&#34;running&#34;</span><span class="op" id="2011895">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011898"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015781">_Gsyscall</a></span><span class="op" id="2011907">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2011911">&#34;syscall&#34;</span><span class="op" id="2011920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011923"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015801">_Gwaiting</a></span><span class="op" id="2011932">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2011936">&#34;waiting&#34;</span><span class="op" id="2011945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011948"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015849">_Gdead</a></span><span class="op" id="2011954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2011961">&#34;dead&#34;</span><span class="op" id="2011967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011970"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015866">_Genqueue</a></span><span class="op" id="2011979">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2011983">&#34;enqueue&#34;</span><span class="op" id="2011992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011995"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015886">_Gcopystack</a></span><span class="op" id="2012006">:</span>&nbsp;<span class="string" id="2012008">&#34;copystack&#34;</span><span class="op" id="2012019">,</span><br>
<span class="lineno">575</span><span class="op" id="2012021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2012024">var</span>&nbsp;<span class="ident" id="2012028">gScanStatusStrings</span>&nbsp;<span class="op" id="2012047">=</span>&nbsp;<span class="op" id="2012049">[</span><span class="op" id="2012050">...</span><span class="op" id="2012053">]</span><span class="builtintype" id="2012054">string</span><span class="op" id="2012060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2012063">0</span><span class="op" id="2012064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2012075">&#34;scan&#34;</span><span class="op" id="2012081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012084"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015740">_Grunnable</a></span><span class="op" id="2012094">:</span>&nbsp;<span class="string" id="2012096">&#34;scanrunnable&#34;</span><span class="op" id="2012110">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012113"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015761">_Grunning</a></span><span class="op" id="2012122">:</span>&nbsp;&nbsp;<span class="string" id="2012125">&#34;scanrunning&#34;</span><span class="op" id="2012138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012141"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015781">_Gsyscall</a></span><span class="op" id="2012150">:</span>&nbsp;&nbsp;<span class="string" id="2012153">&#34;scansyscall&#34;</span><span class="op" id="2012166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012169"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015801">_Gwaiting</a></span><span class="op" id="2012178">:</span>&nbsp;&nbsp;<span class="string" id="2012181">&#34;scanwaiting&#34;</span><span class="op" id="2012194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012197"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015849">_Gdead</a></span><span class="op" id="2012203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2012209">&#34;scandead&#34;</span><span class="op" id="2012219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012222"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015866">_Genqueue</a></span><span class="op" id="2012231">:</span>&nbsp;&nbsp;<span class="string" id="2012234">&#34;scanenqueue&#34;</span><span class="op" id="2012247">,</span><br>
<span class="lineno">585</span><span class="op" id="2012249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2012252">func</span>&nbsp;<span class="ident" id="2012257">goroutineheader</span><span class="op" id="2012272">(</span><span class="ident" id="2012273">gp</span>&nbsp;<span class="op" id="2012276">*</span><span class="ident" id="2012277"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2012278">)</span>&nbsp;<span class="op" id="2012280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012283">gpstatus</span>&nbsp;<span class="op" id="2012292">:=</span>&nbsp;<span class="ident" id="2012295"><a href="/runtime/stubs.go.html#1968965">readgstatus</a></span><span class="op" id="2012306">(</span><span class="ident" id="2012307"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2012309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012313">//&nbsp;Basic&nbsp;string&nbsp;status</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012337">var</span>&nbsp;<span class="ident" id="2012341">status</span>&nbsp;<span class="builtintype" id="2012348">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012356">if</span>&nbsp;<span class="num" id="2012359">0</span>&nbsp;<span class="op" id="2012361">&lt;=</span>&nbsp;<span class="ident" id="2012364"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012373">&amp;&amp;</span>&nbsp;<span class="ident" id="2012376"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012385">&lt;</span>&nbsp;<span class="builtintype" id="2012387">uint32</span><span class="op" id="2012393">(</span><span class="builtinfunc" id="2012394">len</span><span class="op" id="2012397">(</span><span class="ident" id="2012398"><a href="/runtime/traceback.go.html#2011794">gStatusStrings</a></span><span class="op" id="2012412">)</span><span class="op" id="2012413">)</span>&nbsp;<span class="op" id="2012415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012419"><a href="/runtime/traceback.go.html#2012341">status</a></span>&nbsp;<span class="op" id="2012426">=</span>&nbsp;<span class="ident" id="2012428"><a href="/runtime/traceback.go.html#2011794">gStatusStrings</a></span><span class="op" id="2012442">[</span><span class="ident" id="2012443"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span><span class="op" id="2012451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012454">}</span>&nbsp;<span class="keyword" id="2012456">else</span>&nbsp;<span class="keyword" id="2012461">if</span>&nbsp;<span class="ident" id="2012464"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span><span class="op" id="2012472">&amp;</span><span class="ident" id="2012473"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="op" id="2012480">!=</span>&nbsp;<span class="num" id="2012483">0</span>&nbsp;<span class="op" id="2012485">&amp;&amp;</span>&nbsp;<span class="num" id="2012488">0</span>&nbsp;<span class="op" id="2012490">&lt;=</span>&nbsp;<span class="ident" id="2012493"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span><span class="op" id="2012501">&amp;^</span><span class="ident" id="2012503"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="op" id="2012510">&amp;&amp;</span>&nbsp;<span class="ident" id="2012513"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span><span class="op" id="2012521">&amp;^</span><span class="ident" id="2012523"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="op" id="2012530">&lt;</span>&nbsp;<span class="builtintype" id="2012532">uint32</span><span class="op" id="2012538">(</span><span class="builtinfunc" id="2012539">len</span><span class="op" id="2012542">(</span><span class="ident" id="2012543"><a href="/runtime/traceback.go.html#2011794">gStatusStrings</a></span><span class="op" id="2012557">)</span><span class="op" id="2012558">)</span>&nbsp;<span class="op" id="2012560">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012564"><a href="/runtime/traceback.go.html#2012341">status</a></span>&nbsp;<span class="op" id="2012571">=</span>&nbsp;<span class="ident" id="2012573"><a href="/runtime/traceback.go.html#2011794">gStatusStrings</a></span><span class="op" id="2012587">[</span><span class="ident" id="2012588"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span><span class="op" id="2012596">&amp;^</span><span class="ident" id="2012598"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span><span class="op" id="2012604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012607">}</span>&nbsp;<span class="keyword" id="2012609">else</span>&nbsp;<span class="op" id="2012614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012618"><a href="/runtime/traceback.go.html#2012341">status</a></span>&nbsp;<span class="op" id="2012625">=</span>&nbsp;<span class="string" id="2012627">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012638">//&nbsp;Override.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012652">if</span>&nbsp;<span class="op" id="2012655">(</span><span class="ident" id="2012656"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012665">==</span>&nbsp;<span class="ident" id="2012668"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015801">_Gwaiting</a></span>&nbsp;<span class="op" id="2012678">||</span>&nbsp;<span class="ident" id="2012681"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012690">==</span>&nbsp;<span class="ident" id="2012693"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2016010">_Gscanwaiting</a></span><span class="op" id="2012706">)</span>&nbsp;<span class="op" id="2012708">&amp;&amp;</span>&nbsp;<span class="ident" id="2012711"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2012713">.</span><span class="ident" id="2012714">waitreason</span>&nbsp;<span class="op" id="2012725">!=</span>&nbsp;<span class="string" id="2012728">&#34;&#34;</span>&nbsp;<span class="op" id="2012731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012735"><a href="/runtime/traceback.go.html#2012341">status</a></span>&nbsp;<span class="op" id="2012742">=</span>&nbsp;<span class="ident" id="2012744"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2012746">.</span><span class="ident" id="2012747">waitreason</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012763">//&nbsp;approx&nbsp;time&nbsp;the&nbsp;G&nbsp;is&nbsp;blocked,&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012808">var</span>&nbsp;<span class="ident" id="2012812">waitfor</span>&nbsp;<span class="ident" id="2012820">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012827"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012836">&amp;^=</span>&nbsp;<span class="ident" id="2012840"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="comment" id="2012847">//&nbsp;drop&nbsp;the&nbsp;scan&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012869">if</span>&nbsp;<span class="op" id="2012872">(</span><span class="ident" id="2012873"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012882">==</span>&nbsp;<span class="ident" id="2012885"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015801">_Gwaiting</a></span>&nbsp;<span class="op" id="2012895">||</span>&nbsp;<span class="ident" id="2012898"><a href="/runtime/traceback.go.html#2012283">gpstatus</a></span>&nbsp;<span class="op" id="2012907">==</span>&nbsp;<span class="ident" id="2012910"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015781">_Gsyscall</a></span><span class="op" id="2012919">)</span>&nbsp;<span class="op" id="2012921">&amp;&amp;</span>&nbsp;<span class="ident" id="2012924"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2012926">.</span><span class="ident" id="2012927">waitsince</span>&nbsp;<span class="op" id="2012937">!=</span>&nbsp;<span class="num" id="2012940">0</span>&nbsp;<span class="op" id="2012942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012946"><a href="/runtime/traceback.go.html#2012812">waitfor</a></span>&nbsp;<span class="op" id="2012954">=</span>&nbsp;<span class="op" id="2012956">(</span><span class="ident" id="2012957"><a href="/runtime/stubs.go.html#1973903">nanotime</a></span><span class="op" id="2012965">(</span><span class="op" id="2012966">)</span>&nbsp;<span class="op" id="2012968">-</span>&nbsp;<span class="ident" id="2012970"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2012972">.</span><span class="ident" id="2012973">waitsince</span><span class="op" id="2012982">)</span>&nbsp;<span class="op" id="2012984">/</span>&nbsp;<span class="num" id="2012986">60e9</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2012995">print</span><span class="op" id="2013000">(</span><span class="string" id="2013001">&#34;goroutine&nbsp;&#34;</span><span class="op" id="2013013">,</span>&nbsp;<span class="ident" id="2013015"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2013017">.</span><span class="ident" id="2013018">goid</span><span class="op" id="2013022">,</span>&nbsp;<span class="string" id="2013024">&#34;&nbsp;[&#34;</span><span class="op" id="2013028">,</span>&nbsp;<span class="ident" id="2013030"><a href="/runtime/traceback.go.html#2012341">status</a></span><span class="op" id="2013036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013039">if</span>&nbsp;<span class="ident" id="2013042"><a href="/runtime/traceback.go.html#2012812">waitfor</a></span>&nbsp;<span class="op" id="2013050">&gt;=</span>&nbsp;<span class="num" id="2013053">1</span>&nbsp;<span class="op" id="2013055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013059">print</span><span class="op" id="2013064">(</span><span class="string" id="2013065">&#34;,&nbsp;&#34;</span><span class="op" id="2013069">,</span>&nbsp;<span class="ident" id="2013071"><a href="/runtime/traceback.go.html#2012812">waitfor</a></span><span class="op" id="2013078">,</span>&nbsp;<span class="string" id="2013080">&#34;&nbsp;minutes&#34;</span><span class="op" id="2013090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013093">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013096">if</span>&nbsp;<span class="ident" id="2013099"><a href="/runtime/traceback.go.html#2012273">gp</a></span><span class="op" id="2013101">.</span><span class="ident" id="2013102">lockedm</span>&nbsp;<span class="op" id="2013110">!=</span>&nbsp;<span class="ident" id="2013113">nil</span>&nbsp;<span class="op" id="2013117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013121">print</span><span class="op" id="2013126">(</span><span class="string" id="2013127">&#34;,&nbsp;locked&nbsp;to&nbsp;thread&#34;</span><span class="op" id="2013147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013153">print</span><span class="op" id="2013158">(</span><span class="string" id="2013159">&#34;]:\n&#34;</span><span class="op" id="2013165">)</span><br>
<span class="lineno"></span><span class="op" id="2013167">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="2013170">func</span>&nbsp;<span class="ident" id="2013175">tracebackothers</span><span class="op" id="2013190">(</span><span class="ident" id="2013191">me</span>&nbsp;<span class="op" id="2013194">*</span><span class="ident" id="2013195"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="2013196">)</span>&nbsp;<span class="op" id="2013198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013201">level</span>&nbsp;<span class="op" id="2013207">:=</span>&nbsp;<span class="ident" id="2013210"><a href="/runtime/stubs.go.html#1976669">gotraceback</a></span><span class="op" id="2013221">(</span><span class="ident" id="2013222">nil</span><span class="op" id="2013225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2013229">//&nbsp;Show&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;first,&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;already.</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013290">g</span>&nbsp;<span class="op" id="2013292">:=</span>&nbsp;<span class="ident" id="2013295"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="2013299">(</span><span class="op" id="2013300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013303">gp</span>&nbsp;<span class="op" id="2013306">:=</span>&nbsp;<span class="ident" id="2013309"><a href="/runtime/traceback.go.html#2013290">g</a></span><span class="op" id="2013310">.</span><span class="ident" id="2013311">m</span><span class="op" id="2013312">.</span><span class="ident" id="2013313">curg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013319">if</span>&nbsp;<span class="ident" id="2013322"><a href="/runtime/traceback.go.html#2013303">gp</a></span>&nbsp;<span class="op" id="2013325">!=</span>&nbsp;<span class="ident" id="2013328">nil</span>&nbsp;<span class="op" id="2013332">&amp;&amp;</span>&nbsp;<span class="ident" id="2013335"><a href="/runtime/traceback.go.html#2013303">gp</a></span>&nbsp;<span class="op" id="2013338">!=</span>&nbsp;<span class="ident" id="2013341"><a href="/runtime/traceback.go.html#2013191">me</a></span>&nbsp;<span class="op" id="2013344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013348">print</span><span class="op" id="2013353">(</span><span class="string" id="2013354">&#34;\n&#34;</span><span class="op" id="2013358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013362"><a href="/runtime/traceback.go.html#2012257">goroutineheader</a></span><span class="op" id="2013377">(</span><span class="ident" id="2013378"><a href="/runtime/traceback.go.html#2013303">gp</a></span><span class="op" id="2013380">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013384"><a href="/runtime/traceback.go.html#2009235">traceback</a></span><span class="op" id="2013393">(</span><span class="op" id="2013394">^</span><span class="builtintype" id="2013395">uintptr</span><span class="op" id="2013402">(</span><span class="num" id="2013403">0</span><span class="op" id="2013404">)</span><span class="op" id="2013405">,</span>&nbsp;<span class="op" id="2013407">^</span><span class="builtintype" id="2013408">uintptr</span><span class="op" id="2013415">(</span><span class="num" id="2013416">0</span><span class="op" id="2013417">)</span><span class="op" id="2013418">,</span>&nbsp;<span class="num" id="2013420">0</span><span class="op" id="2013421">,</span>&nbsp;<span class="ident" id="2013423"><a href="/runtime/traceback.go.html#2013303">gp</a></span><span class="op" id="2013425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013432"><a href="/runtime/lock_futex.go.html#1815304">lock</a></span><span class="op" id="2013436">(</span><span class="op" id="2013437">&amp;</span><span class="ident" id="2013438"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2033596">allglock</a></span><span class="op" id="2013446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013449">for</span>&nbsp;<span class="ident" id="2013453">_</span><span class="op" id="2013454">,</span>&nbsp;<span class="ident" id="2013456">gp</span>&nbsp;<span class="op" id="2013459">:=</span>&nbsp;<span class="keyword" id="2013462">range</span>&nbsp;<span class="ident" id="2013468"><a href="/runtime/mprof.go.html#1863497">allgs</a></span>&nbsp;<span class="op" id="2013474">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013478">if</span>&nbsp;<span class="ident" id="2013481"><a href="/runtime/traceback.go.html#2013456">gp</a></span>&nbsp;<span class="op" id="2013484">==</span>&nbsp;<span class="ident" id="2013487"><a href="/runtime/traceback.go.html#2013191">me</a></span>&nbsp;<span class="op" id="2013490">||</span>&nbsp;<span class="ident" id="2013493"><a href="/runtime/traceback.go.html#2013456">gp</a></span>&nbsp;<span class="op" id="2013496">==</span>&nbsp;<span class="ident" id="2013499"><a href="/runtime/traceback.go.html#2013290">g</a></span><span class="op" id="2013500">.</span><span class="ident" id="2013501">m</span><span class="op" id="2013502">.</span><span class="ident" id="2013503">curg</span>&nbsp;<span class="op" id="2013508">||</span>&nbsp;<span class="ident" id="2013511"><a href="/runtime/stubs.go.html#1968965">readgstatus</a></span><span class="op" id="2013522">(</span><span class="ident" id="2013523"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013525">)</span>&nbsp;<span class="op" id="2013527">==</span>&nbsp;<span class="ident" id="2013530"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015849">_Gdead</a></span>&nbsp;<span class="op" id="2013537">||</span>&nbsp;<span class="ident" id="2013540"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013542">.</span><span class="ident" id="2013543">issystem</span>&nbsp;<span class="op" id="2013552">&amp;&amp;</span>&nbsp;<span class="ident" id="2013555"><a href="/runtime/traceback.go.html#2013201">level</a></span>&nbsp;<span class="op" id="2013561">&lt;</span>&nbsp;<span class="num" id="2013563">2</span>&nbsp;<span class="op" id="2013565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013570">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013585">print</span><span class="op" id="2013590">(</span><span class="string" id="2013591">&#34;\n&#34;</span><span class="op" id="2013595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013599"><a href="/runtime/traceback.go.html#2012257">goroutineheader</a></span><span class="op" id="2013614">(</span><span class="ident" id="2013615"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013617">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013621">if</span>&nbsp;<span class="ident" id="2013624"><a href="/runtime/stubs.go.html#1968965">readgstatus</a></span><span class="op" id="2013635">(</span><span class="ident" id="2013636"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013638">)</span><span class="op" id="2013639">&amp;^</span><span class="ident" id="2013641"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015908">_Gscan</a></span>&nbsp;<span class="op" id="2013648">==</span>&nbsp;<span class="ident" id="2013651"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2015761">_Grunning</a></span>&nbsp;<span class="op" id="2013661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013666">print</span><span class="op" id="2013671">(</span><span class="string" id="2013672">&#34;\tgoroutine&nbsp;running&nbsp;on&nbsp;other&nbsp;thread;&nbsp;stack&nbsp;unavailable\n&#34;</span><span class="op" id="2013730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013735"><a href="/runtime/traceback.go.html#2008739">printcreatedby</a></span><span class="op" id="2013749">(</span><span class="ident" id="2013750"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013756">}</span>&nbsp;<span class="keyword" id="2013758">else</span>&nbsp;<span class="op" id="2013763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013768"><a href="/runtime/traceback.go.html#2009235">traceback</a></span><span class="op" id="2013777">(</span><span class="op" id="2013778">^</span><span class="builtintype" id="2013779">uintptr</span><span class="op" id="2013786">(</span><span class="num" id="2013787">0</span><span class="op" id="2013788">)</span><span class="op" id="2013789">,</span>&nbsp;<span class="op" id="2013791">^</span><span class="builtintype" id="2013792">uintptr</span><span class="op" id="2013799">(</span><span class="num" id="2013800">0</span><span class="op" id="2013801">)</span><span class="op" id="2013802">,</span>&nbsp;<span class="num" id="2013804">0</span><span class="op" id="2013805">,</span>&nbsp;<span class="ident" id="2013807"><a href="/runtime/traceback.go.html#2013456">gp</a></span><span class="op" id="2013809">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013819"><a href="/runtime/lock_futex.go.html#1816596">unlock</a></span><span class="op" id="2013825">(</span><span class="op" id="2013826">&amp;</span><span class="ident" id="2013827"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2033596">allglock</a></span><span class="op" id="2013835">)</span><br>
<span class="lineno"></span><span class="op" id="2013837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2013840">//&nbsp;Does&nbsp;f&nbsp;mark&nbsp;the&nbsp;top&nbsp;of&nbsp;a&nbsp;goroutine&nbsp;stack?</span><br>
<span class="lineno"></span><span class="keyword" id="2013885">func</span>&nbsp;<span class="ident" id="2013890">topofstack</span><span class="op" id="2013900">(</span><span class="ident" id="2013901">f</span>&nbsp;<span class="op" id="2013903">*</span><span class="ident" id="2013904"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2019504">_func</a></span><span class="op" id="2013909">)</span>&nbsp;<span class="builtintype" id="2013911">bool</span>&nbsp;<span class="op" id="2013916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013919">pc</span>&nbsp;<span class="op" id="2013922">:=</span>&nbsp;<span class="ident" id="2013925"><a href="/runtime/traceback.go.html#2013901">f</a></span><span class="op" id="2013926">.</span><span class="ident" id="2013927">entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013934">return</span>&nbsp;<span class="ident" id="2013941"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2013944">==</span>&nbsp;<span class="ident" id="2013947"><a href="/runtime/traceback.go.html#1994293">goexitPC</a></span>&nbsp;<span class="op" id="2013956">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013961"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2013964">==</span>&nbsp;<span class="ident" id="2013967"><a href="/runtime/traceback.go.html#1994377">mstartPC</a></span>&nbsp;<span class="op" id="2013976">||</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013981"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2013984">==</span>&nbsp;<span class="ident" id="2013987"><a href="/runtime/traceback.go.html#1994335">mcallPC</a></span>&nbsp;<span class="op" id="2013995">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014000"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2014003">==</span>&nbsp;<span class="ident" id="2014006"><a href="/runtime/traceback.go.html#1994356">morestackPC</a></span>&nbsp;<span class="op" id="2014018">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014023"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2014026">==</span>&nbsp;<span class="ident" id="2014029"><a href="/runtime/traceback.go.html#1994419">rt0_goPC</a></span>&nbsp;<span class="op" id="2014038">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014043"><a href="/runtime/traceback.go.html#1994462">externalthreadhandlerp</a></span>&nbsp;<span class="op" id="2014066">!=</span>&nbsp;<span class="num" id="2014069">0</span>&nbsp;<span class="op" id="2014071">&amp;&amp;</span>&nbsp;<span class="ident" id="2014074"><a href="/runtime/traceback.go.html#2013919">pc</a></span>&nbsp;<span class="op" id="2014077">==</span>&nbsp;<span class="ident" id="2014080"><a href="/runtime/traceback.go.html#1994462">externalthreadhandlerp</a></span><br>
<span class="lineno"></span><span class="op" id="2014103">}</span>
</div>
</body>
</html>
