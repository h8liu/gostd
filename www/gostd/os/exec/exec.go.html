<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4678150">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4678205">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4678259">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4678310">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4678386">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="4678460">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="4678476">package</span>&nbsp;<span class="ident" id="4678484">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4678490">import</span>&nbsp;<span class="op" id="4678497">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678500">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678509">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678519">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678525">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678531">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678548">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678559">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678570">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678581">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4678589">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4678599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4678602">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="4678667">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="4678696">type</span>&nbsp;<span class="ident" id="4678701">Error</span>&nbsp;<span class="keyword" id="4678707">struct</span>&nbsp;<span class="op" id="4678714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678717">Name</span>&nbsp;<span class="builtintype" id="4678722">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678730">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4678735">error</span><br>
<span class="lineno"></span><span class="op" id="4678741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4678744">func</span>&nbsp;<span class="op" id="4678749">(</span><span class="ident" id="4678750">e</span>&nbsp;<span class="op" id="4678752">*</span><span class="ident" id="4678753">Error</span><span class="op" id="4678758">)</span>&nbsp;<span class="ident" id="4678760">Error</span><span class="op" id="4678765">(</span><span class="op" id="4678766">)</span>&nbsp;<span class="builtintype" id="4678768">string</span>&nbsp;<span class="op" id="4678775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678778">return</span>&nbsp;<span class="string" id="4678785">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="4678794">+</span>&nbsp;<span class="ident" id="4678796">strconv</span><span class="op" id="4678803">.</span><span class="ident" id="4678804">Quote</span><span class="op" id="4678809">(</span><span class="ident" id="4678810">e</span><span class="op" id="4678811">.</span><span class="ident" id="4678812">Name</span><span class="op" id="4678816">)</span>&nbsp;<span class="op" id="4678818">+</span>&nbsp;<span class="string" id="4678820">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4678825">+</span>&nbsp;<span class="ident" id="4678827">e</span><span class="op" id="4678828">.</span><span class="ident" id="4678829">Err</span><span class="op" id="4678832">.</span><span class="ident" id="4678833">Error</span><span class="op" id="4678838">(</span><span class="op" id="4678839">)</span><br>
<span class="lineno"></span><span class="op" id="4678841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4678844">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="4678905">type</span>&nbsp;<span class="ident" id="4678910">Cmd</span>&nbsp;<span class="keyword" id="4678914">struct</span>&nbsp;<span class="op" id="4678921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678924">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678968">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678972">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679030">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679087">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679099">Path</span>&nbsp;<span class="builtintype" id="4679104">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679113">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679186">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679242">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679246">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679313">Args</span>&nbsp;<span class="op" id="4679318">[</span><span class="op" id="4679319">]</span><span class="builtintype" id="4679320">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679329">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679379">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679442">Env</span>&nbsp;<span class="op" id="4679446">[</span><span class="op" id="4679447">]</span><span class="builtintype" id="4679448">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679457">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679513">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679573">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679614">Dir</span>&nbsp;<span class="builtintype" id="4679618">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679627">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679677">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679751">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679822">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679849">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679911">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4679980">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680054">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680120">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680196">Stdin</span>&nbsp;<span class="ident" id="4680202">io</span><span class="op" id="4680204">.</span><span class="ident" id="4680205">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680214">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680285">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680289">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680358">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680395">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680399">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680457">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680498">Stdout</span>&nbsp;<span class="ident" id="4680505">io</span><span class="op" id="4680507">.</span><span class="ident" id="4680508">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680516">Stderr</span>&nbsp;<span class="ident" id="4680523">io</span><span class="op" id="4680525">.</span><span class="ident" id="4680526">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680535">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680605">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680678">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680747">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680751">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680826">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680859">ExtraFiles</span>&nbsp;<span class="op" id="4680870">[</span><span class="op" id="4680871">]</span><span class="op" id="4680872">*</span><span class="ident" id="4680873">os</span><span class="op" id="4680875">.</span><span class="ident" id="4680876">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680883">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4680953">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681022">SysProcAttr</span>&nbsp;<span class="op" id="4681034">*</span><span class="ident" id="4681035">syscall</span><span class="op" id="4681042">.</span><span class="ident" id="4681043">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681057">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681110">Process</span>&nbsp;<span class="op" id="4681118">*</span><span class="ident" id="4681119">os</span><span class="op" id="4681121">.</span><span class="ident" id="4681122">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681132">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4681195">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681238">ProcessState</span>&nbsp;<span class="op" id="4681251">*</span><span class="ident" id="4681252">os</span><span class="op" id="4681254">.</span><span class="ident" id="4681255">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681270">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4681286">error</span>&nbsp;<span class="comment" id="4681292">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681320">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4681336">bool</span>&nbsp;&nbsp;<span class="comment" id="4681342">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681367">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681383">[</span><span class="op" id="4681384">]</span><span class="op" id="4681385">*</span><span class="ident" id="4681386">os</span><span class="op" id="4681388">.</span><span class="ident" id="4681389">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681395">closeAfterStart</span>&nbsp;<span class="op" id="4681411">[</span><span class="op" id="4681412">]</span><span class="ident" id="4681413">io</span><span class="op" id="4681415">.</span><span class="ident" id="4681416">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681424">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="4681440">[</span><span class="op" id="4681441">]</span><span class="ident" id="4681442">io</span><span class="op" id="4681444">.</span><span class="ident" id="4681445">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681453">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681469">[</span><span class="op" id="4681470">]</span><span class="keyword" id="4681471">func</span><span class="op" id="4681475">(</span><span class="op" id="4681476">)</span>&nbsp;<span class="builtintype" id="4681478">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681485">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681501">chan</span>&nbsp;<span class="builtintype" id="4681506">error</span>&nbsp;<span class="comment" id="4681512">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="4681538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4681541">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4681609">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4681633">//</span><br>
<span class="lineno">110</span><span class="comment" id="4681636">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="4681697">//</span><br>
<span class="lineno"></span><span class="comment" id="4681700">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4681765">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4681835">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="4681853">//</span><br>
<span class="lineno"></span><span class="comment" id="4681856">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4681926">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4681992">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="4682054">func</span>&nbsp;<span class="ident" id="4682059">Command</span><span class="op" id="4682066">(</span><span class="ident" id="4682067">name</span>&nbsp;<span class="builtintype" id="4682072">string</span><span class="op" id="4682078">,</span>&nbsp;<span class="ident" id="4682080">arg</span>&nbsp;<span class="op" id="4682084">...</span><span class="builtintype" id="4682087">string</span><span class="op" id="4682093">)</span>&nbsp;<span class="op" id="4682095">*</span><span class="ident" id="4682096">Cmd</span>&nbsp;<span class="op" id="4682100">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682103">cmd</span>&nbsp;<span class="op" id="4682107">:=</span>&nbsp;<span class="op" id="4682110">&amp;</span><span class="ident" id="4682111">Cmd</span><span class="op" id="4682114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682118">Path</span><span class="op" id="4682122">:</span>&nbsp;<span class="ident" id="4682124">name</span><span class="op" id="4682128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682132">Args</span><span class="op" id="4682136">:</span>&nbsp;<span class="builtinfunc" id="4682138">append</span><span class="op" id="4682144">(</span><span class="op" id="4682145">[</span><span class="op" id="4682146">]</span><span class="builtintype" id="4682147">string</span><span class="op" id="4682153">{</span><span class="ident" id="4682154">name</span><span class="op" id="4682158">}</span><span class="op" id="4682159">,</span>&nbsp;<span class="ident" id="4682161">arg</span><span class="op" id="4682164">...</span><span class="op" id="4682167">)</span><span class="op" id="4682168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682174">if</span>&nbsp;<span class="ident" id="4682177">filepath</span><span class="op" id="4682185">.</span><span class="ident" id="4682186">Base</span><span class="op" id="4682190">(</span><span class="ident" id="4682191">name</span><span class="op" id="4682195">)</span>&nbsp;<span class="op" id="4682197">==</span>&nbsp;<span class="ident" id="4682200">name</span>&nbsp;<span class="op" id="4682205">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682209">if</span>&nbsp;<span class="ident" id="4682212">lp</span><span class="op" id="4682214">,</span>&nbsp;<span class="ident" id="4682216">err</span>&nbsp;<span class="op" id="4682220">:=</span>&nbsp;<span class="ident" id="4682223">LookPath</span><span class="op" id="4682231">(</span><span class="ident" id="4682232">name</span><span class="op" id="4682236">)</span><span class="op" id="4682237">;</span>&nbsp;<span class="ident" id="4682239">err</span>&nbsp;<span class="op" id="4682243">!=</span>&nbsp;<span class="builtintype" id="4682246">nil</span>&nbsp;<span class="op" id="4682250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682255">cmd</span><span class="op" id="4682258">.</span><span class="ident" id="4682259">lookPathErr</span>&nbsp;<span class="op" id="4682271">=</span>&nbsp;<span class="ident" id="4682273">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682279">}</span>&nbsp;<span class="keyword" id="4682281">else</span>&nbsp;<span class="op" id="4682286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682291">cmd</span><span class="op" id="4682294">.</span><span class="ident" id="4682295">Path</span>&nbsp;<span class="op" id="4682300">=</span>&nbsp;<span class="ident" id="4682302">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682307">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682313">return</span>&nbsp;<span class="ident" id="4682320">cmd</span><br>
<span class="lineno"></span><span class="op" id="4682324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4682327">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="4682398">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4682454">func</span>&nbsp;<span class="ident" id="4682459">interfaceEqual</span><span class="op" id="4682473">(</span><span class="ident" id="4682474">a</span><span class="op" id="4682475">,</span>&nbsp;<span class="ident" id="4682477">b</span>&nbsp;<span class="keyword" id="4682479">interface</span><span class="op" id="4682488">{</span><span class="op" id="4682489">}</span><span class="op" id="4682490">)</span>&nbsp;<span class="builtintype" id="4682492">bool</span>&nbsp;<span class="op" id="4682497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682500">defer</span>&nbsp;<span class="keyword" id="4682506">func</span><span class="op" id="4682510">(</span><span class="op" id="4682511">)</span>&nbsp;<span class="op" id="4682513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4682517">recover</span><span class="op" id="4682524">(</span><span class="op" id="4682525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682528">}</span><span class="op" id="4682529">(</span><span class="op" id="4682530">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682533">return</span>&nbsp;<span class="ident" id="4682540">a</span>&nbsp;<span class="op" id="4682542">==</span>&nbsp;<span class="ident" id="4682545">b</span><br>
<span class="lineno"></span><span class="op" id="4682547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682550">func</span>&nbsp;<span class="op" id="4682555">(</span><span class="ident" id="4682556">c</span>&nbsp;<span class="op" id="4682558">*</span><span class="ident" id="4682559">Cmd</span><span class="op" id="4682562">)</span>&nbsp;<span class="ident" id="4682564">envv</span><span class="op" id="4682568">(</span><span class="op" id="4682569">)</span>&nbsp;<span class="op" id="4682571">[</span><span class="op" id="4682572">]</span><span class="builtintype" id="4682573">string</span>&nbsp;<span class="op" id="4682580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682583">if</span>&nbsp;<span class="ident" id="4682586">c</span><span class="op" id="4682587">.</span><span class="ident" id="4682588">Env</span>&nbsp;<span class="op" id="4682592">!=</span>&nbsp;<span class="builtintype" id="4682595">nil</span>&nbsp;<span class="op" id="4682599">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682603">return</span>&nbsp;<span class="ident" id="4682610">c</span><span class="op" id="4682611">.</span><span class="ident" id="4682612">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682620">return</span>&nbsp;<span class="ident" id="4682627">os</span><span class="op" id="4682629">.</span><span class="ident" id="4682630">Environ</span><span class="op" id="4682637">(</span><span class="op" id="4682638">)</span><br>
<span class="lineno"></span><span class="op" id="4682640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="4682643">func</span>&nbsp;<span class="op" id="4682648">(</span><span class="ident" id="4682649">c</span>&nbsp;<span class="op" id="4682651">*</span><span class="ident" id="4682652">Cmd</span><span class="op" id="4682655">)</span>&nbsp;<span class="ident" id="4682657">argv</span><span class="op" id="4682661">(</span><span class="op" id="4682662">)</span>&nbsp;<span class="op" id="4682664">[</span><span class="op" id="4682665">]</span><span class="builtintype" id="4682666">string</span>&nbsp;<span class="op" id="4682673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682676">if</span>&nbsp;<span class="builtinfunc" id="4682679">len</span><span class="op" id="4682682">(</span><span class="ident" id="4682683">c</span><span class="op" id="4682684">.</span><span class="ident" id="4682685">Args</span><span class="op" id="4682689">)</span>&nbsp;<span class="op" id="4682691">&gt;</span>&nbsp;<span class="num" id="4682693">0</span>&nbsp;<span class="op" id="4682695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682699">return</span>&nbsp;<span class="ident" id="4682706">c</span><span class="op" id="4682707">.</span><span class="ident" id="4682708">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682717">return</span>&nbsp;<span class="op" id="4682724">[</span><span class="op" id="4682725">]</span><span class="builtintype" id="4682726">string</span><span class="op" id="4682732">{</span><span class="ident" id="4682733">c</span><span class="op" id="4682734">.</span><span class="ident" id="4682735">Path</span><span class="op" id="4682739">}</span><br>
<span class="lineno">155</span><span class="op" id="4682741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682744">func</span>&nbsp;<span class="op" id="4682749">(</span><span class="ident" id="4682750">c</span>&nbsp;<span class="op" id="4682752">*</span><span class="ident" id="4682753">Cmd</span><span class="op" id="4682756">)</span>&nbsp;<span class="ident" id="4682758">stdin</span><span class="op" id="4682763">(</span><span class="op" id="4682764">)</span>&nbsp;<span class="op" id="4682766">(</span><span class="ident" id="4682767">f</span>&nbsp;<span class="op" id="4682769">*</span><span class="ident" id="4682770">os</span><span class="op" id="4682772">.</span><span class="ident" id="4682773">File</span><span class="op" id="4682777">,</span>&nbsp;<span class="ident" id="4682779">err</span>&nbsp;<span class="builtintype" id="4682783">error</span><span class="op" id="4682788">)</span>&nbsp;<span class="op" id="4682790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682793">if</span>&nbsp;<span class="ident" id="4682796">c</span><span class="op" id="4682797">.</span><span class="ident" id="4682798">Stdin</span>&nbsp;<span class="op" id="4682804">==</span>&nbsp;<span class="builtintype" id="4682807">nil</span>&nbsp;<span class="op" id="4682811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682815">f</span><span class="op" id="4682816">,</span>&nbsp;<span class="ident" id="4682818">err</span>&nbsp;<span class="op" id="4682822">=</span>&nbsp;<span class="ident" id="4682824">os</span><span class="op" id="4682826">.</span><span class="ident" id="4682827">Open</span><span class="op" id="4682831">(</span><span class="ident" id="4682832">os</span><span class="op" id="4682834">.</span><span class="ident" id="4682835">DevNull</span><span class="op" id="4682842">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682846">if</span>&nbsp;<span class="ident" id="4682849">err</span>&nbsp;<span class="op" id="4682853">!=</span>&nbsp;<span class="builtintype" id="4682856">nil</span>&nbsp;<span class="op" id="4682860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682865">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682878">c</span><span class="op" id="4682879">.</span><span class="ident" id="4682880">closeAfterStart</span>&nbsp;<span class="op" id="4682896">=</span>&nbsp;<span class="builtinfunc" id="4682898">append</span><span class="op" id="4682904">(</span><span class="ident" id="4682905">c</span><span class="op" id="4682906">.</span><span class="ident" id="4682907">closeAfterStart</span><span class="op" id="4682922">,</span>&nbsp;<span class="ident" id="4682924">f</span><span class="op" id="4682925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682929">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682941">if</span>&nbsp;<span class="ident" id="4682944">f</span><span class="op" id="4682945">,</span>&nbsp;<span class="ident" id="4682947">ok</span>&nbsp;<span class="op" id="4682950">:=</span>&nbsp;<span class="ident" id="4682953">c</span><span class="op" id="4682954">.</span><span class="ident" id="4682955">Stdin</span><span class="op" id="4682960">.</span><span class="op" id="4682961">(</span><span class="op" id="4682962">*</span><span class="ident" id="4682963">os</span><span class="op" id="4682965">.</span><span class="ident" id="4682966">File</span><span class="op" id="4682970">)</span><span class="op" id="4682971">;</span>&nbsp;<span class="ident" id="4682973">ok</span>&nbsp;<span class="op" id="4682976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682980">return</span>&nbsp;<span class="ident" id="4682987">f</span><span class="op" id="4682988">,</span>&nbsp;<span class="builtintype" id="4682990">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682995">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682999">pr</span><span class="op" id="4683001">,</span>&nbsp;<span class="ident" id="4683003">pw</span><span class="op" id="4683005">,</span>&nbsp;<span class="ident" id="4683007">err</span>&nbsp;<span class="op" id="4683011">:=</span>&nbsp;<span class="ident" id="4683014">os</span><span class="op" id="4683016">.</span><span class="ident" id="4683017">Pipe</span><span class="op" id="4683021">(</span><span class="op" id="4683022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683025">if</span>&nbsp;<span class="ident" id="4683028">err</span>&nbsp;<span class="op" id="4683032">!=</span>&nbsp;<span class="builtintype" id="4683035">nil</span>&nbsp;<span class="op" id="4683039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683043">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683051">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683055">c</span><span class="op" id="4683056">.</span><span class="ident" id="4683057">closeAfterStart</span>&nbsp;<span class="op" id="4683073">=</span>&nbsp;<span class="builtinfunc" id="4683075">append</span><span class="op" id="4683081">(</span><span class="ident" id="4683082">c</span><span class="op" id="4683083">.</span><span class="ident" id="4683084">closeAfterStart</span><span class="op" id="4683099">,</span>&nbsp;<span class="ident" id="4683101">pr</span><span class="op" id="4683103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683106">c</span><span class="op" id="4683107">.</span><span class="ident" id="4683108">closeAfterWait</span>&nbsp;<span class="op" id="4683123">=</span>&nbsp;<span class="builtinfunc" id="4683125">append</span><span class="op" id="4683131">(</span><span class="ident" id="4683132">c</span><span class="op" id="4683133">.</span><span class="ident" id="4683134">closeAfterWait</span><span class="op" id="4683148">,</span>&nbsp;<span class="ident" id="4683150">pw</span><span class="op" id="4683152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683155">c</span><span class="op" id="4683156">.</span><span class="ident" id="4683157">goroutine</span>&nbsp;<span class="op" id="4683167">=</span>&nbsp;<span class="builtinfunc" id="4683169">append</span><span class="op" id="4683175">(</span><span class="ident" id="4683176">c</span><span class="op" id="4683177">.</span><span class="ident" id="4683178">goroutine</span><span class="op" id="4683187">,</span>&nbsp;<span class="keyword" id="4683189">func</span><span class="op" id="4683193">(</span><span class="op" id="4683194">)</span>&nbsp;<span class="builtintype" id="4683196">error</span>&nbsp;<span class="op" id="4683202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683206">_</span><span class="op" id="4683207">,</span>&nbsp;<span class="ident" id="4683209">err</span>&nbsp;<span class="op" id="4683213">:=</span>&nbsp;<span class="ident" id="4683216">io</span><span class="op" id="4683218">.</span><span class="ident" id="4683219">Copy</span><span class="op" id="4683223">(</span><span class="ident" id="4683224">pw</span><span class="op" id="4683226">,</span>&nbsp;<span class="ident" id="4683228">c</span><span class="op" id="4683229">.</span><span class="ident" id="4683230">Stdin</span><span class="op" id="4683235">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683239">if</span>&nbsp;<span class="ident" id="4683242">err1</span>&nbsp;<span class="op" id="4683247">:=</span>&nbsp;<span class="ident" id="4683250">pw</span><span class="op" id="4683252">.</span><span class="ident" id="4683253">Close</span><span class="op" id="4683258">(</span><span class="op" id="4683259">)</span><span class="op" id="4683260">;</span>&nbsp;<span class="ident" id="4683262">err</span>&nbsp;<span class="op" id="4683266">==</span>&nbsp;<span class="builtintype" id="4683269">nil</span>&nbsp;<span class="op" id="4683273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683278">err</span>&nbsp;<span class="op" id="4683282">=</span>&nbsp;<span class="ident" id="4683284">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683295">return</span>&nbsp;<span class="ident" id="4683302">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683307">}</span><span class="op" id="4683308">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683311">return</span>&nbsp;<span class="ident" id="4683318">pr</span><span class="op" id="4683320">,</span>&nbsp;<span class="builtintype" id="4683322">nil</span><br>
<span class="lineno"></span><span class="op" id="4683326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4683329">func</span>&nbsp;<span class="op" id="4683334">(</span><span class="ident" id="4683335">c</span>&nbsp;<span class="op" id="4683337">*</span><span class="ident" id="4683338">Cmd</span><span class="op" id="4683341">)</span>&nbsp;<span class="ident" id="4683343">stdout</span><span class="op" id="4683349">(</span><span class="op" id="4683350">)</span>&nbsp;<span class="op" id="4683352">(</span><span class="ident" id="4683353">f</span>&nbsp;<span class="op" id="4683355">*</span><span class="ident" id="4683356">os</span><span class="op" id="4683358">.</span><span class="ident" id="4683359">File</span><span class="op" id="4683363">,</span>&nbsp;<span class="ident" id="4683365">err</span>&nbsp;<span class="builtintype" id="4683369">error</span><span class="op" id="4683374">)</span>&nbsp;<span class="op" id="4683376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683379">return</span>&nbsp;<span class="ident" id="4683386">c</span><span class="op" id="4683387">.</span><span class="ident" id="4683388">writerDescriptor</span><span class="op" id="4683404">(</span><span class="ident" id="4683405">c</span><span class="op" id="4683406">.</span><span class="ident" id="4683407">Stdout</span><span class="op" id="4683413">)</span><br>
<span class="lineno">190</span><span class="op" id="4683415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4683418">func</span>&nbsp;<span class="op" id="4683423">(</span><span class="ident" id="4683424">c</span>&nbsp;<span class="op" id="4683426">*</span><span class="ident" id="4683427">Cmd</span><span class="op" id="4683430">)</span>&nbsp;<span class="ident" id="4683432">stderr</span><span class="op" id="4683438">(</span><span class="op" id="4683439">)</span>&nbsp;<span class="op" id="4683441">(</span><span class="ident" id="4683442">f</span>&nbsp;<span class="op" id="4683444">*</span><span class="ident" id="4683445">os</span><span class="op" id="4683447">.</span><span class="ident" id="4683448">File</span><span class="op" id="4683452">,</span>&nbsp;<span class="ident" id="4683454">err</span>&nbsp;<span class="builtintype" id="4683458">error</span><span class="op" id="4683463">)</span>&nbsp;<span class="op" id="4683465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683468">if</span>&nbsp;<span class="ident" id="4683471">c</span><span class="op" id="4683472">.</span><span class="ident" id="4683473">Stderr</span>&nbsp;<span class="op" id="4683480">!=</span>&nbsp;<span class="builtintype" id="4683483">nil</span>&nbsp;<span class="op" id="4683487">&amp;&amp;</span>&nbsp;<span class="ident" id="4683490">interfaceEqual</span><span class="op" id="4683504">(</span><span class="ident" id="4683505">c</span><span class="op" id="4683506">.</span><span class="ident" id="4683507">Stderr</span><span class="op" id="4683513">,</span>&nbsp;<span class="ident" id="4683515">c</span><span class="op" id="4683516">.</span><span class="ident" id="4683517">Stdout</span><span class="op" id="4683523">)</span>&nbsp;<span class="op" id="4683525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683529">return</span>&nbsp;<span class="ident" id="4683536">c</span><span class="op" id="4683537">.</span><span class="ident" id="4683538">childFiles</span><span class="op" id="4683548">[</span><span class="num" id="4683549">1</span><span class="op" id="4683550">]</span><span class="op" id="4683551">,</span>&nbsp;<span class="builtintype" id="4683553">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683561">return</span>&nbsp;<span class="ident" id="4683568">c</span><span class="op" id="4683569">.</span><span class="ident" id="4683570">writerDescriptor</span><span class="op" id="4683586">(</span><span class="ident" id="4683587">c</span><span class="op" id="4683588">.</span><span class="ident" id="4683589">Stderr</span><span class="op" id="4683595">)</span><br>
<span class="lineno"></span><span class="op" id="4683597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4683600">func</span>&nbsp;<span class="op" id="4683605">(</span><span class="ident" id="4683606">c</span>&nbsp;<span class="op" id="4683608">*</span><span class="ident" id="4683609">Cmd</span><span class="op" id="4683612">)</span>&nbsp;<span class="ident" id="4683614">writerDescriptor</span><span class="op" id="4683630">(</span><span class="ident" id="4683631">w</span>&nbsp;<span class="ident" id="4683633">io</span><span class="op" id="4683635">.</span><span class="ident" id="4683636">Writer</span><span class="op" id="4683642">)</span>&nbsp;<span class="op" id="4683644">(</span><span class="ident" id="4683645">f</span>&nbsp;<span class="op" id="4683647">*</span><span class="ident" id="4683648">os</span><span class="op" id="4683650">.</span><span class="ident" id="4683651">File</span><span class="op" id="4683655">,</span>&nbsp;<span class="ident" id="4683657">err</span>&nbsp;<span class="builtintype" id="4683661">error</span><span class="op" id="4683666">)</span>&nbsp;<span class="op" id="4683668">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683671">if</span>&nbsp;<span class="ident" id="4683674">w</span>&nbsp;<span class="op" id="4683676">==</span>&nbsp;<span class="builtintype" id="4683679">nil</span>&nbsp;<span class="op" id="4683683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683687">f</span><span class="op" id="4683688">,</span>&nbsp;<span class="ident" id="4683690">err</span>&nbsp;<span class="op" id="4683694">=</span>&nbsp;<span class="ident" id="4683696">os</span><span class="op" id="4683698">.</span><span class="ident" id="4683699">OpenFile</span><span class="op" id="4683707">(</span><span class="ident" id="4683708">os</span><span class="op" id="4683710">.</span><span class="ident" id="4683711">DevNull</span><span class="op" id="4683718">,</span>&nbsp;<span class="ident" id="4683720">os</span><span class="op" id="4683722">.</span><span class="ident" id="4683723">O_WRONLY</span><span class="op" id="4683731">,</span>&nbsp;<span class="num" id="4683733">0</span><span class="op" id="4683734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683738">if</span>&nbsp;<span class="ident" id="4683741">err</span>&nbsp;<span class="op" id="4683745">!=</span>&nbsp;<span class="builtintype" id="4683748">nil</span>&nbsp;<span class="op" id="4683752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683766">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683770">c</span><span class="op" id="4683771">.</span><span class="ident" id="4683772">closeAfterStart</span>&nbsp;<span class="op" id="4683788">=</span>&nbsp;<span class="builtinfunc" id="4683790">append</span><span class="op" id="4683796">(</span><span class="ident" id="4683797">c</span><span class="op" id="4683798">.</span><span class="ident" id="4683799">closeAfterStart</span><span class="op" id="4683814">,</span>&nbsp;<span class="ident" id="4683816">f</span><span class="op" id="4683817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683833">if</span>&nbsp;<span class="ident" id="4683836">f</span><span class="op" id="4683837">,</span>&nbsp;<span class="ident" id="4683839">ok</span>&nbsp;<span class="op" id="4683842">:=</span>&nbsp;<span class="ident" id="4683845">w</span><span class="op" id="4683846">.</span><span class="op" id="4683847">(</span><span class="op" id="4683848">*</span><span class="ident" id="4683849">os</span><span class="op" id="4683851">.</span><span class="ident" id="4683852">File</span><span class="op" id="4683856">)</span><span class="op" id="4683857">;</span>&nbsp;<span class="ident" id="4683859">ok</span>&nbsp;<span class="op" id="4683862">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683866">return</span>&nbsp;<span class="ident" id="4683873">f</span><span class="op" id="4683874">,</span>&nbsp;<span class="builtintype" id="4683876">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683885">pr</span><span class="op" id="4683887">,</span>&nbsp;<span class="ident" id="4683889">pw</span><span class="op" id="4683891">,</span>&nbsp;<span class="ident" id="4683893">err</span>&nbsp;<span class="op" id="4683897">:=</span>&nbsp;<span class="ident" id="4683900">os</span><span class="op" id="4683902">.</span><span class="ident" id="4683903">Pipe</span><span class="op" id="4683907">(</span><span class="op" id="4683908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683911">if</span>&nbsp;<span class="ident" id="4683914">err</span>&nbsp;<span class="op" id="4683918">!=</span>&nbsp;<span class="builtintype" id="4683921">nil</span>&nbsp;<span class="op" id="4683925">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683929">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683941">c</span><span class="op" id="4683942">.</span><span class="ident" id="4683943">closeAfterStart</span>&nbsp;<span class="op" id="4683959">=</span>&nbsp;<span class="builtinfunc" id="4683961">append</span><span class="op" id="4683967">(</span><span class="ident" id="4683968">c</span><span class="op" id="4683969">.</span><span class="ident" id="4683970">closeAfterStart</span><span class="op" id="4683985">,</span>&nbsp;<span class="ident" id="4683987">pw</span><span class="op" id="4683989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683992">c</span><span class="op" id="4683993">.</span><span class="ident" id="4683994">closeAfterWait</span>&nbsp;<span class="op" id="4684009">=</span>&nbsp;<span class="builtinfunc" id="4684011">append</span><span class="op" id="4684017">(</span><span class="ident" id="4684018">c</span><span class="op" id="4684019">.</span><span class="ident" id="4684020">closeAfterWait</span><span class="op" id="4684034">,</span>&nbsp;<span class="ident" id="4684036">pr</span><span class="op" id="4684038">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684041">c</span><span class="op" id="4684042">.</span><span class="ident" id="4684043">goroutine</span>&nbsp;<span class="op" id="4684053">=</span>&nbsp;<span class="builtinfunc" id="4684055">append</span><span class="op" id="4684061">(</span><span class="ident" id="4684062">c</span><span class="op" id="4684063">.</span><span class="ident" id="4684064">goroutine</span><span class="op" id="4684073">,</span>&nbsp;<span class="keyword" id="4684075">func</span><span class="op" id="4684079">(</span><span class="op" id="4684080">)</span>&nbsp;<span class="builtintype" id="4684082">error</span>&nbsp;<span class="op" id="4684088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684092">_</span><span class="op" id="4684093">,</span>&nbsp;<span class="ident" id="4684095">err</span>&nbsp;<span class="op" id="4684099">:=</span>&nbsp;<span class="ident" id="4684102">io</span><span class="op" id="4684104">.</span><span class="ident" id="4684105">Copy</span><span class="op" id="4684109">(</span><span class="ident" id="4684110">w</span><span class="op" id="4684111">,</span>&nbsp;<span class="ident" id="4684113">pr</span><span class="op" id="4684115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684119">return</span>&nbsp;<span class="ident" id="4684126">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684131">}</span><span class="op" id="4684132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684135">return</span>&nbsp;<span class="ident" id="4684142">pw</span><span class="op" id="4684144">,</span>&nbsp;<span class="builtintype" id="4684146">nil</span><br>
<span class="lineno">225</span><span class="op" id="4684150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4684153">func</span>&nbsp;<span class="op" id="4684158">(</span><span class="ident" id="4684159">c</span>&nbsp;<span class="op" id="4684161">*</span><span class="ident" id="4684162">Cmd</span><span class="op" id="4684165">)</span>&nbsp;<span class="ident" id="4684167">closeDescriptors</span><span class="op" id="4684183">(</span><span class="ident" id="4684184">closers</span>&nbsp;<span class="op" id="4684192">[</span><span class="op" id="4684193">]</span><span class="ident" id="4684194">io</span><span class="op" id="4684196">.</span><span class="ident" id="4684197">Closer</span><span class="op" id="4684203">)</span>&nbsp;<span class="op" id="4684205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684208">for</span>&nbsp;<span class="ident" id="4684212">_</span><span class="op" id="4684213">,</span>&nbsp;<span class="ident" id="4684215">fd</span>&nbsp;<span class="op" id="4684218">:=</span>&nbsp;<span class="keyword" id="4684221">range</span>&nbsp;<span class="ident" id="4684227">closers</span>&nbsp;<span class="op" id="4684235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684239">fd</span><span class="op" id="4684241">.</span><span class="ident" id="4684242">Close</span><span class="op" id="4684247">(</span><span class="op" id="4684248">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684251">}</span><br>
<span class="lineno"></span><span class="op" id="4684253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4684256">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4684322">//</span><br>
<span class="lineno">235</span><span class="comment" id="4684325">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4684391">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4684456">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="4684467">//</span><br>
<span class="lineno"></span><span class="comment" id="4684470">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="4684539">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4684596">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="4684626">func</span>&nbsp;<span class="op" id="4684631">(</span><span class="ident" id="4684632">c</span>&nbsp;<span class="op" id="4684634">*</span><span class="ident" id="4684635">Cmd</span><span class="op" id="4684638">)</span>&nbsp;<span class="ident" id="4684640">Run</span><span class="op" id="4684643">(</span><span class="op" id="4684644">)</span>&nbsp;<span class="builtintype" id="4684646">error</span>&nbsp;<span class="op" id="4684652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684655">if</span>&nbsp;<span class="ident" id="4684658">err</span>&nbsp;<span class="op" id="4684662">:=</span>&nbsp;<span class="ident" id="4684665">c</span><span class="op" id="4684666">.</span><span class="ident" id="4684667">Start</span><span class="op" id="4684672">(</span><span class="op" id="4684673">)</span><span class="op" id="4684674">;</span>&nbsp;<span class="ident" id="4684676">err</span>&nbsp;<span class="op" id="4684680">!=</span>&nbsp;<span class="builtintype" id="4684683">nil</span>&nbsp;<span class="op" id="4684687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684691">return</span>&nbsp;<span class="ident" id="4684698">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684706">return</span>&nbsp;<span class="ident" id="4684713">c</span><span class="op" id="4684714">.</span><span class="ident" id="4684715">Wait</span><span class="op" id="4684719">(</span><span class="op" id="4684720">)</span><br>
<span class="lineno"></span><span class="op" id="4684722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4684725">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="4684789">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="4684840">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="4684922">func</span>&nbsp;<span class="ident" id="4684927">lookExtensions</span><span class="op" id="4684941">(</span><span class="ident" id="4684942">path</span><span class="op" id="4684946">,</span>&nbsp;<span class="ident" id="4684948">dir</span>&nbsp;<span class="builtintype" id="4684952">string</span><span class="op" id="4684958">)</span>&nbsp;<span class="op" id="4684960">(</span><span class="builtintype" id="4684961">string</span><span class="op" id="4684967">,</span>&nbsp;<span class="builtintype" id="4684969">error</span><span class="op" id="4684974">)</span>&nbsp;<span class="op" id="4684976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684979">if</span>&nbsp;<span class="ident" id="4684982">filepath</span><span class="op" id="4684990">.</span><span class="ident" id="4684991">Base</span><span class="op" id="4684995">(</span><span class="ident" id="4684996">path</span><span class="op" id="4685000">)</span>&nbsp;<span class="op" id="4685002">==</span>&nbsp;<span class="ident" id="4685005">path</span>&nbsp;<span class="op" id="4685010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685014">path</span>&nbsp;<span class="op" id="4685019">=</span>&nbsp;<span class="ident" id="4685021">filepath</span><span class="op" id="4685029">.</span><span class="ident" id="4685030">Join</span><span class="op" id="4685034">(</span><span class="string" id="4685035">&#34;.&#34;</span><span class="op" id="4685038">,</span>&nbsp;<span class="ident" id="4685040">path</span><span class="op" id="4685044">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685050">if</span>&nbsp;<span class="ident" id="4685053">dir</span>&nbsp;<span class="op" id="4685057">==</span>&nbsp;<span class="string" id="4685060">&#34;&#34;</span>&nbsp;<span class="op" id="4685063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685067">return</span>&nbsp;<span class="ident" id="4685074">LookPath</span><span class="op" id="4685082">(</span><span class="ident" id="4685083">path</span><span class="op" id="4685087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685093">if</span>&nbsp;<span class="ident" id="4685096">filepath</span><span class="op" id="4685104">.</span><span class="ident" id="4685105">VolumeName</span><span class="op" id="4685115">(</span><span class="ident" id="4685116">path</span><span class="op" id="4685120">)</span>&nbsp;<span class="op" id="4685122">!=</span>&nbsp;<span class="string" id="4685125">&#34;&#34;</span>&nbsp;<span class="op" id="4685128">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685132">return</span>&nbsp;<span class="ident" id="4685139">LookPath</span><span class="op" id="4685147">(</span><span class="ident" id="4685148">path</span><span class="op" id="4685152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685158">if</span>&nbsp;<span class="builtinfunc" id="4685161">len</span><span class="op" id="4685164">(</span><span class="ident" id="4685165">path</span><span class="op" id="4685169">)</span>&nbsp;<span class="op" id="4685171">&gt;</span>&nbsp;<span class="num" id="4685173">1</span>&nbsp;<span class="op" id="4685175">&amp;&amp;</span>&nbsp;<span class="ident" id="4685178">os</span><span class="op" id="4685180">.</span><span class="ident" id="4685181">IsPathSeparator</span><span class="op" id="4685196">(</span><span class="ident" id="4685197">path</span><span class="op" id="4685201">[</span><span class="num" id="4685202">0</span><span class="op" id="4685203">]</span><span class="op" id="4685204">)</span>&nbsp;<span class="op" id="4685206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685210">return</span>&nbsp;<span class="ident" id="4685217">LookPath</span><span class="op" id="4685225">(</span><span class="ident" id="4685226">path</span><span class="op" id="4685230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685233">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685236">dirandpath</span>&nbsp;<span class="op" id="4685247">:=</span>&nbsp;<span class="ident" id="4685250">filepath</span><span class="op" id="4685258">.</span><span class="ident" id="4685259">Join</span><span class="op" id="4685263">(</span><span class="ident" id="4685264">dir</span><span class="op" id="4685267">,</span>&nbsp;<span class="ident" id="4685269">path</span><span class="op" id="4685273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4685276">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685334">lp</span><span class="op" id="4685336">,</span>&nbsp;<span class="ident" id="4685338">err</span>&nbsp;<span class="op" id="4685342">:=</span>&nbsp;<span class="ident" id="4685345">LookPath</span><span class="op" id="4685353">(</span><span class="ident" id="4685354">dirandpath</span><span class="op" id="4685364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685367">if</span>&nbsp;<span class="ident" id="4685370">err</span>&nbsp;<span class="op" id="4685374">!=</span>&nbsp;<span class="builtintype" id="4685377">nil</span>&nbsp;<span class="op" id="4685381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685385">return</span>&nbsp;<span class="string" id="4685392">&#34;&#34;</span><span class="op" id="4685394">,</span>&nbsp;<span class="ident" id="4685396">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685404">ext</span>&nbsp;<span class="op" id="4685408">:=</span>&nbsp;<span class="ident" id="4685411">strings</span><span class="op" id="4685418">.</span><span class="ident" id="4685419">TrimPrefix</span><span class="op" id="4685429">(</span><span class="ident" id="4685430">lp</span><span class="op" id="4685432">,</span>&nbsp;<span class="ident" id="4685434">dirandpath</span><span class="op" id="4685444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685447">return</span>&nbsp;<span class="ident" id="4685454">path</span>&nbsp;<span class="op" id="4685459">+</span>&nbsp;<span class="ident" id="4685461">ext</span><span class="op" id="4685464">,</span>&nbsp;<span class="builtintype" id="4685466">nil</span><br>
<span class="lineno"></span><span class="op" id="4685470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4685473">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4685549">//</span><br>
<span class="lineno"></span><span class="comment" id="4685552">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="4685630">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="4685657">func</span>&nbsp;<span class="op" id="4685662">(</span><span class="ident" id="4685663">c</span>&nbsp;<span class="op" id="4685665">*</span><span class="ident" id="4685666">Cmd</span><span class="op" id="4685669">)</span>&nbsp;<span class="ident" id="4685671">Start</span><span class="op" id="4685676">(</span><span class="op" id="4685677">)</span>&nbsp;<span class="builtintype" id="4685679">error</span>&nbsp;<span class="op" id="4685685">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685688">if</span>&nbsp;<span class="ident" id="4685691">c</span><span class="op" id="4685692">.</span><span class="ident" id="4685693">lookPathErr</span>&nbsp;<span class="op" id="4685705">!=</span>&nbsp;<span class="builtintype" id="4685708">nil</span>&nbsp;<span class="op" id="4685712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685716">c</span><span class="op" id="4685717">.</span><span class="ident" id="4685718">closeDescriptors</span><span class="op" id="4685734">(</span><span class="ident" id="4685735">c</span><span class="op" id="4685736">.</span><span class="ident" id="4685737">closeAfterStart</span><span class="op" id="4685752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685756">c</span><span class="op" id="4685757">.</span><span class="ident" id="4685758">closeDescriptors</span><span class="op" id="4685774">(</span><span class="ident" id="4685775">c</span><span class="op" id="4685776">.</span><span class="ident" id="4685777">closeAfterWait</span><span class="op" id="4685791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685795">return</span>&nbsp;<span class="ident" id="4685802">c</span><span class="op" id="4685803">.</span><span class="ident" id="4685804">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685817">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685820">if</span>&nbsp;<span class="ident" id="4685823">runtime</span><span class="op" id="4685830">.</span><span class="ident" id="4685831">GOOS</span>&nbsp;<span class="op" id="4685836">==</span>&nbsp;<span class="string" id="4685839">&#34;windows&#34;</span>&nbsp;<span class="op" id="4685849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685853">lp</span><span class="op" id="4685855">,</span>&nbsp;<span class="ident" id="4685857">err</span>&nbsp;<span class="op" id="4685861">:=</span>&nbsp;<span class="ident" id="4685864">lookExtensions</span><span class="op" id="4685878">(</span><span class="ident" id="4685879">c</span><span class="op" id="4685880">.</span><span class="ident" id="4685881">Path</span><span class="op" id="4685885">,</span>&nbsp;<span class="ident" id="4685887">c</span><span class="op" id="4685888">.</span><span class="ident" id="4685889">Dir</span><span class="op" id="4685892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685896">if</span>&nbsp;<span class="ident" id="4685899">err</span>&nbsp;<span class="op" id="4685903">!=</span>&nbsp;<span class="builtintype" id="4685906">nil</span>&nbsp;<span class="op" id="4685910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685915">c</span><span class="op" id="4685916">.</span><span class="ident" id="4685917">closeDescriptors</span><span class="op" id="4685933">(</span><span class="ident" id="4685934">c</span><span class="op" id="4685935">.</span><span class="ident" id="4685936">closeAfterStart</span><span class="op" id="4685951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685956">c</span><span class="op" id="4685957">.</span><span class="ident" id="4685958">closeDescriptors</span><span class="op" id="4685974">(</span><span class="ident" id="4685975">c</span><span class="op" id="4685976">.</span><span class="ident" id="4685977">closeAfterWait</span><span class="op" id="4685991">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685996">return</span>&nbsp;<span class="ident" id="4686003">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686013">c</span><span class="op" id="4686014">.</span><span class="ident" id="4686015">Path</span>&nbsp;<span class="op" id="4686020">=</span>&nbsp;<span class="ident" id="4686022">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686029">if</span>&nbsp;<span class="ident" id="4686032">c</span><span class="op" id="4686033">.</span><span class="ident" id="4686034">Process</span>&nbsp;<span class="op" id="4686042">!=</span>&nbsp;<span class="builtintype" id="4686045">nil</span>&nbsp;<span class="op" id="4686049">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686053">return</span>&nbsp;<span class="ident" id="4686060">errors</span><span class="op" id="4686066">.</span><span class="ident" id="4686067">New</span><span class="op" id="4686070">(</span><span class="string" id="4686071">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="4686094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686101">type</span>&nbsp;<span class="ident" id="4686106">F</span>&nbsp;<span class="keyword" id="4686108">func</span><span class="op" id="4686112">(</span><span class="op" id="4686113">*</span><span class="ident" id="4686114">Cmd</span><span class="op" id="4686117">)</span>&nbsp;<span class="op" id="4686119">(</span><span class="op" id="4686120">*</span><span class="ident" id="4686121">os</span><span class="op" id="4686123">.</span><span class="ident" id="4686124">File</span><span class="op" id="4686128">,</span>&nbsp;<span class="builtintype" id="4686130">error</span><span class="op" id="4686135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686138">for</span>&nbsp;<span class="ident" id="4686142">_</span><span class="op" id="4686143">,</span>&nbsp;<span class="ident" id="4686145">setupFd</span>&nbsp;<span class="op" id="4686153">:=</span>&nbsp;<span class="keyword" id="4686156">range</span>&nbsp;<span class="op" id="4686162">[</span><span class="op" id="4686163">]</span><span class="ident" id="4686164">F</span><span class="op" id="4686165">{</span><span class="op" id="4686166">(</span><span class="op" id="4686167">*</span><span class="ident" id="4686168">Cmd</span><span class="op" id="4686171">)</span><span class="op" id="4686172">.</span><span class="ident" id="4686173">stdin</span><span class="op" id="4686178">,</span>&nbsp;<span class="op" id="4686180">(</span><span class="op" id="4686181">*</span><span class="ident" id="4686182">Cmd</span><span class="op" id="4686185">)</span><span class="op" id="4686186">.</span><span class="ident" id="4686187">stdout</span><span class="op" id="4686193">,</span>&nbsp;<span class="op" id="4686195">(</span><span class="op" id="4686196">*</span><span class="ident" id="4686197">Cmd</span><span class="op" id="4686200">)</span><span class="op" id="4686201">.</span><span class="ident" id="4686202">stderr</span><span class="op" id="4686208">}</span>&nbsp;<span class="op" id="4686210">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686214">fd</span><span class="op" id="4686216">,</span>&nbsp;<span class="ident" id="4686218">err</span>&nbsp;<span class="op" id="4686222">:=</span>&nbsp;<span class="ident" id="4686225">setupFd</span><span class="op" id="4686232">(</span><span class="ident" id="4686233">c</span><span class="op" id="4686234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686238">if</span>&nbsp;<span class="ident" id="4686241">err</span>&nbsp;<span class="op" id="4686245">!=</span>&nbsp;<span class="builtintype" id="4686248">nil</span>&nbsp;<span class="op" id="4686252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686257">c</span><span class="op" id="4686258">.</span><span class="ident" id="4686259">closeDescriptors</span><span class="op" id="4686275">(</span><span class="ident" id="4686276">c</span><span class="op" id="4686277">.</span><span class="ident" id="4686278">closeAfterStart</span><span class="op" id="4686293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686298">c</span><span class="op" id="4686299">.</span><span class="ident" id="4686300">closeDescriptors</span><span class="op" id="4686316">(</span><span class="ident" id="4686317">c</span><span class="op" id="4686318">.</span><span class="ident" id="4686319">closeAfterWait</span><span class="op" id="4686333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686338">return</span>&nbsp;<span class="ident" id="4686345">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686355">c</span><span class="op" id="4686356">.</span><span class="ident" id="4686357">childFiles</span>&nbsp;<span class="op" id="4686368">=</span>&nbsp;<span class="builtinfunc" id="4686370">append</span><span class="op" id="4686376">(</span><span class="ident" id="4686377">c</span><span class="op" id="4686378">.</span><span class="ident" id="4686379">childFiles</span><span class="op" id="4686389">,</span>&nbsp;<span class="ident" id="4686391">fd</span><span class="op" id="4686393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686399">c</span><span class="op" id="4686400">.</span><span class="ident" id="4686401">childFiles</span>&nbsp;<span class="op" id="4686412">=</span>&nbsp;<span class="builtinfunc" id="4686414">append</span><span class="op" id="4686420">(</span><span class="ident" id="4686421">c</span><span class="op" id="4686422">.</span><span class="ident" id="4686423">childFiles</span><span class="op" id="4686433">,</span>&nbsp;<span class="ident" id="4686435">c</span><span class="op" id="4686436">.</span><span class="ident" id="4686437">ExtraFiles</span><span class="op" id="4686447">...</span><span class="op" id="4686450">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686454">var</span>&nbsp;<span class="ident" id="4686458">err</span>&nbsp;<span class="builtintype" id="4686462">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686469">c</span><span class="op" id="4686470">.</span><span class="ident" id="4686471">Process</span><span class="op" id="4686478">,</span>&nbsp;<span class="ident" id="4686480">err</span>&nbsp;<span class="op" id="4686484">=</span>&nbsp;<span class="ident" id="4686486">os</span><span class="op" id="4686488">.</span><span class="ident" id="4686489">StartProcess</span><span class="op" id="4686501">(</span><span class="ident" id="4686502">c</span><span class="op" id="4686503">.</span><span class="ident" id="4686504">Path</span><span class="op" id="4686508">,</span>&nbsp;<span class="ident" id="4686510">c</span><span class="op" id="4686511">.</span><span class="ident" id="4686512">argv</span><span class="op" id="4686516">(</span><span class="op" id="4686517">)</span><span class="op" id="4686518">,</span>&nbsp;<span class="op" id="4686520">&amp;</span><span class="ident" id="4686521">os</span><span class="op" id="4686523">.</span><span class="ident" id="4686524">ProcAttr</span><span class="op" id="4686532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686536">Dir</span><span class="op" id="4686539">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4686543">c</span><span class="op" id="4686544">.</span><span class="ident" id="4686545">Dir</span><span class="op" id="4686548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686552">Files</span><span class="op" id="4686557">:</span>&nbsp;<span class="ident" id="4686559">c</span><span class="op" id="4686560">.</span><span class="ident" id="4686561">childFiles</span><span class="op" id="4686571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686575">Env</span><span class="op" id="4686578">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4686582">c</span><span class="op" id="4686583">.</span><span class="ident" id="4686584">envv</span><span class="op" id="4686588">(</span><span class="op" id="4686589">)</span><span class="op" id="4686590">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686594">Sys</span><span class="op" id="4686597">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4686601">c</span><span class="op" id="4686602">.</span><span class="ident" id="4686603">SysProcAttr</span><span class="op" id="4686614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686617">}</span><span class="op" id="4686618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686621">if</span>&nbsp;<span class="ident" id="4686624">err</span>&nbsp;<span class="op" id="4686628">!=</span>&nbsp;<span class="builtintype" id="4686631">nil</span>&nbsp;<span class="op" id="4686635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686639">c</span><span class="op" id="4686640">.</span><span class="ident" id="4686641">closeDescriptors</span><span class="op" id="4686657">(</span><span class="ident" id="4686658">c</span><span class="op" id="4686659">.</span><span class="ident" id="4686660">closeAfterStart</span><span class="op" id="4686675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686679">c</span><span class="op" id="4686680">.</span><span class="ident" id="4686681">closeDescriptors</span><span class="op" id="4686697">(</span><span class="ident" id="4686698">c</span><span class="op" id="4686699">.</span><span class="ident" id="4686700">closeAfterWait</span><span class="op" id="4686714">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686718">return</span>&nbsp;<span class="ident" id="4686725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686734">c</span><span class="op" id="4686735">.</span><span class="ident" id="4686736">closeDescriptors</span><span class="op" id="4686752">(</span><span class="ident" id="4686753">c</span><span class="op" id="4686754">.</span><span class="ident" id="4686755">closeAfterStart</span><span class="op" id="4686770">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686774">c</span><span class="op" id="4686775">.</span><span class="ident" id="4686776">errch</span>&nbsp;<span class="op" id="4686782">=</span>&nbsp;<span class="builtinfunc" id="4686784">make</span><span class="op" id="4686788">(</span><span class="keyword" id="4686789">chan</span>&nbsp;<span class="builtintype" id="4686794">error</span><span class="op" id="4686799">,</span>&nbsp;<span class="builtinfunc" id="4686801">len</span><span class="op" id="4686804">(</span><span class="ident" id="4686805">c</span><span class="op" id="4686806">.</span><span class="ident" id="4686807">goroutine</span><span class="op" id="4686816">)</span><span class="op" id="4686817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686820">for</span>&nbsp;<span class="ident" id="4686824">_</span><span class="op" id="4686825">,</span>&nbsp;<span class="ident" id="4686827">fn</span>&nbsp;<span class="op" id="4686830">:=</span>&nbsp;<span class="keyword" id="4686833">range</span>&nbsp;<span class="ident" id="4686839">c</span><span class="op" id="4686840">.</span><span class="ident" id="4686841">goroutine</span>&nbsp;<span class="op" id="4686851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686855">go</span>&nbsp;<span class="keyword" id="4686858">func</span><span class="op" id="4686862">(</span><span class="ident" id="4686863">fn</span>&nbsp;<span class="keyword" id="4686866">func</span><span class="op" id="4686870">(</span><span class="op" id="4686871">)</span>&nbsp;<span class="builtintype" id="4686873">error</span><span class="op" id="4686878">)</span>&nbsp;<span class="op" id="4686880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686885">c</span><span class="op" id="4686886">.</span><span class="ident" id="4686887">errch</span>&nbsp;<span class="op" id="4686893">&lt;-</span>&nbsp;<span class="ident" id="4686896">fn</span><span class="op" id="4686898">(</span><span class="op" id="4686899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686903">}</span><span class="op" id="4686904">(</span><span class="ident" id="4686905">fn</span><span class="op" id="4686907">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686914">return</span>&nbsp;<span class="builtintype" id="4686921">nil</span><br>
<span class="lineno"></span><span class="op" id="4686925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="4686928">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="4686987">type</span>&nbsp;<span class="ident" id="4686992">ExitError</span>&nbsp;<span class="keyword" id="4687002">struct</span>&nbsp;<span class="op" id="4687009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687012">*</span><span class="ident" id="4687013">os</span><span class="op" id="4687015">.</span><span class="ident" id="4687016">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="4687029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="4687032">func</span>&nbsp;<span class="op" id="4687037">(</span><span class="ident" id="4687038">e</span>&nbsp;<span class="op" id="4687040">*</span><span class="ident" id="4687041">ExitError</span><span class="op" id="4687050">)</span>&nbsp;<span class="ident" id="4687052">Error</span><span class="op" id="4687057">(</span><span class="op" id="4687058">)</span>&nbsp;<span class="builtintype" id="4687060">string</span>&nbsp;<span class="op" id="4687067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687070">return</span>&nbsp;<span class="ident" id="4687077">e</span><span class="op" id="4687078">.</span><span class="ident" id="4687079">ProcessState</span><span class="op" id="4687091">.</span><span class="ident" id="4687092">String</span><span class="op" id="4687098">(</span><span class="op" id="4687099">)</span><br>
<span class="lineno"></span><span class="op" id="4687101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4687104">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="4687143">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="4687182">//</span><br>
<span class="lineno"></span><span class="comment" id="4687185">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4687251">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4687316">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="4687327">//</span><br>
<span class="lineno"></span><span class="comment" id="4687330">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4687399">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4687456">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="4687486">//</span><br>
<span class="lineno">355</span><span class="comment" id="4687489">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="4687545">func</span>&nbsp;<span class="op" id="4687550">(</span><span class="ident" id="4687551">c</span>&nbsp;<span class="op" id="4687553">*</span><span class="ident" id="4687554">Cmd</span><span class="op" id="4687557">)</span>&nbsp;<span class="ident" id="4687559">Wait</span><span class="op" id="4687563">(</span><span class="op" id="4687564">)</span>&nbsp;<span class="builtintype" id="4687566">error</span>&nbsp;<span class="op" id="4687572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687575">if</span>&nbsp;<span class="ident" id="4687578">c</span><span class="op" id="4687579">.</span><span class="ident" id="4687580">Process</span>&nbsp;<span class="op" id="4687588">==</span>&nbsp;<span class="builtintype" id="4687591">nil</span>&nbsp;<span class="op" id="4687595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687599">return</span>&nbsp;<span class="ident" id="4687606">errors</span><span class="op" id="4687612">.</span><span class="ident" id="4687613">New</span><span class="op" id="4687616">(</span><span class="string" id="4687617">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="4687636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687639">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687642">if</span>&nbsp;<span class="ident" id="4687645">c</span><span class="op" id="4687646">.</span><span class="ident" id="4687647">finished</span>&nbsp;<span class="op" id="4687656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687660">return</span>&nbsp;<span class="ident" id="4687667">errors</span><span class="op" id="4687673">.</span><span class="ident" id="4687674">New</span><span class="op" id="4687677">(</span><span class="string" id="4687678">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="4687709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687715">c</span><span class="op" id="4687716">.</span><span class="ident" id="4687717">finished</span>&nbsp;<span class="op" id="4687726">=</span>&nbsp;<span class="builtintype" id="4687728">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687734">state</span><span class="op" id="4687739">,</span>&nbsp;<span class="ident" id="4687741">err</span>&nbsp;<span class="op" id="4687745">:=</span>&nbsp;<span class="ident" id="4687748">c</span><span class="op" id="4687749">.</span><span class="ident" id="4687750">Process</span><span class="op" id="4687757">.</span><span class="ident" id="4687758">Wait</span><span class="op" id="4687762">(</span><span class="op" id="4687763">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687766">c</span><span class="op" id="4687767">.</span><span class="ident" id="4687768">ProcessState</span>&nbsp;<span class="op" id="4687781">=</span>&nbsp;<span class="ident" id="4687783">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687791">var</span>&nbsp;<span class="ident" id="4687795">copyError</span>&nbsp;<span class="builtintype" id="4687805">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687812">for</span>&nbsp;<span class="keyword" id="4687816">range</span>&nbsp;<span class="ident" id="4687822">c</span><span class="op" id="4687823">.</span><span class="ident" id="4687824">goroutine</span>&nbsp;<span class="op" id="4687834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687838">if</span>&nbsp;<span class="ident" id="4687841">err</span>&nbsp;<span class="op" id="4687845">:=</span>&nbsp;<span class="op" id="4687848">&lt;-</span><span class="ident" id="4687850">c</span><span class="op" id="4687851">.</span><span class="ident" id="4687852">errch</span><span class="op" id="4687857">;</span>&nbsp;<span class="ident" id="4687859">err</span>&nbsp;<span class="op" id="4687863">!=</span>&nbsp;<span class="builtintype" id="4687866">nil</span>&nbsp;<span class="op" id="4687870">&amp;&amp;</span>&nbsp;<span class="ident" id="4687873">copyError</span>&nbsp;<span class="op" id="4687883">==</span>&nbsp;<span class="builtintype" id="4687886">nil</span>&nbsp;<span class="op" id="4687890">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687895">copyError</span>&nbsp;<span class="op" id="4687905">=</span>&nbsp;<span class="ident" id="4687907">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687920">c</span><span class="op" id="4687921">.</span><span class="ident" id="4687922">closeDescriptors</span><span class="op" id="4687938">(</span><span class="ident" id="4687939">c</span><span class="op" id="4687940">.</span><span class="ident" id="4687941">closeAfterWait</span><span class="op" id="4687955">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687959">if</span>&nbsp;<span class="ident" id="4687962">err</span>&nbsp;<span class="op" id="4687966">!=</span>&nbsp;<span class="builtintype" id="4687969">nil</span>&nbsp;<span class="op" id="4687973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687977">return</span>&nbsp;<span class="ident" id="4687984">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687989">}</span>&nbsp;<span class="keyword" id="4687991">else</span>&nbsp;<span class="keyword" id="4687996">if</span>&nbsp;<span class="op" id="4687999">!</span><span class="ident" id="4688000">state</span><span class="op" id="4688005">.</span><span class="ident" id="4688006">Success</span><span class="op" id="4688013">(</span><span class="op" id="4688014">)</span>&nbsp;<span class="op" id="4688016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688020">return</span>&nbsp;<span class="op" id="4688027">&amp;</span><span class="ident" id="4688028">ExitError</span><span class="op" id="4688037">{</span><span class="ident" id="4688038">state</span><span class="op" id="4688043">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688050">return</span>&nbsp;<span class="ident" id="4688057">copyError</span><br>
<span class="lineno"></span><span class="op" id="4688067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="4688070">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4688130">func</span>&nbsp;<span class="op" id="4688135">(</span><span class="ident" id="4688136">c</span>&nbsp;<span class="op" id="4688138">*</span><span class="ident" id="4688139">Cmd</span><span class="op" id="4688142">)</span>&nbsp;<span class="ident" id="4688144">Output</span><span class="op" id="4688150">(</span><span class="op" id="4688151">)</span>&nbsp;<span class="op" id="4688153">(</span><span class="op" id="4688154">[</span><span class="op" id="4688155">]</span><span class="builtintype" id="4688156">byte</span><span class="op" id="4688160">,</span>&nbsp;<span class="builtintype" id="4688162">error</span><span class="op" id="4688167">)</span>&nbsp;<span class="op" id="4688169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688172">if</span>&nbsp;<span class="ident" id="4688175">c</span><span class="op" id="4688176">.</span><span class="ident" id="4688177">Stdout</span>&nbsp;<span class="op" id="4688184">!=</span>&nbsp;<span class="builtintype" id="4688187">nil</span>&nbsp;<span class="op" id="4688191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688195">return</span>&nbsp;<span class="builtintype" id="4688202">nil</span><span class="op" id="4688205">,</span>&nbsp;<span class="ident" id="4688207">errors</span><span class="op" id="4688213">.</span><span class="ident" id="4688214">New</span><span class="op" id="4688217">(</span><span class="string" id="4688218">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4688244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688247">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688250">var</span>&nbsp;<span class="ident" id="4688254">b</span>&nbsp;<span class="ident" id="4688256">bytes</span><span class="op" id="4688261">.</span><span class="ident" id="4688262">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688270">c</span><span class="op" id="4688271">.</span><span class="ident" id="4688272">Stdout</span>&nbsp;<span class="op" id="4688279">=</span>&nbsp;<span class="op" id="4688281">&amp;</span><span class="ident" id="4688282">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688285">err</span>&nbsp;<span class="op" id="4688289">:=</span>&nbsp;<span class="ident" id="4688292">c</span><span class="op" id="4688293">.</span><span class="ident" id="4688294">Run</span><span class="op" id="4688297">(</span><span class="op" id="4688298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688301">return</span>&nbsp;<span class="ident" id="4688308">b</span><span class="op" id="4688309">.</span><span class="ident" id="4688310">Bytes</span><span class="op" id="4688315">(</span><span class="op" id="4688316">)</span><span class="op" id="4688317">,</span>&nbsp;<span class="ident" id="4688319">err</span><br>
<span class="lineno"></span><span class="op" id="4688323">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="4688326">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="4688395">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4688425">func</span>&nbsp;<span class="op" id="4688430">(</span><span class="ident" id="4688431">c</span>&nbsp;<span class="op" id="4688433">*</span><span class="ident" id="4688434">Cmd</span><span class="op" id="4688437">)</span>&nbsp;<span class="ident" id="4688439">CombinedOutput</span><span class="op" id="4688453">(</span><span class="op" id="4688454">)</span>&nbsp;<span class="op" id="4688456">(</span><span class="op" id="4688457">[</span><span class="op" id="4688458">]</span><span class="builtintype" id="4688459">byte</span><span class="op" id="4688463">,</span>&nbsp;<span class="builtintype" id="4688465">error</span><span class="op" id="4688470">)</span>&nbsp;<span class="op" id="4688472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688475">if</span>&nbsp;<span class="ident" id="4688478">c</span><span class="op" id="4688479">.</span><span class="ident" id="4688480">Stdout</span>&nbsp;<span class="op" id="4688487">!=</span>&nbsp;<span class="builtintype" id="4688490">nil</span>&nbsp;<span class="op" id="4688494">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688498">return</span>&nbsp;<span class="builtintype" id="4688505">nil</span><span class="op" id="4688508">,</span>&nbsp;<span class="ident" id="4688510">errors</span><span class="op" id="4688516">.</span><span class="ident" id="4688517">New</span><span class="op" id="4688520">(</span><span class="string" id="4688521">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4688547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688553">if</span>&nbsp;<span class="ident" id="4688556">c</span><span class="op" id="4688557">.</span><span class="ident" id="4688558">Stderr</span>&nbsp;<span class="op" id="4688565">!=</span>&nbsp;<span class="builtintype" id="4688568">nil</span>&nbsp;<span class="op" id="4688572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688576">return</span>&nbsp;<span class="builtintype" id="4688583">nil</span><span class="op" id="4688586">,</span>&nbsp;<span class="ident" id="4688588">errors</span><span class="op" id="4688594">.</span><span class="ident" id="4688595">New</span><span class="op" id="4688598">(</span><span class="string" id="4688599">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4688625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688628">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688631">var</span>&nbsp;<span class="ident" id="4688635">b</span>&nbsp;<span class="ident" id="4688637">bytes</span><span class="op" id="4688642">.</span><span class="ident" id="4688643">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688651">c</span><span class="op" id="4688652">.</span><span class="ident" id="4688653">Stdout</span>&nbsp;<span class="op" id="4688660">=</span>&nbsp;<span class="op" id="4688662">&amp;</span><span class="ident" id="4688663">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688666">c</span><span class="op" id="4688667">.</span><span class="ident" id="4688668">Stderr</span>&nbsp;<span class="op" id="4688675">=</span>&nbsp;<span class="op" id="4688677">&amp;</span><span class="ident" id="4688678">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688681">err</span>&nbsp;<span class="op" id="4688685">:=</span>&nbsp;<span class="ident" id="4688688">c</span><span class="op" id="4688689">.</span><span class="ident" id="4688690">Run</span><span class="op" id="4688693">(</span><span class="op" id="4688694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688697">return</span>&nbsp;<span class="ident" id="4688704">b</span><span class="op" id="4688705">.</span><span class="ident" id="4688706">Bytes</span><span class="op" id="4688711">(</span><span class="op" id="4688712">)</span><span class="op" id="4688713">,</span>&nbsp;<span class="ident" id="4688715">err</span><br>
<span class="lineno">410</span><span class="op" id="4688719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4688722">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4688790">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4688833">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="4688908">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="4688976">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="4689052">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="4689098">func</span>&nbsp;<span class="op" id="4689103">(</span><span class="ident" id="4689104">c</span>&nbsp;<span class="op" id="4689106">*</span><span class="ident" id="4689107">Cmd</span><span class="op" id="4689110">)</span>&nbsp;<span class="ident" id="4689112">StdinPipe</span><span class="op" id="4689121">(</span><span class="op" id="4689122">)</span>&nbsp;<span class="op" id="4689124">(</span><span class="ident" id="4689125">io</span><span class="op" id="4689127">.</span><span class="ident" id="4689128">WriteCloser</span><span class="op" id="4689139">,</span>&nbsp;<span class="builtintype" id="4689141">error</span><span class="op" id="4689146">)</span>&nbsp;<span class="op" id="4689148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689151">if</span>&nbsp;<span class="ident" id="4689154">c</span><span class="op" id="4689155">.</span><span class="ident" id="4689156">Stdin</span>&nbsp;<span class="op" id="4689162">!=</span>&nbsp;<span class="builtintype" id="4689165">nil</span>&nbsp;<span class="op" id="4689169">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689173">return</span>&nbsp;<span class="builtintype" id="4689180">nil</span><span class="op" id="4689183">,</span>&nbsp;<span class="ident" id="4689185">errors</span><span class="op" id="4689191">.</span><span class="ident" id="4689192">New</span><span class="op" id="4689195">(</span><span class="string" id="4689196">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="4689221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689227">if</span>&nbsp;<span class="ident" id="4689230">c</span><span class="op" id="4689231">.</span><span class="ident" id="4689232">Process</span>&nbsp;<span class="op" id="4689240">!=</span>&nbsp;<span class="builtintype" id="4689243">nil</span>&nbsp;<span class="op" id="4689247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689251">return</span>&nbsp;<span class="builtintype" id="4689258">nil</span><span class="op" id="4689261">,</span>&nbsp;<span class="ident" id="4689263">errors</span><span class="op" id="4689269">.</span><span class="ident" id="4689270">New</span><span class="op" id="4689273">(</span><span class="string" id="4689274">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4689313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689316">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689319">pr</span><span class="op" id="4689321">,</span>&nbsp;<span class="ident" id="4689323">pw</span><span class="op" id="4689325">,</span>&nbsp;<span class="ident" id="4689327">err</span>&nbsp;<span class="op" id="4689331">:=</span>&nbsp;<span class="ident" id="4689334">os</span><span class="op" id="4689336">.</span><span class="ident" id="4689337">Pipe</span><span class="op" id="4689341">(</span><span class="op" id="4689342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689345">if</span>&nbsp;<span class="ident" id="4689348">err</span>&nbsp;<span class="op" id="4689352">!=</span>&nbsp;<span class="builtintype" id="4689355">nil</span>&nbsp;<span class="op" id="4689359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689363">return</span>&nbsp;<span class="builtintype" id="4689370">nil</span><span class="op" id="4689373">,</span>&nbsp;<span class="ident" id="4689375">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689383">c</span><span class="op" id="4689384">.</span><span class="ident" id="4689385">Stdin</span>&nbsp;<span class="op" id="4689391">=</span>&nbsp;<span class="ident" id="4689393">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689397">c</span><span class="op" id="4689398">.</span><span class="ident" id="4689399">closeAfterStart</span>&nbsp;<span class="op" id="4689415">=</span>&nbsp;<span class="builtinfunc" id="4689417">append</span><span class="op" id="4689423">(</span><span class="ident" id="4689424">c</span><span class="op" id="4689425">.</span><span class="ident" id="4689426">closeAfterStart</span><span class="op" id="4689441">,</span>&nbsp;<span class="ident" id="4689443">pr</span><span class="op" id="4689445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689448">wc</span>&nbsp;<span class="op" id="4689451">:=</span>&nbsp;<span class="op" id="4689454">&amp;</span><span class="ident" id="4689455">closeOnce</span><span class="op" id="4689464">{</span><span class="ident" id="4689465">File</span><span class="op" id="4689469">:</span>&nbsp;<span class="ident" id="4689471">pw</span><span class="op" id="4689473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689476">c</span><span class="op" id="4689477">.</span><span class="ident" id="4689478">closeAfterWait</span>&nbsp;<span class="op" id="4689493">=</span>&nbsp;<span class="builtinfunc" id="4689495">append</span><span class="op" id="4689501">(</span><span class="ident" id="4689502">c</span><span class="op" id="4689503">.</span><span class="ident" id="4689504">closeAfterWait</span><span class="op" id="4689518">,</span>&nbsp;<span class="ident" id="4689520">wc</span><span class="op" id="4689522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689525">return</span>&nbsp;<span class="ident" id="4689532">wc</span><span class="op" id="4689534">,</span>&nbsp;<span class="builtintype" id="4689536">nil</span><br>
<span class="lineno"></span><span class="op" id="4689540">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="4689543">type</span>&nbsp;<span class="ident" id="4689548">closeOnce</span>&nbsp;<span class="keyword" id="4689558">struct</span>&nbsp;<span class="op" id="4689565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689568">*</span><span class="ident" id="4689569">os</span><span class="op" id="4689571">.</span><span class="ident" id="4689572">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689579">once</span>&nbsp;<span class="ident" id="4689584">sync</span><span class="op" id="4689588">.</span><span class="ident" id="4689589">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689595">err</span>&nbsp;&nbsp;<span class="builtintype" id="4689600">error</span><br>
<span class="lineno"></span><span class="op" id="4689606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4689609">func</span>&nbsp;<span class="op" id="4689614">(</span><span class="ident" id="4689615">c</span>&nbsp;<span class="op" id="4689617">*</span><span class="ident" id="4689618">closeOnce</span><span class="op" id="4689627">)</span>&nbsp;<span class="ident" id="4689629">Close</span><span class="op" id="4689634">(</span><span class="op" id="4689635">)</span>&nbsp;<span class="builtintype" id="4689637">error</span>&nbsp;<span class="op" id="4689643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689646">c</span><span class="op" id="4689647">.</span><span class="ident" id="4689648">once</span><span class="op" id="4689652">.</span><span class="ident" id="4689653">Do</span><span class="op" id="4689655">(</span><span class="ident" id="4689656">c</span><span class="op" id="4689657">.</span><span class="builtinfunc" id="4689658">close</span><span class="op" id="4689663">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689666">return</span>&nbsp;<span class="ident" id="4689673">c</span><span class="op" id="4689674">.</span><span class="ident" id="4689675">err</span><br>
<span class="lineno"></span><span class="op" id="4689679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4689682">func</span>&nbsp;<span class="op" id="4689687">(</span><span class="ident" id="4689688">c</span>&nbsp;<span class="op" id="4689690">*</span><span class="ident" id="4689691">closeOnce</span><span class="op" id="4689700">)</span>&nbsp;<span class="builtinfunc" id="4689702">close</span><span class="op" id="4689707">(</span><span class="op" id="4689708">)</span>&nbsp;<span class="op" id="4689710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689713">c</span><span class="op" id="4689714">.</span><span class="ident" id="4689715">err</span>&nbsp;<span class="op" id="4689719">=</span>&nbsp;<span class="ident" id="4689721">c</span><span class="op" id="4689722">.</span><span class="ident" id="4689723">File</span><span class="op" id="4689727">.</span><span class="ident" id="4689728">Close</span><span class="op" id="4689733">(</span><span class="op" id="4689734">)</span><br>
<span class="lineno">450</span><span class="op" id="4689736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4689739">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4689808">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4689852">//</span><br>
<span class="lineno">455</span><span class="comment" id="4689855">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4689930">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4690001">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4690080">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4690155">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="4690195">func</span>&nbsp;<span class="op" id="4690200">(</span><span class="ident" id="4690201">c</span>&nbsp;<span class="op" id="4690203">*</span><span class="ident" id="4690204">Cmd</span><span class="op" id="4690207">)</span>&nbsp;<span class="ident" id="4690209">StdoutPipe</span><span class="op" id="4690219">(</span><span class="op" id="4690220">)</span>&nbsp;<span class="op" id="4690222">(</span><span class="ident" id="4690223">io</span><span class="op" id="4690225">.</span><span class="ident" id="4690226">ReadCloser</span><span class="op" id="4690236">,</span>&nbsp;<span class="builtintype" id="4690238">error</span><span class="op" id="4690243">)</span>&nbsp;<span class="op" id="4690245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690248">if</span>&nbsp;<span class="ident" id="4690251">c</span><span class="op" id="4690252">.</span><span class="ident" id="4690253">Stdout</span>&nbsp;<span class="op" id="4690260">!=</span>&nbsp;<span class="builtintype" id="4690263">nil</span>&nbsp;<span class="op" id="4690267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690271">return</span>&nbsp;<span class="builtintype" id="4690278">nil</span><span class="op" id="4690281">,</span>&nbsp;<span class="ident" id="4690283">errors</span><span class="op" id="4690289">.</span><span class="ident" id="4690290">New</span><span class="op" id="4690293">(</span><span class="string" id="4690294">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4690320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690326">if</span>&nbsp;<span class="ident" id="4690329">c</span><span class="op" id="4690330">.</span><span class="ident" id="4690331">Process</span>&nbsp;<span class="op" id="4690339">!=</span>&nbsp;<span class="builtintype" id="4690342">nil</span>&nbsp;<span class="op" id="4690346">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690350">return</span>&nbsp;<span class="builtintype" id="4690357">nil</span><span class="op" id="4690360">,</span>&nbsp;<span class="ident" id="4690362">errors</span><span class="op" id="4690368">.</span><span class="ident" id="4690369">New</span><span class="op" id="4690372">(</span><span class="string" id="4690373">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4690413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690419">pr</span><span class="op" id="4690421">,</span>&nbsp;<span class="ident" id="4690423">pw</span><span class="op" id="4690425">,</span>&nbsp;<span class="ident" id="4690427">err</span>&nbsp;<span class="op" id="4690431">:=</span>&nbsp;<span class="ident" id="4690434">os</span><span class="op" id="4690436">.</span><span class="ident" id="4690437">Pipe</span><span class="op" id="4690441">(</span><span class="op" id="4690442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690445">if</span>&nbsp;<span class="ident" id="4690448">err</span>&nbsp;<span class="op" id="4690452">!=</span>&nbsp;<span class="builtintype" id="4690455">nil</span>&nbsp;<span class="op" id="4690459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690463">return</span>&nbsp;<span class="builtintype" id="4690470">nil</span><span class="op" id="4690473">,</span>&nbsp;<span class="ident" id="4690475">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690483">c</span><span class="op" id="4690484">.</span><span class="ident" id="4690485">Stdout</span>&nbsp;<span class="op" id="4690492">=</span>&nbsp;<span class="ident" id="4690494">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690498">c</span><span class="op" id="4690499">.</span><span class="ident" id="4690500">closeAfterStart</span>&nbsp;<span class="op" id="4690516">=</span>&nbsp;<span class="builtinfunc" id="4690518">append</span><span class="op" id="4690524">(</span><span class="ident" id="4690525">c</span><span class="op" id="4690526">.</span><span class="ident" id="4690527">closeAfterStart</span><span class="op" id="4690542">,</span>&nbsp;<span class="ident" id="4690544">pw</span><span class="op" id="4690546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690549">c</span><span class="op" id="4690550">.</span><span class="ident" id="4690551">closeAfterWait</span>&nbsp;<span class="op" id="4690566">=</span>&nbsp;<span class="builtinfunc" id="4690568">append</span><span class="op" id="4690574">(</span><span class="ident" id="4690575">c</span><span class="op" id="4690576">.</span><span class="ident" id="4690577">closeAfterWait</span><span class="op" id="4690591">,</span>&nbsp;<span class="ident" id="4690593">pr</span><span class="op" id="4690595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690598">return</span>&nbsp;<span class="ident" id="4690605">pr</span><span class="op" id="4690607">,</span>&nbsp;<span class="builtintype" id="4690609">nil</span><br>
<span class="lineno">475</span><span class="op" id="4690613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4690616">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4690685">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4690728">//</span><br>
<span class="lineno">480</span><span class="comment" id="4690731">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4690806">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4690877">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4690956">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4691030">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="4691081">func</span>&nbsp;<span class="op" id="4691086">(</span><span class="ident" id="4691087">c</span>&nbsp;<span class="op" id="4691089">*</span><span class="ident" id="4691090">Cmd</span><span class="op" id="4691093">)</span>&nbsp;<span class="ident" id="4691095">StderrPipe</span><span class="op" id="4691105">(</span><span class="op" id="4691106">)</span>&nbsp;<span class="op" id="4691108">(</span><span class="ident" id="4691109">io</span><span class="op" id="4691111">.</span><span class="ident" id="4691112">ReadCloser</span><span class="op" id="4691122">,</span>&nbsp;<span class="builtintype" id="4691124">error</span><span class="op" id="4691129">)</span>&nbsp;<span class="op" id="4691131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691134">if</span>&nbsp;<span class="ident" id="4691137">c</span><span class="op" id="4691138">.</span><span class="ident" id="4691139">Stderr</span>&nbsp;<span class="op" id="4691146">!=</span>&nbsp;<span class="builtintype" id="4691149">nil</span>&nbsp;<span class="op" id="4691153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691157">return</span>&nbsp;<span class="builtintype" id="4691164">nil</span><span class="op" id="4691167">,</span>&nbsp;<span class="ident" id="4691169">errors</span><span class="op" id="4691175">.</span><span class="ident" id="4691176">New</span><span class="op" id="4691179">(</span><span class="string" id="4691180">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4691206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691212">if</span>&nbsp;<span class="ident" id="4691215">c</span><span class="op" id="4691216">.</span><span class="ident" id="4691217">Process</span>&nbsp;<span class="op" id="4691225">!=</span>&nbsp;<span class="builtintype" id="4691228">nil</span>&nbsp;<span class="op" id="4691232">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691236">return</span>&nbsp;<span class="builtintype" id="4691243">nil</span><span class="op" id="4691246">,</span>&nbsp;<span class="ident" id="4691248">errors</span><span class="op" id="4691254">.</span><span class="ident" id="4691255">New</span><span class="op" id="4691258">(</span><span class="string" id="4691259">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4691299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691305">pr</span><span class="op" id="4691307">,</span>&nbsp;<span class="ident" id="4691309">pw</span><span class="op" id="4691311">,</span>&nbsp;<span class="ident" id="4691313">err</span>&nbsp;<span class="op" id="4691317">:=</span>&nbsp;<span class="ident" id="4691320">os</span><span class="op" id="4691322">.</span><span class="ident" id="4691323">Pipe</span><span class="op" id="4691327">(</span><span class="op" id="4691328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691331">if</span>&nbsp;<span class="ident" id="4691334">err</span>&nbsp;<span class="op" id="4691338">!=</span>&nbsp;<span class="builtintype" id="4691341">nil</span>&nbsp;<span class="op" id="4691345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691349">return</span>&nbsp;<span class="builtintype" id="4691356">nil</span><span class="op" id="4691359">,</span>&nbsp;<span class="ident" id="4691361">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691369">c</span><span class="op" id="4691370">.</span><span class="ident" id="4691371">Stderr</span>&nbsp;<span class="op" id="4691378">=</span>&nbsp;<span class="ident" id="4691380">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691384">c</span><span class="op" id="4691385">.</span><span class="ident" id="4691386">closeAfterStart</span>&nbsp;<span class="op" id="4691402">=</span>&nbsp;<span class="builtinfunc" id="4691404">append</span><span class="op" id="4691410">(</span><span class="ident" id="4691411">c</span><span class="op" id="4691412">.</span><span class="ident" id="4691413">closeAfterStart</span><span class="op" id="4691428">,</span>&nbsp;<span class="ident" id="4691430">pw</span><span class="op" id="4691432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691435">c</span><span class="op" id="4691436">.</span><span class="ident" id="4691437">closeAfterWait</span>&nbsp;<span class="op" id="4691452">=</span>&nbsp;<span class="builtinfunc" id="4691454">append</span><span class="op" id="4691460">(</span><span class="ident" id="4691461">c</span><span class="op" id="4691462">.</span><span class="ident" id="4691463">closeAfterWait</span><span class="op" id="4691477">,</span>&nbsp;<span class="ident" id="4691479">pr</span><span class="op" id="4691481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691484">return</span>&nbsp;<span class="ident" id="4691491">pr</span><span class="op" id="4691493">,</span>&nbsp;<span class="builtintype" id="4691495">nil</span><br>
<span class="lineno">500</span><span class="op" id="4691499">}</span>
</div>
</body>
</html>
