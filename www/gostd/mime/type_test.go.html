<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6761755">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6761810">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6761864">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6761915">package</span>&nbsp;<span class="ident" id="6761923">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6761929">import</span>&nbsp;<span class="op" id="6761936">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6761939">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6761949">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6761952">var</span>&nbsp;<span class="ident" id="6761956">typeTests</span>&nbsp;<span class="op" id="6761966">=</span>&nbsp;<span class="ident" id="6761968">initMimeForTests</span><span class="op" id="6761984">(</span><span class="op" id="6761985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6761988">func</span>&nbsp;<span class="ident" id="6761993">TestTypeByExtension</span><span class="op" id="6762012">(</span><span class="ident" id="6762013">t</span>&nbsp;<span class="op" id="6762015">*</span><span class="ident" id="6762016">testing</span><span class="op" id="6762023">.</span><span class="ident" id="6762024">T</span><span class="op" id="6762025">)</span>&nbsp;<span class="op" id="6762027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762030">for</span>&nbsp;<span class="ident" id="6762034">ext</span><span class="op" id="6762037">,</span>&nbsp;<span class="ident" id="6762039">want</span>&nbsp;<span class="op" id="6762044">:=</span>&nbsp;<span class="keyword" id="6762047">range</span>&nbsp;<span class="ident" id="6762053">typeTests</span>&nbsp;<span class="op" id="6762063">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762067">val</span>&nbsp;<span class="op" id="6762071">:=</span>&nbsp;<span class="ident" id="6762074">TypeByExtension</span><span class="op" id="6762089">(</span><span class="ident" id="6762090">ext</span><span class="op" id="6762093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762097">if</span>&nbsp;<span class="ident" id="6762100">val</span>&nbsp;<span class="op" id="6762104">!=</span>&nbsp;<span class="ident" id="6762107">want</span>&nbsp;<span class="op" id="6762112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762117">t</span><span class="op" id="6762118">.</span><span class="ident" id="6762119">Errorf</span><span class="op" id="6762125">(</span><span class="string" id="6762126">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6762161">,</span>&nbsp;<span class="ident" id="6762163">ext</span><span class="op" id="6762166">,</span>&nbsp;<span class="ident" id="6762168">val</span><span class="op" id="6762171">,</span>&nbsp;<span class="ident" id="6762173">want</span><span class="op" id="6762177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762184">}</span><br>
<span class="lineno">20</span><span class="op" id="6762186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6762189">func</span>&nbsp;<span class="ident" id="6762194">TestTypeByExtensionCase</span><span class="op" id="6762217">(</span><span class="ident" id="6762218">t</span>&nbsp;<span class="op" id="6762220">*</span><span class="ident" id="6762221">testing</span><span class="op" id="6762228">.</span><span class="ident" id="6762229">T</span><span class="op" id="6762230">)</span>&nbsp;<span class="op" id="6762232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762235">const</span>&nbsp;<span class="ident" id="6762241">custom</span>&nbsp;<span class="op" id="6762248">=</span>&nbsp;<span class="string" id="6762250">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762283">const</span>&nbsp;<span class="ident" id="6762289">caps</span>&nbsp;<span class="op" id="6762294">=</span>&nbsp;<span class="string" id="6762296">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762322">if</span>&nbsp;<span class="ident" id="6762325">err</span>&nbsp;<span class="op" id="6762329">:=</span>&nbsp;<span class="ident" id="6762332">AddExtensionType</span><span class="op" id="6762348">(</span><span class="string" id="6762349">&#34;.TEST&#34;</span><span class="op" id="6762356">,</span>&nbsp;<span class="ident" id="6762358">caps</span><span class="op" id="6762362">)</span><span class="op" id="6762363">;</span>&nbsp;<span class="ident" id="6762365">err</span>&nbsp;<span class="op" id="6762369">!=</span>&nbsp;<span class="builtintype" id="6762372">nil</span>&nbsp;<span class="op" id="6762376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762380">t</span><span class="op" id="6762381">.</span><span class="ident" id="6762382">Fatalf</span><span class="op" id="6762388">(</span><span class="string" id="6762389">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="6762420">,</span>&nbsp;<span class="ident" id="6762422">err</span><span class="op" id="6762425">,</span>&nbsp;<span class="ident" id="6762427">custom</span><span class="op" id="6762433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762439">if</span>&nbsp;<span class="ident" id="6762442">err</span>&nbsp;<span class="op" id="6762446">:=</span>&nbsp;<span class="ident" id="6762449">AddExtensionType</span><span class="op" id="6762465">(</span><span class="string" id="6762466">&#34;.tesT&#34;</span><span class="op" id="6762473">,</span>&nbsp;<span class="ident" id="6762475">custom</span><span class="op" id="6762481">)</span><span class="op" id="6762482">;</span>&nbsp;<span class="ident" id="6762484">err</span>&nbsp;<span class="op" id="6762488">!=</span>&nbsp;<span class="builtintype" id="6762491">nil</span>&nbsp;<span class="op" id="6762495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762499">t</span><span class="op" id="6762500">.</span><span class="ident" id="6762501">Fatalf</span><span class="op" id="6762507">(</span><span class="string" id="6762508">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="6762539">,</span>&nbsp;<span class="ident" id="6762541">err</span><span class="op" id="6762544">,</span>&nbsp;<span class="ident" id="6762546">custom</span><span class="op" id="6762552">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6762559">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762585">if</span>&nbsp;<span class="ident" id="6762588">got</span>&nbsp;<span class="op" id="6762592">:=</span>&nbsp;<span class="ident" id="6762595">TypeByExtension</span><span class="op" id="6762610">(</span><span class="string" id="6762611">&#34;.tesT&#34;</span><span class="op" id="6762618">)</span><span class="op" id="6762619">;</span>&nbsp;<span class="ident" id="6762621">got</span>&nbsp;<span class="op" id="6762625">!=</span>&nbsp;<span class="ident" id="6762628">custom</span>&nbsp;<span class="op" id="6762635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762639">t</span><span class="op" id="6762640">.</span><span class="ident" id="6762641">Fatalf</span><span class="op" id="6762647">(</span><span class="string" id="6762648">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6762676">,</span>&nbsp;<span class="ident" id="6762678">got</span><span class="op" id="6762681">,</span>&nbsp;<span class="ident" id="6762683">custom</span><span class="op" id="6762689">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762695">if</span>&nbsp;<span class="ident" id="6762698">got</span>&nbsp;<span class="op" id="6762702">:=</span>&nbsp;<span class="ident" id="6762705">TypeByExtension</span><span class="op" id="6762720">(</span><span class="string" id="6762721">&#34;.TEST&#34;</span><span class="op" id="6762728">)</span><span class="op" id="6762729">;</span>&nbsp;<span class="ident" id="6762731">got</span>&nbsp;<span class="op" id="6762735">!=</span>&nbsp;<span class="ident" id="6762738">caps</span>&nbsp;<span class="op" id="6762743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762747">t</span><span class="op" id="6762748">.</span><span class="ident" id="6762749">Fatalf</span><span class="op" id="6762755">(</span><span class="string" id="6762756">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6762784">,</span>&nbsp;<span class="ident" id="6762786">got</span><span class="op" id="6762789">,</span>&nbsp;<span class="ident" id="6762791">caps</span><span class="op" id="6762795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6762802">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6762823">if</span>&nbsp;<span class="ident" id="6762826">got</span>&nbsp;<span class="op" id="6762830">:=</span>&nbsp;<span class="ident" id="6762833">TypeByExtension</span><span class="op" id="6762848">(</span><span class="string" id="6762849">&#34;.TesT&#34;</span><span class="op" id="6762856">)</span><span class="op" id="6762857">;</span>&nbsp;<span class="ident" id="6762859">got</span>&nbsp;<span class="op" id="6762863">!=</span>&nbsp;<span class="ident" id="6762866">custom</span>&nbsp;<span class="op" id="6762873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762877">t</span><span class="op" id="6762878">.</span><span class="ident" id="6762879">Fatalf</span><span class="op" id="6762885">(</span><span class="string" id="6762886">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6762914">,</span>&nbsp;<span class="ident" id="6762916">got</span><span class="op" id="6762919">,</span>&nbsp;<span class="ident" id="6762921">custom</span><span class="op" id="6762927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6762930">}</span><br>
<span class="lineno"></span><span class="op" id="6762932">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6762935">func</span>&nbsp;<span class="ident" id="6762940">TestLookupMallocs</span><span class="op" id="6762957">(</span><span class="ident" id="6762958">t</span>&nbsp;<span class="op" id="6762960">*</span><span class="ident" id="6762961">testing</span><span class="op" id="6762968">.</span><span class="ident" id="6762969">T</span><span class="op" id="6762970">)</span>&nbsp;<span class="op" id="6762972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6762975">n</span>&nbsp;<span class="op" id="6762977">:=</span>&nbsp;<span class="ident" id="6762980">testing</span><span class="op" id="6762987">.</span><span class="ident" id="6762988">AllocsPerRun</span><span class="op" id="6763000">(</span><span class="num" id="6763001">10000</span><span class="op" id="6763006">,</span>&nbsp;<span class="keyword" id="6763008">func</span><span class="op" id="6763012">(</span><span class="op" id="6763013">)</span>&nbsp;<span class="op" id="6763015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6763019">TypeByExtension</span><span class="op" id="6763034">(</span><span class="string" id="6763035">&#34;.html&#34;</span><span class="op" id="6763042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6763046">TypeByExtension</span><span class="op" id="6763061">(</span><span class="string" id="6763062">&#34;.HtML&#34;</span><span class="op" id="6763069">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6763072">}</span><span class="op" id="6763073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6763076">if</span>&nbsp;<span class="ident" id="6763079">n</span>&nbsp;<span class="op" id="6763081">&gt;</span>&nbsp;<span class="num" id="6763083">0</span>&nbsp;<span class="op" id="6763085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6763089">t</span><span class="op" id="6763090">.</span><span class="ident" id="6763091">Errorf</span><span class="op" id="6763097">(</span><span class="string" id="6763098">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="6763119">,</span>&nbsp;<span class="ident" id="6763121">n</span><span class="op" id="6763122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6763125">}</span><br>
<span class="lineno"></span><span class="op" id="6763127">}</span>
</div>
</body>
</html>
