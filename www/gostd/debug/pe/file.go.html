<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5389258">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5389314">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5389368">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5389419">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5389504">package</span>&nbsp;<span class="ident" id="5389512">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5389516">import</span>&nbsp;<span class="op" id="5389523">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389526">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389541">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389560">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389570">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389577">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389583">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5389589">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5389599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5389602">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5389640">type</span>&nbsp;<span class="ident" id="5389645">File</span>&nbsp;<span class="keyword" id="5389650">struct</span>&nbsp;<span class="op" id="5389657">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389660">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389672">OptionalHeader</span>&nbsp;<span class="keyword" id="5389687">interface</span><span class="op" id="5389696">{</span><span class="op" id="5389697">}</span>&nbsp;<span class="comment" id="5389699">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389750">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389765">[</span><span class="op" id="5389766">]</span><span class="op" id="5389767">*</span><span class="ident" id="5389768">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389777">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389792">[</span><span class="op" id="5389793">]</span><span class="op" id="5389794">*</span><span class="ident" id="5389795">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389804">closer</span>&nbsp;<span class="ident" id="5389811">io</span><span class="op" id="5389813">.</span><span class="ident" id="5389814">Closer</span><br>
<span class="lineno"></span><span class="op" id="5389821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5389824">type</span>&nbsp;<span class="ident" id="5389829">SectionHeader</span>&nbsp;<span class="keyword" id="5389843">struct</span>&nbsp;<span class="op" id="5389850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389853">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389874">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389882">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389903">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389911">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389932">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389940">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389961">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389969">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389990">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389998">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5390019">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390027">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5390048">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390056">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5390077">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390085">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5390106">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390114">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390135">uint32</span><br>
<span class="lineno"></span><span class="op" id="5390142">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5390145">type</span>&nbsp;<span class="ident" id="5390150">Section</span>&nbsp;<span class="keyword" id="5390158">struct</span>&nbsp;<span class="op" id="5390165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390168">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390184">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390222">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390262">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390297">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390345">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390395">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390419">io</span><span class="op" id="5390421">.</span><span class="ident" id="5390422">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390432">sr</span>&nbsp;<span class="op" id="5390435">*</span><span class="ident" id="5390436">io</span><span class="op" id="5390438">.</span><span class="ident" id="5390439">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5390453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5390456">type</span>&nbsp;<span class="ident" id="5390461">Symbol</span>&nbsp;<span class="keyword" id="5390468">struct</span>&nbsp;<span class="op" id="5390475">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390478">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390492">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390500">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390514">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390522">SectionNumber</span>&nbsp;<span class="builtintype" id="5390536">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390543">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390557">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390565">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5390579">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5390585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5390588">type</span>&nbsp;<span class="ident" id="5390593">ImportDirectory</span>&nbsp;<span class="keyword" id="5390609">struct</span>&nbsp;<span class="op" id="5390616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390619">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5390638">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390646">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390665">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390673">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390692">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390700">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390719">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390727">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5390746">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390755">dll</span>&nbsp;<span class="builtintype" id="5390759">string</span><br>
<span class="lineno">70</span><span class="op" id="5390766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390769">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5390827">func</span>&nbsp;<span class="op" id="5390832">(</span><span class="ident" id="5390833">s</span>&nbsp;<span class="op" id="5390835">*</span><span class="ident" id="5390836">Section</span><span class="op" id="5390843">)</span>&nbsp;<span class="ident" id="5390845">Data</span><span class="op" id="5390849">(</span><span class="op" id="5390850">)</span>&nbsp;<span class="op" id="5390852">(</span><span class="op" id="5390853">[</span><span class="op" id="5390854">]</span><span class="builtintype" id="5390855">byte</span><span class="op" id="5390859">,</span>&nbsp;<span class="builtintype" id="5390861">error</span><span class="op" id="5390866">)</span>&nbsp;<span class="op" id="5390868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390871">dat</span>&nbsp;<span class="op" id="5390875">:=</span>&nbsp;<span class="builtinfunc" id="5390878">make</span><span class="op" id="5390882">(</span><span class="op" id="5390883">[</span><span class="op" id="5390884">]</span><span class="builtintype" id="5390885">byte</span><span class="op" id="5390889">,</span>&nbsp;<span class="ident" id="5390891">s</span><span class="op" id="5390892">.</span><span class="ident" id="5390893">sr</span><span class="op" id="5390895">.</span><span class="ident" id="5390896">Size</span><span class="op" id="5390900">(</span><span class="op" id="5390901">)</span><span class="op" id="5390902">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390905">n</span><span class="op" id="5390906">,</span>&nbsp;<span class="ident" id="5390908">err</span>&nbsp;<span class="op" id="5390912">:=</span>&nbsp;<span class="ident" id="5390915">s</span><span class="op" id="5390916">.</span><span class="ident" id="5390917">sr</span><span class="op" id="5390919">.</span><span class="ident" id="5390920">ReadAt</span><span class="op" id="5390926">(</span><span class="ident" id="5390927">dat</span><span class="op" id="5390930">,</span>&nbsp;<span class="num" id="5390932">0</span><span class="op" id="5390933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5390936">if</span>&nbsp;<span class="ident" id="5390939">n</span>&nbsp;<span class="op" id="5390941">==</span>&nbsp;<span class="builtinfunc" id="5390944">len</span><span class="op" id="5390947">(</span><span class="ident" id="5390948">dat</span><span class="op" id="5390951">)</span>&nbsp;<span class="op" id="5390953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390957">err</span>&nbsp;<span class="op" id="5390961">=</span>&nbsp;<span class="ident" id="5390963">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5390968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5390971">return</span>&nbsp;<span class="ident" id="5390978">dat</span><span class="op" id="5390981">[</span><span class="num" id="5390982">0</span><span class="op" id="5390983">:</span><span class="ident" id="5390984">n</span><span class="op" id="5390985">]</span><span class="op" id="5390986">,</span>&nbsp;<span class="ident" id="5390988">err</span><br>
<span class="lineno">80</span><span class="op" id="5390992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390995">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5391052">func</span>&nbsp;<span class="op" id="5391057">(</span><span class="ident" id="5391058">s</span>&nbsp;<span class="op" id="5391060">*</span><span class="ident" id="5391061">Section</span><span class="op" id="5391068">)</span>&nbsp;<span class="ident" id="5391070">Open</span><span class="op" id="5391074">(</span><span class="op" id="5391075">)</span>&nbsp;<span class="ident" id="5391077">io</span><span class="op" id="5391079">.</span><span class="ident" id="5391080">ReadSeeker</span>&nbsp;<span class="op" id="5391091">{</span>&nbsp;<span class="keyword" id="5391093">return</span>&nbsp;<span class="ident" id="5391100">io</span><span class="op" id="5391102">.</span><span class="ident" id="5391103">NewSectionReader</span><span class="op" id="5391119">(</span><span class="ident" id="5391120">s</span><span class="op" id="5391121">.</span><span class="ident" id="5391122">sr</span><span class="op" id="5391124">,</span>&nbsp;<span class="num" id="5391126">0</span><span class="op" id="5391127">,</span>&nbsp;<span class="num" id="5391129">1</span><span class="op" id="5391130">&lt;&lt;</span><span class="num" id="5391132">63</span><span class="op" id="5391134">-</span><span class="num" id="5391135">1</span><span class="op" id="5391136">)</span>&nbsp;<span class="op" id="5391138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5391141">type</span>&nbsp;<span class="ident" id="5391146">FormatError</span>&nbsp;<span class="keyword" id="5391158">struct</span>&nbsp;<span class="op" id="5391165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391168">off</span>&nbsp;<span class="ident" id="5391172">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391179">msg</span>&nbsp;<span class="builtintype" id="5391183">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391191">val</span>&nbsp;<span class="keyword" id="5391195">interface</span><span class="op" id="5391204">{</span><span class="op" id="5391205">}</span><br>
<span class="lineno"></span><span class="op" id="5391207">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5391210">func</span>&nbsp;<span class="op" id="5391215">(</span><span class="ident" id="5391216">e</span>&nbsp;<span class="op" id="5391218">*</span><span class="ident" id="5391219">FormatError</span><span class="op" id="5391230">)</span>&nbsp;<span class="ident" id="5391232">Error</span><span class="op" id="5391237">(</span><span class="op" id="5391238">)</span>&nbsp;<span class="builtintype" id="5391240">string</span>&nbsp;<span class="op" id="5391247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391250">msg</span>&nbsp;<span class="op" id="5391254">:=</span>&nbsp;<span class="ident" id="5391257">e</span><span class="op" id="5391258">.</span><span class="ident" id="5391259">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391264">if</span>&nbsp;<span class="ident" id="5391267">e</span><span class="op" id="5391268">.</span><span class="ident" id="5391269">val</span>&nbsp;<span class="op" id="5391273">!=</span>&nbsp;<span class="ident" id="5391276">nil</span>&nbsp;<span class="op" id="5391280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391284">msg</span>&nbsp;<span class="op" id="5391288">+=</span>&nbsp;<span class="ident" id="5391291">fmt</span><span class="op" id="5391294">.</span><span class="ident" id="5391295">Sprintf</span><span class="op" id="5391302">(</span><span class="string" id="5391303">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5391310">,</span>&nbsp;<span class="ident" id="5391312">e</span><span class="op" id="5391313">.</span><span class="ident" id="5391314">val</span><span class="op" id="5391317">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391323">msg</span>&nbsp;<span class="op" id="5391327">+=</span>&nbsp;<span class="ident" id="5391330">fmt</span><span class="op" id="5391333">.</span><span class="ident" id="5391334">Sprintf</span><span class="op" id="5391341">(</span><span class="string" id="5391342">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5391366">,</span>&nbsp;<span class="ident" id="5391368">e</span><span class="op" id="5391369">.</span><span class="ident" id="5391370">off</span><span class="op" id="5391373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391376">return</span>&nbsp;<span class="ident" id="5391383">msg</span><br>
<span class="lineno"></span><span class="op" id="5391387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5391390">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5391473">func</span>&nbsp;<span class="ident" id="5391478">Open</span><span class="op" id="5391482">(</span><span class="ident" id="5391483">name</span>&nbsp;<span class="builtintype" id="5391488">string</span><span class="op" id="5391494">)</span>&nbsp;<span class="op" id="5391496">(</span><span class="op" id="5391497">*</span><span class="ident" id="5391498">File</span><span class="op" id="5391502">,</span>&nbsp;<span class="builtintype" id="5391504">error</span><span class="op" id="5391509">)</span>&nbsp;<span class="op" id="5391511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391514">f</span><span class="op" id="5391515">,</span>&nbsp;<span class="ident" id="5391517">err</span>&nbsp;<span class="op" id="5391521">:=</span>&nbsp;<span class="ident" id="5391524">os</span><span class="op" id="5391526">.</span><span class="ident" id="5391527">Open</span><span class="op" id="5391531">(</span><span class="ident" id="5391532">name</span><span class="op" id="5391536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391539">if</span>&nbsp;<span class="ident" id="5391542">err</span>&nbsp;<span class="op" id="5391546">!=</span>&nbsp;<span class="ident" id="5391549">nil</span>&nbsp;<span class="op" id="5391553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391557">return</span>&nbsp;<span class="ident" id="5391564">nil</span><span class="op" id="5391567">,</span>&nbsp;<span class="ident" id="5391569">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391577">ff</span><span class="op" id="5391579">,</span>&nbsp;<span class="ident" id="5391581">err</span>&nbsp;<span class="op" id="5391585">:=</span>&nbsp;<span class="ident" id="5391588">NewFile</span><span class="op" id="5391595">(</span><span class="ident" id="5391596">f</span><span class="op" id="5391597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391600">if</span>&nbsp;<span class="ident" id="5391603">err</span>&nbsp;<span class="op" id="5391607">!=</span>&nbsp;<span class="ident" id="5391610">nil</span>&nbsp;<span class="op" id="5391614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391618">f</span><span class="op" id="5391619">.</span><span class="ident" id="5391620">Close</span><span class="op" id="5391625">(</span><span class="op" id="5391626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391630">return</span>&nbsp;<span class="ident" id="5391637">nil</span><span class="op" id="5391640">,</span>&nbsp;<span class="ident" id="5391642">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391650">ff</span><span class="op" id="5391652">.</span><span class="ident" id="5391653">closer</span>&nbsp;<span class="op" id="5391660">=</span>&nbsp;<span class="ident" id="5391662">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391665">return</span>&nbsp;<span class="ident" id="5391672">ff</span><span class="op" id="5391674">,</span>&nbsp;<span class="ident" id="5391676">nil</span><br>
<span class="lineno"></span><span class="op" id="5391680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5391683">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5391709">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5391776">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5391800">func</span>&nbsp;<span class="op" id="5391805">(</span><span class="ident" id="5391806">f</span>&nbsp;<span class="op" id="5391808">*</span><span class="ident" id="5391809">File</span><span class="op" id="5391813">)</span>&nbsp;<span class="ident" id="5391815">Close</span><span class="op" id="5391820">(</span><span class="op" id="5391821">)</span>&nbsp;<span class="builtintype" id="5391823">error</span>&nbsp;<span class="op" id="5391829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391832">var</span>&nbsp;<span class="ident" id="5391836">err</span>&nbsp;<span class="builtintype" id="5391840">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391847">if</span>&nbsp;<span class="ident" id="5391850">f</span><span class="op" id="5391851">.</span><span class="ident" id="5391852">closer</span>&nbsp;<span class="op" id="5391859">!=</span>&nbsp;<span class="ident" id="5391862">nil</span>&nbsp;<span class="op" id="5391866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391870">err</span>&nbsp;<span class="op" id="5391874">=</span>&nbsp;<span class="ident" id="5391876">f</span><span class="op" id="5391877">.</span><span class="ident" id="5391878">closer</span><span class="op" id="5391884">.</span><span class="ident" id="5391885">Close</span><span class="op" id="5391890">(</span><span class="op" id="5391891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391895">f</span><span class="op" id="5391896">.</span><span class="ident" id="5391897">closer</span>&nbsp;<span class="op" id="5391904">=</span>&nbsp;<span class="ident" id="5391906">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391914">return</span>&nbsp;<span class="ident" id="5391921">err</span><br>
<span class="lineno">125</span><span class="op" id="5391925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5391928">var</span>&nbsp;<span class="op" id="5391932">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391935">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5391958">=</span>&nbsp;<span class="builtintype" id="5391960">uint16</span><span class="op" id="5391966">(</span><span class="ident" id="5391967">binary</span><span class="op" id="5391973">.</span><span class="ident" id="5391974">Size</span><span class="op" id="5391978">(</span><span class="ident" id="5391979">OptionalHeader32</span><span class="op" id="5391995">{</span><span class="op" id="5391996">}</span><span class="op" id="5391997">)</span><span class="op" id="5391998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392001">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5392024">=</span>&nbsp;<span class="builtintype" id="5392026">uint16</span><span class="op" id="5392032">(</span><span class="ident" id="5392033">binary</span><span class="op" id="5392039">.</span><span class="ident" id="5392040">Size</span><span class="op" id="5392044">(</span><span class="ident" id="5392045">OptionalHeader64</span><span class="op" id="5392061">{</span><span class="op" id="5392062">}</span><span class="op" id="5392063">)</span><span class="op" id="5392064">)</span><br>
<span class="lineno">130</span><span class="op" id="5392066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392069">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5392150">func</span>&nbsp;<span class="ident" id="5392155">NewFile</span><span class="op" id="5392162">(</span><span class="ident" id="5392163">r</span>&nbsp;<span class="ident" id="5392165">io</span><span class="op" id="5392167">.</span><span class="ident" id="5392168">ReaderAt</span><span class="op" id="5392176">)</span>&nbsp;<span class="op" id="5392178">(</span><span class="op" id="5392179">*</span><span class="ident" id="5392180">File</span><span class="op" id="5392184">,</span>&nbsp;<span class="builtintype" id="5392186">error</span><span class="op" id="5392191">)</span>&nbsp;<span class="op" id="5392193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392196">f</span>&nbsp;<span class="op" id="5392198">:=</span>&nbsp;<span class="builtinfunc" id="5392201">new</span><span class="op" id="5392204">(</span><span class="ident" id="5392205">File</span><span class="op" id="5392209">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392212">sr</span>&nbsp;<span class="op" id="5392215">:=</span>&nbsp;<span class="ident" id="5392218">io</span><span class="op" id="5392220">.</span><span class="ident" id="5392221">NewSectionReader</span><span class="op" id="5392237">(</span><span class="ident" id="5392238">r</span><span class="op" id="5392239">,</span>&nbsp;<span class="num" id="5392241">0</span><span class="op" id="5392242">,</span>&nbsp;<span class="num" id="5392244">1</span><span class="op" id="5392245">&lt;&lt;</span><span class="num" id="5392247">63</span><span class="op" id="5392249">-</span><span class="num" id="5392250">1</span><span class="op" id="5392251">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392255">var</span>&nbsp;<span class="ident" id="5392259">dosheader</span>&nbsp;<span class="op" id="5392269">[</span><span class="num" id="5392270">96</span><span class="op" id="5392272">]</span><span class="builtintype" id="5392273">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392279">if</span>&nbsp;<span class="ident" id="5392282">_</span><span class="op" id="5392283">,</span>&nbsp;<span class="ident" id="5392285">err</span>&nbsp;<span class="op" id="5392289">:=</span>&nbsp;<span class="ident" id="5392292">r</span><span class="op" id="5392293">.</span><span class="ident" id="5392294">ReadAt</span><span class="op" id="5392300">(</span><span class="ident" id="5392301">dosheader</span><span class="op" id="5392310">[</span><span class="num" id="5392311">0</span><span class="op" id="5392312">:</span><span class="op" id="5392313">]</span><span class="op" id="5392314">,</span>&nbsp;<span class="num" id="5392316">0</span><span class="op" id="5392317">)</span><span class="op" id="5392318">;</span>&nbsp;<span class="ident" id="5392320">err</span>&nbsp;<span class="op" id="5392324">!=</span>&nbsp;<span class="ident" id="5392327">nil</span>&nbsp;<span class="op" id="5392331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392335">return</span>&nbsp;<span class="ident" id="5392342">nil</span><span class="op" id="5392345">,</span>&nbsp;<span class="ident" id="5392347">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392355">var</span>&nbsp;<span class="ident" id="5392359">base</span>&nbsp;<span class="ident" id="5392364">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392371">if</span>&nbsp;<span class="ident" id="5392374">dosheader</span><span class="op" id="5392383">[</span><span class="num" id="5392384">0</span><span class="op" id="5392385">]</span>&nbsp;<span class="op" id="5392387">==</span>&nbsp;<span class="string" id="5392390">&#39;M&#39;</span>&nbsp;<span class="op" id="5392394">&amp;&amp;</span>&nbsp;<span class="ident" id="5392397">dosheader</span><span class="op" id="5392406">[</span><span class="num" id="5392407">1</span><span class="op" id="5392408">]</span>&nbsp;<span class="op" id="5392410">==</span>&nbsp;<span class="string" id="5392413">&#39;Z&#39;</span>&nbsp;<span class="op" id="5392417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392421">signoff</span>&nbsp;<span class="op" id="5392429">:=</span>&nbsp;<span class="ident" id="5392432">int64</span><span class="op" id="5392437">(</span><span class="ident" id="5392438">binary</span><span class="op" id="5392444">.</span><span class="ident" id="5392445">LittleEndian</span><span class="op" id="5392457">.</span><span class="ident" id="5392458">Uint32</span><span class="op" id="5392464">(</span><span class="ident" id="5392465">dosheader</span><span class="op" id="5392474">[</span><span class="num" id="5392475">0x3c</span><span class="op" id="5392479">:</span><span class="op" id="5392480">]</span><span class="op" id="5392481">)</span><span class="op" id="5392482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392486">var</span>&nbsp;<span class="ident" id="5392490">sign</span>&nbsp;<span class="op" id="5392495">[</span><span class="num" id="5392496">4</span><span class="op" id="5392497">]</span><span class="builtintype" id="5392498">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392505">r</span><span class="op" id="5392506">.</span><span class="ident" id="5392507">ReadAt</span><span class="op" id="5392513">(</span><span class="ident" id="5392514">sign</span><span class="op" id="5392518">[</span><span class="op" id="5392519">:</span><span class="op" id="5392520">]</span><span class="op" id="5392521">,</span>&nbsp;<span class="ident" id="5392523">signoff</span><span class="op" id="5392530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392534">if</span>&nbsp;<span class="op" id="5392537">!</span><span class="op" id="5392538">(</span><span class="ident" id="5392539">sign</span><span class="op" id="5392543">[</span><span class="num" id="5392544">0</span><span class="op" id="5392545">]</span>&nbsp;<span class="op" id="5392547">==</span>&nbsp;<span class="string" id="5392550">&#39;P&#39;</span>&nbsp;<span class="op" id="5392554">&amp;&amp;</span>&nbsp;<span class="ident" id="5392557">sign</span><span class="op" id="5392561">[</span><span class="num" id="5392562">1</span><span class="op" id="5392563">]</span>&nbsp;<span class="op" id="5392565">==</span>&nbsp;<span class="string" id="5392568">&#39;E&#39;</span>&nbsp;<span class="op" id="5392572">&amp;&amp;</span>&nbsp;<span class="ident" id="5392575">sign</span><span class="op" id="5392579">[</span><span class="num" id="5392580">2</span><span class="op" id="5392581">]</span>&nbsp;<span class="op" id="5392583">==</span>&nbsp;<span class="num" id="5392586">0</span>&nbsp;<span class="op" id="5392588">&amp;&amp;</span>&nbsp;<span class="ident" id="5392591">sign</span><span class="op" id="5392595">[</span><span class="num" id="5392596">3</span><span class="op" id="5392597">]</span>&nbsp;<span class="op" id="5392599">==</span>&nbsp;<span class="num" id="5392602">0</span><span class="op" id="5392603">)</span>&nbsp;<span class="op" id="5392605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392610">return</span>&nbsp;<span class="ident" id="5392617">nil</span><span class="op" id="5392620">,</span>&nbsp;<span class="ident" id="5392622">errors</span><span class="op" id="5392628">.</span><span class="ident" id="5392629">New</span><span class="op" id="5392632">(</span><span class="string" id="5392633">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5392658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392666">base</span>&nbsp;<span class="op" id="5392671">=</span>&nbsp;<span class="ident" id="5392673">signoff</span>&nbsp;<span class="op" id="5392681">+</span>&nbsp;<span class="num" id="5392683">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392686">}</span>&nbsp;<span class="keyword" id="5392688">else</span>&nbsp;<span class="op" id="5392693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392697">base</span>&nbsp;<span class="op" id="5392702">=</span>&nbsp;<span class="ident" id="5392704">int64</span><span class="op" id="5392709">(</span><span class="num" id="5392710">0</span><span class="op" id="5392711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392717">sr</span><span class="op" id="5392719">.</span><span class="ident" id="5392720">Seek</span><span class="op" id="5392724">(</span><span class="ident" id="5392725">base</span><span class="op" id="5392729">,</span>&nbsp;<span class="ident" id="5392731">os</span><span class="op" id="5392733">.</span><span class="ident" id="5392734">SEEK_SET</span><span class="op" id="5392742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392745">if</span>&nbsp;<span class="ident" id="5392748">err</span>&nbsp;<span class="op" id="5392752">:=</span>&nbsp;<span class="ident" id="5392755">binary</span><span class="op" id="5392761">.</span><span class="ident" id="5392762">Read</span><span class="op" id="5392766">(</span><span class="ident" id="5392767">sr</span><span class="op" id="5392769">,</span>&nbsp;<span class="ident" id="5392771">binary</span><span class="op" id="5392777">.</span><span class="ident" id="5392778">LittleEndian</span><span class="op" id="5392790">,</span>&nbsp;<span class="op" id="5392792">&amp;</span><span class="ident" id="5392793">f</span><span class="op" id="5392794">.</span><span class="ident" id="5392795">FileHeader</span><span class="op" id="5392805">)</span><span class="op" id="5392806">;</span>&nbsp;<span class="ident" id="5392808">err</span>&nbsp;<span class="op" id="5392812">!=</span>&nbsp;<span class="ident" id="5392815">nil</span>&nbsp;<span class="op" id="5392819">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392823">return</span>&nbsp;<span class="ident" id="5392830">nil</span><span class="op" id="5392833">,</span>&nbsp;<span class="ident" id="5392835">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392843">if</span>&nbsp;<span class="ident" id="5392846">f</span><span class="op" id="5392847">.</span><span class="ident" id="5392848">FileHeader</span><span class="op" id="5392858">.</span><span class="ident" id="5392859">Machine</span>&nbsp;<span class="op" id="5392867">!=</span>&nbsp;<span class="ident" id="5392870">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5392897">&amp;&amp;</span>&nbsp;<span class="ident" id="5392900">f</span><span class="op" id="5392901">.</span><span class="ident" id="5392902">FileHeader</span><span class="op" id="5392912">.</span><span class="ident" id="5392913">Machine</span>&nbsp;<span class="op" id="5392921">!=</span>&nbsp;<span class="ident" id="5392924">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5392949">&amp;&amp;</span>&nbsp;<span class="ident" id="5392952">f</span><span class="op" id="5392953">.</span><span class="ident" id="5392954">FileHeader</span><span class="op" id="5392964">.</span><span class="ident" id="5392965">Machine</span>&nbsp;<span class="op" id="5392973">!=</span>&nbsp;<span class="ident" id="5392976">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5393000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393004">return</span>&nbsp;<span class="ident" id="5393011">nil</span><span class="op" id="5393014">,</span>&nbsp;<span class="ident" id="5393016">errors</span><span class="op" id="5393022">.</span><span class="ident" id="5393023">New</span><span class="op" id="5393026">(</span><span class="string" id="5393027">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5393052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393055">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393059">var</span>&nbsp;<span class="ident" id="5393063">ss</span>&nbsp;<span class="op" id="5393066">[</span><span class="op" id="5393067">]</span><span class="builtintype" id="5393068">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393074">if</span>&nbsp;<span class="ident" id="5393077">f</span><span class="op" id="5393078">.</span><span class="ident" id="5393079">FileHeader</span><span class="op" id="5393089">.</span><span class="ident" id="5393090">NumberOfSymbols</span>&nbsp;<span class="op" id="5393106">&gt;</span>&nbsp;<span class="num" id="5393108">0</span>&nbsp;<span class="op" id="5393110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5393114">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393196">sr</span><span class="op" id="5393198">.</span><span class="ident" id="5393199">Seek</span><span class="op" id="5393203">(</span><span class="ident" id="5393204">int64</span><span class="op" id="5393209">(</span><span class="ident" id="5393210">f</span><span class="op" id="5393211">.</span><span class="ident" id="5393212">FileHeader</span><span class="op" id="5393222">.</span><span class="ident" id="5393223">PointerToSymbolTable</span><span class="op" id="5393243">+</span><span class="ident" id="5393244">COFFSymbolSize</span><span class="op" id="5393258">*</span><span class="ident" id="5393259">f</span><span class="op" id="5393260">.</span><span class="ident" id="5393261">FileHeader</span><span class="op" id="5393271">.</span><span class="ident" id="5393272">NumberOfSymbols</span><span class="op" id="5393287">)</span><span class="op" id="5393288">,</span>&nbsp;<span class="ident" id="5393290">os</span><span class="op" id="5393292">.</span><span class="ident" id="5393293">SEEK_SET</span><span class="op" id="5393301">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393305">var</span>&nbsp;<span class="ident" id="5393309">l</span>&nbsp;<span class="builtintype" id="5393311">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393320">if</span>&nbsp;<span class="ident" id="5393323">err</span>&nbsp;<span class="op" id="5393327">:=</span>&nbsp;<span class="ident" id="5393330">binary</span><span class="op" id="5393336">.</span><span class="ident" id="5393337">Read</span><span class="op" id="5393341">(</span><span class="ident" id="5393342">sr</span><span class="op" id="5393344">,</span>&nbsp;<span class="ident" id="5393346">binary</span><span class="op" id="5393352">.</span><span class="ident" id="5393353">LittleEndian</span><span class="op" id="5393365">,</span>&nbsp;<span class="op" id="5393367">&amp;</span><span class="ident" id="5393368">l</span><span class="op" id="5393369">)</span><span class="op" id="5393370">;</span>&nbsp;<span class="ident" id="5393372">err</span>&nbsp;<span class="op" id="5393376">!=</span>&nbsp;<span class="ident" id="5393379">nil</span>&nbsp;<span class="op" id="5393383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393388">return</span>&nbsp;<span class="ident" id="5393395">nil</span><span class="op" id="5393398">,</span>&nbsp;<span class="ident" id="5393400">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393410">ss</span>&nbsp;<span class="op" id="5393413">=</span>&nbsp;<span class="builtinfunc" id="5393415">make</span><span class="op" id="5393419">(</span><span class="op" id="5393420">[</span><span class="op" id="5393421">]</span><span class="builtintype" id="5393422">byte</span><span class="op" id="5393426">,</span>&nbsp;<span class="ident" id="5393428">l</span><span class="op" id="5393429">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393433">if</span>&nbsp;<span class="ident" id="5393436">_</span><span class="op" id="5393437">,</span>&nbsp;<span class="ident" id="5393439">err</span>&nbsp;<span class="op" id="5393443">:=</span>&nbsp;<span class="ident" id="5393446">r</span><span class="op" id="5393447">.</span><span class="ident" id="5393448">ReadAt</span><span class="op" id="5393454">(</span><span class="ident" id="5393455">ss</span><span class="op" id="5393457">,</span>&nbsp;<span class="ident" id="5393459">int64</span><span class="op" id="5393464">(</span><span class="ident" id="5393465">f</span><span class="op" id="5393466">.</span><span class="ident" id="5393467">FileHeader</span><span class="op" id="5393477">.</span><span class="ident" id="5393478">PointerToSymbolTable</span><span class="op" id="5393498">+</span><span class="ident" id="5393499">COFFSymbolSize</span><span class="op" id="5393513">*</span><span class="ident" id="5393514">f</span><span class="op" id="5393515">.</span><span class="ident" id="5393516">FileHeader</span><span class="op" id="5393526">.</span><span class="ident" id="5393527">NumberOfSymbols</span><span class="op" id="5393542">)</span><span class="op" id="5393543">)</span><span class="op" id="5393544">;</span>&nbsp;<span class="ident" id="5393546">err</span>&nbsp;<span class="op" id="5393550">!=</span>&nbsp;<span class="ident" id="5393553">nil</span>&nbsp;<span class="op" id="5393557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393562">return</span>&nbsp;<span class="ident" id="5393569">nil</span><span class="op" id="5393572">,</span>&nbsp;<span class="ident" id="5393574">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5393585">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393617">sr</span><span class="op" id="5393619">.</span><span class="ident" id="5393620">Seek</span><span class="op" id="5393624">(</span><span class="ident" id="5393625">int64</span><span class="op" id="5393630">(</span><span class="ident" id="5393631">f</span><span class="op" id="5393632">.</span><span class="ident" id="5393633">FileHeader</span><span class="op" id="5393643">.</span><span class="ident" id="5393644">PointerToSymbolTable</span><span class="op" id="5393664">)</span><span class="op" id="5393665">,</span>&nbsp;<span class="ident" id="5393667">os</span><span class="op" id="5393669">.</span><span class="ident" id="5393670">SEEK_SET</span><span class="op" id="5393678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393682">aux</span>&nbsp;<span class="op" id="5393686">:=</span>&nbsp;<span class="builtintype" id="5393689">uint8</span><span class="op" id="5393694">(</span><span class="num" id="5393695">0</span><span class="op" id="5393696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393700">for</span>&nbsp;<span class="ident" id="5393704">i</span>&nbsp;<span class="op" id="5393706">:=</span>&nbsp;<span class="num" id="5393709">0</span><span class="op" id="5393710">;</span>&nbsp;<span class="ident" id="5393712">i</span>&nbsp;<span class="op" id="5393714">&lt;</span>&nbsp;<span class="builtintype" id="5393716">int</span><span class="op" id="5393719">(</span><span class="ident" id="5393720">f</span><span class="op" id="5393721">.</span><span class="ident" id="5393722">FileHeader</span><span class="op" id="5393732">.</span><span class="ident" id="5393733">NumberOfSymbols</span><span class="op" id="5393748">)</span><span class="op" id="5393749">;</span>&nbsp;<span class="ident" id="5393751">i</span><span class="op" id="5393752">++</span>&nbsp;<span class="op" id="5393755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393760">cs</span>&nbsp;<span class="op" id="5393763">:=</span>&nbsp;<span class="builtinfunc" id="5393766">new</span><span class="op" id="5393769">(</span><span class="ident" id="5393770">COFFSymbol</span><span class="op" id="5393780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393785">if</span>&nbsp;<span class="ident" id="5393788">err</span>&nbsp;<span class="op" id="5393792">:=</span>&nbsp;<span class="ident" id="5393795">binary</span><span class="op" id="5393801">.</span><span class="ident" id="5393802">Read</span><span class="op" id="5393806">(</span><span class="ident" id="5393807">sr</span><span class="op" id="5393809">,</span>&nbsp;<span class="ident" id="5393811">binary</span><span class="op" id="5393817">.</span><span class="ident" id="5393818">LittleEndian</span><span class="op" id="5393830">,</span>&nbsp;<span class="ident" id="5393832">cs</span><span class="op" id="5393834">)</span><span class="op" id="5393835">;</span>&nbsp;<span class="ident" id="5393837">err</span>&nbsp;<span class="op" id="5393841">!=</span>&nbsp;<span class="ident" id="5393844">nil</span>&nbsp;<span class="op" id="5393848">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393854">return</span>&nbsp;<span class="ident" id="5393861">nil</span><span class="op" id="5393864">,</span>&nbsp;<span class="ident" id="5393866">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393878">if</span>&nbsp;<span class="ident" id="5393881">aux</span>&nbsp;<span class="op" id="5393885">&gt;</span>&nbsp;<span class="num" id="5393887">0</span>&nbsp;<span class="op" id="5393889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393895">aux</span><span class="op" id="5393898">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393905">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393922">var</span>&nbsp;<span class="ident" id="5393926">name</span>&nbsp;<span class="builtintype" id="5393931">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393941">if</span>&nbsp;<span class="ident" id="5393944">cs</span><span class="op" id="5393946">.</span><span class="ident" id="5393947">Name</span><span class="op" id="5393951">[</span><span class="num" id="5393952">0</span><span class="op" id="5393953">]</span>&nbsp;<span class="op" id="5393955">==</span>&nbsp;<span class="num" id="5393958">0</span>&nbsp;<span class="op" id="5393960">&amp;&amp;</span>&nbsp;<span class="ident" id="5393963">cs</span><span class="op" id="5393965">.</span><span class="ident" id="5393966">Name</span><span class="op" id="5393970">[</span><span class="num" id="5393971">1</span><span class="op" id="5393972">]</span>&nbsp;<span class="op" id="5393974">==</span>&nbsp;<span class="num" id="5393977">0</span>&nbsp;<span class="op" id="5393979">&amp;&amp;</span>&nbsp;<span class="ident" id="5393982">cs</span><span class="op" id="5393984">.</span><span class="ident" id="5393985">Name</span><span class="op" id="5393989">[</span><span class="num" id="5393990">2</span><span class="op" id="5393991">]</span>&nbsp;<span class="op" id="5393993">==</span>&nbsp;<span class="num" id="5393996">0</span>&nbsp;<span class="op" id="5393998">&amp;&amp;</span>&nbsp;<span class="ident" id="5394001">cs</span><span class="op" id="5394003">.</span><span class="ident" id="5394004">Name</span><span class="op" id="5394008">[</span><span class="num" id="5394009">3</span><span class="op" id="5394010">]</span>&nbsp;<span class="op" id="5394012">==</span>&nbsp;<span class="num" id="5394015">0</span>&nbsp;<span class="op" id="5394017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394023">si</span>&nbsp;<span class="op" id="5394026">:=</span>&nbsp;<span class="builtintype" id="5394029">int</span><span class="op" id="5394032">(</span><span class="ident" id="5394033">binary</span><span class="op" id="5394039">.</span><span class="ident" id="5394040">LittleEndian</span><span class="op" id="5394052">.</span><span class="ident" id="5394053">Uint32</span><span class="op" id="5394059">(</span><span class="ident" id="5394060">cs</span><span class="op" id="5394062">.</span><span class="ident" id="5394063">Name</span><span class="op" id="5394067">[</span><span class="num" id="5394068">4</span><span class="op" id="5394069">:</span><span class="op" id="5394070">]</span><span class="op" id="5394071">)</span><span class="op" id="5394072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394078">name</span><span class="op" id="5394082">,</span>&nbsp;<span class="ident" id="5394084">_</span>&nbsp;<span class="op" id="5394086">=</span>&nbsp;<span class="ident" id="5394088">getString</span><span class="op" id="5394097">(</span><span class="ident" id="5394098">ss</span><span class="op" id="5394100">,</span>&nbsp;<span class="ident" id="5394102">si</span><span class="op" id="5394104">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394109">}</span>&nbsp;<span class="keyword" id="5394111">else</span>&nbsp;<span class="op" id="5394116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394122">name</span>&nbsp;<span class="op" id="5394127">=</span>&nbsp;<span class="ident" id="5394129">cstring</span><span class="op" id="5394136">(</span><span class="ident" id="5394137">cs</span><span class="op" id="5394139">.</span><span class="ident" id="5394140">Name</span><span class="op" id="5394144">[</span><span class="op" id="5394145">:</span><span class="op" id="5394146">]</span><span class="op" id="5394147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394157">aux</span>&nbsp;<span class="op" id="5394161">=</span>&nbsp;<span class="ident" id="5394163">cs</span><span class="op" id="5394165">.</span><span class="ident" id="5394166">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394188">s</span>&nbsp;<span class="op" id="5394190">:=</span>&nbsp;<span class="op" id="5394193">&amp;</span><span class="ident" id="5394194">Symbol</span><span class="op" id="5394200">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394206">Name</span><span class="op" id="5394210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394221">name</span><span class="op" id="5394225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394231">Value</span><span class="op" id="5394236">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394246">cs</span><span class="op" id="5394248">.</span><span class="ident" id="5394249">Value</span><span class="op" id="5394254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394260">SectionNumber</span><span class="op" id="5394273">:</span>&nbsp;<span class="ident" id="5394275">cs</span><span class="op" id="5394277">.</span><span class="ident" id="5394278">SectionNumber</span><span class="op" id="5394291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394297">Type</span><span class="op" id="5394301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394312">cs</span><span class="op" id="5394314">.</span><span class="ident" id="5394315">Type</span><span class="op" id="5394319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394325">StorageClass</span><span class="op" id="5394337">:</span>&nbsp;&nbsp;<span class="ident" id="5394340">cs</span><span class="op" id="5394342">.</span><span class="ident" id="5394343">StorageClass</span><span class="op" id="5394355">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394365">f</span><span class="op" id="5394366">.</span><span class="ident" id="5394367">Symbols</span>&nbsp;<span class="op" id="5394375">=</span>&nbsp;<span class="builtinfunc" id="5394377">append</span><span class="op" id="5394383">(</span><span class="ident" id="5394384">f</span><span class="op" id="5394385">.</span><span class="ident" id="5394386">Symbols</span><span class="op" id="5394393">,</span>&nbsp;<span class="ident" id="5394395">s</span><span class="op" id="5394396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5394407">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394433">sr</span><span class="op" id="5394435">.</span><span class="ident" id="5394436">Seek</span><span class="op" id="5394440">(</span><span class="ident" id="5394441">base</span><span class="op" id="5394445">,</span>&nbsp;<span class="ident" id="5394447">os</span><span class="op" id="5394449">.</span><span class="ident" id="5394450">SEEK_SET</span><span class="op" id="5394458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394461">if</span>&nbsp;<span class="ident" id="5394464">err</span>&nbsp;<span class="op" id="5394468">:=</span>&nbsp;<span class="ident" id="5394471">binary</span><span class="op" id="5394477">.</span><span class="ident" id="5394478">Read</span><span class="op" id="5394482">(</span><span class="ident" id="5394483">sr</span><span class="op" id="5394485">,</span>&nbsp;<span class="ident" id="5394487">binary</span><span class="op" id="5394493">.</span><span class="ident" id="5394494">LittleEndian</span><span class="op" id="5394506">,</span>&nbsp;<span class="op" id="5394508">&amp;</span><span class="ident" id="5394509">f</span><span class="op" id="5394510">.</span><span class="ident" id="5394511">FileHeader</span><span class="op" id="5394521">)</span><span class="op" id="5394522">;</span>&nbsp;<span class="ident" id="5394524">err</span>&nbsp;<span class="op" id="5394528">!=</span>&nbsp;<span class="ident" id="5394531">nil</span>&nbsp;<span class="op" id="5394535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394539">return</span>&nbsp;<span class="ident" id="5394546">nil</span><span class="op" id="5394549">,</span>&nbsp;<span class="ident" id="5394551">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394556">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394559">var</span>&nbsp;<span class="ident" id="5394563">oh32</span>&nbsp;<span class="ident" id="5394568">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394586">var</span>&nbsp;<span class="ident" id="5394590">oh64</span>&nbsp;<span class="ident" id="5394595">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394613">switch</span>&nbsp;<span class="ident" id="5394620">f</span><span class="op" id="5394621">.</span><span class="ident" id="5394622">FileHeader</span><span class="op" id="5394632">.</span><span class="ident" id="5394633">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5394654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394657">case</span>&nbsp;<span class="ident" id="5394662">sizeofOptionalHeader32</span><span class="op" id="5394684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394688">if</span>&nbsp;<span class="ident" id="5394691">err</span>&nbsp;<span class="op" id="5394695">:=</span>&nbsp;<span class="ident" id="5394698">binary</span><span class="op" id="5394704">.</span><span class="ident" id="5394705">Read</span><span class="op" id="5394709">(</span><span class="ident" id="5394710">sr</span><span class="op" id="5394712">,</span>&nbsp;<span class="ident" id="5394714">binary</span><span class="op" id="5394720">.</span><span class="ident" id="5394721">LittleEndian</span><span class="op" id="5394733">,</span>&nbsp;<span class="op" id="5394735">&amp;</span><span class="ident" id="5394736">oh32</span><span class="op" id="5394740">)</span><span class="op" id="5394741">;</span>&nbsp;<span class="ident" id="5394743">err</span>&nbsp;<span class="op" id="5394747">!=</span>&nbsp;<span class="ident" id="5394750">nil</span>&nbsp;<span class="op" id="5394754">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394759">return</span>&nbsp;<span class="ident" id="5394766">nil</span><span class="op" id="5394769">,</span>&nbsp;<span class="ident" id="5394771">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394781">if</span>&nbsp;<span class="ident" id="5394784">oh32</span><span class="op" id="5394788">.</span><span class="ident" id="5394789">Magic</span>&nbsp;<span class="op" id="5394795">!=</span>&nbsp;<span class="num" id="5394798">0x10b</span>&nbsp;<span class="op" id="5394804">{</span>&nbsp;<span class="comment" id="5394806">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394817">return</span>&nbsp;<span class="ident" id="5394824">nil</span><span class="op" id="5394827">,</span>&nbsp;<span class="ident" id="5394829">fmt</span><span class="op" id="5394832">.</span><span class="ident" id="5394833">Errorf</span><span class="op" id="5394839">(</span><span class="string" id="5394840">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5394891">,</span>&nbsp;<span class="ident" id="5394893">oh32</span><span class="op" id="5394897">.</span><span class="ident" id="5394898">Magic</span><span class="op" id="5394903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394907">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394911">f</span><span class="op" id="5394912">.</span><span class="ident" id="5394913">OptionalHeader</span>&nbsp;<span class="op" id="5394928">=</span>&nbsp;<span class="op" id="5394930">&amp;</span><span class="ident" id="5394931">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394937">case</span>&nbsp;<span class="ident" id="5394942">sizeofOptionalHeader64</span><span class="op" id="5394964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394968">if</span>&nbsp;<span class="ident" id="5394971">err</span>&nbsp;<span class="op" id="5394975">:=</span>&nbsp;<span class="ident" id="5394978">binary</span><span class="op" id="5394984">.</span><span class="ident" id="5394985">Read</span><span class="op" id="5394989">(</span><span class="ident" id="5394990">sr</span><span class="op" id="5394992">,</span>&nbsp;<span class="ident" id="5394994">binary</span><span class="op" id="5395000">.</span><span class="ident" id="5395001">LittleEndian</span><span class="op" id="5395013">,</span>&nbsp;<span class="op" id="5395015">&amp;</span><span class="ident" id="5395016">oh64</span><span class="op" id="5395020">)</span><span class="op" id="5395021">;</span>&nbsp;<span class="ident" id="5395023">err</span>&nbsp;<span class="op" id="5395027">!=</span>&nbsp;<span class="ident" id="5395030">nil</span>&nbsp;<span class="op" id="5395034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395039">return</span>&nbsp;<span class="ident" id="5395046">nil</span><span class="op" id="5395049">,</span>&nbsp;<span class="ident" id="5395051">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395057">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395061">if</span>&nbsp;<span class="ident" id="5395064">oh64</span><span class="op" id="5395068">.</span><span class="ident" id="5395069">Magic</span>&nbsp;<span class="op" id="5395075">!=</span>&nbsp;<span class="num" id="5395078">0x20b</span>&nbsp;<span class="op" id="5395084">{</span>&nbsp;<span class="comment" id="5395086">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395098">return</span>&nbsp;<span class="ident" id="5395105">nil</span><span class="op" id="5395108">,</span>&nbsp;<span class="ident" id="5395110">fmt</span><span class="op" id="5395113">.</span><span class="ident" id="5395114">Errorf</span><span class="op" id="5395120">(</span><span class="string" id="5395121">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5395173">,</span>&nbsp;<span class="ident" id="5395175">oh64</span><span class="op" id="5395179">.</span><span class="ident" id="5395180">Magic</span><span class="op" id="5395185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395193">f</span><span class="op" id="5395194">.</span><span class="ident" id="5395195">OptionalHeader</span>&nbsp;<span class="op" id="5395210">=</span>&nbsp;<span class="op" id="5395212">&amp;</span><span class="ident" id="5395213">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395219">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5395223">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395245">f</span><span class="op" id="5395246">.</span><span class="ident" id="5395247">Sections</span>&nbsp;<span class="op" id="5395256">=</span>&nbsp;<span class="builtinfunc" id="5395258">make</span><span class="op" id="5395262">(</span><span class="op" id="5395263">[</span><span class="op" id="5395264">]</span><span class="op" id="5395265">*</span><span class="ident" id="5395266">Section</span><span class="op" id="5395273">,</span>&nbsp;<span class="ident" id="5395275">f</span><span class="op" id="5395276">.</span><span class="ident" id="5395277">FileHeader</span><span class="op" id="5395287">.</span><span class="ident" id="5395288">NumberOfSections</span><span class="op" id="5395304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395307">for</span>&nbsp;<span class="ident" id="5395311">i</span>&nbsp;<span class="op" id="5395313">:=</span>&nbsp;<span class="num" id="5395316">0</span><span class="op" id="5395317">;</span>&nbsp;<span class="ident" id="5395319">i</span>&nbsp;<span class="op" id="5395321">&lt;</span>&nbsp;<span class="builtintype" id="5395323">int</span><span class="op" id="5395326">(</span><span class="ident" id="5395327">f</span><span class="op" id="5395328">.</span><span class="ident" id="5395329">FileHeader</span><span class="op" id="5395339">.</span><span class="ident" id="5395340">NumberOfSections</span><span class="op" id="5395356">)</span><span class="op" id="5395357">;</span>&nbsp;<span class="ident" id="5395359">i</span><span class="op" id="5395360">++</span>&nbsp;<span class="op" id="5395363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395367">sh</span>&nbsp;<span class="op" id="5395370">:=</span>&nbsp;<span class="builtinfunc" id="5395373">new</span><span class="op" id="5395376">(</span><span class="ident" id="5395377">SectionHeader32</span><span class="op" id="5395392">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395396">if</span>&nbsp;<span class="ident" id="5395399">err</span>&nbsp;<span class="op" id="5395403">:=</span>&nbsp;<span class="ident" id="5395406">binary</span><span class="op" id="5395412">.</span><span class="ident" id="5395413">Read</span><span class="op" id="5395417">(</span><span class="ident" id="5395418">sr</span><span class="op" id="5395420">,</span>&nbsp;<span class="ident" id="5395422">binary</span><span class="op" id="5395428">.</span><span class="ident" id="5395429">LittleEndian</span><span class="op" id="5395441">,</span>&nbsp;<span class="ident" id="5395443">sh</span><span class="op" id="5395445">)</span><span class="op" id="5395446">;</span>&nbsp;<span class="ident" id="5395448">err</span>&nbsp;<span class="op" id="5395452">!=</span>&nbsp;<span class="ident" id="5395455">nil</span>&nbsp;<span class="op" id="5395459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395464">return</span>&nbsp;<span class="ident" id="5395471">nil</span><span class="op" id="5395474">,</span>&nbsp;<span class="ident" id="5395476">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395486">var</span>&nbsp;<span class="ident" id="5395490">name</span>&nbsp;<span class="builtintype" id="5395495">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395504">if</span>&nbsp;<span class="ident" id="5395507">sh</span><span class="op" id="5395509">.</span><span class="ident" id="5395510">Name</span><span class="op" id="5395514">[</span><span class="num" id="5395515">0</span><span class="op" id="5395516">]</span>&nbsp;<span class="op" id="5395518">==</span>&nbsp;<span class="string" id="5395521">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5395528">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395533">si</span><span class="op" id="5395535">,</span>&nbsp;<span class="ident" id="5395537">_</span>&nbsp;<span class="op" id="5395539">:=</span>&nbsp;<span class="ident" id="5395542">strconv</span><span class="op" id="5395549">.</span><span class="ident" id="5395550">Atoi</span><span class="op" id="5395554">(</span><span class="ident" id="5395555">cstring</span><span class="op" id="5395562">(</span><span class="ident" id="5395563">sh</span><span class="op" id="5395565">.</span><span class="ident" id="5395566">Name</span><span class="op" id="5395570">[</span><span class="num" id="5395571">1</span><span class="op" id="5395572">:</span><span class="op" id="5395573">]</span><span class="op" id="5395574">)</span><span class="op" id="5395575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395580">name</span><span class="op" id="5395584">,</span>&nbsp;<span class="ident" id="5395586">_</span>&nbsp;<span class="op" id="5395588">=</span>&nbsp;<span class="ident" id="5395590">getString</span><span class="op" id="5395599">(</span><span class="ident" id="5395600">ss</span><span class="op" id="5395602">,</span>&nbsp;<span class="ident" id="5395604">si</span><span class="op" id="5395606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395610">}</span>&nbsp;<span class="keyword" id="5395612">else</span>&nbsp;<span class="op" id="5395617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395622">name</span>&nbsp;<span class="op" id="5395627">=</span>&nbsp;<span class="ident" id="5395629">cstring</span><span class="op" id="5395636">(</span><span class="ident" id="5395637">sh</span><span class="op" id="5395639">.</span><span class="ident" id="5395640">Name</span><span class="op" id="5395644">[</span><span class="num" id="5395645">0</span><span class="op" id="5395646">:</span><span class="op" id="5395647">]</span><span class="op" id="5395648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395652">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395656">s</span>&nbsp;<span class="op" id="5395658">:=</span>&nbsp;<span class="builtinfunc" id="5395661">new</span><span class="op" id="5395664">(</span><span class="ident" id="5395665">Section</span><span class="op" id="5395672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395676">s</span><span class="op" id="5395677">.</span><span class="ident" id="5395678">SectionHeader</span>&nbsp;<span class="op" id="5395692">=</span>&nbsp;<span class="ident" id="5395694">SectionHeader</span><span class="op" id="5395707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395712">Name</span><span class="op" id="5395716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395734">name</span><span class="op" id="5395738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395743">VirtualSize</span><span class="op" id="5395754">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395765">sh</span><span class="op" id="5395767">.</span><span class="ident" id="5395768">VirtualSize</span><span class="op" id="5395779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395784">VirtualAddress</span><span class="op" id="5395798">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395806">sh</span><span class="op" id="5395808">.</span><span class="ident" id="5395809">VirtualAddress</span><span class="op" id="5395823">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395828">Size</span><span class="op" id="5395832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395850">sh</span><span class="op" id="5395852">.</span><span class="ident" id="5395853">SizeOfRawData</span><span class="op" id="5395866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395871">Offset</span><span class="op" id="5395877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395893">sh</span><span class="op" id="5395895">.</span><span class="ident" id="5395896">PointerToRawData</span><span class="op" id="5395912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395917">PointerToRelocations</span><span class="op" id="5395937">:</span>&nbsp;<span class="ident" id="5395939">sh</span><span class="op" id="5395941">.</span><span class="ident" id="5395942">PointerToRelocations</span><span class="op" id="5395962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395967">PointerToLineNumbers</span><span class="op" id="5395987">:</span>&nbsp;<span class="ident" id="5395989">sh</span><span class="op" id="5395991">.</span><span class="ident" id="5395992">PointerToLineNumbers</span><span class="op" id="5396012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396017">NumberOfRelocations</span><span class="op" id="5396036">:</span>&nbsp;&nbsp;<span class="ident" id="5396039">sh</span><span class="op" id="5396041">.</span><span class="ident" id="5396042">NumberOfRelocations</span><span class="op" id="5396061">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396066">NumberOfLineNumbers</span><span class="op" id="5396085">:</span>&nbsp;&nbsp;<span class="ident" id="5396088">sh</span><span class="op" id="5396090">.</span><span class="ident" id="5396091">NumberOfLineNumbers</span><span class="op" id="5396110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396115">Characteristics</span><span class="op" id="5396130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396137">sh</span><span class="op" id="5396139">.</span><span class="ident" id="5396140">Characteristics</span><span class="op" id="5396155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396163">s</span><span class="op" id="5396164">.</span><span class="ident" id="5396165">sr</span>&nbsp;<span class="op" id="5396168">=</span>&nbsp;<span class="ident" id="5396170">io</span><span class="op" id="5396172">.</span><span class="ident" id="5396173">NewSectionReader</span><span class="op" id="5396189">(</span><span class="ident" id="5396190">r</span><span class="op" id="5396191">,</span>&nbsp;<span class="ident" id="5396193">int64</span><span class="op" id="5396198">(</span><span class="ident" id="5396199">s</span><span class="op" id="5396200">.</span><span class="ident" id="5396201">SectionHeader</span><span class="op" id="5396214">.</span><span class="ident" id="5396215">Offset</span><span class="op" id="5396221">)</span><span class="op" id="5396222">,</span>&nbsp;<span class="ident" id="5396224">int64</span><span class="op" id="5396229">(</span><span class="ident" id="5396230">s</span><span class="op" id="5396231">.</span><span class="ident" id="5396232">SectionHeader</span><span class="op" id="5396245">.</span><span class="ident" id="5396246">Size</span><span class="op" id="5396250">)</span><span class="op" id="5396251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396255">s</span><span class="op" id="5396256">.</span><span class="ident" id="5396257">ReaderAt</span>&nbsp;<span class="op" id="5396266">=</span>&nbsp;<span class="ident" id="5396268">s</span><span class="op" id="5396269">.</span><span class="ident" id="5396270">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396275">f</span><span class="op" id="5396276">.</span><span class="ident" id="5396277">Sections</span><span class="op" id="5396285">[</span><span class="ident" id="5396286">i</span><span class="op" id="5396287">]</span>&nbsp;<span class="op" id="5396289">=</span>&nbsp;<span class="ident" id="5396291">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396297">return</span>&nbsp;<span class="ident" id="5396304">f</span><span class="op" id="5396305">,</span>&nbsp;<span class="ident" id="5396307">nil</span><br>
<span class="lineno"></span><span class="op" id="5396311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5396314">func</span>&nbsp;<span class="ident" id="5396319">cstring</span><span class="op" id="5396326">(</span><span class="ident" id="5396327">b</span>&nbsp;<span class="op" id="5396329">[</span><span class="op" id="5396330">]</span><span class="builtintype" id="5396331">byte</span><span class="op" id="5396335">)</span>&nbsp;<span class="builtintype" id="5396337">string</span>&nbsp;<span class="op" id="5396344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396347">var</span>&nbsp;<span class="ident" id="5396351">i</span>&nbsp;<span class="builtintype" id="5396353">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396358">for</span>&nbsp;<span class="ident" id="5396362">i</span>&nbsp;<span class="op" id="5396364">=</span>&nbsp;<span class="num" id="5396366">0</span><span class="op" id="5396367">;</span>&nbsp;<span class="ident" id="5396369">i</span>&nbsp;<span class="op" id="5396371">&lt;</span>&nbsp;<span class="builtinfunc" id="5396373">len</span><span class="op" id="5396376">(</span><span class="ident" id="5396377">b</span><span class="op" id="5396378">)</span>&nbsp;<span class="op" id="5396380">&amp;&amp;</span>&nbsp;<span class="ident" id="5396383">b</span><span class="op" id="5396384">[</span><span class="ident" id="5396385">i</span><span class="op" id="5396386">]</span>&nbsp;<span class="op" id="5396388">!=</span>&nbsp;<span class="num" id="5396391">0</span><span class="op" id="5396392">;</span>&nbsp;<span class="ident" id="5396394">i</span><span class="op" id="5396395">++</span>&nbsp;<span class="op" id="5396398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396404">return</span>&nbsp;<span class="builtintype" id="5396411">string</span><span class="op" id="5396417">(</span><span class="ident" id="5396418">b</span><span class="op" id="5396419">[</span><span class="num" id="5396420">0</span><span class="op" id="5396421">:</span><span class="ident" id="5396422">i</span><span class="op" id="5396423">]</span><span class="op" id="5396424">)</span><br>
<span class="lineno">270</span><span class="op" id="5396426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396429">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5396486">func</span>&nbsp;<span class="ident" id="5396491">getString</span><span class="op" id="5396500">(</span><span class="ident" id="5396501">section</span>&nbsp;<span class="op" id="5396509">[</span><span class="op" id="5396510">]</span><span class="builtintype" id="5396511">byte</span><span class="op" id="5396515">,</span>&nbsp;<span class="ident" id="5396517">start</span>&nbsp;<span class="builtintype" id="5396523">int</span><span class="op" id="5396526">)</span>&nbsp;<span class="op" id="5396528">(</span><span class="builtintype" id="5396529">string</span><span class="op" id="5396535">,</span>&nbsp;<span class="builtintype" id="5396537">bool</span><span class="op" id="5396541">)</span>&nbsp;<span class="op" id="5396543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396546">if</span>&nbsp;<span class="ident" id="5396549">start</span>&nbsp;<span class="op" id="5396555">&lt;</span>&nbsp;<span class="num" id="5396557">0</span>&nbsp;<span class="op" id="5396559">||</span>&nbsp;<span class="ident" id="5396562">start</span>&nbsp;<span class="op" id="5396568">&gt;=</span>&nbsp;<span class="builtinfunc" id="5396571">len</span><span class="op" id="5396574">(</span><span class="ident" id="5396575">section</span><span class="op" id="5396582">)</span>&nbsp;<span class="op" id="5396584">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396588">return</span>&nbsp;<span class="string" id="5396595">&#34;&#34;</span><span class="op" id="5396597">,</span>&nbsp;<span class="builtintype" id="5396599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396610">for</span>&nbsp;<span class="ident" id="5396614">end</span>&nbsp;<span class="op" id="5396618">:=</span>&nbsp;<span class="ident" id="5396621">start</span><span class="op" id="5396626">;</span>&nbsp;<span class="ident" id="5396628">end</span>&nbsp;<span class="op" id="5396632">&lt;</span>&nbsp;<span class="builtinfunc" id="5396634">len</span><span class="op" id="5396637">(</span><span class="ident" id="5396638">section</span><span class="op" id="5396645">)</span><span class="op" id="5396646">;</span>&nbsp;<span class="ident" id="5396648">end</span><span class="op" id="5396651">++</span>&nbsp;<span class="op" id="5396654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396658">if</span>&nbsp;<span class="ident" id="5396661">section</span><span class="op" id="5396668">[</span><span class="ident" id="5396669">end</span><span class="op" id="5396672">]</span>&nbsp;<span class="op" id="5396674">==</span>&nbsp;<span class="num" id="5396677">0</span>&nbsp;<span class="op" id="5396679">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396684">return</span>&nbsp;<span class="builtintype" id="5396691">string</span><span class="op" id="5396697">(</span><span class="ident" id="5396698">section</span><span class="op" id="5396705">[</span><span class="ident" id="5396706">start</span><span class="op" id="5396711">:</span><span class="ident" id="5396712">end</span><span class="op" id="5396715">]</span><span class="op" id="5396716">)</span><span class="op" id="5396717">,</span>&nbsp;<span class="builtintype" id="5396719">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396732">return</span>&nbsp;<span class="string" id="5396739">&#34;&#34;</span><span class="op" id="5396741">,</span>&nbsp;<span class="builtintype" id="5396743">false</span><br>
<span class="lineno"></span><span class="op" id="5396749">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5396752">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5396828">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5396847">func</span>&nbsp;<span class="op" id="5396852">(</span><span class="ident" id="5396853">f</span>&nbsp;<span class="op" id="5396855">*</span><span class="ident" id="5396856">File</span><span class="op" id="5396860">)</span>&nbsp;<span class="ident" id="5396862">Section</span><span class="op" id="5396869">(</span><span class="ident" id="5396870">name</span>&nbsp;<span class="builtintype" id="5396875">string</span><span class="op" id="5396881">)</span>&nbsp;<span class="op" id="5396883">*</span><span class="ident" id="5396884">Section</span>&nbsp;<span class="op" id="5396892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396895">for</span>&nbsp;<span class="ident" id="5396899">_</span><span class="op" id="5396900">,</span>&nbsp;<span class="ident" id="5396902">s</span>&nbsp;<span class="op" id="5396904">:=</span>&nbsp;<span class="keyword" id="5396907">range</span>&nbsp;<span class="ident" id="5396913">f</span><span class="op" id="5396914">.</span><span class="ident" id="5396915">Sections</span>&nbsp;<span class="op" id="5396924">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396928">if</span>&nbsp;<span class="ident" id="5396931">s</span><span class="op" id="5396932">.</span><span class="ident" id="5396933">Name</span>&nbsp;<span class="op" id="5396938">==</span>&nbsp;<span class="ident" id="5396941">name</span>&nbsp;<span class="op" id="5396946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396951">return</span>&nbsp;<span class="ident" id="5396958">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396968">return</span>&nbsp;<span class="ident" id="5396975">nil</span><br>
<span class="lineno">295</span><span class="op" id="5396979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5396982">func</span>&nbsp;<span class="op" id="5396987">(</span><span class="ident" id="5396988">f</span>&nbsp;<span class="op" id="5396990">*</span><span class="ident" id="5396991">File</span><span class="op" id="5396995">)</span>&nbsp;<span class="ident" id="5396997">DWARF</span><span class="op" id="5397002">(</span><span class="op" id="5397003">)</span>&nbsp;<span class="op" id="5397005">(</span><span class="op" id="5397006">*</span><span class="ident" id="5397007">dwarf</span><span class="op" id="5397012">.</span><span class="ident" id="5397013">Data</span><span class="op" id="5397017">,</span>&nbsp;<span class="builtintype" id="5397019">error</span><span class="op" id="5397024">)</span>&nbsp;<span class="op" id="5397026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5397029">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5397080">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5397135">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397194">var</span>&nbsp;<span class="ident" id="5397198">names</span>&nbsp;<span class="op" id="5397204">=</span>&nbsp;<span class="op" id="5397206">[</span><span class="op" id="5397207">...</span><span class="op" id="5397210">]</span><span class="builtintype" id="5397211">string</span><span class="op" id="5397217">{</span><span class="string" id="5397218">&#34;abbrev&#34;</span><span class="op" id="5397226">,</span>&nbsp;<span class="string" id="5397228">&#34;info&#34;</span><span class="op" id="5397234">,</span>&nbsp;<span class="string" id="5397236">&#34;str&#34;</span><span class="op" id="5397241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397244">var</span>&nbsp;<span class="ident" id="5397248">dat</span>&nbsp;<span class="op" id="5397252">[</span><span class="builtinfunc" id="5397253">len</span><span class="op" id="5397256">(</span><span class="ident" id="5397257">names</span><span class="op" id="5397262">)</span><span class="op" id="5397263">]</span><span class="op" id="5397264">[</span><span class="op" id="5397265">]</span><span class="builtintype" id="5397266">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397272">for</span>&nbsp;<span class="ident" id="5397276">i</span><span class="op" id="5397277">,</span>&nbsp;<span class="ident" id="5397279">name</span>&nbsp;<span class="op" id="5397284">:=</span>&nbsp;<span class="keyword" id="5397287">range</span>&nbsp;<span class="ident" id="5397293">names</span>&nbsp;<span class="op" id="5397299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397303">name</span>&nbsp;<span class="op" id="5397308">=</span>&nbsp;<span class="string" id="5397310">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5397320">+</span>&nbsp;<span class="ident" id="5397322">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397329">s</span>&nbsp;<span class="op" id="5397331">:=</span>&nbsp;<span class="ident" id="5397334">f</span><span class="op" id="5397335">.</span><span class="ident" id="5397336">Section</span><span class="op" id="5397343">(</span><span class="ident" id="5397344">name</span><span class="op" id="5397348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397352">if</span>&nbsp;<span class="ident" id="5397355">s</span>&nbsp;<span class="op" id="5397357">==</span>&nbsp;<span class="ident" id="5397360">nil</span>&nbsp;<span class="op" id="5397364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397369">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397384">b</span><span class="op" id="5397385">,</span>&nbsp;<span class="ident" id="5397387">err</span>&nbsp;<span class="op" id="5397391">:=</span>&nbsp;<span class="ident" id="5397394">s</span><span class="op" id="5397395">.</span><span class="ident" id="5397396">Data</span><span class="op" id="5397400">(</span><span class="op" id="5397401">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397405">if</span>&nbsp;<span class="ident" id="5397408">err</span>&nbsp;<span class="op" id="5397412">!=</span>&nbsp;<span class="ident" id="5397415">nil</span>&nbsp;<span class="op" id="5397419">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5397422">uint32</span><span class="op" id="5397428">(</span><span class="builtinfunc" id="5397429">len</span><span class="op" id="5397432">(</span><span class="ident" id="5397433">b</span><span class="op" id="5397434">)</span><span class="op" id="5397435">)</span>&nbsp;<span class="op" id="5397437">&lt;</span>&nbsp;<span class="ident" id="5397439">s</span><span class="op" id="5397440">.</span><span class="ident" id="5397441">Size</span>&nbsp;<span class="op" id="5397446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397451">return</span>&nbsp;<span class="ident" id="5397458">nil</span><span class="op" id="5397461">,</span>&nbsp;<span class="ident" id="5397463">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397473">dat</span><span class="op" id="5397476">[</span><span class="ident" id="5397477">i</span><span class="op" id="5397478">]</span>&nbsp;<span class="op" id="5397480">=</span>&nbsp;<span class="ident" id="5397482">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397485">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397489">abbrev</span><span class="op" id="5397495">,</span>&nbsp;<span class="ident" id="5397497">info</span><span class="op" id="5397501">,</span>&nbsp;<span class="ident" id="5397503">str</span>&nbsp;<span class="op" id="5397507">:=</span>&nbsp;<span class="ident" id="5397510">dat</span><span class="op" id="5397513">[</span><span class="num" id="5397514">0</span><span class="op" id="5397515">]</span><span class="op" id="5397516">,</span>&nbsp;<span class="ident" id="5397518">dat</span><span class="op" id="5397521">[</span><span class="num" id="5397522">1</span><span class="op" id="5397523">]</span><span class="op" id="5397524">,</span>&nbsp;<span class="ident" id="5397526">dat</span><span class="op" id="5397529">[</span><span class="num" id="5397530">2</span><span class="op" id="5397531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397534">return</span>&nbsp;<span class="ident" id="5397541">dwarf</span><span class="op" id="5397546">.</span><span class="ident" id="5397547">New</span><span class="op" id="5397550">(</span><span class="ident" id="5397551">abbrev</span><span class="op" id="5397557">,</span>&nbsp;<span class="ident" id="5397559">nil</span><span class="op" id="5397562">,</span>&nbsp;<span class="ident" id="5397564">nil</span><span class="op" id="5397567">,</span>&nbsp;<span class="ident" id="5397569">info</span><span class="op" id="5397573">,</span>&nbsp;<span class="ident" id="5397575">nil</span><span class="op" id="5397578">,</span>&nbsp;<span class="ident" id="5397580">nil</span><span class="op" id="5397583">,</span>&nbsp;<span class="ident" id="5397585">nil</span><span class="op" id="5397588">,</span>&nbsp;<span class="ident" id="5397590">str</span><span class="op" id="5397593">)</span><br>
<span class="lineno"></span><span class="op" id="5397595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5397598">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5397650">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5397705">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5397759">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5397795">func</span>&nbsp;<span class="op" id="5397800">(</span><span class="ident" id="5397801">f</span>&nbsp;<span class="op" id="5397803">*</span><span class="ident" id="5397804">File</span><span class="op" id="5397808">)</span>&nbsp;<span class="ident" id="5397810">ImportedSymbols</span><span class="op" id="5397825">(</span><span class="op" id="5397826">)</span>&nbsp;<span class="op" id="5397828">(</span><span class="op" id="5397829">[</span><span class="op" id="5397830">]</span><span class="builtintype" id="5397831">string</span><span class="op" id="5397837">,</span>&nbsp;<span class="builtintype" id="5397839">error</span><span class="op" id="5397844">)</span>&nbsp;<span class="op" id="5397846">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397849">pe64</span>&nbsp;<span class="op" id="5397854">:=</span>&nbsp;<span class="ident" id="5397857">f</span><span class="op" id="5397858">.</span><span class="ident" id="5397859">Machine</span>&nbsp;<span class="op" id="5397867">==</span>&nbsp;<span class="ident" id="5397870">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397896">ds</span>&nbsp;<span class="op" id="5397899">:=</span>&nbsp;<span class="ident" id="5397902">f</span><span class="op" id="5397903">.</span><span class="ident" id="5397904">Section</span><span class="op" id="5397911">(</span><span class="string" id="5397912">&#34;.idata&#34;</span><span class="op" id="5397920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397923">if</span>&nbsp;<span class="ident" id="5397926">ds</span>&nbsp;<span class="op" id="5397929">==</span>&nbsp;<span class="ident" id="5397932">nil</span>&nbsp;<span class="op" id="5397936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5397940">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397974">return</span>&nbsp;<span class="ident" id="5397981">nil</span><span class="op" id="5397984">,</span>&nbsp;<span class="ident" id="5397986">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397994">d</span><span class="op" id="5397995">,</span>&nbsp;<span class="ident" id="5397997">err</span>&nbsp;<span class="op" id="5398001">:=</span>&nbsp;<span class="ident" id="5398004">ds</span><span class="op" id="5398006">.</span><span class="ident" id="5398007">Data</span><span class="op" id="5398011">(</span><span class="op" id="5398012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398015">if</span>&nbsp;<span class="ident" id="5398018">err</span>&nbsp;<span class="op" id="5398022">!=</span>&nbsp;<span class="ident" id="5398025">nil</span>&nbsp;<span class="op" id="5398029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398033">return</span>&nbsp;<span class="ident" id="5398040">nil</span><span class="op" id="5398043">,</span>&nbsp;<span class="ident" id="5398045">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398050">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398053">var</span>&nbsp;<span class="ident" id="5398057">ida</span>&nbsp;<span class="op" id="5398061">[</span><span class="op" id="5398062">]</span><span class="ident" id="5398063">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398080">for</span>&nbsp;<span class="builtinfunc" id="5398084">len</span><span class="op" id="5398087">(</span><span class="ident" id="5398088">d</span><span class="op" id="5398089">)</span>&nbsp;<span class="op" id="5398091">&gt;</span>&nbsp;<span class="num" id="5398093">0</span>&nbsp;<span class="op" id="5398095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398099">var</span>&nbsp;<span class="ident" id="5398103">dt</span>&nbsp;<span class="ident" id="5398106">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398124">dt</span><span class="op" id="5398126">.</span><span class="ident" id="5398127">OriginalFirstThunk</span>&nbsp;<span class="op" id="5398146">=</span>&nbsp;<span class="ident" id="5398148">binary</span><span class="op" id="5398154">.</span><span class="ident" id="5398155">LittleEndian</span><span class="op" id="5398167">.</span><span class="ident" id="5398168">Uint32</span><span class="op" id="5398174">(</span><span class="ident" id="5398175">d</span><span class="op" id="5398176">[</span><span class="num" id="5398177">0</span><span class="op" id="5398178">:</span><span class="num" id="5398179">4</span><span class="op" id="5398180">]</span><span class="op" id="5398181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398185">dt</span><span class="op" id="5398187">.</span><span class="ident" id="5398188">Name</span>&nbsp;<span class="op" id="5398193">=</span>&nbsp;<span class="ident" id="5398195">binary</span><span class="op" id="5398201">.</span><span class="ident" id="5398202">LittleEndian</span><span class="op" id="5398214">.</span><span class="ident" id="5398215">Uint32</span><span class="op" id="5398221">(</span><span class="ident" id="5398222">d</span><span class="op" id="5398223">[</span><span class="num" id="5398224">12</span><span class="op" id="5398226">:</span><span class="num" id="5398227">16</span><span class="op" id="5398229">]</span><span class="op" id="5398230">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398234">dt</span><span class="op" id="5398236">.</span><span class="ident" id="5398237">FirstThunk</span>&nbsp;<span class="op" id="5398248">=</span>&nbsp;<span class="ident" id="5398250">binary</span><span class="op" id="5398256">.</span><span class="ident" id="5398257">LittleEndian</span><span class="op" id="5398269">.</span><span class="ident" id="5398270">Uint32</span><span class="op" id="5398276">(</span><span class="ident" id="5398277">d</span><span class="op" id="5398278">[</span><span class="num" id="5398279">16</span><span class="op" id="5398281">:</span><span class="num" id="5398282">20</span><span class="op" id="5398284">]</span><span class="op" id="5398285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398289">d</span>&nbsp;<span class="op" id="5398291">=</span>&nbsp;<span class="ident" id="5398293">d</span><span class="op" id="5398294">[</span><span class="num" id="5398295">20</span><span class="op" id="5398297">:</span><span class="op" id="5398298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398302">if</span>&nbsp;<span class="ident" id="5398305">dt</span><span class="op" id="5398307">.</span><span class="ident" id="5398308">OriginalFirstThunk</span>&nbsp;<span class="op" id="5398327">==</span>&nbsp;<span class="num" id="5398330">0</span>&nbsp;<span class="op" id="5398332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398337">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398345">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398349">ida</span>&nbsp;<span class="op" id="5398353">=</span>&nbsp;<span class="builtinfunc" id="5398355">append</span><span class="op" id="5398361">(</span><span class="ident" id="5398362">ida</span><span class="op" id="5398365">,</span>&nbsp;<span class="ident" id="5398367">dt</span><span class="op" id="5398369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398375">names</span><span class="op" id="5398380">,</span>&nbsp;<span class="ident" id="5398382">_</span>&nbsp;<span class="op" id="5398384">:=</span>&nbsp;<span class="ident" id="5398387">ds</span><span class="op" id="5398389">.</span><span class="ident" id="5398390">Data</span><span class="op" id="5398394">(</span><span class="op" id="5398395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398398">var</span>&nbsp;<span class="ident" id="5398402">all</span>&nbsp;<span class="op" id="5398406">[</span><span class="op" id="5398407">]</span><span class="builtintype" id="5398408">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398416">for</span>&nbsp;<span class="ident" id="5398420">_</span><span class="op" id="5398421">,</span>&nbsp;<span class="ident" id="5398423">dt</span>&nbsp;<span class="op" id="5398426">:=</span>&nbsp;<span class="keyword" id="5398429">range</span>&nbsp;<span class="ident" id="5398435">ida</span>&nbsp;<span class="op" id="5398439">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398443">dt</span><span class="op" id="5398445">.</span><span class="ident" id="5398446">dll</span><span class="op" id="5398449">,</span>&nbsp;<span class="ident" id="5398451">_</span>&nbsp;<span class="op" id="5398453">=</span>&nbsp;<span class="ident" id="5398455">getString</span><span class="op" id="5398464">(</span><span class="ident" id="5398465">names</span><span class="op" id="5398470">,</span>&nbsp;<span class="builtintype" id="5398472">int</span><span class="op" id="5398475">(</span><span class="ident" id="5398476">dt</span><span class="op" id="5398478">.</span><span class="ident" id="5398479">Name</span><span class="op" id="5398483">-</span><span class="ident" id="5398484">ds</span><span class="op" id="5398486">.</span><span class="ident" id="5398487">VirtualAddress</span><span class="op" id="5398501">)</span><span class="op" id="5398502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398506">d</span><span class="op" id="5398507">,</span>&nbsp;<span class="ident" id="5398509">_</span>&nbsp;<span class="op" id="5398511">=</span>&nbsp;<span class="ident" id="5398513">ds</span><span class="op" id="5398515">.</span><span class="ident" id="5398516">Data</span><span class="op" id="5398520">(</span><span class="op" id="5398521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5398525">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398557">d</span>&nbsp;<span class="op" id="5398559">=</span>&nbsp;<span class="ident" id="5398561">d</span><span class="op" id="5398562">[</span><span class="ident" id="5398563">dt</span><span class="op" id="5398565">.</span><span class="ident" id="5398566">OriginalFirstThunk</span><span class="op" id="5398584">-</span><span class="ident" id="5398585">ds</span><span class="op" id="5398587">.</span><span class="ident" id="5398588">VirtualAddress</span><span class="op" id="5398602">:</span><span class="op" id="5398603">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398607">for</span>&nbsp;<span class="builtinfunc" id="5398611">len</span><span class="op" id="5398614">(</span><span class="ident" id="5398615">d</span><span class="op" id="5398616">)</span>&nbsp;<span class="op" id="5398618">&gt;</span>&nbsp;<span class="num" id="5398620">0</span>&nbsp;<span class="op" id="5398622">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398627">if</span>&nbsp;<span class="ident" id="5398630">pe64</span>&nbsp;<span class="op" id="5398635">{</span>&nbsp;<span class="comment" id="5398637">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398650">va</span>&nbsp;<span class="op" id="5398653">:=</span>&nbsp;<span class="ident" id="5398656">binary</span><span class="op" id="5398662">.</span><span class="ident" id="5398663">LittleEndian</span><span class="op" id="5398675">.</span><span class="ident" id="5398676">Uint64</span><span class="op" id="5398682">(</span><span class="ident" id="5398683">d</span><span class="op" id="5398684">[</span><span class="num" id="5398685">0</span><span class="op" id="5398686">:</span><span class="num" id="5398687">8</span><span class="op" id="5398688">]</span><span class="op" id="5398689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398695">d</span>&nbsp;<span class="op" id="5398697">=</span>&nbsp;<span class="ident" id="5398699">d</span><span class="op" id="5398700">[</span><span class="num" id="5398701">8</span><span class="op" id="5398702">:</span><span class="op" id="5398703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398709">if</span>&nbsp;<span class="ident" id="5398712">va</span>&nbsp;<span class="op" id="5398715">==</span>&nbsp;<span class="num" id="5398718">0</span>&nbsp;<span class="op" id="5398720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398727">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398743">if</span>&nbsp;<span class="ident" id="5398746">va</span><span class="op" id="5398748">&amp;</span><span class="num" id="5398749">0x8000000000000000</span>&nbsp;<span class="op" id="5398768">&gt;</span>&nbsp;<span class="num" id="5398770">0</span>&nbsp;<span class="op" id="5398772">{</span>&nbsp;<span class="comment" id="5398774">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5398793">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398836">}</span>&nbsp;<span class="keyword" id="5398838">else</span>&nbsp;<span class="op" id="5398843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398850">fn</span><span class="op" id="5398852">,</span>&nbsp;<span class="ident" id="5398854">_</span>&nbsp;<span class="op" id="5398856">:=</span>&nbsp;<span class="ident" id="5398859">getString</span><span class="op" id="5398868">(</span><span class="ident" id="5398869">names</span><span class="op" id="5398874">,</span>&nbsp;<span class="builtintype" id="5398876">int</span><span class="op" id="5398879">(</span><span class="builtintype" id="5398880">uint32</span><span class="op" id="5398886">(</span><span class="ident" id="5398887">va</span><span class="op" id="5398889">)</span><span class="op" id="5398890">-</span><span class="ident" id="5398891">ds</span><span class="op" id="5398893">.</span><span class="ident" id="5398894">VirtualAddress</span><span class="op" id="5398908">+</span><span class="num" id="5398909">2</span><span class="op" id="5398910">)</span><span class="op" id="5398911">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398918">all</span>&nbsp;<span class="op" id="5398922">=</span>&nbsp;<span class="builtinfunc" id="5398924">append</span><span class="op" id="5398930">(</span><span class="ident" id="5398931">all</span><span class="op" id="5398934">,</span>&nbsp;<span class="ident" id="5398936">fn</span><span class="op" id="5398938">+</span><span class="string" id="5398939">&#34;:&#34;</span><span class="op" id="5398942">+</span><span class="ident" id="5398943">dt</span><span class="op" id="5398945">.</span><span class="ident" id="5398946">dll</span><span class="op" id="5398949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398960">}</span>&nbsp;<span class="keyword" id="5398962">else</span>&nbsp;<span class="op" id="5398967">{</span>&nbsp;<span class="comment" id="5398969">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398982">va</span>&nbsp;<span class="op" id="5398985">:=</span>&nbsp;<span class="ident" id="5398988">binary</span><span class="op" id="5398994">.</span><span class="ident" id="5398995">LittleEndian</span><span class="op" id="5399007">.</span><span class="ident" id="5399008">Uint32</span><span class="op" id="5399014">(</span><span class="ident" id="5399015">d</span><span class="op" id="5399016">[</span><span class="num" id="5399017">0</span><span class="op" id="5399018">:</span><span class="num" id="5399019">4</span><span class="op" id="5399020">]</span><span class="op" id="5399021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399027">d</span>&nbsp;<span class="op" id="5399029">=</span>&nbsp;<span class="ident" id="5399031">d</span><span class="op" id="5399032">[</span><span class="num" id="5399033">4</span><span class="op" id="5399034">:</span><span class="op" id="5399035">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399041">if</span>&nbsp;<span class="ident" id="5399044">va</span>&nbsp;<span class="op" id="5399047">==</span>&nbsp;<span class="num" id="5399050">0</span>&nbsp;<span class="op" id="5399052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399059">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399075">if</span>&nbsp;<span class="ident" id="5399078">va</span><span class="op" id="5399080">&amp;</span><span class="num" id="5399081">0x80000000</span>&nbsp;<span class="op" id="5399092">&gt;</span>&nbsp;<span class="num" id="5399094">0</span>&nbsp;<span class="op" id="5399096">{</span>&nbsp;<span class="comment" id="5399098">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5399117">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5399161">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399188">}</span>&nbsp;<span class="keyword" id="5399190">else</span>&nbsp;<span class="op" id="5399195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399202">fn</span><span class="op" id="5399204">,</span>&nbsp;<span class="ident" id="5399206">_</span>&nbsp;<span class="op" id="5399208">:=</span>&nbsp;<span class="ident" id="5399211">getString</span><span class="op" id="5399220">(</span><span class="ident" id="5399221">names</span><span class="op" id="5399226">,</span>&nbsp;<span class="builtintype" id="5399228">int</span><span class="op" id="5399231">(</span><span class="ident" id="5399232">va</span><span class="op" id="5399234">-</span><span class="ident" id="5399235">ds</span><span class="op" id="5399237">.</span><span class="ident" id="5399238">VirtualAddress</span><span class="op" id="5399252">+</span><span class="num" id="5399253">2</span><span class="op" id="5399254">)</span><span class="op" id="5399255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399262">all</span>&nbsp;<span class="op" id="5399266">=</span>&nbsp;<span class="builtinfunc" id="5399268">append</span><span class="op" id="5399274">(</span><span class="ident" id="5399275">all</span><span class="op" id="5399278">,</span>&nbsp;<span class="ident" id="5399280">fn</span><span class="op" id="5399282">+</span><span class="string" id="5399283">&#34;:&#34;</span><span class="op" id="5399286">+</span><span class="ident" id="5399287">dt</span><span class="op" id="5399289">.</span><span class="ident" id="5399290">dll</span><span class="op" id="5399293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399299">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399315">return</span>&nbsp;<span class="ident" id="5399322">all</span><span class="op" id="5399325">,</span>&nbsp;<span class="ident" id="5399327">nil</span><br>
<span class="lineno">385</span><span class="op" id="5399331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399334">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5399390">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5399445">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5399493">func</span>&nbsp;<span class="op" id="5399498">(</span><span class="ident" id="5399499">f</span>&nbsp;<span class="op" id="5399501">*</span><span class="ident" id="5399502">File</span><span class="op" id="5399506">)</span>&nbsp;<span class="ident" id="5399508">ImportedLibraries</span><span class="op" id="5399525">(</span><span class="op" id="5399526">)</span>&nbsp;<span class="op" id="5399528">(</span><span class="op" id="5399529">[</span><span class="op" id="5399530">]</span><span class="builtintype" id="5399531">string</span><span class="op" id="5399537">,</span>&nbsp;<span class="builtintype" id="5399539">error</span><span class="op" id="5399544">)</span>&nbsp;<span class="op" id="5399546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5399549">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5399558">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399624">return</span>&nbsp;<span class="ident" id="5399631">nil</span><span class="op" id="5399634">,</span>&nbsp;<span class="ident" id="5399636">nil</span><br>
<span class="lineno"></span><span class="op" id="5399640">}</span>
</div>
</body>
</html>
