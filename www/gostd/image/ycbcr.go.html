<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image</h2>
<ul>
<li><a href="/gostd/image/decode_example_test.go.html">decode_example_test.go</a></li>
<li><a href="/gostd/image/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/image/format.go.html">format.go</a></li>
<li><a href="/gostd/image/geom.go.html">geom.go</a></li>
<li><a href="/gostd/image/image.go.html">image.go</a></li>
<li><a href="/gostd/image/image_test.go.html">image_test.go</a></li>
<li><a href="/gostd/image/names.go.html">names.go</a></li>
<li><a href="/gostd/image/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4976756">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4976811">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4976865">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4976916">package</span>&nbsp;<span class="ident" id="4976924">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4976931">import</span>&nbsp;<span class="op" id="4976938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4976941">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="4976955">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4976958">//&nbsp;YCbCrSubsampleRatio&nbsp;is&nbsp;the&nbsp;chroma&nbsp;subsample&nbsp;ratio&nbsp;used&nbsp;in&nbsp;a&nbsp;YCbCr&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4977034">type</span>&nbsp;<span class="ident" id="4977039">YCbCrSubsampleRatio</span>&nbsp;<span class="builtintype" id="4977059">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4977064">const</span>&nbsp;<span class="op" id="4977070">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4977073">YCbCrSubsampleRatio444</span>&nbsp;<span class="ident" id="4977096">YCbCrSubsampleRatio</span>&nbsp;<span class="op" id="4977116">=</span>&nbsp;<span class="ident" id="4977118">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4977124">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4977148">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4977172">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span><span class="op" id="4977195">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4977198">func</span>&nbsp;<span class="op" id="4977203">(</span><span class="ident" id="4977204">s</span>&nbsp;<span class="ident" id="4977206">YCbCrSubsampleRatio</span><span class="op" id="4977225">)</span>&nbsp;<span class="ident" id="4977227">String</span><span class="op" id="4977233">(</span><span class="op" id="4977234">)</span>&nbsp;<span class="builtintype" id="4977236">string</span>&nbsp;<span class="op" id="4977243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977246">switch</span>&nbsp;<span class="ident" id="4977253">s</span>&nbsp;<span class="op" id="4977255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977258">case</span>&nbsp;<span class="ident" id="4977263">YCbCrSubsampleRatio444</span><span class="op" id="4977285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977289">return</span>&nbsp;<span class="string" id="4977296">&#34;YCbCrSubsampleRatio444&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977322">case</span>&nbsp;<span class="ident" id="4977327">YCbCrSubsampleRatio422</span><span class="op" id="4977349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977353">return</span>&nbsp;<span class="string" id="4977360">&#34;YCbCrSubsampleRatio422&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977386">case</span>&nbsp;<span class="ident" id="4977391">YCbCrSubsampleRatio420</span><span class="op" id="4977413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977417">return</span>&nbsp;<span class="string" id="4977424">&#34;YCbCrSubsampleRatio420&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977450">case</span>&nbsp;<span class="ident" id="4977455">YCbCrSubsampleRatio440</span><span class="op" id="4977477">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977481">return</span>&nbsp;<span class="string" id="4977488">&#34;YCbCrSubsampleRatio440&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4977514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4977517">return</span>&nbsp;<span class="string" id="4977524">&#34;YCbCrSubsampleRatioUnknown&#34;</span><br>
<span class="lineno"></span><span class="op" id="4977553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4977556">//&nbsp;YCbCr&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;image&nbsp;of&nbsp;Y&#39;CbCr&nbsp;colors.&nbsp;There&nbsp;is&nbsp;one&nbsp;Y&nbsp;sample&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="4977631">//&nbsp;pixel,&nbsp;but&nbsp;each&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;sample&nbsp;can&nbsp;span&nbsp;one&nbsp;or&nbsp;more&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4977696">//&nbsp;YStride&nbsp;is&nbsp;the&nbsp;Y&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4977770">//&nbsp;CStride&nbsp;is&nbsp;the&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels</span><br>
<span class="lineno"></span><span class="comment" id="4977851">//&nbsp;that&nbsp;map&nbsp;to&nbsp;separate&nbsp;chroma&nbsp;samples.</span><br>
<span class="lineno">40</span><span class="comment" id="4977891">//&nbsp;It&nbsp;is&nbsp;not&nbsp;an&nbsp;absolute&nbsp;requirement,&nbsp;but&nbsp;YStride&nbsp;and&nbsp;len(Y)&nbsp;are&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="4977966">//&nbsp;multiples&nbsp;of&nbsp;8,&nbsp;and:</span><br>
<span class="lineno"></span><span class="comment" id="4977990">//&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;4:4:4,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/1.</span><br>
<span class="lineno"></span><span class="comment" id="4978060">//&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;4:2:2,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="comment" id="4978130">//&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;4:2:0,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/4.</span><br>
<span class="lineno">45</span><span class="comment" id="4978200">//&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;4:4:0,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="4978270">type</span>&nbsp;<span class="ident" id="4978275">YCbCr</span>&nbsp;<span class="keyword" id="4978281">struct</span>&nbsp;<span class="op" id="4978288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978291">Y</span><span class="op" id="4978292">,</span>&nbsp;<span class="ident" id="4978294">Cb</span><span class="op" id="4978296">,</span>&nbsp;<span class="ident" id="4978298">Cr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4978306">[</span><span class="op" id="4978307">]</span><span class="builtintype" id="4978308">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978315">YStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4978330">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978335">CStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4978350">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978355">SubsampleRatio</span>&nbsp;<span class="ident" id="4978370">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978391">Rect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978406">Rectangle</span><br>
<span class="lineno"></span><span class="op" id="4978416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4978419">func</span>&nbsp;<span class="op" id="4978424">(</span><span class="ident" id="4978425">p</span>&nbsp;<span class="op" id="4978427">*</span><span class="ident" id="4978428">YCbCr</span><span class="op" id="4978433">)</span>&nbsp;<span class="ident" id="4978435">ColorModel</span><span class="op" id="4978445">(</span><span class="op" id="4978446">)</span>&nbsp;<span class="ident" id="4978448">color</span><span class="op" id="4978453">.</span><span class="ident" id="4978454">Model</span>&nbsp;<span class="op" id="4978460">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978463">return</span>&nbsp;<span class="ident" id="4978470">color</span><span class="op" id="4978475">.</span><span class="ident" id="4978476">YCbCrModel</span><br>
<span class="lineno"></span><span class="op" id="4978487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4978490">func</span>&nbsp;<span class="op" id="4978495">(</span><span class="ident" id="4978496">p</span>&nbsp;<span class="op" id="4978498">*</span><span class="ident" id="4978499">YCbCr</span><span class="op" id="4978504">)</span>&nbsp;<span class="ident" id="4978506">Bounds</span><span class="op" id="4978512">(</span><span class="op" id="4978513">)</span>&nbsp;<span class="ident" id="4978515">Rectangle</span>&nbsp;<span class="op" id="4978525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978528">return</span>&nbsp;<span class="ident" id="4978535">p</span><span class="op" id="4978536">.</span><span class="ident" id="4978537">Rect</span><br>
<span class="lineno">60</span><span class="op" id="4978542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4978545">func</span>&nbsp;<span class="op" id="4978550">(</span><span class="ident" id="4978551">p</span>&nbsp;<span class="op" id="4978553">*</span><span class="ident" id="4978554">YCbCr</span><span class="op" id="4978559">)</span>&nbsp;<span class="ident" id="4978561">At</span><span class="op" id="4978563">(</span><span class="ident" id="4978564">x</span><span class="op" id="4978565">,</span>&nbsp;<span class="ident" id="4978567">y</span>&nbsp;<span class="builtintype" id="4978569">int</span><span class="op" id="4978572">)</span>&nbsp;<span class="ident" id="4978574">color</span><span class="op" id="4978579">.</span><span class="ident" id="4978580">Color</span>&nbsp;<span class="op" id="4978586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978589">return</span>&nbsp;<span class="ident" id="4978596">p</span><span class="op" id="4978597">.</span><span class="ident" id="4978598">YCbCrAt</span><span class="op" id="4978605">(</span><span class="ident" id="4978606">x</span><span class="op" id="4978607">,</span>&nbsp;<span class="ident" id="4978609">y</span><span class="op" id="4978610">)</span><br>
<span class="lineno"></span><span class="op" id="4978612">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4978615">func</span>&nbsp;<span class="op" id="4978620">(</span><span class="ident" id="4978621">p</span>&nbsp;<span class="op" id="4978623">*</span><span class="ident" id="4978624">YCbCr</span><span class="op" id="4978629">)</span>&nbsp;<span class="ident" id="4978631">YCbCrAt</span><span class="op" id="4978638">(</span><span class="ident" id="4978639">x</span><span class="op" id="4978640">,</span>&nbsp;<span class="ident" id="4978642">y</span>&nbsp;<span class="builtintype" id="4978644">int</span><span class="op" id="4978647">)</span>&nbsp;<span class="ident" id="4978649">color</span><span class="op" id="4978654">.</span><span class="ident" id="4978655">YCbCr</span>&nbsp;<span class="op" id="4978661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978664">if</span>&nbsp;<span class="op" id="4978667">!</span><span class="op" id="4978668">(</span><span class="ident" id="4978669">Point</span><span class="op" id="4978674">{</span><span class="ident" id="4978675">x</span><span class="op" id="4978676">,</span>&nbsp;<span class="ident" id="4978678">y</span><span class="op" id="4978679">}</span><span class="op" id="4978680">.</span><span class="ident" id="4978681">In</span><span class="op" id="4978683">(</span><span class="ident" id="4978684">p</span><span class="op" id="4978685">.</span><span class="ident" id="4978686">Rect</span><span class="op" id="4978690">)</span><span class="op" id="4978691">)</span>&nbsp;<span class="op" id="4978693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978697">return</span>&nbsp;<span class="ident" id="4978704">color</span><span class="op" id="4978709">.</span><span class="ident" id="4978710">YCbCr</span><span class="op" id="4978715">{</span><span class="op" id="4978716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4978719">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978722">yi</span>&nbsp;<span class="op" id="4978725">:=</span>&nbsp;<span class="ident" id="4978728">p</span><span class="op" id="4978729">.</span><span class="ident" id="4978730">YOffset</span><span class="op" id="4978737">(</span><span class="ident" id="4978738">x</span><span class="op" id="4978739">,</span>&nbsp;<span class="ident" id="4978741">y</span><span class="op" id="4978742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978745">ci</span>&nbsp;<span class="op" id="4978748">:=</span>&nbsp;<span class="ident" id="4978751">p</span><span class="op" id="4978752">.</span><span class="ident" id="4978753">COffset</span><span class="op" id="4978760">(</span><span class="ident" id="4978761">x</span><span class="op" id="4978762">,</span>&nbsp;<span class="ident" id="4978764">y</span><span class="op" id="4978765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978768">return</span>&nbsp;<span class="ident" id="4978775">color</span><span class="op" id="4978780">.</span><span class="ident" id="4978781">YCbCr</span><span class="op" id="4978786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978790">p</span><span class="op" id="4978791">.</span><span class="ident" id="4978792">Y</span><span class="op" id="4978793">[</span><span class="ident" id="4978794">yi</span><span class="op" id="4978796">]</span><span class="op" id="4978797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978801">p</span><span class="op" id="4978802">.</span><span class="ident" id="4978803">Cb</span><span class="op" id="4978805">[</span><span class="ident" id="4978806">ci</span><span class="op" id="4978808">]</span><span class="op" id="4978809">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4978813">p</span><span class="op" id="4978814">.</span><span class="ident" id="4978815">Cr</span><span class="op" id="4978817">[</span><span class="ident" id="4978818">ci</span><span class="op" id="4978820">]</span><span class="op" id="4978821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4978824">}</span><br>
<span class="lineno"></span><span class="op" id="4978826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4978829">//&nbsp;YOffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Y&nbsp;that&nbsp;corresponds&nbsp;to</span><br>
<span class="lineno">80</span><span class="comment" id="4978904">//&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4978928">func</span>&nbsp;<span class="op" id="4978933">(</span><span class="ident" id="4978934">p</span>&nbsp;<span class="op" id="4978936">*</span><span class="ident" id="4978937">YCbCr</span><span class="op" id="4978942">)</span>&nbsp;<span class="ident" id="4978944">YOffset</span><span class="op" id="4978951">(</span><span class="ident" id="4978952">x</span><span class="op" id="4978953">,</span>&nbsp;<span class="ident" id="4978955">y</span>&nbsp;<span class="builtintype" id="4978957">int</span><span class="op" id="4978960">)</span>&nbsp;<span class="builtintype" id="4978962">int</span>&nbsp;<span class="op" id="4978966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4978969">return</span>&nbsp;<span class="op" id="4978976">(</span><span class="ident" id="4978977">y</span><span class="op" id="4978978">-</span><span class="ident" id="4978979">p</span><span class="op" id="4978980">.</span><span class="ident" id="4978981">Rect</span><span class="op" id="4978985">.</span><span class="ident" id="4978986">Min</span><span class="op" id="4978989">.</span><span class="ident" id="4978990">Y</span><span class="op" id="4978991">)</span><span class="op" id="4978992">*</span><span class="ident" id="4978993">p</span><span class="op" id="4978994">.</span><span class="ident" id="4978995">YStride</span>&nbsp;<span class="op" id="4979003">+</span>&nbsp;<span class="op" id="4979005">(</span><span class="ident" id="4979006">x</span>&nbsp;<span class="op" id="4979008">-</span>&nbsp;<span class="ident" id="4979010">p</span><span class="op" id="4979011">.</span><span class="ident" id="4979012">Rect</span><span class="op" id="4979016">.</span><span class="ident" id="4979017">Min</span><span class="op" id="4979020">.</span><span class="ident" id="4979021">X</span><span class="op" id="4979022">)</span><br>
<span class="lineno"></span><span class="op" id="4979024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4979027">//&nbsp;COffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Cb&nbsp;or&nbsp;Cr&nbsp;that&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment" id="4979106">//&nbsp;to&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4979133">func</span>&nbsp;<span class="op" id="4979138">(</span><span class="ident" id="4979139">p</span>&nbsp;<span class="op" id="4979141">*</span><span class="ident" id="4979142">YCbCr</span><span class="op" id="4979147">)</span>&nbsp;<span class="ident" id="4979149">COffset</span><span class="op" id="4979156">(</span><span class="ident" id="4979157">x</span><span class="op" id="4979158">,</span>&nbsp;<span class="ident" id="4979160">y</span>&nbsp;<span class="builtintype" id="4979162">int</span><span class="op" id="4979165">)</span>&nbsp;<span class="builtintype" id="4979167">int</span>&nbsp;<span class="op" id="4979171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979174">switch</span>&nbsp;<span class="ident" id="4979181">p</span><span class="op" id="4979182">.</span><span class="ident" id="4979183">SubsampleRatio</span>&nbsp;<span class="op" id="4979198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979201">case</span>&nbsp;<span class="ident" id="4979206">YCbCrSubsampleRatio422</span><span class="op" id="4979228">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979232">return</span>&nbsp;<span class="op" id="4979239">(</span><span class="ident" id="4979240">y</span><span class="op" id="4979241">-</span><span class="ident" id="4979242">p</span><span class="op" id="4979243">.</span><span class="ident" id="4979244">Rect</span><span class="op" id="4979248">.</span><span class="ident" id="4979249">Min</span><span class="op" id="4979252">.</span><span class="ident" id="4979253">Y</span><span class="op" id="4979254">)</span><span class="op" id="4979255">*</span><span class="ident" id="4979256">p</span><span class="op" id="4979257">.</span><span class="ident" id="4979258">CStride</span>&nbsp;<span class="op" id="4979266">+</span>&nbsp;<span class="op" id="4979268">(</span><span class="ident" id="4979269">x</span><span class="op" id="4979270">/</span><span class="num" id="4979271">2</span>&nbsp;<span class="op" id="4979273">-</span>&nbsp;<span class="ident" id="4979275">p</span><span class="op" id="4979276">.</span><span class="ident" id="4979277">Rect</span><span class="op" id="4979281">.</span><span class="ident" id="4979282">Min</span><span class="op" id="4979285">.</span><span class="ident" id="4979286">X</span><span class="op" id="4979287">/</span><span class="num" id="4979288">2</span><span class="op" id="4979289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979292">case</span>&nbsp;<span class="ident" id="4979297">YCbCrSubsampleRatio420</span><span class="op" id="4979319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979323">return</span>&nbsp;<span class="op" id="4979330">(</span><span class="ident" id="4979331">y</span><span class="op" id="4979332">/</span><span class="num" id="4979333">2</span><span class="op" id="4979334">-</span><span class="ident" id="4979335">p</span><span class="op" id="4979336">.</span><span class="ident" id="4979337">Rect</span><span class="op" id="4979341">.</span><span class="ident" id="4979342">Min</span><span class="op" id="4979345">.</span><span class="ident" id="4979346">Y</span><span class="op" id="4979347">/</span><span class="num" id="4979348">2</span><span class="op" id="4979349">)</span><span class="op" id="4979350">*</span><span class="ident" id="4979351">p</span><span class="op" id="4979352">.</span><span class="ident" id="4979353">CStride</span>&nbsp;<span class="op" id="4979361">+</span>&nbsp;<span class="op" id="4979363">(</span><span class="ident" id="4979364">x</span><span class="op" id="4979365">/</span><span class="num" id="4979366">2</span>&nbsp;<span class="op" id="4979368">-</span>&nbsp;<span class="ident" id="4979370">p</span><span class="op" id="4979371">.</span><span class="ident" id="4979372">Rect</span><span class="op" id="4979376">.</span><span class="ident" id="4979377">Min</span><span class="op" id="4979380">.</span><span class="ident" id="4979381">X</span><span class="op" id="4979382">/</span><span class="num" id="4979383">2</span><span class="op" id="4979384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979387">case</span>&nbsp;<span class="ident" id="4979392">YCbCrSubsampleRatio440</span><span class="op" id="4979414">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979418">return</span>&nbsp;<span class="op" id="4979425">(</span><span class="ident" id="4979426">y</span><span class="op" id="4979427">/</span><span class="num" id="4979428">2</span><span class="op" id="4979429">-</span><span class="ident" id="4979430">p</span><span class="op" id="4979431">.</span><span class="ident" id="4979432">Rect</span><span class="op" id="4979436">.</span><span class="ident" id="4979437">Min</span><span class="op" id="4979440">.</span><span class="ident" id="4979441">Y</span><span class="op" id="4979442">/</span><span class="num" id="4979443">2</span><span class="op" id="4979444">)</span><span class="op" id="4979445">*</span><span class="ident" id="4979446">p</span><span class="op" id="4979447">.</span><span class="ident" id="4979448">CStride</span>&nbsp;<span class="op" id="4979456">+</span>&nbsp;<span class="op" id="4979458">(</span><span class="ident" id="4979459">x</span>&nbsp;<span class="op" id="4979461">-</span>&nbsp;<span class="ident" id="4979463">p</span><span class="op" id="4979464">.</span><span class="ident" id="4979465">Rect</span><span class="op" id="4979469">.</span><span class="ident" id="4979470">Min</span><span class="op" id="4979473">.</span><span class="ident" id="4979474">X</span><span class="op" id="4979475">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4979478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4979481">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4979515">return</span>&nbsp;<span class="op" id="4979522">(</span><span class="ident" id="4979523">y</span><span class="op" id="4979524">-</span><span class="ident" id="4979525">p</span><span class="op" id="4979526">.</span><span class="ident" id="4979527">Rect</span><span class="op" id="4979531">.</span><span class="ident" id="4979532">Min</span><span class="op" id="4979535">.</span><span class="ident" id="4979536">Y</span><span class="op" id="4979537">)</span><span class="op" id="4979538">*</span><span class="ident" id="4979539">p</span><span class="op" id="4979540">.</span><span class="ident" id="4979541">CStride</span>&nbsp;<span class="op" id="4979549">+</span>&nbsp;<span class="op" id="4979551">(</span><span class="ident" id="4979552">x</span>&nbsp;<span class="op" id="4979554">-</span>&nbsp;<span class="ident" id="4979556">p</span><span class="op" id="4979557">.</span><span class="ident" id="4979558">Rect</span><span class="op" id="4979562">.</span><span class="ident" id="4979563">Min</span><span class="op" id="4979566">.</span><span class="ident" id="4979567">X</span><span class="op" id="4979568">)</span><br>
<span class="lineno"></span><span class="op" id="4979570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="4979573">//&nbsp;SubImage&nbsp;returns&nbsp;an&nbsp;image&nbsp;representing&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;image&nbsp;p&nbsp;visible</span><br>
<span class="lineno"></span><span class="comment" id="4979650">//&nbsp;through&nbsp;r.&nbsp;The&nbsp;returned&nbsp;value&nbsp;shares&nbsp;pixels&nbsp;with&nbsp;the&nbsp;original&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4979722">func</span>&nbsp;<span class="op" id="4979727">(</span><span class="ident" id="4979728">p</span>&nbsp;<span class="op" id="4979730">*</span><span class="ident" id="4979731">YCbCr</span><span class="op" id="4979736">)</span>&nbsp;<span class="ident" id="4979738">SubImage</span><span class="op" id="4979746">(</span><span class="ident" id="4979747">r</span>&nbsp;<span class="ident" id="4979749">Rectangle</span><span class="op" id="4979758">)</span>&nbsp;<span class="ident" id="4979760">Image</span>&nbsp;<span class="op" id="4979766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4979769">r</span>&nbsp;<span class="op" id="4979771">=</span>&nbsp;<span class="ident" id="4979773">r</span><span class="op" id="4979774">.</span><span class="ident" id="4979775">Intersect</span><span class="op" id="4979784">(</span><span class="ident" id="4979785">p</span><span class="op" id="4979786">.</span><span class="ident" id="4979787">Rect</span><span class="op" id="4979791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4979794">//&nbsp;If&nbsp;r1&nbsp;and&nbsp;r2&nbsp;are&nbsp;Rectangles,&nbsp;r1.Intersect(r2)&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;inside</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4979875">//&nbsp;either&nbsp;r1&nbsp;or&nbsp;r2&nbsp;if&nbsp;the&nbsp;intersection&nbsp;is&nbsp;empty.&nbsp;Without&nbsp;explicitly&nbsp;checking&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4979957">//&nbsp;this,&nbsp;the&nbsp;Pix[i:]&nbsp;expression&nbsp;below&nbsp;can&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980007">if</span>&nbsp;<span class="ident" id="4980010">r</span><span class="op" id="4980011">.</span><span class="ident" id="4980012">Empty</span><span class="op" id="4980017">(</span><span class="op" id="4980018">)</span>&nbsp;<span class="op" id="4980020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980024">return</span>&nbsp;<span class="op" id="4980031">&amp;</span><span class="ident" id="4980032">YCbCr</span><span class="op" id="4980037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980042">SubsampleRatio</span><span class="op" id="4980056">:</span>&nbsp;<span class="ident" id="4980058">p</span><span class="op" id="4980059">.</span><span class="ident" id="4980060">SubsampleRatio</span><span class="op" id="4980074">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4980078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4980081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980084">yi</span>&nbsp;<span class="op" id="4980087">:=</span>&nbsp;<span class="ident" id="4980090">p</span><span class="op" id="4980091">.</span><span class="ident" id="4980092">YOffset</span><span class="op" id="4980099">(</span><span class="ident" id="4980100">r</span><span class="op" id="4980101">.</span><span class="ident" id="4980102">Min</span><span class="op" id="4980105">.</span><span class="ident" id="4980106">X</span><span class="op" id="4980107">,</span>&nbsp;<span class="ident" id="4980109">r</span><span class="op" id="4980110">.</span><span class="ident" id="4980111">Min</span><span class="op" id="4980114">.</span><span class="ident" id="4980115">Y</span><span class="op" id="4980116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980119">ci</span>&nbsp;<span class="op" id="4980122">:=</span>&nbsp;<span class="ident" id="4980125">p</span><span class="op" id="4980126">.</span><span class="ident" id="4980127">COffset</span><span class="op" id="4980134">(</span><span class="ident" id="4980135">r</span><span class="op" id="4980136">.</span><span class="ident" id="4980137">Min</span><span class="op" id="4980140">.</span><span class="ident" id="4980141">X</span><span class="op" id="4980142">,</span>&nbsp;<span class="ident" id="4980144">r</span><span class="op" id="4980145">.</span><span class="ident" id="4980146">Min</span><span class="op" id="4980149">.</span><span class="ident" id="4980150">Y</span><span class="op" id="4980151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980154">return</span>&nbsp;<span class="op" id="4980161">&amp;</span><span class="ident" id="4980162">YCbCr</span><span class="op" id="4980167">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980171">Y</span><span class="op" id="4980172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980187">p</span><span class="op" id="4980188">.</span><span class="ident" id="4980189">Y</span><span class="op" id="4980190">[</span><span class="ident" id="4980191">yi</span><span class="op" id="4980193">:</span><span class="op" id="4980194">]</span><span class="op" id="4980195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980199">Cb</span><span class="op" id="4980201">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980215">p</span><span class="op" id="4980216">.</span><span class="ident" id="4980217">Cb</span><span class="op" id="4980219">[</span><span class="ident" id="4980220">ci</span><span class="op" id="4980222">:</span><span class="op" id="4980223">]</span><span class="op" id="4980224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980228">Cr</span><span class="op" id="4980230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980244">p</span><span class="op" id="4980245">.</span><span class="ident" id="4980246">Cr</span><span class="op" id="4980248">[</span><span class="ident" id="4980249">ci</span><span class="op" id="4980251">:</span><span class="op" id="4980252">]</span><span class="op" id="4980253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980257">SubsampleRatio</span><span class="op" id="4980271">:</span>&nbsp;<span class="ident" id="4980273">p</span><span class="op" id="4980274">.</span><span class="ident" id="4980275">SubsampleRatio</span><span class="op" id="4980289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980293">YStride</span><span class="op" id="4980300">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980309">p</span><span class="op" id="4980310">.</span><span class="ident" id="4980311">YStride</span><span class="op" id="4980318">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980322">CStride</span><span class="op" id="4980329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980338">p</span><span class="op" id="4980339">.</span><span class="ident" id="4980340">CStride</span><span class="op" id="4980347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980351">Rect</span><span class="op" id="4980355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980367">r</span><span class="op" id="4980368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4980371">}</span><br>
<span class="lineno"></span><span class="op" id="4980373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4980376">func</span>&nbsp;<span class="op" id="4980381">(</span><span class="ident" id="4980382">p</span>&nbsp;<span class="op" id="4980384">*</span><span class="ident" id="4980385">YCbCr</span><span class="op" id="4980390">)</span>&nbsp;<span class="ident" id="4980392">Opaque</span><span class="op" id="4980398">(</span><span class="op" id="4980399">)</span>&nbsp;<span class="builtintype" id="4980401">bool</span>&nbsp;<span class="op" id="4980406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980409">return</span>&nbsp;<span class="builtintype" id="4980416">true</span><br>
<span class="lineno"></span><span class="op" id="4980421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4980424">//&nbsp;NewYCbCr&nbsp;returns&nbsp;a&nbsp;new&nbsp;YCbCr&nbsp;with&nbsp;the&nbsp;given&nbsp;bounds&nbsp;and&nbsp;subsample&nbsp;ratio.</span><br>
<span class="lineno">130</span><span class="keyword" id="4980499">func</span>&nbsp;<span class="ident" id="4980504">NewYCbCr</span><span class="op" id="4980512">(</span><span class="ident" id="4980513">r</span>&nbsp;<span class="ident" id="4980515">Rectangle</span><span class="op" id="4980524">,</span>&nbsp;<span class="ident" id="4980526">subsampleRatio</span>&nbsp;<span class="ident" id="4980541">YCbCrSubsampleRatio</span><span class="op" id="4980560">)</span>&nbsp;<span class="op" id="4980562">*</span><span class="ident" id="4980563">YCbCr</span>&nbsp;<span class="op" id="4980569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980572">w</span><span class="op" id="4980573">,</span>&nbsp;<span class="ident" id="4980575">h</span><span class="op" id="4980576">,</span>&nbsp;<span class="ident" id="4980578">cw</span><span class="op" id="4980580">,</span>&nbsp;<span class="ident" id="4980582">ch</span>&nbsp;<span class="op" id="4980585">:=</span>&nbsp;<span class="ident" id="4980588">r</span><span class="op" id="4980589">.</span><span class="ident" id="4980590">Dx</span><span class="op" id="4980592">(</span><span class="op" id="4980593">)</span><span class="op" id="4980594">,</span>&nbsp;<span class="ident" id="4980596">r</span><span class="op" id="4980597">.</span><span class="ident" id="4980598">Dy</span><span class="op" id="4980600">(</span><span class="op" id="4980601">)</span><span class="op" id="4980602">,</span>&nbsp;<span class="num" id="4980604">0</span><span class="op" id="4980605">,</span>&nbsp;<span class="num" id="4980607">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980610">switch</span>&nbsp;<span class="ident" id="4980617">subsampleRatio</span>&nbsp;<span class="op" id="4980632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980635">case</span>&nbsp;<span class="ident" id="4980640">YCbCrSubsampleRatio422</span><span class="op" id="4980662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980666">cw</span>&nbsp;<span class="op" id="4980669">=</span>&nbsp;<span class="op" id="4980671">(</span><span class="ident" id="4980672">r</span><span class="op" id="4980673">.</span><span class="ident" id="4980674">Max</span><span class="op" id="4980677">.</span><span class="ident" id="4980678">X</span><span class="op" id="4980679">+</span><span class="num" id="4980680">1</span><span class="op" id="4980681">)</span><span class="op" id="4980682">/</span><span class="num" id="4980683">2</span>&nbsp;<span class="op" id="4980685">-</span>&nbsp;<span class="ident" id="4980687">r</span><span class="op" id="4980688">.</span><span class="ident" id="4980689">Min</span><span class="op" id="4980692">.</span><span class="ident" id="4980693">X</span><span class="op" id="4980694">/</span><span class="num" id="4980695">2</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980699">ch</span>&nbsp;<span class="op" id="4980702">=</span>&nbsp;<span class="ident" id="4980704">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980707">case</span>&nbsp;<span class="ident" id="4980712">YCbCrSubsampleRatio420</span><span class="op" id="4980734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980738">cw</span>&nbsp;<span class="op" id="4980741">=</span>&nbsp;<span class="op" id="4980743">(</span><span class="ident" id="4980744">r</span><span class="op" id="4980745">.</span><span class="ident" id="4980746">Max</span><span class="op" id="4980749">.</span><span class="ident" id="4980750">X</span><span class="op" id="4980751">+</span><span class="num" id="4980752">1</span><span class="op" id="4980753">)</span><span class="op" id="4980754">/</span><span class="num" id="4980755">2</span>&nbsp;<span class="op" id="4980757">-</span>&nbsp;<span class="ident" id="4980759">r</span><span class="op" id="4980760">.</span><span class="ident" id="4980761">Min</span><span class="op" id="4980764">.</span><span class="ident" id="4980765">X</span><span class="op" id="4980766">/</span><span class="num" id="4980767">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980771">ch</span>&nbsp;<span class="op" id="4980774">=</span>&nbsp;<span class="op" id="4980776">(</span><span class="ident" id="4980777">r</span><span class="op" id="4980778">.</span><span class="ident" id="4980779">Max</span><span class="op" id="4980782">.</span><span class="ident" id="4980783">Y</span><span class="op" id="4980784">+</span><span class="num" id="4980785">1</span><span class="op" id="4980786">)</span><span class="op" id="4980787">/</span><span class="num" id="4980788">2</span>&nbsp;<span class="op" id="4980790">-</span>&nbsp;<span class="ident" id="4980792">r</span><span class="op" id="4980793">.</span><span class="ident" id="4980794">Min</span><span class="op" id="4980797">.</span><span class="ident" id="4980798">Y</span><span class="op" id="4980799">/</span><span class="num" id="4980800">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980803">case</span>&nbsp;<span class="ident" id="4980808">YCbCrSubsampleRatio440</span><span class="op" id="4980830">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980834">cw</span>&nbsp;<span class="op" id="4980837">=</span>&nbsp;<span class="ident" id="4980839">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980843">ch</span>&nbsp;<span class="op" id="4980846">=</span>&nbsp;<span class="op" id="4980848">(</span><span class="ident" id="4980849">r</span><span class="op" id="4980850">.</span><span class="ident" id="4980851">Max</span><span class="op" id="4980854">.</span><span class="ident" id="4980855">Y</span><span class="op" id="4980856">+</span><span class="num" id="4980857">1</span><span class="op" id="4980858">)</span><span class="op" id="4980859">/</span><span class="num" id="4980860">2</span>&nbsp;<span class="op" id="4980862">-</span>&nbsp;<span class="ident" id="4980864">r</span><span class="op" id="4980865">.</span><span class="ident" id="4980866">Min</span><span class="op" id="4980869">.</span><span class="ident" id="4980870">Y</span><span class="op" id="4980871">/</span><span class="num" id="4980872">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980875">default</span><span class="op" id="4980882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4980886">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980921">cw</span>&nbsp;<span class="op" id="4980924">=</span>&nbsp;<span class="ident" id="4980926">w</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980930">ch</span>&nbsp;<span class="op" id="4980933">=</span>&nbsp;<span class="ident" id="4980935">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4980938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980941">b</span>&nbsp;<span class="op" id="4980943">:=</span>&nbsp;<span class="builtinfunc" id="4980946">make</span><span class="op" id="4980950">(</span><span class="op" id="4980951">[</span><span class="op" id="4980952">]</span><span class="builtintype" id="4980953">byte</span><span class="op" id="4980957">,</span>&nbsp;<span class="ident" id="4980959">w</span><span class="op" id="4980960">*</span><span class="ident" id="4980961">h</span><span class="op" id="4980962">+</span><span class="num" id="4980963">2</span><span class="op" id="4980964">*</span><span class="ident" id="4980965">cw</span><span class="op" id="4980967">*</span><span class="ident" id="4980968">ch</span><span class="op" id="4980970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4980973">return</span>&nbsp;<span class="op" id="4980980">&amp;</span><span class="ident" id="4980981">YCbCr</span><span class="op" id="4980986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4980990">Y</span><span class="op" id="4980991">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981006">b</span><span class="op" id="4981007">[</span><span class="op" id="4981008">:</span><span class="ident" id="4981009">w</span><span class="op" id="4981010">*</span><span class="ident" id="4981011">h</span><span class="op" id="4981012">]</span><span class="op" id="4981013">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981017">Cb</span><span class="op" id="4981019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981033">b</span><span class="op" id="4981034">[</span><span class="ident" id="4981035">w</span><span class="op" id="4981036">*</span><span class="ident" id="4981037">h</span><span class="op" id="4981038">+</span><span class="num" id="4981039">0</span><span class="op" id="4981040">*</span><span class="ident" id="4981041">cw</span><span class="op" id="4981043">*</span><span class="ident" id="4981044">ch</span>&nbsp;<span class="op" id="4981047">:</span>&nbsp;<span class="ident" id="4981049">w</span><span class="op" id="4981050">*</span><span class="ident" id="4981051">h</span><span class="op" id="4981052">+</span><span class="num" id="4981053">1</span><span class="op" id="4981054">*</span><span class="ident" id="4981055">cw</span><span class="op" id="4981057">*</span><span class="ident" id="4981058">ch</span><span class="op" id="4981060">]</span><span class="op" id="4981061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981065">Cr</span><span class="op" id="4981067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981081">b</span><span class="op" id="4981082">[</span><span class="ident" id="4981083">w</span><span class="op" id="4981084">*</span><span class="ident" id="4981085">h</span><span class="op" id="4981086">+</span><span class="num" id="4981087">1</span><span class="op" id="4981088">*</span><span class="ident" id="4981089">cw</span><span class="op" id="4981091">*</span><span class="ident" id="4981092">ch</span>&nbsp;<span class="op" id="4981095">:</span>&nbsp;<span class="ident" id="4981097">w</span><span class="op" id="4981098">*</span><span class="ident" id="4981099">h</span><span class="op" id="4981100">+</span><span class="num" id="4981101">2</span><span class="op" id="4981102">*</span><span class="ident" id="4981103">cw</span><span class="op" id="4981105">*</span><span class="ident" id="4981106">ch</span><span class="op" id="4981108">]</span><span class="op" id="4981109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981113">SubsampleRatio</span><span class="op" id="4981127">:</span>&nbsp;<span class="ident" id="4981129">subsampleRatio</span><span class="op" id="4981143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981147">YStride</span><span class="op" id="4981154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981163">w</span><span class="op" id="4981164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981168">CStride</span><span class="op" id="4981175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981184">cw</span><span class="op" id="4981186">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981190">Rect</span><span class="op" id="4981194">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4981206">r</span><span class="op" id="4981207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4981210">}</span><br>
<span class="lineno"></span><span class="op" id="4981212">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
