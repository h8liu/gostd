<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html" class="current">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1383867">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1383922">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1383976">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1384027">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1384086">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1384161">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1384228">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1384295">//</span><br>
<span class="lineno">10</span><span class="comment" id="1384298">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1384374">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1384447">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1384495">package</span>&nbsp;<span class="ident" id="1384503">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1384507">import</span>&nbsp;<span class="op" id="1384514">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1384517">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1384526">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1384529">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1384601">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1384644">var</span>&nbsp;<span class="ident" id="1384648">ErrShortWrite</span>&nbsp;<span class="op" id="1384662">=</span>&nbsp;<span class="ident" id="1384664">errors</span><span class="op" id="1384670">.</span><span class="ident" id="1384671">New</span><span class="op" id="1384674">(</span><span class="string" id="1384675">&#34;short&nbsp;write&#34;</span><span class="op" id="1384688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1384691">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1384771">var</span>&nbsp;<span class="ident" id="1384775">ErrShortBuffer</span>&nbsp;<span class="op" id="1384790">=</span>&nbsp;<span class="ident" id="1384792">errors</span><span class="op" id="1384798">.</span><span class="ident" id="1384799">New</span><span class="op" id="1384802">(</span><span class="string" id="1384803">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1384817">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1384820">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1384890">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1384961">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1385024">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1385096">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1385119">var</span>&nbsp;<span class="ident" id="1385123">EOF</span>&nbsp;<span class="op" id="1385127">=</span>&nbsp;<span class="ident" id="1385129">errors</span><span class="op" id="1385135">.</span><span class="ident" id="1385136">New</span><span class="op" id="1385139">(</span><span class="string" id="1385140">&#34;EOF&#34;</span><span class="op" id="1385145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1385148">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1385206">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1385265">var</span>&nbsp;<span class="ident" id="1385269">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1385286">=</span>&nbsp;<span class="ident" id="1385288">errors</span><span class="op" id="1385294">.</span><span class="ident" id="1385295">New</span><span class="op" id="1385298">(</span><span class="string" id="1385299">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1385315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1385318">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1385384">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1385447">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1385505">var</span>&nbsp;<span class="ident" id="1385509">ErrNoProgress</span>&nbsp;<span class="op" id="1385523">=</span>&nbsp;<span class="ident" id="1385525">errors</span><span class="op" id="1385531">.</span><span class="ident" id="1385532">New</span><span class="op" id="1385535">(</span><span class="string" id="1385536">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1385581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1385584">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1385645">//</span><br>
<span class="lineno"></span><span class="comment" id="1385648">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1385721">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1385789">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1385866">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1385937">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1385995">//</span><br>
<span class="lineno">50</span><span class="comment" id="1385998">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1386062">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1386124">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1386193">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1386253">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1386316">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1386381">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1386446">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1386475">//</span><br>
<span class="lineno"></span><span class="comment" id="1386478">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1386543">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1386612">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1386673">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1386699">//</span><br>
<span class="lineno"></span><span class="comment" id="1386702">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1386762">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1386824">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1386889">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1386950">//</span><br>
<span class="lineno"></span><span class="comment" id="1386953">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1386991">type</span>&nbsp;<span class="ident" id="1386996">Reader</span>&nbsp;<span class="keyword" id="1387003">interface</span>&nbsp;<span class="op" id="1387013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387016">Read</span><span class="op" id="1387020">(</span><span class="ident" id="1387021">p</span>&nbsp;<span class="op" id="1387023">[</span><span class="op" id="1387024">]</span><span class="builtintype" id="1387025">byte</span><span class="op" id="1387029">)</span>&nbsp;<span class="op" id="1387031">(</span><span class="ident" id="1387032">n</span>&nbsp;<span class="builtintype" id="1387034">int</span><span class="op" id="1387037">,</span>&nbsp;<span class="ident" id="1387039">err</span>&nbsp;<span class="builtintype" id="1387043">error</span><span class="op" id="1387048">)</span><br>
<span class="lineno"></span><span class="op" id="1387050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1387053">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1387115">//</span><br>
<span class="lineno"></span><span class="comment" id="1387118">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1387185">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1387253">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1387319">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1387382">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1387441">//</span><br>
<span class="lineno"></span><span class="comment" id="1387444">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1387482">type</span>&nbsp;<span class="ident" id="1387487">Writer</span>&nbsp;<span class="keyword" id="1387494">interface</span>&nbsp;<span class="op" id="1387504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387507">Write</span><span class="op" id="1387512">(</span><span class="ident" id="1387513">p</span>&nbsp;<span class="op" id="1387515">[</span><span class="op" id="1387516">]</span><span class="builtintype" id="1387517">byte</span><span class="op" id="1387521">)</span>&nbsp;<span class="op" id="1387523">(</span><span class="ident" id="1387524">n</span>&nbsp;<span class="builtintype" id="1387526">int</span><span class="op" id="1387529">,</span>&nbsp;<span class="ident" id="1387531">err</span>&nbsp;<span class="builtintype" id="1387535">error</span><span class="op" id="1387540">)</span><br>
<span class="lineno">85</span><span class="op" id="1387542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1387545">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1387607">//</span><br>
<span class="lineno"></span><span class="comment" id="1387610">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1387670">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1387731">type</span>&nbsp;<span class="ident" id="1387736">Closer</span>&nbsp;<span class="keyword" id="1387743">interface</span>&nbsp;<span class="op" id="1387753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387756">Close</span><span class="op" id="1387761">(</span><span class="op" id="1387762">)</span>&nbsp;<span class="builtintype" id="1387764">error</span><br>
<span class="lineno"></span><span class="op" id="1387770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1387773">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1387834">//</span><br>
<span class="lineno"></span><span class="comment" id="1387837">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1387899">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1387969">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1388034">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1388104">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1388112">//</span><br>
<span class="lineno"></span><span class="comment" id="1388115">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1388184">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1388253">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1388307">type</span>&nbsp;<span class="ident" id="1388312">Seeker</span>&nbsp;<span class="keyword" id="1388319">interface</span>&nbsp;<span class="op" id="1388329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388332">Seek</span><span class="op" id="1388336">(</span><span class="ident" id="1388337">offset</span>&nbsp;<span class="ident" id="1388344">int64</span><span class="op" id="1388349">,</span>&nbsp;<span class="ident" id="1388351">whence</span>&nbsp;<span class="builtintype" id="1388358">int</span><span class="op" id="1388361">)</span>&nbsp;<span class="op" id="1388363">(</span><span class="ident" id="1388364">int64</span><span class="op" id="1388369">,</span>&nbsp;<span class="builtintype" id="1388371">error</span><span class="op" id="1388376">)</span><br>
<span class="lineno"></span><span class="op" id="1388378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1388381">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1388458">type</span>&nbsp;<span class="ident" id="1388463">ReadWriter</span>&nbsp;<span class="keyword" id="1388474">interface</span>&nbsp;<span class="op" id="1388484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388487">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388495">Writer</span><br>
<span class="lineno"></span><span class="op" id="1388502">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1388505">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1388582">type</span>&nbsp;<span class="ident" id="1388587">ReadCloser</span>&nbsp;<span class="keyword" id="1388598">interface</span>&nbsp;<span class="op" id="1388608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388611">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388619">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1388626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388629">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1388708">type</span>&nbsp;<span class="ident" id="1388713">WriteCloser</span>&nbsp;<span class="keyword" id="1388725">interface</span>&nbsp;<span class="op" id="1388735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388738">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388746">Closer</span><br>
<span class="lineno"></span><span class="op" id="1388753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388756">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1388845">type</span>&nbsp;<span class="ident" id="1388850">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1388866">interface</span>&nbsp;<span class="op" id="1388876">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388879">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388887">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388895">Closer</span><br>
<span class="lineno"></span><span class="op" id="1388902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1388905">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1388981">type</span>&nbsp;<span class="ident" id="1388986">ReadSeeker</span>&nbsp;<span class="keyword" id="1388997">interface</span>&nbsp;<span class="op" id="1389007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389010">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389018">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1389025">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1389028">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1389106">type</span>&nbsp;<span class="ident" id="1389111">WriteSeeker</span>&nbsp;<span class="keyword" id="1389123">interface</span>&nbsp;<span class="op" id="1389133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389136">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389144">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1389151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389154">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1389242">type</span>&nbsp;<span class="ident" id="1389247">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1389263">interface</span>&nbsp;<span class="op" id="1389273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389276">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389284">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389292">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1389299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389302">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1389365">//</span><br>
<span class="lineno"></span><span class="comment" id="1389368">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1389418">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1389469">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1389542">//</span><br>
<span class="lineno">160</span><span class="comment" id="1389545">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1389596">type</span>&nbsp;<span class="ident" id="1389601">ReaderFrom</span>&nbsp;<span class="keyword" id="1389612">interface</span>&nbsp;<span class="op" id="1389622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389625">ReadFrom</span><span class="op" id="1389633">(</span><span class="ident" id="1389634">r</span>&nbsp;<span class="ident" id="1389636">Reader</span><span class="op" id="1389642">)</span>&nbsp;<span class="op" id="1389644">(</span><span class="ident" id="1389645">n</span>&nbsp;<span class="ident" id="1389647">int64</span><span class="op" id="1389652">,</span>&nbsp;<span class="ident" id="1389654">err</span>&nbsp;<span class="builtintype" id="1389658">error</span><span class="op" id="1389663">)</span><br>
<span class="lineno"></span><span class="op" id="1389665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1389668">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1389728">//</span><br>
<span class="lineno"></span><span class="comment" id="1389731">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1389798">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1389865">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1389934">//</span><br>
<span class="lineno"></span><span class="comment" id="1389937">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1389986">type</span>&nbsp;<span class="ident" id="1389991">WriterTo</span>&nbsp;<span class="keyword" id="1390000">interface</span>&nbsp;<span class="op" id="1390010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390013">WriteTo</span><span class="op" id="1390020">(</span><span class="ident" id="1390021">w</span>&nbsp;<span class="ident" id="1390023">Writer</span><span class="op" id="1390029">)</span>&nbsp;<span class="op" id="1390031">(</span><span class="ident" id="1390032">n</span>&nbsp;<span class="ident" id="1390034">int64</span><span class="op" id="1390039">,</span>&nbsp;<span class="ident" id="1390041">err</span>&nbsp;<span class="builtintype" id="1390045">error</span><span class="op" id="1390050">)</span><br>
<span class="lineno"></span><span class="op" id="1390052">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1390055">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1390120">//</span><br>
<span class="lineno"></span><span class="comment" id="1390123">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1390189">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1390249">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1390303">//</span><br>
<span class="lineno"></span><span class="comment" id="1390306">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1390368">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1390434">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1390467">//</span><br>
<span class="lineno"></span><span class="comment" id="1390470">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1390539">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1390614">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1390690">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1390740">//</span><br>
<span class="lineno"></span><span class="comment" id="1390743">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1390811">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1390879">//</span><br>
<span class="lineno"></span><span class="comment" id="1390882">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1390947">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1391009">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1391025">//</span><br>
<span class="lineno"></span><span class="comment" id="1391028">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1391090">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1391112">//</span><br>
<span class="lineno"></span><span class="comment" id="1391115">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1391153">type</span>&nbsp;<span class="ident" id="1391158">ReaderAt</span>&nbsp;<span class="keyword" id="1391167">interface</span>&nbsp;<span class="op" id="1391177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391180">ReadAt</span><span class="op" id="1391186">(</span><span class="ident" id="1391187">p</span>&nbsp;<span class="op" id="1391189">[</span><span class="op" id="1391190">]</span><span class="builtintype" id="1391191">byte</span><span class="op" id="1391195">,</span>&nbsp;<span class="ident" id="1391197">off</span>&nbsp;<span class="ident" id="1391201">int64</span><span class="op" id="1391206">)</span>&nbsp;<span class="op" id="1391208">(</span><span class="ident" id="1391209">n</span>&nbsp;<span class="builtintype" id="1391211">int</span><span class="op" id="1391214">,</span>&nbsp;<span class="ident" id="1391216">err</span>&nbsp;<span class="builtintype" id="1391220">error</span><span class="op" id="1391225">)</span><br>
<span class="lineno"></span><span class="op" id="1391227">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1391230">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1391296">//</span><br>
<span class="lineno"></span><span class="comment" id="1391299">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1391367">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1391451">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1391517">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1391582">//</span><br>
<span class="lineno"></span><span class="comment" id="1391585">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1391647">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1391710">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1391726">//</span><br>
<span class="lineno"></span><span class="comment" id="1391729">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1391798">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1391843">//</span><br>
<span class="lineno">220</span><span class="comment" id="1391846">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1391884">type</span>&nbsp;<span class="ident" id="1391889">WriterAt</span>&nbsp;<span class="keyword" id="1391898">interface</span>&nbsp;<span class="op" id="1391908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391911">WriteAt</span><span class="op" id="1391918">(</span><span class="ident" id="1391919">p</span>&nbsp;<span class="op" id="1391921">[</span><span class="op" id="1391922">]</span><span class="builtintype" id="1391923">byte</span><span class="op" id="1391927">,</span>&nbsp;<span class="ident" id="1391929">off</span>&nbsp;<span class="ident" id="1391933">int64</span><span class="op" id="1391938">)</span>&nbsp;<span class="op" id="1391940">(</span><span class="ident" id="1391941">n</span>&nbsp;<span class="builtintype" id="1391943">int</span><span class="op" id="1391946">,</span>&nbsp;<span class="ident" id="1391948">err</span>&nbsp;<span class="builtintype" id="1391952">error</span><span class="op" id="1391957">)</span><br>
<span class="lineno"></span><span class="op" id="1391959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1391962">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1392025">//</span><br>
<span class="lineno"></span><span class="comment" id="1392028">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1392088">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1392133">type</span>&nbsp;<span class="ident" id="1392138">ByteReader</span>&nbsp;<span class="keyword" id="1392149">interface</span>&nbsp;<span class="op" id="1392159">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392162">ReadByte</span><span class="op" id="1392170">(</span><span class="op" id="1392171">)</span>&nbsp;<span class="op" id="1392173">(</span><span class="ident" id="1392174">c</span>&nbsp;<span class="builtintype" id="1392176">byte</span><span class="op" id="1392180">,</span>&nbsp;<span class="ident" id="1392182">err</span>&nbsp;<span class="builtintype" id="1392186">error</span><span class="op" id="1392191">)</span><br>
<span class="lineno"></span><span class="op" id="1392193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1392196">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1392267">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1392293">//</span><br>
<span class="lineno"></span><span class="comment" id="1392296">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1392367">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1392404">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1392474">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1392495">type</span>&nbsp;<span class="ident" id="1392500">ByteScanner</span>&nbsp;<span class="keyword" id="1392512">interface</span>&nbsp;<span class="op" id="1392522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392525">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392537">UnreadByte</span><span class="op" id="1392547">(</span><span class="op" id="1392548">)</span>&nbsp;<span class="builtintype" id="1392550">error</span><br>
<span class="lineno"></span><span class="op" id="1392556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1392559">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1392623">type</span>&nbsp;<span class="ident" id="1392628">ByteWriter</span>&nbsp;<span class="keyword" id="1392639">interface</span>&nbsp;<span class="op" id="1392649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392652">WriteByte</span><span class="op" id="1392661">(</span><span class="ident" id="1392662">c</span>&nbsp;<span class="builtintype" id="1392664">byte</span><span class="op" id="1392668">)</span>&nbsp;<span class="builtintype" id="1392670">error</span><br>
<span class="lineno"></span><span class="op" id="1392676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1392679">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1392742">//</span><br>
<span class="lineno"></span><span class="comment" id="1392745">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1392804">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1392870">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1392901">type</span>&nbsp;<span class="ident" id="1392906">RuneReader</span>&nbsp;<span class="keyword" id="1392917">interface</span>&nbsp;<span class="op" id="1392927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392930">ReadRune</span><span class="op" id="1392938">(</span><span class="op" id="1392939">)</span>&nbsp;<span class="op" id="1392941">(</span><span class="ident" id="1392942">r</span>&nbsp;<span class="builtintype" id="1392944">rune</span><span class="op" id="1392948">,</span>&nbsp;<span class="ident" id="1392950">size</span>&nbsp;<span class="builtintype" id="1392955">int</span><span class="op" id="1392958">,</span>&nbsp;<span class="ident" id="1392960">err</span>&nbsp;<span class="builtintype" id="1392964">error</span><span class="op" id="1392969">)</span><br>
<span class="lineno"></span><span class="op" id="1392971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1392974">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1393045">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1393071">//</span><br>
<span class="lineno"></span><span class="comment" id="1393074">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1393145">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1393182">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1393252">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1393273">type</span>&nbsp;<span class="ident" id="1393278">RuneScanner</span>&nbsp;<span class="keyword" id="1393290">interface</span>&nbsp;<span class="op" id="1393300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393303">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393315">UnreadRune</span><span class="op" id="1393325">(</span><span class="op" id="1393326">)</span>&nbsp;<span class="builtintype" id="1393328">error</span><br>
<span class="lineno"></span><span class="op" id="1393334">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1393337">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1393405">type</span>&nbsp;<span class="ident" id="1393410">stringWriter</span>&nbsp;<span class="keyword" id="1393423">interface</span>&nbsp;<span class="op" id="1393433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393436">WriteString</span><span class="op" id="1393447">(</span><span class="ident" id="1393448">s</span>&nbsp;<span class="builtintype" id="1393450">string</span><span class="op" id="1393456">)</span>&nbsp;<span class="op" id="1393458">(</span><span class="ident" id="1393459">n</span>&nbsp;<span class="builtintype" id="1393461">int</span><span class="op" id="1393464">,</span>&nbsp;<span class="ident" id="1393466">err</span>&nbsp;<span class="builtintype" id="1393470">error</span><span class="op" id="1393475">)</span><br>
<span class="lineno"></span><span class="op" id="1393477">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1393480">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1393570">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1393643">func</span>&nbsp;<span class="ident" id="1393648">WriteString</span><span class="op" id="1393659">(</span><span class="ident" id="1393660">w</span>&nbsp;<span class="ident" id="1393662">Writer</span><span class="op" id="1393668">,</span>&nbsp;<span class="ident" id="1393670">s</span>&nbsp;<span class="builtintype" id="1393672">string</span><span class="op" id="1393678">)</span>&nbsp;<span class="op" id="1393680">(</span><span class="ident" id="1393681">n</span>&nbsp;<span class="builtintype" id="1393683">int</span><span class="op" id="1393686">,</span>&nbsp;<span class="ident" id="1393688">err</span>&nbsp;<span class="builtintype" id="1393692">error</span><span class="op" id="1393697">)</span>&nbsp;<span class="op" id="1393699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393702">if</span>&nbsp;<span class="ident" id="1393705">sw</span><span class="op" id="1393707">,</span>&nbsp;<span class="ident" id="1393709">ok</span>&nbsp;<span class="op" id="1393712">:=</span>&nbsp;<span class="ident" id="1393715">w</span><span class="op" id="1393716">.</span><span class="op" id="1393717">(</span><span class="ident" id="1393718">stringWriter</span><span class="op" id="1393730">)</span><span class="op" id="1393731">;</span>&nbsp;<span class="ident" id="1393733">ok</span>&nbsp;<span class="op" id="1393736">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393740">return</span>&nbsp;<span class="ident" id="1393747">sw</span><span class="op" id="1393749">.</span><span class="ident" id="1393750">WriteString</span><span class="op" id="1393761">(</span><span class="ident" id="1393762">s</span><span class="op" id="1393763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1393766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393769">return</span>&nbsp;<span class="ident" id="1393776">w</span><span class="op" id="1393777">.</span><span class="ident" id="1393778">Write</span><span class="op" id="1393783">(</span><span class="op" id="1393784">[</span><span class="op" id="1393785">]</span><span class="builtintype" id="1393786">byte</span><span class="op" id="1393790">(</span><span class="ident" id="1393791">s</span><span class="op" id="1393792">)</span><span class="op" id="1393793">)</span><br>
<span class="lineno"></span><span class="op" id="1393795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1393798">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1393873">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1393953">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1394001">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1394058">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1394099">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1394180">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1394230">func</span>&nbsp;<span class="ident" id="1394235">ReadAtLeast</span><span class="op" id="1394246">(</span><span class="ident" id="1394247">r</span>&nbsp;<span class="ident" id="1394249">Reader</span><span class="op" id="1394255">,</span>&nbsp;<span class="ident" id="1394257">buf</span>&nbsp;<span class="op" id="1394261">[</span><span class="op" id="1394262">]</span><span class="builtintype" id="1394263">byte</span><span class="op" id="1394267">,</span>&nbsp;<span class="ident" id="1394269">min</span>&nbsp;<span class="builtintype" id="1394273">int</span><span class="op" id="1394276">)</span>&nbsp;<span class="op" id="1394278">(</span><span class="ident" id="1394279">n</span>&nbsp;<span class="builtintype" id="1394281">int</span><span class="op" id="1394284">,</span>&nbsp;<span class="ident" id="1394286">err</span>&nbsp;<span class="builtintype" id="1394290">error</span><span class="op" id="1394295">)</span>&nbsp;<span class="op" id="1394297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394300">if</span>&nbsp;<span class="builtinfunc" id="1394303">len</span><span class="op" id="1394306">(</span><span class="ident" id="1394307">buf</span><span class="op" id="1394310">)</span>&nbsp;<span class="op" id="1394312">&lt;</span>&nbsp;<span class="ident" id="1394314">min</span>&nbsp;<span class="op" id="1394318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394322">return</span>&nbsp;<span class="num" id="1394329">0</span><span class="op" id="1394330">,</span>&nbsp;<span class="ident" id="1394332">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1394348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394351">for</span>&nbsp;<span class="ident" id="1394355">n</span>&nbsp;<span class="op" id="1394357">&lt;</span>&nbsp;<span class="ident" id="1394359">min</span>&nbsp;<span class="op" id="1394363">&amp;&amp;</span>&nbsp;<span class="ident" id="1394366">err</span>&nbsp;<span class="op" id="1394370">==</span>&nbsp;<span class="builtintype" id="1394373">nil</span>&nbsp;<span class="op" id="1394377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394381">var</span>&nbsp;<span class="ident" id="1394385">nn</span>&nbsp;<span class="builtintype" id="1394388">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1394394">nn</span><span class="op" id="1394396">,</span>&nbsp;<span class="ident" id="1394398">err</span>&nbsp;<span class="op" id="1394402">=</span>&nbsp;<span class="ident" id="1394404">r</span><span class="op" id="1394405">.</span><span class="ident" id="1394406">Read</span><span class="op" id="1394410">(</span><span class="ident" id="1394411">buf</span><span class="op" id="1394414">[</span><span class="ident" id="1394415">n</span><span class="op" id="1394416">:</span><span class="op" id="1394417">]</span><span class="op" id="1394418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1394422">n</span>&nbsp;<span class="op" id="1394424">+=</span>&nbsp;<span class="ident" id="1394427">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1394431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394434">if</span>&nbsp;<span class="ident" id="1394437">n</span>&nbsp;<span class="op" id="1394439">&gt;=</span>&nbsp;<span class="ident" id="1394442">min</span>&nbsp;<span class="op" id="1394446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1394450">err</span>&nbsp;<span class="op" id="1394454">=</span>&nbsp;<span class="builtintype" id="1394456">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1394461">}</span>&nbsp;<span class="keyword" id="1394463">else</span>&nbsp;<span class="keyword" id="1394468">if</span>&nbsp;<span class="ident" id="1394471">n</span>&nbsp;<span class="op" id="1394473">&gt;</span>&nbsp;<span class="num" id="1394475">0</span>&nbsp;<span class="op" id="1394477">&amp;&amp;</span>&nbsp;<span class="ident" id="1394480">err</span>&nbsp;<span class="op" id="1394484">==</span>&nbsp;<span class="ident" id="1394487">EOF</span>&nbsp;<span class="op" id="1394491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1394495">err</span>&nbsp;<span class="op" id="1394499">=</span>&nbsp;<span class="ident" id="1394501">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1394519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394522">return</span><br>
<span class="lineno"></span><span class="op" id="1394529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1394532">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1394590">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1394670">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1394718">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1394781">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1394819">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1394874">func</span>&nbsp;<span class="ident" id="1394879">ReadFull</span><span class="op" id="1394887">(</span><span class="ident" id="1394888">r</span>&nbsp;<span class="ident" id="1394890">Reader</span><span class="op" id="1394896">,</span>&nbsp;<span class="ident" id="1394898">buf</span>&nbsp;<span class="op" id="1394902">[</span><span class="op" id="1394903">]</span><span class="builtintype" id="1394904">byte</span><span class="op" id="1394908">)</span>&nbsp;<span class="op" id="1394910">(</span><span class="ident" id="1394911">n</span>&nbsp;<span class="builtintype" id="1394913">int</span><span class="op" id="1394916">,</span>&nbsp;<span class="ident" id="1394918">err</span>&nbsp;<span class="builtintype" id="1394922">error</span><span class="op" id="1394927">)</span>&nbsp;<span class="op" id="1394929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1394932">return</span>&nbsp;<span class="ident" id="1394939">ReadAtLeast</span><span class="op" id="1394950">(</span><span class="ident" id="1394951">r</span><span class="op" id="1394952">,</span>&nbsp;<span class="ident" id="1394954">buf</span><span class="op" id="1394957">,</span>&nbsp;<span class="builtinfunc" id="1394959">len</span><span class="op" id="1394962">(</span><span class="ident" id="1394963">buf</span><span class="op" id="1394966">)</span><span class="op" id="1394967">)</span><br>
<span class="lineno"></span><span class="op" id="1394969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1394972">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1395033">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1395091">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1395127">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1395181">//</span><br>
<span class="lineno"></span><span class="comment" id="1395184">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1395231">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1395268">func</span>&nbsp;<span class="ident" id="1395273">CopyN</span><span class="op" id="1395278">(</span><span class="ident" id="1395279">dst</span>&nbsp;<span class="ident" id="1395283">Writer</span><span class="op" id="1395289">,</span>&nbsp;<span class="ident" id="1395291">src</span>&nbsp;<span class="ident" id="1395295">Reader</span><span class="op" id="1395301">,</span>&nbsp;<span class="ident" id="1395303">n</span>&nbsp;<span class="ident" id="1395305">int64</span><span class="op" id="1395310">)</span>&nbsp;<span class="op" id="1395312">(</span><span class="ident" id="1395313">written</span>&nbsp;<span class="ident" id="1395321">int64</span><span class="op" id="1395326">,</span>&nbsp;<span class="ident" id="1395328">err</span>&nbsp;<span class="builtintype" id="1395332">error</span><span class="op" id="1395337">)</span>&nbsp;<span class="op" id="1395339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1395342">written</span><span class="op" id="1395349">,</span>&nbsp;<span class="ident" id="1395351">err</span>&nbsp;<span class="op" id="1395355">=</span>&nbsp;<span class="ident" id="1395357">Copy</span><span class="op" id="1395361">(</span><span class="ident" id="1395362">dst</span><span class="op" id="1395365">,</span>&nbsp;<span class="ident" id="1395367">LimitReader</span><span class="op" id="1395378">(</span><span class="ident" id="1395379">src</span><span class="op" id="1395382">,</span>&nbsp;<span class="ident" id="1395384">n</span><span class="op" id="1395385">)</span><span class="op" id="1395386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1395389">if</span>&nbsp;<span class="ident" id="1395392">written</span>&nbsp;<span class="op" id="1395400">==</span>&nbsp;<span class="ident" id="1395403">n</span>&nbsp;<span class="op" id="1395405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1395409">return</span>&nbsp;<span class="ident" id="1395416">n</span><span class="op" id="1395417">,</span>&nbsp;<span class="builtintype" id="1395419">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1395424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1395427">if</span>&nbsp;<span class="ident" id="1395430">written</span>&nbsp;<span class="op" id="1395438">&lt;</span>&nbsp;<span class="ident" id="1395440">n</span>&nbsp;<span class="op" id="1395442">&amp;&amp;</span>&nbsp;<span class="ident" id="1395445">err</span>&nbsp;<span class="op" id="1395449">==</span>&nbsp;<span class="builtintype" id="1395452">nil</span>&nbsp;<span class="op" id="1395456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1395460">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1395504">err</span>&nbsp;<span class="op" id="1395508">=</span>&nbsp;<span class="ident" id="1395510">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1395515">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1395518">return</span><br>
<span class="lineno"></span><span class="op" id="1395525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1395528">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1395587">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1395649">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1395714">//</span><br>
<span class="lineno"></span><span class="comment" id="1395717">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1395774">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1395837">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1395895">//</span><br>
<span class="lineno"></span><span class="comment" id="1395898">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1395943">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1395999">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1396057">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1396114">func</span>&nbsp;<span class="ident" id="1396119">Copy</span><span class="op" id="1396123">(</span><span class="ident" id="1396124">dst</span>&nbsp;<span class="ident" id="1396128">Writer</span><span class="op" id="1396134">,</span>&nbsp;<span class="ident" id="1396136">src</span>&nbsp;<span class="ident" id="1396140">Reader</span><span class="op" id="1396146">)</span>&nbsp;<span class="op" id="1396148">(</span><span class="ident" id="1396149">written</span>&nbsp;<span class="ident" id="1396157">int64</span><span class="op" id="1396162">,</span>&nbsp;<span class="ident" id="1396164">err</span>&nbsp;<span class="builtintype" id="1396168">error</span><span class="op" id="1396173">)</span>&nbsp;<span class="op" id="1396175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1396178">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1396241">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396278">if</span>&nbsp;<span class="ident" id="1396281">wt</span><span class="op" id="1396283">,</span>&nbsp;<span class="ident" id="1396285">ok</span>&nbsp;<span class="op" id="1396288">:=</span>&nbsp;<span class="ident" id="1396291">src</span><span class="op" id="1396294">.</span><span class="op" id="1396295">(</span><span class="ident" id="1396296">WriterTo</span><span class="op" id="1396304">)</span><span class="op" id="1396305">;</span>&nbsp;<span class="ident" id="1396307">ok</span>&nbsp;<span class="op" id="1396310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396314">return</span>&nbsp;<span class="ident" id="1396321">wt</span><span class="op" id="1396323">.</span><span class="ident" id="1396324">WriteTo</span><span class="op" id="1396331">(</span><span class="ident" id="1396332">dst</span><span class="op" id="1396335">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1396341">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396416">if</span>&nbsp;<span class="ident" id="1396419">rt</span><span class="op" id="1396421">,</span>&nbsp;<span class="ident" id="1396423">ok</span>&nbsp;<span class="op" id="1396426">:=</span>&nbsp;<span class="ident" id="1396429">dst</span><span class="op" id="1396432">.</span><span class="op" id="1396433">(</span><span class="ident" id="1396434">ReaderFrom</span><span class="op" id="1396444">)</span><span class="op" id="1396445">;</span>&nbsp;<span class="ident" id="1396447">ok</span>&nbsp;<span class="op" id="1396450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396454">return</span>&nbsp;<span class="ident" id="1396461">rt</span><span class="op" id="1396463">.</span><span class="ident" id="1396464">ReadFrom</span><span class="op" id="1396472">(</span><span class="ident" id="1396473">src</span><span class="op" id="1396476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396479">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396482">buf</span>&nbsp;<span class="op" id="1396486">:=</span>&nbsp;<span class="builtinfunc" id="1396489">make</span><span class="op" id="1396493">(</span><span class="op" id="1396494">[</span><span class="op" id="1396495">]</span><span class="builtintype" id="1396496">byte</span><span class="op" id="1396500">,</span>&nbsp;<span class="num" id="1396502">32</span><span class="op" id="1396504">*</span><span class="num" id="1396505">1024</span><span class="op" id="1396509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396512">for</span>&nbsp;<span class="op" id="1396516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396520">nr</span><span class="op" id="1396522">,</span>&nbsp;<span class="ident" id="1396524">er</span>&nbsp;<span class="op" id="1396527">:=</span>&nbsp;<span class="ident" id="1396530">src</span><span class="op" id="1396533">.</span><span class="ident" id="1396534">Read</span><span class="op" id="1396538">(</span><span class="ident" id="1396539">buf</span><span class="op" id="1396542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396546">if</span>&nbsp;<span class="ident" id="1396549">nr</span>&nbsp;<span class="op" id="1396552">&gt;</span>&nbsp;<span class="num" id="1396554">0</span>&nbsp;<span class="op" id="1396556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396561">nw</span><span class="op" id="1396563">,</span>&nbsp;<span class="ident" id="1396565">ew</span>&nbsp;<span class="op" id="1396568">:=</span>&nbsp;<span class="ident" id="1396571">dst</span><span class="op" id="1396574">.</span><span class="ident" id="1396575">Write</span><span class="op" id="1396580">(</span><span class="ident" id="1396581">buf</span><span class="op" id="1396584">[</span><span class="num" id="1396585">0</span><span class="op" id="1396586">:</span><span class="ident" id="1396587">nr</span><span class="op" id="1396589">]</span><span class="op" id="1396590">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396595">if</span>&nbsp;<span class="ident" id="1396598">nw</span>&nbsp;<span class="op" id="1396601">&gt;</span>&nbsp;<span class="num" id="1396603">0</span>&nbsp;<span class="op" id="1396605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396611">written</span>&nbsp;<span class="op" id="1396619">+=</span>&nbsp;<span class="ident" id="1396622">int64</span><span class="op" id="1396627">(</span><span class="ident" id="1396628">nw</span><span class="op" id="1396630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396640">if</span>&nbsp;<span class="ident" id="1396643">ew</span>&nbsp;<span class="op" id="1396646">!=</span>&nbsp;<span class="builtintype" id="1396649">nil</span>&nbsp;<span class="op" id="1396653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396659">err</span>&nbsp;<span class="op" id="1396663">=</span>&nbsp;<span class="ident" id="1396665">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396672">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396686">if</span>&nbsp;<span class="ident" id="1396689">nr</span>&nbsp;<span class="op" id="1396692">!=</span>&nbsp;<span class="ident" id="1396695">nw</span>&nbsp;<span class="op" id="1396698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396704">err</span>&nbsp;<span class="op" id="1396708">=</span>&nbsp;<span class="ident" id="1396710">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396728">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396745">if</span>&nbsp;<span class="ident" id="1396748">er</span>&nbsp;<span class="op" id="1396751">==</span>&nbsp;<span class="ident" id="1396754">EOF</span>&nbsp;<span class="op" id="1396758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396763">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396771">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396775">if</span>&nbsp;<span class="ident" id="1396778">er</span>&nbsp;<span class="op" id="1396781">!=</span>&nbsp;<span class="builtintype" id="1396784">nil</span>&nbsp;<span class="op" id="1396788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1396793">err</span>&nbsp;<span class="op" id="1396797">=</span>&nbsp;<span class="ident" id="1396799">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396805">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1396816">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1396819">return</span>&nbsp;<span class="ident" id="1396826">written</span><span class="op" id="1396833">,</span>&nbsp;<span class="ident" id="1396835">err</span><br>
<span class="lineno"></span><span class="op" id="1396839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1396842">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1396892">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1396929">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1396983">func</span>&nbsp;<span class="ident" id="1396988">LimitReader</span><span class="op" id="1396999">(</span><span class="ident" id="1397000">r</span>&nbsp;<span class="ident" id="1397002">Reader</span><span class="op" id="1397008">,</span>&nbsp;<span class="ident" id="1397010">n</span>&nbsp;<span class="ident" id="1397012">int64</span><span class="op" id="1397017">)</span>&nbsp;<span class="ident" id="1397019">Reader</span>&nbsp;<span class="op" id="1397026">{</span>&nbsp;<span class="keyword" id="1397028">return</span>&nbsp;<span class="op" id="1397035">&amp;</span><span class="ident" id="1397036">LimitedReader</span><span class="op" id="1397049">{</span><span class="ident" id="1397050">r</span><span class="op" id="1397051">,</span>&nbsp;<span class="ident" id="1397053">n</span><span class="op" id="1397054">}</span>&nbsp;<span class="op" id="1397056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1397059">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1397116">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1397168">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1397218">type</span>&nbsp;<span class="ident" id="1397223">LimitedReader</span>&nbsp;<span class="keyword" id="1397237">struct</span>&nbsp;<span class="op" id="1397244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397247">R</span>&nbsp;<span class="ident" id="1397249">Reader</span>&nbsp;<span class="comment" id="1397256">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397278">N</span>&nbsp;<span class="ident" id="1397280">int64</span>&nbsp;&nbsp;<span class="comment" id="1397287">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1397310">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1397313">func</span>&nbsp;<span class="op" id="1397318">(</span><span class="ident" id="1397319">l</span>&nbsp;<span class="op" id="1397321">*</span><span class="ident" id="1397322">LimitedReader</span><span class="op" id="1397335">)</span>&nbsp;<span class="ident" id="1397337">Read</span><span class="op" id="1397341">(</span><span class="ident" id="1397342">p</span>&nbsp;<span class="op" id="1397344">[</span><span class="op" id="1397345">]</span><span class="builtintype" id="1397346">byte</span><span class="op" id="1397350">)</span>&nbsp;<span class="op" id="1397352">(</span><span class="ident" id="1397353">n</span>&nbsp;<span class="builtintype" id="1397355">int</span><span class="op" id="1397358">,</span>&nbsp;<span class="ident" id="1397360">err</span>&nbsp;<span class="builtintype" id="1397364">error</span><span class="op" id="1397369">)</span>&nbsp;<span class="op" id="1397371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397374">if</span>&nbsp;<span class="ident" id="1397377">l</span><span class="op" id="1397378">.</span><span class="ident" id="1397379">N</span>&nbsp;<span class="op" id="1397381">&lt;=</span>&nbsp;<span class="num" id="1397384">0</span>&nbsp;<span class="op" id="1397386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397390">return</span>&nbsp;<span class="num" id="1397397">0</span><span class="op" id="1397398">,</span>&nbsp;<span class="ident" id="1397400">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1397405">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397408">if</span>&nbsp;<span class="ident" id="1397411">int64</span><span class="op" id="1397416">(</span><span class="builtinfunc" id="1397417">len</span><span class="op" id="1397420">(</span><span class="ident" id="1397421">p</span><span class="op" id="1397422">)</span><span class="op" id="1397423">)</span>&nbsp;<span class="op" id="1397425">&gt;</span>&nbsp;<span class="ident" id="1397427">l</span><span class="op" id="1397428">.</span><span class="ident" id="1397429">N</span>&nbsp;<span class="op" id="1397431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397435">p</span>&nbsp;<span class="op" id="1397437">=</span>&nbsp;<span class="ident" id="1397439">p</span><span class="op" id="1397440">[</span><span class="num" id="1397441">0</span><span class="op" id="1397442">:</span><span class="ident" id="1397443">l</span><span class="op" id="1397444">.</span><span class="ident" id="1397445">N</span><span class="op" id="1397446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1397449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397452">n</span><span class="op" id="1397453">,</span>&nbsp;<span class="ident" id="1397455">err</span>&nbsp;<span class="op" id="1397459">=</span>&nbsp;<span class="ident" id="1397461">l</span><span class="op" id="1397462">.</span><span class="ident" id="1397463">R</span><span class="op" id="1397464">.</span><span class="ident" id="1397465">Read</span><span class="op" id="1397469">(</span><span class="ident" id="1397470">p</span><span class="op" id="1397471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397474">l</span><span class="op" id="1397475">.</span><span class="ident" id="1397476">N</span>&nbsp;<span class="op" id="1397478">-=</span>&nbsp;<span class="ident" id="1397481">int64</span><span class="op" id="1397486">(</span><span class="ident" id="1397487">n</span><span class="op" id="1397488">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397491">return</span><br>
<span class="lineno"></span><span class="op" id="1397498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1397501">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1397563">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1397623">func</span>&nbsp;<span class="ident" id="1397628">NewSectionReader</span><span class="op" id="1397644">(</span><span class="ident" id="1397645">r</span>&nbsp;<span class="ident" id="1397647">ReaderAt</span><span class="op" id="1397655">,</span>&nbsp;<span class="ident" id="1397657">off</span>&nbsp;<span class="ident" id="1397661">int64</span><span class="op" id="1397666">,</span>&nbsp;<span class="ident" id="1397668">n</span>&nbsp;<span class="ident" id="1397670">int64</span><span class="op" id="1397675">)</span>&nbsp;<span class="op" id="1397677">*</span><span class="ident" id="1397678">SectionReader</span>&nbsp;<span class="op" id="1397692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397695">return</span>&nbsp;<span class="op" id="1397702">&amp;</span><span class="ident" id="1397703">SectionReader</span><span class="op" id="1397716">{</span><span class="ident" id="1397717">r</span><span class="op" id="1397718">,</span>&nbsp;<span class="ident" id="1397720">off</span><span class="op" id="1397723">,</span>&nbsp;<span class="ident" id="1397725">off</span><span class="op" id="1397728">,</span>&nbsp;<span class="ident" id="1397730">off</span>&nbsp;<span class="op" id="1397734">+</span>&nbsp;<span class="ident" id="1397736">n</span><span class="op" id="1397737">}</span><br>
<span class="lineno"></span><span class="op" id="1397739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1397742">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1397806">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1397836">type</span>&nbsp;<span class="ident" id="1397841">SectionReader</span>&nbsp;<span class="keyword" id="1397855">struct</span>&nbsp;<span class="op" id="1397862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397865">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397871">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397881">base</span>&nbsp;&nbsp;<span class="ident" id="1397887">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397894">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1397900">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1397907">limit</span>&nbsp;<span class="ident" id="1397913">int64</span><br>
<span class="lineno"></span><span class="op" id="1397919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1397922">func</span>&nbsp;<span class="op" id="1397927">(</span><span class="ident" id="1397928">s</span>&nbsp;<span class="op" id="1397930">*</span><span class="ident" id="1397931">SectionReader</span><span class="op" id="1397944">)</span>&nbsp;<span class="ident" id="1397946">Read</span><span class="op" id="1397950">(</span><span class="ident" id="1397951">p</span>&nbsp;<span class="op" id="1397953">[</span><span class="op" id="1397954">]</span><span class="builtintype" id="1397955">byte</span><span class="op" id="1397959">)</span>&nbsp;<span class="op" id="1397961">(</span><span class="ident" id="1397962">n</span>&nbsp;<span class="builtintype" id="1397964">int</span><span class="op" id="1397967">,</span>&nbsp;<span class="ident" id="1397969">err</span>&nbsp;<span class="builtintype" id="1397973">error</span><span class="op" id="1397978">)</span>&nbsp;<span class="op" id="1397980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1397983">if</span>&nbsp;<span class="ident" id="1397986">s</span><span class="op" id="1397987">.</span><span class="ident" id="1397988">off</span>&nbsp;<span class="op" id="1397992">&gt;=</span>&nbsp;<span class="ident" id="1397995">s</span><span class="op" id="1397996">.</span><span class="ident" id="1397997">limit</span>&nbsp;<span class="op" id="1398003">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398007">return</span>&nbsp;<span class="num" id="1398014">0</span><span class="op" id="1398015">,</span>&nbsp;<span class="ident" id="1398017">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398025">if</span>&nbsp;<span class="ident" id="1398028">max</span>&nbsp;<span class="op" id="1398032">:=</span>&nbsp;<span class="ident" id="1398035">s</span><span class="op" id="1398036">.</span><span class="ident" id="1398037">limit</span>&nbsp;<span class="op" id="1398043">-</span>&nbsp;<span class="ident" id="1398045">s</span><span class="op" id="1398046">.</span><span class="ident" id="1398047">off</span><span class="op" id="1398050">;</span>&nbsp;<span class="ident" id="1398052">int64</span><span class="op" id="1398057">(</span><span class="builtinfunc" id="1398058">len</span><span class="op" id="1398061">(</span><span class="ident" id="1398062">p</span><span class="op" id="1398063">)</span><span class="op" id="1398064">)</span>&nbsp;<span class="op" id="1398066">&gt;</span>&nbsp;<span class="ident" id="1398068">max</span>&nbsp;<span class="op" id="1398072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398076">p</span>&nbsp;<span class="op" id="1398078">=</span>&nbsp;<span class="ident" id="1398080">p</span><span class="op" id="1398081">[</span><span class="num" id="1398082">0</span><span class="op" id="1398083">:</span><span class="ident" id="1398084">max</span><span class="op" id="1398087">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398090">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398093">n</span><span class="op" id="1398094">,</span>&nbsp;<span class="ident" id="1398096">err</span>&nbsp;<span class="op" id="1398100">=</span>&nbsp;<span class="ident" id="1398102">s</span><span class="op" id="1398103">.</span><span class="ident" id="1398104">r</span><span class="op" id="1398105">.</span><span class="ident" id="1398106">ReadAt</span><span class="op" id="1398112">(</span><span class="ident" id="1398113">p</span><span class="op" id="1398114">,</span>&nbsp;<span class="ident" id="1398116">s</span><span class="op" id="1398117">.</span><span class="ident" id="1398118">off</span><span class="op" id="1398121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398124">s</span><span class="op" id="1398125">.</span><span class="ident" id="1398126">off</span>&nbsp;<span class="op" id="1398130">+=</span>&nbsp;<span class="ident" id="1398133">int64</span><span class="op" id="1398138">(</span><span class="ident" id="1398139">n</span><span class="op" id="1398140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398143">return</span><br>
<span class="lineno"></span><span class="op" id="1398150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1398153">var</span>&nbsp;<span class="ident" id="1398157">errWhence</span>&nbsp;<span class="op" id="1398167">=</span>&nbsp;<span class="ident" id="1398169">errors</span><span class="op" id="1398175">.</span><span class="ident" id="1398176">New</span><span class="op" id="1398179">(</span><span class="string" id="1398180">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1398202">)</span><br>
<span class="lineno"></span><span class="keyword" id="1398204">var</span>&nbsp;<span class="ident" id="1398208">errOffset</span>&nbsp;<span class="op" id="1398218">=</span>&nbsp;<span class="ident" id="1398220">errors</span><span class="op" id="1398226">.</span><span class="ident" id="1398227">New</span><span class="op" id="1398230">(</span><span class="string" id="1398231">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1398253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1398256">func</span>&nbsp;<span class="op" id="1398261">(</span><span class="ident" id="1398262">s</span>&nbsp;<span class="op" id="1398264">*</span><span class="ident" id="1398265">SectionReader</span><span class="op" id="1398278">)</span>&nbsp;<span class="ident" id="1398280">Seek</span><span class="op" id="1398284">(</span><span class="ident" id="1398285">offset</span>&nbsp;<span class="ident" id="1398292">int64</span><span class="op" id="1398297">,</span>&nbsp;<span class="ident" id="1398299">whence</span>&nbsp;<span class="builtintype" id="1398306">int</span><span class="op" id="1398309">)</span>&nbsp;<span class="op" id="1398311">(</span><span class="ident" id="1398312">int64</span><span class="op" id="1398317">,</span>&nbsp;<span class="builtintype" id="1398319">error</span><span class="op" id="1398324">)</span>&nbsp;<span class="op" id="1398326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398329">switch</span>&nbsp;<span class="ident" id="1398336">whence</span>&nbsp;<span class="op" id="1398343">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398346">default</span><span class="op" id="1398353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398357">return</span>&nbsp;<span class="num" id="1398364">0</span><span class="op" id="1398365">,</span>&nbsp;<span class="ident" id="1398367">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398378">case</span>&nbsp;<span class="num" id="1398383">0</span><span class="op" id="1398384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398388">offset</span>&nbsp;<span class="op" id="1398395">+=</span>&nbsp;<span class="ident" id="1398398">s</span><span class="op" id="1398399">.</span><span class="ident" id="1398400">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398406">case</span>&nbsp;<span class="num" id="1398411">1</span><span class="op" id="1398412">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398416">offset</span>&nbsp;<span class="op" id="1398423">+=</span>&nbsp;<span class="ident" id="1398426">s</span><span class="op" id="1398427">.</span><span class="ident" id="1398428">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398433">case</span>&nbsp;<span class="num" id="1398438">2</span><span class="op" id="1398439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398443">offset</span>&nbsp;<span class="op" id="1398450">+=</span>&nbsp;<span class="ident" id="1398453">s</span><span class="op" id="1398454">.</span><span class="ident" id="1398455">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398465">if</span>&nbsp;<span class="ident" id="1398468">offset</span>&nbsp;<span class="op" id="1398475">&lt;</span>&nbsp;<span class="ident" id="1398477">s</span><span class="op" id="1398478">.</span><span class="ident" id="1398479">base</span>&nbsp;<span class="op" id="1398484">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398488">return</span>&nbsp;<span class="num" id="1398495">0</span><span class="op" id="1398496">,</span>&nbsp;<span class="ident" id="1398498">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398512">s</span><span class="op" id="1398513">.</span><span class="ident" id="1398514">off</span>&nbsp;<span class="op" id="1398518">=</span>&nbsp;<span class="ident" id="1398520">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398528">return</span>&nbsp;<span class="ident" id="1398535">offset</span>&nbsp;<span class="op" id="1398542">-</span>&nbsp;<span class="ident" id="1398544">s</span><span class="op" id="1398545">.</span><span class="ident" id="1398546">base</span><span class="op" id="1398550">,</span>&nbsp;<span class="builtintype" id="1398552">nil</span><br>
<span class="lineno"></span><span class="op" id="1398556">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1398559">func</span>&nbsp;<span class="op" id="1398564">(</span><span class="ident" id="1398565">s</span>&nbsp;<span class="op" id="1398567">*</span><span class="ident" id="1398568">SectionReader</span><span class="op" id="1398581">)</span>&nbsp;<span class="ident" id="1398583">ReadAt</span><span class="op" id="1398589">(</span><span class="ident" id="1398590">p</span>&nbsp;<span class="op" id="1398592">[</span><span class="op" id="1398593">]</span><span class="builtintype" id="1398594">byte</span><span class="op" id="1398598">,</span>&nbsp;<span class="ident" id="1398600">off</span>&nbsp;<span class="ident" id="1398604">int64</span><span class="op" id="1398609">)</span>&nbsp;<span class="op" id="1398611">(</span><span class="ident" id="1398612">n</span>&nbsp;<span class="builtintype" id="1398614">int</span><span class="op" id="1398617">,</span>&nbsp;<span class="ident" id="1398619">err</span>&nbsp;<span class="builtintype" id="1398623">error</span><span class="op" id="1398628">)</span>&nbsp;<span class="op" id="1398630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398633">if</span>&nbsp;<span class="ident" id="1398636">off</span>&nbsp;<span class="op" id="1398640">&lt;</span>&nbsp;<span class="num" id="1398642">0</span>&nbsp;<span class="op" id="1398644">||</span>&nbsp;<span class="ident" id="1398647">off</span>&nbsp;<span class="op" id="1398651">&gt;=</span>&nbsp;<span class="ident" id="1398654">s</span><span class="op" id="1398655">.</span><span class="ident" id="1398656">limit</span><span class="op" id="1398661">-</span><span class="ident" id="1398662">s</span><span class="op" id="1398663">.</span><span class="ident" id="1398664">base</span>&nbsp;<span class="op" id="1398669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398673">return</span>&nbsp;<span class="num" id="1398680">0</span><span class="op" id="1398681">,</span>&nbsp;<span class="ident" id="1398683">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398688">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398691">off</span>&nbsp;<span class="op" id="1398695">+=</span>&nbsp;<span class="ident" id="1398698">s</span><span class="op" id="1398699">.</span><span class="ident" id="1398700">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398706">if</span>&nbsp;<span class="ident" id="1398709">max</span>&nbsp;<span class="op" id="1398713">:=</span>&nbsp;<span class="ident" id="1398716">s</span><span class="op" id="1398717">.</span><span class="ident" id="1398718">limit</span>&nbsp;<span class="op" id="1398724">-</span>&nbsp;<span class="ident" id="1398726">off</span><span class="op" id="1398729">;</span>&nbsp;<span class="ident" id="1398731">int64</span><span class="op" id="1398736">(</span><span class="builtinfunc" id="1398737">len</span><span class="op" id="1398740">(</span><span class="ident" id="1398741">p</span><span class="op" id="1398742">)</span><span class="op" id="1398743">)</span>&nbsp;<span class="op" id="1398745">&gt;</span>&nbsp;<span class="ident" id="1398747">max</span>&nbsp;<span class="op" id="1398751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398755">p</span>&nbsp;<span class="op" id="1398757">=</span>&nbsp;<span class="ident" id="1398759">p</span><span class="op" id="1398760">[</span><span class="num" id="1398761">0</span><span class="op" id="1398762">:</span><span class="ident" id="1398763">max</span><span class="op" id="1398766">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398770">n</span><span class="op" id="1398771">,</span>&nbsp;<span class="ident" id="1398773">err</span>&nbsp;<span class="op" id="1398777">=</span>&nbsp;<span class="ident" id="1398779">s</span><span class="op" id="1398780">.</span><span class="ident" id="1398781">r</span><span class="op" id="1398782">.</span><span class="ident" id="1398783">ReadAt</span><span class="op" id="1398789">(</span><span class="ident" id="1398790">p</span><span class="op" id="1398791">,</span>&nbsp;<span class="ident" id="1398793">off</span><span class="op" id="1398796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398800">if</span>&nbsp;<span class="ident" id="1398803">err</span>&nbsp;<span class="op" id="1398807">==</span>&nbsp;<span class="builtintype" id="1398810">nil</span>&nbsp;<span class="op" id="1398814">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1398819">err</span>&nbsp;<span class="op" id="1398823">=</span>&nbsp;<span class="ident" id="1398825">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398835">return</span>&nbsp;<span class="ident" id="1398842">n</span><span class="op" id="1398843">,</span>&nbsp;<span class="ident" id="1398845">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1398850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1398853">return</span>&nbsp;<span class="ident" id="1398860">s</span><span class="op" id="1398861">.</span><span class="ident" id="1398862">r</span><span class="op" id="1398863">.</span><span class="ident" id="1398864">ReadAt</span><span class="op" id="1398870">(</span><span class="ident" id="1398871">p</span><span class="op" id="1398872">,</span>&nbsp;<span class="ident" id="1398874">off</span><span class="op" id="1398877">)</span><br>
<span class="lineno">475</span><span class="op" id="1398879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1398882">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1398932">func</span>&nbsp;<span class="op" id="1398937">(</span><span class="ident" id="1398938">s</span>&nbsp;<span class="op" id="1398940">*</span><span class="ident" id="1398941">SectionReader</span><span class="op" id="1398954">)</span>&nbsp;<span class="ident" id="1398956">Size</span><span class="op" id="1398960">(</span><span class="op" id="1398961">)</span>&nbsp;<span class="ident" id="1398963">int64</span>&nbsp;<span class="op" id="1398969">{</span>&nbsp;<span class="keyword" id="1398971">return</span>&nbsp;<span class="ident" id="1398978">s</span><span class="op" id="1398979">.</span><span class="ident" id="1398980">limit</span>&nbsp;<span class="op" id="1398986">-</span>&nbsp;<span class="ident" id="1398988">s</span><span class="op" id="1398989">.</span><span class="ident" id="1398990">base</span>&nbsp;<span class="op" id="1398995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1398998">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1399067">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1399125">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1399189">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1399243">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1399311">func</span>&nbsp;<span class="ident" id="1399316">TeeReader</span><span class="op" id="1399325">(</span><span class="ident" id="1399326">r</span>&nbsp;<span class="ident" id="1399328">Reader</span><span class="op" id="1399334">,</span>&nbsp;<span class="ident" id="1399336">w</span>&nbsp;<span class="ident" id="1399338">Writer</span><span class="op" id="1399344">)</span>&nbsp;<span class="ident" id="1399346">Reader</span>&nbsp;<span class="op" id="1399353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1399356">return</span>&nbsp;<span class="op" id="1399363">&amp;</span><span class="ident" id="1399364">teeReader</span><span class="op" id="1399373">{</span><span class="ident" id="1399374">r</span><span class="op" id="1399375">,</span>&nbsp;<span class="ident" id="1399377">w</span><span class="op" id="1399378">}</span><br>
<span class="lineno"></span><span class="op" id="1399380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1399383">type</span>&nbsp;<span class="ident" id="1399388">teeReader</span>&nbsp;<span class="keyword" id="1399398">struct</span>&nbsp;<span class="op" id="1399405">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1399408">r</span>&nbsp;<span class="ident" id="1399410">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1399418">w</span>&nbsp;<span class="ident" id="1399420">Writer</span><br>
<span class="lineno"></span><span class="op" id="1399427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1399430">func</span>&nbsp;<span class="op" id="1399435">(</span><span class="ident" id="1399436">t</span>&nbsp;<span class="op" id="1399438">*</span><span class="ident" id="1399439">teeReader</span><span class="op" id="1399448">)</span>&nbsp;<span class="ident" id="1399450">Read</span><span class="op" id="1399454">(</span><span class="ident" id="1399455">p</span>&nbsp;<span class="op" id="1399457">[</span><span class="op" id="1399458">]</span><span class="builtintype" id="1399459">byte</span><span class="op" id="1399463">)</span>&nbsp;<span class="op" id="1399465">(</span><span class="ident" id="1399466">n</span>&nbsp;<span class="builtintype" id="1399468">int</span><span class="op" id="1399471">,</span>&nbsp;<span class="ident" id="1399473">err</span>&nbsp;<span class="builtintype" id="1399477">error</span><span class="op" id="1399482">)</span>&nbsp;<span class="op" id="1399484">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1399487">n</span><span class="op" id="1399488">,</span>&nbsp;<span class="ident" id="1399490">err</span>&nbsp;<span class="op" id="1399494">=</span>&nbsp;<span class="ident" id="1399496">t</span><span class="op" id="1399497">.</span><span class="ident" id="1399498">r</span><span class="op" id="1399499">.</span><span class="ident" id="1399500">Read</span><span class="op" id="1399504">(</span><span class="ident" id="1399505">p</span><span class="op" id="1399506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1399509">if</span>&nbsp;<span class="ident" id="1399512">n</span>&nbsp;<span class="op" id="1399514">&gt;</span>&nbsp;<span class="num" id="1399516">0</span>&nbsp;<span class="op" id="1399518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1399522">if</span>&nbsp;<span class="ident" id="1399525">n</span><span class="op" id="1399526">,</span>&nbsp;<span class="ident" id="1399528">err</span>&nbsp;<span class="op" id="1399532">:=</span>&nbsp;<span class="ident" id="1399535">t</span><span class="op" id="1399536">.</span><span class="ident" id="1399537">w</span><span class="op" id="1399538">.</span><span class="ident" id="1399539">Write</span><span class="op" id="1399544">(</span><span class="ident" id="1399545">p</span><span class="op" id="1399546">[</span><span class="op" id="1399547">:</span><span class="ident" id="1399548">n</span><span class="op" id="1399549">]</span><span class="op" id="1399550">)</span><span class="op" id="1399551">;</span>&nbsp;<span class="ident" id="1399553">err</span>&nbsp;<span class="op" id="1399557">!=</span>&nbsp;<span class="builtintype" id="1399560">nil</span>&nbsp;<span class="op" id="1399564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1399569">return</span>&nbsp;<span class="ident" id="1399576">n</span><span class="op" id="1399577">,</span>&nbsp;<span class="ident" id="1399579">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1399585">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1399588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1399591">return</span><br>
<span class="lineno"></span><span class="op" id="1399598">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
