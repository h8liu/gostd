<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html" class="current">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3582727">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3582782">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3582836">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3582887">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3582911">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3582966">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3583019">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3583075">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3583109">package</span>&nbsp;<span class="ident" id="3583117">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3583125">type</span>&nbsp;<span class="ident" id="3583130">ctr</span>&nbsp;<span class="keyword" id="3583134">struct</span>&nbsp;<span class="op" id="3583141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583144">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583152">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583159">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583167">[</span><span class="op" id="3583168">]</span><span class="builtintype" id="3583169">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583175">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583183">[</span><span class="op" id="3583184">]</span><span class="builtintype" id="3583185">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583191">outUsed</span>&nbsp;<span class="builtintype" id="3583199">int</span><br>
<span class="lineno">20</span><span class="op" id="3583203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3583206">const</span>&nbsp;<span class="ident" id="3583212">streamBufferSize</span>&nbsp;<span class="op" id="3583229">=</span>&nbsp;<span class="num" id="3583231">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3583236">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3583312">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3583390">func</span>&nbsp;<span class="ident" id="3583395">NewCTR</span><span class="op" id="3583401">(</span><span class="ident" id="3583402">block</span>&nbsp;<span class="ident" id="3583408">Block</span><span class="op" id="3583413">,</span>&nbsp;<span class="ident" id="3583415">iv</span>&nbsp;<span class="op" id="3583418">[</span><span class="op" id="3583419">]</span><span class="builtintype" id="3583420">byte</span><span class="op" id="3583424">)</span>&nbsp;<span class="ident" id="3583426">Stream</span>&nbsp;<span class="op" id="3583433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583436">if</span>&nbsp;<span class="builtinfunc" id="3583439">len</span><span class="op" id="3583442">(</span><span class="ident" id="3583443">iv</span><span class="op" id="3583445">)</span>&nbsp;<span class="op" id="3583447">!=</span>&nbsp;<span class="ident" id="3583450">block</span><span class="op" id="3583455">.</span><span class="ident" id="3583456">BlockSize</span><span class="op" id="3583465">(</span><span class="op" id="3583466">)</span>&nbsp;<span class="op" id="3583468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3583472">panic</span><span class="op" id="3583477">(</span><span class="string" id="3583478">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3583526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583529">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583532">bufSize</span>&nbsp;<span class="op" id="3583540">:=</span>&nbsp;<span class="ident" id="3583543">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583561">if</span>&nbsp;<span class="ident" id="3583564">bufSize</span>&nbsp;<span class="op" id="3583572">&lt;</span>&nbsp;<span class="ident" id="3583574">block</span><span class="op" id="3583579">.</span><span class="ident" id="3583580">BlockSize</span><span class="op" id="3583589">(</span><span class="op" id="3583590">)</span>&nbsp;<span class="op" id="3583592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583596">bufSize</span>&nbsp;<span class="op" id="3583604">=</span>&nbsp;<span class="ident" id="3583606">block</span><span class="op" id="3583611">.</span><span class="ident" id="3583612">BlockSize</span><span class="op" id="3583621">(</span><span class="op" id="3583622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583628">return</span>&nbsp;<span class="op" id="3583635">&amp;</span><span class="ident" id="3583636">ctr</span><span class="op" id="3583639">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583643">b</span><span class="op" id="3583644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583652">block</span><span class="op" id="3583657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583661">ctr</span><span class="op" id="3583664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583670">dup</span><span class="op" id="3583673">(</span><span class="ident" id="3583674">iv</span><span class="op" id="3583676">)</span><span class="op" id="3583677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583681">out</span><span class="op" id="3583684">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3583690">make</span><span class="op" id="3583694">(</span><span class="op" id="3583695">[</span><span class="op" id="3583696">]</span><span class="builtintype" id="3583697">byte</span><span class="op" id="3583701">,</span>&nbsp;<span class="num" id="3583703">0</span><span class="op" id="3583704">,</span>&nbsp;<span class="ident" id="3583706">bufSize</span><span class="op" id="3583713">)</span><span class="op" id="3583714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583718">outUsed</span><span class="op" id="3583725">:</span>&nbsp;<span class="num" id="3583727">0</span><span class="op" id="3583728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583731">}</span><br>
<span class="lineno">40</span><span class="op" id="3583733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3583736">func</span>&nbsp;<span class="op" id="3583741">(</span><span class="ident" id="3583742">x</span>&nbsp;<span class="op" id="3583744">*</span><span class="ident" id="3583745">ctr</span><span class="op" id="3583748">)</span>&nbsp;<span class="ident" id="3583750">refill</span><span class="op" id="3583756">(</span><span class="op" id="3583757">)</span>&nbsp;<span class="op" id="3583759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583762">remain</span>&nbsp;<span class="op" id="3583769">:=</span>&nbsp;<span class="builtinfunc" id="3583772">len</span><span class="op" id="3583775">(</span><span class="ident" id="3583776">x</span><span class="op" id="3583777">.</span><span class="ident" id="3583778">out</span><span class="op" id="3583781">)</span>&nbsp;<span class="op" id="3583783">-</span>&nbsp;<span class="ident" id="3583785">x</span><span class="op" id="3583786">.</span><span class="ident" id="3583787">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583796">if</span>&nbsp;<span class="ident" id="3583799">remain</span>&nbsp;<span class="op" id="3583806">&gt;</span>&nbsp;<span class="ident" id="3583808">x</span><span class="op" id="3583809">.</span><span class="ident" id="3583810">outUsed</span>&nbsp;<span class="op" id="3583818">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583822">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3583830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3583833">copy</span><span class="op" id="3583837">(</span><span class="ident" id="3583838">x</span><span class="op" id="3583839">.</span><span class="ident" id="3583840">out</span><span class="op" id="3583843">,</span>&nbsp;<span class="ident" id="3583845">x</span><span class="op" id="3583846">.</span><span class="ident" id="3583847">out</span><span class="op" id="3583850">[</span><span class="ident" id="3583851">x</span><span class="op" id="3583852">.</span><span class="ident" id="3583853">outUsed</span><span class="op" id="3583860">:</span><span class="op" id="3583861">]</span><span class="op" id="3583862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583865">x</span><span class="op" id="3583866">.</span><span class="ident" id="3583867">out</span>&nbsp;<span class="op" id="3583871">=</span>&nbsp;<span class="ident" id="3583873">x</span><span class="op" id="3583874">.</span><span class="ident" id="3583875">out</span><span class="op" id="3583878">[</span><span class="op" id="3583879">:</span><span class="builtinfunc" id="3583880">cap</span><span class="op" id="3583883">(</span><span class="ident" id="3583884">x</span><span class="op" id="3583885">.</span><span class="ident" id="3583886">out</span><span class="op" id="3583889">)</span><span class="op" id="3583890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583893">bs</span>&nbsp;<span class="op" id="3583896">:=</span>&nbsp;<span class="ident" id="3583899">x</span><span class="op" id="3583900">.</span><span class="ident" id="3583901">b</span><span class="op" id="3583902">.</span><span class="ident" id="3583903">BlockSize</span><span class="op" id="3583912">(</span><span class="op" id="3583913">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3583916">for</span>&nbsp;<span class="ident" id="3583920">remain</span>&nbsp;<span class="op" id="3583927">&lt;</span>&nbsp;<span class="builtinfunc" id="3583929">len</span><span class="op" id="3583932">(</span><span class="ident" id="3583933">x</span><span class="op" id="3583934">.</span><span class="ident" id="3583935">out</span><span class="op" id="3583938">)</span><span class="op" id="3583939">-</span><span class="ident" id="3583940">bs</span>&nbsp;<span class="op" id="3583943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583947">x</span><span class="op" id="3583948">.</span><span class="ident" id="3583949">b</span><span class="op" id="3583950">.</span><span class="ident" id="3583951">Encrypt</span><span class="op" id="3583958">(</span><span class="ident" id="3583959">x</span><span class="op" id="3583960">.</span><span class="ident" id="3583961">out</span><span class="op" id="3583964">[</span><span class="ident" id="3583965">remain</span><span class="op" id="3583971">:</span><span class="op" id="3583972">]</span><span class="op" id="3583973">,</span>&nbsp;<span class="ident" id="3583975">x</span><span class="op" id="3583976">.</span><span class="ident" id="3583977">ctr</span><span class="op" id="3583980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3583984">remain</span>&nbsp;<span class="op" id="3583991">+=</span>&nbsp;<span class="ident" id="3583994">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3584000">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3584023">for</span>&nbsp;<span class="ident" id="3584027">i</span>&nbsp;<span class="op" id="3584029">:=</span>&nbsp;<span class="builtinfunc" id="3584032">len</span><span class="op" id="3584035">(</span><span class="ident" id="3584036">x</span><span class="op" id="3584037">.</span><span class="ident" id="3584038">ctr</span><span class="op" id="3584041">)</span>&nbsp;<span class="op" id="3584043">-</span>&nbsp;<span class="num" id="3584045">1</span><span class="op" id="3584046">;</span>&nbsp;<span class="ident" id="3584048">i</span>&nbsp;<span class="op" id="3584050">&gt;=</span>&nbsp;<span class="num" id="3584053">0</span><span class="op" id="3584054">;</span>&nbsp;<span class="ident" id="3584056">i</span><span class="op" id="3584057">--</span>&nbsp;<span class="op" id="3584060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584065">x</span><span class="op" id="3584066">.</span><span class="ident" id="3584067">ctr</span><span class="op" id="3584070">[</span><span class="ident" id="3584071">i</span><span class="op" id="3584072">]</span><span class="op" id="3584073">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3584079">if</span>&nbsp;<span class="ident" id="3584082">x</span><span class="op" id="3584083">.</span><span class="ident" id="3584084">ctr</span><span class="op" id="3584087">[</span><span class="ident" id="3584088">i</span><span class="op" id="3584089">]</span>&nbsp;<span class="op" id="3584091">!=</span>&nbsp;<span class="num" id="3584094">0</span>&nbsp;<span class="op" id="3584096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3584102">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3584111">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3584115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3584118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584121">x</span><span class="op" id="3584122">.</span><span class="ident" id="3584123">out</span>&nbsp;<span class="op" id="3584127">=</span>&nbsp;<span class="ident" id="3584129">x</span><span class="op" id="3584130">.</span><span class="ident" id="3584131">out</span><span class="op" id="3584134">[</span><span class="op" id="3584135">:</span><span class="ident" id="3584136">remain</span><span class="op" id="3584142">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584145">x</span><span class="op" id="3584146">.</span><span class="ident" id="3584147">outUsed</span>&nbsp;<span class="op" id="3584155">=</span>&nbsp;<span class="num" id="3584157">0</span><br>
<span class="lineno"></span><span class="op" id="3584159">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3584162">func</span>&nbsp;<span class="op" id="3584167">(</span><span class="ident" id="3584168">x</span>&nbsp;<span class="op" id="3584170">*</span><span class="ident" id="3584171">ctr</span><span class="op" id="3584174">)</span>&nbsp;<span class="ident" id="3584176">XORKeyStream</span><span class="op" id="3584188">(</span><span class="ident" id="3584189">dst</span><span class="op" id="3584192">,</span>&nbsp;<span class="ident" id="3584194">src</span>&nbsp;<span class="op" id="3584198">[</span><span class="op" id="3584199">]</span><span class="builtintype" id="3584200">byte</span><span class="op" id="3584204">)</span>&nbsp;<span class="op" id="3584206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3584209">for</span>&nbsp;<span class="builtinfunc" id="3584213">len</span><span class="op" id="3584216">(</span><span class="ident" id="3584217">src</span><span class="op" id="3584220">)</span>&nbsp;<span class="op" id="3584222">&gt;</span>&nbsp;<span class="num" id="3584224">0</span>&nbsp;<span class="op" id="3584226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3584230">if</span>&nbsp;<span class="ident" id="3584233">x</span><span class="op" id="3584234">.</span><span class="ident" id="3584235">outUsed</span>&nbsp;<span class="op" id="3584243">&gt;=</span>&nbsp;<span class="builtinfunc" id="3584246">len</span><span class="op" id="3584249">(</span><span class="ident" id="3584250">x</span><span class="op" id="3584251">.</span><span class="ident" id="3584252">out</span><span class="op" id="3584255">)</span><span class="op" id="3584256">-</span><span class="ident" id="3584257">x</span><span class="op" id="3584258">.</span><span class="ident" id="3584259">b</span><span class="op" id="3584260">.</span><span class="ident" id="3584261">BlockSize</span><span class="op" id="3584270">(</span><span class="op" id="3584271">)</span>&nbsp;<span class="op" id="3584273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584278">x</span><span class="op" id="3584279">.</span><span class="ident" id="3584280">refill</span><span class="op" id="3584286">(</span><span class="op" id="3584287">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3584291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584295">n</span>&nbsp;<span class="op" id="3584297">:=</span>&nbsp;<span class="ident" id="3584300">xorBytes</span><span class="op" id="3584308">(</span><span class="ident" id="3584309">dst</span><span class="op" id="3584312">,</span>&nbsp;<span class="ident" id="3584314">src</span><span class="op" id="3584317">,</span>&nbsp;<span class="ident" id="3584319">x</span><span class="op" id="3584320">.</span><span class="ident" id="3584321">out</span><span class="op" id="3584324">[</span><span class="ident" id="3584325">x</span><span class="op" id="3584326">.</span><span class="ident" id="3584327">outUsed</span><span class="op" id="3584334">:</span><span class="op" id="3584335">]</span><span class="op" id="3584336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584340">dst</span>&nbsp;<span class="op" id="3584344">=</span>&nbsp;<span class="ident" id="3584346">dst</span><span class="op" id="3584349">[</span><span class="ident" id="3584350">n</span><span class="op" id="3584351">:</span><span class="op" id="3584352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584356">src</span>&nbsp;<span class="op" id="3584360">=</span>&nbsp;<span class="ident" id="3584362">src</span><span class="op" id="3584365">[</span><span class="ident" id="3584366">n</span><span class="op" id="3584367">:</span><span class="op" id="3584368">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584372">x</span><span class="op" id="3584373">.</span><span class="ident" id="3584374">outUsed</span>&nbsp;<span class="op" id="3584382">+=</span>&nbsp;<span class="ident" id="3584385">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3584388">}</span><br>
<span class="lineno"></span><span class="op" id="3584390">}</span>
</div>
</body>
</html>
