<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8194291">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8194346">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8194400">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8194451">package</span>&nbsp;<span class="ident" id="8194459">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8194466">import</span>&nbsp;<span class="op" id="8194473">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194476">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194485">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194503">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194522">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194537">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194552">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194569">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194586">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194602">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194610">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194616">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194628">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194634">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8194645">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8194655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8194658">func</span>&nbsp;<span class="ident" id="8194663">testKeyGeneration</span><span class="op" id="8194680">(</span><span class="ident" id="8194681">t</span>&nbsp;<span class="op" id="8194683">*</span><span class="ident" id="8194684">testing</span><span class="op" id="8194691">.</span><span class="ident" id="8194692">T</span><span class="op" id="8194693">,</span>&nbsp;<span class="ident" id="8194695">c</span>&nbsp;<span class="ident" id="8194697">elliptic</span><span class="op" id="8194705">.</span><span class="ident" id="8194706">Curve</span><span class="op" id="8194711">,</span>&nbsp;<span class="ident" id="8194713">tag</span>&nbsp;<span class="builtintype" id="8194717">string</span><span class="op" id="8194723">)</span>&nbsp;<span class="op" id="8194725">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194728">priv</span><span class="op" id="8194732">,</span>&nbsp;<span class="ident" id="8194734">err</span>&nbsp;<span class="op" id="8194738">:=</span>&nbsp;<span class="ident" id="8194741">GenerateKey</span><span class="op" id="8194752">(</span><span class="ident" id="8194753">c</span><span class="op" id="8194754">,</span>&nbsp;<span class="ident" id="8194756">rand</span><span class="op" id="8194760">.</span><span class="ident" id="8194761">Reader</span><span class="op" id="8194767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194770">if</span>&nbsp;<span class="ident" id="8194773">err</span>&nbsp;<span class="op" id="8194777">!=</span>&nbsp;<span class="builtintype" id="8194780">nil</span>&nbsp;<span class="op" id="8194784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194788">t</span><span class="op" id="8194789">.</span><span class="ident" id="8194790">Errorf</span><span class="op" id="8194796">(</span><span class="string" id="8194797">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8194812">,</span>&nbsp;<span class="ident" id="8194814">tag</span><span class="op" id="8194817">,</span>&nbsp;<span class="ident" id="8194819">err</span><span class="op" id="8194822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194826">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194834">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194837">if</span>&nbsp;<span class="op" id="8194840">!</span><span class="ident" id="8194841">c</span><span class="op" id="8194842">.</span><span class="ident" id="8194843">IsOnCurve</span><span class="op" id="8194852">(</span><span class="ident" id="8194853">priv</span><span class="op" id="8194857">.</span><span class="ident" id="8194858">PublicKey</span><span class="op" id="8194867">.</span><span class="ident" id="8194868">X</span><span class="op" id="8194869">,</span>&nbsp;<span class="ident" id="8194871">priv</span><span class="op" id="8194875">.</span><span class="ident" id="8194876">PublicKey</span><span class="op" id="8194885">.</span><span class="ident" id="8194886">Y</span><span class="op" id="8194887">)</span>&nbsp;<span class="op" id="8194889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194893">t</span><span class="op" id="8194894">.</span><span class="ident" id="8194895">Errorf</span><span class="op" id="8194901">(</span><span class="string" id="8194902">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="8194930">,</span>&nbsp;<span class="ident" id="8194932">tag</span><span class="op" id="8194935">,</span>&nbsp;<span class="ident" id="8194937">err</span><span class="op" id="8194940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194943">}</span><br>
<span class="lineno"></span><span class="op" id="8194945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8194948">func</span>&nbsp;<span class="ident" id="8194953">TestKeyGeneration</span><span class="op" id="8194970">(</span><span class="ident" id="8194971">t</span>&nbsp;<span class="op" id="8194973">*</span><span class="ident" id="8194974">testing</span><span class="op" id="8194981">.</span><span class="ident" id="8194982">T</span><span class="op" id="8194983">)</span>&nbsp;<span class="op" id="8194985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194988">testKeyGeneration</span><span class="op" id="8195005">(</span><span class="ident" id="8195006">t</span><span class="op" id="8195007">,</span>&nbsp;<span class="ident" id="8195009">elliptic</span><span class="op" id="8195017">.</span><span class="ident" id="8195018">P224</span><span class="op" id="8195022">(</span><span class="op" id="8195023">)</span><span class="op" id="8195024">,</span>&nbsp;<span class="string" id="8195026">&#34;p224&#34;</span><span class="op" id="8195032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195035">if</span>&nbsp;<span class="ident" id="8195038">testing</span><span class="op" id="8195045">.</span><span class="ident" id="8195046">Short</span><span class="op" id="8195051">(</span><span class="op" id="8195052">)</span>&nbsp;<span class="op" id="8195054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195066">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195069">testKeyGeneration</span><span class="op" id="8195086">(</span><span class="ident" id="8195087">t</span><span class="op" id="8195088">,</span>&nbsp;<span class="ident" id="8195090">elliptic</span><span class="op" id="8195098">.</span><span class="ident" id="8195099">P256</span><span class="op" id="8195103">(</span><span class="op" id="8195104">)</span><span class="op" id="8195105">,</span>&nbsp;<span class="string" id="8195107">&#34;p256&#34;</span><span class="op" id="8195113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195116">testKeyGeneration</span><span class="op" id="8195133">(</span><span class="ident" id="8195134">t</span><span class="op" id="8195135">,</span>&nbsp;<span class="ident" id="8195137">elliptic</span><span class="op" id="8195145">.</span><span class="ident" id="8195146">P384</span><span class="op" id="8195150">(</span><span class="op" id="8195151">)</span><span class="op" id="8195152">,</span>&nbsp;<span class="string" id="8195154">&#34;p384&#34;</span><span class="op" id="8195160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195163">testKeyGeneration</span><span class="op" id="8195180">(</span><span class="ident" id="8195181">t</span><span class="op" id="8195182">,</span>&nbsp;<span class="ident" id="8195184">elliptic</span><span class="op" id="8195192">.</span><span class="ident" id="8195193">P521</span><span class="op" id="8195197">(</span><span class="op" id="8195198">)</span><span class="op" id="8195199">,</span>&nbsp;<span class="string" id="8195201">&#34;p521&#34;</span><span class="op" id="8195207">)</span><br>
<span class="lineno"></span><span class="op" id="8195209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="8195212">func</span>&nbsp;<span class="ident" id="8195217">testSignAndVerify</span><span class="op" id="8195234">(</span><span class="ident" id="8195235">t</span>&nbsp;<span class="op" id="8195237">*</span><span class="ident" id="8195238">testing</span><span class="op" id="8195245">.</span><span class="ident" id="8195246">T</span><span class="op" id="8195247">,</span>&nbsp;<span class="ident" id="8195249">c</span>&nbsp;<span class="ident" id="8195251">elliptic</span><span class="op" id="8195259">.</span><span class="ident" id="8195260">Curve</span><span class="op" id="8195265">,</span>&nbsp;<span class="ident" id="8195267">tag</span>&nbsp;<span class="builtintype" id="8195271">string</span><span class="op" id="8195277">)</span>&nbsp;<span class="op" id="8195279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195282">priv</span><span class="op" id="8195286">,</span>&nbsp;<span class="ident" id="8195288">_</span>&nbsp;<span class="op" id="8195290">:=</span>&nbsp;<span class="ident" id="8195293">GenerateKey</span><span class="op" id="8195304">(</span><span class="ident" id="8195305">c</span><span class="op" id="8195306">,</span>&nbsp;<span class="ident" id="8195308">rand</span><span class="op" id="8195312">.</span><span class="ident" id="8195313">Reader</span><span class="op" id="8195319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195323">hashed</span>&nbsp;<span class="op" id="8195330">:=</span>&nbsp;<span class="op" id="8195333">[</span><span class="op" id="8195334">]</span><span class="builtintype" id="8195335">byte</span><span class="op" id="8195339">(</span><span class="string" id="8195340">&#34;testing&#34;</span><span class="op" id="8195349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195352">r</span><span class="op" id="8195353">,</span>&nbsp;<span class="ident" id="8195355">s</span><span class="op" id="8195356">,</span>&nbsp;<span class="ident" id="8195358">err</span>&nbsp;<span class="op" id="8195362">:=</span>&nbsp;<span class="ident" id="8195365">Sign</span><span class="op" id="8195369">(</span><span class="ident" id="8195370">rand</span><span class="op" id="8195374">.</span><span class="ident" id="8195375">Reader</span><span class="op" id="8195381">,</span>&nbsp;<span class="ident" id="8195383">priv</span><span class="op" id="8195387">,</span>&nbsp;<span class="ident" id="8195389">hashed</span><span class="op" id="8195395">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195398">if</span>&nbsp;<span class="ident" id="8195401">err</span>&nbsp;<span class="op" id="8195405">!=</span>&nbsp;<span class="builtintype" id="8195408">nil</span>&nbsp;<span class="op" id="8195412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195416">t</span><span class="op" id="8195417">.</span><span class="ident" id="8195418">Errorf</span><span class="op" id="8195424">(</span><span class="string" id="8195425">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8195448">,</span>&nbsp;<span class="ident" id="8195450">tag</span><span class="op" id="8195453">,</span>&nbsp;<span class="ident" id="8195455">err</span><span class="op" id="8195458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195462">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195474">if</span>&nbsp;<span class="op" id="8195477">!</span><span class="ident" id="8195478">Verify</span><span class="op" id="8195484">(</span><span class="op" id="8195485">&amp;</span><span class="ident" id="8195486">priv</span><span class="op" id="8195490">.</span><span class="ident" id="8195491">PublicKey</span><span class="op" id="8195500">,</span>&nbsp;<span class="ident" id="8195502">hashed</span><span class="op" id="8195508">,</span>&nbsp;<span class="ident" id="8195510">r</span><span class="op" id="8195511">,</span>&nbsp;<span class="ident" id="8195513">s</span><span class="op" id="8195514">)</span>&nbsp;<span class="op" id="8195516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195520">t</span><span class="op" id="8195521">.</span><span class="ident" id="8195522">Errorf</span><span class="op" id="8195528">(</span><span class="string" id="8195529">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="8195548">,</span>&nbsp;<span class="ident" id="8195550">tag</span><span class="op" id="8195553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195560">hashed</span><span class="op" id="8195566">[</span><span class="num" id="8195567">0</span><span class="op" id="8195568">]</span>&nbsp;<span class="op" id="8195570">^=</span>&nbsp;<span class="num" id="8195573">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195579">if</span>&nbsp;<span class="ident" id="8195582">Verify</span><span class="op" id="8195588">(</span><span class="op" id="8195589">&amp;</span><span class="ident" id="8195590">priv</span><span class="op" id="8195594">.</span><span class="ident" id="8195595">PublicKey</span><span class="op" id="8195604">,</span>&nbsp;<span class="ident" id="8195606">hashed</span><span class="op" id="8195612">,</span>&nbsp;<span class="ident" id="8195614">r</span><span class="op" id="8195615">,</span>&nbsp;<span class="ident" id="8195617">s</span><span class="op" id="8195618">)</span>&nbsp;<span class="op" id="8195620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195624">t</span><span class="op" id="8195625">.</span><span class="ident" id="8195626">Errorf</span><span class="op" id="8195632">(</span><span class="string" id="8195633">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="8195659">,</span>&nbsp;<span class="ident" id="8195661">tag</span><span class="op" id="8195664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195667">}</span><br>
<span class="lineno"></span><span class="op" id="8195669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8195672">func</span>&nbsp;<span class="ident" id="8195677">TestSignAndVerify</span><span class="op" id="8195694">(</span><span class="ident" id="8195695">t</span>&nbsp;<span class="op" id="8195697">*</span><span class="ident" id="8195698">testing</span><span class="op" id="8195705">.</span><span class="ident" id="8195706">T</span><span class="op" id="8195707">)</span>&nbsp;<span class="op" id="8195709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195712">testSignAndVerify</span><span class="op" id="8195729">(</span><span class="ident" id="8195730">t</span><span class="op" id="8195731">,</span>&nbsp;<span class="ident" id="8195733">elliptic</span><span class="op" id="8195741">.</span><span class="ident" id="8195742">P224</span><span class="op" id="8195746">(</span><span class="op" id="8195747">)</span><span class="op" id="8195748">,</span>&nbsp;<span class="string" id="8195750">&#34;p224&#34;</span><span class="op" id="8195756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195759">if</span>&nbsp;<span class="ident" id="8195762">testing</span><span class="op" id="8195769">.</span><span class="ident" id="8195770">Short</span><span class="op" id="8195775">(</span><span class="op" id="8195776">)</span>&nbsp;<span class="op" id="8195778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195782">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195790">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195793">testSignAndVerify</span><span class="op" id="8195810">(</span><span class="ident" id="8195811">t</span><span class="op" id="8195812">,</span>&nbsp;<span class="ident" id="8195814">elliptic</span><span class="op" id="8195822">.</span><span class="ident" id="8195823">P256</span><span class="op" id="8195827">(</span><span class="op" id="8195828">)</span><span class="op" id="8195829">,</span>&nbsp;<span class="string" id="8195831">&#34;p256&#34;</span><span class="op" id="8195837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195840">testSignAndVerify</span><span class="op" id="8195857">(</span><span class="ident" id="8195858">t</span><span class="op" id="8195859">,</span>&nbsp;<span class="ident" id="8195861">elliptic</span><span class="op" id="8195869">.</span><span class="ident" id="8195870">P384</span><span class="op" id="8195874">(</span><span class="op" id="8195875">)</span><span class="op" id="8195876">,</span>&nbsp;<span class="string" id="8195878">&#34;p384&#34;</span><span class="op" id="8195884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195887">testSignAndVerify</span><span class="op" id="8195904">(</span><span class="ident" id="8195905">t</span><span class="op" id="8195906">,</span>&nbsp;<span class="ident" id="8195908">elliptic</span><span class="op" id="8195916">.</span><span class="ident" id="8195917">P521</span><span class="op" id="8195921">(</span><span class="op" id="8195922">)</span><span class="op" id="8195923">,</span>&nbsp;<span class="string" id="8195925">&#34;p521&#34;</span><span class="op" id="8195931">)</span><br>
<span class="lineno"></span><span class="op" id="8195933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="8195936">func</span>&nbsp;<span class="ident" id="8195941">fromHex</span><span class="op" id="8195948">(</span><span class="ident" id="8195949">s</span>&nbsp;<span class="builtintype" id="8195951">string</span><span class="op" id="8195957">)</span>&nbsp;<span class="op" id="8195959">*</span><span class="ident" id="8195960">big</span><span class="op" id="8195963">.</span><span class="ident" id="8195964">Int</span>&nbsp;<span class="op" id="8195968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195971">r</span><span class="op" id="8195972">,</span>&nbsp;<span class="ident" id="8195974">ok</span>&nbsp;<span class="op" id="8195977">:=</span>&nbsp;<span class="builtinfunc" id="8195980">new</span><span class="op" id="8195983">(</span><span class="ident" id="8195984">big</span><span class="op" id="8195987">.</span><span class="ident" id="8195988">Int</span><span class="op" id="8195991">)</span><span class="op" id="8195992">.</span><span class="ident" id="8195993">SetString</span><span class="op" id="8196002">(</span><span class="ident" id="8196003">s</span><span class="op" id="8196004">,</span>&nbsp;<span class="num" id="8196006">16</span><span class="op" id="8196008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196011">if</span>&nbsp;<span class="op" id="8196014">!</span><span class="ident" id="8196015">ok</span>&nbsp;<span class="op" id="8196018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8196022">panic</span><span class="op" id="8196027">(</span><span class="string" id="8196028">&#34;bad&nbsp;hex&#34;</span><span class="op" id="8196037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196040">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196043">return</span>&nbsp;<span class="ident" id="8196050">r</span><br>
<span class="lineno"></span><span class="op" id="8196052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196055">func</span>&nbsp;<span class="ident" id="8196060">TestVectors</span><span class="op" id="8196071">(</span><span class="ident" id="8196072">t</span>&nbsp;<span class="op" id="8196074">*</span><span class="ident" id="8196075">testing</span><span class="op" id="8196082">.</span><span class="ident" id="8196083">T</span><span class="op" id="8196084">)</span>&nbsp;<span class="op" id="8196086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196089">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196147">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196228">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196232">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196299">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196352">if</span>&nbsp;<span class="ident" id="8196355">testing</span><span class="op" id="8196362">.</span><span class="ident" id="8196363">Short</span><span class="op" id="8196368">(</span><span class="op" id="8196369">)</span>&nbsp;<span class="op" id="8196371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196387">f</span><span class="op" id="8196388">,</span>&nbsp;<span class="ident" id="8196390">err</span>&nbsp;<span class="op" id="8196394">:=</span>&nbsp;<span class="ident" id="8196397">os</span><span class="op" id="8196399">.</span><span class="ident" id="8196400">Open</span><span class="op" id="8196404">(</span><span class="string" id="8196405">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="8196430">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196433">if</span>&nbsp;<span class="ident" id="8196436">err</span>&nbsp;<span class="op" id="8196440">!=</span>&nbsp;<span class="builtintype" id="8196443">nil</span>&nbsp;<span class="op" id="8196447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196451">t</span><span class="op" id="8196452">.</span><span class="ident" id="8196453">Fatal</span><span class="op" id="8196458">(</span><span class="ident" id="8196459">err</span><span class="op" id="8196462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196469">buf</span>&nbsp;<span class="op" id="8196473">:=</span>&nbsp;<span class="ident" id="8196476">bufio</span><span class="op" id="8196481">.</span><span class="ident" id="8196482">NewReader</span><span class="op" id="8196491">(</span><span class="ident" id="8196492">bzip2</span><span class="op" id="8196497">.</span><span class="ident" id="8196498">NewReader</span><span class="op" id="8196507">(</span><span class="ident" id="8196508">f</span><span class="op" id="8196509">)</span><span class="op" id="8196510">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196514">lineNo</span>&nbsp;<span class="op" id="8196521">:=</span>&nbsp;<span class="num" id="8196524">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196527">var</span>&nbsp;<span class="ident" id="8196531">h</span>&nbsp;<span class="ident" id="8196533">hash</span><span class="op" id="8196537">.</span><span class="ident" id="8196538">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196544">var</span>&nbsp;<span class="ident" id="8196548">msg</span>&nbsp;<span class="op" id="8196552">[</span><span class="op" id="8196553">]</span><span class="builtintype" id="8196554">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196560">var</span>&nbsp;<span class="ident" id="8196564">hashed</span>&nbsp;<span class="op" id="8196571">[</span><span class="op" id="8196572">]</span><span class="builtintype" id="8196573">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196579">var</span>&nbsp;<span class="ident" id="8196583">r</span><span class="op" id="8196584">,</span>&nbsp;<span class="ident" id="8196586">s</span>&nbsp;<span class="op" id="8196588">*</span><span class="ident" id="8196589">big</span><span class="op" id="8196592">.</span><span class="ident" id="8196593">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196598">pub</span>&nbsp;<span class="op" id="8196602">:=</span>&nbsp;<span class="builtinfunc" id="8196605">new</span><span class="op" id="8196608">(</span><span class="ident" id="8196609">PublicKey</span><span class="op" id="8196618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196622">for</span>&nbsp;<span class="op" id="8196626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196630">line</span><span class="op" id="8196634">,</span>&nbsp;<span class="ident" id="8196636">err</span>&nbsp;<span class="op" id="8196640">:=</span>&nbsp;<span class="ident" id="8196643">buf</span><span class="op" id="8196646">.</span><span class="ident" id="8196647">ReadString</span><span class="op" id="8196657">(</span><span class="string" id="8196658">&#39;\n&#39;</span><span class="op" id="8196662">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196666">if</span>&nbsp;<span class="builtinfunc" id="8196669">len</span><span class="op" id="8196672">(</span><span class="ident" id="8196673">line</span><span class="op" id="8196677">)</span>&nbsp;<span class="op" id="8196679">==</span>&nbsp;<span class="num" id="8196682">0</span>&nbsp;<span class="op" id="8196684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196689">if</span>&nbsp;<span class="ident" id="8196692">err</span>&nbsp;<span class="op" id="8196696">==</span>&nbsp;<span class="ident" id="8196699">io</span><span class="op" id="8196701">.</span><span class="ident" id="8196702">EOF</span>&nbsp;<span class="op" id="8196706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196712">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196726">t</span><span class="op" id="8196727">.</span><span class="ident" id="8196728">Fatalf</span><span class="op" id="8196734">(</span><span class="string" id="8196735">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="8196765">,</span>&nbsp;<span class="ident" id="8196767">err</span><span class="op" id="8196770">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196778">lineNo</span><span class="op" id="8196784">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196789">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196840">if</span>&nbsp;<span class="op" id="8196843">!</span><span class="ident" id="8196844">strings</span><span class="op" id="8196851">.</span><span class="ident" id="8196852">HasSuffix</span><span class="op" id="8196861">(</span><span class="ident" id="8196862">line</span><span class="op" id="8196866">,</span>&nbsp;<span class="string" id="8196868">&#34;\r\n&#34;</span><span class="op" id="8196874">)</span>&nbsp;<span class="op" id="8196876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196881">t</span><span class="op" id="8196882">.</span><span class="ident" id="8196883">Fatalf</span><span class="op" id="8196889">(</span><span class="string" id="8196890">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8196936">,</span>&nbsp;<span class="ident" id="8196938">lineNo</span><span class="op" id="8196944">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196952">line</span>&nbsp;<span class="op" id="8196957">=</span>&nbsp;<span class="ident" id="8196959">line</span><span class="op" id="8196963">[</span><span class="op" id="8196964">:</span><span class="builtinfunc" id="8196965">len</span><span class="op" id="8196968">(</span><span class="ident" id="8196969">line</span><span class="op" id="8196973">)</span><span class="op" id="8196974">-</span><span class="num" id="8196975">2</span><span class="op" id="8196976">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196981">if</span>&nbsp;<span class="builtinfunc" id="8196984">len</span><span class="op" id="8196987">(</span><span class="ident" id="8196988">line</span><span class="op" id="8196992">)</span>&nbsp;<span class="op" id="8196994">==</span>&nbsp;<span class="num" id="8196997">0</span>&nbsp;<span class="op" id="8196999">||</span>&nbsp;<span class="ident" id="8197002">line</span><span class="op" id="8197006">[</span><span class="num" id="8197007">0</span><span class="op" id="8197008">]</span>&nbsp;<span class="op" id="8197010">==</span>&nbsp;<span class="string" id="8197013">&#39;#&#39;</span>&nbsp;<span class="op" id="8197017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197022">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197038">if</span>&nbsp;<span class="ident" id="8197041">line</span><span class="op" id="8197045">[</span><span class="num" id="8197046">0</span><span class="op" id="8197047">]</span>&nbsp;<span class="op" id="8197049">==</span>&nbsp;<span class="string" id="8197052">&#39;[&#39;</span>&nbsp;<span class="op" id="8197056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197061">line</span>&nbsp;<span class="op" id="8197066">=</span>&nbsp;<span class="ident" id="8197068">line</span><span class="op" id="8197072">[</span><span class="num" id="8197073">1</span>&nbsp;<span class="op" id="8197075">:</span>&nbsp;<span class="builtinfunc" id="8197077">len</span><span class="op" id="8197080">(</span><span class="ident" id="8197081">line</span><span class="op" id="8197085">)</span><span class="op" id="8197086">-</span><span class="num" id="8197087">1</span><span class="op" id="8197088">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197093">parts</span>&nbsp;<span class="op" id="8197099">:=</span>&nbsp;<span class="ident" id="8197102">strings</span><span class="op" id="8197109">.</span><span class="ident" id="8197110">SplitN</span><span class="op" id="8197116">(</span><span class="ident" id="8197117">line</span><span class="op" id="8197121">,</span>&nbsp;<span class="string" id="8197123">&#34;,&#34;</span><span class="op" id="8197126">,</span>&nbsp;<span class="num" id="8197128">2</span><span class="op" id="8197129">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197135">switch</span>&nbsp;<span class="ident" id="8197142">parts</span><span class="op" id="8197147">[</span><span class="num" id="8197148">0</span><span class="op" id="8197149">]</span>&nbsp;<span class="op" id="8197151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197156">case</span>&nbsp;<span class="string" id="8197161">&#34;P-224&#34;</span><span class="op" id="8197168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197174">pub</span><span class="op" id="8197177">.</span><span class="ident" id="8197178">Curve</span>&nbsp;<span class="op" id="8197184">=</span>&nbsp;<span class="ident" id="8197186">elliptic</span><span class="op" id="8197194">.</span><span class="ident" id="8197195">P224</span><span class="op" id="8197199">(</span><span class="op" id="8197200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197205">case</span>&nbsp;<span class="string" id="8197210">&#34;P-256&#34;</span><span class="op" id="8197217">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197223">pub</span><span class="op" id="8197226">.</span><span class="ident" id="8197227">Curve</span>&nbsp;<span class="op" id="8197233">=</span>&nbsp;<span class="ident" id="8197235">elliptic</span><span class="op" id="8197243">.</span><span class="ident" id="8197244">P256</span><span class="op" id="8197248">(</span><span class="op" id="8197249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197254">case</span>&nbsp;<span class="string" id="8197259">&#34;P-384&#34;</span><span class="op" id="8197266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197272">pub</span><span class="op" id="8197275">.</span><span class="ident" id="8197276">Curve</span>&nbsp;<span class="op" id="8197282">=</span>&nbsp;<span class="ident" id="8197284">elliptic</span><span class="op" id="8197292">.</span><span class="ident" id="8197293">P384</span><span class="op" id="8197297">(</span><span class="op" id="8197298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197303">case</span>&nbsp;<span class="string" id="8197308">&#34;P-521&#34;</span><span class="op" id="8197315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197321">pub</span><span class="op" id="8197324">.</span><span class="ident" id="8197325">Curve</span>&nbsp;<span class="op" id="8197331">=</span>&nbsp;<span class="ident" id="8197333">elliptic</span><span class="op" id="8197341">.</span><span class="ident" id="8197342">P521</span><span class="op" id="8197346">(</span><span class="op" id="8197347">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197352">default</span><span class="op" id="8197359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197365">pub</span><span class="op" id="8197368">.</span><span class="ident" id="8197369">Curve</span>&nbsp;<span class="op" id="8197375">=</span>&nbsp;<span class="builtintype" id="8197377">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197390">switch</span>&nbsp;<span class="ident" id="8197397">parts</span><span class="op" id="8197402">[</span><span class="num" id="8197403">1</span><span class="op" id="8197404">]</span>&nbsp;<span class="op" id="8197406">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197411">case</span>&nbsp;<span class="string" id="8197416">&#34;SHA-1&#34;</span><span class="op" id="8197423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197429">h</span>&nbsp;<span class="op" id="8197431">=</span>&nbsp;<span class="ident" id="8197433">sha1</span><span class="op" id="8197437">.</span><span class="ident" id="8197438">New</span><span class="op" id="8197441">(</span><span class="op" id="8197442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197447">case</span>&nbsp;<span class="string" id="8197452">&#34;SHA-224&#34;</span><span class="op" id="8197461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197467">h</span>&nbsp;<span class="op" id="8197469">=</span>&nbsp;<span class="ident" id="8197471">sha256</span><span class="op" id="8197477">.</span><span class="ident" id="8197478">New224</span><span class="op" id="8197484">(</span><span class="op" id="8197485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197490">case</span>&nbsp;<span class="string" id="8197495">&#34;SHA-256&#34;</span><span class="op" id="8197504">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197510">h</span>&nbsp;<span class="op" id="8197512">=</span>&nbsp;<span class="ident" id="8197514">sha256</span><span class="op" id="8197520">.</span><span class="ident" id="8197521">New</span><span class="op" id="8197524">(</span><span class="op" id="8197525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197530">case</span>&nbsp;<span class="string" id="8197535">&#34;SHA-384&#34;</span><span class="op" id="8197544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197550">h</span>&nbsp;<span class="op" id="8197552">=</span>&nbsp;<span class="ident" id="8197554">sha512</span><span class="op" id="8197560">.</span><span class="ident" id="8197561">New384</span><span class="op" id="8197567">(</span><span class="op" id="8197568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197573">case</span>&nbsp;<span class="string" id="8197578">&#34;SHA-512&#34;</span><span class="op" id="8197587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197593">h</span>&nbsp;<span class="op" id="8197595">=</span>&nbsp;<span class="ident" id="8197597">sha512</span><span class="op" id="8197603">.</span><span class="ident" id="8197604">New</span><span class="op" id="8197607">(</span><span class="op" id="8197608">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197613">default</span><span class="op" id="8197620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197626">h</span>&nbsp;<span class="op" id="8197628">=</span>&nbsp;<span class="builtintype" id="8197630">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197643">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197659">if</span>&nbsp;<span class="ident" id="8197662">h</span>&nbsp;<span class="op" id="8197664">==</span>&nbsp;<span class="builtintype" id="8197667">nil</span>&nbsp;<span class="op" id="8197671">||</span>&nbsp;<span class="ident" id="8197674">pub</span><span class="op" id="8197677">.</span><span class="ident" id="8197678">Curve</span>&nbsp;<span class="op" id="8197684">==</span>&nbsp;<span class="builtintype" id="8197687">nil</span>&nbsp;<span class="op" id="8197691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197696">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197707">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197712">switch</span>&nbsp;<span class="op" id="8197719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197723">case</span>&nbsp;<span class="ident" id="8197728">strings</span><span class="op" id="8197735">.</span><span class="ident" id="8197736">HasPrefix</span><span class="op" id="8197745">(</span><span class="ident" id="8197746">line</span><span class="op" id="8197750">,</span>&nbsp;<span class="string" id="8197752">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="8197760">)</span><span class="op" id="8197761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197766">if</span>&nbsp;<span class="ident" id="8197769">msg</span><span class="op" id="8197772">,</span>&nbsp;<span class="ident" id="8197774">err</span>&nbsp;<span class="op" id="8197778">=</span>&nbsp;<span class="ident" id="8197780">hex</span><span class="op" id="8197783">.</span><span class="ident" id="8197784">DecodeString</span><span class="op" id="8197796">(</span><span class="ident" id="8197797">line</span><span class="op" id="8197801">[</span><span class="num" id="8197802">6</span><span class="op" id="8197803">:</span><span class="op" id="8197804">]</span><span class="op" id="8197805">)</span><span class="op" id="8197806">;</span>&nbsp;<span class="ident" id="8197808">err</span>&nbsp;<span class="op" id="8197812">!=</span>&nbsp;<span class="builtintype" id="8197815">nil</span>&nbsp;<span class="op" id="8197819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197825">t</span><span class="op" id="8197826">.</span><span class="ident" id="8197827">Fatalf</span><span class="op" id="8197833">(</span><span class="string" id="8197834">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8197875">,</span>&nbsp;<span class="ident" id="8197877">lineNo</span><span class="op" id="8197883">,</span>&nbsp;<span class="ident" id="8197885">err</span><span class="op" id="8197888">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197897">case</span>&nbsp;<span class="ident" id="8197902">strings</span><span class="op" id="8197909">.</span><span class="ident" id="8197910">HasPrefix</span><span class="op" id="8197919">(</span><span class="ident" id="8197920">line</span><span class="op" id="8197924">,</span>&nbsp;<span class="string" id="8197926">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="8197933">)</span><span class="op" id="8197934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197939">pub</span><span class="op" id="8197942">.</span><span class="ident" id="8197943">X</span>&nbsp;<span class="op" id="8197945">=</span>&nbsp;<span class="ident" id="8197947">fromHex</span><span class="op" id="8197954">(</span><span class="ident" id="8197955">line</span><span class="op" id="8197959">[</span><span class="num" id="8197960">5</span><span class="op" id="8197961">:</span><span class="op" id="8197962">]</span><span class="op" id="8197963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197967">case</span>&nbsp;<span class="ident" id="8197972">strings</span><span class="op" id="8197979">.</span><span class="ident" id="8197980">HasPrefix</span><span class="op" id="8197989">(</span><span class="ident" id="8197990">line</span><span class="op" id="8197994">,</span>&nbsp;<span class="string" id="8197996">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="8198003">)</span><span class="op" id="8198004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198009">pub</span><span class="op" id="8198012">.</span><span class="ident" id="8198013">Y</span>&nbsp;<span class="op" id="8198015">=</span>&nbsp;<span class="ident" id="8198017">fromHex</span><span class="op" id="8198024">(</span><span class="ident" id="8198025">line</span><span class="op" id="8198029">[</span><span class="num" id="8198030">5</span><span class="op" id="8198031">:</span><span class="op" id="8198032">]</span><span class="op" id="8198033">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198037">case</span>&nbsp;<span class="ident" id="8198042">strings</span><span class="op" id="8198049">.</span><span class="ident" id="8198050">HasPrefix</span><span class="op" id="8198059">(</span><span class="ident" id="8198060">line</span><span class="op" id="8198064">,</span>&nbsp;<span class="string" id="8198066">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="8198072">)</span><span class="op" id="8198073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198078">r</span>&nbsp;<span class="op" id="8198080">=</span>&nbsp;<span class="ident" id="8198082">fromHex</span><span class="op" id="8198089">(</span><span class="ident" id="8198090">line</span><span class="op" id="8198094">[</span><span class="num" id="8198095">4</span><span class="op" id="8198096">:</span><span class="op" id="8198097">]</span><span class="op" id="8198098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198102">case</span>&nbsp;<span class="ident" id="8198107">strings</span><span class="op" id="8198114">.</span><span class="ident" id="8198115">HasPrefix</span><span class="op" id="8198124">(</span><span class="ident" id="8198125">line</span><span class="op" id="8198129">,</span>&nbsp;<span class="string" id="8198131">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="8198137">)</span><span class="op" id="8198138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198143">s</span>&nbsp;<span class="op" id="8198145">=</span>&nbsp;<span class="ident" id="8198147">fromHex</span><span class="op" id="8198154">(</span><span class="ident" id="8198155">line</span><span class="op" id="8198159">[</span><span class="num" id="8198160">4</span><span class="op" id="8198161">:</span><span class="op" id="8198162">]</span><span class="op" id="8198163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198167">case</span>&nbsp;<span class="ident" id="8198172">strings</span><span class="op" id="8198179">.</span><span class="ident" id="8198180">HasPrefix</span><span class="op" id="8198189">(</span><span class="ident" id="8198190">line</span><span class="op" id="8198194">,</span>&nbsp;<span class="string" id="8198196">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="8198207">)</span><span class="op" id="8198208">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198213">expected</span>&nbsp;<span class="op" id="8198222">:=</span>&nbsp;<span class="ident" id="8198225">line</span><span class="op" id="8198229">[</span><span class="num" id="8198230">9</span><span class="op" id="8198231">]</span>&nbsp;<span class="op" id="8198233">==</span>&nbsp;<span class="string" id="8198236">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198243">h</span><span class="op" id="8198244">.</span><span class="ident" id="8198245">Reset</span><span class="op" id="8198250">(</span><span class="op" id="8198251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198256">h</span><span class="op" id="8198257">.</span><span class="ident" id="8198258">Write</span><span class="op" id="8198263">(</span><span class="ident" id="8198264">msg</span><span class="op" id="8198267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198272">hashed</span>&nbsp;<span class="op" id="8198279">:=</span>&nbsp;<span class="ident" id="8198282">h</span><span class="op" id="8198283">.</span><span class="ident" id="8198284">Sum</span><span class="op" id="8198287">(</span><span class="ident" id="8198288">hashed</span><span class="op" id="8198294">[</span><span class="op" id="8198295">:</span><span class="num" id="8198296">0</span><span class="op" id="8198297">]</span><span class="op" id="8198298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198303">if</span>&nbsp;<span class="ident" id="8198306">Verify</span><span class="op" id="8198312">(</span><span class="ident" id="8198313">pub</span><span class="op" id="8198316">,</span>&nbsp;<span class="ident" id="8198318">hashed</span><span class="op" id="8198324">,</span>&nbsp;<span class="ident" id="8198326">r</span><span class="op" id="8198327">,</span>&nbsp;<span class="ident" id="8198329">s</span><span class="op" id="8198330">)</span>&nbsp;<span class="op" id="8198332">!=</span>&nbsp;<span class="ident" id="8198335">expected</span>&nbsp;<span class="op" id="8198344">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198350">t</span><span class="op" id="8198351">.</span><span class="ident" id="8198352">Fatalf</span><span class="op" id="8198358">(</span><span class="string" id="8198359">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8198388">,</span>&nbsp;<span class="ident" id="8198390">lineNo</span><span class="op" id="8198396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198405">default</span><span class="op" id="8198412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198417">t</span><span class="op" id="8198418">.</span><span class="ident" id="8198419">Fatalf</span><span class="op" id="8198425">(</span><span class="string" id="8198426">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8198459">,</span>&nbsp;<span class="ident" id="8198461">lineNo</span><span class="op" id="8198467">,</span>&nbsp;<span class="ident" id="8198469">line</span><span class="op" id="8198473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198477">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198480">}</span><br>
<span class="lineno"></span><span class="op" id="8198482">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
