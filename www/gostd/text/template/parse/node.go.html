<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4616592">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4616647">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4616701">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4616752">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616769">package</span>&nbsp;<span class="ident" id="4616777">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616784">import</span>&nbsp;<span class="op" id="4616791">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4616794">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4616803">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4616810">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4616821">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4616831">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4616834">var</span>&nbsp;<span class="ident" id="4616838">textFormat</span>&nbsp;<span class="op" id="4616849">=</span>&nbsp;<span class="string" id="4616851">&#34;%s&#34;</span>&nbsp;<span class="comment" id="4616856">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616912">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="4616981">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="4617041">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4617088">type</span>&nbsp;<span class="ident" id="4617093">Node</span>&nbsp;<span class="keyword" id="4617098">interface</span>&nbsp;<span class="op" id="4617108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617111">Type</span><span class="op" id="4617115">(</span><span class="op" id="4617116">)</span>&nbsp;<span class="ident" id="4617118">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617128">String</span><span class="op" id="4617134">(</span><span class="op" id="4617135">)</span>&nbsp;<span class="builtintype" id="4617137">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617145">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617207">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617273">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617315">Copy</span><span class="op" id="4617319">(</span><span class="op" id="4617320">)</span>&nbsp;<span class="ident" id="4617322">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617328">Position</span><span class="op" id="4617336">(</span><span class="op" id="4617337">)</span>&nbsp;<span class="ident" id="4617339">Pos</span>&nbsp;<span class="comment" id="4617343">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617408">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617447">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617520">tree</span><span class="op" id="4617524">(</span><span class="op" id="4617525">)</span>&nbsp;<span class="op" id="4617527">*</span><span class="ident" id="4617528">Tree</span><br>
<span class="lineno"></span><span class="op" id="4617533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4617536">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="4617590">type</span>&nbsp;<span class="ident" id="4617595">NodeType</span>&nbsp;<span class="builtintype" id="4617604">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4617609">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="4617681">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="4617710">type</span>&nbsp;<span class="ident" id="4617715">Pos</span>&nbsp;<span class="builtintype" id="4617719">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4617724">func</span>&nbsp;<span class="op" id="4617729">(</span><span class="ident" id="4617730">p</span>&nbsp;<span class="ident" id="4617732">Pos</span><span class="op" id="4617735">)</span>&nbsp;<span class="ident" id="4617737">Position</span><span class="op" id="4617745">(</span><span class="op" id="4617746">)</span>&nbsp;<span class="ident" id="4617748">Pos</span>&nbsp;<span class="op" id="4617752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617755">return</span>&nbsp;<span class="ident" id="4617762">p</span><br>
<span class="lineno"></span><span class="op" id="4617764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4617767">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="4617834">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4617897">func</span>&nbsp;<span class="op" id="4617902">(</span><span class="ident" id="4617903">t</span>&nbsp;<span class="ident" id="4617905">NodeType</span><span class="op" id="4617913">)</span>&nbsp;<span class="ident" id="4617915">Type</span><span class="op" id="4617919">(</span><span class="op" id="4617920">)</span>&nbsp;<span class="ident" id="4617922">NodeType</span>&nbsp;<span class="op" id="4617931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617934">return</span>&nbsp;<span class="ident" id="4617941">t</span><br>
<span class="lineno"></span><span class="op" id="4617943">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4617946">const</span>&nbsp;<span class="op" id="4617952">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617955">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617970">NodeType</span>&nbsp;<span class="op" id="4617979">=</span>&nbsp;<span class="ident" id="4617981">iota</span>&nbsp;<span class="comment" id="4617986">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618002">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618033">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618086">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618117">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618141">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618172">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618206">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618237">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618267">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618298">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618319">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618350">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618389">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618420">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618458">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618489">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618517">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618548">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618591">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618622">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618640">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618671">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618692">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618723">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618752">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618783">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618809">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618840">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618868">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618899">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618919">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618950">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618973">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619004">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619038">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619069">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619087">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619118">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4619136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4619139">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4619150">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4619189">type</span>&nbsp;<span class="ident" id="4619194">ListNode</span>&nbsp;<span class="keyword" id="4619203">struct</span>&nbsp;<span class="op" id="4619210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619213">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619223">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619228">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619234">*</span><span class="ident" id="4619235">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619241">Nodes</span>&nbsp;<span class="op" id="4619247">[</span><span class="op" id="4619248">]</span><span class="ident" id="4619249">Node</span>&nbsp;<span class="comment" id="4619254">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4619293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4619296">func</span>&nbsp;<span class="op" id="4619301">(</span><span class="ident" id="4619302">t</span>&nbsp;<span class="op" id="4619304">*</span><span class="ident" id="4619305">Tree</span><span class="op" id="4619309">)</span>&nbsp;<span class="ident" id="4619311">newList</span><span class="op" id="4619318">(</span><span class="ident" id="4619319">pos</span>&nbsp;<span class="ident" id="4619323">Pos</span><span class="op" id="4619326">)</span>&nbsp;<span class="op" id="4619328">*</span><span class="ident" id="4619329">ListNode</span>&nbsp;<span class="op" id="4619338">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619341">return</span>&nbsp;<span class="op" id="4619348">&amp;</span><span class="ident" id="4619349">ListNode</span><span class="op" id="4619357">{</span><span class="ident" id="4619358">tr</span><span class="op" id="4619360">:</span>&nbsp;<span class="ident" id="4619362">t</span><span class="op" id="4619363">,</span>&nbsp;<span class="ident" id="4619365">NodeType</span><span class="op" id="4619373">:</span>&nbsp;<span class="ident" id="4619375">NodeList</span><span class="op" id="4619383">,</span>&nbsp;<span class="ident" id="4619385">Pos</span><span class="op" id="4619388">:</span>&nbsp;<span class="ident" id="4619390">pos</span><span class="op" id="4619393">}</span><br>
<span class="lineno"></span><span class="op" id="4619395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4619398">func</span>&nbsp;<span class="op" id="4619403">(</span><span class="ident" id="4619404">l</span>&nbsp;<span class="op" id="4619406">*</span><span class="ident" id="4619407">ListNode</span><span class="op" id="4619415">)</span>&nbsp;<span class="builtinfunc" id="4619417">append</span><span class="op" id="4619423">(</span><span class="ident" id="4619424">n</span>&nbsp;<span class="ident" id="4619426">Node</span><span class="op" id="4619430">)</span>&nbsp;<span class="op" id="4619432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619435">l</span><span class="op" id="4619436">.</span><span class="ident" id="4619437">Nodes</span>&nbsp;<span class="op" id="4619443">=</span>&nbsp;<span class="builtinfunc" id="4619445">append</span><span class="op" id="4619451">(</span><span class="ident" id="4619452">l</span><span class="op" id="4619453">.</span><span class="ident" id="4619454">Nodes</span><span class="op" id="4619459">,</span>&nbsp;<span class="ident" id="4619461">n</span><span class="op" id="4619462">)</span><br>
<span class="lineno">90</span><span class="op" id="4619464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4619467">func</span>&nbsp;<span class="op" id="4619472">(</span><span class="ident" id="4619473">l</span>&nbsp;<span class="op" id="4619475">*</span><span class="ident" id="4619476">ListNode</span><span class="op" id="4619484">)</span>&nbsp;<span class="ident" id="4619486">tree</span><span class="op" id="4619490">(</span><span class="op" id="4619491">)</span>&nbsp;<span class="op" id="4619493">*</span><span class="ident" id="4619494">Tree</span>&nbsp;<span class="op" id="4619499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619502">return</span>&nbsp;<span class="ident" id="4619509">l</span><span class="op" id="4619510">.</span><span class="ident" id="4619511">tr</span><br>
<span class="lineno"></span><span class="op" id="4619514">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4619517">func</span>&nbsp;<span class="op" id="4619522">(</span><span class="ident" id="4619523">l</span>&nbsp;<span class="op" id="4619525">*</span><span class="ident" id="4619526">ListNode</span><span class="op" id="4619534">)</span>&nbsp;<span class="ident" id="4619536">String</span><span class="op" id="4619542">(</span><span class="op" id="4619543">)</span>&nbsp;<span class="builtintype" id="4619545">string</span>&nbsp;<span class="op" id="4619552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619555">b</span>&nbsp;<span class="op" id="4619557">:=</span>&nbsp;<span class="builtinfunc" id="4619560">new</span><span class="op" id="4619563">(</span><span class="ident" id="4619564">bytes</span><span class="op" id="4619569">.</span><span class="ident" id="4619570">Buffer</span><span class="op" id="4619576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619579">for</span>&nbsp;<span class="ident" id="4619583">_</span><span class="op" id="4619584">,</span>&nbsp;<span class="ident" id="4619586">n</span>&nbsp;<span class="op" id="4619588">:=</span>&nbsp;<span class="keyword" id="4619591">range</span>&nbsp;<span class="ident" id="4619597">l</span><span class="op" id="4619598">.</span><span class="ident" id="4619599">Nodes</span>&nbsp;<span class="op" id="4619605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619609">fmt</span><span class="op" id="4619612">.</span><span class="ident" id="4619613">Fprint</span><span class="op" id="4619619">(</span><span class="ident" id="4619620">b</span><span class="op" id="4619621">,</span>&nbsp;<span class="ident" id="4619623">n</span><span class="op" id="4619624">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619630">return</span>&nbsp;<span class="ident" id="4619637">b</span><span class="op" id="4619638">.</span><span class="ident" id="4619639">String</span><span class="op" id="4619645">(</span><span class="op" id="4619646">)</span><br>
<span class="lineno"></span><span class="op" id="4619648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4619651">func</span>&nbsp;<span class="op" id="4619656">(</span><span class="ident" id="4619657">l</span>&nbsp;<span class="op" id="4619659">*</span><span class="ident" id="4619660">ListNode</span><span class="op" id="4619668">)</span>&nbsp;<span class="ident" id="4619670">CopyList</span><span class="op" id="4619678">(</span><span class="op" id="4619679">)</span>&nbsp;<span class="op" id="4619681">*</span><span class="ident" id="4619682">ListNode</span>&nbsp;<span class="op" id="4619691">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619694">if</span>&nbsp;<span class="ident" id="4619697">l</span>&nbsp;<span class="op" id="4619699">==</span>&nbsp;<span class="ident" id="4619702">nil</span>&nbsp;<span class="op" id="4619706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619710">return</span>&nbsp;<span class="ident" id="4619717">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619723">n</span>&nbsp;<span class="op" id="4619725">:=</span>&nbsp;<span class="ident" id="4619728">l</span><span class="op" id="4619729">.</span><span class="ident" id="4619730">tr</span><span class="op" id="4619732">.</span><span class="ident" id="4619733">newList</span><span class="op" id="4619740">(</span><span class="ident" id="4619741">l</span><span class="op" id="4619742">.</span><span class="ident" id="4619743">Pos</span><span class="op" id="4619746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619749">for</span>&nbsp;<span class="ident" id="4619753">_</span><span class="op" id="4619754">,</span>&nbsp;<span class="ident" id="4619756">elem</span>&nbsp;<span class="op" id="4619761">:=</span>&nbsp;<span class="keyword" id="4619764">range</span>&nbsp;<span class="ident" id="4619770">l</span><span class="op" id="4619771">.</span><span class="ident" id="4619772">Nodes</span>&nbsp;<span class="op" id="4619778">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619782">n</span><span class="op" id="4619783">.</span><span class="builtinfunc" id="4619784">append</span><span class="op" id="4619790">(</span><span class="ident" id="4619791">elem</span><span class="op" id="4619795">.</span><span class="ident" id="4619796">Copy</span><span class="op" id="4619800">(</span><span class="op" id="4619801">)</span><span class="op" id="4619802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619808">return</span>&nbsp;<span class="ident" id="4619815">n</span><br>
<span class="lineno"></span><span class="op" id="4619817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4619820">func</span>&nbsp;<span class="op" id="4619825">(</span><span class="ident" id="4619826">l</span>&nbsp;<span class="op" id="4619828">*</span><span class="ident" id="4619829">ListNode</span><span class="op" id="4619837">)</span>&nbsp;<span class="ident" id="4619839">Copy</span><span class="op" id="4619843">(</span><span class="op" id="4619844">)</span>&nbsp;<span class="ident" id="4619846">Node</span>&nbsp;<span class="op" id="4619851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619854">return</span>&nbsp;<span class="ident" id="4619861">l</span><span class="op" id="4619862">.</span><span class="ident" id="4619863">CopyList</span><span class="op" id="4619871">(</span><span class="op" id="4619872">)</span><br>
<span class="lineno"></span><span class="op" id="4619874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4619877">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="4619907">type</span>&nbsp;<span class="ident" id="4619912">TextNode</span>&nbsp;<span class="keyword" id="4619921">struct</span>&nbsp;<span class="op" id="4619928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619931">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619941">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619946">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4619951">*</span><span class="ident" id="4619952">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619958">Text</span>&nbsp;<span class="op" id="4619963">[</span><span class="op" id="4619964">]</span><span class="builtintype" id="4619965">byte</span>&nbsp;<span class="comment" id="4619970">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="4620002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620005">func</span>&nbsp;<span class="op" id="4620010">(</span><span class="ident" id="4620011">t</span>&nbsp;<span class="op" id="4620013">*</span><span class="ident" id="4620014">Tree</span><span class="op" id="4620018">)</span>&nbsp;<span class="ident" id="4620020">newText</span><span class="op" id="4620027">(</span><span class="ident" id="4620028">pos</span>&nbsp;<span class="ident" id="4620032">Pos</span><span class="op" id="4620035">,</span>&nbsp;<span class="ident" id="4620037">text</span>&nbsp;<span class="builtintype" id="4620042">string</span><span class="op" id="4620048">)</span>&nbsp;<span class="op" id="4620050">*</span><span class="ident" id="4620051">TextNode</span>&nbsp;<span class="op" id="4620060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620063">return</span>&nbsp;<span class="op" id="4620070">&amp;</span><span class="ident" id="4620071">TextNode</span><span class="op" id="4620079">{</span><span class="ident" id="4620080">tr</span><span class="op" id="4620082">:</span>&nbsp;<span class="ident" id="4620084">t</span><span class="op" id="4620085">,</span>&nbsp;<span class="ident" id="4620087">NodeType</span><span class="op" id="4620095">:</span>&nbsp;<span class="ident" id="4620097">NodeText</span><span class="op" id="4620105">,</span>&nbsp;<span class="ident" id="4620107">Pos</span><span class="op" id="4620110">:</span>&nbsp;<span class="ident" id="4620112">pos</span><span class="op" id="4620115">,</span>&nbsp;<span class="ident" id="4620117">Text</span><span class="op" id="4620121">:</span>&nbsp;<span class="op" id="4620123">[</span><span class="op" id="4620124">]</span><span class="builtintype" id="4620125">byte</span><span class="op" id="4620129">(</span><span class="ident" id="4620130">text</span><span class="op" id="4620134">)</span><span class="op" id="4620135">}</span><br>
<span class="lineno"></span><span class="op" id="4620137">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4620140">func</span>&nbsp;<span class="op" id="4620145">(</span><span class="ident" id="4620146">t</span>&nbsp;<span class="op" id="4620148">*</span><span class="ident" id="4620149">TextNode</span><span class="op" id="4620157">)</span>&nbsp;<span class="ident" id="4620159">String</span><span class="op" id="4620165">(</span><span class="op" id="4620166">)</span>&nbsp;<span class="builtintype" id="4620168">string</span>&nbsp;<span class="op" id="4620175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620178">return</span>&nbsp;<span class="ident" id="4620185">fmt</span><span class="op" id="4620188">.</span><span class="ident" id="4620189">Sprintf</span><span class="op" id="4620196">(</span><span class="ident" id="4620197">textFormat</span><span class="op" id="4620207">,</span>&nbsp;<span class="ident" id="4620209">t</span><span class="op" id="4620210">.</span><span class="ident" id="4620211">Text</span><span class="op" id="4620215">)</span><br>
<span class="lineno"></span><span class="op" id="4620217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4620220">func</span>&nbsp;<span class="op" id="4620225">(</span><span class="ident" id="4620226">t</span>&nbsp;<span class="op" id="4620228">*</span><span class="ident" id="4620229">TextNode</span><span class="op" id="4620237">)</span>&nbsp;<span class="ident" id="4620239">tree</span><span class="op" id="4620243">(</span><span class="op" id="4620244">)</span>&nbsp;<span class="op" id="4620246">*</span><span class="ident" id="4620247">Tree</span>&nbsp;<span class="op" id="4620252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620255">return</span>&nbsp;<span class="ident" id="4620262">t</span><span class="op" id="4620263">.</span><span class="ident" id="4620264">tr</span><br>
<span class="lineno"></span><span class="op" id="4620267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620270">func</span>&nbsp;<span class="op" id="4620275">(</span><span class="ident" id="4620276">t</span>&nbsp;<span class="op" id="4620278">*</span><span class="ident" id="4620279">TextNode</span><span class="op" id="4620287">)</span>&nbsp;<span class="ident" id="4620289">Copy</span><span class="op" id="4620293">(</span><span class="op" id="4620294">)</span>&nbsp;<span class="ident" id="4620296">Node</span>&nbsp;<span class="op" id="4620301">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620304">return</span>&nbsp;<span class="op" id="4620311">&amp;</span><span class="ident" id="4620312">TextNode</span><span class="op" id="4620320">{</span><span class="ident" id="4620321">tr</span><span class="op" id="4620323">:</span>&nbsp;<span class="ident" id="4620325">t</span><span class="op" id="4620326">.</span><span class="ident" id="4620327">tr</span><span class="op" id="4620329">,</span>&nbsp;<span class="ident" id="4620331">NodeType</span><span class="op" id="4620339">:</span>&nbsp;<span class="ident" id="4620341">NodeText</span><span class="op" id="4620349">,</span>&nbsp;<span class="ident" id="4620351">Pos</span><span class="op" id="4620354">:</span>&nbsp;<span class="ident" id="4620356">t</span><span class="op" id="4620357">.</span><span class="ident" id="4620358">Pos</span><span class="op" id="4620361">,</span>&nbsp;<span class="ident" id="4620363">Text</span><span class="op" id="4620367">:</span>&nbsp;<span class="builtinfunc" id="4620369">append</span><span class="op" id="4620375">(</span><span class="op" id="4620376">[</span><span class="op" id="4620377">]</span><span class="builtintype" id="4620378">byte</span><span class="op" id="4620382">{</span><span class="op" id="4620383">}</span><span class="op" id="4620384">,</span>&nbsp;<span class="ident" id="4620386">t</span><span class="op" id="4620387">.</span><span class="ident" id="4620388">Text</span><span class="op" id="4620392">...</span><span class="op" id="4620395">)</span><span class="op" id="4620396">}</span><br>
<span class="lineno"></span><span class="op" id="4620398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620401">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="4620456">type</span>&nbsp;<span class="ident" id="4620461">PipeNode</span>&nbsp;<span class="keyword" id="4620470">struct</span>&nbsp;<span class="op" id="4620477">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620480">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620490">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620495">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4620500">*</span><span class="ident" id="4620501">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620507">Line</span>&nbsp;<span class="builtintype" id="4620512">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4620528">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620598">Decl</span>&nbsp;<span class="op" id="4620603">[</span><span class="op" id="4620604">]</span><span class="op" id="4620605">*</span><span class="ident" id="4620606">VariableNode</span>&nbsp;<span class="comment" id="4620619">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620663">Cmds</span>&nbsp;<span class="op" id="4620668">[</span><span class="op" id="4620669">]</span><span class="op" id="4620670">*</span><span class="ident" id="4620671">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="4620684">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4620718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620721">func</span>&nbsp;<span class="op" id="4620726">(</span><span class="ident" id="4620727">t</span>&nbsp;<span class="op" id="4620729">*</span><span class="ident" id="4620730">Tree</span><span class="op" id="4620734">)</span>&nbsp;<span class="ident" id="4620736">newPipeline</span><span class="op" id="4620747">(</span><span class="ident" id="4620748">pos</span>&nbsp;<span class="ident" id="4620752">Pos</span><span class="op" id="4620755">,</span>&nbsp;<span class="ident" id="4620757">line</span>&nbsp;<span class="builtintype" id="4620762">int</span><span class="op" id="4620765">,</span>&nbsp;<span class="ident" id="4620767">decl</span>&nbsp;<span class="op" id="4620772">[</span><span class="op" id="4620773">]</span><span class="op" id="4620774">*</span><span class="ident" id="4620775">VariableNode</span><span class="op" id="4620787">)</span>&nbsp;<span class="op" id="4620789">*</span><span class="ident" id="4620790">PipeNode</span>&nbsp;<span class="op" id="4620799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620802">return</span>&nbsp;<span class="op" id="4620809">&amp;</span><span class="ident" id="4620810">PipeNode</span><span class="op" id="4620818">{</span><span class="ident" id="4620819">tr</span><span class="op" id="4620821">:</span>&nbsp;<span class="ident" id="4620823">t</span><span class="op" id="4620824">,</span>&nbsp;<span class="ident" id="4620826">NodeType</span><span class="op" id="4620834">:</span>&nbsp;<span class="ident" id="4620836">NodePipe</span><span class="op" id="4620844">,</span>&nbsp;<span class="ident" id="4620846">Pos</span><span class="op" id="4620849">:</span>&nbsp;<span class="ident" id="4620851">pos</span><span class="op" id="4620854">,</span>&nbsp;<span class="ident" id="4620856">Line</span><span class="op" id="4620860">:</span>&nbsp;<span class="ident" id="4620862">line</span><span class="op" id="4620866">,</span>&nbsp;<span class="ident" id="4620868">Decl</span><span class="op" id="4620872">:</span>&nbsp;<span class="ident" id="4620874">decl</span><span class="op" id="4620878">}</span><br>
<span class="lineno">155</span><span class="op" id="4620880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620883">func</span>&nbsp;<span class="op" id="4620888">(</span><span class="ident" id="4620889">p</span>&nbsp;<span class="op" id="4620891">*</span><span class="ident" id="4620892">PipeNode</span><span class="op" id="4620900">)</span>&nbsp;<span class="builtinfunc" id="4620902">append</span><span class="op" id="4620908">(</span><span class="ident" id="4620909">command</span>&nbsp;<span class="op" id="4620917">*</span><span class="ident" id="4620918">CommandNode</span><span class="op" id="4620929">)</span>&nbsp;<span class="op" id="4620931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620934">p</span><span class="op" id="4620935">.</span><span class="ident" id="4620936">Cmds</span>&nbsp;<span class="op" id="4620941">=</span>&nbsp;<span class="builtinfunc" id="4620943">append</span><span class="op" id="4620949">(</span><span class="ident" id="4620950">p</span><span class="op" id="4620951">.</span><span class="ident" id="4620952">Cmds</span><span class="op" id="4620956">,</span>&nbsp;<span class="ident" id="4620958">command</span><span class="op" id="4620965">)</span><br>
<span class="lineno"></span><span class="op" id="4620967">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="4620970">func</span>&nbsp;<span class="op" id="4620975">(</span><span class="ident" id="4620976">p</span>&nbsp;<span class="op" id="4620978">*</span><span class="ident" id="4620979">PipeNode</span><span class="op" id="4620987">)</span>&nbsp;<span class="ident" id="4620989">String</span><span class="op" id="4620995">(</span><span class="op" id="4620996">)</span>&nbsp;<span class="builtintype" id="4620998">string</span>&nbsp;<span class="op" id="4621005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621008">s</span>&nbsp;<span class="op" id="4621010">:=</span>&nbsp;<span class="string" id="4621013">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621017">if</span>&nbsp;<span class="builtinfunc" id="4621020">len</span><span class="op" id="4621023">(</span><span class="ident" id="4621024">p</span><span class="op" id="4621025">.</span><span class="ident" id="4621026">Decl</span><span class="op" id="4621030">)</span>&nbsp;<span class="op" id="4621032">&gt;</span>&nbsp;<span class="num" id="4621034">0</span>&nbsp;<span class="op" id="4621036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621040">for</span>&nbsp;<span class="ident" id="4621044">i</span><span class="op" id="4621045">,</span>&nbsp;<span class="ident" id="4621047">v</span>&nbsp;<span class="op" id="4621049">:=</span>&nbsp;<span class="keyword" id="4621052">range</span>&nbsp;<span class="ident" id="4621058">p</span><span class="op" id="4621059">.</span><span class="ident" id="4621060">Decl</span>&nbsp;<span class="op" id="4621065">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621070">if</span>&nbsp;<span class="ident" id="4621073">i</span>&nbsp;<span class="op" id="4621075">&gt;</span>&nbsp;<span class="num" id="4621077">0</span>&nbsp;<span class="op" id="4621079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621085">s</span>&nbsp;<span class="op" id="4621087">+=</span>&nbsp;<span class="string" id="4621090">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621103">s</span>&nbsp;<span class="op" id="4621105">+=</span>&nbsp;<span class="ident" id="4621108">v</span><span class="op" id="4621109">.</span><span class="ident" id="4621110">String</span><span class="op" id="4621116">(</span><span class="op" id="4621117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621121">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621125">s</span>&nbsp;<span class="op" id="4621127">+=</span>&nbsp;<span class="string" id="4621130">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621141">for</span>&nbsp;<span class="ident" id="4621145">i</span><span class="op" id="4621146">,</span>&nbsp;<span class="ident" id="4621148">c</span>&nbsp;<span class="op" id="4621150">:=</span>&nbsp;<span class="keyword" id="4621153">range</span>&nbsp;<span class="ident" id="4621159">p</span><span class="op" id="4621160">.</span><span class="ident" id="4621161">Cmds</span>&nbsp;<span class="op" id="4621166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621170">if</span>&nbsp;<span class="ident" id="4621173">i</span>&nbsp;<span class="op" id="4621175">&gt;</span>&nbsp;<span class="num" id="4621177">0</span>&nbsp;<span class="op" id="4621179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621184">s</span>&nbsp;<span class="op" id="4621186">+=</span>&nbsp;<span class="string" id="4621189">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621201">s</span>&nbsp;<span class="op" id="4621203">+=</span>&nbsp;<span class="ident" id="4621206">c</span><span class="op" id="4621207">.</span><span class="ident" id="4621208">String</span><span class="op" id="4621214">(</span><span class="op" id="4621215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621221">return</span>&nbsp;<span class="ident" id="4621228">s</span><br>
<span class="lineno"></span><span class="op" id="4621230">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4621233">func</span>&nbsp;<span class="op" id="4621238">(</span><span class="ident" id="4621239">p</span>&nbsp;<span class="op" id="4621241">*</span><span class="ident" id="4621242">PipeNode</span><span class="op" id="4621250">)</span>&nbsp;<span class="ident" id="4621252">tree</span><span class="op" id="4621256">(</span><span class="op" id="4621257">)</span>&nbsp;<span class="op" id="4621259">*</span><span class="ident" id="4621260">Tree</span>&nbsp;<span class="op" id="4621265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621268">return</span>&nbsp;<span class="ident" id="4621275">p</span><span class="op" id="4621276">.</span><span class="ident" id="4621277">tr</span><br>
<span class="lineno"></span><span class="op" id="4621280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4621283">func</span>&nbsp;<span class="op" id="4621288">(</span><span class="ident" id="4621289">p</span>&nbsp;<span class="op" id="4621291">*</span><span class="ident" id="4621292">PipeNode</span><span class="op" id="4621300">)</span>&nbsp;<span class="ident" id="4621302">CopyPipe</span><span class="op" id="4621310">(</span><span class="op" id="4621311">)</span>&nbsp;<span class="op" id="4621313">*</span><span class="ident" id="4621314">PipeNode</span>&nbsp;<span class="op" id="4621323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621326">if</span>&nbsp;<span class="ident" id="4621329">p</span>&nbsp;<span class="op" id="4621331">==</span>&nbsp;<span class="ident" id="4621334">nil</span>&nbsp;<span class="op" id="4621338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621342">return</span>&nbsp;<span class="ident" id="4621349">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621355">var</span>&nbsp;<span class="ident" id="4621359">decl</span>&nbsp;<span class="op" id="4621364">[</span><span class="op" id="4621365">]</span><span class="op" id="4621366">*</span><span class="ident" id="4621367">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621381">for</span>&nbsp;<span class="ident" id="4621385">_</span><span class="op" id="4621386">,</span>&nbsp;<span class="ident" id="4621388">d</span>&nbsp;<span class="op" id="4621390">:=</span>&nbsp;<span class="keyword" id="4621393">range</span>&nbsp;<span class="ident" id="4621399">p</span><span class="op" id="4621400">.</span><span class="ident" id="4621401">Decl</span>&nbsp;<span class="op" id="4621406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621410">decl</span>&nbsp;<span class="op" id="4621415">=</span>&nbsp;<span class="builtinfunc" id="4621417">append</span><span class="op" id="4621423">(</span><span class="ident" id="4621424">decl</span><span class="op" id="4621428">,</span>&nbsp;<span class="ident" id="4621430">d</span><span class="op" id="4621431">.</span><span class="ident" id="4621432">Copy</span><span class="op" id="4621436">(</span><span class="op" id="4621437">)</span><span class="op" id="4621438">.</span><span class="op" id="4621439">(</span><span class="op" id="4621440">*</span><span class="ident" id="4621441">VariableNode</span><span class="op" id="4621453">)</span><span class="op" id="4621454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621460">n</span>&nbsp;<span class="op" id="4621462">:=</span>&nbsp;<span class="ident" id="4621465">p</span><span class="op" id="4621466">.</span><span class="ident" id="4621467">tr</span><span class="op" id="4621469">.</span><span class="ident" id="4621470">newPipeline</span><span class="op" id="4621481">(</span><span class="ident" id="4621482">p</span><span class="op" id="4621483">.</span><span class="ident" id="4621484">Pos</span><span class="op" id="4621487">,</span>&nbsp;<span class="ident" id="4621489">p</span><span class="op" id="4621490">.</span><span class="ident" id="4621491">Line</span><span class="op" id="4621495">,</span>&nbsp;<span class="ident" id="4621497">decl</span><span class="op" id="4621501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621504">for</span>&nbsp;<span class="ident" id="4621508">_</span><span class="op" id="4621509">,</span>&nbsp;<span class="ident" id="4621511">c</span>&nbsp;<span class="op" id="4621513">:=</span>&nbsp;<span class="keyword" id="4621516">range</span>&nbsp;<span class="ident" id="4621522">p</span><span class="op" id="4621523">.</span><span class="ident" id="4621524">Cmds</span>&nbsp;<span class="op" id="4621529">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621533">n</span><span class="op" id="4621534">.</span><span class="builtinfunc" id="4621535">append</span><span class="op" id="4621541">(</span><span class="ident" id="4621542">c</span><span class="op" id="4621543">.</span><span class="ident" id="4621544">Copy</span><span class="op" id="4621548">(</span><span class="op" id="4621549">)</span><span class="op" id="4621550">.</span><span class="op" id="4621551">(</span><span class="op" id="4621552">*</span><span class="ident" id="4621553">CommandNode</span><span class="op" id="4621564">)</span><span class="op" id="4621565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621571">return</span>&nbsp;<span class="ident" id="4621578">n</span><br>
<span class="lineno"></span><span class="op" id="4621580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="4621583">func</span>&nbsp;<span class="op" id="4621588">(</span><span class="ident" id="4621589">p</span>&nbsp;<span class="op" id="4621591">*</span><span class="ident" id="4621592">PipeNode</span><span class="op" id="4621600">)</span>&nbsp;<span class="ident" id="4621602">Copy</span><span class="op" id="4621606">(</span><span class="op" id="4621607">)</span>&nbsp;<span class="ident" id="4621609">Node</span>&nbsp;<span class="op" id="4621614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621617">return</span>&nbsp;<span class="ident" id="4621624">p</span><span class="op" id="4621625">.</span><span class="ident" id="4621626">CopyPipe</span><span class="op" id="4621634">(</span><span class="op" id="4621635">)</span><br>
<span class="lineno"></span><span class="op" id="4621637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4621640">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="4621705">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="4621775">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="4621838">type</span>&nbsp;<span class="ident" id="4621843">ActionNode</span>&nbsp;<span class="keyword" id="4621854">struct</span>&nbsp;<span class="op" id="4621861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621864">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621874">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621879">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4621884">*</span><span class="ident" id="4621885">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621891">Line</span>&nbsp;<span class="builtintype" id="4621896">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621906">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621976">Pipe</span>&nbsp;<span class="op" id="4621981">*</span><span class="ident" id="4621982">PipeNode</span>&nbsp;<span class="comment" id="4621991">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4622022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4622025">func</span>&nbsp;<span class="op" id="4622030">(</span><span class="ident" id="4622031">t</span>&nbsp;<span class="op" id="4622033">*</span><span class="ident" id="4622034">Tree</span><span class="op" id="4622038">)</span>&nbsp;<span class="ident" id="4622040">newAction</span><span class="op" id="4622049">(</span><span class="ident" id="4622050">pos</span>&nbsp;<span class="ident" id="4622054">Pos</span><span class="op" id="4622057">,</span>&nbsp;<span class="ident" id="4622059">line</span>&nbsp;<span class="builtintype" id="4622064">int</span><span class="op" id="4622067">,</span>&nbsp;<span class="ident" id="4622069">pipe</span>&nbsp;<span class="op" id="4622074">*</span><span class="ident" id="4622075">PipeNode</span><span class="op" id="4622083">)</span>&nbsp;<span class="op" id="4622085">*</span><span class="ident" id="4622086">ActionNode</span>&nbsp;<span class="op" id="4622097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622100">return</span>&nbsp;<span class="op" id="4622107">&amp;</span><span class="ident" id="4622108">ActionNode</span><span class="op" id="4622118">{</span><span class="ident" id="4622119">tr</span><span class="op" id="4622121">:</span>&nbsp;<span class="ident" id="4622123">t</span><span class="op" id="4622124">,</span>&nbsp;<span class="ident" id="4622126">NodeType</span><span class="op" id="4622134">:</span>&nbsp;<span class="ident" id="4622136">NodeAction</span><span class="op" id="4622146">,</span>&nbsp;<span class="ident" id="4622148">Pos</span><span class="op" id="4622151">:</span>&nbsp;<span class="ident" id="4622153">pos</span><span class="op" id="4622156">,</span>&nbsp;<span class="ident" id="4622158">Line</span><span class="op" id="4622162">:</span>&nbsp;<span class="ident" id="4622164">line</span><span class="op" id="4622168">,</span>&nbsp;<span class="ident" id="4622170">Pipe</span><span class="op" id="4622174">:</span>&nbsp;<span class="ident" id="4622176">pipe</span><span class="op" id="4622180">}</span><br>
<span class="lineno"></span><span class="op" id="4622182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4622185">func</span>&nbsp;<span class="op" id="4622190">(</span><span class="ident" id="4622191">a</span>&nbsp;<span class="op" id="4622193">*</span><span class="ident" id="4622194">ActionNode</span><span class="op" id="4622204">)</span>&nbsp;<span class="ident" id="4622206">String</span><span class="op" id="4622212">(</span><span class="op" id="4622213">)</span>&nbsp;<span class="builtintype" id="4622215">string</span>&nbsp;<span class="op" id="4622222">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622225">return</span>&nbsp;<span class="ident" id="4622232">fmt</span><span class="op" id="4622235">.</span><span class="ident" id="4622236">Sprintf</span><span class="op" id="4622243">(</span><span class="string" id="4622244">&#34;{{%s}}&#34;</span><span class="op" id="4622252">,</span>&nbsp;<span class="ident" id="4622254">a</span><span class="op" id="4622255">.</span><span class="ident" id="4622256">Pipe</span><span class="op" id="4622260">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="4622263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4622266">func</span>&nbsp;<span class="op" id="4622271">(</span><span class="ident" id="4622272">a</span>&nbsp;<span class="op" id="4622274">*</span><span class="ident" id="4622275">ActionNode</span><span class="op" id="4622285">)</span>&nbsp;<span class="ident" id="4622287">tree</span><span class="op" id="4622291">(</span><span class="op" id="4622292">)</span>&nbsp;<span class="op" id="4622294">*</span><span class="ident" id="4622295">Tree</span>&nbsp;<span class="op" id="4622300">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622303">return</span>&nbsp;<span class="ident" id="4622310">a</span><span class="op" id="4622311">.</span><span class="ident" id="4622312">tr</span><br>
<span class="lineno"></span><span class="op" id="4622315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4622318">func</span>&nbsp;<span class="op" id="4622323">(</span><span class="ident" id="4622324">a</span>&nbsp;<span class="op" id="4622326">*</span><span class="ident" id="4622327">ActionNode</span><span class="op" id="4622337">)</span>&nbsp;<span class="ident" id="4622339">Copy</span><span class="op" id="4622343">(</span><span class="op" id="4622344">)</span>&nbsp;<span class="ident" id="4622346">Node</span>&nbsp;<span class="op" id="4622351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622354">return</span>&nbsp;<span class="ident" id="4622361">a</span><span class="op" id="4622362">.</span><span class="ident" id="4622363">tr</span><span class="op" id="4622365">.</span><span class="ident" id="4622366">newAction</span><span class="op" id="4622375">(</span><span class="ident" id="4622376">a</span><span class="op" id="4622377">.</span><span class="ident" id="4622378">Pos</span><span class="op" id="4622381">,</span>&nbsp;<span class="ident" id="4622383">a</span><span class="op" id="4622384">.</span><span class="ident" id="4622385">Line</span><span class="op" id="4622389">,</span>&nbsp;<span class="ident" id="4622391">a</span><span class="op" id="4622392">.</span><span class="ident" id="4622393">Pipe</span><span class="op" id="4622397">.</span><span class="ident" id="4622398">CopyPipe</span><span class="op" id="4622406">(</span><span class="op" id="4622407">)</span><span class="op" id="4622408">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="4622411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4622414">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="4622487">type</span>&nbsp;<span class="ident" id="4622492">CommandNode</span>&nbsp;<span class="keyword" id="4622504">struct</span>&nbsp;<span class="op" id="4622511">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622514">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622524">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622529">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4622534">*</span><span class="ident" id="4622535">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622541">Args</span>&nbsp;<span class="op" id="4622546">[</span><span class="op" id="4622547">]</span><span class="ident" id="4622548">Node</span>&nbsp;<span class="comment" id="4622553">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4622616">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="4622619">func</span>&nbsp;<span class="op" id="4622624">(</span><span class="ident" id="4622625">t</span>&nbsp;<span class="op" id="4622627">*</span><span class="ident" id="4622628">Tree</span><span class="op" id="4622632">)</span>&nbsp;<span class="ident" id="4622634">newCommand</span><span class="op" id="4622644">(</span><span class="ident" id="4622645">pos</span>&nbsp;<span class="ident" id="4622649">Pos</span><span class="op" id="4622652">)</span>&nbsp;<span class="op" id="4622654">*</span><span class="ident" id="4622655">CommandNode</span>&nbsp;<span class="op" id="4622667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622670">return</span>&nbsp;<span class="op" id="4622677">&amp;</span><span class="ident" id="4622678">CommandNode</span><span class="op" id="4622689">{</span><span class="ident" id="4622690">tr</span><span class="op" id="4622692">:</span>&nbsp;<span class="ident" id="4622694">t</span><span class="op" id="4622695">,</span>&nbsp;<span class="ident" id="4622697">NodeType</span><span class="op" id="4622705">:</span>&nbsp;<span class="ident" id="4622707">NodeCommand</span><span class="op" id="4622718">,</span>&nbsp;<span class="ident" id="4622720">Pos</span><span class="op" id="4622723">:</span>&nbsp;<span class="ident" id="4622725">pos</span><span class="op" id="4622728">}</span><br>
<span class="lineno"></span><span class="op" id="4622730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="4622733">func</span>&nbsp;<span class="op" id="4622738">(</span><span class="ident" id="4622739">c</span>&nbsp;<span class="op" id="4622741">*</span><span class="ident" id="4622742">CommandNode</span><span class="op" id="4622753">)</span>&nbsp;<span class="builtinfunc" id="4622755">append</span><span class="op" id="4622761">(</span><span class="ident" id="4622762">arg</span>&nbsp;<span class="ident" id="4622766">Node</span><span class="op" id="4622770">)</span>&nbsp;<span class="op" id="4622772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622775">c</span><span class="op" id="4622776">.</span><span class="ident" id="4622777">Args</span>&nbsp;<span class="op" id="4622782">=</span>&nbsp;<span class="builtinfunc" id="4622784">append</span><span class="op" id="4622790">(</span><span class="ident" id="4622791">c</span><span class="op" id="4622792">.</span><span class="ident" id="4622793">Args</span><span class="op" id="4622797">,</span>&nbsp;<span class="ident" id="4622799">arg</span><span class="op" id="4622802">)</span><br>
<span class="lineno"></span><span class="op" id="4622804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4622807">func</span>&nbsp;<span class="op" id="4622812">(</span><span class="ident" id="4622813">c</span>&nbsp;<span class="op" id="4622815">*</span><span class="ident" id="4622816">CommandNode</span><span class="op" id="4622827">)</span>&nbsp;<span class="ident" id="4622829">String</span><span class="op" id="4622835">(</span><span class="op" id="4622836">)</span>&nbsp;<span class="builtintype" id="4622838">string</span>&nbsp;<span class="op" id="4622845">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622848">s</span>&nbsp;<span class="op" id="4622850">:=</span>&nbsp;<span class="string" id="4622853">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622857">for</span>&nbsp;<span class="ident" id="4622861">i</span><span class="op" id="4622862">,</span>&nbsp;<span class="ident" id="4622864">arg</span>&nbsp;<span class="op" id="4622868">:=</span>&nbsp;<span class="keyword" id="4622871">range</span>&nbsp;<span class="ident" id="4622877">c</span><span class="op" id="4622878">.</span><span class="ident" id="4622879">Args</span>&nbsp;<span class="op" id="4622884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622888">if</span>&nbsp;<span class="ident" id="4622891">i</span>&nbsp;<span class="op" id="4622893">&gt;</span>&nbsp;<span class="num" id="4622895">0</span>&nbsp;<span class="op" id="4622897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622902">s</span>&nbsp;<span class="op" id="4622904">+=</span>&nbsp;<span class="string" id="4622907">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4622913">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622917">if</span>&nbsp;<span class="ident" id="4622920">arg</span><span class="op" id="4622923">,</span>&nbsp;<span class="ident" id="4622925">ok</span>&nbsp;<span class="op" id="4622928">:=</span>&nbsp;<span class="ident" id="4622931">arg</span><span class="op" id="4622934">.</span><span class="op" id="4622935">(</span><span class="op" id="4622936">*</span><span class="ident" id="4622937">PipeNode</span><span class="op" id="4622945">)</span><span class="op" id="4622946">;</span>&nbsp;<span class="ident" id="4622948">ok</span>&nbsp;<span class="op" id="4622951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622956">s</span>&nbsp;<span class="op" id="4622958">+=</span>&nbsp;<span class="string" id="4622961">&#34;(&#34;</span>&nbsp;<span class="op" id="4622965">+</span>&nbsp;<span class="ident" id="4622967">arg</span><span class="op" id="4622970">.</span><span class="ident" id="4622971">String</span><span class="op" id="4622977">(</span><span class="op" id="4622978">)</span>&nbsp;<span class="op" id="4622980">+</span>&nbsp;<span class="string" id="4622982">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622989">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4623000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623004">s</span>&nbsp;<span class="op" id="4623006">+=</span>&nbsp;<span class="ident" id="4623009">arg</span><span class="op" id="4623012">.</span><span class="ident" id="4623013">String</span><span class="op" id="4623019">(</span><span class="op" id="4623020">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4623023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623026">return</span>&nbsp;<span class="ident" id="4623033">s</span><br>
<span class="lineno"></span><span class="op" id="4623035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4623038">func</span>&nbsp;<span class="op" id="4623043">(</span><span class="ident" id="4623044">c</span>&nbsp;<span class="op" id="4623046">*</span><span class="ident" id="4623047">CommandNode</span><span class="op" id="4623058">)</span>&nbsp;<span class="ident" id="4623060">tree</span><span class="op" id="4623064">(</span><span class="op" id="4623065">)</span>&nbsp;<span class="op" id="4623067">*</span><span class="ident" id="4623068">Tree</span>&nbsp;<span class="op" id="4623073">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623076">return</span>&nbsp;<span class="ident" id="4623083">c</span><span class="op" id="4623084">.</span><span class="ident" id="4623085">tr</span><br>
<span class="lineno"></span><span class="op" id="4623088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4623091">func</span>&nbsp;<span class="op" id="4623096">(</span><span class="ident" id="4623097">c</span>&nbsp;<span class="op" id="4623099">*</span><span class="ident" id="4623100">CommandNode</span><span class="op" id="4623111">)</span>&nbsp;<span class="ident" id="4623113">Copy</span><span class="op" id="4623117">(</span><span class="op" id="4623118">)</span>&nbsp;<span class="ident" id="4623120">Node</span>&nbsp;<span class="op" id="4623125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623128">if</span>&nbsp;<span class="ident" id="4623131">c</span>&nbsp;<span class="op" id="4623133">==</span>&nbsp;<span class="ident" id="4623136">nil</span>&nbsp;<span class="op" id="4623140">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623144">return</span>&nbsp;<span class="ident" id="4623151">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4623154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623157">n</span>&nbsp;<span class="op" id="4623159">:=</span>&nbsp;<span class="ident" id="4623162">c</span><span class="op" id="4623163">.</span><span class="ident" id="4623164">tr</span><span class="op" id="4623166">.</span><span class="ident" id="4623167">newCommand</span><span class="op" id="4623177">(</span><span class="ident" id="4623178">c</span><span class="op" id="4623179">.</span><span class="ident" id="4623180">Pos</span><span class="op" id="4623183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623186">for</span>&nbsp;<span class="ident" id="4623190">_</span><span class="op" id="4623191">,</span>&nbsp;<span class="ident" id="4623193">c</span>&nbsp;<span class="op" id="4623195">:=</span>&nbsp;<span class="keyword" id="4623198">range</span>&nbsp;<span class="ident" id="4623204">c</span><span class="op" id="4623205">.</span><span class="ident" id="4623206">Args</span>&nbsp;<span class="op" id="4623211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623215">n</span><span class="op" id="4623216">.</span><span class="builtinfunc" id="4623217">append</span><span class="op" id="4623223">(</span><span class="ident" id="4623224">c</span><span class="op" id="4623225">.</span><span class="ident" id="4623226">Copy</span><span class="op" id="4623230">(</span><span class="op" id="4623231">)</span><span class="op" id="4623232">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4623235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623238">return</span>&nbsp;<span class="ident" id="4623245">n</span><br>
<span class="lineno"></span><span class="op" id="4623247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623250">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="4623289">type</span>&nbsp;<span class="ident" id="4623294">IdentifierNode</span>&nbsp;<span class="keyword" id="4623309">struct</span>&nbsp;<span class="op" id="4623316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623319">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623329">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623334">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623340">*</span><span class="ident" id="4623341">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623347">Ident</span>&nbsp;<span class="builtintype" id="4623353">string</span>&nbsp;<span class="comment" id="4623360">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="4623386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623389">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4623467">func</span>&nbsp;<span class="ident" id="4623472">NewIdentifier</span><span class="op" id="4623485">(</span><span class="ident" id="4623486">ident</span>&nbsp;<span class="builtintype" id="4623492">string</span><span class="op" id="4623498">)</span>&nbsp;<span class="op" id="4623500">*</span><span class="ident" id="4623501">IdentifierNode</span>&nbsp;<span class="op" id="4623516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623519">return</span>&nbsp;<span class="op" id="4623526">&amp;</span><span class="ident" id="4623527">IdentifierNode</span><span class="op" id="4623541">{</span><span class="ident" id="4623542">NodeType</span><span class="op" id="4623550">:</span>&nbsp;<span class="ident" id="4623552">NodeIdentifier</span><span class="op" id="4623566">,</span>&nbsp;<span class="ident" id="4623568">Ident</span><span class="op" id="4623573">:</span>&nbsp;<span class="ident" id="4623575">ident</span><span class="op" id="4623580">}</span><br>
<span class="lineno">290</span><span class="op" id="4623582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623585">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4623681">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4623709">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="4623731">func</span>&nbsp;<span class="op" id="4623736">(</span><span class="ident" id="4623737">i</span>&nbsp;<span class="op" id="4623739">*</span><span class="ident" id="4623740">IdentifierNode</span><span class="op" id="4623754">)</span>&nbsp;<span class="ident" id="4623756">SetPos</span><span class="op" id="4623762">(</span><span class="ident" id="4623763">pos</span>&nbsp;<span class="ident" id="4623767">Pos</span><span class="op" id="4623770">)</span>&nbsp;<span class="op" id="4623772">*</span><span class="ident" id="4623773">IdentifierNode</span>&nbsp;<span class="op" id="4623788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623791">i</span><span class="op" id="4623792">.</span><span class="ident" id="4623793">Pos</span>&nbsp;<span class="op" id="4623797">=</span>&nbsp;<span class="ident" id="4623799">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623804">return</span>&nbsp;<span class="ident" id="4623811">i</span><br>
<span class="lineno"></span><span class="op" id="4623813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="4623816">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4623929">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4623957">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="4623979">func</span>&nbsp;<span class="op" id="4623984">(</span><span class="ident" id="4623985">i</span>&nbsp;<span class="op" id="4623987">*</span><span class="ident" id="4623988">IdentifierNode</span><span class="op" id="4624002">)</span>&nbsp;<span class="ident" id="4624004">SetTree</span><span class="op" id="4624011">(</span><span class="ident" id="4624012">t</span>&nbsp;<span class="op" id="4624014">*</span><span class="ident" id="4624015">Tree</span><span class="op" id="4624019">)</span>&nbsp;<span class="op" id="4624021">*</span><span class="ident" id="4624022">IdentifierNode</span>&nbsp;<span class="op" id="4624037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624040">i</span><span class="op" id="4624041">.</span><span class="ident" id="4624042">tr</span>&nbsp;<span class="op" id="4624045">=</span>&nbsp;<span class="ident" id="4624047">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624050">return</span>&nbsp;<span class="ident" id="4624057">i</span><br>
<span class="lineno"></span><span class="op" id="4624059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624062">func</span>&nbsp;<span class="op" id="4624067">(</span><span class="ident" id="4624068">i</span>&nbsp;<span class="op" id="4624070">*</span><span class="ident" id="4624071">IdentifierNode</span><span class="op" id="4624085">)</span>&nbsp;<span class="ident" id="4624087">String</span><span class="op" id="4624093">(</span><span class="op" id="4624094">)</span>&nbsp;<span class="builtintype" id="4624096">string</span>&nbsp;<span class="op" id="4624103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624106">return</span>&nbsp;<span class="ident" id="4624113">i</span><span class="op" id="4624114">.</span><span class="ident" id="4624115">Ident</span><br>
<span class="lineno">310</span><span class="op" id="4624121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624124">func</span>&nbsp;<span class="op" id="4624129">(</span><span class="ident" id="4624130">i</span>&nbsp;<span class="op" id="4624132">*</span><span class="ident" id="4624133">IdentifierNode</span><span class="op" id="4624147">)</span>&nbsp;<span class="ident" id="4624149">tree</span><span class="op" id="4624153">(</span><span class="op" id="4624154">)</span>&nbsp;<span class="op" id="4624156">*</span><span class="ident" id="4624157">Tree</span>&nbsp;<span class="op" id="4624162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624165">return</span>&nbsp;<span class="ident" id="4624172">i</span><span class="op" id="4624173">.</span><span class="ident" id="4624174">tr</span><br>
<span class="lineno"></span><span class="op" id="4624177">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4624180">func</span>&nbsp;<span class="op" id="4624185">(</span><span class="ident" id="4624186">i</span>&nbsp;<span class="op" id="4624188">*</span><span class="ident" id="4624189">IdentifierNode</span><span class="op" id="4624203">)</span>&nbsp;<span class="ident" id="4624205">Copy</span><span class="op" id="4624209">(</span><span class="op" id="4624210">)</span>&nbsp;<span class="ident" id="4624212">Node</span>&nbsp;<span class="op" id="4624217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624220">return</span>&nbsp;<span class="ident" id="4624227">NewIdentifier</span><span class="op" id="4624240">(</span><span class="ident" id="4624241">i</span><span class="op" id="4624242">.</span><span class="ident" id="4624243">Ident</span><span class="op" id="4624248">)</span><span class="op" id="4624249">.</span><span class="ident" id="4624250">SetTree</span><span class="op" id="4624257">(</span><span class="ident" id="4624258">i</span><span class="op" id="4624259">.</span><span class="ident" id="4624260">tr</span><span class="op" id="4624262">)</span><span class="op" id="4624263">.</span><span class="ident" id="4624264">SetPos</span><span class="op" id="4624270">(</span><span class="ident" id="4624271">i</span><span class="op" id="4624272">.</span><span class="ident" id="4624273">Pos</span><span class="op" id="4624276">)</span><br>
<span class="lineno"></span><span class="op" id="4624278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="4624281">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4624357">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4624415">type</span>&nbsp;<span class="ident" id="4624420">VariableNode</span>&nbsp;<span class="keyword" id="4624433">struct</span>&nbsp;<span class="op" id="4624440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624443">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624453">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624458">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624464">*</span><span class="ident" id="4624465">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624471">Ident</span>&nbsp;<span class="op" id="4624477">[</span><span class="op" id="4624478">]</span><span class="builtintype" id="4624479">string</span>&nbsp;<span class="comment" id="4624486">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4624532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624535">func</span>&nbsp;<span class="op" id="4624540">(</span><span class="ident" id="4624541">t</span>&nbsp;<span class="op" id="4624543">*</span><span class="ident" id="4624544">Tree</span><span class="op" id="4624548">)</span>&nbsp;<span class="ident" id="4624550">newVariable</span><span class="op" id="4624561">(</span><span class="ident" id="4624562">pos</span>&nbsp;<span class="ident" id="4624566">Pos</span><span class="op" id="4624569">,</span>&nbsp;<span class="ident" id="4624571">ident</span>&nbsp;<span class="builtintype" id="4624577">string</span><span class="op" id="4624583">)</span>&nbsp;<span class="op" id="4624585">*</span><span class="ident" id="4624586">VariableNode</span>&nbsp;<span class="op" id="4624599">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624602">return</span>&nbsp;<span class="op" id="4624609">&amp;</span><span class="ident" id="4624610">VariableNode</span><span class="op" id="4624622">{</span><span class="ident" id="4624623">tr</span><span class="op" id="4624625">:</span>&nbsp;<span class="ident" id="4624627">t</span><span class="op" id="4624628">,</span>&nbsp;<span class="ident" id="4624630">NodeType</span><span class="op" id="4624638">:</span>&nbsp;<span class="ident" id="4624640">NodeVariable</span><span class="op" id="4624652">,</span>&nbsp;<span class="ident" id="4624654">Pos</span><span class="op" id="4624657">:</span>&nbsp;<span class="ident" id="4624659">pos</span><span class="op" id="4624662">,</span>&nbsp;<span class="ident" id="4624664">Ident</span><span class="op" id="4624669">:</span>&nbsp;<span class="ident" id="4624671">strings</span><span class="op" id="4624678">.</span><span class="ident" id="4624679">Split</span><span class="op" id="4624684">(</span><span class="ident" id="4624685">ident</span><span class="op" id="4624690">,</span>&nbsp;<span class="string" id="4624692">&#34;.&#34;</span><span class="op" id="4624695">)</span><span class="op" id="4624696">}</span><br>
<span class="lineno"></span><span class="op" id="4624698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624701">func</span>&nbsp;<span class="op" id="4624706">(</span><span class="ident" id="4624707">v</span>&nbsp;<span class="op" id="4624709">*</span><span class="ident" id="4624710">VariableNode</span><span class="op" id="4624722">)</span>&nbsp;<span class="ident" id="4624724">String</span><span class="op" id="4624730">(</span><span class="op" id="4624731">)</span>&nbsp;<span class="builtintype" id="4624733">string</span>&nbsp;<span class="op" id="4624740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624743">s</span>&nbsp;<span class="op" id="4624745">:=</span>&nbsp;<span class="string" id="4624748">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624752">for</span>&nbsp;<span class="ident" id="4624756">i</span><span class="op" id="4624757">,</span>&nbsp;<span class="ident" id="4624759">id</span>&nbsp;<span class="op" id="4624762">:=</span>&nbsp;<span class="keyword" id="4624765">range</span>&nbsp;<span class="ident" id="4624771">v</span><span class="op" id="4624772">.</span><span class="ident" id="4624773">Ident</span>&nbsp;<span class="op" id="4624779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624783">if</span>&nbsp;<span class="ident" id="4624786">i</span>&nbsp;<span class="op" id="4624788">&gt;</span>&nbsp;<span class="num" id="4624790">0</span>&nbsp;<span class="op" id="4624792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624797">s</span>&nbsp;<span class="op" id="4624799">+=</span>&nbsp;<span class="string" id="4624802">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624812">s</span>&nbsp;<span class="op" id="4624814">+=</span>&nbsp;<span class="ident" id="4624817">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624824">return</span>&nbsp;<span class="ident" id="4624831">s</span><br>
<span class="lineno"></span><span class="op" id="4624833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624836">func</span>&nbsp;<span class="op" id="4624841">(</span><span class="ident" id="4624842">v</span>&nbsp;<span class="op" id="4624844">*</span><span class="ident" id="4624845">VariableNode</span><span class="op" id="4624857">)</span>&nbsp;<span class="ident" id="4624859">tree</span><span class="op" id="4624863">(</span><span class="op" id="4624864">)</span>&nbsp;<span class="op" id="4624866">*</span><span class="ident" id="4624867">Tree</span>&nbsp;<span class="op" id="4624872">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624875">return</span>&nbsp;<span class="ident" id="4624882">v</span><span class="op" id="4624883">.</span><span class="ident" id="4624884">tr</span><br>
<span class="lineno"></span><span class="op" id="4624887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624890">func</span>&nbsp;<span class="op" id="4624895">(</span><span class="ident" id="4624896">v</span>&nbsp;<span class="op" id="4624898">*</span><span class="ident" id="4624899">VariableNode</span><span class="op" id="4624911">)</span>&nbsp;<span class="ident" id="4624913">Copy</span><span class="op" id="4624917">(</span><span class="op" id="4624918">)</span>&nbsp;<span class="ident" id="4624920">Node</span>&nbsp;<span class="op" id="4624925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624928">return</span>&nbsp;<span class="op" id="4624935">&amp;</span><span class="ident" id="4624936">VariableNode</span><span class="op" id="4624948">{</span><span class="ident" id="4624949">tr</span><span class="op" id="4624951">:</span>&nbsp;<span class="ident" id="4624953">v</span><span class="op" id="4624954">.</span><span class="ident" id="4624955">tr</span><span class="op" id="4624957">,</span>&nbsp;<span class="ident" id="4624959">NodeType</span><span class="op" id="4624967">:</span>&nbsp;<span class="ident" id="4624969">NodeVariable</span><span class="op" id="4624981">,</span>&nbsp;<span class="ident" id="4624983">Pos</span><span class="op" id="4624986">:</span>&nbsp;<span class="ident" id="4624988">v</span><span class="op" id="4624989">.</span><span class="ident" id="4624990">Pos</span><span class="op" id="4624993">,</span>&nbsp;<span class="ident" id="4624995">Ident</span><span class="op" id="4625000">:</span>&nbsp;<span class="builtinfunc" id="4625002">append</span><span class="op" id="4625008">(</span><span class="op" id="4625009">[</span><span class="op" id="4625010">]</span><span class="builtintype" id="4625011">string</span><span class="op" id="4625017">{</span><span class="op" id="4625018">}</span><span class="op" id="4625019">,</span>&nbsp;<span class="ident" id="4625021">v</span><span class="op" id="4625022">.</span><span class="ident" id="4625023">Ident</span><span class="op" id="4625028">...</span><span class="op" id="4625031">)</span><span class="op" id="4625032">}</span><br>
<span class="lineno">350</span><span class="op" id="4625034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4625037">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="4625082">type</span>&nbsp;<span class="ident" id="4625087">DotNode</span>&nbsp;<span class="keyword" id="4625095">struct</span>&nbsp;<span class="op" id="4625102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625105">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625115">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625120">tr</span>&nbsp;<span class="op" id="4625123">*</span><span class="ident" id="4625124">Tree</span><br>
<span class="lineno"></span><span class="op" id="4625129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625132">func</span>&nbsp;<span class="op" id="4625137">(</span><span class="ident" id="4625138">t</span>&nbsp;<span class="op" id="4625140">*</span><span class="ident" id="4625141">Tree</span><span class="op" id="4625145">)</span>&nbsp;<span class="ident" id="4625147">newDot</span><span class="op" id="4625153">(</span><span class="ident" id="4625154">pos</span>&nbsp;<span class="ident" id="4625158">Pos</span><span class="op" id="4625161">)</span>&nbsp;<span class="op" id="4625163">*</span><span class="ident" id="4625164">DotNode</span>&nbsp;<span class="op" id="4625172">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625175">return</span>&nbsp;<span class="op" id="4625182">&amp;</span><span class="ident" id="4625183">DotNode</span><span class="op" id="4625190">{</span><span class="ident" id="4625191">tr</span><span class="op" id="4625193">:</span>&nbsp;<span class="ident" id="4625195">t</span><span class="op" id="4625196">,</span>&nbsp;<span class="ident" id="4625198">NodeType</span><span class="op" id="4625206">:</span>&nbsp;<span class="ident" id="4625208">NodeDot</span><span class="op" id="4625215">,</span>&nbsp;<span class="ident" id="4625217">Pos</span><span class="op" id="4625220">:</span>&nbsp;<span class="ident" id="4625222">pos</span><span class="op" id="4625225">}</span><br>
<span class="lineno"></span><span class="op" id="4625227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625230">func</span>&nbsp;<span class="op" id="4625235">(</span><span class="ident" id="4625236">d</span>&nbsp;<span class="op" id="4625238">*</span><span class="ident" id="4625239">DotNode</span><span class="op" id="4625246">)</span>&nbsp;<span class="ident" id="4625248">Type</span><span class="op" id="4625252">(</span><span class="op" id="4625253">)</span>&nbsp;<span class="ident" id="4625255">NodeType</span>&nbsp;<span class="op" id="4625264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4625267">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4625331">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4625399">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625423">return</span>&nbsp;<span class="ident" id="4625430">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="4625438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="4625441">func</span>&nbsp;<span class="op" id="4625446">(</span><span class="ident" id="4625447">d</span>&nbsp;<span class="op" id="4625449">*</span><span class="ident" id="4625450">DotNode</span><span class="op" id="4625457">)</span>&nbsp;<span class="ident" id="4625459">String</span><span class="op" id="4625465">(</span><span class="op" id="4625466">)</span>&nbsp;<span class="builtintype" id="4625468">string</span>&nbsp;<span class="op" id="4625475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625478">return</span>&nbsp;<span class="string" id="4625485">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="4625489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625492">func</span>&nbsp;<span class="op" id="4625497">(</span><span class="ident" id="4625498">d</span>&nbsp;<span class="op" id="4625500">*</span><span class="ident" id="4625501">DotNode</span><span class="op" id="4625508">)</span>&nbsp;<span class="ident" id="4625510">tree</span><span class="op" id="4625514">(</span><span class="op" id="4625515">)</span>&nbsp;<span class="op" id="4625517">*</span><span class="ident" id="4625518">Tree</span>&nbsp;<span class="op" id="4625523">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625526">return</span>&nbsp;<span class="ident" id="4625533">d</span><span class="op" id="4625534">.</span><span class="ident" id="4625535">tr</span><br>
<span class="lineno"></span><span class="op" id="4625538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625541">func</span>&nbsp;<span class="op" id="4625546">(</span><span class="ident" id="4625547">d</span>&nbsp;<span class="op" id="4625549">*</span><span class="ident" id="4625550">DotNode</span><span class="op" id="4625557">)</span>&nbsp;<span class="ident" id="4625559">Copy</span><span class="op" id="4625563">(</span><span class="op" id="4625564">)</span>&nbsp;<span class="ident" id="4625566">Node</span>&nbsp;<span class="op" id="4625571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625574">return</span>&nbsp;<span class="ident" id="4625581">d</span><span class="op" id="4625582">.</span><span class="ident" id="4625583">tr</span><span class="op" id="4625585">.</span><span class="ident" id="4625586">newDot</span><span class="op" id="4625592">(</span><span class="ident" id="4625593">d</span><span class="op" id="4625594">.</span><span class="ident" id="4625595">Pos</span><span class="op" id="4625598">)</span><br>
<span class="lineno">380</span><span class="op" id="4625600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4625603">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4625687">type</span>&nbsp;<span class="ident" id="4625692">NilNode</span>&nbsp;<span class="keyword" id="4625700">struct</span>&nbsp;<span class="op" id="4625707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625710">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625720">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625725">tr</span>&nbsp;<span class="op" id="4625728">*</span><span class="ident" id="4625729">Tree</span><br>
<span class="lineno"></span><span class="op" id="4625734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625737">func</span>&nbsp;<span class="op" id="4625742">(</span><span class="ident" id="4625743">t</span>&nbsp;<span class="op" id="4625745">*</span><span class="ident" id="4625746">Tree</span><span class="op" id="4625750">)</span>&nbsp;<span class="ident" id="4625752">newNil</span><span class="op" id="4625758">(</span><span class="ident" id="4625759">pos</span>&nbsp;<span class="ident" id="4625763">Pos</span><span class="op" id="4625766">)</span>&nbsp;<span class="op" id="4625768">*</span><span class="ident" id="4625769">NilNode</span>&nbsp;<span class="op" id="4625777">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625780">return</span>&nbsp;<span class="op" id="4625787">&amp;</span><span class="ident" id="4625788">NilNode</span><span class="op" id="4625795">{</span><span class="ident" id="4625796">tr</span><span class="op" id="4625798">:</span>&nbsp;<span class="ident" id="4625800">t</span><span class="op" id="4625801">,</span>&nbsp;<span class="ident" id="4625803">NodeType</span><span class="op" id="4625811">:</span>&nbsp;<span class="ident" id="4625813">NodeNil</span><span class="op" id="4625820">,</span>&nbsp;<span class="ident" id="4625822">Pos</span><span class="op" id="4625825">:</span>&nbsp;<span class="ident" id="4625827">pos</span><span class="op" id="4625830">}</span><br>
<span class="lineno"></span><span class="op" id="4625832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625835">func</span>&nbsp;<span class="op" id="4625840">(</span><span class="ident" id="4625841">n</span>&nbsp;<span class="op" id="4625843">*</span><span class="ident" id="4625844">NilNode</span><span class="op" id="4625851">)</span>&nbsp;<span class="ident" id="4625853">Type</span><span class="op" id="4625857">(</span><span class="op" id="4625858">)</span>&nbsp;<span class="ident" id="4625860">NodeType</span>&nbsp;<span class="op" id="4625869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4625872">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4625936">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4626004">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626028">return</span>&nbsp;<span class="ident" id="4626035">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="4626043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="4626046">func</span>&nbsp;<span class="op" id="4626051">(</span><span class="ident" id="4626052">n</span>&nbsp;<span class="op" id="4626054">*</span><span class="ident" id="4626055">NilNode</span><span class="op" id="4626062">)</span>&nbsp;<span class="ident" id="4626064">String</span><span class="op" id="4626070">(</span><span class="op" id="4626071">)</span>&nbsp;<span class="builtintype" id="4626073">string</span>&nbsp;<span class="op" id="4626080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626083">return</span>&nbsp;<span class="string" id="4626090">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="4626096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626099">func</span>&nbsp;<span class="op" id="4626104">(</span><span class="ident" id="4626105">n</span>&nbsp;<span class="op" id="4626107">*</span><span class="ident" id="4626108">NilNode</span><span class="op" id="4626115">)</span>&nbsp;<span class="ident" id="4626117">tree</span><span class="op" id="4626121">(</span><span class="op" id="4626122">)</span>&nbsp;<span class="op" id="4626124">*</span><span class="ident" id="4626125">Tree</span>&nbsp;<span class="op" id="4626130">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626133">return</span>&nbsp;<span class="ident" id="4626140">n</span><span class="op" id="4626141">.</span><span class="ident" id="4626142">tr</span><br>
<span class="lineno"></span><span class="op" id="4626145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626148">func</span>&nbsp;<span class="op" id="4626153">(</span><span class="ident" id="4626154">n</span>&nbsp;<span class="op" id="4626156">*</span><span class="ident" id="4626157">NilNode</span><span class="op" id="4626164">)</span>&nbsp;<span class="ident" id="4626166">Copy</span><span class="op" id="4626170">(</span><span class="op" id="4626171">)</span>&nbsp;<span class="ident" id="4626173">Node</span>&nbsp;<span class="op" id="4626178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626181">return</span>&nbsp;<span class="ident" id="4626188">n</span><span class="op" id="4626189">.</span><span class="ident" id="4626190">tr</span><span class="op" id="4626192">.</span><span class="ident" id="4626193">newNil</span><span class="op" id="4626199">(</span><span class="ident" id="4626200">n</span><span class="op" id="4626201">.</span><span class="ident" id="4626202">Pos</span><span class="op" id="4626205">)</span><br>
<span class="lineno">410</span><span class="op" id="4626207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626210">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4626269">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4626307">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="4626349">type</span>&nbsp;<span class="ident" id="4626354">FieldNode</span>&nbsp;<span class="keyword" id="4626364">struct</span>&nbsp;<span class="op" id="4626371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626374">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626384">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626389">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626395">*</span><span class="ident" id="4626396">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626402">Ident</span>&nbsp;<span class="op" id="4626408">[</span><span class="op" id="4626409">]</span><span class="builtintype" id="4626410">string</span>&nbsp;<span class="comment" id="4626417">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="4626454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626457">func</span>&nbsp;<span class="op" id="4626462">(</span><span class="ident" id="4626463">t</span>&nbsp;<span class="op" id="4626465">*</span><span class="ident" id="4626466">Tree</span><span class="op" id="4626470">)</span>&nbsp;<span class="ident" id="4626472">newField</span><span class="op" id="4626480">(</span><span class="ident" id="4626481">pos</span>&nbsp;<span class="ident" id="4626485">Pos</span><span class="op" id="4626488">,</span>&nbsp;<span class="ident" id="4626490">ident</span>&nbsp;<span class="builtintype" id="4626496">string</span><span class="op" id="4626502">)</span>&nbsp;<span class="op" id="4626504">*</span><span class="ident" id="4626505">FieldNode</span>&nbsp;<span class="op" id="4626515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626518">return</span>&nbsp;<span class="op" id="4626525">&amp;</span><span class="ident" id="4626526">FieldNode</span><span class="op" id="4626535">{</span><span class="ident" id="4626536">tr</span><span class="op" id="4626538">:</span>&nbsp;<span class="ident" id="4626540">t</span><span class="op" id="4626541">,</span>&nbsp;<span class="ident" id="4626543">NodeType</span><span class="op" id="4626551">:</span>&nbsp;<span class="ident" id="4626553">NodeField</span><span class="op" id="4626562">,</span>&nbsp;<span class="ident" id="4626564">Pos</span><span class="op" id="4626567">:</span>&nbsp;<span class="ident" id="4626569">pos</span><span class="op" id="4626572">,</span>&nbsp;<span class="ident" id="4626574">Ident</span><span class="op" id="4626579">:</span>&nbsp;<span class="ident" id="4626581">strings</span><span class="op" id="4626588">.</span><span class="ident" id="4626589">Split</span><span class="op" id="4626594">(</span><span class="ident" id="4626595">ident</span><span class="op" id="4626600">[</span><span class="num" id="4626601">1</span><span class="op" id="4626602">:</span><span class="op" id="4626603">]</span><span class="op" id="4626604">,</span>&nbsp;<span class="string" id="4626606">&#34;.&#34;</span><span class="op" id="4626609">)</span><span class="op" id="4626610">}</span>&nbsp;<span class="comment" id="4626612">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="4626643">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4626646">func</span>&nbsp;<span class="op" id="4626651">(</span><span class="ident" id="4626652">f</span>&nbsp;<span class="op" id="4626654">*</span><span class="ident" id="4626655">FieldNode</span><span class="op" id="4626664">)</span>&nbsp;<span class="ident" id="4626666">String</span><span class="op" id="4626672">(</span><span class="op" id="4626673">)</span>&nbsp;<span class="builtintype" id="4626675">string</span>&nbsp;<span class="op" id="4626682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626685">s</span>&nbsp;<span class="op" id="4626687">:=</span>&nbsp;<span class="string" id="4626690">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626694">for</span>&nbsp;<span class="ident" id="4626698">_</span><span class="op" id="4626699">,</span>&nbsp;<span class="ident" id="4626701">id</span>&nbsp;<span class="op" id="4626704">:=</span>&nbsp;<span class="keyword" id="4626707">range</span>&nbsp;<span class="ident" id="4626713">f</span><span class="op" id="4626714">.</span><span class="ident" id="4626715">Ident</span>&nbsp;<span class="op" id="4626721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626725">s</span>&nbsp;<span class="op" id="4626727">+=</span>&nbsp;<span class="string" id="4626730">&#34;.&#34;</span>&nbsp;<span class="op" id="4626734">+</span>&nbsp;<span class="ident" id="4626736">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626743">return</span>&nbsp;<span class="ident" id="4626750">s</span><br>
<span class="lineno"></span><span class="op" id="4626752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626755">func</span>&nbsp;<span class="op" id="4626760">(</span><span class="ident" id="4626761">f</span>&nbsp;<span class="op" id="4626763">*</span><span class="ident" id="4626764">FieldNode</span><span class="op" id="4626773">)</span>&nbsp;<span class="ident" id="4626775">tree</span><span class="op" id="4626779">(</span><span class="op" id="4626780">)</span>&nbsp;<span class="op" id="4626782">*</span><span class="ident" id="4626783">Tree</span>&nbsp;<span class="op" id="4626788">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626791">return</span>&nbsp;<span class="ident" id="4626798">f</span><span class="op" id="4626799">.</span><span class="ident" id="4626800">tr</span><br>
<span class="lineno"></span><span class="op" id="4626803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626806">func</span>&nbsp;<span class="op" id="4626811">(</span><span class="ident" id="4626812">f</span>&nbsp;<span class="op" id="4626814">*</span><span class="ident" id="4626815">FieldNode</span><span class="op" id="4626824">)</span>&nbsp;<span class="ident" id="4626826">Copy</span><span class="op" id="4626830">(</span><span class="op" id="4626831">)</span>&nbsp;<span class="ident" id="4626833">Node</span>&nbsp;<span class="op" id="4626838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626841">return</span>&nbsp;<span class="op" id="4626848">&amp;</span><span class="ident" id="4626849">FieldNode</span><span class="op" id="4626858">{</span><span class="ident" id="4626859">tr</span><span class="op" id="4626861">:</span>&nbsp;<span class="ident" id="4626863">f</span><span class="op" id="4626864">.</span><span class="ident" id="4626865">tr</span><span class="op" id="4626867">,</span>&nbsp;<span class="ident" id="4626869">NodeType</span><span class="op" id="4626877">:</span>&nbsp;<span class="ident" id="4626879">NodeField</span><span class="op" id="4626888">,</span>&nbsp;<span class="ident" id="4626890">Pos</span><span class="op" id="4626893">:</span>&nbsp;<span class="ident" id="4626895">f</span><span class="op" id="4626896">.</span><span class="ident" id="4626897">Pos</span><span class="op" id="4626900">,</span>&nbsp;<span class="ident" id="4626902">Ident</span><span class="op" id="4626907">:</span>&nbsp;<span class="builtinfunc" id="4626909">append</span><span class="op" id="4626915">(</span><span class="op" id="4626916">[</span><span class="op" id="4626917">]</span><span class="builtintype" id="4626918">string</span><span class="op" id="4626924">{</span><span class="op" id="4626925">}</span><span class="op" id="4626926">,</span>&nbsp;<span class="ident" id="4626928">f</span><span class="op" id="4626929">.</span><span class="ident" id="4626930">Ident</span><span class="op" id="4626935">...</span><span class="op" id="4626938">)</span><span class="op" id="4626939">}</span><br>
<span class="lineno">440</span><span class="op" id="4626941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626944">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4627040">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4627078">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="4627122">type</span>&nbsp;<span class="ident" id="4627127">ChainNode</span>&nbsp;<span class="keyword" id="4627137">struct</span>&nbsp;<span class="op" id="4627144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627147">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627157">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627162">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627168">*</span><span class="ident" id="4627169">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627175">Node</span>&nbsp;&nbsp;<span class="ident" id="4627181">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627187">Field</span>&nbsp;<span class="op" id="4627193">[</span><span class="op" id="4627194">]</span><span class="builtintype" id="4627195">string</span>&nbsp;<span class="comment" id="4627202">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4627239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627242">func</span>&nbsp;<span class="op" id="4627247">(</span><span class="ident" id="4627248">t</span>&nbsp;<span class="op" id="4627250">*</span><span class="ident" id="4627251">Tree</span><span class="op" id="4627255">)</span>&nbsp;<span class="ident" id="4627257">newChain</span><span class="op" id="4627265">(</span><span class="ident" id="4627266">pos</span>&nbsp;<span class="ident" id="4627270">Pos</span><span class="op" id="4627273">,</span>&nbsp;<span class="ident" id="4627275">node</span>&nbsp;<span class="ident" id="4627280">Node</span><span class="op" id="4627284">)</span>&nbsp;<span class="op" id="4627286">*</span><span class="ident" id="4627287">ChainNode</span>&nbsp;<span class="op" id="4627297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627300">return</span>&nbsp;<span class="op" id="4627307">&amp;</span><span class="ident" id="4627308">ChainNode</span><span class="op" id="4627317">{</span><span class="ident" id="4627318">tr</span><span class="op" id="4627320">:</span>&nbsp;<span class="ident" id="4627322">t</span><span class="op" id="4627323">,</span>&nbsp;<span class="ident" id="4627325">NodeType</span><span class="op" id="4627333">:</span>&nbsp;<span class="ident" id="4627335">NodeChain</span><span class="op" id="4627344">,</span>&nbsp;<span class="ident" id="4627346">Pos</span><span class="op" id="4627349">:</span>&nbsp;<span class="ident" id="4627351">pos</span><span class="op" id="4627354">,</span>&nbsp;<span class="ident" id="4627356">Node</span><span class="op" id="4627360">:</span>&nbsp;<span class="ident" id="4627362">node</span><span class="op" id="4627366">}</span><br>
<span class="lineno">455</span><span class="op" id="4627368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4627371">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4627459">func</span>&nbsp;<span class="op" id="4627464">(</span><span class="ident" id="4627465">c</span>&nbsp;<span class="op" id="4627467">*</span><span class="ident" id="4627468">ChainNode</span><span class="op" id="4627477">)</span>&nbsp;<span class="ident" id="4627479">Add</span><span class="op" id="4627482">(</span><span class="ident" id="4627483">field</span>&nbsp;<span class="builtintype" id="4627489">string</span><span class="op" id="4627495">)</span>&nbsp;<span class="op" id="4627497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627500">if</span>&nbsp;<span class="builtinfunc" id="4627503">len</span><span class="op" id="4627506">(</span><span class="ident" id="4627507">field</span><span class="op" id="4627512">)</span>&nbsp;<span class="op" id="4627514">==</span>&nbsp;<span class="num" id="4627517">0</span>&nbsp;<span class="op" id="4627519">||</span>&nbsp;<span class="ident" id="4627522">field</span><span class="op" id="4627527">[</span><span class="num" id="4627528">0</span><span class="op" id="4627529">]</span>&nbsp;<span class="op" id="4627531">!=</span>&nbsp;<span class="string" id="4627534">&#39;.&#39;</span>&nbsp;<span class="op" id="4627538">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4627542">panic</span><span class="op" id="4627547">(</span><span class="string" id="4627548">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="4627565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4627568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627571">field</span>&nbsp;<span class="op" id="4627577">=</span>&nbsp;<span class="ident" id="4627579">field</span><span class="op" id="4627584">[</span><span class="num" id="4627585">1</span><span class="op" id="4627586">:</span><span class="op" id="4627587">]</span>&nbsp;<span class="comment" id="4627589">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627613">if</span>&nbsp;<span class="ident" id="4627616">field</span>&nbsp;<span class="op" id="4627622">==</span>&nbsp;<span class="string" id="4627625">&#34;&#34;</span>&nbsp;<span class="op" id="4627628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4627632">panic</span><span class="op" id="4627637">(</span><span class="string" id="4627638">&#34;empty&nbsp;field&#34;</span><span class="op" id="4627651">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4627654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627657">c</span><span class="op" id="4627658">.</span><span class="ident" id="4627659">Field</span>&nbsp;<span class="op" id="4627665">=</span>&nbsp;<span class="builtinfunc" id="4627667">append</span><span class="op" id="4627673">(</span><span class="ident" id="4627674">c</span><span class="op" id="4627675">.</span><span class="ident" id="4627676">Field</span><span class="op" id="4627681">,</span>&nbsp;<span class="ident" id="4627683">field</span><span class="op" id="4627688">)</span><br>
<span class="lineno"></span><span class="op" id="4627690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627693">func</span>&nbsp;<span class="op" id="4627698">(</span><span class="ident" id="4627699">c</span>&nbsp;<span class="op" id="4627701">*</span><span class="ident" id="4627702">ChainNode</span><span class="op" id="4627711">)</span>&nbsp;<span class="ident" id="4627713">String</span><span class="op" id="4627719">(</span><span class="op" id="4627720">)</span>&nbsp;<span class="builtintype" id="4627722">string</span>&nbsp;<span class="op" id="4627729">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627732">s</span>&nbsp;<span class="op" id="4627734">:=</span>&nbsp;<span class="ident" id="4627737">c</span><span class="op" id="4627738">.</span><span class="ident" id="4627739">Node</span><span class="op" id="4627743">.</span><span class="ident" id="4627744">String</span><span class="op" id="4627750">(</span><span class="op" id="4627751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627754">if</span>&nbsp;<span class="ident" id="4627757">_</span><span class="op" id="4627758">,</span>&nbsp;<span class="ident" id="4627760">ok</span>&nbsp;<span class="op" id="4627763">:=</span>&nbsp;<span class="ident" id="4627766">c</span><span class="op" id="4627767">.</span><span class="ident" id="4627768">Node</span><span class="op" id="4627772">.</span><span class="op" id="4627773">(</span><span class="op" id="4627774">*</span><span class="ident" id="4627775">PipeNode</span><span class="op" id="4627783">)</span><span class="op" id="4627784">;</span>&nbsp;<span class="ident" id="4627786">ok</span>&nbsp;<span class="op" id="4627789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627793">s</span>&nbsp;<span class="op" id="4627795">=</span>&nbsp;<span class="string" id="4627797">&#34;(&#34;</span>&nbsp;<span class="op" id="4627801">+</span>&nbsp;<span class="ident" id="4627803">s</span>&nbsp;<span class="op" id="4627805">+</span>&nbsp;<span class="string" id="4627807">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4627812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627815">for</span>&nbsp;<span class="ident" id="4627819">_</span><span class="op" id="4627820">,</span>&nbsp;<span class="ident" id="4627822">field</span>&nbsp;<span class="op" id="4627828">:=</span>&nbsp;<span class="keyword" id="4627831">range</span>&nbsp;<span class="ident" id="4627837">c</span><span class="op" id="4627838">.</span><span class="ident" id="4627839">Field</span>&nbsp;<span class="op" id="4627845">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627849">s</span>&nbsp;<span class="op" id="4627851">+=</span>&nbsp;<span class="string" id="4627854">&#34;.&#34;</span>&nbsp;<span class="op" id="4627858">+</span>&nbsp;<span class="ident" id="4627860">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4627867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627870">return</span>&nbsp;<span class="ident" id="4627877">s</span><br>
<span class="lineno"></span><span class="op" id="4627879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="4627882">func</span>&nbsp;<span class="op" id="4627887">(</span><span class="ident" id="4627888">c</span>&nbsp;<span class="op" id="4627890">*</span><span class="ident" id="4627891">ChainNode</span><span class="op" id="4627900">)</span>&nbsp;<span class="ident" id="4627902">tree</span><span class="op" id="4627906">(</span><span class="op" id="4627907">)</span>&nbsp;<span class="op" id="4627909">*</span><span class="ident" id="4627910">Tree</span>&nbsp;<span class="op" id="4627915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627918">return</span>&nbsp;<span class="ident" id="4627925">c</span><span class="op" id="4627926">.</span><span class="ident" id="4627927">tr</span><br>
<span class="lineno"></span><span class="op" id="4627930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627933">func</span>&nbsp;<span class="op" id="4627938">(</span><span class="ident" id="4627939">c</span>&nbsp;<span class="op" id="4627941">*</span><span class="ident" id="4627942">ChainNode</span><span class="op" id="4627951">)</span>&nbsp;<span class="ident" id="4627953">Copy</span><span class="op" id="4627957">(</span><span class="op" id="4627958">)</span>&nbsp;<span class="ident" id="4627960">Node</span>&nbsp;<span class="op" id="4627965">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627968">return</span>&nbsp;<span class="op" id="4627975">&amp;</span><span class="ident" id="4627976">ChainNode</span><span class="op" id="4627985">{</span><span class="ident" id="4627986">tr</span><span class="op" id="4627988">:</span>&nbsp;<span class="ident" id="4627990">c</span><span class="op" id="4627991">.</span><span class="ident" id="4627992">tr</span><span class="op" id="4627994">,</span>&nbsp;<span class="ident" id="4627996">NodeType</span><span class="op" id="4628004">:</span>&nbsp;<span class="ident" id="4628006">NodeChain</span><span class="op" id="4628015">,</span>&nbsp;<span class="ident" id="4628017">Pos</span><span class="op" id="4628020">:</span>&nbsp;<span class="ident" id="4628022">c</span><span class="op" id="4628023">.</span><span class="ident" id="4628024">Pos</span><span class="op" id="4628027">,</span>&nbsp;<span class="ident" id="4628029">Node</span><span class="op" id="4628033">:</span>&nbsp;<span class="ident" id="4628035">c</span><span class="op" id="4628036">.</span><span class="ident" id="4628037">Node</span><span class="op" id="4628041">,</span>&nbsp;<span class="ident" id="4628043">Field</span><span class="op" id="4628048">:</span>&nbsp;<span class="builtinfunc" id="4628050">append</span><span class="op" id="4628056">(</span><span class="op" id="4628057">[</span><span class="op" id="4628058">]</span><span class="builtintype" id="4628059">string</span><span class="op" id="4628065">{</span><span class="op" id="4628066">}</span><span class="op" id="4628067">,</span>&nbsp;<span class="ident" id="4628069">c</span><span class="op" id="4628070">.</span><span class="ident" id="4628071">Field</span><span class="op" id="4628076">...</span><span class="op" id="4628079">)</span><span class="op" id="4628080">}</span><br>
<span class="lineno"></span><span class="op" id="4628082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4628085">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4628123">type</span>&nbsp;<span class="ident" id="4628128">BoolNode</span>&nbsp;<span class="keyword" id="4628137">struct</span>&nbsp;<span class="op" id="4628144">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628147">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628157">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628162">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4628167">*</span><span class="ident" id="4628168">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628174">True</span>&nbsp;<span class="builtintype" id="4628179">bool</span>&nbsp;<span class="comment" id="4628184">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4628222">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="4628225">func</span>&nbsp;<span class="op" id="4628230">(</span><span class="ident" id="4628231">t</span>&nbsp;<span class="op" id="4628233">*</span><span class="ident" id="4628234">Tree</span><span class="op" id="4628238">)</span>&nbsp;<span class="ident" id="4628240">newBool</span><span class="op" id="4628247">(</span><span class="ident" id="4628248">pos</span>&nbsp;<span class="ident" id="4628252">Pos</span><span class="op" id="4628255">,</span>&nbsp;<span class="builtintype" id="4628257">true</span>&nbsp;<span class="builtintype" id="4628262">bool</span><span class="op" id="4628266">)</span>&nbsp;<span class="op" id="4628268">*</span><span class="ident" id="4628269">BoolNode</span>&nbsp;<span class="op" id="4628278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628281">return</span>&nbsp;<span class="op" id="4628288">&amp;</span><span class="ident" id="4628289">BoolNode</span><span class="op" id="4628297">{</span><span class="ident" id="4628298">tr</span><span class="op" id="4628300">:</span>&nbsp;<span class="ident" id="4628302">t</span><span class="op" id="4628303">,</span>&nbsp;<span class="ident" id="4628305">NodeType</span><span class="op" id="4628313">:</span>&nbsp;<span class="ident" id="4628315">NodeBool</span><span class="op" id="4628323">,</span>&nbsp;<span class="ident" id="4628325">Pos</span><span class="op" id="4628328">:</span>&nbsp;<span class="ident" id="4628330">pos</span><span class="op" id="4628333">,</span>&nbsp;<span class="ident" id="4628335">True</span><span class="op" id="4628339">:</span>&nbsp;<span class="builtintype" id="4628341">true</span><span class="op" id="4628345">}</span><br>
<span class="lineno"></span><span class="op" id="4628347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4628350">func</span>&nbsp;<span class="op" id="4628355">(</span><span class="ident" id="4628356">b</span>&nbsp;<span class="op" id="4628358">*</span><span class="ident" id="4628359">BoolNode</span><span class="op" id="4628367">)</span>&nbsp;<span class="ident" id="4628369">String</span><span class="op" id="4628375">(</span><span class="op" id="4628376">)</span>&nbsp;<span class="builtintype" id="4628378">string</span>&nbsp;<span class="op" id="4628385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628388">if</span>&nbsp;<span class="ident" id="4628391">b</span><span class="op" id="4628392">.</span><span class="ident" id="4628393">True</span>&nbsp;<span class="op" id="4628398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628402">return</span>&nbsp;<span class="string" id="4628409">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628420">return</span>&nbsp;<span class="string" id="4628427">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="4628435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4628438">func</span>&nbsp;<span class="op" id="4628443">(</span><span class="ident" id="4628444">b</span>&nbsp;<span class="op" id="4628446">*</span><span class="ident" id="4628447">BoolNode</span><span class="op" id="4628455">)</span>&nbsp;<span class="ident" id="4628457">tree</span><span class="op" id="4628461">(</span><span class="op" id="4628462">)</span>&nbsp;<span class="op" id="4628464">*</span><span class="ident" id="4628465">Tree</span>&nbsp;<span class="op" id="4628470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628473">return</span>&nbsp;<span class="ident" id="4628480">b</span><span class="op" id="4628481">.</span><span class="ident" id="4628482">tr</span><br>
<span class="lineno"></span><span class="op" id="4628485">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4628488">func</span>&nbsp;<span class="op" id="4628493">(</span><span class="ident" id="4628494">b</span>&nbsp;<span class="op" id="4628496">*</span><span class="ident" id="4628497">BoolNode</span><span class="op" id="4628505">)</span>&nbsp;<span class="ident" id="4628507">Copy</span><span class="op" id="4628511">(</span><span class="op" id="4628512">)</span>&nbsp;<span class="ident" id="4628514">Node</span>&nbsp;<span class="op" id="4628519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628522">return</span>&nbsp;<span class="ident" id="4628529">b</span><span class="op" id="4628530">.</span><span class="ident" id="4628531">tr</span><span class="op" id="4628533">.</span><span class="ident" id="4628534">newBool</span><span class="op" id="4628541">(</span><span class="ident" id="4628542">b</span><span class="op" id="4628543">.</span><span class="ident" id="4628544">Pos</span><span class="op" id="4628547">,</span>&nbsp;<span class="ident" id="4628549">b</span><span class="op" id="4628550">.</span><span class="ident" id="4628551">True</span><span class="op" id="4628555">)</span><br>
<span class="lineno"></span><span class="op" id="4628557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4628560">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="4628637">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4628721">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4628803">type</span>&nbsp;<span class="ident" id="4628808">NumberNode</span>&nbsp;<span class="keyword" id="4628819">struct</span>&nbsp;<span class="op" id="4628826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628829">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628839">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628844">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628855">*</span><span class="ident" id="4628856">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628862">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4628873">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628884">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628918">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4628929">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628940">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628983">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4628994">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629005">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629044">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="4629055">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629066">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629089">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629100">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629111">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629141">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629152">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629163">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629195">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4629206">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629217">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629247">Complex128</span>&nbsp;<span class="builtintype" id="4629258">complex128</span>&nbsp;<span class="comment" id="4629269">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629292">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4629303">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629314">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="4629369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4629372">func</span>&nbsp;<span class="op" id="4629377">(</span><span class="ident" id="4629378">t</span>&nbsp;<span class="op" id="4629380">*</span><span class="ident" id="4629381">Tree</span><span class="op" id="4629385">)</span>&nbsp;<span class="ident" id="4629387">newNumber</span><span class="op" id="4629396">(</span><span class="ident" id="4629397">pos</span>&nbsp;<span class="ident" id="4629401">Pos</span><span class="op" id="4629404">,</span>&nbsp;<span class="ident" id="4629406">text</span>&nbsp;<span class="builtintype" id="4629411">string</span><span class="op" id="4629417">,</span>&nbsp;<span class="ident" id="4629419">typ</span>&nbsp;<span class="ident" id="4629423">itemType</span><span class="op" id="4629431">)</span>&nbsp;<span class="op" id="4629433">(</span><span class="op" id="4629434">*</span><span class="ident" id="4629435">NumberNode</span><span class="op" id="4629445">,</span>&nbsp;<span class="builtintype" id="4629447">error</span><span class="op" id="4629452">)</span>&nbsp;<span class="op" id="4629454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629457">n</span>&nbsp;<span class="op" id="4629459">:=</span>&nbsp;<span class="op" id="4629462">&amp;</span><span class="ident" id="4629463">NumberNode</span><span class="op" id="4629473">{</span><span class="ident" id="4629474">tr</span><span class="op" id="4629476">:</span>&nbsp;<span class="ident" id="4629478">t</span><span class="op" id="4629479">,</span>&nbsp;<span class="ident" id="4629481">NodeType</span><span class="op" id="4629489">:</span>&nbsp;<span class="ident" id="4629491">NodeNumber</span><span class="op" id="4629501">,</span>&nbsp;<span class="ident" id="4629503">Pos</span><span class="op" id="4629506">:</span>&nbsp;<span class="ident" id="4629508">pos</span><span class="op" id="4629511">,</span>&nbsp;<span class="ident" id="4629513">Text</span><span class="op" id="4629517">:</span>&nbsp;<span class="ident" id="4629519">text</span><span class="op" id="4629523">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629526">switch</span>&nbsp;<span class="ident" id="4629533">typ</span>&nbsp;<span class="op" id="4629537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629540">case</span>&nbsp;<span class="ident" id="4629545">itemCharConstant</span><span class="op" id="4629561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4629565">rune</span><span class="op" id="4629569">,</span>&nbsp;<span class="ident" id="4629571">_</span><span class="op" id="4629572">,</span>&nbsp;<span class="ident" id="4629574">tail</span><span class="op" id="4629578">,</span>&nbsp;<span class="ident" id="4629580">err</span>&nbsp;<span class="op" id="4629584">:=</span>&nbsp;<span class="ident" id="4629587">strconv</span><span class="op" id="4629594">.</span><span class="ident" id="4629595">UnquoteChar</span><span class="op" id="4629606">(</span><span class="ident" id="4629607">text</span><span class="op" id="4629611">[</span><span class="num" id="4629612">1</span><span class="op" id="4629613">:</span><span class="op" id="4629614">]</span><span class="op" id="4629615">,</span>&nbsp;<span class="ident" id="4629617">text</span><span class="op" id="4629621">[</span><span class="num" id="4629622">0</span><span class="op" id="4629623">]</span><span class="op" id="4629624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629628">if</span>&nbsp;<span class="ident" id="4629631">err</span>&nbsp;<span class="op" id="4629635">!=</span>&nbsp;<span class="ident" id="4629638">nil</span>&nbsp;<span class="op" id="4629642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629647">return</span>&nbsp;<span class="ident" id="4629654">nil</span><span class="op" id="4629657">,</span>&nbsp;<span class="ident" id="4629659">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629669">if</span>&nbsp;<span class="ident" id="4629672">tail</span>&nbsp;<span class="op" id="4629677">!=</span>&nbsp;<span class="string" id="4629680">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4629684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629689">return</span>&nbsp;<span class="ident" id="4629696">nil</span><span class="op" id="4629699">,</span>&nbsp;<span class="ident" id="4629701">fmt</span><span class="op" id="4629704">.</span><span class="ident" id="4629705">Errorf</span><span class="op" id="4629711">(</span><span class="string" id="4629712">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="4629746">,</span>&nbsp;<span class="ident" id="4629748">text</span><span class="op" id="4629752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629760">n</span><span class="op" id="4629761">.</span><span class="ident" id="4629762">Int64</span>&nbsp;<span class="op" id="4629768">=</span>&nbsp;<span class="ident" id="4629770">int64</span><span class="op" id="4629775">(</span><span class="builtintype" id="4629776">rune</span><span class="op" id="4629780">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629784">n</span><span class="op" id="4629785">.</span><span class="ident" id="4629786">IsInt</span>&nbsp;<span class="op" id="4629792">=</span>&nbsp;<span class="builtintype" id="4629794">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629801">n</span><span class="op" id="4629802">.</span><span class="ident" id="4629803">Uint64</span>&nbsp;<span class="op" id="4629810">=</span>&nbsp;<span class="ident" id="4629812">uint64</span><span class="op" id="4629818">(</span><span class="builtintype" id="4629819">rune</span><span class="op" id="4629823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629827">n</span><span class="op" id="4629828">.</span><span class="ident" id="4629829">IsUint</span>&nbsp;<span class="op" id="4629836">=</span>&nbsp;<span class="builtintype" id="4629838">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629845">n</span><span class="op" id="4629846">.</span><span class="ident" id="4629847">Float64</span>&nbsp;<span class="op" id="4629855">=</span>&nbsp;<span class="builtintype" id="4629857">float64</span><span class="op" id="4629864">(</span><span class="builtintype" id="4629865">rune</span><span class="op" id="4629869">)</span>&nbsp;<span class="comment" id="4629871">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629905">n</span><span class="op" id="4629906">.</span><span class="ident" id="4629907">IsFloat</span>&nbsp;<span class="op" id="4629915">=</span>&nbsp;<span class="builtintype" id="4629917">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629924">return</span>&nbsp;<span class="ident" id="4629931">n</span><span class="op" id="4629932">,</span>&nbsp;<span class="ident" id="4629934">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629939">case</span>&nbsp;<span class="ident" id="4629944">itemComplex</span><span class="op" id="4629955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4629959">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630017">if</span>&nbsp;<span class="ident" id="4630020">_</span><span class="op" id="4630021">,</span>&nbsp;<span class="ident" id="4630023">err</span>&nbsp;<span class="op" id="4630027">:=</span>&nbsp;<span class="ident" id="4630030">fmt</span><span class="op" id="4630033">.</span><span class="ident" id="4630034">Sscan</span><span class="op" id="4630039">(</span><span class="ident" id="4630040">text</span><span class="op" id="4630044">,</span>&nbsp;<span class="op" id="4630046">&amp;</span><span class="ident" id="4630047">n</span><span class="op" id="4630048">.</span><span class="ident" id="4630049">Complex128</span><span class="op" id="4630059">)</span><span class="op" id="4630060">;</span>&nbsp;<span class="ident" id="4630062">err</span>&nbsp;<span class="op" id="4630066">!=</span>&nbsp;<span class="ident" id="4630069">nil</span>&nbsp;<span class="op" id="4630073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630078">return</span>&nbsp;<span class="ident" id="4630085">nil</span><span class="op" id="4630088">,</span>&nbsp;<span class="ident" id="4630090">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630100">n</span><span class="op" id="4630101">.</span><span class="ident" id="4630102">IsComplex</span>&nbsp;<span class="op" id="4630112">=</span>&nbsp;<span class="builtintype" id="4630114">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630121">n</span><span class="op" id="4630122">.</span><span class="ident" id="4630123">simplifyComplex</span><span class="op" id="4630138">(</span><span class="op" id="4630139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630143">return</span>&nbsp;<span class="ident" id="4630150">n</span><span class="op" id="4630151">,</span>&nbsp;<span class="ident" id="4630153">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630158">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630161">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630227">if</span>&nbsp;<span class="builtinfunc" id="4630230">len</span><span class="op" id="4630233">(</span><span class="ident" id="4630234">text</span><span class="op" id="4630238">)</span>&nbsp;<span class="op" id="4630240">&gt;</span>&nbsp;<span class="num" id="4630242">0</span>&nbsp;<span class="op" id="4630244">&amp;&amp;</span>&nbsp;<span class="ident" id="4630247">text</span><span class="op" id="4630251">[</span><span class="builtinfunc" id="4630252">len</span><span class="op" id="4630255">(</span><span class="ident" id="4630256">text</span><span class="op" id="4630260">)</span><span class="op" id="4630261">-</span><span class="num" id="4630262">1</span><span class="op" id="4630263">]</span>&nbsp;<span class="op" id="4630265">==</span>&nbsp;<span class="string" id="4630268">&#39;i&#39;</span>&nbsp;<span class="op" id="4630272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630276">f</span><span class="op" id="4630277">,</span>&nbsp;<span class="ident" id="4630279">err</span>&nbsp;<span class="op" id="4630283">:=</span>&nbsp;<span class="ident" id="4630286">strconv</span><span class="op" id="4630293">.</span><span class="ident" id="4630294">ParseFloat</span><span class="op" id="4630304">(</span><span class="ident" id="4630305">text</span><span class="op" id="4630309">[</span><span class="op" id="4630310">:</span><span class="builtinfunc" id="4630311">len</span><span class="op" id="4630314">(</span><span class="ident" id="4630315">text</span><span class="op" id="4630319">)</span><span class="op" id="4630320">-</span><span class="num" id="4630321">1</span><span class="op" id="4630322">]</span><span class="op" id="4630323">,</span>&nbsp;<span class="num" id="4630325">64</span><span class="op" id="4630327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630331">if</span>&nbsp;<span class="ident" id="4630334">err</span>&nbsp;<span class="op" id="4630338">==</span>&nbsp;<span class="ident" id="4630341">nil</span>&nbsp;<span class="op" id="4630345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630350">n</span><span class="op" id="4630351">.</span><span class="ident" id="4630352">IsComplex</span>&nbsp;<span class="op" id="4630362">=</span>&nbsp;<span class="builtintype" id="4630364">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630372">n</span><span class="op" id="4630373">.</span><span class="ident" id="4630374">Complex128</span>&nbsp;<span class="op" id="4630385">=</span>&nbsp;<span class="builtinfunc" id="4630387">complex</span><span class="op" id="4630394">(</span><span class="num" id="4630395">0</span><span class="op" id="4630396">,</span>&nbsp;<span class="ident" id="4630398">f</span><span class="op" id="4630399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630404">n</span><span class="op" id="4630405">.</span><span class="ident" id="4630406">simplifyComplex</span><span class="op" id="4630421">(</span><span class="op" id="4630422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630427">return</span>&nbsp;<span class="ident" id="4630434">n</span><span class="op" id="4630435">,</span>&nbsp;<span class="ident" id="4630437">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630446">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630449">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630496">u</span><span class="op" id="4630497">,</span>&nbsp;<span class="ident" id="4630499">err</span>&nbsp;<span class="op" id="4630503">:=</span>&nbsp;<span class="ident" id="4630506">strconv</span><span class="op" id="4630513">.</span><span class="ident" id="4630514">ParseUint</span><span class="op" id="4630523">(</span><span class="ident" id="4630524">text</span><span class="op" id="4630528">,</span>&nbsp;<span class="num" id="4630530">0</span><span class="op" id="4630531">,</span>&nbsp;<span class="num" id="4630533">64</span><span class="op" id="4630535">)</span>&nbsp;<span class="comment" id="4630537">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630572">if</span>&nbsp;<span class="ident" id="4630575">err</span>&nbsp;<span class="op" id="4630579">==</span>&nbsp;<span class="ident" id="4630582">nil</span>&nbsp;<span class="op" id="4630586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630590">n</span><span class="op" id="4630591">.</span><span class="ident" id="4630592">IsUint</span>&nbsp;<span class="op" id="4630599">=</span>&nbsp;<span class="builtintype" id="4630601">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630608">n</span><span class="op" id="4630609">.</span><span class="ident" id="4630610">Uint64</span>&nbsp;<span class="op" id="4630617">=</span>&nbsp;<span class="ident" id="4630619">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630625">i</span><span class="op" id="4630626">,</span>&nbsp;<span class="ident" id="4630628">err</span>&nbsp;<span class="op" id="4630632">:=</span>&nbsp;<span class="ident" id="4630635">strconv</span><span class="op" id="4630642">.</span><span class="ident" id="4630643">ParseInt</span><span class="op" id="4630651">(</span><span class="ident" id="4630652">text</span><span class="op" id="4630656">,</span>&nbsp;<span class="num" id="4630658">0</span><span class="op" id="4630659">,</span>&nbsp;<span class="num" id="4630661">64</span><span class="op" id="4630663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630666">if</span>&nbsp;<span class="ident" id="4630669">err</span>&nbsp;<span class="op" id="4630673">==</span>&nbsp;<span class="ident" id="4630676">nil</span>&nbsp;<span class="op" id="4630680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630684">n</span><span class="op" id="4630685">.</span><span class="ident" id="4630686">IsInt</span>&nbsp;<span class="op" id="4630692">=</span>&nbsp;<span class="builtintype" id="4630694">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630701">n</span><span class="op" id="4630702">.</span><span class="ident" id="4630703">Int64</span>&nbsp;<span class="op" id="4630709">=</span>&nbsp;<span class="ident" id="4630711">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630715">if</span>&nbsp;<span class="ident" id="4630718">i</span>&nbsp;<span class="op" id="4630720">==</span>&nbsp;<span class="num" id="4630723">0</span>&nbsp;<span class="op" id="4630725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630730">n</span><span class="op" id="4630731">.</span><span class="ident" id="4630732">IsUint</span>&nbsp;<span class="op" id="4630739">=</span>&nbsp;<span class="builtintype" id="4630741">true</span>&nbsp;<span class="comment" id="4630746">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630767">n</span><span class="op" id="4630768">.</span><span class="ident" id="4630769">Uint64</span>&nbsp;<span class="op" id="4630776">=</span>&nbsp;<span class="ident" id="4630778">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630785">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630788">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630847">if</span>&nbsp;<span class="ident" id="4630850">n</span><span class="op" id="4630851">.</span><span class="ident" id="4630852">IsInt</span>&nbsp;<span class="op" id="4630858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630862">n</span><span class="op" id="4630863">.</span><span class="ident" id="4630864">IsFloat</span>&nbsp;<span class="op" id="4630872">=</span>&nbsp;<span class="builtintype" id="4630874">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630881">n</span><span class="op" id="4630882">.</span><span class="ident" id="4630883">Float64</span>&nbsp;<span class="op" id="4630891">=</span>&nbsp;<span class="builtintype" id="4630893">float64</span><span class="op" id="4630900">(</span><span class="ident" id="4630901">n</span><span class="op" id="4630902">.</span><span class="ident" id="4630903">Int64</span><span class="op" id="4630908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630911">}</span>&nbsp;<span class="keyword" id="4630913">else</span>&nbsp;<span class="keyword" id="4630918">if</span>&nbsp;<span class="ident" id="4630921">n</span><span class="op" id="4630922">.</span><span class="ident" id="4630923">IsUint</span>&nbsp;<span class="op" id="4630930">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630934">n</span><span class="op" id="4630935">.</span><span class="ident" id="4630936">IsFloat</span>&nbsp;<span class="op" id="4630944">=</span>&nbsp;<span class="builtintype" id="4630946">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630953">n</span><span class="op" id="4630954">.</span><span class="ident" id="4630955">Float64</span>&nbsp;<span class="op" id="4630963">=</span>&nbsp;<span class="builtintype" id="4630965">float64</span><span class="op" id="4630972">(</span><span class="ident" id="4630973">n</span><span class="op" id="4630974">.</span><span class="ident" id="4630975">Uint64</span><span class="op" id="4630981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630984">}</span>&nbsp;<span class="keyword" id="4630986">else</span>&nbsp;<span class="op" id="4630991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630995">f</span><span class="op" id="4630996">,</span>&nbsp;<span class="ident" id="4630998">err</span>&nbsp;<span class="op" id="4631002">:=</span>&nbsp;<span class="ident" id="4631005">strconv</span><span class="op" id="4631012">.</span><span class="ident" id="4631013">ParseFloat</span><span class="op" id="4631023">(</span><span class="ident" id="4631024">text</span><span class="op" id="4631028">,</span>&nbsp;<span class="num" id="4631030">64</span><span class="op" id="4631032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631036">if</span>&nbsp;<span class="ident" id="4631039">err</span>&nbsp;<span class="op" id="4631043">==</span>&nbsp;<span class="ident" id="4631046">nil</span>&nbsp;<span class="op" id="4631050">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631055">n</span><span class="op" id="4631056">.</span><span class="ident" id="4631057">IsFloat</span>&nbsp;<span class="op" id="4631065">=</span>&nbsp;<span class="builtintype" id="4631067">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631075">n</span><span class="op" id="4631076">.</span><span class="ident" id="4631077">Float64</span>&nbsp;<span class="op" id="4631085">=</span>&nbsp;<span class="ident" id="4631087">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4631092">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631167">if</span>&nbsp;<span class="op" id="4631170">!</span><span class="ident" id="4631171">n</span><span class="op" id="4631172">.</span><span class="ident" id="4631173">IsInt</span>&nbsp;<span class="op" id="4631179">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4631182">float64</span><span class="op" id="4631189">(</span><span class="ident" id="4631190">int64</span><span class="op" id="4631195">(</span><span class="ident" id="4631196">f</span><span class="op" id="4631197">)</span><span class="op" id="4631198">)</span>&nbsp;<span class="op" id="4631200">==</span>&nbsp;<span class="ident" id="4631203">f</span>&nbsp;<span class="op" id="4631205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631211">n</span><span class="op" id="4631212">.</span><span class="ident" id="4631213">IsInt</span>&nbsp;<span class="op" id="4631219">=</span>&nbsp;<span class="builtintype" id="4631221">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631230">n</span><span class="op" id="4631231">.</span><span class="ident" id="4631232">Int64</span>&nbsp;<span class="op" id="4631238">=</span>&nbsp;<span class="ident" id="4631240">int64</span><span class="op" id="4631245">(</span><span class="ident" id="4631246">f</span><span class="op" id="4631247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631257">if</span>&nbsp;<span class="op" id="4631260">!</span><span class="ident" id="4631261">n</span><span class="op" id="4631262">.</span><span class="ident" id="4631263">IsUint</span>&nbsp;<span class="op" id="4631270">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4631273">float64</span><span class="op" id="4631280">(</span><span class="ident" id="4631281">uint64</span><span class="op" id="4631287">(</span><span class="ident" id="4631288">f</span><span class="op" id="4631289">)</span><span class="op" id="4631290">)</span>&nbsp;<span class="op" id="4631292">==</span>&nbsp;<span class="ident" id="4631295">f</span>&nbsp;<span class="op" id="4631297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631303">n</span><span class="op" id="4631304">.</span><span class="ident" id="4631305">IsUint</span>&nbsp;<span class="op" id="4631312">=</span>&nbsp;<span class="builtintype" id="4631314">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631323">n</span><span class="op" id="4631324">.</span><span class="ident" id="4631325">Uint64</span>&nbsp;<span class="op" id="4631332">=</span>&nbsp;<span class="ident" id="4631334">uint64</span><span class="op" id="4631340">(</span><span class="ident" id="4631341">f</span><span class="op" id="4631342">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631357">if</span>&nbsp;<span class="op" id="4631360">!</span><span class="ident" id="4631361">n</span><span class="op" id="4631362">.</span><span class="ident" id="4631363">IsInt</span>&nbsp;<span class="op" id="4631369">&amp;&amp;</span>&nbsp;<span class="op" id="4631372">!</span><span class="ident" id="4631373">n</span><span class="op" id="4631374">.</span><span class="ident" id="4631375">IsUint</span>&nbsp;<span class="op" id="4631382">&amp;&amp;</span>&nbsp;<span class="op" id="4631385">!</span><span class="ident" id="4631386">n</span><span class="op" id="4631387">.</span><span class="ident" id="4631388">IsFloat</span>&nbsp;<span class="op" id="4631396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631400">return</span>&nbsp;<span class="ident" id="4631407">nil</span><span class="op" id="4631410">,</span>&nbsp;<span class="ident" id="4631412">fmt</span><span class="op" id="4631415">.</span><span class="ident" id="4631416">Errorf</span><span class="op" id="4631422">(</span><span class="string" id="4631423">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="4631450">,</span>&nbsp;<span class="ident" id="4631452">text</span><span class="op" id="4631456">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631462">return</span>&nbsp;<span class="ident" id="4631469">n</span><span class="op" id="4631470">,</span>&nbsp;<span class="ident" id="4631472">nil</span><br>
<span class="lineno"></span><span class="op" id="4631476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4631479">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="4631568">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4631622">func</span>&nbsp;<span class="op" id="4631627">(</span><span class="ident" id="4631628">n</span>&nbsp;<span class="op" id="4631630">*</span><span class="ident" id="4631631">NumberNode</span><span class="op" id="4631641">)</span>&nbsp;<span class="ident" id="4631643">simplifyComplex</span><span class="op" id="4631658">(</span><span class="op" id="4631659">)</span>&nbsp;<span class="op" id="4631661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631664">n</span><span class="op" id="4631665">.</span><span class="ident" id="4631666">IsFloat</span>&nbsp;<span class="op" id="4631674">=</span>&nbsp;<span class="builtinfunc" id="4631676">imag</span><span class="op" id="4631680">(</span><span class="ident" id="4631681">n</span><span class="op" id="4631682">.</span><span class="ident" id="4631683">Complex128</span><span class="op" id="4631693">)</span>&nbsp;<span class="op" id="4631695">==</span>&nbsp;<span class="num" id="4631698">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631701">if</span>&nbsp;<span class="ident" id="4631704">n</span><span class="op" id="4631705">.</span><span class="ident" id="4631706">IsFloat</span>&nbsp;<span class="op" id="4631714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631718">n</span><span class="op" id="4631719">.</span><span class="ident" id="4631720">Float64</span>&nbsp;<span class="op" id="4631728">=</span>&nbsp;<span class="builtinfunc" id="4631730">real</span><span class="op" id="4631734">(</span><span class="ident" id="4631735">n</span><span class="op" id="4631736">.</span><span class="ident" id="4631737">Complex128</span><span class="op" id="4631747">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631751">n</span><span class="op" id="4631752">.</span><span class="ident" id="4631753">IsInt</span>&nbsp;<span class="op" id="4631759">=</span>&nbsp;<span class="builtintype" id="4631761">float64</span><span class="op" id="4631768">(</span><span class="ident" id="4631769">int64</span><span class="op" id="4631774">(</span><span class="ident" id="4631775">n</span><span class="op" id="4631776">.</span><span class="ident" id="4631777">Float64</span><span class="op" id="4631784">)</span><span class="op" id="4631785">)</span>&nbsp;<span class="op" id="4631787">==</span>&nbsp;<span class="ident" id="4631790">n</span><span class="op" id="4631791">.</span><span class="ident" id="4631792">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631802">if</span>&nbsp;<span class="ident" id="4631805">n</span><span class="op" id="4631806">.</span><span class="ident" id="4631807">IsInt</span>&nbsp;<span class="op" id="4631813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631818">n</span><span class="op" id="4631819">.</span><span class="ident" id="4631820">Int64</span>&nbsp;<span class="op" id="4631826">=</span>&nbsp;<span class="ident" id="4631828">int64</span><span class="op" id="4631833">(</span><span class="ident" id="4631834">n</span><span class="op" id="4631835">.</span><span class="ident" id="4631836">Float64</span><span class="op" id="4631843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631851">n</span><span class="op" id="4631852">.</span><span class="ident" id="4631853">IsUint</span>&nbsp;<span class="op" id="4631860">=</span>&nbsp;<span class="builtintype" id="4631862">float64</span><span class="op" id="4631869">(</span><span class="ident" id="4631870">uint64</span><span class="op" id="4631876">(</span><span class="ident" id="4631877">n</span><span class="op" id="4631878">.</span><span class="ident" id="4631879">Float64</span><span class="op" id="4631886">)</span><span class="op" id="4631887">)</span>&nbsp;<span class="op" id="4631889">==</span>&nbsp;<span class="ident" id="4631892">n</span><span class="op" id="4631893">.</span><span class="ident" id="4631894">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631904">if</span>&nbsp;<span class="ident" id="4631907">n</span><span class="op" id="4631908">.</span><span class="ident" id="4631909">IsUint</span>&nbsp;<span class="op" id="4631916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631921">n</span><span class="op" id="4631922">.</span><span class="ident" id="4631923">Uint64</span>&nbsp;<span class="op" id="4631930">=</span>&nbsp;<span class="ident" id="4631932">uint64</span><span class="op" id="4631938">(</span><span class="ident" id="4631939">n</span><span class="op" id="4631940">.</span><span class="ident" id="4631941">Float64</span><span class="op" id="4631948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631955">}</span><br>
<span class="lineno"></span><span class="op" id="4631957">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="4631960">func</span>&nbsp;<span class="op" id="4631965">(</span><span class="ident" id="4631966">n</span>&nbsp;<span class="op" id="4631968">*</span><span class="ident" id="4631969">NumberNode</span><span class="op" id="4631979">)</span>&nbsp;<span class="ident" id="4631981">String</span><span class="op" id="4631987">(</span><span class="op" id="4631988">)</span>&nbsp;<span class="builtintype" id="4631990">string</span>&nbsp;<span class="op" id="4631997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632000">return</span>&nbsp;<span class="ident" id="4632007">n</span><span class="op" id="4632008">.</span><span class="ident" id="4632009">Text</span><br>
<span class="lineno"></span><span class="op" id="4632014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="4632017">func</span>&nbsp;<span class="op" id="4632022">(</span><span class="ident" id="4632023">n</span>&nbsp;<span class="op" id="4632025">*</span><span class="ident" id="4632026">NumberNode</span><span class="op" id="4632036">)</span>&nbsp;<span class="ident" id="4632038">tree</span><span class="op" id="4632042">(</span><span class="op" id="4632043">)</span>&nbsp;<span class="op" id="4632045">*</span><span class="ident" id="4632046">Tree</span>&nbsp;<span class="op" id="4632051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632054">return</span>&nbsp;<span class="ident" id="4632061">n</span><span class="op" id="4632062">.</span><span class="ident" id="4632063">tr</span><br>
<span class="lineno"></span><span class="op" id="4632066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632069">func</span>&nbsp;<span class="op" id="4632074">(</span><span class="ident" id="4632075">n</span>&nbsp;<span class="op" id="4632077">*</span><span class="ident" id="4632078">NumberNode</span><span class="op" id="4632088">)</span>&nbsp;<span class="ident" id="4632090">Copy</span><span class="op" id="4632094">(</span><span class="op" id="4632095">)</span>&nbsp;<span class="ident" id="4632097">Node</span>&nbsp;<span class="op" id="4632102">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632105">nn</span>&nbsp;<span class="op" id="4632108">:=</span>&nbsp;<span class="builtinfunc" id="4632111">new</span><span class="op" id="4632114">(</span><span class="ident" id="4632115">NumberNode</span><span class="op" id="4632125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4632128">*</span><span class="ident" id="4632129">nn</span>&nbsp;<span class="op" id="4632132">=</span>&nbsp;<span class="op" id="4632134">*</span><span class="ident" id="4632135">n</span>&nbsp;<span class="comment" id="4632137">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632162">return</span>&nbsp;<span class="ident" id="4632169">nn</span><br>
<span class="lineno"></span><span class="op" id="4632172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="4632175">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4632245">type</span>&nbsp;<span class="ident" id="4632250">StringNode</span>&nbsp;<span class="keyword" id="4632261">struct</span>&nbsp;<span class="op" id="4632268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632271">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632281">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632286">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632293">*</span><span class="ident" id="4632294">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632300">Quoted</span>&nbsp;<span class="builtintype" id="4632307">string</span>&nbsp;<span class="comment" id="4632314">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632364">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4632371">string</span>&nbsp;<span class="comment" id="4632378">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="4632417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632420">func</span>&nbsp;<span class="op" id="4632425">(</span><span class="ident" id="4632426">t</span>&nbsp;<span class="op" id="4632428">*</span><span class="ident" id="4632429">Tree</span><span class="op" id="4632433">)</span>&nbsp;<span class="ident" id="4632435">newString</span><span class="op" id="4632444">(</span><span class="ident" id="4632445">pos</span>&nbsp;<span class="ident" id="4632449">Pos</span><span class="op" id="4632452">,</span>&nbsp;<span class="ident" id="4632454">orig</span><span class="op" id="4632458">,</span>&nbsp;<span class="ident" id="4632460">text</span>&nbsp;<span class="builtintype" id="4632465">string</span><span class="op" id="4632471">)</span>&nbsp;<span class="op" id="4632473">*</span><span class="ident" id="4632474">StringNode</span>&nbsp;<span class="op" id="4632485">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632488">return</span>&nbsp;<span class="op" id="4632495">&amp;</span><span class="ident" id="4632496">StringNode</span><span class="op" id="4632506">{</span><span class="ident" id="4632507">tr</span><span class="op" id="4632509">:</span>&nbsp;<span class="ident" id="4632511">t</span><span class="op" id="4632512">,</span>&nbsp;<span class="ident" id="4632514">NodeType</span><span class="op" id="4632522">:</span>&nbsp;<span class="ident" id="4632524">NodeString</span><span class="op" id="4632534">,</span>&nbsp;<span class="ident" id="4632536">Pos</span><span class="op" id="4632539">:</span>&nbsp;<span class="ident" id="4632541">pos</span><span class="op" id="4632544">,</span>&nbsp;<span class="ident" id="4632546">Quoted</span><span class="op" id="4632552">:</span>&nbsp;<span class="ident" id="4632554">orig</span><span class="op" id="4632558">,</span>&nbsp;<span class="ident" id="4632560">Text</span><span class="op" id="4632564">:</span>&nbsp;<span class="ident" id="4632566">text</span><span class="op" id="4632570">}</span><br>
<span class="lineno"></span><span class="op" id="4632572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632575">func</span>&nbsp;<span class="op" id="4632580">(</span><span class="ident" id="4632581">s</span>&nbsp;<span class="op" id="4632583">*</span><span class="ident" id="4632584">StringNode</span><span class="op" id="4632594">)</span>&nbsp;<span class="ident" id="4632596">String</span><span class="op" id="4632602">(</span><span class="op" id="4632603">)</span>&nbsp;<span class="builtintype" id="4632605">string</span>&nbsp;<span class="op" id="4632612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632615">return</span>&nbsp;<span class="ident" id="4632622">s</span><span class="op" id="4632623">.</span><span class="ident" id="4632624">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="4632631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632634">func</span>&nbsp;<span class="op" id="4632639">(</span><span class="ident" id="4632640">s</span>&nbsp;<span class="op" id="4632642">*</span><span class="ident" id="4632643">StringNode</span><span class="op" id="4632653">)</span>&nbsp;<span class="ident" id="4632655">tree</span><span class="op" id="4632659">(</span><span class="op" id="4632660">)</span>&nbsp;<span class="op" id="4632662">*</span><span class="ident" id="4632663">Tree</span>&nbsp;<span class="op" id="4632668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632671">return</span>&nbsp;<span class="ident" id="4632678">s</span><span class="op" id="4632679">.</span><span class="ident" id="4632680">tr</span><br>
<span class="lineno"></span><span class="op" id="4632683">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="4632686">func</span>&nbsp;<span class="op" id="4632691">(</span><span class="ident" id="4632692">s</span>&nbsp;<span class="op" id="4632694">*</span><span class="ident" id="4632695">StringNode</span><span class="op" id="4632705">)</span>&nbsp;<span class="ident" id="4632707">Copy</span><span class="op" id="4632711">(</span><span class="op" id="4632712">)</span>&nbsp;<span class="ident" id="4632714">Node</span>&nbsp;<span class="op" id="4632719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632722">return</span>&nbsp;<span class="ident" id="4632729">s</span><span class="op" id="4632730">.</span><span class="ident" id="4632731">tr</span><span class="op" id="4632733">.</span><span class="ident" id="4632734">newString</span><span class="op" id="4632743">(</span><span class="ident" id="4632744">s</span><span class="op" id="4632745">.</span><span class="ident" id="4632746">Pos</span><span class="op" id="4632749">,</span>&nbsp;<span class="ident" id="4632751">s</span><span class="op" id="4632752">.</span><span class="ident" id="4632753">Quoted</span><span class="op" id="4632759">,</span>&nbsp;<span class="ident" id="4632761">s</span><span class="op" id="4632762">.</span><span class="ident" id="4632763">Text</span><span class="op" id="4632767">)</span><br>
<span class="lineno"></span><span class="op" id="4632769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4632772">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="4632813">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="4632860">type</span>&nbsp;<span class="ident" id="4632865">endNode</span>&nbsp;<span class="keyword" id="4632873">struct</span>&nbsp;<span class="op" id="4632880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632883">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632893">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632898">tr</span>&nbsp;<span class="op" id="4632901">*</span><span class="ident" id="4632902">Tree</span><br>
<span class="lineno"></span><span class="op" id="4632907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632910">func</span>&nbsp;<span class="op" id="4632915">(</span><span class="ident" id="4632916">t</span>&nbsp;<span class="op" id="4632918">*</span><span class="ident" id="4632919">Tree</span><span class="op" id="4632923">)</span>&nbsp;<span class="ident" id="4632925">newEnd</span><span class="op" id="4632931">(</span><span class="ident" id="4632932">pos</span>&nbsp;<span class="ident" id="4632936">Pos</span><span class="op" id="4632939">)</span>&nbsp;<span class="op" id="4632941">*</span><span class="ident" id="4632942">endNode</span>&nbsp;<span class="op" id="4632950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632953">return</span>&nbsp;<span class="op" id="4632960">&amp;</span><span class="ident" id="4632961">endNode</span><span class="op" id="4632968">{</span><span class="ident" id="4632969">tr</span><span class="op" id="4632971">:</span>&nbsp;<span class="ident" id="4632973">t</span><span class="op" id="4632974">,</span>&nbsp;<span class="ident" id="4632976">NodeType</span><span class="op" id="4632984">:</span>&nbsp;<span class="ident" id="4632986">nodeEnd</span><span class="op" id="4632993">,</span>&nbsp;<span class="ident" id="4632995">Pos</span><span class="op" id="4632998">:</span>&nbsp;<span class="ident" id="4633000">pos</span><span class="op" id="4633003">}</span><br>
<span class="lineno">680</span><span class="op" id="4633005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4633008">func</span>&nbsp;<span class="op" id="4633013">(</span><span class="ident" id="4633014">e</span>&nbsp;<span class="op" id="4633016">*</span><span class="ident" id="4633017">endNode</span><span class="op" id="4633024">)</span>&nbsp;<span class="ident" id="4633026">String</span><span class="op" id="4633032">(</span><span class="op" id="4633033">)</span>&nbsp;<span class="builtintype" id="4633035">string</span>&nbsp;<span class="op" id="4633042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633045">return</span>&nbsp;<span class="string" id="4633052">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4633062">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4633065">func</span>&nbsp;<span class="op" id="4633070">(</span><span class="ident" id="4633071">e</span>&nbsp;<span class="op" id="4633073">*</span><span class="ident" id="4633074">endNode</span><span class="op" id="4633081">)</span>&nbsp;<span class="ident" id="4633083">tree</span><span class="op" id="4633087">(</span><span class="op" id="4633088">)</span>&nbsp;<span class="op" id="4633090">*</span><span class="ident" id="4633091">Tree</span>&nbsp;<span class="op" id="4633096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633099">return</span>&nbsp;<span class="ident" id="4633106">e</span><span class="op" id="4633107">.</span><span class="ident" id="4633108">tr</span><br>
<span class="lineno"></span><span class="op" id="4633111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="4633114">func</span>&nbsp;<span class="op" id="4633119">(</span><span class="ident" id="4633120">e</span>&nbsp;<span class="op" id="4633122">*</span><span class="ident" id="4633123">endNode</span><span class="op" id="4633130">)</span>&nbsp;<span class="ident" id="4633132">Copy</span><span class="op" id="4633136">(</span><span class="op" id="4633137">)</span>&nbsp;<span class="ident" id="4633139">Node</span>&nbsp;<span class="op" id="4633144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633147">return</span>&nbsp;<span class="ident" id="4633154">e</span><span class="op" id="4633155">.</span><span class="ident" id="4633156">tr</span><span class="op" id="4633158">.</span><span class="ident" id="4633159">newEnd</span><span class="op" id="4633165">(</span><span class="ident" id="4633166">e</span><span class="op" id="4633167">.</span><span class="ident" id="4633168">Pos</span><span class="op" id="4633171">)</span><br>
<span class="lineno"></span><span class="op" id="4633173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4633176">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="4633254">type</span>&nbsp;<span class="ident" id="4633259">elseNode</span>&nbsp;<span class="keyword" id="4633268">struct</span>&nbsp;<span class="op" id="4633275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633278">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633288">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633293">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4633298">*</span><span class="ident" id="4633299">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633305">Line</span>&nbsp;<span class="builtintype" id="4633310">int</span>&nbsp;<span class="comment" id="4633314">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="4633383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4633386">func</span>&nbsp;<span class="op" id="4633391">(</span><span class="ident" id="4633392">t</span>&nbsp;<span class="op" id="4633394">*</span><span class="ident" id="4633395">Tree</span><span class="op" id="4633399">)</span>&nbsp;<span class="ident" id="4633401">newElse</span><span class="op" id="4633408">(</span><span class="ident" id="4633409">pos</span>&nbsp;<span class="ident" id="4633413">Pos</span><span class="op" id="4633416">,</span>&nbsp;<span class="ident" id="4633418">line</span>&nbsp;<span class="builtintype" id="4633423">int</span><span class="op" id="4633426">)</span>&nbsp;<span class="op" id="4633428">*</span><span class="ident" id="4633429">elseNode</span>&nbsp;<span class="op" id="4633438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633441">return</span>&nbsp;<span class="op" id="4633448">&amp;</span><span class="ident" id="4633449">elseNode</span><span class="op" id="4633457">{</span><span class="ident" id="4633458">tr</span><span class="op" id="4633460">:</span>&nbsp;<span class="ident" id="4633462">t</span><span class="op" id="4633463">,</span>&nbsp;<span class="ident" id="4633465">NodeType</span><span class="op" id="4633473">:</span>&nbsp;<span class="ident" id="4633475">nodeElse</span><span class="op" id="4633483">,</span>&nbsp;<span class="ident" id="4633485">Pos</span><span class="op" id="4633488">:</span>&nbsp;<span class="ident" id="4633490">pos</span><span class="op" id="4633493">,</span>&nbsp;<span class="ident" id="4633495">Line</span><span class="op" id="4633499">:</span>&nbsp;<span class="ident" id="4633501">line</span><span class="op" id="4633505">}</span><br>
<span class="lineno"></span><span class="op" id="4633507">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="4633510">func</span>&nbsp;<span class="op" id="4633515">(</span><span class="ident" id="4633516">e</span>&nbsp;<span class="op" id="4633518">*</span><span class="ident" id="4633519">elseNode</span><span class="op" id="4633527">)</span>&nbsp;<span class="ident" id="4633529">Type</span><span class="op" id="4633533">(</span><span class="op" id="4633534">)</span>&nbsp;<span class="ident" id="4633536">NodeType</span>&nbsp;<span class="op" id="4633545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633548">return</span>&nbsp;<span class="ident" id="4633555">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="4633564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="4633567">func</span>&nbsp;<span class="op" id="4633572">(</span><span class="ident" id="4633573">e</span>&nbsp;<span class="op" id="4633575">*</span><span class="ident" id="4633576">elseNode</span><span class="op" id="4633584">)</span>&nbsp;<span class="ident" id="4633586">String</span><span class="op" id="4633592">(</span><span class="op" id="4633593">)</span>&nbsp;<span class="builtintype" id="4633595">string</span>&nbsp;<span class="op" id="4633602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633605">return</span>&nbsp;<span class="string" id="4633612">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4633623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4633626">func</span>&nbsp;<span class="op" id="4633631">(</span><span class="ident" id="4633632">e</span>&nbsp;<span class="op" id="4633634">*</span><span class="ident" id="4633635">elseNode</span><span class="op" id="4633643">)</span>&nbsp;<span class="ident" id="4633645">tree</span><span class="op" id="4633649">(</span><span class="op" id="4633650">)</span>&nbsp;<span class="op" id="4633652">*</span><span class="ident" id="4633653">Tree</span>&nbsp;<span class="op" id="4633658">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633661">return</span>&nbsp;<span class="ident" id="4633668">e</span><span class="op" id="4633669">.</span><span class="ident" id="4633670">tr</span><br>
<span class="lineno"></span><span class="op" id="4633673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4633676">func</span>&nbsp;<span class="op" id="4633681">(</span><span class="ident" id="4633682">e</span>&nbsp;<span class="op" id="4633684">*</span><span class="ident" id="4633685">elseNode</span><span class="op" id="4633693">)</span>&nbsp;<span class="ident" id="4633695">Copy</span><span class="op" id="4633699">(</span><span class="op" id="4633700">)</span>&nbsp;<span class="ident" id="4633702">Node</span>&nbsp;<span class="op" id="4633707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633710">return</span>&nbsp;<span class="ident" id="4633717">e</span><span class="op" id="4633718">.</span><span class="ident" id="4633719">tr</span><span class="op" id="4633721">.</span><span class="ident" id="4633722">newElse</span><span class="op" id="4633729">(</span><span class="ident" id="4633730">e</span><span class="op" id="4633731">.</span><span class="ident" id="4633732">Pos</span><span class="op" id="4633735">,</span>&nbsp;<span class="ident" id="4633737">e</span><span class="op" id="4633738">.</span><span class="ident" id="4633739">Line</span><span class="op" id="4633743">)</span><br>
<span class="lineno">720</span><span class="op" id="4633745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4633748">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="4633815">type</span>&nbsp;<span class="ident" id="4633820">BranchNode</span>&nbsp;<span class="keyword" id="4633831">struct</span>&nbsp;<span class="op" id="4633838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633841">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633851">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633856">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633865">*</span><span class="ident" id="4633866">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633872">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4633881">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4633891">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633961">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633970">*</span><span class="ident" id="4633971">PipeNode</span>&nbsp;<span class="comment" id="4633980">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634014">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634023">*</span><span class="ident" id="4634024">ListNode</span>&nbsp;<span class="comment" id="4634033">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634080">ElseList</span>&nbsp;<span class="op" id="4634089">*</span><span class="ident" id="4634090">ListNode</span>&nbsp;<span class="comment" id="4634099">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="4634157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4634160">func</span>&nbsp;<span class="op" id="4634165">(</span><span class="ident" id="4634166">b</span>&nbsp;<span class="op" id="4634168">*</span><span class="ident" id="4634169">BranchNode</span><span class="op" id="4634179">)</span>&nbsp;<span class="ident" id="4634181">String</span><span class="op" id="4634187">(</span><span class="op" id="4634188">)</span>&nbsp;<span class="builtintype" id="4634190">string</span>&nbsp;<span class="op" id="4634197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634200">name</span>&nbsp;<span class="op" id="4634205">:=</span>&nbsp;<span class="string" id="4634208">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634212">switch</span>&nbsp;<span class="ident" id="4634219">b</span><span class="op" id="4634220">.</span><span class="ident" id="4634221">NodeType</span>&nbsp;<span class="op" id="4634230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634233">case</span>&nbsp;<span class="ident" id="4634238">NodeIf</span><span class="op" id="4634244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634248">name</span>&nbsp;<span class="op" id="4634253">=</span>&nbsp;<span class="string" id="4634255">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634261">case</span>&nbsp;<span class="ident" id="4634266">NodeRange</span><span class="op" id="4634275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634279">name</span>&nbsp;<span class="op" id="4634284">=</span>&nbsp;<span class="string" id="4634286">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634295">case</span>&nbsp;<span class="ident" id="4634300">NodeWith</span><span class="op" id="4634308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634312">name</span>&nbsp;<span class="op" id="4634317">=</span>&nbsp;<span class="string" id="4634319">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634327">default</span><span class="op" id="4634334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4634338">panic</span><span class="op" id="4634343">(</span><span class="string" id="4634344">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4634365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4634368">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634371">if</span>&nbsp;<span class="ident" id="4634374">b</span><span class="op" id="4634375">.</span><span class="ident" id="4634376">ElseList</span>&nbsp;<span class="op" id="4634385">!=</span>&nbsp;<span class="ident" id="4634388">nil</span>&nbsp;<span class="op" id="4634392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634396">return</span>&nbsp;<span class="ident" id="4634403">fmt</span><span class="op" id="4634406">.</span><span class="ident" id="4634407">Sprintf</span><span class="op" id="4634414">(</span><span class="string" id="4634415">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="4634445">,</span>&nbsp;<span class="ident" id="4634447">name</span><span class="op" id="4634451">,</span>&nbsp;<span class="ident" id="4634453">b</span><span class="op" id="4634454">.</span><span class="ident" id="4634455">Pipe</span><span class="op" id="4634459">,</span>&nbsp;<span class="ident" id="4634461">b</span><span class="op" id="4634462">.</span><span class="ident" id="4634463">List</span><span class="op" id="4634467">,</span>&nbsp;<span class="ident" id="4634469">b</span><span class="op" id="4634470">.</span><span class="ident" id="4634471">ElseList</span><span class="op" id="4634479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4634482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634485">return</span>&nbsp;<span class="ident" id="4634492">fmt</span><span class="op" id="4634495">.</span><span class="ident" id="4634496">Sprintf</span><span class="op" id="4634503">(</span><span class="string" id="4634504">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="4634524">,</span>&nbsp;<span class="ident" id="4634526">name</span><span class="op" id="4634530">,</span>&nbsp;<span class="ident" id="4634532">b</span><span class="op" id="4634533">.</span><span class="ident" id="4634534">Pipe</span><span class="op" id="4634538">,</span>&nbsp;<span class="ident" id="4634540">b</span><span class="op" id="4634541">.</span><span class="ident" id="4634542">List</span><span class="op" id="4634546">)</span><br>
<span class="lineno"></span><span class="op" id="4634548">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="4634551">func</span>&nbsp;<span class="op" id="4634556">(</span><span class="ident" id="4634557">b</span>&nbsp;<span class="op" id="4634559">*</span><span class="ident" id="4634560">BranchNode</span><span class="op" id="4634570">)</span>&nbsp;<span class="ident" id="4634572">tree</span><span class="op" id="4634576">(</span><span class="op" id="4634577">)</span>&nbsp;<span class="op" id="4634579">*</span><span class="ident" id="4634580">Tree</span>&nbsp;<span class="op" id="4634585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634588">return</span>&nbsp;<span class="ident" id="4634595">b</span><span class="op" id="4634596">.</span><span class="ident" id="4634597">tr</span><br>
<span class="lineno"></span><span class="op" id="4634600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="4634603">func</span>&nbsp;<span class="op" id="4634608">(</span><span class="ident" id="4634609">b</span>&nbsp;<span class="op" id="4634611">*</span><span class="ident" id="4634612">BranchNode</span><span class="op" id="4634622">)</span>&nbsp;<span class="ident" id="4634624">Copy</span><span class="op" id="4634628">(</span><span class="op" id="4634629">)</span>&nbsp;<span class="ident" id="4634631">Node</span>&nbsp;<span class="op" id="4634636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634639">switch</span>&nbsp;<span class="ident" id="4634646">b</span><span class="op" id="4634647">.</span><span class="ident" id="4634648">NodeType</span>&nbsp;<span class="op" id="4634657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634660">case</span>&nbsp;<span class="ident" id="4634665">NodeIf</span><span class="op" id="4634671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634675">return</span>&nbsp;<span class="ident" id="4634682">b</span><span class="op" id="4634683">.</span><span class="ident" id="4634684">tr</span><span class="op" id="4634686">.</span><span class="ident" id="4634687">newIf</span><span class="op" id="4634692">(</span><span class="ident" id="4634693">b</span><span class="op" id="4634694">.</span><span class="ident" id="4634695">Pos</span><span class="op" id="4634698">,</span>&nbsp;<span class="ident" id="4634700">b</span><span class="op" id="4634701">.</span><span class="ident" id="4634702">Line</span><span class="op" id="4634706">,</span>&nbsp;<span class="ident" id="4634708">b</span><span class="op" id="4634709">.</span><span class="ident" id="4634710">Pipe</span><span class="op" id="4634714">,</span>&nbsp;<span class="ident" id="4634716">b</span><span class="op" id="4634717">.</span><span class="ident" id="4634718">List</span><span class="op" id="4634722">,</span>&nbsp;<span class="ident" id="4634724">b</span><span class="op" id="4634725">.</span><span class="ident" id="4634726">ElseList</span><span class="op" id="4634734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634737">case</span>&nbsp;<span class="ident" id="4634742">NodeRange</span><span class="op" id="4634751">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634755">return</span>&nbsp;<span class="ident" id="4634762">b</span><span class="op" id="4634763">.</span><span class="ident" id="4634764">tr</span><span class="op" id="4634766">.</span><span class="ident" id="4634767">newRange</span><span class="op" id="4634775">(</span><span class="ident" id="4634776">b</span><span class="op" id="4634777">.</span><span class="ident" id="4634778">Pos</span><span class="op" id="4634781">,</span>&nbsp;<span class="ident" id="4634783">b</span><span class="op" id="4634784">.</span><span class="ident" id="4634785">Line</span><span class="op" id="4634789">,</span>&nbsp;<span class="ident" id="4634791">b</span><span class="op" id="4634792">.</span><span class="ident" id="4634793">Pipe</span><span class="op" id="4634797">,</span>&nbsp;<span class="ident" id="4634799">b</span><span class="op" id="4634800">.</span><span class="ident" id="4634801">List</span><span class="op" id="4634805">,</span>&nbsp;<span class="ident" id="4634807">b</span><span class="op" id="4634808">.</span><span class="ident" id="4634809">ElseList</span><span class="op" id="4634817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634820">case</span>&nbsp;<span class="ident" id="4634825">NodeWith</span><span class="op" id="4634833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634837">return</span>&nbsp;<span class="ident" id="4634844">b</span><span class="op" id="4634845">.</span><span class="ident" id="4634846">tr</span><span class="op" id="4634848">.</span><span class="ident" id="4634849">newWith</span><span class="op" id="4634856">(</span><span class="ident" id="4634857">b</span><span class="op" id="4634858">.</span><span class="ident" id="4634859">Pos</span><span class="op" id="4634862">,</span>&nbsp;<span class="ident" id="4634864">b</span><span class="op" id="4634865">.</span><span class="ident" id="4634866">Line</span><span class="op" id="4634870">,</span>&nbsp;<span class="ident" id="4634872">b</span><span class="op" id="4634873">.</span><span class="ident" id="4634874">Pipe</span><span class="op" id="4634878">,</span>&nbsp;<span class="ident" id="4634880">b</span><span class="op" id="4634881">.</span><span class="ident" id="4634882">List</span><span class="op" id="4634886">,</span>&nbsp;<span class="ident" id="4634888">b</span><span class="op" id="4634889">.</span><span class="ident" id="4634890">ElseList</span><span class="op" id="4634898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4634901">default</span><span class="op" id="4634908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4634912">panic</span><span class="op" id="4634917">(</span><span class="string" id="4634918">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4634939">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4634942">}</span><br>
<span class="lineno"></span><span class="op" id="4634944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4634947">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4635003">type</span>&nbsp;<span class="ident" id="4635008">IfNode</span>&nbsp;<span class="keyword" id="4635015">struct</span>&nbsp;<span class="op" id="4635022">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635025">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4635036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4635039">func</span>&nbsp;<span class="op" id="4635044">(</span><span class="ident" id="4635045">t</span>&nbsp;<span class="op" id="4635047">*</span><span class="ident" id="4635048">Tree</span><span class="op" id="4635052">)</span>&nbsp;<span class="ident" id="4635054">newIf</span><span class="op" id="4635059">(</span><span class="ident" id="4635060">pos</span>&nbsp;<span class="ident" id="4635064">Pos</span><span class="op" id="4635067">,</span>&nbsp;<span class="ident" id="4635069">line</span>&nbsp;<span class="builtintype" id="4635074">int</span><span class="op" id="4635077">,</span>&nbsp;<span class="ident" id="4635079">pipe</span>&nbsp;<span class="op" id="4635084">*</span><span class="ident" id="4635085">PipeNode</span><span class="op" id="4635093">,</span>&nbsp;<span class="ident" id="4635095">list</span><span class="op" id="4635099">,</span>&nbsp;<span class="ident" id="4635101">elseList</span>&nbsp;<span class="op" id="4635110">*</span><span class="ident" id="4635111">ListNode</span><span class="op" id="4635119">)</span>&nbsp;<span class="op" id="4635121">*</span><span class="ident" id="4635122">IfNode</span>&nbsp;<span class="op" id="4635129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635132">return</span>&nbsp;<span class="op" id="4635139">&amp;</span><span class="ident" id="4635140">IfNode</span><span class="op" id="4635146">{</span><span class="ident" id="4635147">BranchNode</span><span class="op" id="4635157">{</span><span class="ident" id="4635158">tr</span><span class="op" id="4635160">:</span>&nbsp;<span class="ident" id="4635162">t</span><span class="op" id="4635163">,</span>&nbsp;<span class="ident" id="4635165">NodeType</span><span class="op" id="4635173">:</span>&nbsp;<span class="ident" id="4635175">NodeIf</span><span class="op" id="4635181">,</span>&nbsp;<span class="ident" id="4635183">Pos</span><span class="op" id="4635186">:</span>&nbsp;<span class="ident" id="4635188">pos</span><span class="op" id="4635191">,</span>&nbsp;<span class="ident" id="4635193">Line</span><span class="op" id="4635197">:</span>&nbsp;<span class="ident" id="4635199">line</span><span class="op" id="4635203">,</span>&nbsp;<span class="ident" id="4635205">Pipe</span><span class="op" id="4635209">:</span>&nbsp;<span class="ident" id="4635211">pipe</span><span class="op" id="4635215">,</span>&nbsp;<span class="ident" id="4635217">List</span><span class="op" id="4635221">:</span>&nbsp;<span class="ident" id="4635223">list</span><span class="op" id="4635227">,</span>&nbsp;<span class="ident" id="4635229">ElseList</span><span class="op" id="4635237">:</span>&nbsp;<span class="ident" id="4635239">elseList</span><span class="op" id="4635247">}</span><span class="op" id="4635248">}</span><br>
<span class="lineno">775</span><span class="op" id="4635250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4635253">func</span>&nbsp;<span class="op" id="4635258">(</span><span class="ident" id="4635259">i</span>&nbsp;<span class="op" id="4635261">*</span><span class="ident" id="4635262">IfNode</span><span class="op" id="4635268">)</span>&nbsp;<span class="ident" id="4635270">Copy</span><span class="op" id="4635274">(</span><span class="op" id="4635275">)</span>&nbsp;<span class="ident" id="4635277">Node</span>&nbsp;<span class="op" id="4635282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635285">return</span>&nbsp;<span class="ident" id="4635292">i</span><span class="op" id="4635293">.</span><span class="ident" id="4635294">tr</span><span class="op" id="4635296">.</span><span class="ident" id="4635297">newIf</span><span class="op" id="4635302">(</span><span class="ident" id="4635303">i</span><span class="op" id="4635304">.</span><span class="ident" id="4635305">Pos</span><span class="op" id="4635308">,</span>&nbsp;<span class="ident" id="4635310">i</span><span class="op" id="4635311">.</span><span class="ident" id="4635312">Line</span><span class="op" id="4635316">,</span>&nbsp;<span class="ident" id="4635318">i</span><span class="op" id="4635319">.</span><span class="ident" id="4635320">Pipe</span><span class="op" id="4635324">.</span><span class="ident" id="4635325">CopyPipe</span><span class="op" id="4635333">(</span><span class="op" id="4635334">)</span><span class="op" id="4635335">,</span>&nbsp;<span class="ident" id="4635337">i</span><span class="op" id="4635338">.</span><span class="ident" id="4635339">List</span><span class="op" id="4635343">.</span><span class="ident" id="4635344">CopyList</span><span class="op" id="4635352">(</span><span class="op" id="4635353">)</span><span class="op" id="4635354">,</span>&nbsp;<span class="ident" id="4635356">i</span><span class="op" id="4635357">.</span><span class="ident" id="4635358">ElseList</span><span class="op" id="4635366">.</span><span class="ident" id="4635367">CopyList</span><span class="op" id="4635375">(</span><span class="op" id="4635376">)</span><span class="op" id="4635377">)</span><br>
<span class="lineno"></span><span class="op" id="4635379">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="4635382">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4635443">type</span>&nbsp;<span class="ident" id="4635448">RangeNode</span>&nbsp;<span class="keyword" id="4635458">struct</span>&nbsp;<span class="op" id="4635465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635468">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4635479">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="4635482">func</span>&nbsp;<span class="op" id="4635487">(</span><span class="ident" id="4635488">t</span>&nbsp;<span class="op" id="4635490">*</span><span class="ident" id="4635491">Tree</span><span class="op" id="4635495">)</span>&nbsp;<span class="ident" id="4635497">newRange</span><span class="op" id="4635505">(</span><span class="ident" id="4635506">pos</span>&nbsp;<span class="ident" id="4635510">Pos</span><span class="op" id="4635513">,</span>&nbsp;<span class="ident" id="4635515">line</span>&nbsp;<span class="builtintype" id="4635520">int</span><span class="op" id="4635523">,</span>&nbsp;<span class="ident" id="4635525">pipe</span>&nbsp;<span class="op" id="4635530">*</span><span class="ident" id="4635531">PipeNode</span><span class="op" id="4635539">,</span>&nbsp;<span class="ident" id="4635541">list</span><span class="op" id="4635545">,</span>&nbsp;<span class="ident" id="4635547">elseList</span>&nbsp;<span class="op" id="4635556">*</span><span class="ident" id="4635557">ListNode</span><span class="op" id="4635565">)</span>&nbsp;<span class="op" id="4635567">*</span><span class="ident" id="4635568">RangeNode</span>&nbsp;<span class="op" id="4635578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635581">return</span>&nbsp;<span class="op" id="4635588">&amp;</span><span class="ident" id="4635589">RangeNode</span><span class="op" id="4635598">{</span><span class="ident" id="4635599">BranchNode</span><span class="op" id="4635609">{</span><span class="ident" id="4635610">tr</span><span class="op" id="4635612">:</span>&nbsp;<span class="ident" id="4635614">t</span><span class="op" id="4635615">,</span>&nbsp;<span class="ident" id="4635617">NodeType</span><span class="op" id="4635625">:</span>&nbsp;<span class="ident" id="4635627">NodeRange</span><span class="op" id="4635636">,</span>&nbsp;<span class="ident" id="4635638">Pos</span><span class="op" id="4635641">:</span>&nbsp;<span class="ident" id="4635643">pos</span><span class="op" id="4635646">,</span>&nbsp;<span class="ident" id="4635648">Line</span><span class="op" id="4635652">:</span>&nbsp;<span class="ident" id="4635654">line</span><span class="op" id="4635658">,</span>&nbsp;<span class="ident" id="4635660">Pipe</span><span class="op" id="4635664">:</span>&nbsp;<span class="ident" id="4635666">pipe</span><span class="op" id="4635670">,</span>&nbsp;<span class="ident" id="4635672">List</span><span class="op" id="4635676">:</span>&nbsp;<span class="ident" id="4635678">list</span><span class="op" id="4635682">,</span>&nbsp;<span class="ident" id="4635684">ElseList</span><span class="op" id="4635692">:</span>&nbsp;<span class="ident" id="4635694">elseList</span><span class="op" id="4635702">}</span><span class="op" id="4635703">}</span><br>
<span class="lineno"></span><span class="op" id="4635705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="4635708">func</span>&nbsp;<span class="op" id="4635713">(</span><span class="ident" id="4635714">r</span>&nbsp;<span class="op" id="4635716">*</span><span class="ident" id="4635717">RangeNode</span><span class="op" id="4635726">)</span>&nbsp;<span class="ident" id="4635728">Copy</span><span class="op" id="4635732">(</span><span class="op" id="4635733">)</span>&nbsp;<span class="ident" id="4635735">Node</span>&nbsp;<span class="op" id="4635740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635743">return</span>&nbsp;<span class="ident" id="4635750">r</span><span class="op" id="4635751">.</span><span class="ident" id="4635752">tr</span><span class="op" id="4635754">.</span><span class="ident" id="4635755">newRange</span><span class="op" id="4635763">(</span><span class="ident" id="4635764">r</span><span class="op" id="4635765">.</span><span class="ident" id="4635766">Pos</span><span class="op" id="4635769">,</span>&nbsp;<span class="ident" id="4635771">r</span><span class="op" id="4635772">.</span><span class="ident" id="4635773">Line</span><span class="op" id="4635777">,</span>&nbsp;<span class="ident" id="4635779">r</span><span class="op" id="4635780">.</span><span class="ident" id="4635781">Pipe</span><span class="op" id="4635785">.</span><span class="ident" id="4635786">CopyPipe</span><span class="op" id="4635794">(</span><span class="op" id="4635795">)</span><span class="op" id="4635796">,</span>&nbsp;<span class="ident" id="4635798">r</span><span class="op" id="4635799">.</span><span class="ident" id="4635800">List</span><span class="op" id="4635804">.</span><span class="ident" id="4635805">CopyList</span><span class="op" id="4635813">(</span><span class="op" id="4635814">)</span><span class="op" id="4635815">,</span>&nbsp;<span class="ident" id="4635817">r</span><span class="op" id="4635818">.</span><span class="ident" id="4635819">ElseList</span><span class="op" id="4635827">.</span><span class="ident" id="4635828">CopyList</span><span class="op" id="4635836">(</span><span class="op" id="4635837">)</span><span class="op" id="4635838">)</span><br>
<span class="lineno"></span><span class="op" id="4635840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4635843">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="4635902">type</span>&nbsp;<span class="ident" id="4635907">WithNode</span>&nbsp;<span class="keyword" id="4635916">struct</span>&nbsp;<span class="op" id="4635923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635926">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4635937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4635940">func</span>&nbsp;<span class="op" id="4635945">(</span><span class="ident" id="4635946">t</span>&nbsp;<span class="op" id="4635948">*</span><span class="ident" id="4635949">Tree</span><span class="op" id="4635953">)</span>&nbsp;<span class="ident" id="4635955">newWith</span><span class="op" id="4635962">(</span><span class="ident" id="4635963">pos</span>&nbsp;<span class="ident" id="4635967">Pos</span><span class="op" id="4635970">,</span>&nbsp;<span class="ident" id="4635972">line</span>&nbsp;<span class="builtintype" id="4635977">int</span><span class="op" id="4635980">,</span>&nbsp;<span class="ident" id="4635982">pipe</span>&nbsp;<span class="op" id="4635987">*</span><span class="ident" id="4635988">PipeNode</span><span class="op" id="4635996">,</span>&nbsp;<span class="ident" id="4635998">list</span><span class="op" id="4636002">,</span>&nbsp;<span class="ident" id="4636004">elseList</span>&nbsp;<span class="op" id="4636013">*</span><span class="ident" id="4636014">ListNode</span><span class="op" id="4636022">)</span>&nbsp;<span class="op" id="4636024">*</span><span class="ident" id="4636025">WithNode</span>&nbsp;<span class="op" id="4636034">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636037">return</span>&nbsp;<span class="op" id="4636044">&amp;</span><span class="ident" id="4636045">WithNode</span><span class="op" id="4636053">{</span><span class="ident" id="4636054">BranchNode</span><span class="op" id="4636064">{</span><span class="ident" id="4636065">tr</span><span class="op" id="4636067">:</span>&nbsp;<span class="ident" id="4636069">t</span><span class="op" id="4636070">,</span>&nbsp;<span class="ident" id="4636072">NodeType</span><span class="op" id="4636080">:</span>&nbsp;<span class="ident" id="4636082">NodeWith</span><span class="op" id="4636090">,</span>&nbsp;<span class="ident" id="4636092">Pos</span><span class="op" id="4636095">:</span>&nbsp;<span class="ident" id="4636097">pos</span><span class="op" id="4636100">,</span>&nbsp;<span class="ident" id="4636102">Line</span><span class="op" id="4636106">:</span>&nbsp;<span class="ident" id="4636108">line</span><span class="op" id="4636112">,</span>&nbsp;<span class="ident" id="4636114">Pipe</span><span class="op" id="4636118">:</span>&nbsp;<span class="ident" id="4636120">pipe</span><span class="op" id="4636124">,</span>&nbsp;<span class="ident" id="4636126">List</span><span class="op" id="4636130">:</span>&nbsp;<span class="ident" id="4636132">list</span><span class="op" id="4636136">,</span>&nbsp;<span class="ident" id="4636138">ElseList</span><span class="op" id="4636146">:</span>&nbsp;<span class="ident" id="4636148">elseList</span><span class="op" id="4636156">}</span><span class="op" id="4636157">}</span><br>
<span class="lineno"></span><span class="op" id="4636159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4636162">func</span>&nbsp;<span class="op" id="4636167">(</span><span class="ident" id="4636168">w</span>&nbsp;<span class="op" id="4636170">*</span><span class="ident" id="4636171">WithNode</span><span class="op" id="4636179">)</span>&nbsp;<span class="ident" id="4636181">Copy</span><span class="op" id="4636185">(</span><span class="op" id="4636186">)</span>&nbsp;<span class="ident" id="4636188">Node</span>&nbsp;<span class="op" id="4636193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636196">return</span>&nbsp;<span class="ident" id="4636203">w</span><span class="op" id="4636204">.</span><span class="ident" id="4636205">tr</span><span class="op" id="4636207">.</span><span class="ident" id="4636208">newWith</span><span class="op" id="4636215">(</span><span class="ident" id="4636216">w</span><span class="op" id="4636217">.</span><span class="ident" id="4636218">Pos</span><span class="op" id="4636221">,</span>&nbsp;<span class="ident" id="4636223">w</span><span class="op" id="4636224">.</span><span class="ident" id="4636225">Line</span><span class="op" id="4636229">,</span>&nbsp;<span class="ident" id="4636231">w</span><span class="op" id="4636232">.</span><span class="ident" id="4636233">Pipe</span><span class="op" id="4636237">.</span><span class="ident" id="4636238">CopyPipe</span><span class="op" id="4636246">(</span><span class="op" id="4636247">)</span><span class="op" id="4636248">,</span>&nbsp;<span class="ident" id="4636250">w</span><span class="op" id="4636251">.</span><span class="ident" id="4636252">List</span><span class="op" id="4636256">.</span><span class="ident" id="4636257">CopyList</span><span class="op" id="4636265">(</span><span class="op" id="4636266">)</span><span class="op" id="4636267">,</span>&nbsp;<span class="ident" id="4636269">w</span><span class="op" id="4636270">.</span><span class="ident" id="4636271">ElseList</span><span class="op" id="4636279">.</span><span class="ident" id="4636280">CopyList</span><span class="op" id="4636288">(</span><span class="op" id="4636289">)</span><span class="op" id="4636290">)</span><br>
<span class="lineno">805</span><span class="op" id="4636292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4636295">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4636345">type</span>&nbsp;<span class="ident" id="4636350">TemplateNode</span>&nbsp;<span class="keyword" id="4636363">struct</span>&nbsp;<span class="op" id="4636370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636373">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636383">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636388">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4636393">*</span><span class="ident" id="4636394">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636400">Line</span>&nbsp;<span class="builtintype" id="4636405">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636415">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636485">Name</span>&nbsp;<span class="builtintype" id="4636490">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636500">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636541">Pipe</span>&nbsp;<span class="op" id="4636546">*</span><span class="ident" id="4636547">PipeNode</span>&nbsp;<span class="comment" id="4636556">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="4636608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4636611">func</span>&nbsp;<span class="op" id="4636616">(</span><span class="ident" id="4636617">t</span>&nbsp;<span class="op" id="4636619">*</span><span class="ident" id="4636620">Tree</span><span class="op" id="4636624">)</span>&nbsp;<span class="ident" id="4636626">newTemplate</span><span class="op" id="4636637">(</span><span class="ident" id="4636638">pos</span>&nbsp;<span class="ident" id="4636642">Pos</span><span class="op" id="4636645">,</span>&nbsp;<span class="ident" id="4636647">line</span>&nbsp;<span class="builtintype" id="4636652">int</span><span class="op" id="4636655">,</span>&nbsp;<span class="ident" id="4636657">name</span>&nbsp;<span class="builtintype" id="4636662">string</span><span class="op" id="4636668">,</span>&nbsp;<span class="ident" id="4636670">pipe</span>&nbsp;<span class="op" id="4636675">*</span><span class="ident" id="4636676">PipeNode</span><span class="op" id="4636684">)</span>&nbsp;<span class="op" id="4636686">*</span><span class="ident" id="4636687">TemplateNode</span>&nbsp;<span class="op" id="4636700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636703">return</span>&nbsp;<span class="op" id="4636710">&amp;</span><span class="ident" id="4636711">TemplateNode</span><span class="op" id="4636723">{</span><span class="ident" id="4636724">tr</span><span class="op" id="4636726">:</span>&nbsp;<span class="ident" id="4636728">t</span><span class="op" id="4636729">,</span>&nbsp;<span class="ident" id="4636731">NodeType</span><span class="op" id="4636739">:</span>&nbsp;<span class="ident" id="4636741">NodeTemplate</span><span class="op" id="4636753">,</span>&nbsp;<span class="ident" id="4636755">Pos</span><span class="op" id="4636758">:</span>&nbsp;<span class="ident" id="4636760">pos</span><span class="op" id="4636763">,</span>&nbsp;<span class="ident" id="4636765">Line</span><span class="op" id="4636769">:</span>&nbsp;<span class="ident" id="4636771">line</span><span class="op" id="4636775">,</span>&nbsp;<span class="ident" id="4636777">Name</span><span class="op" id="4636781">:</span>&nbsp;<span class="ident" id="4636783">name</span><span class="op" id="4636787">,</span>&nbsp;<span class="ident" id="4636789">Pipe</span><span class="op" id="4636793">:</span>&nbsp;<span class="ident" id="4636795">pipe</span><span class="op" id="4636799">}</span><br>
<span class="lineno"></span><span class="op" id="4636801">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="4636804">func</span>&nbsp;<span class="op" id="4636809">(</span><span class="ident" id="4636810">t</span>&nbsp;<span class="op" id="4636812">*</span><span class="ident" id="4636813">TemplateNode</span><span class="op" id="4636825">)</span>&nbsp;<span class="ident" id="4636827">String</span><span class="op" id="4636833">(</span><span class="op" id="4636834">)</span>&nbsp;<span class="builtintype" id="4636836">string</span>&nbsp;<span class="op" id="4636843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636846">if</span>&nbsp;<span class="ident" id="4636849">t</span><span class="op" id="4636850">.</span><span class="ident" id="4636851">Pipe</span>&nbsp;<span class="op" id="4636856">==</span>&nbsp;<span class="ident" id="4636859">nil</span>&nbsp;<span class="op" id="4636863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636867">return</span>&nbsp;<span class="ident" id="4636874">fmt</span><span class="op" id="4636877">.</span><span class="ident" id="4636878">Sprintf</span><span class="op" id="4636885">(</span><span class="string" id="4636886">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="4636903">,</span>&nbsp;<span class="ident" id="4636905">t</span><span class="op" id="4636906">.</span><span class="ident" id="4636907">Name</span><span class="op" id="4636911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4636914">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636917">return</span>&nbsp;<span class="ident" id="4636924">fmt</span><span class="op" id="4636927">.</span><span class="ident" id="4636928">Sprintf</span><span class="op" id="4636935">(</span><span class="string" id="4636936">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="4636956">,</span>&nbsp;<span class="ident" id="4636958">t</span><span class="op" id="4636959">.</span><span class="ident" id="4636960">Name</span><span class="op" id="4636964">,</span>&nbsp;<span class="ident" id="4636966">t</span><span class="op" id="4636967">.</span><span class="ident" id="4636968">Pipe</span><span class="op" id="4636972">)</span><br>
<span class="lineno"></span><span class="op" id="4636974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4636977">func</span>&nbsp;<span class="op" id="4636982">(</span><span class="ident" id="4636983">t</span>&nbsp;<span class="op" id="4636985">*</span><span class="ident" id="4636986">TemplateNode</span><span class="op" id="4636998">)</span>&nbsp;<span class="ident" id="4637000">tree</span><span class="op" id="4637004">(</span><span class="op" id="4637005">)</span>&nbsp;<span class="op" id="4637007">*</span><span class="ident" id="4637008">Tree</span>&nbsp;<span class="op" id="4637013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637016">return</span>&nbsp;<span class="ident" id="4637023">t</span><span class="op" id="4637024">.</span><span class="ident" id="4637025">tr</span><br>
<span class="lineno">830</span><span class="op" id="4637028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4637031">func</span>&nbsp;<span class="op" id="4637036">(</span><span class="ident" id="4637037">t</span>&nbsp;<span class="op" id="4637039">*</span><span class="ident" id="4637040">TemplateNode</span><span class="op" id="4637052">)</span>&nbsp;<span class="ident" id="4637054">Copy</span><span class="op" id="4637058">(</span><span class="op" id="4637059">)</span>&nbsp;<span class="ident" id="4637061">Node</span>&nbsp;<span class="op" id="4637066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637069">return</span>&nbsp;<span class="ident" id="4637076">t</span><span class="op" id="4637077">.</span><span class="ident" id="4637078">tr</span><span class="op" id="4637080">.</span><span class="ident" id="4637081">newTemplate</span><span class="op" id="4637092">(</span><span class="ident" id="4637093">t</span><span class="op" id="4637094">.</span><span class="ident" id="4637095">Pos</span><span class="op" id="4637098">,</span>&nbsp;<span class="ident" id="4637100">t</span><span class="op" id="4637101">.</span><span class="ident" id="4637102">Line</span><span class="op" id="4637106">,</span>&nbsp;<span class="ident" id="4637108">t</span><span class="op" id="4637109">.</span><span class="ident" id="4637110">Name</span><span class="op" id="4637114">,</span>&nbsp;<span class="ident" id="4637116">t</span><span class="op" id="4637117">.</span><span class="ident" id="4637118">Pipe</span><span class="op" id="4637122">.</span><span class="ident" id="4637123">CopyPipe</span><span class="op" id="4637131">(</span><span class="op" id="4637132">)</span><span class="op" id="4637133">)</span><br>
<span class="lineno"></span><span class="op" id="4637135">}</span>
</div>
</body>
</html>
