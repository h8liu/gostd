<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4016680">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4016735">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4016789">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4016840">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4016905">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4016954">package</span>&nbsp;<span class="ident" id="4016962">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4016967">type</span>&nbsp;<span class="ident" id="4016972">dnsConfig</span>&nbsp;<span class="keyword" id="4016982">struct</span>&nbsp;<span class="op" id="4016989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016992">servers</span>&nbsp;&nbsp;<span class="op" id="4017001">[</span><span class="op" id="4017002">]</span><span class="builtintype" id="4017003">string</span>&nbsp;<span class="comment" id="4017010">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017029">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4017038">[</span><span class="op" id="4017039">]</span><span class="builtintype" id="4017040">string</span>&nbsp;<span class="comment" id="4017047">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017084">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4017093">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017102">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017156">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="4017165">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017174">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017213">attempts</span>&nbsp;<span class="builtintype" id="4017222">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017231">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017275">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4017284">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017293">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="4017322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4017325">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="4017367">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="4017429">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="4017483">func</span>&nbsp;<span class="ident" id="4017488">dnsReadConfig</span><span class="op" id="4017501">(</span><span class="ident" id="4017502">filename</span>&nbsp;<span class="builtintype" id="4017511">string</span><span class="op" id="4017517">)</span>&nbsp;<span class="op" id="4017519">(</span><span class="op" id="4017520">*</span><span class="ident" id="4017521">dnsConfig</span><span class="op" id="4017530">,</span>&nbsp;<span class="builtintype" id="4017532">error</span><span class="op" id="4017537">)</span>&nbsp;<span class="op" id="4017539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017542">file</span><span class="op" id="4017546">,</span>&nbsp;<span class="ident" id="4017548">err</span>&nbsp;<span class="op" id="4017552">:=</span>&nbsp;<span class="ident" id="4017555">open</span><span class="op" id="4017559">(</span><span class="ident" id="4017560">filename</span><span class="op" id="4017568">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017571">if</span>&nbsp;<span class="ident" id="4017574">err</span>&nbsp;<span class="op" id="4017578">!=</span>&nbsp;<span class="ident" id="4017581">nil</span>&nbsp;<span class="op" id="4017585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017589">return</span>&nbsp;<span class="ident" id="4017596">nil</span><span class="op" id="4017599">,</span>&nbsp;<span class="op" id="4017601">&amp;</span><span class="ident" id="4017602">DNSConfigError</span><span class="op" id="4017616">{</span><span class="ident" id="4017617">err</span><span class="op" id="4017620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017626">defer</span>&nbsp;<span class="ident" id="4017632">file</span><span class="op" id="4017636">.</span><span class="builtinfunc" id="4017637">close</span><span class="op" id="4017642">(</span><span class="op" id="4017643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017646">conf</span>&nbsp;<span class="op" id="4017651">:=</span>&nbsp;<span class="op" id="4017654">&amp;</span><span class="ident" id="4017655">dnsConfig</span><span class="op" id="4017664">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017668">ndots</span><span class="op" id="4017673">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4017678">1</span><span class="op" id="4017679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017683">timeout</span><span class="op" id="4017690">:</span>&nbsp;&nbsp;<span class="num" id="4017693">5</span><span class="op" id="4017694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017698">attempts</span><span class="op" id="4017706">:</span>&nbsp;<span class="num" id="4017708">2</span><span class="op" id="4017709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017715">for</span>&nbsp;<span class="ident" id="4017719">line</span><span class="op" id="4017723">,</span>&nbsp;<span class="ident" id="4017725">ok</span>&nbsp;<span class="op" id="4017728">:=</span>&nbsp;<span class="ident" id="4017731">file</span><span class="op" id="4017735">.</span><span class="ident" id="4017736">readLine</span><span class="op" id="4017744">(</span><span class="op" id="4017745">)</span><span class="op" id="4017746">;</span>&nbsp;<span class="ident" id="4017748">ok</span><span class="op" id="4017750">;</span>&nbsp;<span class="ident" id="4017752">line</span><span class="op" id="4017756">,</span>&nbsp;<span class="ident" id="4017758">ok</span>&nbsp;<span class="op" id="4017761">=</span>&nbsp;<span class="ident" id="4017763">file</span><span class="op" id="4017767">.</span><span class="ident" id="4017768">readLine</span><span class="op" id="4017776">(</span><span class="op" id="4017777">)</span>&nbsp;<span class="op" id="4017779">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017783">f</span>&nbsp;<span class="op" id="4017785">:=</span>&nbsp;<span class="ident" id="4017788">getFields</span><span class="op" id="4017797">(</span><span class="ident" id="4017798">line</span><span class="op" id="4017802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017806">if</span>&nbsp;<span class="builtinfunc" id="4017809">len</span><span class="op" id="4017812">(</span><span class="ident" id="4017813">f</span><span class="op" id="4017814">)</span>&nbsp;<span class="op" id="4017816">&lt;</span>&nbsp;<span class="num" id="4017818">1</span>&nbsp;<span class="op" id="4017820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017840">switch</span>&nbsp;<span class="ident" id="4017847">f</span><span class="op" id="4017848">[</span><span class="num" id="4017849">0</span><span class="op" id="4017850">]</span>&nbsp;<span class="op" id="4017852">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017856">case</span>&nbsp;<span class="string" id="4017861">&#34;nameserver&#34;</span><span class="op" id="4017873">:</span>&nbsp;<span class="comment" id="4017875">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017901">if</span>&nbsp;<span class="builtinfunc" id="4017904">len</span><span class="op" id="4017907">(</span><span class="ident" id="4017908">f</span><span class="op" id="4017909">)</span>&nbsp;<span class="op" id="4017911">&gt;</span>&nbsp;<span class="num" id="4017913">1</span>&nbsp;<span class="op" id="4017915">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4017918">len</span><span class="op" id="4017921">(</span><span class="ident" id="4017922">conf</span><span class="op" id="4017926">.</span><span class="ident" id="4017927">servers</span><span class="op" id="4017934">)</span>&nbsp;<span class="op" id="4017936">&lt;</span>&nbsp;<span class="num" id="4017938">3</span>&nbsp;<span class="op" id="4017940">{</span>&nbsp;<span class="comment" id="4017942">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017979">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018027">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018077">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018099">if</span>&nbsp;<span class="ident" id="4018102">parseIPv4</span><span class="op" id="4018111">(</span><span class="ident" id="4018112">f</span><span class="op" id="4018113">[</span><span class="num" id="4018114">1</span><span class="op" id="4018115">]</span><span class="op" id="4018116">)</span>&nbsp;<span class="op" id="4018118">!=</span>&nbsp;<span class="ident" id="4018121">nil</span>&nbsp;<span class="op" id="4018125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018132">conf</span><span class="op" id="4018136">.</span><span class="ident" id="4018137">servers</span>&nbsp;<span class="op" id="4018145">=</span>&nbsp;<span class="builtinfunc" id="4018147">append</span><span class="op" id="4018153">(</span><span class="ident" id="4018154">conf</span><span class="op" id="4018158">.</span><span class="ident" id="4018159">servers</span><span class="op" id="4018166">,</span>&nbsp;<span class="ident" id="4018168">f</span><span class="op" id="4018169">[</span><span class="num" id="4018170">1</span><span class="op" id="4018171">]</span><span class="op" id="4018172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018178">}</span>&nbsp;<span class="keyword" id="4018180">else</span>&nbsp;<span class="keyword" id="4018185">if</span>&nbsp;<span class="ident" id="4018188">ip</span><span class="op" id="4018190">,</span>&nbsp;<span class="ident" id="4018192">_</span>&nbsp;<span class="op" id="4018194">:=</span>&nbsp;<span class="ident" id="4018197">parseIPv6</span><span class="op" id="4018206">(</span><span class="ident" id="4018207">f</span><span class="op" id="4018208">[</span><span class="num" id="4018209">1</span><span class="op" id="4018210">]</span><span class="op" id="4018211">,</span>&nbsp;<span class="builtintype" id="4018213">true</span><span class="op" id="4018217">)</span><span class="op" id="4018218">;</span>&nbsp;<span class="ident" id="4018220">ip</span>&nbsp;<span class="op" id="4018223">!=</span>&nbsp;<span class="ident" id="4018226">nil</span>&nbsp;<span class="op" id="4018230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018237">conf</span><span class="op" id="4018241">.</span><span class="ident" id="4018242">servers</span>&nbsp;<span class="op" id="4018250">=</span>&nbsp;<span class="builtinfunc" id="4018252">append</span><span class="op" id="4018258">(</span><span class="ident" id="4018259">conf</span><span class="op" id="4018263">.</span><span class="ident" id="4018264">servers</span><span class="op" id="4018271">,</span>&nbsp;<span class="ident" id="4018273">f</span><span class="op" id="4018274">[</span><span class="num" id="4018275">1</span><span class="op" id="4018276">]</span><span class="op" id="4018277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018283">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018293">case</span>&nbsp;<span class="string" id="4018298">&#34;domain&#34;</span><span class="op" id="4018306">:</span>&nbsp;<span class="comment" id="4018308">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018350">if</span>&nbsp;<span class="builtinfunc" id="4018353">len</span><span class="op" id="4018356">(</span><span class="ident" id="4018357">f</span><span class="op" id="4018358">)</span>&nbsp;<span class="op" id="4018360">&gt;</span>&nbsp;<span class="num" id="4018362">1</span>&nbsp;<span class="op" id="4018364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018370">conf</span><span class="op" id="4018374">.</span><span class="ident" id="4018375">search</span>&nbsp;<span class="op" id="4018382">=</span>&nbsp;<span class="op" id="4018384">[</span><span class="op" id="4018385">]</span><span class="builtintype" id="4018386">string</span><span class="op" id="4018392">{</span><span class="ident" id="4018393">f</span><span class="op" id="4018394">[</span><span class="num" id="4018395">1</span><span class="op" id="4018396">]</span><span class="op" id="4018397">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018407">case</span>&nbsp;<span class="string" id="4018412">&#34;search&#34;</span><span class="op" id="4018420">:</span>&nbsp;<span class="comment" id="4018422">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018461">conf</span><span class="op" id="4018465">.</span><span class="ident" id="4018466">search</span>&nbsp;<span class="op" id="4018473">=</span>&nbsp;<span class="builtinfunc" id="4018475">make</span><span class="op" id="4018479">(</span><span class="op" id="4018480">[</span><span class="op" id="4018481">]</span><span class="builtintype" id="4018482">string</span><span class="op" id="4018488">,</span>&nbsp;<span class="builtinfunc" id="4018490">len</span><span class="op" id="4018493">(</span><span class="ident" id="4018494">f</span><span class="op" id="4018495">)</span><span class="op" id="4018496">-</span><span class="num" id="4018497">1</span><span class="op" id="4018498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018503">for</span>&nbsp;<span class="ident" id="4018507">i</span>&nbsp;<span class="op" id="4018509">:=</span>&nbsp;<span class="num" id="4018512">0</span><span class="op" id="4018513">;</span>&nbsp;<span class="ident" id="4018515">i</span>&nbsp;<span class="op" id="4018517">&lt;</span>&nbsp;<span class="builtinfunc" id="4018519">len</span><span class="op" id="4018522">(</span><span class="ident" id="4018523">conf</span><span class="op" id="4018527">.</span><span class="ident" id="4018528">search</span><span class="op" id="4018534">)</span><span class="op" id="4018535">;</span>&nbsp;<span class="ident" id="4018537">i</span><span class="op" id="4018538">++</span>&nbsp;<span class="op" id="4018541">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018547">conf</span><span class="op" id="4018551">.</span><span class="ident" id="4018552">search</span><span class="op" id="4018558">[</span><span class="ident" id="4018559">i</span><span class="op" id="4018560">]</span>&nbsp;<span class="op" id="4018562">=</span>&nbsp;<span class="ident" id="4018564">f</span><span class="op" id="4018565">[</span><span class="ident" id="4018566">i</span><span class="op" id="4018567">+</span><span class="num" id="4018568">1</span><span class="op" id="4018569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018579">case</span>&nbsp;<span class="string" id="4018584">&#34;options&#34;</span><span class="op" id="4018593">:</span>&nbsp;<span class="comment" id="4018595">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018615">for</span>&nbsp;<span class="ident" id="4018619">i</span>&nbsp;<span class="op" id="4018621">:=</span>&nbsp;<span class="num" id="4018624">1</span><span class="op" id="4018625">;</span>&nbsp;<span class="ident" id="4018627">i</span>&nbsp;<span class="op" id="4018629">&lt;</span>&nbsp;<span class="builtinfunc" id="4018631">len</span><span class="op" id="4018634">(</span><span class="ident" id="4018635">f</span><span class="op" id="4018636">)</span><span class="op" id="4018637">;</span>&nbsp;<span class="ident" id="4018639">i</span><span class="op" id="4018640">++</span>&nbsp;<span class="op" id="4018643">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018649">s</span>&nbsp;<span class="op" id="4018651">:=</span>&nbsp;<span class="ident" id="4018654">f</span><span class="op" id="4018655">[</span><span class="ident" id="4018656">i</span><span class="op" id="4018657">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018663">switch</span>&nbsp;<span class="op" id="4018670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018676">case</span>&nbsp;<span class="ident" id="4018681">hasPrefix</span><span class="op" id="4018690">(</span><span class="ident" id="4018691">s</span><span class="op" id="4018692">,</span>&nbsp;<span class="string" id="4018694">&#34;ndots:&#34;</span><span class="op" id="4018702">)</span><span class="op" id="4018703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018710">n</span><span class="op" id="4018711">,</span>&nbsp;<span class="ident" id="4018713">_</span><span class="op" id="4018714">,</span>&nbsp;<span class="ident" id="4018716">_</span>&nbsp;<span class="op" id="4018718">:=</span>&nbsp;<span class="ident" id="4018721">dtoi</span><span class="op" id="4018725">(</span><span class="ident" id="4018726">s</span><span class="op" id="4018727">,</span>&nbsp;<span class="num" id="4018729">6</span><span class="op" id="4018730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018737">if</span>&nbsp;<span class="ident" id="4018740">n</span>&nbsp;<span class="op" id="4018742">&lt;</span>&nbsp;<span class="num" id="4018744">1</span>&nbsp;<span class="op" id="4018746">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018754">n</span>&nbsp;<span class="op" id="4018756">=</span>&nbsp;<span class="num" id="4018758">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018772">conf</span><span class="op" id="4018776">.</span><span class="ident" id="4018777">ndots</span>&nbsp;<span class="op" id="4018783">=</span>&nbsp;<span class="ident" id="4018785">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018791">case</span>&nbsp;<span class="ident" id="4018796">hasPrefix</span><span class="op" id="4018805">(</span><span class="ident" id="4018806">s</span><span class="op" id="4018807">,</span>&nbsp;<span class="string" id="4018809">&#34;timeout:&#34;</span><span class="op" id="4018819">)</span><span class="op" id="4018820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018827">n</span><span class="op" id="4018828">,</span>&nbsp;<span class="ident" id="4018830">_</span><span class="op" id="4018831">,</span>&nbsp;<span class="ident" id="4018833">_</span>&nbsp;<span class="op" id="4018835">:=</span>&nbsp;<span class="ident" id="4018838">dtoi</span><span class="op" id="4018842">(</span><span class="ident" id="4018843">s</span><span class="op" id="4018844">,</span>&nbsp;<span class="num" id="4018846">8</span><span class="op" id="4018847">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018854">if</span>&nbsp;<span class="ident" id="4018857">n</span>&nbsp;<span class="op" id="4018859">&lt;</span>&nbsp;<span class="num" id="4018861">1</span>&nbsp;<span class="op" id="4018863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018871">n</span>&nbsp;<span class="op" id="4018873">=</span>&nbsp;<span class="num" id="4018875">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018889">conf</span><span class="op" id="4018893">.</span><span class="ident" id="4018894">timeout</span>&nbsp;<span class="op" id="4018902">=</span>&nbsp;<span class="ident" id="4018904">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018910">case</span>&nbsp;<span class="ident" id="4018915">hasPrefix</span><span class="op" id="4018924">(</span><span class="ident" id="4018925">s</span><span class="op" id="4018926">,</span>&nbsp;<span class="string" id="4018928">&#34;attempts:&#34;</span><span class="op" id="4018939">)</span><span class="op" id="4018940">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018947">n</span><span class="op" id="4018948">,</span>&nbsp;<span class="ident" id="4018950">_</span><span class="op" id="4018951">,</span>&nbsp;<span class="ident" id="4018953">_</span>&nbsp;<span class="op" id="4018955">:=</span>&nbsp;<span class="ident" id="4018958">dtoi</span><span class="op" id="4018962">(</span><span class="ident" id="4018963">s</span><span class="op" id="4018964">,</span>&nbsp;<span class="num" id="4018966">9</span><span class="op" id="4018967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018974">if</span>&nbsp;<span class="ident" id="4018977">n</span>&nbsp;<span class="op" id="4018979">&lt;</span>&nbsp;<span class="num" id="4018981">1</span>&nbsp;<span class="op" id="4018983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018991">n</span>&nbsp;<span class="op" id="4018993">=</span>&nbsp;<span class="num" id="4018995">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019009">conf</span><span class="op" id="4019013">.</span><span class="ident" id="4019014">attempts</span>&nbsp;<span class="op" id="4019023">=</span>&nbsp;<span class="ident" id="4019025">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019031">case</span>&nbsp;<span class="ident" id="4019036">s</span>&nbsp;<span class="op" id="4019038">==</span>&nbsp;<span class="string" id="4019041">&#34;rotate&#34;</span><span class="op" id="4019049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019056">conf</span><span class="op" id="4019060">.</span><span class="ident" id="4019061">rotate</span>&nbsp;<span class="op" id="4019068">=</span>&nbsp;<span class="builtintype" id="4019070">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019088">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019094">return</span>&nbsp;<span class="ident" id="4019101">conf</span><span class="op" id="4019105">,</span>&nbsp;<span class="ident" id="4019107">nil</span><br>
<span class="lineno"></span><span class="op" id="4019111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4019114">func</span>&nbsp;<span class="ident" id="4019119">hasPrefix</span><span class="op" id="4019128">(</span><span class="ident" id="4019129">s</span><span class="op" id="4019130">,</span>&nbsp;<span class="ident" id="4019132">prefix</span>&nbsp;<span class="builtintype" id="4019139">string</span><span class="op" id="4019145">)</span>&nbsp;<span class="builtintype" id="4019147">bool</span>&nbsp;<span class="op" id="4019152">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019155">return</span>&nbsp;<span class="builtinfunc" id="4019162">len</span><span class="op" id="4019165">(</span><span class="ident" id="4019166">s</span><span class="op" id="4019167">)</span>&nbsp;<span class="op" id="4019169">&gt;=</span>&nbsp;<span class="builtinfunc" id="4019172">len</span><span class="op" id="4019175">(</span><span class="ident" id="4019176">prefix</span><span class="op" id="4019182">)</span>&nbsp;<span class="op" id="4019184">&amp;&amp;</span>&nbsp;<span class="ident" id="4019187">s</span><span class="op" id="4019188">[</span><span class="op" id="4019189">:</span><span class="builtinfunc" id="4019190">len</span><span class="op" id="4019193">(</span><span class="ident" id="4019194">prefix</span><span class="op" id="4019200">)</span><span class="op" id="4019201">]</span>&nbsp;<span class="op" id="4019203">==</span>&nbsp;<span class="ident" id="4019206">prefix</span><br>
<span class="lineno"></span><span class="op" id="4019213">}</span>
</div>
</body>
</html>
