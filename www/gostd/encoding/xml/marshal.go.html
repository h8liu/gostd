<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html" class="current">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6176986">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6177041">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6177095">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6177146">package</span>&nbsp;<span class="ident" id="6177154">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6177159">import</span>&nbsp;<span class="op" id="6177166">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177169">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177178">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177187">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177199">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177206">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177212">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177223">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6177234">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6177244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6177247">const</span>&nbsp;<span class="op" id="6177253">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6177256">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6177326">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6177393">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6177430">Header</span>&nbsp;<span class="op" id="6177437">=</span>&nbsp;<span class="string" id="6177439">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="6177480">+</span>&nbsp;<span class="string" id="6177482">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="6177487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6177490">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="6177532">//</span><br>
<span class="lineno"></span><span class="comment" id="6177535">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6177609">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6177687">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="6177765">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6177840">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="6177919">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6177952">//</span><br>
<span class="lineno"></span><span class="comment" id="6177955">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="6178027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="6178090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="6178147">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6178208">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6178270">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="6178311">//</span><br>
<span class="lineno"></span><span class="comment" id="6178314">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6178391">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="6178448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="6178505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="6178547">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6178611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6178655">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6178719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6178759">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="6178827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6178859">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="6178930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="6178975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6179046">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="6179119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6179155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="6179227">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6179300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6179371">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="6179403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6179473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="6179519">//</span><br>
<span class="lineno"></span><span class="comment" id="6179522">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="6179597">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="6179674">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6179730">//</span><br>
<span class="lineno"></span><span class="comment" id="6179733">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="6179770">//</span><br>
<span class="lineno"></span><span class="comment" id="6179773">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="6179854">func</span>&nbsp;<span class="ident" id="6179859">Marshal</span><span class="op" id="6179866">(</span><span class="ident" id="6179867">v</span>&nbsp;<span class="keyword" id="6179869">interface</span><span class="op" id="6179878">{</span><span class="op" id="6179879">}</span><span class="op" id="6179880">)</span>&nbsp;<span class="op" id="6179882">(</span><span class="op" id="6179883">[</span><span class="op" id="6179884">]</span><span class="builtintype" id="6179885">byte</span><span class="op" id="6179889">,</span>&nbsp;<span class="builtintype" id="6179891">error</span><span class="op" id="6179896">)</span>&nbsp;<span class="op" id="6179898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6179901">var</span>&nbsp;<span class="ident" id="6179905">b</span>&nbsp;<span class="ident" id="6179907">bytes</span><span class="op" id="6179912">.</span><span class="ident" id="6179913">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6179921">if</span>&nbsp;<span class="ident" id="6179924">err</span>&nbsp;<span class="op" id="6179928">:=</span>&nbsp;<span class="ident" id="6179931">NewEncoder</span><span class="op" id="6179941">(</span><span class="op" id="6179942">&amp;</span><span class="ident" id="6179943">b</span><span class="op" id="6179944">)</span><span class="op" id="6179945">.</span><span class="ident" id="6179946">Encode</span><span class="op" id="6179952">(</span><span class="ident" id="6179953">v</span><span class="op" id="6179954">)</span><span class="op" id="6179955">;</span>&nbsp;<span class="ident" id="6179957">err</span>&nbsp;<span class="op" id="6179961">!=</span>&nbsp;<span class="builtintype" id="6179964">nil</span>&nbsp;<span class="op" id="6179968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6179972">return</span>&nbsp;<span class="builtintype" id="6179979">nil</span><span class="op" id="6179982">,</span>&nbsp;<span class="ident" id="6179984">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6179989">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6179992">return</span>&nbsp;<span class="ident" id="6179999">b</span><span class="op" id="6180000">.</span><span class="ident" id="6180001">Bytes</span><span class="op" id="6180006">(</span><span class="op" id="6180007">)</span><span class="op" id="6180008">,</span>&nbsp;<span class="builtintype" id="6180010">nil</span><br>
<span class="lineno"></span><span class="op" id="6180014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6180017">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6180087">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="6180126">//</span><br>
<span class="lineno"></span><span class="comment" id="6180129">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6180194">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="6180265">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="6180296">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="6180360">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6180426">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="6180443">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="6180508">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6180573">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="6180612">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="6180681">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6180732">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="6180798">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6180815">type</span>&nbsp;<span class="ident" id="6180820">Marshaler</span>&nbsp;<span class="keyword" id="6180830">interface</span>&nbsp;<span class="op" id="6180840">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6180843">MarshalXML</span><span class="op" id="6180853">(</span><span class="ident" id="6180854">e</span>&nbsp;<span class="op" id="6180856">*</span><span class="ident" id="6180857">Encoder</span><span class="op" id="6180864">,</span>&nbsp;<span class="ident" id="6180866">start</span>&nbsp;<span class="ident" id="6180872">StartElement</span><span class="op" id="6180884">)</span>&nbsp;<span class="builtintype" id="6180886">error</span><br>
<span class="lineno"></span><span class="op" id="6180892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6180895">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6180969">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="6181010">//</span><br>
<span class="lineno"></span><span class="comment" id="6181013">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="6181096">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="6181162">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6181225">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="6181242">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="6181311">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="6181347">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6181405">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="6181440">type</span>&nbsp;<span class="ident" id="6181445">MarshalerAttr</span>&nbsp;<span class="keyword" id="6181459">interface</span>&nbsp;<span class="op" id="6181469">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6181472">MarshalXMLAttr</span><span class="op" id="6181486">(</span><span class="ident" id="6181487">name</span>&nbsp;<span class="ident" id="6181492">Name</span><span class="op" id="6181496">)</span>&nbsp;<span class="op" id="6181498">(</span><span class="ident" id="6181499">Attr</span><span class="op" id="6181503">,</span>&nbsp;<span class="builtintype" id="6181505">error</span><span class="op" id="6181510">)</span><br>
<span class="lineno"></span><span class="op" id="6181512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6181515">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="6181589">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="6181661">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6181713">func</span>&nbsp;<span class="ident" id="6181718">MarshalIndent</span><span class="op" id="6181731">(</span><span class="ident" id="6181732">v</span>&nbsp;<span class="keyword" id="6181734">interface</span><span class="op" id="6181743">{</span><span class="op" id="6181744">}</span><span class="op" id="6181745">,</span>&nbsp;<span class="ident" id="6181747">prefix</span><span class="op" id="6181753">,</span>&nbsp;<span class="ident" id="6181755">indent</span>&nbsp;<span class="builtintype" id="6181762">string</span><span class="op" id="6181768">)</span>&nbsp;<span class="op" id="6181770">(</span><span class="op" id="6181771">[</span><span class="op" id="6181772">]</span><span class="builtintype" id="6181773">byte</span><span class="op" id="6181777">,</span>&nbsp;<span class="builtintype" id="6181779">error</span><span class="op" id="6181784">)</span>&nbsp;<span class="op" id="6181786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6181789">var</span>&nbsp;<span class="ident" id="6181793">b</span>&nbsp;<span class="ident" id="6181795">bytes</span><span class="op" id="6181800">.</span><span class="ident" id="6181801">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6181809">enc</span>&nbsp;<span class="op" id="6181813">:=</span>&nbsp;<span class="ident" id="6181816">NewEncoder</span><span class="op" id="6181826">(</span><span class="op" id="6181827">&amp;</span><span class="ident" id="6181828">b</span><span class="op" id="6181829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6181832">enc</span><span class="op" id="6181835">.</span><span class="ident" id="6181836">Indent</span><span class="op" id="6181842">(</span><span class="ident" id="6181843">prefix</span><span class="op" id="6181849">,</span>&nbsp;<span class="ident" id="6181851">indent</span><span class="op" id="6181857">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6181860">if</span>&nbsp;<span class="ident" id="6181863">err</span>&nbsp;<span class="op" id="6181867">:=</span>&nbsp;<span class="ident" id="6181870">enc</span><span class="op" id="6181873">.</span><span class="ident" id="6181874">Encode</span><span class="op" id="6181880">(</span><span class="ident" id="6181881">v</span><span class="op" id="6181882">)</span><span class="op" id="6181883">;</span>&nbsp;<span class="ident" id="6181885">err</span>&nbsp;<span class="op" id="6181889">!=</span>&nbsp;<span class="builtintype" id="6181892">nil</span>&nbsp;<span class="op" id="6181896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6181900">return</span>&nbsp;<span class="builtintype" id="6181907">nil</span><span class="op" id="6181910">,</span>&nbsp;<span class="ident" id="6181912">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6181917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6181920">return</span>&nbsp;<span class="ident" id="6181927">b</span><span class="op" id="6181928">.</span><span class="ident" id="6181929">Bytes</span><span class="op" id="6181934">(</span><span class="op" id="6181935">)</span><span class="op" id="6181936">,</span>&nbsp;<span class="builtintype" id="6181938">nil</span><br>
<span class="lineno"></span><span class="op" id="6181942">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6181945">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6181996">type</span>&nbsp;<span class="ident" id="6182001">Encoder</span>&nbsp;<span class="keyword" id="6182009">struct</span>&nbsp;<span class="op" id="6182016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182019">p</span>&nbsp;<span class="ident" id="6182021">printer</span><br>
<span class="lineno"></span><span class="op" id="6182029">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="6182032">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6182086">func</span>&nbsp;<span class="ident" id="6182091">NewEncoder</span><span class="op" id="6182101">(</span><span class="ident" id="6182102">w</span>&nbsp;<span class="ident" id="6182104">io</span><span class="op" id="6182106">.</span><span class="ident" id="6182107">Writer</span><span class="op" id="6182113">)</span>&nbsp;<span class="op" id="6182115">*</span><span class="ident" id="6182116">Encoder</span>&nbsp;<span class="op" id="6182124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182127">e</span>&nbsp;<span class="op" id="6182129">:=</span>&nbsp;<span class="op" id="6182132">&amp;</span><span class="ident" id="6182133">Encoder</span><span class="op" id="6182140">{</span><span class="ident" id="6182141">printer</span><span class="op" id="6182148">{</span><span class="ident" id="6182149">Writer</span><span class="op" id="6182155">:</span>&nbsp;<span class="ident" id="6182157">bufio</span><span class="op" id="6182162">.</span><span class="ident" id="6182163">NewWriter</span><span class="op" id="6182172">(</span><span class="ident" id="6182173">w</span><span class="op" id="6182174">)</span><span class="op" id="6182175">}</span><span class="op" id="6182176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182179">e</span><span class="op" id="6182180">.</span><span class="ident" id="6182181">p</span><span class="op" id="6182182">.</span><span class="ident" id="6182183">encoder</span>&nbsp;<span class="op" id="6182191">=</span>&nbsp;<span class="ident" id="6182193">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6182196">return</span>&nbsp;<span class="ident" id="6182203">e</span><br>
<span class="lineno"></span><span class="op" id="6182205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6182208">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="6182273">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="6182349">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6182413">func</span>&nbsp;<span class="op" id="6182418">(</span><span class="ident" id="6182419">enc</span>&nbsp;<span class="op" id="6182423">*</span><span class="ident" id="6182424">Encoder</span><span class="op" id="6182431">)</span>&nbsp;<span class="ident" id="6182433">Indent</span><span class="op" id="6182439">(</span><span class="ident" id="6182440">prefix</span><span class="op" id="6182446">,</span>&nbsp;<span class="ident" id="6182448">indent</span>&nbsp;<span class="builtintype" id="6182455">string</span><span class="op" id="6182461">)</span>&nbsp;<span class="op" id="6182463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182466">enc</span><span class="op" id="6182469">.</span><span class="ident" id="6182470">p</span><span class="op" id="6182471">.</span><span class="ident" id="6182472">prefix</span>&nbsp;<span class="op" id="6182479">=</span>&nbsp;<span class="ident" id="6182481">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182489">enc</span><span class="op" id="6182492">.</span><span class="ident" id="6182493">p</span><span class="op" id="6182494">.</span><span class="ident" id="6182495">indent</span>&nbsp;<span class="op" id="6182502">=</span>&nbsp;<span class="ident" id="6182504">indent</span><br>
<span class="lineno"></span><span class="op" id="6182511">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="6182514">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6182568">//</span><br>
<span class="lineno"></span><span class="comment" id="6182571">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6182641">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="6182665">//</span><br>
<span class="lineno"></span><span class="comment" id="6182668">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6182708">func</span>&nbsp;<span class="op" id="6182713">(</span><span class="ident" id="6182714">enc</span>&nbsp;<span class="op" id="6182718">*</span><span class="ident" id="6182719">Encoder</span><span class="op" id="6182726">)</span>&nbsp;<span class="ident" id="6182728">Encode</span><span class="op" id="6182734">(</span><span class="ident" id="6182735">v</span>&nbsp;<span class="keyword" id="6182737">interface</span><span class="op" id="6182746">{</span><span class="op" id="6182747">}</span><span class="op" id="6182748">)</span>&nbsp;<span class="builtintype" id="6182750">error</span>&nbsp;<span class="op" id="6182756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6182759">err</span>&nbsp;<span class="op" id="6182763">:=</span>&nbsp;<span class="ident" id="6182766">enc</span><span class="op" id="6182769">.</span><span class="ident" id="6182770">p</span><span class="op" id="6182771">.</span><span class="ident" id="6182772">marshalValue</span><span class="op" id="6182784">(</span><span class="ident" id="6182785">reflect</span><span class="op" id="6182792">.</span><span class="ident" id="6182793">ValueOf</span><span class="op" id="6182800">(</span><span class="ident" id="6182801">v</span><span class="op" id="6182802">)</span><span class="op" id="6182803">,</span>&nbsp;<span class="builtintype" id="6182805">nil</span><span class="op" id="6182808">,</span>&nbsp;<span class="builtintype" id="6182810">nil</span><span class="op" id="6182813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6182816">if</span>&nbsp;<span class="ident" id="6182819">err</span>&nbsp;<span class="op" id="6182823">!=</span>&nbsp;<span class="builtintype" id="6182826">nil</span>&nbsp;<span class="op" id="6182830">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6182834">return</span>&nbsp;<span class="ident" id="6182841">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6182846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6182849">return</span>&nbsp;<span class="ident" id="6182856">enc</span><span class="op" id="6182859">.</span><span class="ident" id="6182860">p</span><span class="op" id="6182861">.</span><span class="ident" id="6182862">Flush</span><span class="op" id="6182867">(</span><span class="op" id="6182868">)</span><br>
<span class="lineno"></span><span class="op" id="6182870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6182873">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="6182934">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="6182987">//</span><br>
<span class="lineno"></span><span class="comment" id="6182990">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6183060">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="6183084">//</span><br>
<span class="lineno"></span><span class="comment" id="6183087">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6183134">func</span>&nbsp;<span class="op" id="6183139">(</span><span class="ident" id="6183140">enc</span>&nbsp;<span class="op" id="6183144">*</span><span class="ident" id="6183145">Encoder</span><span class="op" id="6183152">)</span>&nbsp;<span class="ident" id="6183154">EncodeElement</span><span class="op" id="6183167">(</span><span class="ident" id="6183168">v</span>&nbsp;<span class="keyword" id="6183170">interface</span><span class="op" id="6183179">{</span><span class="op" id="6183180">}</span><span class="op" id="6183181">,</span>&nbsp;<span class="ident" id="6183183">start</span>&nbsp;<span class="ident" id="6183189">StartElement</span><span class="op" id="6183201">)</span>&nbsp;<span class="builtintype" id="6183203">error</span>&nbsp;<span class="op" id="6183209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6183212">err</span>&nbsp;<span class="op" id="6183216">:=</span>&nbsp;<span class="ident" id="6183219">enc</span><span class="op" id="6183222">.</span><span class="ident" id="6183223">p</span><span class="op" id="6183224">.</span><span class="ident" id="6183225">marshalValue</span><span class="op" id="6183237">(</span><span class="ident" id="6183238">reflect</span><span class="op" id="6183245">.</span><span class="ident" id="6183246">ValueOf</span><span class="op" id="6183253">(</span><span class="ident" id="6183254">v</span><span class="op" id="6183255">)</span><span class="op" id="6183256">,</span>&nbsp;<span class="builtintype" id="6183258">nil</span><span class="op" id="6183261">,</span>&nbsp;<span class="op" id="6183263">&amp;</span><span class="ident" id="6183264">start</span><span class="op" id="6183269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6183272">if</span>&nbsp;<span class="ident" id="6183275">err</span>&nbsp;<span class="op" id="6183279">!=</span>&nbsp;<span class="builtintype" id="6183282">nil</span>&nbsp;<span class="op" id="6183286">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6183290">return</span>&nbsp;<span class="ident" id="6183297">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6183302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6183305">return</span>&nbsp;<span class="ident" id="6183312">enc</span><span class="op" id="6183315">.</span><span class="ident" id="6183316">p</span><span class="op" id="6183317">.</span><span class="ident" id="6183318">Flush</span><span class="op" id="6183323">(</span><span class="op" id="6183324">)</span><br>
<span class="lineno"></span><span class="op" id="6183326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6183329">var</span>&nbsp;<span class="op" id="6183333">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6183336">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6183349">=</span>&nbsp;<span class="op" id="6183351">[</span><span class="op" id="6183352">]</span><span class="builtintype" id="6183353">byte</span><span class="op" id="6183357">(</span><span class="string" id="6183358">&#34;--&gt;&#34;</span><span class="op" id="6183363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6183366">endProcInst</span>&nbsp;&nbsp;<span class="op" id="6183379">=</span>&nbsp;<span class="op" id="6183381">[</span><span class="op" id="6183382">]</span><span class="builtintype" id="6183383">byte</span><span class="op" id="6183387">(</span><span class="string" id="6183388">&#34;?&gt;&#34;</span><span class="op" id="6183392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6183395">endDirective</span>&nbsp;<span class="op" id="6183408">=</span>&nbsp;<span class="op" id="6183410">[</span><span class="op" id="6183411">]</span><span class="builtintype" id="6183412">byte</span><span class="op" id="6183416">(</span><span class="string" id="6183417">&#34;&gt;&#34;</span><span class="op" id="6183420">)</span><br>
<span class="lineno"></span><span class="op" id="6183422">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="6183425">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6183482">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="6183569">//</span><br>
<span class="lineno"></span><span class="comment" id="6183572">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="6183657">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="6183736">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="6183795">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="6183875">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="6183952">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="6184005">//</span><br>
<span class="lineno"></span><span class="comment" id="6184008">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="6184098">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6184116">func</span>&nbsp;<span class="op" id="6184121">(</span><span class="ident" id="6184122">enc</span>&nbsp;<span class="op" id="6184126">*</span><span class="ident" id="6184127">Encoder</span><span class="op" id="6184134">)</span>&nbsp;<span class="ident" id="6184136">EncodeToken</span><span class="op" id="6184147">(</span><span class="ident" id="6184148">t</span>&nbsp;<span class="ident" id="6184150">Token</span><span class="op" id="6184155">)</span>&nbsp;<span class="builtintype" id="6184157">error</span>&nbsp;<span class="op" id="6184163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6184166">p</span>&nbsp;<span class="op" id="6184168">:=</span>&nbsp;<span class="op" id="6184171">&amp;</span><span class="ident" id="6184172">enc</span><span class="op" id="6184175">.</span><span class="ident" id="6184176">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184179">switch</span>&nbsp;<span class="ident" id="6184186">t</span>&nbsp;<span class="op" id="6184188">:=</span>&nbsp;<span class="ident" id="6184191">t</span><span class="op" id="6184192">.</span><span class="op" id="6184193">(</span><span class="keyword" id="6184194">type</span><span class="op" id="6184198">)</span>&nbsp;<span class="op" id="6184200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184203">case</span>&nbsp;<span class="ident" id="6184208">StartElement</span><span class="op" id="6184220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184224">if</span>&nbsp;<span class="ident" id="6184227">err</span>&nbsp;<span class="op" id="6184231">:=</span>&nbsp;<span class="ident" id="6184234">p</span><span class="op" id="6184235">.</span><span class="ident" id="6184236">writeStart</span><span class="op" id="6184246">(</span><span class="op" id="6184247">&amp;</span><span class="ident" id="6184248">t</span><span class="op" id="6184249">)</span><span class="op" id="6184250">;</span>&nbsp;<span class="ident" id="6184252">err</span>&nbsp;<span class="op" id="6184256">!=</span>&nbsp;<span class="builtintype" id="6184259">nil</span>&nbsp;<span class="op" id="6184263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184268">return</span>&nbsp;<span class="ident" id="6184275">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6184281">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184284">case</span>&nbsp;<span class="ident" id="6184289">EndElement</span><span class="op" id="6184299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184303">if</span>&nbsp;<span class="ident" id="6184306">err</span>&nbsp;<span class="op" id="6184310">:=</span>&nbsp;<span class="ident" id="6184313">p</span><span class="op" id="6184314">.</span><span class="ident" id="6184315">writeEnd</span><span class="op" id="6184323">(</span><span class="ident" id="6184324">t</span><span class="op" id="6184325">.</span><span class="ident" id="6184326">Name</span><span class="op" id="6184330">)</span><span class="op" id="6184331">;</span>&nbsp;<span class="ident" id="6184333">err</span>&nbsp;<span class="op" id="6184337">!=</span>&nbsp;<span class="builtintype" id="6184340">nil</span>&nbsp;<span class="op" id="6184344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184349">return</span>&nbsp;<span class="ident" id="6184356">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6184362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184365">case</span>&nbsp;<span class="ident" id="6184370">CharData</span><span class="op" id="6184378">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6184382">EscapeText</span><span class="op" id="6184392">(</span><span class="ident" id="6184393">p</span><span class="op" id="6184394">,</span>&nbsp;<span class="ident" id="6184396">t</span><span class="op" id="6184397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184400">case</span>&nbsp;<span class="ident" id="6184405">Comment</span><span class="op" id="6184412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184416">if</span>&nbsp;<span class="ident" id="6184419">bytes</span><span class="op" id="6184424">.</span><span class="ident" id="6184425">Contains</span><span class="op" id="6184433">(</span><span class="ident" id="6184434">t</span><span class="op" id="6184435">,</span>&nbsp;<span class="ident" id="6184437">endComment</span><span class="op" id="6184447">)</span>&nbsp;<span class="op" id="6184449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184454">return</span>&nbsp;<span class="ident" id="6184461">fmt</span><span class="op" id="6184464">.</span><span class="ident" id="6184465">Errorf</span><span class="op" id="6184471">(</span><span class="string" id="6184472">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="6184523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6184527">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6184531">p</span><span class="op" id="6184532">.</span><span class="ident" id="6184533">WriteString</span><span class="op" id="6184544">(</span><span class="string" id="6184545">&#34;&lt;!--&#34;</span><span class="op" id="6184551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6184555">p</span><span class="op" id="6184556">.</span><span class="ident" id="6184557">Write</span><span class="op" id="6184562">(</span><span class="ident" id="6184563">t</span><span class="op" id="6184564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6184568">p</span><span class="op" id="6184569">.</span><span class="ident" id="6184570">WriteString</span><span class="op" id="6184581">(</span><span class="string" id="6184582">&#34;--&gt;&#34;</span><span class="op" id="6184587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184591">return</span>&nbsp;<span class="ident" id="6184598">p</span><span class="op" id="6184599">.</span><span class="ident" id="6184600">cachedWriteError</span><span class="op" id="6184616">(</span><span class="op" id="6184617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184620">case</span>&nbsp;<span class="ident" id="6184625">ProcInst</span><span class="op" id="6184633">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6184637">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6184712">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184792">if</span>&nbsp;<span class="ident" id="6184795">t</span><span class="op" id="6184796">.</span><span class="ident" id="6184797">Target</span>&nbsp;<span class="op" id="6184804">==</span>&nbsp;<span class="string" id="6184807">&#34;xml&#34;</span>&nbsp;<span class="op" id="6184813">&amp;&amp;</span>&nbsp;<span class="ident" id="6184816">p</span><span class="op" id="6184817">.</span><span class="ident" id="6184818">Buffered</span><span class="op" id="6184826">(</span><span class="op" id="6184827">)</span>&nbsp;<span class="op" id="6184829">!=</span>&nbsp;<span class="num" id="6184832">0</span>&nbsp;<span class="op" id="6184834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184839">return</span>&nbsp;<span class="ident" id="6184846">fmt</span><span class="op" id="6184849">.</span><span class="ident" id="6184850">Errorf</span><span class="op" id="6184856">(</span><span class="string" id="6184857">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="6184950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6184954">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184958">if</span>&nbsp;<span class="op" id="6184961">!</span><span class="ident" id="6184962">isNameString</span><span class="op" id="6184974">(</span><span class="ident" id="6184975">t</span><span class="op" id="6184976">.</span><span class="ident" id="6184977">Target</span><span class="op" id="6184983">)</span>&nbsp;<span class="op" id="6184985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6184990">return</span>&nbsp;<span class="ident" id="6184997">fmt</span><span class="op" id="6185000">.</span><span class="ident" id="6185001">Errorf</span><span class="op" id="6185007">(</span><span class="string" id="6185008">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="6185058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185066">if</span>&nbsp;<span class="ident" id="6185069">bytes</span><span class="op" id="6185074">.</span><span class="ident" id="6185075">Contains</span><span class="op" id="6185083">(</span><span class="ident" id="6185084">t</span><span class="op" id="6185085">.</span><span class="ident" id="6185086">Inst</span><span class="op" id="6185090">,</span>&nbsp;<span class="ident" id="6185092">endProcInst</span><span class="op" id="6185103">)</span>&nbsp;<span class="op" id="6185105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185110">return</span>&nbsp;<span class="ident" id="6185117">fmt</span><span class="op" id="6185120">.</span><span class="ident" id="6185121">Errorf</span><span class="op" id="6185127">(</span><span class="string" id="6185128">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="6185179">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185187">p</span><span class="op" id="6185188">.</span><span class="ident" id="6185189">WriteString</span><span class="op" id="6185200">(</span><span class="string" id="6185201">&#34;&lt;?&#34;</span><span class="op" id="6185205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185209">p</span><span class="op" id="6185210">.</span><span class="ident" id="6185211">WriteString</span><span class="op" id="6185222">(</span><span class="ident" id="6185223">t</span><span class="op" id="6185224">.</span><span class="ident" id="6185225">Target</span><span class="op" id="6185231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185235">if</span>&nbsp;<span class="builtinfunc" id="6185238">len</span><span class="op" id="6185241">(</span><span class="ident" id="6185242">t</span><span class="op" id="6185243">.</span><span class="ident" id="6185244">Inst</span><span class="op" id="6185248">)</span>&nbsp;<span class="op" id="6185250">&gt;</span>&nbsp;<span class="num" id="6185252">0</span>&nbsp;<span class="op" id="6185254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185259">p</span><span class="op" id="6185260">.</span><span class="ident" id="6185261">WriteByte</span><span class="op" id="6185270">(</span><span class="string" id="6185271">&#39;&nbsp;&#39;</span><span class="op" id="6185274">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185279">p</span><span class="op" id="6185280">.</span><span class="ident" id="6185281">Write</span><span class="op" id="6185286">(</span><span class="ident" id="6185287">t</span><span class="op" id="6185288">.</span><span class="ident" id="6185289">Inst</span><span class="op" id="6185293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185301">p</span><span class="op" id="6185302">.</span><span class="ident" id="6185303">WriteString</span><span class="op" id="6185314">(</span><span class="string" id="6185315">&#34;?&gt;&#34;</span><span class="op" id="6185319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185322">case</span>&nbsp;<span class="ident" id="6185327">Directive</span><span class="op" id="6185336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185340">if</span>&nbsp;<span class="ident" id="6185343">bytes</span><span class="op" id="6185348">.</span><span class="ident" id="6185349">Contains</span><span class="op" id="6185357">(</span><span class="ident" id="6185358">t</span><span class="op" id="6185359">,</span>&nbsp;<span class="ident" id="6185361">endDirective</span><span class="op" id="6185373">)</span>&nbsp;<span class="op" id="6185375">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185380">return</span>&nbsp;<span class="ident" id="6185387">fmt</span><span class="op" id="6185390">.</span><span class="ident" id="6185391">Errorf</span><span class="op" id="6185397">(</span><span class="string" id="6185398">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="6185449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185457">p</span><span class="op" id="6185458">.</span><span class="ident" id="6185459">WriteString</span><span class="op" id="6185470">(</span><span class="string" id="6185471">&#34;&lt;!&#34;</span><span class="op" id="6185475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185479">p</span><span class="op" id="6185480">.</span><span class="ident" id="6185481">Write</span><span class="op" id="6185486">(</span><span class="ident" id="6185487">t</span><span class="op" id="6185488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185492">p</span><span class="op" id="6185493">.</span><span class="ident" id="6185494">WriteString</span><span class="op" id="6185505">(</span><span class="string" id="6185506">&#34;&gt;&#34;</span><span class="op" id="6185509">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185515">return</span>&nbsp;<span class="ident" id="6185522">p</span><span class="op" id="6185523">.</span><span class="ident" id="6185524">cachedWriteError</span><span class="op" id="6185540">(</span><span class="op" id="6185541">)</span><br>
<span class="lineno"></span><span class="op" id="6185543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6185546">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="6185606">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="6185683">func</span>&nbsp;<span class="op" id="6185688">(</span><span class="ident" id="6185689">enc</span>&nbsp;<span class="op" id="6185693">*</span><span class="ident" id="6185694">Encoder</span><span class="op" id="6185701">)</span>&nbsp;<span class="ident" id="6185703">Flush</span><span class="op" id="6185708">(</span><span class="op" id="6185709">)</span>&nbsp;<span class="builtintype" id="6185711">error</span>&nbsp;<span class="op" id="6185717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185720">return</span>&nbsp;<span class="ident" id="6185727">enc</span><span class="op" id="6185730">.</span><span class="ident" id="6185731">p</span><span class="op" id="6185732">.</span><span class="ident" id="6185733">Flush</span><span class="op" id="6185738">(</span><span class="op" id="6185739">)</span><br>
<span class="lineno"></span><span class="op" id="6185741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="6185744">type</span>&nbsp;<span class="ident" id="6185749">printer</span>&nbsp;<span class="keyword" id="6185757">struct</span>&nbsp;<span class="op" id="6185764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185767">*</span><span class="ident" id="6185768">bufio</span><span class="op" id="6185773">.</span><span class="ident" id="6185774">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185782">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6185793">*</span><span class="ident" id="6185794">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185803">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6185814">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185819">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6185830">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185838">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6185849">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185857">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6185868">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185873">indentedIn</span>&nbsp;<span class="builtintype" id="6185884">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185890">putNewline</span>&nbsp;<span class="builtintype" id="6185901">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185907">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6185918">map</span><span class="op" id="6185921">[</span><span class="builtintype" id="6185922">string</span><span class="op" id="6185928">]</span><span class="builtintype" id="6185929">string</span>&nbsp;<span class="comment" id="6185936">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6185965">attrPrefix</span>&nbsp;<span class="keyword" id="6185976">map</span><span class="op" id="6185979">[</span><span class="builtintype" id="6185980">string</span><span class="op" id="6185986">]</span><span class="builtintype" id="6185987">string</span>&nbsp;<span class="comment" id="6185994">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186023">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6186034">[</span><span class="op" id="6186035">]</span><span class="builtintype" id="6186036">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186044">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6186055">[</span><span class="op" id="6186056">]</span><span class="ident" id="6186057">Name</span><br>
<span class="lineno"></span><span class="op" id="6186062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="6186065">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="6186156">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6186218">func</span>&nbsp;<span class="op" id="6186223">(</span><span class="ident" id="6186224">p</span>&nbsp;<span class="op" id="6186226">*</span><span class="ident" id="6186227">printer</span><span class="op" id="6186234">)</span>&nbsp;<span class="ident" id="6186236">createAttrPrefix</span><span class="op" id="6186252">(</span><span class="ident" id="6186253">url</span>&nbsp;<span class="builtintype" id="6186257">string</span><span class="op" id="6186263">)</span>&nbsp;<span class="builtintype" id="6186265">string</span>&nbsp;<span class="op" id="6186272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186275">if</span>&nbsp;<span class="ident" id="6186278">prefix</span>&nbsp;<span class="op" id="6186285">:=</span>&nbsp;<span class="ident" id="6186288">p</span><span class="op" id="6186289">.</span><span class="ident" id="6186290">attrPrefix</span><span class="op" id="6186300">[</span><span class="ident" id="6186301">url</span><span class="op" id="6186304">]</span><span class="op" id="6186305">;</span>&nbsp;<span class="ident" id="6186307">prefix</span>&nbsp;<span class="op" id="6186314">!=</span>&nbsp;<span class="string" id="6186317">&#34;&#34;</span>&nbsp;<span class="op" id="6186320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186324">return</span>&nbsp;<span class="ident" id="6186331">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6186339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186343">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186424">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186462">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186545">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186624">if</span>&nbsp;<span class="ident" id="6186627">url</span>&nbsp;<span class="op" id="6186631">==</span>&nbsp;<span class="ident" id="6186634">xmlURL</span>&nbsp;<span class="op" id="6186641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186645">return</span>&nbsp;<span class="string" id="6186652">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6186659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186663">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186700">if</span>&nbsp;<span class="ident" id="6186703">p</span><span class="op" id="6186704">.</span><span class="ident" id="6186705">attrPrefix</span>&nbsp;<span class="op" id="6186716">==</span>&nbsp;<span class="builtintype" id="6186719">nil</span>&nbsp;<span class="op" id="6186723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186727">p</span><span class="op" id="6186728">.</span><span class="ident" id="6186729">attrPrefix</span>&nbsp;<span class="op" id="6186740">=</span>&nbsp;<span class="builtinfunc" id="6186742">make</span><span class="op" id="6186746">(</span><span class="keyword" id="6186747">map</span><span class="op" id="6186750">[</span><span class="builtintype" id="6186751">string</span><span class="op" id="6186757">]</span><span class="builtintype" id="6186758">string</span><span class="op" id="6186764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186768">p</span><span class="op" id="6186769">.</span><span class="ident" id="6186770">attrNS</span>&nbsp;<span class="op" id="6186777">=</span>&nbsp;<span class="builtinfunc" id="6186779">make</span><span class="op" id="6186783">(</span><span class="keyword" id="6186784">map</span><span class="op" id="6186787">[</span><span class="builtintype" id="6186788">string</span><span class="op" id="6186794">]</span><span class="builtintype" id="6186795">string</span><span class="op" id="6186801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6186804">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186808">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6186869">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186893">prefix</span>&nbsp;<span class="op" id="6186900">:=</span>&nbsp;<span class="ident" id="6186903">strings</span><span class="op" id="6186910">.</span><span class="ident" id="6186911">TrimRight</span><span class="op" id="6186920">(</span><span class="ident" id="6186921">url</span><span class="op" id="6186924">,</span>&nbsp;<span class="string" id="6186926">&#34;/&#34;</span><span class="op" id="6186929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6186932">if</span>&nbsp;<span class="ident" id="6186935">i</span>&nbsp;<span class="op" id="6186937">:=</span>&nbsp;<span class="ident" id="6186940">strings</span><span class="op" id="6186947">.</span><span class="ident" id="6186948">LastIndex</span><span class="op" id="6186957">(</span><span class="ident" id="6186958">prefix</span><span class="op" id="6186964">,</span>&nbsp;<span class="string" id="6186966">&#34;/&#34;</span><span class="op" id="6186969">)</span><span class="op" id="6186970">;</span>&nbsp;<span class="ident" id="6186972">i</span>&nbsp;<span class="op" id="6186974">&gt;=</span>&nbsp;<span class="num" id="6186977">0</span>&nbsp;<span class="op" id="6186979">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6186983">prefix</span>&nbsp;<span class="op" id="6186990">=</span>&nbsp;<span class="ident" id="6186992">prefix</span><span class="op" id="6186998">[</span><span class="ident" id="6186999">i</span><span class="op" id="6187000">+</span><span class="num" id="6187001">1</span><span class="op" id="6187002">:</span><span class="op" id="6187003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187009">if</span>&nbsp;<span class="ident" id="6187012">prefix</span>&nbsp;<span class="op" id="6187019">==</span>&nbsp;<span class="string" id="6187022">&#34;&#34;</span>&nbsp;<span class="op" id="6187025">||</span>&nbsp;<span class="op" id="6187028">!</span><span class="ident" id="6187029">isName</span><span class="op" id="6187035">(</span><span class="op" id="6187036">[</span><span class="op" id="6187037">]</span><span class="builtintype" id="6187038">byte</span><span class="op" id="6187042">(</span><span class="ident" id="6187043">prefix</span><span class="op" id="6187049">)</span><span class="op" id="6187050">)</span>&nbsp;<span class="op" id="6187052">||</span>&nbsp;<span class="ident" id="6187055">strings</span><span class="op" id="6187062">.</span><span class="ident" id="6187063">Contains</span><span class="op" id="6187071">(</span><span class="ident" id="6187072">prefix</span><span class="op" id="6187078">,</span>&nbsp;<span class="string" id="6187080">&#34;:&#34;</span><span class="op" id="6187083">)</span>&nbsp;<span class="op" id="6187085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187089">prefix</span>&nbsp;<span class="op" id="6187096">=</span>&nbsp;<span class="string" id="6187098">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187103">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187106">if</span>&nbsp;<span class="ident" id="6187109">strings</span><span class="op" id="6187116">.</span><span class="ident" id="6187117">HasPrefix</span><span class="op" id="6187126">(</span><span class="ident" id="6187127">prefix</span><span class="op" id="6187133">,</span>&nbsp;<span class="string" id="6187135">&#34;xml&#34;</span><span class="op" id="6187140">)</span>&nbsp;<span class="op" id="6187142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6187146">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187176">prefix</span>&nbsp;<span class="op" id="6187183">=</span>&nbsp;<span class="string" id="6187185">&#34;_&#34;</span>&nbsp;<span class="op" id="6187189">+</span>&nbsp;<span class="ident" id="6187191">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187202">if</span>&nbsp;<span class="ident" id="6187205">p</span><span class="op" id="6187206">.</span><span class="ident" id="6187207">attrNS</span><span class="op" id="6187213">[</span><span class="ident" id="6187214">prefix</span><span class="op" id="6187220">]</span>&nbsp;<span class="op" id="6187222">!=</span>&nbsp;<span class="string" id="6187225">&#34;&#34;</span>&nbsp;<span class="op" id="6187228">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6187232">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187271">for</span>&nbsp;<span class="ident" id="6187275">p</span><span class="op" id="6187276">.</span><span class="ident" id="6187277">seq</span><span class="op" id="6187280">++</span><span class="op" id="6187282">;</span>&nbsp;<span class="op" id="6187284">;</span>&nbsp;<span class="ident" id="6187286">p</span><span class="op" id="6187287">.</span><span class="ident" id="6187288">seq</span><span class="op" id="6187291">++</span>&nbsp;<span class="op" id="6187294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187299">if</span>&nbsp;<span class="ident" id="6187302">id</span>&nbsp;<span class="op" id="6187305">:=</span>&nbsp;<span class="ident" id="6187308">prefix</span>&nbsp;<span class="op" id="6187315">+</span>&nbsp;<span class="string" id="6187317">&#34;_&#34;</span>&nbsp;<span class="op" id="6187321">+</span>&nbsp;<span class="ident" id="6187323">strconv</span><span class="op" id="6187330">.</span><span class="ident" id="6187331">Itoa</span><span class="op" id="6187335">(</span><span class="ident" id="6187336">p</span><span class="op" id="6187337">.</span><span class="ident" id="6187338">seq</span><span class="op" id="6187341">)</span><span class="op" id="6187342">;</span>&nbsp;<span class="ident" id="6187344">p</span><span class="op" id="6187345">.</span><span class="ident" id="6187346">attrNS</span><span class="op" id="6187352">[</span><span class="ident" id="6187353">id</span><span class="op" id="6187355">]</span>&nbsp;<span class="op" id="6187357">==</span>&nbsp;<span class="string" id="6187360">&#34;&#34;</span>&nbsp;<span class="op" id="6187363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187369">prefix</span>&nbsp;<span class="op" id="6187376">=</span>&nbsp;<span class="ident" id="6187378">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187385">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6187401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187405">p</span><span class="op" id="6187406">.</span><span class="ident" id="6187407">attrPrefix</span><span class="op" id="6187417">[</span><span class="ident" id="6187418">url</span><span class="op" id="6187421">]</span>&nbsp;<span class="op" id="6187423">=</span>&nbsp;<span class="ident" id="6187425">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187433">p</span><span class="op" id="6187434">.</span><span class="ident" id="6187435">attrNS</span><span class="op" id="6187441">[</span><span class="ident" id="6187442">prefix</span><span class="op" id="6187448">]</span>&nbsp;<span class="op" id="6187450">=</span>&nbsp;<span class="ident" id="6187452">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187458">p</span><span class="op" id="6187459">.</span><span class="ident" id="6187460">WriteString</span><span class="op" id="6187471">(</span><span class="string" id="6187472">`xmlns:`</span><span class="op" id="6187480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187483">p</span><span class="op" id="6187484">.</span><span class="ident" id="6187485">WriteString</span><span class="op" id="6187496">(</span><span class="ident" id="6187497">prefix</span><span class="op" id="6187503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187506">p</span><span class="op" id="6187507">.</span><span class="ident" id="6187508">WriteString</span><span class="op" id="6187519">(</span><span class="string" id="6187520">`=&#34;`</span><span class="op" id="6187524">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187527">EscapeText</span><span class="op" id="6187537">(</span><span class="ident" id="6187538">p</span><span class="op" id="6187539">,</span>&nbsp;<span class="op" id="6187541">[</span><span class="op" id="6187542">]</span><span class="builtintype" id="6187543">byte</span><span class="op" id="6187547">(</span><span class="ident" id="6187548">url</span><span class="op" id="6187551">)</span><span class="op" id="6187552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187555">p</span><span class="op" id="6187556">.</span><span class="ident" id="6187557">WriteString</span><span class="op" id="6187568">(</span><span class="string" id="6187569">`&#34;&nbsp;`</span><span class="op" id="6187573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187577">p</span><span class="op" id="6187578">.</span><span class="ident" id="6187579">prefixes</span>&nbsp;<span class="op" id="6187588">=</span>&nbsp;<span class="builtinfunc" id="6187590">append</span><span class="op" id="6187596">(</span><span class="ident" id="6187597">p</span><span class="op" id="6187598">.</span><span class="ident" id="6187599">prefixes</span><span class="op" id="6187607">,</span>&nbsp;<span class="ident" id="6187609">prefix</span><span class="op" id="6187615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187619">return</span>&nbsp;<span class="ident" id="6187626">prefix</span><br>
<span class="lineno"></span><span class="op" id="6187633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6187636">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6187696">func</span>&nbsp;<span class="op" id="6187701">(</span><span class="ident" id="6187702">p</span>&nbsp;<span class="op" id="6187704">*</span><span class="ident" id="6187705">printer</span><span class="op" id="6187712">)</span>&nbsp;<span class="ident" id="6187714">deleteAttrPrefix</span><span class="op" id="6187730">(</span><span class="ident" id="6187731">prefix</span>&nbsp;<span class="builtintype" id="6187738">string</span><span class="op" id="6187744">)</span>&nbsp;<span class="op" id="6187746">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6187749">delete</span><span class="op" id="6187755">(</span><span class="ident" id="6187756">p</span><span class="op" id="6187757">.</span><span class="ident" id="6187758">attrPrefix</span><span class="op" id="6187768">,</span>&nbsp;<span class="ident" id="6187770">p</span><span class="op" id="6187771">.</span><span class="ident" id="6187772">attrNS</span><span class="op" id="6187778">[</span><span class="ident" id="6187779">prefix</span><span class="op" id="6187785">]</span><span class="op" id="6187786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6187789">delete</span><span class="op" id="6187795">(</span><span class="ident" id="6187796">p</span><span class="op" id="6187797">.</span><span class="ident" id="6187798">attrNS</span><span class="op" id="6187804">,</span>&nbsp;<span class="ident" id="6187806">prefix</span><span class="op" id="6187812">)</span><br>
<span class="lineno"></span><span class="op" id="6187814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187817">func</span>&nbsp;<span class="op" id="6187822">(</span><span class="ident" id="6187823">p</span>&nbsp;<span class="op" id="6187825">*</span><span class="ident" id="6187826">printer</span><span class="op" id="6187833">)</span>&nbsp;<span class="ident" id="6187835">markPrefix</span><span class="op" id="6187845">(</span><span class="op" id="6187846">)</span>&nbsp;<span class="op" id="6187848">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187851">p</span><span class="op" id="6187852">.</span><span class="ident" id="6187853">prefixes</span>&nbsp;<span class="op" id="6187862">=</span>&nbsp;<span class="builtinfunc" id="6187864">append</span><span class="op" id="6187870">(</span><span class="ident" id="6187871">p</span><span class="op" id="6187872">.</span><span class="ident" id="6187873">prefixes</span><span class="op" id="6187881">,</span>&nbsp;<span class="string" id="6187883">&#34;&#34;</span><span class="op" id="6187885">)</span><br>
<span class="lineno"></span><span class="op" id="6187887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187890">func</span>&nbsp;<span class="op" id="6187895">(</span><span class="ident" id="6187896">p</span>&nbsp;<span class="op" id="6187898">*</span><span class="ident" id="6187899">printer</span><span class="op" id="6187906">)</span>&nbsp;<span class="ident" id="6187908">popPrefix</span><span class="op" id="6187917">(</span><span class="op" id="6187918">)</span>&nbsp;<span class="op" id="6187920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6187923">for</span>&nbsp;<span class="builtinfunc" id="6187927">len</span><span class="op" id="6187930">(</span><span class="ident" id="6187931">p</span><span class="op" id="6187932">.</span><span class="ident" id="6187933">prefixes</span><span class="op" id="6187941">)</span>&nbsp;<span class="op" id="6187943">&gt;</span>&nbsp;<span class="num" id="6187945">0</span>&nbsp;<span class="op" id="6187947">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187951">prefix</span>&nbsp;<span class="op" id="6187958">:=</span>&nbsp;<span class="ident" id="6187961">p</span><span class="op" id="6187962">.</span><span class="ident" id="6187963">prefixes</span><span class="op" id="6187971">[</span><span class="builtinfunc" id="6187972">len</span><span class="op" id="6187975">(</span><span class="ident" id="6187976">p</span><span class="op" id="6187977">.</span><span class="ident" id="6187978">prefixes</span><span class="op" id="6187986">)</span><span class="op" id="6187987">-</span><span class="num" id="6187988">1</span><span class="op" id="6187989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6187993">p</span><span class="op" id="6187994">.</span><span class="ident" id="6187995">prefixes</span>&nbsp;<span class="op" id="6188004">=</span>&nbsp;<span class="ident" id="6188006">p</span><span class="op" id="6188007">.</span><span class="ident" id="6188008">prefixes</span><span class="op" id="6188016">[</span><span class="op" id="6188017">:</span><span class="builtinfunc" id="6188018">len</span><span class="op" id="6188021">(</span><span class="ident" id="6188022">p</span><span class="op" id="6188023">.</span><span class="ident" id="6188024">prefixes</span><span class="op" id="6188032">)</span><span class="op" id="6188033">-</span><span class="num" id="6188034">1</span><span class="op" id="6188035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188039">if</span>&nbsp;<span class="ident" id="6188042">prefix</span>&nbsp;<span class="op" id="6188049">==</span>&nbsp;<span class="string" id="6188052">&#34;&#34;</span>&nbsp;<span class="op" id="6188055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188060">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188068">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6188072">p</span><span class="op" id="6188073">.</span><span class="ident" id="6188074">deleteAttrPrefix</span><span class="op" id="6188090">(</span><span class="ident" id="6188091">prefix</span><span class="op" id="6188097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188100">}</span><br>
<span class="lineno"></span><span class="op" id="6188102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6188105">var</span>&nbsp;<span class="op" id="6188109">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6188112">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188130">=</span>&nbsp;<span class="ident" id="6188132">reflect</span><span class="op" id="6188139">.</span><span class="ident" id="6188140">TypeOf</span><span class="op" id="6188146">(</span><span class="op" id="6188147">(</span><span class="op" id="6188148">*</span><span class="ident" id="6188149">Marshaler</span><span class="op" id="6188158">)</span><span class="op" id="6188159">(</span><span class="builtintype" id="6188160">nil</span><span class="op" id="6188163">)</span><span class="op" id="6188164">)</span><span class="op" id="6188165">.</span><span class="ident" id="6188166">Elem</span><span class="op" id="6188170">(</span><span class="op" id="6188171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6188174">marshalerAttrType</span>&nbsp;<span class="op" id="6188192">=</span>&nbsp;<span class="ident" id="6188194">reflect</span><span class="op" id="6188201">.</span><span class="ident" id="6188202">TypeOf</span><span class="op" id="6188208">(</span><span class="op" id="6188209">(</span><span class="op" id="6188210">*</span><span class="ident" id="6188211">MarshalerAttr</span><span class="op" id="6188224">)</span><span class="op" id="6188225">(</span><span class="builtintype" id="6188226">nil</span><span class="op" id="6188229">)</span><span class="op" id="6188230">)</span><span class="op" id="6188231">.</span><span class="ident" id="6188232">Elem</span><span class="op" id="6188236">(</span><span class="op" id="6188237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6188240">textMarshalerType</span>&nbsp;<span class="op" id="6188258">=</span>&nbsp;<span class="ident" id="6188260">reflect</span><span class="op" id="6188267">.</span><span class="ident" id="6188268">TypeOf</span><span class="op" id="6188274">(</span><span class="op" id="6188275">(</span><span class="op" id="6188276">*</span><span class="ident" id="6188277">encoding</span><span class="op" id="6188285">.</span><span class="ident" id="6188286">TextMarshaler</span><span class="op" id="6188299">)</span><span class="op" id="6188300">(</span><span class="builtintype" id="6188301">nil</span><span class="op" id="6188304">)</span><span class="op" id="6188305">)</span><span class="op" id="6188306">.</span><span class="ident" id="6188307">Elem</span><span class="op" id="6188311">(</span><span class="op" id="6188312">)</span><br>
<span class="lineno"></span><span class="op" id="6188314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="6188317">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="6188383">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="6188456">func</span>&nbsp;<span class="op" id="6188461">(</span><span class="ident" id="6188462">p</span>&nbsp;<span class="op" id="6188464">*</span><span class="ident" id="6188465">printer</span><span class="op" id="6188472">)</span>&nbsp;<span class="ident" id="6188474">marshalValue</span><span class="op" id="6188486">(</span><span class="ident" id="6188487">val</span>&nbsp;<span class="ident" id="6188491">reflect</span><span class="op" id="6188498">.</span><span class="ident" id="6188499">Value</span><span class="op" id="6188504">,</span>&nbsp;<span class="ident" id="6188506">finfo</span>&nbsp;<span class="op" id="6188512">*</span><span class="ident" id="6188513">fieldInfo</span><span class="op" id="6188522">,</span>&nbsp;<span class="ident" id="6188524">startTemplate</span>&nbsp;<span class="op" id="6188538">*</span><span class="ident" id="6188539">StartElement</span><span class="op" id="6188551">)</span>&nbsp;<span class="builtintype" id="6188553">error</span>&nbsp;<span class="op" id="6188559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188562">if</span>&nbsp;<span class="ident" id="6188565">startTemplate</span>&nbsp;<span class="op" id="6188579">!=</span>&nbsp;<span class="builtintype" id="6188582">nil</span>&nbsp;<span class="op" id="6188586">&amp;&amp;</span>&nbsp;<span class="ident" id="6188589">startTemplate</span><span class="op" id="6188602">.</span><span class="ident" id="6188603">Name</span><span class="op" id="6188607">.</span><span class="ident" id="6188608">Local</span>&nbsp;<span class="op" id="6188614">==</span>&nbsp;<span class="string" id="6188617">&#34;&#34;</span>&nbsp;<span class="op" id="6188620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188624">return</span>&nbsp;<span class="ident" id="6188631">fmt</span><span class="op" id="6188634">.</span><span class="ident" id="6188635">Errorf</span><span class="op" id="6188641">(</span><span class="string" id="6188642">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="6188696">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188703">if</span>&nbsp;<span class="op" id="6188706">!</span><span class="ident" id="6188707">val</span><span class="op" id="6188710">.</span><span class="ident" id="6188711">IsValid</span><span class="op" id="6188718">(</span><span class="op" id="6188719">)</span>&nbsp;<span class="op" id="6188721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188725">return</span>&nbsp;<span class="builtintype" id="6188732">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188737">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188740">if</span>&nbsp;<span class="ident" id="6188743">finfo</span>&nbsp;<span class="op" id="6188749">!=</span>&nbsp;<span class="builtintype" id="6188752">nil</span>&nbsp;<span class="op" id="6188756">&amp;&amp;</span>&nbsp;<span class="ident" id="6188759">finfo</span><span class="op" id="6188764">.</span><span class="ident" id="6188765">flags</span><span class="op" id="6188770">&amp;</span><span class="ident" id="6188771">fOmitEmpty</span>&nbsp;<span class="op" id="6188782">!=</span>&nbsp;<span class="num" id="6188785">0</span>&nbsp;<span class="op" id="6188787">&amp;&amp;</span>&nbsp;<span class="ident" id="6188790">isEmptyValue</span><span class="op" id="6188802">(</span><span class="ident" id="6188803">val</span><span class="op" id="6188806">)</span>&nbsp;<span class="op" id="6188808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188812">return</span>&nbsp;<span class="builtintype" id="6188819">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6188824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6188828">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6188868">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6188930">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188968">for</span>&nbsp;<span class="ident" id="6188972">val</span><span class="op" id="6188975">.</span><span class="ident" id="6188976">Kind</span><span class="op" id="6188980">(</span><span class="op" id="6188981">)</span>&nbsp;<span class="op" id="6188983">==</span>&nbsp;<span class="ident" id="6188986">reflect</span><span class="op" id="6188993">.</span><span class="ident" id="6188994">Interface</span>&nbsp;<span class="op" id="6189004">||</span>&nbsp;<span class="ident" id="6189007">val</span><span class="op" id="6189010">.</span><span class="ident" id="6189011">Kind</span><span class="op" id="6189015">(</span><span class="op" id="6189016">)</span>&nbsp;<span class="op" id="6189018">==</span>&nbsp;<span class="ident" id="6189021">reflect</span><span class="op" id="6189028">.</span><span class="ident" id="6189029">Ptr</span>&nbsp;<span class="op" id="6189033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189037">if</span>&nbsp;<span class="ident" id="6189040">val</span><span class="op" id="6189043">.</span><span class="ident" id="6189044">IsNil</span><span class="op" id="6189049">(</span><span class="op" id="6189050">)</span>&nbsp;<span class="op" id="6189052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189057">return</span>&nbsp;<span class="builtintype" id="6189064">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6189074">val</span>&nbsp;<span class="op" id="6189078">=</span>&nbsp;<span class="ident" id="6189080">val</span><span class="op" id="6189083">.</span><span class="ident" id="6189084">Elem</span><span class="op" id="6189088">(</span><span class="op" id="6189089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6189096">kind</span>&nbsp;<span class="op" id="6189101">:=</span>&nbsp;<span class="ident" id="6189104">val</span><span class="op" id="6189107">.</span><span class="ident" id="6189108">Kind</span><span class="op" id="6189112">(</span><span class="op" id="6189113">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6189116">typ</span>&nbsp;<span class="op" id="6189120">:=</span>&nbsp;<span class="ident" id="6189123">val</span><span class="op" id="6189126">.</span><span class="ident" id="6189127">Type</span><span class="op" id="6189131">(</span><span class="op" id="6189132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6189136">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189161">if</span>&nbsp;<span class="ident" id="6189164">val</span><span class="op" id="6189167">.</span><span class="ident" id="6189168">CanInterface</span><span class="op" id="6189180">(</span><span class="op" id="6189181">)</span>&nbsp;<span class="op" id="6189183">&amp;&amp;</span>&nbsp;<span class="ident" id="6189186">typ</span><span class="op" id="6189189">.</span><span class="ident" id="6189190">Implements</span><span class="op" id="6189200">(</span><span class="ident" id="6189201">marshalerType</span><span class="op" id="6189214">)</span>&nbsp;<span class="op" id="6189216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189220">return</span>&nbsp;<span class="ident" id="6189227">p</span><span class="op" id="6189228">.</span><span class="ident" id="6189229">marshalInterface</span><span class="op" id="6189245">(</span><span class="ident" id="6189246">val</span><span class="op" id="6189249">.</span><span class="ident" id="6189250">Interface</span><span class="op" id="6189259">(</span><span class="op" id="6189260">)</span><span class="op" id="6189261">.</span><span class="op" id="6189262">(</span><span class="ident" id="6189263">Marshaler</span><span class="op" id="6189272">)</span><span class="op" id="6189273">,</span>&nbsp;<span class="ident" id="6189275">defaultStart</span><span class="op" id="6189287">(</span><span class="ident" id="6189288">typ</span><span class="op" id="6189291">,</span>&nbsp;<span class="ident" id="6189293">finfo</span><span class="op" id="6189298">,</span>&nbsp;<span class="ident" id="6189300">startTemplate</span><span class="op" id="6189313">)</span><span class="op" id="6189314">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189320">if</span>&nbsp;<span class="ident" id="6189323">val</span><span class="op" id="6189326">.</span><span class="ident" id="6189327">CanAddr</span><span class="op" id="6189334">(</span><span class="op" id="6189335">)</span>&nbsp;<span class="op" id="6189337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6189341">pv</span>&nbsp;<span class="op" id="6189344">:=</span>&nbsp;<span class="ident" id="6189347">val</span><span class="op" id="6189350">.</span><span class="ident" id="6189351">Addr</span><span class="op" id="6189355">(</span><span class="op" id="6189356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189360">if</span>&nbsp;<span class="ident" id="6189363">pv</span><span class="op" id="6189365">.</span><span class="ident" id="6189366">CanInterface</span><span class="op" id="6189378">(</span><span class="op" id="6189379">)</span>&nbsp;<span class="op" id="6189381">&amp;&amp;</span>&nbsp;<span class="ident" id="6189384">pv</span><span class="op" id="6189386">.</span><span class="ident" id="6189387">Type</span><span class="op" id="6189391">(</span><span class="op" id="6189392">)</span><span class="op" id="6189393">.</span><span class="ident" id="6189394">Implements</span><span class="op" id="6189404">(</span><span class="ident" id="6189405">marshalerType</span><span class="op" id="6189418">)</span>&nbsp;<span class="op" id="6189420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189425">return</span>&nbsp;<span class="ident" id="6189432">p</span><span class="op" id="6189433">.</span><span class="ident" id="6189434">marshalInterface</span><span class="op" id="6189450">(</span><span class="ident" id="6189451">pv</span><span class="op" id="6189453">.</span><span class="ident" id="6189454">Interface</span><span class="op" id="6189463">(</span><span class="op" id="6189464">)</span><span class="op" id="6189465">.</span><span class="op" id="6189466">(</span><span class="ident" id="6189467">Marshaler</span><span class="op" id="6189476">)</span><span class="op" id="6189477">,</span>&nbsp;<span class="ident" id="6189479">defaultStart</span><span class="op" id="6189491">(</span><span class="ident" id="6189492">pv</span><span class="op" id="6189494">.</span><span class="ident" id="6189495">Type</span><span class="op" id="6189499">(</span><span class="op" id="6189500">)</span><span class="op" id="6189501">,</span>&nbsp;<span class="ident" id="6189503">finfo</span><span class="op" id="6189508">,</span>&nbsp;<span class="ident" id="6189510">startTemplate</span><span class="op" id="6189523">)</span><span class="op" id="6189524">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6189535">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189565">if</span>&nbsp;<span class="ident" id="6189568">val</span><span class="op" id="6189571">.</span><span class="ident" id="6189572">CanInterface</span><span class="op" id="6189584">(</span><span class="op" id="6189585">)</span>&nbsp;<span class="op" id="6189587">&amp;&amp;</span>&nbsp;<span class="ident" id="6189590">typ</span><span class="op" id="6189593">.</span><span class="ident" id="6189594">Implements</span><span class="op" id="6189604">(</span><span class="ident" id="6189605">textMarshalerType</span><span class="op" id="6189622">)</span>&nbsp;<span class="op" id="6189624">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189628">return</span>&nbsp;<span class="ident" id="6189635">p</span><span class="op" id="6189636">.</span><span class="ident" id="6189637">marshalTextInterface</span><span class="op" id="6189657">(</span><span class="ident" id="6189658">val</span><span class="op" id="6189661">.</span><span class="ident" id="6189662">Interface</span><span class="op" id="6189671">(</span><span class="op" id="6189672">)</span><span class="op" id="6189673">.</span><span class="op" id="6189674">(</span><span class="ident" id="6189675">encoding</span><span class="op" id="6189683">.</span><span class="ident" id="6189684">TextMarshaler</span><span class="op" id="6189697">)</span><span class="op" id="6189698">,</span>&nbsp;<span class="ident" id="6189700">defaultStart</span><span class="op" id="6189712">(</span><span class="ident" id="6189713">typ</span><span class="op" id="6189716">,</span>&nbsp;<span class="ident" id="6189718">finfo</span><span class="op" id="6189723">,</span>&nbsp;<span class="ident" id="6189725">startTemplate</span><span class="op" id="6189738">)</span><span class="op" id="6189739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189745">if</span>&nbsp;<span class="ident" id="6189748">val</span><span class="op" id="6189751">.</span><span class="ident" id="6189752">CanAddr</span><span class="op" id="6189759">(</span><span class="op" id="6189760">)</span>&nbsp;<span class="op" id="6189762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6189766">pv</span>&nbsp;<span class="op" id="6189769">:=</span>&nbsp;<span class="ident" id="6189772">val</span><span class="op" id="6189775">.</span><span class="ident" id="6189776">Addr</span><span class="op" id="6189780">(</span><span class="op" id="6189781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189785">if</span>&nbsp;<span class="ident" id="6189788">pv</span><span class="op" id="6189790">.</span><span class="ident" id="6189791">CanInterface</span><span class="op" id="6189803">(</span><span class="op" id="6189804">)</span>&nbsp;<span class="op" id="6189806">&amp;&amp;</span>&nbsp;<span class="ident" id="6189809">pv</span><span class="op" id="6189811">.</span><span class="ident" id="6189812">Type</span><span class="op" id="6189816">(</span><span class="op" id="6189817">)</span><span class="op" id="6189818">.</span><span class="ident" id="6189819">Implements</span><span class="op" id="6189829">(</span><span class="ident" id="6189830">textMarshalerType</span><span class="op" id="6189847">)</span>&nbsp;<span class="op" id="6189849">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6189854">return</span>&nbsp;<span class="ident" id="6189861">p</span><span class="op" id="6189862">.</span><span class="ident" id="6189863">marshalTextInterface</span><span class="op" id="6189883">(</span><span class="ident" id="6189884">pv</span><span class="op" id="6189886">.</span><span class="ident" id="6189887">Interface</span><span class="op" id="6189896">(</span><span class="op" id="6189897">)</span><span class="op" id="6189898">.</span><span class="op" id="6189899">(</span><span class="ident" id="6189900">encoding</span><span class="op" id="6189908">.</span><span class="ident" id="6189909">TextMarshaler</span><span class="op" id="6189922">)</span><span class="op" id="6189923">,</span>&nbsp;<span class="ident" id="6189925">defaultStart</span><span class="op" id="6189937">(</span><span class="ident" id="6189938">pv</span><span class="op" id="6189940">.</span><span class="ident" id="6189941">Type</span><span class="op" id="6189945">(</span><span class="op" id="6189946">)</span><span class="op" id="6189947">,</span>&nbsp;<span class="ident" id="6189949">finfo</span><span class="op" id="6189954">,</span>&nbsp;<span class="ident" id="6189956">startTemplate</span><span class="op" id="6189969">)</span><span class="op" id="6189970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6189977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6189981">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190065">if</span>&nbsp;<span class="op" id="6190068">(</span><span class="ident" id="6190069">kind</span>&nbsp;<span class="op" id="6190074">==</span>&nbsp;<span class="ident" id="6190077">reflect</span><span class="op" id="6190084">.</span><span class="ident" id="6190085">Slice</span>&nbsp;<span class="op" id="6190091">||</span>&nbsp;<span class="ident" id="6190094">kind</span>&nbsp;<span class="op" id="6190099">==</span>&nbsp;<span class="ident" id="6190102">reflect</span><span class="op" id="6190109">.</span><span class="ident" id="6190110">Array</span><span class="op" id="6190115">)</span>&nbsp;<span class="op" id="6190117">&amp;&amp;</span>&nbsp;<span class="ident" id="6190120">typ</span><span class="op" id="6190123">.</span><span class="ident" id="6190124">Elem</span><span class="op" id="6190128">(</span><span class="op" id="6190129">)</span><span class="op" id="6190130">.</span><span class="ident" id="6190131">Kind</span><span class="op" id="6190135">(</span><span class="op" id="6190136">)</span>&nbsp;<span class="op" id="6190138">!=</span>&nbsp;<span class="ident" id="6190141">reflect</span><span class="op" id="6190148">.</span><span class="ident" id="6190149">Uint8</span>&nbsp;<span class="op" id="6190155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190159">for</span>&nbsp;<span class="ident" id="6190163">i</span><span class="op" id="6190164">,</span>&nbsp;<span class="ident" id="6190166">n</span>&nbsp;<span class="op" id="6190168">:=</span>&nbsp;<span class="num" id="6190171">0</span><span class="op" id="6190172">,</span>&nbsp;<span class="ident" id="6190174">val</span><span class="op" id="6190177">.</span><span class="ident" id="6190178">Len</span><span class="op" id="6190181">(</span><span class="op" id="6190182">)</span><span class="op" id="6190183">;</span>&nbsp;<span class="ident" id="6190185">i</span>&nbsp;<span class="op" id="6190187">&lt;</span>&nbsp;<span class="ident" id="6190189">n</span><span class="op" id="6190190">;</span>&nbsp;<span class="ident" id="6190192">i</span><span class="op" id="6190193">++</span>&nbsp;<span class="op" id="6190196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190201">if</span>&nbsp;<span class="ident" id="6190204">err</span>&nbsp;<span class="op" id="6190208">:=</span>&nbsp;<span class="ident" id="6190211">p</span><span class="op" id="6190212">.</span><span class="ident" id="6190213">marshalValue</span><span class="op" id="6190225">(</span><span class="ident" id="6190226">val</span><span class="op" id="6190229">.</span><span class="ident" id="6190230">Index</span><span class="op" id="6190235">(</span><span class="ident" id="6190236">i</span><span class="op" id="6190237">)</span><span class="op" id="6190238">,</span>&nbsp;<span class="ident" id="6190240">finfo</span><span class="op" id="6190245">,</span>&nbsp;<span class="ident" id="6190247">startTemplate</span><span class="op" id="6190260">)</span><span class="op" id="6190261">;</span>&nbsp;<span class="ident" id="6190263">err</span>&nbsp;<span class="op" id="6190267">!=</span>&nbsp;<span class="builtintype" id="6190270">nil</span>&nbsp;<span class="op" id="6190274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190280">return</span>&nbsp;<span class="ident" id="6190287">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190294">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190302">return</span>&nbsp;<span class="builtintype" id="6190309">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190318">tinfo</span><span class="op" id="6190323">,</span>&nbsp;<span class="ident" id="6190325">err</span>&nbsp;<span class="op" id="6190329">:=</span>&nbsp;<span class="ident" id="6190332">getTypeInfo</span><span class="op" id="6190343">(</span><span class="ident" id="6190344">typ</span><span class="op" id="6190347">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190350">if</span>&nbsp;<span class="ident" id="6190353">err</span>&nbsp;<span class="op" id="6190357">!=</span>&nbsp;<span class="builtintype" id="6190360">nil</span>&nbsp;<span class="op" id="6190364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190368">return</span>&nbsp;<span class="ident" id="6190375">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190384">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190410">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190454">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190475">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190518">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6190565">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190582">var</span>&nbsp;<span class="ident" id="6190586">start</span>&nbsp;<span class="ident" id="6190592">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190607">if</span>&nbsp;<span class="ident" id="6190610">startTemplate</span>&nbsp;<span class="op" id="6190624">!=</span>&nbsp;<span class="builtintype" id="6190627">nil</span>&nbsp;<span class="op" id="6190631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190635">start</span><span class="op" id="6190640">.</span><span class="ident" id="6190641">Name</span>&nbsp;<span class="op" id="6190646">=</span>&nbsp;<span class="ident" id="6190648">startTemplate</span><span class="op" id="6190661">.</span><span class="ident" id="6190662">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190669">start</span><span class="op" id="6190674">.</span><span class="ident" id="6190675">Attr</span>&nbsp;<span class="op" id="6190680">=</span>&nbsp;<span class="builtinfunc" id="6190682">append</span><span class="op" id="6190688">(</span><span class="ident" id="6190689">start</span><span class="op" id="6190694">.</span><span class="ident" id="6190695">Attr</span><span class="op" id="6190699">,</span>&nbsp;<span class="ident" id="6190701">startTemplate</span><span class="op" id="6190714">.</span><span class="ident" id="6190715">Attr</span><span class="op" id="6190719">...</span><span class="op" id="6190722">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190725">}</span>&nbsp;<span class="keyword" id="6190727">else</span>&nbsp;<span class="keyword" id="6190732">if</span>&nbsp;<span class="ident" id="6190735">tinfo</span><span class="op" id="6190740">.</span><span class="ident" id="6190741">xmlname</span>&nbsp;<span class="op" id="6190749">!=</span>&nbsp;<span class="builtintype" id="6190752">nil</span>&nbsp;<span class="op" id="6190756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190760">xmlname</span>&nbsp;<span class="op" id="6190768">:=</span>&nbsp;<span class="ident" id="6190771">tinfo</span><span class="op" id="6190776">.</span><span class="ident" id="6190777">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190787">if</span>&nbsp;<span class="ident" id="6190790">xmlname</span><span class="op" id="6190797">.</span><span class="ident" id="6190798">name</span>&nbsp;<span class="op" id="6190803">!=</span>&nbsp;<span class="string" id="6190806">&#34;&#34;</span>&nbsp;<span class="op" id="6190809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190814">start</span><span class="op" id="6190819">.</span><span class="ident" id="6190820">Name</span><span class="op" id="6190824">.</span><span class="ident" id="6190825">Space</span><span class="op" id="6190830">,</span>&nbsp;<span class="ident" id="6190832">start</span><span class="op" id="6190837">.</span><span class="ident" id="6190838">Name</span><span class="op" id="6190842">.</span><span class="ident" id="6190843">Local</span>&nbsp;<span class="op" id="6190849">=</span>&nbsp;<span class="ident" id="6190851">xmlname</span><span class="op" id="6190858">.</span><span class="ident" id="6190859">xmlns</span><span class="op" id="6190864">,</span>&nbsp;<span class="ident" id="6190866">xmlname</span><span class="op" id="6190873">.</span><span class="ident" id="6190874">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190881">}</span>&nbsp;<span class="keyword" id="6190883">else</span>&nbsp;<span class="keyword" id="6190888">if</span>&nbsp;<span class="ident" id="6190891">v</span><span class="op" id="6190892">,</span>&nbsp;<span class="ident" id="6190894">ok</span>&nbsp;<span class="op" id="6190897">:=</span>&nbsp;<span class="ident" id="6190900">xmlname</span><span class="op" id="6190907">.</span><span class="ident" id="6190908">value</span><span class="op" id="6190913">(</span><span class="ident" id="6190914">val</span><span class="op" id="6190917">)</span><span class="op" id="6190918">.</span><span class="ident" id="6190919">Interface</span><span class="op" id="6190928">(</span><span class="op" id="6190929">)</span><span class="op" id="6190930">.</span><span class="op" id="6190931">(</span><span class="ident" id="6190932">Name</span><span class="op" id="6190936">)</span><span class="op" id="6190937">;</span>&nbsp;<span class="ident" id="6190939">ok</span>&nbsp;<span class="op" id="6190942">&amp;&amp;</span>&nbsp;<span class="ident" id="6190945">v</span><span class="op" id="6190946">.</span><span class="ident" id="6190947">Local</span>&nbsp;<span class="op" id="6190953">!=</span>&nbsp;<span class="string" id="6190956">&#34;&#34;</span>&nbsp;<span class="op" id="6190959">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6190964">start</span><span class="op" id="6190969">.</span><span class="ident" id="6190970">Name</span>&nbsp;<span class="op" id="6190975">=</span>&nbsp;<span class="ident" id="6190977">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6190984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6190987">if</span>&nbsp;<span class="ident" id="6190990">start</span><span class="op" id="6190995">.</span><span class="ident" id="6190996">Name</span><span class="op" id="6191000">.</span><span class="ident" id="6191001">Local</span>&nbsp;<span class="op" id="6191007">==</span>&nbsp;<span class="string" id="6191010">&#34;&#34;</span>&nbsp;<span class="op" id="6191013">&amp;&amp;</span>&nbsp;<span class="ident" id="6191016">finfo</span>&nbsp;<span class="op" id="6191022">!=</span>&nbsp;<span class="builtintype" id="6191025">nil</span>&nbsp;<span class="op" id="6191029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191033">start</span><span class="op" id="6191038">.</span><span class="ident" id="6191039">Name</span><span class="op" id="6191043">.</span><span class="ident" id="6191044">Space</span><span class="op" id="6191049">,</span>&nbsp;<span class="ident" id="6191051">start</span><span class="op" id="6191056">.</span><span class="ident" id="6191057">Name</span><span class="op" id="6191061">.</span><span class="ident" id="6191062">Local</span>&nbsp;<span class="op" id="6191068">=</span>&nbsp;<span class="ident" id="6191070">finfo</span><span class="op" id="6191075">.</span><span class="ident" id="6191076">xmlns</span><span class="op" id="6191081">,</span>&nbsp;<span class="ident" id="6191083">finfo</span><span class="op" id="6191088">.</span><span class="ident" id="6191089">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191098">if</span>&nbsp;<span class="ident" id="6191101">start</span><span class="op" id="6191106">.</span><span class="ident" id="6191107">Name</span><span class="op" id="6191111">.</span><span class="ident" id="6191112">Local</span>&nbsp;<span class="op" id="6191118">==</span>&nbsp;<span class="string" id="6191121">&#34;&#34;</span>&nbsp;<span class="op" id="6191124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191128">name</span>&nbsp;<span class="op" id="6191133">:=</span>&nbsp;<span class="ident" id="6191136">typ</span><span class="op" id="6191139">.</span><span class="ident" id="6191140">Name</span><span class="op" id="6191144">(</span><span class="op" id="6191145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191149">if</span>&nbsp;<span class="ident" id="6191152">name</span>&nbsp;<span class="op" id="6191157">==</span>&nbsp;<span class="string" id="6191160">&#34;&#34;</span>&nbsp;<span class="op" id="6191163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191168">return</span>&nbsp;<span class="op" id="6191175">&amp;</span><span class="ident" id="6191176">UnsupportedTypeError</span><span class="op" id="6191196">{</span><span class="ident" id="6191197">typ</span><span class="op" id="6191200">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191208">start</span><span class="op" id="6191213">.</span><span class="ident" id="6191214">Name</span><span class="op" id="6191218">.</span><span class="ident" id="6191219">Local</span>&nbsp;<span class="op" id="6191225">=</span>&nbsp;<span class="ident" id="6191227">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6191237">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191252">for</span>&nbsp;<span class="ident" id="6191256">i</span>&nbsp;<span class="op" id="6191258">:=</span>&nbsp;<span class="keyword" id="6191261">range</span>&nbsp;<span class="ident" id="6191267">tinfo</span><span class="op" id="6191272">.</span><span class="ident" id="6191273">fields</span>&nbsp;<span class="op" id="6191280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191284">finfo</span>&nbsp;<span class="op" id="6191290">:=</span>&nbsp;<span class="op" id="6191293">&amp;</span><span class="ident" id="6191294">tinfo</span><span class="op" id="6191299">.</span><span class="ident" id="6191300">fields</span><span class="op" id="6191306">[</span><span class="ident" id="6191307">i</span><span class="op" id="6191308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191312">if</span>&nbsp;<span class="ident" id="6191315">finfo</span><span class="op" id="6191320">.</span><span class="ident" id="6191321">flags</span><span class="op" id="6191326">&amp;</span><span class="ident" id="6191327">fAttr</span>&nbsp;<span class="op" id="6191333">==</span>&nbsp;<span class="num" id="6191336">0</span>&nbsp;<span class="op" id="6191338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191343">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191354">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191358">fv</span>&nbsp;<span class="op" id="6191361">:=</span>&nbsp;<span class="ident" id="6191364">finfo</span><span class="op" id="6191369">.</span><span class="ident" id="6191370">value</span><span class="op" id="6191375">(</span><span class="ident" id="6191376">val</span><span class="op" id="6191379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191383">name</span>&nbsp;<span class="op" id="6191388">:=</span>&nbsp;<span class="ident" id="6191391">Name</span><span class="op" id="6191395">{</span><span class="ident" id="6191396">Space</span><span class="op" id="6191401">:</span>&nbsp;<span class="ident" id="6191403">finfo</span><span class="op" id="6191408">.</span><span class="ident" id="6191409">xmlns</span><span class="op" id="6191414">,</span>&nbsp;<span class="ident" id="6191416">Local</span><span class="op" id="6191421">:</span>&nbsp;<span class="ident" id="6191423">finfo</span><span class="op" id="6191428">.</span><span class="ident" id="6191429">name</span><span class="op" id="6191433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191438">if</span>&nbsp;<span class="ident" id="6191441">finfo</span><span class="op" id="6191446">.</span><span class="ident" id="6191447">flags</span><span class="op" id="6191452">&amp;</span><span class="ident" id="6191453">fOmitEmpty</span>&nbsp;<span class="op" id="6191464">!=</span>&nbsp;<span class="num" id="6191467">0</span>&nbsp;<span class="op" id="6191469">&amp;&amp;</span>&nbsp;<span class="ident" id="6191472">isEmptyValue</span><span class="op" id="6191484">(</span><span class="ident" id="6191485">fv</span><span class="op" id="6191487">)</span>&nbsp;<span class="op" id="6191489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191494">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191510">if</span>&nbsp;<span class="ident" id="6191513">fv</span><span class="op" id="6191515">.</span><span class="ident" id="6191516">Kind</span><span class="op" id="6191520">(</span><span class="op" id="6191521">)</span>&nbsp;<span class="op" id="6191523">==</span>&nbsp;<span class="ident" id="6191526">reflect</span><span class="op" id="6191533">.</span><span class="ident" id="6191534">Interface</span>&nbsp;<span class="op" id="6191544">&amp;&amp;</span>&nbsp;<span class="ident" id="6191547">fv</span><span class="op" id="6191549">.</span><span class="ident" id="6191550">IsNil</span><span class="op" id="6191555">(</span><span class="op" id="6191556">)</span>&nbsp;<span class="op" id="6191558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191563">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191574">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191579">if</span>&nbsp;<span class="ident" id="6191582">fv</span><span class="op" id="6191584">.</span><span class="ident" id="6191585">CanInterface</span><span class="op" id="6191597">(</span><span class="op" id="6191598">)</span>&nbsp;<span class="op" id="6191600">&amp;&amp;</span>&nbsp;<span class="ident" id="6191603">fv</span><span class="op" id="6191605">.</span><span class="ident" id="6191606">Type</span><span class="op" id="6191610">(</span><span class="op" id="6191611">)</span><span class="op" id="6191612">.</span><span class="ident" id="6191613">Implements</span><span class="op" id="6191623">(</span><span class="ident" id="6191624">marshalerAttrType</span><span class="op" id="6191641">)</span>&nbsp;<span class="op" id="6191643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191648">attr</span><span class="op" id="6191652">,</span>&nbsp;<span class="ident" id="6191654">err</span>&nbsp;<span class="op" id="6191658">:=</span>&nbsp;<span class="ident" id="6191661">fv</span><span class="op" id="6191663">.</span><span class="ident" id="6191664">Interface</span><span class="op" id="6191673">(</span><span class="op" id="6191674">)</span><span class="op" id="6191675">.</span><span class="op" id="6191676">(</span><span class="ident" id="6191677">MarshalerAttr</span><span class="op" id="6191690">)</span><span class="op" id="6191691">.</span><span class="ident" id="6191692">MarshalXMLAttr</span><span class="op" id="6191706">(</span><span class="ident" id="6191707">name</span><span class="op" id="6191711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191716">if</span>&nbsp;<span class="ident" id="6191719">err</span>&nbsp;<span class="op" id="6191723">!=</span>&nbsp;<span class="builtintype" id="6191726">nil</span>&nbsp;<span class="op" id="6191730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191736">return</span>&nbsp;<span class="ident" id="6191743">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191755">if</span>&nbsp;<span class="ident" id="6191758">attr</span><span class="op" id="6191762">.</span><span class="ident" id="6191763">Name</span><span class="op" id="6191767">.</span><span class="ident" id="6191768">Local</span>&nbsp;<span class="op" id="6191774">!=</span>&nbsp;<span class="string" id="6191777">&#34;&#34;</span>&nbsp;<span class="op" id="6191780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191786">start</span><span class="op" id="6191791">.</span><span class="ident" id="6191792">Attr</span>&nbsp;<span class="op" id="6191797">=</span>&nbsp;<span class="builtinfunc" id="6191799">append</span><span class="op" id="6191805">(</span><span class="ident" id="6191806">start</span><span class="op" id="6191811">.</span><span class="ident" id="6191812">Attr</span><span class="op" id="6191816">,</span>&nbsp;<span class="ident" id="6191818">attr</span><span class="op" id="6191822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191832">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6191843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191848">if</span>&nbsp;<span class="ident" id="6191851">fv</span><span class="op" id="6191853">.</span><span class="ident" id="6191854">CanAddr</span><span class="op" id="6191861">(</span><span class="op" id="6191862">)</span>&nbsp;<span class="op" id="6191864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191869">pv</span>&nbsp;<span class="op" id="6191872">:=</span>&nbsp;<span class="ident" id="6191875">fv</span><span class="op" id="6191877">.</span><span class="ident" id="6191878">Addr</span><span class="op" id="6191882">(</span><span class="op" id="6191883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6191888">if</span>&nbsp;<span class="ident" id="6191891">pv</span><span class="op" id="6191893">.</span><span class="ident" id="6191894">CanInterface</span><span class="op" id="6191906">(</span><span class="op" id="6191907">)</span>&nbsp;<span class="op" id="6191909">&amp;&amp;</span>&nbsp;<span class="ident" id="6191912">pv</span><span class="op" id="6191914">.</span><span class="ident" id="6191915">Type</span><span class="op" id="6191919">(</span><span class="op" id="6191920">)</span><span class="op" id="6191921">.</span><span class="ident" id="6191922">Implements</span><span class="op" id="6191932">(</span><span class="ident" id="6191933">marshalerAttrType</span><span class="op" id="6191950">)</span>&nbsp;<span class="op" id="6191952">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6191958">attr</span><span class="op" id="6191962">,</span>&nbsp;<span class="ident" id="6191964">err</span>&nbsp;<span class="op" id="6191968">:=</span>&nbsp;<span class="ident" id="6191971">pv</span><span class="op" id="6191973">.</span><span class="ident" id="6191974">Interface</span><span class="op" id="6191983">(</span><span class="op" id="6191984">)</span><span class="op" id="6191985">.</span><span class="op" id="6191986">(</span><span class="ident" id="6191987">MarshalerAttr</span><span class="op" id="6192000">)</span><span class="op" id="6192001">.</span><span class="ident" id="6192002">MarshalXMLAttr</span><span class="op" id="6192016">(</span><span class="ident" id="6192017">name</span><span class="op" id="6192021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192027">if</span>&nbsp;<span class="ident" id="6192030">err</span>&nbsp;<span class="op" id="6192034">!=</span>&nbsp;<span class="builtintype" id="6192037">nil</span>&nbsp;<span class="op" id="6192041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192048">return</span>&nbsp;<span class="ident" id="6192055">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192069">if</span>&nbsp;<span class="ident" id="6192072">attr</span><span class="op" id="6192076">.</span><span class="ident" id="6192077">Name</span><span class="op" id="6192081">.</span><span class="ident" id="6192082">Local</span>&nbsp;<span class="op" id="6192088">!=</span>&nbsp;<span class="string" id="6192091">&#34;&#34;</span>&nbsp;<span class="op" id="6192094">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192101">start</span><span class="op" id="6192106">.</span><span class="ident" id="6192107">Attr</span>&nbsp;<span class="op" id="6192112">=</span>&nbsp;<span class="builtinfunc" id="6192114">append</span><span class="op" id="6192120">(</span><span class="ident" id="6192121">start</span><span class="op" id="6192126">.</span><span class="ident" id="6192127">Attr</span><span class="op" id="6192131">,</span>&nbsp;<span class="ident" id="6192133">attr</span><span class="op" id="6192137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192149">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192165">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192170">if</span>&nbsp;<span class="ident" id="6192173">fv</span><span class="op" id="6192175">.</span><span class="ident" id="6192176">CanInterface</span><span class="op" id="6192188">(</span><span class="op" id="6192189">)</span>&nbsp;<span class="op" id="6192191">&amp;&amp;</span>&nbsp;<span class="ident" id="6192194">fv</span><span class="op" id="6192196">.</span><span class="ident" id="6192197">Type</span><span class="op" id="6192201">(</span><span class="op" id="6192202">)</span><span class="op" id="6192203">.</span><span class="ident" id="6192204">Implements</span><span class="op" id="6192214">(</span><span class="ident" id="6192215">textMarshalerType</span><span class="op" id="6192232">)</span>&nbsp;<span class="op" id="6192234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192239">text</span><span class="op" id="6192243">,</span>&nbsp;<span class="ident" id="6192245">err</span>&nbsp;<span class="op" id="6192249">:=</span>&nbsp;<span class="ident" id="6192252">fv</span><span class="op" id="6192254">.</span><span class="ident" id="6192255">Interface</span><span class="op" id="6192264">(</span><span class="op" id="6192265">)</span><span class="op" id="6192266">.</span><span class="op" id="6192267">(</span><span class="ident" id="6192268">encoding</span><span class="op" id="6192276">.</span><span class="ident" id="6192277">TextMarshaler</span><span class="op" id="6192290">)</span><span class="op" id="6192291">.</span><span class="ident" id="6192292">MarshalText</span><span class="op" id="6192303">(</span><span class="op" id="6192304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192309">if</span>&nbsp;<span class="ident" id="6192312">err</span>&nbsp;<span class="op" id="6192316">!=</span>&nbsp;<span class="builtintype" id="6192319">nil</span>&nbsp;<span class="op" id="6192323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192329">return</span>&nbsp;<span class="ident" id="6192336">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192348">start</span><span class="op" id="6192353">.</span><span class="ident" id="6192354">Attr</span>&nbsp;<span class="op" id="6192359">=</span>&nbsp;<span class="builtinfunc" id="6192361">append</span><span class="op" id="6192367">(</span><span class="ident" id="6192368">start</span><span class="op" id="6192373">.</span><span class="ident" id="6192374">Attr</span><span class="op" id="6192378">,</span>&nbsp;<span class="ident" id="6192380">Attr</span><span class="op" id="6192384">{</span><span class="ident" id="6192385">name</span><span class="op" id="6192389">,</span>&nbsp;<span class="builtintype" id="6192391">string</span><span class="op" id="6192397">(</span><span class="ident" id="6192398">text</span><span class="op" id="6192402">)</span><span class="op" id="6192403">}</span><span class="op" id="6192404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192409">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192425">if</span>&nbsp;<span class="ident" id="6192428">fv</span><span class="op" id="6192430">.</span><span class="ident" id="6192431">CanAddr</span><span class="op" id="6192438">(</span><span class="op" id="6192439">)</span>&nbsp;<span class="op" id="6192441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192446">pv</span>&nbsp;<span class="op" id="6192449">:=</span>&nbsp;<span class="ident" id="6192452">fv</span><span class="op" id="6192454">.</span><span class="ident" id="6192455">Addr</span><span class="op" id="6192459">(</span><span class="op" id="6192460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192465">if</span>&nbsp;<span class="ident" id="6192468">pv</span><span class="op" id="6192470">.</span><span class="ident" id="6192471">CanInterface</span><span class="op" id="6192483">(</span><span class="op" id="6192484">)</span>&nbsp;<span class="op" id="6192486">&amp;&amp;</span>&nbsp;<span class="ident" id="6192489">pv</span><span class="op" id="6192491">.</span><span class="ident" id="6192492">Type</span><span class="op" id="6192496">(</span><span class="op" id="6192497">)</span><span class="op" id="6192498">.</span><span class="ident" id="6192499">Implements</span><span class="op" id="6192509">(</span><span class="ident" id="6192510">textMarshalerType</span><span class="op" id="6192527">)</span>&nbsp;<span class="op" id="6192529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192535">text</span><span class="op" id="6192539">,</span>&nbsp;<span class="ident" id="6192541">err</span>&nbsp;<span class="op" id="6192545">:=</span>&nbsp;<span class="ident" id="6192548">pv</span><span class="op" id="6192550">.</span><span class="ident" id="6192551">Interface</span><span class="op" id="6192560">(</span><span class="op" id="6192561">)</span><span class="op" id="6192562">.</span><span class="op" id="6192563">(</span><span class="ident" id="6192564">encoding</span><span class="op" id="6192572">.</span><span class="ident" id="6192573">TextMarshaler</span><span class="op" id="6192586">)</span><span class="op" id="6192587">.</span><span class="ident" id="6192588">MarshalText</span><span class="op" id="6192599">(</span><span class="op" id="6192600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192606">if</span>&nbsp;<span class="ident" id="6192609">err</span>&nbsp;<span class="op" id="6192613">!=</span>&nbsp;<span class="builtintype" id="6192616">nil</span>&nbsp;<span class="op" id="6192620">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192627">return</span>&nbsp;<span class="ident" id="6192634">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192648">start</span><span class="op" id="6192653">.</span><span class="ident" id="6192654">Attr</span>&nbsp;<span class="op" id="6192659">=</span>&nbsp;<span class="builtinfunc" id="6192661">append</span><span class="op" id="6192667">(</span><span class="ident" id="6192668">start</span><span class="op" id="6192673">.</span><span class="ident" id="6192674">Attr</span><span class="op" id="6192678">,</span>&nbsp;<span class="ident" id="6192680">Attr</span><span class="op" id="6192684">{</span><span class="ident" id="6192685">name</span><span class="op" id="6192689">,</span>&nbsp;<span class="builtintype" id="6192691">string</span><span class="op" id="6192697">(</span><span class="ident" id="6192698">text</span><span class="op" id="6192702">)</span><span class="op" id="6192703">}</span><span class="op" id="6192704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192710">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192722">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6192731">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192787">switch</span>&nbsp;<span class="ident" id="6192794">fv</span><span class="op" id="6192796">.</span><span class="ident" id="6192797">Kind</span><span class="op" id="6192801">(</span><span class="op" id="6192802">)</span>&nbsp;<span class="op" id="6192804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192808">case</span>&nbsp;<span class="ident" id="6192813">reflect</span><span class="op" id="6192820">.</span><span class="ident" id="6192821">Ptr</span><span class="op" id="6192824">,</span>&nbsp;<span class="ident" id="6192826">reflect</span><span class="op" id="6192833">.</span><span class="ident" id="6192834">Interface</span><span class="op" id="6192843">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192848">if</span>&nbsp;<span class="ident" id="6192851">fv</span><span class="op" id="6192853">.</span><span class="ident" id="6192854">IsNil</span><span class="op" id="6192859">(</span><span class="op" id="6192860">)</span>&nbsp;<span class="op" id="6192862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192868">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192885">fv</span>&nbsp;<span class="op" id="6192888">=</span>&nbsp;<span class="ident" id="6192890">fv</span><span class="op" id="6192892">.</span><span class="ident" id="6192893">Elem</span><span class="op" id="6192897">(</span><span class="op" id="6192898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192902">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6192907">s</span><span class="op" id="6192908">,</span>&nbsp;<span class="ident" id="6192910">b</span><span class="op" id="6192911">,</span>&nbsp;<span class="ident" id="6192913">err</span>&nbsp;<span class="op" id="6192917">:=</span>&nbsp;<span class="ident" id="6192920">p</span><span class="op" id="6192921">.</span><span class="ident" id="6192922">marshalSimple</span><span class="op" id="6192935">(</span><span class="ident" id="6192936">fv</span><span class="op" id="6192938">.</span><span class="ident" id="6192939">Type</span><span class="op" id="6192943">(</span><span class="op" id="6192944">)</span><span class="op" id="6192945">,</span>&nbsp;<span class="ident" id="6192947">fv</span><span class="op" id="6192949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192953">if</span>&nbsp;<span class="ident" id="6192956">err</span>&nbsp;<span class="op" id="6192960">!=</span>&nbsp;<span class="builtintype" id="6192963">nil</span>&nbsp;<span class="op" id="6192967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192972">return</span>&nbsp;<span class="ident" id="6192979">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6192985">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6192989">if</span>&nbsp;<span class="ident" id="6192992">b</span>&nbsp;<span class="op" id="6192994">!=</span>&nbsp;<span class="builtintype" id="6192997">nil</span>&nbsp;<span class="op" id="6193001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193006">s</span>&nbsp;<span class="op" id="6193008">=</span>&nbsp;<span class="builtintype" id="6193010">string</span><span class="op" id="6193016">(</span><span class="ident" id="6193017">b</span><span class="op" id="6193018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193026">start</span><span class="op" id="6193031">.</span><span class="ident" id="6193032">Attr</span>&nbsp;<span class="op" id="6193037">=</span>&nbsp;<span class="builtinfunc" id="6193039">append</span><span class="op" id="6193045">(</span><span class="ident" id="6193046">start</span><span class="op" id="6193051">.</span><span class="ident" id="6193052">Attr</span><span class="op" id="6193056">,</span>&nbsp;<span class="ident" id="6193058">Attr</span><span class="op" id="6193062">{</span><span class="ident" id="6193063">name</span><span class="op" id="6193067">,</span>&nbsp;<span class="ident" id="6193069">s</span><span class="op" id="6193070">}</span><span class="op" id="6193071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193074">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193078">if</span>&nbsp;<span class="ident" id="6193081">err</span>&nbsp;<span class="op" id="6193085">:=</span>&nbsp;<span class="ident" id="6193088">p</span><span class="op" id="6193089">.</span><span class="ident" id="6193090">writeStart</span><span class="op" id="6193100">(</span><span class="op" id="6193101">&amp;</span><span class="ident" id="6193102">start</span><span class="op" id="6193107">)</span><span class="op" id="6193108">;</span>&nbsp;<span class="ident" id="6193110">err</span>&nbsp;<span class="op" id="6193114">!=</span>&nbsp;<span class="builtintype" id="6193117">nil</span>&nbsp;<span class="op" id="6193121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193125">return</span>&nbsp;<span class="ident" id="6193132">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193141">if</span>&nbsp;<span class="ident" id="6193144">val</span><span class="op" id="6193147">.</span><span class="ident" id="6193148">Kind</span><span class="op" id="6193152">(</span><span class="op" id="6193153">)</span>&nbsp;<span class="op" id="6193155">==</span>&nbsp;<span class="ident" id="6193158">reflect</span><span class="op" id="6193165">.</span><span class="ident" id="6193166">Struct</span>&nbsp;<span class="op" id="6193173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193177">err</span>&nbsp;<span class="op" id="6193181">=</span>&nbsp;<span class="ident" id="6193183">p</span><span class="op" id="6193184">.</span><span class="ident" id="6193185">marshalStruct</span><span class="op" id="6193198">(</span><span class="ident" id="6193199">tinfo</span><span class="op" id="6193204">,</span>&nbsp;<span class="ident" id="6193206">val</span><span class="op" id="6193209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193212">}</span>&nbsp;<span class="keyword" id="6193214">else</span>&nbsp;<span class="op" id="6193219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193223">s</span><span class="op" id="6193224">,</span>&nbsp;<span class="ident" id="6193226">b</span><span class="op" id="6193227">,</span>&nbsp;<span class="ident" id="6193229">err1</span>&nbsp;<span class="op" id="6193234">:=</span>&nbsp;<span class="ident" id="6193237">p</span><span class="op" id="6193238">.</span><span class="ident" id="6193239">marshalSimple</span><span class="op" id="6193252">(</span><span class="ident" id="6193253">typ</span><span class="op" id="6193256">,</span>&nbsp;<span class="ident" id="6193258">val</span><span class="op" id="6193261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193265">if</span>&nbsp;<span class="ident" id="6193268">err1</span>&nbsp;<span class="op" id="6193273">!=</span>&nbsp;<span class="builtintype" id="6193276">nil</span>&nbsp;<span class="op" id="6193280">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193285">err</span>&nbsp;<span class="op" id="6193289">=</span>&nbsp;<span class="ident" id="6193291">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193298">}</span>&nbsp;<span class="keyword" id="6193300">else</span>&nbsp;<span class="keyword" id="6193305">if</span>&nbsp;<span class="ident" id="6193308">b</span>&nbsp;<span class="op" id="6193310">!=</span>&nbsp;<span class="builtintype" id="6193313">nil</span>&nbsp;<span class="op" id="6193317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193322">EscapeText</span><span class="op" id="6193332">(</span><span class="ident" id="6193333">p</span><span class="op" id="6193334">,</span>&nbsp;<span class="ident" id="6193336">b</span><span class="op" id="6193337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193341">}</span>&nbsp;<span class="keyword" id="6193343">else</span>&nbsp;<span class="op" id="6193348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193353">p</span><span class="op" id="6193354">.</span><span class="ident" id="6193355">EscapeString</span><span class="op" id="6193367">(</span><span class="ident" id="6193368">s</span><span class="op" id="6193369">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193379">if</span>&nbsp;<span class="ident" id="6193382">err</span>&nbsp;<span class="op" id="6193386">!=</span>&nbsp;<span class="builtintype" id="6193389">nil</span>&nbsp;<span class="op" id="6193393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193397">return</span>&nbsp;<span class="ident" id="6193404">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193409">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193413">if</span>&nbsp;<span class="ident" id="6193416">err</span>&nbsp;<span class="op" id="6193420">:=</span>&nbsp;<span class="ident" id="6193423">p</span><span class="op" id="6193424">.</span><span class="ident" id="6193425">writeEnd</span><span class="op" id="6193433">(</span><span class="ident" id="6193434">start</span><span class="op" id="6193439">.</span><span class="ident" id="6193440">Name</span><span class="op" id="6193444">)</span><span class="op" id="6193445">;</span>&nbsp;<span class="ident" id="6193447">err</span>&nbsp;<span class="op" id="6193451">!=</span>&nbsp;<span class="builtintype" id="6193454">nil</span>&nbsp;<span class="op" id="6193458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193462">return</span>&nbsp;<span class="ident" id="6193469">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193478">return</span>&nbsp;<span class="ident" id="6193485">p</span><span class="op" id="6193486">.</span><span class="ident" id="6193487">cachedWriteError</span><span class="op" id="6193503">(</span><span class="op" id="6193504">)</span><br>
<span class="lineno"></span><span class="op" id="6193506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6193509">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="6193567">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="6193626">func</span>&nbsp;<span class="ident" id="6193631">defaultStart</span><span class="op" id="6193643">(</span><span class="ident" id="6193644">typ</span>&nbsp;<span class="ident" id="6193648">reflect</span><span class="op" id="6193655">.</span><span class="ident" id="6193656">Type</span><span class="op" id="6193660">,</span>&nbsp;<span class="ident" id="6193662">finfo</span>&nbsp;<span class="op" id="6193668">*</span><span class="ident" id="6193669">fieldInfo</span><span class="op" id="6193678">,</span>&nbsp;<span class="ident" id="6193680">startTemplate</span>&nbsp;<span class="op" id="6193694">*</span><span class="ident" id="6193695">StartElement</span><span class="op" id="6193707">)</span>&nbsp;<span class="ident" id="6193709">StartElement</span>&nbsp;<span class="op" id="6193722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193725">var</span>&nbsp;<span class="ident" id="6193729">start</span>&nbsp;<span class="ident" id="6193735">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6193749">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6193802">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6193869">if</span>&nbsp;<span class="ident" id="6193872">startTemplate</span>&nbsp;<span class="op" id="6193886">!=</span>&nbsp;<span class="builtintype" id="6193889">nil</span>&nbsp;<span class="op" id="6193893">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193897">start</span><span class="op" id="6193902">.</span><span class="ident" id="6193903">Name</span>&nbsp;<span class="op" id="6193908">=</span>&nbsp;<span class="ident" id="6193910">startTemplate</span><span class="op" id="6193923">.</span><span class="ident" id="6193924">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6193931">start</span><span class="op" id="6193936">.</span><span class="ident" id="6193937">Attr</span>&nbsp;<span class="op" id="6193942">=</span>&nbsp;<span class="builtinfunc" id="6193944">append</span><span class="op" id="6193950">(</span><span class="ident" id="6193951">start</span><span class="op" id="6193956">.</span><span class="ident" id="6193957">Attr</span><span class="op" id="6193961">,</span>&nbsp;<span class="ident" id="6193963">startTemplate</span><span class="op" id="6193976">.</span><span class="ident" id="6193977">Attr</span><span class="op" id="6193981">...</span><span class="op" id="6193984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6193987">}</span>&nbsp;<span class="keyword" id="6193989">else</span>&nbsp;<span class="keyword" id="6193994">if</span>&nbsp;<span class="ident" id="6193997">finfo</span>&nbsp;<span class="op" id="6194003">!=</span>&nbsp;<span class="builtintype" id="6194006">nil</span>&nbsp;<span class="op" id="6194010">&amp;&amp;</span>&nbsp;<span class="ident" id="6194013">finfo</span><span class="op" id="6194018">.</span><span class="ident" id="6194019">name</span>&nbsp;<span class="op" id="6194024">!=</span>&nbsp;<span class="string" id="6194027">&#34;&#34;</span>&nbsp;<span class="op" id="6194030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194034">start</span><span class="op" id="6194039">.</span><span class="ident" id="6194040">Name</span><span class="op" id="6194044">.</span><span class="ident" id="6194045">Local</span>&nbsp;<span class="op" id="6194051">=</span>&nbsp;<span class="ident" id="6194053">finfo</span><span class="op" id="6194058">.</span><span class="ident" id="6194059">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194066">start</span><span class="op" id="6194071">.</span><span class="ident" id="6194072">Name</span><span class="op" id="6194076">.</span><span class="ident" id="6194077">Space</span>&nbsp;<span class="op" id="6194083">=</span>&nbsp;<span class="ident" id="6194085">finfo</span><span class="op" id="6194090">.</span><span class="ident" id="6194091">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6194098">}</span>&nbsp;<span class="keyword" id="6194100">else</span>&nbsp;<span class="keyword" id="6194105">if</span>&nbsp;<span class="ident" id="6194108">typ</span><span class="op" id="6194111">.</span><span class="ident" id="6194112">Name</span><span class="op" id="6194116">(</span><span class="op" id="6194117">)</span>&nbsp;<span class="op" id="6194119">!=</span>&nbsp;<span class="string" id="6194122">&#34;&#34;</span>&nbsp;<span class="op" id="6194125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194129">start</span><span class="op" id="6194134">.</span><span class="ident" id="6194135">Name</span><span class="op" id="6194139">.</span><span class="ident" id="6194140">Local</span>&nbsp;<span class="op" id="6194146">=</span>&nbsp;<span class="ident" id="6194148">typ</span><span class="op" id="6194151">.</span><span class="ident" id="6194152">Name</span><span class="op" id="6194156">(</span><span class="op" id="6194157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6194160">}</span>&nbsp;<span class="keyword" id="6194162">else</span>&nbsp;<span class="op" id="6194167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194171">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194211">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194252">start</span><span class="op" id="6194257">.</span><span class="ident" id="6194258">Name</span><span class="op" id="6194262">.</span><span class="ident" id="6194263">Local</span>&nbsp;<span class="op" id="6194269">=</span>&nbsp;<span class="ident" id="6194271">typ</span><span class="op" id="6194274">.</span><span class="ident" id="6194275">Elem</span><span class="op" id="6194279">(</span><span class="op" id="6194280">)</span><span class="op" id="6194281">.</span><span class="ident" id="6194282">Name</span><span class="op" id="6194286">(</span><span class="op" id="6194287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6194290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194293">return</span>&nbsp;<span class="ident" id="6194300">start</span><br>
<span class="lineno"></span><span class="op" id="6194306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="6194309">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6194367">func</span>&nbsp;<span class="op" id="6194372">(</span><span class="ident" id="6194373">p</span>&nbsp;<span class="op" id="6194375">*</span><span class="ident" id="6194376">printer</span><span class="op" id="6194383">)</span>&nbsp;<span class="ident" id="6194385">marshalInterface</span><span class="op" id="6194401">(</span><span class="ident" id="6194402">val</span>&nbsp;<span class="ident" id="6194406">Marshaler</span><span class="op" id="6194415">,</span>&nbsp;<span class="ident" id="6194417">start</span>&nbsp;<span class="ident" id="6194423">StartElement</span><span class="op" id="6194435">)</span>&nbsp;<span class="builtintype" id="6194437">error</span>&nbsp;<span class="op" id="6194443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194446">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194502">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194554">p</span><span class="op" id="6194555">.</span><span class="ident" id="6194556">tags</span>&nbsp;<span class="op" id="6194561">=</span>&nbsp;<span class="builtinfunc" id="6194563">append</span><span class="op" id="6194569">(</span><span class="ident" id="6194570">p</span><span class="op" id="6194571">.</span><span class="ident" id="6194572">tags</span><span class="op" id="6194576">,</span>&nbsp;<span class="ident" id="6194578">Name</span><span class="op" id="6194582">{</span><span class="op" id="6194583">}</span><span class="op" id="6194584">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194587">n</span>&nbsp;<span class="op" id="6194589">:=</span>&nbsp;<span class="builtinfunc" id="6194592">len</span><span class="op" id="6194595">(</span><span class="ident" id="6194596">p</span><span class="op" id="6194597">.</span><span class="ident" id="6194598">tags</span><span class="op" id="6194602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194606">err</span>&nbsp;<span class="op" id="6194610">:=</span>&nbsp;<span class="ident" id="6194613">val</span><span class="op" id="6194616">.</span><span class="ident" id="6194617">MarshalXML</span><span class="op" id="6194627">(</span><span class="ident" id="6194628">p</span><span class="op" id="6194629">.</span><span class="ident" id="6194630">encoder</span><span class="op" id="6194637">,</span>&nbsp;<span class="ident" id="6194639">start</span><span class="op" id="6194644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194647">if</span>&nbsp;<span class="ident" id="6194650">err</span>&nbsp;<span class="op" id="6194654">!=</span>&nbsp;<span class="builtintype" id="6194657">nil</span>&nbsp;<span class="op" id="6194661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194665">return</span>&nbsp;<span class="ident" id="6194672">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6194677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194681">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194752">if</span>&nbsp;<span class="builtinfunc" id="6194755">len</span><span class="op" id="6194758">(</span><span class="ident" id="6194759">p</span><span class="op" id="6194760">.</span><span class="ident" id="6194761">tags</span><span class="op" id="6194765">)</span>&nbsp;<span class="op" id="6194767">&gt;</span>&nbsp;<span class="ident" id="6194769">n</span>&nbsp;<span class="op" id="6194771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194775">return</span>&nbsp;<span class="ident" id="6194782">fmt</span><span class="op" id="6194785">.</span><span class="ident" id="6194786">Errorf</span><span class="op" id="6194792">(</span><span class="string" id="6194793">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="6194848">,</span>&nbsp;<span class="ident" id="6194850">receiverType</span><span class="op" id="6194862">(</span><span class="ident" id="6194863">val</span><span class="op" id="6194866">)</span><span class="op" id="6194867">,</span>&nbsp;<span class="ident" id="6194869">p</span><span class="op" id="6194870">.</span><span class="ident" id="6194871">tags</span><span class="op" id="6194875">[</span><span class="builtinfunc" id="6194876">len</span><span class="op" id="6194879">(</span><span class="ident" id="6194880">p</span><span class="op" id="6194881">.</span><span class="ident" id="6194882">tags</span><span class="op" id="6194886">)</span><span class="op" id="6194887">-</span><span class="num" id="6194888">1</span><span class="op" id="6194889">]</span><span class="op" id="6194890">.</span><span class="ident" id="6194891">Local</span><span class="op" id="6194896">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6194899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194902">p</span><span class="op" id="6194903">.</span><span class="ident" id="6194904">tags</span>&nbsp;<span class="op" id="6194909">=</span>&nbsp;<span class="ident" id="6194911">p</span><span class="op" id="6194912">.</span><span class="ident" id="6194913">tags</span><span class="op" id="6194917">[</span><span class="op" id="6194918">:</span><span class="ident" id="6194919">n</span><span class="op" id="6194920">-</span><span class="num" id="6194921">1</span><span class="op" id="6194922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6194925">return</span>&nbsp;<span class="builtintype" id="6194932">nil</span><br>
<span class="lineno"></span><span class="op" id="6194936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="6194939">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6195005">func</span>&nbsp;<span class="op" id="6195010">(</span><span class="ident" id="6195011">p</span>&nbsp;<span class="op" id="6195013">*</span><span class="ident" id="6195014">printer</span><span class="op" id="6195021">)</span>&nbsp;<span class="ident" id="6195023">marshalTextInterface</span><span class="op" id="6195043">(</span><span class="ident" id="6195044">val</span>&nbsp;<span class="ident" id="6195048">encoding</span><span class="op" id="6195056">.</span><span class="ident" id="6195057">TextMarshaler</span><span class="op" id="6195070">,</span>&nbsp;<span class="ident" id="6195072">start</span>&nbsp;<span class="ident" id="6195078">StartElement</span><span class="op" id="6195090">)</span>&nbsp;<span class="builtintype" id="6195092">error</span>&nbsp;<span class="op" id="6195098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195101">if</span>&nbsp;<span class="ident" id="6195104">err</span>&nbsp;<span class="op" id="6195108">:=</span>&nbsp;<span class="ident" id="6195111">p</span><span class="op" id="6195112">.</span><span class="ident" id="6195113">writeStart</span><span class="op" id="6195123">(</span><span class="op" id="6195124">&amp;</span><span class="ident" id="6195125">start</span><span class="op" id="6195130">)</span><span class="op" id="6195131">;</span>&nbsp;<span class="ident" id="6195133">err</span>&nbsp;<span class="op" id="6195137">!=</span>&nbsp;<span class="builtintype" id="6195140">nil</span>&nbsp;<span class="op" id="6195144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195148">return</span>&nbsp;<span class="ident" id="6195155">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195160">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195163">text</span><span class="op" id="6195167">,</span>&nbsp;<span class="ident" id="6195169">err</span>&nbsp;<span class="op" id="6195173">:=</span>&nbsp;<span class="ident" id="6195176">val</span><span class="op" id="6195179">.</span><span class="ident" id="6195180">MarshalText</span><span class="op" id="6195191">(</span><span class="op" id="6195192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195195">if</span>&nbsp;<span class="ident" id="6195198">err</span>&nbsp;<span class="op" id="6195202">!=</span>&nbsp;<span class="builtintype" id="6195205">nil</span>&nbsp;<span class="op" id="6195209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195213">return</span>&nbsp;<span class="ident" id="6195220">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195228">EscapeText</span><span class="op" id="6195238">(</span><span class="ident" id="6195239">p</span><span class="op" id="6195240">,</span>&nbsp;<span class="ident" id="6195242">text</span><span class="op" id="6195246">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195249">return</span>&nbsp;<span class="ident" id="6195256">p</span><span class="op" id="6195257">.</span><span class="ident" id="6195258">writeEnd</span><span class="op" id="6195266">(</span><span class="ident" id="6195267">start</span><span class="op" id="6195272">.</span><span class="ident" id="6195273">Name</span><span class="op" id="6195277">)</span><br>
<span class="lineno"></span><span class="op" id="6195279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6195282">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="6195328">func</span>&nbsp;<span class="op" id="6195333">(</span><span class="ident" id="6195334">p</span>&nbsp;<span class="op" id="6195336">*</span><span class="ident" id="6195337">printer</span><span class="op" id="6195344">)</span>&nbsp;<span class="ident" id="6195346">writeStart</span><span class="op" id="6195356">(</span><span class="ident" id="6195357">start</span>&nbsp;<span class="op" id="6195363">*</span><span class="ident" id="6195364">StartElement</span><span class="op" id="6195376">)</span>&nbsp;<span class="builtintype" id="6195378">error</span>&nbsp;<span class="op" id="6195384">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195387">if</span>&nbsp;<span class="ident" id="6195390">start</span><span class="op" id="6195395">.</span><span class="ident" id="6195396">Name</span><span class="op" id="6195400">.</span><span class="ident" id="6195401">Local</span>&nbsp;<span class="op" id="6195407">==</span>&nbsp;<span class="string" id="6195410">&#34;&#34;</span>&nbsp;<span class="op" id="6195413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195417">return</span>&nbsp;<span class="ident" id="6195424">fmt</span><span class="op" id="6195427">.</span><span class="ident" id="6195428">Errorf</span><span class="op" id="6195434">(</span><span class="string" id="6195435">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6195464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195471">p</span><span class="op" id="6195472">.</span><span class="ident" id="6195473">tags</span>&nbsp;<span class="op" id="6195478">=</span>&nbsp;<span class="builtinfunc" id="6195480">append</span><span class="op" id="6195486">(</span><span class="ident" id="6195487">p</span><span class="op" id="6195488">.</span><span class="ident" id="6195489">tags</span><span class="op" id="6195493">,</span>&nbsp;<span class="ident" id="6195495">start</span><span class="op" id="6195500">.</span><span class="ident" id="6195501">Name</span><span class="op" id="6195505">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195508">p</span><span class="op" id="6195509">.</span><span class="ident" id="6195510">markPrefix</span><span class="op" id="6195520">(</span><span class="op" id="6195521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195525">p</span><span class="op" id="6195526">.</span><span class="ident" id="6195527">writeIndent</span><span class="op" id="6195538">(</span><span class="num" id="6195539">1</span><span class="op" id="6195540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195543">p</span><span class="op" id="6195544">.</span><span class="ident" id="6195545">WriteByte</span><span class="op" id="6195554">(</span><span class="string" id="6195555">&#39;&lt;&#39;</span><span class="op" id="6195558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195561">p</span><span class="op" id="6195562">.</span><span class="ident" id="6195563">WriteString</span><span class="op" id="6195574">(</span><span class="ident" id="6195575">start</span><span class="op" id="6195580">.</span><span class="ident" id="6195581">Name</span><span class="op" id="6195585">.</span><span class="ident" id="6195586">Local</span><span class="op" id="6195591">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195595">if</span>&nbsp;<span class="ident" id="6195598">start</span><span class="op" id="6195603">.</span><span class="ident" id="6195604">Name</span><span class="op" id="6195608">.</span><span class="ident" id="6195609">Space</span>&nbsp;<span class="op" id="6195615">!=</span>&nbsp;<span class="string" id="6195618">&#34;&#34;</span>&nbsp;<span class="op" id="6195621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195625">p</span><span class="op" id="6195626">.</span><span class="ident" id="6195627">WriteString</span><span class="op" id="6195638">(</span><span class="string" id="6195639">`&nbsp;xmlns=&#34;`</span><span class="op" id="6195649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195653">p</span><span class="op" id="6195654">.</span><span class="ident" id="6195655">EscapeString</span><span class="op" id="6195667">(</span><span class="ident" id="6195668">start</span><span class="op" id="6195673">.</span><span class="ident" id="6195674">Name</span><span class="op" id="6195678">.</span><span class="ident" id="6195679">Space</span><span class="op" id="6195684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195688">p</span><span class="op" id="6195689">.</span><span class="ident" id="6195690">WriteByte</span><span class="op" id="6195699">(</span><span class="string" id="6195700">&#39;&#34;&#39;</span><span class="op" id="6195703">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6195710">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195725">for</span>&nbsp;<span class="ident" id="6195729">_</span><span class="op" id="6195730">,</span>&nbsp;<span class="ident" id="6195732">attr</span>&nbsp;<span class="op" id="6195737">:=</span>&nbsp;<span class="keyword" id="6195740">range</span>&nbsp;<span class="ident" id="6195746">start</span><span class="op" id="6195751">.</span><span class="ident" id="6195752">Attr</span>&nbsp;<span class="op" id="6195757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195761">name</span>&nbsp;<span class="op" id="6195766">:=</span>&nbsp;<span class="ident" id="6195769">attr</span><span class="op" id="6195773">.</span><span class="ident" id="6195774">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195781">if</span>&nbsp;<span class="ident" id="6195784">name</span><span class="op" id="6195788">.</span><span class="ident" id="6195789">Local</span>&nbsp;<span class="op" id="6195795">==</span>&nbsp;<span class="string" id="6195798">&#34;&#34;</span>&nbsp;<span class="op" id="6195801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195806">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195821">p</span><span class="op" id="6195822">.</span><span class="ident" id="6195823">WriteByte</span><span class="op" id="6195832">(</span><span class="string" id="6195833">&#39;&nbsp;&#39;</span><span class="op" id="6195836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6195840">if</span>&nbsp;<span class="ident" id="6195843">name</span><span class="op" id="6195847">.</span><span class="ident" id="6195848">Space</span>&nbsp;<span class="op" id="6195854">!=</span>&nbsp;<span class="string" id="6195857">&#34;&#34;</span>&nbsp;<span class="op" id="6195860">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195865">p</span><span class="op" id="6195866">.</span><span class="ident" id="6195867">WriteString</span><span class="op" id="6195878">(</span><span class="ident" id="6195879">p</span><span class="op" id="6195880">.</span><span class="ident" id="6195881">createAttrPrefix</span><span class="op" id="6195897">(</span><span class="ident" id="6195898">name</span><span class="op" id="6195902">.</span><span class="ident" id="6195903">Space</span><span class="op" id="6195908">)</span><span class="op" id="6195909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195914">p</span><span class="op" id="6195915">.</span><span class="ident" id="6195916">WriteByte</span><span class="op" id="6195925">(</span><span class="string" id="6195926">&#39;:&#39;</span><span class="op" id="6195929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195937">p</span><span class="op" id="6195938">.</span><span class="ident" id="6195939">WriteString</span><span class="op" id="6195950">(</span><span class="ident" id="6195951">name</span><span class="op" id="6195955">.</span><span class="ident" id="6195956">Local</span><span class="op" id="6195961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195965">p</span><span class="op" id="6195966">.</span><span class="ident" id="6195967">WriteString</span><span class="op" id="6195978">(</span><span class="string" id="6195979">`=&#34;`</span><span class="op" id="6195983">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6195987">p</span><span class="op" id="6195988">.</span><span class="ident" id="6195989">EscapeString</span><span class="op" id="6196001">(</span><span class="ident" id="6196002">attr</span><span class="op" id="6196006">.</span><span class="ident" id="6196007">Value</span><span class="op" id="6196012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196016">p</span><span class="op" id="6196017">.</span><span class="ident" id="6196018">WriteByte</span><span class="op" id="6196027">(</span><span class="string" id="6196028">&#39;&#34;&#39;</span><span class="op" id="6196031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6196034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196037">p</span><span class="op" id="6196038">.</span><span class="ident" id="6196039">WriteByte</span><span class="op" id="6196048">(</span><span class="string" id="6196049">&#39;&gt;&#39;</span><span class="op" id="6196052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196055">return</span>&nbsp;<span class="builtintype" id="6196062">nil</span><br>
<span class="lineno">645</span><span class="op" id="6196066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6196069">func</span>&nbsp;<span class="op" id="6196074">(</span><span class="ident" id="6196075">p</span>&nbsp;<span class="op" id="6196077">*</span><span class="ident" id="6196078">printer</span><span class="op" id="6196085">)</span>&nbsp;<span class="ident" id="6196087">writeEnd</span><span class="op" id="6196095">(</span><span class="ident" id="6196096">name</span>&nbsp;<span class="ident" id="6196101">Name</span><span class="op" id="6196105">)</span>&nbsp;<span class="builtintype" id="6196107">error</span>&nbsp;<span class="op" id="6196113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196116">if</span>&nbsp;<span class="ident" id="6196119">name</span><span class="op" id="6196123">.</span><span class="ident" id="6196124">Local</span>&nbsp;<span class="op" id="6196130">==</span>&nbsp;<span class="string" id="6196133">&#34;&#34;</span>&nbsp;<span class="op" id="6196136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196140">return</span>&nbsp;<span class="ident" id="6196147">fmt</span><span class="op" id="6196150">.</span><span class="ident" id="6196151">Errorf</span><span class="op" id="6196157">(</span><span class="string" id="6196158">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6196185">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6196188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196191">if</span>&nbsp;<span class="builtinfunc" id="6196194">len</span><span class="op" id="6196197">(</span><span class="ident" id="6196198">p</span><span class="op" id="6196199">.</span><span class="ident" id="6196200">tags</span><span class="op" id="6196204">)</span>&nbsp;<span class="op" id="6196206">==</span>&nbsp;<span class="num" id="6196209">0</span>&nbsp;<span class="op" id="6196211">||</span>&nbsp;<span class="ident" id="6196214">p</span><span class="op" id="6196215">.</span><span class="ident" id="6196216">tags</span><span class="op" id="6196220">[</span><span class="builtinfunc" id="6196221">len</span><span class="op" id="6196224">(</span><span class="ident" id="6196225">p</span><span class="op" id="6196226">.</span><span class="ident" id="6196227">tags</span><span class="op" id="6196231">)</span><span class="op" id="6196232">-</span><span class="num" id="6196233">1</span><span class="op" id="6196234">]</span><span class="op" id="6196235">.</span><span class="ident" id="6196236">Local</span>&nbsp;<span class="op" id="6196242">==</span>&nbsp;<span class="string" id="6196245">&#34;&#34;</span>&nbsp;<span class="op" id="6196248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196252">return</span>&nbsp;<span class="ident" id="6196259">fmt</span><span class="op" id="6196262">.</span><span class="ident" id="6196263">Errorf</span><span class="op" id="6196269">(</span><span class="string" id="6196270">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="6196308">,</span>&nbsp;<span class="ident" id="6196310">name</span><span class="op" id="6196314">.</span><span class="ident" id="6196315">Local</span><span class="op" id="6196320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6196323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196326">if</span>&nbsp;<span class="ident" id="6196329">top</span>&nbsp;<span class="op" id="6196333">:=</span>&nbsp;<span class="ident" id="6196336">p</span><span class="op" id="6196337">.</span><span class="ident" id="6196338">tags</span><span class="op" id="6196342">[</span><span class="builtinfunc" id="6196343">len</span><span class="op" id="6196346">(</span><span class="ident" id="6196347">p</span><span class="op" id="6196348">.</span><span class="ident" id="6196349">tags</span><span class="op" id="6196353">)</span><span class="op" id="6196354">-</span><span class="num" id="6196355">1</span><span class="op" id="6196356">]</span><span class="op" id="6196357">;</span>&nbsp;<span class="ident" id="6196359">top</span>&nbsp;<span class="op" id="6196363">!=</span>&nbsp;<span class="ident" id="6196366">name</span>&nbsp;<span class="op" id="6196371">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196375">if</span>&nbsp;<span class="ident" id="6196378">top</span><span class="op" id="6196381">.</span><span class="ident" id="6196382">Local</span>&nbsp;<span class="op" id="6196388">!=</span>&nbsp;<span class="ident" id="6196391">name</span><span class="op" id="6196395">.</span><span class="ident" id="6196396">Local</span>&nbsp;<span class="op" id="6196402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196407">return</span>&nbsp;<span class="ident" id="6196414">fmt</span><span class="op" id="6196417">.</span><span class="ident" id="6196418">Errorf</span><span class="op" id="6196424">(</span><span class="string" id="6196425">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6196475">,</span>&nbsp;<span class="ident" id="6196477">name</span><span class="op" id="6196481">.</span><span class="ident" id="6196482">Local</span><span class="op" id="6196487">,</span>&nbsp;<span class="ident" id="6196489">top</span><span class="op" id="6196492">.</span><span class="ident" id="6196493">Local</span><span class="op" id="6196498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6196502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196506">return</span>&nbsp;<span class="ident" id="6196513">fmt</span><span class="op" id="6196516">.</span><span class="ident" id="6196517">Errorf</span><span class="op" id="6196523">(</span><span class="string" id="6196524">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="6196606">,</span>&nbsp;<span class="ident" id="6196608">name</span><span class="op" id="6196612">.</span><span class="ident" id="6196613">Local</span><span class="op" id="6196618">,</span>&nbsp;<span class="ident" id="6196620">name</span><span class="op" id="6196624">.</span><span class="ident" id="6196625">Space</span><span class="op" id="6196630">,</span>&nbsp;<span class="ident" id="6196632">top</span><span class="op" id="6196635">.</span><span class="ident" id="6196636">Local</span><span class="op" id="6196641">,</span>&nbsp;<span class="ident" id="6196643">top</span><span class="op" id="6196646">.</span><span class="ident" id="6196647">Space</span><span class="op" id="6196652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6196655">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196658">p</span><span class="op" id="6196659">.</span><span class="ident" id="6196660">tags</span>&nbsp;<span class="op" id="6196665">=</span>&nbsp;<span class="ident" id="6196667">p</span><span class="op" id="6196668">.</span><span class="ident" id="6196669">tags</span><span class="op" id="6196673">[</span><span class="op" id="6196674">:</span><span class="builtinfunc" id="6196675">len</span><span class="op" id="6196678">(</span><span class="ident" id="6196679">p</span><span class="op" id="6196680">.</span><span class="ident" id="6196681">tags</span><span class="op" id="6196685">)</span><span class="op" id="6196686">-</span><span class="num" id="6196687">1</span><span class="op" id="6196688">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196692">p</span><span class="op" id="6196693">.</span><span class="ident" id="6196694">writeIndent</span><span class="op" id="6196705">(</span><span class="op" id="6196706">-</span><span class="num" id="6196707">1</span><span class="op" id="6196708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196711">p</span><span class="op" id="6196712">.</span><span class="ident" id="6196713">WriteByte</span><span class="op" id="6196722">(</span><span class="string" id="6196723">&#39;&lt;&#39;</span><span class="op" id="6196726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196729">p</span><span class="op" id="6196730">.</span><span class="ident" id="6196731">WriteByte</span><span class="op" id="6196740">(</span><span class="string" id="6196741">&#39;/&#39;</span><span class="op" id="6196744">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196747">p</span><span class="op" id="6196748">.</span><span class="ident" id="6196749">WriteString</span><span class="op" id="6196760">(</span><span class="ident" id="6196761">name</span><span class="op" id="6196765">.</span><span class="ident" id="6196766">Local</span><span class="op" id="6196771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196774">p</span><span class="op" id="6196775">.</span><span class="ident" id="6196776">WriteByte</span><span class="op" id="6196785">(</span><span class="string" id="6196786">&#39;&gt;&#39;</span><span class="op" id="6196789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6196792">p</span><span class="op" id="6196793">.</span><span class="ident" id="6196794">popPrefix</span><span class="op" id="6196803">(</span><span class="op" id="6196804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196807">return</span>&nbsp;<span class="builtintype" id="6196814">nil</span><br>
<span class="lineno"></span><span class="op" id="6196818">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="6196821">func</span>&nbsp;<span class="op" id="6196826">(</span><span class="ident" id="6196827">p</span>&nbsp;<span class="op" id="6196829">*</span><span class="ident" id="6196830">printer</span><span class="op" id="6196837">)</span>&nbsp;<span class="ident" id="6196839">marshalSimple</span><span class="op" id="6196852">(</span><span class="ident" id="6196853">typ</span>&nbsp;<span class="ident" id="6196857">reflect</span><span class="op" id="6196864">.</span><span class="ident" id="6196865">Type</span><span class="op" id="6196869">,</span>&nbsp;<span class="ident" id="6196871">val</span>&nbsp;<span class="ident" id="6196875">reflect</span><span class="op" id="6196882">.</span><span class="ident" id="6196883">Value</span><span class="op" id="6196888">)</span>&nbsp;<span class="op" id="6196890">(</span><span class="builtintype" id="6196891">string</span><span class="op" id="6196897">,</span>&nbsp;<span class="op" id="6196899">[</span><span class="op" id="6196900">]</span><span class="builtintype" id="6196901">byte</span><span class="op" id="6196905">,</span>&nbsp;<span class="builtintype" id="6196907">error</span><span class="op" id="6196912">)</span>&nbsp;<span class="op" id="6196914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196917">switch</span>&nbsp;<span class="ident" id="6196924">val</span><span class="op" id="6196927">.</span><span class="ident" id="6196928">Kind</span><span class="op" id="6196932">(</span><span class="op" id="6196933">)</span>&nbsp;<span class="op" id="6196935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6196938">case</span>&nbsp;<span class="ident" id="6196943">reflect</span><span class="op" id="6196950">.</span><span class="ident" id="6196951">Int</span><span class="op" id="6196954">,</span>&nbsp;<span class="ident" id="6196956">reflect</span><span class="op" id="6196963">.</span><span class="ident" id="6196964">Int8</span><span class="op" id="6196968">,</span>&nbsp;<span class="ident" id="6196970">reflect</span><span class="op" id="6196977">.</span><span class="ident" id="6196978">Int16</span><span class="op" id="6196983">,</span>&nbsp;<span class="ident" id="6196985">reflect</span><span class="op" id="6196992">.</span><span class="ident" id="6196993">Int32</span><span class="op" id="6196998">,</span>&nbsp;<span class="ident" id="6197000">reflect</span><span class="op" id="6197007">.</span><span class="ident" id="6197008">Int64</span><span class="op" id="6197013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197017">return</span>&nbsp;<span class="ident" id="6197024">strconv</span><span class="op" id="6197031">.</span><span class="ident" id="6197032">FormatInt</span><span class="op" id="6197041">(</span><span class="ident" id="6197042">val</span><span class="op" id="6197045">.</span><span class="ident" id="6197046">Int</span><span class="op" id="6197049">(</span><span class="op" id="6197050">)</span><span class="op" id="6197051">,</span>&nbsp;<span class="num" id="6197053">10</span><span class="op" id="6197055">)</span><span class="op" id="6197056">,</span>&nbsp;<span class="builtintype" id="6197058">nil</span><span class="op" id="6197061">,</span>&nbsp;<span class="builtintype" id="6197063">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197068">case</span>&nbsp;<span class="ident" id="6197073">reflect</span><span class="op" id="6197080">.</span><span class="ident" id="6197081">Uint</span><span class="op" id="6197085">,</span>&nbsp;<span class="ident" id="6197087">reflect</span><span class="op" id="6197094">.</span><span class="ident" id="6197095">Uint8</span><span class="op" id="6197100">,</span>&nbsp;<span class="ident" id="6197102">reflect</span><span class="op" id="6197109">.</span><span class="ident" id="6197110">Uint16</span><span class="op" id="6197116">,</span>&nbsp;<span class="ident" id="6197118">reflect</span><span class="op" id="6197125">.</span><span class="ident" id="6197126">Uint32</span><span class="op" id="6197132">,</span>&nbsp;<span class="ident" id="6197134">reflect</span><span class="op" id="6197141">.</span><span class="ident" id="6197142">Uint64</span><span class="op" id="6197148">,</span>&nbsp;<span class="ident" id="6197150">reflect</span><span class="op" id="6197157">.</span><span class="ident" id="6197158">Uintptr</span><span class="op" id="6197165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197169">return</span>&nbsp;<span class="ident" id="6197176">strconv</span><span class="op" id="6197183">.</span><span class="ident" id="6197184">FormatUint</span><span class="op" id="6197194">(</span><span class="ident" id="6197195">val</span><span class="op" id="6197198">.</span><span class="ident" id="6197199">Uint</span><span class="op" id="6197203">(</span><span class="op" id="6197204">)</span><span class="op" id="6197205">,</span>&nbsp;<span class="num" id="6197207">10</span><span class="op" id="6197209">)</span><span class="op" id="6197210">,</span>&nbsp;<span class="builtintype" id="6197212">nil</span><span class="op" id="6197215">,</span>&nbsp;<span class="builtintype" id="6197217">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197222">case</span>&nbsp;<span class="ident" id="6197227">reflect</span><span class="op" id="6197234">.</span><span class="ident" id="6197235">Float32</span><span class="op" id="6197242">,</span>&nbsp;<span class="ident" id="6197244">reflect</span><span class="op" id="6197251">.</span><span class="ident" id="6197252">Float64</span><span class="op" id="6197259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197263">return</span>&nbsp;<span class="ident" id="6197270">strconv</span><span class="op" id="6197277">.</span><span class="ident" id="6197278">FormatFloat</span><span class="op" id="6197289">(</span><span class="ident" id="6197290">val</span><span class="op" id="6197293">.</span><span class="ident" id="6197294">Float</span><span class="op" id="6197299">(</span><span class="op" id="6197300">)</span><span class="op" id="6197301">,</span>&nbsp;<span class="string" id="6197303">&#39;g&#39;</span><span class="op" id="6197306">,</span>&nbsp;<span class="op" id="6197308">-</span><span class="num" id="6197309">1</span><span class="op" id="6197310">,</span>&nbsp;<span class="ident" id="6197312">val</span><span class="op" id="6197315">.</span><span class="ident" id="6197316">Type</span><span class="op" id="6197320">(</span><span class="op" id="6197321">)</span><span class="op" id="6197322">.</span><span class="ident" id="6197323">Bits</span><span class="op" id="6197327">(</span><span class="op" id="6197328">)</span><span class="op" id="6197329">)</span><span class="op" id="6197330">,</span>&nbsp;<span class="builtintype" id="6197332">nil</span><span class="op" id="6197335">,</span>&nbsp;<span class="builtintype" id="6197337">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197342">case</span>&nbsp;<span class="ident" id="6197347">reflect</span><span class="op" id="6197354">.</span><span class="ident" id="6197355">String</span><span class="op" id="6197361">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197365">return</span>&nbsp;<span class="ident" id="6197372">val</span><span class="op" id="6197375">.</span><span class="ident" id="6197376">String</span><span class="op" id="6197382">(</span><span class="op" id="6197383">)</span><span class="op" id="6197384">,</span>&nbsp;<span class="builtintype" id="6197386">nil</span><span class="op" id="6197389">,</span>&nbsp;<span class="builtintype" id="6197391">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197396">case</span>&nbsp;<span class="ident" id="6197401">reflect</span><span class="op" id="6197408">.</span><span class="ident" id="6197409">Bool</span><span class="op" id="6197413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197417">return</span>&nbsp;<span class="ident" id="6197424">strconv</span><span class="op" id="6197431">.</span><span class="ident" id="6197432">FormatBool</span><span class="op" id="6197442">(</span><span class="ident" id="6197443">val</span><span class="op" id="6197446">.</span><span class="ident" id="6197447">Bool</span><span class="op" id="6197451">(</span><span class="op" id="6197452">)</span><span class="op" id="6197453">)</span><span class="op" id="6197454">,</span>&nbsp;<span class="builtintype" id="6197456">nil</span><span class="op" id="6197459">,</span>&nbsp;<span class="builtintype" id="6197461">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197466">case</span>&nbsp;<span class="ident" id="6197471">reflect</span><span class="op" id="6197478">.</span><span class="ident" id="6197479">Array</span><span class="op" id="6197484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197488">if</span>&nbsp;<span class="ident" id="6197491">typ</span><span class="op" id="6197494">.</span><span class="ident" id="6197495">Elem</span><span class="op" id="6197499">(</span><span class="op" id="6197500">)</span><span class="op" id="6197501">.</span><span class="ident" id="6197502">Kind</span><span class="op" id="6197506">(</span><span class="op" id="6197507">)</span>&nbsp;<span class="op" id="6197509">!=</span>&nbsp;<span class="ident" id="6197512">reflect</span><span class="op" id="6197519">.</span><span class="ident" id="6197520">Uint8</span>&nbsp;<span class="op" id="6197526">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197531">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6197539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197543">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197558">var</span>&nbsp;<span class="ident" id="6197562">bytes</span>&nbsp;<span class="op" id="6197568">[</span><span class="op" id="6197569">]</span><span class="builtintype" id="6197570">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197577">if</span>&nbsp;<span class="ident" id="6197580">val</span><span class="op" id="6197583">.</span><span class="ident" id="6197584">CanAddr</span><span class="op" id="6197591">(</span><span class="op" id="6197592">)</span>&nbsp;<span class="op" id="6197594">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6197599">bytes</span>&nbsp;<span class="op" id="6197605">=</span>&nbsp;<span class="ident" id="6197607">val</span><span class="op" id="6197610">.</span><span class="ident" id="6197611">Slice</span><span class="op" id="6197616">(</span><span class="num" id="6197617">0</span><span class="op" id="6197618">,</span>&nbsp;<span class="ident" id="6197620">val</span><span class="op" id="6197623">.</span><span class="ident" id="6197624">Len</span><span class="op" id="6197627">(</span><span class="op" id="6197628">)</span><span class="op" id="6197629">)</span><span class="op" id="6197630">.</span><span class="ident" id="6197631">Bytes</span><span class="op" id="6197636">(</span><span class="op" id="6197637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6197641">}</span>&nbsp;<span class="keyword" id="6197643">else</span>&nbsp;<span class="op" id="6197648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6197653">bytes</span>&nbsp;<span class="op" id="6197659">=</span>&nbsp;<span class="builtinfunc" id="6197661">make</span><span class="op" id="6197665">(</span><span class="op" id="6197666">[</span><span class="op" id="6197667">]</span><span class="builtintype" id="6197668">byte</span><span class="op" id="6197672">,</span>&nbsp;<span class="ident" id="6197674">val</span><span class="op" id="6197677">.</span><span class="ident" id="6197678">Len</span><span class="op" id="6197681">(</span><span class="op" id="6197682">)</span><span class="op" id="6197683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6197688">reflect</span><span class="op" id="6197695">.</span><span class="ident" id="6197696">Copy</span><span class="op" id="6197700">(</span><span class="ident" id="6197701">reflect</span><span class="op" id="6197708">.</span><span class="ident" id="6197709">ValueOf</span><span class="op" id="6197716">(</span><span class="ident" id="6197717">bytes</span><span class="op" id="6197722">)</span><span class="op" id="6197723">,</span>&nbsp;<span class="ident" id="6197725">val</span><span class="op" id="6197728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6197732">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197736">return</span>&nbsp;<span class="string" id="6197743">&#34;&#34;</span><span class="op" id="6197745">,</span>&nbsp;<span class="ident" id="6197747">bytes</span><span class="op" id="6197752">,</span>&nbsp;<span class="builtintype" id="6197754">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197759">case</span>&nbsp;<span class="ident" id="6197764">reflect</span><span class="op" id="6197771">.</span><span class="ident" id="6197772">Slice</span><span class="op" id="6197777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197781">if</span>&nbsp;<span class="ident" id="6197784">typ</span><span class="op" id="6197787">.</span><span class="ident" id="6197788">Elem</span><span class="op" id="6197792">(</span><span class="op" id="6197793">)</span><span class="op" id="6197794">.</span><span class="ident" id="6197795">Kind</span><span class="op" id="6197799">(</span><span class="op" id="6197800">)</span>&nbsp;<span class="op" id="6197802">!=</span>&nbsp;<span class="ident" id="6197805">reflect</span><span class="op" id="6197812">.</span><span class="ident" id="6197813">Uint8</span>&nbsp;<span class="op" id="6197819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197824">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6197832">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197836">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197848">return</span>&nbsp;<span class="string" id="6197855">&#34;&#34;</span><span class="op" id="6197857">,</span>&nbsp;<span class="ident" id="6197859">val</span><span class="op" id="6197862">.</span><span class="ident" id="6197863">Bytes</span><span class="op" id="6197868">(</span><span class="op" id="6197869">)</span><span class="op" id="6197870">,</span>&nbsp;<span class="builtintype" id="6197872">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6197877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6197880">return</span>&nbsp;<span class="string" id="6197887">&#34;&#34;</span><span class="op" id="6197889">,</span>&nbsp;<span class="builtintype" id="6197891">nil</span><span class="op" id="6197894">,</span>&nbsp;<span class="op" id="6197896">&amp;</span><span class="ident" id="6197897">UnsupportedTypeError</span><span class="op" id="6197917">{</span><span class="ident" id="6197918">typ</span><span class="op" id="6197921">}</span><br>
<span class="lineno"></span><span class="op" id="6197923">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="6197926">var</span>&nbsp;<span class="ident" id="6197930">ddBytes</span>&nbsp;<span class="op" id="6197938">=</span>&nbsp;<span class="op" id="6197940">[</span><span class="op" id="6197941">]</span><span class="builtintype" id="6197942">byte</span><span class="op" id="6197946">(</span><span class="string" id="6197947">&#34;--&#34;</span><span class="op" id="6197951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6197954">func</span>&nbsp;<span class="op" id="6197959">(</span><span class="ident" id="6197960">p</span>&nbsp;<span class="op" id="6197962">*</span><span class="ident" id="6197963">printer</span><span class="op" id="6197970">)</span>&nbsp;<span class="ident" id="6197972">marshalStruct</span><span class="op" id="6197985">(</span><span class="ident" id="6197986">tinfo</span>&nbsp;<span class="op" id="6197992">*</span><span class="ident" id="6197993">typeInfo</span><span class="op" id="6198001">,</span>&nbsp;<span class="ident" id="6198003">val</span>&nbsp;<span class="ident" id="6198007">reflect</span><span class="op" id="6198014">.</span><span class="ident" id="6198015">Value</span><span class="op" id="6198020">)</span>&nbsp;<span class="builtintype" id="6198022">error</span>&nbsp;<span class="op" id="6198028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198031">s</span>&nbsp;<span class="op" id="6198033">:=</span>&nbsp;<span class="ident" id="6198036">parentStack</span><span class="op" id="6198047">{</span><span class="ident" id="6198048">p</span><span class="op" id="6198049">:</span>&nbsp;<span class="ident" id="6198051">p</span><span class="op" id="6198052">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198055">for</span>&nbsp;<span class="ident" id="6198059">i</span>&nbsp;<span class="op" id="6198061">:=</span>&nbsp;<span class="keyword" id="6198064">range</span>&nbsp;<span class="ident" id="6198070">tinfo</span><span class="op" id="6198075">.</span><span class="ident" id="6198076">fields</span>&nbsp;<span class="op" id="6198083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198087">finfo</span>&nbsp;<span class="op" id="6198093">:=</span>&nbsp;<span class="op" id="6198096">&amp;</span><span class="ident" id="6198097">tinfo</span><span class="op" id="6198102">.</span><span class="ident" id="6198103">fields</span><span class="op" id="6198109">[</span><span class="ident" id="6198110">i</span><span class="op" id="6198111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198115">if</span>&nbsp;<span class="ident" id="6198118">finfo</span><span class="op" id="6198123">.</span><span class="ident" id="6198124">flags</span><span class="op" id="6198129">&amp;</span><span class="ident" id="6198130">fAttr</span>&nbsp;<span class="op" id="6198136">!=</span>&nbsp;<span class="num" id="6198139">0</span>&nbsp;<span class="op" id="6198141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198146">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198157">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198161">vf</span>&nbsp;<span class="op" id="6198164">:=</span>&nbsp;<span class="ident" id="6198167">finfo</span><span class="op" id="6198172">.</span><span class="ident" id="6198173">value</span><span class="op" id="6198178">(</span><span class="ident" id="6198179">val</span><span class="op" id="6198182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6198187">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198243">switch</span>&nbsp;<span class="ident" id="6198250">vf</span><span class="op" id="6198252">.</span><span class="ident" id="6198253">Kind</span><span class="op" id="6198257">(</span><span class="op" id="6198258">)</span>&nbsp;<span class="op" id="6198260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198264">case</span>&nbsp;<span class="ident" id="6198269">reflect</span><span class="op" id="6198276">.</span><span class="ident" id="6198277">Ptr</span><span class="op" id="6198280">,</span>&nbsp;<span class="ident" id="6198282">reflect</span><span class="op" id="6198289">.</span><span class="ident" id="6198290">Interface</span><span class="op" id="6198299">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198304">if</span>&nbsp;<span class="op" id="6198307">!</span><span class="ident" id="6198308">vf</span><span class="op" id="6198310">.</span><span class="ident" id="6198311">IsNil</span><span class="op" id="6198316">(</span><span class="op" id="6198317">)</span>&nbsp;<span class="op" id="6198319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198325">vf</span>&nbsp;<span class="op" id="6198328">=</span>&nbsp;<span class="ident" id="6198330">vf</span><span class="op" id="6198332">.</span><span class="ident" id="6198333">Elem</span><span class="op" id="6198337">(</span><span class="op" id="6198338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198352">switch</span>&nbsp;<span class="ident" id="6198359">finfo</span><span class="op" id="6198364">.</span><span class="ident" id="6198365">flags</span>&nbsp;<span class="op" id="6198371">&amp;</span>&nbsp;<span class="ident" id="6198373">fMode</span>&nbsp;<span class="op" id="6198379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198383">case</span>&nbsp;<span class="ident" id="6198388">fCharData</span><span class="op" id="6198397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198402">if</span>&nbsp;<span class="ident" id="6198405">vf</span><span class="op" id="6198407">.</span><span class="ident" id="6198408">CanInterface</span><span class="op" id="6198420">(</span><span class="op" id="6198421">)</span>&nbsp;<span class="op" id="6198423">&amp;&amp;</span>&nbsp;<span class="ident" id="6198426">vf</span><span class="op" id="6198428">.</span><span class="ident" id="6198429">Type</span><span class="op" id="6198433">(</span><span class="op" id="6198434">)</span><span class="op" id="6198435">.</span><span class="ident" id="6198436">Implements</span><span class="op" id="6198446">(</span><span class="ident" id="6198447">textMarshalerType</span><span class="op" id="6198464">)</span>&nbsp;<span class="op" id="6198466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198472">data</span><span class="op" id="6198476">,</span>&nbsp;<span class="ident" id="6198478">err</span>&nbsp;<span class="op" id="6198482">:=</span>&nbsp;<span class="ident" id="6198485">vf</span><span class="op" id="6198487">.</span><span class="ident" id="6198488">Interface</span><span class="op" id="6198497">(</span><span class="op" id="6198498">)</span><span class="op" id="6198499">.</span><span class="op" id="6198500">(</span><span class="ident" id="6198501">encoding</span><span class="op" id="6198509">.</span><span class="ident" id="6198510">TextMarshaler</span><span class="op" id="6198523">)</span><span class="op" id="6198524">.</span><span class="ident" id="6198525">MarshalText</span><span class="op" id="6198536">(</span><span class="op" id="6198537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198543">if</span>&nbsp;<span class="ident" id="6198546">err</span>&nbsp;<span class="op" id="6198550">!=</span>&nbsp;<span class="builtintype" id="6198553">nil</span>&nbsp;<span class="op" id="6198557">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198564">return</span>&nbsp;<span class="ident" id="6198571">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198585">Escape</span><span class="op" id="6198591">(</span><span class="ident" id="6198592">p</span><span class="op" id="6198593">,</span>&nbsp;<span class="ident" id="6198595">data</span><span class="op" id="6198599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198605">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198617">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198622">if</span>&nbsp;<span class="ident" id="6198625">vf</span><span class="op" id="6198627">.</span><span class="ident" id="6198628">CanAddr</span><span class="op" id="6198635">(</span><span class="op" id="6198636">)</span>&nbsp;<span class="op" id="6198638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198644">pv</span>&nbsp;<span class="op" id="6198647">:=</span>&nbsp;<span class="ident" id="6198650">vf</span><span class="op" id="6198652">.</span><span class="ident" id="6198653">Addr</span><span class="op" id="6198657">(</span><span class="op" id="6198658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198664">if</span>&nbsp;<span class="ident" id="6198667">pv</span><span class="op" id="6198669">.</span><span class="ident" id="6198670">CanInterface</span><span class="op" id="6198682">(</span><span class="op" id="6198683">)</span>&nbsp;<span class="op" id="6198685">&amp;&amp;</span>&nbsp;<span class="ident" id="6198688">pv</span><span class="op" id="6198690">.</span><span class="ident" id="6198691">Type</span><span class="op" id="6198695">(</span><span class="op" id="6198696">)</span><span class="op" id="6198697">.</span><span class="ident" id="6198698">Implements</span><span class="op" id="6198708">(</span><span class="ident" id="6198709">textMarshalerType</span><span class="op" id="6198726">)</span>&nbsp;<span class="op" id="6198728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198735">data</span><span class="op" id="6198739">,</span>&nbsp;<span class="ident" id="6198741">err</span>&nbsp;<span class="op" id="6198745">:=</span>&nbsp;<span class="ident" id="6198748">pv</span><span class="op" id="6198750">.</span><span class="ident" id="6198751">Interface</span><span class="op" id="6198760">(</span><span class="op" id="6198761">)</span><span class="op" id="6198762">.</span><span class="op" id="6198763">(</span><span class="ident" id="6198764">encoding</span><span class="op" id="6198772">.</span><span class="ident" id="6198773">TextMarshaler</span><span class="op" id="6198786">)</span><span class="op" id="6198787">.</span><span class="ident" id="6198788">MarshalText</span><span class="op" id="6198799">(</span><span class="op" id="6198800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198807">if</span>&nbsp;<span class="ident" id="6198810">err</span>&nbsp;<span class="op" id="6198814">!=</span>&nbsp;<span class="builtintype" id="6198817">nil</span>&nbsp;<span class="op" id="6198821">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198829">return</span>&nbsp;<span class="ident" id="6198836">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6198852">Escape</span><span class="op" id="6198858">(</span><span class="ident" id="6198859">p</span><span class="op" id="6198860">,</span>&nbsp;<span class="ident" id="6198862">data</span><span class="op" id="6198866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198873">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198886">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6198891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198896">var</span>&nbsp;<span class="ident" id="6198900">scratch</span>&nbsp;<span class="op" id="6198908">[</span><span class="num" id="6198909">64</span><span class="op" id="6198911">]</span><span class="builtintype" id="6198912">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198920">switch</span>&nbsp;<span class="ident" id="6198927">vf</span><span class="op" id="6198929">.</span><span class="ident" id="6198930">Kind</span><span class="op" id="6198934">(</span><span class="op" id="6198935">)</span>&nbsp;<span class="op" id="6198937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6198942">case</span>&nbsp;<span class="ident" id="6198947">reflect</span><span class="op" id="6198954">.</span><span class="ident" id="6198955">Int</span><span class="op" id="6198958">,</span>&nbsp;<span class="ident" id="6198960">reflect</span><span class="op" id="6198967">.</span><span class="ident" id="6198968">Int8</span><span class="op" id="6198972">,</span>&nbsp;<span class="ident" id="6198974">reflect</span><span class="op" id="6198981">.</span><span class="ident" id="6198982">Int16</span><span class="op" id="6198987">,</span>&nbsp;<span class="ident" id="6198989">reflect</span><span class="op" id="6198996">.</span><span class="ident" id="6198997">Int32</span><span class="op" id="6199002">,</span>&nbsp;<span class="ident" id="6199004">reflect</span><span class="op" id="6199011">.</span><span class="ident" id="6199012">Int64</span><span class="op" id="6199017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199023">Escape</span><span class="op" id="6199029">(</span><span class="ident" id="6199030">p</span><span class="op" id="6199031">,</span>&nbsp;<span class="ident" id="6199033">strconv</span><span class="op" id="6199040">.</span><span class="ident" id="6199041">AppendInt</span><span class="op" id="6199050">(</span><span class="ident" id="6199051">scratch</span><span class="op" id="6199058">[</span><span class="op" id="6199059">:</span><span class="num" id="6199060">0</span><span class="op" id="6199061">]</span><span class="op" id="6199062">,</span>&nbsp;<span class="ident" id="6199064">vf</span><span class="op" id="6199066">.</span><span class="ident" id="6199067">Int</span><span class="op" id="6199070">(</span><span class="op" id="6199071">)</span><span class="op" id="6199072">,</span>&nbsp;<span class="num" id="6199074">10</span><span class="op" id="6199076">)</span><span class="op" id="6199077">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199082">case</span>&nbsp;<span class="ident" id="6199087">reflect</span><span class="op" id="6199094">.</span><span class="ident" id="6199095">Uint</span><span class="op" id="6199099">,</span>&nbsp;<span class="ident" id="6199101">reflect</span><span class="op" id="6199108">.</span><span class="ident" id="6199109">Uint8</span><span class="op" id="6199114">,</span>&nbsp;<span class="ident" id="6199116">reflect</span><span class="op" id="6199123">.</span><span class="ident" id="6199124">Uint16</span><span class="op" id="6199130">,</span>&nbsp;<span class="ident" id="6199132">reflect</span><span class="op" id="6199139">.</span><span class="ident" id="6199140">Uint32</span><span class="op" id="6199146">,</span>&nbsp;<span class="ident" id="6199148">reflect</span><span class="op" id="6199155">.</span><span class="ident" id="6199156">Uint64</span><span class="op" id="6199162">,</span>&nbsp;<span class="ident" id="6199164">reflect</span><span class="op" id="6199171">.</span><span class="ident" id="6199172">Uintptr</span><span class="op" id="6199179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199185">Escape</span><span class="op" id="6199191">(</span><span class="ident" id="6199192">p</span><span class="op" id="6199193">,</span>&nbsp;<span class="ident" id="6199195">strconv</span><span class="op" id="6199202">.</span><span class="ident" id="6199203">AppendUint</span><span class="op" id="6199213">(</span><span class="ident" id="6199214">scratch</span><span class="op" id="6199221">[</span><span class="op" id="6199222">:</span><span class="num" id="6199223">0</span><span class="op" id="6199224">]</span><span class="op" id="6199225">,</span>&nbsp;<span class="ident" id="6199227">vf</span><span class="op" id="6199229">.</span><span class="ident" id="6199230">Uint</span><span class="op" id="6199234">(</span><span class="op" id="6199235">)</span><span class="op" id="6199236">,</span>&nbsp;<span class="num" id="6199238">10</span><span class="op" id="6199240">)</span><span class="op" id="6199241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199246">case</span>&nbsp;<span class="ident" id="6199251">reflect</span><span class="op" id="6199258">.</span><span class="ident" id="6199259">Float32</span><span class="op" id="6199266">,</span>&nbsp;<span class="ident" id="6199268">reflect</span><span class="op" id="6199275">.</span><span class="ident" id="6199276">Float64</span><span class="op" id="6199283">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199289">Escape</span><span class="op" id="6199295">(</span><span class="ident" id="6199296">p</span><span class="op" id="6199297">,</span>&nbsp;<span class="ident" id="6199299">strconv</span><span class="op" id="6199306">.</span><span class="ident" id="6199307">AppendFloat</span><span class="op" id="6199318">(</span><span class="ident" id="6199319">scratch</span><span class="op" id="6199326">[</span><span class="op" id="6199327">:</span><span class="num" id="6199328">0</span><span class="op" id="6199329">]</span><span class="op" id="6199330">,</span>&nbsp;<span class="ident" id="6199332">vf</span><span class="op" id="6199334">.</span><span class="ident" id="6199335">Float</span><span class="op" id="6199340">(</span><span class="op" id="6199341">)</span><span class="op" id="6199342">,</span>&nbsp;<span class="string" id="6199344">&#39;g&#39;</span><span class="op" id="6199347">,</span>&nbsp;<span class="op" id="6199349">-</span><span class="num" id="6199350">1</span><span class="op" id="6199351">,</span>&nbsp;<span class="ident" id="6199353">vf</span><span class="op" id="6199355">.</span><span class="ident" id="6199356">Type</span><span class="op" id="6199360">(</span><span class="op" id="6199361">)</span><span class="op" id="6199362">.</span><span class="ident" id="6199363">Bits</span><span class="op" id="6199367">(</span><span class="op" id="6199368">)</span><span class="op" id="6199369">)</span><span class="op" id="6199370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199375">case</span>&nbsp;<span class="ident" id="6199380">reflect</span><span class="op" id="6199387">.</span><span class="ident" id="6199388">Bool</span><span class="op" id="6199392">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199398">Escape</span><span class="op" id="6199404">(</span><span class="ident" id="6199405">p</span><span class="op" id="6199406">,</span>&nbsp;<span class="ident" id="6199408">strconv</span><span class="op" id="6199415">.</span><span class="ident" id="6199416">AppendBool</span><span class="op" id="6199426">(</span><span class="ident" id="6199427">scratch</span><span class="op" id="6199434">[</span><span class="op" id="6199435">:</span><span class="num" id="6199436">0</span><span class="op" id="6199437">]</span><span class="op" id="6199438">,</span>&nbsp;<span class="ident" id="6199440">vf</span><span class="op" id="6199442">.</span><span class="ident" id="6199443">Bool</span><span class="op" id="6199447">(</span><span class="op" id="6199448">)</span><span class="op" id="6199449">)</span><span class="op" id="6199450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199455">case</span>&nbsp;<span class="ident" id="6199460">reflect</span><span class="op" id="6199467">.</span><span class="ident" id="6199468">String</span><span class="op" id="6199474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199480">if</span>&nbsp;<span class="ident" id="6199483">err</span>&nbsp;<span class="op" id="6199487">:=</span>&nbsp;<span class="ident" id="6199490">EscapeText</span><span class="op" id="6199500">(</span><span class="ident" id="6199501">p</span><span class="op" id="6199502">,</span>&nbsp;<span class="op" id="6199504">[</span><span class="op" id="6199505">]</span><span class="builtintype" id="6199506">byte</span><span class="op" id="6199510">(</span><span class="ident" id="6199511">vf</span><span class="op" id="6199513">.</span><span class="ident" id="6199514">String</span><span class="op" id="6199520">(</span><span class="op" id="6199521">)</span><span class="op" id="6199522">)</span><span class="op" id="6199523">)</span><span class="op" id="6199524">;</span>&nbsp;<span class="ident" id="6199526">err</span>&nbsp;<span class="op" id="6199530">!=</span>&nbsp;<span class="builtintype" id="6199533">nil</span>&nbsp;<span class="op" id="6199537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199544">return</span>&nbsp;<span class="ident" id="6199551">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199559">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199564">case</span>&nbsp;<span class="ident" id="6199569">reflect</span><span class="op" id="6199576">.</span><span class="ident" id="6199577">Slice</span><span class="op" id="6199582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199588">if</span>&nbsp;<span class="ident" id="6199591">elem</span><span class="op" id="6199595">,</span>&nbsp;<span class="ident" id="6199597">ok</span>&nbsp;<span class="op" id="6199600">:=</span>&nbsp;<span class="ident" id="6199603">vf</span><span class="op" id="6199605">.</span><span class="ident" id="6199606">Interface</span><span class="op" id="6199615">(</span><span class="op" id="6199616">)</span><span class="op" id="6199617">.</span><span class="op" id="6199618">(</span><span class="op" id="6199619">[</span><span class="op" id="6199620">]</span><span class="builtintype" id="6199621">byte</span><span class="op" id="6199625">)</span><span class="op" id="6199626">;</span>&nbsp;<span class="ident" id="6199628">ok</span>&nbsp;<span class="op" id="6199631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199638">if</span>&nbsp;<span class="ident" id="6199641">err</span>&nbsp;<span class="op" id="6199645">:=</span>&nbsp;<span class="ident" id="6199648">EscapeText</span><span class="op" id="6199658">(</span><span class="ident" id="6199659">p</span><span class="op" id="6199660">,</span>&nbsp;<span class="ident" id="6199662">elem</span><span class="op" id="6199666">)</span><span class="op" id="6199667">;</span>&nbsp;<span class="ident" id="6199669">err</span>&nbsp;<span class="op" id="6199673">!=</span>&nbsp;<span class="builtintype" id="6199676">nil</span>&nbsp;<span class="op" id="6199680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199688">return</span>&nbsp;<span class="ident" id="6199695">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199704">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199720">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199732">case</span>&nbsp;<span class="ident" id="6199737">fComment</span><span class="op" id="6199745">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199750">k</span>&nbsp;<span class="op" id="6199752">:=</span>&nbsp;<span class="ident" id="6199755">vf</span><span class="op" id="6199757">.</span><span class="ident" id="6199758">Kind</span><span class="op" id="6199762">(</span><span class="op" id="6199763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199768">if</span>&nbsp;<span class="op" id="6199771">!</span><span class="op" id="6199772">(</span><span class="ident" id="6199773">k</span>&nbsp;<span class="op" id="6199775">==</span>&nbsp;<span class="ident" id="6199778">reflect</span><span class="op" id="6199785">.</span><span class="ident" id="6199786">String</span>&nbsp;<span class="op" id="6199793">||</span>&nbsp;<span class="ident" id="6199796">k</span>&nbsp;<span class="op" id="6199798">==</span>&nbsp;<span class="ident" id="6199801">reflect</span><span class="op" id="6199808">.</span><span class="ident" id="6199809">Slice</span>&nbsp;<span class="op" id="6199815">&amp;&amp;</span>&nbsp;<span class="ident" id="6199818">vf</span><span class="op" id="6199820">.</span><span class="ident" id="6199821">Type</span><span class="op" id="6199825">(</span><span class="op" id="6199826">)</span><span class="op" id="6199827">.</span><span class="ident" id="6199828">Elem</span><span class="op" id="6199832">(</span><span class="op" id="6199833">)</span><span class="op" id="6199834">.</span><span class="ident" id="6199835">Kind</span><span class="op" id="6199839">(</span><span class="op" id="6199840">)</span>&nbsp;<span class="op" id="6199842">==</span>&nbsp;<span class="ident" id="6199845">reflect</span><span class="op" id="6199852">.</span><span class="ident" id="6199853">Uint8</span><span class="op" id="6199858">)</span>&nbsp;<span class="op" id="6199860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199866">return</span>&nbsp;<span class="ident" id="6199873">fmt</span><span class="op" id="6199876">.</span><span class="ident" id="6199877">Errorf</span><span class="op" id="6199883">(</span><span class="string" id="6199884">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="6199923">,</span>&nbsp;<span class="ident" id="6199925">val</span><span class="op" id="6199928">.</span><span class="ident" id="6199929">Type</span><span class="op" id="6199933">(</span><span class="op" id="6199934">)</span><span class="op" id="6199935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199945">if</span>&nbsp;<span class="ident" id="6199948">vf</span><span class="op" id="6199950">.</span><span class="ident" id="6199951">Len</span><span class="op" id="6199954">(</span><span class="op" id="6199955">)</span>&nbsp;<span class="op" id="6199957">==</span>&nbsp;<span class="num" id="6199960">0</span>&nbsp;<span class="op" id="6199962">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6199968">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6199980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6199985">p</span><span class="op" id="6199986">.</span><span class="ident" id="6199987">writeIndent</span><span class="op" id="6199998">(</span><span class="num" id="6199999">0</span><span class="op" id="6200000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200005">p</span><span class="op" id="6200006">.</span><span class="ident" id="6200007">WriteString</span><span class="op" id="6200018">(</span><span class="string" id="6200019">&#34;&lt;!--&#34;</span><span class="op" id="6200025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200030">dashDash</span>&nbsp;<span class="op" id="6200039">:=</span>&nbsp;<span class="builtintype" id="6200042">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200051">dashLast</span>&nbsp;<span class="op" id="6200060">:=</span>&nbsp;<span class="builtintype" id="6200063">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200072">switch</span>&nbsp;<span class="ident" id="6200079">k</span>&nbsp;<span class="op" id="6200081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200086">case</span>&nbsp;<span class="ident" id="6200091">reflect</span><span class="op" id="6200098">.</span><span class="ident" id="6200099">String</span><span class="op" id="6200105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200111">s</span>&nbsp;<span class="op" id="6200113">:=</span>&nbsp;<span class="ident" id="6200116">vf</span><span class="op" id="6200118">.</span><span class="ident" id="6200119">String</span><span class="op" id="6200125">(</span><span class="op" id="6200126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200132">dashDash</span>&nbsp;<span class="op" id="6200141">=</span>&nbsp;<span class="ident" id="6200143">strings</span><span class="op" id="6200150">.</span><span class="ident" id="6200151">Index</span><span class="op" id="6200156">(</span><span class="ident" id="6200157">s</span><span class="op" id="6200158">,</span>&nbsp;<span class="string" id="6200160">&#34;--&#34;</span><span class="op" id="6200164">)</span>&nbsp;<span class="op" id="6200166">&gt;=</span>&nbsp;<span class="num" id="6200169">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200175">dashLast</span>&nbsp;<span class="op" id="6200184">=</span>&nbsp;<span class="ident" id="6200186">s</span><span class="op" id="6200187">[</span><span class="builtinfunc" id="6200188">len</span><span class="op" id="6200191">(</span><span class="ident" id="6200192">s</span><span class="op" id="6200193">)</span><span class="op" id="6200194">-</span><span class="num" id="6200195">1</span><span class="op" id="6200196">]</span>&nbsp;<span class="op" id="6200198">==</span>&nbsp;<span class="string" id="6200201">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200209">if</span>&nbsp;<span class="op" id="6200212">!</span><span class="ident" id="6200213">dashDash</span>&nbsp;<span class="op" id="6200222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200229">p</span><span class="op" id="6200230">.</span><span class="ident" id="6200231">WriteString</span><span class="op" id="6200242">(</span><span class="ident" id="6200243">s</span><span class="op" id="6200244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200255">case</span>&nbsp;<span class="ident" id="6200260">reflect</span><span class="op" id="6200267">.</span><span class="ident" id="6200268">Slice</span><span class="op" id="6200273">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200279">b</span>&nbsp;<span class="op" id="6200281">:=</span>&nbsp;<span class="ident" id="6200284">vf</span><span class="op" id="6200286">.</span><span class="ident" id="6200287">Bytes</span><span class="op" id="6200292">(</span><span class="op" id="6200293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200299">dashDash</span>&nbsp;<span class="op" id="6200308">=</span>&nbsp;<span class="ident" id="6200310">bytes</span><span class="op" id="6200315">.</span><span class="ident" id="6200316">Index</span><span class="op" id="6200321">(</span><span class="ident" id="6200322">b</span><span class="op" id="6200323">,</span>&nbsp;<span class="ident" id="6200325">ddBytes</span><span class="op" id="6200332">)</span>&nbsp;<span class="op" id="6200334">&gt;=</span>&nbsp;<span class="num" id="6200337">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200343">dashLast</span>&nbsp;<span class="op" id="6200352">=</span>&nbsp;<span class="ident" id="6200354">b</span><span class="op" id="6200355">[</span><span class="builtinfunc" id="6200356">len</span><span class="op" id="6200359">(</span><span class="ident" id="6200360">b</span><span class="op" id="6200361">)</span><span class="op" id="6200362">-</span><span class="num" id="6200363">1</span><span class="op" id="6200364">]</span>&nbsp;<span class="op" id="6200366">==</span>&nbsp;<span class="string" id="6200369">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200377">if</span>&nbsp;<span class="op" id="6200380">!</span><span class="ident" id="6200381">dashDash</span>&nbsp;<span class="op" id="6200390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200397">p</span><span class="op" id="6200398">.</span><span class="ident" id="6200399">Write</span><span class="op" id="6200404">(</span><span class="ident" id="6200405">b</span><span class="op" id="6200406">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200417">default</span><span class="op" id="6200424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6200430">panic</span><span class="op" id="6200435">(</span><span class="string" id="6200436">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="6200450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200460">if</span>&nbsp;<span class="ident" id="6200463">dashDash</span>&nbsp;<span class="op" id="6200472">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200478">return</span>&nbsp;<span class="ident" id="6200485">fmt</span><span class="op" id="6200488">.</span><span class="ident" id="6200489">Errorf</span><span class="op" id="6200495">(</span><span class="string" id="6200496">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="6200533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200543">if</span>&nbsp;<span class="ident" id="6200546">dashLast</span>&nbsp;<span class="op" id="6200555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6200561">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200611">p</span><span class="op" id="6200612">.</span><span class="ident" id="6200613">WriteByte</span><span class="op" id="6200622">(</span><span class="string" id="6200623">&#39;&nbsp;&#39;</span><span class="op" id="6200626">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200636">p</span><span class="op" id="6200637">.</span><span class="ident" id="6200638">WriteString</span><span class="op" id="6200649">(</span><span class="string" id="6200650">&#34;--&gt;&#34;</span><span class="op" id="6200655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200660">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200672">case</span>&nbsp;<span class="ident" id="6200677">fInnerXml</span><span class="op" id="6200686">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200691">iface</span>&nbsp;<span class="op" id="6200697">:=</span>&nbsp;<span class="ident" id="6200700">vf</span><span class="op" id="6200702">.</span><span class="ident" id="6200703">Interface</span><span class="op" id="6200712">(</span><span class="op" id="6200713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200718">switch</span>&nbsp;<span class="ident" id="6200725">raw</span>&nbsp;<span class="op" id="6200729">:=</span>&nbsp;<span class="ident" id="6200732">iface</span><span class="op" id="6200737">.</span><span class="op" id="6200738">(</span><span class="keyword" id="6200739">type</span><span class="op" id="6200743">)</span>&nbsp;<span class="op" id="6200745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200750">case</span>&nbsp;<span class="op" id="6200755">[</span><span class="op" id="6200756">]</span><span class="builtintype" id="6200757">byte</span><span class="op" id="6200761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200767">p</span><span class="op" id="6200768">.</span><span class="ident" id="6200769">Write</span><span class="op" id="6200774">(</span><span class="ident" id="6200775">raw</span><span class="op" id="6200778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200784">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200796">case</span>&nbsp;<span class="builtintype" id="6200801">string</span><span class="op" id="6200807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6200813">p</span><span class="op" id="6200814">.</span><span class="ident" id="6200815">WriteString</span><span class="op" id="6200826">(</span><span class="ident" id="6200827">raw</span><span class="op" id="6200830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200836">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200853">case</span>&nbsp;<span class="ident" id="6200858">fElement</span><span class="op" id="6200866">,</span>&nbsp;<span class="ident" id="6200868">fElement</span>&nbsp;<span class="op" id="6200877">|</span>&nbsp;<span class="ident" id="6200879">fAny</span><span class="op" id="6200883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200888">if</span>&nbsp;<span class="ident" id="6200891">err</span>&nbsp;<span class="op" id="6200895">:=</span>&nbsp;<span class="ident" id="6200898">s</span><span class="op" id="6200899">.</span><span class="ident" id="6200900">trim</span><span class="op" id="6200904">(</span><span class="ident" id="6200905">finfo</span><span class="op" id="6200910">.</span><span class="ident" id="6200911">parents</span><span class="op" id="6200918">)</span><span class="op" id="6200919">;</span>&nbsp;<span class="ident" id="6200921">err</span>&nbsp;<span class="op" id="6200925">!=</span>&nbsp;<span class="builtintype" id="6200928">nil</span>&nbsp;<span class="op" id="6200932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200938">return</span>&nbsp;<span class="ident" id="6200945">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6200952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6200957">if</span>&nbsp;<span class="builtinfunc" id="6200960">len</span><span class="op" id="6200963">(</span><span class="ident" id="6200964">finfo</span><span class="op" id="6200969">.</span><span class="ident" id="6200970">parents</span><span class="op" id="6200977">)</span>&nbsp;<span class="op" id="6200979">&gt;</span>&nbsp;<span class="builtinfunc" id="6200981">len</span><span class="op" id="6200984">(</span><span class="ident" id="6200985">s</span><span class="op" id="6200986">.</span><span class="ident" id="6200987">stack</span><span class="op" id="6200992">)</span>&nbsp;<span class="op" id="6200994">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201000">if</span>&nbsp;<span class="ident" id="6201003">vf</span><span class="op" id="6201005">.</span><span class="ident" id="6201006">Kind</span><span class="op" id="6201010">(</span><span class="op" id="6201011">)</span>&nbsp;<span class="op" id="6201013">!=</span>&nbsp;<span class="ident" id="6201016">reflect</span><span class="op" id="6201023">.</span><span class="ident" id="6201024">Ptr</span>&nbsp;<span class="op" id="6201028">&amp;&amp;</span>&nbsp;<span class="ident" id="6201031">vf</span><span class="op" id="6201033">.</span><span class="ident" id="6201034">Kind</span><span class="op" id="6201038">(</span><span class="op" id="6201039">)</span>&nbsp;<span class="op" id="6201041">!=</span>&nbsp;<span class="ident" id="6201044">reflect</span><span class="op" id="6201051">.</span><span class="ident" id="6201052">Interface</span>&nbsp;<span class="op" id="6201062">||</span>&nbsp;<span class="op" id="6201065">!</span><span class="ident" id="6201066">vf</span><span class="op" id="6201068">.</span><span class="ident" id="6201069">IsNil</span><span class="op" id="6201074">(</span><span class="op" id="6201075">)</span>&nbsp;<span class="op" id="6201077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201084">if</span>&nbsp;<span class="ident" id="6201087">err</span>&nbsp;<span class="op" id="6201091">:=</span>&nbsp;<span class="ident" id="6201094">s</span><span class="op" id="6201095">.</span><span class="ident" id="6201096">push</span><span class="op" id="6201100">(</span><span class="ident" id="6201101">finfo</span><span class="op" id="6201106">.</span><span class="ident" id="6201107">parents</span><span class="op" id="6201114">[</span><span class="builtinfunc" id="6201115">len</span><span class="op" id="6201118">(</span><span class="ident" id="6201119">s</span><span class="op" id="6201120">.</span><span class="ident" id="6201121">stack</span><span class="op" id="6201126">)</span><span class="op" id="6201127">:</span><span class="op" id="6201128">]</span><span class="op" id="6201129">)</span><span class="op" id="6201130">;</span>&nbsp;<span class="ident" id="6201132">err</span>&nbsp;<span class="op" id="6201136">!=</span>&nbsp;<span class="builtintype" id="6201139">nil</span>&nbsp;<span class="op" id="6201143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201151">return</span>&nbsp;<span class="ident" id="6201158">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201173">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201186">if</span>&nbsp;<span class="ident" id="6201189">err</span>&nbsp;<span class="op" id="6201193">:=</span>&nbsp;<span class="ident" id="6201196">p</span><span class="op" id="6201197">.</span><span class="ident" id="6201198">marshalValue</span><span class="op" id="6201210">(</span><span class="ident" id="6201211">vf</span><span class="op" id="6201213">,</span>&nbsp;<span class="ident" id="6201215">finfo</span><span class="op" id="6201220">,</span>&nbsp;<span class="builtintype" id="6201222">nil</span><span class="op" id="6201225">)</span><span class="op" id="6201226">;</span>&nbsp;<span class="ident" id="6201228">err</span>&nbsp;<span class="op" id="6201232">!=</span>&nbsp;<span class="builtintype" id="6201235">nil</span>&nbsp;<span class="op" id="6201239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201244">return</span>&nbsp;<span class="ident" id="6201251">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201257">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201263">s</span><span class="op" id="6201264">.</span><span class="ident" id="6201265">trim</span><span class="op" id="6201269">(</span><span class="builtintype" id="6201270">nil</span><span class="op" id="6201273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201276">return</span>&nbsp;<span class="ident" id="6201283">p</span><span class="op" id="6201284">.</span><span class="ident" id="6201285">cachedWriteError</span><span class="op" id="6201301">(</span><span class="op" id="6201302">)</span><br>
<span class="lineno"></span><span class="op" id="6201304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="6201307">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="6201355">func</span>&nbsp;<span class="op" id="6201360">(</span><span class="ident" id="6201361">p</span>&nbsp;<span class="op" id="6201363">*</span><span class="ident" id="6201364">printer</span><span class="op" id="6201371">)</span>&nbsp;<span class="ident" id="6201373">cachedWriteError</span><span class="op" id="6201389">(</span><span class="op" id="6201390">)</span>&nbsp;<span class="builtintype" id="6201392">error</span>&nbsp;<span class="op" id="6201398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201401">_</span><span class="op" id="6201402">,</span>&nbsp;<span class="ident" id="6201404">err</span>&nbsp;<span class="op" id="6201408">:=</span>&nbsp;<span class="ident" id="6201411">p</span><span class="op" id="6201412">.</span><span class="ident" id="6201413">Write</span><span class="op" id="6201418">(</span><span class="builtintype" id="6201419">nil</span><span class="op" id="6201422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201425">return</span>&nbsp;<span class="ident" id="6201432">err</span><br>
<span class="lineno"></span><span class="op" id="6201436">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="6201439">func</span>&nbsp;<span class="op" id="6201444">(</span><span class="ident" id="6201445">p</span>&nbsp;<span class="op" id="6201447">*</span><span class="ident" id="6201448">printer</span><span class="op" id="6201455">)</span>&nbsp;<span class="ident" id="6201457">writeIndent</span><span class="op" id="6201468">(</span><span class="ident" id="6201469">depthDelta</span>&nbsp;<span class="builtintype" id="6201480">int</span><span class="op" id="6201483">)</span>&nbsp;<span class="op" id="6201485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201488">if</span>&nbsp;<span class="builtinfunc" id="6201491">len</span><span class="op" id="6201494">(</span><span class="ident" id="6201495">p</span><span class="op" id="6201496">.</span><span class="ident" id="6201497">prefix</span><span class="op" id="6201503">)</span>&nbsp;<span class="op" id="6201505">==</span>&nbsp;<span class="num" id="6201508">0</span>&nbsp;<span class="op" id="6201510">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6201513">len</span><span class="op" id="6201516">(</span><span class="ident" id="6201517">p</span><span class="op" id="6201518">.</span><span class="ident" id="6201519">indent</span><span class="op" id="6201525">)</span>&nbsp;<span class="op" id="6201527">==</span>&nbsp;<span class="num" id="6201530">0</span>&nbsp;<span class="op" id="6201532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201544">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201547">if</span>&nbsp;<span class="ident" id="6201550">depthDelta</span>&nbsp;<span class="op" id="6201561">&lt;</span>&nbsp;<span class="num" id="6201563">0</span>&nbsp;<span class="op" id="6201565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201569">p</span><span class="op" id="6201570">.</span><span class="ident" id="6201571">depth</span><span class="op" id="6201576">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201581">if</span>&nbsp;<span class="ident" id="6201584">p</span><span class="op" id="6201585">.</span><span class="ident" id="6201586">indentedIn</span>&nbsp;<span class="op" id="6201597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201602">p</span><span class="op" id="6201603">.</span><span class="ident" id="6201604">indentedIn</span>&nbsp;<span class="op" id="6201615">=</span>&nbsp;<span class="builtintype" id="6201617">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201626">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201639">p</span><span class="op" id="6201640">.</span><span class="ident" id="6201641">indentedIn</span>&nbsp;<span class="op" id="6201652">=</span>&nbsp;<span class="builtintype" id="6201654">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201664">if</span>&nbsp;<span class="ident" id="6201667">p</span><span class="op" id="6201668">.</span><span class="ident" id="6201669">putNewline</span>&nbsp;<span class="op" id="6201680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201684">p</span><span class="op" id="6201685">.</span><span class="ident" id="6201686">WriteByte</span><span class="op" id="6201695">(</span><span class="string" id="6201696">&#39;\n&#39;</span><span class="op" id="6201700">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201703">}</span>&nbsp;<span class="keyword" id="6201705">else</span>&nbsp;<span class="op" id="6201710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201714">p</span><span class="op" id="6201715">.</span><span class="ident" id="6201716">putNewline</span>&nbsp;<span class="op" id="6201727">=</span>&nbsp;<span class="builtintype" id="6201729">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201738">if</span>&nbsp;<span class="builtinfunc" id="6201741">len</span><span class="op" id="6201744">(</span><span class="ident" id="6201745">p</span><span class="op" id="6201746">.</span><span class="ident" id="6201747">prefix</span><span class="op" id="6201753">)</span>&nbsp;<span class="op" id="6201755">&gt;</span>&nbsp;<span class="num" id="6201757">0</span>&nbsp;<span class="op" id="6201759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201763">p</span><span class="op" id="6201764">.</span><span class="ident" id="6201765">WriteString</span><span class="op" id="6201776">(</span><span class="ident" id="6201777">p</span><span class="op" id="6201778">.</span><span class="ident" id="6201779">prefix</span><span class="op" id="6201785">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201791">if</span>&nbsp;<span class="builtinfunc" id="6201794">len</span><span class="op" id="6201797">(</span><span class="ident" id="6201798">p</span><span class="op" id="6201799">.</span><span class="ident" id="6201800">indent</span><span class="op" id="6201806">)</span>&nbsp;<span class="op" id="6201808">&gt;</span>&nbsp;<span class="num" id="6201810">0</span>&nbsp;<span class="op" id="6201812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201816">for</span>&nbsp;<span class="ident" id="6201820">i</span>&nbsp;<span class="op" id="6201822">:=</span>&nbsp;<span class="num" id="6201825">0</span><span class="op" id="6201826">;</span>&nbsp;<span class="ident" id="6201828">i</span>&nbsp;<span class="op" id="6201830">&lt;</span>&nbsp;<span class="ident" id="6201832">p</span><span class="op" id="6201833">.</span><span class="ident" id="6201834">depth</span><span class="op" id="6201839">;</span>&nbsp;<span class="ident" id="6201841">i</span><span class="op" id="6201842">++</span>&nbsp;<span class="op" id="6201845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201850">p</span><span class="op" id="6201851">.</span><span class="ident" id="6201852">WriteString</span><span class="op" id="6201863">(</span><span class="ident" id="6201864">p</span><span class="op" id="6201865">.</span><span class="ident" id="6201866">indent</span><span class="op" id="6201872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201876">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6201882">if</span>&nbsp;<span class="ident" id="6201885">depthDelta</span>&nbsp;<span class="op" id="6201896">&gt;</span>&nbsp;<span class="num" id="6201898">0</span>&nbsp;<span class="op" id="6201900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201904">p</span><span class="op" id="6201905">.</span><span class="ident" id="6201906">depth</span><span class="op" id="6201911">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201916">p</span><span class="op" id="6201917">.</span><span class="ident" id="6201918">indentedIn</span>&nbsp;<span class="op" id="6201929">=</span>&nbsp;<span class="builtintype" id="6201931">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201937">}</span><br>
<span class="lineno">875</span><span class="op" id="6201939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6201942">type</span>&nbsp;<span class="ident" id="6201947">parentStack</span>&nbsp;<span class="keyword" id="6201959">struct</span>&nbsp;<span class="op" id="6201966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201969">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6201975">*</span><span class="ident" id="6201976">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6201985">stack</span>&nbsp;<span class="op" id="6201991">[</span><span class="op" id="6201992">]</span><span class="builtintype" id="6201993">string</span><br>
<span class="lineno">880</span><span class="op" id="6202000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6202003">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="6202083">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="6202157">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="6202226">func</span>&nbsp;<span class="op" id="6202231">(</span><span class="ident" id="6202232">s</span>&nbsp;<span class="op" id="6202234">*</span><span class="ident" id="6202235">parentStack</span><span class="op" id="6202246">)</span>&nbsp;<span class="ident" id="6202248">trim</span><span class="op" id="6202252">(</span><span class="ident" id="6202253">parents</span>&nbsp;<span class="op" id="6202261">[</span><span class="op" id="6202262">]</span><span class="builtintype" id="6202263">string</span><span class="op" id="6202269">)</span>&nbsp;<span class="builtintype" id="6202271">error</span>&nbsp;<span class="op" id="6202277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6202280">split</span>&nbsp;<span class="op" id="6202286">:=</span>&nbsp;<span class="num" id="6202289">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202292">for</span>&nbsp;<span class="op" id="6202296">;</span>&nbsp;<span class="ident" id="6202298">split</span>&nbsp;<span class="op" id="6202304">&lt;</span>&nbsp;<span class="builtinfunc" id="6202306">len</span><span class="op" id="6202309">(</span><span class="ident" id="6202310">parents</span><span class="op" id="6202317">)</span>&nbsp;<span class="op" id="6202319">&amp;&amp;</span>&nbsp;<span class="ident" id="6202322">split</span>&nbsp;<span class="op" id="6202328">&lt;</span>&nbsp;<span class="builtinfunc" id="6202330">len</span><span class="op" id="6202333">(</span><span class="ident" id="6202334">s</span><span class="op" id="6202335">.</span><span class="ident" id="6202336">stack</span><span class="op" id="6202341">)</span><span class="op" id="6202342">;</span>&nbsp;<span class="ident" id="6202344">split</span><span class="op" id="6202349">++</span>&nbsp;<span class="op" id="6202352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202356">if</span>&nbsp;<span class="ident" id="6202359">parents</span><span class="op" id="6202366">[</span><span class="ident" id="6202367">split</span><span class="op" id="6202372">]</span>&nbsp;<span class="op" id="6202374">!=</span>&nbsp;<span class="ident" id="6202377">s</span><span class="op" id="6202378">.</span><span class="ident" id="6202379">stack</span><span class="op" id="6202384">[</span><span class="ident" id="6202385">split</span><span class="op" id="6202390">]</span>&nbsp;<span class="op" id="6202392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202397">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202411">for</span>&nbsp;<span class="ident" id="6202415">i</span>&nbsp;<span class="op" id="6202417">:=</span>&nbsp;<span class="builtinfunc" id="6202420">len</span><span class="op" id="6202423">(</span><span class="ident" id="6202424">s</span><span class="op" id="6202425">.</span><span class="ident" id="6202426">stack</span><span class="op" id="6202431">)</span>&nbsp;<span class="op" id="6202433">-</span>&nbsp;<span class="num" id="6202435">1</span><span class="op" id="6202436">;</span>&nbsp;<span class="ident" id="6202438">i</span>&nbsp;<span class="op" id="6202440">&gt;=</span>&nbsp;<span class="ident" id="6202443">split</span><span class="op" id="6202448">;</span>&nbsp;<span class="ident" id="6202450">i</span><span class="op" id="6202451">--</span>&nbsp;<span class="op" id="6202454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202458">if</span>&nbsp;<span class="ident" id="6202461">err</span>&nbsp;<span class="op" id="6202465">:=</span>&nbsp;<span class="ident" id="6202468">s</span><span class="op" id="6202469">.</span><span class="ident" id="6202470">p</span><span class="op" id="6202471">.</span><span class="ident" id="6202472">writeEnd</span><span class="op" id="6202480">(</span><span class="ident" id="6202481">Name</span><span class="op" id="6202485">{</span><span class="ident" id="6202486">Local</span><span class="op" id="6202491">:</span>&nbsp;<span class="ident" id="6202493">s</span><span class="op" id="6202494">.</span><span class="ident" id="6202495">stack</span><span class="op" id="6202500">[</span><span class="ident" id="6202501">i</span><span class="op" id="6202502">]</span><span class="op" id="6202503">}</span><span class="op" id="6202504">)</span><span class="op" id="6202505">;</span>&nbsp;<span class="ident" id="6202507">err</span>&nbsp;<span class="op" id="6202511">!=</span>&nbsp;<span class="builtintype" id="6202514">nil</span>&nbsp;<span class="op" id="6202518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202523">return</span>&nbsp;<span class="ident" id="6202530">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6202542">s</span><span class="op" id="6202543">.</span><span class="ident" id="6202544">stack</span>&nbsp;<span class="op" id="6202550">=</span>&nbsp;<span class="ident" id="6202552">parents</span><span class="op" id="6202559">[</span><span class="op" id="6202560">:</span><span class="ident" id="6202561">split</span><span class="op" id="6202566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202569">return</span>&nbsp;<span class="builtintype" id="6202576">nil</span><br>
<span class="lineno"></span><span class="op" id="6202580">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="6202583">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="6202647">func</span>&nbsp;<span class="op" id="6202652">(</span><span class="ident" id="6202653">s</span>&nbsp;<span class="op" id="6202655">*</span><span class="ident" id="6202656">parentStack</span><span class="op" id="6202667">)</span>&nbsp;<span class="ident" id="6202669">push</span><span class="op" id="6202673">(</span><span class="ident" id="6202674">parents</span>&nbsp;<span class="op" id="6202682">[</span><span class="op" id="6202683">]</span><span class="builtintype" id="6202684">string</span><span class="op" id="6202690">)</span>&nbsp;<span class="builtintype" id="6202692">error</span>&nbsp;<span class="op" id="6202698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202701">for</span>&nbsp;<span class="ident" id="6202705">i</span>&nbsp;<span class="op" id="6202707">:=</span>&nbsp;<span class="num" id="6202710">0</span><span class="op" id="6202711">;</span>&nbsp;<span class="ident" id="6202713">i</span>&nbsp;<span class="op" id="6202715">&lt;</span>&nbsp;<span class="builtinfunc" id="6202717">len</span><span class="op" id="6202720">(</span><span class="ident" id="6202721">parents</span><span class="op" id="6202728">)</span><span class="op" id="6202729">;</span>&nbsp;<span class="ident" id="6202731">i</span><span class="op" id="6202732">++</span>&nbsp;<span class="op" id="6202735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202739">if</span>&nbsp;<span class="ident" id="6202742">err</span>&nbsp;<span class="op" id="6202746">:=</span>&nbsp;<span class="ident" id="6202749">s</span><span class="op" id="6202750">.</span><span class="ident" id="6202751">p</span><span class="op" id="6202752">.</span><span class="ident" id="6202753">writeStart</span><span class="op" id="6202763">(</span><span class="op" id="6202764">&amp;</span><span class="ident" id="6202765">StartElement</span><span class="op" id="6202777">{</span><span class="ident" id="6202778">Name</span><span class="op" id="6202782">:</span>&nbsp;<span class="ident" id="6202784">Name</span><span class="op" id="6202788">{</span><span class="ident" id="6202789">Local</span><span class="op" id="6202794">:</span>&nbsp;<span class="ident" id="6202796">parents</span><span class="op" id="6202803">[</span><span class="ident" id="6202804">i</span><span class="op" id="6202805">]</span><span class="op" id="6202806">}</span><span class="op" id="6202807">}</span><span class="op" id="6202808">)</span><span class="op" id="6202809">;</span>&nbsp;<span class="ident" id="6202811">err</span>&nbsp;<span class="op" id="6202815">!=</span>&nbsp;<span class="builtintype" id="6202818">nil</span>&nbsp;<span class="op" id="6202822">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202827">return</span>&nbsp;<span class="ident" id="6202834">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6202843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6202846">s</span><span class="op" id="6202847">.</span><span class="ident" id="6202848">stack</span>&nbsp;<span class="op" id="6202854">=</span>&nbsp;<span class="builtinfunc" id="6202856">append</span><span class="op" id="6202862">(</span><span class="ident" id="6202863">s</span><span class="op" id="6202864">.</span><span class="ident" id="6202865">stack</span><span class="op" id="6202870">,</span>&nbsp;<span class="ident" id="6202872">parents</span><span class="op" id="6202879">...</span><span class="op" id="6202882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6202885">return</span>&nbsp;<span class="builtintype" id="6202892">nil</span><br>
<span class="lineno">910</span><span class="op" id="6202896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6202899">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6202963">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="6203001">type</span>&nbsp;<span class="ident" id="6203006">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="6203027">struct</span>&nbsp;<span class="op" id="6203034">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6203037">Type</span>&nbsp;<span class="ident" id="6203042">reflect</span><span class="op" id="6203049">.</span><span class="ident" id="6203050">Type</span><br>
<span class="lineno"></span><span class="op" id="6203055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6203058">func</span>&nbsp;<span class="op" id="6203063">(</span><span class="ident" id="6203064">e</span>&nbsp;<span class="op" id="6203066">*</span><span class="ident" id="6203067">UnsupportedTypeError</span><span class="op" id="6203087">)</span>&nbsp;<span class="ident" id="6203089">Error</span><span class="op" id="6203094">(</span><span class="op" id="6203095">)</span>&nbsp;<span class="builtintype" id="6203097">string</span>&nbsp;<span class="op" id="6203104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203107">return</span>&nbsp;<span class="string" id="6203114">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="6203140">+</span>&nbsp;<span class="ident" id="6203142">e</span><span class="op" id="6203143">.</span><span class="ident" id="6203144">Type</span><span class="op" id="6203148">.</span><span class="ident" id="6203149">String</span><span class="op" id="6203155">(</span><span class="op" id="6203156">)</span><br>
<span class="lineno">920</span><span class="op" id="6203158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6203161">func</span>&nbsp;<span class="ident" id="6203166">isEmptyValue</span><span class="op" id="6203178">(</span><span class="ident" id="6203179">v</span>&nbsp;<span class="ident" id="6203181">reflect</span><span class="op" id="6203188">.</span><span class="ident" id="6203189">Value</span><span class="op" id="6203194">)</span>&nbsp;<span class="builtintype" id="6203196">bool</span>&nbsp;<span class="op" id="6203201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203204">switch</span>&nbsp;<span class="ident" id="6203211">v</span><span class="op" id="6203212">.</span><span class="ident" id="6203213">Kind</span><span class="op" id="6203217">(</span><span class="op" id="6203218">)</span>&nbsp;<span class="op" id="6203220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203223">case</span>&nbsp;<span class="ident" id="6203228">reflect</span><span class="op" id="6203235">.</span><span class="ident" id="6203236">Array</span><span class="op" id="6203241">,</span>&nbsp;<span class="ident" id="6203243">reflect</span><span class="op" id="6203250">.</span><span class="ident" id="6203251">Map</span><span class="op" id="6203254">,</span>&nbsp;<span class="ident" id="6203256">reflect</span><span class="op" id="6203263">.</span><span class="ident" id="6203264">Slice</span><span class="op" id="6203269">,</span>&nbsp;<span class="ident" id="6203271">reflect</span><span class="op" id="6203278">.</span><span class="ident" id="6203279">String</span><span class="op" id="6203285">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203289">return</span>&nbsp;<span class="ident" id="6203296">v</span><span class="op" id="6203297">.</span><span class="ident" id="6203298">Len</span><span class="op" id="6203301">(</span><span class="op" id="6203302">)</span>&nbsp;<span class="op" id="6203304">==</span>&nbsp;<span class="num" id="6203307">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203310">case</span>&nbsp;<span class="ident" id="6203315">reflect</span><span class="op" id="6203322">.</span><span class="ident" id="6203323">Bool</span><span class="op" id="6203327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203331">return</span>&nbsp;<span class="op" id="6203338">!</span><span class="ident" id="6203339">v</span><span class="op" id="6203340">.</span><span class="ident" id="6203341">Bool</span><span class="op" id="6203345">(</span><span class="op" id="6203346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203349">case</span>&nbsp;<span class="ident" id="6203354">reflect</span><span class="op" id="6203361">.</span><span class="ident" id="6203362">Int</span><span class="op" id="6203365">,</span>&nbsp;<span class="ident" id="6203367">reflect</span><span class="op" id="6203374">.</span><span class="ident" id="6203375">Int8</span><span class="op" id="6203379">,</span>&nbsp;<span class="ident" id="6203381">reflect</span><span class="op" id="6203388">.</span><span class="ident" id="6203389">Int16</span><span class="op" id="6203394">,</span>&nbsp;<span class="ident" id="6203396">reflect</span><span class="op" id="6203403">.</span><span class="ident" id="6203404">Int32</span><span class="op" id="6203409">,</span>&nbsp;<span class="ident" id="6203411">reflect</span><span class="op" id="6203418">.</span><span class="ident" id="6203419">Int64</span><span class="op" id="6203424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203428">return</span>&nbsp;<span class="ident" id="6203435">v</span><span class="op" id="6203436">.</span><span class="ident" id="6203437">Int</span><span class="op" id="6203440">(</span><span class="op" id="6203441">)</span>&nbsp;<span class="op" id="6203443">==</span>&nbsp;<span class="num" id="6203446">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203449">case</span>&nbsp;<span class="ident" id="6203454">reflect</span><span class="op" id="6203461">.</span><span class="ident" id="6203462">Uint</span><span class="op" id="6203466">,</span>&nbsp;<span class="ident" id="6203468">reflect</span><span class="op" id="6203475">.</span><span class="ident" id="6203476">Uint8</span><span class="op" id="6203481">,</span>&nbsp;<span class="ident" id="6203483">reflect</span><span class="op" id="6203490">.</span><span class="ident" id="6203491">Uint16</span><span class="op" id="6203497">,</span>&nbsp;<span class="ident" id="6203499">reflect</span><span class="op" id="6203506">.</span><span class="ident" id="6203507">Uint32</span><span class="op" id="6203513">,</span>&nbsp;<span class="ident" id="6203515">reflect</span><span class="op" id="6203522">.</span><span class="ident" id="6203523">Uint64</span><span class="op" id="6203529">,</span>&nbsp;<span class="ident" id="6203531">reflect</span><span class="op" id="6203538">.</span><span class="ident" id="6203539">Uintptr</span><span class="op" id="6203546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203550">return</span>&nbsp;<span class="ident" id="6203557">v</span><span class="op" id="6203558">.</span><span class="ident" id="6203559">Uint</span><span class="op" id="6203563">(</span><span class="op" id="6203564">)</span>&nbsp;<span class="op" id="6203566">==</span>&nbsp;<span class="num" id="6203569">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203572">case</span>&nbsp;<span class="ident" id="6203577">reflect</span><span class="op" id="6203584">.</span><span class="ident" id="6203585">Float32</span><span class="op" id="6203592">,</span>&nbsp;<span class="ident" id="6203594">reflect</span><span class="op" id="6203601">.</span><span class="ident" id="6203602">Float64</span><span class="op" id="6203609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203613">return</span>&nbsp;<span class="ident" id="6203620">v</span><span class="op" id="6203621">.</span><span class="ident" id="6203622">Float</span><span class="op" id="6203627">(</span><span class="op" id="6203628">)</span>&nbsp;<span class="op" id="6203630">==</span>&nbsp;<span class="num" id="6203633">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203636">case</span>&nbsp;<span class="ident" id="6203641">reflect</span><span class="op" id="6203648">.</span><span class="ident" id="6203649">Interface</span><span class="op" id="6203658">,</span>&nbsp;<span class="ident" id="6203660">reflect</span><span class="op" id="6203667">.</span><span class="ident" id="6203668">Ptr</span><span class="op" id="6203671">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203675">return</span>&nbsp;<span class="ident" id="6203682">v</span><span class="op" id="6203683">.</span><span class="ident" id="6203684">IsNil</span><span class="op" id="6203689">(</span><span class="op" id="6203690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6203693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6203696">return</span>&nbsp;<span class="builtintype" id="6203703">false</span><br>
<span class="lineno"></span><span class="op" id="6203709">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
