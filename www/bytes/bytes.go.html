<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3008584">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3008639">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3008693">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3008744">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="3008819">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3008880">package</span>&nbsp;<span class="ident" id="3008888">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3008895">import</span>&nbsp;<span class="op" id="3008902">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3008905">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3008916">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3008931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3008934">func</span>&nbsp;<span class="ident" id="3008939">equalPortable</span><span class="op" id="3008952">(</span><span class="ident" id="3008953">a</span><span class="op" id="3008954">,</span>&nbsp;<span class="ident" id="3008956">b</span>&nbsp;<span class="op" id="3008958">[</span><span class="op" id="3008959">]</span><span class="builtintype" id="3008960">byte</span><span class="op" id="3008964">)</span>&nbsp;<span class="builtintype" id="3008966">bool</span>&nbsp;<span class="op" id="3008971">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3008974">if</span>&nbsp;<span class="builtinfunc" id="3008977">len</span><span class="op" id="3008980">(</span><span class="ident" id="3008981">a</span><span class="op" id="3008982">)</span>&nbsp;<span class="op" id="3008984">!=</span>&nbsp;<span class="builtinfunc" id="3008987">len</span><span class="op" id="3008990">(</span><span class="ident" id="3008991">b</span><span class="op" id="3008992">)</span>&nbsp;<span class="op" id="3008994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3008998">return</span>&nbsp;<span class="ident" id="3009005">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009015">for</span>&nbsp;<span class="ident" id="3009019">i</span><span class="op" id="3009020">,</span>&nbsp;<span class="ident" id="3009022">c</span>&nbsp;<span class="op" id="3009024">:=</span>&nbsp;<span class="keyword" id="3009027">range</span>&nbsp;<span class="ident" id="3009033">a</span>&nbsp;<span class="op" id="3009035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009039">if</span>&nbsp;<span class="ident" id="3009042">c</span>&nbsp;<span class="op" id="3009044">!=</span>&nbsp;<span class="ident" id="3009047">b</span><span class="op" id="3009048">[</span><span class="ident" id="3009049">i</span><span class="op" id="3009050">]</span>&nbsp;<span class="op" id="3009052">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009057">return</span>&nbsp;<span class="ident" id="3009064">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009078">return</span>&nbsp;<span class="ident" id="3009085">true</span><br>
<span class="lineno"></span><span class="op" id="3009090">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3009093">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="3009197">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3009293">func</span>&nbsp;<span class="ident" id="3009298">explode</span><span class="op" id="3009305">(</span><span class="ident" id="3009306">s</span>&nbsp;<span class="op" id="3009308">[</span><span class="op" id="3009309">]</span><span class="builtintype" id="3009310">byte</span><span class="op" id="3009314">,</span>&nbsp;<span class="ident" id="3009316">n</span>&nbsp;<span class="builtintype" id="3009318">int</span><span class="op" id="3009321">)</span>&nbsp;<span class="op" id="3009323">[</span><span class="op" id="3009324">]</span><span class="op" id="3009325">[</span><span class="op" id="3009326">]</span><span class="builtintype" id="3009327">byte</span>&nbsp;<span class="op" id="3009332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009335">if</span>&nbsp;<span class="ident" id="3009338">n</span>&nbsp;<span class="op" id="3009340">&lt;=</span>&nbsp;<span class="num" id="3009343">0</span>&nbsp;<span class="op" id="3009345">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009349">n</span>&nbsp;<span class="op" id="3009351">=</span>&nbsp;<span class="builtinfunc" id="3009353">len</span><span class="op" id="3009356">(</span><span class="ident" id="3009357">s</span><span class="op" id="3009358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009364">a</span>&nbsp;<span class="op" id="3009366">:=</span>&nbsp;<span class="builtinfunc" id="3009369">make</span><span class="op" id="3009373">(</span><span class="op" id="3009374">[</span><span class="op" id="3009375">]</span><span class="op" id="3009376">[</span><span class="op" id="3009377">]</span><span class="builtintype" id="3009378">byte</span><span class="op" id="3009382">,</span>&nbsp;<span class="ident" id="3009384">n</span><span class="op" id="3009385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009388">var</span>&nbsp;<span class="ident" id="3009392">size</span>&nbsp;<span class="builtintype" id="3009397">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009402">na</span>&nbsp;<span class="op" id="3009405">:=</span>&nbsp;<span class="num" id="3009408">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009411">for</span>&nbsp;<span class="builtinfunc" id="3009415">len</span><span class="op" id="3009418">(</span><span class="ident" id="3009419">s</span><span class="op" id="3009420">)</span>&nbsp;<span class="op" id="3009422">&gt;</span>&nbsp;<span class="num" id="3009424">0</span>&nbsp;<span class="op" id="3009426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009430">if</span>&nbsp;<span class="ident" id="3009433">na</span><span class="op" id="3009435">+</span><span class="num" id="3009436">1</span>&nbsp;<span class="op" id="3009438">&gt;=</span>&nbsp;<span class="ident" id="3009441">n</span>&nbsp;<span class="op" id="3009443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009448">a</span><span class="op" id="3009449">[</span><span class="ident" id="3009450">na</span><span class="op" id="3009452">]</span>&nbsp;<span class="op" id="3009454">=</span>&nbsp;<span class="ident" id="3009456">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009461">na</span><span class="op" id="3009463">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009469">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009481">_</span><span class="op" id="3009482">,</span>&nbsp;<span class="ident" id="3009484">size</span>&nbsp;<span class="op" id="3009489">=</span>&nbsp;<span class="ident" id="3009491">utf8</span><span class="op" id="3009495">.</span><span class="ident" id="3009496">DecodeRune</span><span class="op" id="3009506">(</span><span class="ident" id="3009507">s</span><span class="op" id="3009508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009512">a</span><span class="op" id="3009513">[</span><span class="ident" id="3009514">na</span><span class="op" id="3009516">]</span>&nbsp;<span class="op" id="3009518">=</span>&nbsp;<span class="ident" id="3009520">s</span><span class="op" id="3009521">[</span><span class="num" id="3009522">0</span><span class="op" id="3009523">:</span><span class="ident" id="3009524">size</span><span class="op" id="3009528">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009532">s</span>&nbsp;<span class="op" id="3009534">=</span>&nbsp;<span class="ident" id="3009536">s</span><span class="op" id="3009537">[</span><span class="ident" id="3009538">size</span><span class="op" id="3009542">:</span><span class="op" id="3009543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009547">na</span><span class="op" id="3009549">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009556">return</span>&nbsp;<span class="ident" id="3009563">a</span><span class="op" id="3009564">[</span><span class="num" id="3009565">0</span><span class="op" id="3009566">:</span><span class="ident" id="3009567">na</span><span class="op" id="3009569">]</span><br>
<span class="lineno"></span><span class="op" id="3009571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3009574">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="3009643">func</span>&nbsp;<span class="ident" id="3009648">Count</span><span class="op" id="3009653">(</span><span class="ident" id="3009654">s</span><span class="op" id="3009655">,</span>&nbsp;<span class="ident" id="3009657">sep</span>&nbsp;<span class="op" id="3009661">[</span><span class="op" id="3009662">]</span><span class="builtintype" id="3009663">byte</span><span class="op" id="3009667">)</span>&nbsp;<span class="builtintype" id="3009669">int</span>&nbsp;<span class="op" id="3009673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009676">n</span>&nbsp;<span class="op" id="3009678">:=</span>&nbsp;<span class="builtinfunc" id="3009681">len</span><span class="op" id="3009684">(</span><span class="ident" id="3009685">sep</span><span class="op" id="3009688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009691">if</span>&nbsp;<span class="ident" id="3009694">n</span>&nbsp;<span class="op" id="3009696">==</span>&nbsp;<span class="num" id="3009699">0</span>&nbsp;<span class="op" id="3009701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009705">return</span>&nbsp;<span class="ident" id="3009712">utf8</span><span class="op" id="3009716">.</span><span class="ident" id="3009717">RuneCount</span><span class="op" id="3009726">(</span><span class="ident" id="3009727">s</span><span class="op" id="3009728">)</span>&nbsp;<span class="op" id="3009730">+</span>&nbsp;<span class="num" id="3009732">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009735">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009738">if</span>&nbsp;<span class="ident" id="3009741">n</span>&nbsp;<span class="op" id="3009743">&gt;</span>&nbsp;<span class="builtinfunc" id="3009745">len</span><span class="op" id="3009748">(</span><span class="ident" id="3009749">s</span><span class="op" id="3009750">)</span>&nbsp;<span class="op" id="3009752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009756">return</span>&nbsp;<span class="num" id="3009763">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009769">count</span>&nbsp;<span class="op" id="3009775">:=</span>&nbsp;<span class="num" id="3009778">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009781">c</span>&nbsp;<span class="op" id="3009783">:=</span>&nbsp;<span class="ident" id="3009786">sep</span><span class="op" id="3009789">[</span><span class="num" id="3009790">0</span><span class="op" id="3009791">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009794">i</span>&nbsp;<span class="op" id="3009796">:=</span>&nbsp;<span class="num" id="3009799">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009802">t</span>&nbsp;<span class="op" id="3009804">:=</span>&nbsp;<span class="ident" id="3009807">s</span><span class="op" id="3009808">[</span><span class="op" id="3009809">:</span><span class="builtinfunc" id="3009810">len</span><span class="op" id="3009813">(</span><span class="ident" id="3009814">s</span><span class="op" id="3009815">)</span><span class="op" id="3009816">-</span><span class="ident" id="3009817">n</span><span class="op" id="3009818">+</span><span class="num" id="3009819">1</span><span class="op" id="3009820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009823">for</span>&nbsp;<span class="ident" id="3009827">i</span>&nbsp;<span class="op" id="3009829">&lt;</span>&nbsp;<span class="builtinfunc" id="3009831">len</span><span class="op" id="3009834">(</span><span class="ident" id="3009835">t</span><span class="op" id="3009836">)</span>&nbsp;<span class="op" id="3009838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009842">if</span>&nbsp;<span class="ident" id="3009845">t</span><span class="op" id="3009846">[</span><span class="ident" id="3009847">i</span><span class="op" id="3009848">]</span>&nbsp;<span class="op" id="3009850">!=</span>&nbsp;<span class="ident" id="3009853">c</span>&nbsp;<span class="op" id="3009855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009860">o</span>&nbsp;<span class="op" id="3009862">:=</span>&nbsp;<span class="ident" id="3009865">IndexByte</span><span class="op" id="3009874">(</span><span class="ident" id="3009875">t</span><span class="op" id="3009876">[</span><span class="ident" id="3009877">i</span><span class="op" id="3009878">:</span><span class="op" id="3009879">]</span><span class="op" id="3009880">,</span>&nbsp;<span class="ident" id="3009882">c</span><span class="op" id="3009883">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009888">if</span>&nbsp;<span class="ident" id="3009891">o</span>&nbsp;<span class="op" id="3009893">&lt;</span>&nbsp;<span class="num" id="3009895">0</span>&nbsp;<span class="op" id="3009897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009903">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009917">i</span>&nbsp;<span class="op" id="3009919">+=</span>&nbsp;<span class="ident" id="3009922">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3009926">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009930">if</span>&nbsp;<span class="ident" id="3009933">n</span>&nbsp;<span class="op" id="3009935">==</span>&nbsp;<span class="num" id="3009938">1</span>&nbsp;<span class="op" id="3009940">||</span>&nbsp;<span class="ident" id="3009943">Equal</span><span class="op" id="3009948">(</span><span class="ident" id="3009949">s</span><span class="op" id="3009950">[</span><span class="ident" id="3009951">i</span><span class="op" id="3009952">:</span><span class="ident" id="3009953">i</span><span class="op" id="3009954">+</span><span class="ident" id="3009955">n</span><span class="op" id="3009956">]</span><span class="op" id="3009957">,</span>&nbsp;<span class="ident" id="3009959">sep</span><span class="op" id="3009962">)</span>&nbsp;<span class="op" id="3009964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009969">count</span><span class="op" id="3009974">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3009980">i</span>&nbsp;<span class="op" id="3009982">+=</span>&nbsp;<span class="ident" id="3009985">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3009990">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010001">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010005">i</span><span class="op" id="3010006">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010013">return</span>&nbsp;<span class="ident" id="3010020">count</span><br>
<span class="lineno"></span><span class="op" id="3010026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3010029">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3010079">func</span>&nbsp;<span class="ident" id="3010084">Contains</span><span class="op" id="3010092">(</span><span class="ident" id="3010093">b</span><span class="op" id="3010094">,</span>&nbsp;<span class="ident" id="3010096">subslice</span>&nbsp;<span class="op" id="3010105">[</span><span class="op" id="3010106">]</span><span class="builtintype" id="3010107">byte</span><span class="op" id="3010111">)</span>&nbsp;<span class="builtintype" id="3010113">bool</span>&nbsp;<span class="op" id="3010118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010121">return</span>&nbsp;<span class="ident" id="3010128">Index</span><span class="op" id="3010133">(</span><span class="ident" id="3010134">b</span><span class="op" id="3010135">,</span>&nbsp;<span class="ident" id="3010137">subslice</span><span class="op" id="3010145">)</span>&nbsp;<span class="op" id="3010147">!=</span>&nbsp;<span class="op" id="3010150">-</span><span class="num" id="3010151">1</span><br>
<span class="lineno"></span><span class="op" id="3010153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3010156">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3010252">func</span>&nbsp;<span class="ident" id="3010257">Index</span><span class="op" id="3010262">(</span><span class="ident" id="3010263">s</span><span class="op" id="3010264">,</span>&nbsp;<span class="ident" id="3010266">sep</span>&nbsp;<span class="op" id="3010270">[</span><span class="op" id="3010271">]</span><span class="builtintype" id="3010272">byte</span><span class="op" id="3010276">)</span>&nbsp;<span class="builtintype" id="3010278">int</span>&nbsp;<span class="op" id="3010282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010285">n</span>&nbsp;<span class="op" id="3010287">:=</span>&nbsp;<span class="builtinfunc" id="3010290">len</span><span class="op" id="3010293">(</span><span class="ident" id="3010294">sep</span><span class="op" id="3010297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010300">if</span>&nbsp;<span class="ident" id="3010303">n</span>&nbsp;<span class="op" id="3010305">==</span>&nbsp;<span class="num" id="3010308">0</span>&nbsp;<span class="op" id="3010310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010314">return</span>&nbsp;<span class="num" id="3010321">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010327">if</span>&nbsp;<span class="ident" id="3010330">n</span>&nbsp;<span class="op" id="3010332">&gt;</span>&nbsp;<span class="builtinfunc" id="3010334">len</span><span class="op" id="3010337">(</span><span class="ident" id="3010338">s</span><span class="op" id="3010339">)</span>&nbsp;<span class="op" id="3010341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010345">return</span>&nbsp;<span class="op" id="3010352">-</span><span class="num" id="3010353">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010359">c</span>&nbsp;<span class="op" id="3010361">:=</span>&nbsp;<span class="ident" id="3010364">sep</span><span class="op" id="3010367">[</span><span class="num" id="3010368">0</span><span class="op" id="3010369">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010372">if</span>&nbsp;<span class="ident" id="3010375">n</span>&nbsp;<span class="op" id="3010377">==</span>&nbsp;<span class="num" id="3010380">1</span>&nbsp;<span class="op" id="3010382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010386">return</span>&nbsp;<span class="ident" id="3010393">IndexByte</span><span class="op" id="3010402">(</span><span class="ident" id="3010403">s</span><span class="op" id="3010404">,</span>&nbsp;<span class="ident" id="3010406">c</span><span class="op" id="3010407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010413">i</span>&nbsp;<span class="op" id="3010415">:=</span>&nbsp;<span class="num" id="3010418">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010421">t</span>&nbsp;<span class="op" id="3010423">:=</span>&nbsp;<span class="ident" id="3010426">s</span><span class="op" id="3010427">[</span><span class="op" id="3010428">:</span><span class="builtinfunc" id="3010429">len</span><span class="op" id="3010432">(</span><span class="ident" id="3010433">s</span><span class="op" id="3010434">)</span><span class="op" id="3010435">-</span><span class="ident" id="3010436">n</span><span class="op" id="3010437">+</span><span class="num" id="3010438">1</span><span class="op" id="3010439">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010442">for</span>&nbsp;<span class="ident" id="3010446">i</span>&nbsp;<span class="op" id="3010448">&lt;</span>&nbsp;<span class="builtinfunc" id="3010450">len</span><span class="op" id="3010453">(</span><span class="ident" id="3010454">t</span><span class="op" id="3010455">)</span>&nbsp;<span class="op" id="3010457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010461">if</span>&nbsp;<span class="ident" id="3010464">t</span><span class="op" id="3010465">[</span><span class="ident" id="3010466">i</span><span class="op" id="3010467">]</span>&nbsp;<span class="op" id="3010469">!=</span>&nbsp;<span class="ident" id="3010472">c</span>&nbsp;<span class="op" id="3010474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010479">o</span>&nbsp;<span class="op" id="3010481">:=</span>&nbsp;<span class="ident" id="3010484">IndexByte</span><span class="op" id="3010493">(</span><span class="ident" id="3010494">t</span><span class="op" id="3010495">[</span><span class="ident" id="3010496">i</span><span class="op" id="3010497">:</span><span class="op" id="3010498">]</span><span class="op" id="3010499">,</span>&nbsp;<span class="ident" id="3010501">c</span><span class="op" id="3010502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010507">if</span>&nbsp;<span class="ident" id="3010510">o</span>&nbsp;<span class="op" id="3010512">&lt;</span>&nbsp;<span class="num" id="3010514">0</span>&nbsp;<span class="op" id="3010516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010522">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010536">i</span>&nbsp;<span class="op" id="3010538">+=</span>&nbsp;<span class="ident" id="3010541">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010549">if</span>&nbsp;<span class="ident" id="3010552">Equal</span><span class="op" id="3010557">(</span><span class="ident" id="3010558">s</span><span class="op" id="3010559">[</span><span class="ident" id="3010560">i</span><span class="op" id="3010561">:</span><span class="ident" id="3010562">i</span><span class="op" id="3010563">+</span><span class="ident" id="3010564">n</span><span class="op" id="3010565">]</span><span class="op" id="3010566">,</span>&nbsp;<span class="ident" id="3010568">sep</span><span class="op" id="3010571">)</span>&nbsp;<span class="op" id="3010573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010578">return</span>&nbsp;<span class="ident" id="3010585">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010593">i</span><span class="op" id="3010594">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010601">return</span>&nbsp;<span class="op" id="3010608">-</span><span class="num" id="3010609">1</span><br>
<span class="lineno"></span><span class="op" id="3010611">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="3010614">func</span>&nbsp;<span class="ident" id="3010619">indexBytePortable</span><span class="op" id="3010636">(</span><span class="ident" id="3010637">s</span>&nbsp;<span class="op" id="3010639">[</span><span class="op" id="3010640">]</span><span class="builtintype" id="3010641">byte</span><span class="op" id="3010645">,</span>&nbsp;<span class="ident" id="3010647">c</span>&nbsp;<span class="builtintype" id="3010649">byte</span><span class="op" id="3010653">)</span>&nbsp;<span class="builtintype" id="3010655">int</span>&nbsp;<span class="op" id="3010659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010662">for</span>&nbsp;<span class="ident" id="3010666">i</span><span class="op" id="3010667">,</span>&nbsp;<span class="ident" id="3010669">b</span>&nbsp;<span class="op" id="3010671">:=</span>&nbsp;<span class="keyword" id="3010674">range</span>&nbsp;<span class="ident" id="3010680">s</span>&nbsp;<span class="op" id="3010682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010686">if</span>&nbsp;<span class="ident" id="3010689">b</span>&nbsp;<span class="op" id="3010691">==</span>&nbsp;<span class="ident" id="3010694">c</span>&nbsp;<span class="op" id="3010696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010701">return</span>&nbsp;<span class="ident" id="3010708">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010718">return</span>&nbsp;<span class="op" id="3010725">-</span><span class="num" id="3010726">1</span><br>
<span class="lineno"></span><span class="op" id="3010728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3010731">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3010830">func</span>&nbsp;<span class="ident" id="3010835">LastIndex</span><span class="op" id="3010844">(</span><span class="ident" id="3010845">s</span><span class="op" id="3010846">,</span>&nbsp;<span class="ident" id="3010848">sep</span>&nbsp;<span class="op" id="3010852">[</span><span class="op" id="3010853">]</span><span class="builtintype" id="3010854">byte</span><span class="op" id="3010858">)</span>&nbsp;<span class="builtintype" id="3010860">int</span>&nbsp;<span class="op" id="3010864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010867">n</span>&nbsp;<span class="op" id="3010869">:=</span>&nbsp;<span class="builtinfunc" id="3010872">len</span><span class="op" id="3010875">(</span><span class="ident" id="3010876">sep</span><span class="op" id="3010879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010882">if</span>&nbsp;<span class="ident" id="3010885">n</span>&nbsp;<span class="op" id="3010887">==</span>&nbsp;<span class="num" id="3010890">0</span>&nbsp;<span class="op" id="3010892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010896">return</span>&nbsp;<span class="builtinfunc" id="3010903">len</span><span class="op" id="3010906">(</span><span class="ident" id="3010907">s</span><span class="op" id="3010908">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3010911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010914">c</span>&nbsp;<span class="op" id="3010916">:=</span>&nbsp;<span class="ident" id="3010919">sep</span><span class="op" id="3010922">[</span><span class="num" id="3010923">0</span><span class="op" id="3010924">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010927">for</span>&nbsp;<span class="ident" id="3010931">i</span>&nbsp;<span class="op" id="3010933">:=</span>&nbsp;<span class="builtinfunc" id="3010936">len</span><span class="op" id="3010939">(</span><span class="ident" id="3010940">s</span><span class="op" id="3010941">)</span>&nbsp;<span class="op" id="3010943">-</span>&nbsp;<span class="ident" id="3010945">n</span><span class="op" id="3010946">;</span>&nbsp;<span class="ident" id="3010948">i</span>&nbsp;<span class="op" id="3010950">&gt;=</span>&nbsp;<span class="num" id="3010953">0</span><span class="op" id="3010954">;</span>&nbsp;<span class="ident" id="3010956">i</span><span class="op" id="3010957">--</span>&nbsp;<span class="op" id="3010960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3010964">if</span>&nbsp;<span class="ident" id="3010967">s</span><span class="op" id="3010968">[</span><span class="ident" id="3010969">i</span><span class="op" id="3010970">]</span>&nbsp;<span class="op" id="3010972">==</span>&nbsp;<span class="ident" id="3010975">c</span>&nbsp;<span class="op" id="3010977">&amp;&amp;</span>&nbsp;<span class="op" id="3010980">(</span><span class="ident" id="3010981">n</span>&nbsp;<span class="op" id="3010983">==</span>&nbsp;<span class="num" id="3010986">1</span>&nbsp;<span class="op" id="3010988">||</span>&nbsp;<span class="ident" id="3010991">Equal</span><span class="op" id="3010996">(</span><span class="ident" id="3010997">s</span><span class="op" id="3010998">[</span><span class="ident" id="3010999">i</span><span class="op" id="3011000">:</span><span class="ident" id="3011001">i</span><span class="op" id="3011002">+</span><span class="ident" id="3011003">n</span><span class="op" id="3011004">]</span><span class="op" id="3011005">,</span>&nbsp;<span class="ident" id="3011007">sep</span><span class="op" id="3011010">)</span><span class="op" id="3011011">)</span>&nbsp;<span class="op" id="3011013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011018">return</span>&nbsp;<span class="ident" id="3011025">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011035">return</span>&nbsp;<span class="op" id="3011042">-</span><span class="num" id="3011043">1</span><br>
<span class="lineno"></span><span class="op" id="3011045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3011048">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="3011126">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="3011203">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3011249">func</span>&nbsp;<span class="ident" id="3011254">IndexRune</span><span class="op" id="3011263">(</span><span class="ident" id="3011264">s</span>&nbsp;<span class="op" id="3011266">[</span><span class="op" id="3011267">]</span><span class="builtintype" id="3011268">byte</span><span class="op" id="3011272">,</span>&nbsp;<span class="ident" id="3011274">r</span>&nbsp;<span class="builtintype" id="3011276">rune</span><span class="op" id="3011280">)</span>&nbsp;<span class="builtintype" id="3011282">int</span>&nbsp;<span class="op" id="3011286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011289">for</span>&nbsp;<span class="ident" id="3011293">i</span>&nbsp;<span class="op" id="3011295">:=</span>&nbsp;<span class="num" id="3011298">0</span><span class="op" id="3011299">;</span>&nbsp;<span class="ident" id="3011301">i</span>&nbsp;<span class="op" id="3011303">&lt;</span>&nbsp;<span class="builtinfunc" id="3011305">len</span><span class="op" id="3011308">(</span><span class="ident" id="3011309">s</span><span class="op" id="3011310">)</span><span class="op" id="3011311">;</span>&nbsp;<span class="op" id="3011313">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011317">r1</span><span class="op" id="3011319">,</span>&nbsp;<span class="ident" id="3011321">size</span>&nbsp;<span class="op" id="3011326">:=</span>&nbsp;<span class="ident" id="3011329">utf8</span><span class="op" id="3011333">.</span><span class="ident" id="3011334">DecodeRune</span><span class="op" id="3011344">(</span><span class="ident" id="3011345">s</span><span class="op" id="3011346">[</span><span class="ident" id="3011347">i</span><span class="op" id="3011348">:</span><span class="op" id="3011349">]</span><span class="op" id="3011350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011354">if</span>&nbsp;<span class="ident" id="3011357">r</span>&nbsp;<span class="op" id="3011359">==</span>&nbsp;<span class="ident" id="3011362">r1</span>&nbsp;<span class="op" id="3011365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011370">return</span>&nbsp;<span class="ident" id="3011377">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011385">i</span>&nbsp;<span class="op" id="3011387">+=</span>&nbsp;<span class="ident" id="3011390">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011399">return</span>&nbsp;<span class="op" id="3011406">-</span><span class="num" id="3011407">1</span><br>
<span class="lineno"></span><span class="op" id="3011409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3011412">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="3011489">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="3011569">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3011650">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="3011670">func</span>&nbsp;<span class="ident" id="3011675">IndexAny</span><span class="op" id="3011683">(</span><span class="ident" id="3011684">s</span>&nbsp;<span class="op" id="3011686">[</span><span class="op" id="3011687">]</span><span class="builtintype" id="3011688">byte</span><span class="op" id="3011692">,</span>&nbsp;<span class="ident" id="3011694">chars</span>&nbsp;<span class="builtintype" id="3011700">string</span><span class="op" id="3011706">)</span>&nbsp;<span class="builtintype" id="3011708">int</span>&nbsp;<span class="op" id="3011712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011715">if</span>&nbsp;<span class="builtinfunc" id="3011718">len</span><span class="op" id="3011721">(</span><span class="ident" id="3011722">chars</span><span class="op" id="3011727">)</span>&nbsp;<span class="op" id="3011729">&gt;</span>&nbsp;<span class="num" id="3011731">0</span>&nbsp;<span class="op" id="3011733">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011737">var</span>&nbsp;<span class="ident" id="3011741">r</span>&nbsp;<span class="builtintype" id="3011743">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011750">var</span>&nbsp;<span class="ident" id="3011754">width</span>&nbsp;<span class="builtintype" id="3011760">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011766">for</span>&nbsp;<span class="ident" id="3011770">i</span>&nbsp;<span class="op" id="3011772">:=</span>&nbsp;<span class="num" id="3011775">0</span><span class="op" id="3011776">;</span>&nbsp;<span class="ident" id="3011778">i</span>&nbsp;<span class="op" id="3011780">&lt;</span>&nbsp;<span class="builtinfunc" id="3011782">len</span><span class="op" id="3011785">(</span><span class="ident" id="3011786">s</span><span class="op" id="3011787">)</span><span class="op" id="3011788">;</span>&nbsp;<span class="ident" id="3011790">i</span>&nbsp;<span class="op" id="3011792">+=</span>&nbsp;<span class="ident" id="3011795">width</span>&nbsp;<span class="op" id="3011801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011806">r</span>&nbsp;<span class="op" id="3011808">=</span>&nbsp;<span class="builtintype" id="3011810">rune</span><span class="op" id="3011814">(</span><span class="ident" id="3011815">s</span><span class="op" id="3011816">[</span><span class="ident" id="3011817">i</span><span class="op" id="3011818">]</span><span class="op" id="3011819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011824">if</span>&nbsp;<span class="ident" id="3011827">r</span>&nbsp;<span class="op" id="3011829">&lt;</span>&nbsp;<span class="ident" id="3011831">utf8</span><span class="op" id="3011835">.</span><span class="ident" id="3011836">RuneSelf</span>&nbsp;<span class="op" id="3011845">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011851">width</span>&nbsp;<span class="op" id="3011857">=</span>&nbsp;<span class="num" id="3011859">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011864">}</span>&nbsp;<span class="keyword" id="3011866">else</span>&nbsp;<span class="op" id="3011871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011877">r</span><span class="op" id="3011878">,</span>&nbsp;<span class="ident" id="3011880">width</span>&nbsp;<span class="op" id="3011886">=</span>&nbsp;<span class="ident" id="3011888">utf8</span><span class="op" id="3011892">.</span><span class="ident" id="3011893">DecodeRune</span><span class="op" id="3011903">(</span><span class="ident" id="3011904">s</span><span class="op" id="3011905">[</span><span class="ident" id="3011906">i</span><span class="op" id="3011907">:</span><span class="op" id="3011908">]</span><span class="op" id="3011909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011919">for</span>&nbsp;<span class="ident" id="3011923">_</span><span class="op" id="3011924">,</span>&nbsp;<span class="ident" id="3011926">ch</span>&nbsp;<span class="op" id="3011929">:=</span>&nbsp;<span class="keyword" id="3011932">range</span>&nbsp;<span class="ident" id="3011938">chars</span>&nbsp;<span class="op" id="3011944">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011950">if</span>&nbsp;<span class="ident" id="3011953">r</span>&nbsp;<span class="op" id="3011955">==</span>&nbsp;<span class="ident" id="3011958">ch</span>&nbsp;<span class="op" id="3011961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011968">return</span>&nbsp;<span class="ident" id="3011975">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011990">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011996">return</span>&nbsp;<span class="op" id="3012003">-</span><span class="num" id="3012004">1</span><br>
<span class="lineno"></span><span class="op" id="3012006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3012009">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="3012082">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3012158">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3012234">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="3012271">func</span>&nbsp;<span class="ident" id="3012276">LastIndexAny</span><span class="op" id="3012288">(</span><span class="ident" id="3012289">s</span>&nbsp;<span class="op" id="3012291">[</span><span class="op" id="3012292">]</span><span class="builtintype" id="3012293">byte</span><span class="op" id="3012297">,</span>&nbsp;<span class="ident" id="3012299">chars</span>&nbsp;<span class="builtintype" id="3012305">string</span><span class="op" id="3012311">)</span>&nbsp;<span class="builtintype" id="3012313">int</span>&nbsp;<span class="op" id="3012317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012320">if</span>&nbsp;<span class="builtinfunc" id="3012323">len</span><span class="op" id="3012326">(</span><span class="ident" id="3012327">chars</span><span class="op" id="3012332">)</span>&nbsp;<span class="op" id="3012334">&gt;</span>&nbsp;<span class="num" id="3012336">0</span>&nbsp;<span class="op" id="3012338">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012342">for</span>&nbsp;<span class="ident" id="3012346">i</span>&nbsp;<span class="op" id="3012348">:=</span>&nbsp;<span class="builtinfunc" id="3012351">len</span><span class="op" id="3012354">(</span><span class="ident" id="3012355">s</span><span class="op" id="3012356">)</span><span class="op" id="3012357">;</span>&nbsp;<span class="ident" id="3012359">i</span>&nbsp;<span class="op" id="3012361">&gt;</span>&nbsp;<span class="num" id="3012363">0</span><span class="op" id="3012364">;</span>&nbsp;<span class="op" id="3012366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012371">r</span><span class="op" id="3012372">,</span>&nbsp;<span class="ident" id="3012374">size</span>&nbsp;<span class="op" id="3012379">:=</span>&nbsp;<span class="ident" id="3012382">utf8</span><span class="op" id="3012386">.</span><span class="ident" id="3012387">DecodeLastRune</span><span class="op" id="3012401">(</span><span class="ident" id="3012402">s</span><span class="op" id="3012403">[</span><span class="num" id="3012404">0</span><span class="op" id="3012405">:</span><span class="ident" id="3012406">i</span><span class="op" id="3012407">]</span><span class="op" id="3012408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012413">i</span>&nbsp;<span class="op" id="3012415">-=</span>&nbsp;<span class="ident" id="3012418">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012426">for</span>&nbsp;<span class="ident" id="3012430">_</span><span class="op" id="3012431">,</span>&nbsp;<span class="ident" id="3012433">ch</span>&nbsp;<span class="op" id="3012436">:=</span>&nbsp;<span class="keyword" id="3012439">range</span>&nbsp;<span class="ident" id="3012445">chars</span>&nbsp;<span class="op" id="3012451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012457">if</span>&nbsp;<span class="ident" id="3012460">r</span>&nbsp;<span class="op" id="3012462">==</span>&nbsp;<span class="ident" id="3012465">ch</span>&nbsp;<span class="op" id="3012468">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012475">return</span>&nbsp;<span class="ident" id="3012482">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012500">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012503">return</span>&nbsp;<span class="op" id="3012510">-</span><span class="num" id="3012511">1</span><br>
<span class="lineno"></span><span class="op" id="3012513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3012516">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="3012569">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="3012621">func</span>&nbsp;<span class="ident" id="3012626">genSplit</span><span class="op" id="3012634">(</span><span class="ident" id="3012635">s</span><span class="op" id="3012636">,</span>&nbsp;<span class="ident" id="3012638">sep</span>&nbsp;<span class="op" id="3012642">[</span><span class="op" id="3012643">]</span><span class="builtintype" id="3012644">byte</span><span class="op" id="3012648">,</span>&nbsp;<span class="ident" id="3012650">sepSave</span><span class="op" id="3012657">,</span>&nbsp;<span class="ident" id="3012659">n</span>&nbsp;<span class="builtintype" id="3012661">int</span><span class="op" id="3012664">)</span>&nbsp;<span class="op" id="3012666">[</span><span class="op" id="3012667">]</span><span class="op" id="3012668">[</span><span class="op" id="3012669">]</span><span class="builtintype" id="3012670">byte</span>&nbsp;<span class="op" id="3012675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012678">if</span>&nbsp;<span class="ident" id="3012681">n</span>&nbsp;<span class="op" id="3012683">==</span>&nbsp;<span class="num" id="3012686">0</span>&nbsp;<span class="op" id="3012688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012692">return</span>&nbsp;<span class="ident" id="3012699">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012707">if</span>&nbsp;<span class="builtinfunc" id="3012710">len</span><span class="op" id="3012713">(</span><span class="ident" id="3012714">sep</span><span class="op" id="3012717">)</span>&nbsp;<span class="op" id="3012719">==</span>&nbsp;<span class="num" id="3012722">0</span>&nbsp;<span class="op" id="3012724">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012728">return</span>&nbsp;<span class="ident" id="3012735">explode</span><span class="op" id="3012742">(</span><span class="ident" id="3012743">s</span><span class="op" id="3012744">,</span>&nbsp;<span class="ident" id="3012746">n</span><span class="op" id="3012747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012753">if</span>&nbsp;<span class="ident" id="3012756">n</span>&nbsp;<span class="op" id="3012758">&lt;</span>&nbsp;<span class="num" id="3012760">0</span>&nbsp;<span class="op" id="3012762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012766">n</span>&nbsp;<span class="op" id="3012768">=</span>&nbsp;<span class="ident" id="3012770">Count</span><span class="op" id="3012775">(</span><span class="ident" id="3012776">s</span><span class="op" id="3012777">,</span>&nbsp;<span class="ident" id="3012779">sep</span><span class="op" id="3012782">)</span>&nbsp;<span class="op" id="3012784">+</span>&nbsp;<span class="num" id="3012786">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012789">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012792">c</span>&nbsp;<span class="op" id="3012794">:=</span>&nbsp;<span class="ident" id="3012797">sep</span><span class="op" id="3012800">[</span><span class="num" id="3012801">0</span><span class="op" id="3012802">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012805">start</span>&nbsp;<span class="op" id="3012811">:=</span>&nbsp;<span class="num" id="3012814">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012817">a</span>&nbsp;<span class="op" id="3012819">:=</span>&nbsp;<span class="builtinfunc" id="3012822">make</span><span class="op" id="3012826">(</span><span class="op" id="3012827">[</span><span class="op" id="3012828">]</span><span class="op" id="3012829">[</span><span class="op" id="3012830">]</span><span class="builtintype" id="3012831">byte</span><span class="op" id="3012835">,</span>&nbsp;<span class="ident" id="3012837">n</span><span class="op" id="3012838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012841">na</span>&nbsp;<span class="op" id="3012844">:=</span>&nbsp;<span class="num" id="3012847">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012850">for</span>&nbsp;<span class="ident" id="3012854">i</span>&nbsp;<span class="op" id="3012856">:=</span>&nbsp;<span class="num" id="3012859">0</span><span class="op" id="3012860">;</span>&nbsp;<span class="ident" id="3012862">i</span><span class="op" id="3012863">+</span><span class="builtinfunc" id="3012864">len</span><span class="op" id="3012867">(</span><span class="ident" id="3012868">sep</span><span class="op" id="3012871">)</span>&nbsp;<span class="op" id="3012873">&lt;=</span>&nbsp;<span class="builtinfunc" id="3012876">len</span><span class="op" id="3012879">(</span><span class="ident" id="3012880">s</span><span class="op" id="3012881">)</span>&nbsp;<span class="op" id="3012883">&amp;&amp;</span>&nbsp;<span class="ident" id="3012886">na</span><span class="op" id="3012888">+</span><span class="num" id="3012889">1</span>&nbsp;<span class="op" id="3012891">&lt;</span>&nbsp;<span class="ident" id="3012893">n</span><span class="op" id="3012894">;</span>&nbsp;<span class="ident" id="3012896">i</span><span class="op" id="3012897">++</span>&nbsp;<span class="op" id="3012900">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012904">if</span>&nbsp;<span class="ident" id="3012907">s</span><span class="op" id="3012908">[</span><span class="ident" id="3012909">i</span><span class="op" id="3012910">]</span>&nbsp;<span class="op" id="3012912">==</span>&nbsp;<span class="ident" id="3012915">c</span>&nbsp;<span class="op" id="3012917">&amp;&amp;</span>&nbsp;<span class="op" id="3012920">(</span><span class="builtinfunc" id="3012921">len</span><span class="op" id="3012924">(</span><span class="ident" id="3012925">sep</span><span class="op" id="3012928">)</span>&nbsp;<span class="op" id="3012930">==</span>&nbsp;<span class="num" id="3012933">1</span>&nbsp;<span class="op" id="3012935">||</span>&nbsp;<span class="ident" id="3012938">Equal</span><span class="op" id="3012943">(</span><span class="ident" id="3012944">s</span><span class="op" id="3012945">[</span><span class="ident" id="3012946">i</span><span class="op" id="3012947">:</span><span class="ident" id="3012948">i</span><span class="op" id="3012949">+</span><span class="builtinfunc" id="3012950">len</span><span class="op" id="3012953">(</span><span class="ident" id="3012954">sep</span><span class="op" id="3012957">)</span><span class="op" id="3012958">]</span><span class="op" id="3012959">,</span>&nbsp;<span class="ident" id="3012961">sep</span><span class="op" id="3012964">)</span><span class="op" id="3012965">)</span>&nbsp;<span class="op" id="3012967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012972">a</span><span class="op" id="3012973">[</span><span class="ident" id="3012974">na</span><span class="op" id="3012976">]</span>&nbsp;<span class="op" id="3012978">=</span>&nbsp;<span class="ident" id="3012980">s</span><span class="op" id="3012981">[</span><span class="ident" id="3012982">start</span>&nbsp;<span class="op" id="3012988">:</span>&nbsp;<span class="ident" id="3012990">i</span><span class="op" id="3012991">+</span><span class="ident" id="3012992">sepSave</span><span class="op" id="3012999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013004">na</span><span class="op" id="3013006">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013012">start</span>&nbsp;<span class="op" id="3013018">=</span>&nbsp;<span class="ident" id="3013020">i</span>&nbsp;<span class="op" id="3013022">+</span>&nbsp;<span class="builtinfunc" id="3013024">len</span><span class="op" id="3013027">(</span><span class="ident" id="3013028">sep</span><span class="op" id="3013031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013036">i</span>&nbsp;<span class="op" id="3013038">+=</span>&nbsp;<span class="builtinfunc" id="3013041">len</span><span class="op" id="3013044">(</span><span class="ident" id="3013045">sep</span><span class="op" id="3013048">)</span>&nbsp;<span class="op" id="3013050">-</span>&nbsp;<span class="num" id="3013052">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013062">a</span><span class="op" id="3013063">[</span><span class="ident" id="3013064">na</span><span class="op" id="3013066">]</span>&nbsp;<span class="op" id="3013068">=</span>&nbsp;<span class="ident" id="3013070">s</span><span class="op" id="3013071">[</span><span class="ident" id="3013072">start</span><span class="op" id="3013077">:</span><span class="op" id="3013078">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013081">return</span>&nbsp;<span class="ident" id="3013088">a</span><span class="op" id="3013089">[</span><span class="num" id="3013090">0</span>&nbsp;<span class="op" id="3013092">:</span>&nbsp;<span class="ident" id="3013094">na</span><span class="op" id="3013096">+</span><span class="num" id="3013097">1</span><span class="op" id="3013098">]</span><br>
<span class="lineno"></span><span class="op" id="3013100">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3013103">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3013177">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="3013220">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="3013281">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="3013340">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="3013422">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="3013470">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="3013496">func</span>&nbsp;<span class="ident" id="3013501">SplitN</span><span class="op" id="3013507">(</span><span class="ident" id="3013508">s</span><span class="op" id="3013509">,</span>&nbsp;<span class="ident" id="3013511">sep</span>&nbsp;<span class="op" id="3013515">[</span><span class="op" id="3013516">]</span><span class="builtintype" id="3013517">byte</span><span class="op" id="3013521">,</span>&nbsp;<span class="ident" id="3013523">n</span>&nbsp;<span class="builtintype" id="3013525">int</span><span class="op" id="3013528">)</span>&nbsp;<span class="op" id="3013530">[</span><span class="op" id="3013531">]</span><span class="op" id="3013532">[</span><span class="op" id="3013533">]</span><span class="builtintype" id="3013534">byte</span>&nbsp;<span class="op" id="3013539">{</span>&nbsp;<span class="keyword" id="3013541">return</span>&nbsp;<span class="ident" id="3013548">genSplit</span><span class="op" id="3013556">(</span><span class="ident" id="3013557">s</span><span class="op" id="3013558">,</span>&nbsp;<span class="ident" id="3013560">sep</span><span class="op" id="3013563">,</span>&nbsp;<span class="num" id="3013565">0</span><span class="op" id="3013566">,</span>&nbsp;<span class="ident" id="3013568">n</span><span class="op" id="3013569">)</span>&nbsp;<span class="op" id="3013571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="3013574">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3013644">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="3013683">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="3013749">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="3013808">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="3013890">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="3013938">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="3013964">func</span>&nbsp;<span class="ident" id="3013969">SplitAfterN</span><span class="op" id="3013980">(</span><span class="ident" id="3013981">s</span><span class="op" id="3013982">,</span>&nbsp;<span class="ident" id="3013984">sep</span>&nbsp;<span class="op" id="3013988">[</span><span class="op" id="3013989">]</span><span class="builtintype" id="3013990">byte</span><span class="op" id="3013994">,</span>&nbsp;<span class="ident" id="3013996">n</span>&nbsp;<span class="builtintype" id="3013998">int</span><span class="op" id="3014001">)</span>&nbsp;<span class="op" id="3014003">[</span><span class="op" id="3014004">]</span><span class="op" id="3014005">[</span><span class="op" id="3014006">]</span><span class="builtintype" id="3014007">byte</span>&nbsp;<span class="op" id="3014012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014015">return</span>&nbsp;<span class="ident" id="3014022">genSplit</span><span class="op" id="3014030">(</span><span class="ident" id="3014031">s</span><span class="op" id="3014032">,</span>&nbsp;<span class="ident" id="3014034">sep</span><span class="op" id="3014037">,</span>&nbsp;<span class="builtinfunc" id="3014039">len</span><span class="op" id="3014042">(</span><span class="ident" id="3014043">sep</span><span class="op" id="3014046">)</span><span class="op" id="3014047">,</span>&nbsp;<span class="ident" id="3014049">n</span><span class="op" id="3014050">)</span><br>
<span class="lineno"></span><span class="op" id="3014052">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="3014055">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3014132">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="3014175">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="3014235">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="3014285">func</span>&nbsp;<span class="ident" id="3014290">Split</span><span class="op" id="3014295">(</span><span class="ident" id="3014296">s</span><span class="op" id="3014297">,</span>&nbsp;<span class="ident" id="3014299">sep</span>&nbsp;<span class="op" id="3014303">[</span><span class="op" id="3014304">]</span><span class="builtintype" id="3014305">byte</span><span class="op" id="3014309">)</span>&nbsp;<span class="op" id="3014311">[</span><span class="op" id="3014312">]</span><span class="op" id="3014313">[</span><span class="op" id="3014314">]</span><span class="builtintype" id="3014315">byte</span>&nbsp;<span class="op" id="3014320">{</span>&nbsp;<span class="keyword" id="3014322">return</span>&nbsp;<span class="ident" id="3014329">genSplit</span><span class="op" id="3014337">(</span><span class="ident" id="3014338">s</span><span class="op" id="3014339">,</span>&nbsp;<span class="ident" id="3014341">sep</span><span class="op" id="3014344">,</span>&nbsp;<span class="num" id="3014346">0</span><span class="op" id="3014347">,</span>&nbsp;<span class="op" id="3014349">-</span><span class="num" id="3014350">1</span><span class="op" id="3014351">)</span>&nbsp;<span class="op" id="3014353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3014356">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3014429">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="3014468">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="3014533">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="3014588">func</span>&nbsp;<span class="ident" id="3014593">SplitAfter</span><span class="op" id="3014603">(</span><span class="ident" id="3014604">s</span><span class="op" id="3014605">,</span>&nbsp;<span class="ident" id="3014607">sep</span>&nbsp;<span class="op" id="3014611">[</span><span class="op" id="3014612">]</span><span class="builtintype" id="3014613">byte</span><span class="op" id="3014617">)</span>&nbsp;<span class="op" id="3014619">[</span><span class="op" id="3014620">]</span><span class="op" id="3014621">[</span><span class="op" id="3014622">]</span><span class="builtintype" id="3014623">byte</span>&nbsp;<span class="op" id="3014628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014631">return</span>&nbsp;<span class="ident" id="3014638">genSplit</span><span class="op" id="3014646">(</span><span class="ident" id="3014647">s</span><span class="op" id="3014648">,</span>&nbsp;<span class="ident" id="3014650">sep</span><span class="op" id="3014653">,</span>&nbsp;<span class="builtinfunc" id="3014655">len</span><span class="op" id="3014658">(</span><span class="ident" id="3014659">sep</span><span class="op" id="3014662">)</span><span class="op" id="3014663">,</span>&nbsp;<span class="op" id="3014665">-</span><span class="num" id="3014666">1</span><span class="op" id="3014667">)</span><br>
<span class="lineno"></span><span class="op" id="3014669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3014672">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="3014761">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3014861">func</span>&nbsp;<span class="ident" id="3014866">Fields</span><span class="op" id="3014872">(</span><span class="ident" id="3014873">s</span>&nbsp;<span class="op" id="3014875">[</span><span class="op" id="3014876">]</span><span class="builtintype" id="3014877">byte</span><span class="op" id="3014881">)</span>&nbsp;<span class="op" id="3014883">[</span><span class="op" id="3014884">]</span><span class="op" id="3014885">[</span><span class="op" id="3014886">]</span><span class="builtintype" id="3014887">byte</span>&nbsp;<span class="op" id="3014892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014895">return</span>&nbsp;<span class="ident" id="3014902">FieldsFunc</span><span class="op" id="3014912">(</span><span class="ident" id="3014913">s</span><span class="op" id="3014914">,</span>&nbsp;<span class="ident" id="3014916">unicode</span><span class="op" id="3014923">.</span><span class="ident" id="3014924">IsSpace</span><span class="op" id="3014931">)</span><br>
<span class="lineno"></span><span class="op" id="3014933">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="3014936">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="3015015">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3015089">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3015169">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="3015213">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="3015287">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="3015367">func</span>&nbsp;<span class="ident" id="3015372">FieldsFunc</span><span class="op" id="3015382">(</span><span class="ident" id="3015383">s</span>&nbsp;<span class="op" id="3015385">[</span><span class="op" id="3015386">]</span><span class="builtintype" id="3015387">byte</span><span class="op" id="3015391">,</span>&nbsp;<span class="ident" id="3015393">f</span>&nbsp;<span class="keyword" id="3015395">func</span><span class="op" id="3015399">(</span><span class="builtintype" id="3015400">rune</span><span class="op" id="3015404">)</span>&nbsp;<span class="builtintype" id="3015406">bool</span><span class="op" id="3015410">)</span>&nbsp;<span class="op" id="3015412">[</span><span class="op" id="3015413">]</span><span class="op" id="3015414">[</span><span class="op" id="3015415">]</span><span class="builtintype" id="3015416">byte</span>&nbsp;<span class="op" id="3015421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015424">n</span>&nbsp;<span class="op" id="3015426">:=</span>&nbsp;<span class="num" id="3015429">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015432">inField</span>&nbsp;<span class="op" id="3015440">:=</span>&nbsp;<span class="ident" id="3015443">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015450">for</span>&nbsp;<span class="ident" id="3015454">i</span>&nbsp;<span class="op" id="3015456">:=</span>&nbsp;<span class="num" id="3015459">0</span><span class="op" id="3015460">;</span>&nbsp;<span class="ident" id="3015462">i</span>&nbsp;<span class="op" id="3015464">&lt;</span>&nbsp;<span class="builtinfunc" id="3015466">len</span><span class="op" id="3015469">(</span><span class="ident" id="3015470">s</span><span class="op" id="3015471">)</span><span class="op" id="3015472">;</span>&nbsp;<span class="op" id="3015474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015478">r</span><span class="op" id="3015479">,</span>&nbsp;<span class="ident" id="3015481">size</span>&nbsp;<span class="op" id="3015486">:=</span>&nbsp;<span class="ident" id="3015489">utf8</span><span class="op" id="3015493">.</span><span class="ident" id="3015494">DecodeRune</span><span class="op" id="3015504">(</span><span class="ident" id="3015505">s</span><span class="op" id="3015506">[</span><span class="ident" id="3015507">i</span><span class="op" id="3015508">:</span><span class="op" id="3015509">]</span><span class="op" id="3015510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015514">wasInField</span>&nbsp;<span class="op" id="3015525">:=</span>&nbsp;<span class="ident" id="3015528">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015538">inField</span>&nbsp;<span class="op" id="3015546">=</span>&nbsp;<span class="op" id="3015548">!</span><span class="ident" id="3015549">f</span><span class="op" id="3015550">(</span><span class="ident" id="3015551">r</span><span class="op" id="3015552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015556">if</span>&nbsp;<span class="ident" id="3015559">inField</span>&nbsp;<span class="op" id="3015567">&amp;&amp;</span>&nbsp;<span class="op" id="3015570">!</span><span class="ident" id="3015571">wasInField</span>&nbsp;<span class="op" id="3015582">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015587">n</span><span class="op" id="3015588">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015597">i</span>&nbsp;<span class="op" id="3015599">+=</span>&nbsp;<span class="ident" id="3015602">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015612">a</span>&nbsp;<span class="op" id="3015614">:=</span>&nbsp;<span class="builtinfunc" id="3015617">make</span><span class="op" id="3015621">(</span><span class="op" id="3015622">[</span><span class="op" id="3015623">]</span><span class="op" id="3015624">[</span><span class="op" id="3015625">]</span><span class="builtintype" id="3015626">byte</span><span class="op" id="3015630">,</span>&nbsp;<span class="ident" id="3015632">n</span><span class="op" id="3015633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015636">na</span>&nbsp;<span class="op" id="3015639">:=</span>&nbsp;<span class="num" id="3015642">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015645">fieldStart</span>&nbsp;<span class="op" id="3015656">:=</span>&nbsp;<span class="op" id="3015659">-</span><span class="num" id="3015660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015663">for</span>&nbsp;<span class="ident" id="3015667">i</span>&nbsp;<span class="op" id="3015669">:=</span>&nbsp;<span class="num" id="3015672">0</span><span class="op" id="3015673">;</span>&nbsp;<span class="ident" id="3015675">i</span>&nbsp;<span class="op" id="3015677">&lt;=</span>&nbsp;<span class="builtinfunc" id="3015680">len</span><span class="op" id="3015683">(</span><span class="ident" id="3015684">s</span><span class="op" id="3015685">)</span>&nbsp;<span class="op" id="3015687">&amp;&amp;</span>&nbsp;<span class="ident" id="3015690">na</span>&nbsp;<span class="op" id="3015693">&lt;</span>&nbsp;<span class="ident" id="3015695">n</span><span class="op" id="3015696">;</span>&nbsp;<span class="op" id="3015698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015702">r</span><span class="op" id="3015703">,</span>&nbsp;<span class="ident" id="3015705">size</span>&nbsp;<span class="op" id="3015710">:=</span>&nbsp;<span class="ident" id="3015713">utf8</span><span class="op" id="3015717">.</span><span class="ident" id="3015718">DecodeRune</span><span class="op" id="3015728">(</span><span class="ident" id="3015729">s</span><span class="op" id="3015730">[</span><span class="ident" id="3015731">i</span><span class="op" id="3015732">:</span><span class="op" id="3015733">]</span><span class="op" id="3015734">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015738">if</span>&nbsp;<span class="ident" id="3015741">fieldStart</span>&nbsp;<span class="op" id="3015752">&lt;</span>&nbsp;<span class="num" id="3015754">0</span>&nbsp;<span class="op" id="3015756">&amp;&amp;</span>&nbsp;<span class="ident" id="3015759">size</span>&nbsp;<span class="op" id="3015764">&gt;</span>&nbsp;<span class="num" id="3015766">0</span>&nbsp;<span class="op" id="3015768">&amp;&amp;</span>&nbsp;<span class="op" id="3015771">!</span><span class="ident" id="3015772">f</span><span class="op" id="3015773">(</span><span class="ident" id="3015774">r</span><span class="op" id="3015775">)</span>&nbsp;<span class="op" id="3015777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015782">fieldStart</span>&nbsp;<span class="op" id="3015793">=</span>&nbsp;<span class="ident" id="3015795">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015800">i</span>&nbsp;<span class="op" id="3015802">+=</span>&nbsp;<span class="ident" id="3015805">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015813">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015824">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015828">if</span>&nbsp;<span class="ident" id="3015831">fieldStart</span>&nbsp;<span class="op" id="3015842">&gt;=</span>&nbsp;<span class="num" id="3015845">0</span>&nbsp;<span class="op" id="3015847">&amp;&amp;</span>&nbsp;<span class="op" id="3015850">(</span><span class="ident" id="3015851">size</span>&nbsp;<span class="op" id="3015856">==</span>&nbsp;<span class="num" id="3015859">0</span>&nbsp;<span class="op" id="3015861">||</span>&nbsp;<span class="ident" id="3015864">f</span><span class="op" id="3015865">(</span><span class="ident" id="3015866">r</span><span class="op" id="3015867">)</span><span class="op" id="3015868">)</span>&nbsp;<span class="op" id="3015870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015875">a</span><span class="op" id="3015876">[</span><span class="ident" id="3015877">na</span><span class="op" id="3015879">]</span>&nbsp;<span class="op" id="3015881">=</span>&nbsp;<span class="ident" id="3015883">s</span><span class="op" id="3015884">[</span><span class="ident" id="3015885">fieldStart</span><span class="op" id="3015895">:</span><span class="ident" id="3015896">i</span><span class="op" id="3015897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015902">na</span><span class="op" id="3015904">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015910">fieldStart</span>&nbsp;<span class="op" id="3015921">=</span>&nbsp;<span class="op" id="3015923">-</span><span class="num" id="3015924">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015928">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015932">if</span>&nbsp;<span class="ident" id="3015935">size</span>&nbsp;<span class="op" id="3015940">==</span>&nbsp;<span class="num" id="3015943">0</span>&nbsp;<span class="op" id="3015945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015950">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015962">i</span>&nbsp;<span class="op" id="3015964">+=</span>&nbsp;<span class="ident" id="3015967">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015973">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015976">return</span>&nbsp;<span class="ident" id="3015983">a</span><span class="op" id="3015984">[</span><span class="num" id="3015985">0</span><span class="op" id="3015986">:</span><span class="ident" id="3015987">na</span><span class="op" id="3015989">]</span><br>
<span class="lineno"></span><span class="op" id="3015991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3015994">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="3016075">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="3016133">func</span>&nbsp;<span class="ident" id="3016138">Join</span><span class="op" id="3016142">(</span><span class="ident" id="3016143">s</span>&nbsp;<span class="op" id="3016145">[</span><span class="op" id="3016146">]</span><span class="op" id="3016147">[</span><span class="op" id="3016148">]</span><span class="builtintype" id="3016149">byte</span><span class="op" id="3016153">,</span>&nbsp;<span class="ident" id="3016155">sep</span>&nbsp;<span class="op" id="3016159">[</span><span class="op" id="3016160">]</span><span class="builtintype" id="3016161">byte</span><span class="op" id="3016165">)</span>&nbsp;<span class="op" id="3016167">[</span><span class="op" id="3016168">]</span><span class="builtintype" id="3016169">byte</span>&nbsp;<span class="op" id="3016174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016177">if</span>&nbsp;<span class="builtinfunc" id="3016180">len</span><span class="op" id="3016183">(</span><span class="ident" id="3016184">s</span><span class="op" id="3016185">)</span>&nbsp;<span class="op" id="3016187">==</span>&nbsp;<span class="num" id="3016190">0</span>&nbsp;<span class="op" id="3016192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016196">return</span>&nbsp;<span class="op" id="3016203">[</span><span class="op" id="3016204">]</span><span class="builtintype" id="3016205">byte</span><span class="op" id="3016209">{</span><span class="op" id="3016210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016216">if</span>&nbsp;<span class="builtinfunc" id="3016219">len</span><span class="op" id="3016222">(</span><span class="ident" id="3016223">s</span><span class="op" id="3016224">)</span>&nbsp;<span class="op" id="3016226">==</span>&nbsp;<span class="num" id="3016229">1</span>&nbsp;<span class="op" id="3016231">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016235">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016260">return</span>&nbsp;<span class="builtinfunc" id="3016267">append</span><span class="op" id="3016273">(</span><span class="op" id="3016274">[</span><span class="op" id="3016275">]</span><span class="builtintype" id="3016276">byte</span><span class="op" id="3016280">(</span><span class="ident" id="3016281">nil</span><span class="op" id="3016284">)</span><span class="op" id="3016285">,</span>&nbsp;<span class="ident" id="3016287">s</span><span class="op" id="3016288">[</span><span class="num" id="3016289">0</span><span class="op" id="3016290">]</span><span class="op" id="3016291">...</span><span class="op" id="3016294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016300">n</span>&nbsp;<span class="op" id="3016302">:=</span>&nbsp;<span class="builtinfunc" id="3016305">len</span><span class="op" id="3016308">(</span><span class="ident" id="3016309">sep</span><span class="op" id="3016312">)</span>&nbsp;<span class="op" id="3016314">*</span>&nbsp;<span class="op" id="3016316">(</span><span class="builtinfunc" id="3016317">len</span><span class="op" id="3016320">(</span><span class="ident" id="3016321">s</span><span class="op" id="3016322">)</span>&nbsp;<span class="op" id="3016324">-</span>&nbsp;<span class="num" id="3016326">1</span><span class="op" id="3016327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016330">for</span>&nbsp;<span class="ident" id="3016334">_</span><span class="op" id="3016335">,</span>&nbsp;<span class="ident" id="3016337">v</span>&nbsp;<span class="op" id="3016339">:=</span>&nbsp;<span class="keyword" id="3016342">range</span>&nbsp;<span class="ident" id="3016348">s</span>&nbsp;<span class="op" id="3016350">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016354">n</span>&nbsp;<span class="op" id="3016356">+=</span>&nbsp;<span class="builtinfunc" id="3016359">len</span><span class="op" id="3016362">(</span><span class="ident" id="3016363">v</span><span class="op" id="3016364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016371">b</span>&nbsp;<span class="op" id="3016373">:=</span>&nbsp;<span class="builtinfunc" id="3016376">make</span><span class="op" id="3016380">(</span><span class="op" id="3016381">[</span><span class="op" id="3016382">]</span><span class="builtintype" id="3016383">byte</span><span class="op" id="3016387">,</span>&nbsp;<span class="ident" id="3016389">n</span><span class="op" id="3016390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016393">bp</span>&nbsp;<span class="op" id="3016396">:=</span>&nbsp;<span class="builtinfunc" id="3016399">copy</span><span class="op" id="3016403">(</span><span class="ident" id="3016404">b</span><span class="op" id="3016405">,</span>&nbsp;<span class="ident" id="3016407">s</span><span class="op" id="3016408">[</span><span class="num" id="3016409">0</span><span class="op" id="3016410">]</span><span class="op" id="3016411">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016414">for</span>&nbsp;<span class="ident" id="3016418">_</span><span class="op" id="3016419">,</span>&nbsp;<span class="ident" id="3016421">v</span>&nbsp;<span class="op" id="3016423">:=</span>&nbsp;<span class="keyword" id="3016426">range</span>&nbsp;<span class="ident" id="3016432">s</span><span class="op" id="3016433">[</span><span class="num" id="3016434">1</span><span class="op" id="3016435">:</span><span class="op" id="3016436">]</span>&nbsp;<span class="op" id="3016438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016442">bp</span>&nbsp;<span class="op" id="3016445">+=</span>&nbsp;<span class="builtinfunc" id="3016448">copy</span><span class="op" id="3016452">(</span><span class="ident" id="3016453">b</span><span class="op" id="3016454">[</span><span class="ident" id="3016455">bp</span><span class="op" id="3016457">:</span><span class="op" id="3016458">]</span><span class="op" id="3016459">,</span>&nbsp;<span class="ident" id="3016461">sep</span><span class="op" id="3016464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016468">bp</span>&nbsp;<span class="op" id="3016471">+=</span>&nbsp;<span class="builtinfunc" id="3016474">copy</span><span class="op" id="3016478">(</span><span class="ident" id="3016479">b</span><span class="op" id="3016480">[</span><span class="ident" id="3016481">bp</span><span class="op" id="3016483">:</span><span class="op" id="3016484">]</span><span class="op" id="3016485">,</span>&nbsp;<span class="ident" id="3016487">v</span><span class="op" id="3016488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016494">return</span>&nbsp;<span class="ident" id="3016501">b</span><br>
<span class="lineno">330</span><span class="op" id="3016503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3016506">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="3016570">func</span>&nbsp;<span class="ident" id="3016575">HasPrefix</span><span class="op" id="3016584">(</span><span class="ident" id="3016585">s</span><span class="op" id="3016586">,</span>&nbsp;<span class="ident" id="3016588">prefix</span>&nbsp;<span class="op" id="3016595">[</span><span class="op" id="3016596">]</span><span class="builtintype" id="3016597">byte</span><span class="op" id="3016601">)</span>&nbsp;<span class="builtintype" id="3016603">bool</span>&nbsp;<span class="op" id="3016608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016611">return</span>&nbsp;<span class="builtinfunc" id="3016618">len</span><span class="op" id="3016621">(</span><span class="ident" id="3016622">s</span><span class="op" id="3016623">)</span>&nbsp;<span class="op" id="3016625">&gt;=</span>&nbsp;<span class="builtinfunc" id="3016628">len</span><span class="op" id="3016631">(</span><span class="ident" id="3016632">prefix</span><span class="op" id="3016638">)</span>&nbsp;<span class="op" id="3016640">&amp;&amp;</span>&nbsp;<span class="ident" id="3016643">Equal</span><span class="op" id="3016648">(</span><span class="ident" id="3016649">s</span><span class="op" id="3016650">[</span><span class="num" id="3016651">0</span><span class="op" id="3016652">:</span><span class="builtinfunc" id="3016653">len</span><span class="op" id="3016656">(</span><span class="ident" id="3016657">prefix</span><span class="op" id="3016663">)</span><span class="op" id="3016664">]</span><span class="op" id="3016665">,</span>&nbsp;<span class="ident" id="3016667">prefix</span><span class="op" id="3016673">)</span><br>
<span class="lineno">335</span><span class="op" id="3016675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3016678">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="3016740">func</span>&nbsp;<span class="ident" id="3016745">HasSuffix</span><span class="op" id="3016754">(</span><span class="ident" id="3016755">s</span><span class="op" id="3016756">,</span>&nbsp;<span class="ident" id="3016758">suffix</span>&nbsp;<span class="op" id="3016765">[</span><span class="op" id="3016766">]</span><span class="builtintype" id="3016767">byte</span><span class="op" id="3016771">)</span>&nbsp;<span class="builtintype" id="3016773">bool</span>&nbsp;<span class="op" id="3016778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016781">return</span>&nbsp;<span class="builtinfunc" id="3016788">len</span><span class="op" id="3016791">(</span><span class="ident" id="3016792">s</span><span class="op" id="3016793">)</span>&nbsp;<span class="op" id="3016795">&gt;=</span>&nbsp;<span class="builtinfunc" id="3016798">len</span><span class="op" id="3016801">(</span><span class="ident" id="3016802">suffix</span><span class="op" id="3016808">)</span>&nbsp;<span class="op" id="3016810">&amp;&amp;</span>&nbsp;<span class="ident" id="3016813">Equal</span><span class="op" id="3016818">(</span><span class="ident" id="3016819">s</span><span class="op" id="3016820">[</span><span class="builtinfunc" id="3016821">len</span><span class="op" id="3016824">(</span><span class="ident" id="3016825">s</span><span class="op" id="3016826">)</span><span class="op" id="3016827">-</span><span class="builtinfunc" id="3016828">len</span><span class="op" id="3016831">(</span><span class="ident" id="3016832">suffix</span><span class="op" id="3016838">)</span><span class="op" id="3016839">:</span><span class="op" id="3016840">]</span><span class="op" id="3016841">,</span>&nbsp;<span class="ident" id="3016843">suffix</span><span class="op" id="3016849">)</span><br>
<span class="lineno">340</span><span class="op" id="3016851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3016854">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="3016929">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3017021">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="3017098">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="3017162">func</span>&nbsp;<span class="ident" id="3017167">Map</span><span class="op" id="3017170">(</span><span class="ident" id="3017171">mapping</span>&nbsp;<span class="keyword" id="3017179">func</span><span class="op" id="3017183">(</span><span class="ident" id="3017184">r</span>&nbsp;<span class="builtintype" id="3017186">rune</span><span class="op" id="3017190">)</span>&nbsp;<span class="builtintype" id="3017192">rune</span><span class="op" id="3017196">,</span>&nbsp;<span class="ident" id="3017198">s</span>&nbsp;<span class="op" id="3017200">[</span><span class="op" id="3017201">]</span><span class="builtintype" id="3017202">byte</span><span class="op" id="3017206">)</span>&nbsp;<span class="op" id="3017208">[</span><span class="op" id="3017209">]</span><span class="builtintype" id="3017210">byte</span>&nbsp;<span class="op" id="3017215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017218">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017280">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017347">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017409">maxbytes</span>&nbsp;<span class="op" id="3017418">:=</span>&nbsp;<span class="builtinfunc" id="3017421">len</span><span class="op" id="3017424">(</span><span class="ident" id="3017425">s</span><span class="op" id="3017426">)</span>&nbsp;<span class="comment" id="3017428">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017444">nbytes</span>&nbsp;<span class="op" id="3017451">:=</span>&nbsp;<span class="num" id="3017454">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3017463">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017496">b</span>&nbsp;<span class="op" id="3017498">:=</span>&nbsp;<span class="builtinfunc" id="3017501">make</span><span class="op" id="3017505">(</span><span class="op" id="3017506">[</span><span class="op" id="3017507">]</span><span class="builtintype" id="3017508">byte</span><span class="op" id="3017512">,</span>&nbsp;<span class="ident" id="3017514">maxbytes</span><span class="op" id="3017522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017525">for</span>&nbsp;<span class="ident" id="3017529">i</span>&nbsp;<span class="op" id="3017531">:=</span>&nbsp;<span class="num" id="3017534">0</span><span class="op" id="3017535">;</span>&nbsp;<span class="ident" id="3017537">i</span>&nbsp;<span class="op" id="3017539">&lt;</span>&nbsp;<span class="builtinfunc" id="3017541">len</span><span class="op" id="3017544">(</span><span class="ident" id="3017545">s</span><span class="op" id="3017546">)</span><span class="op" id="3017547">;</span>&nbsp;<span class="op" id="3017549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017553">wid</span>&nbsp;<span class="op" id="3017557">:=</span>&nbsp;<span class="num" id="3017560">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017564">r</span>&nbsp;<span class="op" id="3017566">:=</span>&nbsp;<span class="builtintype" id="3017569">rune</span><span class="op" id="3017573">(</span><span class="ident" id="3017574">s</span><span class="op" id="3017575">[</span><span class="ident" id="3017576">i</span><span class="op" id="3017577">]</span><span class="op" id="3017578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017582">if</span>&nbsp;<span class="ident" id="3017585">r</span>&nbsp;<span class="op" id="3017587">&gt;=</span>&nbsp;<span class="ident" id="3017590">utf8</span><span class="op" id="3017594">.</span><span class="ident" id="3017595">RuneSelf</span>&nbsp;<span class="op" id="3017604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017609">r</span><span class="op" id="3017610">,</span>&nbsp;<span class="ident" id="3017612">wid</span>&nbsp;<span class="op" id="3017616">=</span>&nbsp;<span class="ident" id="3017618">utf8</span><span class="op" id="3017622">.</span><span class="ident" id="3017623">DecodeRune</span><span class="op" id="3017633">(</span><span class="ident" id="3017634">s</span><span class="op" id="3017635">[</span><span class="ident" id="3017636">i</span><span class="op" id="3017637">:</span><span class="op" id="3017638">]</span><span class="op" id="3017639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017647">r</span>&nbsp;<span class="op" id="3017649">=</span>&nbsp;<span class="ident" id="3017651">mapping</span><span class="op" id="3017658">(</span><span class="ident" id="3017659">r</span><span class="op" id="3017660">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017664">if</span>&nbsp;<span class="ident" id="3017667">r</span>&nbsp;<span class="op" id="3017669">&gt;=</span>&nbsp;<span class="num" id="3017672">0</span>&nbsp;<span class="op" id="3017674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017679">rl</span>&nbsp;<span class="op" id="3017682">:=</span>&nbsp;<span class="ident" id="3017685">utf8</span><span class="op" id="3017689">.</span><span class="ident" id="3017690">RuneLen</span><span class="op" id="3017697">(</span><span class="ident" id="3017698">r</span><span class="op" id="3017699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017704">if</span>&nbsp;<span class="ident" id="3017707">rl</span>&nbsp;<span class="op" id="3017710">&lt;</span>&nbsp;<span class="num" id="3017712">0</span>&nbsp;<span class="op" id="3017714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017720">rl</span>&nbsp;<span class="op" id="3017723">=</span>&nbsp;<span class="builtinfunc" id="3017725">len</span><span class="op" id="3017728">(</span><span class="builtintype" id="3017729">string</span><span class="op" id="3017735">(</span><span class="ident" id="3017736">utf8</span><span class="op" id="3017740">.</span><span class="ident" id="3017741">RuneError</span><span class="op" id="3017750">)</span><span class="op" id="3017751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017756">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017761">if</span>&nbsp;<span class="ident" id="3017764">nbytes</span><span class="op" id="3017770">+</span><span class="ident" id="3017771">rl</span>&nbsp;<span class="op" id="3017774">&gt;</span>&nbsp;<span class="ident" id="3017776">maxbytes</span>&nbsp;<span class="op" id="3017785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017791">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017815">maxbytes</span>&nbsp;<span class="op" id="3017824">=</span>&nbsp;<span class="ident" id="3017826">maxbytes</span><span class="op" id="3017834">*</span><span class="num" id="3017835">2</span>&nbsp;<span class="op" id="3017837">+</span>&nbsp;<span class="ident" id="3017839">utf8</span><span class="op" id="3017843">.</span><span class="ident" id="3017844">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017855">nb</span>&nbsp;<span class="op" id="3017858">:=</span>&nbsp;<span class="builtinfunc" id="3017861">make</span><span class="op" id="3017865">(</span><span class="op" id="3017866">[</span><span class="op" id="3017867">]</span><span class="builtintype" id="3017868">byte</span><span class="op" id="3017872">,</span>&nbsp;<span class="ident" id="3017874">maxbytes</span><span class="op" id="3017882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3017888">copy</span><span class="op" id="3017892">(</span><span class="ident" id="3017893">nb</span><span class="op" id="3017895">,</span>&nbsp;<span class="ident" id="3017897">b</span><span class="op" id="3017898">[</span><span class="num" id="3017899">0</span><span class="op" id="3017900">:</span><span class="ident" id="3017901">nbytes</span><span class="op" id="3017907">]</span><span class="op" id="3017908">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017914">b</span>&nbsp;<span class="op" id="3017916">=</span>&nbsp;<span class="ident" id="3017918">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017929">nbytes</span>&nbsp;<span class="op" id="3017936">+=</span>&nbsp;<span class="ident" id="3017939">utf8</span><span class="op" id="3017943">.</span><span class="ident" id="3017944">EncodeRune</span><span class="op" id="3017954">(</span><span class="ident" id="3017955">b</span><span class="op" id="3017956">[</span><span class="ident" id="3017957">nbytes</span><span class="op" id="3017963">:</span><span class="ident" id="3017964">maxbytes</span><span class="op" id="3017972">]</span><span class="op" id="3017973">,</span>&nbsp;<span class="ident" id="3017975">r</span><span class="op" id="3017976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017984">i</span>&nbsp;<span class="op" id="3017986">+=</span>&nbsp;<span class="ident" id="3017989">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017997">return</span>&nbsp;<span class="ident" id="3018004">b</span><span class="op" id="3018005">[</span><span class="num" id="3018006">0</span><span class="op" id="3018007">:</span><span class="ident" id="3018008">nbytes</span><span class="op" id="3018014">]</span><br>
<span class="lineno"></span><span class="op" id="3018016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3018019">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="3018087">func</span>&nbsp;<span class="ident" id="3018092">Repeat</span><span class="op" id="3018098">(</span><span class="ident" id="3018099">b</span>&nbsp;<span class="op" id="3018101">[</span><span class="op" id="3018102">]</span><span class="builtintype" id="3018103">byte</span><span class="op" id="3018107">,</span>&nbsp;<span class="ident" id="3018109">count</span>&nbsp;<span class="builtintype" id="3018115">int</span><span class="op" id="3018118">)</span>&nbsp;<span class="op" id="3018120">[</span><span class="op" id="3018121">]</span><span class="builtintype" id="3018122">byte</span>&nbsp;<span class="op" id="3018127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018130">nb</span>&nbsp;<span class="op" id="3018133">:=</span>&nbsp;<span class="builtinfunc" id="3018136">make</span><span class="op" id="3018140">(</span><span class="op" id="3018141">[</span><span class="op" id="3018142">]</span><span class="builtintype" id="3018143">byte</span><span class="op" id="3018147">,</span>&nbsp;<span class="builtinfunc" id="3018149">len</span><span class="op" id="3018152">(</span><span class="ident" id="3018153">b</span><span class="op" id="3018154">)</span><span class="op" id="3018155">*</span><span class="ident" id="3018156">count</span><span class="op" id="3018161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018164">bp</span>&nbsp;<span class="op" id="3018167">:=</span>&nbsp;<span class="builtinfunc" id="3018170">copy</span><span class="op" id="3018174">(</span><span class="ident" id="3018175">nb</span><span class="op" id="3018177">,</span>&nbsp;<span class="ident" id="3018179">b</span><span class="op" id="3018180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018183">for</span>&nbsp;<span class="ident" id="3018187">bp</span>&nbsp;<span class="op" id="3018190">&lt;</span>&nbsp;<span class="builtinfunc" id="3018192">len</span><span class="op" id="3018195">(</span><span class="ident" id="3018196">nb</span><span class="op" id="3018198">)</span>&nbsp;<span class="op" id="3018200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3018204">copy</span><span class="op" id="3018208">(</span><span class="ident" id="3018209">nb</span><span class="op" id="3018211">[</span><span class="ident" id="3018212">bp</span><span class="op" id="3018214">:</span><span class="op" id="3018215">]</span><span class="op" id="3018216">,</span>&nbsp;<span class="ident" id="3018218">nb</span><span class="op" id="3018220">[</span><span class="op" id="3018221">:</span><span class="ident" id="3018222">bp</span><span class="op" id="3018224">]</span><span class="op" id="3018225">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018229">bp</span>&nbsp;<span class="op" id="3018232">*=</span>&nbsp;<span class="num" id="3018235">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018241">return</span>&nbsp;<span class="ident" id="3018248">nb</span><br>
<span class="lineno"></span><span class="op" id="3018251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="3018254">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="3018353">func</span>&nbsp;<span class="ident" id="3018358">ToUpper</span><span class="op" id="3018365">(</span><span class="ident" id="3018366">s</span>&nbsp;<span class="op" id="3018368">[</span><span class="op" id="3018369">]</span><span class="builtintype" id="3018370">byte</span><span class="op" id="3018374">)</span>&nbsp;<span class="op" id="3018376">[</span><span class="op" id="3018377">]</span><span class="builtintype" id="3018378">byte</span>&nbsp;<span class="op" id="3018383">{</span>&nbsp;<span class="keyword" id="3018385">return</span>&nbsp;<span class="ident" id="3018392">Map</span><span class="op" id="3018395">(</span><span class="ident" id="3018396">unicode</span><span class="op" id="3018403">.</span><span class="ident" id="3018404">ToUpper</span><span class="op" id="3018411">,</span>&nbsp;<span class="ident" id="3018413">s</span><span class="op" id="3018414">)</span>&nbsp;<span class="op" id="3018416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3018419">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="3018518">func</span>&nbsp;<span class="ident" id="3018523">ToLower</span><span class="op" id="3018530">(</span><span class="ident" id="3018531">s</span>&nbsp;<span class="op" id="3018533">[</span><span class="op" id="3018534">]</span><span class="builtintype" id="3018535">byte</span><span class="op" id="3018539">)</span>&nbsp;<span class="op" id="3018541">[</span><span class="op" id="3018542">]</span><span class="builtintype" id="3018543">byte</span>&nbsp;<span class="op" id="3018548">{</span>&nbsp;<span class="keyword" id="3018550">return</span>&nbsp;<span class="ident" id="3018557">Map</span><span class="op" id="3018560">(</span><span class="ident" id="3018561">unicode</span><span class="op" id="3018568">.</span><span class="ident" id="3018569">ToLower</span><span class="op" id="3018576">,</span>&nbsp;<span class="ident" id="3018578">s</span><span class="op" id="3018579">)</span>&nbsp;<span class="op" id="3018581">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="3018584">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="3018683">func</span>&nbsp;<span class="ident" id="3018688">ToTitle</span><span class="op" id="3018695">(</span><span class="ident" id="3018696">s</span>&nbsp;<span class="op" id="3018698">[</span><span class="op" id="3018699">]</span><span class="builtintype" id="3018700">byte</span><span class="op" id="3018704">)</span>&nbsp;<span class="op" id="3018706">[</span><span class="op" id="3018707">]</span><span class="builtintype" id="3018708">byte</span>&nbsp;<span class="op" id="3018713">{</span>&nbsp;<span class="keyword" id="3018715">return</span>&nbsp;<span class="ident" id="3018722">Map</span><span class="op" id="3018725">(</span><span class="ident" id="3018726">unicode</span><span class="op" id="3018733">.</span><span class="ident" id="3018734">ToTitle</span><span class="op" id="3018741">,</span>&nbsp;<span class="ident" id="3018743">s</span><span class="op" id="3018744">)</span>&nbsp;<span class="op" id="3018746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3018749">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="3018843">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="3018903">func</span>&nbsp;<span class="ident" id="3018908">ToUpperSpecial</span><span class="op" id="3018922">(</span><span class="ident" id="3018923">_case</span>&nbsp;<span class="ident" id="3018929">unicode</span><span class="op" id="3018936">.</span><span class="ident" id="3018937">SpecialCase</span><span class="op" id="3018948">,</span>&nbsp;<span class="ident" id="3018950">s</span>&nbsp;<span class="op" id="3018952">[</span><span class="op" id="3018953">]</span><span class="builtintype" id="3018954">byte</span><span class="op" id="3018958">)</span>&nbsp;<span class="op" id="3018960">[</span><span class="op" id="3018961">]</span><span class="builtintype" id="3018962">byte</span>&nbsp;<span class="op" id="3018967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018970">return</span>&nbsp;<span class="ident" id="3018977">Map</span><span class="op" id="3018980">(</span><span class="keyword" id="3018981">func</span><span class="op" id="3018985">(</span><span class="ident" id="3018986">r</span>&nbsp;<span class="builtintype" id="3018988">rune</span><span class="op" id="3018992">)</span>&nbsp;<span class="builtintype" id="3018994">rune</span>&nbsp;<span class="op" id="3018999">{</span>&nbsp;<span class="keyword" id="3019001">return</span>&nbsp;<span class="ident" id="3019008">_case</span><span class="op" id="3019013">.</span><span class="ident" id="3019014">ToUpper</span><span class="op" id="3019021">(</span><span class="ident" id="3019022">r</span><span class="op" id="3019023">)</span>&nbsp;<span class="op" id="3019025">}</span><span class="op" id="3019026">,</span>&nbsp;<span class="ident" id="3019028">s</span><span class="op" id="3019029">)</span><br>
<span class="lineno"></span><span class="op" id="3019031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="3019034">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="3019128">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="3019188">func</span>&nbsp;<span class="ident" id="3019193">ToLowerSpecial</span><span class="op" id="3019207">(</span><span class="ident" id="3019208">_case</span>&nbsp;<span class="ident" id="3019214">unicode</span><span class="op" id="3019221">.</span><span class="ident" id="3019222">SpecialCase</span><span class="op" id="3019233">,</span>&nbsp;<span class="ident" id="3019235">s</span>&nbsp;<span class="op" id="3019237">[</span><span class="op" id="3019238">]</span><span class="builtintype" id="3019239">byte</span><span class="op" id="3019243">)</span>&nbsp;<span class="op" id="3019245">[</span><span class="op" id="3019246">]</span><span class="builtintype" id="3019247">byte</span>&nbsp;<span class="op" id="3019252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019255">return</span>&nbsp;<span class="ident" id="3019262">Map</span><span class="op" id="3019265">(</span><span class="keyword" id="3019266">func</span><span class="op" id="3019270">(</span><span class="ident" id="3019271">r</span>&nbsp;<span class="builtintype" id="3019273">rune</span><span class="op" id="3019277">)</span>&nbsp;<span class="builtintype" id="3019279">rune</span>&nbsp;<span class="op" id="3019284">{</span>&nbsp;<span class="keyword" id="3019286">return</span>&nbsp;<span class="ident" id="3019293">_case</span><span class="op" id="3019298">.</span><span class="ident" id="3019299">ToLower</span><span class="op" id="3019306">(</span><span class="ident" id="3019307">r</span><span class="op" id="3019308">)</span>&nbsp;<span class="op" id="3019310">}</span><span class="op" id="3019311">,</span>&nbsp;<span class="ident" id="3019313">s</span><span class="op" id="3019314">)</span><br>
<span class="lineno"></span><span class="op" id="3019316">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="3019319">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="3019413">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="3019473">func</span>&nbsp;<span class="ident" id="3019478">ToTitleSpecial</span><span class="op" id="3019492">(</span><span class="ident" id="3019493">_case</span>&nbsp;<span class="ident" id="3019499">unicode</span><span class="op" id="3019506">.</span><span class="ident" id="3019507">SpecialCase</span><span class="op" id="3019518">,</span>&nbsp;<span class="ident" id="3019520">s</span>&nbsp;<span class="op" id="3019522">[</span><span class="op" id="3019523">]</span><span class="builtintype" id="3019524">byte</span><span class="op" id="3019528">)</span>&nbsp;<span class="op" id="3019530">[</span><span class="op" id="3019531">]</span><span class="builtintype" id="3019532">byte</span>&nbsp;<span class="op" id="3019537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019540">return</span>&nbsp;<span class="ident" id="3019547">Map</span><span class="op" id="3019550">(</span><span class="keyword" id="3019551">func</span><span class="op" id="3019555">(</span><span class="ident" id="3019556">r</span>&nbsp;<span class="builtintype" id="3019558">rune</span><span class="op" id="3019562">)</span>&nbsp;<span class="builtintype" id="3019564">rune</span>&nbsp;<span class="op" id="3019569">{</span>&nbsp;<span class="keyword" id="3019571">return</span>&nbsp;<span class="ident" id="3019578">_case</span><span class="op" id="3019583">.</span><span class="ident" id="3019584">ToTitle</span><span class="op" id="3019591">(</span><span class="ident" id="3019592">r</span><span class="op" id="3019593">)</span>&nbsp;<span class="op" id="3019595">}</span><span class="op" id="3019596">,</span>&nbsp;<span class="ident" id="3019598">s</span><span class="op" id="3019599">)</span><br>
<span class="lineno">415</span><span class="op" id="3019601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3019604">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="3019672">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="3019742">func</span>&nbsp;<span class="ident" id="3019747">isSeparator</span><span class="op" id="3019758">(</span><span class="ident" id="3019759">r</span>&nbsp;<span class="builtintype" id="3019761">rune</span><span class="op" id="3019765">)</span>&nbsp;<span class="builtintype" id="3019767">bool</span>&nbsp;<span class="op" id="3019772">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3019775">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019833">if</span>&nbsp;<span class="ident" id="3019836">r</span>&nbsp;<span class="op" id="3019838">&lt;=</span>&nbsp;<span class="num" id="3019841">0x7F</span>&nbsp;<span class="op" id="3019846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019850">switch</span>&nbsp;<span class="op" id="3019857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019861">case</span>&nbsp;<span class="string" id="3019866">&#39;0&#39;</span>&nbsp;<span class="op" id="3019870">&lt;=</span>&nbsp;<span class="ident" id="3019873">r</span>&nbsp;<span class="op" id="3019875">&amp;&amp;</span>&nbsp;<span class="ident" id="3019878">r</span>&nbsp;<span class="op" id="3019880">&lt;=</span>&nbsp;<span class="string" id="3019883">&#39;9&#39;</span><span class="op" id="3019886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019891">return</span>&nbsp;<span class="ident" id="3019898">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019906">case</span>&nbsp;<span class="string" id="3019911">&#39;a&#39;</span>&nbsp;<span class="op" id="3019915">&lt;=</span>&nbsp;<span class="ident" id="3019918">r</span>&nbsp;<span class="op" id="3019920">&amp;&amp;</span>&nbsp;<span class="ident" id="3019923">r</span>&nbsp;<span class="op" id="3019925">&lt;=</span>&nbsp;<span class="string" id="3019928">&#39;z&#39;</span><span class="op" id="3019931">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019936">return</span>&nbsp;<span class="ident" id="3019943">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019951">case</span>&nbsp;<span class="string" id="3019956">&#39;A&#39;</span>&nbsp;<span class="op" id="3019960">&lt;=</span>&nbsp;<span class="ident" id="3019963">r</span>&nbsp;<span class="op" id="3019965">&amp;&amp;</span>&nbsp;<span class="ident" id="3019968">r</span>&nbsp;<span class="op" id="3019970">&lt;=</span>&nbsp;<span class="string" id="3019973">&#39;Z&#39;</span><span class="op" id="3019976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019981">return</span>&nbsp;<span class="ident" id="3019988">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019996">case</span>&nbsp;<span class="ident" id="3020001">r</span>&nbsp;<span class="op" id="3020003">==</span>&nbsp;<span class="string" id="3020006">&#39;_&#39;</span><span class="op" id="3020009">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020014">return</span>&nbsp;<span class="ident" id="3020021">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020033">return</span>&nbsp;<span class="ident" id="3020040">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020049">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020091">if</span>&nbsp;<span class="ident" id="3020094">unicode</span><span class="op" id="3020101">.</span><span class="ident" id="3020102">IsLetter</span><span class="op" id="3020110">(</span><span class="ident" id="3020111">r</span><span class="op" id="3020112">)</span>&nbsp;<span class="op" id="3020114">||</span>&nbsp;<span class="ident" id="3020117">unicode</span><span class="op" id="3020124">.</span><span class="ident" id="3020125">IsDigit</span><span class="op" id="3020132">(</span><span class="ident" id="3020133">r</span><span class="op" id="3020134">)</span>&nbsp;<span class="op" id="3020136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020140">return</span>&nbsp;<span class="ident" id="3020147">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020157">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020225">return</span>&nbsp;<span class="ident" id="3020232">unicode</span><span class="op" id="3020239">.</span><span class="ident" id="3020240">IsSpace</span><span class="op" id="3020247">(</span><span class="ident" id="3020248">r</span><span class="op" id="3020249">)</span><br>
<span class="lineno">440</span><span class="op" id="3020251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3020254">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="3020325">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="3020356">//</span><br>
<span class="lineno">445</span><span class="comment" id="3020359">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="3020453">func</span>&nbsp;<span class="ident" id="3020458">Title</span><span class="op" id="3020463">(</span><span class="ident" id="3020464">s</span>&nbsp;<span class="op" id="3020466">[</span><span class="op" id="3020467">]</span><span class="builtintype" id="3020468">byte</span><span class="op" id="3020472">)</span>&nbsp;<span class="op" id="3020474">[</span><span class="op" id="3020475">]</span><span class="builtintype" id="3020476">byte</span>&nbsp;<span class="op" id="3020481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020484">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020526">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3020598">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020629">prev</span>&nbsp;<span class="op" id="3020634">:=</span>&nbsp;<span class="string" id="3020637">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020642">return</span>&nbsp;<span class="ident" id="3020649">Map</span><span class="op" id="3020652">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020656">func</span><span class="op" id="3020660">(</span><span class="ident" id="3020661">r</span>&nbsp;<span class="builtintype" id="3020663">rune</span><span class="op" id="3020667">)</span>&nbsp;<span class="builtintype" id="3020669">rune</span>&nbsp;<span class="op" id="3020674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020679">if</span>&nbsp;<span class="ident" id="3020682">isSeparator</span><span class="op" id="3020693">(</span><span class="ident" id="3020694">prev</span><span class="op" id="3020698">)</span>&nbsp;<span class="op" id="3020700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020706">prev</span>&nbsp;<span class="op" id="3020711">=</span>&nbsp;<span class="ident" id="3020713">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020719">return</span>&nbsp;<span class="ident" id="3020726">unicode</span><span class="op" id="3020733">.</span><span class="ident" id="3020734">ToTitle</span><span class="op" id="3020741">(</span><span class="ident" id="3020742">r</span><span class="op" id="3020743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020753">prev</span>&nbsp;<span class="op" id="3020758">=</span>&nbsp;<span class="ident" id="3020760">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020765">return</span>&nbsp;<span class="ident" id="3020772">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020776">}</span><span class="op" id="3020777">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020781">s</span><span class="op" id="3020782">)</span><br>
<span class="lineno"></span><span class="op" id="3020784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3020787">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="3020868">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="3020912">func</span>&nbsp;<span class="ident" id="3020917">TrimLeftFunc</span><span class="op" id="3020929">(</span><span class="ident" id="3020930">s</span>&nbsp;<span class="op" id="3020932">[</span><span class="op" id="3020933">]</span><span class="builtintype" id="3020934">byte</span><span class="op" id="3020938">,</span>&nbsp;<span class="ident" id="3020940">f</span>&nbsp;<span class="keyword" id="3020942">func</span><span class="op" id="3020946">(</span><span class="ident" id="3020947">r</span>&nbsp;<span class="builtintype" id="3020949">rune</span><span class="op" id="3020953">)</span>&nbsp;<span class="builtintype" id="3020955">bool</span><span class="op" id="3020959">)</span>&nbsp;<span class="op" id="3020961">[</span><span class="op" id="3020962">]</span><span class="builtintype" id="3020963">byte</span>&nbsp;<span class="op" id="3020968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020971">i</span>&nbsp;<span class="op" id="3020973">:=</span>&nbsp;<span class="ident" id="3020976">indexFunc</span><span class="op" id="3020985">(</span><span class="ident" id="3020986">s</span><span class="op" id="3020987">,</span>&nbsp;<span class="ident" id="3020989">f</span><span class="op" id="3020990">,</span>&nbsp;<span class="ident" id="3020992">false</span><span class="op" id="3020997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021000">if</span>&nbsp;<span class="ident" id="3021003">i</span>&nbsp;<span class="op" id="3021005">==</span>&nbsp;<span class="op" id="3021008">-</span><span class="num" id="3021009">1</span>&nbsp;<span class="op" id="3021011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021015">return</span>&nbsp;<span class="ident" id="3021022">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3021027">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021030">return</span>&nbsp;<span class="ident" id="3021037">s</span><span class="op" id="3021038">[</span><span class="ident" id="3021039">i</span><span class="op" id="3021040">:</span><span class="op" id="3021041">]</span><br>
<span class="lineno"></span><span class="op" id="3021043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3021046">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="3021121">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="3021173">func</span>&nbsp;<span class="ident" id="3021178">TrimRightFunc</span><span class="op" id="3021191">(</span><span class="ident" id="3021192">s</span>&nbsp;<span class="op" id="3021194">[</span><span class="op" id="3021195">]</span><span class="builtintype" id="3021196">byte</span><span class="op" id="3021200">,</span>&nbsp;<span class="ident" id="3021202">f</span>&nbsp;<span class="keyword" id="3021204">func</span><span class="op" id="3021208">(</span><span class="ident" id="3021209">r</span>&nbsp;<span class="builtintype" id="3021211">rune</span><span class="op" id="3021215">)</span>&nbsp;<span class="builtintype" id="3021217">bool</span><span class="op" id="3021221">)</span>&nbsp;<span class="op" id="3021223">[</span><span class="op" id="3021224">]</span><span class="builtintype" id="3021225">byte</span>&nbsp;<span class="op" id="3021230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3021233">i</span>&nbsp;<span class="op" id="3021235">:=</span>&nbsp;<span class="ident" id="3021238">lastIndexFunc</span><span class="op" id="3021251">(</span><span class="ident" id="3021252">s</span><span class="op" id="3021253">,</span>&nbsp;<span class="ident" id="3021255">f</span><span class="op" id="3021256">,</span>&nbsp;<span class="ident" id="3021258">false</span><span class="op" id="3021263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021266">if</span>&nbsp;<span class="ident" id="3021269">i</span>&nbsp;<span class="op" id="3021271">&gt;=</span>&nbsp;<span class="num" id="3021274">0</span>&nbsp;<span class="op" id="3021276">&amp;&amp;</span>&nbsp;<span class="ident" id="3021279">s</span><span class="op" id="3021280">[</span><span class="ident" id="3021281">i</span><span class="op" id="3021282">]</span>&nbsp;<span class="op" id="3021284">&gt;=</span>&nbsp;<span class="ident" id="3021287">utf8</span><span class="op" id="3021291">.</span><span class="ident" id="3021292">RuneSelf</span>&nbsp;<span class="op" id="3021301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3021305">_</span><span class="op" id="3021306">,</span>&nbsp;<span class="ident" id="3021308">wid</span>&nbsp;<span class="op" id="3021312">:=</span>&nbsp;<span class="ident" id="3021315">utf8</span><span class="op" id="3021319">.</span><span class="ident" id="3021320">DecodeRune</span><span class="op" id="3021330">(</span><span class="ident" id="3021331">s</span><span class="op" id="3021332">[</span><span class="ident" id="3021333">i</span><span class="op" id="3021334">:</span><span class="op" id="3021335">]</span><span class="op" id="3021336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3021340">i</span>&nbsp;<span class="op" id="3021342">+=</span>&nbsp;<span class="ident" id="3021345">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3021350">}</span>&nbsp;<span class="keyword" id="3021352">else</span>&nbsp;<span class="op" id="3021357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3021361">i</span><span class="op" id="3021362">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3021366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021369">return</span>&nbsp;<span class="ident" id="3021376">s</span><span class="op" id="3021377">[</span><span class="num" id="3021378">0</span><span class="op" id="3021379">:</span><span class="ident" id="3021380">i</span><span class="op" id="3021381">]</span><br>
<span class="lineno"></span><span class="op" id="3021383">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="3021386">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3021462">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="3021520">func</span>&nbsp;<span class="ident" id="3021525">TrimFunc</span><span class="op" id="3021533">(</span><span class="ident" id="3021534">s</span>&nbsp;<span class="op" id="3021536">[</span><span class="op" id="3021537">]</span><span class="builtintype" id="3021538">byte</span><span class="op" id="3021542">,</span>&nbsp;<span class="ident" id="3021544">f</span>&nbsp;<span class="keyword" id="3021546">func</span><span class="op" id="3021550">(</span><span class="ident" id="3021551">r</span>&nbsp;<span class="builtintype" id="3021553">rune</span><span class="op" id="3021557">)</span>&nbsp;<span class="builtintype" id="3021559">bool</span><span class="op" id="3021563">)</span>&nbsp;<span class="op" id="3021565">[</span><span class="op" id="3021566">]</span><span class="builtintype" id="3021567">byte</span>&nbsp;<span class="op" id="3021572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021575">return</span>&nbsp;<span class="ident" id="3021582">TrimRightFunc</span><span class="op" id="3021595">(</span><span class="ident" id="3021596">TrimLeftFunc</span><span class="op" id="3021608">(</span><span class="ident" id="3021609">s</span><span class="op" id="3021610">,</span>&nbsp;<span class="ident" id="3021612">f</span><span class="op" id="3021613">)</span><span class="op" id="3021614">,</span>&nbsp;<span class="ident" id="3021616">f</span><span class="op" id="3021617">)</span><br>
<span class="lineno">490</span><span class="op" id="3021619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3021622">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3021690">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="3021750">func</span>&nbsp;<span class="ident" id="3021755">TrimPrefix</span><span class="op" id="3021765">(</span><span class="ident" id="3021766">s</span><span class="op" id="3021767">,</span>&nbsp;<span class="ident" id="3021769">prefix</span>&nbsp;<span class="op" id="3021776">[</span><span class="op" id="3021777">]</span><span class="builtintype" id="3021778">byte</span><span class="op" id="3021782">)</span>&nbsp;<span class="op" id="3021784">[</span><span class="op" id="3021785">]</span><span class="builtintype" id="3021786">byte</span>&nbsp;<span class="op" id="3021791">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021794">if</span>&nbsp;<span class="ident" id="3021797">HasPrefix</span><span class="op" id="3021806">(</span><span class="ident" id="3021807">s</span><span class="op" id="3021808">,</span>&nbsp;<span class="ident" id="3021810">prefix</span><span class="op" id="3021816">)</span>&nbsp;<span class="op" id="3021818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021822">return</span>&nbsp;<span class="ident" id="3021829">s</span><span class="op" id="3021830">[</span><span class="builtinfunc" id="3021831">len</span><span class="op" id="3021834">(</span><span class="ident" id="3021835">prefix</span><span class="op" id="3021841">)</span><span class="op" id="3021842">:</span><span class="op" id="3021843">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3021846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3021849">return</span>&nbsp;<span class="ident" id="3021856">s</span><br>
<span class="lineno"></span><span class="op" id="3021858">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="3021861">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3021930">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="3021988">func</span>&nbsp;<span class="ident" id="3021993">TrimSuffix</span><span class="op" id="3022003">(</span><span class="ident" id="3022004">s</span><span class="op" id="3022005">,</span>&nbsp;<span class="ident" id="3022007">suffix</span>&nbsp;<span class="op" id="3022014">[</span><span class="op" id="3022015">]</span><span class="builtintype" id="3022016">byte</span><span class="op" id="3022020">)</span>&nbsp;<span class="op" id="3022022">[</span><span class="op" id="3022023">]</span><span class="builtintype" id="3022024">byte</span>&nbsp;<span class="op" id="3022029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022032">if</span>&nbsp;<span class="ident" id="3022035">HasSuffix</span><span class="op" id="3022044">(</span><span class="ident" id="3022045">s</span><span class="op" id="3022046">,</span>&nbsp;<span class="ident" id="3022048">suffix</span><span class="op" id="3022054">)</span>&nbsp;<span class="op" id="3022056">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022060">return</span>&nbsp;<span class="ident" id="3022067">s</span><span class="op" id="3022068">[</span><span class="op" id="3022069">:</span><span class="builtinfunc" id="3022070">len</span><span class="op" id="3022073">(</span><span class="ident" id="3022074">s</span><span class="op" id="3022075">)</span><span class="op" id="3022076">-</span><span class="builtinfunc" id="3022077">len</span><span class="op" id="3022080">(</span><span class="ident" id="3022081">suffix</span><span class="op" id="3022087">)</span><span class="op" id="3022088">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3022091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022094">return</span>&nbsp;<span class="ident" id="3022101">s</span><br>
<span class="lineno"></span><span class="op" id="3022103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="3022106">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="3022184">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="3022239">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="3022288">func</span>&nbsp;<span class="ident" id="3022293">IndexFunc</span><span class="op" id="3022302">(</span><span class="ident" id="3022303">s</span>&nbsp;<span class="op" id="3022305">[</span><span class="op" id="3022306">]</span><span class="builtintype" id="3022307">byte</span><span class="op" id="3022311">,</span>&nbsp;<span class="ident" id="3022313">f</span>&nbsp;<span class="keyword" id="3022315">func</span><span class="op" id="3022319">(</span><span class="ident" id="3022320">r</span>&nbsp;<span class="builtintype" id="3022322">rune</span><span class="op" id="3022326">)</span>&nbsp;<span class="builtintype" id="3022328">bool</span><span class="op" id="3022332">)</span>&nbsp;<span class="builtintype" id="3022334">int</span>&nbsp;<span class="op" id="3022338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022341">return</span>&nbsp;<span class="ident" id="3022348">indexFunc</span><span class="op" id="3022357">(</span><span class="ident" id="3022358">s</span><span class="op" id="3022359">,</span>&nbsp;<span class="ident" id="3022361">f</span><span class="op" id="3022362">,</span>&nbsp;<span class="ident" id="3022364">true</span><span class="op" id="3022368">)</span><br>
<span class="lineno">515</span><span class="op" id="3022370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3022373">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="3022455">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="3022509">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="3022558">func</span>&nbsp;<span class="ident" id="3022563">LastIndexFunc</span><span class="op" id="3022576">(</span><span class="ident" id="3022577">s</span>&nbsp;<span class="op" id="3022579">[</span><span class="op" id="3022580">]</span><span class="builtintype" id="3022581">byte</span><span class="op" id="3022585">,</span>&nbsp;<span class="ident" id="3022587">f</span>&nbsp;<span class="keyword" id="3022589">func</span><span class="op" id="3022593">(</span><span class="ident" id="3022594">r</span>&nbsp;<span class="builtintype" id="3022596">rune</span><span class="op" id="3022600">)</span>&nbsp;<span class="builtintype" id="3022602">bool</span><span class="op" id="3022606">)</span>&nbsp;<span class="builtintype" id="3022608">int</span>&nbsp;<span class="op" id="3022612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022615">return</span>&nbsp;<span class="ident" id="3022622">lastIndexFunc</span><span class="op" id="3022635">(</span><span class="ident" id="3022636">s</span><span class="op" id="3022637">,</span>&nbsp;<span class="ident" id="3022639">f</span><span class="op" id="3022640">,</span>&nbsp;<span class="ident" id="3022642">true</span><span class="op" id="3022646">)</span><br>
<span class="lineno"></span><span class="op" id="3022648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3022651">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="3022704">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3022760">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="3022773">func</span>&nbsp;<span class="ident" id="3022778">indexFunc</span><span class="op" id="3022787">(</span><span class="ident" id="3022788">s</span>&nbsp;<span class="op" id="3022790">[</span><span class="op" id="3022791">]</span><span class="builtintype" id="3022792">byte</span><span class="op" id="3022796">,</span>&nbsp;<span class="ident" id="3022798">f</span>&nbsp;<span class="keyword" id="3022800">func</span><span class="op" id="3022804">(</span><span class="ident" id="3022805">r</span>&nbsp;<span class="builtintype" id="3022807">rune</span><span class="op" id="3022811">)</span>&nbsp;<span class="builtintype" id="3022813">bool</span><span class="op" id="3022817">,</span>&nbsp;<span class="ident" id="3022819">truth</span>&nbsp;<span class="builtintype" id="3022825">bool</span><span class="op" id="3022829">)</span>&nbsp;<span class="builtintype" id="3022831">int</span>&nbsp;<span class="op" id="3022835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022838">start</span>&nbsp;<span class="op" id="3022844">:=</span>&nbsp;<span class="num" id="3022847">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022850">for</span>&nbsp;<span class="ident" id="3022854">start</span>&nbsp;<span class="op" id="3022860">&lt;</span>&nbsp;<span class="builtinfunc" id="3022862">len</span><span class="op" id="3022865">(</span><span class="ident" id="3022866">s</span><span class="op" id="3022867">)</span>&nbsp;<span class="op" id="3022869">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022873">wid</span>&nbsp;<span class="op" id="3022877">:=</span>&nbsp;<span class="num" id="3022880">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022884">r</span>&nbsp;<span class="op" id="3022886">:=</span>&nbsp;<span class="builtintype" id="3022889">rune</span><span class="op" id="3022893">(</span><span class="ident" id="3022894">s</span><span class="op" id="3022895">[</span><span class="ident" id="3022896">start</span><span class="op" id="3022901">]</span><span class="op" id="3022902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022906">if</span>&nbsp;<span class="ident" id="3022909">r</span>&nbsp;<span class="op" id="3022911">&gt;=</span>&nbsp;<span class="ident" id="3022914">utf8</span><span class="op" id="3022918">.</span><span class="ident" id="3022919">RuneSelf</span>&nbsp;<span class="op" id="3022928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022933">r</span><span class="op" id="3022934">,</span>&nbsp;<span class="ident" id="3022936">wid</span>&nbsp;<span class="op" id="3022940">=</span>&nbsp;<span class="ident" id="3022942">utf8</span><span class="op" id="3022946">.</span><span class="ident" id="3022947">DecodeRune</span><span class="op" id="3022957">(</span><span class="ident" id="3022958">s</span><span class="op" id="3022959">[</span><span class="ident" id="3022960">start</span><span class="op" id="3022965">:</span><span class="op" id="3022966">]</span><span class="op" id="3022967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3022971">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022975">if</span>&nbsp;<span class="ident" id="3022978">f</span><span class="op" id="3022979">(</span><span class="ident" id="3022980">r</span><span class="op" id="3022981">)</span>&nbsp;<span class="op" id="3022983">==</span>&nbsp;<span class="ident" id="3022986">truth</span>&nbsp;<span class="op" id="3022992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022997">return</span>&nbsp;<span class="ident" id="3023004">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023016">start</span>&nbsp;<span class="op" id="3023022">+=</span>&nbsp;<span class="ident" id="3023025">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023030">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023033">return</span>&nbsp;<span class="op" id="3023040">-</span><span class="num" id="3023041">1</span><br>
<span class="lineno"></span><span class="op" id="3023043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3023046">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3023107">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="3023163">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="3023176">func</span>&nbsp;<span class="ident" id="3023181">lastIndexFunc</span><span class="op" id="3023194">(</span><span class="ident" id="3023195">s</span>&nbsp;<span class="op" id="3023197">[</span><span class="op" id="3023198">]</span><span class="builtintype" id="3023199">byte</span><span class="op" id="3023203">,</span>&nbsp;<span class="ident" id="3023205">f</span>&nbsp;<span class="keyword" id="3023207">func</span><span class="op" id="3023211">(</span><span class="ident" id="3023212">r</span>&nbsp;<span class="builtintype" id="3023214">rune</span><span class="op" id="3023218">)</span>&nbsp;<span class="builtintype" id="3023220">bool</span><span class="op" id="3023224">,</span>&nbsp;<span class="ident" id="3023226">truth</span>&nbsp;<span class="builtintype" id="3023232">bool</span><span class="op" id="3023236">)</span>&nbsp;<span class="builtintype" id="3023238">int</span>&nbsp;<span class="op" id="3023242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023245">for</span>&nbsp;<span class="ident" id="3023249">i</span>&nbsp;<span class="op" id="3023251">:=</span>&nbsp;<span class="builtinfunc" id="3023254">len</span><span class="op" id="3023257">(</span><span class="ident" id="3023258">s</span><span class="op" id="3023259">)</span><span class="op" id="3023260">;</span>&nbsp;<span class="ident" id="3023262">i</span>&nbsp;<span class="op" id="3023264">&gt;</span>&nbsp;<span class="num" id="3023266">0</span><span class="op" id="3023267">;</span>&nbsp;<span class="op" id="3023269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023273">r</span><span class="op" id="3023274">,</span>&nbsp;<span class="ident" id="3023276">size</span>&nbsp;<span class="op" id="3023281">:=</span>&nbsp;<span class="builtintype" id="3023284">rune</span><span class="op" id="3023288">(</span><span class="ident" id="3023289">s</span><span class="op" id="3023290">[</span><span class="ident" id="3023291">i</span><span class="op" id="3023292">-</span><span class="num" id="3023293">1</span><span class="op" id="3023294">]</span><span class="op" id="3023295">)</span><span class="op" id="3023296">,</span>&nbsp;<span class="num" id="3023298">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023302">if</span>&nbsp;<span class="ident" id="3023305">r</span>&nbsp;<span class="op" id="3023307">&gt;=</span>&nbsp;<span class="ident" id="3023310">utf8</span><span class="op" id="3023314">.</span><span class="ident" id="3023315">RuneSelf</span>&nbsp;<span class="op" id="3023324">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023329">r</span><span class="op" id="3023330">,</span>&nbsp;<span class="ident" id="3023332">size</span>&nbsp;<span class="op" id="3023337">=</span>&nbsp;<span class="ident" id="3023339">utf8</span><span class="op" id="3023343">.</span><span class="ident" id="3023344">DecodeLastRune</span><span class="op" id="3023358">(</span><span class="ident" id="3023359">s</span><span class="op" id="3023360">[</span><span class="num" id="3023361">0</span><span class="op" id="3023362">:</span><span class="ident" id="3023363">i</span><span class="op" id="3023364">]</span><span class="op" id="3023365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023373">i</span>&nbsp;<span class="op" id="3023375">-=</span>&nbsp;<span class="ident" id="3023378">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023385">if</span>&nbsp;<span class="ident" id="3023388">f</span><span class="op" id="3023389">(</span><span class="ident" id="3023390">r</span><span class="op" id="3023391">)</span>&nbsp;<span class="op" id="3023393">==</span>&nbsp;<span class="ident" id="3023396">truth</span>&nbsp;<span class="op" id="3023402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023407">return</span>&nbsp;<span class="ident" id="3023414">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023424">return</span>&nbsp;<span class="op" id="3023431">-</span><span class="num" id="3023432">1</span><br>
<span class="lineno"></span><span class="op" id="3023434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="3023437">func</span>&nbsp;<span class="ident" id="3023442">makeCutsetFunc</span><span class="op" id="3023456">(</span><span class="ident" id="3023457">cutset</span>&nbsp;<span class="builtintype" id="3023464">string</span><span class="op" id="3023470">)</span>&nbsp;<span class="keyword" id="3023472">func</span><span class="op" id="3023476">(</span><span class="ident" id="3023477">r</span>&nbsp;<span class="builtintype" id="3023479">rune</span><span class="op" id="3023483">)</span>&nbsp;<span class="builtintype" id="3023485">bool</span>&nbsp;<span class="op" id="3023490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023493">return</span>&nbsp;<span class="keyword" id="3023500">func</span><span class="op" id="3023504">(</span><span class="ident" id="3023505">r</span>&nbsp;<span class="builtintype" id="3023507">rune</span><span class="op" id="3023511">)</span>&nbsp;<span class="builtintype" id="3023513">bool</span>&nbsp;<span class="op" id="3023518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023522">for</span>&nbsp;<span class="ident" id="3023526">_</span><span class="op" id="3023527">,</span>&nbsp;<span class="ident" id="3023529">c</span>&nbsp;<span class="op" id="3023531">:=</span>&nbsp;<span class="keyword" id="3023534">range</span>&nbsp;<span class="ident" id="3023540">cutset</span>&nbsp;<span class="op" id="3023547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023552">if</span>&nbsp;<span class="ident" id="3023555">c</span>&nbsp;<span class="op" id="3023557">==</span>&nbsp;<span class="ident" id="3023560">r</span>&nbsp;<span class="op" id="3023562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023568">return</span>&nbsp;<span class="ident" id="3023575">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023591">return</span>&nbsp;<span class="ident" id="3023598">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023605">}</span><br>
<span class="lineno"></span><span class="op" id="3023607">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="3023610">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3023673">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="3023740">func</span>&nbsp;<span class="ident" id="3023745">Trim</span><span class="op" id="3023749">(</span><span class="ident" id="3023750">s</span>&nbsp;<span class="op" id="3023752">[</span><span class="op" id="3023753">]</span><span class="builtintype" id="3023754">byte</span><span class="op" id="3023758">,</span>&nbsp;<span class="ident" id="3023760">cutset</span>&nbsp;<span class="builtintype" id="3023767">string</span><span class="op" id="3023773">)</span>&nbsp;<span class="op" id="3023775">[</span><span class="op" id="3023776">]</span><span class="builtintype" id="3023777">byte</span>&nbsp;<span class="op" id="3023782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023785">return</span>&nbsp;<span class="ident" id="3023792">TrimFunc</span><span class="op" id="3023800">(</span><span class="ident" id="3023801">s</span><span class="op" id="3023802">,</span>&nbsp;<span class="ident" id="3023804">makeCutsetFunc</span><span class="op" id="3023818">(</span><span class="ident" id="3023819">cutset</span><span class="op" id="3023825">)</span><span class="op" id="3023826">)</span><br>
<span class="lineno">575</span><span class="op" id="3023828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3023831">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="3023894">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="3023952">func</span>&nbsp;<span class="ident" id="3023957">TrimLeft</span><span class="op" id="3023965">(</span><span class="ident" id="3023966">s</span>&nbsp;<span class="op" id="3023968">[</span><span class="op" id="3023969">]</span><span class="builtintype" id="3023970">byte</span><span class="op" id="3023974">,</span>&nbsp;<span class="ident" id="3023976">cutset</span>&nbsp;<span class="builtintype" id="3023983">string</span><span class="op" id="3023989">)</span>&nbsp;<span class="op" id="3023991">[</span><span class="op" id="3023992">]</span><span class="builtintype" id="3023993">byte</span>&nbsp;<span class="op" id="3023998">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024001">return</span>&nbsp;<span class="ident" id="3024008">TrimLeftFunc</span><span class="op" id="3024020">(</span><span class="ident" id="3024021">s</span><span class="op" id="3024022">,</span>&nbsp;<span class="ident" id="3024024">makeCutsetFunc</span><span class="op" id="3024038">(</span><span class="ident" id="3024039">cutset</span><span class="op" id="3024045">)</span><span class="op" id="3024046">)</span><br>
<span class="lineno"></span><span class="op" id="3024048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3024051">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3024116">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="3024183">func</span>&nbsp;<span class="ident" id="3024188">TrimRight</span><span class="op" id="3024197">(</span><span class="ident" id="3024198">s</span>&nbsp;<span class="op" id="3024200">[</span><span class="op" id="3024201">]</span><span class="builtintype" id="3024202">byte</span><span class="op" id="3024206">,</span>&nbsp;<span class="ident" id="3024208">cutset</span>&nbsp;<span class="builtintype" id="3024215">string</span><span class="op" id="3024221">)</span>&nbsp;<span class="op" id="3024223">[</span><span class="op" id="3024224">]</span><span class="builtintype" id="3024225">byte</span>&nbsp;<span class="op" id="3024230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024233">return</span>&nbsp;<span class="ident" id="3024240">TrimRightFunc</span><span class="op" id="3024253">(</span><span class="ident" id="3024254">s</span><span class="op" id="3024255">,</span>&nbsp;<span class="ident" id="3024257">makeCutsetFunc</span><span class="op" id="3024271">(</span><span class="ident" id="3024272">cutset</span><span class="op" id="3024278">)</span><span class="op" id="3024279">)</span><br>
<span class="lineno"></span><span class="op" id="3024281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3024284">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="3024352">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="3024400">func</span>&nbsp;<span class="ident" id="3024405">TrimSpace</span><span class="op" id="3024414">(</span><span class="ident" id="3024415">s</span>&nbsp;<span class="op" id="3024417">[</span><span class="op" id="3024418">]</span><span class="builtintype" id="3024419">byte</span><span class="op" id="3024423">)</span>&nbsp;<span class="op" id="3024425">[</span><span class="op" id="3024426">]</span><span class="builtintype" id="3024427">byte</span>&nbsp;<span class="op" id="3024432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024435">return</span>&nbsp;<span class="ident" id="3024442">TrimFunc</span><span class="op" id="3024450">(</span><span class="ident" id="3024451">s</span><span class="op" id="3024452">,</span>&nbsp;<span class="ident" id="3024454">unicode</span><span class="op" id="3024461">.</span><span class="ident" id="3024462">IsSpace</span><span class="op" id="3024469">)</span><br>
<span class="lineno"></span><span class="op" id="3024471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="3024474">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3024547">func</span>&nbsp;<span class="ident" id="3024552">Runes</span><span class="op" id="3024557">(</span><span class="ident" id="3024558">s</span>&nbsp;<span class="op" id="3024560">[</span><span class="op" id="3024561">]</span><span class="builtintype" id="3024562">byte</span><span class="op" id="3024566">)</span>&nbsp;<span class="op" id="3024568">[</span><span class="op" id="3024569">]</span><span class="builtintype" id="3024570">rune</span>&nbsp;<span class="op" id="3024575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024578">t</span>&nbsp;<span class="op" id="3024580">:=</span>&nbsp;<span class="builtinfunc" id="3024583">make</span><span class="op" id="3024587">(</span><span class="op" id="3024588">[</span><span class="op" id="3024589">]</span><span class="builtintype" id="3024590">rune</span><span class="op" id="3024594">,</span>&nbsp;<span class="ident" id="3024596">utf8</span><span class="op" id="3024600">.</span><span class="ident" id="3024601">RuneCount</span><span class="op" id="3024610">(</span><span class="ident" id="3024611">s</span><span class="op" id="3024612">)</span><span class="op" id="3024613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024616">i</span>&nbsp;<span class="op" id="3024618">:=</span>&nbsp;<span class="num" id="3024621">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024624">for</span>&nbsp;<span class="builtinfunc" id="3024628">len</span><span class="op" id="3024631">(</span><span class="ident" id="3024632">s</span><span class="op" id="3024633">)</span>&nbsp;<span class="op" id="3024635">&gt;</span>&nbsp;<span class="num" id="3024637">0</span>&nbsp;<span class="op" id="3024639">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024643">r</span><span class="op" id="3024644">,</span>&nbsp;<span class="ident" id="3024646">l</span>&nbsp;<span class="op" id="3024648">:=</span>&nbsp;<span class="ident" id="3024651">utf8</span><span class="op" id="3024655">.</span><span class="ident" id="3024656">DecodeRune</span><span class="op" id="3024666">(</span><span class="ident" id="3024667">s</span><span class="op" id="3024668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024672">t</span><span class="op" id="3024673">[</span><span class="ident" id="3024674">i</span><span class="op" id="3024675">]</span>&nbsp;<span class="op" id="3024677">=</span>&nbsp;<span class="ident" id="3024679">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024683">i</span><span class="op" id="3024684">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024689">s</span>&nbsp;<span class="op" id="3024691">=</span>&nbsp;<span class="ident" id="3024693">s</span><span class="op" id="3024694">[</span><span class="ident" id="3024695">l</span><span class="op" id="3024696">:</span><span class="op" id="3024697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024700">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024703">return</span>&nbsp;<span class="ident" id="3024710">t</span><br>
<span class="lineno"></span><span class="op" id="3024712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3024715">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="3024773">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="3024826">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3024887">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="3024953">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="3024976">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="3025038">func</span>&nbsp;<span class="ident" id="3025043">Replace</span><span class="op" id="3025050">(</span><span class="ident" id="3025051">s</span><span class="op" id="3025052">,</span>&nbsp;<span class="ident" id="3025054">old</span><span class="op" id="3025057">,</span>&nbsp;<span class="builtinfunc" id="3025059">new</span>&nbsp;<span class="op" id="3025063">[</span><span class="op" id="3025064">]</span><span class="builtintype" id="3025065">byte</span><span class="op" id="3025069">,</span>&nbsp;<span class="ident" id="3025071">n</span>&nbsp;<span class="builtintype" id="3025073">int</span><span class="op" id="3025076">)</span>&nbsp;<span class="op" id="3025078">[</span><span class="op" id="3025079">]</span><span class="builtintype" id="3025080">byte</span>&nbsp;<span class="op" id="3025085">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025088">m</span>&nbsp;<span class="op" id="3025090">:=</span>&nbsp;<span class="num" id="3025093">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025096">if</span>&nbsp;<span class="ident" id="3025099">n</span>&nbsp;<span class="op" id="3025101">!=</span>&nbsp;<span class="num" id="3025104">0</span>&nbsp;<span class="op" id="3025106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3025110">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025147">m</span>&nbsp;<span class="op" id="3025149">=</span>&nbsp;<span class="ident" id="3025151">Count</span><span class="op" id="3025156">(</span><span class="ident" id="3025157">s</span><span class="op" id="3025158">,</span>&nbsp;<span class="ident" id="3025160">old</span><span class="op" id="3025163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025166">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025169">if</span>&nbsp;<span class="ident" id="3025172">m</span>&nbsp;<span class="op" id="3025174">==</span>&nbsp;<span class="num" id="3025177">0</span>&nbsp;<span class="op" id="3025179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3025183">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025208">return</span>&nbsp;<span class="builtinfunc" id="3025215">append</span><span class="op" id="3025221">(</span><span class="op" id="3025222">[</span><span class="op" id="3025223">]</span><span class="builtintype" id="3025224">byte</span><span class="op" id="3025228">(</span><span class="ident" id="3025229">nil</span><span class="op" id="3025232">)</span><span class="op" id="3025233">,</span>&nbsp;<span class="ident" id="3025235">s</span><span class="op" id="3025236">...</span><span class="op" id="3025239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025245">if</span>&nbsp;<span class="ident" id="3025248">n</span>&nbsp;<span class="op" id="3025250">&lt;</span>&nbsp;<span class="num" id="3025252">0</span>&nbsp;<span class="op" id="3025254">||</span>&nbsp;<span class="ident" id="3025257">m</span>&nbsp;<span class="op" id="3025259">&lt;</span>&nbsp;<span class="ident" id="3025261">n</span>&nbsp;<span class="op" id="3025263">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025267">n</span>&nbsp;<span class="op" id="3025269">=</span>&nbsp;<span class="ident" id="3025271">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3025278">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025312">t</span>&nbsp;<span class="op" id="3025314">:=</span>&nbsp;<span class="builtinfunc" id="3025317">make</span><span class="op" id="3025321">(</span><span class="op" id="3025322">[</span><span class="op" id="3025323">]</span><span class="builtintype" id="3025324">byte</span><span class="op" id="3025328">,</span>&nbsp;<span class="builtinfunc" id="3025330">len</span><span class="op" id="3025333">(</span><span class="ident" id="3025334">s</span><span class="op" id="3025335">)</span><span class="op" id="3025336">+</span><span class="ident" id="3025337">n</span><span class="op" id="3025338">*</span><span class="op" id="3025339">(</span><span class="builtinfunc" id="3025340">len</span><span class="op" id="3025343">(</span><span class="builtinfunc" id="3025344">new</span><span class="op" id="3025347">)</span><span class="op" id="3025348">-</span><span class="builtinfunc" id="3025349">len</span><span class="op" id="3025352">(</span><span class="ident" id="3025353">old</span><span class="op" id="3025356">)</span><span class="op" id="3025357">)</span><span class="op" id="3025358">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025361">w</span>&nbsp;<span class="op" id="3025363">:=</span>&nbsp;<span class="num" id="3025366">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025369">start</span>&nbsp;<span class="op" id="3025375">:=</span>&nbsp;<span class="num" id="3025378">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025381">for</span>&nbsp;<span class="ident" id="3025385">i</span>&nbsp;<span class="op" id="3025387">:=</span>&nbsp;<span class="num" id="3025390">0</span><span class="op" id="3025391">;</span>&nbsp;<span class="ident" id="3025393">i</span>&nbsp;<span class="op" id="3025395">&lt;</span>&nbsp;<span class="ident" id="3025397">n</span><span class="op" id="3025398">;</span>&nbsp;<span class="ident" id="3025400">i</span><span class="op" id="3025401">++</span>&nbsp;<span class="op" id="3025404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025408">j</span>&nbsp;<span class="op" id="3025410">:=</span>&nbsp;<span class="ident" id="3025413">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025421">if</span>&nbsp;<span class="builtinfunc" id="3025424">len</span><span class="op" id="3025427">(</span><span class="ident" id="3025428">old</span><span class="op" id="3025431">)</span>&nbsp;<span class="op" id="3025433">==</span>&nbsp;<span class="num" id="3025436">0</span>&nbsp;<span class="op" id="3025438">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025443">if</span>&nbsp;<span class="ident" id="3025446">i</span>&nbsp;<span class="op" id="3025448">&gt;</span>&nbsp;<span class="num" id="3025450">0</span>&nbsp;<span class="op" id="3025452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025458">_</span><span class="op" id="3025459">,</span>&nbsp;<span class="ident" id="3025461">wid</span>&nbsp;<span class="op" id="3025465">:=</span>&nbsp;<span class="ident" id="3025468">utf8</span><span class="op" id="3025472">.</span><span class="ident" id="3025473">DecodeRune</span><span class="op" id="3025483">(</span><span class="ident" id="3025484">s</span><span class="op" id="3025485">[</span><span class="ident" id="3025486">start</span><span class="op" id="3025491">:</span><span class="op" id="3025492">]</span><span class="op" id="3025493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025499">j</span>&nbsp;<span class="op" id="3025501">+=</span>&nbsp;<span class="ident" id="3025504">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025515">}</span>&nbsp;<span class="keyword" id="3025517">else</span>&nbsp;<span class="op" id="3025522">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025527">j</span>&nbsp;<span class="op" id="3025529">+=</span>&nbsp;<span class="ident" id="3025532">Index</span><span class="op" id="3025537">(</span><span class="ident" id="3025538">s</span><span class="op" id="3025539">[</span><span class="ident" id="3025540">start</span><span class="op" id="3025545">:</span><span class="op" id="3025546">]</span><span class="op" id="3025547">,</span>&nbsp;<span class="ident" id="3025549">old</span><span class="op" id="3025552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025560">w</span>&nbsp;<span class="op" id="3025562">+=</span>&nbsp;<span class="builtinfunc" id="3025565">copy</span><span class="op" id="3025569">(</span><span class="ident" id="3025570">t</span><span class="op" id="3025571">[</span><span class="ident" id="3025572">w</span><span class="op" id="3025573">:</span><span class="op" id="3025574">]</span><span class="op" id="3025575">,</span>&nbsp;<span class="ident" id="3025577">s</span><span class="op" id="3025578">[</span><span class="ident" id="3025579">start</span><span class="op" id="3025584">:</span><span class="ident" id="3025585">j</span><span class="op" id="3025586">]</span><span class="op" id="3025587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025591">w</span>&nbsp;<span class="op" id="3025593">+=</span>&nbsp;<span class="builtinfunc" id="3025596">copy</span><span class="op" id="3025600">(</span><span class="ident" id="3025601">t</span><span class="op" id="3025602">[</span><span class="ident" id="3025603">w</span><span class="op" id="3025604">:</span><span class="op" id="3025605">]</span><span class="op" id="3025606">,</span>&nbsp;<span class="builtinfunc" id="3025608">new</span><span class="op" id="3025611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025615">start</span>&nbsp;<span class="op" id="3025621">=</span>&nbsp;<span class="ident" id="3025623">j</span>&nbsp;<span class="op" id="3025625">+</span>&nbsp;<span class="builtinfunc" id="3025627">len</span><span class="op" id="3025630">(</span><span class="ident" id="3025631">old</span><span class="op" id="3025634">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025640">w</span>&nbsp;<span class="op" id="3025642">+=</span>&nbsp;<span class="builtinfunc" id="3025645">copy</span><span class="op" id="3025649">(</span><span class="ident" id="3025650">t</span><span class="op" id="3025651">[</span><span class="ident" id="3025652">w</span><span class="op" id="3025653">:</span><span class="op" id="3025654">]</span><span class="op" id="3025655">,</span>&nbsp;<span class="ident" id="3025657">s</span><span class="op" id="3025658">[</span><span class="ident" id="3025659">start</span><span class="op" id="3025664">:</span><span class="op" id="3025665">]</span><span class="op" id="3025666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025669">return</span>&nbsp;<span class="ident" id="3025676">t</span><span class="op" id="3025677">[</span><span class="num" id="3025678">0</span><span class="op" id="3025679">:</span><span class="ident" id="3025680">w</span><span class="op" id="3025681">]</span><br>
<span class="lineno"></span><span class="op" id="3025683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="3025686">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="3025754">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="3025795">func</span>&nbsp;<span class="ident" id="3025800">EqualFold</span><span class="op" id="3025809">(</span><span class="ident" id="3025810">s</span><span class="op" id="3025811">,</span>&nbsp;<span class="ident" id="3025813">t</span>&nbsp;<span class="op" id="3025815">[</span><span class="op" id="3025816">]</span><span class="builtintype" id="3025817">byte</span><span class="op" id="3025821">)</span>&nbsp;<span class="builtintype" id="3025823">bool</span>&nbsp;<span class="op" id="3025828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025831">for</span>&nbsp;<span class="builtinfunc" id="3025835">len</span><span class="op" id="3025838">(</span><span class="ident" id="3025839">s</span><span class="op" id="3025840">)</span>&nbsp;<span class="op" id="3025842">!=</span>&nbsp;<span class="num" id="3025845">0</span>&nbsp;<span class="op" id="3025847">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3025850">len</span><span class="op" id="3025853">(</span><span class="ident" id="3025854">t</span><span class="op" id="3025855">)</span>&nbsp;<span class="op" id="3025857">!=</span>&nbsp;<span class="num" id="3025860">0</span>&nbsp;<span class="op" id="3025862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3025866">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025901">var</span>&nbsp;<span class="ident" id="3025905">sr</span><span class="op" id="3025907">,</span>&nbsp;<span class="ident" id="3025909">tr</span>&nbsp;<span class="builtintype" id="3025912">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025919">if</span>&nbsp;<span class="ident" id="3025922">s</span><span class="op" id="3025923">[</span><span class="num" id="3025924">0</span><span class="op" id="3025925">]</span>&nbsp;<span class="op" id="3025927">&lt;</span>&nbsp;<span class="ident" id="3025929">utf8</span><span class="op" id="3025933">.</span><span class="ident" id="3025934">RuneSelf</span>&nbsp;<span class="op" id="3025943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025948">sr</span><span class="op" id="3025950">,</span>&nbsp;<span class="ident" id="3025952">s</span>&nbsp;<span class="op" id="3025954">=</span>&nbsp;<span class="builtintype" id="3025956">rune</span><span class="op" id="3025960">(</span><span class="ident" id="3025961">s</span><span class="op" id="3025962">[</span><span class="num" id="3025963">0</span><span class="op" id="3025964">]</span><span class="op" id="3025965">)</span><span class="op" id="3025966">,</span>&nbsp;<span class="ident" id="3025968">s</span><span class="op" id="3025969">[</span><span class="num" id="3025970">1</span><span class="op" id="3025971">:</span><span class="op" id="3025972">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025976">}</span>&nbsp;<span class="keyword" id="3025978">else</span>&nbsp;<span class="op" id="3025983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025988">r</span><span class="op" id="3025989">,</span>&nbsp;<span class="ident" id="3025991">size</span>&nbsp;<span class="op" id="3025996">:=</span>&nbsp;<span class="ident" id="3025999">utf8</span><span class="op" id="3026003">.</span><span class="ident" id="3026004">DecodeRune</span><span class="op" id="3026014">(</span><span class="ident" id="3026015">s</span><span class="op" id="3026016">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026021">sr</span><span class="op" id="3026023">,</span>&nbsp;<span class="ident" id="3026025">s</span>&nbsp;<span class="op" id="3026027">=</span>&nbsp;<span class="ident" id="3026029">r</span><span class="op" id="3026030">,</span>&nbsp;<span class="ident" id="3026032">s</span><span class="op" id="3026033">[</span><span class="ident" id="3026034">size</span><span class="op" id="3026038">:</span><span class="op" id="3026039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026047">if</span>&nbsp;<span class="ident" id="3026050">t</span><span class="op" id="3026051">[</span><span class="num" id="3026052">0</span><span class="op" id="3026053">]</span>&nbsp;<span class="op" id="3026055">&lt;</span>&nbsp;<span class="ident" id="3026057">utf8</span><span class="op" id="3026061">.</span><span class="ident" id="3026062">RuneSelf</span>&nbsp;<span class="op" id="3026071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026076">tr</span><span class="op" id="3026078">,</span>&nbsp;<span class="ident" id="3026080">t</span>&nbsp;<span class="op" id="3026082">=</span>&nbsp;<span class="builtintype" id="3026084">rune</span><span class="op" id="3026088">(</span><span class="ident" id="3026089">t</span><span class="op" id="3026090">[</span><span class="num" id="3026091">0</span><span class="op" id="3026092">]</span><span class="op" id="3026093">)</span><span class="op" id="3026094">,</span>&nbsp;<span class="ident" id="3026096">t</span><span class="op" id="3026097">[</span><span class="num" id="3026098">1</span><span class="op" id="3026099">:</span><span class="op" id="3026100">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026104">}</span>&nbsp;<span class="keyword" id="3026106">else</span>&nbsp;<span class="op" id="3026111">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026116">r</span><span class="op" id="3026117">,</span>&nbsp;<span class="ident" id="3026119">size</span>&nbsp;<span class="op" id="3026124">:=</span>&nbsp;<span class="ident" id="3026127">utf8</span><span class="op" id="3026131">.</span><span class="ident" id="3026132">DecodeRune</span><span class="op" id="3026142">(</span><span class="ident" id="3026143">t</span><span class="op" id="3026144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026149">tr</span><span class="op" id="3026151">,</span>&nbsp;<span class="ident" id="3026153">t</span>&nbsp;<span class="op" id="3026155">=</span>&nbsp;<span class="ident" id="3026157">r</span><span class="op" id="3026158">,</span>&nbsp;<span class="ident" id="3026160">t</span><span class="op" id="3026161">[</span><span class="ident" id="3026162">size</span><span class="op" id="3026166">:</span><span class="op" id="3026167">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026176">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026231">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026247">if</span>&nbsp;<span class="ident" id="3026250">tr</span>&nbsp;<span class="op" id="3026253">==</span>&nbsp;<span class="ident" id="3026256">sr</span>&nbsp;<span class="op" id="3026259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026264">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026275">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026280">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026324">if</span>&nbsp;<span class="ident" id="3026327">tr</span>&nbsp;<span class="op" id="3026330">&lt;</span>&nbsp;<span class="ident" id="3026332">sr</span>&nbsp;<span class="op" id="3026335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026340">tr</span><span class="op" id="3026342">,</span>&nbsp;<span class="ident" id="3026344">sr</span>&nbsp;<span class="op" id="3026347">=</span>&nbsp;<span class="ident" id="3026349">sr</span><span class="op" id="3026351">,</span>&nbsp;<span class="ident" id="3026353">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026358">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026362">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026389">if</span>&nbsp;<span class="ident" id="3026392">tr</span>&nbsp;<span class="op" id="3026395">&lt;</span>&nbsp;<span class="ident" id="3026397">utf8</span><span class="op" id="3026401">.</span><span class="ident" id="3026402">RuneSelf</span>&nbsp;<span class="op" id="3026411">&amp;&amp;</span>&nbsp;<span class="string" id="3026414">&#39;A&#39;</span>&nbsp;<span class="op" id="3026418">&lt;=</span>&nbsp;<span class="ident" id="3026421">sr</span>&nbsp;<span class="op" id="3026424">&amp;&amp;</span>&nbsp;<span class="ident" id="3026427">sr</span>&nbsp;<span class="op" id="3026430">&lt;=</span>&nbsp;<span class="string" id="3026433">&#39;Z&#39;</span>&nbsp;<span class="op" id="3026437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026442">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026501">if</span>&nbsp;<span class="ident" id="3026504">tr</span>&nbsp;<span class="op" id="3026507">==</span>&nbsp;<span class="ident" id="3026510">sr</span><span class="op" id="3026512">+</span><span class="string" id="3026513">&#39;a&#39;</span><span class="op" id="3026516">-</span><span class="string" id="3026517">&#39;A&#39;</span>&nbsp;<span class="op" id="3026521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026527">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026544">return</span>&nbsp;<span class="ident" id="3026551">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026564">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026635">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026675">r</span>&nbsp;<span class="op" id="3026677">:=</span>&nbsp;<span class="ident" id="3026680">unicode</span><span class="op" id="3026687">.</span><span class="ident" id="3026688">SimpleFold</span><span class="op" id="3026698">(</span><span class="ident" id="3026699">sr</span><span class="op" id="3026701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026705">for</span>&nbsp;<span class="ident" id="3026709">r</span>&nbsp;<span class="op" id="3026711">!=</span>&nbsp;<span class="ident" id="3026714">sr</span>&nbsp;<span class="op" id="3026717">&amp;&amp;</span>&nbsp;<span class="ident" id="3026720">r</span>&nbsp;<span class="op" id="3026722">&lt;</span>&nbsp;<span class="ident" id="3026724">tr</span>&nbsp;<span class="op" id="3026727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026732">r</span>&nbsp;<span class="op" id="3026734">=</span>&nbsp;<span class="ident" id="3026736">unicode</span><span class="op" id="3026743">.</span><span class="ident" id="3026744">SimpleFold</span><span class="op" id="3026754">(</span><span class="ident" id="3026755">r</span><span class="op" id="3026756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026760">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026764">if</span>&nbsp;<span class="ident" id="3026767">r</span>&nbsp;<span class="op" id="3026769">==</span>&nbsp;<span class="ident" id="3026772">tr</span>&nbsp;<span class="op" id="3026775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026780">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026795">return</span>&nbsp;<span class="ident" id="3026802">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026809">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026813">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026849">return</span>&nbsp;<span class="builtinfunc" id="3026856">len</span><span class="op" id="3026859">(</span><span class="ident" id="3026860">s</span><span class="op" id="3026861">)</span>&nbsp;<span class="op" id="3026863">==</span>&nbsp;<span class="builtinfunc" id="3026866">len</span><span class="op" id="3026869">(</span><span class="ident" id="3026870">t</span><span class="op" id="3026871">)</span><br>
<span class="lineno"></span><span class="op" id="3026873">}</span>
</div>
</body>
</html>
