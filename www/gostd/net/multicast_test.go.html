<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7922100">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7922155">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7922209">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7922260">package</span>&nbsp;<span class="ident" id="7922268">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7922273">import</span>&nbsp;<span class="op" id="7922280">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7922283">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7922290">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7922296">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7922307">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7922317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7922320">var</span>&nbsp;<span class="ident" id="7922324">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7922351">=</span>&nbsp;<span class="op" id="7922353">[</span><span class="op" id="7922354">]</span><span class="keyword" id="7922355">struct</span>&nbsp;<span class="op" id="7922362">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922365">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7922371">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922379">gaddr</span>&nbsp;<span class="op" id="7922385">*</span><span class="ident" id="7922386">UDPAddr</span>&nbsp;<span class="comment" id="7922394">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7922410">}</span><span class="op" id="7922411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922414">{</span><span class="string" id="7922415">&#34;udp&#34;</span><span class="op" id="7922420">,</span>&nbsp;<span class="op" id="7922422">&amp;</span><span class="ident" id="7922423">UDPAddr</span><span class="op" id="7922430">{</span><span class="ident" id="7922431">IP</span><span class="op" id="7922433">:</span>&nbsp;<span class="ident" id="7922435">IPv4</span><span class="op" id="7922439">(</span><span class="num" id="7922440">224</span><span class="op" id="7922443">,</span>&nbsp;<span class="num" id="7922445">0</span><span class="op" id="7922446">,</span>&nbsp;<span class="num" id="7922448">0</span><span class="op" id="7922449">,</span>&nbsp;<span class="num" id="7922451">254</span><span class="op" id="7922454">)</span><span class="op" id="7922455">,</span>&nbsp;<span class="ident" id="7922457">Port</span><span class="op" id="7922461">:</span>&nbsp;<span class="num" id="7922463">12345</span><span class="op" id="7922468">}</span><span class="op" id="7922469">}</span><span class="op" id="7922470">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922474">{</span><span class="string" id="7922475">&#34;udp4&#34;</span><span class="op" id="7922481">,</span>&nbsp;<span class="op" id="7922483">&amp;</span><span class="ident" id="7922484">UDPAddr</span><span class="op" id="7922491">{</span><span class="ident" id="7922492">IP</span><span class="op" id="7922494">:</span>&nbsp;<span class="ident" id="7922496">IPv4</span><span class="op" id="7922500">(</span><span class="num" id="7922501">224</span><span class="op" id="7922504">,</span>&nbsp;<span class="num" id="7922506">0</span><span class="op" id="7922507">,</span>&nbsp;<span class="num" id="7922509">0</span><span class="op" id="7922510">,</span>&nbsp;<span class="num" id="7922512">254</span><span class="op" id="7922515">)</span><span class="op" id="7922516">,</span>&nbsp;<span class="ident" id="7922518">Port</span><span class="op" id="7922522">:</span>&nbsp;<span class="num" id="7922524">12345</span><span class="op" id="7922529">}</span><span class="op" id="7922530">}</span><span class="op" id="7922531">,</span><br>
<span class="lineno"></span><span class="op" id="7922533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7922536">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7922606">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="7922677">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7922686">func</span>&nbsp;<span class="ident" id="7922691">TestIPv4MulticastListener</span><span class="op" id="7922716">(</span><span class="ident" id="7922717">t</span>&nbsp;<span class="op" id="7922719">*</span><span class="ident" id="7922720">testing</span><span class="op" id="7922727">.</span><span class="ident" id="7922728">T</span><span class="op" id="7922729">)</span>&nbsp;<span class="op" id="7922731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922734">switch</span>&nbsp;<span class="ident" id="7922741">runtime</span><span class="op" id="7922748">.</span><span class="ident" id="7922749">GOOS</span>&nbsp;<span class="op" id="7922754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922757">case</span>&nbsp;<span class="string" id="7922762">&#34;android&#34;</span><span class="op" id="7922771">,</span>&nbsp;<span class="string" id="7922773">&#34;nacl&#34;</span><span class="op" id="7922779">,</span>&nbsp;<span class="string" id="7922781">&#34;plan9&#34;</span><span class="op" id="7922788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922792">t</span><span class="op" id="7922793">.</span><span class="ident" id="7922794">Skipf</span><span class="op" id="7922799">(</span><span class="string" id="7922800">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7922821">,</span>&nbsp;<span class="ident" id="7922823">runtime</span><span class="op" id="7922830">.</span><span class="ident" id="7922831">GOOS</span><span class="op" id="7922835">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922838">case</span>&nbsp;<span class="string" id="7922843">&#34;solaris&#34;</span><span class="op" id="7922852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922856">t</span><span class="op" id="7922857">.</span><span class="ident" id="7922858">Skipf</span><span class="op" id="7922863">(</span><span class="string" id="7922864">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7922906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922913">closer</span>&nbsp;<span class="op" id="7922920">:=</span>&nbsp;<span class="keyword" id="7922923">func</span><span class="op" id="7922927">(</span><span class="ident" id="7922928">cs</span>&nbsp;<span class="op" id="7922931">[</span><span class="op" id="7922932">]</span><span class="op" id="7922933">*</span><span class="ident" id="7922934">UDPConn</span><span class="op" id="7922941">)</span>&nbsp;<span class="op" id="7922943">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922947">for</span>&nbsp;<span class="ident" id="7922951">_</span><span class="op" id="7922952">,</span>&nbsp;<span class="ident" id="7922954">c</span>&nbsp;<span class="op" id="7922956">:=</span>&nbsp;<span class="keyword" id="7922959">range</span>&nbsp;<span class="ident" id="7922965">cs</span>&nbsp;<span class="op" id="7922968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922973">if</span>&nbsp;<span class="ident" id="7922976">c</span>&nbsp;<span class="op" id="7922978">!=</span>&nbsp;<span class="ident" id="7922981">nil</span>&nbsp;<span class="op" id="7922985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922991">c</span><span class="op" id="7922992">.</span><span class="ident" id="7922993">Close</span><span class="op" id="7922998">(</span><span class="op" id="7922999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923008">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923015">for</span>&nbsp;<span class="ident" id="7923019">_</span><span class="op" id="7923020">,</span>&nbsp;<span class="ident" id="7923022">ifi</span>&nbsp;<span class="op" id="7923026">:=</span>&nbsp;<span class="keyword" id="7923029">range</span>&nbsp;<span class="op" id="7923035">[</span><span class="op" id="7923036">]</span><span class="op" id="7923037">*</span><span class="ident" id="7923038">Interface</span><span class="op" id="7923047">{</span><span class="ident" id="7923048">loopbackInterface</span><span class="op" id="7923065">(</span><span class="op" id="7923066">)</span><span class="op" id="7923067">,</span>&nbsp;<span class="ident" id="7923069">nil</span><span class="op" id="7923072">}</span>&nbsp;<span class="op" id="7923074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923078">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923134">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923187">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923237">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923289">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923307">if</span>&nbsp;<span class="ident" id="7923310">ifi</span>&nbsp;<span class="op" id="7923314">==</span>&nbsp;<span class="ident" id="7923317">nil</span>&nbsp;<span class="op" id="7923321">&amp;&amp;</span>&nbsp;<span class="op" id="7923324">!</span><span class="op" id="7923325">*</span><span class="ident" id="7923326">testExternal</span>&nbsp;<span class="op" id="7923339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923344">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923359">for</span>&nbsp;<span class="ident" id="7923363">_</span><span class="op" id="7923364">,</span>&nbsp;<span class="ident" id="7923366">tt</span>&nbsp;<span class="op" id="7923369">:=</span>&nbsp;<span class="keyword" id="7923372">range</span>&nbsp;<span class="ident" id="7923378">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7923405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923410">var</span>&nbsp;<span class="ident" id="7923414">err</span>&nbsp;<span class="builtintype" id="7923418">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923427">cs</span>&nbsp;<span class="op" id="7923430">:=</span>&nbsp;<span class="builtinfunc" id="7923433">make</span><span class="op" id="7923437">(</span><span class="op" id="7923438">[</span><span class="op" id="7923439">]</span><span class="op" id="7923440">*</span><span class="ident" id="7923441">UDPConn</span><span class="op" id="7923448">,</span>&nbsp;<span class="num" id="7923450">2</span><span class="op" id="7923451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923456">if</span>&nbsp;<span class="ident" id="7923459">cs</span><span class="op" id="7923461">[</span><span class="num" id="7923462">0</span><span class="op" id="7923463">]</span><span class="op" id="7923464">,</span>&nbsp;<span class="ident" id="7923466">err</span>&nbsp;<span class="op" id="7923470">=</span>&nbsp;<span class="ident" id="7923472">ListenMulticastUDP</span><span class="op" id="7923490">(</span><span class="ident" id="7923491">tt</span><span class="op" id="7923493">.</span><span class="ident" id="7923494">net</span><span class="op" id="7923497">,</span>&nbsp;<span class="ident" id="7923499">ifi</span><span class="op" id="7923502">,</span>&nbsp;<span class="ident" id="7923504">tt</span><span class="op" id="7923506">.</span><span class="ident" id="7923507">gaddr</span><span class="op" id="7923512">)</span><span class="op" id="7923513">;</span>&nbsp;<span class="ident" id="7923515">err</span>&nbsp;<span class="op" id="7923519">!=</span>&nbsp;<span class="ident" id="7923522">nil</span>&nbsp;<span class="op" id="7923526">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923532">t</span><span class="op" id="7923533">.</span><span class="ident" id="7923534">Fatalf</span><span class="op" id="7923540">(</span><span class="string" id="7923541">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7923584">,</span>&nbsp;<span class="ident" id="7923586">ifi</span><span class="op" id="7923589">,</span>&nbsp;<span class="ident" id="7923591">err</span><span class="op" id="7923594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923604">if</span>&nbsp;<span class="ident" id="7923607">err</span>&nbsp;<span class="op" id="7923611">:=</span>&nbsp;<span class="ident" id="7923614">checkMulticastListener</span><span class="op" id="7923636">(</span><span class="ident" id="7923637">cs</span><span class="op" id="7923639">[</span><span class="num" id="7923640">0</span><span class="op" id="7923641">]</span><span class="op" id="7923642">,</span>&nbsp;<span class="ident" id="7923644">tt</span><span class="op" id="7923646">.</span><span class="ident" id="7923647">gaddr</span><span class="op" id="7923652">.</span><span class="ident" id="7923653">IP</span><span class="op" id="7923655">)</span><span class="op" id="7923656">;</span>&nbsp;<span class="ident" id="7923658">err</span>&nbsp;<span class="op" id="7923662">!=</span>&nbsp;<span class="ident" id="7923665">nil</span>&nbsp;<span class="op" id="7923669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923675">closer</span><span class="op" id="7923681">(</span><span class="ident" id="7923682">cs</span><span class="op" id="7923684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923690">t</span><span class="op" id="7923691">.</span><span class="ident" id="7923692">Fatal</span><span class="op" id="7923697">(</span><span class="ident" id="7923698">err</span><span class="op" id="7923701">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923711">if</span>&nbsp;<span class="ident" id="7923714">cs</span><span class="op" id="7923716">[</span><span class="num" id="7923717">1</span><span class="op" id="7923718">]</span><span class="op" id="7923719">,</span>&nbsp;<span class="ident" id="7923721">err</span>&nbsp;<span class="op" id="7923725">=</span>&nbsp;<span class="ident" id="7923727">ListenMulticastUDP</span><span class="op" id="7923745">(</span><span class="ident" id="7923746">tt</span><span class="op" id="7923748">.</span><span class="ident" id="7923749">net</span><span class="op" id="7923752">,</span>&nbsp;<span class="ident" id="7923754">ifi</span><span class="op" id="7923757">,</span>&nbsp;<span class="ident" id="7923759">tt</span><span class="op" id="7923761">.</span><span class="ident" id="7923762">gaddr</span><span class="op" id="7923767">)</span><span class="op" id="7923768">;</span>&nbsp;<span class="ident" id="7923770">err</span>&nbsp;<span class="op" id="7923774">!=</span>&nbsp;<span class="ident" id="7923777">nil</span>&nbsp;<span class="op" id="7923781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923787">closer</span><span class="op" id="7923793">(</span><span class="ident" id="7923794">cs</span><span class="op" id="7923796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923802">t</span><span class="op" id="7923803">.</span><span class="ident" id="7923804">Fatalf</span><span class="op" id="7923810">(</span><span class="string" id="7923811">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7923855">,</span>&nbsp;<span class="ident" id="7923857">ifi</span><span class="op" id="7923860">,</span>&nbsp;<span class="ident" id="7923862">err</span><span class="op" id="7923865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923870">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923875">if</span>&nbsp;<span class="ident" id="7923878">err</span>&nbsp;<span class="op" id="7923882">:=</span>&nbsp;<span class="ident" id="7923885">checkMulticastListener</span><span class="op" id="7923907">(</span><span class="ident" id="7923908">cs</span><span class="op" id="7923910">[</span><span class="num" id="7923911">1</span><span class="op" id="7923912">]</span><span class="op" id="7923913">,</span>&nbsp;<span class="ident" id="7923915">tt</span><span class="op" id="7923917">.</span><span class="ident" id="7923918">gaddr</span><span class="op" id="7923923">.</span><span class="ident" id="7923924">IP</span><span class="op" id="7923926">)</span><span class="op" id="7923927">;</span>&nbsp;<span class="ident" id="7923929">err</span>&nbsp;<span class="op" id="7923933">!=</span>&nbsp;<span class="ident" id="7923936">nil</span>&nbsp;<span class="op" id="7923940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923946">closer</span><span class="op" id="7923952">(</span><span class="ident" id="7923953">cs</span><span class="op" id="7923955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923961">t</span><span class="op" id="7923962">.</span><span class="ident" id="7923963">Fatal</span><span class="op" id="7923968">(</span><span class="ident" id="7923969">err</span><span class="op" id="7923972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923982">closer</span><span class="op" id="7923988">(</span><span class="ident" id="7923989">cs</span><span class="op" id="7923991">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923998">}</span><br>
<span class="lineno"></span><span class="op" id="7924000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7924003">var</span>&nbsp;<span class="ident" id="7924007">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7924034">=</span>&nbsp;<span class="op" id="7924036">[</span><span class="op" id="7924037">]</span><span class="keyword" id="7924038">struct</span>&nbsp;<span class="op" id="7924045">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924048">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7924054">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924062">gaddr</span>&nbsp;<span class="op" id="7924068">*</span><span class="ident" id="7924069">UDPAddr</span>&nbsp;<span class="comment" id="7924077">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7924093">}</span><span class="op" id="7924094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924097">{</span><span class="string" id="7924098">&#34;udp&#34;</span><span class="op" id="7924103">,</span>&nbsp;<span class="op" id="7924105">&amp;</span><span class="ident" id="7924106">UDPAddr</span><span class="op" id="7924113">{</span><span class="ident" id="7924114">IP</span><span class="op" id="7924116">:</span>&nbsp;<span class="ident" id="7924118">ParseIP</span><span class="op" id="7924125">(</span><span class="string" id="7924126">&#34;ff01::114&#34;</span><span class="op" id="7924137">)</span><span class="op" id="7924138">,</span>&nbsp;<span class="ident" id="7924140">Port</span><span class="op" id="7924144">:</span>&nbsp;<span class="num" id="7924146">12345</span><span class="op" id="7924151">}</span><span class="op" id="7924152">}</span><span class="op" id="7924153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924156">{</span><span class="string" id="7924157">&#34;udp&#34;</span><span class="op" id="7924162">,</span>&nbsp;<span class="op" id="7924164">&amp;</span><span class="ident" id="7924165">UDPAddr</span><span class="op" id="7924172">{</span><span class="ident" id="7924173">IP</span><span class="op" id="7924175">:</span>&nbsp;<span class="ident" id="7924177">ParseIP</span><span class="op" id="7924184">(</span><span class="string" id="7924185">&#34;ff02::114&#34;</span><span class="op" id="7924196">)</span><span class="op" id="7924197">,</span>&nbsp;<span class="ident" id="7924199">Port</span><span class="op" id="7924203">:</span>&nbsp;<span class="num" id="7924205">12345</span><span class="op" id="7924210">}</span><span class="op" id="7924211">}</span><span class="op" id="7924212">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924215">{</span><span class="string" id="7924216">&#34;udp&#34;</span><span class="op" id="7924221">,</span>&nbsp;<span class="op" id="7924223">&amp;</span><span class="ident" id="7924224">UDPAddr</span><span class="op" id="7924231">{</span><span class="ident" id="7924232">IP</span><span class="op" id="7924234">:</span>&nbsp;<span class="ident" id="7924236">ParseIP</span><span class="op" id="7924243">(</span><span class="string" id="7924244">&#34;ff04::114&#34;</span><span class="op" id="7924255">)</span><span class="op" id="7924256">,</span>&nbsp;<span class="ident" id="7924258">Port</span><span class="op" id="7924262">:</span>&nbsp;<span class="num" id="7924264">12345</span><span class="op" id="7924269">}</span><span class="op" id="7924270">}</span><span class="op" id="7924271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924274">{</span><span class="string" id="7924275">&#34;udp&#34;</span><span class="op" id="7924280">,</span>&nbsp;<span class="op" id="7924282">&amp;</span><span class="ident" id="7924283">UDPAddr</span><span class="op" id="7924290">{</span><span class="ident" id="7924291">IP</span><span class="op" id="7924293">:</span>&nbsp;<span class="ident" id="7924295">ParseIP</span><span class="op" id="7924302">(</span><span class="string" id="7924303">&#34;ff05::114&#34;</span><span class="op" id="7924314">)</span><span class="op" id="7924315">,</span>&nbsp;<span class="ident" id="7924317">Port</span><span class="op" id="7924321">:</span>&nbsp;<span class="num" id="7924323">12345</span><span class="op" id="7924328">}</span><span class="op" id="7924329">}</span><span class="op" id="7924330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924333">{</span><span class="string" id="7924334">&#34;udp&#34;</span><span class="op" id="7924339">,</span>&nbsp;<span class="op" id="7924341">&amp;</span><span class="ident" id="7924342">UDPAddr</span><span class="op" id="7924349">{</span><span class="ident" id="7924350">IP</span><span class="op" id="7924352">:</span>&nbsp;<span class="ident" id="7924354">ParseIP</span><span class="op" id="7924361">(</span><span class="string" id="7924362">&#34;ff08::114&#34;</span><span class="op" id="7924373">)</span><span class="op" id="7924374">,</span>&nbsp;<span class="ident" id="7924376">Port</span><span class="op" id="7924380">:</span>&nbsp;<span class="num" id="7924382">12345</span><span class="op" id="7924387">}</span><span class="op" id="7924388">}</span><span class="op" id="7924389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924392">{</span><span class="string" id="7924393">&#34;udp&#34;</span><span class="op" id="7924398">,</span>&nbsp;<span class="op" id="7924400">&amp;</span><span class="ident" id="7924401">UDPAddr</span><span class="op" id="7924408">{</span><span class="ident" id="7924409">IP</span><span class="op" id="7924411">:</span>&nbsp;<span class="ident" id="7924413">ParseIP</span><span class="op" id="7924420">(</span><span class="string" id="7924421">&#34;ff0e::114&#34;</span><span class="op" id="7924432">)</span><span class="op" id="7924433">,</span>&nbsp;<span class="ident" id="7924435">Port</span><span class="op" id="7924439">:</span>&nbsp;<span class="num" id="7924441">12345</span><span class="op" id="7924446">}</span><span class="op" id="7924447">}</span><span class="op" id="7924448">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924452">{</span><span class="string" id="7924453">&#34;udp6&#34;</span><span class="op" id="7924459">,</span>&nbsp;<span class="op" id="7924461">&amp;</span><span class="ident" id="7924462">UDPAddr</span><span class="op" id="7924469">{</span><span class="ident" id="7924470">IP</span><span class="op" id="7924472">:</span>&nbsp;<span class="ident" id="7924474">ParseIP</span><span class="op" id="7924481">(</span><span class="string" id="7924482">&#34;ff01::114&#34;</span><span class="op" id="7924493">)</span><span class="op" id="7924494">,</span>&nbsp;<span class="ident" id="7924496">Port</span><span class="op" id="7924500">:</span>&nbsp;<span class="num" id="7924502">12345</span><span class="op" id="7924507">}</span><span class="op" id="7924508">}</span><span class="op" id="7924509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924512">{</span><span class="string" id="7924513">&#34;udp6&#34;</span><span class="op" id="7924519">,</span>&nbsp;<span class="op" id="7924521">&amp;</span><span class="ident" id="7924522">UDPAddr</span><span class="op" id="7924529">{</span><span class="ident" id="7924530">IP</span><span class="op" id="7924532">:</span>&nbsp;<span class="ident" id="7924534">ParseIP</span><span class="op" id="7924541">(</span><span class="string" id="7924542">&#34;ff02::114&#34;</span><span class="op" id="7924553">)</span><span class="op" id="7924554">,</span>&nbsp;<span class="ident" id="7924556">Port</span><span class="op" id="7924560">:</span>&nbsp;<span class="num" id="7924562">12345</span><span class="op" id="7924567">}</span><span class="op" id="7924568">}</span><span class="op" id="7924569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924572">{</span><span class="string" id="7924573">&#34;udp6&#34;</span><span class="op" id="7924579">,</span>&nbsp;<span class="op" id="7924581">&amp;</span><span class="ident" id="7924582">UDPAddr</span><span class="op" id="7924589">{</span><span class="ident" id="7924590">IP</span><span class="op" id="7924592">:</span>&nbsp;<span class="ident" id="7924594">ParseIP</span><span class="op" id="7924601">(</span><span class="string" id="7924602">&#34;ff04::114&#34;</span><span class="op" id="7924613">)</span><span class="op" id="7924614">,</span>&nbsp;<span class="ident" id="7924616">Port</span><span class="op" id="7924620">:</span>&nbsp;<span class="num" id="7924622">12345</span><span class="op" id="7924627">}</span><span class="op" id="7924628">}</span><span class="op" id="7924629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924632">{</span><span class="string" id="7924633">&#34;udp6&#34;</span><span class="op" id="7924639">,</span>&nbsp;<span class="op" id="7924641">&amp;</span><span class="ident" id="7924642">UDPAddr</span><span class="op" id="7924649">{</span><span class="ident" id="7924650">IP</span><span class="op" id="7924652">:</span>&nbsp;<span class="ident" id="7924654">ParseIP</span><span class="op" id="7924661">(</span><span class="string" id="7924662">&#34;ff05::114&#34;</span><span class="op" id="7924673">)</span><span class="op" id="7924674">,</span>&nbsp;<span class="ident" id="7924676">Port</span><span class="op" id="7924680">:</span>&nbsp;<span class="num" id="7924682">12345</span><span class="op" id="7924687">}</span><span class="op" id="7924688">}</span><span class="op" id="7924689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924692">{</span><span class="string" id="7924693">&#34;udp6&#34;</span><span class="op" id="7924699">,</span>&nbsp;<span class="op" id="7924701">&amp;</span><span class="ident" id="7924702">UDPAddr</span><span class="op" id="7924709">{</span><span class="ident" id="7924710">IP</span><span class="op" id="7924712">:</span>&nbsp;<span class="ident" id="7924714">ParseIP</span><span class="op" id="7924721">(</span><span class="string" id="7924722">&#34;ff08::114&#34;</span><span class="op" id="7924733">)</span><span class="op" id="7924734">,</span>&nbsp;<span class="ident" id="7924736">Port</span><span class="op" id="7924740">:</span>&nbsp;<span class="num" id="7924742">12345</span><span class="op" id="7924747">}</span><span class="op" id="7924748">}</span><span class="op" id="7924749">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924752">{</span><span class="string" id="7924753">&#34;udp6&#34;</span><span class="op" id="7924759">,</span>&nbsp;<span class="op" id="7924761">&amp;</span><span class="ident" id="7924762">UDPAddr</span><span class="op" id="7924769">{</span><span class="ident" id="7924770">IP</span><span class="op" id="7924772">:</span>&nbsp;<span class="ident" id="7924774">ParseIP</span><span class="op" id="7924781">(</span><span class="string" id="7924782">&#34;ff0e::114&#34;</span><span class="op" id="7924793">)</span><span class="op" id="7924794">,</span>&nbsp;<span class="ident" id="7924796">Port</span><span class="op" id="7924800">:</span>&nbsp;<span class="num" id="7924802">12345</span><span class="op" id="7924807">}</span><span class="op" id="7924808">}</span><span class="op" id="7924809">,</span><br>
<span class="lineno"></span><span class="op" id="7924811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7924814">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7924884">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="7924955">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7924964">func</span>&nbsp;<span class="ident" id="7924969">TestIPv6MulticastListener</span><span class="op" id="7924994">(</span><span class="ident" id="7924995">t</span>&nbsp;<span class="op" id="7924997">*</span><span class="ident" id="7924998">testing</span><span class="op" id="7925005">.</span><span class="ident" id="7925006">T</span><span class="op" id="7925007">)</span>&nbsp;<span class="op" id="7925009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925012">switch</span>&nbsp;<span class="ident" id="7925019">runtime</span><span class="op" id="7925026">.</span><span class="ident" id="7925027">GOOS</span>&nbsp;<span class="op" id="7925032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925035">case</span>&nbsp;<span class="string" id="7925040">&#34;plan9&#34;</span><span class="op" id="7925047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925051">t</span><span class="op" id="7925052">.</span><span class="ident" id="7925053">Skipf</span><span class="op" id="7925058">(</span><span class="string" id="7925059">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7925080">,</span>&nbsp;<span class="ident" id="7925082">runtime</span><span class="op" id="7925089">.</span><span class="ident" id="7925090">GOOS</span><span class="op" id="7925094">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925097">case</span>&nbsp;<span class="string" id="7925102">&#34;solaris&#34;</span><span class="op" id="7925111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925115">t</span><span class="op" id="7925116">.</span><span class="ident" id="7925117">Skipf</span><span class="op" id="7925122">(</span><span class="string" id="7925123">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7925165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925171">if</span>&nbsp;<span class="op" id="7925174">!</span><span class="ident" id="7925175">supportsIPv6</span>&nbsp;<span class="op" id="7925188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925192">t</span><span class="op" id="7925193">.</span><span class="ident" id="7925194">Skip</span><span class="op" id="7925198">(</span><span class="string" id="7925199">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7925222">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925228">if</span>&nbsp;<span class="ident" id="7925231">os</span><span class="op" id="7925233">.</span><span class="ident" id="7925234">Getuid</span><span class="op" id="7925240">(</span><span class="op" id="7925241">)</span>&nbsp;<span class="op" id="7925243">!=</span>&nbsp;<span class="num" id="7925246">0</span>&nbsp;<span class="op" id="7925248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925252">t</span><span class="op" id="7925253">.</span><span class="ident" id="7925254">Skip</span><span class="op" id="7925258">(</span><span class="string" id="7925259">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7925288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925295">closer</span>&nbsp;<span class="op" id="7925302">:=</span>&nbsp;<span class="keyword" id="7925305">func</span><span class="op" id="7925309">(</span><span class="ident" id="7925310">cs</span>&nbsp;<span class="op" id="7925313">[</span><span class="op" id="7925314">]</span><span class="op" id="7925315">*</span><span class="ident" id="7925316">UDPConn</span><span class="op" id="7925323">)</span>&nbsp;<span class="op" id="7925325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925329">for</span>&nbsp;<span class="ident" id="7925333">_</span><span class="op" id="7925334">,</span>&nbsp;<span class="ident" id="7925336">c</span>&nbsp;<span class="op" id="7925338">:=</span>&nbsp;<span class="keyword" id="7925341">range</span>&nbsp;<span class="ident" id="7925347">cs</span>&nbsp;<span class="op" id="7925350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925355">if</span>&nbsp;<span class="ident" id="7925358">c</span>&nbsp;<span class="op" id="7925360">!=</span>&nbsp;<span class="ident" id="7925363">nil</span>&nbsp;<span class="op" id="7925367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925373">c</span><span class="op" id="7925374">.</span><span class="ident" id="7925375">Close</span><span class="op" id="7925380">(</span><span class="op" id="7925381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925386">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925397">for</span>&nbsp;<span class="ident" id="7925401">_</span><span class="op" id="7925402">,</span>&nbsp;<span class="ident" id="7925404">ifi</span>&nbsp;<span class="op" id="7925408">:=</span>&nbsp;<span class="keyword" id="7925411">range</span>&nbsp;<span class="op" id="7925417">[</span><span class="op" id="7925418">]</span><span class="op" id="7925419">*</span><span class="ident" id="7925420">Interface</span><span class="op" id="7925429">{</span><span class="ident" id="7925430">loopbackInterface</span><span class="op" id="7925447">(</span><span class="op" id="7925448">)</span><span class="op" id="7925449">,</span>&nbsp;<span class="ident" id="7925451">nil</span><span class="op" id="7925454">}</span>&nbsp;<span class="op" id="7925456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925460">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925516">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925569">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925619">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925671">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925689">if</span>&nbsp;<span class="ident" id="7925692">ifi</span>&nbsp;<span class="op" id="7925696">==</span>&nbsp;<span class="ident" id="7925699">nil</span>&nbsp;<span class="op" id="7925703">&amp;&amp;</span>&nbsp;<span class="op" id="7925706">(</span><span class="op" id="7925707">!</span><span class="op" id="7925708">*</span><span class="ident" id="7925709">testExternal</span>&nbsp;<span class="op" id="7925722">||</span>&nbsp;<span class="op" id="7925725">!</span><span class="op" id="7925726">*</span><span class="ident" id="7925727">testIPv6</span><span class="op" id="7925735">)</span>&nbsp;<span class="op" id="7925737">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925742">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925757">for</span>&nbsp;<span class="ident" id="7925761">_</span><span class="op" id="7925762">,</span>&nbsp;<span class="ident" id="7925764">tt</span>&nbsp;<span class="op" id="7925767">:=</span>&nbsp;<span class="keyword" id="7925770">range</span>&nbsp;<span class="ident" id="7925776">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7925803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925808">var</span>&nbsp;<span class="ident" id="7925812">err</span>&nbsp;<span class="builtintype" id="7925816">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925825">cs</span>&nbsp;<span class="op" id="7925828">:=</span>&nbsp;<span class="builtinfunc" id="7925831">make</span><span class="op" id="7925835">(</span><span class="op" id="7925836">[</span><span class="op" id="7925837">]</span><span class="op" id="7925838">*</span><span class="ident" id="7925839">UDPConn</span><span class="op" id="7925846">,</span>&nbsp;<span class="num" id="7925848">2</span><span class="op" id="7925849">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925854">if</span>&nbsp;<span class="ident" id="7925857">cs</span><span class="op" id="7925859">[</span><span class="num" id="7925860">0</span><span class="op" id="7925861">]</span><span class="op" id="7925862">,</span>&nbsp;<span class="ident" id="7925864">err</span>&nbsp;<span class="op" id="7925868">=</span>&nbsp;<span class="ident" id="7925870">ListenMulticastUDP</span><span class="op" id="7925888">(</span><span class="ident" id="7925889">tt</span><span class="op" id="7925891">.</span><span class="ident" id="7925892">net</span><span class="op" id="7925895">,</span>&nbsp;<span class="ident" id="7925897">ifi</span><span class="op" id="7925900">,</span>&nbsp;<span class="ident" id="7925902">tt</span><span class="op" id="7925904">.</span><span class="ident" id="7925905">gaddr</span><span class="op" id="7925910">)</span><span class="op" id="7925911">;</span>&nbsp;<span class="ident" id="7925913">err</span>&nbsp;<span class="op" id="7925917">!=</span>&nbsp;<span class="ident" id="7925920">nil</span>&nbsp;<span class="op" id="7925924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925930">t</span><span class="op" id="7925931">.</span><span class="ident" id="7925932">Fatalf</span><span class="op" id="7925938">(</span><span class="string" id="7925939">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7925982">,</span>&nbsp;<span class="ident" id="7925984">ifi</span><span class="op" id="7925987">,</span>&nbsp;<span class="ident" id="7925989">err</span><span class="op" id="7925992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926002">if</span>&nbsp;<span class="ident" id="7926005">err</span>&nbsp;<span class="op" id="7926009">:=</span>&nbsp;<span class="ident" id="7926012">checkMulticastListener</span><span class="op" id="7926034">(</span><span class="ident" id="7926035">cs</span><span class="op" id="7926037">[</span><span class="num" id="7926038">0</span><span class="op" id="7926039">]</span><span class="op" id="7926040">,</span>&nbsp;<span class="ident" id="7926042">tt</span><span class="op" id="7926044">.</span><span class="ident" id="7926045">gaddr</span><span class="op" id="7926050">.</span><span class="ident" id="7926051">IP</span><span class="op" id="7926053">)</span><span class="op" id="7926054">;</span>&nbsp;<span class="ident" id="7926056">err</span>&nbsp;<span class="op" id="7926060">!=</span>&nbsp;<span class="ident" id="7926063">nil</span>&nbsp;<span class="op" id="7926067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926073">closer</span><span class="op" id="7926079">(</span><span class="ident" id="7926080">cs</span><span class="op" id="7926082">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926088">t</span><span class="op" id="7926089">.</span><span class="ident" id="7926090">Fatal</span><span class="op" id="7926095">(</span><span class="ident" id="7926096">err</span><span class="op" id="7926099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926109">if</span>&nbsp;<span class="ident" id="7926112">cs</span><span class="op" id="7926114">[</span><span class="num" id="7926115">1</span><span class="op" id="7926116">]</span><span class="op" id="7926117">,</span>&nbsp;<span class="ident" id="7926119">err</span>&nbsp;<span class="op" id="7926123">=</span>&nbsp;<span class="ident" id="7926125">ListenMulticastUDP</span><span class="op" id="7926143">(</span><span class="ident" id="7926144">tt</span><span class="op" id="7926146">.</span><span class="ident" id="7926147">net</span><span class="op" id="7926150">,</span>&nbsp;<span class="ident" id="7926152">ifi</span><span class="op" id="7926155">,</span>&nbsp;<span class="ident" id="7926157">tt</span><span class="op" id="7926159">.</span><span class="ident" id="7926160">gaddr</span><span class="op" id="7926165">)</span><span class="op" id="7926166">;</span>&nbsp;<span class="ident" id="7926168">err</span>&nbsp;<span class="op" id="7926172">!=</span>&nbsp;<span class="ident" id="7926175">nil</span>&nbsp;<span class="op" id="7926179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926185">closer</span><span class="op" id="7926191">(</span><span class="ident" id="7926192">cs</span><span class="op" id="7926194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926200">t</span><span class="op" id="7926201">.</span><span class="ident" id="7926202">Fatalf</span><span class="op" id="7926208">(</span><span class="string" id="7926209">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7926253">,</span>&nbsp;<span class="ident" id="7926255">ifi</span><span class="op" id="7926258">,</span>&nbsp;<span class="ident" id="7926260">err</span><span class="op" id="7926263">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926273">if</span>&nbsp;<span class="ident" id="7926276">err</span>&nbsp;<span class="op" id="7926280">:=</span>&nbsp;<span class="ident" id="7926283">checkMulticastListener</span><span class="op" id="7926305">(</span><span class="ident" id="7926306">cs</span><span class="op" id="7926308">[</span><span class="num" id="7926309">1</span><span class="op" id="7926310">]</span><span class="op" id="7926311">,</span>&nbsp;<span class="ident" id="7926313">tt</span><span class="op" id="7926315">.</span><span class="ident" id="7926316">gaddr</span><span class="op" id="7926321">.</span><span class="ident" id="7926322">IP</span><span class="op" id="7926324">)</span><span class="op" id="7926325">;</span>&nbsp;<span class="ident" id="7926327">err</span>&nbsp;<span class="op" id="7926331">!=</span>&nbsp;<span class="ident" id="7926334">nil</span>&nbsp;<span class="op" id="7926338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926344">closer</span><span class="op" id="7926350">(</span><span class="ident" id="7926351">cs</span><span class="op" id="7926353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926359">t</span><span class="op" id="7926360">.</span><span class="ident" id="7926361">Fatal</span><span class="op" id="7926366">(</span><span class="ident" id="7926367">err</span><span class="op" id="7926370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926375">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926380">closer</span><span class="op" id="7926386">(</span><span class="ident" id="7926387">cs</span><span class="op" id="7926389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926396">}</span><br>
<span class="lineno"></span><span class="op" id="7926398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7926401">func</span>&nbsp;<span class="ident" id="7926406">checkMulticastListener</span><span class="op" id="7926428">(</span><span class="ident" id="7926429">c</span>&nbsp;<span class="op" id="7926431">*</span><span class="ident" id="7926432">UDPConn</span><span class="op" id="7926439">,</span>&nbsp;<span class="ident" id="7926441">ip</span>&nbsp;<span class="ident" id="7926444">IP</span><span class="op" id="7926446">)</span>&nbsp;<span class="builtintype" id="7926448">error</span>&nbsp;<span class="op" id="7926454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926457">if</span>&nbsp;<span class="ident" id="7926460">ok</span><span class="op" id="7926462">,</span>&nbsp;<span class="ident" id="7926464">err</span>&nbsp;<span class="op" id="7926468">:=</span>&nbsp;<span class="ident" id="7926471">multicastRIBContains</span><span class="op" id="7926491">(</span><span class="ident" id="7926492">ip</span><span class="op" id="7926494">)</span><span class="op" id="7926495">;</span>&nbsp;<span class="ident" id="7926497">err</span>&nbsp;<span class="op" id="7926501">!=</span>&nbsp;<span class="ident" id="7926504">nil</span>&nbsp;<span class="op" id="7926508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926512">return</span>&nbsp;<span class="ident" id="7926519">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926524">}</span>&nbsp;<span class="keyword" id="7926526">else</span>&nbsp;<span class="keyword" id="7926531">if</span>&nbsp;<span class="op" id="7926534">!</span><span class="ident" id="7926535">ok</span>&nbsp;<span class="op" id="7926538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926542">return</span>&nbsp;<span class="ident" id="7926549">fmt</span><span class="op" id="7926552">.</span><span class="ident" id="7926553">Errorf</span><span class="op" id="7926559">(</span><span class="string" id="7926560">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="7926591">,</span>&nbsp;<span class="ident" id="7926593">ip</span><span class="op" id="7926595">.</span><span class="ident" id="7926596">String</span><span class="op" id="7926602">(</span><span class="op" id="7926603">)</span><span class="op" id="7926604">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926610">la</span>&nbsp;<span class="op" id="7926613">:=</span>&nbsp;<span class="ident" id="7926616">c</span><span class="op" id="7926617">.</span><span class="ident" id="7926618">LocalAddr</span><span class="op" id="7926627">(</span><span class="op" id="7926628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926631">if</span>&nbsp;<span class="ident" id="7926634">la</span><span class="op" id="7926636">,</span>&nbsp;<span class="ident" id="7926638">ok</span>&nbsp;<span class="op" id="7926641">:=</span>&nbsp;<span class="ident" id="7926644">la</span><span class="op" id="7926646">.</span><span class="op" id="7926647">(</span><span class="op" id="7926648">*</span><span class="ident" id="7926649">UDPAddr</span><span class="op" id="7926656">)</span><span class="op" id="7926657">;</span>&nbsp;<span class="op" id="7926659">!</span><span class="ident" id="7926660">ok</span>&nbsp;<span class="op" id="7926663">||</span>&nbsp;<span class="ident" id="7926666">la</span><span class="op" id="7926668">.</span><span class="ident" id="7926669">Port</span>&nbsp;<span class="op" id="7926674">==</span>&nbsp;<span class="num" id="7926677">0</span>&nbsp;<span class="op" id="7926679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926683">return</span>&nbsp;<span class="ident" id="7926690">fmt</span><span class="op" id="7926693">.</span><span class="ident" id="7926694">Errorf</span><span class="op" id="7926700">(</span><span class="string" id="7926701">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7926762">,</span>&nbsp;<span class="ident" id="7926764">la</span><span class="op" id="7926766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926769">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926772">return</span>&nbsp;<span class="ident" id="7926779">nil</span><br>
<span class="lineno"></span><span class="op" id="7926783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7926786">func</span>&nbsp;<span class="ident" id="7926791">multicastRIBContains</span><span class="op" id="7926811">(</span><span class="ident" id="7926812">ip</span>&nbsp;<span class="ident" id="7926815">IP</span><span class="op" id="7926817">)</span>&nbsp;<span class="op" id="7926819">(</span><span class="builtintype" id="7926820">bool</span><span class="op" id="7926824">,</span>&nbsp;<span class="builtintype" id="7926826">error</span><span class="op" id="7926831">)</span>&nbsp;<span class="op" id="7926833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926836">switch</span>&nbsp;<span class="ident" id="7926843">runtime</span><span class="op" id="7926850">.</span><span class="ident" id="7926851">GOOS</span>&nbsp;<span class="op" id="7926856">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926859">case</span>&nbsp;<span class="string" id="7926864">&#34;dragonfly&#34;</span><span class="op" id="7926875">,</span>&nbsp;<span class="string" id="7926877">&#34;netbsd&#34;</span><span class="op" id="7926885">,</span>&nbsp;<span class="string" id="7926887">&#34;openbsd&#34;</span><span class="op" id="7926896">,</span>&nbsp;<span class="string" id="7926898">&#34;plan9&#34;</span><span class="op" id="7926905">,</span>&nbsp;<span class="string" id="7926907">&#34;solaris&#34;</span><span class="op" id="7926916">,</span>&nbsp;<span class="string" id="7926918">&#34;windows&#34;</span><span class="op" id="7926927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926931">return</span>&nbsp;<span class="builtintype" id="7926938">true</span><span class="op" id="7926942">,</span>&nbsp;<span class="ident" id="7926944">nil</span>&nbsp;<span class="comment" id="7926948">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926972">case</span>&nbsp;<span class="string" id="7926977">&#34;linux&#34;</span><span class="op" id="7926984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926988">if</span>&nbsp;<span class="ident" id="7926991">runtime</span><span class="op" id="7926998">.</span><span class="ident" id="7926999">GOARCH</span>&nbsp;<span class="op" id="7927006">==</span>&nbsp;<span class="string" id="7927009">&#34;arm&#34;</span>&nbsp;<span class="op" id="7927015">||</span>&nbsp;<span class="ident" id="7927018">runtime</span><span class="op" id="7927025">.</span><span class="ident" id="7927026">GOARCH</span>&nbsp;<span class="op" id="7927033">==</span>&nbsp;<span class="string" id="7927036">&#34;alpha&#34;</span>&nbsp;<span class="op" id="7927044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927049">return</span>&nbsp;<span class="builtintype" id="7927056">true</span><span class="op" id="7927060">,</span>&nbsp;<span class="ident" id="7927062">nil</span>&nbsp;<span class="comment" id="7927066">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927097">ift</span><span class="op" id="7927100">,</span>&nbsp;<span class="ident" id="7927102">err</span>&nbsp;<span class="op" id="7927106">:=</span>&nbsp;<span class="ident" id="7927109">Interfaces</span><span class="op" id="7927119">(</span><span class="op" id="7927120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927123">if</span>&nbsp;<span class="ident" id="7927126">err</span>&nbsp;<span class="op" id="7927130">!=</span>&nbsp;<span class="ident" id="7927133">nil</span>&nbsp;<span class="op" id="7927137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927141">return</span>&nbsp;<span class="builtintype" id="7927148">false</span><span class="op" id="7927153">,</span>&nbsp;<span class="ident" id="7927155">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927163">for</span>&nbsp;<span class="ident" id="7927167">_</span><span class="op" id="7927168">,</span>&nbsp;<span class="ident" id="7927170">ifi</span>&nbsp;<span class="op" id="7927174">:=</span>&nbsp;<span class="keyword" id="7927177">range</span>&nbsp;<span class="ident" id="7927183">ift</span>&nbsp;<span class="op" id="7927187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927191">ifmat</span><span class="op" id="7927196">,</span>&nbsp;<span class="ident" id="7927198">err</span>&nbsp;<span class="op" id="7927202">:=</span>&nbsp;<span class="ident" id="7927205">ifi</span><span class="op" id="7927208">.</span><span class="ident" id="7927209">MulticastAddrs</span><span class="op" id="7927223">(</span><span class="op" id="7927224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927228">if</span>&nbsp;<span class="ident" id="7927231">err</span>&nbsp;<span class="op" id="7927235">!=</span>&nbsp;<span class="ident" id="7927238">nil</span>&nbsp;<span class="op" id="7927242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927247">return</span>&nbsp;<span class="builtintype" id="7927254">false</span><span class="op" id="7927259">,</span>&nbsp;<span class="ident" id="7927261">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927271">for</span>&nbsp;<span class="ident" id="7927275">_</span><span class="op" id="7927276">,</span>&nbsp;<span class="ident" id="7927278">ifma</span>&nbsp;<span class="op" id="7927283">:=</span>&nbsp;<span class="keyword" id="7927286">range</span>&nbsp;<span class="ident" id="7927292">ifmat</span>&nbsp;<span class="op" id="7927298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927303">if</span>&nbsp;<span class="ident" id="7927306">ifma</span><span class="op" id="7927310">.</span><span class="op" id="7927311">(</span><span class="op" id="7927312">*</span><span class="ident" id="7927313">IPAddr</span><span class="op" id="7927319">)</span><span class="op" id="7927320">.</span><span class="ident" id="7927321">IP</span><span class="op" id="7927323">.</span><span class="ident" id="7927324">Equal</span><span class="op" id="7927329">(</span><span class="ident" id="7927330">ip</span><span class="op" id="7927332">)</span>&nbsp;<span class="op" id="7927334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927340">return</span>&nbsp;<span class="builtintype" id="7927347">true</span><span class="op" id="7927351">,</span>&nbsp;<span class="ident" id="7927353">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927360">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927370">return</span>&nbsp;<span class="builtintype" id="7927377">false</span><span class="op" id="7927382">,</span>&nbsp;<span class="ident" id="7927384">nil</span><br>
<span class="lineno"></span><span class="op" id="7927388">}</span>
</div>
</body>
</html>
