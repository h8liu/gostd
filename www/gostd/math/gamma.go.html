<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2244959">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2245014">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2245068">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2245119">package</span>&nbsp;<span class="ident" id="2245127">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2245133">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2245193">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2245258">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2245316">//</span><br>
<span class="lineno"></span><span class="comment" id="2245319">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2245336">//</span><br>
<span class="lineno"></span><span class="comment" id="2245339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2245362">//</span><br>
<span class="lineno">15</span><span class="comment" id="2245365">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2245378">//</span><br>
<span class="lineno"></span><span class="comment" id="2245381">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2245407">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2245430">//</span><br>
<span class="lineno">20</span><span class="comment" id="2245433">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2245453">//</span><br>
<span class="lineno"></span><span class="comment" id="2245456">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2245472">//</span><br>
<span class="lineno"></span><span class="comment" id="2245475">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2245533">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2245586">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2245643">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2245703">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2245725">//</span><br>
<span class="lineno">30</span><span class="comment" id="2245728">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2245794">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2245854">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2245916">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2245977">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2246002">//</span><br>
<span class="lineno"></span><span class="comment" id="2246005">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2246018">//</span><br>
<span class="lineno"></span><span class="comment" id="2246021">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2246061">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2246119">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2246179">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2246239">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2246299">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2246359">//</span><br>
<span class="lineno">45</span><span class="comment" id="2246362">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2246423">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2246484">//</span><br>
<span class="lineno"></span><span class="comment" id="2246487">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2246535">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2246599">//</span><br>
<span class="lineno"></span><span class="comment" id="2246602">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2246663">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2246733">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2246808">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2246875">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2246948">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2247020">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2247034">//</span><br>
<span class="lineno"></span><span class="comment" id="2247037">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2247103">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2247169">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2247182">//</span><br>
<span class="lineno"></span><span class="comment" id="2247185">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2247209">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2247239">var</span>&nbsp;<span class="ident" id="2247243">_gamP</span>&nbsp;<span class="op" id="2247249">=</span>&nbsp;<span class="op" id="2247251">[</span><span class="op" id="2247252">...</span><span class="op" id="2247255">]</span><span class="builtintype" id="2247256">float64</span><span class="op" id="2247263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247266">1.60119522476751861407e-04</span><span class="op" id="2247292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247295">1.19135147006586384913e-03</span><span class="op" id="2247321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247324">1.04213797561761569935e-02</span><span class="op" id="2247350">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247353">4.76367800457137231464e-02</span><span class="op" id="2247379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247382">2.07448227648435975150e-01</span><span class="op" id="2247408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247411">4.94214826801497100753e-01</span><span class="op" id="2247437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247440">9.99999999999999996796e-01</span><span class="op" id="2247466">,</span><br>
<span class="lineno"></span><span class="op" id="2247468">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2247470">var</span>&nbsp;<span class="ident" id="2247474">_gamQ</span>&nbsp;<span class="op" id="2247480">=</span>&nbsp;<span class="op" id="2247482">[</span><span class="op" id="2247483">...</span><span class="op" id="2247486">]</span><span class="builtintype" id="2247487">float64</span><span class="op" id="2247494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247497">-</span><span class="num" id="2247498">2.31581873324120129819e-05</span><span class="op" id="2247524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247527">5.39605580493303397842e-04</span><span class="op" id="2247553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247556">-</span><span class="num" id="2247557">4.45641913851797240494e-03</span><span class="op" id="2247583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247586">1.18139785222060435552e-02</span><span class="op" id="2247612">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247615">3.58236398605498653373e-02</span><span class="op" id="2247641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247644">-</span><span class="num" id="2247645">2.34591795718243348568e-01</span><span class="op" id="2247671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247674">7.14304917030273074085e-02</span><span class="op" id="2247700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247703">1.00000000000000000320e+00</span><span class="op" id="2247729">,</span><br>
<span class="lineno"></span><span class="op" id="2247731">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2247733">var</span>&nbsp;<span class="ident" id="2247737">_gamS</span>&nbsp;<span class="op" id="2247743">=</span>&nbsp;<span class="op" id="2247745">[</span><span class="op" id="2247746">...</span><span class="op" id="2247749">]</span><span class="builtintype" id="2247750">float64</span><span class="op" id="2247757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247760">7.87311395793093628397e-04</span><span class="op" id="2247786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247789">-</span><span class="num" id="2247790">2.29549961613378126380e-04</span><span class="op" id="2247816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247819">-</span><span class="num" id="2247820">2.68132617805781232825e-03</span><span class="op" id="2247846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247849">3.47222221605458667310e-03</span><span class="op" id="2247875">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2247878">8.33333333333482257126e-02</span><span class="op" id="2247904">,</span><br>
<span class="lineno"></span><span class="op" id="2247906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247909">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2247959">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2248006">func</span>&nbsp;<span class="ident" id="2248011">stirling</span><span class="op" id="2248019">(</span><span class="ident" id="2248020">x</span>&nbsp;<span class="builtintype" id="2248022">float64</span><span class="op" id="2248029">)</span>&nbsp;<span class="builtintype" id="2248031">float64</span>&nbsp;<span class="op" id="2248039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248042">const</span>&nbsp;<span class="op" id="2248048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248052">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2248064">=</span>&nbsp;<span class="num" id="2248066">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248092">MaxStirling</span>&nbsp;<span class="op" id="2248104">=</span>&nbsp;<span class="num" id="2248106">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248117">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248120">w</span>&nbsp;<span class="op" id="2248122">:=</span>&nbsp;<span class="num" id="2248125">1</span>&nbsp;<span class="op" id="2248127">/</span>&nbsp;<span class="ident" id="2248129"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248132"><a href="/gostd/math/gamma.go.html#2248120">w</a></span>&nbsp;<span class="op" id="2248134">=</span>&nbsp;<span class="num" id="2248136">1</span>&nbsp;<span class="op" id="2248138">+</span>&nbsp;<span class="ident" id="2248140"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><span class="op" id="2248141">*</span><span class="op" id="2248142">(</span><span class="op" id="2248143">(</span><span class="op" id="2248144">(</span><span class="op" id="2248145">(</span><span class="ident" id="2248146"><a href="/gostd/math/gamma.go.html#2247737">_gamS</a></span><span class="op" id="2248151">[</span><span class="num" id="2248152">0</span><span class="op" id="2248153">]</span><span class="op" id="2248154">*</span><span class="ident" id="2248155"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><span class="op" id="2248156">+</span><span class="ident" id="2248157"><a href="/gostd/math/gamma.go.html#2247737">_gamS</a></span><span class="op" id="2248162">[</span><span class="num" id="2248163">1</span><span class="op" id="2248164">]</span><span class="op" id="2248165">)</span><span class="op" id="2248166">*</span><span class="ident" id="2248167"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><span class="op" id="2248168">+</span><span class="ident" id="2248169"><a href="/gostd/math/gamma.go.html#2247737">_gamS</a></span><span class="op" id="2248174">[</span><span class="num" id="2248175">2</span><span class="op" id="2248176">]</span><span class="op" id="2248177">)</span><span class="op" id="2248178">*</span><span class="ident" id="2248179"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><span class="op" id="2248180">+</span><span class="ident" id="2248181"><a href="/gostd/math/gamma.go.html#2247737">_gamS</a></span><span class="op" id="2248186">[</span><span class="num" id="2248187">3</span><span class="op" id="2248188">]</span><span class="op" id="2248189">)</span><span class="op" id="2248190">*</span><span class="ident" id="2248191"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><span class="op" id="2248192">+</span><span class="ident" id="2248193"><a href="/gostd/math/gamma.go.html#2247737">_gamS</a></span><span class="op" id="2248198">[</span><span class="num" id="2248199">4</span><span class="op" id="2248200">]</span><span class="op" id="2248201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248204">y</span>&nbsp;<span class="op" id="2248206">:=</span>&nbsp;<span class="ident" id="2248209"><a href="/gostd/math/exp.go.html#2229936">Exp</a></span><span class="op" id="2248212">(</span><span class="ident" id="2248213"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><span class="op" id="2248214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248217">if</span>&nbsp;<span class="ident" id="2248220"><a href="/gostd/math/gamma.go.html#2248020">x</a></span>&nbsp;<span class="op" id="2248222">&gt;</span>&nbsp;<span class="ident" id="2248224"><a href="/gostd/math/gamma.go.html#2248092">MaxStirling</a></span>&nbsp;<span class="op" id="2248236">{</span>&nbsp;<span class="comment" id="2248238">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248264">v</span>&nbsp;<span class="op" id="2248266">:=</span>&nbsp;<span class="ident" id="2248269"><a href="/gostd/math/pow.go.html#2313950">Pow</a></span><span class="op" id="2248272">(</span><span class="ident" id="2248273"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><span class="op" id="2248274">,</span>&nbsp;<span class="num" id="2248276">0.5</span><span class="op" id="2248279">*</span><span class="ident" id="2248280"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><span class="op" id="2248281">-</span><span class="num" id="2248282">0.25</span><span class="op" id="2248286">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248290"><a href="/gostd/math/gamma.go.html#2248204">y</a></span>&nbsp;<span class="op" id="2248292">=</span>&nbsp;<span class="ident" id="2248294"><a href="/gostd/math/gamma.go.html#2248264">v</a></span>&nbsp;<span class="op" id="2248296">*</span>&nbsp;<span class="op" id="2248298">(</span><span class="ident" id="2248299"><a href="/gostd/math/gamma.go.html#2248264">v</a></span>&nbsp;<span class="op" id="2248301">/</span>&nbsp;<span class="ident" id="2248303"><a href="/gostd/math/gamma.go.html#2248204">y</a></span><span class="op" id="2248304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248307">}</span>&nbsp;<span class="keyword" id="2248309">else</span>&nbsp;<span class="op" id="2248314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248318"><a href="/gostd/math/gamma.go.html#2248204">y</a></span>&nbsp;<span class="op" id="2248320">=</span>&nbsp;<span class="ident" id="2248322"><a href="/gostd/math/pow.go.html#2313950">Pow</a></span><span class="op" id="2248325">(</span><span class="ident" id="2248326"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><span class="op" id="2248327">,</span>&nbsp;<span class="ident" id="2248329"><a href="/gostd/math/gamma.go.html#2248020">x</a></span><span class="op" id="2248330">-</span><span class="num" id="2248331">0.5</span><span class="op" id="2248334">)</span>&nbsp;<span class="op" id="2248336">/</span>&nbsp;<span class="ident" id="2248338"><a href="/gostd/math/gamma.go.html#2248204">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248344"><a href="/gostd/math/gamma.go.html#2248204">y</a></span>&nbsp;<span class="op" id="2248346">=</span>&nbsp;<span class="ident" id="2248348"><a href="/gostd/math/gamma.go.html#2248052">SqrtTwoPi</a></span>&nbsp;<span class="op" id="2248358">*</span>&nbsp;<span class="ident" id="2248360"><a href="/gostd/math/gamma.go.html#2248204">y</a></span>&nbsp;<span class="op" id="2248362">*</span>&nbsp;<span class="ident" id="2248364"><a href="/gostd/math/gamma.go.html#2248120">w</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248367">return</span>&nbsp;<span class="ident" id="2248374"><a href="/gostd/math/gamma.go.html#2248204">y</a></span><br>
<span class="lineno"></span><span class="op" id="2248376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248379">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2248421">//</span><br>
<span class="lineno">115</span><span class="comment" id="2248424">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2248446">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2248468">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2248488">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2248508">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2248544">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2248565">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2248585">func</span>&nbsp;<span class="ident" id="2248590">Gamma</span><span class="op" id="2248595">(</span><span class="ident" id="2248596">x</span>&nbsp;<span class="builtintype" id="2248598">float64</span><span class="op" id="2248605">)</span>&nbsp;<span class="builtintype" id="2248607">float64</span>&nbsp;<span class="op" id="2248615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248618">const</span>&nbsp;<span class="ident" id="2248624">Euler</span>&nbsp;<span class="op" id="2248630">=</span>&nbsp;<span class="num" id="2248632">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2248685">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248697">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248715">switch</span>&nbsp;<span class="op" id="2248722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248725">case</span>&nbsp;<span class="ident" id="2248730"><a href="/gostd/math/gamma.go.html#2249822">isNegInt</a></span><span class="op" id="2248738">(</span><span class="ident" id="2248739"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2248740">)</span>&nbsp;<span class="op" id="2248742">||</span>&nbsp;<span class="ident" id="2248745"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2248750">(</span><span class="ident" id="2248751"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2248752">,</span>&nbsp;<span class="op" id="2248754">-</span><span class="num" id="2248755">1</span><span class="op" id="2248756">)</span>&nbsp;<span class="op" id="2248758">||</span>&nbsp;<span class="ident" id="2248761"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2248766">(</span><span class="ident" id="2248767"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2248768">)</span><span class="op" id="2248769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248773">return</span>&nbsp;<span class="ident" id="2248780"><a href="/gostd/math/bits.go.html#2211303">NaN</a></span><span class="op" id="2248783">(</span><span class="op" id="2248784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248787">case</span>&nbsp;<span class="ident" id="2248792"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2248794">==</span>&nbsp;<span class="num" id="2248797">0</span><span class="op" id="2248798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248802">if</span>&nbsp;<span class="ident" id="2248805"><a href="/gostd/math/signbit.go.html#2318443">Signbit</a></span><span class="op" id="2248812">(</span><span class="ident" id="2248813"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2248814">)</span>&nbsp;<span class="op" id="2248816">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248821">return</span>&nbsp;<span class="ident" id="2248828"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2248831">(</span><span class="op" id="2248832">-</span><span class="num" id="2248833">1</span><span class="op" id="2248834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248842">return</span>&nbsp;<span class="ident" id="2248849"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2248852">(</span><span class="num" id="2248853">1</span><span class="op" id="2248854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248857">case</span>&nbsp;<span class="ident" id="2248862"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2248864">&lt;</span>&nbsp;<span class="op" id="2248866">-</span><span class="num" id="2248867">170.5674972726612</span>&nbsp;<span class="op" id="2248885">||</span>&nbsp;<span class="ident" id="2248888"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2248890">&gt;</span>&nbsp;<span class="num" id="2248892">171.61447887182298</span><span class="op" id="2248910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248914">return</span>&nbsp;<span class="ident" id="2248921"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2248924">(</span><span class="num" id="2248925">1</span><span class="op" id="2248926">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2248929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248932">q</span>&nbsp;<span class="op" id="2248934">:=</span>&nbsp;<span class="ident" id="2248937"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="2248940">(</span><span class="ident" id="2248941"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2248942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2248945">p</span>&nbsp;<span class="op" id="2248947">:=</span>&nbsp;<span class="ident" id="2248950"><a href="/gostd/math/floor.go.html#2243355">Floor</a></span><span class="op" id="2248955">(</span><span class="ident" id="2248956"><a href="/gostd/math/gamma.go.html#2248932">q</a></span><span class="op" id="2248957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248960">if</span>&nbsp;<span class="ident" id="2248963"><a href="/gostd/math/gamma.go.html#2248932">q</a></span>&nbsp;<span class="op" id="2248965">&gt;</span>&nbsp;<span class="num" id="2248967">33</span>&nbsp;<span class="op" id="2248970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248974">if</span>&nbsp;<span class="ident" id="2248977"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2248979">&gt;=</span>&nbsp;<span class="num" id="2248982">0</span>&nbsp;<span class="op" id="2248984">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2248989">return</span>&nbsp;<span class="ident" id="2248996"><a href="/gostd/math/gamma.go.html#2248011">stirling</a></span><span class="op" id="2249004">(</span><span class="ident" id="2249005"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249014">signgam</span>&nbsp;<span class="op" id="2249022">:=</span>&nbsp;<span class="num" id="2249025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249029">if</span>&nbsp;<span class="ident" id="2249032">ip</span>&nbsp;<span class="op" id="2249035">:=</span>&nbsp;<span class="builtintype" id="2249038">int</span><span class="op" id="2249041">(</span><span class="ident" id="2249042"><a href="/gostd/math/gamma.go.html#2248945">p</a></span><span class="op" id="2249043">)</span><span class="op" id="2249044">;</span>&nbsp;<span class="ident" id="2249046"><a href="/gostd/math/gamma.go.html#2249032">ip</a></span><span class="op" id="2249048">&amp;</span><span class="num" id="2249049">1</span>&nbsp;<span class="op" id="2249051">==</span>&nbsp;<span class="num" id="2249054">0</span>&nbsp;<span class="op" id="2249056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249061"><a href="/gostd/math/gamma.go.html#2249014">signgam</a></span>&nbsp;<span class="op" id="2249069">=</span>&nbsp;<span class="op" id="2249071">-</span><span class="num" id="2249072">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249080">z</span>&nbsp;<span class="op" id="2249082">:=</span>&nbsp;<span class="ident" id="2249085"><a href="/gostd/math/gamma.go.html#2248932">q</a></span>&nbsp;<span class="op" id="2249087">-</span>&nbsp;<span class="ident" id="2249089"><a href="/gostd/math/gamma.go.html#2248945">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249093">if</span>&nbsp;<span class="ident" id="2249096"><a href="/gostd/math/gamma.go.html#2249080">z</a></span>&nbsp;<span class="op" id="2249098">&gt;</span>&nbsp;<span class="num" id="2249100">0.5</span>&nbsp;<span class="op" id="2249104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249109"><a href="/gostd/math/gamma.go.html#2248945">p</a></span>&nbsp;<span class="op" id="2249111">=</span>&nbsp;<span class="ident" id="2249113"><a href="/gostd/math/gamma.go.html#2248945">p</a></span>&nbsp;<span class="op" id="2249115">+</span>&nbsp;<span class="num" id="2249117">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249122"><a href="/gostd/math/gamma.go.html#2249080">z</a></span>&nbsp;<span class="op" id="2249124">=</span>&nbsp;<span class="ident" id="2249126"><a href="/gostd/math/gamma.go.html#2248932">q</a></span>&nbsp;<span class="op" id="2249128">-</span>&nbsp;<span class="ident" id="2249130"><a href="/gostd/math/gamma.go.html#2248945">p</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249138"><a href="/gostd/math/gamma.go.html#2249080">z</a></span>&nbsp;<span class="op" id="2249140">=</span>&nbsp;<span class="ident" id="2249142"><a href="/gostd/math/gamma.go.html#2248932">q</a></span>&nbsp;<span class="op" id="2249144">*</span>&nbsp;<span class="ident" id="2249146"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2249149">(</span><span class="ident" id="2249150"><a href="/gostd/math/const.go.html#2214581">Pi</a></span><span class="op" id="2249152">*</span><span class="ident" id="2249153"><a href="/gostd/math/gamma.go.html#2249080">z</a></span><span class="op" id="2249154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249158">if</span>&nbsp;<span class="ident" id="2249161"><a href="/gostd/math/gamma.go.html#2249080">z</a></span>&nbsp;<span class="op" id="2249163">==</span>&nbsp;<span class="num" id="2249166">0</span>&nbsp;<span class="op" id="2249168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249173">return</span>&nbsp;<span class="ident" id="2249180"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2249183">(</span><span class="ident" id="2249184"><a href="/gostd/math/gamma.go.html#2249014">signgam</a></span><span class="op" id="2249191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249195">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249199"><a href="/gostd/math/gamma.go.html#2249080">z</a></span>&nbsp;<span class="op" id="2249201">=</span>&nbsp;<span class="ident" id="2249203"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2249206">/</span>&nbsp;<span class="op" id="2249208">(</span><span class="ident" id="2249209"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="2249212">(</span><span class="ident" id="2249213"><a href="/gostd/math/gamma.go.html#2249080">z</a></span><span class="op" id="2249214">)</span>&nbsp;<span class="op" id="2249216">*</span>&nbsp;<span class="ident" id="2249218"><a href="/gostd/math/gamma.go.html#2248011">stirling</a></span><span class="op" id="2249226">(</span><span class="ident" id="2249227"><a href="/gostd/math/gamma.go.html#2248932">q</a></span><span class="op" id="2249228">)</span><span class="op" id="2249229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249233">return</span>&nbsp;<span class="builtintype" id="2249240">float64</span><span class="op" id="2249247">(</span><span class="ident" id="2249248"><a href="/gostd/math/gamma.go.html#2249014">signgam</a></span><span class="op" id="2249255">)</span>&nbsp;<span class="op" id="2249257">*</span>&nbsp;<span class="ident" id="2249259"><a href="/gostd/math/gamma.go.html#2249080">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2249266">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249286">z</span>&nbsp;<span class="op" id="2249288">:=</span>&nbsp;<span class="num" id="2249291">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249296">for</span>&nbsp;<span class="ident" id="2249300"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249302">&gt;=</span>&nbsp;<span class="num" id="2249305">3</span>&nbsp;<span class="op" id="2249307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249311"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249313">=</span>&nbsp;<span class="ident" id="2249315"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249317">-</span>&nbsp;<span class="num" id="2249319">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249323"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249325">=</span>&nbsp;<span class="ident" id="2249327"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249329">*</span>&nbsp;<span class="ident" id="2249331"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249334">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249337">for</span>&nbsp;<span class="ident" id="2249341"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249343">&lt;</span>&nbsp;<span class="num" id="2249345">0</span>&nbsp;<span class="op" id="2249347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249351">if</span>&nbsp;<span class="ident" id="2249354"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249356">&gt;</span>&nbsp;<span class="op" id="2249358">-</span><span class="num" id="2249359">1e-09</span>&nbsp;<span class="op" id="2249365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249370">goto</span>&nbsp;<span class="ident" id="2249375"><a href="/gostd/math/gamma.go.html#2249743">small</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249387"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249389">=</span>&nbsp;<span class="ident" id="2249391"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249393">/</span>&nbsp;<span class="ident" id="2249395"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249399"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249401">=</span>&nbsp;<span class="ident" id="2249403"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249405">+</span>&nbsp;<span class="num" id="2249407">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249413">for</span>&nbsp;<span class="ident" id="2249417"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249419">&lt;</span>&nbsp;<span class="num" id="2249421">2</span>&nbsp;<span class="op" id="2249423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249427">if</span>&nbsp;<span class="ident" id="2249430"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249432">&lt;</span>&nbsp;<span class="num" id="2249434">1e-09</span>&nbsp;<span class="op" id="2249440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249445">goto</span>&nbsp;<span class="ident" id="2249450"><a href="/gostd/math/gamma.go.html#2249743">small</a></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249462"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249464">=</span>&nbsp;<span class="ident" id="2249466"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249468">/</span>&nbsp;<span class="ident" id="2249470"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249474"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249476">=</span>&nbsp;<span class="ident" id="2249478"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249480">+</span>&nbsp;<span class="num" id="2249482">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249489">if</span>&nbsp;<span class="ident" id="2249492"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249494">==</span>&nbsp;<span class="num" id="2249497">2</span>&nbsp;<span class="op" id="2249499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249503">return</span>&nbsp;<span class="ident" id="2249510"><a href="/gostd/math/gamma.go.html#2249286">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249517"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249519">=</span>&nbsp;<span class="ident" id="2249521"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249523">-</span>&nbsp;<span class="num" id="2249525">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249528"><a href="/gostd/math/gamma.go.html#2248945">p</a></span>&nbsp;<span class="op" id="2249530">=</span>&nbsp;<span class="op" id="2249532">(</span><span class="op" id="2249533">(</span><span class="op" id="2249534">(</span><span class="op" id="2249535">(</span><span class="op" id="2249536">(</span><span class="ident" id="2249537"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249538">*</span><span class="ident" id="2249539"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249544">[</span><span class="num" id="2249545">0</span><span class="op" id="2249546">]</span><span class="op" id="2249547">+</span><span class="ident" id="2249548"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249553">[</span><span class="num" id="2249554">1</span><span class="op" id="2249555">]</span><span class="op" id="2249556">)</span><span class="op" id="2249557">*</span><span class="ident" id="2249558"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249559">+</span><span class="ident" id="2249560"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249565">[</span><span class="num" id="2249566">2</span><span class="op" id="2249567">]</span><span class="op" id="2249568">)</span><span class="op" id="2249569">*</span><span class="ident" id="2249570"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249571">+</span><span class="ident" id="2249572"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249577">[</span><span class="num" id="2249578">3</span><span class="op" id="2249579">]</span><span class="op" id="2249580">)</span><span class="op" id="2249581">*</span><span class="ident" id="2249582"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249583">+</span><span class="ident" id="2249584"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249589">[</span><span class="num" id="2249590">4</span><span class="op" id="2249591">]</span><span class="op" id="2249592">)</span><span class="op" id="2249593">*</span><span class="ident" id="2249594"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249595">+</span><span class="ident" id="2249596"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249601">[</span><span class="num" id="2249602">5</span><span class="op" id="2249603">]</span><span class="op" id="2249604">)</span><span class="op" id="2249605">*</span><span class="ident" id="2249606"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249608">+</span>&nbsp;<span class="ident" id="2249610"><a href="/gostd/math/gamma.go.html#2247243">_gamP</a></span><span class="op" id="2249615">[</span><span class="num" id="2249616">6</span><span class="op" id="2249617">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249620"><a href="/gostd/math/gamma.go.html#2248932">q</a></span>&nbsp;<span class="op" id="2249622">=</span>&nbsp;<span class="op" id="2249624">(</span><span class="op" id="2249625">(</span><span class="op" id="2249626">(</span><span class="op" id="2249627">(</span><span class="op" id="2249628">(</span><span class="op" id="2249629">(</span><span class="ident" id="2249630"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249631">*</span><span class="ident" id="2249632"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249637">[</span><span class="num" id="2249638">0</span><span class="op" id="2249639">]</span><span class="op" id="2249640">+</span><span class="ident" id="2249641"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249646">[</span><span class="num" id="2249647">1</span><span class="op" id="2249648">]</span><span class="op" id="2249649">)</span><span class="op" id="2249650">*</span><span class="ident" id="2249651"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249652">+</span><span class="ident" id="2249653"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249658">[</span><span class="num" id="2249659">2</span><span class="op" id="2249660">]</span><span class="op" id="2249661">)</span><span class="op" id="2249662">*</span><span class="ident" id="2249663"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249664">+</span><span class="ident" id="2249665"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249670">[</span><span class="num" id="2249671">3</span><span class="op" id="2249672">]</span><span class="op" id="2249673">)</span><span class="op" id="2249674">*</span><span class="ident" id="2249675"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249676">+</span><span class="ident" id="2249677"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249682">[</span><span class="num" id="2249683">4</span><span class="op" id="2249684">]</span><span class="op" id="2249685">)</span><span class="op" id="2249686">*</span><span class="ident" id="2249687"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249688">+</span><span class="ident" id="2249689"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249694">[</span><span class="num" id="2249695">5</span><span class="op" id="2249696">]</span><span class="op" id="2249697">)</span><span class="op" id="2249698">*</span><span class="ident" id="2249699"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249700">+</span><span class="ident" id="2249701"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249706">[</span><span class="num" id="2249707">6</span><span class="op" id="2249708">]</span><span class="op" id="2249709">)</span><span class="op" id="2249710">*</span><span class="ident" id="2249711"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249713">+</span>&nbsp;<span class="ident" id="2249715"><a href="/gostd/math/gamma.go.html#2247474">_gamQ</a></span><span class="op" id="2249720">[</span><span class="num" id="2249721">7</span><span class="op" id="2249722">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249725">return</span>&nbsp;<span class="ident" id="2249732"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249734">*</span>&nbsp;<span class="ident" id="2249736"><a href="/gostd/math/gamma.go.html#2248945">p</a></span>&nbsp;<span class="op" id="2249738">/</span>&nbsp;<span class="ident" id="2249740"><a href="/gostd/math/gamma.go.html#2248932">q</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2249743">small</span><span class="op" id="2249748">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249751">if</span>&nbsp;<span class="ident" id="2249754"><a href="/gostd/math/gamma.go.html#2248596">x</a></span>&nbsp;<span class="op" id="2249756">==</span>&nbsp;<span class="num" id="2249759">0</span>&nbsp;<span class="op" id="2249761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249765">return</span>&nbsp;<span class="ident" id="2249772"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2249775">(</span><span class="num" id="2249776">1</span><span class="op" id="2249777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249783">return</span>&nbsp;<span class="ident" id="2249790"><a href="/gostd/math/gamma.go.html#2249286">z</a></span>&nbsp;<span class="op" id="2249792">/</span>&nbsp;<span class="op" id="2249794">(</span><span class="op" id="2249795">(</span><span class="num" id="2249796">1</span>&nbsp;<span class="op" id="2249798">+</span>&nbsp;<span class="ident" id="2249800"><a href="/gostd/math/gamma.go.html#2248624">Euler</a></span><span class="op" id="2249805">*</span><span class="ident" id="2249806"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249807">)</span>&nbsp;<span class="op" id="2249809">*</span>&nbsp;<span class="ident" id="2249811"><a href="/gostd/math/gamma.go.html#2248596">x</a></span><span class="op" id="2249812">)</span><br>
<span class="lineno"></span><span class="op" id="2249814">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2249817">func</span>&nbsp;<span class="ident" id="2249822">isNegInt</span><span class="op" id="2249830">(</span><span class="ident" id="2249831">x</span>&nbsp;<span class="builtintype" id="2249833">float64</span><span class="op" id="2249840">)</span>&nbsp;<span class="builtintype" id="2249842">bool</span>&nbsp;<span class="op" id="2249847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249850">if</span>&nbsp;<span class="ident" id="2249853"><a href="/gostd/math/gamma.go.html#2249831">x</a></span>&nbsp;<span class="op" id="2249855">&lt;</span>&nbsp;<span class="num" id="2249857">0</span>&nbsp;<span class="op" id="2249859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2249863">_</span><span class="op" id="2249864">,</span>&nbsp;<span class="ident" id="2249866">xf</span>&nbsp;<span class="op" id="2249869">:=</span>&nbsp;<span class="ident" id="2249872"><a href="/gostd/math/modf.go.html#2311110">Modf</a></span><span class="op" id="2249876">(</span><span class="ident" id="2249877"><a href="/gostd/math/gamma.go.html#2249831">x</a></span><span class="op" id="2249878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249882">return</span>&nbsp;<span class="ident" id="2249889"><a href="/gostd/math/gamma.go.html#2249866">xf</a></span>&nbsp;<span class="op" id="2249892">==</span>&nbsp;<span class="num" id="2249895">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2249898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2249901">return</span>&nbsp;<span class="builtintype" id="2249908">false</span><br>
<span class="lineno"></span><span class="op" id="2249914">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
