<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5564588">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5564643">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5564697">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5564748">package</span>&nbsp;<span class="ident" id="5564756">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5564763">import</span>&nbsp;<span class="string" id="5564770">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5564778">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5564838">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5564908">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5564966">//</span><br>
<span class="lineno"></span><span class="comment" id="5564969">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5565017">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5565081">//</span><br>
<span class="lineno"></span><span class="comment" id="5565084">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5565145">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5565215">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5565290">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5565357">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5565430">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5565502">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5565516">//</span><br>
<span class="lineno"></span><span class="comment" id="5565519">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5565585">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5565651">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5565664">//</span><br>
<span class="lineno"></span><span class="comment" id="5565667">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5565691">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5565721">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5565749">//</span><br>
<span class="lineno"></span><span class="comment" id="5565752">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5565768">//</span><br>
<span class="lineno">35</span><span class="comment" id="5565771">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5565777">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5565796">//</span><br>
<span class="lineno"></span><span class="comment" id="5565799">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5565807">//</span><br>
<span class="lineno">40</span><span class="comment" id="5565810">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5565844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5565879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5565912">//</span><br>
<span class="lineno"></span><span class="comment" id="5565915">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5565976">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5566032">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5566061">//</span><br>
<span class="lineno"></span><span class="comment" id="5566064">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5566091">//</span><br>
<span class="lineno">50</span><span class="comment" id="5566094">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5566107">//</span><br>
<span class="lineno"></span><span class="comment" id="5566110">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5566150">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5566208">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5566268">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5566328">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5566389">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5566422">func</span>&nbsp;<span class="ident" id="5566427">Tan</span><span class="op" id="5566430">(</span><span class="ident" id="5566431">x</span>&nbsp;<span class="builtintype" id="5566433">complex128</span><span class="op" id="5566443">)</span>&nbsp;<span class="builtintype" id="5566445">complex128</span>&nbsp;<span class="op" id="5566456">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5566459">d</span>&nbsp;<span class="op" id="5566461">:=</span>&nbsp;<span class="ident" id="5566464"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5566468">.</span><span class="ident" id="5566469">Cos</span><span class="op" id="5566472">(</span><span class="num" id="5566473">2</span><span class="op" id="5566474">*</span><span class="builtinfunc" id="5566475">real</span><span class="op" id="5566479">(</span><span class="ident" id="5566480"><a href="/math/cmplx/tan.go.html#5566431">x</a></span><span class="op" id="5566481">)</span><span class="op" id="5566482">)</span>&nbsp;<span class="op" id="5566484">+</span>&nbsp;<span class="ident" id="5566486"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5566490">.</span><span class="ident" id="5566491">Cosh</span><span class="op" id="5566495">(</span><span class="num" id="5566496">2</span><span class="op" id="5566497">*</span><span class="builtinfunc" id="5566498">imag</span><span class="op" id="5566502">(</span><span class="ident" id="5566503"><a href="/math/cmplx/tan.go.html#5566431">x</a></span><span class="op" id="5566504">)</span><span class="op" id="5566505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5566508">if</span>&nbsp;<span class="ident" id="5566511"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5566515">.</span><span class="ident" id="5566516">Abs</span><span class="op" id="5566519">(</span><span class="ident" id="5566520"><a href="/math/cmplx/tan.go.html#5566459">d</a></span><span class="op" id="5566521">)</span>&nbsp;<span class="op" id="5566523">&lt;</span>&nbsp;<span class="num" id="5566525">0.25</span>&nbsp;<span class="op" id="5566530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5566534"><a href="/math/cmplx/tan.go.html#5566459">d</a></span>&nbsp;<span class="op" id="5566536">=</span>&nbsp;<span class="ident" id="5566538"><a href="/math/cmplx/tan.go.html#5567697">tanSeries</a></span><span class="op" id="5566547">(</span><span class="ident" id="5566548"><a href="/math/cmplx/tan.go.html#5566431">x</a></span><span class="op" id="5566549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5566552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5566555">if</span>&nbsp;<span class="ident" id="5566558"><a href="/math/cmplx/tan.go.html#5566459">d</a></span>&nbsp;<span class="op" id="5566560">==</span>&nbsp;<span class="num" id="5566563">0</span>&nbsp;<span class="op" id="5566565">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5566569">return</span>&nbsp;<span class="ident" id="5566576"><a href="/math/cmplx/isinf.go.html#5552219">Inf</a></span><span class="op" id="5566579">(</span><span class="op" id="5566580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5566583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5566586">return</span>&nbsp;<span class="builtinfunc" id="5566593">complex</span><span class="op" id="5566600">(</span><span class="ident" id="5566601"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5566605">.</span><span class="ident" id="5566606">Sin</span><span class="op" id="5566609">(</span><span class="num" id="5566610">2</span><span class="op" id="5566611">*</span><span class="builtinfunc" id="5566612">real</span><span class="op" id="5566616">(</span><span class="ident" id="5566617"><a href="/math/cmplx/tan.go.html#5566431">x</a></span><span class="op" id="5566618">)</span><span class="op" id="5566619">)</span><span class="op" id="5566620">/</span><span class="ident" id="5566621"><a href="/math/cmplx/tan.go.html#5566459">d</a></span><span class="op" id="5566622">,</span>&nbsp;<span class="ident" id="5566624"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5566628">.</span><span class="ident" id="5566629">Sinh</span><span class="op" id="5566633">(</span><span class="num" id="5566634">2</span><span class="op" id="5566635">*</span><span class="builtinfunc" id="5566636">imag</span><span class="op" id="5566640">(</span><span class="ident" id="5566641"><a href="/math/cmplx/tan.go.html#5566431">x</a></span><span class="op" id="5566642">)</span><span class="op" id="5566643">)</span><span class="op" id="5566644">/</span><span class="ident" id="5566645"><a href="/math/cmplx/tan.go.html#5566459">d</a></span><span class="op" id="5566646">)</span><br>
<span class="lineno"></span><span class="op" id="5566648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5566651">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5566681">//</span><br>
<span class="lineno"></span><span class="comment" id="5566684">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5566700">//</span><br>
<span class="lineno"></span><span class="comment" id="5566703">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5566761">//</span><br>
<span class="lineno"></span><span class="comment" id="5566764">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5566777">//</span><br>
<span class="lineno"></span><span class="comment" id="5566780">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5566820">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5566878">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5566939">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5566984">func</span>&nbsp;<span class="ident" id="5566989">Tanh</span><span class="op" id="5566993">(</span><span class="ident" id="5566994">x</span>&nbsp;<span class="builtintype" id="5566996">complex128</span><span class="op" id="5567006">)</span>&nbsp;<span class="builtintype" id="5567008">complex128</span>&nbsp;<span class="op" id="5567019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567022">d</span>&nbsp;<span class="op" id="5567024">:=</span>&nbsp;<span class="ident" id="5567027"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567031">.</span><span class="ident" id="5567032">Cosh</span><span class="op" id="5567036">(</span><span class="num" id="5567037">2</span><span class="op" id="5567038">*</span><span class="builtinfunc" id="5567039">real</span><span class="op" id="5567043">(</span><span class="ident" id="5567044"><a href="/math/cmplx/tan.go.html#5566994">x</a></span><span class="op" id="5567045">)</span><span class="op" id="5567046">)</span>&nbsp;<span class="op" id="5567048">+</span>&nbsp;<span class="ident" id="5567050"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567054">.</span><span class="ident" id="5567055">Cos</span><span class="op" id="5567058">(</span><span class="num" id="5567059">2</span><span class="op" id="5567060">*</span><span class="builtinfunc" id="5567061">imag</span><span class="op" id="5567065">(</span><span class="ident" id="5567066"><a href="/math/cmplx/tan.go.html#5566994">x</a></span><span class="op" id="5567067">)</span><span class="op" id="5567068">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567071">if</span>&nbsp;<span class="ident" id="5567074"><a href="/math/cmplx/tan.go.html#5567022">d</a></span>&nbsp;<span class="op" id="5567076">==</span>&nbsp;<span class="num" id="5567079">0</span>&nbsp;<span class="op" id="5567081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567085">return</span>&nbsp;<span class="ident" id="5567092"><a href="/math/cmplx/isinf.go.html#5552219">Inf</a></span><span class="op" id="5567095">(</span><span class="op" id="5567096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5567099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567102">return</span>&nbsp;<span class="builtinfunc" id="5567109">complex</span><span class="op" id="5567116">(</span><span class="ident" id="5567117"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567121">.</span><span class="ident" id="5567122">Sinh</span><span class="op" id="5567126">(</span><span class="num" id="5567127">2</span><span class="op" id="5567128">*</span><span class="builtinfunc" id="5567129">real</span><span class="op" id="5567133">(</span><span class="ident" id="5567134"><a href="/math/cmplx/tan.go.html#5566994">x</a></span><span class="op" id="5567135">)</span><span class="op" id="5567136">)</span><span class="op" id="5567137">/</span><span class="ident" id="5567138"><a href="/math/cmplx/tan.go.html#5567022">d</a></span><span class="op" id="5567139">,</span>&nbsp;<span class="ident" id="5567141"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567145">.</span><span class="ident" id="5567146">Sin</span><span class="op" id="5567149">(</span><span class="num" id="5567150">2</span><span class="op" id="5567151">*</span><span class="builtinfunc" id="5567152">imag</span><span class="op" id="5567156">(</span><span class="ident" id="5567157"><a href="/math/cmplx/tan.go.html#5566994">x</a></span><span class="op" id="5567158">)</span><span class="op" id="5567159">)</span><span class="op" id="5567160">/</span><span class="ident" id="5567161"><a href="/math/cmplx/tan.go.html#5567022">d</a></span><span class="op" id="5567162">)</span><br>
<span class="lineno"></span><span class="op" id="5567164">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5567167">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5567221">func</span>&nbsp;<span class="ident" id="5567226">reducePi</span><span class="op" id="5567234">(</span><span class="ident" id="5567235">x</span>&nbsp;<span class="builtintype" id="5567237">float64</span><span class="op" id="5567244">)</span>&nbsp;<span class="builtintype" id="5567246">float64</span>&nbsp;<span class="op" id="5567254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567257">const</span>&nbsp;<span class="op" id="5567263">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5567267">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567304">DP1</span>&nbsp;<span class="op" id="5567308">=</span>&nbsp;<span class="num" id="5567310">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5567337">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567364">DP2</span>&nbsp;<span class="op" id="5567368">=</span>&nbsp;<span class="num" id="5567370">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5567397">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567424">DP3</span>&nbsp;<span class="op" id="5567428">=</span>&nbsp;<span class="num" id="5567430">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5567457">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5567483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567486">t</span>&nbsp;<span class="op" id="5567488">:=</span>&nbsp;<span class="ident" id="5567491"><a href="/math/cmplx/tan.go.html#5567235">x</a></span>&nbsp;<span class="op" id="5567493">/</span>&nbsp;<span class="ident" id="5567495"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567499">.</span><span class="ident" id="5567500">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567504">if</span>&nbsp;<span class="ident" id="5567507"><a href="/math/cmplx/tan.go.html#5567486">t</a></span>&nbsp;<span class="op" id="5567509">&gt;=</span>&nbsp;<span class="num" id="5567512">0</span>&nbsp;<span class="op" id="5567514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567518"><a href="/math/cmplx/tan.go.html#5567486">t</a></span>&nbsp;<span class="op" id="5567520">+=</span>&nbsp;<span class="num" id="5567523">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5567528">}</span>&nbsp;<span class="keyword" id="5567530">else</span>&nbsp;<span class="op" id="5567535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567539"><a href="/math/cmplx/tan.go.html#5567486">t</a></span>&nbsp;<span class="op" id="5567541">-=</span>&nbsp;<span class="num" id="5567544">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5567549">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567552"><a href="/math/cmplx/tan.go.html#5567486">t</a></span>&nbsp;<span class="op" id="5567554">=</span>&nbsp;<span class="builtintype" id="5567556">float64</span><span class="op" id="5567563">(</span><span class="ident" id="5567564">int64</span><span class="op" id="5567569">(</span><span class="ident" id="5567570"><a href="/math/cmplx/tan.go.html#5567486">t</a></span><span class="op" id="5567571">)</span><span class="op" id="5567572">)</span>&nbsp;<span class="comment" id="5567574">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567602">return</span>&nbsp;<span class="op" id="5567609">(</span><span class="op" id="5567610">(</span><span class="ident" id="5567611"><a href="/math/cmplx/tan.go.html#5567235">x</a></span>&nbsp;<span class="op" id="5567613">-</span>&nbsp;<span class="ident" id="5567615"><a href="/math/cmplx/tan.go.html#5567486">t</a></span><span class="op" id="5567616">*</span><span class="ident" id="5567617"><a href="/math/cmplx/tan.go.html#5567304">DP1</a></span><span class="op" id="5567620">)</span>&nbsp;<span class="op" id="5567622">-</span>&nbsp;<span class="ident" id="5567624"><a href="/math/cmplx/tan.go.html#5567486">t</a></span><span class="op" id="5567625">*</span><span class="ident" id="5567626"><a href="/math/cmplx/tan.go.html#5567364">DP2</a></span><span class="op" id="5567629">)</span>&nbsp;<span class="op" id="5567631">-</span>&nbsp;<span class="ident" id="5567633"><a href="/math/cmplx/tan.go.html#5567486">t</a></span><span class="op" id="5567634">*</span><span class="ident" id="5567635"><a href="/math/cmplx/tan.go.html#5567424">DP3</a></span><br>
<span class="lineno"></span><span class="op" id="5567639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5567642">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5567692">func</span>&nbsp;<span class="ident" id="5567697">tanSeries</span><span class="op" id="5567706">(</span><span class="ident" id="5567707">z</span>&nbsp;<span class="builtintype" id="5567709">complex128</span><span class="op" id="5567719">)</span>&nbsp;<span class="builtintype" id="5567721">float64</span>&nbsp;<span class="op" id="5567729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567732">const</span>&nbsp;<span class="ident" id="5567738">MACHEP</span>&nbsp;<span class="op" id="5567745">=</span>&nbsp;<span class="num" id="5567747">1.0</span>&nbsp;<span class="op" id="5567751">/</span>&nbsp;<span class="op" id="5567753">(</span><span class="num" id="5567754">1</span>&nbsp;<span class="op" id="5567756">&lt;&lt;</span>&nbsp;<span class="num" id="5567759">53</span><span class="op" id="5567761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567764">x</span>&nbsp;<span class="op" id="5567766">:=</span>&nbsp;<span class="ident" id="5567769"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567773">.</span><span class="ident" id="5567774">Abs</span><span class="op" id="5567777">(</span><span class="num" id="5567778">2</span>&nbsp;<span class="op" id="5567780">*</span>&nbsp;<span class="builtinfunc" id="5567782">real</span><span class="op" id="5567786">(</span><span class="ident" id="5567787"><a href="/math/cmplx/tan.go.html#5567707">z</a></span><span class="op" id="5567788">)</span><span class="op" id="5567789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567792">y</span>&nbsp;<span class="op" id="5567794">:=</span>&nbsp;<span class="ident" id="5567797"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5567801">.</span><span class="ident" id="5567802">Abs</span><span class="op" id="5567805">(</span><span class="num" id="5567806">2</span>&nbsp;<span class="op" id="5567808">*</span>&nbsp;<span class="builtinfunc" id="5567810">imag</span><span class="op" id="5567814">(</span><span class="ident" id="5567815"><a href="/math/cmplx/tan.go.html#5567707">z</a></span><span class="op" id="5567816">)</span><span class="op" id="5567817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567820"><a href="/math/cmplx/tan.go.html#5567764">x</a></span>&nbsp;<span class="op" id="5567822">=</span>&nbsp;<span class="ident" id="5567824"><a href="/math/cmplx/tan.go.html#5567226">reducePi</a></span><span class="op" id="5567832">(</span><span class="ident" id="5567833"><a href="/math/cmplx/tan.go.html#5567764">x</a></span><span class="op" id="5567834">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567837"><a href="/math/cmplx/tan.go.html#5567764">x</a></span>&nbsp;<span class="op" id="5567839">=</span>&nbsp;<span class="ident" id="5567841"><a href="/math/cmplx/tan.go.html#5567764">x</a></span>&nbsp;<span class="op" id="5567843">*</span>&nbsp;<span class="ident" id="5567845"><a href="/math/cmplx/tan.go.html#5567764">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567848"><a href="/math/cmplx/tan.go.html#5567792">y</a></span>&nbsp;<span class="op" id="5567850">=</span>&nbsp;<span class="ident" id="5567852"><a href="/math/cmplx/tan.go.html#5567792">y</a></span>&nbsp;<span class="op" id="5567854">*</span>&nbsp;<span class="ident" id="5567856"><a href="/math/cmplx/tan.go.html#5567792">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567859">x2</span>&nbsp;<span class="op" id="5567862">:=</span>&nbsp;<span class="num" id="5567865">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567870">y2</span>&nbsp;<span class="op" id="5567873">:=</span>&nbsp;<span class="num" id="5567876">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567881">f</span>&nbsp;<span class="op" id="5567883">:=</span>&nbsp;<span class="num" id="5567886">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567891">rn</span>&nbsp;<span class="op" id="5567894">:=</span>&nbsp;<span class="num" id="5567897">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567902">d</span>&nbsp;<span class="op" id="5567904">:=</span>&nbsp;<span class="num" id="5567907">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5567912">for</span>&nbsp;<span class="op" id="5567916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567920"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span>&nbsp;<span class="op" id="5567923">+=</span>&nbsp;<span class="num" id="5567926">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567930"><a href="/math/cmplx/tan.go.html#5567881">f</a></span>&nbsp;<span class="op" id="5567932">*=</span>&nbsp;<span class="ident" id="5567935"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567940"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span>&nbsp;<span class="op" id="5567943">+=</span>&nbsp;<span class="num" id="5567946">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567950"><a href="/math/cmplx/tan.go.html#5567881">f</a></span>&nbsp;<span class="op" id="5567952">*=</span>&nbsp;<span class="ident" id="5567955"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567960"><a href="/math/cmplx/tan.go.html#5567859">x2</a></span>&nbsp;<span class="op" id="5567963">*=</span>&nbsp;<span class="ident" id="5567966"><a href="/math/cmplx/tan.go.html#5567764">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567970"><a href="/math/cmplx/tan.go.html#5567870">y2</a></span>&nbsp;<span class="op" id="5567973">*=</span>&nbsp;<span class="ident" id="5567976"><a href="/math/cmplx/tan.go.html#5567792">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567980">t</span>&nbsp;<span class="op" id="5567982">:=</span>&nbsp;<span class="ident" id="5567985"><a href="/math/cmplx/tan.go.html#5567870">y2</a></span>&nbsp;<span class="op" id="5567988">+</span>&nbsp;<span class="ident" id="5567990"><a href="/math/cmplx/tan.go.html#5567859">x2</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5567995"><a href="/math/cmplx/tan.go.html#5567980">t</a></span>&nbsp;<span class="op" id="5567997">/=</span>&nbsp;<span class="ident" id="5568000"><a href="/math/cmplx/tan.go.html#5567881">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568004"><a href="/math/cmplx/tan.go.html#5567902">d</a></span>&nbsp;<span class="op" id="5568006">+=</span>&nbsp;<span class="ident" id="5568009"><a href="/math/cmplx/tan.go.html#5567980">t</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568014"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span>&nbsp;<span class="op" id="5568017">+=</span>&nbsp;<span class="num" id="5568020">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568024"><a href="/math/cmplx/tan.go.html#5567881">f</a></span>&nbsp;<span class="op" id="5568026">*=</span>&nbsp;<span class="ident" id="5568029"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568034"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span>&nbsp;<span class="op" id="5568037">+=</span>&nbsp;<span class="num" id="5568040">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568044"><a href="/math/cmplx/tan.go.html#5567881">f</a></span>&nbsp;<span class="op" id="5568046">*=</span>&nbsp;<span class="ident" id="5568049"><a href="/math/cmplx/tan.go.html#5567891">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568054"><a href="/math/cmplx/tan.go.html#5567859">x2</a></span>&nbsp;<span class="op" id="5568057">*=</span>&nbsp;<span class="ident" id="5568060"><a href="/math/cmplx/tan.go.html#5567764">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568064"><a href="/math/cmplx/tan.go.html#5567870">y2</a></span>&nbsp;<span class="op" id="5568067">*=</span>&nbsp;<span class="ident" id="5568070"><a href="/math/cmplx/tan.go.html#5567792">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568074"><a href="/math/cmplx/tan.go.html#5567980">t</a></span>&nbsp;<span class="op" id="5568076">=</span>&nbsp;<span class="ident" id="5568078"><a href="/math/cmplx/tan.go.html#5567870">y2</a></span>&nbsp;<span class="op" id="5568081">-</span>&nbsp;<span class="ident" id="5568083"><a href="/math/cmplx/tan.go.html#5567859">x2</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568088"><a href="/math/cmplx/tan.go.html#5567980">t</a></span>&nbsp;<span class="op" id="5568090">/=</span>&nbsp;<span class="ident" id="5568093"><a href="/math/cmplx/tan.go.html#5567881">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568097"><a href="/math/cmplx/tan.go.html#5567902">d</a></span>&nbsp;<span class="op" id="5568099">+=</span>&nbsp;<span class="ident" id="5568102"><a href="/math/cmplx/tan.go.html#5567980">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568106">if</span>&nbsp;<span class="ident" id="5568109"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5568113">.</span><span class="ident" id="5568114">Abs</span><span class="op" id="5568117">(</span><span class="ident" id="5568118"><a href="/math/cmplx/tan.go.html#5567980">t</a></span><span class="op" id="5568119">/</span><span class="ident" id="5568120"><a href="/math/cmplx/tan.go.html#5567902">d</a></span><span class="op" id="5568121">)</span>&nbsp;<span class="op" id="5568123">&lt;=</span>&nbsp;<span class="ident" id="5568126"><a href="/math/cmplx/tan.go.html#5567738">MACHEP</a></span>&nbsp;<span class="op" id="5568133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568138">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5568146">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5568149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568152">return</span>&nbsp;<span class="ident" id="5568159"><a href="/math/cmplx/tan.go.html#5567902">d</a></span><br>
<span class="lineno"></span><span class="op" id="5568161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5568164">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5568194">//</span><br>
<span class="lineno"></span><span class="comment" id="5568197">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5568213">//</span><br>
<span class="lineno"></span><span class="comment" id="5568216">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5568222">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5568241">//</span><br>
<span class="lineno"></span><span class="comment" id="5568244">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5568252">//</span><br>
<span class="lineno"></span><span class="comment" id="5568255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5568289">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5568324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5568357">//</span><br>
<span class="lineno"></span><span class="comment" id="5568360">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5568415">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5568472">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5568495">//</span><br>
<span class="lineno"></span><span class="comment" id="5568498">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5568511">//</span><br>
<span class="lineno"></span><span class="comment" id="5568514">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5568554">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5568612">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5568672">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5568732">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5568773">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5568808">func</span>&nbsp;<span class="ident" id="5568813">Cot</span><span class="op" id="5568816">(</span><span class="ident" id="5568817">x</span>&nbsp;<span class="builtintype" id="5568819">complex128</span><span class="op" id="5568829">)</span>&nbsp;<span class="builtintype" id="5568831">complex128</span>&nbsp;<span class="op" id="5568842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568845">d</span>&nbsp;<span class="op" id="5568847">:=</span>&nbsp;<span class="ident" id="5568850"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5568854">.</span><span class="ident" id="5568855">Cosh</span><span class="op" id="5568859">(</span><span class="num" id="5568860">2</span><span class="op" id="5568861">*</span><span class="builtinfunc" id="5568862">imag</span><span class="op" id="5568866">(</span><span class="ident" id="5568867"><a href="/math/cmplx/tan.go.html#5568817">x</a></span><span class="op" id="5568868">)</span><span class="op" id="5568869">)</span>&nbsp;<span class="op" id="5568871">-</span>&nbsp;<span class="ident" id="5568873"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5568877">.</span><span class="ident" id="5568878">Cos</span><span class="op" id="5568881">(</span><span class="num" id="5568882">2</span><span class="op" id="5568883">*</span><span class="builtinfunc" id="5568884">real</span><span class="op" id="5568888">(</span><span class="ident" id="5568889"><a href="/math/cmplx/tan.go.html#5568817">x</a></span><span class="op" id="5568890">)</span><span class="op" id="5568891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568894">if</span>&nbsp;<span class="ident" id="5568897"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5568901">.</span><span class="ident" id="5568902">Abs</span><span class="op" id="5568905">(</span><span class="ident" id="5568906"><a href="/math/cmplx/tan.go.html#5568845">d</a></span><span class="op" id="5568907">)</span>&nbsp;<span class="op" id="5568909">&lt;</span>&nbsp;<span class="num" id="5568911">0.25</span>&nbsp;<span class="op" id="5568916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5568920"><a href="/math/cmplx/tan.go.html#5568845">d</a></span>&nbsp;<span class="op" id="5568922">=</span>&nbsp;<span class="ident" id="5568924"><a href="/math/cmplx/tan.go.html#5567697">tanSeries</a></span><span class="op" id="5568933">(</span><span class="ident" id="5568934"><a href="/math/cmplx/tan.go.html#5568817">x</a></span><span class="op" id="5568935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5568938">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568941">if</span>&nbsp;<span class="ident" id="5568944"><a href="/math/cmplx/tan.go.html#5568845">d</a></span>&nbsp;<span class="op" id="5568946">==</span>&nbsp;<span class="num" id="5568949">0</span>&nbsp;<span class="op" id="5568951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568955">return</span>&nbsp;<span class="ident" id="5568962"><a href="/math/cmplx/isinf.go.html#5552219">Inf</a></span><span class="op" id="5568965">(</span><span class="op" id="5568966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5568969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5568972">return</span>&nbsp;<span class="builtinfunc" id="5568979">complex</span><span class="op" id="5568986">(</span><span class="ident" id="5568987"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5568991">.</span><span class="ident" id="5568992">Sin</span><span class="op" id="5568995">(</span><span class="num" id="5568996">2</span><span class="op" id="5568997">*</span><span class="builtinfunc" id="5568998">real</span><span class="op" id="5569002">(</span><span class="ident" id="5569003"><a href="/math/cmplx/tan.go.html#5568817">x</a></span><span class="op" id="5569004">)</span><span class="op" id="5569005">)</span><span class="op" id="5569006">/</span><span class="ident" id="5569007"><a href="/math/cmplx/tan.go.html#5568845">d</a></span><span class="op" id="5569008">,</span>&nbsp;<span class="op" id="5569010">-</span><span class="ident" id="5569011"><a href="/math/cmplx/tan.go.html#5564770">math</a></span><span class="op" id="5569015">.</span><span class="ident" id="5569016">Sinh</span><span class="op" id="5569020">(</span><span class="num" id="5569021">2</span><span class="op" id="5569022">*</span><span class="builtinfunc" id="5569023">imag</span><span class="op" id="5569027">(</span><span class="ident" id="5569028"><a href="/math/cmplx/tan.go.html#5568817">x</a></span><span class="op" id="5569029">)</span><span class="op" id="5569030">)</span><span class="op" id="5569031">/</span><span class="ident" id="5569032"><a href="/math/cmplx/tan.go.html#5568845">d</a></span><span class="op" id="5569033">)</span><br>
<span class="lineno"></span><span class="op" id="5569035">}</span>
</div>
</body>
</html>
