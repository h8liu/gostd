<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3629523">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3629578">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3629632">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3629683">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629748">package</span>&nbsp;<span class="ident" id="3629756">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629761">import</span>&nbsp;<span class="op" id="3629768">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3629771">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3629777">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3629787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629790">func</span>&nbsp;<span class="ident" id="3629795">newFileFD</span><span class="op" id="3629804">(</span><span class="ident" id="3629805">f</span>&nbsp;<span class="op" id="3629807">*</span><span class="ident" id="3629808">os</span><span class="op" id="3629810">.</span><span class="ident" id="3629811">File</span><span class="op" id="3629815">)</span>&nbsp;<span class="op" id="3629817">(</span><span class="op" id="3629818">*</span><span class="ident" id="3629819">netFD</span><span class="op" id="3629824">,</span>&nbsp;<span class="builtintype" id="3629826">error</span><span class="op" id="3629831">)</span>&nbsp;<span class="op" id="3629833">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629836">fd</span><span class="op" id="3629838">,</span>&nbsp;<span class="ident" id="3629840">err</span>&nbsp;<span class="op" id="3629844">:=</span>&nbsp;<span class="ident" id="3629847">dupCloseOnExec</span><span class="op" id="3629861">(</span><span class="builtintype" id="3629862">int</span><span class="op" id="3629865">(</span><span class="ident" id="3629866">f</span><span class="op" id="3629867">.</span><span class="ident" id="3629868">Fd</span><span class="op" id="3629870">(</span><span class="op" id="3629871">)</span><span class="op" id="3629872">)</span><span class="op" id="3629873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629876">if</span>&nbsp;<span class="ident" id="3629879">err</span>&nbsp;<span class="op" id="3629883">!=</span>&nbsp;<span class="ident" id="3629886">nil</span>&nbsp;<span class="op" id="3629890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629894">return</span>&nbsp;<span class="ident" id="3629901">nil</span><span class="op" id="3629904">,</span>&nbsp;<span class="ident" id="3629906">os</span><span class="op" id="3629908">.</span><span class="ident" id="3629909">NewSyscallError</span><span class="op" id="3629924">(</span><span class="string" id="3629925">&#34;dup&#34;</span><span class="op" id="3629930">,</span>&nbsp;<span class="ident" id="3629932">err</span><span class="op" id="3629935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3629938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629942">if</span>&nbsp;<span class="ident" id="3629945">err</span>&nbsp;<span class="op" id="3629949">=</span>&nbsp;<span class="ident" id="3629951">syscall</span><span class="op" id="3629958">.</span><span class="ident" id="3629959">SetNonblock</span><span class="op" id="3629970">(</span><span class="ident" id="3629971">fd</span><span class="op" id="3629973">,</span>&nbsp;<span class="builtintype" id="3629975">true</span><span class="op" id="3629979">)</span><span class="op" id="3629980">;</span>&nbsp;<span class="ident" id="3629982">err</span>&nbsp;<span class="op" id="3629986">!=</span>&nbsp;<span class="ident" id="3629989">nil</span>&nbsp;<span class="op" id="3629993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629997">closesocket</span><span class="op" id="3630008">(</span><span class="ident" id="3630009">fd</span><span class="op" id="3630011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630015">return</span>&nbsp;<span class="ident" id="3630022">nil</span><span class="op" id="3630025">,</span>&nbsp;<span class="ident" id="3630027">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630036">sotype</span><span class="op" id="3630042">,</span>&nbsp;<span class="ident" id="3630044">err</span>&nbsp;<span class="op" id="3630048">:=</span>&nbsp;<span class="ident" id="3630051">syscall</span><span class="op" id="3630058">.</span><span class="ident" id="3630059">GetsockoptInt</span><span class="op" id="3630072">(</span><span class="ident" id="3630073">fd</span><span class="op" id="3630075">,</span>&nbsp;<span class="ident" id="3630077">syscall</span><span class="op" id="3630084">.</span><span class="ident" id="3630085">SOL_SOCKET</span><span class="op" id="3630095">,</span>&nbsp;<span class="ident" id="3630097">syscall</span><span class="op" id="3630104">.</span><span class="ident" id="3630105">SO_TYPE</span><span class="op" id="3630112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630115">if</span>&nbsp;<span class="ident" id="3630118">err</span>&nbsp;<span class="op" id="3630122">!=</span>&nbsp;<span class="ident" id="3630125">nil</span>&nbsp;<span class="op" id="3630129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630133">closesocket</span><span class="op" id="3630144">(</span><span class="ident" id="3630145">fd</span><span class="op" id="3630147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630151">return</span>&nbsp;<span class="ident" id="3630158">nil</span><span class="op" id="3630161">,</span>&nbsp;<span class="ident" id="3630163">os</span><span class="op" id="3630165">.</span><span class="ident" id="3630166">NewSyscallError</span><span class="op" id="3630181">(</span><span class="string" id="3630182">&#34;getsockopt&#34;</span><span class="op" id="3630194">,</span>&nbsp;<span class="ident" id="3630196">err</span><span class="op" id="3630199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630202">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630206">family</span>&nbsp;<span class="op" id="3630213">:=</span>&nbsp;<span class="ident" id="3630216">syscall</span><span class="op" id="3630223">.</span><span class="ident" id="3630224">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630235">toAddr</span>&nbsp;<span class="op" id="3630242">:=</span>&nbsp;<span class="ident" id="3630245">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630260">lsa</span><span class="op" id="3630263">,</span>&nbsp;<span class="ident" id="3630265">_</span>&nbsp;<span class="op" id="3630267">:=</span>&nbsp;<span class="ident" id="3630270">syscall</span><span class="op" id="3630277">.</span><span class="ident" id="3630278">Getsockname</span><span class="op" id="3630289">(</span><span class="ident" id="3630290">fd</span><span class="op" id="3630292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630295">switch</span>&nbsp;<span class="ident" id="3630302">lsa</span><span class="op" id="3630305">.</span><span class="op" id="3630306">(</span><span class="keyword" id="3630307">type</span><span class="op" id="3630311">)</span>&nbsp;<span class="op" id="3630313">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630316">default</span><span class="op" id="3630323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630327">closesocket</span><span class="op" id="3630338">(</span><span class="ident" id="3630339">fd</span><span class="op" id="3630341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630345">return</span>&nbsp;<span class="ident" id="3630352">nil</span><span class="op" id="3630355">,</span>&nbsp;<span class="ident" id="3630357">syscall</span><span class="op" id="3630364">.</span><span class="ident" id="3630365">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630373">case</span>&nbsp;<span class="op" id="3630378">*</span><span class="ident" id="3630379">syscall</span><span class="op" id="3630386">.</span><span class="ident" id="3630387">SockaddrInet4</span><span class="op" id="3630400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630404">family</span>&nbsp;<span class="op" id="3630411">=</span>&nbsp;<span class="ident" id="3630413">syscall</span><span class="op" id="3630420">.</span><span class="ident" id="3630421">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630431">if</span>&nbsp;<span class="ident" id="3630434">sotype</span>&nbsp;<span class="op" id="3630441">==</span>&nbsp;<span class="ident" id="3630444">syscall</span><span class="op" id="3630451">.</span><span class="ident" id="3630452">SOCK_DGRAM</span>&nbsp;<span class="op" id="3630463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630468">toAddr</span>&nbsp;<span class="op" id="3630475">=</span>&nbsp;<span class="ident" id="3630477">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630493">}</span>&nbsp;<span class="keyword" id="3630495">else</span>&nbsp;<span class="keyword" id="3630500">if</span>&nbsp;<span class="ident" id="3630503">sotype</span>&nbsp;<span class="op" id="3630510">==</span>&nbsp;<span class="ident" id="3630513">syscall</span><span class="op" id="3630520">.</span><span class="ident" id="3630521">SOCK_RAW</span>&nbsp;<span class="op" id="3630530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630535">toAddr</span>&nbsp;<span class="op" id="3630542">=</span>&nbsp;<span class="ident" id="3630544">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630559">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630562">case</span>&nbsp;<span class="op" id="3630567">*</span><span class="ident" id="3630568">syscall</span><span class="op" id="3630575">.</span><span class="ident" id="3630576">SockaddrInet6</span><span class="op" id="3630589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630593">family</span>&nbsp;<span class="op" id="3630600">=</span>&nbsp;<span class="ident" id="3630602">syscall</span><span class="op" id="3630609">.</span><span class="ident" id="3630610">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630621">if</span>&nbsp;<span class="ident" id="3630624">sotype</span>&nbsp;<span class="op" id="3630631">==</span>&nbsp;<span class="ident" id="3630634">syscall</span><span class="op" id="3630641">.</span><span class="ident" id="3630642">SOCK_DGRAM</span>&nbsp;<span class="op" id="3630653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630658">toAddr</span>&nbsp;<span class="op" id="3630665">=</span>&nbsp;<span class="ident" id="3630667">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630683">}</span>&nbsp;<span class="keyword" id="3630685">else</span>&nbsp;<span class="keyword" id="3630690">if</span>&nbsp;<span class="ident" id="3630693">sotype</span>&nbsp;<span class="op" id="3630700">==</span>&nbsp;<span class="ident" id="3630703">syscall</span><span class="op" id="3630710">.</span><span class="ident" id="3630711">SOCK_RAW</span>&nbsp;<span class="op" id="3630720">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630725">toAddr</span>&nbsp;<span class="op" id="3630732">=</span>&nbsp;<span class="ident" id="3630734">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630752">case</span>&nbsp;<span class="op" id="3630757">*</span><span class="ident" id="3630758">syscall</span><span class="op" id="3630765">.</span><span class="ident" id="3630766">SockaddrUnix</span><span class="op" id="3630778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630782">family</span>&nbsp;<span class="op" id="3630789">=</span>&nbsp;<span class="ident" id="3630791">syscall</span><span class="op" id="3630798">.</span><span class="ident" id="3630799">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630809">toAddr</span>&nbsp;<span class="op" id="3630816">=</span>&nbsp;<span class="ident" id="3630818">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630835">if</span>&nbsp;<span class="ident" id="3630838">sotype</span>&nbsp;<span class="op" id="3630845">==</span>&nbsp;<span class="ident" id="3630848">syscall</span><span class="op" id="3630855">.</span><span class="ident" id="3630856">SOCK_DGRAM</span>&nbsp;<span class="op" id="3630867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630872">toAddr</span>&nbsp;<span class="op" id="3630879">=</span>&nbsp;<span class="ident" id="3630881">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630902">}</span>&nbsp;<span class="keyword" id="3630904">else</span>&nbsp;<span class="keyword" id="3630909">if</span>&nbsp;<span class="ident" id="3630912">sotype</span>&nbsp;<span class="op" id="3630919">==</span>&nbsp;<span class="ident" id="3630922">syscall</span><span class="op" id="3630929">.</span><span class="ident" id="3630930">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3630945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630950">toAddr</span>&nbsp;<span class="op" id="3630957">=</span>&nbsp;<span class="ident" id="3630959">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630982">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630988">laddr</span>&nbsp;<span class="op" id="3630994">:=</span>&nbsp;<span class="ident" id="3630997">toAddr</span><span class="op" id="3631003">(</span><span class="ident" id="3631004">lsa</span><span class="op" id="3631007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631010">rsa</span><span class="op" id="3631013">,</span>&nbsp;<span class="ident" id="3631015">_</span>&nbsp;<span class="op" id="3631017">:=</span>&nbsp;<span class="ident" id="3631020">syscall</span><span class="op" id="3631027">.</span><span class="ident" id="3631028">Getpeername</span><span class="op" id="3631039">(</span><span class="ident" id="3631040">fd</span><span class="op" id="3631042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631045">raddr</span>&nbsp;<span class="op" id="3631051">:=</span>&nbsp;<span class="ident" id="3631054">toAddr</span><span class="op" id="3631060">(</span><span class="ident" id="3631061">rsa</span><span class="op" id="3631064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631068">netfd</span><span class="op" id="3631073">,</span>&nbsp;<span class="ident" id="3631075">err</span>&nbsp;<span class="op" id="3631079">:=</span>&nbsp;<span class="ident" id="3631082">newFD</span><span class="op" id="3631087">(</span><span class="ident" id="3631088">fd</span><span class="op" id="3631090">,</span>&nbsp;<span class="ident" id="3631092">family</span><span class="op" id="3631098">,</span>&nbsp;<span class="ident" id="3631100">sotype</span><span class="op" id="3631106">,</span>&nbsp;<span class="ident" id="3631108">laddr</span><span class="op" id="3631113">.</span><span class="ident" id="3631114">Network</span><span class="op" id="3631121">(</span><span class="op" id="3631122">)</span><span class="op" id="3631123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631126">if</span>&nbsp;<span class="ident" id="3631129">err</span>&nbsp;<span class="op" id="3631133">!=</span>&nbsp;<span class="ident" id="3631136">nil</span>&nbsp;<span class="op" id="3631140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631144">closesocket</span><span class="op" id="3631155">(</span><span class="ident" id="3631156">fd</span><span class="op" id="3631158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631162">return</span>&nbsp;<span class="ident" id="3631169">nil</span><span class="op" id="3631172">,</span>&nbsp;<span class="ident" id="3631174">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631179">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631182">if</span>&nbsp;<span class="ident" id="3631185">err</span>&nbsp;<span class="op" id="3631189">:=</span>&nbsp;<span class="ident" id="3631192">netfd</span><span class="op" id="3631197">.</span><span class="ident" id="3631198">init</span><span class="op" id="3631202">(</span><span class="op" id="3631203">)</span><span class="op" id="3631204">;</span>&nbsp;<span class="ident" id="3631206">err</span>&nbsp;<span class="op" id="3631210">!=</span>&nbsp;<span class="ident" id="3631213">nil</span>&nbsp;<span class="op" id="3631217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631221">netfd</span><span class="op" id="3631226">.</span><span class="ident" id="3631227">Close</span><span class="op" id="3631232">(</span><span class="op" id="3631233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631237">return</span>&nbsp;<span class="ident" id="3631244">nil</span><span class="op" id="3631247">,</span>&nbsp;<span class="ident" id="3631249">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631257">netfd</span><span class="op" id="3631262">.</span><span class="ident" id="3631263">setAddr</span><span class="op" id="3631270">(</span><span class="ident" id="3631271">laddr</span><span class="op" id="3631276">,</span>&nbsp;<span class="ident" id="3631278">raddr</span><span class="op" id="3631283">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631286">return</span>&nbsp;<span class="ident" id="3631293">netfd</span><span class="op" id="3631298">,</span>&nbsp;<span class="ident" id="3631300">nil</span><br>
<span class="lineno"></span><span class="op" id="3631304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3631307">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3631377">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3631448">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3631514">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3631527">func</span>&nbsp;<span class="ident" id="3631532">FileConn</span><span class="op" id="3631540">(</span><span class="ident" id="3631541">f</span>&nbsp;<span class="op" id="3631543">*</span><span class="ident" id="3631544">os</span><span class="op" id="3631546">.</span><span class="ident" id="3631547">File</span><span class="op" id="3631551">)</span>&nbsp;<span class="op" id="3631553">(</span><span class="ident" id="3631554">c</span>&nbsp;<span class="ident" id="3631556">Conn</span><span class="op" id="3631560">,</span>&nbsp;<span class="ident" id="3631562">err</span>&nbsp;<span class="builtintype" id="3631566">error</span><span class="op" id="3631571">)</span>&nbsp;<span class="op" id="3631573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631576">fd</span><span class="op" id="3631578">,</span>&nbsp;<span class="ident" id="3631580">err</span>&nbsp;<span class="op" id="3631584">:=</span>&nbsp;<span class="ident" id="3631587">newFileFD</span><span class="op" id="3631596">(</span><span class="ident" id="3631597">f</span><span class="op" id="3631598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631601">if</span>&nbsp;<span class="ident" id="3631604">err</span>&nbsp;<span class="op" id="3631608">!=</span>&nbsp;<span class="ident" id="3631611">nil</span>&nbsp;<span class="op" id="3631615">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631619">return</span>&nbsp;<span class="ident" id="3631626">nil</span><span class="op" id="3631629">,</span>&nbsp;<span class="ident" id="3631631">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631639">switch</span>&nbsp;<span class="ident" id="3631646">fd</span><span class="op" id="3631648">.</span><span class="ident" id="3631649">laddr</span><span class="op" id="3631654">.</span><span class="op" id="3631655">(</span><span class="keyword" id="3631656">type</span><span class="op" id="3631660">)</span>&nbsp;<span class="op" id="3631662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631665">case</span>&nbsp;<span class="op" id="3631670">*</span><span class="ident" id="3631671">TCPAddr</span><span class="op" id="3631678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631682">return</span>&nbsp;<span class="ident" id="3631689">newTCPConn</span><span class="op" id="3631699">(</span><span class="ident" id="3631700">fd</span><span class="op" id="3631702">)</span><span class="op" id="3631703">,</span>&nbsp;<span class="ident" id="3631705">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631710">case</span>&nbsp;<span class="op" id="3631715">*</span><span class="ident" id="3631716">UDPAddr</span><span class="op" id="3631723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631727">return</span>&nbsp;<span class="ident" id="3631734">newUDPConn</span><span class="op" id="3631744">(</span><span class="ident" id="3631745">fd</span><span class="op" id="3631747">)</span><span class="op" id="3631748">,</span>&nbsp;<span class="ident" id="3631750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631755">case</span>&nbsp;<span class="op" id="3631760">*</span><span class="ident" id="3631761">IPAddr</span><span class="op" id="3631767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631771">return</span>&nbsp;<span class="ident" id="3631778">newIPConn</span><span class="op" id="3631787">(</span><span class="ident" id="3631788">fd</span><span class="op" id="3631790">)</span><span class="op" id="3631791">,</span>&nbsp;<span class="ident" id="3631793">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631798">case</span>&nbsp;<span class="op" id="3631803">*</span><span class="ident" id="3631804">UnixAddr</span><span class="op" id="3631812">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631816">return</span>&nbsp;<span class="ident" id="3631823">newUnixConn</span><span class="op" id="3631834">(</span><span class="ident" id="3631835">fd</span><span class="op" id="3631837">)</span><span class="op" id="3631838">,</span>&nbsp;<span class="ident" id="3631840">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631848">fd</span><span class="op" id="3631850">.</span><span class="ident" id="3631851">Close</span><span class="op" id="3631856">(</span><span class="op" id="3631857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631860">return</span>&nbsp;<span class="ident" id="3631867">nil</span><span class="op" id="3631870">,</span>&nbsp;<span class="ident" id="3631872">syscall</span><span class="op" id="3631879">.</span><span class="ident" id="3631880">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3631887">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3631890">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3631959">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3632028">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3632099">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3632112">func</span>&nbsp;<span class="ident" id="3632117">FileListener</span><span class="op" id="3632129">(</span><span class="ident" id="3632130">f</span>&nbsp;<span class="op" id="3632132">*</span><span class="ident" id="3632133">os</span><span class="op" id="3632135">.</span><span class="ident" id="3632136">File</span><span class="op" id="3632140">)</span>&nbsp;<span class="op" id="3632142">(</span><span class="ident" id="3632143">l</span>&nbsp;<span class="ident" id="3632145">Listener</span><span class="op" id="3632153">,</span>&nbsp;<span class="ident" id="3632155">err</span>&nbsp;<span class="builtintype" id="3632159">error</span><span class="op" id="3632164">)</span>&nbsp;<span class="op" id="3632166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632169">fd</span><span class="op" id="3632171">,</span>&nbsp;<span class="ident" id="3632173">err</span>&nbsp;<span class="op" id="3632177">:=</span>&nbsp;<span class="ident" id="3632180">newFileFD</span><span class="op" id="3632189">(</span><span class="ident" id="3632190">f</span><span class="op" id="3632191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632194">if</span>&nbsp;<span class="ident" id="3632197">err</span>&nbsp;<span class="op" id="3632201">!=</span>&nbsp;<span class="ident" id="3632204">nil</span>&nbsp;<span class="op" id="3632208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632212">return</span>&nbsp;<span class="ident" id="3632219">nil</span><span class="op" id="3632222">,</span>&nbsp;<span class="ident" id="3632224">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632229">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632232">switch</span>&nbsp;<span class="ident" id="3632239">laddr</span>&nbsp;<span class="op" id="3632245">:=</span>&nbsp;<span class="ident" id="3632248">fd</span><span class="op" id="3632250">.</span><span class="ident" id="3632251">laddr</span><span class="op" id="3632256">.</span><span class="op" id="3632257">(</span><span class="keyword" id="3632258">type</span><span class="op" id="3632262">)</span>&nbsp;<span class="op" id="3632264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632267">case</span>&nbsp;<span class="op" id="3632272">*</span><span class="ident" id="3632273">TCPAddr</span><span class="op" id="3632280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632284">return</span>&nbsp;<span class="op" id="3632291">&amp;</span><span class="ident" id="3632292">TCPListener</span><span class="op" id="3632303">{</span><span class="ident" id="3632304">fd</span><span class="op" id="3632306">}</span><span class="op" id="3632307">,</span>&nbsp;<span class="ident" id="3632309">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632314">case</span>&nbsp;<span class="op" id="3632319">*</span><span class="ident" id="3632320">UnixAddr</span><span class="op" id="3632328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632332">return</span>&nbsp;<span class="op" id="3632339">&amp;</span><span class="ident" id="3632340">UnixListener</span><span class="op" id="3632352">{</span><span class="ident" id="3632353">fd</span><span class="op" id="3632355">,</span>&nbsp;<span class="ident" id="3632357">laddr</span><span class="op" id="3632362">.</span><span class="ident" id="3632363">Name</span><span class="op" id="3632367">}</span><span class="op" id="3632368">,</span>&nbsp;<span class="ident" id="3632370">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632378">fd</span><span class="op" id="3632380">.</span><span class="ident" id="3632381">Close</span><span class="op" id="3632386">(</span><span class="op" id="3632387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632390">return</span>&nbsp;<span class="ident" id="3632397">nil</span><span class="op" id="3632400">,</span>&nbsp;<span class="ident" id="3632402">syscall</span><span class="op" id="3632409">.</span><span class="ident" id="3632410">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3632417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3632420">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3632486">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3632543">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3632614">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3632653">func</span>&nbsp;<span class="ident" id="3632658">FilePacketConn</span><span class="op" id="3632672">(</span><span class="ident" id="3632673">f</span>&nbsp;<span class="op" id="3632675">*</span><span class="ident" id="3632676">os</span><span class="op" id="3632678">.</span><span class="ident" id="3632679">File</span><span class="op" id="3632683">)</span>&nbsp;<span class="op" id="3632685">(</span><span class="ident" id="3632686">c</span>&nbsp;<span class="ident" id="3632688">PacketConn</span><span class="op" id="3632698">,</span>&nbsp;<span class="ident" id="3632700">err</span>&nbsp;<span class="builtintype" id="3632704">error</span><span class="op" id="3632709">)</span>&nbsp;<span class="op" id="3632711">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632714">fd</span><span class="op" id="3632716">,</span>&nbsp;<span class="ident" id="3632718">err</span>&nbsp;<span class="op" id="3632722">:=</span>&nbsp;<span class="ident" id="3632725">newFileFD</span><span class="op" id="3632734">(</span><span class="ident" id="3632735">f</span><span class="op" id="3632736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632739">if</span>&nbsp;<span class="ident" id="3632742">err</span>&nbsp;<span class="op" id="3632746">!=</span>&nbsp;<span class="ident" id="3632749">nil</span>&nbsp;<span class="op" id="3632753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632757">return</span>&nbsp;<span class="ident" id="3632764">nil</span><span class="op" id="3632767">,</span>&nbsp;<span class="ident" id="3632769">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632777">switch</span>&nbsp;<span class="ident" id="3632784">fd</span><span class="op" id="3632786">.</span><span class="ident" id="3632787">laddr</span><span class="op" id="3632792">.</span><span class="op" id="3632793">(</span><span class="keyword" id="3632794">type</span><span class="op" id="3632798">)</span>&nbsp;<span class="op" id="3632800">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632803">case</span>&nbsp;<span class="op" id="3632808">*</span><span class="ident" id="3632809">UDPAddr</span><span class="op" id="3632816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632820">return</span>&nbsp;<span class="ident" id="3632827">newUDPConn</span><span class="op" id="3632837">(</span><span class="ident" id="3632838">fd</span><span class="op" id="3632840">)</span><span class="op" id="3632841">,</span>&nbsp;<span class="ident" id="3632843">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632848">case</span>&nbsp;<span class="op" id="3632853">*</span><span class="ident" id="3632854">IPAddr</span><span class="op" id="3632860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632864">return</span>&nbsp;<span class="ident" id="3632871">newIPConn</span><span class="op" id="3632880">(</span><span class="ident" id="3632881">fd</span><span class="op" id="3632883">)</span><span class="op" id="3632884">,</span>&nbsp;<span class="ident" id="3632886">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632891">case</span>&nbsp;<span class="op" id="3632896">*</span><span class="ident" id="3632897">UnixAddr</span><span class="op" id="3632905">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632909">return</span>&nbsp;<span class="ident" id="3632916">newUnixConn</span><span class="op" id="3632927">(</span><span class="ident" id="3632928">fd</span><span class="op" id="3632930">)</span><span class="op" id="3632931">,</span>&nbsp;<span class="ident" id="3632933">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632941">fd</span><span class="op" id="3632943">.</span><span class="ident" id="3632944">Close</span><span class="op" id="3632949">(</span><span class="op" id="3632950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632953">return</span>&nbsp;<span class="ident" id="3632960">nil</span><span class="op" id="3632963">,</span>&nbsp;<span class="ident" id="3632965">syscall</span><span class="op" id="3632972">.</span><span class="ident" id="3632973">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3632980">}</span>
</div>
</body>
</html>
