<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6844912">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6844968">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6845022">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6845073">package</span>&nbsp;<span class="ident" id="6845081">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845086">import</span>&nbsp;<span class="op" id="6845093">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845096">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845105">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845112">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845118">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845129">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845140">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845151">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6845158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845161">type</span>&nbsp;<span class="ident" id="6845166">resolveIPAddrTest</span>&nbsp;<span class="keyword" id="6845184">struct</span>&nbsp;<span class="op" id="6845191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845194">net</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6845208">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845216">litAddrOrName</span>&nbsp;<span class="builtintype" id="6845230">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845238">addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6845252">*</span><span class="ident" id="6845253"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845261">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6845275">error</span><br>
<span class="lineno"></span><span class="op" id="6845281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845284">var</span>&nbsp;<span class="ident" id="6845288">resolveIPAddrTests</span>&nbsp;<span class="op" id="6845307">=</span>&nbsp;<span class="op" id="6845309">[</span><span class="op" id="6845310">]</span><span class="ident" id="6845311"><a href="/net/ipraw_test.go.html#6845166">resolveIPAddrTest</a></span><span class="op" id="6845328">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845331">{</span><span class="string" id="6845332">&#34;ip&#34;</span><span class="op" id="6845336">,</span>&nbsp;<span class="string" id="6845338">&#34;127.0.0.1&#34;</span><span class="op" id="6845349">,</span>&nbsp;<span class="op" id="6845351">&amp;</span><span class="ident" id="6845352"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845358">{</span><span class="ident" id="6845359">IP</span><span class="op" id="6845361">:</span>&nbsp;<span class="ident" id="6845363"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6845367">(</span><span class="num" id="6845368">127</span><span class="op" id="6845371">,</span>&nbsp;<span class="num" id="6845373">0</span><span class="op" id="6845374">,</span>&nbsp;<span class="num" id="6845376">0</span><span class="op" id="6845377">,</span>&nbsp;<span class="num" id="6845379">1</span><span class="op" id="6845380">)</span><span class="op" id="6845381">}</span><span class="op" id="6845382">,</span>&nbsp;<span class="ident" id="6845384">nil</span><span class="op" id="6845387">}</span><span class="op" id="6845388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845391">{</span><span class="string" id="6845392">&#34;ip4&#34;</span><span class="op" id="6845397">,</span>&nbsp;<span class="string" id="6845399">&#34;127.0.0.1&#34;</span><span class="op" id="6845410">,</span>&nbsp;<span class="op" id="6845412">&amp;</span><span class="ident" id="6845413"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845419">{</span><span class="ident" id="6845420">IP</span><span class="op" id="6845422">:</span>&nbsp;<span class="ident" id="6845424"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6845428">(</span><span class="num" id="6845429">127</span><span class="op" id="6845432">,</span>&nbsp;<span class="num" id="6845434">0</span><span class="op" id="6845435">,</span>&nbsp;<span class="num" id="6845437">0</span><span class="op" id="6845438">,</span>&nbsp;<span class="num" id="6845440">1</span><span class="op" id="6845441">)</span><span class="op" id="6845442">}</span><span class="op" id="6845443">,</span>&nbsp;<span class="ident" id="6845445">nil</span><span class="op" id="6845448">}</span><span class="op" id="6845449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845452">{</span><span class="string" id="6845453">&#34;ip4:icmp&#34;</span><span class="op" id="6845463">,</span>&nbsp;<span class="string" id="6845465">&#34;127.0.0.1&#34;</span><span class="op" id="6845476">,</span>&nbsp;<span class="op" id="6845478">&amp;</span><span class="ident" id="6845479"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845485">{</span><span class="ident" id="6845486">IP</span><span class="op" id="6845488">:</span>&nbsp;<span class="ident" id="6845490"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6845494">(</span><span class="num" id="6845495">127</span><span class="op" id="6845498">,</span>&nbsp;<span class="num" id="6845500">0</span><span class="op" id="6845501">,</span>&nbsp;<span class="num" id="6845503">0</span><span class="op" id="6845504">,</span>&nbsp;<span class="num" id="6845506">1</span><span class="op" id="6845507">)</span><span class="op" id="6845508">}</span><span class="op" id="6845509">,</span>&nbsp;<span class="ident" id="6845511">nil</span><span class="op" id="6845514">}</span><span class="op" id="6845515">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845519">{</span><span class="string" id="6845520">&#34;ip&#34;</span><span class="op" id="6845524">,</span>&nbsp;<span class="string" id="6845526">&#34;::1&#34;</span><span class="op" id="6845531">,</span>&nbsp;<span class="op" id="6845533">&amp;</span><span class="ident" id="6845534"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845540">{</span><span class="ident" id="6845541">IP</span><span class="op" id="6845543">:</span>&nbsp;<span class="ident" id="6845545"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845552">(</span><span class="string" id="6845553">&#34;::1&#34;</span><span class="op" id="6845558">)</span><span class="op" id="6845559">}</span><span class="op" id="6845560">,</span>&nbsp;<span class="ident" id="6845562">nil</span><span class="op" id="6845565">}</span><span class="op" id="6845566">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845569">{</span><span class="string" id="6845570">&#34;ip6&#34;</span><span class="op" id="6845575">,</span>&nbsp;<span class="string" id="6845577">&#34;::1&#34;</span><span class="op" id="6845582">,</span>&nbsp;<span class="op" id="6845584">&amp;</span><span class="ident" id="6845585"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845591">{</span><span class="ident" id="6845592">IP</span><span class="op" id="6845594">:</span>&nbsp;<span class="ident" id="6845596"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845603">(</span><span class="string" id="6845604">&#34;::1&#34;</span><span class="op" id="6845609">)</span><span class="op" id="6845610">}</span><span class="op" id="6845611">,</span>&nbsp;<span class="ident" id="6845613">nil</span><span class="op" id="6845616">}</span><span class="op" id="6845617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845620">{</span><span class="string" id="6845621">&#34;ip6:ipv6-icmp&#34;</span><span class="op" id="6845636">,</span>&nbsp;<span class="string" id="6845638">&#34;::1&#34;</span><span class="op" id="6845643">,</span>&nbsp;<span class="op" id="6845645">&amp;</span><span class="ident" id="6845646"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845652">{</span><span class="ident" id="6845653">IP</span><span class="op" id="6845655">:</span>&nbsp;<span class="ident" id="6845657"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845664">(</span><span class="string" id="6845665">&#34;::1&#34;</span><span class="op" id="6845670">)</span><span class="op" id="6845671">}</span><span class="op" id="6845672">,</span>&nbsp;<span class="ident" id="6845674">nil</span><span class="op" id="6845677">}</span><span class="op" id="6845678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845681">{</span><span class="string" id="6845682">&#34;ip6:IPv6-ICMP&#34;</span><span class="op" id="6845697">,</span>&nbsp;<span class="string" id="6845699">&#34;::1&#34;</span><span class="op" id="6845704">,</span>&nbsp;<span class="op" id="6845706">&amp;</span><span class="ident" id="6845707"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845713">{</span><span class="ident" id="6845714">IP</span><span class="op" id="6845716">:</span>&nbsp;<span class="ident" id="6845718"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845725">(</span><span class="string" id="6845726">&#34;::1&#34;</span><span class="op" id="6845731">)</span><span class="op" id="6845732">}</span><span class="op" id="6845733">,</span>&nbsp;<span class="ident" id="6845735">nil</span><span class="op" id="6845738">}</span><span class="op" id="6845739">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845743">{</span><span class="string" id="6845744">&#34;ip&#34;</span><span class="op" id="6845748">,</span>&nbsp;<span class="string" id="6845750">&#34;::1%en0&#34;</span><span class="op" id="6845759">,</span>&nbsp;<span class="op" id="6845761">&amp;</span><span class="ident" id="6845762"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845768">{</span><span class="ident" id="6845769">IP</span><span class="op" id="6845771">:</span>&nbsp;<span class="ident" id="6845773"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845780">(</span><span class="string" id="6845781">&#34;::1&#34;</span><span class="op" id="6845786">)</span><span class="op" id="6845787">,</span>&nbsp;<span class="ident" id="6845789">Zone</span><span class="op" id="6845793">:</span>&nbsp;<span class="string" id="6845795">&#34;en0&#34;</span><span class="op" id="6845800">}</span><span class="op" id="6845801">,</span>&nbsp;<span class="ident" id="6845803">nil</span><span class="op" id="6845806">}</span><span class="op" id="6845807">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845810">{</span><span class="string" id="6845811">&#34;ip6&#34;</span><span class="op" id="6845816">,</span>&nbsp;<span class="string" id="6845818">&#34;::1%911&#34;</span><span class="op" id="6845827">,</span>&nbsp;<span class="op" id="6845829">&amp;</span><span class="ident" id="6845830"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845836">{</span><span class="ident" id="6845837">IP</span><span class="op" id="6845839">:</span>&nbsp;<span class="ident" id="6845841"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845848">(</span><span class="string" id="6845849">&#34;::1&#34;</span><span class="op" id="6845854">)</span><span class="op" id="6845855">,</span>&nbsp;<span class="ident" id="6845857">Zone</span><span class="op" id="6845861">:</span>&nbsp;<span class="string" id="6845863">&#34;911&#34;</span><span class="op" id="6845868">}</span><span class="op" id="6845869">,</span>&nbsp;<span class="ident" id="6845871">nil</span><span class="op" id="6845874">}</span><span class="op" id="6845875">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845879">{</span><span class="string" id="6845880">&#34;&#34;</span><span class="op" id="6845882">,</span>&nbsp;<span class="string" id="6845884">&#34;127.0.0.1&#34;</span><span class="op" id="6845895">,</span>&nbsp;<span class="op" id="6845897">&amp;</span><span class="ident" id="6845898"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845904">{</span><span class="ident" id="6845905">IP</span><span class="op" id="6845907">:</span>&nbsp;<span class="ident" id="6845909"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6845913">(</span><span class="num" id="6845914">127</span><span class="op" id="6845917">,</span>&nbsp;<span class="num" id="6845919">0</span><span class="op" id="6845920">,</span>&nbsp;<span class="num" id="6845922">0</span><span class="op" id="6845923">,</span>&nbsp;<span class="num" id="6845925">1</span><span class="op" id="6845926">)</span><span class="op" id="6845927">}</span><span class="op" id="6845928">,</span>&nbsp;<span class="ident" id="6845930">nil</span><span class="op" id="6845933">}</span><span class="op" id="6845934">,</span>&nbsp;<span class="comment" id="6845936">//&nbsp;Go&nbsp;1.0&nbsp;behavior</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845956">{</span><span class="string" id="6845957">&#34;&#34;</span><span class="op" id="6845959">,</span>&nbsp;<span class="string" id="6845961">&#34;::1&#34;</span><span class="op" id="6845966">,</span>&nbsp;<span class="op" id="6845968">&amp;</span><span class="ident" id="6845969"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6845975">{</span><span class="ident" id="6845976">IP</span><span class="op" id="6845978">:</span>&nbsp;<span class="ident" id="6845980"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6845987">(</span><span class="string" id="6845988">&#34;::1&#34;</span><span class="op" id="6845993">)</span><span class="op" id="6845994">}</span><span class="op" id="6845995">,</span>&nbsp;<span class="ident" id="6845997">nil</span><span class="op" id="6846000">}</span><span class="op" id="6846001">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6846013">//&nbsp;Go&nbsp;1.0&nbsp;behavior</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846034">{</span><span class="string" id="6846035">&#34;l2tp&#34;</span><span class="op" id="6846041">,</span>&nbsp;<span class="string" id="6846043">&#34;127.0.0.1&#34;</span><span class="op" id="6846054">,</span>&nbsp;<span class="ident" id="6846056">nil</span><span class="op" id="6846059">,</span>&nbsp;<span class="ident" id="6846061"><a href="/net/net.go.html#2661008">UnknownNetworkError</a></span><span class="op" id="6846080">(</span><span class="string" id="6846081">&#34;l2tp&#34;</span><span class="op" id="6846087">)</span><span class="op" id="6846088">}</span><span class="op" id="6846089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846092">{</span><span class="string" id="6846093">&#34;l2tp:gre&#34;</span><span class="op" id="6846103">,</span>&nbsp;<span class="string" id="6846105">&#34;127.0.0.1&#34;</span><span class="op" id="6846116">,</span>&nbsp;<span class="ident" id="6846118">nil</span><span class="op" id="6846121">,</span>&nbsp;<span class="ident" id="6846123"><a href="/net/net.go.html#2661008">UnknownNetworkError</a></span><span class="op" id="6846142">(</span><span class="string" id="6846143">&#34;l2tp:gre&#34;</span><span class="op" id="6846153">)</span><span class="op" id="6846154">}</span><span class="op" id="6846155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846158">{</span><span class="string" id="6846159">&#34;tcp&#34;</span><span class="op" id="6846164">,</span>&nbsp;<span class="string" id="6846166">&#34;1.2.3.4:123&#34;</span><span class="op" id="6846179">,</span>&nbsp;<span class="ident" id="6846181">nil</span><span class="op" id="6846184">,</span>&nbsp;<span class="ident" id="6846186"><a href="/net/net.go.html#2661008">UnknownNetworkError</a></span><span class="op" id="6846205">(</span><span class="string" id="6846206">&#34;tcp&#34;</span><span class="op" id="6846211">)</span><span class="op" id="6846212">}</span><span class="op" id="6846213">,</span><br>
<span class="lineno"></span><span class="op" id="6846215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6846218">func</span>&nbsp;<span class="ident" id="6846223">init</span><span class="op" id="6846227">(</span><span class="op" id="6846228">)</span>&nbsp;<span class="op" id="6846230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846233">if</span>&nbsp;<span class="ident" id="6846236">ifi</span>&nbsp;<span class="op" id="6846240">:=</span>&nbsp;<span class="ident" id="6846243"><a href="/net/interface_test.go.html#6819206">loopbackInterface</a></span><span class="op" id="6846260">(</span><span class="op" id="6846261">)</span><span class="op" id="6846262">;</span>&nbsp;<span class="ident" id="6846264"><a href="/net/ipraw_test.go.html#6846236">ifi</a></span>&nbsp;<span class="op" id="6846268">!=</span>&nbsp;<span class="ident" id="6846271">nil</span>&nbsp;<span class="op" id="6846275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846279">index</span>&nbsp;<span class="op" id="6846285">:=</span>&nbsp;<span class="ident" id="6846288"><a href="/net/ipraw_test.go.html#6845105">fmt</a></span><span class="op" id="6846291">.</span><span class="ident" id="6846292">Sprintf</span><span class="op" id="6846299">(</span><span class="string" id="6846300">&#34;%v&#34;</span><span class="op" id="6846304">,</span>&nbsp;<span class="ident" id="6846306"><a href="/net/ipraw_test.go.html#6846236">ifi</a></span><span class="op" id="6846309">.</span><span class="ident" id="6846310">Index</span><span class="op" id="6846315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846319"><a href="/net/ipraw_test.go.html#6845288">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="6846338">=</span>&nbsp;<span class="builtinfunc" id="6846340">append</span><span class="op" id="6846346">(</span><span class="ident" id="6846347"><a href="/net/ipraw_test.go.html#6845288">resolveIPAddrTests</a></span><span class="op" id="6846365">,</span>&nbsp;<span class="op" id="6846367">[</span><span class="op" id="6846368">]</span><span class="ident" id="6846369"><a href="/net/ipraw_test.go.html#6845166">resolveIPAddrTest</a></span><span class="op" id="6846386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846391">{</span><span class="string" id="6846392">&#34;ip6&#34;</span><span class="op" id="6846397">,</span>&nbsp;<span class="string" id="6846399">&#34;fe80::1%&#34;</span>&nbsp;<span class="op" id="6846410">+</span>&nbsp;<span class="ident" id="6846412"><a href="/net/ipraw_test.go.html#6846236">ifi</a></span><span class="op" id="6846415">.</span><span class="ident" id="6846416">Name</span><span class="op" id="6846420">,</span>&nbsp;<span class="op" id="6846422">&amp;</span><span class="ident" id="6846423"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6846429">{</span><span class="ident" id="6846430">IP</span><span class="op" id="6846432">:</span>&nbsp;<span class="ident" id="6846434"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6846441">(</span><span class="string" id="6846442">&#34;fe80::1&#34;</span><span class="op" id="6846451">)</span><span class="op" id="6846452">,</span>&nbsp;<span class="ident" id="6846454">Zone</span><span class="op" id="6846458">:</span>&nbsp;<span class="ident" id="6846460"><a href="/net/ipsock.go.html#2635208">zoneToString</a></span><span class="op" id="6846472">(</span><span class="ident" id="6846473"><a href="/net/ipraw_test.go.html#6846236">ifi</a></span><span class="op" id="6846476">.</span><span class="ident" id="6846477">Index</span><span class="op" id="6846482">)</span><span class="op" id="6846483">}</span><span class="op" id="6846484">,</span>&nbsp;<span class="ident" id="6846486">nil</span><span class="op" id="6846489">}</span><span class="op" id="6846490">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846495">{</span><span class="string" id="6846496">&#34;ip6&#34;</span><span class="op" id="6846501">,</span>&nbsp;<span class="string" id="6846503">&#34;fe80::1%&#34;</span>&nbsp;<span class="op" id="6846514">+</span>&nbsp;<span class="ident" id="6846516"><a href="/net/ipraw_test.go.html#6846279">index</a></span><span class="op" id="6846521">,</span>&nbsp;<span class="op" id="6846523">&amp;</span><span class="ident" id="6846524"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6846530">{</span><span class="ident" id="6846531">IP</span><span class="op" id="6846533">:</span>&nbsp;<span class="ident" id="6846535"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6846542">(</span><span class="string" id="6846543">&#34;fe80::1&#34;</span><span class="op" id="6846552">)</span><span class="op" id="6846553">,</span>&nbsp;<span class="ident" id="6846555">Zone</span><span class="op" id="6846559">:</span>&nbsp;<span class="ident" id="6846561"><a href="/net/ipraw_test.go.html#6846279">index</a></span><span class="op" id="6846566">}</span><span class="op" id="6846567">,</span>&nbsp;<span class="ident" id="6846569">nil</span><span class="op" id="6846572">}</span><span class="op" id="6846573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846577">}</span><span class="op" id="6846578">...</span><span class="op" id="6846581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846587">if</span>&nbsp;<span class="ident" id="6846590">ips</span><span class="op" id="6846593">,</span>&nbsp;<span class="ident" id="6846595">err</span>&nbsp;<span class="op" id="6846599">:=</span>&nbsp;<span class="ident" id="6846602"><a href="/net/lookup.go.html#2642100">LookupIP</a></span><span class="op" id="6846610">(</span><span class="string" id="6846611">&#34;localhost&#34;</span><span class="op" id="6846622">)</span><span class="op" id="6846623">;</span>&nbsp;<span class="ident" id="6846625"><a href="/net/ipraw_test.go.html#6846595">err</a></span>&nbsp;<span class="op" id="6846629">==</span>&nbsp;<span class="ident" id="6846632">nil</span>&nbsp;<span class="op" id="6846636">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6846639">len</span><span class="op" id="6846642">(</span><span class="ident" id="6846643"><a href="/net/ipraw_test.go.html#6846590">ips</a></span><span class="op" id="6846646">)</span>&nbsp;<span class="op" id="6846648">&gt;</span>&nbsp;<span class="num" id="6846650">1</span>&nbsp;<span class="op" id="6846652">&amp;&amp;</span>&nbsp;<span class="ident" id="6846655"><a href="/net/ipsock.go.html#2627659">supportsIPv4</a></span>&nbsp;<span class="op" id="6846668">&amp;&amp;</span>&nbsp;<span class="ident" id="6846671"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6846684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846688"><a href="/net/ipraw_test.go.html#6845288">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="6846707">=</span>&nbsp;<span class="builtinfunc" id="6846709">append</span><span class="op" id="6846715">(</span><span class="ident" id="6846716"><a href="/net/ipraw_test.go.html#6845288">resolveIPAddrTests</a></span><span class="op" id="6846734">,</span>&nbsp;<span class="op" id="6846736">[</span><span class="op" id="6846737">]</span><span class="ident" id="6846738"><a href="/net/ipraw_test.go.html#6845166">resolveIPAddrTest</a></span><span class="op" id="6846755">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846760">{</span><span class="string" id="6846761">&#34;ip&#34;</span><span class="op" id="6846765">,</span>&nbsp;<span class="string" id="6846767">&#34;localhost&#34;</span><span class="op" id="6846778">,</span>&nbsp;<span class="op" id="6846780">&amp;</span><span class="ident" id="6846781"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6846787">{</span><span class="ident" id="6846788">IP</span><span class="op" id="6846790">:</span>&nbsp;<span class="ident" id="6846792"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6846796">(</span><span class="num" id="6846797">127</span><span class="op" id="6846800">,</span>&nbsp;<span class="num" id="6846802">0</span><span class="op" id="6846803">,</span>&nbsp;<span class="num" id="6846805">0</span><span class="op" id="6846806">,</span>&nbsp;<span class="num" id="6846808">1</span><span class="op" id="6846809">)</span><span class="op" id="6846810">}</span><span class="op" id="6846811">,</span>&nbsp;<span class="ident" id="6846813">nil</span><span class="op" id="6846816">}</span><span class="op" id="6846817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846822">{</span><span class="string" id="6846823">&#34;ip4&#34;</span><span class="op" id="6846828">,</span>&nbsp;<span class="string" id="6846830">&#34;localhost&#34;</span><span class="op" id="6846841">,</span>&nbsp;<span class="op" id="6846843">&amp;</span><span class="ident" id="6846844"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6846850">{</span><span class="ident" id="6846851">IP</span><span class="op" id="6846853">:</span>&nbsp;<span class="ident" id="6846855"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6846859">(</span><span class="num" id="6846860">127</span><span class="op" id="6846863">,</span>&nbsp;<span class="num" id="6846865">0</span><span class="op" id="6846866">,</span>&nbsp;<span class="num" id="6846868">0</span><span class="op" id="6846869">,</span>&nbsp;<span class="num" id="6846871">1</span><span class="op" id="6846872">)</span><span class="op" id="6846873">}</span><span class="op" id="6846874">,</span>&nbsp;<span class="ident" id="6846876">nil</span><span class="op" id="6846879">}</span><span class="op" id="6846880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846885">{</span><span class="string" id="6846886">&#34;ip6&#34;</span><span class="op" id="6846891">,</span>&nbsp;<span class="string" id="6846893">&#34;localhost&#34;</span><span class="op" id="6846904">,</span>&nbsp;<span class="op" id="6846906">&amp;</span><span class="ident" id="6846907"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6846913">{</span><span class="ident" id="6846914">IP</span><span class="op" id="6846916">:</span>&nbsp;<span class="ident" id="6846918"><a href="/net/ip.go.html#2605971">IPv6loopback</a></span><span class="op" id="6846930">}</span><span class="op" id="6846931">,</span>&nbsp;<span class="ident" id="6846933">nil</span><span class="op" id="6846936">}</span><span class="op" id="6846937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846941">}</span><span class="op" id="6846942">...</span><span class="op" id="6846945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846948">}</span><br>
<span class="lineno">60</span><span class="op" id="6846950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6846953">func</span>&nbsp;<span class="ident" id="6846958">skipRawSocketTest</span><span class="op" id="6846975">(</span><span class="ident" id="6846976">t</span>&nbsp;<span class="op" id="6846978">*</span><span class="ident" id="6846979"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6846986">.</span><span class="ident" id="6846987">T</span><span class="op" id="6846988">)</span>&nbsp;<span class="op" id="6846990">(</span><span class="ident" id="6846991">skip</span>&nbsp;<span class="builtintype" id="6846996">bool</span><span class="op" id="6847000">,</span>&nbsp;<span class="ident" id="6847002">skipmsg</span>&nbsp;<span class="builtintype" id="6847010">string</span><span class="op" id="6847016">)</span>&nbsp;<span class="op" id="6847018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847021"><a href="/net/ipraw_test.go.html#6846991">skip</a></span><span class="op" id="6847025">,</span>&nbsp;<span class="ident" id="6847027"><a href="/net/ipraw_test.go.html#6847002">skipmsg</a></span><span class="op" id="6847034">,</span>&nbsp;<span class="ident" id="6847036">err</span>&nbsp;<span class="op" id="6847040">:=</span>&nbsp;<span class="ident" id="6847043"><a href="/net/fd_unix.go.html#2587310">skipRawSocketTests</a></span><span class="op" id="6847061">(</span><span class="op" id="6847062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847065">if</span>&nbsp;<span class="ident" id="6847068"><a href="/net/ipraw_test.go.html#6847036">err</a></span>&nbsp;<span class="op" id="6847072">!=</span>&nbsp;<span class="ident" id="6847075">nil</span>&nbsp;<span class="op" id="6847079">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847083"><a href="/net/ipraw_test.go.html#6846976">t</a></span><span class="op" id="6847084">.</span><span class="ident" id="6847085">Fatal</span><span class="op" id="6847090">(</span><span class="ident" id="6847091"><a href="/net/ipraw_test.go.html#6847036">err</a></span><span class="op" id="6847094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847100">return</span>&nbsp;<span class="ident" id="6847107"><a href="/net/ipraw_test.go.html#6846991">skip</a></span><span class="op" id="6847111">,</span>&nbsp;<span class="ident" id="6847113"><a href="/net/ipraw_test.go.html#6847002">skipmsg</a></span><br>
<span class="lineno"></span><span class="op" id="6847121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="6847124">func</span>&nbsp;<span class="ident" id="6847129">TestResolveIPAddr</span><span class="op" id="6847146">(</span><span class="ident" id="6847147">t</span>&nbsp;<span class="op" id="6847149">*</span><span class="ident" id="6847150"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6847157">.</span><span class="ident" id="6847158">T</span><span class="op" id="6847159">)</span>&nbsp;<span class="op" id="6847161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847164">switch</span>&nbsp;<span class="ident" id="6847171"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6847178">.</span><span class="ident" id="6847179">GOOS</span>&nbsp;<span class="op" id="6847184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847187">case</span>&nbsp;<span class="string" id="6847192">&#34;nacl&#34;</span><span class="op" id="6847198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847202"><a href="/net/ipraw_test.go.html#6847147">t</a></span><span class="op" id="6847203">.</span><span class="ident" id="6847204">Skipf</span><span class="op" id="6847209">(</span><span class="string" id="6847210">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6847231">,</span>&nbsp;<span class="ident" id="6847233"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6847240">.</span><span class="ident" id="6847241">GOOS</span><span class="op" id="6847245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847248">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847252">for</span>&nbsp;<span class="ident" id="6847256">_</span><span class="op" id="6847257">,</span>&nbsp;<span class="ident" id="6847259">tt</span>&nbsp;<span class="op" id="6847262">:=</span>&nbsp;<span class="keyword" id="6847265">range</span>&nbsp;<span class="ident" id="6847271"><a href="/net/ipraw_test.go.html#6845288">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="6847290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847294">addr</span><span class="op" id="6847298">,</span>&nbsp;<span class="ident" id="6847300">err</span>&nbsp;<span class="op" id="6847304">:=</span>&nbsp;<span class="ident" id="6847307"><a href="/net/iprawsock.go.html#2619766">ResolveIPAddr</a></span><span class="op" id="6847320">(</span><span class="ident" id="6847321"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847323">.</span><span class="ident" id="6847324">net</span><span class="op" id="6847327">,</span>&nbsp;<span class="ident" id="6847329"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847331">.</span><span class="ident" id="6847332">litAddrOrName</span><span class="op" id="6847345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847349">if</span>&nbsp;<span class="ident" id="6847352"><a href="/net/ipraw_test.go.html#6847300">err</a></span>&nbsp;<span class="op" id="6847356">!=</span>&nbsp;<span class="ident" id="6847359"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847361">.</span><span class="ident" id="6847362">err</span>&nbsp;<span class="op" id="6847366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847371"><a href="/net/ipraw_test.go.html#6847147">t</a></span><span class="op" id="6847372">.</span><span class="ident" id="6847373">Fatalf</span><span class="op" id="6847379">(</span><span class="string" id="6847380">&#34;ResolveIPAddr(%v,&nbsp;%v)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6847414">,</span>&nbsp;<span class="ident" id="6847416"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847418">.</span><span class="ident" id="6847419">net</span><span class="op" id="6847422">,</span>&nbsp;<span class="ident" id="6847424"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847426">.</span><span class="ident" id="6847427">litAddrOrName</span><span class="op" id="6847440">,</span>&nbsp;<span class="ident" id="6847442"><a href="/net/ipraw_test.go.html#6847300">err</a></span><span class="op" id="6847445">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847449">}</span>&nbsp;<span class="keyword" id="6847451">else</span>&nbsp;<span class="keyword" id="6847456">if</span>&nbsp;<span class="op" id="6847459">!</span><span class="ident" id="6847460"><a href="/net/ipraw_test.go.html#6845118">reflect</a></span><span class="op" id="6847467">.</span><span class="ident" id="6847468">DeepEqual</span><span class="op" id="6847477">(</span><span class="ident" id="6847478"><a href="/net/ipraw_test.go.html#6847294">addr</a></span><span class="op" id="6847482">,</span>&nbsp;<span class="ident" id="6847484"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847486">.</span><span class="ident" id="6847487">addr</span><span class="op" id="6847491">)</span>&nbsp;<span class="op" id="6847493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847498"><a href="/net/ipraw_test.go.html#6847147">t</a></span><span class="op" id="6847499">.</span><span class="ident" id="6847500">Fatalf</span><span class="op" id="6847506">(</span><span class="string" id="6847507">&#34;got&nbsp;%#v;&nbsp;expected&nbsp;%#v&#34;</span><span class="op" id="6847530">,</span>&nbsp;<span class="ident" id="6847532"><a href="/net/ipraw_test.go.html#6847294">addr</a></span><span class="op" id="6847536">,</span>&nbsp;<span class="ident" id="6847538"><a href="/net/ipraw_test.go.html#6847259">tt</a></span><span class="op" id="6847540">.</span><span class="ident" id="6847541">addr</span><span class="op" id="6847545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847552">}</span><br>
<span class="lineno"></span><span class="op" id="6847554">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6847557">var</span>&nbsp;<span class="ident" id="6847561">icmpEchoTests</span>&nbsp;<span class="op" id="6847575">=</span>&nbsp;<span class="op" id="6847577">[</span><span class="op" id="6847578">]</span><span class="keyword" id="6847579">struct</span>&nbsp;<span class="op" id="6847586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847589">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6847595">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847603">laddr</span>&nbsp;<span class="builtintype" id="6847609">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847617">raddr</span>&nbsp;<span class="builtintype" id="6847623">string</span><br>
<span class="lineno">90</span><span class="op" id="6847630">}</span><span class="op" id="6847631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847634">{</span><span class="string" id="6847635">&#34;ip4:icmp&#34;</span><span class="op" id="6847645">,</span>&nbsp;<span class="string" id="6847647">&#34;0.0.0.0&#34;</span><span class="op" id="6847656">,</span>&nbsp;<span class="string" id="6847658">&#34;127.0.0.1&#34;</span><span class="op" id="6847669">}</span><span class="op" id="6847670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847673">{</span><span class="string" id="6847674">&#34;ip6:ipv6-icmp&#34;</span><span class="op" id="6847689">,</span>&nbsp;<span class="string" id="6847691">&#34;::&#34;</span><span class="op" id="6847695">,</span>&nbsp;<span class="string" id="6847697">&#34;::1&#34;</span><span class="op" id="6847702">}</span><span class="op" id="6847703">,</span><br>
<span class="lineno"></span><span class="op" id="6847705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6847708">func</span>&nbsp;<span class="ident" id="6847713">TestConnICMPEcho</span><span class="op" id="6847729">(</span><span class="ident" id="6847730">t</span>&nbsp;<span class="op" id="6847732">*</span><span class="ident" id="6847733"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6847740">.</span><span class="ident" id="6847741">T</span><span class="op" id="6847742">)</span>&nbsp;<span class="op" id="6847744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847747">if</span>&nbsp;<span class="ident" id="6847750">skip</span><span class="op" id="6847754">,</span>&nbsp;<span class="ident" id="6847756">skipmsg</span>&nbsp;<span class="op" id="6847764">:=</span>&nbsp;<span class="ident" id="6847767"><a href="/net/ipraw_test.go.html#6846958">skipRawSocketTest</a></span><span class="op" id="6847784">(</span><span class="ident" id="6847785"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6847786">)</span><span class="op" id="6847787">;</span>&nbsp;<span class="ident" id="6847789"><a href="/net/ipraw_test.go.html#6847750">skip</a></span>&nbsp;<span class="op" id="6847794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847798"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6847799">.</span><span class="ident" id="6847800">Skip</span><span class="op" id="6847804">(</span><span class="ident" id="6847805"><a href="/net/ipraw_test.go.html#6847756">skipmsg</a></span><span class="op" id="6847812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847819">for</span>&nbsp;<span class="ident" id="6847823">i</span><span class="op" id="6847824">,</span>&nbsp;<span class="ident" id="6847826">tt</span>&nbsp;<span class="op" id="6847829">:=</span>&nbsp;<span class="keyword" id="6847832">range</span>&nbsp;<span class="ident" id="6847838"><a href="/net/ipraw_test.go.html#6847561">icmpEchoTests</a></span>&nbsp;<span class="op" id="6847852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847856">net</span><span class="op" id="6847859">,</span>&nbsp;<span class="ident" id="6847861">_</span><span class="op" id="6847862">,</span>&nbsp;<span class="ident" id="6847864">err</span>&nbsp;<span class="op" id="6847868">:=</span>&nbsp;<span class="ident" id="6847871"><a href="/net/dial.go.html#2519499">parseNetwork</a></span><span class="op" id="6847883">(</span><span class="ident" id="6847884"><a href="/net/ipraw_test.go.html#6847826">tt</a></span><span class="op" id="6847886">.</span><span class="ident" id="6847887">net</span><span class="op" id="6847890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847894">if</span>&nbsp;<span class="ident" id="6847897"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6847901">!=</span>&nbsp;<span class="ident" id="6847904">nil</span>&nbsp;<span class="op" id="6847908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847913"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6847914">.</span><span class="ident" id="6847915">Fatalf</span><span class="op" id="6847921">(</span><span class="string" id="6847922">&#34;parseNetwork&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6847947">,</span>&nbsp;<span class="ident" id="6847949"><a href="/net/ipraw_test.go.html#6847864">err</a></span><span class="op" id="6847952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847956">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847960">if</span>&nbsp;<span class="ident" id="6847963"><a href="/net/ipraw_test.go.html#6847856">net</a></span>&nbsp;<span class="op" id="6847967">==</span>&nbsp;<span class="string" id="6847970">&#34;ip6&#34;</span>&nbsp;<span class="op" id="6847976">&amp;&amp;</span>&nbsp;<span class="op" id="6847979">!</span><span class="ident" id="6847980"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6847993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847998">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848014">c</span><span class="op" id="6848015">,</span>&nbsp;<span class="ident" id="6848017"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848021">:=</span>&nbsp;<span class="ident" id="6848024"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6848028">(</span><span class="ident" id="6848029"><a href="/net/ipraw_test.go.html#6847826">tt</a></span><span class="op" id="6848031">.</span><span class="ident" id="6848032">net</span><span class="op" id="6848035">,</span>&nbsp;<span class="ident" id="6848037"><a href="/net/ipraw_test.go.html#6847826">tt</a></span><span class="op" id="6848039">.</span><span class="ident" id="6848040">raddr</span><span class="op" id="6848045">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848049">if</span>&nbsp;<span class="ident" id="6848052"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848056">!=</span>&nbsp;<span class="ident" id="6848059">nil</span>&nbsp;<span class="op" id="6848063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848068"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6848069">.</span><span class="ident" id="6848070">Fatalf</span><span class="op" id="6848076">(</span><span class="string" id="6848077">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6848094">,</span>&nbsp;<span class="ident" id="6848096"><a href="/net/ipraw_test.go.html#6847864">err</a></span><span class="op" id="6848099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848107"><a href="/net/ipraw_test.go.html#6848014">c</a></span><span class="op" id="6848108">.</span><span class="ident" id="6848109">SetDeadline</span><span class="op" id="6848120">(</span><span class="ident" id="6848121"><a href="/net/ipraw_test.go.html#6845151">time</a></span><span class="op" id="6848125">.</span><span class="ident" id="6848126">Now</span><span class="op" id="6848129">(</span><span class="op" id="6848130">)</span><span class="op" id="6848131">.</span><span class="ident" id="6848132">Add</span><span class="op" id="6848135">(</span><span class="num" id="6848136">100</span>&nbsp;<span class="op" id="6848140">*</span>&nbsp;<span class="ident" id="6848142"><a href="/net/ipraw_test.go.html#6845151">time</a></span><span class="op" id="6848146">.</span><span class="ident" id="6848147">Millisecond</span><span class="op" id="6848158">)</span><span class="op" id="6848159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848163">defer</span>&nbsp;<span class="ident" id="6848169"><a href="/net/ipraw_test.go.html#6848014">c</a></span><span class="op" id="6848170">.</span><span class="ident" id="6848171">Close</span><span class="op" id="6848176">(</span><span class="op" id="6848177">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848182">typ</span>&nbsp;<span class="op" id="6848186">:=</span>&nbsp;<span class="ident" id="6848189"><a href="/net/mockicmp_test.go.html#6863993">icmpv4EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848209">if</span>&nbsp;<span class="ident" id="6848212"><a href="/net/ipraw_test.go.html#6847856">net</a></span>&nbsp;<span class="op" id="6848216">==</span>&nbsp;<span class="string" id="6848219">&#34;ip6&#34;</span>&nbsp;<span class="op" id="6848225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848230"><a href="/net/ipraw_test.go.html#6848182">typ</a></span>&nbsp;<span class="op" id="6848234">=</span>&nbsp;<span class="ident" id="6848236"><a href="/net/mockicmp_test.go.html#6864039">icmpv6EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848256">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848260">xid</span><span class="op" id="6848263">,</span>&nbsp;<span class="ident" id="6848265">xseq</span>&nbsp;<span class="op" id="6848270">:=</span>&nbsp;<span class="ident" id="6848273"><a href="/net/ipraw_test.go.html#6845112">os</a></span><span class="op" id="6848275">.</span><span class="ident" id="6848276">Getpid</span><span class="op" id="6848282">(</span><span class="op" id="6848283">)</span><span class="op" id="6848284">&amp;</span><span class="num" id="6848285">0xffff</span><span class="op" id="6848291">,</span>&nbsp;<span class="ident" id="6848293"><a href="/net/ipraw_test.go.html#6847823">i</a></span><span class="op" id="6848294">+</span><span class="num" id="6848295">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848299">wb</span><span class="op" id="6848301">,</span>&nbsp;<span class="ident" id="6848303"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848307">:=</span>&nbsp;<span class="op" id="6848310">(</span><span class="op" id="6848311">&amp;</span><span class="ident" id="6848312"><a href="/net/mockicmp_test.go.html#6864139">icmpMessage</a></span><span class="op" id="6848323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848328">Type</span><span class="op" id="6848332">:</span>&nbsp;<span class="ident" id="6848334"><a href="/net/ipraw_test.go.html#6848182">typ</a></span><span class="op" id="6848337">,</span>&nbsp;<span class="ident" id="6848339">Code</span><span class="op" id="6848343">:</span>&nbsp;<span class="num" id="6848345">0</span><span class="op" id="6848346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848351">Body</span><span class="op" id="6848355">:</span>&nbsp;<span class="op" id="6848357">&amp;</span><span class="ident" id="6848358"><a href="/net/mockicmp_test.go.html#6865797">icmpEcho</a></span><span class="op" id="6848366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848372">ID</span><span class="op" id="6848374">:</span>&nbsp;<span class="ident" id="6848376"><a href="/net/ipraw_test.go.html#6848260">xid</a></span><span class="op" id="6848379">,</span>&nbsp;<span class="ident" id="6848381">Seq</span><span class="op" id="6848384">:</span>&nbsp;<span class="ident" id="6848386"><a href="/net/ipraw_test.go.html#6848265">xseq</a></span><span class="op" id="6848390">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848396">Data</span><span class="op" id="6848400">:</span>&nbsp;<span class="ident" id="6848402"><a href="/net/ipraw_test.go.html#6845096">bytes</a></span><span class="op" id="6848407">.</span><span class="ident" id="6848408">Repeat</span><span class="op" id="6848414">(</span><span class="op" id="6848415">[</span><span class="op" id="6848416">]</span><span class="builtintype" id="6848417">byte</span><span class="op" id="6848421">(</span><span class="string" id="6848422">&#34;Go&nbsp;Go&nbsp;Gadget&nbsp;Ping!!!&#34;</span><span class="op" id="6848444">)</span><span class="op" id="6848445">,</span>&nbsp;<span class="num" id="6848447">3</span><span class="op" id="6848448">)</span><span class="op" id="6848449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848454">}</span><span class="op" id="6848455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848459">}</span><span class="op" id="6848460">)</span><span class="op" id="6848461">.</span><span class="ident" id="6848462">Marshal</span><span class="op" id="6848469">(</span><span class="op" id="6848470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848474">if</span>&nbsp;<span class="ident" id="6848477"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848481">!=</span>&nbsp;<span class="ident" id="6848484">nil</span>&nbsp;<span class="op" id="6848488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848493"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6848494">.</span><span class="ident" id="6848495">Fatalf</span><span class="op" id="6848501">(</span><span class="string" id="6848502">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6848534">,</span>&nbsp;<span class="ident" id="6848536"><a href="/net/ipraw_test.go.html#6847864">err</a></span><span class="op" id="6848539">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848547">if</span>&nbsp;<span class="ident" id="6848550">_</span><span class="op" id="6848551">,</span>&nbsp;<span class="ident" id="6848553">err</span>&nbsp;<span class="op" id="6848557">:=</span>&nbsp;<span class="ident" id="6848560"><a href="/net/ipraw_test.go.html#6848014">c</a></span><span class="op" id="6848561">.</span><span class="ident" id="6848562">Write</span><span class="op" id="6848567">(</span><span class="ident" id="6848568"><a href="/net/ipraw_test.go.html#6848299">wb</a></span><span class="op" id="6848570">)</span><span class="op" id="6848571">;</span>&nbsp;<span class="ident" id="6848573"><a href="/net/ipraw_test.go.html#6848553">err</a></span>&nbsp;<span class="op" id="6848577">!=</span>&nbsp;<span class="ident" id="6848580">nil</span>&nbsp;<span class="op" id="6848584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848589"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6848590">.</span><span class="ident" id="6848591">Fatalf</span><span class="op" id="6848597">(</span><span class="string" id="6848598">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6848621">,</span>&nbsp;<span class="ident" id="6848623"><a href="/net/ipraw_test.go.html#6848553">err</a></span><span class="op" id="6848626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848634">var</span>&nbsp;<span class="ident" id="6848638">m</span>&nbsp;<span class="op" id="6848640">*</span><span class="ident" id="6848641"><a href="/net/mockicmp_test.go.html#6864139">icmpMessage</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848655">rb</span>&nbsp;<span class="op" id="6848658">:=</span>&nbsp;<span class="builtinfunc" id="6848661">make</span><span class="op" id="6848665">(</span><span class="op" id="6848666">[</span><span class="op" id="6848667">]</span><span class="builtintype" id="6848668">byte</span><span class="op" id="6848672">,</span>&nbsp;<span class="num" id="6848674">20</span><span class="op" id="6848676">+</span><span class="builtinfunc" id="6848677">len</span><span class="op" id="6848680">(</span><span class="ident" id="6848681"><a href="/net/ipraw_test.go.html#6848299">wb</a></span><span class="op" id="6848683">)</span><span class="op" id="6848684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848688">for</span>&nbsp;<span class="op" id="6848692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848697">if</span>&nbsp;<span class="ident" id="6848700">_</span><span class="op" id="6848701">,</span>&nbsp;<span class="ident" id="6848703">err</span>&nbsp;<span class="op" id="6848707">:=</span>&nbsp;<span class="ident" id="6848710"><a href="/net/ipraw_test.go.html#6848014">c</a></span><span class="op" id="6848711">.</span><span class="ident" id="6848712">Read</span><span class="op" id="6848716">(</span><span class="ident" id="6848717"><a href="/net/ipraw_test.go.html#6848655">rb</a></span><span class="op" id="6848719">)</span><span class="op" id="6848720">;</span>&nbsp;<span class="ident" id="6848722"><a href="/net/ipraw_test.go.html#6848703">err</a></span>&nbsp;<span class="op" id="6848726">!=</span>&nbsp;<span class="ident" id="6848729">nil</span>&nbsp;<span class="op" id="6848733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848739"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6848740">.</span><span class="ident" id="6848741">Fatalf</span><span class="op" id="6848747">(</span><span class="string" id="6848748">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6848770">,</span>&nbsp;<span class="ident" id="6848772"><a href="/net/ipraw_test.go.html#6848703">err</a></span><span class="op" id="6848775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848780">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848785">if</span>&nbsp;<span class="ident" id="6848788"><a href="/net/ipraw_test.go.html#6847856">net</a></span>&nbsp;<span class="op" id="6848792">==</span>&nbsp;<span class="string" id="6848795">&#34;ip4&#34;</span>&nbsp;<span class="op" id="6848801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848807"><a href="/net/ipraw_test.go.html#6848655">rb</a></span>&nbsp;<span class="op" id="6848810">=</span>&nbsp;<span class="ident" id="6848812"><a href="/net/ipraw_test.go.html#6851129">ipv4Payload</a></span><span class="op" id="6848823">(</span><span class="ident" id="6848824"><a href="/net/ipraw_test.go.html#6848655">rb</a></span><span class="op" id="6848826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848836">if</span>&nbsp;<span class="ident" id="6848839"><a href="/net/ipraw_test.go.html#6848638">m</a></span><span class="op" id="6848840">,</span>&nbsp;<span class="ident" id="6848842"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848846">=</span>&nbsp;<span class="ident" id="6848848"><a href="/net/mockicmp_test.go.html#6865263">parseICMPMessage</a></span><span class="op" id="6848864">(</span><span class="ident" id="6848865"><a href="/net/ipraw_test.go.html#6848655">rb</a></span><span class="op" id="6848867">)</span><span class="op" id="6848868">;</span>&nbsp;<span class="ident" id="6848870"><a href="/net/ipraw_test.go.html#6847864">err</a></span>&nbsp;<span class="op" id="6848874">!=</span>&nbsp;<span class="ident" id="6848877">nil</span>&nbsp;<span class="op" id="6848881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848887"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6848888">.</span><span class="ident" id="6848889">Fatalf</span><span class="op" id="6848895">(</span><span class="string" id="6848896">&#34;parseICMPMessage&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6848925">,</span>&nbsp;<span class="ident" id="6848927"><a href="/net/ipraw_test.go.html#6847864">err</a></span><span class="op" id="6848930">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848940">switch</span>&nbsp;<span class="ident" id="6848947"><a href="/net/ipraw_test.go.html#6848638">m</a></span><span class="op" id="6848948">.</span><span class="ident" id="6848949">Type</span>&nbsp;<span class="op" id="6848954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848959">case</span>&nbsp;<span class="ident" id="6848964"><a href="/net/mockicmp_test.go.html#6863993">icmpv4EchoRequest</a></span><span class="op" id="6848981">,</span>&nbsp;<span class="ident" id="6848983"><a href="/net/mockicmp_test.go.html#6864039">icmpv6EchoRequest</a></span><span class="op" id="6849000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849006">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849018">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849023">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849035">switch</span>&nbsp;<span class="ident" id="6849042">p</span>&nbsp;<span class="op" id="6849044">:=</span>&nbsp;<span class="ident" id="6849047"><a href="/net/ipraw_test.go.html#6848638">m</a></span><span class="op" id="6849048">.</span><span class="ident" id="6849049">Body</span><span class="op" id="6849053">.</span><span class="op" id="6849054">(</span><span class="keyword" id="6849055">type</span><span class="op" id="6849059">)</span>&nbsp;<span class="op" id="6849061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849065">case</span>&nbsp;<span class="op" id="6849070">*</span><span class="ident" id="6849071"><a href="/net/mockicmp_test.go.html#6865797">icmpEcho</a></span><span class="op" id="6849079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849084">if</span>&nbsp;<span class="ident" id="6849087"><a href="/net/ipraw_test.go.html#6849042">p</a></span><span class="op" id="6849088">.</span><span class="ident" id="6849089">ID</span>&nbsp;<span class="op" id="6849092">!=</span>&nbsp;<span class="ident" id="6849095"><a href="/net/ipraw_test.go.html#6848260">xid</a></span>&nbsp;<span class="op" id="6849099">||</span>&nbsp;<span class="ident" id="6849102"><a href="/net/ipraw_test.go.html#6849042">p</a></span><span class="op" id="6849103">.</span><span class="ident" id="6849104">Seq</span>&nbsp;<span class="op" id="6849108">!=</span>&nbsp;<span class="ident" id="6849111"><a href="/net/ipraw_test.go.html#6848265">xseq</a></span>&nbsp;<span class="op" id="6849116">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849122"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6849123">.</span><span class="ident" id="6849124">Fatalf</span><span class="op" id="6849130">(</span><span class="string" id="6849131">&#34;got&nbsp;id=%v,&nbsp;seqnum=%v;&nbsp;expected&nbsp;id=%v,&nbsp;seqnum=%v&#34;</span><span class="op" id="6849180">,</span>&nbsp;<span class="ident" id="6849182"><a href="/net/ipraw_test.go.html#6849042">p</a></span><span class="op" id="6849183">.</span><span class="ident" id="6849184">ID</span><span class="op" id="6849186">,</span>&nbsp;<span class="ident" id="6849188"><a href="/net/ipraw_test.go.html#6849042">p</a></span><span class="op" id="6849189">.</span><span class="ident" id="6849190">Seq</span><span class="op" id="6849193">,</span>&nbsp;<span class="ident" id="6849195"><a href="/net/ipraw_test.go.html#6848260">xid</a></span><span class="op" id="6849198">,</span>&nbsp;<span class="ident" id="6849200"><a href="/net/ipraw_test.go.html#6848265">xseq</a></span><span class="op" id="6849204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849213">default</span><span class="op" id="6849220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849225"><a href="/net/ipraw_test.go.html#6847730">t</a></span><span class="op" id="6849226">.</span><span class="ident" id="6849227">Fatalf</span><span class="op" id="6849233">(</span><span class="string" id="6849234">&#34;got&nbsp;type=%v,&nbsp;code=%v;&nbsp;expected&nbsp;type=%v,&nbsp;code=%v&#34;</span><span class="op" id="6849283">,</span>&nbsp;<span class="ident" id="6849285"><a href="/net/ipraw_test.go.html#6848638">m</a></span><span class="op" id="6849286">.</span><span class="ident" id="6849287">Type</span><span class="op" id="6849291">,</span>&nbsp;<span class="ident" id="6849293"><a href="/net/ipraw_test.go.html#6848638">m</a></span><span class="op" id="6849294">.</span><span class="ident" id="6849295">Code</span><span class="op" id="6849299">,</span>&nbsp;<span class="ident" id="6849301"><a href="/net/ipraw_test.go.html#6848182">typ</a></span><span class="op" id="6849304">,</span>&nbsp;<span class="num" id="6849306">0</span><span class="op" id="6849307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849311">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849314">}</span><br>
<span class="lineno"></span><span class="op" id="6849316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6849319">func</span>&nbsp;<span class="ident" id="6849324">TestPacketConnICMPEcho</span><span class="op" id="6849346">(</span><span class="ident" id="6849347">t</span>&nbsp;<span class="op" id="6849349">*</span><span class="ident" id="6849350"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6849357">.</span><span class="ident" id="6849358">T</span><span class="op" id="6849359">)</span>&nbsp;<span class="op" id="6849361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849364">if</span>&nbsp;<span class="ident" id="6849367">skip</span><span class="op" id="6849371">,</span>&nbsp;<span class="ident" id="6849373">skipmsg</span>&nbsp;<span class="op" id="6849381">:=</span>&nbsp;<span class="ident" id="6849384"><a href="/net/ipraw_test.go.html#6846958">skipRawSocketTest</a></span><span class="op" id="6849401">(</span><span class="ident" id="6849402"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6849403">)</span><span class="op" id="6849404">;</span>&nbsp;<span class="ident" id="6849406"><a href="/net/ipraw_test.go.html#6849367">skip</a></span>&nbsp;<span class="op" id="6849411">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849415"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6849416">.</span><span class="ident" id="6849417">Skip</span><span class="op" id="6849421">(</span><span class="ident" id="6849422"><a href="/net/ipraw_test.go.html#6849373">skipmsg</a></span><span class="op" id="6849429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849436">for</span>&nbsp;<span class="ident" id="6849440">i</span><span class="op" id="6849441">,</span>&nbsp;<span class="ident" id="6849443">tt</span>&nbsp;<span class="op" id="6849446">:=</span>&nbsp;<span class="keyword" id="6849449">range</span>&nbsp;<span class="ident" id="6849455"><a href="/net/ipraw_test.go.html#6847561">icmpEchoTests</a></span>&nbsp;<span class="op" id="6849469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849473">net</span><span class="op" id="6849476">,</span>&nbsp;<span class="ident" id="6849478">_</span><span class="op" id="6849479">,</span>&nbsp;<span class="ident" id="6849481">err</span>&nbsp;<span class="op" id="6849485">:=</span>&nbsp;<span class="ident" id="6849488"><a href="/net/dial.go.html#2519499">parseNetwork</a></span><span class="op" id="6849500">(</span><span class="ident" id="6849501"><a href="/net/ipraw_test.go.html#6849443">tt</a></span><span class="op" id="6849503">.</span><span class="ident" id="6849504">net</span><span class="op" id="6849507">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849511">if</span>&nbsp;<span class="ident" id="6849514"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6849518">!=</span>&nbsp;<span class="ident" id="6849521">nil</span>&nbsp;<span class="op" id="6849525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849530"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6849531">.</span><span class="ident" id="6849532">Fatalf</span><span class="op" id="6849538">(</span><span class="string" id="6849539">&#34;parseNetwork&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6849564">,</span>&nbsp;<span class="ident" id="6849566"><a href="/net/ipraw_test.go.html#6849481">err</a></span><span class="op" id="6849569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849577">if</span>&nbsp;<span class="ident" id="6849580"><a href="/net/ipraw_test.go.html#6849473">net</a></span>&nbsp;<span class="op" id="6849584">==</span>&nbsp;<span class="string" id="6849587">&#34;ip6&#34;</span>&nbsp;<span class="op" id="6849593">&amp;&amp;</span>&nbsp;<span class="op" id="6849596">!</span><span class="ident" id="6849597"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6849610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849615">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849631">c</span><span class="op" id="6849632">,</span>&nbsp;<span class="ident" id="6849634"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6849638">:=</span>&nbsp;<span class="ident" id="6849641"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6849653">(</span><span class="ident" id="6849654"><a href="/net/ipraw_test.go.html#6849443">tt</a></span><span class="op" id="6849656">.</span><span class="ident" id="6849657">net</span><span class="op" id="6849660">,</span>&nbsp;<span class="ident" id="6849662"><a href="/net/ipraw_test.go.html#6849443">tt</a></span><span class="op" id="6849664">.</span><span class="ident" id="6849665">laddr</span><span class="op" id="6849670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849674">if</span>&nbsp;<span class="ident" id="6849677"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6849681">!=</span>&nbsp;<span class="ident" id="6849684">nil</span>&nbsp;<span class="op" id="6849688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849693"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6849694">.</span><span class="ident" id="6849695">Fatalf</span><span class="op" id="6849701">(</span><span class="string" id="6849702">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6849727">,</span>&nbsp;<span class="ident" id="6849729"><a href="/net/ipraw_test.go.html#6849481">err</a></span><span class="op" id="6849732">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849740"><a href="/net/ipraw_test.go.html#6849631">c</a></span><span class="op" id="6849741">.</span><span class="ident" id="6849742">SetDeadline</span><span class="op" id="6849753">(</span><span class="ident" id="6849754"><a href="/net/ipraw_test.go.html#6845151">time</a></span><span class="op" id="6849758">.</span><span class="ident" id="6849759">Now</span><span class="op" id="6849762">(</span><span class="op" id="6849763">)</span><span class="op" id="6849764">.</span><span class="ident" id="6849765">Add</span><span class="op" id="6849768">(</span><span class="num" id="6849769">100</span>&nbsp;<span class="op" id="6849773">*</span>&nbsp;<span class="ident" id="6849775"><a href="/net/ipraw_test.go.html#6845151">time</a></span><span class="op" id="6849779">.</span><span class="ident" id="6849780">Millisecond</span><span class="op" id="6849791">)</span><span class="op" id="6849792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849796">defer</span>&nbsp;<span class="ident" id="6849802"><a href="/net/ipraw_test.go.html#6849631">c</a></span><span class="op" id="6849803">.</span><span class="ident" id="6849804">Close</span><span class="op" id="6849809">(</span><span class="op" id="6849810">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849815">ra</span><span class="op" id="6849817">,</span>&nbsp;<span class="ident" id="6849819"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6849823">:=</span>&nbsp;<span class="ident" id="6849826"><a href="/net/iprawsock.go.html#2619766">ResolveIPAddr</a></span><span class="op" id="6849839">(</span><span class="ident" id="6849840"><a href="/net/ipraw_test.go.html#6849443">tt</a></span><span class="op" id="6849842">.</span><span class="ident" id="6849843">net</span><span class="op" id="6849846">,</span>&nbsp;<span class="ident" id="6849848"><a href="/net/ipraw_test.go.html#6849443">tt</a></span><span class="op" id="6849850">.</span><span class="ident" id="6849851">raddr</span><span class="op" id="6849856">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849860">if</span>&nbsp;<span class="ident" id="6849863"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6849867">!=</span>&nbsp;<span class="ident" id="6849870">nil</span>&nbsp;<span class="op" id="6849874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849879"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6849880">.</span><span class="ident" id="6849881">Fatalf</span><span class="op" id="6849887">(</span><span class="string" id="6849888">&#34;ResolveIPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6849914">,</span>&nbsp;<span class="ident" id="6849916"><a href="/net/ipraw_test.go.html#6849481">err</a></span><span class="op" id="6849919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6849923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849927">typ</span>&nbsp;<span class="op" id="6849931">:=</span>&nbsp;<span class="ident" id="6849934"><a href="/net/mockicmp_test.go.html#6863993">icmpv4EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6849954">if</span>&nbsp;<span class="ident" id="6849957"><a href="/net/ipraw_test.go.html#6849473">net</a></span>&nbsp;<span class="op" id="6849961">==</span>&nbsp;<span class="string" id="6849964">&#34;ip6&#34;</span>&nbsp;<span class="op" id="6849970">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6849975"><a href="/net/ipraw_test.go.html#6849927">typ</a></span>&nbsp;<span class="op" id="6849979">=</span>&nbsp;<span class="ident" id="6849981"><a href="/net/mockicmp_test.go.html#6864039">icmpv6EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850005">xid</span><span class="op" id="6850008">,</span>&nbsp;<span class="ident" id="6850010">xseq</span>&nbsp;<span class="op" id="6850015">:=</span>&nbsp;<span class="ident" id="6850018"><a href="/net/ipraw_test.go.html#6845112">os</a></span><span class="op" id="6850020">.</span><span class="ident" id="6850021">Getpid</span><span class="op" id="6850027">(</span><span class="op" id="6850028">)</span><span class="op" id="6850029">&amp;</span><span class="num" id="6850030">0xffff</span><span class="op" id="6850036">,</span>&nbsp;<span class="ident" id="6850038"><a href="/net/ipraw_test.go.html#6849440">i</a></span><span class="op" id="6850039">+</span><span class="num" id="6850040">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850044">wb</span><span class="op" id="6850046">,</span>&nbsp;<span class="ident" id="6850048"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6850052">:=</span>&nbsp;<span class="op" id="6850055">(</span><span class="op" id="6850056">&amp;</span><span class="ident" id="6850057"><a href="/net/mockicmp_test.go.html#6864139">icmpMessage</a></span><span class="op" id="6850068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850073">Type</span><span class="op" id="6850077">:</span>&nbsp;<span class="ident" id="6850079"><a href="/net/ipraw_test.go.html#6849927">typ</a></span><span class="op" id="6850082">,</span>&nbsp;<span class="ident" id="6850084">Code</span><span class="op" id="6850088">:</span>&nbsp;<span class="num" id="6850090">0</span><span class="op" id="6850091">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850096">Body</span><span class="op" id="6850100">:</span>&nbsp;<span class="op" id="6850102">&amp;</span><span class="ident" id="6850103"><a href="/net/mockicmp_test.go.html#6865797">icmpEcho</a></span><span class="op" id="6850111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850117">ID</span><span class="op" id="6850119">:</span>&nbsp;<span class="ident" id="6850121"><a href="/net/ipraw_test.go.html#6850005">xid</a></span><span class="op" id="6850124">,</span>&nbsp;<span class="ident" id="6850126">Seq</span><span class="op" id="6850129">:</span>&nbsp;<span class="ident" id="6850131"><a href="/net/ipraw_test.go.html#6850010">xseq</a></span><span class="op" id="6850135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850141">Data</span><span class="op" id="6850145">:</span>&nbsp;<span class="ident" id="6850147"><a href="/net/ipraw_test.go.html#6845096">bytes</a></span><span class="op" id="6850152">.</span><span class="ident" id="6850153">Repeat</span><span class="op" id="6850159">(</span><span class="op" id="6850160">[</span><span class="op" id="6850161">]</span><span class="builtintype" id="6850162">byte</span><span class="op" id="6850166">(</span><span class="string" id="6850167">&#34;Go&nbsp;Go&nbsp;Gadget&nbsp;Ping!!!&#34;</span><span class="op" id="6850189">)</span><span class="op" id="6850190">,</span>&nbsp;<span class="num" id="6850192">3</span><span class="op" id="6850193">)</span><span class="op" id="6850194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850199">}</span><span class="op" id="6850200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850204">}</span><span class="op" id="6850205">)</span><span class="op" id="6850206">.</span><span class="ident" id="6850207">Marshal</span><span class="op" id="6850214">(</span><span class="op" id="6850215">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850219">if</span>&nbsp;<span class="ident" id="6850222"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6850226">!=</span>&nbsp;<span class="ident" id="6850229">nil</span>&nbsp;<span class="op" id="6850233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850238"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6850239">.</span><span class="ident" id="6850240">Fatalf</span><span class="op" id="6850246">(</span><span class="string" id="6850247">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6850279">,</span>&nbsp;<span class="ident" id="6850281"><a href="/net/ipraw_test.go.html#6849481">err</a></span><span class="op" id="6850284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850292">if</span>&nbsp;<span class="ident" id="6850295">_</span><span class="op" id="6850296">,</span>&nbsp;<span class="ident" id="6850298">err</span>&nbsp;<span class="op" id="6850302">:=</span>&nbsp;<span class="ident" id="6850305"><a href="/net/ipraw_test.go.html#6849631">c</a></span><span class="op" id="6850306">.</span><span class="ident" id="6850307">WriteTo</span><span class="op" id="6850314">(</span><span class="ident" id="6850315"><a href="/net/ipraw_test.go.html#6850044">wb</a></span><span class="op" id="6850317">,</span>&nbsp;<span class="ident" id="6850319"><a href="/net/ipraw_test.go.html#6849815">ra</a></span><span class="op" id="6850321">)</span><span class="op" id="6850322">;</span>&nbsp;<span class="ident" id="6850324"><a href="/net/ipraw_test.go.html#6850298">err</a></span>&nbsp;<span class="op" id="6850328">!=</span>&nbsp;<span class="ident" id="6850331">nil</span>&nbsp;<span class="op" id="6850335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850340"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6850341">.</span><span class="ident" id="6850342">Fatalf</span><span class="op" id="6850348">(</span><span class="string" id="6850349">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6850380">,</span>&nbsp;<span class="ident" id="6850382"><a href="/net/ipraw_test.go.html#6850298">err</a></span><span class="op" id="6850385">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850393">var</span>&nbsp;<span class="ident" id="6850397">m</span>&nbsp;<span class="op" id="6850399">*</span><span class="ident" id="6850400"><a href="/net/mockicmp_test.go.html#6864139">icmpMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850414">rb</span>&nbsp;<span class="op" id="6850417">:=</span>&nbsp;<span class="builtinfunc" id="6850420">make</span><span class="op" id="6850424">(</span><span class="op" id="6850425">[</span><span class="op" id="6850426">]</span><span class="builtintype" id="6850427">byte</span><span class="op" id="6850431">,</span>&nbsp;<span class="num" id="6850433">20</span><span class="op" id="6850435">+</span><span class="builtinfunc" id="6850436">len</span><span class="op" id="6850439">(</span><span class="ident" id="6850440"><a href="/net/ipraw_test.go.html#6850044">wb</a></span><span class="op" id="6850442">)</span><span class="op" id="6850443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850447">for</span>&nbsp;<span class="op" id="6850451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850456">if</span>&nbsp;<span class="ident" id="6850459">_</span><span class="op" id="6850460">,</span>&nbsp;<span class="ident" id="6850462">_</span><span class="op" id="6850463">,</span>&nbsp;<span class="ident" id="6850465">err</span>&nbsp;<span class="op" id="6850469">:=</span>&nbsp;<span class="ident" id="6850472"><a href="/net/ipraw_test.go.html#6849631">c</a></span><span class="op" id="6850473">.</span><span class="ident" id="6850474">ReadFrom</span><span class="op" id="6850482">(</span><span class="ident" id="6850483"><a href="/net/ipraw_test.go.html#6850414">rb</a></span><span class="op" id="6850485">)</span><span class="op" id="6850486">;</span>&nbsp;<span class="ident" id="6850488"><a href="/net/ipraw_test.go.html#6850465">err</a></span>&nbsp;<span class="op" id="6850492">!=</span>&nbsp;<span class="ident" id="6850495">nil</span>&nbsp;<span class="op" id="6850499">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850505"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6850506">.</span><span class="ident" id="6850507">Fatalf</span><span class="op" id="6850513">(</span><span class="string" id="6850514">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6850546">,</span>&nbsp;<span class="ident" id="6850548"><a href="/net/ipraw_test.go.html#6850465">err</a></span><span class="op" id="6850551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6850561">//&nbsp;See&nbsp;BUG&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6850584">//if&nbsp;net&nbsp;==&nbsp;&#34;ip4&#34;&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6850607">//&nbsp;&nbsp;&nbsp;&nbsprb&nbsp;=&nbsp;ipv4Payload(rb)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6850634">//}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850641">if</span>&nbsp;<span class="ident" id="6850644"><a href="/net/ipraw_test.go.html#6850397">m</a></span><span class="op" id="6850645">,</span>&nbsp;<span class="ident" id="6850647"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6850651">=</span>&nbsp;<span class="ident" id="6850653"><a href="/net/mockicmp_test.go.html#6865263">parseICMPMessage</a></span><span class="op" id="6850669">(</span><span class="ident" id="6850670"><a href="/net/ipraw_test.go.html#6850414">rb</a></span><span class="op" id="6850672">)</span><span class="op" id="6850673">;</span>&nbsp;<span class="ident" id="6850675"><a href="/net/ipraw_test.go.html#6849481">err</a></span>&nbsp;<span class="op" id="6850679">!=</span>&nbsp;<span class="ident" id="6850682">nil</span>&nbsp;<span class="op" id="6850686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850692"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6850693">.</span><span class="ident" id="6850694">Fatalf</span><span class="op" id="6850700">(</span><span class="string" id="6850701">&#34;parseICMPMessage&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6850730">,</span>&nbsp;<span class="ident" id="6850732"><a href="/net/ipraw_test.go.html#6849481">err</a></span><span class="op" id="6850735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850745">switch</span>&nbsp;<span class="ident" id="6850752"><a href="/net/ipraw_test.go.html#6850397">m</a></span><span class="op" id="6850753">.</span><span class="ident" id="6850754">Type</span>&nbsp;<span class="op" id="6850759">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850764">case</span>&nbsp;<span class="ident" id="6850769"><a href="/net/mockicmp_test.go.html#6863993">icmpv4EchoRequest</a></span><span class="op" id="6850786">,</span>&nbsp;<span class="ident" id="6850788"><a href="/net/mockicmp_test.go.html#6864039">icmpv6EchoRequest</a></span><span class="op" id="6850805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850811">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6850836">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850840">switch</span>&nbsp;<span class="ident" id="6850847">p</span>&nbsp;<span class="op" id="6850849">:=</span>&nbsp;<span class="ident" id="6850852"><a href="/net/ipraw_test.go.html#6850397">m</a></span><span class="op" id="6850853">.</span><span class="ident" id="6850854">Body</span><span class="op" id="6850858">.</span><span class="op" id="6850859">(</span><span class="keyword" id="6850860">type</span><span class="op" id="6850864">)</span>&nbsp;<span class="op" id="6850866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850870">case</span>&nbsp;<span class="op" id="6850875">*</span><span class="ident" id="6850876"><a href="/net/mockicmp_test.go.html#6865797">icmpEcho</a></span><span class="op" id="6850884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6850889">if</span>&nbsp;<span class="ident" id="6850892"><a href="/net/ipraw_test.go.html#6850847">p</a></span><span class="op" id="6850893">.</span><span class="ident" id="6850894">ID</span>&nbsp;<span class="op" id="6850897">!=</span>&nbsp;<span class="ident" id="6850900"><a href="/net/ipraw_test.go.html#6850005">xid</a></span>&nbsp;<span class="op" id="6850904">||</span>&nbsp;<span class="ident" id="6850907"><a href="/net/ipraw_test.go.html#6850847">p</a></span><span class="op" id="6850908">.</span><span class="ident" id="6850909">Seq</span>&nbsp;<span class="op" id="6850913">!=</span>&nbsp;<span class="ident" id="6850916"><a href="/net/ipraw_test.go.html#6850010">xseq</a></span>&nbsp;<span class="op" id="6850921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6850927"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6850928">.</span><span class="ident" id="6850929">Fatalf</span><span class="op" id="6850935">(</span><span class="string" id="6850936">&#34;got&nbsp;id=%v,&nbsp;seqnum=%v;&nbsp;expected&nbsp;id=%v,&nbsp;seqnum=%v&#34;</span><span class="op" id="6850985">,</span>&nbsp;<span class="ident" id="6850987"><a href="/net/ipraw_test.go.html#6850847">p</a></span><span class="op" id="6850988">.</span><span class="ident" id="6850989">ID</span><span class="op" id="6850991">,</span>&nbsp;<span class="ident" id="6850993"><a href="/net/ipraw_test.go.html#6850847">p</a></span><span class="op" id="6850994">.</span><span class="ident" id="6850995">Seq</span><span class="op" id="6850998">,</span>&nbsp;<span class="ident" id="6851000"><a href="/net/ipraw_test.go.html#6850005">xid</a></span><span class="op" id="6851003">,</span>&nbsp;<span class="ident" id="6851005"><a href="/net/ipraw_test.go.html#6850010">xseq</a></span><span class="op" id="6851009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851014">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851018">default</span><span class="op" id="6851025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851030"><a href="/net/ipraw_test.go.html#6849347">t</a></span><span class="op" id="6851031">.</span><span class="ident" id="6851032">Fatalf</span><span class="op" id="6851038">(</span><span class="string" id="6851039">&#34;got&nbsp;type=%v,&nbsp;code=%v;&nbsp;expected&nbsp;type=%v,&nbsp;code=%v&#34;</span><span class="op" id="6851088">,</span>&nbsp;<span class="ident" id="6851090"><a href="/net/ipraw_test.go.html#6850397">m</a></span><span class="op" id="6851091">.</span><span class="ident" id="6851092">Type</span><span class="op" id="6851096">,</span>&nbsp;<span class="ident" id="6851098"><a href="/net/ipraw_test.go.html#6850397">m</a></span><span class="op" id="6851099">.</span><span class="ident" id="6851100">Code</span><span class="op" id="6851104">,</span>&nbsp;<span class="ident" id="6851106"><a href="/net/ipraw_test.go.html#6849927">typ</a></span><span class="op" id="6851109">,</span>&nbsp;<span class="num" id="6851111">0</span><span class="op" id="6851112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851119">}</span><br>
<span class="lineno"></span><span class="op" id="6851121">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="6851124">func</span>&nbsp;<span class="ident" id="6851129">ipv4Payload</span><span class="op" id="6851140">(</span><span class="ident" id="6851141">b</span>&nbsp;<span class="op" id="6851143">[</span><span class="op" id="6851144">]</span><span class="builtintype" id="6851145">byte</span><span class="op" id="6851149">)</span>&nbsp;<span class="op" id="6851151">[</span><span class="op" id="6851152">]</span><span class="builtintype" id="6851153">byte</span>&nbsp;<span class="op" id="6851158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851161">if</span>&nbsp;<span class="builtinfunc" id="6851164">len</span><span class="op" id="6851167">(</span><span class="ident" id="6851168"><a href="/net/ipraw_test.go.html#6851141">b</a></span><span class="op" id="6851169">)</span>&nbsp;<span class="op" id="6851171">&lt;</span>&nbsp;<span class="num" id="6851173">20</span>&nbsp;<span class="op" id="6851176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851180">return</span>&nbsp;<span class="ident" id="6851187"><a href="/net/ipraw_test.go.html#6851141">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851190">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851193">hdrlen</span>&nbsp;<span class="op" id="6851200">:=</span>&nbsp;<span class="builtintype" id="6851203">int</span><span class="op" id="6851206">(</span><span class="ident" id="6851207"><a href="/net/ipraw_test.go.html#6851141">b</a></span><span class="op" id="6851208">[</span><span class="num" id="6851209">0</span><span class="op" id="6851210">]</span><span class="op" id="6851211">&amp;</span><span class="num" id="6851212">0x0f</span><span class="op" id="6851216">)</span>&nbsp;<span class="op" id="6851218">&lt;&lt;</span>&nbsp;<span class="num" id="6851221">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851224">return</span>&nbsp;<span class="ident" id="6851231"><a href="/net/ipraw_test.go.html#6851141">b</a></span><span class="op" id="6851232">[</span><span class="ident" id="6851233"><a href="/net/ipraw_test.go.html#6851193">hdrlen</a></span><span class="op" id="6851239">:</span><span class="op" id="6851240">]</span><br>
<span class="lineno"></span><span class="op" id="6851242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6851245">var</span>&nbsp;<span class="ident" id="6851249">ipConnLocalNameTests</span>&nbsp;<span class="op" id="6851270">=</span>&nbsp;<span class="op" id="6851272">[</span><span class="op" id="6851273">]</span><span class="keyword" id="6851274">struct</span>&nbsp;<span class="op" id="6851281">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851284">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6851290">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851298">laddr</span>&nbsp;<span class="op" id="6851304">*</span><span class="ident" id="6851305"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><br>
<span class="lineno"></span><span class="op" id="6851312">}</span><span class="op" id="6851313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851316">{</span><span class="string" id="6851317">&#34;ip4:icmp&#34;</span><span class="op" id="6851327">,</span>&nbsp;<span class="op" id="6851329">&amp;</span><span class="ident" id="6851330"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6851336">{</span><span class="ident" id="6851337">IP</span><span class="op" id="6851339">:</span>&nbsp;<span class="ident" id="6851341"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6851345">(</span><span class="num" id="6851346">127</span><span class="op" id="6851349">,</span>&nbsp;<span class="num" id="6851351">0</span><span class="op" id="6851352">,</span>&nbsp;<span class="num" id="6851354">0</span><span class="op" id="6851355">,</span>&nbsp;<span class="num" id="6851357">1</span><span class="op" id="6851358">)</span><span class="op" id="6851359">}</span><span class="op" id="6851360">}</span><span class="op" id="6851361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851364">{</span><span class="string" id="6851365">&#34;ip4:icmp&#34;</span><span class="op" id="6851375">,</span>&nbsp;<span class="op" id="6851377">&amp;</span><span class="ident" id="6851378"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6851384">{</span><span class="op" id="6851385">}</span><span class="op" id="6851386">}</span><span class="op" id="6851387">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851390">{</span><span class="string" id="6851391">&#34;ip4:icmp&#34;</span><span class="op" id="6851401">,</span>&nbsp;<span class="ident" id="6851403">nil</span><span class="op" id="6851406">}</span><span class="op" id="6851407">,</span><br>
<span class="lineno"></span><span class="op" id="6851409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6851412">func</span>&nbsp;<span class="ident" id="6851417">TestIPConnLocalName</span><span class="op" id="6851436">(</span><span class="ident" id="6851437">t</span>&nbsp;<span class="op" id="6851439">*</span><span class="ident" id="6851440"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6851447">.</span><span class="ident" id="6851448">T</span><span class="op" id="6851449">)</span>&nbsp;<span class="op" id="6851451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851454">switch</span>&nbsp;<span class="ident" id="6851461"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6851468">.</span><span class="ident" id="6851469">GOOS</span>&nbsp;<span class="op" id="6851474">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851477">case</span>&nbsp;<span class="string" id="6851482">&#34;nacl&#34;</span><span class="op" id="6851488">,</span>&nbsp;<span class="string" id="6851490">&#34;plan9&#34;</span><span class="op" id="6851497">,</span>&nbsp;<span class="string" id="6851499">&#34;windows&#34;</span><span class="op" id="6851508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851512"><a href="/net/ipraw_test.go.html#6851437">t</a></span><span class="op" id="6851513">.</span><span class="ident" id="6851514">Skipf</span><span class="op" id="6851519">(</span><span class="string" id="6851520">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6851541">,</span>&nbsp;<span class="ident" id="6851543"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6851550">.</span><span class="ident" id="6851551">GOOS</span><span class="op" id="6851555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851558">default</span><span class="op" id="6851565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851569">if</span>&nbsp;<span class="ident" id="6851572"><a href="/net/ipraw_test.go.html#6845112">os</a></span><span class="op" id="6851574">.</span><span class="ident" id="6851575">Getuid</span><span class="op" id="6851581">(</span><span class="op" id="6851582">)</span>&nbsp;<span class="op" id="6851584">!=</span>&nbsp;<span class="num" id="6851587">0</span>&nbsp;<span class="op" id="6851589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851594"><a href="/net/ipraw_test.go.html#6851437">t</a></span><span class="op" id="6851595">.</span><span class="ident" id="6851596">Skip</span><span class="op" id="6851600">(</span><span class="string" id="6851601">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6851630">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851641">for</span>&nbsp;<span class="ident" id="6851645">_</span><span class="op" id="6851646">,</span>&nbsp;<span class="ident" id="6851648">tt</span>&nbsp;<span class="op" id="6851651">:=</span>&nbsp;<span class="keyword" id="6851654">range</span>&nbsp;<span class="ident" id="6851660"><a href="/net/ipraw_test.go.html#6851249">ipConnLocalNameTests</a></span>&nbsp;<span class="op" id="6851681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851685">c</span><span class="op" id="6851686">,</span>&nbsp;<span class="ident" id="6851688">err</span>&nbsp;<span class="op" id="6851692">:=</span>&nbsp;<span class="ident" id="6851695"><a href="/net/iprawsock_posix.go.html#2626755">ListenIP</a></span><span class="op" id="6851703">(</span><span class="ident" id="6851704"><a href="/net/ipraw_test.go.html#6851648">tt</a></span><span class="op" id="6851706">.</span><span class="ident" id="6851707">net</span><span class="op" id="6851710">,</span>&nbsp;<span class="ident" id="6851712"><a href="/net/ipraw_test.go.html#6851648">tt</a></span><span class="op" id="6851714">.</span><span class="ident" id="6851715">laddr</span><span class="op" id="6851720">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851724">if</span>&nbsp;<span class="ident" id="6851727"><a href="/net/ipraw_test.go.html#6851688">err</a></span>&nbsp;<span class="op" id="6851731">!=</span>&nbsp;<span class="ident" id="6851734">nil</span>&nbsp;<span class="op" id="6851738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851743"><a href="/net/ipraw_test.go.html#6851437">t</a></span><span class="op" id="6851744">.</span><span class="ident" id="6851745">Fatalf</span><span class="op" id="6851751">(</span><span class="string" id="6851752">&#34;ListenIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6851773">,</span>&nbsp;<span class="ident" id="6851775"><a href="/net/ipraw_test.go.html#6851688">err</a></span><span class="op" id="6851778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851786">defer</span>&nbsp;<span class="ident" id="6851792"><a href="/net/ipraw_test.go.html#6851685">c</a></span><span class="op" id="6851793">.</span><span class="ident" id="6851794">Close</span><span class="op" id="6851799">(</span><span class="op" id="6851800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851804">if</span>&nbsp;<span class="ident" id="6851807">la</span>&nbsp;<span class="op" id="6851810">:=</span>&nbsp;<span class="ident" id="6851813"><a href="/net/ipraw_test.go.html#6851685">c</a></span><span class="op" id="6851814">.</span><span class="ident" id="6851815">LocalAddr</span><span class="op" id="6851824">(</span><span class="op" id="6851825">)</span><span class="op" id="6851826">;</span>&nbsp;<span class="ident" id="6851828"><a href="/net/ipraw_test.go.html#6851807">la</a></span>&nbsp;<span class="op" id="6851831">==</span>&nbsp;<span class="ident" id="6851834">nil</span>&nbsp;<span class="op" id="6851838">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851843"><a href="/net/ipraw_test.go.html#6851437">t</a></span><span class="op" id="6851844">.</span><span class="ident" id="6851845">Fatal</span><span class="op" id="6851850">(</span><span class="string" id="6851851">&#34;IPConn.LocalAddr&nbsp;failed&#34;</span><span class="op" id="6851876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6851883">}</span><br>
<span class="lineno"></span><span class="op" id="6851885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="6851888">func</span>&nbsp;<span class="ident" id="6851893">TestIPConnRemoteName</span><span class="op" id="6851913">(</span><span class="ident" id="6851914">t</span>&nbsp;<span class="op" id="6851916">*</span><span class="ident" id="6851917"><a href="/net/ipraw_test.go.html#6845140">testing</a></span><span class="op" id="6851924">.</span><span class="ident" id="6851925">T</span><span class="op" id="6851926">)</span>&nbsp;<span class="op" id="6851928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851931">switch</span>&nbsp;<span class="ident" id="6851938"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6851945">.</span><span class="ident" id="6851946">GOOS</span>&nbsp;<span class="op" id="6851951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6851954">case</span>&nbsp;<span class="string" id="6851959">&#34;plan9&#34;</span><span class="op" id="6851966">,</span>&nbsp;<span class="string" id="6851968">&#34;windows&#34;</span><span class="op" id="6851977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6851981"><a href="/net/ipraw_test.go.html#6851914">t</a></span><span class="op" id="6851982">.</span><span class="ident" id="6851983">Skipf</span><span class="op" id="6851988">(</span><span class="string" id="6851989">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6852010">,</span>&nbsp;<span class="ident" id="6852012"><a href="/net/ipraw_test.go.html#6845129">runtime</a></span><span class="op" id="6852019">.</span><span class="ident" id="6852020">GOOS</span><span class="op" id="6852024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6852027">default</span><span class="op" id="6852034">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6852038">if</span>&nbsp;<span class="ident" id="6852041"><a href="/net/ipraw_test.go.html#6845112">os</a></span><span class="op" id="6852043">.</span><span class="ident" id="6852044">Getuid</span><span class="op" id="6852050">(</span><span class="op" id="6852051">)</span>&nbsp;<span class="op" id="6852053">!=</span>&nbsp;<span class="num" id="6852056">0</span>&nbsp;<span class="op" id="6852058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6852063"><a href="/net/ipraw_test.go.html#6851914">t</a></span><span class="op" id="6852064">.</span><span class="ident" id="6852065">Skip</span><span class="op" id="6852069">(</span><span class="string" id="6852070">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6852099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6852103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6852106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6852110">raddr</span>&nbsp;<span class="op" id="6852116">:=</span>&nbsp;<span class="op" id="6852119">&amp;</span><span class="ident" id="6852120"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6852126">{</span><span class="ident" id="6852127">IP</span><span class="op" id="6852129">:</span>&nbsp;<span class="ident" id="6852131"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6852135">(</span><span class="num" id="6852136">127</span><span class="op" id="6852139">,</span>&nbsp;<span class="num" id="6852141">0</span><span class="op" id="6852142">,</span>&nbsp;<span class="num" id="6852144">0</span><span class="op" id="6852145">,</span>&nbsp;<span class="num" id="6852147">1</span><span class="op" id="6852148">)</span><span class="op" id="6852149">.</span><span class="ident" id="6852150">To4</span><span class="op" id="6852153">(</span><span class="op" id="6852154">)</span><span class="op" id="6852155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6852158">c</span><span class="op" id="6852159">,</span>&nbsp;<span class="ident" id="6852161">err</span>&nbsp;<span class="op" id="6852165">:=</span>&nbsp;<span class="ident" id="6852168"><a href="/net/iprawsock_posix.go.html#2625716">DialIP</a></span><span class="op" id="6852174">(</span><span class="string" id="6852175">&#34;ip:tcp&#34;</span><span class="op" id="6852183">,</span>&nbsp;<span class="op" id="6852185">&amp;</span><span class="ident" id="6852186"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6852192">{</span><span class="ident" id="6852193">IP</span><span class="op" id="6852195">:</span>&nbsp;<span class="ident" id="6852197"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6852201">(</span><span class="num" id="6852202">127</span><span class="op" id="6852205">,</span>&nbsp;<span class="num" id="6852207">0</span><span class="op" id="6852208">,</span>&nbsp;<span class="num" id="6852210">0</span><span class="op" id="6852211">,</span>&nbsp;<span class="num" id="6852213">1</span><span class="op" id="6852214">)</span><span class="op" id="6852215">}</span><span class="op" id="6852216">,</span>&nbsp;<span class="ident" id="6852218"><a href="/net/ipraw_test.go.html#6852110">raddr</a></span><span class="op" id="6852223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6852226">if</span>&nbsp;<span class="ident" id="6852229"><a href="/net/ipraw_test.go.html#6852161">err</a></span>&nbsp;<span class="op" id="6852233">!=</span>&nbsp;<span class="ident" id="6852236">nil</span>&nbsp;<span class="op" id="6852240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6852244"><a href="/net/ipraw_test.go.html#6851914">t</a></span><span class="op" id="6852245">.</span><span class="ident" id="6852246">Fatalf</span><span class="op" id="6852252">(</span><span class="string" id="6852253">&#34;DialIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6852272">,</span>&nbsp;<span class="ident" id="6852274"><a href="/net/ipraw_test.go.html#6852161">err</a></span><span class="op" id="6852277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6852280">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6852283">defer</span>&nbsp;<span class="ident" id="6852289"><a href="/net/ipraw_test.go.html#6852158">c</a></span><span class="op" id="6852290">.</span><span class="ident" id="6852291">Close</span><span class="op" id="6852296">(</span><span class="op" id="6852297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6852300">if</span>&nbsp;<span class="op" id="6852303">!</span><span class="ident" id="6852304"><a href="/net/ipraw_test.go.html#6845118">reflect</a></span><span class="op" id="6852311">.</span><span class="ident" id="6852312">DeepEqual</span><span class="op" id="6852321">(</span><span class="ident" id="6852322"><a href="/net/ipraw_test.go.html#6852110">raddr</a></span><span class="op" id="6852327">,</span>&nbsp;<span class="ident" id="6852329"><a href="/net/ipraw_test.go.html#6852158">c</a></span><span class="op" id="6852330">.</span><span class="ident" id="6852331">RemoteAddr</span><span class="op" id="6852341">(</span><span class="op" id="6852342">)</span><span class="op" id="6852343">)</span>&nbsp;<span class="op" id="6852345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6852349"><a href="/net/ipraw_test.go.html#6851914">t</a></span><span class="op" id="6852350">.</span><span class="ident" id="6852351">Fatalf</span><span class="op" id="6852357">(</span><span class="string" id="6852358">&#34;got&nbsp;%#v,&nbsp;expected&nbsp;%#v&#34;</span><span class="op" id="6852381">,</span>&nbsp;<span class="ident" id="6852383"><a href="/net/ipraw_test.go.html#6852158">c</a></span><span class="op" id="6852384">.</span><span class="ident" id="6852385">RemoteAddr</span><span class="op" id="6852395">(</span><span class="op" id="6852396">)</span><span class="op" id="6852397">,</span>&nbsp;<span class="ident" id="6852399"><a href="/net/ipraw_test.go.html#6852110">raddr</a></span><span class="op" id="6852404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6852407">}</span><br>
<span class="lineno"></span><span class="op" id="6852409">}</span>
</div>
</body>
</html>
