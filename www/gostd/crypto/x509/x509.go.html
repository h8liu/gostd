<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3971311">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3971366">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3971420">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3971471">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="3971531">package</span>&nbsp;<span class="ident" id="3971539">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971545">import</span>&nbsp;<span class="op" id="3971552">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971555">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971564">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971574">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971588">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971604">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971623">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971637">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971652">_</span>&nbsp;<span class="string" id="3971654">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971671">_</span>&nbsp;<span class="string" id="3971673">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971690">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971710">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971727">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971743">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971753">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971759">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971771">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971778">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971789">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3971796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3971799">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="3971879">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="3971895">type</span>&nbsp;<span class="ident" id="3971900">pkixPublicKey</span>&nbsp;<span class="keyword" id="3971914">struct</span>&nbsp;<span class="op" id="3971921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971924">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971934">pkix</span><span class="op" id="3971938">.</span><span class="ident" id="3971939">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971960">BitString</span>&nbsp;<span class="ident" id="3971970">asn1</span><span class="op" id="3971974">.</span><span class="ident" id="3971975">BitString</span><br>
<span class="lineno"></span><span class="op" id="3971985">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3971988">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3972060">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3972118">func</span>&nbsp;<span class="ident" id="3972123">ParsePKIXPublicKey</span><span class="op" id="3972141">(</span><span class="ident" id="3972142">derBytes</span>&nbsp;<span class="op" id="3972151">[</span><span class="op" id="3972152">]</span><span class="builtintype" id="3972153">byte</span><span class="op" id="3972157">)</span>&nbsp;<span class="op" id="3972159">(</span><span class="ident" id="3972160">pub</span>&nbsp;<span class="keyword" id="3972164">interface</span><span class="op" id="3972173">{</span><span class="op" id="3972174">}</span><span class="op" id="3972175">,</span>&nbsp;<span class="ident" id="3972177">err</span>&nbsp;<span class="builtintype" id="3972181">error</span><span class="op" id="3972186">)</span>&nbsp;<span class="op" id="3972188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972191">var</span>&nbsp;<span class="ident" id="3972195">pki</span>&nbsp;<span class="ident" id="3972199">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972214">if</span>&nbsp;<span class="ident" id="3972217">_</span><span class="op" id="3972218">,</span>&nbsp;<span class="ident" id="3972220">err</span>&nbsp;<span class="op" id="3972224">=</span>&nbsp;<span class="ident" id="3972226">asn1</span><span class="op" id="3972230">.</span><span class="ident" id="3972231">Unmarshal</span><span class="op" id="3972240">(</span><span class="ident" id="3972241">derBytes</span><span class="op" id="3972249">,</span>&nbsp;<span class="op" id="3972251">&amp;</span><span class="ident" id="3972252">pki</span><span class="op" id="3972255">)</span><span class="op" id="3972256">;</span>&nbsp;<span class="ident" id="3972258">err</span>&nbsp;<span class="op" id="3972262">!=</span>&nbsp;<span class="ident" id="3972265">nil</span>&nbsp;<span class="op" id="3972269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972273">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972284">algo</span>&nbsp;<span class="op" id="3972289">:=</span>&nbsp;<span class="ident" id="3972292">getPublicKeyAlgorithmFromOID</span><span class="op" id="3972320">(</span><span class="ident" id="3972321">pki</span><span class="op" id="3972324">.</span><span class="ident" id="3972325">Algorithm</span><span class="op" id="3972334">.</span><span class="ident" id="3972335">Algorithm</span><span class="op" id="3972344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972347">if</span>&nbsp;<span class="ident" id="3972350">algo</span>&nbsp;<span class="op" id="3972355">==</span>&nbsp;<span class="ident" id="3972358">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3972384">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972388">return</span>&nbsp;<span class="ident" id="3972395">nil</span><span class="op" id="3972398">,</span>&nbsp;<span class="ident" id="3972400">errors</span><span class="op" id="3972406">.</span><span class="ident" id="3972407">New</span><span class="op" id="3972410">(</span><span class="string" id="3972411">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="3972447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972453">return</span>&nbsp;<span class="ident" id="3972460">parsePublicKey</span><span class="op" id="3972474">(</span><span class="ident" id="3972475">algo</span><span class="op" id="3972479">,</span>&nbsp;<span class="op" id="3972481">&amp;</span><span class="ident" id="3972482">pki</span><span class="op" id="3972485">)</span><br>
<span class="lineno"></span><span class="op" id="3972487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3972490">func</span>&nbsp;<span class="ident" id="3972495">marshalPublicKey</span><span class="op" id="3972511">(</span><span class="ident" id="3972512">pub</span>&nbsp;<span class="keyword" id="3972516">interface</span><span class="op" id="3972525">{</span><span class="op" id="3972526">}</span><span class="op" id="3972527">)</span>&nbsp;<span class="op" id="3972529">(</span><span class="ident" id="3972530">publicKeyBytes</span>&nbsp;<span class="op" id="3972545">[</span><span class="op" id="3972546">]</span><span class="builtintype" id="3972547">byte</span><span class="op" id="3972551">,</span>&nbsp;<span class="ident" id="3972553">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3972572">pkix</span><span class="op" id="3972576">.</span><span class="ident" id="3972577">AlgorithmIdentifier</span><span class="op" id="3972596">,</span>&nbsp;<span class="ident" id="3972598">err</span>&nbsp;<span class="builtintype" id="3972602">error</span><span class="op" id="3972607">)</span>&nbsp;<span class="op" id="3972609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972612">switch</span>&nbsp;<span class="ident" id="3972619">pub</span>&nbsp;<span class="op" id="3972623">:=</span>&nbsp;<span class="ident" id="3972626">pub</span><span class="op" id="3972629">.</span><span class="op" id="3972630">(</span><span class="keyword" id="3972631">type</span><span class="op" id="3972635">)</span>&nbsp;<span class="op" id="3972637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972640">case</span>&nbsp;<span class="op" id="3972645">*</span><span class="ident" id="3972646">rsa</span><span class="op" id="3972649">.</span><span class="ident" id="3972650">PublicKey</span><span class="op" id="3972659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972663">publicKeyBytes</span><span class="op" id="3972677">,</span>&nbsp;<span class="ident" id="3972679">err</span>&nbsp;<span class="op" id="3972683">=</span>&nbsp;<span class="ident" id="3972685">asn1</span><span class="op" id="3972689">.</span><span class="ident" id="3972690">Marshal</span><span class="op" id="3972697">(</span><span class="ident" id="3972698">rsaPublicKey</span><span class="op" id="3972710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972715">N</span><span class="op" id="3972716">:</span>&nbsp;<span class="ident" id="3972718">pub</span><span class="op" id="3972721">.</span><span class="ident" id="3972722">N</span><span class="op" id="3972723">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972728">E</span><span class="op" id="3972729">:</span>&nbsp;<span class="ident" id="3972731">pub</span><span class="op" id="3972734">.</span><span class="ident" id="3972735">E</span><span class="op" id="3972736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972740">}</span><span class="op" id="3972741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972745">publicKeyAlgorithm</span><span class="op" id="3972763">.</span><span class="ident" id="3972764">Algorithm</span>&nbsp;<span class="op" id="3972774">=</span>&nbsp;<span class="ident" id="3972776">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972794">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972852">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972910">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972961">publicKeyAlgorithm</span><span class="op" id="3972979">.</span><span class="ident" id="3972980">Parameters</span>&nbsp;<span class="op" id="3972991">=</span>&nbsp;<span class="ident" id="3972993">asn1</span><span class="op" id="3972997">.</span><span class="ident" id="3972998">RawValue</span><span class="op" id="3973006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973011">Tag</span><span class="op" id="3973014">:</span>&nbsp;<span class="num" id="3973016">5</span><span class="op" id="3973017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973024">case</span>&nbsp;<span class="op" id="3973029">*</span><span class="ident" id="3973030">ecdsa</span><span class="op" id="3973035">.</span><span class="ident" id="3973036">PublicKey</span><span class="op" id="3973045">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973049">publicKeyBytes</span>&nbsp;<span class="op" id="3973064">=</span>&nbsp;<span class="ident" id="3973066">elliptic</span><span class="op" id="3973074">.</span><span class="ident" id="3973075">Marshal</span><span class="op" id="3973082">(</span><span class="ident" id="3973083">pub</span><span class="op" id="3973086">.</span><span class="ident" id="3973087">Curve</span><span class="op" id="3973092">,</span>&nbsp;<span class="ident" id="3973094">pub</span><span class="op" id="3973097">.</span><span class="ident" id="3973098">X</span><span class="op" id="3973099">,</span>&nbsp;<span class="ident" id="3973101">pub</span><span class="op" id="3973104">.</span><span class="ident" id="3973105">Y</span><span class="op" id="3973106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973110">oid</span><span class="op" id="3973113">,</span>&nbsp;<span class="ident" id="3973115">ok</span>&nbsp;<span class="op" id="3973118">:=</span>&nbsp;<span class="ident" id="3973121">oidFromNamedCurve</span><span class="op" id="3973138">(</span><span class="ident" id="3973139">pub</span><span class="op" id="3973142">.</span><span class="ident" id="3973143">Curve</span><span class="op" id="3973148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973152">if</span>&nbsp;<span class="op" id="3973155">!</span><span class="ident" id="3973156">ok</span>&nbsp;<span class="op" id="3973159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973164">return</span>&nbsp;<span class="ident" id="3973171">nil</span><span class="op" id="3973174">,</span>&nbsp;<span class="ident" id="3973176">pkix</span><span class="op" id="3973180">.</span><span class="ident" id="3973181">AlgorithmIdentifier</span><span class="op" id="3973200">{</span><span class="op" id="3973201">}</span><span class="op" id="3973202">,</span>&nbsp;<span class="ident" id="3973204">errors</span><span class="op" id="3973210">.</span><span class="ident" id="3973211">New</span><span class="op" id="3973214">(</span><span class="string" id="3973215">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3973249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973253">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973257">publicKeyAlgorithm</span><span class="op" id="3973275">.</span><span class="ident" id="3973276">Algorithm</span>&nbsp;<span class="op" id="3973286">=</span>&nbsp;<span class="ident" id="3973288">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973308">var</span>&nbsp;<span class="ident" id="3973312">paramBytes</span>&nbsp;<span class="op" id="3973323">[</span><span class="op" id="3973324">]</span><span class="builtintype" id="3973325">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973332">paramBytes</span><span class="op" id="3973342">,</span>&nbsp;<span class="ident" id="3973344">err</span>&nbsp;<span class="op" id="3973348">=</span>&nbsp;<span class="ident" id="3973350">asn1</span><span class="op" id="3973354">.</span><span class="ident" id="3973355">Marshal</span><span class="op" id="3973362">(</span><span class="ident" id="3973363">oid</span><span class="op" id="3973366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973370">if</span>&nbsp;<span class="ident" id="3973373">err</span>&nbsp;<span class="op" id="3973377">!=</span>&nbsp;<span class="ident" id="3973380">nil</span>&nbsp;<span class="op" id="3973384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973389">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973402">publicKeyAlgorithm</span><span class="op" id="3973420">.</span><span class="ident" id="3973421">Parameters</span><span class="op" id="3973431">.</span><span class="ident" id="3973432">FullBytes</span>&nbsp;<span class="op" id="3973442">=</span>&nbsp;<span class="ident" id="3973444">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973456">default</span><span class="op" id="3973463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973467">return</span>&nbsp;<span class="ident" id="3973474">nil</span><span class="op" id="3973477">,</span>&nbsp;<span class="ident" id="3973479">pkix</span><span class="op" id="3973483">.</span><span class="ident" id="3973484">AlgorithmIdentifier</span><span class="op" id="3973503">{</span><span class="op" id="3973504">}</span><span class="op" id="3973505">,</span>&nbsp;<span class="ident" id="3973507">errors</span><span class="op" id="3973513">.</span><span class="ident" id="3973514">New</span><span class="op" id="3973517">(</span><span class="string" id="3973518">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3973566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973569">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973573">return</span>&nbsp;<span class="ident" id="3973580">publicKeyBytes</span><span class="op" id="3973594">,</span>&nbsp;<span class="ident" id="3973596">publicKeyAlgorithm</span><span class="op" id="3973614">,</span>&nbsp;<span class="ident" id="3973616">nil</span><br>
<span class="lineno"></span><span class="op" id="3973620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3973623">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="3973699">func</span>&nbsp;<span class="ident" id="3973704">MarshalPKIXPublicKey</span><span class="op" id="3973724">(</span><span class="ident" id="3973725">pub</span>&nbsp;<span class="keyword" id="3973729">interface</span><span class="op" id="3973738">{</span><span class="op" id="3973739">}</span><span class="op" id="3973740">)</span>&nbsp;<span class="op" id="3973742">(</span><span class="op" id="3973743">[</span><span class="op" id="3973744">]</span><span class="builtintype" id="3973745">byte</span><span class="op" id="3973749">,</span>&nbsp;<span class="builtintype" id="3973751">error</span><span class="op" id="3973756">)</span>&nbsp;<span class="op" id="3973758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973761">var</span>&nbsp;<span class="ident" id="3973765">publicKeyBytes</span>&nbsp;<span class="op" id="3973780">[</span><span class="op" id="3973781">]</span><span class="builtintype" id="3973782">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973788">var</span>&nbsp;<span class="ident" id="3973792">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3973811">pkix</span><span class="op" id="3973815">.</span><span class="ident" id="3973816">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973837">var</span>&nbsp;<span class="ident" id="3973841">err</span>&nbsp;<span class="builtintype" id="3973845">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973853">if</span>&nbsp;<span class="ident" id="3973856">publicKeyBytes</span><span class="op" id="3973870">,</span>&nbsp;<span class="ident" id="3973872">publicKeyAlgorithm</span><span class="op" id="3973890">,</span>&nbsp;<span class="ident" id="3973892">err</span>&nbsp;<span class="op" id="3973896">=</span>&nbsp;<span class="ident" id="3973898">marshalPublicKey</span><span class="op" id="3973914">(</span><span class="ident" id="3973915">pub</span><span class="op" id="3973918">)</span><span class="op" id="3973919">;</span>&nbsp;<span class="ident" id="3973921">err</span>&nbsp;<span class="op" id="3973925">!=</span>&nbsp;<span class="ident" id="3973928">nil</span>&nbsp;<span class="op" id="3973932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973936">return</span>&nbsp;<span class="ident" id="3973943">nil</span><span class="op" id="3973946">,</span>&nbsp;<span class="ident" id="3973948">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973957">pkix</span>&nbsp;<span class="op" id="3973962">:=</span>&nbsp;<span class="ident" id="3973965">pkixPublicKey</span><span class="op" id="3973978">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973982">Algo</span><span class="op" id="3973986">:</span>&nbsp;<span class="ident" id="3973988">publicKeyAlgorithm</span><span class="op" id="3974006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974010">BitString</span><span class="op" id="3974019">:</span>&nbsp;<span class="ident" id="3974021">asn1</span><span class="op" id="3974025">.</span><span class="ident" id="3974026">BitString</span><span class="op" id="3974035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974040">Bytes</span><span class="op" id="3974045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974051">publicKeyBytes</span><span class="op" id="3974065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974070">BitLength</span><span class="op" id="3974079">:</span>&nbsp;<span class="num" id="3974081">8</span>&nbsp;<span class="op" id="3974083">*</span>&nbsp;<span class="builtinfunc" id="3974085">len</span><span class="op" id="3974088">(</span><span class="ident" id="3974089">publicKeyBytes</span><span class="op" id="3974103">)</span><span class="op" id="3974104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974108">}</span><span class="op" id="3974109">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974116">ret</span><span class="op" id="3974119">,</span>&nbsp;<span class="ident" id="3974121">_</span>&nbsp;<span class="op" id="3974123">:=</span>&nbsp;<span class="ident" id="3974126">asn1</span><span class="op" id="3974130">.</span><span class="ident" id="3974131">Marshal</span><span class="op" id="3974138">(</span><span class="ident" id="3974139">pkix</span><span class="op" id="3974143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974146">return</span>&nbsp;<span class="ident" id="3974153">ret</span><span class="op" id="3974156">,</span>&nbsp;<span class="ident" id="3974158">nil</span><br>
<span class="lineno"></span><span class="op" id="3974162">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3974165">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3974238">type</span>&nbsp;<span class="ident" id="3974243">certificate</span>&nbsp;<span class="keyword" id="3974255">struct</span>&nbsp;<span class="op" id="3974262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974265">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974284">asn1</span><span class="op" id="3974288">.</span><span class="ident" id="3974289">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974301">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974320">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974336">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3974355">pkix</span><span class="op" id="3974359">.</span><span class="ident" id="3974360">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974381">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974400">asn1</span><span class="op" id="3974404">.</span><span class="ident" id="3974405">BitString</span><br>
<span class="lineno"></span><span class="op" id="3974415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3974418">type</span>&nbsp;<span class="ident" id="3974423">tbsCertificate</span>&nbsp;<span class="keyword" id="3974438">struct</span>&nbsp;<span class="op" id="3974445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974448">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974467">asn1</span><span class="op" id="3974471">.</span><span class="ident" id="3974472">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974484">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3974503">int</span>&nbsp;<span class="string" id="3974507">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974551">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974570">*</span><span class="ident" id="3974571">big</span><span class="op" id="3974574">.</span><span class="ident" id="3974575">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974580">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3974599">pkix</span><span class="op" id="3974603">.</span><span class="ident" id="3974604">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974625">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974644">asn1</span><span class="op" id="3974648">.</span><span class="ident" id="3974649">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974659">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974678">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974688">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974707">asn1</span><span class="op" id="3974711">.</span><span class="ident" id="3974712">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974722">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974741">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974756">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974775">asn1</span><span class="op" id="3974779">.</span><span class="ident" id="3974780">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3974792">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974817">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974836">asn1</span><span class="op" id="3974840">.</span><span class="ident" id="3974841">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3974853">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974878">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974897">[</span><span class="op" id="3974898">]</span><span class="ident" id="3974899">pkix</span><span class="op" id="3974903">.</span><span class="ident" id="3974904">Extension</span>&nbsp;<span class="string" id="3974914">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3974947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3974950">type</span>&nbsp;<span class="ident" id="3974955">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="3974978">struct</span>&nbsp;<span class="op" id="3974985">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974988">P</span><span class="op" id="3974989">,</span>&nbsp;<span class="ident" id="3974991">Q</span><span class="op" id="3974992">,</span>&nbsp;<span class="ident" id="3974994">G</span>&nbsp;<span class="op" id="3974996">*</span><span class="ident" id="3974997">big</span><span class="op" id="3975000">.</span><span class="ident" id="3975001">Int</span><br>
<span class="lineno"></span><span class="op" id="3975005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975008">type</span>&nbsp;<span class="ident" id="3975013">dsaSignature</span>&nbsp;<span class="keyword" id="3975026">struct</span>&nbsp;<span class="op" id="3975033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975036">R</span><span class="op" id="3975037">,</span>&nbsp;<span class="ident" id="3975039">S</span>&nbsp;<span class="op" id="3975041">*</span><span class="ident" id="3975042">big</span><span class="op" id="3975045">.</span><span class="ident" id="3975046">Int</span><br>
<span class="lineno">135</span><span class="op" id="3975050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975053">type</span>&nbsp;<span class="ident" id="3975058">ecdsaSignature</span>&nbsp;<span class="ident" id="3975073">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975087">type</span>&nbsp;<span class="ident" id="3975092">validity</span>&nbsp;<span class="keyword" id="3975101">struct</span>&nbsp;<span class="op" id="3975108">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975111">NotBefore</span><span class="op" id="3975120">,</span>&nbsp;<span class="ident" id="3975122">NotAfter</span>&nbsp;<span class="ident" id="3975131">time</span><span class="op" id="3975135">.</span><span class="ident" id="3975136">Time</span><br>
<span class="lineno"></span><span class="op" id="3975141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975144">type</span>&nbsp;<span class="ident" id="3975149">publicKeyInfo</span>&nbsp;<span class="keyword" id="3975163">struct</span>&nbsp;<span class="op" id="3975170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975173">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975183">asn1</span><span class="op" id="3975187">.</span><span class="ident" id="3975188">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975200">Algorithm</span>&nbsp;<span class="ident" id="3975210">pkix</span><span class="op" id="3975214">.</span><span class="ident" id="3975215">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975236">PublicKey</span>&nbsp;<span class="ident" id="3975246">asn1</span><span class="op" id="3975250">.</span><span class="ident" id="3975251">BitString</span><br>
<span class="lineno"></span><span class="op" id="3975261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3975264">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="3975286">type</span>&nbsp;<span class="ident" id="3975291">authKeyId</span>&nbsp;<span class="keyword" id="3975301">struct</span>&nbsp;<span class="op" id="3975308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975311">Id</span>&nbsp;<span class="op" id="3975314">[</span><span class="op" id="3975315">]</span><span class="builtintype" id="3975316">byte</span>&nbsp;<span class="string" id="3975321">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3975345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975348">type</span>&nbsp;<span class="ident" id="3975353">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="3975372">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3975377">const</span>&nbsp;<span class="op" id="3975383">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975386">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="3975412">SignatureAlgorithm</span>&nbsp;<span class="op" id="3975431">=</span>&nbsp;<span class="ident" id="3975433">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975439">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975451">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975463">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975476">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975491">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975506">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975521">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975534">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975549">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975564">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975581">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975598">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="3975614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975617">type</span>&nbsp;<span class="ident" id="3975622">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="3975641">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975646">const</span>&nbsp;<span class="op" id="3975652">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975655">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3975681">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3975700">=</span>&nbsp;<span class="ident" id="3975702">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975708">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975713">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975718">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="3975724">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3975727">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3975760">//</span><br>
<span class="lineno"></span><span class="comment" id="3975763">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3975797">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="3975860">//</span><br>
<span class="lineno"></span><span class="comment" id="3975863">//</span><br>
<span class="lineno"></span><span class="comment" id="3975866">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3975909">//</span><br>
<span class="lineno"></span><span class="comment" id="3975912">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="3975971">//</span><br>
<span class="lineno"></span><span class="comment" id="3975974">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3976033">//</span><br>
<span class="lineno"></span><span class="comment" id="3976036">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3976097">//</span><br>
<span class="lineno">195</span><span class="comment" id="3976100">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3976139">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3976200">//</span><br>
<span class="lineno"></span><span class="comment" id="3976203">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3976247">//</span><br>
<span class="lineno">200</span><span class="comment" id="3976250">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3976293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="3976346">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="3976386">//</span><br>
<span class="lineno"></span><span class="comment" id="3976389">//</span><br>
<span class="lineno">205</span><span class="comment" id="3976392">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="3976426">//</span><br>
<span class="lineno"></span><span class="comment" id="3976429">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3976492">//</span><br>
<span class="lineno"></span><span class="comment" id="3976495">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="3976558">//</span><br>
<span class="lineno"></span><span class="comment" id="3976561">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3976624">//</span><br>
<span class="lineno"></span><span class="comment" id="3976627">//</span><br>
<span class="lineno"></span><span class="comment" id="3976630">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="3976671">//</span><br>
<span class="lineno"></span><span class="comment" id="3976674">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3976715">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="3976785">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="3976836">//</span><br>
<span class="lineno">220</span><span class="comment" id="3976839">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3976881">//</span><br>
<span class="lineno"></span><span class="comment" id="3976884">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3976951">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3977020">//</span><br>
<span class="lineno">225</span><span class="comment" id="3977023">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3977090">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3977159">//</span><br>
<span class="lineno"></span><span class="comment" id="3977162">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3977229">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3977299">var</span>&nbsp;<span class="op" id="3977303">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977306">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977334">=</span>&nbsp;<span class="ident" id="3977336">asn1</span><span class="op" id="3977340">.</span><span class="ident" id="3977341">ObjectIdentifier</span><span class="op" id="3977357">{</span><span class="num" id="3977358">1</span><span class="op" id="3977359">,</span>&nbsp;<span class="num" id="3977361">2</span><span class="op" id="3977362">,</span>&nbsp;<span class="num" id="3977364">840</span><span class="op" id="3977367">,</span>&nbsp;<span class="num" id="3977369">113549</span><span class="op" id="3977375">,</span>&nbsp;<span class="num" id="3977377">1</span><span class="op" id="3977378">,</span>&nbsp;<span class="num" id="3977380">1</span><span class="op" id="3977381">,</span>&nbsp;<span class="num" id="3977383">2</span><span class="op" id="3977384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977387">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977415">=</span>&nbsp;<span class="ident" id="3977417">asn1</span><span class="op" id="3977421">.</span><span class="ident" id="3977422">ObjectIdentifier</span><span class="op" id="3977438">{</span><span class="num" id="3977439">1</span><span class="op" id="3977440">,</span>&nbsp;<span class="num" id="3977442">2</span><span class="op" id="3977443">,</span>&nbsp;<span class="num" id="3977445">840</span><span class="op" id="3977448">,</span>&nbsp;<span class="num" id="3977450">113549</span><span class="op" id="3977456">,</span>&nbsp;<span class="num" id="3977458">1</span><span class="op" id="3977459">,</span>&nbsp;<span class="num" id="3977461">1</span><span class="op" id="3977462">,</span>&nbsp;<span class="num" id="3977464">4</span><span class="op" id="3977465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977468">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977496">=</span>&nbsp;<span class="ident" id="3977498">asn1</span><span class="op" id="3977502">.</span><span class="ident" id="3977503">ObjectIdentifier</span><span class="op" id="3977519">{</span><span class="num" id="3977520">1</span><span class="op" id="3977521">,</span>&nbsp;<span class="num" id="3977523">2</span><span class="op" id="3977524">,</span>&nbsp;<span class="num" id="3977526">840</span><span class="op" id="3977529">,</span>&nbsp;<span class="num" id="3977531">113549</span><span class="op" id="3977537">,</span>&nbsp;<span class="num" id="3977539">1</span><span class="op" id="3977540">,</span>&nbsp;<span class="num" id="3977542">1</span><span class="op" id="3977543">,</span>&nbsp;<span class="num" id="3977545">5</span><span class="op" id="3977546">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977549">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3977577">=</span>&nbsp;<span class="ident" id="3977579">asn1</span><span class="op" id="3977583">.</span><span class="ident" id="3977584">ObjectIdentifier</span><span class="op" id="3977600">{</span><span class="num" id="3977601">1</span><span class="op" id="3977602">,</span>&nbsp;<span class="num" id="3977604">2</span><span class="op" id="3977605">,</span>&nbsp;<span class="num" id="3977607">840</span><span class="op" id="3977610">,</span>&nbsp;<span class="num" id="3977612">113549</span><span class="op" id="3977618">,</span>&nbsp;<span class="num" id="3977620">1</span><span class="op" id="3977621">,</span>&nbsp;<span class="num" id="3977623">1</span><span class="op" id="3977624">,</span>&nbsp;<span class="num" id="3977626">11</span><span class="op" id="3977628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977631">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3977659">=</span>&nbsp;<span class="ident" id="3977661">asn1</span><span class="op" id="3977665">.</span><span class="ident" id="3977666">ObjectIdentifier</span><span class="op" id="3977682">{</span><span class="num" id="3977683">1</span><span class="op" id="3977684">,</span>&nbsp;<span class="num" id="3977686">2</span><span class="op" id="3977687">,</span>&nbsp;<span class="num" id="3977689">840</span><span class="op" id="3977692">,</span>&nbsp;<span class="num" id="3977694">113549</span><span class="op" id="3977700">,</span>&nbsp;<span class="num" id="3977702">1</span><span class="op" id="3977703">,</span>&nbsp;<span class="num" id="3977705">1</span><span class="op" id="3977706">,</span>&nbsp;<span class="num" id="3977708">12</span><span class="op" id="3977710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977713">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3977741">=</span>&nbsp;<span class="ident" id="3977743">asn1</span><span class="op" id="3977747">.</span><span class="ident" id="3977748">ObjectIdentifier</span><span class="op" id="3977764">{</span><span class="num" id="3977765">1</span><span class="op" id="3977766">,</span>&nbsp;<span class="num" id="3977768">2</span><span class="op" id="3977769">,</span>&nbsp;<span class="num" id="3977771">840</span><span class="op" id="3977774">,</span>&nbsp;<span class="num" id="3977776">113549</span><span class="op" id="3977782">,</span>&nbsp;<span class="num" id="3977784">1</span><span class="op" id="3977785">,</span>&nbsp;<span class="num" id="3977787">1</span><span class="op" id="3977788">,</span>&nbsp;<span class="num" id="3977790">13</span><span class="op" id="3977792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977795">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977823">=</span>&nbsp;<span class="ident" id="3977825">asn1</span><span class="op" id="3977829">.</span><span class="ident" id="3977830">ObjectIdentifier</span><span class="op" id="3977846">{</span><span class="num" id="3977847">1</span><span class="op" id="3977848">,</span>&nbsp;<span class="num" id="3977850">2</span><span class="op" id="3977851">,</span>&nbsp;<span class="num" id="3977853">840</span><span class="op" id="3977856">,</span>&nbsp;<span class="num" id="3977858">10040</span><span class="op" id="3977863">,</span>&nbsp;<span class="num" id="3977865">4</span><span class="op" id="3977866">,</span>&nbsp;<span class="num" id="3977868">3</span><span class="op" id="3977869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977872">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3977900">=</span>&nbsp;<span class="ident" id="3977902">asn1</span><span class="op" id="3977906">.</span><span class="ident" id="3977907">ObjectIdentifier</span><span class="op" id="3977923">{</span><span class="num" id="3977924">2</span><span class="op" id="3977925">,</span>&nbsp;<span class="num" id="3977927">16</span><span class="op" id="3977929">,</span>&nbsp;<span class="num" id="3977931">840</span><span class="op" id="3977934">,</span>&nbsp;<span class="num" id="3977936">1</span><span class="op" id="3977937">,</span>&nbsp;<span class="num" id="3977939">101</span><span class="op" id="3977942">,</span>&nbsp;<span class="num" id="3977944">4</span><span class="op" id="3977945">,</span>&nbsp;<span class="num" id="3977947">3</span><span class="op" id="3977948">,</span>&nbsp;<span class="num" id="3977950">2</span><span class="op" id="3977951">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977954">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3977982">=</span>&nbsp;<span class="ident" id="3977984">asn1</span><span class="op" id="3977988">.</span><span class="ident" id="3977989">ObjectIdentifier</span><span class="op" id="3978005">{</span><span class="num" id="3978006">1</span><span class="op" id="3978007">,</span>&nbsp;<span class="num" id="3978009">2</span><span class="op" id="3978010">,</span>&nbsp;<span class="num" id="3978012">840</span><span class="op" id="3978015">,</span>&nbsp;<span class="num" id="3978017">10045</span><span class="op" id="3978022">,</span>&nbsp;<span class="num" id="3978024">4</span><span class="op" id="3978025">,</span>&nbsp;<span class="num" id="3978027">1</span><span class="op" id="3978028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978031">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="3978059">=</span>&nbsp;<span class="ident" id="3978061">asn1</span><span class="op" id="3978065">.</span><span class="ident" id="3978066">ObjectIdentifier</span><span class="op" id="3978082">{</span><span class="num" id="3978083">1</span><span class="op" id="3978084">,</span>&nbsp;<span class="num" id="3978086">2</span><span class="op" id="3978087">,</span>&nbsp;<span class="num" id="3978089">840</span><span class="op" id="3978092">,</span>&nbsp;<span class="num" id="3978094">10045</span><span class="op" id="3978099">,</span>&nbsp;<span class="num" id="3978101">4</span><span class="op" id="3978102">,</span>&nbsp;<span class="num" id="3978104">3</span><span class="op" id="3978105">,</span>&nbsp;<span class="num" id="3978107">2</span><span class="op" id="3978108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978111">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="3978139">=</span>&nbsp;<span class="ident" id="3978141">asn1</span><span class="op" id="3978145">.</span><span class="ident" id="3978146">ObjectIdentifier</span><span class="op" id="3978162">{</span><span class="num" id="3978163">1</span><span class="op" id="3978164">,</span>&nbsp;<span class="num" id="3978166">2</span><span class="op" id="3978167">,</span>&nbsp;<span class="num" id="3978169">840</span><span class="op" id="3978172">,</span>&nbsp;<span class="num" id="3978174">10045</span><span class="op" id="3978179">,</span>&nbsp;<span class="num" id="3978181">4</span><span class="op" id="3978182">,</span>&nbsp;<span class="num" id="3978184">3</span><span class="op" id="3978185">,</span>&nbsp;<span class="num" id="3978187">3</span><span class="op" id="3978188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978191">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="3978219">=</span>&nbsp;<span class="ident" id="3978221">asn1</span><span class="op" id="3978225">.</span><span class="ident" id="3978226">ObjectIdentifier</span><span class="op" id="3978242">{</span><span class="num" id="3978243">1</span><span class="op" id="3978244">,</span>&nbsp;<span class="num" id="3978246">2</span><span class="op" id="3978247">,</span>&nbsp;<span class="num" id="3978249">840</span><span class="op" id="3978252">,</span>&nbsp;<span class="num" id="3978254">10045</span><span class="op" id="3978259">,</span>&nbsp;<span class="num" id="3978261">4</span><span class="op" id="3978262">,</span>&nbsp;<span class="num" id="3978264">3</span><span class="op" id="3978265">,</span>&nbsp;<span class="num" id="3978267">4</span><span class="op" id="3978268">}</span><br>
<span class="lineno"></span><span class="op" id="3978270">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="3978273">var</span>&nbsp;<span class="ident" id="3978277">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3978303">=</span>&nbsp;<span class="op" id="3978305">[</span><span class="op" id="3978306">]</span><span class="keyword" id="3978307">struct</span>&nbsp;<span class="op" id="3978314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978317">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978328">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978348">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978359">asn1</span><span class="op" id="3978363">.</span><span class="ident" id="3978364">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978382">pubKeyAlgo</span>&nbsp;<span class="ident" id="3978393">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978413">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978424">crypto</span><span class="op" id="3978430">.</span><span class="ident" id="3978431">Hash</span><br>
<span class="lineno"></span><span class="op" id="3978436">}</span><span class="op" id="3978437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978440">{</span><span class="ident" id="3978441">MD2WithRSA</span><span class="op" id="3978451">,</span>&nbsp;<span class="ident" id="3978453">oidSignatureMD2WithRSA</span><span class="op" id="3978475">,</span>&nbsp;<span class="ident" id="3978477">RSA</span><span class="op" id="3978480">,</span>&nbsp;<span class="ident" id="3978482">crypto</span><span class="op" id="3978488">.</span><span class="ident" id="3978489">Hash</span><span class="op" id="3978493">(</span><span class="num" id="3978494">0</span><span class="op" id="3978495">)</span>&nbsp;<span class="comment" id="3978497">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="3978519">}</span><span class="op" id="3978520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978523">{</span><span class="ident" id="3978524">MD5WithRSA</span><span class="op" id="3978534">,</span>&nbsp;<span class="ident" id="3978536">oidSignatureMD5WithRSA</span><span class="op" id="3978558">,</span>&nbsp;<span class="ident" id="3978560">RSA</span><span class="op" id="3978563">,</span>&nbsp;<span class="ident" id="3978565">crypto</span><span class="op" id="3978571">.</span><span class="ident" id="3978572">MD5</span><span class="op" id="3978575">}</span><span class="op" id="3978576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978579">{</span><span class="ident" id="3978580">SHA1WithRSA</span><span class="op" id="3978591">,</span>&nbsp;<span class="ident" id="3978593">oidSignatureSHA1WithRSA</span><span class="op" id="3978616">,</span>&nbsp;<span class="ident" id="3978618">RSA</span><span class="op" id="3978621">,</span>&nbsp;<span class="ident" id="3978623">crypto</span><span class="op" id="3978629">.</span><span class="ident" id="3978630">SHA1</span><span class="op" id="3978634">}</span><span class="op" id="3978635">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978638">{</span><span class="ident" id="3978639">SHA256WithRSA</span><span class="op" id="3978652">,</span>&nbsp;<span class="ident" id="3978654">oidSignatureSHA256WithRSA</span><span class="op" id="3978679">,</span>&nbsp;<span class="ident" id="3978681">RSA</span><span class="op" id="3978684">,</span>&nbsp;<span class="ident" id="3978686">crypto</span><span class="op" id="3978692">.</span><span class="ident" id="3978693">SHA256</span><span class="op" id="3978699">}</span><span class="op" id="3978700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978703">{</span><span class="ident" id="3978704">SHA384WithRSA</span><span class="op" id="3978717">,</span>&nbsp;<span class="ident" id="3978719">oidSignatureSHA384WithRSA</span><span class="op" id="3978744">,</span>&nbsp;<span class="ident" id="3978746">RSA</span><span class="op" id="3978749">,</span>&nbsp;<span class="ident" id="3978751">crypto</span><span class="op" id="3978757">.</span><span class="ident" id="3978758">SHA384</span><span class="op" id="3978764">}</span><span class="op" id="3978765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978768">{</span><span class="ident" id="3978769">SHA512WithRSA</span><span class="op" id="3978782">,</span>&nbsp;<span class="ident" id="3978784">oidSignatureSHA512WithRSA</span><span class="op" id="3978809">,</span>&nbsp;<span class="ident" id="3978811">RSA</span><span class="op" id="3978814">,</span>&nbsp;<span class="ident" id="3978816">crypto</span><span class="op" id="3978822">.</span><span class="ident" id="3978823">SHA512</span><span class="op" id="3978829">}</span><span class="op" id="3978830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978833">{</span><span class="ident" id="3978834">DSAWithSHA1</span><span class="op" id="3978845">,</span>&nbsp;<span class="ident" id="3978847">oidSignatureDSAWithSHA1</span><span class="op" id="3978870">,</span>&nbsp;<span class="ident" id="3978872">DSA</span><span class="op" id="3978875">,</span>&nbsp;<span class="ident" id="3978877">crypto</span><span class="op" id="3978883">.</span><span class="ident" id="3978884">SHA1</span><span class="op" id="3978888">}</span><span class="op" id="3978889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978892">{</span><span class="ident" id="3978893">DSAWithSHA256</span><span class="op" id="3978906">,</span>&nbsp;<span class="ident" id="3978908">oidSignatureDSAWithSHA256</span><span class="op" id="3978933">,</span>&nbsp;<span class="ident" id="3978935">DSA</span><span class="op" id="3978938">,</span>&nbsp;<span class="ident" id="3978940">crypto</span><span class="op" id="3978946">.</span><span class="ident" id="3978947">SHA256</span><span class="op" id="3978953">}</span><span class="op" id="3978954">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978957">{</span><span class="ident" id="3978958">ECDSAWithSHA1</span><span class="op" id="3978971">,</span>&nbsp;<span class="ident" id="3978973">oidSignatureECDSAWithSHA1</span><span class="op" id="3978998">,</span>&nbsp;<span class="ident" id="3979000">ECDSA</span><span class="op" id="3979005">,</span>&nbsp;<span class="ident" id="3979007">crypto</span><span class="op" id="3979013">.</span><span class="ident" id="3979014">SHA1</span><span class="op" id="3979018">}</span><span class="op" id="3979019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979022">{</span><span class="ident" id="3979023">ECDSAWithSHA256</span><span class="op" id="3979038">,</span>&nbsp;<span class="ident" id="3979040">oidSignatureECDSAWithSHA256</span><span class="op" id="3979067">,</span>&nbsp;<span class="ident" id="3979069">ECDSA</span><span class="op" id="3979074">,</span>&nbsp;<span class="ident" id="3979076">crypto</span><span class="op" id="3979082">.</span><span class="ident" id="3979083">SHA256</span><span class="op" id="3979089">}</span><span class="op" id="3979090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979093">{</span><span class="ident" id="3979094">ECDSAWithSHA384</span><span class="op" id="3979109">,</span>&nbsp;<span class="ident" id="3979111">oidSignatureECDSAWithSHA384</span><span class="op" id="3979138">,</span>&nbsp;<span class="ident" id="3979140">ECDSA</span><span class="op" id="3979145">,</span>&nbsp;<span class="ident" id="3979147">crypto</span><span class="op" id="3979153">.</span><span class="ident" id="3979154">SHA384</span><span class="op" id="3979160">}</span><span class="op" id="3979161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979164">{</span><span class="ident" id="3979165">ECDSAWithSHA512</span><span class="op" id="3979180">,</span>&nbsp;<span class="ident" id="3979182">oidSignatureECDSAWithSHA512</span><span class="op" id="3979209">,</span>&nbsp;<span class="ident" id="3979211">ECDSA</span><span class="op" id="3979216">,</span>&nbsp;<span class="ident" id="3979218">crypto</span><span class="op" id="3979224">.</span><span class="ident" id="3979225">SHA512</span><span class="op" id="3979231">}</span><span class="op" id="3979232">,</span><br>
<span class="lineno"></span><span class="op" id="3979234">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="3979237">func</span>&nbsp;<span class="ident" id="3979242">getSignatureAlgorithmFromOID</span><span class="op" id="3979270">(</span><span class="ident" id="3979271">oid</span>&nbsp;<span class="ident" id="3979275">asn1</span><span class="op" id="3979279">.</span><span class="ident" id="3979280">ObjectIdentifier</span><span class="op" id="3979296">)</span>&nbsp;<span class="ident" id="3979298">SignatureAlgorithm</span>&nbsp;<span class="op" id="3979317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979320">for</span>&nbsp;<span class="ident" id="3979324">_</span><span class="op" id="3979325">,</span>&nbsp;<span class="ident" id="3979327">details</span>&nbsp;<span class="op" id="3979335">:=</span>&nbsp;<span class="keyword" id="3979338">range</span>&nbsp;<span class="ident" id="3979344">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3979370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979374">if</span>&nbsp;<span class="ident" id="3979377">oid</span><span class="op" id="3979380">.</span><span class="ident" id="3979381">Equal</span><span class="op" id="3979386">(</span><span class="ident" id="3979387">details</span><span class="op" id="3979394">.</span><span class="ident" id="3979395">oid</span><span class="op" id="3979398">)</span>&nbsp;<span class="op" id="3979400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979405">return</span>&nbsp;<span class="ident" id="3979412">details</span><span class="op" id="3979419">.</span><span class="ident" id="3979420">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979433">return</span>&nbsp;<span class="ident" id="3979440">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3979466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="3979469">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3979508">//</span><br>
<span class="lineno"></span><span class="comment" id="3979511">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3979576">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3979609">//</span><br>
<span class="lineno">280</span><span class="comment" id="3979612">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3979666">//</span><br>
<span class="lineno"></span><span class="comment" id="3979669">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3979734">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3979765">//</span><br>
<span class="lineno">285</span><span class="comment" id="3979768">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="3979836">//</span><br>
<span class="lineno"></span><span class="comment" id="3979839">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3979881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3979953">var</span>&nbsp;<span class="op" id="3979957">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3979960">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3979978">=</span>&nbsp;<span class="ident" id="3979980">asn1</span><span class="op" id="3979984">.</span><span class="ident" id="3979985">ObjectIdentifier</span><span class="op" id="3980001">{</span><span class="num" id="3980002">1</span><span class="op" id="3980003">,</span>&nbsp;<span class="num" id="3980005">2</span><span class="op" id="3980006">,</span>&nbsp;<span class="num" id="3980008">840</span><span class="op" id="3980011">,</span>&nbsp;<span class="num" id="3980013">113549</span><span class="op" id="3980019">,</span>&nbsp;<span class="num" id="3980021">1</span><span class="op" id="3980022">,</span>&nbsp;<span class="num" id="3980024">1</span><span class="op" id="3980025">,</span>&nbsp;<span class="num" id="3980027">1</span><span class="op" id="3980028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3980031">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3980049">=</span>&nbsp;<span class="ident" id="3980051">asn1</span><span class="op" id="3980055">.</span><span class="ident" id="3980056">ObjectIdentifier</span><span class="op" id="3980072">{</span><span class="num" id="3980073">1</span><span class="op" id="3980074">,</span>&nbsp;<span class="num" id="3980076">2</span><span class="op" id="3980077">,</span>&nbsp;<span class="num" id="3980079">840</span><span class="op" id="3980082">,</span>&nbsp;<span class="num" id="3980084">10040</span><span class="op" id="3980089">,</span>&nbsp;<span class="num" id="3980091">4</span><span class="op" id="3980092">,</span>&nbsp;<span class="num" id="3980094">1</span><span class="op" id="3980095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3980098">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="3980116">=</span>&nbsp;<span class="ident" id="3980118">asn1</span><span class="op" id="3980122">.</span><span class="ident" id="3980123">ObjectIdentifier</span><span class="op" id="3980139">{</span><span class="num" id="3980140">1</span><span class="op" id="3980141">,</span>&nbsp;<span class="num" id="3980143">2</span><span class="op" id="3980144">,</span>&nbsp;<span class="num" id="3980146">840</span><span class="op" id="3980149">,</span>&nbsp;<span class="num" id="3980151">10045</span><span class="op" id="3980156">,</span>&nbsp;<span class="num" id="3980158">2</span><span class="op" id="3980159">,</span>&nbsp;<span class="num" id="3980161">1</span><span class="op" id="3980162">}</span><br>
<span class="lineno"></span><span class="op" id="3980164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="3980167">func</span>&nbsp;<span class="ident" id="3980172">getPublicKeyAlgorithmFromOID</span><span class="op" id="3980200">(</span><span class="ident" id="3980201">oid</span>&nbsp;<span class="ident" id="3980205">asn1</span><span class="op" id="3980209">.</span><span class="ident" id="3980210">ObjectIdentifier</span><span class="op" id="3980226">)</span>&nbsp;<span class="ident" id="3980228">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3980247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980250">switch</span>&nbsp;<span class="op" id="3980257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980260">case</span>&nbsp;<span class="ident" id="3980265">oid</span><span class="op" id="3980268">.</span><span class="ident" id="3980269">Equal</span><span class="op" id="3980274">(</span><span class="ident" id="3980275">oidPublicKeyRSA</span><span class="op" id="3980290">)</span><span class="op" id="3980291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980295">return</span>&nbsp;<span class="ident" id="3980302">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980307">case</span>&nbsp;<span class="ident" id="3980312">oid</span><span class="op" id="3980315">.</span><span class="ident" id="3980316">Equal</span><span class="op" id="3980321">(</span><span class="ident" id="3980322">oidPublicKeyDSA</span><span class="op" id="3980337">)</span><span class="op" id="3980338">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980342">return</span>&nbsp;<span class="ident" id="3980349">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980354">case</span>&nbsp;<span class="ident" id="3980359">oid</span><span class="op" id="3980362">.</span><span class="ident" id="3980363">Equal</span><span class="op" id="3980368">(</span><span class="ident" id="3980369">oidPublicKeyECDSA</span><span class="op" id="3980386">)</span><span class="op" id="3980387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980391">return</span>&nbsp;<span class="ident" id="3980398">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3980405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3980408">return</span>&nbsp;<span class="ident" id="3980415">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="3980441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3980444">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="3980478">//</span><br>
<span class="lineno"></span><span class="comment" id="3980481">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="3980518">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3980585">//</span><br>
<span class="lineno"></span><span class="comment" id="3980588">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3980625">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="3980688">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="3980706">//</span><br>
<span class="lineno"></span><span class="comment" id="3980709">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3980746">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3980813">//</span><br>
<span class="lineno"></span><span class="comment" id="3980816">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="3980853">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3980920">//</span><br>
<span class="lineno"></span><span class="comment" id="3980923">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="3980968">var</span>&nbsp;<span class="op" id="3980972">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3980975">oidNamedCurveP224</span>&nbsp;<span class="op" id="3980993">=</span>&nbsp;<span class="ident" id="3980995">asn1</span><span class="op" id="3980999">.</span><span class="ident" id="3981000">ObjectIdentifier</span><span class="op" id="3981016">{</span><span class="num" id="3981017">1</span><span class="op" id="3981018">,</span>&nbsp;<span class="num" id="3981020">3</span><span class="op" id="3981021">,</span>&nbsp;<span class="num" id="3981023">132</span><span class="op" id="3981026">,</span>&nbsp;<span class="num" id="3981028">0</span><span class="op" id="3981029">,</span>&nbsp;<span class="num" id="3981031">33</span><span class="op" id="3981033">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3981036">oidNamedCurveP256</span>&nbsp;<span class="op" id="3981054">=</span>&nbsp;<span class="ident" id="3981056">asn1</span><span class="op" id="3981060">.</span><span class="ident" id="3981061">ObjectIdentifier</span><span class="op" id="3981077">{</span><span class="num" id="3981078">1</span><span class="op" id="3981079">,</span>&nbsp;<span class="num" id="3981081">2</span><span class="op" id="3981082">,</span>&nbsp;<span class="num" id="3981084">840</span><span class="op" id="3981087">,</span>&nbsp;<span class="num" id="3981089">10045</span><span class="op" id="3981094">,</span>&nbsp;<span class="num" id="3981096">3</span><span class="op" id="3981097">,</span>&nbsp;<span class="num" id="3981099">1</span><span class="op" id="3981100">,</span>&nbsp;<span class="num" id="3981102">7</span><span class="op" id="3981103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3981106">oidNamedCurveP384</span>&nbsp;<span class="op" id="3981124">=</span>&nbsp;<span class="ident" id="3981126">asn1</span><span class="op" id="3981130">.</span><span class="ident" id="3981131">ObjectIdentifier</span><span class="op" id="3981147">{</span><span class="num" id="3981148">1</span><span class="op" id="3981149">,</span>&nbsp;<span class="num" id="3981151">3</span><span class="op" id="3981152">,</span>&nbsp;<span class="num" id="3981154">132</span><span class="op" id="3981157">,</span>&nbsp;<span class="num" id="3981159">0</span><span class="op" id="3981160">,</span>&nbsp;<span class="num" id="3981162">34</span><span class="op" id="3981164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3981167">oidNamedCurveP521</span>&nbsp;<span class="op" id="3981185">=</span>&nbsp;<span class="ident" id="3981187">asn1</span><span class="op" id="3981191">.</span><span class="ident" id="3981192">ObjectIdentifier</span><span class="op" id="3981208">{</span><span class="num" id="3981209">1</span><span class="op" id="3981210">,</span>&nbsp;<span class="num" id="3981212">3</span><span class="op" id="3981213">,</span>&nbsp;<span class="num" id="3981215">132</span><span class="op" id="3981218">,</span>&nbsp;<span class="num" id="3981220">0</span><span class="op" id="3981221">,</span>&nbsp;<span class="num" id="3981223">35</span><span class="op" id="3981225">}</span><br>
<span class="lineno"></span><span class="op" id="3981227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="3981230">func</span>&nbsp;<span class="ident" id="3981235">namedCurveFromOID</span><span class="op" id="3981252">(</span><span class="ident" id="3981253">oid</span>&nbsp;<span class="ident" id="3981257">asn1</span><span class="op" id="3981261">.</span><span class="ident" id="3981262">ObjectIdentifier</span><span class="op" id="3981278">)</span>&nbsp;<span class="ident" id="3981280">elliptic</span><span class="op" id="3981288">.</span><span class="ident" id="3981289">Curve</span>&nbsp;<span class="op" id="3981295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981298">switch</span>&nbsp;<span class="op" id="3981305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981308">case</span>&nbsp;<span class="ident" id="3981313">oid</span><span class="op" id="3981316">.</span><span class="ident" id="3981317">Equal</span><span class="op" id="3981322">(</span><span class="ident" id="3981323">oidNamedCurveP224</span><span class="op" id="3981340">)</span><span class="op" id="3981341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981345">return</span>&nbsp;<span class="ident" id="3981352">elliptic</span><span class="op" id="3981360">.</span><span class="ident" id="3981361">P224</span><span class="op" id="3981365">(</span><span class="op" id="3981366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981369">case</span>&nbsp;<span class="ident" id="3981374">oid</span><span class="op" id="3981377">.</span><span class="ident" id="3981378">Equal</span><span class="op" id="3981383">(</span><span class="ident" id="3981384">oidNamedCurveP256</span><span class="op" id="3981401">)</span><span class="op" id="3981402">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981406">return</span>&nbsp;<span class="ident" id="3981413">elliptic</span><span class="op" id="3981421">.</span><span class="ident" id="3981422">P256</span><span class="op" id="3981426">(</span><span class="op" id="3981427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981430">case</span>&nbsp;<span class="ident" id="3981435">oid</span><span class="op" id="3981438">.</span><span class="ident" id="3981439">Equal</span><span class="op" id="3981444">(</span><span class="ident" id="3981445">oidNamedCurveP384</span><span class="op" id="3981462">)</span><span class="op" id="3981463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981467">return</span>&nbsp;<span class="ident" id="3981474">elliptic</span><span class="op" id="3981482">.</span><span class="ident" id="3981483">P384</span><span class="op" id="3981487">(</span><span class="op" id="3981488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981491">case</span>&nbsp;<span class="ident" id="3981496">oid</span><span class="op" id="3981499">.</span><span class="ident" id="3981500">Equal</span><span class="op" id="3981505">(</span><span class="ident" id="3981506">oidNamedCurveP521</span><span class="op" id="3981523">)</span><span class="op" id="3981524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981528">return</span>&nbsp;<span class="ident" id="3981535">elliptic</span><span class="op" id="3981543">.</span><span class="ident" id="3981544">P521</span><span class="op" id="3981548">(</span><span class="op" id="3981549">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3981552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981555">return</span>&nbsp;<span class="ident" id="3981562">nil</span><br>
<span class="lineno"></span><span class="op" id="3981566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3981569">func</span>&nbsp;<span class="ident" id="3981574">oidFromNamedCurve</span><span class="op" id="3981591">(</span><span class="ident" id="3981592">curve</span>&nbsp;<span class="ident" id="3981598">elliptic</span><span class="op" id="3981606">.</span><span class="ident" id="3981607">Curve</span><span class="op" id="3981612">)</span>&nbsp;<span class="op" id="3981614">(</span><span class="ident" id="3981615">asn1</span><span class="op" id="3981619">.</span><span class="ident" id="3981620">ObjectIdentifier</span><span class="op" id="3981636">,</span>&nbsp;<span class="builtintype" id="3981638">bool</span><span class="op" id="3981642">)</span>&nbsp;<span class="op" id="3981644">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981647">switch</span>&nbsp;<span class="ident" id="3981654">curve</span>&nbsp;<span class="op" id="3981660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981663">case</span>&nbsp;<span class="ident" id="3981668">elliptic</span><span class="op" id="3981676">.</span><span class="ident" id="3981677">P224</span><span class="op" id="3981681">(</span><span class="op" id="3981682">)</span><span class="op" id="3981683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981687">return</span>&nbsp;<span class="ident" id="3981694">oidNamedCurveP224</span><span class="op" id="3981711">,</span>&nbsp;<span class="builtintype" id="3981713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981719">case</span>&nbsp;<span class="ident" id="3981724">elliptic</span><span class="op" id="3981732">.</span><span class="ident" id="3981733">P256</span><span class="op" id="3981737">(</span><span class="op" id="3981738">)</span><span class="op" id="3981739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981743">return</span>&nbsp;<span class="ident" id="3981750">oidNamedCurveP256</span><span class="op" id="3981767">,</span>&nbsp;<span class="builtintype" id="3981769">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981775">case</span>&nbsp;<span class="ident" id="3981780">elliptic</span><span class="op" id="3981788">.</span><span class="ident" id="3981789">P384</span><span class="op" id="3981793">(</span><span class="op" id="3981794">)</span><span class="op" id="3981795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981799">return</span>&nbsp;<span class="ident" id="3981806">oidNamedCurveP384</span><span class="op" id="3981823">,</span>&nbsp;<span class="builtintype" id="3981825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981831">case</span>&nbsp;<span class="ident" id="3981836">elliptic</span><span class="op" id="3981844">.</span><span class="ident" id="3981845">P521</span><span class="op" id="3981849">(</span><span class="op" id="3981850">)</span><span class="op" id="3981851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981855">return</span>&nbsp;<span class="ident" id="3981862">oidNamedCurveP521</span><span class="op" id="3981879">,</span>&nbsp;<span class="builtintype" id="3981881">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3981887">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3981891">return</span>&nbsp;<span class="ident" id="3981898">nil</span><span class="op" id="3981901">,</span>&nbsp;<span class="builtintype" id="3981903">false</span><br>
<span class="lineno"></span><span class="op" id="3981909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3981912">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="3981991">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3982031">type</span>&nbsp;<span class="ident" id="3982036">KeyUsage</span>&nbsp;<span class="builtintype" id="3982045">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3982050">const</span>&nbsp;<span class="op" id="3982056">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982059">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="3982084">KeyUsage</span>&nbsp;<span class="op" id="3982093">=</span>&nbsp;<span class="num" id="3982095">1</span>&nbsp;<span class="op" id="3982097">&lt;&lt;</span>&nbsp;<span class="ident" id="3982100">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982106">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982133">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982158">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982184">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982206">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982224">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982241">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982263">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="3982284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="3982287">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="3982329">//</span><br>
<span class="lineno"></span><span class="comment" id="3982332">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3982401">//</span><br>
<span class="lineno"></span><span class="comment" id="3982404">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="3982449">//</span><br>
<span class="lineno"></span><span class="comment" id="3982452">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3982518">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3982584">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3982650">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="3982716">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3982782">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3982848">var</span>&nbsp;<span class="op" id="3982852">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982855">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982896">=</span>&nbsp;<span class="ident" id="3982898">asn1</span><span class="op" id="3982902">.</span><span class="ident" id="3982903">ObjectIdentifier</span><span class="op" id="3982919">{</span><span class="num" id="3982920">2</span><span class="op" id="3982921">,</span>&nbsp;<span class="num" id="3982923">5</span><span class="op" id="3982924">,</span>&nbsp;<span class="num" id="3982926">29</span><span class="op" id="3982928">,</span>&nbsp;<span class="num" id="3982930">37</span><span class="op" id="3982932">,</span>&nbsp;<span class="num" id="3982934">0</span><span class="op" id="3982935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3982938">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982979">=</span>&nbsp;<span class="ident" id="3982981">asn1</span><span class="op" id="3982985">.</span><span class="ident" id="3982986">ObjectIdentifier</span><span class="op" id="3983002">{</span><span class="num" id="3983003">1</span><span class="op" id="3983004">,</span>&nbsp;<span class="num" id="3983006">3</span><span class="op" id="3983007">,</span>&nbsp;<span class="num" id="3983009">6</span><span class="op" id="3983010">,</span>&nbsp;<span class="num" id="3983012">1</span><span class="op" id="3983013">,</span>&nbsp;<span class="num" id="3983015">5</span><span class="op" id="3983016">,</span>&nbsp;<span class="num" id="3983018">5</span><span class="op" id="3983019">,</span>&nbsp;<span class="num" id="3983021">7</span><span class="op" id="3983022">,</span>&nbsp;<span class="num" id="3983024">3</span><span class="op" id="3983025">,</span>&nbsp;<span class="num" id="3983027">1</span><span class="op" id="3983028">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983031">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983072">=</span>&nbsp;<span class="ident" id="3983074">asn1</span><span class="op" id="3983078">.</span><span class="ident" id="3983079">ObjectIdentifier</span><span class="op" id="3983095">{</span><span class="num" id="3983096">1</span><span class="op" id="3983097">,</span>&nbsp;<span class="num" id="3983099">3</span><span class="op" id="3983100">,</span>&nbsp;<span class="num" id="3983102">6</span><span class="op" id="3983103">,</span>&nbsp;<span class="num" id="3983105">1</span><span class="op" id="3983106">,</span>&nbsp;<span class="num" id="3983108">5</span><span class="op" id="3983109">,</span>&nbsp;<span class="num" id="3983111">5</span><span class="op" id="3983112">,</span>&nbsp;<span class="num" id="3983114">7</span><span class="op" id="3983115">,</span>&nbsp;<span class="num" id="3983117">3</span><span class="op" id="3983118">,</span>&nbsp;<span class="num" id="3983120">2</span><span class="op" id="3983121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983124">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983165">=</span>&nbsp;<span class="ident" id="3983167">asn1</span><span class="op" id="3983171">.</span><span class="ident" id="3983172">ObjectIdentifier</span><span class="op" id="3983188">{</span><span class="num" id="3983189">1</span><span class="op" id="3983190">,</span>&nbsp;<span class="num" id="3983192">3</span><span class="op" id="3983193">,</span>&nbsp;<span class="num" id="3983195">6</span><span class="op" id="3983196">,</span>&nbsp;<span class="num" id="3983198">1</span><span class="op" id="3983199">,</span>&nbsp;<span class="num" id="3983201">5</span><span class="op" id="3983202">,</span>&nbsp;<span class="num" id="3983204">5</span><span class="op" id="3983205">,</span>&nbsp;<span class="num" id="3983207">7</span><span class="op" id="3983208">,</span>&nbsp;<span class="num" id="3983210">3</span><span class="op" id="3983211">,</span>&nbsp;<span class="num" id="3983213">3</span><span class="op" id="3983214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983217">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983258">=</span>&nbsp;<span class="ident" id="3983260">asn1</span><span class="op" id="3983264">.</span><span class="ident" id="3983265">ObjectIdentifier</span><span class="op" id="3983281">{</span><span class="num" id="3983282">1</span><span class="op" id="3983283">,</span>&nbsp;<span class="num" id="3983285">3</span><span class="op" id="3983286">,</span>&nbsp;<span class="num" id="3983288">6</span><span class="op" id="3983289">,</span>&nbsp;<span class="num" id="3983291">1</span><span class="op" id="3983292">,</span>&nbsp;<span class="num" id="3983294">5</span><span class="op" id="3983295">,</span>&nbsp;<span class="num" id="3983297">5</span><span class="op" id="3983298">,</span>&nbsp;<span class="num" id="3983300">7</span><span class="op" id="3983301">,</span>&nbsp;<span class="num" id="3983303">3</span><span class="op" id="3983304">,</span>&nbsp;<span class="num" id="3983306">4</span><span class="op" id="3983307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983310">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983351">=</span>&nbsp;<span class="ident" id="3983353">asn1</span><span class="op" id="3983357">.</span><span class="ident" id="3983358">ObjectIdentifier</span><span class="op" id="3983374">{</span><span class="num" id="3983375">1</span><span class="op" id="3983376">,</span>&nbsp;<span class="num" id="3983378">3</span><span class="op" id="3983379">,</span>&nbsp;<span class="num" id="3983381">6</span><span class="op" id="3983382">,</span>&nbsp;<span class="num" id="3983384">1</span><span class="op" id="3983385">,</span>&nbsp;<span class="num" id="3983387">5</span><span class="op" id="3983388">,</span>&nbsp;<span class="num" id="3983390">5</span><span class="op" id="3983391">,</span>&nbsp;<span class="num" id="3983393">7</span><span class="op" id="3983394">,</span>&nbsp;<span class="num" id="3983396">3</span><span class="op" id="3983397">,</span>&nbsp;<span class="num" id="3983399">5</span><span class="op" id="3983400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983403">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983444">=</span>&nbsp;<span class="ident" id="3983446">asn1</span><span class="op" id="3983450">.</span><span class="ident" id="3983451">ObjectIdentifier</span><span class="op" id="3983467">{</span><span class="num" id="3983468">1</span><span class="op" id="3983469">,</span>&nbsp;<span class="num" id="3983471">3</span><span class="op" id="3983472">,</span>&nbsp;<span class="num" id="3983474">6</span><span class="op" id="3983475">,</span>&nbsp;<span class="num" id="3983477">1</span><span class="op" id="3983478">,</span>&nbsp;<span class="num" id="3983480">5</span><span class="op" id="3983481">,</span>&nbsp;<span class="num" id="3983483">5</span><span class="op" id="3983484">,</span>&nbsp;<span class="num" id="3983486">7</span><span class="op" id="3983487">,</span>&nbsp;<span class="num" id="3983489">3</span><span class="op" id="3983490">,</span>&nbsp;<span class="num" id="3983492">6</span><span class="op" id="3983493">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983496">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983537">=</span>&nbsp;<span class="ident" id="3983539">asn1</span><span class="op" id="3983543">.</span><span class="ident" id="3983544">ObjectIdentifier</span><span class="op" id="3983560">{</span><span class="num" id="3983561">1</span><span class="op" id="3983562">,</span>&nbsp;<span class="num" id="3983564">3</span><span class="op" id="3983565">,</span>&nbsp;<span class="num" id="3983567">6</span><span class="op" id="3983568">,</span>&nbsp;<span class="num" id="3983570">1</span><span class="op" id="3983571">,</span>&nbsp;<span class="num" id="3983573">5</span><span class="op" id="3983574">,</span>&nbsp;<span class="num" id="3983576">5</span><span class="op" id="3983577">,</span>&nbsp;<span class="num" id="3983579">7</span><span class="op" id="3983580">,</span>&nbsp;<span class="num" id="3983582">3</span><span class="op" id="3983583">,</span>&nbsp;<span class="num" id="3983585">7</span><span class="op" id="3983586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983589">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983630">=</span>&nbsp;<span class="ident" id="3983632">asn1</span><span class="op" id="3983636">.</span><span class="ident" id="3983637">ObjectIdentifier</span><span class="op" id="3983653">{</span><span class="num" id="3983654">1</span><span class="op" id="3983655">,</span>&nbsp;<span class="num" id="3983657">3</span><span class="op" id="3983658">,</span>&nbsp;<span class="num" id="3983660">6</span><span class="op" id="3983661">,</span>&nbsp;<span class="num" id="3983663">1</span><span class="op" id="3983664">,</span>&nbsp;<span class="num" id="3983666">5</span><span class="op" id="3983667">,</span>&nbsp;<span class="num" id="3983669">5</span><span class="op" id="3983670">,</span>&nbsp;<span class="num" id="3983672">7</span><span class="op" id="3983673">,</span>&nbsp;<span class="num" id="3983675">3</span><span class="op" id="3983676">,</span>&nbsp;<span class="num" id="3983678">8</span><span class="op" id="3983679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983682">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983723">=</span>&nbsp;<span class="ident" id="3983725">asn1</span><span class="op" id="3983729">.</span><span class="ident" id="3983730">ObjectIdentifier</span><span class="op" id="3983746">{</span><span class="num" id="3983747">1</span><span class="op" id="3983748">,</span>&nbsp;<span class="num" id="3983750">3</span><span class="op" id="3983751">,</span>&nbsp;<span class="num" id="3983753">6</span><span class="op" id="3983754">,</span>&nbsp;<span class="num" id="3983756">1</span><span class="op" id="3983757">,</span>&nbsp;<span class="num" id="3983759">5</span><span class="op" id="3983760">,</span>&nbsp;<span class="num" id="3983762">5</span><span class="op" id="3983763">,</span>&nbsp;<span class="num" id="3983765">7</span><span class="op" id="3983766">,</span>&nbsp;<span class="num" id="3983768">3</span><span class="op" id="3983769">,</span>&nbsp;<span class="num" id="3983771">9</span><span class="op" id="3983772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983775">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="3983816">=</span>&nbsp;<span class="ident" id="3983818">asn1</span><span class="op" id="3983822">.</span><span class="ident" id="3983823">ObjectIdentifier</span><span class="op" id="3983839">{</span><span class="num" id="3983840">1</span><span class="op" id="3983841">,</span>&nbsp;<span class="num" id="3983843">3</span><span class="op" id="3983844">,</span>&nbsp;<span class="num" id="3983846">6</span><span class="op" id="3983847">,</span>&nbsp;<span class="num" id="3983849">1</span><span class="op" id="3983850">,</span>&nbsp;<span class="num" id="3983852">4</span><span class="op" id="3983853">,</span>&nbsp;<span class="num" id="3983855">1</span><span class="op" id="3983856">,</span>&nbsp;<span class="num" id="3983858">311</span><span class="op" id="3983861">,</span>&nbsp;<span class="num" id="3983863">10</span><span class="op" id="3983865">,</span>&nbsp;<span class="num" id="3983867">3</span><span class="op" id="3983868">,</span>&nbsp;<span class="num" id="3983870">3</span><span class="op" id="3983871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3983874">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="3983915">=</span>&nbsp;<span class="ident" id="3983917">asn1</span><span class="op" id="3983921">.</span><span class="ident" id="3983922">ObjectIdentifier</span><span class="op" id="3983938">{</span><span class="num" id="3983939">2</span><span class="op" id="3983940">,</span>&nbsp;<span class="num" id="3983942">16</span><span class="op" id="3983944">,</span>&nbsp;<span class="num" id="3983946">840</span><span class="op" id="3983949">,</span>&nbsp;<span class="num" id="3983951">1</span><span class="op" id="3983952">,</span>&nbsp;<span class="num" id="3983954">113730</span><span class="op" id="3983960">,</span>&nbsp;<span class="num" id="3983962">4</span><span class="op" id="3983963">,</span>&nbsp;<span class="num" id="3983965">1</span><span class="op" id="3983966">}</span><br>
<span class="lineno">400</span><span class="op" id="3983968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3983971">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3984056">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3984118">type</span>&nbsp;<span class="ident" id="3984123">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="3984135">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3984140">const</span>&nbsp;<span class="op" id="3984146">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984149">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="3984164">ExtKeyUsage</span>&nbsp;<span class="op" id="3984176">=</span>&nbsp;<span class="ident" id="3984178">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984184">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984207">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984230">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984254">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984282">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984309">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984333">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984355">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984380">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984404">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984443">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="3984480">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="3984483">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="3984559">var</span>&nbsp;<span class="ident" id="3984563">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3984579">=</span>&nbsp;<span class="op" id="3984581">[</span><span class="op" id="3984582">]</span><span class="keyword" id="3984583">struct</span>&nbsp;<span class="op" id="3984590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984593">extKeyUsage</span>&nbsp;<span class="ident" id="3984605">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3984618">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984630">asn1</span><span class="op" id="3984634">.</span><span class="ident" id="3984635">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="3984652">}</span><span class="op" id="3984653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984656">{</span><span class="ident" id="3984657">ExtKeyUsageAny</span><span class="op" id="3984671">,</span>&nbsp;<span class="ident" id="3984673">oidExtKeyUsageAny</span><span class="op" id="3984690">}</span><span class="op" id="3984691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984694">{</span><span class="ident" id="3984695">ExtKeyUsageServerAuth</span><span class="op" id="3984716">,</span>&nbsp;<span class="ident" id="3984718">oidExtKeyUsageServerAuth</span><span class="op" id="3984742">}</span><span class="op" id="3984743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984746">{</span><span class="ident" id="3984747">ExtKeyUsageClientAuth</span><span class="op" id="3984768">,</span>&nbsp;<span class="ident" id="3984770">oidExtKeyUsageClientAuth</span><span class="op" id="3984794">}</span><span class="op" id="3984795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984798">{</span><span class="ident" id="3984799">ExtKeyUsageCodeSigning</span><span class="op" id="3984821">,</span>&nbsp;<span class="ident" id="3984823">oidExtKeyUsageCodeSigning</span><span class="op" id="3984848">}</span><span class="op" id="3984849">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984852">{</span><span class="ident" id="3984853">ExtKeyUsageEmailProtection</span><span class="op" id="3984879">,</span>&nbsp;<span class="ident" id="3984881">oidExtKeyUsageEmailProtection</span><span class="op" id="3984910">}</span><span class="op" id="3984911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984914">{</span><span class="ident" id="3984915">ExtKeyUsageIPSECEndSystem</span><span class="op" id="3984940">,</span>&nbsp;<span class="ident" id="3984942">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="3984970">}</span><span class="op" id="3984971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3984974">{</span><span class="ident" id="3984975">ExtKeyUsageIPSECTunnel</span><span class="op" id="3984997">,</span>&nbsp;<span class="ident" id="3984999">oidExtKeyUsageIPSECTunnel</span><span class="op" id="3985024">}</span><span class="op" id="3985025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985028">{</span><span class="ident" id="3985029">ExtKeyUsageIPSECUser</span><span class="op" id="3985049">,</span>&nbsp;<span class="ident" id="3985051">oidExtKeyUsageIPSECUser</span><span class="op" id="3985074">}</span><span class="op" id="3985075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985078">{</span><span class="ident" id="3985079">ExtKeyUsageTimeStamping</span><span class="op" id="3985102">,</span>&nbsp;<span class="ident" id="3985104">oidExtKeyUsageTimeStamping</span><span class="op" id="3985130">}</span><span class="op" id="3985131">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985134">{</span><span class="ident" id="3985135">ExtKeyUsageOCSPSigning</span><span class="op" id="3985157">,</span>&nbsp;<span class="ident" id="3985159">oidExtKeyUsageOCSPSigning</span><span class="op" id="3985184">}</span><span class="op" id="3985185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985188">{</span><span class="ident" id="3985189">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3985226">,</span>&nbsp;<span class="ident" id="3985228">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3985268">}</span><span class="op" id="3985269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985272">{</span><span class="ident" id="3985273">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3985309">,</span>&nbsp;<span class="ident" id="3985311">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3985350">}</span><span class="op" id="3985351">,</span><br>
<span class="lineno"></span><span class="op" id="3985353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="3985356">func</span>&nbsp;<span class="ident" id="3985361">extKeyUsageFromOID</span><span class="op" id="3985379">(</span><span class="ident" id="3985380">oid</span>&nbsp;<span class="ident" id="3985384">asn1</span><span class="op" id="3985388">.</span><span class="ident" id="3985389">ObjectIdentifier</span><span class="op" id="3985405">)</span>&nbsp;<span class="op" id="3985407">(</span><span class="ident" id="3985408">eku</span>&nbsp;<span class="ident" id="3985412">ExtKeyUsage</span><span class="op" id="3985423">,</span>&nbsp;<span class="ident" id="3985425">ok</span>&nbsp;<span class="builtintype" id="3985428">bool</span><span class="op" id="3985432">)</span>&nbsp;<span class="op" id="3985434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985437">for</span>&nbsp;<span class="ident" id="3985441">_</span><span class="op" id="3985442">,</span>&nbsp;<span class="ident" id="3985444">pair</span>&nbsp;<span class="op" id="3985449">:=</span>&nbsp;<span class="keyword" id="3985452">range</span>&nbsp;<span class="ident" id="3985458">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3985474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985478">if</span>&nbsp;<span class="ident" id="3985481">oid</span><span class="op" id="3985484">.</span><span class="ident" id="3985485">Equal</span><span class="op" id="3985490">(</span><span class="ident" id="3985491">pair</span><span class="op" id="3985495">.</span><span class="ident" id="3985496">oid</span><span class="op" id="3985499">)</span>&nbsp;<span class="op" id="3985501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985506">return</span>&nbsp;<span class="ident" id="3985513">pair</span><span class="op" id="3985517">.</span><span class="ident" id="3985518">extKeyUsage</span><span class="op" id="3985529">,</span>&nbsp;<span class="builtintype" id="3985531">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985538">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985544">return</span><br>
<span class="lineno"></span><span class="op" id="3985551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3985554">func</span>&nbsp;<span class="ident" id="3985559">oidFromExtKeyUsage</span><span class="op" id="3985577">(</span><span class="ident" id="3985578">eku</span>&nbsp;<span class="ident" id="3985582">ExtKeyUsage</span><span class="op" id="3985593">)</span>&nbsp;<span class="op" id="3985595">(</span><span class="ident" id="3985596">oid</span>&nbsp;<span class="ident" id="3985600">asn1</span><span class="op" id="3985604">.</span><span class="ident" id="3985605">ObjectIdentifier</span><span class="op" id="3985621">,</span>&nbsp;<span class="ident" id="3985623">ok</span>&nbsp;<span class="builtintype" id="3985626">bool</span><span class="op" id="3985630">)</span>&nbsp;<span class="op" id="3985632">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985635">for</span>&nbsp;<span class="ident" id="3985639">_</span><span class="op" id="3985640">,</span>&nbsp;<span class="ident" id="3985642">pair</span>&nbsp;<span class="op" id="3985647">:=</span>&nbsp;<span class="keyword" id="3985650">range</span>&nbsp;<span class="ident" id="3985656">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3985672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985676">if</span>&nbsp;<span class="ident" id="3985679">eku</span>&nbsp;<span class="op" id="3985683">==</span>&nbsp;<span class="ident" id="3985686">pair</span><span class="op" id="3985690">.</span><span class="ident" id="3985691">extKeyUsage</span>&nbsp;<span class="op" id="3985703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985708">return</span>&nbsp;<span class="ident" id="3985715">pair</span><span class="op" id="3985719">.</span><span class="ident" id="3985720">oid</span><span class="op" id="3985723">,</span>&nbsp;<span class="builtintype" id="3985725">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3985735">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3985738">return</span><br>
<span class="lineno"></span><span class="op" id="3985745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3985748">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="3985798">type</span>&nbsp;<span class="ident" id="3985803">Certificate</span>&nbsp;<span class="keyword" id="3985815">struct</span>&nbsp;<span class="op" id="3985822">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3985825">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3985849">[</span><span class="op" id="3985850">]</span><span class="builtintype" id="3985851">byte</span>&nbsp;<span class="comment" id="3985856">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3985937">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3985961">[</span><span class="op" id="3985962">]</span><span class="builtintype" id="3985963">byte</span>&nbsp;<span class="comment" id="3985968">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986015">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3986039">[</span><span class="op" id="3986040">]</span><span class="builtintype" id="3986041">byte</span>&nbsp;<span class="comment" id="3986046">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986084">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986108">[</span><span class="op" id="3986109">]</span><span class="builtintype" id="3986110">byte</span>&nbsp;<span class="comment" id="3986115">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986139">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986163">[</span><span class="op" id="3986164">]</span><span class="builtintype" id="3986165">byte</span>&nbsp;<span class="comment" id="3986170">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986194">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986213">[</span><span class="op" id="3986214">]</span><span class="builtintype" id="3986215">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986221">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3986240">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986261">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3986280">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986300">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986319">interface</span><span class="op" id="3986328">{</span><span class="op" id="3986329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986333">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3986353">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986358">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986378">*</span><span class="ident" id="3986379">big</span><span class="op" id="3986382">.</span><span class="ident" id="3986383">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986388">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986408">pkix</span><span class="op" id="3986412">.</span><span class="ident" id="3986413">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986419">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986439">pkix</span><span class="op" id="3986443">.</span><span class="ident" id="3986444">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986450">NotBefore</span><span class="op" id="3986459">,</span>&nbsp;<span class="ident" id="3986461">NotAfter</span>&nbsp;<span class="ident" id="3986470">time</span><span class="op" id="3986474">.</span><span class="ident" id="3986475">Time</span>&nbsp;<span class="comment" id="3986480">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986501">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986521">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986532">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986605">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986674">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986747">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3986790">Extensions</span>&nbsp;<span class="op" id="3986801">[</span><span class="op" id="3986802">]</span><span class="ident" id="3986803">pkix</span><span class="op" id="3986807">.</span><span class="ident" id="3986808">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986820">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986888">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3986958">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987031">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987101">ExtraExtensions</span>&nbsp;<span class="op" id="3987117">[</span><span class="op" id="3987118">]</span><span class="ident" id="3987119">pkix</span><span class="op" id="3987123">.</span><span class="ident" id="3987124">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987136">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987155">[</span><span class="op" id="3987156">]</span><span class="ident" id="3987157">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987179">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987216">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3987235">[</span><span class="op" id="3987236">]</span><span class="ident" id="3987237">asn1</span><span class="op" id="3987241">.</span><span class="ident" id="3987242">ObjectIdentifier</span>&nbsp;<span class="comment" id="3987259">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987321">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="3987343">bool</span>&nbsp;<span class="comment" id="3987348">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987396">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3987418">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987424">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3987446">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987451">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987517">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987590">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987660">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987679">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="3987694">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987701">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3987716">[</span><span class="op" id="3987717">]</span><span class="builtintype" id="3987718">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987724">AuthorityKeyId</span>&nbsp;<span class="op" id="3987739">[</span><span class="op" id="3987740">]</span><span class="builtintype" id="3987741">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987748">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987801">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987823">[</span><span class="op" id="3987824">]</span><span class="builtintype" id="3987825">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987833">IssuingCertificateURL</span>&nbsp;<span class="op" id="3987855">[</span><span class="op" id="3987856">]</span><span class="builtintype" id="3987857">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987866">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987900">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987915">[</span><span class="op" id="3987916">]</span><span class="builtintype" id="3987917">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987925">EmailAddresses</span>&nbsp;<span class="op" id="3987940">[</span><span class="op" id="3987941">]</span><span class="builtintype" id="3987942">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987950">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987965">[</span><span class="op" id="3987966">]</span><span class="ident" id="3987967">net</span><span class="op" id="3987970">.</span><span class="ident" id="3987971">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3987976">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3987997">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="3988025">bool</span>&nbsp;<span class="comment" id="3988030">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988089">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988117">[</span><span class="op" id="3988118">]</span><span class="builtintype" id="3988119">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3988128">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988156">CRLDistributionPoints</span>&nbsp;<span class="op" id="3988178">[</span><span class="op" id="3988179">]</span><span class="builtintype" id="3988180">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988189">PolicyIdentifiers</span>&nbsp;<span class="op" id="3988207">[</span><span class="op" id="3988208">]</span><span class="ident" id="3988209">asn1</span><span class="op" id="3988213">.</span><span class="ident" id="3988214">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="3988231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3988234">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3988314">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="3988373">var</span>&nbsp;<span class="ident" id="3988377">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="3988401">=</span>&nbsp;<span class="ident" id="3988403">errors</span><span class="op" id="3988409">.</span><span class="ident" id="3988410">New</span><span class="op" id="3988413">(</span><span class="string" id="3988414">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="3988470">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3988473">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="3988552">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3988632">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3988660">type</span>&nbsp;<span class="ident" id="3988665">ConstraintViolationError</span>&nbsp;<span class="keyword" id="3988690">struct</span><span class="op" id="3988696">{</span><span class="op" id="3988697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3988700">func</span>&nbsp;<span class="op" id="3988705">(</span><span class="ident" id="3988706">ConstraintViolationError</span><span class="op" id="3988730">)</span>&nbsp;<span class="ident" id="3988732">Error</span><span class="op" id="3988737">(</span><span class="op" id="3988738">)</span>&nbsp;<span class="builtintype" id="3988740">string</span>&nbsp;<span class="op" id="3988747">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3988750">return</span>&nbsp;<span class="string" id="3988757">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="3988840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3988843">func</span>&nbsp;<span class="op" id="3988848">(</span><span class="ident" id="3988849">c</span>&nbsp;<span class="op" id="3988851">*</span><span class="ident" id="3988852">Certificate</span><span class="op" id="3988863">)</span>&nbsp;<span class="ident" id="3988865">Equal</span><span class="op" id="3988870">(</span><span class="ident" id="3988871">other</span>&nbsp;<span class="op" id="3988877">*</span><span class="ident" id="3988878">Certificate</span><span class="op" id="3988889">)</span>&nbsp;<span class="builtintype" id="3988891">bool</span>&nbsp;<span class="op" id="3988896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3988899">return</span>&nbsp;<span class="ident" id="3988906">bytes</span><span class="op" id="3988911">.</span><span class="ident" id="3988912">Equal</span><span class="op" id="3988917">(</span><span class="ident" id="3988918">c</span><span class="op" id="3988919">.</span><span class="ident" id="3988920">Raw</span><span class="op" id="3988923">,</span>&nbsp;<span class="ident" id="3988925">other</span><span class="op" id="3988930">.</span><span class="ident" id="3988931">Raw</span><span class="op" id="3988934">)</span><br>
<span class="lineno">540</span><span class="op" id="3988936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3988939">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="3989011">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="3989091">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="3989113">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3989188">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="3989231">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="3989297">//</span><br>
<span class="lineno"></span><span class="comment" id="3989300">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="3989372">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="3989387">var</span>&nbsp;<span class="ident" id="3989391">entrustBrokenSPKI</span>&nbsp;<span class="op" id="3989409">=</span>&nbsp;<span class="op" id="3989411">[</span><span class="op" id="3989412">]</span><span class="builtintype" id="3989413">byte</span><span class="op" id="3989417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989420">0x30</span><span class="op" id="3989424">,</span>&nbsp;<span class="num" id="3989426">0x82</span><span class="op" id="3989430">,</span>&nbsp;<span class="num" id="3989432">0x01</span><span class="op" id="3989436">,</span>&nbsp;<span class="num" id="3989438">0x22</span><span class="op" id="3989442">,</span>&nbsp;<span class="num" id="3989444">0x30</span><span class="op" id="3989448">,</span>&nbsp;<span class="num" id="3989450">0x0d</span><span class="op" id="3989454">,</span>&nbsp;<span class="num" id="3989456">0x06</span><span class="op" id="3989460">,</span>&nbsp;<span class="num" id="3989462">0x09</span><span class="op" id="3989466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989469">0x2a</span><span class="op" id="3989473">,</span>&nbsp;<span class="num" id="3989475">0x86</span><span class="op" id="3989479">,</span>&nbsp;<span class="num" id="3989481">0x48</span><span class="op" id="3989485">,</span>&nbsp;<span class="num" id="3989487">0x86</span><span class="op" id="3989491">,</span>&nbsp;<span class="num" id="3989493">0xf7</span><span class="op" id="3989497">,</span>&nbsp;<span class="num" id="3989499">0x0d</span><span class="op" id="3989503">,</span>&nbsp;<span class="num" id="3989505">0x01</span><span class="op" id="3989509">,</span>&nbsp;<span class="num" id="3989511">0x01</span><span class="op" id="3989515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989518">0x01</span><span class="op" id="3989522">,</span>&nbsp;<span class="num" id="3989524">0x05</span><span class="op" id="3989528">,</span>&nbsp;<span class="num" id="3989530">0x00</span><span class="op" id="3989534">,</span>&nbsp;<span class="num" id="3989536">0x03</span><span class="op" id="3989540">,</span>&nbsp;<span class="num" id="3989542">0x82</span><span class="op" id="3989546">,</span>&nbsp;<span class="num" id="3989548">0x01</span><span class="op" id="3989552">,</span>&nbsp;<span class="num" id="3989554">0x0f</span><span class="op" id="3989558">,</span>&nbsp;<span class="num" id="3989560">0x00</span><span class="op" id="3989564">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989567">0x30</span><span class="op" id="3989571">,</span>&nbsp;<span class="num" id="3989573">0x82</span><span class="op" id="3989577">,</span>&nbsp;<span class="num" id="3989579">0x01</span><span class="op" id="3989583">,</span>&nbsp;<span class="num" id="3989585">0x0a</span><span class="op" id="3989589">,</span>&nbsp;<span class="num" id="3989591">0x02</span><span class="op" id="3989595">,</span>&nbsp;<span class="num" id="3989597">0x82</span><span class="op" id="3989601">,</span>&nbsp;<span class="num" id="3989603">0x01</span><span class="op" id="3989607">,</span>&nbsp;<span class="num" id="3989609">0x01</span><span class="op" id="3989613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989616">0x00</span><span class="op" id="3989620">,</span>&nbsp;<span class="num" id="3989622">0x97</span><span class="op" id="3989626">,</span>&nbsp;<span class="num" id="3989628">0xa3</span><span class="op" id="3989632">,</span>&nbsp;<span class="num" id="3989634">0x2d</span><span class="op" id="3989638">,</span>&nbsp;<span class="num" id="3989640">0x3c</span><span class="op" id="3989644">,</span>&nbsp;<span class="num" id="3989646">0x9e</span><span class="op" id="3989650">,</span>&nbsp;<span class="num" id="3989652">0xde</span><span class="op" id="3989656">,</span>&nbsp;<span class="num" id="3989658">0x05</span><span class="op" id="3989662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989665">0xda</span><span class="op" id="3989669">,</span>&nbsp;<span class="num" id="3989671">0x13</span><span class="op" id="3989675">,</span>&nbsp;<span class="num" id="3989677">0xc2</span><span class="op" id="3989681">,</span>&nbsp;<span class="num" id="3989683">0x11</span><span class="op" id="3989687">,</span>&nbsp;<span class="num" id="3989689">0x8d</span><span class="op" id="3989693">,</span>&nbsp;<span class="num" id="3989695">0x9d</span><span class="op" id="3989699">,</span>&nbsp;<span class="num" id="3989701">0x8e</span><span class="op" id="3989705">,</span>&nbsp;<span class="num" id="3989707">0xe3</span><span class="op" id="3989711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989714">0x7f</span><span class="op" id="3989718">,</span>&nbsp;<span class="num" id="3989720">0xc7</span><span class="op" id="3989724">,</span>&nbsp;<span class="num" id="3989726">0x4b</span><span class="op" id="3989730">,</span>&nbsp;<span class="num" id="3989732">0x7e</span><span class="op" id="3989736">,</span>&nbsp;<span class="num" id="3989738">0x5a</span><span class="op" id="3989742">,</span>&nbsp;<span class="num" id="3989744">0x9f</span><span class="op" id="3989748">,</span>&nbsp;<span class="num" id="3989750">0xb3</span><span class="op" id="3989754">,</span>&nbsp;<span class="num" id="3989756">0xff</span><span class="op" id="3989760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989763">0x62</span><span class="op" id="3989767">,</span>&nbsp;<span class="num" id="3989769">0xab</span><span class="op" id="3989773">,</span>&nbsp;<span class="num" id="3989775">0x73</span><span class="op" id="3989779">,</span>&nbsp;<span class="num" id="3989781">0xc8</span><span class="op" id="3989785">,</span>&nbsp;<span class="num" id="3989787">0x28</span><span class="op" id="3989791">,</span>&nbsp;<span class="num" id="3989793">0x6b</span><span class="op" id="3989797">,</span>&nbsp;<span class="num" id="3989799">0xba</span><span class="op" id="3989803">,</span>&nbsp;<span class="num" id="3989805">0x10</span><span class="op" id="3989809">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989812">0x64</span><span class="op" id="3989816">,</span>&nbsp;<span class="num" id="3989818">0x82</span><span class="op" id="3989822">,</span>&nbsp;<span class="num" id="3989824">0x87</span><span class="op" id="3989828">,</span>&nbsp;<span class="num" id="3989830">0x13</span><span class="op" id="3989834">,</span>&nbsp;<span class="num" id="3989836">0xcd</span><span class="op" id="3989840">,</span>&nbsp;<span class="num" id="3989842">0x57</span><span class="op" id="3989846">,</span>&nbsp;<span class="num" id="3989848">0x18</span><span class="op" id="3989852">,</span>&nbsp;<span class="num" id="3989854">0xff</span><span class="op" id="3989858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989861">0x28</span><span class="op" id="3989865">,</span>&nbsp;<span class="num" id="3989867">0xce</span><span class="op" id="3989871">,</span>&nbsp;<span class="num" id="3989873">0xc0</span><span class="op" id="3989877">,</span>&nbsp;<span class="num" id="3989879">0xe6</span><span class="op" id="3989883">,</span>&nbsp;<span class="num" id="3989885">0x0e</span><span class="op" id="3989889">,</span>&nbsp;<span class="num" id="3989891">0x06</span><span class="op" id="3989895">,</span>&nbsp;<span class="num" id="3989897">0x91</span><span class="op" id="3989901">,</span>&nbsp;<span class="num" id="3989903">0x50</span><span class="op" id="3989907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989910">0x29</span><span class="op" id="3989914">,</span>&nbsp;<span class="num" id="3989916">0x83</span><span class="op" id="3989920">,</span>&nbsp;<span class="num" id="3989922">0xd1</span><span class="op" id="3989926">,</span>&nbsp;<span class="num" id="3989928">0xf2</span><span class="op" id="3989932">,</span>&nbsp;<span class="num" id="3989934">0xc3</span><span class="op" id="3989938">,</span>&nbsp;<span class="num" id="3989940">0x2a</span><span class="op" id="3989944">,</span>&nbsp;<span class="num" id="3989946">0xdb</span><span class="op" id="3989950">,</span>&nbsp;<span class="num" id="3989952">0xd8</span><span class="op" id="3989956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3989959">0xdb</span><span class="op" id="3989963">,</span>&nbsp;<span class="num" id="3989965">0x4e</span><span class="op" id="3989969">,</span>&nbsp;<span class="num" id="3989971">0x04</span><span class="op" id="3989975">,</span>&nbsp;<span class="num" id="3989977">0xcc</span><span class="op" id="3989981">,</span>&nbsp;<span class="num" id="3989983">0x00</span><span class="op" id="3989987">,</span>&nbsp;<span class="num" id="3989989">0xeb</span><span class="op" id="3989993">,</span>&nbsp;<span class="num" id="3989995">0x8b</span><span class="op" id="3989999">,</span>&nbsp;<span class="num" id="3990001">0xb6</span><span class="op" id="3990005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990008">0x96</span><span class="op" id="3990012">,</span>&nbsp;<span class="num" id="3990014">0xdc</span><span class="op" id="3990018">,</span>&nbsp;<span class="num" id="3990020">0xbc</span><span class="op" id="3990024">,</span>&nbsp;<span class="num" id="3990026">0xaa</span><span class="op" id="3990030">,</span>&nbsp;<span class="num" id="3990032">0xfa</span><span class="op" id="3990036">,</span>&nbsp;<span class="num" id="3990038">0x52</span><span class="op" id="3990042">,</span>&nbsp;<span class="num" id="3990044">0x77</span><span class="op" id="3990048">,</span>&nbsp;<span class="num" id="3990050">0x04</span><span class="op" id="3990054">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990057">0xc1</span><span class="op" id="3990061">,</span>&nbsp;<span class="num" id="3990063">0xdb</span><span class="op" id="3990067">,</span>&nbsp;<span class="num" id="3990069">0x19</span><span class="op" id="3990073">,</span>&nbsp;<span class="num" id="3990075">0xe4</span><span class="op" id="3990079">,</span>&nbsp;<span class="num" id="3990081">0xae</span><span class="op" id="3990085">,</span>&nbsp;<span class="num" id="3990087">0x9c</span><span class="op" id="3990091">,</span>&nbsp;<span class="num" id="3990093">0xfd</span><span class="op" id="3990097">,</span>&nbsp;<span class="num" id="3990099">0x3c</span><span class="op" id="3990103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990106">0x8b</span><span class="op" id="3990110">,</span>&nbsp;<span class="num" id="3990112">0x03</span><span class="op" id="3990116">,</span>&nbsp;<span class="num" id="3990118">0xef</span><span class="op" id="3990122">,</span>&nbsp;<span class="num" id="3990124">0x4d</span><span class="op" id="3990128">,</span>&nbsp;<span class="num" id="3990130">0xbc</span><span class="op" id="3990134">,</span>&nbsp;<span class="num" id="3990136">0x1a</span><span class="op" id="3990140">,</span>&nbsp;<span class="num" id="3990142">0x03</span><span class="op" id="3990146">,</span>&nbsp;<span class="num" id="3990148">0x65</span><span class="op" id="3990152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990155">0xf9</span><span class="op" id="3990159">,</span>&nbsp;<span class="num" id="3990161">0xc1</span><span class="op" id="3990165">,</span>&nbsp;<span class="num" id="3990167">0xb1</span><span class="op" id="3990171">,</span>&nbsp;<span class="num" id="3990173">0x3f</span><span class="op" id="3990177">,</span>&nbsp;<span class="num" id="3990179">0x72</span><span class="op" id="3990183">,</span>&nbsp;<span class="num" id="3990185">0x86</span><span class="op" id="3990189">,</span>&nbsp;<span class="num" id="3990191">0xf2</span><span class="op" id="3990195">,</span>&nbsp;<span class="num" id="3990197">0x38</span><span class="op" id="3990201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990204">0xaa</span><span class="op" id="3990208">,</span>&nbsp;<span class="num" id="3990210">0x19</span><span class="op" id="3990214">,</span>&nbsp;<span class="num" id="3990216">0xae</span><span class="op" id="3990220">,</span>&nbsp;<span class="num" id="3990222">0x10</span><span class="op" id="3990226">,</span>&nbsp;<span class="num" id="3990228">0x88</span><span class="op" id="3990232">,</span>&nbsp;<span class="num" id="3990234">0x78</span><span class="op" id="3990238">,</span>&nbsp;<span class="num" id="3990240">0x28</span><span class="op" id="3990244">,</span>&nbsp;<span class="num" id="3990246">0xda</span><span class="op" id="3990250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990253">0x75</span><span class="op" id="3990257">,</span>&nbsp;<span class="num" id="3990259">0xc3</span><span class="op" id="3990263">,</span>&nbsp;<span class="num" id="3990265">0x3d</span><span class="op" id="3990269">,</span>&nbsp;<span class="num" id="3990271">0x02</span><span class="op" id="3990275">,</span>&nbsp;<span class="num" id="3990277">0x82</span><span class="op" id="3990281">,</span>&nbsp;<span class="num" id="3990283">0x02</span><span class="op" id="3990287">,</span>&nbsp;<span class="num" id="3990289">0x9c</span><span class="op" id="3990293">,</span>&nbsp;<span class="num" id="3990295">0xb9</span><span class="op" id="3990299">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990302">0xc1</span><span class="op" id="3990306">,</span>&nbsp;<span class="num" id="3990308">0x65</span><span class="op" id="3990312">,</span>&nbsp;<span class="num" id="3990314">0x77</span><span class="op" id="3990318">,</span>&nbsp;<span class="num" id="3990320">0x76</span><span class="op" id="3990324">,</span>&nbsp;<span class="num" id="3990326">0x24</span><span class="op" id="3990330">,</span>&nbsp;<span class="num" id="3990332">0x4c</span><span class="op" id="3990336">,</span>&nbsp;<span class="num" id="3990338">0x98</span><span class="op" id="3990342">,</span>&nbsp;<span class="num" id="3990344">0xf7</span><span class="op" id="3990348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990351">0x6d</span><span class="op" id="3990355">,</span>&nbsp;<span class="num" id="3990357">0x31</span><span class="op" id="3990361">,</span>&nbsp;<span class="num" id="3990363">0x38</span><span class="op" id="3990367">,</span>&nbsp;<span class="num" id="3990369">0xfb</span><span class="op" id="3990373">,</span>&nbsp;<span class="num" id="3990375">0xdb</span><span class="op" id="3990379">,</span>&nbsp;<span class="num" id="3990381">0xfe</span><span class="op" id="3990385">,</span>&nbsp;<span class="num" id="3990387">0xdb</span><span class="op" id="3990391">,</span>&nbsp;<span class="num" id="3990393">0x37</span><span class="op" id="3990397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990400">0x02</span><span class="op" id="3990404">,</span>&nbsp;<span class="num" id="3990406">0x76</span><span class="op" id="3990410">,</span>&nbsp;<span class="num" id="3990412">0xa1</span><span class="op" id="3990416">,</span>&nbsp;<span class="num" id="3990418">0x18</span><span class="op" id="3990422">,</span>&nbsp;<span class="num" id="3990424">0x97</span><span class="op" id="3990428">,</span>&nbsp;<span class="num" id="3990430">0xa6</span><span class="op" id="3990434">,</span>&nbsp;<span class="num" id="3990436">0xcc</span><span class="op" id="3990440">,</span>&nbsp;<span class="num" id="3990442">0xde</span><span class="op" id="3990446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990449">0x20</span><span class="op" id="3990453">,</span>&nbsp;<span class="num" id="3990455">0x09</span><span class="op" id="3990459">,</span>&nbsp;<span class="num" id="3990461">0x49</span><span class="op" id="3990465">,</span>&nbsp;<span class="num" id="3990467">0x36</span><span class="op" id="3990471">,</span>&nbsp;<span class="num" id="3990473">0x24</span><span class="op" id="3990477">,</span>&nbsp;<span class="num" id="3990479">0x69</span><span class="op" id="3990483">,</span>&nbsp;<span class="num" id="3990485">0x42</span><span class="op" id="3990489">,</span>&nbsp;<span class="num" id="3990491">0xf6</span><span class="op" id="3990495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990498">0xe4</span><span class="op" id="3990502">,</span>&nbsp;<span class="num" id="3990504">0x37</span><span class="op" id="3990508">,</span>&nbsp;<span class="num" id="3990510">0x62</span><span class="op" id="3990514">,</span>&nbsp;<span class="num" id="3990516">0xf1</span><span class="op" id="3990520">,</span>&nbsp;<span class="num" id="3990522">0x59</span><span class="op" id="3990526">,</span>&nbsp;<span class="num" id="3990528">0x6d</span><span class="op" id="3990532">,</span>&nbsp;<span class="num" id="3990534">0xa9</span><span class="op" id="3990538">,</span>&nbsp;<span class="num" id="3990540">0x3c</span><span class="op" id="3990544">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990547">0xed</span><span class="op" id="3990551">,</span>&nbsp;<span class="num" id="3990553">0x34</span><span class="op" id="3990557">,</span>&nbsp;<span class="num" id="3990559">0x9c</span><span class="op" id="3990563">,</span>&nbsp;<span class="num" id="3990565">0xa3</span><span class="op" id="3990569">,</span>&nbsp;<span class="num" id="3990571">0x8e</span><span class="op" id="3990575">,</span>&nbsp;<span class="num" id="3990577">0xdb</span><span class="op" id="3990581">,</span>&nbsp;<span class="num" id="3990583">0xdc</span><span class="op" id="3990587">,</span>&nbsp;<span class="num" id="3990589">0x3a</span><span class="op" id="3990593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990596">0xd7</span><span class="op" id="3990600">,</span>&nbsp;<span class="num" id="3990602">0xf7</span><span class="op" id="3990606">,</span>&nbsp;<span class="num" id="3990608">0x0a</span><span class="op" id="3990612">,</span>&nbsp;<span class="num" id="3990614">0x6f</span><span class="op" id="3990618">,</span>&nbsp;<span class="num" id="3990620">0xef</span><span class="op" id="3990624">,</span>&nbsp;<span class="num" id="3990626">0x2e</span><span class="op" id="3990630">,</span>&nbsp;<span class="num" id="3990632">0xd8</span><span class="op" id="3990636">,</span>&nbsp;<span class="num" id="3990638">0xd5</span><span class="op" id="3990642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990645">0x93</span><span class="op" id="3990649">,</span>&nbsp;<span class="num" id="3990651">0x5a</span><span class="op" id="3990655">,</span>&nbsp;<span class="num" id="3990657">0x7a</span><span class="op" id="3990661">,</span>&nbsp;<span class="num" id="3990663">0xed</span><span class="op" id="3990667">,</span>&nbsp;<span class="num" id="3990669">0x08</span><span class="op" id="3990673">,</span>&nbsp;<span class="num" id="3990675">0x49</span><span class="op" id="3990679">,</span>&nbsp;<span class="num" id="3990681">0x68</span><span class="op" id="3990685">,</span>&nbsp;<span class="num" id="3990687">0xe2</span><span class="op" id="3990691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990694">0x41</span><span class="op" id="3990698">,</span>&nbsp;<span class="num" id="3990700">0xe3</span><span class="op" id="3990704">,</span>&nbsp;<span class="num" id="3990706">0x5a</span><span class="op" id="3990710">,</span>&nbsp;<span class="num" id="3990712">0x90</span><span class="op" id="3990716">,</span>&nbsp;<span class="num" id="3990718">0xc1</span><span class="op" id="3990722">,</span>&nbsp;<span class="num" id="3990724">0x86</span><span class="op" id="3990728">,</span>&nbsp;<span class="num" id="3990730">0x55</span><span class="op" id="3990734">,</span>&nbsp;<span class="num" id="3990736">0xfc</span><span class="op" id="3990740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990743">0x51</span><span class="op" id="3990747">,</span>&nbsp;<span class="num" id="3990749">0x43</span><span class="op" id="3990753">,</span>&nbsp;<span class="num" id="3990755">0x9d</span><span class="op" id="3990759">,</span>&nbsp;<span class="num" id="3990761">0xe0</span><span class="op" id="3990765">,</span>&nbsp;<span class="num" id="3990767">0xb2</span><span class="op" id="3990771">,</span>&nbsp;<span class="num" id="3990773">0xc4</span><span class="op" id="3990777">,</span>&nbsp;<span class="num" id="3990779">0x67</span><span class="op" id="3990783">,</span>&nbsp;<span class="num" id="3990785">0xb4</span><span class="op" id="3990789">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990792">0xcb</span><span class="op" id="3990796">,</span>&nbsp;<span class="num" id="3990798">0x32</span><span class="op" id="3990802">,</span>&nbsp;<span class="num" id="3990804">0x31</span><span class="op" id="3990808">,</span>&nbsp;<span class="num" id="3990810">0x25</span><span class="op" id="3990814">,</span>&nbsp;<span class="num" id="3990816">0xf0</span><span class="op" id="3990820">,</span>&nbsp;<span class="num" id="3990822">0x54</span><span class="op" id="3990826">,</span>&nbsp;<span class="num" id="3990828">0x9f</span><span class="op" id="3990832">,</span>&nbsp;<span class="num" id="3990834">0x4b</span><span class="op" id="3990838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990841">0xd1</span><span class="op" id="3990845">,</span>&nbsp;<span class="num" id="3990847">0x6f</span><span class="op" id="3990851">,</span>&nbsp;<span class="num" id="3990853">0xdb</span><span class="op" id="3990857">,</span>&nbsp;<span class="num" id="3990859">0xd4</span><span class="op" id="3990863">,</span>&nbsp;<span class="num" id="3990865">0xdd</span><span class="op" id="3990869">,</span>&nbsp;<span class="num" id="3990871">0xfc</span><span class="op" id="3990875">,</span>&nbsp;<span class="num" id="3990877">0xaf</span><span class="op" id="3990881">,</span>&nbsp;<span class="num" id="3990883">0x5e</span><span class="op" id="3990887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990890">0x6c</span><span class="op" id="3990894">,</span>&nbsp;<span class="num" id="3990896">0x78</span><span class="op" id="3990900">,</span>&nbsp;<span class="num" id="3990902">0x90</span><span class="op" id="3990906">,</span>&nbsp;<span class="num" id="3990908">0x95</span><span class="op" id="3990912">,</span>&nbsp;<span class="num" id="3990914">0xde</span><span class="op" id="3990918">,</span>&nbsp;<span class="num" id="3990920">0xca</span><span class="op" id="3990924">,</span>&nbsp;<span class="num" id="3990926">0x3a</span><span class="op" id="3990930">,</span>&nbsp;<span class="num" id="3990932">0x48</span><span class="op" id="3990936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990939">0xb9</span><span class="op" id="3990943">,</span>&nbsp;<span class="num" id="3990945">0x79</span><span class="op" id="3990949">,</span>&nbsp;<span class="num" id="3990951">0x3c</span><span class="op" id="3990955">,</span>&nbsp;<span class="num" id="3990957">0x9b</span><span class="op" id="3990961">,</span>&nbsp;<span class="num" id="3990963">0x19</span><span class="op" id="3990967">,</span>&nbsp;<span class="num" id="3990969">0xd6</span><span class="op" id="3990973">,</span>&nbsp;<span class="num" id="3990975">0x75</span><span class="op" id="3990979">,</span>&nbsp;<span class="num" id="3990981">0x05</span><span class="op" id="3990985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3990988">0xa0</span><span class="op" id="3990992">,</span>&nbsp;<span class="num" id="3990994">0xf9</span><span class="op" id="3990998">,</span>&nbsp;<span class="num" id="3991000">0x88</span><span class="op" id="3991004">,</span>&nbsp;<span class="num" id="3991006">0xd7</span><span class="op" id="3991010">,</span>&nbsp;<span class="num" id="3991012">0xc1</span><span class="op" id="3991016">,</span>&nbsp;<span class="num" id="3991018">0xe8</span><span class="op" id="3991022">,</span>&nbsp;<span class="num" id="3991024">0xa5</span><span class="op" id="3991028">,</span>&nbsp;<span class="num" id="3991030">0x09</span><span class="op" id="3991034">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3991037">0xe4</span><span class="op" id="3991041">,</span>&nbsp;<span class="num" id="3991043">0x1a</span><span class="op" id="3991047">,</span>&nbsp;<span class="num" id="3991049">0x15</span><span class="op" id="3991053">,</span>&nbsp;<span class="num" id="3991055">0xdc</span><span class="op" id="3991059">,</span>&nbsp;<span class="num" id="3991061">0x87</span><span class="op" id="3991065">,</span>&nbsp;<span class="num" id="3991067">0x23</span><span class="op" id="3991071">,</span>&nbsp;<span class="num" id="3991073">0xaa</span><span class="op" id="3991077">,</span>&nbsp;<span class="num" id="3991079">0xb2</span><span class="op" id="3991083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3991086">0x75</span><span class="op" id="3991090">,</span>&nbsp;<span class="num" id="3991092">0x8c</span><span class="op" id="3991096">,</span>&nbsp;<span class="num" id="3991098">0x63</span><span class="op" id="3991102">,</span>&nbsp;<span class="num" id="3991104">0x25</span><span class="op" id="3991108">,</span>&nbsp;<span class="num" id="3991110">0x87</span><span class="op" id="3991114">,</span>&nbsp;<span class="num" id="3991116">0xd8</span><span class="op" id="3991120">,</span>&nbsp;<span class="num" id="3991122">0xf8</span><span class="op" id="3991126">,</span>&nbsp;<span class="num" id="3991128">0x3d</span><span class="op" id="3991132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3991135">0xa6</span><span class="op" id="3991139">,</span>&nbsp;<span class="num" id="3991141">0xc2</span><span class="op" id="3991145">,</span>&nbsp;<span class="num" id="3991147">0xcc</span><span class="op" id="3991151">,</span>&nbsp;<span class="num" id="3991153">0x66</span><span class="op" id="3991157">,</span>&nbsp;<span class="num" id="3991159">0xff</span><span class="op" id="3991163">,</span>&nbsp;<span class="num" id="3991165">0xa5</span><span class="op" id="3991169">,</span>&nbsp;<span class="num" id="3991171">0x66</span><span class="op" id="3991175">,</span>&nbsp;<span class="num" id="3991177">0x68</span><span class="op" id="3991181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3991184">0x55</span><span class="op" id="3991188">,</span>&nbsp;<span class="num" id="3991190">0x02</span><span class="op" id="3991194">,</span>&nbsp;<span class="num" id="3991196">0x03</span><span class="op" id="3991200">,</span>&nbsp;<span class="num" id="3991202">0x01</span><span class="op" id="3991206">,</span>&nbsp;<span class="num" id="3991208">0x00</span><span class="op" id="3991212">,</span>&nbsp;<span class="num" id="3991214">0x01</span><span class="op" id="3991218">,</span><br>
<span class="lineno"></span><span class="op" id="3991220">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3991223">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="3991299">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="3991315">func</span>&nbsp;<span class="op" id="3991320">(</span><span class="ident" id="3991321">c</span>&nbsp;<span class="op" id="3991323">*</span><span class="ident" id="3991324">Certificate</span><span class="op" id="3991335">)</span>&nbsp;<span class="ident" id="3991337">CheckSignatureFrom</span><span class="op" id="3991355">(</span><span class="ident" id="3991356">parent</span>&nbsp;<span class="op" id="3991363">*</span><span class="ident" id="3991364">Certificate</span><span class="op" id="3991375">)</span>&nbsp;<span class="op" id="3991377">(</span><span class="ident" id="3991378">err</span>&nbsp;<span class="builtintype" id="3991382">error</span><span class="op" id="3991387">)</span>&nbsp;<span class="op" id="3991389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991392">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991415">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991485">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991556">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991627">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3991656">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991718">if</span>&nbsp;<span class="op" id="3991721">(</span><span class="ident" id="3991722">parent</span><span class="op" id="3991728">.</span><span class="ident" id="3991729">Version</span>&nbsp;<span class="op" id="3991737">==</span>&nbsp;<span class="num" id="3991740">3</span>&nbsp;<span class="op" id="3991742">&amp;&amp;</span>&nbsp;<span class="op" id="3991745">!</span><span class="ident" id="3991746">parent</span><span class="op" id="3991752">.</span><span class="ident" id="3991753">BasicConstraintsValid</span>&nbsp;<span class="op" id="3991775">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3991780">parent</span><span class="op" id="3991786">.</span><span class="ident" id="3991787">BasicConstraintsValid</span>&nbsp;<span class="op" id="3991809">&amp;&amp;</span>&nbsp;<span class="op" id="3991812">!</span><span class="ident" id="3991813">parent</span><span class="op" id="3991819">.</span><span class="ident" id="3991820">IsCA</span><span class="op" id="3991824">)</span>&nbsp;<span class="op" id="3991826">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3991831">!</span><span class="ident" id="3991832">bytes</span><span class="op" id="3991837">.</span><span class="ident" id="3991838">Equal</span><span class="op" id="3991843">(</span><span class="ident" id="3991844">c</span><span class="op" id="3991845">.</span><span class="ident" id="3991846">RawSubjectPublicKeyInfo</span><span class="op" id="3991869">,</span>&nbsp;<span class="ident" id="3991871">entrustBrokenSPKI</span><span class="op" id="3991888">)</span>&nbsp;<span class="op" id="3991890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991894">return</span>&nbsp;<span class="ident" id="3991901">ConstraintViolationError</span><span class="op" id="3991925">{</span><span class="op" id="3991926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3991929">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3991933">if</span>&nbsp;<span class="ident" id="3991936">parent</span><span class="op" id="3991942">.</span><span class="ident" id="3991943">KeyUsage</span>&nbsp;<span class="op" id="3991952">!=</span>&nbsp;<span class="num" id="3991955">0</span>&nbsp;<span class="op" id="3991957">&amp;&amp;</span>&nbsp;<span class="ident" id="3991960">parent</span><span class="op" id="3991966">.</span><span class="ident" id="3991967">KeyUsage</span><span class="op" id="3991975">&amp;</span><span class="ident" id="3991976">KeyUsageCertSign</span>&nbsp;<span class="op" id="3991993">==</span>&nbsp;<span class="num" id="3991996">0</span>&nbsp;<span class="op" id="3991998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992002">return</span>&nbsp;<span class="ident" id="3992009">ConstraintViolationError</span><span class="op" id="3992033">{</span><span class="op" id="3992034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3992037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992041">if</span>&nbsp;<span class="ident" id="3992044">parent</span><span class="op" id="3992050">.</span><span class="ident" id="3992051">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3992070">==</span>&nbsp;<span class="ident" id="3992073">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3992099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992103">return</span>&nbsp;<span class="ident" id="3992110">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3992135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3992139">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992196">return</span>&nbsp;<span class="ident" id="3992203">parent</span><span class="op" id="3992209">.</span><span class="ident" id="3992210">CheckSignature</span><span class="op" id="3992224">(</span><span class="ident" id="3992225">c</span><span class="op" id="3992226">.</span><span class="ident" id="3992227">SignatureAlgorithm</span><span class="op" id="3992245">,</span>&nbsp;<span class="ident" id="3992247">c</span><span class="op" id="3992248">.</span><span class="ident" id="3992249">RawTBSCertificate</span><span class="op" id="3992266">,</span>&nbsp;<span class="ident" id="3992268">c</span><span class="op" id="3992269">.</span><span class="ident" id="3992270">Signature</span><span class="op" id="3992279">)</span><br>
<span class="lineno"></span><span class="op" id="3992281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3992284">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="3992364">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3992383">func</span>&nbsp;<span class="op" id="3992388">(</span><span class="ident" id="3992389">c</span>&nbsp;<span class="op" id="3992391">*</span><span class="ident" id="3992392">Certificate</span><span class="op" id="3992403">)</span>&nbsp;<span class="ident" id="3992405">CheckSignature</span><span class="op" id="3992419">(</span><span class="ident" id="3992420">algo</span>&nbsp;<span class="ident" id="3992425">SignatureAlgorithm</span><span class="op" id="3992443">,</span>&nbsp;<span class="ident" id="3992445">signed</span><span class="op" id="3992451">,</span>&nbsp;<span class="ident" id="3992453">signature</span>&nbsp;<span class="op" id="3992463">[</span><span class="op" id="3992464">]</span><span class="builtintype" id="3992465">byte</span><span class="op" id="3992469">)</span>&nbsp;<span class="op" id="3992471">(</span><span class="ident" id="3992472">err</span>&nbsp;<span class="builtintype" id="3992476">error</span><span class="op" id="3992481">)</span>&nbsp;<span class="op" id="3992483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992486">var</span>&nbsp;<span class="ident" id="3992490">hashType</span>&nbsp;<span class="ident" id="3992499">crypto</span><span class="op" id="3992505">.</span><span class="ident" id="3992506">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992513">switch</span>&nbsp;<span class="ident" id="3992520">algo</span>&nbsp;<span class="op" id="3992525">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992528">case</span>&nbsp;<span class="ident" id="3992533">SHA1WithRSA</span><span class="op" id="3992544">,</span>&nbsp;<span class="ident" id="3992546">DSAWithSHA1</span><span class="op" id="3992557">,</span>&nbsp;<span class="ident" id="3992559">ECDSAWithSHA1</span><span class="op" id="3992572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992576">hashType</span>&nbsp;<span class="op" id="3992585">=</span>&nbsp;<span class="ident" id="3992587">crypto</span><span class="op" id="3992593">.</span><span class="ident" id="3992594">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992600">case</span>&nbsp;<span class="ident" id="3992605">SHA256WithRSA</span><span class="op" id="3992618">,</span>&nbsp;<span class="ident" id="3992620">DSAWithSHA256</span><span class="op" id="3992633">,</span>&nbsp;<span class="ident" id="3992635">ECDSAWithSHA256</span><span class="op" id="3992650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992654">hashType</span>&nbsp;<span class="op" id="3992663">=</span>&nbsp;<span class="ident" id="3992665">crypto</span><span class="op" id="3992671">.</span><span class="ident" id="3992672">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992680">case</span>&nbsp;<span class="ident" id="3992685">SHA384WithRSA</span><span class="op" id="3992698">,</span>&nbsp;<span class="ident" id="3992700">ECDSAWithSHA384</span><span class="op" id="3992715">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992719">hashType</span>&nbsp;<span class="op" id="3992728">=</span>&nbsp;<span class="ident" id="3992730">crypto</span><span class="op" id="3992736">.</span><span class="ident" id="3992737">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992745">case</span>&nbsp;<span class="ident" id="3992750">SHA512WithRSA</span><span class="op" id="3992763">,</span>&nbsp;<span class="ident" id="3992765">ECDSAWithSHA512</span><span class="op" id="3992780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992784">hashType</span>&nbsp;<span class="op" id="3992793">=</span>&nbsp;<span class="ident" id="3992795">crypto</span><span class="op" id="3992801">.</span><span class="ident" id="3992802">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992810">default</span><span class="op" id="3992817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992821">return</span>&nbsp;<span class="ident" id="3992828">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3992853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992857">if</span>&nbsp;<span class="op" id="3992860">!</span><span class="ident" id="3992861">hashType</span><span class="op" id="3992869">.</span><span class="ident" id="3992870">Available</span><span class="op" id="3992879">(</span><span class="op" id="3992880">)</span>&nbsp;<span class="op" id="3992882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992886">return</span>&nbsp;<span class="ident" id="3992893">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3992918">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992921">h</span>&nbsp;<span class="op" id="3992923">:=</span>&nbsp;<span class="ident" id="3992926">hashType</span><span class="op" id="3992934">.</span><span class="ident" id="3992935">New</span><span class="op" id="3992938">(</span><span class="op" id="3992939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992943">h</span><span class="op" id="3992944">.</span><span class="ident" id="3992945">Write</span><span class="op" id="3992950">(</span><span class="ident" id="3992951">signed</span><span class="op" id="3992957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3992960">digest</span>&nbsp;<span class="op" id="3992967">:=</span>&nbsp;<span class="ident" id="3992970">h</span><span class="op" id="3992971">.</span><span class="ident" id="3992972">Sum</span><span class="op" id="3992975">(</span><span class="ident" id="3992976">nil</span><span class="op" id="3992979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3992983">switch</span>&nbsp;<span class="ident" id="3992990">pub</span>&nbsp;<span class="op" id="3992994">:=</span>&nbsp;<span class="ident" id="3992997">c</span><span class="op" id="3992998">.</span><span class="ident" id="3992999">PublicKey</span><span class="op" id="3993008">.</span><span class="op" id="3993009">(</span><span class="keyword" id="3993010">type</span><span class="op" id="3993014">)</span>&nbsp;<span class="op" id="3993016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993019">case</span>&nbsp;<span class="op" id="3993024">*</span><span class="ident" id="3993025">rsa</span><span class="op" id="3993028">.</span><span class="ident" id="3993029">PublicKey</span><span class="op" id="3993038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993042">return</span>&nbsp;<span class="ident" id="3993049">rsa</span><span class="op" id="3993052">.</span><span class="ident" id="3993053">VerifyPKCS1v15</span><span class="op" id="3993067">(</span><span class="ident" id="3993068">pub</span><span class="op" id="3993071">,</span>&nbsp;<span class="ident" id="3993073">hashType</span><span class="op" id="3993081">,</span>&nbsp;<span class="ident" id="3993083">digest</span><span class="op" id="3993089">,</span>&nbsp;<span class="ident" id="3993091">signature</span><span class="op" id="3993100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993103">case</span>&nbsp;<span class="op" id="3993108">*</span><span class="ident" id="3993109">dsa</span><span class="op" id="3993112">.</span><span class="ident" id="3993113">PublicKey</span><span class="op" id="3993122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3993126">dsaSig</span>&nbsp;<span class="op" id="3993133">:=</span>&nbsp;<span class="builtinfunc" id="3993136">new</span><span class="op" id="3993139">(</span><span class="ident" id="3993140">dsaSignature</span><span class="op" id="3993152">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993156">if</span>&nbsp;<span class="ident" id="3993159">_</span><span class="op" id="3993160">,</span>&nbsp;<span class="ident" id="3993162">err</span>&nbsp;<span class="op" id="3993166">:=</span>&nbsp;<span class="ident" id="3993169">asn1</span><span class="op" id="3993173">.</span><span class="ident" id="3993174">Unmarshal</span><span class="op" id="3993183">(</span><span class="ident" id="3993184">signature</span><span class="op" id="3993193">,</span>&nbsp;<span class="ident" id="3993195">dsaSig</span><span class="op" id="3993201">)</span><span class="op" id="3993202">;</span>&nbsp;<span class="ident" id="3993204">err</span>&nbsp;<span class="op" id="3993208">!=</span>&nbsp;<span class="ident" id="3993211">nil</span>&nbsp;<span class="op" id="3993215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993220">return</span>&nbsp;<span class="ident" id="3993227">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993237">if</span>&nbsp;<span class="ident" id="3993240">dsaSig</span><span class="op" id="3993246">.</span><span class="ident" id="3993247">R</span><span class="op" id="3993248">.</span><span class="ident" id="3993249">Sign</span><span class="op" id="3993253">(</span><span class="op" id="3993254">)</span>&nbsp;<span class="op" id="3993256">&lt;=</span>&nbsp;<span class="num" id="3993259">0</span>&nbsp;<span class="op" id="3993261">||</span>&nbsp;<span class="ident" id="3993264">dsaSig</span><span class="op" id="3993270">.</span><span class="ident" id="3993271">S</span><span class="op" id="3993272">.</span><span class="ident" id="3993273">Sign</span><span class="op" id="3993277">(</span><span class="op" id="3993278">)</span>&nbsp;<span class="op" id="3993280">&lt;=</span>&nbsp;<span class="num" id="3993283">0</span>&nbsp;<span class="op" id="3993285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993290">return</span>&nbsp;<span class="ident" id="3993297">errors</span><span class="op" id="3993303">.</span><span class="ident" id="3993304">New</span><span class="op" id="3993307">(</span><span class="string" id="3993308">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3993363">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993371">if</span>&nbsp;<span class="op" id="3993374">!</span><span class="ident" id="3993375">dsa</span><span class="op" id="3993378">.</span><span class="ident" id="3993379">Verify</span><span class="op" id="3993385">(</span><span class="ident" id="3993386">pub</span><span class="op" id="3993389">,</span>&nbsp;<span class="ident" id="3993391">digest</span><span class="op" id="3993397">,</span>&nbsp;<span class="ident" id="3993399">dsaSig</span><span class="op" id="3993405">.</span><span class="ident" id="3993406">R</span><span class="op" id="3993407">,</span>&nbsp;<span class="ident" id="3993409">dsaSig</span><span class="op" id="3993415">.</span><span class="ident" id="3993416">S</span><span class="op" id="3993417">)</span>&nbsp;<span class="op" id="3993419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993424">return</span>&nbsp;<span class="ident" id="3993431">errors</span><span class="op" id="3993437">.</span><span class="ident" id="3993438">New</span><span class="op" id="3993441">(</span><span class="string" id="3993442">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3993474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993482">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993490">case</span>&nbsp;<span class="op" id="3993495">*</span><span class="ident" id="3993496">ecdsa</span><span class="op" id="3993501">.</span><span class="ident" id="3993502">PublicKey</span><span class="op" id="3993511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3993515">ecdsaSig</span>&nbsp;<span class="op" id="3993524">:=</span>&nbsp;<span class="builtinfunc" id="3993527">new</span><span class="op" id="3993530">(</span><span class="ident" id="3993531">ecdsaSignature</span><span class="op" id="3993545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993549">if</span>&nbsp;<span class="ident" id="3993552">_</span><span class="op" id="3993553">,</span>&nbsp;<span class="ident" id="3993555">err</span>&nbsp;<span class="op" id="3993559">:=</span>&nbsp;<span class="ident" id="3993562">asn1</span><span class="op" id="3993566">.</span><span class="ident" id="3993567">Unmarshal</span><span class="op" id="3993576">(</span><span class="ident" id="3993577">signature</span><span class="op" id="3993586">,</span>&nbsp;<span class="ident" id="3993588">ecdsaSig</span><span class="op" id="3993596">)</span><span class="op" id="3993597">;</span>&nbsp;<span class="ident" id="3993599">err</span>&nbsp;<span class="op" id="3993603">!=</span>&nbsp;<span class="ident" id="3993606">nil</span>&nbsp;<span class="op" id="3993610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993615">return</span>&nbsp;<span class="ident" id="3993622">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993628">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993632">if</span>&nbsp;<span class="ident" id="3993635">ecdsaSig</span><span class="op" id="3993643">.</span><span class="ident" id="3993644">R</span><span class="op" id="3993645">.</span><span class="ident" id="3993646">Sign</span><span class="op" id="3993650">(</span><span class="op" id="3993651">)</span>&nbsp;<span class="op" id="3993653">&lt;=</span>&nbsp;<span class="num" id="3993656">0</span>&nbsp;<span class="op" id="3993658">||</span>&nbsp;<span class="ident" id="3993661">ecdsaSig</span><span class="op" id="3993669">.</span><span class="ident" id="3993670">S</span><span class="op" id="3993671">.</span><span class="ident" id="3993672">Sign</span><span class="op" id="3993676">(</span><span class="op" id="3993677">)</span>&nbsp;<span class="op" id="3993679">&lt;=</span>&nbsp;<span class="num" id="3993682">0</span>&nbsp;<span class="op" id="3993684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993689">return</span>&nbsp;<span class="ident" id="3993696">errors</span><span class="op" id="3993702">.</span><span class="ident" id="3993703">New</span><span class="op" id="3993706">(</span><span class="string" id="3993707">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3993764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993772">if</span>&nbsp;<span class="op" id="3993775">!</span><span class="ident" id="3993776">ecdsa</span><span class="op" id="3993781">.</span><span class="ident" id="3993782">Verify</span><span class="op" id="3993788">(</span><span class="ident" id="3993789">pub</span><span class="op" id="3993792">,</span>&nbsp;<span class="ident" id="3993794">digest</span><span class="op" id="3993800">,</span>&nbsp;<span class="ident" id="3993802">ecdsaSig</span><span class="op" id="3993810">.</span><span class="ident" id="3993811">R</span><span class="op" id="3993812">,</span>&nbsp;<span class="ident" id="3993814">ecdsaSig</span><span class="op" id="3993822">.</span><span class="ident" id="3993823">S</span><span class="op" id="3993824">)</span>&nbsp;<span class="op" id="3993826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993831">return</span>&nbsp;<span class="ident" id="3993838">errors</span><span class="op" id="3993844">.</span><span class="ident" id="3993845">New</span><span class="op" id="3993848">(</span><span class="string" id="3993849">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3993883">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993891">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3993899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3993902">return</span>&nbsp;<span class="ident" id="3993909">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3993933">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="3993936">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3994001">func</span>&nbsp;<span class="op" id="3994006">(</span><span class="ident" id="3994007">c</span>&nbsp;<span class="op" id="3994009">*</span><span class="ident" id="3994010">Certificate</span><span class="op" id="3994021">)</span>&nbsp;<span class="ident" id="3994023">CheckCRLSignature</span><span class="op" id="3994040">(</span><span class="ident" id="3994041">crl</span>&nbsp;<span class="op" id="3994045">*</span><span class="ident" id="3994046">pkix</span><span class="op" id="3994050">.</span><span class="ident" id="3994051">CertificateList</span><span class="op" id="3994066">)</span>&nbsp;<span class="op" id="3994068">(</span><span class="ident" id="3994069">err</span>&nbsp;<span class="builtintype" id="3994073">error</span><span class="op" id="3994078">)</span>&nbsp;<span class="op" id="3994080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994083">algo</span>&nbsp;<span class="op" id="3994088">:=</span>&nbsp;<span class="ident" id="3994091">getSignatureAlgorithmFromOID</span><span class="op" id="3994119">(</span><span class="ident" id="3994120">crl</span><span class="op" id="3994123">.</span><span class="ident" id="3994124">SignatureAlgorithm</span><span class="op" id="3994142">.</span><span class="ident" id="3994143">Algorithm</span><span class="op" id="3994152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3994155">return</span>&nbsp;<span class="ident" id="3994162">c</span><span class="op" id="3994163">.</span><span class="ident" id="3994164">CheckSignature</span><span class="op" id="3994178">(</span><span class="ident" id="3994179">algo</span><span class="op" id="3994183">,</span>&nbsp;<span class="ident" id="3994185">crl</span><span class="op" id="3994188">.</span><span class="ident" id="3994189">TBSCertList</span><span class="op" id="3994200">.</span><span class="ident" id="3994201">Raw</span><span class="op" id="3994204">,</span>&nbsp;<span class="ident" id="3994206">crl</span><span class="op" id="3994209">.</span><span class="ident" id="3994210">SignatureValue</span><span class="op" id="3994224">.</span><span class="ident" id="3994225">RightAlign</span><span class="op" id="3994235">(</span><span class="op" id="3994236">)</span><span class="op" id="3994237">)</span><br>
<span class="lineno">680</span><span class="op" id="3994239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3994242">type</span>&nbsp;<span class="ident" id="3994247">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="3994274">struct</span><span class="op" id="3994280">{</span><span class="op" id="3994281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3994284">func</span>&nbsp;<span class="op" id="3994289">(</span><span class="ident" id="3994290">h</span>&nbsp;<span class="ident" id="3994292">UnhandledCriticalExtension</span><span class="op" id="3994318">)</span>&nbsp;<span class="ident" id="3994320">Error</span><span class="op" id="3994325">(</span><span class="op" id="3994326">)</span>&nbsp;<span class="builtintype" id="3994328">string</span>&nbsp;<span class="op" id="3994335">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3994338">return</span>&nbsp;<span class="string" id="3994345">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="3994382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3994385">type</span>&nbsp;<span class="ident" id="3994390">basicConstraints</span>&nbsp;<span class="keyword" id="3994407">struct</span>&nbsp;<span class="op" id="3994414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994417">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3994428">bool</span>&nbsp;<span class="string" id="3994433">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994452">MaxPathLen</span>&nbsp;<span class="builtintype" id="3994463">int</span>&nbsp;&nbsp;<span class="string" id="3994468">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3994497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3994500">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="3994520">type</span>&nbsp;<span class="ident" id="3994525">policyInformation</span>&nbsp;<span class="keyword" id="3994543">struct</span>&nbsp;<span class="op" id="3994550">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994553">Policy</span>&nbsp;<span class="ident" id="3994560">asn1</span><span class="op" id="3994564">.</span><span class="ident" id="3994565">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3994583">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="3994611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3994614">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="3994636">type</span>&nbsp;<span class="ident" id="3994641">nameConstraints</span>&nbsp;<span class="keyword" id="3994657">struct</span>&nbsp;<span class="op" id="3994664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994667">Permitted</span>&nbsp;<span class="op" id="3994677">[</span><span class="op" id="3994678">]</span><span class="ident" id="3994679">generalSubtree</span>&nbsp;<span class="string" id="3994694">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994719">Excluded</span>&nbsp;&nbsp;<span class="op" id="3994729">[</span><span class="op" id="3994730">]</span><span class="ident" id="3994731">generalSubtree</span>&nbsp;<span class="string" id="3994746">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3994770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="3994773">type</span>&nbsp;<span class="ident" id="3994778">generalSubtree</span>&nbsp;<span class="keyword" id="3994793">struct</span>&nbsp;<span class="op" id="3994800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994803">Name</span>&nbsp;<span class="builtintype" id="3994808">string</span>&nbsp;<span class="string" id="3994815">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3994843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3994846">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="3994867">type</span>&nbsp;<span class="ident" id="3994872">authorityInfoAccess</span>&nbsp;<span class="keyword" id="3994892">struct</span>&nbsp;<span class="op" id="3994899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994902">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3994911">asn1</span><span class="op" id="3994915">.</span><span class="ident" id="3994916">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3994934">Location</span>&nbsp;<span class="ident" id="3994943">asn1</span><span class="op" id="3994947">.</span><span class="ident" id="3994948">RawValue</span><br>
<span class="lineno"></span><span class="op" id="3994957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="3994960">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="3994982">type</span>&nbsp;<span class="ident" id="3994987">distributionPoint</span>&nbsp;<span class="keyword" id="3995005">struct</span>&nbsp;<span class="op" id="3995012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995015">DistributionPoint</span>&nbsp;<span class="ident" id="3995033">distributionPointName</span>&nbsp;<span class="string" id="3995055">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995080">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995098">asn1</span><span class="op" id="3995102">.</span><span class="ident" id="3995103">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3995120">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995145">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995163">asn1</span><span class="op" id="3995167">.</span><span class="ident" id="3995168">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3995185">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="3995209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3995212">type</span>&nbsp;<span class="ident" id="3995217">distributionPointName</span>&nbsp;<span class="keyword" id="3995239">struct</span>&nbsp;<span class="op" id="3995246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995249">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995262">asn1</span><span class="op" id="3995266">.</span><span class="ident" id="3995267">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3995279">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995304">RelativeName</span>&nbsp;<span class="ident" id="3995317">pkix</span><span class="op" id="3995321">.</span><span class="ident" id="3995322">RDNSequence</span>&nbsp;<span class="string" id="3995334">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="3995358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3995361">func</span>&nbsp;<span class="ident" id="3995366">parsePublicKey</span><span class="op" id="3995380">(</span><span class="ident" id="3995381">algo</span>&nbsp;<span class="ident" id="3995386">PublicKeyAlgorithm</span><span class="op" id="3995404">,</span>&nbsp;<span class="ident" id="3995406">keyData</span>&nbsp;<span class="op" id="3995414">*</span><span class="ident" id="3995415">publicKeyInfo</span><span class="op" id="3995428">)</span>&nbsp;<span class="op" id="3995430">(</span><span class="keyword" id="3995431">interface</span><span class="op" id="3995440">{</span><span class="op" id="3995441">}</span><span class="op" id="3995442">,</span>&nbsp;<span class="builtintype" id="3995444">error</span><span class="op" id="3995449">)</span>&nbsp;<span class="op" id="3995451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995454">asn1Data</span>&nbsp;<span class="op" id="3995463">:=</span>&nbsp;<span class="ident" id="3995466">keyData</span><span class="op" id="3995473">.</span><span class="ident" id="3995474">PublicKey</span><span class="op" id="3995483">.</span><span class="ident" id="3995484">RightAlign</span><span class="op" id="3995494">(</span><span class="op" id="3995495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995498">switch</span>&nbsp;<span class="ident" id="3995505">algo</span>&nbsp;<span class="op" id="3995510">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995513">case</span>&nbsp;<span class="ident" id="3995518">RSA</span><span class="op" id="3995521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995525">p</span>&nbsp;<span class="op" id="3995527">:=</span>&nbsp;<span class="builtinfunc" id="3995530">new</span><span class="op" id="3995533">(</span><span class="ident" id="3995534">rsaPublicKey</span><span class="op" id="3995546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995550">_</span><span class="op" id="3995551">,</span>&nbsp;<span class="ident" id="3995553">err</span>&nbsp;<span class="op" id="3995557">:=</span>&nbsp;<span class="ident" id="3995560">asn1</span><span class="op" id="3995564">.</span><span class="ident" id="3995565">Unmarshal</span><span class="op" id="3995574">(</span><span class="ident" id="3995575">asn1Data</span><span class="op" id="3995583">,</span>&nbsp;<span class="ident" id="3995585">p</span><span class="op" id="3995586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995590">if</span>&nbsp;<span class="ident" id="3995593">err</span>&nbsp;<span class="op" id="3995597">!=</span>&nbsp;<span class="ident" id="3995600">nil</span>&nbsp;<span class="op" id="3995604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995609">return</span>&nbsp;<span class="ident" id="3995616">nil</span><span class="op" id="3995619">,</span>&nbsp;<span class="ident" id="3995621">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995632">if</span>&nbsp;<span class="ident" id="3995635">p</span><span class="op" id="3995636">.</span><span class="ident" id="3995637">N</span><span class="op" id="3995638">.</span><span class="ident" id="3995639">Sign</span><span class="op" id="3995643">(</span><span class="op" id="3995644">)</span>&nbsp;<span class="op" id="3995646">&lt;=</span>&nbsp;<span class="num" id="3995649">0</span>&nbsp;<span class="op" id="3995651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995656">return</span>&nbsp;<span class="ident" id="3995663">nil</span><span class="op" id="3995666">,</span>&nbsp;<span class="ident" id="3995668">errors</span><span class="op" id="3995674">.</span><span class="ident" id="3995675">New</span><span class="op" id="3995678">(</span><span class="string" id="3995679">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3995723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995727">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995731">if</span>&nbsp;<span class="ident" id="3995734">p</span><span class="op" id="3995735">.</span><span class="ident" id="3995736">E</span>&nbsp;<span class="op" id="3995738">&lt;=</span>&nbsp;<span class="num" id="3995741">0</span>&nbsp;<span class="op" id="3995743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995748">return</span>&nbsp;<span class="ident" id="3995755">nil</span><span class="op" id="3995758">,</span>&nbsp;<span class="ident" id="3995760">errors</span><span class="op" id="3995766">.</span><span class="ident" id="3995767">New</span><span class="op" id="3995770">(</span><span class="string" id="3995771">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3995823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995832">pub</span>&nbsp;<span class="op" id="3995836">:=</span>&nbsp;<span class="op" id="3995839">&amp;</span><span class="ident" id="3995840">rsa</span><span class="op" id="3995843">.</span><span class="ident" id="3995844">PublicKey</span><span class="op" id="3995853">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995858">E</span><span class="op" id="3995859">:</span>&nbsp;<span class="ident" id="3995861">p</span><span class="op" id="3995862">.</span><span class="ident" id="3995863">E</span><span class="op" id="3995864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995869">N</span><span class="op" id="3995870">:</span>&nbsp;<span class="ident" id="3995872">p</span><span class="op" id="3995873">.</span><span class="ident" id="3995874">N</span><span class="op" id="3995875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3995879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995883">return</span>&nbsp;<span class="ident" id="3995890">pub</span><span class="op" id="3995893">,</span>&nbsp;<span class="ident" id="3995895">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995900">case</span>&nbsp;<span class="ident" id="3995905">DSA</span><span class="op" id="3995908">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995912">var</span>&nbsp;<span class="ident" id="3995916">p</span>&nbsp;<span class="op" id="3995918">*</span><span class="ident" id="3995919">big</span><span class="op" id="3995922">.</span><span class="ident" id="3995923">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3995929">_</span><span class="op" id="3995930">,</span>&nbsp;<span class="ident" id="3995932">err</span>&nbsp;<span class="op" id="3995936">:=</span>&nbsp;<span class="ident" id="3995939">asn1</span><span class="op" id="3995943">.</span><span class="ident" id="3995944">Unmarshal</span><span class="op" id="3995953">(</span><span class="ident" id="3995954">asn1Data</span><span class="op" id="3995962">,</span>&nbsp;<span class="op" id="3995964">&amp;</span><span class="ident" id="3995965">p</span><span class="op" id="3995966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995970">if</span>&nbsp;<span class="ident" id="3995973">err</span>&nbsp;<span class="op" id="3995977">!=</span>&nbsp;<span class="ident" id="3995980">nil</span>&nbsp;<span class="op" id="3995984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3995989">return</span>&nbsp;<span class="ident" id="3995996">nil</span><span class="op" id="3995999">,</span>&nbsp;<span class="ident" id="3996001">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996007">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996011">paramsData</span>&nbsp;<span class="op" id="3996022">:=</span>&nbsp;<span class="ident" id="3996025">keyData</span><span class="op" id="3996032">.</span><span class="ident" id="3996033">Algorithm</span><span class="op" id="3996042">.</span><span class="ident" id="3996043">Parameters</span><span class="op" id="3996053">.</span><span class="ident" id="3996054">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996066">params</span>&nbsp;<span class="op" id="3996073">:=</span>&nbsp;<span class="builtinfunc" id="3996076">new</span><span class="op" id="3996079">(</span><span class="ident" id="3996080">dsaAlgorithmParameters</span><span class="op" id="3996102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996106">_</span><span class="op" id="3996107">,</span>&nbsp;<span class="ident" id="3996109">err</span>&nbsp;<span class="op" id="3996113">=</span>&nbsp;<span class="ident" id="3996115">asn1</span><span class="op" id="3996119">.</span><span class="ident" id="3996120">Unmarshal</span><span class="op" id="3996129">(</span><span class="ident" id="3996130">paramsData</span><span class="op" id="3996140">,</span>&nbsp;<span class="ident" id="3996142">params</span><span class="op" id="3996148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996152">if</span>&nbsp;<span class="ident" id="3996155">err</span>&nbsp;<span class="op" id="3996159">!=</span>&nbsp;<span class="ident" id="3996162">nil</span>&nbsp;<span class="op" id="3996166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996171">return</span>&nbsp;<span class="ident" id="3996178">nil</span><span class="op" id="3996181">,</span>&nbsp;<span class="ident" id="3996183">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996193">if</span>&nbsp;<span class="ident" id="3996196">p</span><span class="op" id="3996197">.</span><span class="ident" id="3996198">Sign</span><span class="op" id="3996202">(</span><span class="op" id="3996203">)</span>&nbsp;<span class="op" id="3996205">&lt;=</span>&nbsp;<span class="num" id="3996208">0</span>&nbsp;<span class="op" id="3996210">||</span>&nbsp;<span class="ident" id="3996213">params</span><span class="op" id="3996219">.</span><span class="ident" id="3996220">P</span><span class="op" id="3996221">.</span><span class="ident" id="3996222">Sign</span><span class="op" id="3996226">(</span><span class="op" id="3996227">)</span>&nbsp;<span class="op" id="3996229">&lt;=</span>&nbsp;<span class="num" id="3996232">0</span>&nbsp;<span class="op" id="3996234">||</span>&nbsp;<span class="ident" id="3996237">params</span><span class="op" id="3996243">.</span><span class="ident" id="3996244">Q</span><span class="op" id="3996245">.</span><span class="ident" id="3996246">Sign</span><span class="op" id="3996250">(</span><span class="op" id="3996251">)</span>&nbsp;<span class="op" id="3996253">&lt;=</span>&nbsp;<span class="num" id="3996256">0</span>&nbsp;<span class="op" id="3996258">||</span>&nbsp;<span class="ident" id="3996261">params</span><span class="op" id="3996267">.</span><span class="ident" id="3996268">G</span><span class="op" id="3996269">.</span><span class="ident" id="3996270">Sign</span><span class="op" id="3996274">(</span><span class="op" id="3996275">)</span>&nbsp;<span class="op" id="3996277">&lt;=</span>&nbsp;<span class="num" id="3996280">0</span>&nbsp;<span class="op" id="3996282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996287">return</span>&nbsp;<span class="ident" id="3996294">nil</span><span class="op" id="3996297">,</span>&nbsp;<span class="ident" id="3996299">errors</span><span class="op" id="3996305">.</span><span class="ident" id="3996306">New</span><span class="op" id="3996309">(</span><span class="string" id="3996310">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="3996348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996356">pub</span>&nbsp;<span class="op" id="3996360">:=</span>&nbsp;<span class="op" id="3996363">&amp;</span><span class="ident" id="3996364">dsa</span><span class="op" id="3996367">.</span><span class="ident" id="3996368">PublicKey</span><span class="op" id="3996377">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996382">Parameters</span><span class="op" id="3996392">:</span>&nbsp;<span class="ident" id="3996394">dsa</span><span class="op" id="3996397">.</span><span class="ident" id="3996398">Parameters</span><span class="op" id="3996408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996414">P</span><span class="op" id="3996415">:</span>&nbsp;<span class="ident" id="3996417">params</span><span class="op" id="3996423">.</span><span class="ident" id="3996424">P</span><span class="op" id="3996425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996431">Q</span><span class="op" id="3996432">:</span>&nbsp;<span class="ident" id="3996434">params</span><span class="op" id="3996440">.</span><span class="ident" id="3996441">Q</span><span class="op" id="3996442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996448">G</span><span class="op" id="3996449">:</span>&nbsp;<span class="ident" id="3996451">params</span><span class="op" id="3996457">.</span><span class="ident" id="3996458">G</span><span class="op" id="3996459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996464">}</span><span class="op" id="3996465">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996470">Y</span><span class="op" id="3996471">:</span>&nbsp;<span class="ident" id="3996473">p</span><span class="op" id="3996474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996482">return</span>&nbsp;<span class="ident" id="3996489">pub</span><span class="op" id="3996492">,</span>&nbsp;<span class="ident" id="3996494">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996499">case</span>&nbsp;<span class="ident" id="3996504">ECDSA</span><span class="op" id="3996509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996513">paramsData</span>&nbsp;<span class="op" id="3996524">:=</span>&nbsp;<span class="ident" id="3996527">keyData</span><span class="op" id="3996534">.</span><span class="ident" id="3996535">Algorithm</span><span class="op" id="3996544">.</span><span class="ident" id="3996545">Parameters</span><span class="op" id="3996555">.</span><span class="ident" id="3996556">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996568">namedCurveOID</span>&nbsp;<span class="op" id="3996582">:=</span>&nbsp;<span class="builtinfunc" id="3996585">new</span><span class="op" id="3996588">(</span><span class="ident" id="3996589">asn1</span><span class="op" id="3996593">.</span><span class="ident" id="3996594">ObjectIdentifier</span><span class="op" id="3996610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996614">_</span><span class="op" id="3996615">,</span>&nbsp;<span class="ident" id="3996617">err</span>&nbsp;<span class="op" id="3996621">:=</span>&nbsp;<span class="ident" id="3996624">asn1</span><span class="op" id="3996628">.</span><span class="ident" id="3996629">Unmarshal</span><span class="op" id="3996638">(</span><span class="ident" id="3996639">paramsData</span><span class="op" id="3996649">,</span>&nbsp;<span class="ident" id="3996651">namedCurveOID</span><span class="op" id="3996664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996668">if</span>&nbsp;<span class="ident" id="3996671">err</span>&nbsp;<span class="op" id="3996675">!=</span>&nbsp;<span class="ident" id="3996678">nil</span>&nbsp;<span class="op" id="3996682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996687">return</span>&nbsp;<span class="ident" id="3996694">nil</span><span class="op" id="3996697">,</span>&nbsp;<span class="ident" id="3996699">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996705">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996709">namedCurve</span>&nbsp;<span class="op" id="3996720">:=</span>&nbsp;<span class="ident" id="3996723">namedCurveFromOID</span><span class="op" id="3996740">(</span><span class="op" id="3996741">*</span><span class="ident" id="3996742">namedCurveOID</span><span class="op" id="3996755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996759">if</span>&nbsp;<span class="ident" id="3996762">namedCurve</span>&nbsp;<span class="op" id="3996773">==</span>&nbsp;<span class="ident" id="3996776">nil</span>&nbsp;<span class="op" id="3996780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996785">return</span>&nbsp;<span class="ident" id="3996792">nil</span><span class="op" id="3996795">,</span>&nbsp;<span class="ident" id="3996797">errors</span><span class="op" id="3996803">.</span><span class="ident" id="3996804">New</span><span class="op" id="3996807">(</span><span class="string" id="3996808">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3996842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996850">x</span><span class="op" id="3996851">,</span>&nbsp;<span class="ident" id="3996853">y</span>&nbsp;<span class="op" id="3996855">:=</span>&nbsp;<span class="ident" id="3996858">elliptic</span><span class="op" id="3996866">.</span><span class="ident" id="3996867">Unmarshal</span><span class="op" id="3996876">(</span><span class="ident" id="3996877">namedCurve</span><span class="op" id="3996887">,</span>&nbsp;<span class="ident" id="3996889">asn1Data</span><span class="op" id="3996897">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996901">if</span>&nbsp;<span class="ident" id="3996904">x</span>&nbsp;<span class="op" id="3996906">==</span>&nbsp;<span class="ident" id="3996909">nil</span>&nbsp;<span class="op" id="3996913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3996918">return</span>&nbsp;<span class="ident" id="3996925">nil</span><span class="op" id="3996928">,</span>&nbsp;<span class="ident" id="3996930">errors</span><span class="op" id="3996936">.</span><span class="ident" id="3996937">New</span><span class="op" id="3996940">(</span><span class="string" id="3996941">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="3996989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3996993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3996997">pub</span>&nbsp;<span class="op" id="3997001">:=</span>&nbsp;<span class="op" id="3997004">&amp;</span><span class="ident" id="3997005">ecdsa</span><span class="op" id="3997010">.</span><span class="ident" id="3997011">PublicKey</span><span class="op" id="3997020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997025">Curve</span><span class="op" id="3997030">:</span>&nbsp;<span class="ident" id="3997032">namedCurve</span><span class="op" id="3997042">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997047">X</span><span class="op" id="3997048">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997054">x</span><span class="op" id="3997055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997060">Y</span><span class="op" id="3997061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997067">y</span><span class="op" id="3997068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3997072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3997076">return</span>&nbsp;<span class="ident" id="3997083">pub</span><span class="op" id="3997086">,</span>&nbsp;<span class="ident" id="3997088">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3997093">default</span><span class="op" id="3997100">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3997104">return</span>&nbsp;<span class="ident" id="3997111">nil</span><span class="op" id="3997114">,</span>&nbsp;<span class="ident" id="3997116">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3997121">}</span><br>
<span class="lineno"></span><span class="op" id="3997123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3997126">func</span>&nbsp;<span class="ident" id="3997131">parseSANExtension</span><span class="op" id="3997148">(</span><span class="ident" id="3997149">value</span>&nbsp;<span class="op" id="3997155">[</span><span class="op" id="3997156">]</span><span class="builtintype" id="3997157">byte</span><span class="op" id="3997161">)</span>&nbsp;<span class="op" id="3997163">(</span><span class="ident" id="3997164">dnsNames</span><span class="op" id="3997172">,</span>&nbsp;<span class="ident" id="3997174">emailAddresses</span>&nbsp;<span class="op" id="3997189">[</span><span class="op" id="3997190">]</span><span class="builtintype" id="3997191">string</span><span class="op" id="3997197">,</span>&nbsp;<span class="ident" id="3997199">ipAddresses</span>&nbsp;<span class="op" id="3997211">[</span><span class="op" id="3997212">]</span><span class="ident" id="3997213">net</span><span class="op" id="3997216">.</span><span class="ident" id="3997217">IP</span><span class="op" id="3997219">,</span>&nbsp;<span class="ident" id="3997221">err</span>&nbsp;<span class="builtintype" id="3997225">error</span><span class="op" id="3997230">)</span>&nbsp;<span class="op" id="3997232">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997235">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997258">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997294">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997298">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997357">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997361">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997510">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997570">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3997871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3997940">var</span>&nbsp;<span class="ident" id="3997944">seq</span>&nbsp;<span class="ident" id="3997948">asn1</span><span class="op" id="3997952">.</span><span class="ident" id="3997953">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3997963">if</span>&nbsp;<span class="ident" id="3997966">_</span><span class="op" id="3997967">,</span>&nbsp;<span class="ident" id="3997969">err</span>&nbsp;<span class="op" id="3997973">=</span>&nbsp;<span class="ident" id="3997975">asn1</span><span class="op" id="3997979">.</span><span class="ident" id="3997980">Unmarshal</span><span class="op" id="3997989">(</span><span class="ident" id="3997990">value</span><span class="op" id="3997995">,</span>&nbsp;<span class="op" id="3997997">&amp;</span><span class="ident" id="3997998">seq</span><span class="op" id="3998001">)</span><span class="op" id="3998002">;</span>&nbsp;<span class="ident" id="3998004">err</span>&nbsp;<span class="op" id="3998008">!=</span>&nbsp;<span class="ident" id="3998011">nil</span>&nbsp;<span class="op" id="3998015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998019">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998027">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998030">if</span>&nbsp;<span class="op" id="3998033">!</span><span class="ident" id="3998034">seq</span><span class="op" id="3998037">.</span><span class="ident" id="3998038">IsCompound</span>&nbsp;<span class="op" id="3998049">||</span>&nbsp;<span class="ident" id="3998052">seq</span><span class="op" id="3998055">.</span><span class="ident" id="3998056">Tag</span>&nbsp;<span class="op" id="3998060">!=</span>&nbsp;<span class="num" id="3998063">16</span>&nbsp;<span class="op" id="3998066">||</span>&nbsp;<span class="ident" id="3998069">seq</span><span class="op" id="3998072">.</span><span class="ident" id="3998073">Class</span>&nbsp;<span class="op" id="3998079">!=</span>&nbsp;<span class="num" id="3998082">0</span>&nbsp;<span class="op" id="3998084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998088">err</span>&nbsp;<span class="op" id="3998092">=</span>&nbsp;<span class="ident" id="3998094">asn1</span><span class="op" id="3998098">.</span><span class="ident" id="3998099">StructuralError</span><span class="op" id="3998114">{</span><span class="ident" id="3998115">Msg</span><span class="op" id="3998118">:</span>&nbsp;<span class="string" id="3998120">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="3998138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998154">rest</span>&nbsp;<span class="op" id="3998159">:=</span>&nbsp;<span class="ident" id="3998162">seq</span><span class="op" id="3998165">.</span><span class="ident" id="3998166">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998173">for</span>&nbsp;<span class="builtinfunc" id="3998177">len</span><span class="op" id="3998180">(</span><span class="ident" id="3998181">rest</span><span class="op" id="3998185">)</span>&nbsp;<span class="op" id="3998187">&gt;</span>&nbsp;<span class="num" id="3998189">0</span>&nbsp;<span class="op" id="3998191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998195">var</span>&nbsp;<span class="ident" id="3998199">v</span>&nbsp;<span class="ident" id="3998201">asn1</span><span class="op" id="3998205">.</span><span class="ident" id="3998206">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998217">rest</span><span class="op" id="3998221">,</span>&nbsp;<span class="ident" id="3998223">err</span>&nbsp;<span class="op" id="3998227">=</span>&nbsp;<span class="ident" id="3998229">asn1</span><span class="op" id="3998233">.</span><span class="ident" id="3998234">Unmarshal</span><span class="op" id="3998243">(</span><span class="ident" id="3998244">rest</span><span class="op" id="3998248">,</span>&nbsp;<span class="op" id="3998250">&amp;</span><span class="ident" id="3998251">v</span><span class="op" id="3998252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998256">if</span>&nbsp;<span class="ident" id="3998259">err</span>&nbsp;<span class="op" id="3998263">!=</span>&nbsp;<span class="ident" id="3998266">nil</span>&nbsp;<span class="op" id="3998270">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998275">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998288">switch</span>&nbsp;<span class="ident" id="3998295">v</span><span class="op" id="3998296">.</span><span class="ident" id="3998297">Tag</span>&nbsp;<span class="op" id="3998301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998305">case</span>&nbsp;<span class="num" id="3998310">1</span><span class="op" id="3998311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998316">emailAddresses</span>&nbsp;<span class="op" id="3998331">=</span>&nbsp;<span class="builtinfunc" id="3998333">append</span><span class="op" id="3998339">(</span><span class="ident" id="3998340">emailAddresses</span><span class="op" id="3998354">,</span>&nbsp;<span class="builtintype" id="3998356">string</span><span class="op" id="3998362">(</span><span class="ident" id="3998363">v</span><span class="op" id="3998364">.</span><span class="ident" id="3998365">Bytes</span><span class="op" id="3998370">)</span><span class="op" id="3998371">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998375">case</span>&nbsp;<span class="num" id="3998380">2</span><span class="op" id="3998381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998386">dnsNames</span>&nbsp;<span class="op" id="3998395">=</span>&nbsp;<span class="builtinfunc" id="3998397">append</span><span class="op" id="3998403">(</span><span class="ident" id="3998404">dnsNames</span><span class="op" id="3998412">,</span>&nbsp;<span class="builtintype" id="3998414">string</span><span class="op" id="3998420">(</span><span class="ident" id="3998421">v</span><span class="op" id="3998422">.</span><span class="ident" id="3998423">Bytes</span><span class="op" id="3998428">)</span><span class="op" id="3998429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998433">case</span>&nbsp;<span class="num" id="3998438">7</span><span class="op" id="3998439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998444">switch</span>&nbsp;<span class="builtinfunc" id="3998451">len</span><span class="op" id="3998454">(</span><span class="ident" id="3998455">v</span><span class="op" id="3998456">.</span><span class="ident" id="3998457">Bytes</span><span class="op" id="3998462">)</span>&nbsp;<span class="op" id="3998464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998469">case</span>&nbsp;<span class="ident" id="3998474">net</span><span class="op" id="3998477">.</span><span class="ident" id="3998478">IPv4len</span><span class="op" id="3998485">,</span>&nbsp;<span class="ident" id="3998487">net</span><span class="op" id="3998490">.</span><span class="ident" id="3998491">IPv6len</span><span class="op" id="3998498">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998504">ipAddresses</span>&nbsp;<span class="op" id="3998516">=</span>&nbsp;<span class="builtinfunc" id="3998518">append</span><span class="op" id="3998524">(</span><span class="ident" id="3998525">ipAddresses</span><span class="op" id="3998536">,</span>&nbsp;<span class="ident" id="3998538">v</span><span class="op" id="3998539">.</span><span class="ident" id="3998540">Bytes</span><span class="op" id="3998545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998550">default</span><span class="op" id="3998557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998563">err</span>&nbsp;<span class="op" id="3998567">=</span>&nbsp;<span class="ident" id="3998569">errors</span><span class="op" id="3998575">.</span><span class="ident" id="3998576">New</span><span class="op" id="3998579">(</span><span class="string" id="3998580">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="3998632">+</span>&nbsp;<span class="ident" id="3998634">strconv</span><span class="op" id="3998641">.</span><span class="ident" id="3998642">Itoa</span><span class="op" id="3998646">(</span><span class="builtinfunc" id="3998647">len</span><span class="op" id="3998650">(</span><span class="ident" id="3998651">v</span><span class="op" id="3998652">.</span><span class="ident" id="3998653">Bytes</span><span class="op" id="3998658">)</span><span class="op" id="3998659">)</span><span class="op" id="3998660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998666">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998676">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998687">return</span><br>
<span class="lineno"></span><span class="op" id="3998694">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="3998697">func</span>&nbsp;<span class="ident" id="3998702">parseCertificate</span><span class="op" id="3998718">(</span><span class="ident" id="3998719">in</span>&nbsp;<span class="op" id="3998722">*</span><span class="ident" id="3998723">certificate</span><span class="op" id="3998734">)</span>&nbsp;<span class="op" id="3998736">(</span><span class="op" id="3998737">*</span><span class="ident" id="3998738">Certificate</span><span class="op" id="3998749">,</span>&nbsp;<span class="builtintype" id="3998751">error</span><span class="op" id="3998756">)</span>&nbsp;<span class="op" id="3998758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998761">out</span>&nbsp;<span class="op" id="3998765">:=</span>&nbsp;<span class="builtinfunc" id="3998768">new</span><span class="op" id="3998771">(</span><span class="ident" id="3998772">Certificate</span><span class="op" id="3998783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998786">out</span><span class="op" id="3998789">.</span><span class="ident" id="3998790">Raw</span>&nbsp;<span class="op" id="3998794">=</span>&nbsp;<span class="ident" id="3998796">in</span><span class="op" id="3998798">.</span><span class="ident" id="3998799">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998804">out</span><span class="op" id="3998807">.</span><span class="ident" id="3998808">RawTBSCertificate</span>&nbsp;<span class="op" id="3998826">=</span>&nbsp;<span class="ident" id="3998828">in</span><span class="op" id="3998830">.</span><span class="ident" id="3998831">TBSCertificate</span><span class="op" id="3998845">.</span><span class="ident" id="3998846">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998851">out</span><span class="op" id="3998854">.</span><span class="ident" id="3998855">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3998879">=</span>&nbsp;<span class="ident" id="3998881">in</span><span class="op" id="3998883">.</span><span class="ident" id="3998884">TBSCertificate</span><span class="op" id="3998898">.</span><span class="ident" id="3998899">PublicKey</span><span class="op" id="3998908">.</span><span class="ident" id="3998909">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998914">out</span><span class="op" id="3998917">.</span><span class="ident" id="3998918">RawSubject</span>&nbsp;<span class="op" id="3998929">=</span>&nbsp;<span class="ident" id="3998931">in</span><span class="op" id="3998933">.</span><span class="ident" id="3998934">TBSCertificate</span><span class="op" id="3998948">.</span><span class="ident" id="3998949">Subject</span><span class="op" id="3998956">.</span><span class="ident" id="3998957">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998968">out</span><span class="op" id="3998971">.</span><span class="ident" id="3998972">RawIssuer</span>&nbsp;<span class="op" id="3998982">=</span>&nbsp;<span class="ident" id="3998984">in</span><span class="op" id="3998986">.</span><span class="ident" id="3998987">TBSCertificate</span><span class="op" id="3999001">.</span><span class="ident" id="3999002">Issuer</span><span class="op" id="3999008">.</span><span class="ident" id="3999009">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999021">out</span><span class="op" id="3999024">.</span><span class="ident" id="3999025">Signature</span>&nbsp;<span class="op" id="3999035">=</span>&nbsp;<span class="ident" id="3999037">in</span><span class="op" id="3999039">.</span><span class="ident" id="3999040">SignatureValue</span><span class="op" id="3999054">.</span><span class="ident" id="3999055">RightAlign</span><span class="op" id="3999065">(</span><span class="op" id="3999066">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999069">out</span><span class="op" id="3999072">.</span><span class="ident" id="3999073">SignatureAlgorithm</span>&nbsp;<span class="op" id="3999092">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999096">getSignatureAlgorithmFromOID</span><span class="op" id="3999124">(</span><span class="ident" id="3999125">in</span><span class="op" id="3999127">.</span><span class="ident" id="3999128">TBSCertificate</span><span class="op" id="3999142">.</span><span class="ident" id="3999143">SignatureAlgorithm</span><span class="op" id="3999161">.</span><span class="ident" id="3999162">Algorithm</span><span class="op" id="3999171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999175">out</span><span class="op" id="3999178">.</span><span class="ident" id="3999179">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3999198">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999202">getPublicKeyAlgorithmFromOID</span><span class="op" id="3999230">(</span><span class="ident" id="3999231">in</span><span class="op" id="3999233">.</span><span class="ident" id="3999234">TBSCertificate</span><span class="op" id="3999248">.</span><span class="ident" id="3999249">PublicKey</span><span class="op" id="3999258">.</span><span class="ident" id="3999259">Algorithm</span><span class="op" id="3999268">.</span><span class="ident" id="3999269">Algorithm</span><span class="op" id="3999278">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999281">var</span>&nbsp;<span class="ident" id="3999285">err</span>&nbsp;<span class="builtintype" id="3999289">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999296">out</span><span class="op" id="3999299">.</span><span class="ident" id="3999300">PublicKey</span><span class="op" id="3999309">,</span>&nbsp;<span class="ident" id="3999311">err</span>&nbsp;<span class="op" id="3999315">=</span>&nbsp;<span class="ident" id="3999317">parsePublicKey</span><span class="op" id="3999331">(</span><span class="ident" id="3999332">out</span><span class="op" id="3999335">.</span><span class="ident" id="3999336">PublicKeyAlgorithm</span><span class="op" id="3999354">,</span>&nbsp;<span class="op" id="3999356">&amp;</span><span class="ident" id="3999357">in</span><span class="op" id="3999359">.</span><span class="ident" id="3999360">TBSCertificate</span><span class="op" id="3999374">.</span><span class="ident" id="3999375">PublicKey</span><span class="op" id="3999384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999387">if</span>&nbsp;<span class="ident" id="3999390">err</span>&nbsp;<span class="op" id="3999394">!=</span>&nbsp;<span class="ident" id="3999397">nil</span>&nbsp;<span class="op" id="3999401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999405">return</span>&nbsp;<span class="ident" id="3999412">nil</span><span class="op" id="3999415">,</span>&nbsp;<span class="ident" id="3999417">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999422">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999426">if</span>&nbsp;<span class="ident" id="3999429">in</span><span class="op" id="3999431">.</span><span class="ident" id="3999432">TBSCertificate</span><span class="op" id="3999446">.</span><span class="ident" id="3999447">SerialNumber</span><span class="op" id="3999459">.</span><span class="ident" id="3999460">Sign</span><span class="op" id="3999464">(</span><span class="op" id="3999465">)</span>&nbsp;<span class="op" id="3999467">&lt;</span>&nbsp;<span class="num" id="3999469">0</span>&nbsp;<span class="op" id="3999471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999475">return</span>&nbsp;<span class="ident" id="3999482">nil</span><span class="op" id="3999485">,</span>&nbsp;<span class="ident" id="3999487">errors</span><span class="op" id="3999493">.</span><span class="ident" id="3999494">New</span><span class="op" id="3999497">(</span><span class="string" id="3999498">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="3999528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999535">out</span><span class="op" id="3999538">.</span><span class="ident" id="3999539">Version</span>&nbsp;<span class="op" id="3999547">=</span>&nbsp;<span class="ident" id="3999549">in</span><span class="op" id="3999551">.</span><span class="ident" id="3999552">TBSCertificate</span><span class="op" id="3999566">.</span><span class="ident" id="3999567">Version</span>&nbsp;<span class="op" id="3999575">+</span>&nbsp;<span class="num" id="3999577">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999580">out</span><span class="op" id="3999583">.</span><span class="ident" id="3999584">SerialNumber</span>&nbsp;<span class="op" id="3999597">=</span>&nbsp;<span class="ident" id="3999599">in</span><span class="op" id="3999601">.</span><span class="ident" id="3999602">TBSCertificate</span><span class="op" id="3999616">.</span><span class="ident" id="3999617">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999632">var</span>&nbsp;<span class="ident" id="3999636">issuer</span><span class="op" id="3999642">,</span>&nbsp;<span class="ident" id="3999644">subject</span>&nbsp;<span class="ident" id="3999652">pkix</span><span class="op" id="3999656">.</span><span class="ident" id="3999657">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999670">if</span>&nbsp;<span class="ident" id="3999673">_</span><span class="op" id="3999674">,</span>&nbsp;<span class="ident" id="3999676">err</span>&nbsp;<span class="op" id="3999680">:=</span>&nbsp;<span class="ident" id="3999683">asn1</span><span class="op" id="3999687">.</span><span class="ident" id="3999688">Unmarshal</span><span class="op" id="3999697">(</span><span class="ident" id="3999698">in</span><span class="op" id="3999700">.</span><span class="ident" id="3999701">TBSCertificate</span><span class="op" id="3999715">.</span><span class="ident" id="3999716">Subject</span><span class="op" id="3999723">.</span><span class="ident" id="3999724">FullBytes</span><span class="op" id="3999733">,</span>&nbsp;<span class="op" id="3999735">&amp;</span><span class="ident" id="3999736">subject</span><span class="op" id="3999743">)</span><span class="op" id="3999744">;</span>&nbsp;<span class="ident" id="3999746">err</span>&nbsp;<span class="op" id="3999750">!=</span>&nbsp;<span class="ident" id="3999753">nil</span>&nbsp;<span class="op" id="3999757">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999761">return</span>&nbsp;<span class="ident" id="3999768">nil</span><span class="op" id="3999771">,</span>&nbsp;<span class="ident" id="3999773">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999781">if</span>&nbsp;<span class="ident" id="3999784">_</span><span class="op" id="3999785">,</span>&nbsp;<span class="ident" id="3999787">err</span>&nbsp;<span class="op" id="3999791">:=</span>&nbsp;<span class="ident" id="3999794">asn1</span><span class="op" id="3999798">.</span><span class="ident" id="3999799">Unmarshal</span><span class="op" id="3999808">(</span><span class="ident" id="3999809">in</span><span class="op" id="3999811">.</span><span class="ident" id="3999812">TBSCertificate</span><span class="op" id="3999826">.</span><span class="ident" id="3999827">Issuer</span><span class="op" id="3999833">.</span><span class="ident" id="3999834">FullBytes</span><span class="op" id="3999843">,</span>&nbsp;<span class="op" id="3999845">&amp;</span><span class="ident" id="3999846">issuer</span><span class="op" id="3999852">)</span><span class="op" id="3999853">;</span>&nbsp;<span class="ident" id="3999855">err</span>&nbsp;<span class="op" id="3999859">!=</span>&nbsp;<span class="ident" id="3999862">nil</span>&nbsp;<span class="op" id="3999866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999870">return</span>&nbsp;<span class="ident" id="3999877">nil</span><span class="op" id="3999880">,</span>&nbsp;<span class="ident" id="3999882">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999887">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999891">out</span><span class="op" id="3999894">.</span><span class="ident" id="3999895">Issuer</span><span class="op" id="3999901">.</span><span class="ident" id="3999902">FillFromRDNSequence</span><span class="op" id="3999921">(</span><span class="op" id="3999922">&amp;</span><span class="ident" id="3999923">issuer</span><span class="op" id="3999929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999932">out</span><span class="op" id="3999935">.</span><span class="ident" id="3999936">Subject</span><span class="op" id="3999943">.</span><span class="ident" id="3999944">FillFromRDNSequence</span><span class="op" id="3999963">(</span><span class="op" id="3999964">&amp;</span><span class="ident" id="3999965">subject</span><span class="op" id="3999972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999976">out</span><span class="op" id="3999979">.</span><span class="ident" id="3999980">NotBefore</span>&nbsp;<span class="op" id="3999990">=</span>&nbsp;<span class="ident" id="3999992">in</span><span class="op" id="3999994">.</span><span class="ident" id="3999995">TBSCertificate</span><span class="op" id="4000009">.</span><span class="ident" id="4000010">Validity</span><span class="op" id="4000018">.</span><span class="ident" id="4000019">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000030">out</span><span class="op" id="4000033">.</span><span class="ident" id="4000034">NotAfter</span>&nbsp;<span class="op" id="4000043">=</span>&nbsp;<span class="ident" id="4000045">in</span><span class="op" id="4000047">.</span><span class="ident" id="4000048">TBSCertificate</span><span class="op" id="4000062">.</span><span class="ident" id="4000063">Validity</span><span class="op" id="4000071">.</span><span class="ident" id="4000072">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000083">for</span>&nbsp;<span class="ident" id="4000087">_</span><span class="op" id="4000088">,</span>&nbsp;<span class="ident" id="4000090">e</span>&nbsp;<span class="op" id="4000092">:=</span>&nbsp;<span class="keyword" id="4000095">range</span>&nbsp;<span class="ident" id="4000101">in</span><span class="op" id="4000103">.</span><span class="ident" id="4000104">TBSCertificate</span><span class="op" id="4000118">.</span><span class="ident" id="4000119">Extensions</span>&nbsp;<span class="op" id="4000130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000134">out</span><span class="op" id="4000137">.</span><span class="ident" id="4000138">Extensions</span>&nbsp;<span class="op" id="4000149">=</span>&nbsp;<span class="builtinfunc" id="4000151">append</span><span class="op" id="4000157">(</span><span class="ident" id="4000158">out</span><span class="op" id="4000161">.</span><span class="ident" id="4000162">Extensions</span><span class="op" id="4000172">,</span>&nbsp;<span class="ident" id="4000174">e</span><span class="op" id="4000175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000180">if</span>&nbsp;<span class="builtinfunc" id="4000183">len</span><span class="op" id="4000186">(</span><span class="ident" id="4000187">e</span><span class="op" id="4000188">.</span><span class="ident" id="4000189">Id</span><span class="op" id="4000191">)</span>&nbsp;<span class="op" id="4000193">==</span>&nbsp;<span class="num" id="4000196">4</span>&nbsp;<span class="op" id="4000198">&amp;&amp;</span>&nbsp;<span class="ident" id="4000201">e</span><span class="op" id="4000202">.</span><span class="ident" id="4000203">Id</span><span class="op" id="4000205">[</span><span class="num" id="4000206">0</span><span class="op" id="4000207">]</span>&nbsp;<span class="op" id="4000209">==</span>&nbsp;<span class="num" id="4000212">2</span>&nbsp;<span class="op" id="4000214">&amp;&amp;</span>&nbsp;<span class="ident" id="4000217">e</span><span class="op" id="4000218">.</span><span class="ident" id="4000219">Id</span><span class="op" id="4000221">[</span><span class="num" id="4000222">1</span><span class="op" id="4000223">]</span>&nbsp;<span class="op" id="4000225">==</span>&nbsp;<span class="num" id="4000228">5</span>&nbsp;<span class="op" id="4000230">&amp;&amp;</span>&nbsp;<span class="ident" id="4000233">e</span><span class="op" id="4000234">.</span><span class="ident" id="4000235">Id</span><span class="op" id="4000237">[</span><span class="num" id="4000238">2</span><span class="op" id="4000239">]</span>&nbsp;<span class="op" id="4000241">==</span>&nbsp;<span class="num" id="4000244">29</span>&nbsp;<span class="op" id="4000247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000252">switch</span>&nbsp;<span class="ident" id="4000259">e</span><span class="op" id="4000260">.</span><span class="ident" id="4000261">Id</span><span class="op" id="4000263">[</span><span class="num" id="4000264">3</span><span class="op" id="4000265">]</span>&nbsp;<span class="op" id="4000267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000272">case</span>&nbsp;<span class="num" id="4000277">15</span><span class="op" id="4000279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000285">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000310">var</span>&nbsp;<span class="ident" id="4000314">usageBits</span>&nbsp;<span class="ident" id="4000324">asn1</span><span class="op" id="4000328">.</span><span class="ident" id="4000329">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000343">_</span><span class="op" id="4000344">,</span>&nbsp;<span class="ident" id="4000346">err</span>&nbsp;<span class="op" id="4000350">:=</span>&nbsp;<span class="ident" id="4000353">asn1</span><span class="op" id="4000357">.</span><span class="ident" id="4000358">Unmarshal</span><span class="op" id="4000367">(</span><span class="ident" id="4000368">e</span><span class="op" id="4000369">.</span><span class="ident" id="4000370">Value</span><span class="op" id="4000375">,</span>&nbsp;<span class="op" id="4000377">&amp;</span><span class="ident" id="4000378">usageBits</span><span class="op" id="4000387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000394">if</span>&nbsp;<span class="ident" id="4000397">err</span>&nbsp;<span class="op" id="4000401">==</span>&nbsp;<span class="ident" id="4000404">nil</span>&nbsp;<span class="op" id="4000408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000415">var</span>&nbsp;<span class="ident" id="4000419">usage</span>&nbsp;<span class="builtintype" id="4000425">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000434">for</span>&nbsp;<span class="ident" id="4000438">i</span>&nbsp;<span class="op" id="4000440">:=</span>&nbsp;<span class="num" id="4000443">0</span><span class="op" id="4000444">;</span>&nbsp;<span class="ident" id="4000446">i</span>&nbsp;<span class="op" id="4000448">&lt;</span>&nbsp;<span class="num" id="4000450">9</span><span class="op" id="4000451">;</span>&nbsp;<span class="ident" id="4000453">i</span><span class="op" id="4000454">++</span>&nbsp;<span class="op" id="4000457">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000465">if</span>&nbsp;<span class="ident" id="4000468">usageBits</span><span class="op" id="4000477">.</span><span class="ident" id="4000478">At</span><span class="op" id="4000480">(</span><span class="ident" id="4000481">i</span><span class="op" id="4000482">)</span>&nbsp;<span class="op" id="4000484">!=</span>&nbsp;<span class="num" id="4000487">0</span>&nbsp;<span class="op" id="4000489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000498">usage</span>&nbsp;<span class="op" id="4000504">|=</span>&nbsp;<span class="num" id="4000507">1</span>&nbsp;<span class="op" id="4000509">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4000512">uint</span><span class="op" id="4000516">(</span><span class="ident" id="4000517">i</span><span class="op" id="4000518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000540">out</span><span class="op" id="4000543">.</span><span class="ident" id="4000544">KeyUsage</span>&nbsp;<span class="op" id="4000553">=</span>&nbsp;<span class="ident" id="4000555">KeyUsage</span><span class="op" id="4000563">(</span><span class="ident" id="4000564">usage</span><span class="op" id="4000569">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000576">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000594">case</span>&nbsp;<span class="num" id="4000599">19</span><span class="op" id="4000601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000607">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000632">var</span>&nbsp;<span class="ident" id="4000636">constraints</span>&nbsp;<span class="ident" id="4000648">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000669">_</span><span class="op" id="4000670">,</span>&nbsp;<span class="ident" id="4000672">err</span>&nbsp;<span class="op" id="4000676">:=</span>&nbsp;<span class="ident" id="4000679">asn1</span><span class="op" id="4000683">.</span><span class="ident" id="4000684">Unmarshal</span><span class="op" id="4000693">(</span><span class="ident" id="4000694">e</span><span class="op" id="4000695">.</span><span class="ident" id="4000696">Value</span><span class="op" id="4000701">,</span>&nbsp;<span class="op" id="4000703">&amp;</span><span class="ident" id="4000704">constraints</span><span class="op" id="4000715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000722">if</span>&nbsp;<span class="ident" id="4000725">err</span>&nbsp;<span class="op" id="4000729">==</span>&nbsp;<span class="ident" id="4000732">nil</span>&nbsp;<span class="op" id="4000736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000743">out</span><span class="op" id="4000746">.</span><span class="ident" id="4000747">BasicConstraintsValid</span>&nbsp;<span class="op" id="4000769">=</span>&nbsp;<span class="builtintype" id="4000771">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000781">out</span><span class="op" id="4000784">.</span><span class="ident" id="4000785">IsCA</span>&nbsp;<span class="op" id="4000790">=</span>&nbsp;<span class="ident" id="4000792">constraints</span><span class="op" id="4000803">.</span><span class="ident" id="4000804">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000814">out</span><span class="op" id="4000817">.</span><span class="ident" id="4000818">MaxPathLen</span>&nbsp;<span class="op" id="4000829">=</span>&nbsp;<span class="ident" id="4000831">constraints</span><span class="op" id="4000842">.</span><span class="ident" id="4000843">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000859">out</span><span class="op" id="4000862">.</span><span class="ident" id="4000863">MaxPathLenZero</span>&nbsp;<span class="op" id="4000878">=</span>&nbsp;<span class="ident" id="4000880">out</span><span class="op" id="4000883">.</span><span class="ident" id="4000884">MaxPathLen</span>&nbsp;<span class="op" id="4000895">==</span>&nbsp;<span class="num" id="4000898">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000905">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000923">case</span>&nbsp;<span class="num" id="4000928">17</span><span class="op" id="4000930">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000936">out</span><span class="op" id="4000939">.</span><span class="ident" id="4000940">DNSNames</span><span class="op" id="4000948">,</span>&nbsp;<span class="ident" id="4000950">out</span><span class="op" id="4000953">.</span><span class="ident" id="4000954">EmailAddresses</span><span class="op" id="4000968">,</span>&nbsp;<span class="ident" id="4000970">out</span><span class="op" id="4000973">.</span><span class="ident" id="4000974">IPAddresses</span><span class="op" id="4000985">,</span>&nbsp;<span class="ident" id="4000987">err</span>&nbsp;<span class="op" id="4000991">=</span>&nbsp;<span class="ident" id="4000993">parseSANExtension</span><span class="op" id="4001010">(</span><span class="ident" id="4001011">e</span><span class="op" id="4001012">.</span><span class="ident" id="4001013">Value</span><span class="op" id="4001018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001024">if</span>&nbsp;<span class="ident" id="4001027">err</span>&nbsp;<span class="op" id="4001031">!=</span>&nbsp;<span class="ident" id="4001034">nil</span>&nbsp;<span class="op" id="4001038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001045">return</span>&nbsp;<span class="ident" id="4001052">nil</span><span class="op" id="4001055">,</span>&nbsp;<span class="ident" id="4001057">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001072">if</span>&nbsp;<span class="builtinfunc" id="4001075">len</span><span class="op" id="4001078">(</span><span class="ident" id="4001079">out</span><span class="op" id="4001082">.</span><span class="ident" id="4001083">DNSNames</span><span class="op" id="4001091">)</span>&nbsp;<span class="op" id="4001093">&gt;</span>&nbsp;<span class="num" id="4001095">0</span>&nbsp;<span class="op" id="4001097">||</span>&nbsp;<span class="builtinfunc" id="4001100">len</span><span class="op" id="4001103">(</span><span class="ident" id="4001104">out</span><span class="op" id="4001107">.</span><span class="ident" id="4001108">EmailAddresses</span><span class="op" id="4001122">)</span>&nbsp;<span class="op" id="4001124">&gt;</span>&nbsp;<span class="num" id="4001126">0</span>&nbsp;<span class="op" id="4001128">||</span>&nbsp;<span class="builtinfunc" id="4001131">len</span><span class="op" id="4001134">(</span><span class="ident" id="4001135">out</span><span class="op" id="4001138">.</span><span class="ident" id="4001139">IPAddresses</span><span class="op" id="4001150">)</span>&nbsp;<span class="op" id="4001152">&gt;</span>&nbsp;<span class="num" id="4001154">0</span>&nbsp;<span class="op" id="4001156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001163">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001182">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001233">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001282">case</span>&nbsp;<span class="num" id="4001287">30</span><span class="op" id="4001289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001295">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001322">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001501">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001508">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001576">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001583">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001620">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001729">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001789">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001796">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001838">var</span>&nbsp;<span class="ident" id="4001842">constraints</span>&nbsp;<span class="ident" id="4001854">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001874">_</span><span class="op" id="4001875">,</span>&nbsp;<span class="ident" id="4001877">err</span>&nbsp;<span class="op" id="4001881">:=</span>&nbsp;<span class="ident" id="4001884">asn1</span><span class="op" id="4001888">.</span><span class="ident" id="4001889">Unmarshal</span><span class="op" id="4001898">(</span><span class="ident" id="4001899">e</span><span class="op" id="4001900">.</span><span class="ident" id="4001901">Value</span><span class="op" id="4001906">,</span>&nbsp;<span class="op" id="4001908">&amp;</span><span class="ident" id="4001909">constraints</span><span class="op" id="4001920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001926">if</span>&nbsp;<span class="ident" id="4001929">err</span>&nbsp;<span class="op" id="4001933">!=</span>&nbsp;<span class="ident" id="4001936">nil</span>&nbsp;<span class="op" id="4001940">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001947">return</span>&nbsp;<span class="ident" id="4001954">nil</span><span class="op" id="4001957">,</span>&nbsp;<span class="ident" id="4001959">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001974">if</span>&nbsp;<span class="builtinfunc" id="4001977">len</span><span class="op" id="4001980">(</span><span class="ident" id="4001981">constraints</span><span class="op" id="4001992">.</span><span class="ident" id="4001993">Excluded</span><span class="op" id="4002001">)</span>&nbsp;<span class="op" id="4002003">&gt;</span>&nbsp;<span class="num" id="4002005">0</span>&nbsp;<span class="op" id="4002007">&amp;&amp;</span>&nbsp;<span class="ident" id="4002010">e</span><span class="op" id="4002011">.</span><span class="ident" id="4002012">Critical</span>&nbsp;<span class="op" id="4002021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002028">return</span>&nbsp;<span class="ident" id="4002035">out</span><span class="op" id="4002038">,</span>&nbsp;<span class="ident" id="4002040">UnhandledCriticalExtension</span><span class="op" id="4002066">{</span><span class="op" id="4002067">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002080">for</span>&nbsp;<span class="ident" id="4002084">_</span><span class="op" id="4002085">,</span>&nbsp;<span class="ident" id="4002087">subtree</span>&nbsp;<span class="op" id="4002095">:=</span>&nbsp;<span class="keyword" id="4002098">range</span>&nbsp;<span class="ident" id="4002104">constraints</span><span class="op" id="4002115">.</span><span class="ident" id="4002116">Permitted</span>&nbsp;<span class="op" id="4002126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002133">if</span>&nbsp;<span class="builtinfunc" id="4002136">len</span><span class="op" id="4002139">(</span><span class="ident" id="4002140">subtree</span><span class="op" id="4002147">.</span><span class="ident" id="4002148">Name</span><span class="op" id="4002152">)</span>&nbsp;<span class="op" id="4002154">==</span>&nbsp;<span class="num" id="4002157">0</span>&nbsp;<span class="op" id="4002159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002167">if</span>&nbsp;<span class="ident" id="4002170">e</span><span class="op" id="4002171">.</span><span class="ident" id="4002172">Critical</span>&nbsp;<span class="op" id="4002181">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002190">return</span>&nbsp;<span class="ident" id="4002197">out</span><span class="op" id="4002200">,</span>&nbsp;<span class="ident" id="4002202">UnhandledCriticalExtension</span><span class="op" id="4002228">{</span><span class="op" id="4002229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002245">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002266">out</span><span class="op" id="4002269">.</span><span class="ident" id="4002270">PermittedDNSDomains</span>&nbsp;<span class="op" id="4002290">=</span>&nbsp;<span class="builtinfunc" id="4002292">append</span><span class="op" id="4002298">(</span><span class="ident" id="4002299">out</span><span class="op" id="4002302">.</span><span class="ident" id="4002303">PermittedDNSDomains</span><span class="op" id="4002322">,</span>&nbsp;<span class="ident" id="4002324">subtree</span><span class="op" id="4002331">.</span><span class="ident" id="4002332">Name</span><span class="op" id="4002336">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002348">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002361">case</span>&nbsp;<span class="num" id="4002366">31</span><span class="op" id="4002368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002374">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002401">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002478">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002485">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002525">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002600">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002732">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002739">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002781">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002838">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002910">var</span>&nbsp;<span class="ident" id="4002914">cdp</span>&nbsp;<span class="op" id="4002918">[</span><span class="op" id="4002919">]</span><span class="ident" id="4002920">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002942">_</span><span class="op" id="4002943">,</span>&nbsp;<span class="ident" id="4002945">err</span>&nbsp;<span class="op" id="4002949">:=</span>&nbsp;<span class="ident" id="4002952">asn1</span><span class="op" id="4002956">.</span><span class="ident" id="4002957">Unmarshal</span><span class="op" id="4002966">(</span><span class="ident" id="4002967">e</span><span class="op" id="4002968">.</span><span class="ident" id="4002969">Value</span><span class="op" id="4002974">,</span>&nbsp;<span class="op" id="4002976">&amp;</span><span class="ident" id="4002977">cdp</span><span class="op" id="4002980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002986">if</span>&nbsp;<span class="ident" id="4002989">err</span>&nbsp;<span class="op" id="4002993">!=</span>&nbsp;<span class="ident" id="4002996">nil</span>&nbsp;<span class="op" id="4003000">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003007">return</span>&nbsp;<span class="ident" id="4003014">nil</span><span class="op" id="4003017">,</span>&nbsp;<span class="ident" id="4003019">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003034">for</span>&nbsp;<span class="ident" id="4003038">_</span><span class="op" id="4003039">,</span>&nbsp;<span class="ident" id="4003041">dp</span>&nbsp;<span class="op" id="4003044">:=</span>&nbsp;<span class="keyword" id="4003047">range</span>&nbsp;<span class="ident" id="4003053">cdp</span>&nbsp;<span class="op" id="4003057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003064">var</span>&nbsp;<span class="ident" id="4003068">n</span>&nbsp;<span class="ident" id="4003070">asn1</span><span class="op" id="4003074">.</span><span class="ident" id="4003075">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003089">_</span><span class="op" id="4003090">,</span>&nbsp;<span class="ident" id="4003092">err</span>&nbsp;<span class="op" id="4003096">=</span>&nbsp;<span class="ident" id="4003098">asn1</span><span class="op" id="4003102">.</span><span class="ident" id="4003103">Unmarshal</span><span class="op" id="4003112">(</span><span class="ident" id="4003113">dp</span><span class="op" id="4003115">.</span><span class="ident" id="4003116">DistributionPoint</span><span class="op" id="4003133">.</span><span class="ident" id="4003134">FullName</span><span class="op" id="4003142">.</span><span class="ident" id="4003143">Bytes</span><span class="op" id="4003148">,</span>&nbsp;<span class="op" id="4003150">&amp;</span><span class="ident" id="4003151">n</span><span class="op" id="4003152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003159">if</span>&nbsp;<span class="ident" id="4003162">err</span>&nbsp;<span class="op" id="4003166">!=</span>&nbsp;<span class="ident" id="4003169">nil</span>&nbsp;<span class="op" id="4003173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003181">return</span>&nbsp;<span class="ident" id="4003188">nil</span><span class="op" id="4003191">,</span>&nbsp;<span class="ident" id="4003193">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003210">if</span>&nbsp;<span class="ident" id="4003213">n</span><span class="op" id="4003214">.</span><span class="ident" id="4003215">Tag</span>&nbsp;<span class="op" id="4003219">==</span>&nbsp;<span class="num" id="4003222">6</span>&nbsp;<span class="op" id="4003224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003232">out</span><span class="op" id="4003235">.</span><span class="ident" id="4003236">CRLDistributionPoints</span>&nbsp;<span class="op" id="4003258">=</span>&nbsp;<span class="builtinfunc" id="4003260">append</span><span class="op" id="4003266">(</span><span class="ident" id="4003267">out</span><span class="op" id="4003270">.</span><span class="ident" id="4003271">CRLDistributionPoints</span><span class="op" id="4003292">,</span>&nbsp;<span class="builtintype" id="4003294">string</span><span class="op" id="4003300">(</span><span class="ident" id="4003301">n</span><span class="op" id="4003302">.</span><span class="ident" id="4003303">Bytes</span><span class="op" id="4003308">)</span><span class="op" id="4003309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003328">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003341">case</span>&nbsp;<span class="num" id="4003346">35</span><span class="op" id="4003348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003354">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003379">var</span>&nbsp;<span class="ident" id="4003383">a</span>&nbsp;<span class="ident" id="4003385">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003399">_</span><span class="op" id="4003400">,</span>&nbsp;<span class="ident" id="4003402">err</span>&nbsp;<span class="op" id="4003406">=</span>&nbsp;<span class="ident" id="4003408">asn1</span><span class="op" id="4003412">.</span><span class="ident" id="4003413">Unmarshal</span><span class="op" id="4003422">(</span><span class="ident" id="4003423">e</span><span class="op" id="4003424">.</span><span class="ident" id="4003425">Value</span><span class="op" id="4003430">,</span>&nbsp;<span class="op" id="4003432">&amp;</span><span class="ident" id="4003433">a</span><span class="op" id="4003434">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003440">if</span>&nbsp;<span class="ident" id="4003443">err</span>&nbsp;<span class="op" id="4003447">!=</span>&nbsp;<span class="ident" id="4003450">nil</span>&nbsp;<span class="op" id="4003454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003461">return</span>&nbsp;<span class="ident" id="4003468">nil</span><span class="op" id="4003471">,</span>&nbsp;<span class="ident" id="4003473">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003487">out</span><span class="op" id="4003490">.</span><span class="ident" id="4003491">AuthorityKeyId</span>&nbsp;<span class="op" id="4003506">=</span>&nbsp;<span class="ident" id="4003508">a</span><span class="op" id="4003509">.</span><span class="ident" id="4003510">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003517">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003530">case</span>&nbsp;<span class="num" id="4003535">37</span><span class="op" id="4003537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003543">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003591">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003651">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003658">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003726">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003733">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003776">var</span>&nbsp;<span class="ident" id="4003780">keyUsage</span>&nbsp;<span class="op" id="4003789">[</span><span class="op" id="4003790">]</span><span class="ident" id="4003791">asn1</span><span class="op" id="4003795">.</span><span class="ident" id="4003796">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003817">_</span><span class="op" id="4003818">,</span>&nbsp;<span class="ident" id="4003820">err</span>&nbsp;<span class="op" id="4003824">=</span>&nbsp;<span class="ident" id="4003826">asn1</span><span class="op" id="4003830">.</span><span class="ident" id="4003831">Unmarshal</span><span class="op" id="4003840">(</span><span class="ident" id="4003841">e</span><span class="op" id="4003842">.</span><span class="ident" id="4003843">Value</span><span class="op" id="4003848">,</span>&nbsp;<span class="op" id="4003850">&amp;</span><span class="ident" id="4003851">keyUsage</span><span class="op" id="4003859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003865">if</span>&nbsp;<span class="ident" id="4003868">err</span>&nbsp;<span class="op" id="4003872">!=</span>&nbsp;<span class="ident" id="4003875">nil</span>&nbsp;<span class="op" id="4003879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003886">return</span>&nbsp;<span class="ident" id="4003893">nil</span><span class="op" id="4003896">,</span>&nbsp;<span class="ident" id="4003898">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003906">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003913">for</span>&nbsp;<span class="ident" id="4003917">_</span><span class="op" id="4003918">,</span>&nbsp;<span class="ident" id="4003920">u</span>&nbsp;<span class="op" id="4003922">:=</span>&nbsp;<span class="keyword" id="4003925">range</span>&nbsp;<span class="ident" id="4003931">keyUsage</span>&nbsp;<span class="op" id="4003940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003947">if</span>&nbsp;<span class="ident" id="4003950">extKeyUsage</span><span class="op" id="4003961">,</span>&nbsp;<span class="ident" id="4003963">ok</span>&nbsp;<span class="op" id="4003966">:=</span>&nbsp;<span class="ident" id="4003969">extKeyUsageFromOID</span><span class="op" id="4003987">(</span><span class="ident" id="4003988">u</span><span class="op" id="4003989">)</span><span class="op" id="4003990">;</span>&nbsp;<span class="ident" id="4003992">ok</span>&nbsp;<span class="op" id="4003995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004003">out</span><span class="op" id="4004006">.</span><span class="ident" id="4004007">ExtKeyUsage</span>&nbsp;<span class="op" id="4004019">=</span>&nbsp;<span class="builtinfunc" id="4004021">append</span><span class="op" id="4004027">(</span><span class="ident" id="4004028">out</span><span class="op" id="4004031">.</span><span class="ident" id="4004032">ExtKeyUsage</span><span class="op" id="4004043">,</span>&nbsp;<span class="ident" id="4004045">extKeyUsage</span><span class="op" id="4004056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004063">}</span>&nbsp;<span class="keyword" id="4004065">else</span>&nbsp;<span class="op" id="4004070">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004078">out</span><span class="op" id="4004081">.</span><span class="ident" id="4004082">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4004101">=</span>&nbsp;<span class="builtinfunc" id="4004103">append</span><span class="op" id="4004109">(</span><span class="ident" id="4004110">out</span><span class="op" id="4004113">.</span><span class="ident" id="4004114">UnknownExtKeyUsage</span><span class="op" id="4004132">,</span>&nbsp;<span class="ident" id="4004134">u</span><span class="op" id="4004135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004155">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004168">case</span>&nbsp;<span class="num" id="4004173">14</span><span class="op" id="4004175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004181">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004206">var</span>&nbsp;<span class="ident" id="4004210">keyid</span>&nbsp;<span class="op" id="4004216">[</span><span class="op" id="4004217">]</span><span class="builtintype" id="4004218">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004227">_</span><span class="op" id="4004228">,</span>&nbsp;<span class="ident" id="4004230">err</span>&nbsp;<span class="op" id="4004234">=</span>&nbsp;<span class="ident" id="4004236">asn1</span><span class="op" id="4004240">.</span><span class="ident" id="4004241">Unmarshal</span><span class="op" id="4004250">(</span><span class="ident" id="4004251">e</span><span class="op" id="4004252">.</span><span class="ident" id="4004253">Value</span><span class="op" id="4004258">,</span>&nbsp;<span class="op" id="4004260">&amp;</span><span class="ident" id="4004261">keyid</span><span class="op" id="4004266">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004272">if</span>&nbsp;<span class="ident" id="4004275">err</span>&nbsp;<span class="op" id="4004279">!=</span>&nbsp;<span class="ident" id="4004282">nil</span>&nbsp;<span class="op" id="4004286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004293">return</span>&nbsp;<span class="ident" id="4004300">nil</span><span class="op" id="4004303">,</span>&nbsp;<span class="ident" id="4004305">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004319">out</span><span class="op" id="4004322">.</span><span class="ident" id="4004323">SubjectKeyId</span>&nbsp;<span class="op" id="4004336">=</span>&nbsp;<span class="ident" id="4004338">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004348">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004361">case</span>&nbsp;<span class="num" id="4004366">32</span><span class="op" id="4004368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004374">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004420">var</span>&nbsp;<span class="ident" id="4004424">policies</span>&nbsp;<span class="op" id="4004433">[</span><span class="op" id="4004434">]</span><span class="ident" id="4004435">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004457">if</span>&nbsp;<span class="ident" id="4004460">_</span><span class="op" id="4004461">,</span>&nbsp;<span class="ident" id="4004463">err</span>&nbsp;<span class="op" id="4004467">=</span>&nbsp;<span class="ident" id="4004469">asn1</span><span class="op" id="4004473">.</span><span class="ident" id="4004474">Unmarshal</span><span class="op" id="4004483">(</span><span class="ident" id="4004484">e</span><span class="op" id="4004485">.</span><span class="ident" id="4004486">Value</span><span class="op" id="4004491">,</span>&nbsp;<span class="op" id="4004493">&amp;</span><span class="ident" id="4004494">policies</span><span class="op" id="4004502">)</span><span class="op" id="4004503">;</span>&nbsp;<span class="ident" id="4004505">err</span>&nbsp;<span class="op" id="4004509">!=</span>&nbsp;<span class="ident" id="4004512">nil</span>&nbsp;<span class="op" id="4004516">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004523">return</span>&nbsp;<span class="ident" id="4004530">nil</span><span class="op" id="4004533">,</span>&nbsp;<span class="ident" id="4004535">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004549">out</span><span class="op" id="4004552">.</span><span class="ident" id="4004553">PolicyIdentifiers</span>&nbsp;<span class="op" id="4004571">=</span>&nbsp;<span class="builtinfunc" id="4004573">make</span><span class="op" id="4004577">(</span><span class="op" id="4004578">[</span><span class="op" id="4004579">]</span><span class="ident" id="4004580">asn1</span><span class="op" id="4004584">.</span><span class="ident" id="4004585">ObjectIdentifier</span><span class="op" id="4004601">,</span>&nbsp;<span class="builtinfunc" id="4004603">len</span><span class="op" id="4004606">(</span><span class="ident" id="4004607">policies</span><span class="op" id="4004615">)</span><span class="op" id="4004616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004622">for</span>&nbsp;<span class="ident" id="4004626">i</span><span class="op" id="4004627">,</span>&nbsp;<span class="ident" id="4004629">policy</span>&nbsp;<span class="op" id="4004636">:=</span>&nbsp;<span class="keyword" id="4004639">range</span>&nbsp;<span class="ident" id="4004645">policies</span>&nbsp;<span class="op" id="4004654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004661">out</span><span class="op" id="4004664">.</span><span class="ident" id="4004665">PolicyIdentifiers</span><span class="op" id="4004682">[</span><span class="ident" id="4004683">i</span><span class="op" id="4004684">]</span>&nbsp;<span class="op" id="4004686">=</span>&nbsp;<span class="ident" id="4004688">policy</span><span class="op" id="4004694">.</span><span class="ident" id="4004695">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004715">}</span>&nbsp;<span class="keyword" id="4004717">else</span>&nbsp;<span class="keyword" id="4004722">if</span>&nbsp;<span class="ident" id="4004725">e</span><span class="op" id="4004726">.</span><span class="ident" id="4004727">Id</span><span class="op" id="4004729">.</span><span class="ident" id="4004730">Equal</span><span class="op" id="4004735">(</span><span class="ident" id="4004736">oidExtensionAuthorityInfoAccess</span><span class="op" id="4004767">)</span>&nbsp;<span class="op" id="4004769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004774">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004827">var</span>&nbsp;<span class="ident" id="4004831">aia</span>&nbsp;<span class="op" id="4004835">[</span><span class="op" id="4004836">]</span><span class="ident" id="4004837">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004860">if</span>&nbsp;<span class="ident" id="4004863">_</span><span class="op" id="4004864">,</span>&nbsp;<span class="ident" id="4004866">err</span>&nbsp;<span class="op" id="4004870">=</span>&nbsp;<span class="ident" id="4004872">asn1</span><span class="op" id="4004876">.</span><span class="ident" id="4004877">Unmarshal</span><span class="op" id="4004886">(</span><span class="ident" id="4004887">e</span><span class="op" id="4004888">.</span><span class="ident" id="4004889">Value</span><span class="op" id="4004894">,</span>&nbsp;<span class="op" id="4004896">&amp;</span><span class="ident" id="4004897">aia</span><span class="op" id="4004900">)</span><span class="op" id="4004901">;</span>&nbsp;<span class="ident" id="4004903">err</span>&nbsp;<span class="op" id="4004907">!=</span>&nbsp;<span class="ident" id="4004910">nil</span>&nbsp;<span class="op" id="4004914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004920">return</span>&nbsp;<span class="ident" id="4004927">nil</span><span class="op" id="4004930">,</span>&nbsp;<span class="ident" id="4004932">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004945">for</span>&nbsp;<span class="ident" id="4004949">_</span><span class="op" id="4004950">,</span>&nbsp;<span class="ident" id="4004952">v</span>&nbsp;<span class="op" id="4004954">:=</span>&nbsp;<span class="keyword" id="4004957">range</span>&nbsp;<span class="ident" id="4004963">aia</span>&nbsp;<span class="op" id="4004967">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004973">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005033">if</span>&nbsp;<span class="ident" id="4005036">v</span><span class="op" id="4005037">.</span><span class="ident" id="4005038">Location</span><span class="op" id="4005046">.</span><span class="ident" id="4005047">Tag</span>&nbsp;<span class="op" id="4005051">!=</span>&nbsp;<span class="num" id="4005054">6</span>&nbsp;<span class="op" id="4005056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005063">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005082">if</span>&nbsp;<span class="ident" id="4005085">v</span><span class="op" id="4005086">.</span><span class="ident" id="4005087">Method</span><span class="op" id="4005093">.</span><span class="ident" id="4005094">Equal</span><span class="op" id="4005099">(</span><span class="ident" id="4005100">oidAuthorityInfoAccessOcsp</span><span class="op" id="4005126">)</span>&nbsp;<span class="op" id="4005128">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005135">out</span><span class="op" id="4005138">.</span><span class="ident" id="4005139">OCSPServer</span>&nbsp;<span class="op" id="4005150">=</span>&nbsp;<span class="builtinfunc" id="4005152">append</span><span class="op" id="4005158">(</span><span class="ident" id="4005159">out</span><span class="op" id="4005162">.</span><span class="ident" id="4005163">OCSPServer</span><span class="op" id="4005173">,</span>&nbsp;<span class="builtintype" id="4005175">string</span><span class="op" id="4005181">(</span><span class="ident" id="4005182">v</span><span class="op" id="4005183">.</span><span class="ident" id="4005184">Location</span><span class="op" id="4005192">.</span><span class="ident" id="4005193">Bytes</span><span class="op" id="4005198">)</span><span class="op" id="4005199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005205">}</span>&nbsp;<span class="keyword" id="4005207">else</span>&nbsp;<span class="keyword" id="4005212">if</span>&nbsp;<span class="ident" id="4005215">v</span><span class="op" id="4005216">.</span><span class="ident" id="4005217">Method</span><span class="op" id="4005223">.</span><span class="ident" id="4005224">Equal</span><span class="op" id="4005229">(</span><span class="ident" id="4005230">oidAuthorityInfoAccessIssuers</span><span class="op" id="4005259">)</span>&nbsp;<span class="op" id="4005261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005268">out</span><span class="op" id="4005271">.</span><span class="ident" id="4005272">IssuingCertificateURL</span>&nbsp;<span class="op" id="4005294">=</span>&nbsp;<span class="builtinfunc" id="4005296">append</span><span class="op" id="4005302">(</span><span class="ident" id="4005303">out</span><span class="op" id="4005306">.</span><span class="ident" id="4005307">IssuingCertificateURL</span><span class="op" id="4005328">,</span>&nbsp;<span class="builtintype" id="4005330">string</span><span class="op" id="4005336">(</span><span class="ident" id="4005337">v</span><span class="op" id="4005338">.</span><span class="ident" id="4005339">Location</span><span class="op" id="4005347">.</span><span class="ident" id="4005348">Bytes</span><span class="op" id="4005353">)</span><span class="op" id="4005354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005365">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005374">if</span>&nbsp;<span class="ident" id="4005377">e</span><span class="op" id="4005378">.</span><span class="ident" id="4005379">Critical</span>&nbsp;<span class="op" id="4005388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005393">return</span>&nbsp;<span class="ident" id="4005400">out</span><span class="op" id="4005403">,</span>&nbsp;<span class="ident" id="4005405">UnhandledCriticalExtension</span><span class="op" id="4005431">{</span><span class="op" id="4005432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005436">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005443">return</span>&nbsp;<span class="ident" id="4005450">out</span><span class="op" id="4005453">,</span>&nbsp;<span class="ident" id="4005455">nil</span><br>
<span class="lineno"></span><span class="op" id="4005459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4005462">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4005541">func</span>&nbsp;<span class="ident" id="4005546">ParseCertificate</span><span class="op" id="4005562">(</span><span class="ident" id="4005563">asn1Data</span>&nbsp;<span class="op" id="4005572">[</span><span class="op" id="4005573">]</span><span class="builtintype" id="4005574">byte</span><span class="op" id="4005578">)</span>&nbsp;<span class="op" id="4005580">(</span><span class="op" id="4005581">*</span><span class="ident" id="4005582">Certificate</span><span class="op" id="4005593">,</span>&nbsp;<span class="builtintype" id="4005595">error</span><span class="op" id="4005600">)</span>&nbsp;<span class="op" id="4005602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005605">var</span>&nbsp;<span class="ident" id="4005609">cert</span>&nbsp;<span class="ident" id="4005614">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005627">rest</span><span class="op" id="4005631">,</span>&nbsp;<span class="ident" id="4005633">err</span>&nbsp;<span class="op" id="4005637">:=</span>&nbsp;<span class="ident" id="4005640">asn1</span><span class="op" id="4005644">.</span><span class="ident" id="4005645">Unmarshal</span><span class="op" id="4005654">(</span><span class="ident" id="4005655">asn1Data</span><span class="op" id="4005663">,</span>&nbsp;<span class="op" id="4005665">&amp;</span><span class="ident" id="4005666">cert</span><span class="op" id="4005670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005673">if</span>&nbsp;<span class="ident" id="4005676">err</span>&nbsp;<span class="op" id="4005680">!=</span>&nbsp;<span class="ident" id="4005683">nil</span>&nbsp;<span class="op" id="4005687">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005691">return</span>&nbsp;<span class="ident" id="4005698">nil</span><span class="op" id="4005701">,</span>&nbsp;<span class="ident" id="4005703">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005711">if</span>&nbsp;<span class="builtinfunc" id="4005714">len</span><span class="op" id="4005717">(</span><span class="ident" id="4005718">rest</span><span class="op" id="4005722">)</span>&nbsp;<span class="op" id="4005724">&gt;</span>&nbsp;<span class="num" id="4005726">0</span>&nbsp;<span class="op" id="4005728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005732">return</span>&nbsp;<span class="ident" id="4005739">nil</span><span class="op" id="4005742">,</span>&nbsp;<span class="ident" id="4005744">asn1</span><span class="op" id="4005748">.</span><span class="ident" id="4005749">SyntaxError</span><span class="op" id="4005760">{</span><span class="ident" id="4005761">Msg</span><span class="op" id="4005764">:</span>&nbsp;<span class="string" id="4005766">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4005781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005784">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005788">return</span>&nbsp;<span class="ident" id="4005795">parseCertificate</span><span class="op" id="4005811">(</span><span class="op" id="4005812">&amp;</span><span class="ident" id="4005813">cert</span><span class="op" id="4005817">)</span><br>
<span class="lineno"></span><span class="op" id="4005819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4005822">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4005900">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4005977">func</span>&nbsp;<span class="ident" id="4005982">ParseCertificates</span><span class="op" id="4005999">(</span><span class="ident" id="4006000">asn1Data</span>&nbsp;<span class="op" id="4006009">[</span><span class="op" id="4006010">]</span><span class="builtintype" id="4006011">byte</span><span class="op" id="4006015">)</span>&nbsp;<span class="op" id="4006017">(</span><span class="op" id="4006018">[</span><span class="op" id="4006019">]</span><span class="op" id="4006020">*</span><span class="ident" id="4006021">Certificate</span><span class="op" id="4006032">,</span>&nbsp;<span class="builtintype" id="4006034">error</span><span class="op" id="4006039">)</span>&nbsp;<span class="op" id="4006041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006044">var</span>&nbsp;<span class="ident" id="4006048">v</span>&nbsp;<span class="op" id="4006050">[</span><span class="op" id="4006051">]</span><span class="op" id="4006052">*</span><span class="ident" id="4006053">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006067">for</span>&nbsp;<span class="builtinfunc" id="4006071">len</span><span class="op" id="4006074">(</span><span class="ident" id="4006075">asn1Data</span><span class="op" id="4006083">)</span>&nbsp;<span class="op" id="4006085">&gt;</span>&nbsp;<span class="num" id="4006087">0</span>&nbsp;<span class="op" id="4006089">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006093">cert</span>&nbsp;<span class="op" id="4006098">:=</span>&nbsp;<span class="builtinfunc" id="4006101">new</span><span class="op" id="4006104">(</span><span class="ident" id="4006105">certificate</span><span class="op" id="4006116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006120">var</span>&nbsp;<span class="ident" id="4006124">err</span>&nbsp;<span class="builtintype" id="4006128">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006136">asn1Data</span><span class="op" id="4006144">,</span>&nbsp;<span class="ident" id="4006146">err</span>&nbsp;<span class="op" id="4006150">=</span>&nbsp;<span class="ident" id="4006152">asn1</span><span class="op" id="4006156">.</span><span class="ident" id="4006157">Unmarshal</span><span class="op" id="4006166">(</span><span class="ident" id="4006167">asn1Data</span><span class="op" id="4006175">,</span>&nbsp;<span class="ident" id="4006177">cert</span><span class="op" id="4006181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006185">if</span>&nbsp;<span class="ident" id="4006188">err</span>&nbsp;<span class="op" id="4006192">!=</span>&nbsp;<span class="ident" id="4006195">nil</span>&nbsp;<span class="op" id="4006199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006204">return</span>&nbsp;<span class="ident" id="4006211">nil</span><span class="op" id="4006214">,</span>&nbsp;<span class="ident" id="4006216">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006226">v</span>&nbsp;<span class="op" id="4006228">=</span>&nbsp;<span class="builtinfunc" id="4006230">append</span><span class="op" id="4006236">(</span><span class="ident" id="4006237">v</span><span class="op" id="4006238">,</span>&nbsp;<span class="ident" id="4006240">cert</span><span class="op" id="4006244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006251">ret</span>&nbsp;<span class="op" id="4006255">:=</span>&nbsp;<span class="builtinfunc" id="4006258">make</span><span class="op" id="4006262">(</span><span class="op" id="4006263">[</span><span class="op" id="4006264">]</span><span class="op" id="4006265">*</span><span class="ident" id="4006266">Certificate</span><span class="op" id="4006277">,</span>&nbsp;<span class="builtinfunc" id="4006279">len</span><span class="op" id="4006282">(</span><span class="ident" id="4006283">v</span><span class="op" id="4006284">)</span><span class="op" id="4006285">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006288">for</span>&nbsp;<span class="ident" id="4006292">i</span><span class="op" id="4006293">,</span>&nbsp;<span class="ident" id="4006295">ci</span>&nbsp;<span class="op" id="4006298">:=</span>&nbsp;<span class="keyword" id="4006301">range</span>&nbsp;<span class="ident" id="4006307">v</span>&nbsp;<span class="op" id="4006309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006313">cert</span><span class="op" id="4006317">,</span>&nbsp;<span class="ident" id="4006319">err</span>&nbsp;<span class="op" id="4006323">:=</span>&nbsp;<span class="ident" id="4006326">parseCertificate</span><span class="op" id="4006342">(</span><span class="ident" id="4006343">ci</span><span class="op" id="4006345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006349">if</span>&nbsp;<span class="ident" id="4006352">err</span>&nbsp;<span class="op" id="4006356">!=</span>&nbsp;<span class="ident" id="4006359">nil</span>&nbsp;<span class="op" id="4006363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006368">return</span>&nbsp;<span class="ident" id="4006375">nil</span><span class="op" id="4006378">,</span>&nbsp;<span class="ident" id="4006380">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006386">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006390">ret</span><span class="op" id="4006393">[</span><span class="ident" id="4006394">i</span><span class="op" id="4006395">]</span>&nbsp;<span class="op" id="4006397">=</span>&nbsp;<span class="ident" id="4006399">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006409">return</span>&nbsp;<span class="ident" id="4006416">ret</span><span class="op" id="4006419">,</span>&nbsp;<span class="ident" id="4006421">nil</span><br>
<span class="lineno"></span><span class="op" id="4006425">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4006428">func</span>&nbsp;<span class="ident" id="4006433">reverseBitsInAByte</span><span class="op" id="4006451">(</span><span class="ident" id="4006452">in</span>&nbsp;<span class="builtintype" id="4006455">byte</span><span class="op" id="4006459">)</span>&nbsp;<span class="builtintype" id="4006461">byte</span>&nbsp;<span class="op" id="4006466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006469">b1</span>&nbsp;<span class="op" id="4006472">:=</span>&nbsp;<span class="ident" id="4006475">in</span><span class="op" id="4006477">&gt;&gt;</span><span class="num" id="4006479">4</span>&nbsp;<span class="op" id="4006481">|</span>&nbsp;<span class="ident" id="4006483">in</span><span class="op" id="4006485">&lt;&lt;</span><span class="num" id="4006487">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006490">b2</span>&nbsp;<span class="op" id="4006493">:=</span>&nbsp;<span class="ident" id="4006496">b1</span><span class="op" id="4006498">&gt;&gt;</span><span class="num" id="4006500">2</span><span class="op" id="4006501">&amp;</span><span class="num" id="4006502">0x33</span>&nbsp;<span class="op" id="4006507">|</span>&nbsp;<span class="ident" id="4006509">b1</span><span class="op" id="4006511">&lt;&lt;</span><span class="num" id="4006513">2</span><span class="op" id="4006514">&amp;</span><span class="num" id="4006515">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006521">b3</span>&nbsp;<span class="op" id="4006524">:=</span>&nbsp;<span class="ident" id="4006527">b2</span><span class="op" id="4006529">&gt;&gt;</span><span class="num" id="4006531">1</span><span class="op" id="4006532">&amp;</span><span class="num" id="4006533">0x55</span>&nbsp;<span class="op" id="4006538">|</span>&nbsp;<span class="ident" id="4006540">b2</span><span class="op" id="4006542">&lt;&lt;</span><span class="num" id="4006544">1</span><span class="op" id="4006545">&amp;</span><span class="num" id="4006546">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006552">return</span>&nbsp;<span class="ident" id="4006559">b3</span><br>
<span class="lineno"></span><span class="op" id="4006562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006565">var</span>&nbsp;<span class="op" id="4006569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006572">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006606">=</span>&nbsp;<span class="op" id="4006608">[</span><span class="op" id="4006609">]</span><span class="builtintype" id="4006610">int</span><span class="op" id="4006613">{</span><span class="num" id="4006614">2</span><span class="op" id="4006615">,</span>&nbsp;<span class="num" id="4006617">5</span><span class="op" id="4006618">,</span>&nbsp;<span class="num" id="4006620">29</span><span class="op" id="4006622">,</span>&nbsp;<span class="num" id="4006624">14</span><span class="op" id="4006626">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006629">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006663">=</span>&nbsp;<span class="op" id="4006665">[</span><span class="op" id="4006666">]</span><span class="builtintype" id="4006667">int</span><span class="op" id="4006670">{</span><span class="num" id="4006671">2</span><span class="op" id="4006672">,</span>&nbsp;<span class="num" id="4006674">5</span><span class="op" id="4006675">,</span>&nbsp;<span class="num" id="4006677">29</span><span class="op" id="4006679">,</span>&nbsp;<span class="num" id="4006681">15</span><span class="op" id="4006683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006686">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006720">=</span>&nbsp;<span class="op" id="4006722">[</span><span class="op" id="4006723">]</span><span class="builtintype" id="4006724">int</span><span class="op" id="4006727">{</span><span class="num" id="4006728">2</span><span class="op" id="4006729">,</span>&nbsp;<span class="num" id="4006731">5</span><span class="op" id="4006732">,</span>&nbsp;<span class="num" id="4006734">29</span><span class="op" id="4006736">,</span>&nbsp;<span class="num" id="4006738">37</span><span class="op" id="4006740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006743">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006777">=</span>&nbsp;<span class="op" id="4006779">[</span><span class="op" id="4006780">]</span><span class="builtintype" id="4006781">int</span><span class="op" id="4006784">{</span><span class="num" id="4006785">2</span><span class="op" id="4006786">,</span>&nbsp;<span class="num" id="4006788">5</span><span class="op" id="4006789">,</span>&nbsp;<span class="num" id="4006791">29</span><span class="op" id="4006793">,</span>&nbsp;<span class="num" id="4006795">35</span><span class="op" id="4006797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006800">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006834">=</span>&nbsp;<span class="op" id="4006836">[</span><span class="op" id="4006837">]</span><span class="builtintype" id="4006838">int</span><span class="op" id="4006841">{</span><span class="num" id="4006842">2</span><span class="op" id="4006843">,</span>&nbsp;<span class="num" id="4006845">5</span><span class="op" id="4006846">,</span>&nbsp;<span class="num" id="4006848">29</span><span class="op" id="4006850">,</span>&nbsp;<span class="num" id="4006852">19</span><span class="op" id="4006854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006857">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006891">=</span>&nbsp;<span class="op" id="4006893">[</span><span class="op" id="4006894">]</span><span class="builtintype" id="4006895">int</span><span class="op" id="4006898">{</span><span class="num" id="4006899">2</span><span class="op" id="4006900">,</span>&nbsp;<span class="num" id="4006902">5</span><span class="op" id="4006903">,</span>&nbsp;<span class="num" id="4006905">29</span><span class="op" id="4006907">,</span>&nbsp;<span class="num" id="4006909">17</span><span class="op" id="4006911">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006914">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4006948">=</span>&nbsp;<span class="op" id="4006950">[</span><span class="op" id="4006951">]</span><span class="builtintype" id="4006952">int</span><span class="op" id="4006955">{</span><span class="num" id="4006956">2</span><span class="op" id="4006957">,</span>&nbsp;<span class="num" id="4006959">5</span><span class="op" id="4006960">,</span>&nbsp;<span class="num" id="4006962">29</span><span class="op" id="4006964">,</span>&nbsp;<span class="num" id="4006966">32</span><span class="op" id="4006968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006971">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007005">=</span>&nbsp;<span class="op" id="4007007">[</span><span class="op" id="4007008">]</span><span class="builtintype" id="4007009">int</span><span class="op" id="4007012">{</span><span class="num" id="4007013">2</span><span class="op" id="4007014">,</span>&nbsp;<span class="num" id="4007016">5</span><span class="op" id="4007017">,</span>&nbsp;<span class="num" id="4007019">29</span><span class="op" id="4007021">,</span>&nbsp;<span class="num" id="4007023">30</span><span class="op" id="4007025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007028">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4007062">=</span>&nbsp;<span class="op" id="4007064">[</span><span class="op" id="4007065">]</span><span class="builtintype" id="4007066">int</span><span class="op" id="4007069">{</span><span class="num" id="4007070">2</span><span class="op" id="4007071">,</span>&nbsp;<span class="num" id="4007073">5</span><span class="op" id="4007074">,</span>&nbsp;<span class="num" id="4007076">29</span><span class="op" id="4007078">,</span>&nbsp;<span class="num" id="4007080">31</span><span class="op" id="4007082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007085">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4007119">=</span>&nbsp;<span class="op" id="4007121">[</span><span class="op" id="4007122">]</span><span class="builtintype" id="4007123">int</span><span class="op" id="4007126">{</span><span class="num" id="4007127">1</span><span class="op" id="4007128">,</span>&nbsp;<span class="num" id="4007130">3</span><span class="op" id="4007131">,</span>&nbsp;<span class="num" id="4007133">6</span><span class="op" id="4007134">,</span>&nbsp;<span class="num" id="4007136">1</span><span class="op" id="4007137">,</span>&nbsp;<span class="num" id="4007139">5</span><span class="op" id="4007140">,</span>&nbsp;<span class="num" id="4007142">5</span><span class="op" id="4007143">,</span>&nbsp;<span class="num" id="4007145">7</span><span class="op" id="4007146">,</span>&nbsp;<span class="num" id="4007148">1</span><span class="op" id="4007149">,</span>&nbsp;<span class="num" id="4007151">1</span><span class="op" id="4007152">}</span><br>
<span class="lineno"></span><span class="op" id="4007154">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4007157">var</span>&nbsp;<span class="op" id="4007161">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007164">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007194">=</span>&nbsp;<span class="ident" id="4007196">asn1</span><span class="op" id="4007200">.</span><span class="ident" id="4007201">ObjectIdentifier</span><span class="op" id="4007217">{</span><span class="num" id="4007218">1</span><span class="op" id="4007219">,</span>&nbsp;<span class="num" id="4007221">3</span><span class="op" id="4007222">,</span>&nbsp;<span class="num" id="4007224">6</span><span class="op" id="4007225">,</span>&nbsp;<span class="num" id="4007227">1</span><span class="op" id="4007228">,</span>&nbsp;<span class="num" id="4007230">5</span><span class="op" id="4007231">,</span>&nbsp;<span class="num" id="4007233">5</span><span class="op" id="4007234">,</span>&nbsp;<span class="num" id="4007236">7</span><span class="op" id="4007237">,</span>&nbsp;<span class="num" id="4007239">48</span><span class="op" id="4007241">,</span>&nbsp;<span class="num" id="4007243">1</span><span class="op" id="4007244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007247">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4007277">=</span>&nbsp;<span class="ident" id="4007279">asn1</span><span class="op" id="4007283">.</span><span class="ident" id="4007284">ObjectIdentifier</span><span class="op" id="4007300">{</span><span class="num" id="4007301">1</span><span class="op" id="4007302">,</span>&nbsp;<span class="num" id="4007304">3</span><span class="op" id="4007305">,</span>&nbsp;<span class="num" id="4007307">6</span><span class="op" id="4007308">,</span>&nbsp;<span class="num" id="4007310">1</span><span class="op" id="4007311">,</span>&nbsp;<span class="num" id="4007313">5</span><span class="op" id="4007314">,</span>&nbsp;<span class="num" id="4007316">5</span><span class="op" id="4007317">,</span>&nbsp;<span class="num" id="4007319">7</span><span class="op" id="4007320">,</span>&nbsp;<span class="num" id="4007322">48</span><span class="op" id="4007324">,</span>&nbsp;<span class="num" id="4007326">2</span><span class="op" id="4007327">}</span><br>
<span class="lineno"></span><span class="op" id="4007329">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4007332">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4007412">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4007427">func</span>&nbsp;<span class="ident" id="4007432">oidInExtensions</span><span class="op" id="4007447">(</span><span class="ident" id="4007448">oid</span>&nbsp;<span class="ident" id="4007452">asn1</span><span class="op" id="4007456">.</span><span class="ident" id="4007457">ObjectIdentifier</span><span class="op" id="4007473">,</span>&nbsp;<span class="ident" id="4007475">extensions</span>&nbsp;<span class="op" id="4007486">[</span><span class="op" id="4007487">]</span><span class="ident" id="4007488">pkix</span><span class="op" id="4007492">.</span><span class="ident" id="4007493">Extension</span><span class="op" id="4007502">)</span>&nbsp;<span class="builtintype" id="4007504">bool</span>&nbsp;<span class="op" id="4007509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007512">for</span>&nbsp;<span class="ident" id="4007516">_</span><span class="op" id="4007517">,</span>&nbsp;<span class="ident" id="4007519">e</span>&nbsp;<span class="op" id="4007521">:=</span>&nbsp;<span class="keyword" id="4007524">range</span>&nbsp;<span class="ident" id="4007530">extensions</span>&nbsp;<span class="op" id="4007541">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007545">if</span>&nbsp;<span class="ident" id="4007548">e</span><span class="op" id="4007549">.</span><span class="ident" id="4007550">Id</span><span class="op" id="4007552">.</span><span class="ident" id="4007553">Equal</span><span class="op" id="4007558">(</span><span class="ident" id="4007559">oid</span><span class="op" id="4007562">)</span>&nbsp;<span class="op" id="4007564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007569">return</span>&nbsp;<span class="builtintype" id="4007576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007589">return</span>&nbsp;<span class="builtintype" id="4007596">false</span><br>
<span class="lineno">1165</span><span class="op" id="4007602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007605">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4007681">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4007718">func</span>&nbsp;<span class="ident" id="4007723">marshalSANs</span><span class="op" id="4007734">(</span><span class="ident" id="4007735">dnsNames</span><span class="op" id="4007743">,</span>&nbsp;<span class="ident" id="4007745">emailAddresses</span>&nbsp;<span class="op" id="4007760">[</span><span class="op" id="4007761">]</span><span class="builtintype" id="4007762">string</span><span class="op" id="4007768">,</span>&nbsp;<span class="ident" id="4007770">ipAddresses</span>&nbsp;<span class="op" id="4007782">[</span><span class="op" id="4007783">]</span><span class="ident" id="4007784">net</span><span class="op" id="4007787">.</span><span class="ident" id="4007788">IP</span><span class="op" id="4007790">)</span>&nbsp;<span class="op" id="4007792">(</span><span class="ident" id="4007793">derBytes</span>&nbsp;<span class="op" id="4007802">[</span><span class="op" id="4007803">]</span><span class="builtintype" id="4007804">byte</span><span class="op" id="4007808">,</span>&nbsp;<span class="ident" id="4007810">err</span>&nbsp;<span class="builtintype" id="4007814">error</span><span class="op" id="4007819">)</span>&nbsp;<span class="op" id="4007821">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007824">var</span>&nbsp;<span class="ident" id="4007828">rawValues</span>&nbsp;<span class="op" id="4007838">[</span><span class="op" id="4007839">]</span><span class="ident" id="4007840">asn1</span><span class="op" id="4007844">.</span><span class="ident" id="4007845">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007855">for</span>&nbsp;<span class="ident" id="4007859">_</span><span class="op" id="4007860">,</span>&nbsp;<span class="ident" id="4007862">name</span>&nbsp;<span class="op" id="4007867">:=</span>&nbsp;<span class="keyword" id="4007870">range</span>&nbsp;<span class="ident" id="4007876">dnsNames</span>&nbsp;<span class="op" id="4007885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007889">rawValues</span>&nbsp;<span class="op" id="4007899">=</span>&nbsp;<span class="builtinfunc" id="4007901">append</span><span class="op" id="4007907">(</span><span class="ident" id="4007908">rawValues</span><span class="op" id="4007917">,</span>&nbsp;<span class="ident" id="4007919">asn1</span><span class="op" id="4007923">.</span><span class="ident" id="4007924">RawValue</span><span class="op" id="4007932">{</span><span class="ident" id="4007933">Tag</span><span class="op" id="4007936">:</span>&nbsp;<span class="num" id="4007938">2</span><span class="op" id="4007939">,</span>&nbsp;<span class="ident" id="4007941">Class</span><span class="op" id="4007946">:</span>&nbsp;<span class="num" id="4007948">2</span><span class="op" id="4007949">,</span>&nbsp;<span class="ident" id="4007951">Bytes</span><span class="op" id="4007956">:</span>&nbsp;<span class="op" id="4007958">[</span><span class="op" id="4007959">]</span><span class="builtintype" id="4007960">byte</span><span class="op" id="4007964">(</span><span class="ident" id="4007965">name</span><span class="op" id="4007969">)</span><span class="op" id="4007970">}</span><span class="op" id="4007971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007977">for</span>&nbsp;<span class="ident" id="4007981">_</span><span class="op" id="4007982">,</span>&nbsp;<span class="ident" id="4007984">email</span>&nbsp;<span class="op" id="4007990">:=</span>&nbsp;<span class="keyword" id="4007993">range</span>&nbsp;<span class="ident" id="4007999">emailAddresses</span>&nbsp;<span class="op" id="4008014">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008018">rawValues</span>&nbsp;<span class="op" id="4008028">=</span>&nbsp;<span class="builtinfunc" id="4008030">append</span><span class="op" id="4008036">(</span><span class="ident" id="4008037">rawValues</span><span class="op" id="4008046">,</span>&nbsp;<span class="ident" id="4008048">asn1</span><span class="op" id="4008052">.</span><span class="ident" id="4008053">RawValue</span><span class="op" id="4008061">{</span><span class="ident" id="4008062">Tag</span><span class="op" id="4008065">:</span>&nbsp;<span class="num" id="4008067">1</span><span class="op" id="4008068">,</span>&nbsp;<span class="ident" id="4008070">Class</span><span class="op" id="4008075">:</span>&nbsp;<span class="num" id="4008077">2</span><span class="op" id="4008078">,</span>&nbsp;<span class="ident" id="4008080">Bytes</span><span class="op" id="4008085">:</span>&nbsp;<span class="op" id="4008087">[</span><span class="op" id="4008088">]</span><span class="builtintype" id="4008089">byte</span><span class="op" id="4008093">(</span><span class="ident" id="4008094">email</span><span class="op" id="4008099">)</span><span class="op" id="4008100">}</span><span class="op" id="4008101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008107">for</span>&nbsp;<span class="ident" id="4008111">_</span><span class="op" id="4008112">,</span>&nbsp;<span class="ident" id="4008114">rawIP</span>&nbsp;<span class="op" id="4008120">:=</span>&nbsp;<span class="keyword" id="4008123">range</span>&nbsp;<span class="ident" id="4008129">ipAddresses</span>&nbsp;<span class="op" id="4008141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4008145">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008215">ip</span>&nbsp;<span class="op" id="4008218">:=</span>&nbsp;<span class="ident" id="4008221">rawIP</span><span class="op" id="4008226">.</span><span class="ident" id="4008227">To4</span><span class="op" id="4008230">(</span><span class="op" id="4008231">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008235">if</span>&nbsp;<span class="ident" id="4008238">ip</span>&nbsp;<span class="op" id="4008241">==</span>&nbsp;<span class="ident" id="4008244">nil</span>&nbsp;<span class="op" id="4008248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008253">ip</span>&nbsp;<span class="op" id="4008256">=</span>&nbsp;<span class="ident" id="4008258">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008270">rawValues</span>&nbsp;<span class="op" id="4008280">=</span>&nbsp;<span class="builtinfunc" id="4008282">append</span><span class="op" id="4008288">(</span><span class="ident" id="4008289">rawValues</span><span class="op" id="4008298">,</span>&nbsp;<span class="ident" id="4008300">asn1</span><span class="op" id="4008304">.</span><span class="ident" id="4008305">RawValue</span><span class="op" id="4008313">{</span><span class="ident" id="4008314">Tag</span><span class="op" id="4008317">:</span>&nbsp;<span class="num" id="4008319">7</span><span class="op" id="4008320">,</span>&nbsp;<span class="ident" id="4008322">Class</span><span class="op" id="4008327">:</span>&nbsp;<span class="num" id="4008329">2</span><span class="op" id="4008330">,</span>&nbsp;<span class="ident" id="4008332">Bytes</span><span class="op" id="4008337">:</span>&nbsp;<span class="ident" id="4008339">ip</span><span class="op" id="4008341">}</span><span class="op" id="4008342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008345">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008348">return</span>&nbsp;<span class="ident" id="4008355">asn1</span><span class="op" id="4008359">.</span><span class="ident" id="4008360">Marshal</span><span class="op" id="4008367">(</span><span class="ident" id="4008368">rawValues</span><span class="op" id="4008377">)</span><br>
<span class="lineno"></span><span class="op" id="4008379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008382">func</span>&nbsp;<span class="ident" id="4008387">buildExtensions</span><span class="op" id="4008402">(</span><span class="ident" id="4008403">template</span>&nbsp;<span class="op" id="4008412">*</span><span class="ident" id="4008413">Certificate</span><span class="op" id="4008424">)</span>&nbsp;<span class="op" id="4008426">(</span><span class="ident" id="4008427">ret</span>&nbsp;<span class="op" id="4008431">[</span><span class="op" id="4008432">]</span><span class="ident" id="4008433">pkix</span><span class="op" id="4008437">.</span><span class="ident" id="4008438">Extension</span><span class="op" id="4008447">,</span>&nbsp;<span class="ident" id="4008449">err</span>&nbsp;<span class="builtintype" id="4008453">error</span><span class="op" id="4008458">)</span>&nbsp;<span class="op" id="4008460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008463">ret</span>&nbsp;<span class="op" id="4008467">=</span>&nbsp;<span class="builtinfunc" id="4008469">make</span><span class="op" id="4008473">(</span><span class="op" id="4008474">[</span><span class="op" id="4008475">]</span><span class="ident" id="4008476">pkix</span><span class="op" id="4008480">.</span><span class="ident" id="4008481">Extension</span><span class="op" id="4008490">,</span>&nbsp;<span class="num" id="4008492">10</span>&nbsp;<span class="comment" id="4008495">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4008528">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008531">n</span>&nbsp;<span class="op" id="4008533">:=</span>&nbsp;<span class="num" id="4008536">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008540">if</span>&nbsp;<span class="ident" id="4008543">template</span><span class="op" id="4008551">.</span><span class="ident" id="4008552">KeyUsage</span>&nbsp;<span class="op" id="4008561">!=</span>&nbsp;<span class="num" id="4008564">0</span>&nbsp;<span class="op" id="4008566">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008571">!</span><span class="ident" id="4008572">oidInExtensions</span><span class="op" id="4008587">(</span><span class="ident" id="4008588">oidExtensionKeyUsage</span><span class="op" id="4008608">,</span>&nbsp;<span class="ident" id="4008610">template</span><span class="op" id="4008618">.</span><span class="ident" id="4008619">ExtraExtensions</span><span class="op" id="4008634">)</span>&nbsp;<span class="op" id="4008636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008640">ret</span><span class="op" id="4008643">[</span><span class="ident" id="4008644">n</span><span class="op" id="4008645">]</span><span class="op" id="4008646">.</span><span class="ident" id="4008647">Id</span>&nbsp;<span class="op" id="4008650">=</span>&nbsp;<span class="ident" id="4008652">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008675">ret</span><span class="op" id="4008678">[</span><span class="ident" id="4008679">n</span><span class="op" id="4008680">]</span><span class="op" id="4008681">.</span><span class="ident" id="4008682">Critical</span>&nbsp;<span class="op" id="4008691">=</span>&nbsp;<span class="builtintype" id="4008693">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008701">var</span>&nbsp;<span class="ident" id="4008705">a</span>&nbsp;<span class="op" id="4008707">[</span><span class="num" id="4008708">2</span><span class="op" id="4008709">]</span><span class="builtintype" id="4008710">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008717">a</span><span class="op" id="4008718">[</span><span class="num" id="4008719">0</span><span class="op" id="4008720">]</span>&nbsp;<span class="op" id="4008722">=</span>&nbsp;<span class="ident" id="4008724">reverseBitsInAByte</span><span class="op" id="4008742">(</span><span class="builtintype" id="4008743">byte</span><span class="op" id="4008747">(</span><span class="ident" id="4008748">template</span><span class="op" id="4008756">.</span><span class="ident" id="4008757">KeyUsage</span><span class="op" id="4008765">)</span><span class="op" id="4008766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008770">a</span><span class="op" id="4008771">[</span><span class="num" id="4008772">1</span><span class="op" id="4008773">]</span>&nbsp;<span class="op" id="4008775">=</span>&nbsp;<span class="ident" id="4008777">reverseBitsInAByte</span><span class="op" id="4008795">(</span><span class="builtintype" id="4008796">byte</span><span class="op" id="4008800">(</span><span class="ident" id="4008801">template</span><span class="op" id="4008809">.</span><span class="ident" id="4008810">KeyUsage</span>&nbsp;<span class="op" id="4008819">&gt;&gt;</span>&nbsp;<span class="num" id="4008822">8</span><span class="op" id="4008823">)</span><span class="op" id="4008824">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008829">l</span>&nbsp;<span class="op" id="4008831">:=</span>&nbsp;<span class="num" id="4008834">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008838">if</span>&nbsp;<span class="ident" id="4008841">a</span><span class="op" id="4008842">[</span><span class="num" id="4008843">1</span><span class="op" id="4008844">]</span>&nbsp;<span class="op" id="4008846">!=</span>&nbsp;<span class="num" id="4008849">0</span>&nbsp;<span class="op" id="4008851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008856">l</span>&nbsp;<span class="op" id="4008858">=</span>&nbsp;<span class="num" id="4008860">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008864">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008869">ret</span><span class="op" id="4008872">[</span><span class="ident" id="4008873">n</span><span class="op" id="4008874">]</span><span class="op" id="4008875">.</span><span class="ident" id="4008876">Value</span><span class="op" id="4008881">,</span>&nbsp;<span class="ident" id="4008883">err</span>&nbsp;<span class="op" id="4008887">=</span>&nbsp;<span class="ident" id="4008889">asn1</span><span class="op" id="4008893">.</span><span class="ident" id="4008894">Marshal</span><span class="op" id="4008901">(</span><span class="ident" id="4008902">asn1</span><span class="op" id="4008906">.</span><span class="ident" id="4008907">BitString</span><span class="op" id="4008916">{</span><span class="ident" id="4008917">Bytes</span><span class="op" id="4008922">:</span>&nbsp;<span class="ident" id="4008924">a</span><span class="op" id="4008925">[</span><span class="num" id="4008926">0</span><span class="op" id="4008927">:</span><span class="ident" id="4008928">l</span><span class="op" id="4008929">]</span><span class="op" id="4008930">,</span>&nbsp;<span class="ident" id="4008932">BitLength</span><span class="op" id="4008941">:</span>&nbsp;<span class="ident" id="4008943">l</span>&nbsp;<span class="op" id="4008945">*</span>&nbsp;<span class="num" id="4008947">8</span><span class="op" id="4008948">}</span><span class="op" id="4008949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008953">if</span>&nbsp;<span class="ident" id="4008956">err</span>&nbsp;<span class="op" id="4008960">!=</span>&nbsp;<span class="ident" id="4008963">nil</span>&nbsp;<span class="op" id="4008967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008972">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008981">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008985">n</span><span class="op" id="4008986">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008994">if</span>&nbsp;<span class="op" id="4008997">(</span><span class="builtinfunc" id="4008998">len</span><span class="op" id="4009001">(</span><span class="ident" id="4009002">template</span><span class="op" id="4009010">.</span><span class="ident" id="4009011">ExtKeyUsage</span><span class="op" id="4009022">)</span>&nbsp;<span class="op" id="4009024">&gt;</span>&nbsp;<span class="num" id="4009026">0</span>&nbsp;<span class="op" id="4009028">||</span>&nbsp;<span class="builtinfunc" id="4009031">len</span><span class="op" id="4009034">(</span><span class="ident" id="4009035">template</span><span class="op" id="4009043">.</span><span class="ident" id="4009044">UnknownExtKeyUsage</span><span class="op" id="4009062">)</span>&nbsp;<span class="op" id="4009064">&gt;</span>&nbsp;<span class="num" id="4009066">0</span><span class="op" id="4009067">)</span>&nbsp;<span class="op" id="4009069">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009074">!</span><span class="ident" id="4009075">oidInExtensions</span><span class="op" id="4009090">(</span><span class="ident" id="4009091">oidExtensionExtendedKeyUsage</span><span class="op" id="4009119">,</span>&nbsp;<span class="ident" id="4009121">template</span><span class="op" id="4009129">.</span><span class="ident" id="4009130">ExtraExtensions</span><span class="op" id="4009145">)</span>&nbsp;<span class="op" id="4009147">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009151">ret</span><span class="op" id="4009154">[</span><span class="ident" id="4009155">n</span><span class="op" id="4009156">]</span><span class="op" id="4009157">.</span><span class="ident" id="4009158">Id</span>&nbsp;<span class="op" id="4009161">=</span>&nbsp;<span class="ident" id="4009163">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009195">var</span>&nbsp;<span class="ident" id="4009199">oids</span>&nbsp;<span class="op" id="4009204">[</span><span class="op" id="4009205">]</span><span class="ident" id="4009206">asn1</span><span class="op" id="4009210">.</span><span class="ident" id="4009211">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009230">for</span>&nbsp;<span class="ident" id="4009234">_</span><span class="op" id="4009235">,</span>&nbsp;<span class="ident" id="4009237">u</span>&nbsp;<span class="op" id="4009239">:=</span>&nbsp;<span class="keyword" id="4009242">range</span>&nbsp;<span class="ident" id="4009248">template</span><span class="op" id="4009256">.</span><span class="ident" id="4009257">ExtKeyUsage</span>&nbsp;<span class="op" id="4009269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009274">if</span>&nbsp;<span class="ident" id="4009277">oid</span><span class="op" id="4009280">,</span>&nbsp;<span class="ident" id="4009282">ok</span>&nbsp;<span class="op" id="4009285">:=</span>&nbsp;<span class="ident" id="4009288">oidFromExtKeyUsage</span><span class="op" id="4009306">(</span><span class="ident" id="4009307">u</span><span class="op" id="4009308">)</span><span class="op" id="4009309">;</span>&nbsp;<span class="ident" id="4009311">ok</span>&nbsp;<span class="op" id="4009314">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009320">oids</span>&nbsp;<span class="op" id="4009325">=</span>&nbsp;<span class="builtinfunc" id="4009327">append</span><span class="op" id="4009333">(</span><span class="ident" id="4009334">oids</span><span class="op" id="4009338">,</span>&nbsp;<span class="ident" id="4009340">oid</span><span class="op" id="4009343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009348">}</span>&nbsp;<span class="keyword" id="4009350">else</span>&nbsp;<span class="op" id="4009355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4009361">panic</span><span class="op" id="4009366">(</span><span class="string" id="4009367">&#34;internal&nbsp;error&#34;</span><span class="op" id="4009383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009392">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009397">oids</span>&nbsp;<span class="op" id="4009402">=</span>&nbsp;<span class="builtinfunc" id="4009404">append</span><span class="op" id="4009410">(</span><span class="ident" id="4009411">oids</span><span class="op" id="4009415">,</span>&nbsp;<span class="ident" id="4009417">template</span><span class="op" id="4009425">.</span><span class="ident" id="4009426">UnknownExtKeyUsage</span><span class="op" id="4009444">...</span><span class="op" id="4009447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009452">ret</span><span class="op" id="4009455">[</span><span class="ident" id="4009456">n</span><span class="op" id="4009457">]</span><span class="op" id="4009458">.</span><span class="ident" id="4009459">Value</span><span class="op" id="4009464">,</span>&nbsp;<span class="ident" id="4009466">err</span>&nbsp;<span class="op" id="4009470">=</span>&nbsp;<span class="ident" id="4009472">asn1</span><span class="op" id="4009476">.</span><span class="ident" id="4009477">Marshal</span><span class="op" id="4009484">(</span><span class="ident" id="4009485">oids</span><span class="op" id="4009489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009493">if</span>&nbsp;<span class="ident" id="4009496">err</span>&nbsp;<span class="op" id="4009500">!=</span>&nbsp;<span class="ident" id="4009503">nil</span>&nbsp;<span class="op" id="4009507">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009512">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009525">n</span><span class="op" id="4009526">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009534">if</span>&nbsp;<span class="ident" id="4009537">template</span><span class="op" id="4009545">.</span><span class="ident" id="4009546">BasicConstraintsValid</span>&nbsp;<span class="op" id="4009568">&amp;&amp;</span>&nbsp;<span class="op" id="4009571">!</span><span class="ident" id="4009572">oidInExtensions</span><span class="op" id="4009587">(</span><span class="ident" id="4009588">oidExtensionBasicConstraints</span><span class="op" id="4009616">,</span>&nbsp;<span class="ident" id="4009618">template</span><span class="op" id="4009626">.</span><span class="ident" id="4009627">ExtraExtensions</span><span class="op" id="4009642">)</span>&nbsp;<span class="op" id="4009644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4009648">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4009711">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4009776">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009835">maxPathLen</span>&nbsp;<span class="op" id="4009846">:=</span>&nbsp;<span class="ident" id="4009849">template</span><span class="op" id="4009857">.</span><span class="ident" id="4009858">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009871">if</span>&nbsp;<span class="ident" id="4009874">maxPathLen</span>&nbsp;<span class="op" id="4009885">==</span>&nbsp;<span class="num" id="4009888">0</span>&nbsp;<span class="op" id="4009890">&amp;&amp;</span>&nbsp;<span class="op" id="4009893">!</span><span class="ident" id="4009894">template</span><span class="op" id="4009902">.</span><span class="ident" id="4009903">MaxPathLenZero</span>&nbsp;<span class="op" id="4009918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009923">maxPathLen</span>&nbsp;<span class="op" id="4009934">=</span>&nbsp;<span class="op" id="4009936">-</span><span class="num" id="4009937">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009945">ret</span><span class="op" id="4009948">[</span><span class="ident" id="4009949">n</span><span class="op" id="4009950">]</span><span class="op" id="4009951">.</span><span class="ident" id="4009952">Id</span>&nbsp;<span class="op" id="4009955">=</span>&nbsp;<span class="ident" id="4009957">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009988">ret</span><span class="op" id="4009991">[</span><span class="ident" id="4009992">n</span><span class="op" id="4009993">]</span><span class="op" id="4009994">.</span><span class="ident" id="4009995">Value</span><span class="op" id="4010000">,</span>&nbsp;<span class="ident" id="4010002">err</span>&nbsp;<span class="op" id="4010006">=</span>&nbsp;<span class="ident" id="4010008">asn1</span><span class="op" id="4010012">.</span><span class="ident" id="4010013">Marshal</span><span class="op" id="4010020">(</span><span class="ident" id="4010021">basicConstraints</span><span class="op" id="4010037">{</span><span class="ident" id="4010038">template</span><span class="op" id="4010046">.</span><span class="ident" id="4010047">IsCA</span><span class="op" id="4010051">,</span>&nbsp;<span class="ident" id="4010053">maxPathLen</span><span class="op" id="4010063">}</span><span class="op" id="4010064">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010068">ret</span><span class="op" id="4010071">[</span><span class="ident" id="4010072">n</span><span class="op" id="4010073">]</span><span class="op" id="4010074">.</span><span class="ident" id="4010075">Critical</span>&nbsp;<span class="op" id="4010084">=</span>&nbsp;<span class="builtintype" id="4010086">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010093">if</span>&nbsp;<span class="ident" id="4010096">err</span>&nbsp;<span class="op" id="4010100">!=</span>&nbsp;<span class="ident" id="4010103">nil</span>&nbsp;<span class="op" id="4010107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010112">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010125">n</span><span class="op" id="4010126">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010134">if</span>&nbsp;<span class="builtinfunc" id="4010137">len</span><span class="op" id="4010140">(</span><span class="ident" id="4010141">template</span><span class="op" id="4010149">.</span><span class="ident" id="4010150">SubjectKeyId</span><span class="op" id="4010162">)</span>&nbsp;<span class="op" id="4010164">&gt;</span>&nbsp;<span class="num" id="4010166">0</span>&nbsp;<span class="op" id="4010168">&amp;&amp;</span>&nbsp;<span class="op" id="4010171">!</span><span class="ident" id="4010172">oidInExtensions</span><span class="op" id="4010187">(</span><span class="ident" id="4010188">oidExtensionSubjectKeyId</span><span class="op" id="4010212">,</span>&nbsp;<span class="ident" id="4010214">template</span><span class="op" id="4010222">.</span><span class="ident" id="4010223">ExtraExtensions</span><span class="op" id="4010238">)</span>&nbsp;<span class="op" id="4010240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010244">ret</span><span class="op" id="4010247">[</span><span class="ident" id="4010248">n</span><span class="op" id="4010249">]</span><span class="op" id="4010250">.</span><span class="ident" id="4010251">Id</span>&nbsp;<span class="op" id="4010254">=</span>&nbsp;<span class="ident" id="4010256">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010283">ret</span><span class="op" id="4010286">[</span><span class="ident" id="4010287">n</span><span class="op" id="4010288">]</span><span class="op" id="4010289">.</span><span class="ident" id="4010290">Value</span><span class="op" id="4010295">,</span>&nbsp;<span class="ident" id="4010297">err</span>&nbsp;<span class="op" id="4010301">=</span>&nbsp;<span class="ident" id="4010303">asn1</span><span class="op" id="4010307">.</span><span class="ident" id="4010308">Marshal</span><span class="op" id="4010315">(</span><span class="ident" id="4010316">template</span><span class="op" id="4010324">.</span><span class="ident" id="4010325">SubjectKeyId</span><span class="op" id="4010337">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010341">if</span>&nbsp;<span class="ident" id="4010344">err</span>&nbsp;<span class="op" id="4010348">!=</span>&nbsp;<span class="ident" id="4010351">nil</span>&nbsp;<span class="op" id="4010355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010373">n</span><span class="op" id="4010374">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010378">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010382">if</span>&nbsp;<span class="builtinfunc" id="4010385">len</span><span class="op" id="4010388">(</span><span class="ident" id="4010389">template</span><span class="op" id="4010397">.</span><span class="ident" id="4010398">AuthorityKeyId</span><span class="op" id="4010412">)</span>&nbsp;<span class="op" id="4010414">&gt;</span>&nbsp;<span class="num" id="4010416">0</span>&nbsp;<span class="op" id="4010418">&amp;&amp;</span>&nbsp;<span class="op" id="4010421">!</span><span class="ident" id="4010422">oidInExtensions</span><span class="op" id="4010437">(</span><span class="ident" id="4010438">oidExtensionAuthorityKeyId</span><span class="op" id="4010464">,</span>&nbsp;<span class="ident" id="4010466">template</span><span class="op" id="4010474">.</span><span class="ident" id="4010475">ExtraExtensions</span><span class="op" id="4010490">)</span>&nbsp;<span class="op" id="4010492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010496">ret</span><span class="op" id="4010499">[</span><span class="ident" id="4010500">n</span><span class="op" id="4010501">]</span><span class="op" id="4010502">.</span><span class="ident" id="4010503">Id</span>&nbsp;<span class="op" id="4010506">=</span>&nbsp;<span class="ident" id="4010508">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010537">ret</span><span class="op" id="4010540">[</span><span class="ident" id="4010541">n</span><span class="op" id="4010542">]</span><span class="op" id="4010543">.</span><span class="ident" id="4010544">Value</span><span class="op" id="4010549">,</span>&nbsp;<span class="ident" id="4010551">err</span>&nbsp;<span class="op" id="4010555">=</span>&nbsp;<span class="ident" id="4010557">asn1</span><span class="op" id="4010561">.</span><span class="ident" id="4010562">Marshal</span><span class="op" id="4010569">(</span><span class="ident" id="4010570">authKeyId</span><span class="op" id="4010579">{</span><span class="ident" id="4010580">template</span><span class="op" id="4010588">.</span><span class="ident" id="4010589">AuthorityKeyId</span><span class="op" id="4010603">}</span><span class="op" id="4010604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010608">if</span>&nbsp;<span class="ident" id="4010611">err</span>&nbsp;<span class="op" id="4010615">!=</span>&nbsp;<span class="ident" id="4010618">nil</span>&nbsp;<span class="op" id="4010622">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010640">n</span><span class="op" id="4010641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010649">if</span>&nbsp;<span class="op" id="4010652">(</span><span class="builtinfunc" id="4010653">len</span><span class="op" id="4010656">(</span><span class="ident" id="4010657">template</span><span class="op" id="4010665">.</span><span class="ident" id="4010666">OCSPServer</span><span class="op" id="4010676">)</span>&nbsp;<span class="op" id="4010678">&gt;</span>&nbsp;<span class="num" id="4010680">0</span>&nbsp;<span class="op" id="4010682">||</span>&nbsp;<span class="builtinfunc" id="4010685">len</span><span class="op" id="4010688">(</span><span class="ident" id="4010689">template</span><span class="op" id="4010697">.</span><span class="ident" id="4010698">IssuingCertificateURL</span><span class="op" id="4010719">)</span>&nbsp;<span class="op" id="4010721">&gt;</span>&nbsp;<span class="num" id="4010723">0</span><span class="op" id="4010724">)</span>&nbsp;<span class="op" id="4010726">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010731">!</span><span class="ident" id="4010732">oidInExtensions</span><span class="op" id="4010747">(</span><span class="ident" id="4010748">oidExtensionAuthorityInfoAccess</span><span class="op" id="4010779">,</span>&nbsp;<span class="ident" id="4010781">template</span><span class="op" id="4010789">.</span><span class="ident" id="4010790">ExtraExtensions</span><span class="op" id="4010805">)</span>&nbsp;<span class="op" id="4010807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010811">ret</span><span class="op" id="4010814">[</span><span class="ident" id="4010815">n</span><span class="op" id="4010816">]</span><span class="op" id="4010817">.</span><span class="ident" id="4010818">Id</span>&nbsp;<span class="op" id="4010821">=</span>&nbsp;<span class="ident" id="4010823">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010857">var</span>&nbsp;<span class="ident" id="4010861">aiaValues</span>&nbsp;<span class="op" id="4010871">[</span><span class="op" id="4010872">]</span><span class="ident" id="4010873">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010895">for</span>&nbsp;<span class="ident" id="4010899">_</span><span class="op" id="4010900">,</span>&nbsp;<span class="ident" id="4010902">name</span>&nbsp;<span class="op" id="4010907">:=</span>&nbsp;<span class="keyword" id="4010910">range</span>&nbsp;<span class="ident" id="4010916">template</span><span class="op" id="4010924">.</span><span class="ident" id="4010925">OCSPServer</span>&nbsp;<span class="op" id="4010936">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010941">aiaValues</span>&nbsp;<span class="op" id="4010951">=</span>&nbsp;<span class="builtinfunc" id="4010953">append</span><span class="op" id="4010959">(</span><span class="ident" id="4010960">aiaValues</span><span class="op" id="4010969">,</span>&nbsp;<span class="ident" id="4010971">authorityInfoAccess</span><span class="op" id="4010990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010996">Method</span><span class="op" id="4011002">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4011006">oidAuthorityInfoAccessOcsp</span><span class="op" id="4011032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011038">Location</span><span class="op" id="4011046">:</span>&nbsp;<span class="ident" id="4011048">asn1</span><span class="op" id="4011052">.</span><span class="ident" id="4011053">RawValue</span><span class="op" id="4011061">{</span><span class="ident" id="4011062">Tag</span><span class="op" id="4011065">:</span>&nbsp;<span class="num" id="4011067">6</span><span class="op" id="4011068">,</span>&nbsp;<span class="ident" id="4011070">Class</span><span class="op" id="4011075">:</span>&nbsp;<span class="num" id="4011077">2</span><span class="op" id="4011078">,</span>&nbsp;<span class="ident" id="4011080">Bytes</span><span class="op" id="4011085">:</span>&nbsp;<span class="op" id="4011087">[</span><span class="op" id="4011088">]</span><span class="builtintype" id="4011089">byte</span><span class="op" id="4011093">(</span><span class="ident" id="4011094">name</span><span class="op" id="4011098">)</span><span class="op" id="4011099">}</span><span class="op" id="4011100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011105">}</span><span class="op" id="4011106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011110">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011114">for</span>&nbsp;<span class="ident" id="4011118">_</span><span class="op" id="4011119">,</span>&nbsp;<span class="ident" id="4011121">name</span>&nbsp;<span class="op" id="4011126">:=</span>&nbsp;<span class="keyword" id="4011129">range</span>&nbsp;<span class="ident" id="4011135">template</span><span class="op" id="4011143">.</span><span class="ident" id="4011144">IssuingCertificateURL</span>&nbsp;<span class="op" id="4011166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011171">aiaValues</span>&nbsp;<span class="op" id="4011181">=</span>&nbsp;<span class="builtinfunc" id="4011183">append</span><span class="op" id="4011189">(</span><span class="ident" id="4011190">aiaValues</span><span class="op" id="4011199">,</span>&nbsp;<span class="ident" id="4011201">authorityInfoAccess</span><span class="op" id="4011220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011226">Method</span><span class="op" id="4011232">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4011236">oidAuthorityInfoAccessIssuers</span><span class="op" id="4011265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011271">Location</span><span class="op" id="4011279">:</span>&nbsp;<span class="ident" id="4011281">asn1</span><span class="op" id="4011285">.</span><span class="ident" id="4011286">RawValue</span><span class="op" id="4011294">{</span><span class="ident" id="4011295">Tag</span><span class="op" id="4011298">:</span>&nbsp;<span class="num" id="4011300">6</span><span class="op" id="4011301">,</span>&nbsp;<span class="ident" id="4011303">Class</span><span class="op" id="4011308">:</span>&nbsp;<span class="num" id="4011310">2</span><span class="op" id="4011311">,</span>&nbsp;<span class="ident" id="4011313">Bytes</span><span class="op" id="4011318">:</span>&nbsp;<span class="op" id="4011320">[</span><span class="op" id="4011321">]</span><span class="builtintype" id="4011322">byte</span><span class="op" id="4011326">(</span><span class="ident" id="4011327">name</span><span class="op" id="4011331">)</span><span class="op" id="4011332">}</span><span class="op" id="4011333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011338">}</span><span class="op" id="4011339">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011347">ret</span><span class="op" id="4011350">[</span><span class="ident" id="4011351">n</span><span class="op" id="4011352">]</span><span class="op" id="4011353">.</span><span class="ident" id="4011354">Value</span><span class="op" id="4011359">,</span>&nbsp;<span class="ident" id="4011361">err</span>&nbsp;<span class="op" id="4011365">=</span>&nbsp;<span class="ident" id="4011367">asn1</span><span class="op" id="4011371">.</span><span class="ident" id="4011372">Marshal</span><span class="op" id="4011379">(</span><span class="ident" id="4011380">aiaValues</span><span class="op" id="4011389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011393">if</span>&nbsp;<span class="ident" id="4011396">err</span>&nbsp;<span class="op" id="4011400">!=</span>&nbsp;<span class="ident" id="4011403">nil</span>&nbsp;<span class="op" id="4011407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011412">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011421">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011425">n</span><span class="op" id="4011426">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011434">if</span>&nbsp;<span class="op" id="4011437">(</span><span class="builtinfunc" id="4011438">len</span><span class="op" id="4011441">(</span><span class="ident" id="4011442">template</span><span class="op" id="4011450">.</span><span class="ident" id="4011451">DNSNames</span><span class="op" id="4011459">)</span>&nbsp;<span class="op" id="4011461">&gt;</span>&nbsp;<span class="num" id="4011463">0</span>&nbsp;<span class="op" id="4011465">||</span>&nbsp;<span class="builtinfunc" id="4011468">len</span><span class="op" id="4011471">(</span><span class="ident" id="4011472">template</span><span class="op" id="4011480">.</span><span class="ident" id="4011481">EmailAddresses</span><span class="op" id="4011495">)</span>&nbsp;<span class="op" id="4011497">&gt;</span>&nbsp;<span class="num" id="4011499">0</span>&nbsp;<span class="op" id="4011501">||</span>&nbsp;<span class="builtinfunc" id="4011504">len</span><span class="op" id="4011507">(</span><span class="ident" id="4011508">template</span><span class="op" id="4011516">.</span><span class="ident" id="4011517">IPAddresses</span><span class="op" id="4011528">)</span>&nbsp;<span class="op" id="4011530">&gt;</span>&nbsp;<span class="num" id="4011532">0</span><span class="op" id="4011533">)</span>&nbsp;<span class="op" id="4011535">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011540">!</span><span class="ident" id="4011541">oidInExtensions</span><span class="op" id="4011556">(</span><span class="ident" id="4011557">oidExtensionSubjectAltName</span><span class="op" id="4011583">,</span>&nbsp;<span class="ident" id="4011585">template</span><span class="op" id="4011593">.</span><span class="ident" id="4011594">ExtraExtensions</span><span class="op" id="4011609">)</span>&nbsp;<span class="op" id="4011611">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011615">ret</span><span class="op" id="4011618">[</span><span class="ident" id="4011619">n</span><span class="op" id="4011620">]</span><span class="op" id="4011621">.</span><span class="ident" id="4011622">Id</span>&nbsp;<span class="op" id="4011625">=</span>&nbsp;<span class="ident" id="4011627">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011656">ret</span><span class="op" id="4011659">[</span><span class="ident" id="4011660">n</span><span class="op" id="4011661">]</span><span class="op" id="4011662">.</span><span class="ident" id="4011663">Value</span><span class="op" id="4011668">,</span>&nbsp;<span class="ident" id="4011670">err</span>&nbsp;<span class="op" id="4011674">=</span>&nbsp;<span class="ident" id="4011676">marshalSANs</span><span class="op" id="4011687">(</span><span class="ident" id="4011688">template</span><span class="op" id="4011696">.</span><span class="ident" id="4011697">DNSNames</span><span class="op" id="4011705">,</span>&nbsp;<span class="ident" id="4011707">template</span><span class="op" id="4011715">.</span><span class="ident" id="4011716">EmailAddresses</span><span class="op" id="4011730">,</span>&nbsp;<span class="ident" id="4011732">template</span><span class="op" id="4011740">.</span><span class="ident" id="4011741">IPAddresses</span><span class="op" id="4011752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011756">if</span>&nbsp;<span class="ident" id="4011759">err</span>&nbsp;<span class="op" id="4011763">!=</span>&nbsp;<span class="ident" id="4011766">nil</span>&nbsp;<span class="op" id="4011770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011775">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011784">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011788">n</span><span class="op" id="4011789">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011797">if</span>&nbsp;<span class="builtinfunc" id="4011800">len</span><span class="op" id="4011803">(</span><span class="ident" id="4011804">template</span><span class="op" id="4011812">.</span><span class="ident" id="4011813">PolicyIdentifiers</span><span class="op" id="4011830">)</span>&nbsp;<span class="op" id="4011832">&gt;</span>&nbsp;<span class="num" id="4011834">0</span>&nbsp;<span class="op" id="4011836">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011841">!</span><span class="ident" id="4011842">oidInExtensions</span><span class="op" id="4011857">(</span><span class="ident" id="4011858">oidExtensionCertificatePolicies</span><span class="op" id="4011889">,</span>&nbsp;<span class="ident" id="4011891">template</span><span class="op" id="4011899">.</span><span class="ident" id="4011900">ExtraExtensions</span><span class="op" id="4011915">)</span>&nbsp;<span class="op" id="4011917">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011921">ret</span><span class="op" id="4011924">[</span><span class="ident" id="4011925">n</span><span class="op" id="4011926">]</span><span class="op" id="4011927">.</span><span class="ident" id="4011928">Id</span>&nbsp;<span class="op" id="4011931">=</span>&nbsp;<span class="ident" id="4011933">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011967">policies</span>&nbsp;<span class="op" id="4011976">:=</span>&nbsp;<span class="builtinfunc" id="4011979">make</span><span class="op" id="4011983">(</span><span class="op" id="4011984">[</span><span class="op" id="4011985">]</span><span class="ident" id="4011986">policyInformation</span><span class="op" id="4012003">,</span>&nbsp;<span class="builtinfunc" id="4012005">len</span><span class="op" id="4012008">(</span><span class="ident" id="4012009">template</span><span class="op" id="4012017">.</span><span class="ident" id="4012018">PolicyIdentifiers</span><span class="op" id="4012035">)</span><span class="op" id="4012036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012040">for</span>&nbsp;<span class="ident" id="4012044">i</span><span class="op" id="4012045">,</span>&nbsp;<span class="ident" id="4012047">policy</span>&nbsp;<span class="op" id="4012054">:=</span>&nbsp;<span class="keyword" id="4012057">range</span>&nbsp;<span class="ident" id="4012063">template</span><span class="op" id="4012071">.</span><span class="ident" id="4012072">PolicyIdentifiers</span>&nbsp;<span class="op" id="4012090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012095">policies</span><span class="op" id="4012103">[</span><span class="ident" id="4012104">i</span><span class="op" id="4012105">]</span><span class="op" id="4012106">.</span><span class="ident" id="4012107">Policy</span>&nbsp;<span class="op" id="4012114">=</span>&nbsp;<span class="ident" id="4012116">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012125">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012129">ret</span><span class="op" id="4012132">[</span><span class="ident" id="4012133">n</span><span class="op" id="4012134">]</span><span class="op" id="4012135">.</span><span class="ident" id="4012136">Value</span><span class="op" id="4012141">,</span>&nbsp;<span class="ident" id="4012143">err</span>&nbsp;<span class="op" id="4012147">=</span>&nbsp;<span class="ident" id="4012149">asn1</span><span class="op" id="4012153">.</span><span class="ident" id="4012154">Marshal</span><span class="op" id="4012161">(</span><span class="ident" id="4012162">policies</span><span class="op" id="4012170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012174">if</span>&nbsp;<span class="ident" id="4012177">err</span>&nbsp;<span class="op" id="4012181">!=</span>&nbsp;<span class="ident" id="4012184">nil</span>&nbsp;<span class="op" id="4012188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012193">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012206">n</span><span class="op" id="4012207">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012215">if</span>&nbsp;<span class="builtinfunc" id="4012218">len</span><span class="op" id="4012221">(</span><span class="ident" id="4012222">template</span><span class="op" id="4012230">.</span><span class="ident" id="4012231">PermittedDNSDomains</span><span class="op" id="4012250">)</span>&nbsp;<span class="op" id="4012252">&gt;</span>&nbsp;<span class="num" id="4012254">0</span>&nbsp;<span class="op" id="4012256">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012261">!</span><span class="ident" id="4012262">oidInExtensions</span><span class="op" id="4012277">(</span><span class="ident" id="4012278">oidExtensionNameConstraints</span><span class="op" id="4012305">,</span>&nbsp;<span class="ident" id="4012307">template</span><span class="op" id="4012315">.</span><span class="ident" id="4012316">ExtraExtensions</span><span class="op" id="4012331">)</span>&nbsp;<span class="op" id="4012333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012337">ret</span><span class="op" id="4012340">[</span><span class="ident" id="4012341">n</span><span class="op" id="4012342">]</span><span class="op" id="4012343">.</span><span class="ident" id="4012344">Id</span>&nbsp;<span class="op" id="4012347">=</span>&nbsp;<span class="ident" id="4012349">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012379">ret</span><span class="op" id="4012382">[</span><span class="ident" id="4012383">n</span><span class="op" id="4012384">]</span><span class="op" id="4012385">.</span><span class="ident" id="4012386">Critical</span>&nbsp;<span class="op" id="4012395">=</span>&nbsp;<span class="ident" id="4012397">template</span><span class="op" id="4012405">.</span><span class="ident" id="4012406">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012437">var</span>&nbsp;<span class="ident" id="4012441">out</span>&nbsp;<span class="ident" id="4012445">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012463">out</span><span class="op" id="4012466">.</span><span class="ident" id="4012467">Permitted</span>&nbsp;<span class="op" id="4012477">=</span>&nbsp;<span class="builtinfunc" id="4012479">make</span><span class="op" id="4012483">(</span><span class="op" id="4012484">[</span><span class="op" id="4012485">]</span><span class="ident" id="4012486">generalSubtree</span><span class="op" id="4012500">,</span>&nbsp;<span class="builtinfunc" id="4012502">len</span><span class="op" id="4012505">(</span><span class="ident" id="4012506">template</span><span class="op" id="4012514">.</span><span class="ident" id="4012515">PermittedDNSDomains</span><span class="op" id="4012534">)</span><span class="op" id="4012535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012539">for</span>&nbsp;<span class="ident" id="4012543">i</span><span class="op" id="4012544">,</span>&nbsp;<span class="ident" id="4012546">permitted</span>&nbsp;<span class="op" id="4012556">:=</span>&nbsp;<span class="keyword" id="4012559">range</span>&nbsp;<span class="ident" id="4012565">template</span><span class="op" id="4012573">.</span><span class="ident" id="4012574">PermittedDNSDomains</span>&nbsp;<span class="op" id="4012594">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012599">out</span><span class="op" id="4012602">.</span><span class="ident" id="4012603">Permitted</span><span class="op" id="4012612">[</span><span class="ident" id="4012613">i</span><span class="op" id="4012614">]</span>&nbsp;<span class="op" id="4012616">=</span>&nbsp;<span class="ident" id="4012618">generalSubtree</span><span class="op" id="4012632">{</span><span class="ident" id="4012633">Name</span><span class="op" id="4012637">:</span>&nbsp;<span class="ident" id="4012639">permitted</span><span class="op" id="4012648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012656">ret</span><span class="op" id="4012659">[</span><span class="ident" id="4012660">n</span><span class="op" id="4012661">]</span><span class="op" id="4012662">.</span><span class="ident" id="4012663">Value</span><span class="op" id="4012668">,</span>&nbsp;<span class="ident" id="4012670">err</span>&nbsp;<span class="op" id="4012674">=</span>&nbsp;<span class="ident" id="4012676">asn1</span><span class="op" id="4012680">.</span><span class="ident" id="4012681">Marshal</span><span class="op" id="4012688">(</span><span class="ident" id="4012689">out</span><span class="op" id="4012692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012696">if</span>&nbsp;<span class="ident" id="4012699">err</span>&nbsp;<span class="op" id="4012703">!=</span>&nbsp;<span class="ident" id="4012706">nil</span>&nbsp;<span class="op" id="4012710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012715">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012728">n</span><span class="op" id="4012729">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012737">if</span>&nbsp;<span class="builtinfunc" id="4012740">len</span><span class="op" id="4012743">(</span><span class="ident" id="4012744">template</span><span class="op" id="4012752">.</span><span class="ident" id="4012753">CRLDistributionPoints</span><span class="op" id="4012774">)</span>&nbsp;<span class="op" id="4012776">&gt;</span>&nbsp;<span class="num" id="4012778">0</span>&nbsp;<span class="op" id="4012780">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012785">!</span><span class="ident" id="4012786">oidInExtensions</span><span class="op" id="4012801">(</span><span class="ident" id="4012802">oidExtensionCRLDistributionPoints</span><span class="op" id="4012835">,</span>&nbsp;<span class="ident" id="4012837">template</span><span class="op" id="4012845">.</span><span class="ident" id="4012846">ExtraExtensions</span><span class="op" id="4012861">)</span>&nbsp;<span class="op" id="4012863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012867">ret</span><span class="op" id="4012870">[</span><span class="ident" id="4012871">n</span><span class="op" id="4012872">]</span><span class="op" id="4012873">.</span><span class="ident" id="4012874">Id</span>&nbsp;<span class="op" id="4012877">=</span>&nbsp;<span class="ident" id="4012879">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012916">var</span>&nbsp;<span class="ident" id="4012920">crlDp</span>&nbsp;<span class="op" id="4012926">[</span><span class="op" id="4012927">]</span><span class="ident" id="4012928">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012948">for</span>&nbsp;<span class="ident" id="4012952">_</span><span class="op" id="4012953">,</span>&nbsp;<span class="ident" id="4012955">name</span>&nbsp;<span class="op" id="4012960">:=</span>&nbsp;<span class="keyword" id="4012963">range</span>&nbsp;<span class="ident" id="4012969">template</span><span class="op" id="4012977">.</span><span class="ident" id="4012978">CRLDistributionPoints</span>&nbsp;<span class="op" id="4013000">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013005">rawFullName</span><span class="op" id="4013016">,</span>&nbsp;<span class="ident" id="4013018">_</span>&nbsp;<span class="op" id="4013020">:=</span>&nbsp;<span class="ident" id="4013023">asn1</span><span class="op" id="4013027">.</span><span class="ident" id="4013028">Marshal</span><span class="op" id="4013035">(</span><span class="ident" id="4013036">asn1</span><span class="op" id="4013040">.</span><span class="ident" id="4013041">RawValue</span><span class="op" id="4013049">{</span><span class="ident" id="4013050">Tag</span><span class="op" id="4013053">:</span>&nbsp;<span class="num" id="4013055">6</span><span class="op" id="4013056">,</span>&nbsp;<span class="ident" id="4013058">Class</span><span class="op" id="4013063">:</span>&nbsp;<span class="num" id="4013065">2</span><span class="op" id="4013066">,</span>&nbsp;<span class="ident" id="4013068">Bytes</span><span class="op" id="4013073">:</span>&nbsp;<span class="op" id="4013075">[</span><span class="op" id="4013076">]</span><span class="builtintype" id="4013077">byte</span><span class="op" id="4013081">(</span><span class="ident" id="4013082">name</span><span class="op" id="4013086">)</span><span class="op" id="4013087">}</span><span class="op" id="4013088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013094">dp</span>&nbsp;<span class="op" id="4013097">:=</span>&nbsp;<span class="ident" id="4013100">distributionPoint</span><span class="op" id="4013117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013123">DistributionPoint</span><span class="op" id="4013140">:</span>&nbsp;<span class="ident" id="4013142">distributionPointName</span><span class="op" id="4013163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013170">FullName</span><span class="op" id="4013178">:</span>&nbsp;<span class="ident" id="4013180">asn1</span><span class="op" id="4013184">.</span><span class="ident" id="4013185">RawValue</span><span class="op" id="4013193">{</span><span class="ident" id="4013194">Tag</span><span class="op" id="4013197">:</span>&nbsp;<span class="num" id="4013199">0</span><span class="op" id="4013200">,</span>&nbsp;<span class="ident" id="4013202">Class</span><span class="op" id="4013207">:</span>&nbsp;<span class="num" id="4013209">2</span><span class="op" id="4013210">,</span>&nbsp;<span class="ident" id="4013212">IsCompound</span><span class="op" id="4013222">:</span>&nbsp;<span class="builtintype" id="4013224">true</span><span class="op" id="4013228">,</span>&nbsp;<span class="ident" id="4013230">Bytes</span><span class="op" id="4013235">:</span>&nbsp;<span class="ident" id="4013237">rawFullName</span><span class="op" id="4013248">}</span><span class="op" id="4013249">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013255">}</span><span class="op" id="4013256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013266">crlDp</span>&nbsp;<span class="op" id="4013272">=</span>&nbsp;<span class="builtinfunc" id="4013274">append</span><span class="op" id="4013280">(</span><span class="ident" id="4013281">crlDp</span><span class="op" id="4013286">,</span>&nbsp;<span class="ident" id="4013288">dp</span><span class="op" id="4013290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013299">ret</span><span class="op" id="4013302">[</span><span class="ident" id="4013303">n</span><span class="op" id="4013304">]</span><span class="op" id="4013305">.</span><span class="ident" id="4013306">Value</span><span class="op" id="4013311">,</span>&nbsp;<span class="ident" id="4013313">err</span>&nbsp;<span class="op" id="4013317">=</span>&nbsp;<span class="ident" id="4013319">asn1</span><span class="op" id="4013323">.</span><span class="ident" id="4013324">Marshal</span><span class="op" id="4013331">(</span><span class="ident" id="4013332">crlDp</span><span class="op" id="4013337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013341">if</span>&nbsp;<span class="ident" id="4013344">err</span>&nbsp;<span class="op" id="4013348">!=</span>&nbsp;<span class="ident" id="4013351">nil</span>&nbsp;<span class="op" id="4013355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013373">n</span><span class="op" id="4013374">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4013382">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4013455">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013514">return</span>&nbsp;<span class="builtinfunc" id="4013521">append</span><span class="op" id="4013527">(</span><span class="ident" id="4013528">ret</span><span class="op" id="4013531">[</span><span class="op" id="4013532">:</span><span class="ident" id="4013533">n</span><span class="op" id="4013534">]</span><span class="op" id="4013535">,</span>&nbsp;<span class="ident" id="4013537">template</span><span class="op" id="4013545">.</span><span class="ident" id="4013546">ExtraExtensions</span><span class="op" id="4013561">...</span><span class="op" id="4013564">)</span><span class="op" id="4013565">,</span>&nbsp;<span class="ident" id="4013567">nil</span><br>
<span class="lineno"></span><span class="op" id="4013571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4013574">func</span>&nbsp;<span class="ident" id="4013579">subjectBytes</span><span class="op" id="4013591">(</span><span class="ident" id="4013592">cert</span>&nbsp;<span class="op" id="4013597">*</span><span class="ident" id="4013598">Certificate</span><span class="op" id="4013609">)</span>&nbsp;<span class="op" id="4013611">(</span><span class="op" id="4013612">[</span><span class="op" id="4013613">]</span><span class="builtintype" id="4013614">byte</span><span class="op" id="4013618">,</span>&nbsp;<span class="builtintype" id="4013620">error</span><span class="op" id="4013625">)</span>&nbsp;<span class="op" id="4013627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013630">if</span>&nbsp;<span class="builtinfunc" id="4013633">len</span><span class="op" id="4013636">(</span><span class="ident" id="4013637">cert</span><span class="op" id="4013641">.</span><span class="ident" id="4013642">RawSubject</span><span class="op" id="4013652">)</span>&nbsp;<span class="op" id="4013654">&gt;</span>&nbsp;<span class="num" id="4013656">0</span>&nbsp;<span class="op" id="4013658">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013662">return</span>&nbsp;<span class="ident" id="4013669">cert</span><span class="op" id="4013673">.</span><span class="ident" id="4013674">RawSubject</span><span class="op" id="4013684">,</span>&nbsp;<span class="ident" id="4013686">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013695">return</span>&nbsp;<span class="ident" id="4013702">asn1</span><span class="op" id="4013706">.</span><span class="ident" id="4013707">Marshal</span><span class="op" id="4013714">(</span><span class="ident" id="4013715">cert</span><span class="op" id="4013719">.</span><span class="ident" id="4013720">Subject</span><span class="op" id="4013727">.</span><span class="ident" id="4013728">ToRDNSequence</span><span class="op" id="4013741">(</span><span class="op" id="4013742">)</span><span class="op" id="4013743">)</span><br>
<span class="lineno"></span><span class="op" id="4013745">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4013748">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4013825">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4013896">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4013920">func</span>&nbsp;<span class="ident" id="4013925">signingParamsForPrivateKey</span><span class="op" id="4013951">(</span><span class="ident" id="4013952">priv</span>&nbsp;<span class="keyword" id="4013957">interface</span><span class="op" id="4013966">{</span><span class="op" id="4013967">}</span><span class="op" id="4013968">,</span>&nbsp;<span class="ident" id="4013970">requestedSigAlgo</span>&nbsp;<span class="ident" id="4013987">SignatureAlgorithm</span><span class="op" id="4014005">)</span>&nbsp;<span class="op" id="4014007">(</span><span class="ident" id="4014008">hashFunc</span>&nbsp;<span class="ident" id="4014017">crypto</span><span class="op" id="4014023">.</span><span class="ident" id="4014024">Hash</span><span class="op" id="4014028">,</span>&nbsp;<span class="ident" id="4014030">sigAlgo</span>&nbsp;<span class="ident" id="4014038">pkix</span><span class="op" id="4014042">.</span><span class="ident" id="4014043">AlgorithmIdentifier</span><span class="op" id="4014062">,</span>&nbsp;<span class="ident" id="4014064">err</span>&nbsp;<span class="builtintype" id="4014068">error</span><span class="op" id="4014073">)</span>&nbsp;<span class="op" id="4014075">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014078">var</span>&nbsp;<span class="ident" id="4014082">pubType</span>&nbsp;<span class="ident" id="4014090">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014111">switch</span>&nbsp;<span class="ident" id="4014118">priv</span>&nbsp;<span class="op" id="4014123">:=</span>&nbsp;<span class="ident" id="4014126">priv</span><span class="op" id="4014130">.</span><span class="op" id="4014131">(</span><span class="keyword" id="4014132">type</span><span class="op" id="4014136">)</span>&nbsp;<span class="op" id="4014138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014141">case</span>&nbsp;<span class="op" id="4014146">*</span><span class="ident" id="4014147">rsa</span><span class="op" id="4014150">.</span><span class="ident" id="4014151">PrivateKey</span><span class="op" id="4014161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014165">pubType</span>&nbsp;<span class="op" id="4014173">=</span>&nbsp;<span class="ident" id="4014175">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014181">sigAlgo</span><span class="op" id="4014188">.</span><span class="ident" id="4014189">Algorithm</span>&nbsp;<span class="op" id="4014199">=</span>&nbsp;<span class="ident" id="4014201">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014229">hashFunc</span>&nbsp;<span class="op" id="4014238">=</span>&nbsp;<span class="ident" id="4014240">crypto</span><span class="op" id="4014246">.</span><span class="ident" id="4014247">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014256">case</span>&nbsp;<span class="op" id="4014261">*</span><span class="ident" id="4014262">ecdsa</span><span class="op" id="4014267">.</span><span class="ident" id="4014268">PrivateKey</span><span class="op" id="4014278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014282">pubType</span>&nbsp;<span class="op" id="4014290">=</span>&nbsp;<span class="ident" id="4014292">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014301">switch</span>&nbsp;<span class="ident" id="4014308">priv</span><span class="op" id="4014312">.</span><span class="ident" id="4014313">Curve</span>&nbsp;<span class="op" id="4014319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014323">case</span>&nbsp;<span class="ident" id="4014328">elliptic</span><span class="op" id="4014336">.</span><span class="ident" id="4014337">P224</span><span class="op" id="4014341">(</span><span class="op" id="4014342">)</span><span class="op" id="4014343">,</span>&nbsp;<span class="ident" id="4014345">elliptic</span><span class="op" id="4014353">.</span><span class="ident" id="4014354">P256</span><span class="op" id="4014358">(</span><span class="op" id="4014359">)</span><span class="op" id="4014360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014365">hashFunc</span>&nbsp;<span class="op" id="4014374">=</span>&nbsp;<span class="ident" id="4014376">crypto</span><span class="op" id="4014382">.</span><span class="ident" id="4014383">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014393">sigAlgo</span><span class="op" id="4014400">.</span><span class="ident" id="4014401">Algorithm</span>&nbsp;<span class="op" id="4014411">=</span>&nbsp;<span class="ident" id="4014413">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014443">case</span>&nbsp;<span class="ident" id="4014448">elliptic</span><span class="op" id="4014456">.</span><span class="ident" id="4014457">P384</span><span class="op" id="4014461">(</span><span class="op" id="4014462">)</span><span class="op" id="4014463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014468">hashFunc</span>&nbsp;<span class="op" id="4014477">=</span>&nbsp;<span class="ident" id="4014479">crypto</span><span class="op" id="4014485">.</span><span class="ident" id="4014486">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014496">sigAlgo</span><span class="op" id="4014503">.</span><span class="ident" id="4014504">Algorithm</span>&nbsp;<span class="op" id="4014514">=</span>&nbsp;<span class="ident" id="4014516">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014546">case</span>&nbsp;<span class="ident" id="4014551">elliptic</span><span class="op" id="4014559">.</span><span class="ident" id="4014560">P521</span><span class="op" id="4014564">(</span><span class="op" id="4014565">)</span><span class="op" id="4014566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014571">hashFunc</span>&nbsp;<span class="op" id="4014580">=</span>&nbsp;<span class="ident" id="4014582">crypto</span><span class="op" id="4014588">.</span><span class="ident" id="4014589">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014599">sigAlgo</span><span class="op" id="4014606">.</span><span class="ident" id="4014607">Algorithm</span>&nbsp;<span class="op" id="4014617">=</span>&nbsp;<span class="ident" id="4014619">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014649">default</span><span class="op" id="4014656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014661">err</span>&nbsp;<span class="op" id="4014665">=</span>&nbsp;<span class="ident" id="4014667">errors</span><span class="op" id="4014673">.</span><span class="ident" id="4014674">New</span><span class="op" id="4014677">(</span><span class="string" id="4014678">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4014708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014716">default</span><span class="op" id="4014723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014727">err</span>&nbsp;<span class="op" id="4014731">=</span>&nbsp;<span class="ident" id="4014733">errors</span><span class="op" id="4014739">.</span><span class="ident" id="4014740">New</span><span class="op" id="4014743">(</span><span class="string" id="4014744">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4014793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014800">if</span>&nbsp;<span class="ident" id="4014803">err</span>&nbsp;<span class="op" id="4014807">!=</span>&nbsp;<span class="ident" id="4014810">nil</span>&nbsp;<span class="op" id="4014814">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014830">if</span>&nbsp;<span class="ident" id="4014833">requestedSigAlgo</span>&nbsp;<span class="op" id="4014850">==</span>&nbsp;<span class="num" id="4014853">0</span>&nbsp;<span class="op" id="4014855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014859">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014871">found</span>&nbsp;<span class="op" id="4014877">:=</span>&nbsp;<span class="builtintype" id="4014880">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014887">for</span>&nbsp;<span class="ident" id="4014891">_</span><span class="op" id="4014892">,</span>&nbsp;<span class="ident" id="4014894">details</span>&nbsp;<span class="op" id="4014902">:=</span>&nbsp;<span class="keyword" id="4014905">range</span>&nbsp;<span class="ident" id="4014911">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4014937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014941">if</span>&nbsp;<span class="ident" id="4014944">details</span><span class="op" id="4014951">.</span><span class="ident" id="4014952">algo</span>&nbsp;<span class="op" id="4014957">==</span>&nbsp;<span class="ident" id="4014960">requestedSigAlgo</span>&nbsp;<span class="op" id="4014977">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014982">if</span>&nbsp;<span class="ident" id="4014985">details</span><span class="op" id="4014992">.</span><span class="ident" id="4014993">pubKeyAlgo</span>&nbsp;<span class="op" id="4015004">!=</span>&nbsp;<span class="ident" id="4015007">pubType</span>&nbsp;<span class="op" id="4015015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015021">err</span>&nbsp;<span class="op" id="4015025">=</span>&nbsp;<span class="ident" id="4015027">errors</span><span class="op" id="4015033">.</span><span class="ident" id="4015034">New</span><span class="op" id="4015037">(</span><span class="string" id="4015038">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4015106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015112">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015127">sigAlgo</span><span class="op" id="4015134">.</span><span class="ident" id="4015135">Algorithm</span><span class="op" id="4015144">,</span>&nbsp;<span class="ident" id="4015146">hashFunc</span>&nbsp;<span class="op" id="4015155">=</span>&nbsp;<span class="ident" id="4015157">details</span><span class="op" id="4015164">.</span><span class="ident" id="4015165">oid</span><span class="op" id="4015168">,</span>&nbsp;<span class="ident" id="4015170">details</span><span class="op" id="4015177">.</span><span class="ident" id="4015178">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015186">if</span>&nbsp;<span class="ident" id="4015189">hashFunc</span>&nbsp;<span class="op" id="4015198">==</span>&nbsp;<span class="num" id="4015201">0</span>&nbsp;<span class="op" id="4015203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015209">err</span>&nbsp;<span class="op" id="4015213">=</span>&nbsp;<span class="ident" id="4015215">errors</span><span class="op" id="4015221">.</span><span class="ident" id="4015222">New</span><span class="op" id="4015225">(</span><span class="string" id="4015226">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4015274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015280">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015295">found</span>&nbsp;<span class="op" id="4015301">=</span>&nbsp;<span class="builtintype" id="4015303">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015311">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015326">if</span>&nbsp;<span class="op" id="4015329">!</span><span class="ident" id="4015330">found</span>&nbsp;<span class="op" id="4015336">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015340">err</span>&nbsp;<span class="op" id="4015344">=</span>&nbsp;<span class="ident" id="4015346">errors</span><span class="op" id="4015352">.</span><span class="ident" id="4015353">New</span><span class="op" id="4015356">(</span><span class="string" id="4015357">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4015391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015398">return</span><br>
<span class="lineno"></span><span class="op" id="4015405">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4015408">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4015480">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4015557">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4015636">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4015710">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4015754">//</span><br>
<span class="lineno"></span><span class="comment" id="4015757">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4015837">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4015911">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4015964">//</span><br>
<span class="lineno"></span><span class="comment" id="4015967">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4016025">//</span><br>
<span class="lineno"></span><span class="comment" id="4016028">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4016097">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4016174">func</span>&nbsp;<span class="ident" id="4016179">CreateCertificate</span><span class="op" id="4016196">(</span><span class="ident" id="4016197">rand</span>&nbsp;<span class="ident" id="4016202">io</span><span class="op" id="4016204">.</span><span class="ident" id="4016205">Reader</span><span class="op" id="4016211">,</span>&nbsp;<span class="ident" id="4016213">template</span><span class="op" id="4016221">,</span>&nbsp;<span class="ident" id="4016223">parent</span>&nbsp;<span class="op" id="4016230">*</span><span class="ident" id="4016231">Certificate</span><span class="op" id="4016242">,</span>&nbsp;<span class="ident" id="4016244">pub</span>&nbsp;<span class="keyword" id="4016248">interface</span><span class="op" id="4016257">{</span><span class="op" id="4016258">}</span><span class="op" id="4016259">,</span>&nbsp;<span class="ident" id="4016261">priv</span>&nbsp;<span class="keyword" id="4016266">interface</span><span class="op" id="4016275">{</span><span class="op" id="4016276">}</span><span class="op" id="4016277">)</span>&nbsp;<span class="op" id="4016279">(</span><span class="ident" id="4016280">cert</span>&nbsp;<span class="op" id="4016285">[</span><span class="op" id="4016286">]</span><span class="builtintype" id="4016287">byte</span><span class="op" id="4016291">,</span>&nbsp;<span class="ident" id="4016293">err</span>&nbsp;<span class="builtintype" id="4016297">error</span><span class="op" id="4016302">)</span>&nbsp;<span class="op" id="4016304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016307">hashFunc</span><span class="op" id="4016315">,</span>&nbsp;<span class="ident" id="4016317">signatureAlgorithm</span><span class="op" id="4016335">,</span>&nbsp;<span class="ident" id="4016337">err</span>&nbsp;<span class="op" id="4016341">:=</span>&nbsp;<span class="ident" id="4016344">signingParamsForPrivateKey</span><span class="op" id="4016370">(</span><span class="ident" id="4016371">priv</span><span class="op" id="4016375">,</span>&nbsp;<span class="ident" id="4016377">template</span><span class="op" id="4016385">.</span><span class="ident" id="4016386">SignatureAlgorithm</span><span class="op" id="4016404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016407">if</span>&nbsp;<span class="ident" id="4016410">err</span>&nbsp;<span class="op" id="4016414">!=</span>&nbsp;<span class="ident" id="4016417">nil</span>&nbsp;<span class="op" id="4016421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016425">return</span>&nbsp;<span class="ident" id="4016432">nil</span><span class="op" id="4016435">,</span>&nbsp;<span class="ident" id="4016437">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016442">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016446">publicKeyBytes</span><span class="op" id="4016460">,</span>&nbsp;<span class="ident" id="4016462">publicKeyAlgorithm</span><span class="op" id="4016480">,</span>&nbsp;<span class="ident" id="4016482">err</span>&nbsp;<span class="op" id="4016486">:=</span>&nbsp;<span class="ident" id="4016489">marshalPublicKey</span><span class="op" id="4016505">(</span><span class="ident" id="4016506">pub</span><span class="op" id="4016509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016512">if</span>&nbsp;<span class="ident" id="4016515">err</span>&nbsp;<span class="op" id="4016519">!=</span>&nbsp;<span class="ident" id="4016522">nil</span>&nbsp;<span class="op" id="4016526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016530">return</span>&nbsp;<span class="ident" id="4016537">nil</span><span class="op" id="4016540">,</span>&nbsp;<span class="ident" id="4016542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016547">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016551">if</span>&nbsp;<span class="ident" id="4016554">err</span>&nbsp;<span class="op" id="4016558">!=</span>&nbsp;<span class="ident" id="4016561">nil</span>&nbsp;<span class="op" id="4016565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016569">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016581">if</span>&nbsp;<span class="builtinfunc" id="4016584">len</span><span class="op" id="4016587">(</span><span class="ident" id="4016588">parent</span><span class="op" id="4016594">.</span><span class="ident" id="4016595">SubjectKeyId</span><span class="op" id="4016607">)</span>&nbsp;<span class="op" id="4016609">&gt;</span>&nbsp;<span class="num" id="4016611">0</span>&nbsp;<span class="op" id="4016613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016617">template</span><span class="op" id="4016625">.</span><span class="ident" id="4016626">AuthorityKeyId</span>&nbsp;<span class="op" id="4016641">=</span>&nbsp;<span class="ident" id="4016643">parent</span><span class="op" id="4016649">.</span><span class="ident" id="4016650">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016668">extensions</span><span class="op" id="4016678">,</span>&nbsp;<span class="ident" id="4016680">err</span>&nbsp;<span class="op" id="4016684">:=</span>&nbsp;<span class="ident" id="4016687">buildExtensions</span><span class="op" id="4016702">(</span><span class="ident" id="4016703">template</span><span class="op" id="4016711">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016714">if</span>&nbsp;<span class="ident" id="4016717">err</span>&nbsp;<span class="op" id="4016721">!=</span>&nbsp;<span class="ident" id="4016724">nil</span>&nbsp;<span class="op" id="4016728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016732">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016744">asn1Issuer</span><span class="op" id="4016754">,</span>&nbsp;<span class="ident" id="4016756">err</span>&nbsp;<span class="op" id="4016760">:=</span>&nbsp;<span class="ident" id="4016763">subjectBytes</span><span class="op" id="4016775">(</span><span class="ident" id="4016776">parent</span><span class="op" id="4016782">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016785">if</span>&nbsp;<span class="ident" id="4016788">err</span>&nbsp;<span class="op" id="4016792">!=</span>&nbsp;<span class="ident" id="4016795">nil</span>&nbsp;<span class="op" id="4016799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016803">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016815">asn1Subject</span><span class="op" id="4016826">,</span>&nbsp;<span class="ident" id="4016828">err</span>&nbsp;<span class="op" id="4016832">:=</span>&nbsp;<span class="ident" id="4016835">subjectBytes</span><span class="op" id="4016847">(</span><span class="ident" id="4016848">template</span><span class="op" id="4016856">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016859">if</span>&nbsp;<span class="ident" id="4016862">err</span>&nbsp;<span class="op" id="4016866">!=</span>&nbsp;<span class="ident" id="4016869">nil</span>&nbsp;<span class="op" id="4016873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016877">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016889">encodedPublicKey</span>&nbsp;<span class="op" id="4016906">:=</span>&nbsp;<span class="ident" id="4016909">asn1</span><span class="op" id="4016913">.</span><span class="ident" id="4016914">BitString</span><span class="op" id="4016923">{</span><span class="ident" id="4016924">BitLength</span><span class="op" id="4016933">:</span>&nbsp;<span class="builtinfunc" id="4016935">len</span><span class="op" id="4016938">(</span><span class="ident" id="4016939">publicKeyBytes</span><span class="op" id="4016953">)</span>&nbsp;<span class="op" id="4016955">*</span>&nbsp;<span class="num" id="4016957">8</span><span class="op" id="4016958">,</span>&nbsp;<span class="ident" id="4016960">Bytes</span><span class="op" id="4016965">:</span>&nbsp;<span class="ident" id="4016967">publicKeyBytes</span><span class="op" id="4016981">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016984">c</span>&nbsp;<span class="op" id="4016986">:=</span>&nbsp;<span class="ident" id="4016989">tbsCertificate</span><span class="op" id="4017003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017007">Version</span><span class="op" id="4017014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4017027">2</span><span class="op" id="4017028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017032">SerialNumber</span><span class="op" id="4017044">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017052">template</span><span class="op" id="4017060">.</span><span class="ident" id="4017061">SerialNumber</span><span class="op" id="4017073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017077">SignatureAlgorithm</span><span class="op" id="4017095">:</span>&nbsp;<span class="ident" id="4017097">signatureAlgorithm</span><span class="op" id="4017115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017119">Issuer</span><span class="op" id="4017125">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017139">asn1</span><span class="op" id="4017143">.</span><span class="ident" id="4017144">RawValue</span><span class="op" id="4017152">{</span><span class="ident" id="4017153">FullBytes</span><span class="op" id="4017162">:</span>&nbsp;<span class="ident" id="4017164">asn1Issuer</span><span class="op" id="4017174">}</span><span class="op" id="4017175">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017179">Validity</span><span class="op" id="4017187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017199">validity</span><span class="op" id="4017207">{</span><span class="ident" id="4017208">template</span><span class="op" id="4017216">.</span><span class="ident" id="4017217">NotBefore</span><span class="op" id="4017226">.</span><span class="ident" id="4017227">UTC</span><span class="op" id="4017230">(</span><span class="op" id="4017231">)</span><span class="op" id="4017232">,</span>&nbsp;<span class="ident" id="4017234">template</span><span class="op" id="4017242">.</span><span class="ident" id="4017243">NotAfter</span><span class="op" id="4017251">.</span><span class="ident" id="4017252">UTC</span><span class="op" id="4017255">(</span><span class="op" id="4017256">)</span><span class="op" id="4017257">}</span><span class="op" id="4017258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017262">Subject</span><span class="op" id="4017269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017282">asn1</span><span class="op" id="4017286">.</span><span class="ident" id="4017287">RawValue</span><span class="op" id="4017295">{</span><span class="ident" id="4017296">FullBytes</span><span class="op" id="4017305">:</span>&nbsp;<span class="ident" id="4017307">asn1Subject</span><span class="op" id="4017318">}</span><span class="op" id="4017319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017323">PublicKey</span><span class="op" id="4017332">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017343">publicKeyInfo</span><span class="op" id="4017356">{</span><span class="ident" id="4017357">nil</span><span class="op" id="4017360">,</span>&nbsp;<span class="ident" id="4017362">publicKeyAlgorithm</span><span class="op" id="4017380">,</span>&nbsp;<span class="ident" id="4017382">encodedPublicKey</span><span class="op" id="4017398">}</span><span class="op" id="4017399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017403">Extensions</span><span class="op" id="4017413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017423">extensions</span><span class="op" id="4017433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017436">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017440">tbsCertContents</span><span class="op" id="4017455">,</span>&nbsp;<span class="ident" id="4017457">err</span>&nbsp;<span class="op" id="4017461">:=</span>&nbsp;<span class="ident" id="4017464">asn1</span><span class="op" id="4017468">.</span><span class="ident" id="4017469">Marshal</span><span class="op" id="4017476">(</span><span class="ident" id="4017477">c</span><span class="op" id="4017478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017481">if</span>&nbsp;<span class="ident" id="4017484">err</span>&nbsp;<span class="op" id="4017488">!=</span>&nbsp;<span class="ident" id="4017491">nil</span>&nbsp;<span class="op" id="4017495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017507">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017511">c</span><span class="op" id="4017512">.</span><span class="ident" id="4017513">Raw</span>&nbsp;<span class="op" id="4017517">=</span>&nbsp;<span class="ident" id="4017519">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017537">h</span>&nbsp;<span class="op" id="4017539">:=</span>&nbsp;<span class="ident" id="4017542">hashFunc</span><span class="op" id="4017550">.</span><span class="ident" id="4017551">New</span><span class="op" id="4017554">(</span><span class="op" id="4017555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017558">h</span><span class="op" id="4017559">.</span><span class="ident" id="4017560">Write</span><span class="op" id="4017565">(</span><span class="ident" id="4017566">tbsCertContents</span><span class="op" id="4017581">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017584">digest</span>&nbsp;<span class="op" id="4017591">:=</span>&nbsp;<span class="ident" id="4017594">h</span><span class="op" id="4017595">.</span><span class="ident" id="4017596">Sum</span><span class="op" id="4017599">(</span><span class="ident" id="4017600">nil</span><span class="op" id="4017603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017607">var</span>&nbsp;<span class="ident" id="4017611">signature</span>&nbsp;<span class="op" id="4017621">[</span><span class="op" id="4017622">]</span><span class="builtintype" id="4017623">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017630">switch</span>&nbsp;<span class="ident" id="4017637">priv</span>&nbsp;<span class="op" id="4017642">:=</span>&nbsp;<span class="ident" id="4017645">priv</span><span class="op" id="4017649">.</span><span class="op" id="4017650">(</span><span class="keyword" id="4017651">type</span><span class="op" id="4017655">)</span>&nbsp;<span class="op" id="4017657">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017660">case</span>&nbsp;<span class="op" id="4017665">*</span><span class="ident" id="4017666">rsa</span><span class="op" id="4017669">.</span><span class="ident" id="4017670">PrivateKey</span><span class="op" id="4017680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017684">signature</span><span class="op" id="4017693">,</span>&nbsp;<span class="ident" id="4017695">err</span>&nbsp;<span class="op" id="4017699">=</span>&nbsp;<span class="ident" id="4017701">rsa</span><span class="op" id="4017704">.</span><span class="ident" id="4017705">SignPKCS1v15</span><span class="op" id="4017717">(</span><span class="ident" id="4017718">rand</span><span class="op" id="4017722">,</span>&nbsp;<span class="ident" id="4017724">priv</span><span class="op" id="4017728">,</span>&nbsp;<span class="ident" id="4017730">hashFunc</span><span class="op" id="4017738">,</span>&nbsp;<span class="ident" id="4017740">digest</span><span class="op" id="4017746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017749">case</span>&nbsp;<span class="op" id="4017754">*</span><span class="ident" id="4017755">ecdsa</span><span class="op" id="4017760">.</span><span class="ident" id="4017761">PrivateKey</span><span class="op" id="4017771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017775">var</span>&nbsp;<span class="ident" id="4017779">r</span><span class="op" id="4017780">,</span>&nbsp;<span class="ident" id="4017782">s</span>&nbsp;<span class="op" id="4017784">*</span><span class="ident" id="4017785">big</span><span class="op" id="4017788">.</span><span class="ident" id="4017789">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017795">if</span>&nbsp;<span class="ident" id="4017798">r</span><span class="op" id="4017799">,</span>&nbsp;<span class="ident" id="4017801">s</span><span class="op" id="4017802">,</span>&nbsp;<span class="ident" id="4017804">err</span>&nbsp;<span class="op" id="4017808">=</span>&nbsp;<span class="ident" id="4017810">ecdsa</span><span class="op" id="4017815">.</span><span class="ident" id="4017816">Sign</span><span class="op" id="4017820">(</span><span class="ident" id="4017821">rand</span><span class="op" id="4017825">,</span>&nbsp;<span class="ident" id="4017827">priv</span><span class="op" id="4017831">,</span>&nbsp;<span class="ident" id="4017833">digest</span><span class="op" id="4017839">)</span><span class="op" id="4017840">;</span>&nbsp;<span class="ident" id="4017842">err</span>&nbsp;<span class="op" id="4017846">==</span>&nbsp;<span class="ident" id="4017849">nil</span>&nbsp;<span class="op" id="4017853">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017858">signature</span><span class="op" id="4017867">,</span>&nbsp;<span class="ident" id="4017869">err</span>&nbsp;<span class="op" id="4017873">=</span>&nbsp;<span class="ident" id="4017875">asn1</span><span class="op" id="4017879">.</span><span class="ident" id="4017880">Marshal</span><span class="op" id="4017887">(</span><span class="ident" id="4017888">ecdsaSignature</span><span class="op" id="4017902">{</span><span class="ident" id="4017903">r</span><span class="op" id="4017904">,</span>&nbsp;<span class="ident" id="4017906">s</span><span class="op" id="4017907">}</span><span class="op" id="4017908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017915">default</span><span class="op" id="4017922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4017926">panic</span><span class="op" id="4017931">(</span><span class="string" id="4017932">&#34;internal&nbsp;error&#34;</span><span class="op" id="4017948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017951">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017955">if</span>&nbsp;<span class="ident" id="4017958">err</span>&nbsp;<span class="op" id="4017962">!=</span>&nbsp;<span class="ident" id="4017965">nil</span>&nbsp;<span class="op" id="4017969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017973">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017985">cert</span><span class="op" id="4017989">,</span>&nbsp;<span class="ident" id="4017991">err</span>&nbsp;<span class="op" id="4017995">=</span>&nbsp;<span class="ident" id="4017997">asn1</span><span class="op" id="4018001">.</span><span class="ident" id="4018002">Marshal</span><span class="op" id="4018009">(</span><span class="ident" id="4018010">certificate</span><span class="op" id="4018021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018025">nil</span><span class="op" id="4018028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018032">c</span><span class="op" id="4018033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018037">signatureAlgorithm</span><span class="op" id="4018055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018059">asn1</span><span class="op" id="4018063">.</span><span class="ident" id="4018064">BitString</span><span class="op" id="4018073">{</span><span class="ident" id="4018074">Bytes</span><span class="op" id="4018079">:</span>&nbsp;<span class="ident" id="4018081">signature</span><span class="op" id="4018090">,</span>&nbsp;<span class="ident" id="4018092">BitLength</span><span class="op" id="4018101">:</span>&nbsp;<span class="builtinfunc" id="4018103">len</span><span class="op" id="4018106">(</span><span class="ident" id="4018107">signature</span><span class="op" id="4018116">)</span>&nbsp;<span class="op" id="4018118">*</span>&nbsp;<span class="num" id="4018120">8</span><span class="op" id="4018121">}</span><span class="op" id="4018122">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018125">}</span><span class="op" id="4018126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018129">return</span><br>
<span class="lineno"></span><span class="op" id="4018136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018139">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4018217">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4018225">var</span>&nbsp;<span class="ident" id="4018229">pemCRLPrefix</span>&nbsp;<span class="op" id="4018242">=</span>&nbsp;<span class="op" id="4018244">[</span><span class="op" id="4018245">]</span><span class="builtintype" id="4018246">byte</span><span class="op" id="4018250">(</span><span class="string" id="4018251">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4018272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018275">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4018320">var</span>&nbsp;<span class="ident" id="4018324">pemType</span>&nbsp;<span class="op" id="4018332">=</span>&nbsp;<span class="string" id="4018334">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4018346">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4018422">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4018501">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4018578">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4018590">func</span>&nbsp;<span class="ident" id="4018595">ParseCRL</span><span class="op" id="4018603">(</span><span class="ident" id="4018604">crlBytes</span>&nbsp;<span class="op" id="4018613">[</span><span class="op" id="4018614">]</span><span class="builtintype" id="4018615">byte</span><span class="op" id="4018619">)</span>&nbsp;<span class="op" id="4018621">(</span><span class="ident" id="4018622">certList</span>&nbsp;<span class="op" id="4018631">*</span><span class="ident" id="4018632">pkix</span><span class="op" id="4018636">.</span><span class="ident" id="4018637">CertificateList</span><span class="op" id="4018652">,</span>&nbsp;<span class="ident" id="4018654">err</span>&nbsp;<span class="builtintype" id="4018658">error</span><span class="op" id="4018663">)</span>&nbsp;<span class="op" id="4018665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018668">if</span>&nbsp;<span class="ident" id="4018671">bytes</span><span class="op" id="4018676">.</span><span class="ident" id="4018677">HasPrefix</span><span class="op" id="4018686">(</span><span class="ident" id="4018687">crlBytes</span><span class="op" id="4018695">,</span>&nbsp;<span class="ident" id="4018697">pemCRLPrefix</span><span class="op" id="4018709">)</span>&nbsp;<span class="op" id="4018711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018715">block</span><span class="op" id="4018720">,</span>&nbsp;<span class="ident" id="4018722">_</span>&nbsp;<span class="op" id="4018724">:=</span>&nbsp;<span class="ident" id="4018727">pem</span><span class="op" id="4018730">.</span><span class="ident" id="4018731">Decode</span><span class="op" id="4018737">(</span><span class="ident" id="4018738">crlBytes</span><span class="op" id="4018746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018750">if</span>&nbsp;<span class="ident" id="4018753">block</span>&nbsp;<span class="op" id="4018759">!=</span>&nbsp;<span class="ident" id="4018762">nil</span>&nbsp;<span class="op" id="4018766">&amp;&amp;</span>&nbsp;<span class="ident" id="4018769">block</span><span class="op" id="4018774">.</span><span class="ident" id="4018775">Type</span>&nbsp;<span class="op" id="4018780">==</span>&nbsp;<span class="ident" id="4018783">pemType</span>&nbsp;<span class="op" id="4018791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018796">crlBytes</span>&nbsp;<span class="op" id="4018805">=</span>&nbsp;<span class="ident" id="4018807">block</span><span class="op" id="4018812">.</span><span class="ident" id="4018813">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018827">return</span>&nbsp;<span class="ident" id="4018834">ParseDERCRL</span><span class="op" id="4018845">(</span><span class="ident" id="4018846">crlBytes</span><span class="op" id="4018854">)</span><br>
<span class="lineno"></span><span class="op" id="4018856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4018859">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4018921">func</span>&nbsp;<span class="ident" id="4018926">ParseDERCRL</span><span class="op" id="4018937">(</span><span class="ident" id="4018938">derBytes</span>&nbsp;<span class="op" id="4018947">[</span><span class="op" id="4018948">]</span><span class="builtintype" id="4018949">byte</span><span class="op" id="4018953">)</span>&nbsp;<span class="op" id="4018955">(</span><span class="ident" id="4018956">certList</span>&nbsp;<span class="op" id="4018965">*</span><span class="ident" id="4018966">pkix</span><span class="op" id="4018970">.</span><span class="ident" id="4018971">CertificateList</span><span class="op" id="4018986">,</span>&nbsp;<span class="ident" id="4018988">err</span>&nbsp;<span class="builtintype" id="4018992">error</span><span class="op" id="4018997">)</span>&nbsp;<span class="op" id="4018999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019002">certList</span>&nbsp;<span class="op" id="4019011">=</span>&nbsp;<span class="builtinfunc" id="4019013">new</span><span class="op" id="4019016">(</span><span class="ident" id="4019017">pkix</span><span class="op" id="4019021">.</span><span class="ident" id="4019022">CertificateList</span><span class="op" id="4019037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019040">_</span><span class="op" id="4019041">,</span>&nbsp;<span class="ident" id="4019043">err</span>&nbsp;<span class="op" id="4019047">=</span>&nbsp;<span class="ident" id="4019049">asn1</span><span class="op" id="4019053">.</span><span class="ident" id="4019054">Unmarshal</span><span class="op" id="4019063">(</span><span class="ident" id="4019064">derBytes</span><span class="op" id="4019072">,</span>&nbsp;<span class="ident" id="4019074">certList</span><span class="op" id="4019082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019085">if</span>&nbsp;<span class="ident" id="4019088">err</span>&nbsp;<span class="op" id="4019092">!=</span>&nbsp;<span class="ident" id="4019095">nil</span>&nbsp;<span class="op" id="4019099">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019103">certList</span>&nbsp;<span class="op" id="4019112">=</span>&nbsp;<span class="ident" id="4019114">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019122">return</span><br>
<span class="lineno"></span><span class="op" id="4019129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4019132">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4019205">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4019257">//</span><br>
<span class="lineno"></span><span class="comment" id="4019260">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4019326">func</span>&nbsp;<span class="op" id="4019331">(</span><span class="ident" id="4019332">c</span>&nbsp;<span class="op" id="4019334">*</span><span class="ident" id="4019335">Certificate</span><span class="op" id="4019346">)</span>&nbsp;<span class="ident" id="4019348">CreateCRL</span><span class="op" id="4019357">(</span><span class="ident" id="4019358">rand</span>&nbsp;<span class="ident" id="4019363">io</span><span class="op" id="4019365">.</span><span class="ident" id="4019366">Reader</span><span class="op" id="4019372">,</span>&nbsp;<span class="ident" id="4019374">priv</span>&nbsp;<span class="keyword" id="4019379">interface</span><span class="op" id="4019388">{</span><span class="op" id="4019389">}</span><span class="op" id="4019390">,</span>&nbsp;<span class="ident" id="4019392">revokedCerts</span>&nbsp;<span class="op" id="4019405">[</span><span class="op" id="4019406">]</span><span class="ident" id="4019407">pkix</span><span class="op" id="4019411">.</span><span class="ident" id="4019412">RevokedCertificate</span><span class="op" id="4019430">,</span>&nbsp;<span class="ident" id="4019432">now</span><span class="op" id="4019435">,</span>&nbsp;<span class="ident" id="4019437">expiry</span>&nbsp;<span class="ident" id="4019444">time</span><span class="op" id="4019448">.</span><span class="ident" id="4019449">Time</span><span class="op" id="4019453">)</span>&nbsp;<span class="op" id="4019455">(</span><span class="ident" id="4019456">crlBytes</span>&nbsp;<span class="op" id="4019465">[</span><span class="op" id="4019466">]</span><span class="builtintype" id="4019467">byte</span><span class="op" id="4019471">,</span>&nbsp;<span class="ident" id="4019473">err</span>&nbsp;<span class="builtintype" id="4019477">error</span><span class="op" id="4019482">)</span>&nbsp;<span class="op" id="4019484">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019487">rsaPriv</span><span class="op" id="4019494">,</span>&nbsp;<span class="ident" id="4019496">ok</span>&nbsp;<span class="op" id="4019499">:=</span>&nbsp;<span class="ident" id="4019502">priv</span><span class="op" id="4019506">.</span><span class="op" id="4019507">(</span><span class="op" id="4019508">*</span><span class="ident" id="4019509">rsa</span><span class="op" id="4019512">.</span><span class="ident" id="4019513">PrivateKey</span><span class="op" id="4019523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019526">if</span>&nbsp;<span class="op" id="4019529">!</span><span class="ident" id="4019530">ok</span>&nbsp;<span class="op" id="4019533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019537">return</span>&nbsp;<span class="ident" id="4019544">nil</span><span class="op" id="4019547">,</span>&nbsp;<span class="ident" id="4019549">errors</span><span class="op" id="4019555">.</span><span class="ident" id="4019556">New</span><span class="op" id="4019559">(</span><span class="string" id="4019560">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4019602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019608">tbsCertList</span>&nbsp;<span class="op" id="4019620">:=</span>&nbsp;<span class="ident" id="4019623">pkix</span><span class="op" id="4019627">.</span><span class="ident" id="4019628">TBSCertificateList</span><span class="op" id="4019646">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019650">Version</span><span class="op" id="4019657">:</span>&nbsp;<span class="num" id="4019659">2</span><span class="op" id="4019660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019664">Signature</span><span class="op" id="4019673">:</span>&nbsp;<span class="ident" id="4019675">pkix</span><span class="op" id="4019679">.</span><span class="ident" id="4019680">AlgorithmIdentifier</span><span class="op" id="4019699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019704">Algorithm</span><span class="op" id="4019713">:</span>&nbsp;<span class="ident" id="4019715">oidSignatureSHA1WithRSA</span><span class="op" id="4019738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019742">}</span><span class="op" id="4019743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019747">Issuer</span><span class="op" id="4019753">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019768">c</span><span class="op" id="4019769">.</span><span class="ident" id="4019770">Subject</span><span class="op" id="4019777">.</span><span class="ident" id="4019778">ToRDNSequence</span><span class="op" id="4019791">(</span><span class="op" id="4019792">)</span><span class="op" id="4019793">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019797">ThisUpdate</span><span class="op" id="4019807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019818">now</span><span class="op" id="4019821">.</span><span class="ident" id="4019822">UTC</span><span class="op" id="4019825">(</span><span class="op" id="4019826">)</span><span class="op" id="4019827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019831">NextUpdate</span><span class="op" id="4019841">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019852">expiry</span><span class="op" id="4019858">.</span><span class="ident" id="4019859">UTC</span><span class="op" id="4019862">(</span><span class="op" id="4019863">)</span><span class="op" id="4019864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019868">RevokedCertificates</span><span class="op" id="4019887">:</span>&nbsp;<span class="ident" id="4019889">revokedCerts</span><span class="op" id="4019901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019908">tbsCertListContents</span><span class="op" id="4019927">,</span>&nbsp;<span class="ident" id="4019929">err</span>&nbsp;<span class="op" id="4019933">:=</span>&nbsp;<span class="ident" id="4019936">asn1</span><span class="op" id="4019940">.</span><span class="ident" id="4019941">Marshal</span><span class="op" id="4019948">(</span><span class="ident" id="4019949">tbsCertList</span><span class="op" id="4019960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019963">if</span>&nbsp;<span class="ident" id="4019966">err</span>&nbsp;<span class="op" id="4019970">!=</span>&nbsp;<span class="ident" id="4019973">nil</span>&nbsp;<span class="op" id="4019977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019981">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019993">h</span>&nbsp;<span class="op" id="4019995">:=</span>&nbsp;<span class="ident" id="4019998">sha1</span><span class="op" id="4020002">.</span><span class="ident" id="4020003">New</span><span class="op" id="4020006">(</span><span class="op" id="4020007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020010">h</span><span class="op" id="4020011">.</span><span class="ident" id="4020012">Write</span><span class="op" id="4020017">(</span><span class="ident" id="4020018">tbsCertListContents</span><span class="op" id="4020037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020040">digest</span>&nbsp;<span class="op" id="4020047">:=</span>&nbsp;<span class="ident" id="4020050">h</span><span class="op" id="4020051">.</span><span class="ident" id="4020052">Sum</span><span class="op" id="4020055">(</span><span class="ident" id="4020056">nil</span><span class="op" id="4020059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020063">signature</span><span class="op" id="4020072">,</span>&nbsp;<span class="ident" id="4020074">err</span>&nbsp;<span class="op" id="4020078">:=</span>&nbsp;<span class="ident" id="4020081">rsa</span><span class="op" id="4020084">.</span><span class="ident" id="4020085">SignPKCS1v15</span><span class="op" id="4020097">(</span><span class="ident" id="4020098">rand</span><span class="op" id="4020102">,</span>&nbsp;<span class="ident" id="4020104">rsaPriv</span><span class="op" id="4020111">,</span>&nbsp;<span class="ident" id="4020113">crypto</span><span class="op" id="4020119">.</span><span class="ident" id="4020120">SHA1</span><span class="op" id="4020124">,</span>&nbsp;<span class="ident" id="4020126">digest</span><span class="op" id="4020132">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020135">if</span>&nbsp;<span class="ident" id="4020138">err</span>&nbsp;<span class="op" id="4020142">!=</span>&nbsp;<span class="ident" id="4020145">nil</span>&nbsp;<span class="op" id="4020149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020153">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020165">return</span>&nbsp;<span class="ident" id="4020172">asn1</span><span class="op" id="4020176">.</span><span class="ident" id="4020177">Marshal</span><span class="op" id="4020184">(</span><span class="ident" id="4020185">pkix</span><span class="op" id="4020189">.</span><span class="ident" id="4020190">CertificateList</span><span class="op" id="4020205">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020209">TBSCertList</span><span class="op" id="4020220">:</span>&nbsp;<span class="ident" id="4020222">tbsCertList</span><span class="op" id="4020233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020237">SignatureAlgorithm</span><span class="op" id="4020255">:</span>&nbsp;<span class="ident" id="4020257">pkix</span><span class="op" id="4020261">.</span><span class="ident" id="4020262">AlgorithmIdentifier</span><span class="op" id="4020281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020286">Algorithm</span><span class="op" id="4020295">:</span>&nbsp;<span class="ident" id="4020297">oidSignatureSHA1WithRSA</span><span class="op" id="4020320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020324">}</span><span class="op" id="4020325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020329">SignatureValue</span><span class="op" id="4020343">:</span>&nbsp;<span class="ident" id="4020345">asn1</span><span class="op" id="4020349">.</span><span class="ident" id="4020350">BitString</span><span class="op" id="4020359">{</span><span class="ident" id="4020360">Bytes</span><span class="op" id="4020365">:</span>&nbsp;<span class="ident" id="4020367">signature</span><span class="op" id="4020376">,</span>&nbsp;<span class="ident" id="4020378">BitLength</span><span class="op" id="4020387">:</span>&nbsp;<span class="builtinfunc" id="4020389">len</span><span class="op" id="4020392">(</span><span class="ident" id="4020393">signature</span><span class="op" id="4020402">)</span>&nbsp;<span class="op" id="4020404">*</span>&nbsp;<span class="num" id="4020406">8</span><span class="op" id="4020407">}</span><span class="op" id="4020408">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020411">}</span><span class="op" id="4020412">)</span><br>
<span class="lineno"></span><span class="op" id="4020414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4020417">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4020493">type</span>&nbsp;<span class="ident" id="4020498">CertificateRequest</span>&nbsp;<span class="keyword" id="4020517">struct</span>&nbsp;<span class="op" id="4020524">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020527">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020552">[</span><span class="op" id="4020553">]</span><span class="builtintype" id="4020554">byte</span>&nbsp;<span class="comment" id="4020559">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020632">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4020657">[</span><span class="op" id="4020658">]</span><span class="builtintype" id="4020659">byte</span>&nbsp;<span class="comment" id="4020664">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020724">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4020749">[</span><span class="op" id="4020750">]</span><span class="builtintype" id="4020751">byte</span>&nbsp;<span class="comment" id="4020756">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020794">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020819">[</span><span class="op" id="4020820">]</span><span class="builtintype" id="4020821">byte</span>&nbsp;<span class="comment" id="4020826">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020852">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4020871">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020876">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020895">[</span><span class="op" id="4020896">]</span><span class="builtintype" id="4020897">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020903">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4020922">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020943">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4020962">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020982">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4021001">interface</span><span class="op" id="4021010">{</span><span class="op" id="4021011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021015">Subject</span>&nbsp;<span class="ident" id="4021023">pkix</span><span class="op" id="4021027">.</span><span class="ident" id="4021028">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021035">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021090">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021155">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021185">Attributes</span>&nbsp;<span class="op" id="4021196">[</span><span class="op" id="4021197">]</span><span class="ident" id="4021198">pkix</span><span class="op" id="4021202">.</span><span class="ident" id="4021203">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021230">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021300">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021366">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021379">Extensions</span>&nbsp;<span class="op" id="4021390">[</span><span class="op" id="4021391">]</span><span class="ident" id="4021392">pkix</span><span class="op" id="4021396">.</span><span class="ident" id="4021397">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021409">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021477">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021548">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021616">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021656">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021660">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021730">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021746">ExtraExtensions</span>&nbsp;<span class="op" id="4021762">[</span><span class="op" id="4021763">]</span><span class="ident" id="4021764">pkix</span><span class="op" id="4021768">.</span><span class="ident" id="4021769">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021781">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021816">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4021831">[</span><span class="op" id="4021832">]</span><span class="builtintype" id="4021833">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021841">EmailAddresses</span>&nbsp;<span class="op" id="4021856">[</span><span class="op" id="4021857">]</span><span class="builtintype" id="4021858">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021866">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4021881">[</span><span class="op" id="4021882">]</span><span class="ident" id="4021883">net</span><span class="op" id="4021886">.</span><span class="ident" id="4021887">IP</span><br>
<span class="lineno"></span><span class="op" id="4021890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4021893">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4021962">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022001">type</span>&nbsp;<span class="ident" id="4022006">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4022028">struct</span>&nbsp;<span class="op" id="4022035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022038">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4022049">asn1</span><span class="op" id="4022053">.</span><span class="ident" id="4022054">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022066">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022077">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022082">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4022093">asn1</span><span class="op" id="4022097">.</span><span class="ident" id="4022098">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022108">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4022119">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022134">Attributes</span>&nbsp;<span class="op" id="4022145">[</span><span class="op" id="4022146">]</span><span class="ident" id="4022147">pkix</span><span class="op" id="4022151">.</span><span class="ident" id="4022152">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4022177">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4022192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4022195">type</span>&nbsp;<span class="ident" id="4022200">certificateRequest</span>&nbsp;<span class="keyword" id="4022219">struct</span>&nbsp;<span class="op" id="4022226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022229">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4022248">asn1</span><span class="op" id="4022252">.</span><span class="ident" id="4022253">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022265">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4022284">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022307">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4022326">pkix</span><span class="op" id="4022330">.</span><span class="ident" id="4022331">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022352">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4022371">asn1</span><span class="op" id="4022375">.</span><span class="ident" id="4022376">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4022386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022389">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4022467">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4022491">var</span>&nbsp;<span class="ident" id="4022495">oidExtensionRequest</span>&nbsp;<span class="op" id="4022515">=</span>&nbsp;<span class="ident" id="4022517">asn1</span><span class="op" id="4022521">.</span><span class="ident" id="4022522">ObjectIdentifier</span><span class="op" id="4022538">{</span><span class="num" id="4022539">1</span><span class="op" id="4022540">,</span>&nbsp;<span class="num" id="4022542">2</span><span class="op" id="4022543">,</span>&nbsp;<span class="num" id="4022545">840</span><span class="op" id="4022548">,</span>&nbsp;<span class="num" id="4022550">113549</span><span class="op" id="4022556">,</span>&nbsp;<span class="num" id="4022558">1</span><span class="op" id="4022559">,</span>&nbsp;<span class="num" id="4022561">9</span><span class="op" id="4022562">,</span>&nbsp;<span class="num" id="4022564">14</span><span class="op" id="4022566">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4022569">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4022648">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4022712">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4022790">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4022843">//</span><br>
<span class="lineno"></span><span class="comment" id="4022846">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4022912">//</span><br>
<span class="lineno"></span><span class="comment" id="4022915">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4022983">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4023007">func</span>&nbsp;<span class="ident" id="4023012">CreateCertificateRequest</span><span class="op" id="4023036">(</span><span class="ident" id="4023037">rand</span>&nbsp;<span class="ident" id="4023042">io</span><span class="op" id="4023044">.</span><span class="ident" id="4023045">Reader</span><span class="op" id="4023051">,</span>&nbsp;<span class="ident" id="4023053">template</span>&nbsp;<span class="op" id="4023062">*</span><span class="ident" id="4023063">CertificateRequest</span><span class="op" id="4023081">,</span>&nbsp;<span class="ident" id="4023083">priv</span>&nbsp;<span class="keyword" id="4023088">interface</span><span class="op" id="4023097">{</span><span class="op" id="4023098">}</span><span class="op" id="4023099">)</span>&nbsp;<span class="op" id="4023101">(</span><span class="ident" id="4023102">csr</span>&nbsp;<span class="op" id="4023106">[</span><span class="op" id="4023107">]</span><span class="builtintype" id="4023108">byte</span><span class="op" id="4023112">,</span>&nbsp;<span class="ident" id="4023114">err</span>&nbsp;<span class="builtintype" id="4023118">error</span><span class="op" id="4023123">)</span>&nbsp;<span class="op" id="4023125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023128">hashFunc</span><span class="op" id="4023136">,</span>&nbsp;<span class="ident" id="4023138">sigAlgo</span><span class="op" id="4023145">,</span>&nbsp;<span class="ident" id="4023147">err</span>&nbsp;<span class="op" id="4023151">:=</span>&nbsp;<span class="ident" id="4023154">signingParamsForPrivateKey</span><span class="op" id="4023180">(</span><span class="ident" id="4023181">priv</span><span class="op" id="4023185">,</span>&nbsp;<span class="ident" id="4023187">template</span><span class="op" id="4023195">.</span><span class="ident" id="4023196">SignatureAlgorithm</span><span class="op" id="4023214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023217">if</span>&nbsp;<span class="ident" id="4023220">err</span>&nbsp;<span class="op" id="4023224">!=</span>&nbsp;<span class="ident" id="4023227">nil</span>&nbsp;<span class="op" id="4023231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023235">return</span>&nbsp;<span class="ident" id="4023242">nil</span><span class="op" id="4023245">,</span>&nbsp;<span class="ident" id="4023247">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023252">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023256">var</span>&nbsp;<span class="ident" id="4023260">publicKeyBytes</span>&nbsp;<span class="op" id="4023275">[</span><span class="op" id="4023276">]</span><span class="builtintype" id="4023277">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023283">var</span>&nbsp;<span class="ident" id="4023287">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4023306">pkix</span><span class="op" id="4023310">.</span><span class="ident" id="4023311">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023333">switch</span>&nbsp;<span class="ident" id="4023340">priv</span>&nbsp;<span class="op" id="4023345">:=</span>&nbsp;<span class="ident" id="4023348">priv</span><span class="op" id="4023352">.</span><span class="op" id="4023353">(</span><span class="keyword" id="4023354">type</span><span class="op" id="4023358">)</span>&nbsp;<span class="op" id="4023360">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023363">case</span>&nbsp;<span class="op" id="4023368">*</span><span class="ident" id="4023369">rsa</span><span class="op" id="4023372">.</span><span class="ident" id="4023373">PrivateKey</span><span class="op" id="4023383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023387">publicKeyBytes</span><span class="op" id="4023401">,</span>&nbsp;<span class="ident" id="4023403">publicKeyAlgorithm</span><span class="op" id="4023421">,</span>&nbsp;<span class="ident" id="4023423">err</span>&nbsp;<span class="op" id="4023427">=</span>&nbsp;<span class="ident" id="4023429">marshalPublicKey</span><span class="op" id="4023445">(</span><span class="op" id="4023446">&amp;</span><span class="ident" id="4023447">priv</span><span class="op" id="4023451">.</span><span class="ident" id="4023452">PublicKey</span><span class="op" id="4023461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023464">case</span>&nbsp;<span class="op" id="4023469">*</span><span class="ident" id="4023470">ecdsa</span><span class="op" id="4023475">.</span><span class="ident" id="4023476">PrivateKey</span><span class="op" id="4023486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023490">publicKeyBytes</span><span class="op" id="4023504">,</span>&nbsp;<span class="ident" id="4023506">publicKeyAlgorithm</span><span class="op" id="4023524">,</span>&nbsp;<span class="ident" id="4023526">err</span>&nbsp;<span class="op" id="4023530">=</span>&nbsp;<span class="ident" id="4023532">marshalPublicKey</span><span class="op" id="4023548">(</span><span class="op" id="4023549">&amp;</span><span class="ident" id="4023550">priv</span><span class="op" id="4023554">.</span><span class="ident" id="4023555">PublicKey</span><span class="op" id="4023564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023567">default</span><span class="op" id="4023574">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4023578">panic</span><span class="op" id="4023583">(</span><span class="string" id="4023584">&#34;internal&nbsp;error&#34;</span><span class="op" id="4023600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023607">if</span>&nbsp;<span class="ident" id="4023610">err</span>&nbsp;<span class="op" id="4023614">!=</span>&nbsp;<span class="ident" id="4023617">nil</span>&nbsp;<span class="op" id="4023621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023625">return</span>&nbsp;<span class="ident" id="4023632">nil</span><span class="op" id="4023635">,</span>&nbsp;<span class="ident" id="4023637">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023646">var</span>&nbsp;<span class="ident" id="4023650">extensions</span>&nbsp;<span class="op" id="4023661">[</span><span class="op" id="4023662">]</span><span class="ident" id="4023663">pkix</span><span class="op" id="4023667">.</span><span class="ident" id="4023668">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023680">if</span>&nbsp;<span class="op" id="4023683">(</span><span class="builtinfunc" id="4023684">len</span><span class="op" id="4023687">(</span><span class="ident" id="4023688">template</span><span class="op" id="4023696">.</span><span class="ident" id="4023697">DNSNames</span><span class="op" id="4023705">)</span>&nbsp;<span class="op" id="4023707">&gt;</span>&nbsp;<span class="num" id="4023709">0</span>&nbsp;<span class="op" id="4023711">||</span>&nbsp;<span class="builtinfunc" id="4023714">len</span><span class="op" id="4023717">(</span><span class="ident" id="4023718">template</span><span class="op" id="4023726">.</span><span class="ident" id="4023727">EmailAddresses</span><span class="op" id="4023741">)</span>&nbsp;<span class="op" id="4023743">&gt;</span>&nbsp;<span class="num" id="4023745">0</span>&nbsp;<span class="op" id="4023747">||</span>&nbsp;<span class="builtinfunc" id="4023750">len</span><span class="op" id="4023753">(</span><span class="ident" id="4023754">template</span><span class="op" id="4023762">.</span><span class="ident" id="4023763">IPAddresses</span><span class="op" id="4023774">)</span>&nbsp;<span class="op" id="4023776">&gt;</span>&nbsp;<span class="num" id="4023778">0</span><span class="op" id="4023779">)</span>&nbsp;<span class="op" id="4023781">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023786">!</span><span class="ident" id="4023787">oidInExtensions</span><span class="op" id="4023802">(</span><span class="ident" id="4023803">oidExtensionSubjectAltName</span><span class="op" id="4023829">,</span>&nbsp;<span class="ident" id="4023831">template</span><span class="op" id="4023839">.</span><span class="ident" id="4023840">ExtraExtensions</span><span class="op" id="4023855">)</span>&nbsp;<span class="op" id="4023857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023861">sanBytes</span><span class="op" id="4023869">,</span>&nbsp;<span class="ident" id="4023871">err</span>&nbsp;<span class="op" id="4023875">:=</span>&nbsp;<span class="ident" id="4023878">marshalSANs</span><span class="op" id="4023889">(</span><span class="ident" id="4023890">template</span><span class="op" id="4023898">.</span><span class="ident" id="4023899">DNSNames</span><span class="op" id="4023907">,</span>&nbsp;<span class="ident" id="4023909">template</span><span class="op" id="4023917">.</span><span class="ident" id="4023918">EmailAddresses</span><span class="op" id="4023932">,</span>&nbsp;<span class="ident" id="4023934">template</span><span class="op" id="4023942">.</span><span class="ident" id="4023943">IPAddresses</span><span class="op" id="4023954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023958">if</span>&nbsp;<span class="ident" id="4023961">err</span>&nbsp;<span class="op" id="4023965">!=</span>&nbsp;<span class="ident" id="4023968">nil</span>&nbsp;<span class="op" id="4023972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023977">return</span>&nbsp;<span class="ident" id="4023984">nil</span><span class="op" id="4023987">,</span>&nbsp;<span class="ident" id="4023989">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023995">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024000">extensions</span>&nbsp;<span class="op" id="4024011">=</span>&nbsp;<span class="builtinfunc" id="4024013">append</span><span class="op" id="4024019">(</span><span class="ident" id="4024020">extensions</span><span class="op" id="4024030">,</span>&nbsp;<span class="ident" id="4024032">pkix</span><span class="op" id="4024036">.</span><span class="ident" id="4024037">Extension</span><span class="op" id="4024046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024051">Id</span><span class="op" id="4024053">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4024058">oidExtensionSubjectAltName</span><span class="op" id="4024084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024089">Value</span><span class="op" id="4024094">:</span>&nbsp;<span class="ident" id="4024096">sanBytes</span><span class="op" id="4024104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024108">}</span><span class="op" id="4024109">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024116">extensions</span>&nbsp;<span class="op" id="4024127">=</span>&nbsp;<span class="builtinfunc" id="4024129">append</span><span class="op" id="4024135">(</span><span class="ident" id="4024136">extensions</span><span class="op" id="4024146">,</span>&nbsp;<span class="ident" id="4024148">template</span><span class="op" id="4024156">.</span><span class="ident" id="4024157">ExtraExtensions</span><span class="op" id="4024172">...</span><span class="op" id="4024175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024179">var</span>&nbsp;<span class="ident" id="4024183">attributes</span>&nbsp;<span class="op" id="4024194">[</span><span class="op" id="4024195">]</span><span class="ident" id="4024196">pkix</span><span class="op" id="4024200">.</span><span class="ident" id="4024201">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024227">attributes</span>&nbsp;<span class="op" id="4024238">=</span>&nbsp;<span class="builtinfunc" id="4024240">append</span><span class="op" id="4024246">(</span><span class="ident" id="4024247">attributes</span><span class="op" id="4024257">,</span>&nbsp;<span class="ident" id="4024259">template</span><span class="op" id="4024267">.</span><span class="ident" id="4024268">Attributes</span><span class="op" id="4024278">...</span><span class="op" id="4024281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024285">if</span>&nbsp;<span class="builtinfunc" id="4024288">len</span><span class="op" id="4024291">(</span><span class="ident" id="4024292">extensions</span><span class="op" id="4024302">)</span>&nbsp;<span class="op" id="4024304">&gt;</span>&nbsp;<span class="num" id="4024306">0</span>&nbsp;<span class="op" id="4024308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024312">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024373">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024419">specifiedExtensions</span>&nbsp;<span class="op" id="4024439">:=</span>&nbsp;<span class="builtinfunc" id="4024442">make</span><span class="op" id="4024446">(</span><span class="keyword" id="4024447">map</span><span class="op" id="4024450">[</span><span class="builtintype" id="4024451">string</span><span class="op" id="4024457">]</span><span class="builtintype" id="4024458">bool</span><span class="op" id="4024462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024467">for</span>&nbsp;<span class="ident" id="4024471">_</span><span class="op" id="4024472">,</span>&nbsp;<span class="ident" id="4024474">atvSet</span>&nbsp;<span class="op" id="4024481">:=</span>&nbsp;<span class="keyword" id="4024484">range</span>&nbsp;<span class="ident" id="4024490">template</span><span class="op" id="4024498">.</span><span class="ident" id="4024499">Attributes</span>&nbsp;<span class="op" id="4024510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024515">if</span>&nbsp;<span class="op" id="4024518">!</span><span class="ident" id="4024519">atvSet</span><span class="op" id="4024525">.</span><span class="ident" id="4024526">Type</span><span class="op" id="4024530">.</span><span class="ident" id="4024531">Equal</span><span class="op" id="4024536">(</span><span class="ident" id="4024537">oidExtensionRequest</span><span class="op" id="4024556">)</span>&nbsp;<span class="op" id="4024558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024564">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024582">for</span>&nbsp;<span class="ident" id="4024586">_</span><span class="op" id="4024587">,</span>&nbsp;<span class="ident" id="4024589">atvs</span>&nbsp;<span class="op" id="4024594">:=</span>&nbsp;<span class="keyword" id="4024597">range</span>&nbsp;<span class="ident" id="4024603">atvSet</span><span class="op" id="4024609">.</span><span class="ident" id="4024610">Value</span>&nbsp;<span class="op" id="4024616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024622">for</span>&nbsp;<span class="ident" id="4024626">_</span><span class="op" id="4024627">,</span>&nbsp;<span class="ident" id="4024629">atv</span>&nbsp;<span class="op" id="4024633">:=</span>&nbsp;<span class="keyword" id="4024636">range</span>&nbsp;<span class="ident" id="4024642">atvs</span>&nbsp;<span class="op" id="4024647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024654">specifiedExtensions</span><span class="op" id="4024673">[</span><span class="ident" id="4024674">atv</span><span class="op" id="4024677">.</span><span class="ident" id="4024678">Type</span><span class="op" id="4024682">.</span><span class="ident" id="4024683">String</span><span class="op" id="4024689">(</span><span class="op" id="4024690">)</span><span class="op" id="4024691">]</span>&nbsp;<span class="op" id="4024693">=</span>&nbsp;<span class="builtintype" id="4024695">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024718">atvs</span>&nbsp;<span class="op" id="4024723">:=</span>&nbsp;<span class="builtinfunc" id="4024726">make</span><span class="op" id="4024730">(</span><span class="op" id="4024731">[</span><span class="op" id="4024732">]</span><span class="ident" id="4024733">pkix</span><span class="op" id="4024737">.</span><span class="ident" id="4024738">AttributeTypeAndValue</span><span class="op" id="4024759">,</span>&nbsp;<span class="num" id="4024761">0</span><span class="op" id="4024762">,</span>&nbsp;<span class="builtinfunc" id="4024764">len</span><span class="op" id="4024767">(</span><span class="ident" id="4024768">extensions</span><span class="op" id="4024778">)</span><span class="op" id="4024779">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024783">for</span>&nbsp;<span class="ident" id="4024787">_</span><span class="op" id="4024788">,</span>&nbsp;<span class="ident" id="4024790">e</span>&nbsp;<span class="op" id="4024792">:=</span>&nbsp;<span class="keyword" id="4024795">range</span>&nbsp;<span class="ident" id="4024801">extensions</span>&nbsp;<span class="op" id="4024812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024817">if</span>&nbsp;<span class="ident" id="4024820">specifiedExtensions</span><span class="op" id="4024839">[</span><span class="ident" id="4024840">e</span><span class="op" id="4024841">.</span><span class="ident" id="4024842">Id</span><span class="op" id="4024844">.</span><span class="ident" id="4024845">String</span><span class="op" id="4024851">(</span><span class="op" id="4024852">)</span><span class="op" id="4024853">]</span>&nbsp;<span class="op" id="4024855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024861">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024909">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024954">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024972">atvs</span>&nbsp;<span class="op" id="4024977">=</span>&nbsp;<span class="builtinfunc" id="4024979">append</span><span class="op" id="4024985">(</span><span class="ident" id="4024986">atvs</span><span class="op" id="4024990">,</span>&nbsp;<span class="ident" id="4024992">pkix</span><span class="op" id="4024996">.</span><span class="ident" id="4024997">AttributeTypeAndValue</span><span class="op" id="4025018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025024">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025081">Type</span><span class="op" id="4025085">:</span>&nbsp;&nbsp;<span class="ident" id="4025088">e</span><span class="op" id="4025089">.</span><span class="ident" id="4025090">Id</span><span class="op" id="4025092">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025098">Value</span><span class="op" id="4025103">:</span>&nbsp;<span class="ident" id="4025105">e</span><span class="op" id="4025106">.</span><span class="ident" id="4025107">Value</span><span class="op" id="4025112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025117">}</span><span class="op" id="4025118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025127">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025192">appended</span>&nbsp;<span class="op" id="4025201">:=</span>&nbsp;<span class="builtintype" id="4025204">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025212">for</span>&nbsp;<span class="ident" id="4025216">_</span><span class="op" id="4025217">,</span>&nbsp;<span class="ident" id="4025219">atvSet</span>&nbsp;<span class="op" id="4025226">:=</span>&nbsp;<span class="keyword" id="4025229">range</span>&nbsp;<span class="ident" id="4025235">attributes</span>&nbsp;<span class="op" id="4025246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025251">if</span>&nbsp;<span class="op" id="4025254">!</span><span class="ident" id="4025255">atvSet</span><span class="op" id="4025261">.</span><span class="ident" id="4025262">Type</span><span class="op" id="4025266">.</span><span class="ident" id="4025267">Equal</span><span class="op" id="4025272">(</span><span class="ident" id="4025273">oidExtensionRequest</span><span class="op" id="4025292">)</span>&nbsp;<span class="op" id="4025294">||</span>&nbsp;<span class="builtinfunc" id="4025297">len</span><span class="op" id="4025300">(</span><span class="ident" id="4025301">atvSet</span><span class="op" id="4025307">.</span><span class="ident" id="4025308">Value</span><span class="op" id="4025313">)</span>&nbsp;<span class="op" id="4025315">==</span>&nbsp;<span class="num" id="4025318">0</span>&nbsp;<span class="op" id="4025320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025326">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025338">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025344">atvSet</span><span class="op" id="4025350">.</span><span class="ident" id="4025351">Value</span><span class="op" id="4025356">[</span><span class="num" id="4025357">0</span><span class="op" id="4025358">]</span>&nbsp;<span class="op" id="4025360">=</span>&nbsp;<span class="builtinfunc" id="4025362">append</span><span class="op" id="4025368">(</span><span class="ident" id="4025369">atvSet</span><span class="op" id="4025375">.</span><span class="ident" id="4025376">Value</span><span class="op" id="4025381">[</span><span class="num" id="4025382">0</span><span class="op" id="4025383">]</span><span class="op" id="4025384">,</span>&nbsp;<span class="ident" id="4025386">atvs</span><span class="op" id="4025390">...</span><span class="op" id="4025393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025398">appended</span>&nbsp;<span class="op" id="4025407">=</span>&nbsp;<span class="builtintype" id="4025409">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025417">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025425">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025430">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025486">if</span>&nbsp;<span class="op" id="4025489">!</span><span class="ident" id="4025490">appended</span>&nbsp;<span class="op" id="4025499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025504">attributes</span>&nbsp;<span class="op" id="4025515">=</span>&nbsp;<span class="builtinfunc" id="4025517">append</span><span class="op" id="4025523">(</span><span class="ident" id="4025524">attributes</span><span class="op" id="4025534">,</span>&nbsp;<span class="ident" id="4025536">pkix</span><span class="op" id="4025540">.</span><span class="ident" id="4025541">AttributeTypeAndValueSET</span><span class="op" id="4025565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025571">Type</span><span class="op" id="4025575">:</span>&nbsp;<span class="ident" id="4025577">oidExtensionRequest</span><span class="op" id="4025596">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025602">Value</span><span class="op" id="4025607">:</span>&nbsp;<span class="op" id="4025609">[</span><span class="op" id="4025610">]</span><span class="op" id="4025611">[</span><span class="op" id="4025612">]</span><span class="ident" id="4025613">pkix</span><span class="op" id="4025617">.</span><span class="ident" id="4025618">AttributeTypeAndValue</span><span class="op" id="4025639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025646">atvs</span><span class="op" id="4025650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025656">}</span><span class="op" id="4025657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025662">}</span><span class="op" id="4025663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025667">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025674">asn1Subject</span>&nbsp;<span class="op" id="4025686">:=</span>&nbsp;<span class="ident" id="4025689">template</span><span class="op" id="4025697">.</span><span class="ident" id="4025698">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025710">if</span>&nbsp;<span class="builtinfunc" id="4025713">len</span><span class="op" id="4025716">(</span><span class="ident" id="4025717">asn1Subject</span><span class="op" id="4025728">)</span>&nbsp;<span class="op" id="4025730">==</span>&nbsp;<span class="num" id="4025733">0</span>&nbsp;<span class="op" id="4025735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025739">asn1Subject</span><span class="op" id="4025750">,</span>&nbsp;<span class="ident" id="4025752">err</span>&nbsp;<span class="op" id="4025756">=</span>&nbsp;<span class="ident" id="4025758">asn1</span><span class="op" id="4025762">.</span><span class="ident" id="4025763">Marshal</span><span class="op" id="4025770">(</span><span class="ident" id="4025771">template</span><span class="op" id="4025779">.</span><span class="ident" id="4025780">Subject</span><span class="op" id="4025787">.</span><span class="ident" id="4025788">ToRDNSequence</span><span class="op" id="4025801">(</span><span class="op" id="4025802">)</span><span class="op" id="4025803">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025807">if</span>&nbsp;<span class="ident" id="4025810">err</span>&nbsp;<span class="op" id="4025814">!=</span>&nbsp;<span class="ident" id="4025817">nil</span>&nbsp;<span class="op" id="4025821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025826">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025842">tbsCSR</span>&nbsp;<span class="op" id="4025849">:=</span>&nbsp;<span class="ident" id="4025852">tbsCertificateRequest</span><span class="op" id="4025873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025877">Version</span><span class="op" id="4025884">:</span>&nbsp;<span class="num" id="4025886">0</span><span class="op" id="4025887">,</span>&nbsp;<span class="comment" id="4025889">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025913">Subject</span><span class="op" id="4025920">:</span>&nbsp;<span class="ident" id="4025922">asn1</span><span class="op" id="4025926">.</span><span class="ident" id="4025927">RawValue</span><span class="op" id="4025935">{</span><span class="ident" id="4025936">FullBytes</span><span class="op" id="4025945">:</span>&nbsp;<span class="ident" id="4025947">asn1Subject</span><span class="op" id="4025958">}</span><span class="op" id="4025959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025963">PublicKey</span><span class="op" id="4025972">:</span>&nbsp;<span class="ident" id="4025974">publicKeyInfo</span><span class="op" id="4025987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025992">Algorithm</span><span class="op" id="4026001">:</span>&nbsp;<span class="ident" id="4026003">publicKeyAlgorithm</span><span class="op" id="4026021">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026026">PublicKey</span><span class="op" id="4026035">:</span>&nbsp;<span class="ident" id="4026037">asn1</span><span class="op" id="4026041">.</span><span class="ident" id="4026042">BitString</span><span class="op" id="4026051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026057">Bytes</span><span class="op" id="4026062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4026068">publicKeyBytes</span><span class="op" id="4026082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026088">BitLength</span><span class="op" id="4026097">:</span>&nbsp;<span class="builtinfunc" id="4026099">len</span><span class="op" id="4026102">(</span><span class="ident" id="4026103">publicKeyBytes</span><span class="op" id="4026117">)</span>&nbsp;<span class="op" id="4026119">*</span>&nbsp;<span class="num" id="4026121">8</span><span class="op" id="4026122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026127">}</span><span class="op" id="4026128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026132">}</span><span class="op" id="4026133">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026137">Attributes</span><span class="op" id="4026147">:</span>&nbsp;<span class="ident" id="4026149">attributes</span><span class="op" id="4026159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026166">tbsCSRContents</span><span class="op" id="4026180">,</span>&nbsp;<span class="ident" id="4026182">err</span>&nbsp;<span class="op" id="4026186">:=</span>&nbsp;<span class="ident" id="4026189">asn1</span><span class="op" id="4026193">.</span><span class="ident" id="4026194">Marshal</span><span class="op" id="4026201">(</span><span class="ident" id="4026202">tbsCSR</span><span class="op" id="4026208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026211">if</span>&nbsp;<span class="ident" id="4026214">err</span>&nbsp;<span class="op" id="4026218">!=</span>&nbsp;<span class="ident" id="4026221">nil</span>&nbsp;<span class="op" id="4026225">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026229">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026240">tbsCSR</span><span class="op" id="4026246">.</span><span class="ident" id="4026247">Raw</span>&nbsp;<span class="op" id="4026251">=</span>&nbsp;<span class="ident" id="4026253">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026270">h</span>&nbsp;<span class="op" id="4026272">:=</span>&nbsp;<span class="ident" id="4026275">hashFunc</span><span class="op" id="4026283">.</span><span class="ident" id="4026284">New</span><span class="op" id="4026287">(</span><span class="op" id="4026288">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026291">h</span><span class="op" id="4026292">.</span><span class="ident" id="4026293">Write</span><span class="op" id="4026298">(</span><span class="ident" id="4026299">tbsCSRContents</span><span class="op" id="4026313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026316">digest</span>&nbsp;<span class="op" id="4026323">:=</span>&nbsp;<span class="ident" id="4026326">h</span><span class="op" id="4026327">.</span><span class="ident" id="4026328">Sum</span><span class="op" id="4026331">(</span><span class="ident" id="4026332">nil</span><span class="op" id="4026335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026339">var</span>&nbsp;<span class="ident" id="4026343">signature</span>&nbsp;<span class="op" id="4026353">[</span><span class="op" id="4026354">]</span><span class="builtintype" id="4026355">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026361">switch</span>&nbsp;<span class="ident" id="4026368">priv</span>&nbsp;<span class="op" id="4026373">:=</span>&nbsp;<span class="ident" id="4026376">priv</span><span class="op" id="4026380">.</span><span class="op" id="4026381">(</span><span class="keyword" id="4026382">type</span><span class="op" id="4026386">)</span>&nbsp;<span class="op" id="4026388">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026391">case</span>&nbsp;<span class="op" id="4026396">*</span><span class="ident" id="4026397">rsa</span><span class="op" id="4026400">.</span><span class="ident" id="4026401">PrivateKey</span><span class="op" id="4026411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026415">signature</span><span class="op" id="4026424">,</span>&nbsp;<span class="ident" id="4026426">err</span>&nbsp;<span class="op" id="4026430">=</span>&nbsp;<span class="ident" id="4026432">rsa</span><span class="op" id="4026435">.</span><span class="ident" id="4026436">SignPKCS1v15</span><span class="op" id="4026448">(</span><span class="ident" id="4026449">rand</span><span class="op" id="4026453">,</span>&nbsp;<span class="ident" id="4026455">priv</span><span class="op" id="4026459">,</span>&nbsp;<span class="ident" id="4026461">hashFunc</span><span class="op" id="4026469">,</span>&nbsp;<span class="ident" id="4026471">digest</span><span class="op" id="4026477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026480">case</span>&nbsp;<span class="op" id="4026485">*</span><span class="ident" id="4026486">ecdsa</span><span class="op" id="4026491">.</span><span class="ident" id="4026492">PrivateKey</span><span class="op" id="4026502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026506">var</span>&nbsp;<span class="ident" id="4026510">r</span><span class="op" id="4026511">,</span>&nbsp;<span class="ident" id="4026513">s</span>&nbsp;<span class="op" id="4026515">*</span><span class="ident" id="4026516">big</span><span class="op" id="4026519">.</span><span class="ident" id="4026520">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026526">if</span>&nbsp;<span class="ident" id="4026529">r</span><span class="op" id="4026530">,</span>&nbsp;<span class="ident" id="4026532">s</span><span class="op" id="4026533">,</span>&nbsp;<span class="ident" id="4026535">err</span>&nbsp;<span class="op" id="4026539">=</span>&nbsp;<span class="ident" id="4026541">ecdsa</span><span class="op" id="4026546">.</span><span class="ident" id="4026547">Sign</span><span class="op" id="4026551">(</span><span class="ident" id="4026552">rand</span><span class="op" id="4026556">,</span>&nbsp;<span class="ident" id="4026558">priv</span><span class="op" id="4026562">,</span>&nbsp;<span class="ident" id="4026564">digest</span><span class="op" id="4026570">)</span><span class="op" id="4026571">;</span>&nbsp;<span class="ident" id="4026573">err</span>&nbsp;<span class="op" id="4026577">==</span>&nbsp;<span class="ident" id="4026580">nil</span>&nbsp;<span class="op" id="4026584">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026589">signature</span><span class="op" id="4026598">,</span>&nbsp;<span class="ident" id="4026600">err</span>&nbsp;<span class="op" id="4026604">=</span>&nbsp;<span class="ident" id="4026606">asn1</span><span class="op" id="4026610">.</span><span class="ident" id="4026611">Marshal</span><span class="op" id="4026618">(</span><span class="ident" id="4026619">ecdsaSignature</span><span class="op" id="4026633">{</span><span class="ident" id="4026634">r</span><span class="op" id="4026635">,</span>&nbsp;<span class="ident" id="4026637">s</span><span class="op" id="4026638">}</span><span class="op" id="4026639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026646">default</span><span class="op" id="4026653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4026657">panic</span><span class="op" id="4026662">(</span><span class="string" id="4026663">&#34;internal&nbsp;error&#34;</span><span class="op" id="4026679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026682">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026686">if</span>&nbsp;<span class="ident" id="4026689">err</span>&nbsp;<span class="op" id="4026693">!=</span>&nbsp;<span class="ident" id="4026696">nil</span>&nbsp;<span class="op" id="4026700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026704">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026716">return</span>&nbsp;<span class="ident" id="4026723">asn1</span><span class="op" id="4026727">.</span><span class="ident" id="4026728">Marshal</span><span class="op" id="4026735">(</span><span class="ident" id="4026736">certificateRequest</span><span class="op" id="4026754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026758">TBSCSR</span><span class="op" id="4026764">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4026778">tbsCSR</span><span class="op" id="4026784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026788">SignatureAlgorithm</span><span class="op" id="4026806">:</span>&nbsp;<span class="ident" id="4026808">sigAlgo</span><span class="op" id="4026815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026819">SignatureValue</span><span class="op" id="4026833">:</span>&nbsp;<span class="ident" id="4026835">asn1</span><span class="op" id="4026839">.</span><span class="ident" id="4026840">BitString</span><span class="op" id="4026849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026854">Bytes</span><span class="op" id="4026859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4026865">signature</span><span class="op" id="4026874">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026879">BitLength</span><span class="op" id="4026888">:</span>&nbsp;<span class="builtinfunc" id="4026890">len</span><span class="op" id="4026893">(</span><span class="ident" id="4026894">signature</span><span class="op" id="4026903">)</span>&nbsp;<span class="op" id="4026905">*</span>&nbsp;<span class="num" id="4026907">8</span><span class="op" id="4026908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026912">}</span><span class="op" id="4026913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026916">}</span><span class="op" id="4026917">)</span><br>
<span class="lineno"></span><span class="op" id="4026919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4026922">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4026994">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4027019">func</span>&nbsp;<span class="ident" id="4027024">ParseCertificateRequest</span><span class="op" id="4027047">(</span><span class="ident" id="4027048">asn1Data</span>&nbsp;<span class="op" id="4027057">[</span><span class="op" id="4027058">]</span><span class="builtintype" id="4027059">byte</span><span class="op" id="4027063">)</span>&nbsp;<span class="op" id="4027065">(</span><span class="op" id="4027066">*</span><span class="ident" id="4027067">CertificateRequest</span><span class="op" id="4027085">,</span>&nbsp;<span class="builtintype" id="4027087">error</span><span class="op" id="4027092">)</span>&nbsp;<span class="op" id="4027094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027097">var</span>&nbsp;<span class="ident" id="4027101">csr</span>&nbsp;<span class="ident" id="4027105">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027126">rest</span><span class="op" id="4027130">,</span>&nbsp;<span class="ident" id="4027132">err</span>&nbsp;<span class="op" id="4027136">:=</span>&nbsp;<span class="ident" id="4027139">asn1</span><span class="op" id="4027143">.</span><span class="ident" id="4027144">Unmarshal</span><span class="op" id="4027153">(</span><span class="ident" id="4027154">asn1Data</span><span class="op" id="4027162">,</span>&nbsp;<span class="op" id="4027164">&amp;</span><span class="ident" id="4027165">csr</span><span class="op" id="4027168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027171">if</span>&nbsp;<span class="ident" id="4027174">err</span>&nbsp;<span class="op" id="4027178">!=</span>&nbsp;<span class="ident" id="4027181">nil</span>&nbsp;<span class="op" id="4027185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027189">return</span>&nbsp;<span class="ident" id="4027196">nil</span><span class="op" id="4027199">,</span>&nbsp;<span class="ident" id="4027201">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027206">}</span>&nbsp;<span class="keyword" id="4027208">else</span>&nbsp;<span class="keyword" id="4027213">if</span>&nbsp;<span class="builtinfunc" id="4027216">len</span><span class="op" id="4027219">(</span><span class="ident" id="4027220">rest</span><span class="op" id="4027224">)</span>&nbsp;<span class="op" id="4027226">!=</span>&nbsp;<span class="num" id="4027229">0</span>&nbsp;<span class="op" id="4027231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027235">return</span>&nbsp;<span class="ident" id="4027242">nil</span><span class="op" id="4027245">,</span>&nbsp;<span class="ident" id="4027247">asn1</span><span class="op" id="4027251">.</span><span class="ident" id="4027252">SyntaxError</span><span class="op" id="4027263">{</span><span class="ident" id="4027264">Msg</span><span class="op" id="4027267">:</span>&nbsp;<span class="string" id="4027269">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4027284">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027291">return</span>&nbsp;<span class="ident" id="4027298">parseCertificateRequest</span><span class="op" id="4027321">(</span><span class="op" id="4027322">&amp;</span><span class="ident" id="4027323">csr</span><span class="op" id="4027326">)</span><br>
<span class="lineno"></span><span class="op" id="4027328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4027331">func</span>&nbsp;<span class="ident" id="4027336">parseCertificateRequest</span><span class="op" id="4027359">(</span><span class="ident" id="4027360">in</span>&nbsp;<span class="op" id="4027363">*</span><span class="ident" id="4027364">certificateRequest</span><span class="op" id="4027382">)</span>&nbsp;<span class="op" id="4027384">(</span><span class="op" id="4027385">*</span><span class="ident" id="4027386">CertificateRequest</span><span class="op" id="4027404">,</span>&nbsp;<span class="builtintype" id="4027406">error</span><span class="op" id="4027411">)</span>&nbsp;<span class="op" id="4027413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027416">out</span>&nbsp;<span class="op" id="4027420">:=</span>&nbsp;<span class="op" id="4027423">&amp;</span><span class="ident" id="4027424">CertificateRequest</span><span class="op" id="4027442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027446">Raw</span><span class="op" id="4027449">:</span>&nbsp;<span class="ident" id="4027451">in</span><span class="op" id="4027453">.</span><span class="ident" id="4027454">Raw</span><span class="op" id="4027457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027461">RawTBSCertificateRequest</span><span class="op" id="4027485">:</span>&nbsp;<span class="ident" id="4027487">in</span><span class="op" id="4027489">.</span><span class="ident" id="4027490">TBSCSR</span><span class="op" id="4027496">.</span><span class="ident" id="4027497">Raw</span><span class="op" id="4027500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027504">RawSubjectPublicKeyInfo</span><span class="op" id="4027527">:</span>&nbsp;&nbsp;<span class="ident" id="4027530">in</span><span class="op" id="4027532">.</span><span class="ident" id="4027533">TBSCSR</span><span class="op" id="4027539">.</span><span class="ident" id="4027540">PublicKey</span><span class="op" id="4027549">.</span><span class="ident" id="4027550">Raw</span><span class="op" id="4027553">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027557">RawSubject</span><span class="op" id="4027567">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4027583">in</span><span class="op" id="4027585">.</span><span class="ident" id="4027586">TBSCSR</span><span class="op" id="4027592">.</span><span class="ident" id="4027593">Subject</span><span class="op" id="4027600">.</span><span class="ident" id="4027601">FullBytes</span><span class="op" id="4027610">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027615">Signature</span><span class="op" id="4027624">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4027635">in</span><span class="op" id="4027637">.</span><span class="ident" id="4027638">SignatureValue</span><span class="op" id="4027652">.</span><span class="ident" id="4027653">RightAlign</span><span class="op" id="4027663">(</span><span class="op" id="4027664">)</span><span class="op" id="4027665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027669">SignatureAlgorithm</span><span class="op" id="4027687">:</span>&nbsp;<span class="ident" id="4027689">getSignatureAlgorithmFromOID</span><span class="op" id="4027717">(</span><span class="ident" id="4027718">in</span><span class="op" id="4027720">.</span><span class="ident" id="4027721">SignatureAlgorithm</span><span class="op" id="4027739">.</span><span class="ident" id="4027740">Algorithm</span><span class="op" id="4027749">)</span><span class="op" id="4027750">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027755">PublicKeyAlgorithm</span><span class="op" id="4027773">:</span>&nbsp;<span class="ident" id="4027775">getPublicKeyAlgorithmFromOID</span><span class="op" id="4027803">(</span><span class="ident" id="4027804">in</span><span class="op" id="4027806">.</span><span class="ident" id="4027807">TBSCSR</span><span class="op" id="4027813">.</span><span class="ident" id="4027814">PublicKey</span><span class="op" id="4027823">.</span><span class="ident" id="4027824">Algorithm</span><span class="op" id="4027833">.</span><span class="ident" id="4027834">Algorithm</span><span class="op" id="4027843">)</span><span class="op" id="4027844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027849">Version</span><span class="op" id="4027856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4027861">in</span><span class="op" id="4027863">.</span><span class="ident" id="4027864">TBSCSR</span><span class="op" id="4027870">.</span><span class="ident" id="4027871">Version</span><span class="op" id="4027878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027882">Attributes</span><span class="op" id="4027892">:</span>&nbsp;<span class="ident" id="4027894">in</span><span class="op" id="4027896">.</span><span class="ident" id="4027897">TBSCSR</span><span class="op" id="4027903">.</span><span class="ident" id="4027904">Attributes</span><span class="op" id="4027914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027917">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027921">var</span>&nbsp;<span class="ident" id="4027925">err</span>&nbsp;<span class="builtintype" id="4027929">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027936">out</span><span class="op" id="4027939">.</span><span class="ident" id="4027940">PublicKey</span><span class="op" id="4027949">,</span>&nbsp;<span class="ident" id="4027951">err</span>&nbsp;<span class="op" id="4027955">=</span>&nbsp;<span class="ident" id="4027957">parsePublicKey</span><span class="op" id="4027971">(</span><span class="ident" id="4027972">out</span><span class="op" id="4027975">.</span><span class="ident" id="4027976">PublicKeyAlgorithm</span><span class="op" id="4027994">,</span>&nbsp;<span class="op" id="4027996">&amp;</span><span class="ident" id="4027997">in</span><span class="op" id="4027999">.</span><span class="ident" id="4028000">TBSCSR</span><span class="op" id="4028006">.</span><span class="ident" id="4028007">PublicKey</span><span class="op" id="4028016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028019">if</span>&nbsp;<span class="ident" id="4028022">err</span>&nbsp;<span class="op" id="4028026">!=</span>&nbsp;<span class="ident" id="4028029">nil</span>&nbsp;<span class="op" id="4028033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028037">return</span>&nbsp;<span class="ident" id="4028044">nil</span><span class="op" id="4028047">,</span>&nbsp;<span class="ident" id="4028049">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028058">var</span>&nbsp;<span class="ident" id="4028062">subject</span>&nbsp;<span class="ident" id="4028070">pkix</span><span class="op" id="4028074">.</span><span class="ident" id="4028075">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028088">if</span>&nbsp;<span class="ident" id="4028091">_</span><span class="op" id="4028092">,</span>&nbsp;<span class="ident" id="4028094">err</span>&nbsp;<span class="op" id="4028098">:=</span>&nbsp;<span class="ident" id="4028101">asn1</span><span class="op" id="4028105">.</span><span class="ident" id="4028106">Unmarshal</span><span class="op" id="4028115">(</span><span class="ident" id="4028116">in</span><span class="op" id="4028118">.</span><span class="ident" id="4028119">TBSCSR</span><span class="op" id="4028125">.</span><span class="ident" id="4028126">Subject</span><span class="op" id="4028133">.</span><span class="ident" id="4028134">FullBytes</span><span class="op" id="4028143">,</span>&nbsp;<span class="op" id="4028145">&amp;</span><span class="ident" id="4028146">subject</span><span class="op" id="4028153">)</span><span class="op" id="4028154">;</span>&nbsp;<span class="ident" id="4028156">err</span>&nbsp;<span class="op" id="4028160">!=</span>&nbsp;<span class="ident" id="4028163">nil</span>&nbsp;<span class="op" id="4028167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028171">return</span>&nbsp;<span class="ident" id="4028178">nil</span><span class="op" id="4028181">,</span>&nbsp;<span class="ident" id="4028183">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028192">out</span><span class="op" id="4028195">.</span><span class="ident" id="4028196">Subject</span><span class="op" id="4028203">.</span><span class="ident" id="4028204">FillFromRDNSequence</span><span class="op" id="4028223">(</span><span class="op" id="4028224">&amp;</span><span class="ident" id="4028225">subject</span><span class="op" id="4028232">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028236">var</span>&nbsp;<span class="ident" id="4028240">extensions</span>&nbsp;<span class="op" id="4028251">[</span><span class="op" id="4028252">]</span><span class="ident" id="4028253">pkix</span><span class="op" id="4028257">.</span><span class="ident" id="4028258">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028282">for</span>&nbsp;<span class="ident" id="4028286">_</span><span class="op" id="4028287">,</span>&nbsp;<span class="ident" id="4028289">atvSet</span>&nbsp;<span class="op" id="4028296">:=</span>&nbsp;<span class="keyword" id="4028299">range</span>&nbsp;<span class="ident" id="4028305">in</span><span class="op" id="4028307">.</span><span class="ident" id="4028308">TBSCSR</span><span class="op" id="4028314">.</span><span class="ident" id="4028315">Attributes</span>&nbsp;<span class="op" id="4028326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028330">if</span>&nbsp;<span class="op" id="4028333">!</span><span class="ident" id="4028334">atvSet</span><span class="op" id="4028340">.</span><span class="ident" id="4028341">Type</span><span class="op" id="4028345">.</span><span class="ident" id="4028346">Equal</span><span class="op" id="4028351">(</span><span class="ident" id="4028352">oidExtensionRequest</span><span class="op" id="4028371">)</span>&nbsp;<span class="op" id="4028373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028378">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028389">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028394">for</span>&nbsp;<span class="ident" id="4028398">_</span><span class="op" id="4028399">,</span>&nbsp;<span class="ident" id="4028401">atvs</span>&nbsp;<span class="op" id="4028406">:=</span>&nbsp;<span class="keyword" id="4028409">range</span>&nbsp;<span class="ident" id="4028415">atvSet</span><span class="op" id="4028421">.</span><span class="ident" id="4028422">Value</span>&nbsp;<span class="op" id="4028428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028433">extensions</span>&nbsp;<span class="op" id="4028444">=</span>&nbsp;<span class="builtinfunc" id="4028446">append</span><span class="op" id="4028452">(</span><span class="ident" id="4028453">extensions</span><span class="op" id="4028463">,</span>&nbsp;<span class="ident" id="4028465">atvs</span><span class="op" id="4028469">...</span><span class="op" id="4028472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028479">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028483">out</span><span class="op" id="4028486">.</span><span class="ident" id="4028487">Extensions</span>&nbsp;<span class="op" id="4028498">=</span>&nbsp;<span class="builtinfunc" id="4028500">make</span><span class="op" id="4028504">(</span><span class="op" id="4028505">[</span><span class="op" id="4028506">]</span><span class="ident" id="4028507">pkix</span><span class="op" id="4028511">.</span><span class="ident" id="4028512">Extension</span><span class="op" id="4028521">,</span>&nbsp;<span class="num" id="4028523">0</span><span class="op" id="4028524">,</span>&nbsp;<span class="builtinfunc" id="4028526">len</span><span class="op" id="4028529">(</span><span class="ident" id="4028530">extensions</span><span class="op" id="4028540">)</span><span class="op" id="4028541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028545">for</span>&nbsp;<span class="ident" id="4028549">_</span><span class="op" id="4028550">,</span>&nbsp;<span class="ident" id="4028552">e</span>&nbsp;<span class="op" id="4028554">:=</span>&nbsp;<span class="keyword" id="4028557">range</span>&nbsp;<span class="ident" id="4028563">extensions</span>&nbsp;<span class="op" id="4028574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028578">value</span><span class="op" id="4028583">,</span>&nbsp;<span class="ident" id="4028585">ok</span>&nbsp;<span class="op" id="4028588">:=</span>&nbsp;<span class="ident" id="4028591">e</span><span class="op" id="4028592">.</span><span class="ident" id="4028593">Value</span><span class="op" id="4028598">.</span><span class="op" id="4028599">(</span><span class="op" id="4028600">[</span><span class="op" id="4028601">]</span><span class="builtintype" id="4028602">byte</span><span class="op" id="4028606">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028610">if</span>&nbsp;<span class="op" id="4028613">!</span><span class="ident" id="4028614">ok</span>&nbsp;<span class="op" id="4028617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028622">return</span>&nbsp;<span class="ident" id="4028629">nil</span><span class="op" id="4028632">,</span>&nbsp;<span class="ident" id="4028634">errors</span><span class="op" id="4028640">.</span><span class="ident" id="4028641">New</span><span class="op" id="4028644">(</span><span class="string" id="4028645">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4028704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028713">out</span><span class="op" id="4028716">.</span><span class="ident" id="4028717">Extensions</span>&nbsp;<span class="op" id="4028728">=</span>&nbsp;<span class="builtinfunc" id="4028730">append</span><span class="op" id="4028736">(</span><span class="ident" id="4028737">out</span><span class="op" id="4028740">.</span><span class="ident" id="4028741">Extensions</span><span class="op" id="4028751">,</span>&nbsp;<span class="ident" id="4028753">pkix</span><span class="op" id="4028757">.</span><span class="ident" id="4028758">Extension</span><span class="op" id="4028767">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028772">Id</span><span class="op" id="4028774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4028779">e</span><span class="op" id="4028780">.</span><span class="ident" id="4028781">Type</span><span class="op" id="4028785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028790">Value</span><span class="op" id="4028795">:</span>&nbsp;<span class="ident" id="4028797">value</span><span class="op" id="4028802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028806">}</span><span class="op" id="4028807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028812">if</span>&nbsp;<span class="builtinfunc" id="4028815">len</span><span class="op" id="4028818">(</span><span class="ident" id="4028819">e</span><span class="op" id="4028820">.</span><span class="ident" id="4028821">Type</span><span class="op" id="4028825">)</span>&nbsp;<span class="op" id="4028827">==</span>&nbsp;<span class="num" id="4028830">4</span>&nbsp;<span class="op" id="4028832">&amp;&amp;</span>&nbsp;<span class="ident" id="4028835">e</span><span class="op" id="4028836">.</span><span class="ident" id="4028837">Type</span><span class="op" id="4028841">[</span><span class="num" id="4028842">0</span><span class="op" id="4028843">]</span>&nbsp;<span class="op" id="4028845">==</span>&nbsp;<span class="num" id="4028848">2</span>&nbsp;<span class="op" id="4028850">&amp;&amp;</span>&nbsp;<span class="ident" id="4028853">e</span><span class="op" id="4028854">.</span><span class="ident" id="4028855">Type</span><span class="op" id="4028859">[</span><span class="num" id="4028860">1</span><span class="op" id="4028861">]</span>&nbsp;<span class="op" id="4028863">==</span>&nbsp;<span class="num" id="4028866">5</span>&nbsp;<span class="op" id="4028868">&amp;&amp;</span>&nbsp;<span class="ident" id="4028871">e</span><span class="op" id="4028872">.</span><span class="ident" id="4028873">Type</span><span class="op" id="4028877">[</span><span class="num" id="4028878">2</span><span class="op" id="4028879">]</span>&nbsp;<span class="op" id="4028881">==</span>&nbsp;<span class="num" id="4028884">29</span>&nbsp;<span class="op" id="4028887">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028892">switch</span>&nbsp;<span class="ident" id="4028899">e</span><span class="op" id="4028900">.</span><span class="ident" id="4028901">Type</span><span class="op" id="4028905">[</span><span class="num" id="4028906">3</span><span class="op" id="4028907">]</span>&nbsp;<span class="op" id="4028909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028914">case</span>&nbsp;<span class="num" id="4028919">17</span><span class="op" id="4028921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028927">out</span><span class="op" id="4028930">.</span><span class="ident" id="4028931">DNSNames</span><span class="op" id="4028939">,</span>&nbsp;<span class="ident" id="4028941">out</span><span class="op" id="4028944">.</span><span class="ident" id="4028945">EmailAddresses</span><span class="op" id="4028959">,</span>&nbsp;<span class="ident" id="4028961">out</span><span class="op" id="4028964">.</span><span class="ident" id="4028965">IPAddresses</span><span class="op" id="4028976">,</span>&nbsp;<span class="ident" id="4028978">err</span>&nbsp;<span class="op" id="4028982">=</span>&nbsp;<span class="ident" id="4028984">parseSANExtension</span><span class="op" id="4029001">(</span><span class="ident" id="4029002">value</span><span class="op" id="4029007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029013">if</span>&nbsp;<span class="ident" id="4029016">err</span>&nbsp;<span class="op" id="4029020">!=</span>&nbsp;<span class="ident" id="4029023">nil</span>&nbsp;<span class="op" id="4029027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029034">return</span>&nbsp;<span class="ident" id="4029041">nil</span><span class="op" id="4029044">,</span>&nbsp;<span class="ident" id="4029046">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029070">return</span>&nbsp;<span class="ident" id="4029077">out</span><span class="op" id="4029080">,</span>&nbsp;<span class="ident" id="4029082">nil</span><br>
<span class="lineno"></span><span class="op" id="4029086">}</span>
</div>
</body>
</html>
