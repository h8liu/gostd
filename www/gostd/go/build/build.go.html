<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html" class="current">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6123843">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6123899">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6123953">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6124004">package</span>&nbsp;<span class="ident" id="6124012">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6124019">import</span>&nbsp;<span class="op" id="6124026">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124029">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124038">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124048">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124055">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124065">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124075">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124088">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124100">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124106">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124119">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124126">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124132">pathpkg</span>&nbsp;<span class="string" id="6124140">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124148">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124165">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124176">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124184">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124195">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124206">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6124217">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6124232">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6124235">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="6124294">type</span>&nbsp;<span class="ident" id="6124299">Context</span>&nbsp;<span class="keyword" id="6124307">struct</span>&nbsp;<span class="op" id="6124314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124317">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6124329">string</span>&nbsp;<span class="comment" id="6124336">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124360">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6124372">string</span>&nbsp;<span class="comment" id="6124379">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124407">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6124419">string</span>&nbsp;<span class="comment" id="6124426">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124438">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6124450">string</span>&nbsp;<span class="comment" id="6124457">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124469">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="6124481">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6124488">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124516">UseAllFiles</span>&nbsp;<span class="builtintype" id="6124528">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6124535">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124588">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6124600">string</span>&nbsp;<span class="comment" id="6124607">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124659">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124716">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124786">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124852">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124928">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125014">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125082">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125144">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6125156">[</span><span class="op" id="6125157">]</span><span class="builtintype" id="6125158">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125166">ReleaseTags</span>&nbsp;<span class="op" id="6125178">[</span><span class="op" id="6125179">]</span><span class="builtintype" id="6125180">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125189">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125270">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125345">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125422">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125498">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125572">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125627">InstallSuffix</span>&nbsp;<span class="builtintype" id="6125641">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125650">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125719">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125783">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125851">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125922">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6125978">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126048">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126099">JoinPath</span>&nbsp;<span class="keyword" id="6126108">func</span><span class="op" id="6126112">(</span><span class="ident" id="6126113">elem</span>&nbsp;<span class="op" id="6126118">...</span><span class="builtintype" id="6126121">string</span><span class="op" id="6126127">)</span>&nbsp;<span class="builtintype" id="6126129">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126138">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126211">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126272">SplitPathList</span>&nbsp;<span class="keyword" id="6126286">func</span><span class="op" id="6126290">(</span><span class="ident" id="6126291">list</span>&nbsp;<span class="builtintype" id="6126296">string</span><span class="op" id="6126302">)</span>&nbsp;<span class="op" id="6126304">[</span><span class="op" id="6126305">]</span><span class="builtintype" id="6126306">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126315">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126371">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126424">IsAbsPath</span>&nbsp;<span class="keyword" id="6126434">func</span><span class="op" id="6126438">(</span><span class="ident" id="6126439">path</span>&nbsp;<span class="builtintype" id="6126444">string</span><span class="op" id="6126450">)</span>&nbsp;<span class="builtintype" id="6126452">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126459">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126513">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126591">IsDir</span>&nbsp;<span class="keyword" id="6126597">func</span><span class="op" id="6126601">(</span><span class="ident" id="6126602">path</span>&nbsp;<span class="builtintype" id="6126607">string</span><span class="op" id="6126613">)</span>&nbsp;<span class="builtintype" id="6126615">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126622">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126677">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126719">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126780">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126843">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126907">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126934">HasSubdir</span>&nbsp;<span class="keyword" id="6126944">func</span><span class="op" id="6126948">(</span><span class="ident" id="6126949">root</span><span class="op" id="6126953">,</span>&nbsp;<span class="ident" id="6126955">dir</span>&nbsp;<span class="builtintype" id="6126959">string</span><span class="op" id="6126965">)</span>&nbsp;<span class="op" id="6126967">(</span><span class="ident" id="6126968">rel</span>&nbsp;<span class="builtintype" id="6126972">string</span><span class="op" id="6126978">,</span>&nbsp;<span class="ident" id="6126980">ok</span>&nbsp;<span class="builtintype" id="6126983">bool</span><span class="op" id="6126987">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6126991">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6127051">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6127102">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127153">ReadDir</span>&nbsp;<span class="keyword" id="6127161">func</span><span class="op" id="6127165">(</span><span class="ident" id="6127166">dir</span>&nbsp;<span class="builtintype" id="6127170">string</span><span class="op" id="6127176">)</span>&nbsp;<span class="op" id="6127178">(</span><span class="ident" id="6127179">fi</span>&nbsp;<span class="op" id="6127182">[</span><span class="op" id="6127183">]</span><span class="ident" id="6127184">os</span><span class="op" id="6127186">.</span><span class="ident" id="6127187">FileInfo</span><span class="op" id="6127195">,</span>&nbsp;<span class="ident" id="6127197">err</span>&nbsp;<span class="builtintype" id="6127201">error</span><span class="op" id="6127206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6127210">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6127267">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127312">OpenFile</span>&nbsp;<span class="keyword" id="6127321">func</span><span class="op" id="6127325">(</span><span class="ident" id="6127326">path</span>&nbsp;<span class="builtintype" id="6127331">string</span><span class="op" id="6127337">)</span>&nbsp;<span class="op" id="6127339">(</span><span class="ident" id="6127340">r</span>&nbsp;<span class="ident" id="6127342">io</span><span class="op" id="6127344">.</span><span class="ident" id="6127345">ReadCloser</span><span class="op" id="6127355">,</span>&nbsp;<span class="ident" id="6127357">err</span>&nbsp;<span class="builtintype" id="6127361">error</span><span class="op" id="6127366">)</span><br>
<span class="lineno">95</span><span class="op" id="6127368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6127371">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="6127439">func</span>&nbsp;<span class="op" id="6127444">(</span><span class="ident" id="6127445">ctxt</span>&nbsp;<span class="op" id="6127450">*</span><span class="ident" id="6127451">Context</span><span class="op" id="6127458">)</span>&nbsp;<span class="ident" id="6127460">joinPath</span><span class="op" id="6127468">(</span><span class="ident" id="6127469">elem</span>&nbsp;<span class="op" id="6127474">...</span><span class="builtintype" id="6127477">string</span><span class="op" id="6127483">)</span>&nbsp;<span class="builtintype" id="6127485">string</span>&nbsp;<span class="op" id="6127492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127495">if</span>&nbsp;<span class="ident" id="6127498">f</span>&nbsp;<span class="op" id="6127500">:=</span>&nbsp;<span class="ident" id="6127503">ctxt</span><span class="op" id="6127507">.</span><span class="ident" id="6127508">JoinPath</span><span class="op" id="6127516">;</span>&nbsp;<span class="ident" id="6127518">f</span>&nbsp;<span class="op" id="6127520">!=</span>&nbsp;<span class="ident" id="6127523">nil</span>&nbsp;<span class="op" id="6127527">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127531">return</span>&nbsp;<span class="ident" id="6127538">f</span><span class="op" id="6127539">(</span><span class="ident" id="6127540">elem</span><span class="op" id="6127544">...</span><span class="op" id="6127547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127553">return</span>&nbsp;<span class="ident" id="6127560">filepath</span><span class="op" id="6127568">.</span><span class="ident" id="6127569">Join</span><span class="op" id="6127573">(</span><span class="ident" id="6127574">elem</span><span class="op" id="6127578">...</span><span class="op" id="6127581">)</span><br>
<span class="lineno"></span><span class="op" id="6127583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6127586">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="6127669">func</span>&nbsp;<span class="op" id="6127674">(</span><span class="ident" id="6127675">ctxt</span>&nbsp;<span class="op" id="6127680">*</span><span class="ident" id="6127681">Context</span><span class="op" id="6127688">)</span>&nbsp;<span class="ident" id="6127690">splitPathList</span><span class="op" id="6127703">(</span><span class="ident" id="6127704">s</span>&nbsp;<span class="builtintype" id="6127706">string</span><span class="op" id="6127712">)</span>&nbsp;<span class="op" id="6127714">[</span><span class="op" id="6127715">]</span><span class="builtintype" id="6127716">string</span>&nbsp;<span class="op" id="6127723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127726">if</span>&nbsp;<span class="ident" id="6127729">f</span>&nbsp;<span class="op" id="6127731">:=</span>&nbsp;<span class="ident" id="6127734">ctxt</span><span class="op" id="6127738">.</span><span class="ident" id="6127739">SplitPathList</span><span class="op" id="6127752">;</span>&nbsp;<span class="ident" id="6127754">f</span>&nbsp;<span class="op" id="6127756">!=</span>&nbsp;<span class="ident" id="6127759">nil</span>&nbsp;<span class="op" id="6127763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127767">return</span>&nbsp;<span class="ident" id="6127774">f</span><span class="op" id="6127775">(</span><span class="ident" id="6127776">s</span><span class="op" id="6127777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127780">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127783">return</span>&nbsp;<span class="ident" id="6127790">filepath</span><span class="op" id="6127798">.</span><span class="ident" id="6127799">SplitList</span><span class="op" id="6127808">(</span><span class="ident" id="6127809">s</span><span class="op" id="6127810">)</span><br>
<span class="lineno"></span><span class="op" id="6127812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6127815">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="6127887">func</span>&nbsp;<span class="op" id="6127892">(</span><span class="ident" id="6127893">ctxt</span>&nbsp;<span class="op" id="6127898">*</span><span class="ident" id="6127899">Context</span><span class="op" id="6127906">)</span>&nbsp;<span class="ident" id="6127908">isAbsPath</span><span class="op" id="6127917">(</span><span class="ident" id="6127918">path</span>&nbsp;<span class="builtintype" id="6127923">string</span><span class="op" id="6127929">)</span>&nbsp;<span class="builtintype" id="6127931">bool</span>&nbsp;<span class="op" id="6127936">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127939">if</span>&nbsp;<span class="ident" id="6127942">f</span>&nbsp;<span class="op" id="6127944">:=</span>&nbsp;<span class="ident" id="6127947">ctxt</span><span class="op" id="6127951">.</span><span class="ident" id="6127952">IsAbsPath</span><span class="op" id="6127961">;</span>&nbsp;<span class="ident" id="6127963">f</span>&nbsp;<span class="op" id="6127965">!=</span>&nbsp;<span class="ident" id="6127968">nil</span>&nbsp;<span class="op" id="6127972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127976">return</span>&nbsp;<span class="ident" id="6127983">f</span><span class="op" id="6127984">(</span><span class="ident" id="6127985">path</span><span class="op" id="6127989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127995">return</span>&nbsp;<span class="ident" id="6128002">filepath</span><span class="op" id="6128010">.</span><span class="ident" id="6128011">IsAbs</span><span class="op" id="6128016">(</span><span class="ident" id="6128017">path</span><span class="op" id="6128021">)</span><br>
<span class="lineno"></span><span class="op" id="6128023">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="6128026">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="6128087">func</span>&nbsp;<span class="op" id="6128092">(</span><span class="ident" id="6128093">ctxt</span>&nbsp;<span class="op" id="6128098">*</span><span class="ident" id="6128099">Context</span><span class="op" id="6128106">)</span>&nbsp;<span class="ident" id="6128108">isDir</span><span class="op" id="6128113">(</span><span class="ident" id="6128114">path</span>&nbsp;<span class="builtintype" id="6128119">string</span><span class="op" id="6128125">)</span>&nbsp;<span class="builtintype" id="6128127">bool</span>&nbsp;<span class="op" id="6128132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128135">if</span>&nbsp;<span class="ident" id="6128138">f</span>&nbsp;<span class="op" id="6128140">:=</span>&nbsp;<span class="ident" id="6128143">ctxt</span><span class="op" id="6128147">.</span><span class="ident" id="6128148">IsDir</span><span class="op" id="6128153">;</span>&nbsp;<span class="ident" id="6128155">f</span>&nbsp;<span class="op" id="6128157">!=</span>&nbsp;<span class="ident" id="6128160">nil</span>&nbsp;<span class="op" id="6128164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128168">return</span>&nbsp;<span class="ident" id="6128175">f</span><span class="op" id="6128176">(</span><span class="ident" id="6128177">path</span><span class="op" id="6128181">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128187">fi</span><span class="op" id="6128189">,</span>&nbsp;<span class="ident" id="6128191">err</span>&nbsp;<span class="op" id="6128195">:=</span>&nbsp;<span class="ident" id="6128198">os</span><span class="op" id="6128200">.</span><span class="ident" id="6128201">Stat</span><span class="op" id="6128205">(</span><span class="ident" id="6128206">path</span><span class="op" id="6128210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128213">return</span>&nbsp;<span class="ident" id="6128220">err</span>&nbsp;<span class="op" id="6128224">==</span>&nbsp;<span class="ident" id="6128227">nil</span>&nbsp;<span class="op" id="6128231">&amp;&amp;</span>&nbsp;<span class="ident" id="6128234">fi</span><span class="op" id="6128236">.</span><span class="ident" id="6128237">IsDir</span><span class="op" id="6128242">(</span><span class="op" id="6128243">)</span><br>
<span class="lineno"></span><span class="op" id="6128245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6128248">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6128308">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="6128357">func</span>&nbsp;<span class="op" id="6128362">(</span><span class="ident" id="6128363">ctxt</span>&nbsp;<span class="op" id="6128368">*</span><span class="ident" id="6128369">Context</span><span class="op" id="6128376">)</span>&nbsp;<span class="ident" id="6128378">hasSubdir</span><span class="op" id="6128387">(</span><span class="ident" id="6128388">root</span><span class="op" id="6128392">,</span>&nbsp;<span class="ident" id="6128394">dir</span>&nbsp;<span class="builtintype" id="6128398">string</span><span class="op" id="6128404">)</span>&nbsp;<span class="op" id="6128406">(</span><span class="ident" id="6128407">rel</span>&nbsp;<span class="builtintype" id="6128411">string</span><span class="op" id="6128417">,</span>&nbsp;<span class="ident" id="6128419">ok</span>&nbsp;<span class="builtintype" id="6128422">bool</span><span class="op" id="6128426">)</span>&nbsp;<span class="op" id="6128428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128431">if</span>&nbsp;<span class="ident" id="6128434">f</span>&nbsp;<span class="op" id="6128436">:=</span>&nbsp;<span class="ident" id="6128439">ctxt</span><span class="op" id="6128443">.</span><span class="ident" id="6128444">HasSubdir</span><span class="op" id="6128453">;</span>&nbsp;<span class="ident" id="6128455">f</span>&nbsp;<span class="op" id="6128457">!=</span>&nbsp;<span class="ident" id="6128460">nil</span>&nbsp;<span class="op" id="6128464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128468">return</span>&nbsp;<span class="ident" id="6128475">f</span><span class="op" id="6128476">(</span><span class="ident" id="6128477">root</span><span class="op" id="6128481">,</span>&nbsp;<span class="ident" id="6128483">dir</span><span class="op" id="6128486">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128493">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128526">if</span>&nbsp;<span class="ident" id="6128529">rel</span><span class="op" id="6128532">,</span>&nbsp;<span class="ident" id="6128534">ok</span>&nbsp;<span class="op" id="6128537">=</span>&nbsp;<span class="ident" id="6128539">hasSubdir</span><span class="op" id="6128548">(</span><span class="ident" id="6128549">root</span><span class="op" id="6128553">,</span>&nbsp;<span class="ident" id="6128555">dir</span><span class="op" id="6128558">)</span><span class="op" id="6128559">;</span>&nbsp;<span class="ident" id="6128561">ok</span>&nbsp;<span class="op" id="6128564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128568">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128580">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128621">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128657">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128688">rootSym</span><span class="op" id="6128695">,</span>&nbsp;<span class="ident" id="6128697">_</span>&nbsp;<span class="op" id="6128699">:=</span>&nbsp;<span class="ident" id="6128702">filepath</span><span class="op" id="6128710">.</span><span class="ident" id="6128711">EvalSymlinks</span><span class="op" id="6128723">(</span><span class="ident" id="6128724">root</span><span class="op" id="6128728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128731">dirSym</span><span class="op" id="6128737">,</span>&nbsp;<span class="ident" id="6128739">_</span>&nbsp;<span class="op" id="6128741">:=</span>&nbsp;<span class="ident" id="6128744">filepath</span><span class="op" id="6128752">.</span><span class="ident" id="6128753">EvalSymlinks</span><span class="op" id="6128765">(</span><span class="ident" id="6128766">dir</span><span class="op" id="6128769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128773">if</span>&nbsp;<span class="ident" id="6128776">rel</span><span class="op" id="6128779">,</span>&nbsp;<span class="ident" id="6128781">ok</span>&nbsp;<span class="op" id="6128784">=</span>&nbsp;<span class="ident" id="6128786">hasSubdir</span><span class="op" id="6128795">(</span><span class="ident" id="6128796">rootSym</span><span class="op" id="6128803">,</span>&nbsp;<span class="ident" id="6128805">dir</span><span class="op" id="6128808">)</span><span class="op" id="6128809">;</span>&nbsp;<span class="ident" id="6128811">ok</span>&nbsp;<span class="op" id="6128814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128818">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128829">if</span>&nbsp;<span class="ident" id="6128832">rel</span><span class="op" id="6128835">,</span>&nbsp;<span class="ident" id="6128837">ok</span>&nbsp;<span class="op" id="6128840">=</span>&nbsp;<span class="ident" id="6128842">hasSubdir</span><span class="op" id="6128851">(</span><span class="ident" id="6128852">root</span><span class="op" id="6128856">,</span>&nbsp;<span class="ident" id="6128858">dirSym</span><span class="op" id="6128864">)</span><span class="op" id="6128865">;</span>&nbsp;<span class="ident" id="6128867">ok</span>&nbsp;<span class="op" id="6128870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128885">return</span>&nbsp;<span class="ident" id="6128892">hasSubdir</span><span class="op" id="6128901">(</span><span class="ident" id="6128902">rootSym</span><span class="op" id="6128909">,</span>&nbsp;<span class="ident" id="6128911">dirSym</span><span class="op" id="6128917">)</span><br>
<span class="lineno">155</span><span class="op" id="6128919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6128922">func</span>&nbsp;<span class="ident" id="6128927">hasSubdir</span><span class="op" id="6128936">(</span><span class="ident" id="6128937">root</span><span class="op" id="6128941">,</span>&nbsp;<span class="ident" id="6128943">dir</span>&nbsp;<span class="builtintype" id="6128947">string</span><span class="op" id="6128953">)</span>&nbsp;<span class="op" id="6128955">(</span><span class="ident" id="6128956">rel</span>&nbsp;<span class="builtintype" id="6128960">string</span><span class="op" id="6128966">,</span>&nbsp;<span class="ident" id="6128968">ok</span>&nbsp;<span class="builtintype" id="6128971">bool</span><span class="op" id="6128975">)</span>&nbsp;<span class="op" id="6128977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128980">const</span>&nbsp;<span class="ident" id="6128986">sep</span>&nbsp;<span class="op" id="6128990">=</span>&nbsp;<span class="builtintype" id="6128992">string</span><span class="op" id="6128998">(</span><span class="ident" id="6128999">filepath</span><span class="op" id="6129007">.</span><span class="ident" id="6129008">Separator</span><span class="op" id="6129017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129020">root</span>&nbsp;<span class="op" id="6129025">=</span>&nbsp;<span class="ident" id="6129027">filepath</span><span class="op" id="6129035">.</span><span class="ident" id="6129036">Clean</span><span class="op" id="6129041">(</span><span class="ident" id="6129042">root</span><span class="op" id="6129046">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129049">if</span>&nbsp;<span class="op" id="6129052">!</span><span class="ident" id="6129053">strings</span><span class="op" id="6129060">.</span><span class="ident" id="6129061">HasSuffix</span><span class="op" id="6129070">(</span><span class="ident" id="6129071">root</span><span class="op" id="6129075">,</span>&nbsp;<span class="ident" id="6129077">sep</span><span class="op" id="6129080">)</span>&nbsp;<span class="op" id="6129082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129086">root</span>&nbsp;<span class="op" id="6129091">+=</span>&nbsp;<span class="ident" id="6129094">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129102">dir</span>&nbsp;<span class="op" id="6129106">=</span>&nbsp;<span class="ident" id="6129108">filepath</span><span class="op" id="6129116">.</span><span class="ident" id="6129117">Clean</span><span class="op" id="6129122">(</span><span class="ident" id="6129123">dir</span><span class="op" id="6129126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129129">if</span>&nbsp;<span class="op" id="6129132">!</span><span class="ident" id="6129133">strings</span><span class="op" id="6129140">.</span><span class="ident" id="6129141">HasPrefix</span><span class="op" id="6129150">(</span><span class="ident" id="6129151">dir</span><span class="op" id="6129154">,</span>&nbsp;<span class="ident" id="6129156">root</span><span class="op" id="6129160">)</span>&nbsp;<span class="op" id="6129162">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129166">return</span>&nbsp;<span class="string" id="6129173">&#34;&#34;</span><span class="op" id="6129175">,</span>&nbsp;<span class="builtintype" id="6129177">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129187">return</span>&nbsp;<span class="ident" id="6129194">filepath</span><span class="op" id="6129202">.</span><span class="ident" id="6129203">ToSlash</span><span class="op" id="6129210">(</span><span class="ident" id="6129211">dir</span><span class="op" id="6129214">[</span><span class="builtinfunc" id="6129215">len</span><span class="op" id="6129218">(</span><span class="ident" id="6129219">root</span><span class="op" id="6129223">)</span><span class="op" id="6129224">:</span><span class="op" id="6129225">]</span><span class="op" id="6129226">)</span><span class="op" id="6129227">,</span>&nbsp;<span class="builtintype" id="6129229">true</span><br>
<span class="lineno"></span><span class="op" id="6129234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="6129237">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6129304">func</span>&nbsp;<span class="op" id="6129309">(</span><span class="ident" id="6129310">ctxt</span>&nbsp;<span class="op" id="6129315">*</span><span class="ident" id="6129316">Context</span><span class="op" id="6129323">)</span>&nbsp;<span class="ident" id="6129325">readDir</span><span class="op" id="6129332">(</span><span class="ident" id="6129333">path</span>&nbsp;<span class="builtintype" id="6129338">string</span><span class="op" id="6129344">)</span>&nbsp;<span class="op" id="6129346">(</span><span class="op" id="6129347">[</span><span class="op" id="6129348">]</span><span class="ident" id="6129349">os</span><span class="op" id="6129351">.</span><span class="ident" id="6129352">FileInfo</span><span class="op" id="6129360">,</span>&nbsp;<span class="builtintype" id="6129362">error</span><span class="op" id="6129367">)</span>&nbsp;<span class="op" id="6129369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129372">if</span>&nbsp;<span class="ident" id="6129375">f</span>&nbsp;<span class="op" id="6129377">:=</span>&nbsp;<span class="ident" id="6129380">ctxt</span><span class="op" id="6129384">.</span><span class="ident" id="6129385">ReadDir</span><span class="op" id="6129392">;</span>&nbsp;<span class="ident" id="6129394">f</span>&nbsp;<span class="op" id="6129396">!=</span>&nbsp;<span class="ident" id="6129399">nil</span>&nbsp;<span class="op" id="6129403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129407">return</span>&nbsp;<span class="ident" id="6129414">f</span><span class="op" id="6129415">(</span><span class="ident" id="6129416">path</span><span class="op" id="6129420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129423">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129426">return</span>&nbsp;<span class="ident" id="6129433">ioutil</span><span class="op" id="6129439">.</span><span class="ident" id="6129440">ReadDir</span><span class="op" id="6129447">(</span><span class="ident" id="6129448">path</span><span class="op" id="6129452">)</span><br>
<span class="lineno"></span><span class="op" id="6129454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6129457">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="6129519">func</span>&nbsp;<span class="op" id="6129524">(</span><span class="ident" id="6129525">ctxt</span>&nbsp;<span class="op" id="6129530">*</span><span class="ident" id="6129531">Context</span><span class="op" id="6129538">)</span>&nbsp;<span class="ident" id="6129540">openFile</span><span class="op" id="6129548">(</span><span class="ident" id="6129549">path</span>&nbsp;<span class="builtintype" id="6129554">string</span><span class="op" id="6129560">)</span>&nbsp;<span class="op" id="6129562">(</span><span class="ident" id="6129563">io</span><span class="op" id="6129565">.</span><span class="ident" id="6129566">ReadCloser</span><span class="op" id="6129576">,</span>&nbsp;<span class="builtintype" id="6129578">error</span><span class="op" id="6129583">)</span>&nbsp;<span class="op" id="6129585">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129588">if</span>&nbsp;<span class="ident" id="6129591">fn</span>&nbsp;<span class="op" id="6129594">:=</span>&nbsp;<span class="ident" id="6129597">ctxt</span><span class="op" id="6129601">.</span><span class="ident" id="6129602">OpenFile</span><span class="op" id="6129610">;</span>&nbsp;<span class="ident" id="6129612">fn</span>&nbsp;<span class="op" id="6129615">!=</span>&nbsp;<span class="ident" id="6129618">nil</span>&nbsp;<span class="op" id="6129622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129626">return</span>&nbsp;<span class="ident" id="6129633">fn</span><span class="op" id="6129635">(</span><span class="ident" id="6129636">path</span><span class="op" id="6129640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129647">f</span><span class="op" id="6129648">,</span>&nbsp;<span class="ident" id="6129650">err</span>&nbsp;<span class="op" id="6129654">:=</span>&nbsp;<span class="ident" id="6129657">os</span><span class="op" id="6129659">.</span><span class="ident" id="6129660">Open</span><span class="op" id="6129664">(</span><span class="ident" id="6129665">path</span><span class="op" id="6129669">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129672">if</span>&nbsp;<span class="ident" id="6129675">err</span>&nbsp;<span class="op" id="6129679">!=</span>&nbsp;<span class="ident" id="6129682">nil</span>&nbsp;<span class="op" id="6129686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129690">return</span>&nbsp;<span class="ident" id="6129697">nil</span><span class="op" id="6129700">,</span>&nbsp;<span class="ident" id="6129702">err</span>&nbsp;<span class="comment" id="6129706">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129727">return</span>&nbsp;<span class="ident" id="6129734">f</span><span class="op" id="6129735">,</span>&nbsp;<span class="ident" id="6129737">nil</span><br>
<span class="lineno"></span><span class="op" id="6129741">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6129744">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6129810">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6129874">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="6129894">func</span>&nbsp;<span class="op" id="6129899">(</span><span class="ident" id="6129900">ctxt</span>&nbsp;<span class="op" id="6129905">*</span><span class="ident" id="6129906">Context</span><span class="op" id="6129913">)</span>&nbsp;<span class="ident" id="6129915">isFile</span><span class="op" id="6129921">(</span><span class="ident" id="6129922">path</span>&nbsp;<span class="builtintype" id="6129927">string</span><span class="op" id="6129933">)</span>&nbsp;<span class="builtintype" id="6129935">bool</span>&nbsp;<span class="op" id="6129940">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129943">f</span><span class="op" id="6129944">,</span>&nbsp;<span class="ident" id="6129946">err</span>&nbsp;<span class="op" id="6129950">:=</span>&nbsp;<span class="ident" id="6129953">ctxt</span><span class="op" id="6129957">.</span><span class="ident" id="6129958">openFile</span><span class="op" id="6129966">(</span><span class="ident" id="6129967">path</span><span class="op" id="6129971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129974">if</span>&nbsp;<span class="ident" id="6129977">err</span>&nbsp;<span class="op" id="6129981">!=</span>&nbsp;<span class="ident" id="6129984">nil</span>&nbsp;<span class="op" id="6129988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129992">return</span>&nbsp;<span class="builtintype" id="6129999">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6130006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130009">f</span><span class="op" id="6130010">.</span><span class="ident" id="6130011">Close</span><span class="op" id="6130016">(</span><span class="op" id="6130017">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130020">return</span>&nbsp;<span class="builtintype" id="6130027">true</span><br>
<span class="lineno"></span><span class="op" id="6130032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6130035">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="6130086">func</span>&nbsp;<span class="op" id="6130091">(</span><span class="ident" id="6130092">ctxt</span>&nbsp;<span class="op" id="6130097">*</span><span class="ident" id="6130098">Context</span><span class="op" id="6130105">)</span>&nbsp;<span class="ident" id="6130107">gopath</span><span class="op" id="6130113">(</span><span class="op" id="6130114">)</span>&nbsp;<span class="op" id="6130116">[</span><span class="op" id="6130117">]</span><span class="builtintype" id="6130118">string</span>&nbsp;<span class="op" id="6130125">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130128">var</span>&nbsp;<span class="ident" id="6130132">all</span>&nbsp;<span class="op" id="6130136">[</span><span class="op" id="6130137">]</span><span class="builtintype" id="6130138">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130146">for</span>&nbsp;<span class="ident" id="6130150">_</span><span class="op" id="6130151">,</span>&nbsp;<span class="ident" id="6130153">p</span>&nbsp;<span class="op" id="6130155">:=</span>&nbsp;<span class="keyword" id="6130158">range</span>&nbsp;<span class="ident" id="6130164">ctxt</span><span class="op" id="6130168">.</span><span class="ident" id="6130169">splitPathList</span><span class="op" id="6130182">(</span><span class="ident" id="6130183">ctxt</span><span class="op" id="6130187">.</span><span class="ident" id="6130188">GOPATH</span><span class="op" id="6130194">)</span>&nbsp;<span class="op" id="6130196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130200">if</span>&nbsp;<span class="ident" id="6130203">p</span>&nbsp;<span class="op" id="6130205">==</span>&nbsp;<span class="string" id="6130208">&#34;&#34;</span>&nbsp;<span class="op" id="6130211">||</span>&nbsp;<span class="ident" id="6130214">p</span>&nbsp;<span class="op" id="6130216">==</span>&nbsp;<span class="ident" id="6130219">ctxt</span><span class="op" id="6130223">.</span><span class="ident" id="6130224">GOROOT</span>&nbsp;<span class="op" id="6130231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130236">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130273">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130317">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130360">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130410">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6130421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130425">if</span>&nbsp;<span class="ident" id="6130428">strings</span><span class="op" id="6130435">.</span><span class="ident" id="6130436">HasPrefix</span><span class="op" id="6130445">(</span><span class="ident" id="6130446">p</span><span class="op" id="6130447">,</span>&nbsp;<span class="string" id="6130449">&#34;~&#34;</span><span class="op" id="6130452">)</span>&nbsp;<span class="op" id="6130454">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130459">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130521">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130585">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130630">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130690">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130748">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130815">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130878">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130944">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131003">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131023">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131087">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131115">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131130">all</span>&nbsp;<span class="op" id="6131134">=</span>&nbsp;<span class="builtinfunc" id="6131136">append</span><span class="op" id="6131142">(</span><span class="ident" id="6131143">all</span><span class="op" id="6131146">,</span>&nbsp;<span class="ident" id="6131148">p</span><span class="op" id="6131149">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131155">return</span>&nbsp;<span class="ident" id="6131162">all</span><br>
<span class="lineno"></span><span class="op" id="6131166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6131169">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="6131231">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="6131302">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="6131324">func</span>&nbsp;<span class="op" id="6131329">(</span><span class="ident" id="6131330">ctxt</span>&nbsp;<span class="op" id="6131335">*</span><span class="ident" id="6131336">Context</span><span class="op" id="6131343">)</span>&nbsp;<span class="ident" id="6131345">SrcDirs</span><span class="op" id="6131352">(</span><span class="op" id="6131353">)</span>&nbsp;<span class="op" id="6131355">[</span><span class="op" id="6131356">]</span><span class="builtintype" id="6131357">string</span>&nbsp;<span class="op" id="6131364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131367">var</span>&nbsp;<span class="ident" id="6131371">all</span>&nbsp;<span class="op" id="6131375">[</span><span class="op" id="6131376">]</span><span class="builtintype" id="6131377">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131385">if</span>&nbsp;<span class="ident" id="6131388">ctxt</span><span class="op" id="6131392">.</span><span class="ident" id="6131393">GOROOT</span>&nbsp;<span class="op" id="6131400">!=</span>&nbsp;<span class="string" id="6131403">&#34;&#34;</span>&nbsp;<span class="op" id="6131406">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131410">dir</span>&nbsp;<span class="op" id="6131414">:=</span>&nbsp;<span class="ident" id="6131417">ctxt</span><span class="op" id="6131421">.</span><span class="ident" id="6131422">joinPath</span><span class="op" id="6131430">(</span><span class="ident" id="6131431">ctxt</span><span class="op" id="6131435">.</span><span class="ident" id="6131436">GOROOT</span><span class="op" id="6131442">,</span>&nbsp;<span class="string" id="6131444">&#34;src&#34;</span><span class="op" id="6131449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131453">if</span>&nbsp;<span class="ident" id="6131456">ctxt</span><span class="op" id="6131460">.</span><span class="ident" id="6131461">isDir</span><span class="op" id="6131466">(</span><span class="ident" id="6131467">dir</span><span class="op" id="6131470">)</span>&nbsp;<span class="op" id="6131472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131477">all</span>&nbsp;<span class="op" id="6131481">=</span>&nbsp;<span class="builtinfunc" id="6131483">append</span><span class="op" id="6131489">(</span><span class="ident" id="6131490">all</span><span class="op" id="6131493">,</span>&nbsp;<span class="ident" id="6131495">dir</span><span class="op" id="6131498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131505">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131508">for</span>&nbsp;<span class="ident" id="6131512">_</span><span class="op" id="6131513">,</span>&nbsp;<span class="ident" id="6131515">p</span>&nbsp;<span class="op" id="6131517">:=</span>&nbsp;<span class="keyword" id="6131520">range</span>&nbsp;<span class="ident" id="6131526">ctxt</span><span class="op" id="6131530">.</span><span class="ident" id="6131531">gopath</span><span class="op" id="6131537">(</span><span class="op" id="6131538">)</span>&nbsp;<span class="op" id="6131540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131544">dir</span>&nbsp;<span class="op" id="6131548">:=</span>&nbsp;<span class="ident" id="6131551">ctxt</span><span class="op" id="6131555">.</span><span class="ident" id="6131556">joinPath</span><span class="op" id="6131564">(</span><span class="ident" id="6131565">p</span><span class="op" id="6131566">,</span>&nbsp;<span class="string" id="6131568">&#34;src&#34;</span><span class="op" id="6131573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131577">if</span>&nbsp;<span class="ident" id="6131580">ctxt</span><span class="op" id="6131584">.</span><span class="ident" id="6131585">isDir</span><span class="op" id="6131590">(</span><span class="ident" id="6131591">dir</span><span class="op" id="6131594">)</span>&nbsp;<span class="op" id="6131596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131601">all</span>&nbsp;<span class="op" id="6131605">=</span>&nbsp;<span class="builtinfunc" id="6131607">append</span><span class="op" id="6131613">(</span><span class="ident" id="6131614">all</span><span class="op" id="6131617">,</span>&nbsp;<span class="ident" id="6131619">dir</span><span class="op" id="6131622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131626">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131632">return</span>&nbsp;<span class="ident" id="6131639">all</span><br>
<span class="lineno"></span><span class="op" id="6131643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6131646">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="6131692">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="6131762">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="6131827">var</span>&nbsp;<span class="ident" id="6131831">Default</span>&nbsp;<span class="ident" id="6131839">Context</span>&nbsp;<span class="op" id="6131847">=</span>&nbsp;<span class="ident" id="6131849">defaultContext</span><span class="op" id="6131863">(</span><span class="op" id="6131864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6131867">var</span>&nbsp;<span class="ident" id="6131871">cgoEnabled</span>&nbsp;<span class="op" id="6131882">=</span>&nbsp;<span class="keyword" id="6131884">map</span><span class="op" id="6131887">[</span><span class="builtintype" id="6131888">string</span><span class="op" id="6131894">]</span><span class="builtintype" id="6131895">bool</span><span class="op" id="6131899">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6131902">&#34;darwin/386&#34;</span><span class="op" id="6131914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131921">true</span><span class="op" id="6131925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6131928">&#34;darwin/amd64&#34;</span><span class="op" id="6131942">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131947">true</span><span class="op" id="6131951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6131954">&#34;dragonfly/386&#34;</span><span class="op" id="6131969">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131973">true</span><span class="op" id="6131977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6131980">&#34;dragonfly/amd64&#34;</span><span class="op" id="6131997">:</span>&nbsp;<span class="builtintype" id="6131999">true</span><span class="op" id="6132003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132006">&#34;freebsd/386&#34;</span><span class="op" id="6132019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132025">true</span><span class="op" id="6132029">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132032">&#34;freebsd/amd64&#34;</span><span class="op" id="6132047">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132051">true</span><span class="op" id="6132055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132058">&#34;freebsd/arm&#34;</span><span class="op" id="6132071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132077">true</span><span class="op" id="6132081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132084">&#34;linux/386&#34;</span><span class="op" id="6132095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132103">true</span><span class="op" id="6132107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132110">&#34;linux/amd64&#34;</span><span class="op" id="6132123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132129">true</span><span class="op" id="6132133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132136">&#34;linux/arm&#34;</span><span class="op" id="6132147">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132155">true</span><span class="op" id="6132159">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132162">&#34;android/386&#34;</span><span class="op" id="6132175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132181">true</span><span class="op" id="6132185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132188">&#34;android/amd64&#34;</span><span class="op" id="6132203">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132207">true</span><span class="op" id="6132211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132214">&#34;android/arm&#34;</span><span class="op" id="6132227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132233">true</span><span class="op" id="6132237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132240">&#34;netbsd/386&#34;</span><span class="op" id="6132252">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132259">true</span><span class="op" id="6132263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132266">&#34;netbsd/amd64&#34;</span><span class="op" id="6132280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132285">true</span><span class="op" id="6132289">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132292">&#34;netbsd/arm&#34;</span><span class="op" id="6132304">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132311">true</span><span class="op" id="6132315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132318">&#34;openbsd/386&#34;</span><span class="op" id="6132331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132337">true</span><span class="op" id="6132341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132344">&#34;openbsd/amd64&#34;</span><span class="op" id="6132359">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132363">true</span><span class="op" id="6132367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132370">&#34;windows/386&#34;</span><span class="op" id="6132383">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132389">true</span><span class="op" id="6132393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132396">&#34;windows/amd64&#34;</span><span class="op" id="6132411">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6132415">true</span><span class="op" id="6132419">,</span><br>
<span class="lineno">280</span><span class="op" id="6132421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6132424">func</span>&nbsp;<span class="ident" id="6132429">defaultContext</span><span class="op" id="6132443">(</span><span class="op" id="6132444">)</span>&nbsp;<span class="ident" id="6132446">Context</span>&nbsp;<span class="op" id="6132454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132457">var</span>&nbsp;<span class="ident" id="6132461">c</span>&nbsp;<span class="ident" id="6132463">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132473">c</span><span class="op" id="6132474">.</span><span class="ident" id="6132475">GOARCH</span>&nbsp;<span class="op" id="6132482">=</span>&nbsp;<span class="ident" id="6132484">envOr</span><span class="op" id="6132489">(</span><span class="string" id="6132490">&#34;GOARCH&#34;</span><span class="op" id="6132498">,</span>&nbsp;<span class="ident" id="6132500">runtime</span><span class="op" id="6132507">.</span><span class="ident" id="6132508">GOARCH</span><span class="op" id="6132514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132517">c</span><span class="op" id="6132518">.</span><span class="ident" id="6132519">GOOS</span>&nbsp;<span class="op" id="6132524">=</span>&nbsp;<span class="ident" id="6132526">envOr</span><span class="op" id="6132531">(</span><span class="string" id="6132532">&#34;GOOS&#34;</span><span class="op" id="6132538">,</span>&nbsp;<span class="ident" id="6132540">runtime</span><span class="op" id="6132547">.</span><span class="ident" id="6132548">GOOS</span><span class="op" id="6132552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132555">c</span><span class="op" id="6132556">.</span><span class="ident" id="6132557">GOROOT</span>&nbsp;<span class="op" id="6132564">=</span>&nbsp;<span class="ident" id="6132566">runtime</span><span class="op" id="6132573">.</span><span class="ident" id="6132574">GOROOT</span><span class="op" id="6132580">(</span><span class="op" id="6132581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132584">c</span><span class="op" id="6132585">.</span><span class="ident" id="6132586">GOPATH</span>&nbsp;<span class="op" id="6132593">=</span>&nbsp;<span class="ident" id="6132595">envOr</span><span class="op" id="6132600">(</span><span class="string" id="6132601">&#34;GOPATH&#34;</span><span class="op" id="6132609">,</span>&nbsp;<span class="string" id="6132611">&#34;&#34;</span><span class="op" id="6132613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132616">c</span><span class="op" id="6132617">.</span><span class="ident" id="6132618">Compiler</span>&nbsp;<span class="op" id="6132627">=</span>&nbsp;<span class="ident" id="6132629">runtime</span><span class="op" id="6132636">.</span><span class="ident" id="6132637">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132648">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132718">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132788">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132861">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132934">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133011">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133015">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133059">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133133">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133148">c</span><span class="op" id="6133149">.</span><span class="ident" id="6133150">ReleaseTags</span>&nbsp;<span class="op" id="6133162">=</span>&nbsp;<span class="op" id="6133164">[</span><span class="op" id="6133165">]</span><span class="builtintype" id="6133166">string</span><span class="op" id="6133172">{</span><span class="string" id="6133173">&#34;go1.1&#34;</span><span class="op" id="6133180">,</span>&nbsp;<span class="string" id="6133182">&#34;go1.2&#34;</span><span class="op" id="6133189">,</span>&nbsp;<span class="string" id="6133191">&#34;go1.3&#34;</span><span class="op" id="6133198">,</span>&nbsp;<span class="string" id="6133200">&#34;go1.4&#34;</span><span class="op" id="6133207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133211">switch</span>&nbsp;<span class="ident" id="6133218">os</span><span class="op" id="6133220">.</span><span class="ident" id="6133221">Getenv</span><span class="op" id="6133227">(</span><span class="string" id="6133228">&#34;CGO_ENABLED&#34;</span><span class="op" id="6133241">)</span>&nbsp;<span class="op" id="6133243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133246">case</span>&nbsp;<span class="string" id="6133251">&#34;1&#34;</span><span class="op" id="6133254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133258">c</span><span class="op" id="6133259">.</span><span class="ident" id="6133260">CgoEnabled</span>&nbsp;<span class="op" id="6133271">=</span>&nbsp;<span class="builtintype" id="6133273">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133279">case</span>&nbsp;<span class="string" id="6133284">&#34;0&#34;</span><span class="op" id="6133287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133291">c</span><span class="op" id="6133292">.</span><span class="ident" id="6133293">CgoEnabled</span>&nbsp;<span class="op" id="6133304">=</span>&nbsp;<span class="builtintype" id="6133306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133313">default</span><span class="op" id="6133320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133324">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133389">if</span>&nbsp;<span class="ident" id="6133392">runtime</span><span class="op" id="6133399">.</span><span class="ident" id="6133400">GOARCH</span>&nbsp;<span class="op" id="6133407">==</span>&nbsp;<span class="ident" id="6133410">c</span><span class="op" id="6133411">.</span><span class="ident" id="6133412">GOARCH</span>&nbsp;<span class="op" id="6133419">&amp;&amp;</span>&nbsp;<span class="ident" id="6133422">runtime</span><span class="op" id="6133429">.</span><span class="ident" id="6133430">GOOS</span>&nbsp;<span class="op" id="6133435">==</span>&nbsp;<span class="ident" id="6133438">c</span><span class="op" id="6133439">.</span><span class="ident" id="6133440">GOOS</span>&nbsp;<span class="op" id="6133445">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133450">c</span><span class="op" id="6133451">.</span><span class="ident" id="6133452">CgoEnabled</span>&nbsp;<span class="op" id="6133463">=</span>&nbsp;<span class="ident" id="6133465">cgoEnabled</span><span class="op" id="6133475">[</span><span class="ident" id="6133476">c</span><span class="op" id="6133477">.</span><span class="ident" id="6133478">GOOS</span><span class="op" id="6133482">+</span><span class="string" id="6133483">&#34;/&#34;</span><span class="op" id="6133486">+</span><span class="ident" id="6133487">c</span><span class="op" id="6133488">.</span><span class="ident" id="6133489">GOARCH</span><span class="op" id="6133495">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133500">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133512">c</span><span class="op" id="6133513">.</span><span class="ident" id="6133514">CgoEnabled</span>&nbsp;<span class="op" id="6133525">=</span>&nbsp;<span class="builtintype" id="6133527">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133534">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133538">return</span>&nbsp;<span class="ident" id="6133545">c</span><br>
<span class="lineno"></span><span class="op" id="6133547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133550">func</span>&nbsp;<span class="ident" id="6133555">envOr</span><span class="op" id="6133560">(</span><span class="ident" id="6133561">name</span><span class="op" id="6133565">,</span>&nbsp;<span class="ident" id="6133567">def</span>&nbsp;<span class="builtintype" id="6133571">string</span><span class="op" id="6133577">)</span>&nbsp;<span class="builtintype" id="6133579">string</span>&nbsp;<span class="op" id="6133586">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133589">s</span>&nbsp;<span class="op" id="6133591">:=</span>&nbsp;<span class="ident" id="6133594">os</span><span class="op" id="6133596">.</span><span class="ident" id="6133597">Getenv</span><span class="op" id="6133603">(</span><span class="ident" id="6133604">name</span><span class="op" id="6133608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133611">if</span>&nbsp;<span class="ident" id="6133614">s</span>&nbsp;<span class="op" id="6133616">==</span>&nbsp;<span class="string" id="6133619">&#34;&#34;</span>&nbsp;<span class="op" id="6133622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133626">return</span>&nbsp;<span class="ident" id="6133633">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133641">return</span>&nbsp;<span class="ident" id="6133648">s</span><br>
<span class="lineno">325</span><span class="op" id="6133650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6133653">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6133714">type</span>&nbsp;<span class="ident" id="6133719">ImportMode</span>&nbsp;<span class="builtintype" id="6133730">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="6133736">const</span>&nbsp;<span class="op" id="6133742">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133745">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133811">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133875">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133912">FindOnly</span>&nbsp;<span class="ident" id="6133921">ImportMode</span>&nbsp;<span class="op" id="6133932">=</span>&nbsp;<span class="num" id="6133934">1</span>&nbsp;<span class="op" id="6133936">&lt;&lt;</span>&nbsp;<span class="ident" id="6133939">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133946">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134011">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134061">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134075">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134149">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134220">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134280">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134340">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="6134354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6134357">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="6134417">type</span>&nbsp;<span class="ident" id="6134422">Package</span>&nbsp;<span class="keyword" id="6134430">struct</span>&nbsp;<span class="op" id="6134437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134440">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134454">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134463">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134504">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134518">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134527">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134544">ImportComment</span>&nbsp;<span class="builtintype" id="6134558">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134567">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134615">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134629">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134638">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134665">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134679">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134688">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134731">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134745">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134754">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134799">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134813">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134822">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134872">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134886">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134895">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134946">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6134960">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6134969">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135015">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6135029">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6135038">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135067">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6135081">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6135090">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135112">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135126">[</span><span class="op" id="6135127">]</span><span class="builtintype" id="6135128">string</span>&nbsp;<span class="comment" id="6135135">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135196">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6135210">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6135219">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6135262">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135279">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135294">[</span><span class="op" id="6135295">]</span><span class="builtintype" id="6135296">string</span>&nbsp;<span class="comment" id="6135303">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135372">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135387">[</span><span class="op" id="6135388">]</span><span class="builtintype" id="6135389">string</span>&nbsp;<span class="comment" id="6135396">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135433">IgnoredGoFiles</span>&nbsp;<span class="op" id="6135448">[</span><span class="op" id="6135449">]</span><span class="builtintype" id="6135450">string</span>&nbsp;<span class="comment" id="6135457">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135501">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135516">[</span><span class="op" id="6135517">]</span><span class="builtintype" id="6135518">string</span>&nbsp;<span class="comment" id="6135525">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135545">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135560">[</span><span class="op" id="6135561">]</span><span class="builtintype" id="6135562">string</span>&nbsp;<span class="comment" id="6135569">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135605">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135620">[</span><span class="op" id="6135621">]</span><span class="builtintype" id="6135622">string</span>&nbsp;<span class="comment" id="6135629">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135663">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135678">[</span><span class="op" id="6135679">]</span><span class="builtintype" id="6135680">string</span>&nbsp;<span class="comment" id="6135687">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135727">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135742">[</span><span class="op" id="6135743">]</span><span class="builtintype" id="6135744">string</span>&nbsp;<span class="comment" id="6135751">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135771">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135786">[</span><span class="op" id="6135787">]</span><span class="builtintype" id="6135788">string</span>&nbsp;<span class="comment" id="6135795">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135811">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6135826">[</span><span class="op" id="6135827">]</span><span class="builtintype" id="6135828">string</span>&nbsp;<span class="comment" id="6135835">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135854">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135869">[</span><span class="op" id="6135870">]</span><span class="builtintype" id="6135871">string</span>&nbsp;<span class="comment" id="6135878">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6135927">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135946">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6135959">[</span><span class="op" id="6135960">]</span><span class="builtintype" id="6135961">string</span>&nbsp;<span class="comment" id="6135968">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135994">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="6136007">[</span><span class="op" id="6136008">]</span><span class="builtintype" id="6136009">string</span>&nbsp;<span class="comment" id="6136016">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136044">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="6136057">[</span><span class="op" id="6136058">]</span><span class="builtintype" id="6136059">string</span>&nbsp;<span class="comment" id="6136066">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136094">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6136107">[</span><span class="op" id="6136108">]</span><span class="builtintype" id="6136109">string</span>&nbsp;<span class="comment" id="6136116">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136143">CgoPkgConfig</span>&nbsp;<span class="op" id="6136156">[</span><span class="op" id="6136157">]</span><span class="builtintype" id="6136158">string</span>&nbsp;<span class="comment" id="6136165">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6136196">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136223">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6136233">[</span><span class="op" id="6136234">]</span><span class="builtintype" id="6136235">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6136261">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136296">ImportPos</span>&nbsp;<span class="keyword" id="6136306">map</span><span class="op" id="6136309">[</span><span class="builtintype" id="6136310">string</span><span class="op" id="6136316">]</span><span class="op" id="6136317">[</span><span class="op" id="6136318">]</span><span class="ident" id="6136319">token</span><span class="op" id="6136324">.</span><span class="ident" id="6136325">Position</span>&nbsp;<span class="comment" id="6136334">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6136368">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136389">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6136404">[</span><span class="op" id="6136405">]</span><span class="builtintype" id="6136406">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6136432">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136462">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6136477">[</span><span class="op" id="6136478">]</span><span class="builtintype" id="6136479">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6136505">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136534">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="6136549">map</span><span class="op" id="6136552">[</span><span class="builtintype" id="6136553">string</span><span class="op" id="6136559">]</span><span class="op" id="6136560">[</span><span class="op" id="6136561">]</span><span class="ident" id="6136562">token</span><span class="op" id="6136567">.</span><span class="ident" id="6136568">Position</span>&nbsp;<span class="comment" id="6136577">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136614">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6136629">[</span><span class="op" id="6136630">]</span><span class="builtintype" id="6136631">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6136657">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136692">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6136707">[</span><span class="op" id="6136708">]</span><span class="builtintype" id="6136709">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6136735">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136765">XTestImportPos</span>&nbsp;<span class="keyword" id="6136780">map</span><span class="op" id="6136783">[</span><span class="builtintype" id="6136784">string</span><span class="op" id="6136790">]</span><span class="op" id="6136791">[</span><span class="op" id="6136792">]</span><span class="ident" id="6136793">token</span><span class="op" id="6136798">.</span><span class="ident" id="6136799">Position</span>&nbsp;<span class="comment" id="6136808">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="6136845">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="6136848">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6136905">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="6136954">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="6137004">func</span>&nbsp;<span class="op" id="6137009">(</span><span class="ident" id="6137010">p</span>&nbsp;<span class="op" id="6137012">*</span><span class="ident" id="6137013">Package</span><span class="op" id="6137020">)</span>&nbsp;<span class="ident" id="6137022">IsCommand</span><span class="op" id="6137031">(</span><span class="op" id="6137032">)</span>&nbsp;<span class="builtintype" id="6137034">bool</span>&nbsp;<span class="op" id="6137039">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137042">return</span>&nbsp;<span class="ident" id="6137049">p</span><span class="op" id="6137050">.</span><span class="ident" id="6137051">Name</span>&nbsp;<span class="op" id="6137056">==</span>&nbsp;<span class="string" id="6137059">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="6137066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6137069">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6137135">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="6137159">func</span>&nbsp;<span class="op" id="6137164">(</span><span class="ident" id="6137165">ctxt</span>&nbsp;<span class="op" id="6137170">*</span><span class="ident" id="6137171">Context</span><span class="op" id="6137178">)</span>&nbsp;<span class="ident" id="6137180">ImportDir</span><span class="op" id="6137189">(</span><span class="ident" id="6137190">dir</span>&nbsp;<span class="builtintype" id="6137194">string</span><span class="op" id="6137200">,</span>&nbsp;<span class="ident" id="6137202">mode</span>&nbsp;<span class="ident" id="6137207">ImportMode</span><span class="op" id="6137217">)</span>&nbsp;<span class="op" id="6137219">(</span><span class="op" id="6137220">*</span><span class="ident" id="6137221">Package</span><span class="op" id="6137228">,</span>&nbsp;<span class="builtintype" id="6137230">error</span><span class="op" id="6137235">)</span>&nbsp;<span class="op" id="6137237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137240">return</span>&nbsp;<span class="ident" id="6137247">ctxt</span><span class="op" id="6137251">.</span><span class="ident" id="6137252">Import</span><span class="op" id="6137258">(</span><span class="string" id="6137259">&#34;.&#34;</span><span class="op" id="6137262">,</span>&nbsp;<span class="ident" id="6137264">dir</span><span class="op" id="6137267">,</span>&nbsp;<span class="ident" id="6137269">mode</span><span class="op" id="6137273">)</span><br>
<span class="lineno"></span><span class="op" id="6137275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6137278">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="6137343">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6137409">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="6137464">type</span>&nbsp;<span class="ident" id="6137469">NoGoError</span>&nbsp;<span class="keyword" id="6137479">struct</span>&nbsp;<span class="op" id="6137486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137489">Dir</span>&nbsp;<span class="builtintype" id="6137493">string</span><br>
<span class="lineno"></span><span class="op" id="6137500">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6137503">func</span>&nbsp;<span class="op" id="6137508">(</span><span class="ident" id="6137509">e</span>&nbsp;<span class="op" id="6137511">*</span><span class="ident" id="6137512">NoGoError</span><span class="op" id="6137521">)</span>&nbsp;<span class="ident" id="6137523">Error</span><span class="op" id="6137528">(</span><span class="op" id="6137529">)</span>&nbsp;<span class="builtintype" id="6137531">string</span>&nbsp;<span class="op" id="6137538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137541">return</span>&nbsp;<span class="string" id="6137548">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6137583">+</span>&nbsp;<span class="ident" id="6137585">e</span><span class="op" id="6137586">.</span><span class="ident" id="6137587">Dir</span><br>
<span class="lineno"></span><span class="op" id="6137591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="6137594">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="6137651">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="6137712">type</span>&nbsp;<span class="ident" id="6137717">MultiplePackageError</span>&nbsp;<span class="keyword" id="6137738">struct</span>&nbsp;<span class="op" id="6137745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137748">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6137757">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6137766">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137797">Packages</span>&nbsp;<span class="op" id="6137806">[</span><span class="op" id="6137807">]</span><span class="builtintype" id="6137808">string</span>&nbsp;<span class="comment" id="6137815">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137839">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6137848">[</span><span class="op" id="6137849">]</span><span class="builtintype" id="6137850">string</span>&nbsp;<span class="comment" id="6137857">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="6137919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6137922">func</span>&nbsp;<span class="op" id="6137927">(</span><span class="ident" id="6137928">e</span>&nbsp;<span class="op" id="6137930">*</span><span class="ident" id="6137931">MultiplePackageError</span><span class="op" id="6137951">)</span>&nbsp;<span class="ident" id="6137953">Error</span><span class="op" id="6137958">(</span><span class="op" id="6137959">)</span>&nbsp;<span class="builtintype" id="6137961">string</span>&nbsp;<span class="op" id="6137968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6137971">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138030">return</span>&nbsp;<span class="ident" id="6138037">fmt</span><span class="op" id="6138040">.</span><span class="ident" id="6138041">Sprintf</span><span class="op" id="6138048">(</span><span class="string" id="6138049">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6138091">,</span>&nbsp;<span class="ident" id="6138093">e</span><span class="op" id="6138094">.</span><span class="ident" id="6138095">Packages</span><span class="op" id="6138103">[</span><span class="num" id="6138104">0</span><span class="op" id="6138105">]</span><span class="op" id="6138106">,</span>&nbsp;<span class="ident" id="6138108">e</span><span class="op" id="6138109">.</span><span class="ident" id="6138110">Files</span><span class="op" id="6138115">[</span><span class="num" id="6138116">0</span><span class="op" id="6138117">]</span><span class="op" id="6138118">,</span>&nbsp;<span class="ident" id="6138120">e</span><span class="op" id="6138121">.</span><span class="ident" id="6138122">Packages</span><span class="op" id="6138130">[</span><span class="num" id="6138131">1</span><span class="op" id="6138132">]</span><span class="op" id="6138133">,</span>&nbsp;<span class="ident" id="6138135">e</span><span class="op" id="6138136">.</span><span class="ident" id="6138137">Files</span><span class="op" id="6138142">[</span><span class="num" id="6138143">1</span><span class="op" id="6138144">]</span><span class="op" id="6138145">,</span>&nbsp;<span class="ident" id="6138147">e</span><span class="op" id="6138148">.</span><span class="ident" id="6138149">Dir</span><span class="op" id="6138152">)</span><br>
<span class="lineno"></span><span class="op" id="6138154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6138157">func</span>&nbsp;<span class="ident" id="6138162">nameExt</span><span class="op" id="6138169">(</span><span class="ident" id="6138170">name</span>&nbsp;<span class="builtintype" id="6138175">string</span><span class="op" id="6138181">)</span>&nbsp;<span class="builtintype" id="6138183">string</span>&nbsp;<span class="op" id="6138190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138193">i</span>&nbsp;<span class="op" id="6138195">:=</span>&nbsp;<span class="ident" id="6138198">strings</span><span class="op" id="6138205">.</span><span class="ident" id="6138206">LastIndex</span><span class="op" id="6138215">(</span><span class="ident" id="6138216">name</span><span class="op" id="6138220">,</span>&nbsp;<span class="string" id="6138222">&#34;.&#34;</span><span class="op" id="6138225">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138228">if</span>&nbsp;<span class="ident" id="6138231">i</span>&nbsp;<span class="op" id="6138233">&lt;</span>&nbsp;<span class="num" id="6138235">0</span>&nbsp;<span class="op" id="6138237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138241">return</span>&nbsp;<span class="string" id="6138248">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6138252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138255">return</span>&nbsp;<span class="ident" id="6138262">name</span><span class="op" id="6138266">[</span><span class="ident" id="6138267">i</span><span class="op" id="6138268">:</span><span class="op" id="6138269">]</span><br>
<span class="lineno"></span><span class="op" id="6138271">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="6138274">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="6138347">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6138416">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="6138492">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="6138568">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="6138585">//</span><br>
<span class="lineno"></span><span class="comment" id="6138588">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="6138662">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="6138708">//</span><br>
<span class="lineno">450</span><span class="comment" id="6138711">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="6138751">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="6138815">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="6138878">//</span><br>
<span class="lineno"></span><span class="comment" id="6138881">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="6138949">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="6138993">//</span><br>
<span class="lineno"></span><span class="keyword" id="6138996">func</span>&nbsp;<span class="op" id="6139001">(</span><span class="ident" id="6139002">ctxt</span>&nbsp;<span class="op" id="6139007">*</span><span class="ident" id="6139008">Context</span><span class="op" id="6139015">)</span>&nbsp;<span class="ident" id="6139017">Import</span><span class="op" id="6139023">(</span><span class="ident" id="6139024">path</span>&nbsp;<span class="builtintype" id="6139029">string</span><span class="op" id="6139035">,</span>&nbsp;<span class="ident" id="6139037">srcDir</span>&nbsp;<span class="builtintype" id="6139044">string</span><span class="op" id="6139050">,</span>&nbsp;<span class="ident" id="6139052">mode</span>&nbsp;<span class="ident" id="6139057">ImportMode</span><span class="op" id="6139067">)</span>&nbsp;<span class="op" id="6139069">(</span><span class="op" id="6139070">*</span><span class="ident" id="6139071">Package</span><span class="op" id="6139078">,</span>&nbsp;<span class="builtintype" id="6139080">error</span><span class="op" id="6139085">)</span>&nbsp;<span class="op" id="6139087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139090">p</span>&nbsp;<span class="op" id="6139092">:=</span>&nbsp;<span class="op" id="6139095">&amp;</span><span class="ident" id="6139096">Package</span><span class="op" id="6139103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139107">ImportPath</span><span class="op" id="6139117">:</span>&nbsp;<span class="ident" id="6139119">path</span><span class="op" id="6139123">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139129">if</span>&nbsp;<span class="ident" id="6139132">path</span>&nbsp;<span class="op" id="6139137">==</span>&nbsp;<span class="string" id="6139140">&#34;&#34;</span>&nbsp;<span class="op" id="6139143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139147">return</span>&nbsp;<span class="ident" id="6139154">p</span><span class="op" id="6139155">,</span>&nbsp;<span class="ident" id="6139157">fmt</span><span class="op" id="6139160">.</span><span class="ident" id="6139161">Errorf</span><span class="op" id="6139167">(</span><span class="string" id="6139168">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="6139200">,</span>&nbsp;<span class="ident" id="6139202">path</span><span class="op" id="6139206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139213">var</span>&nbsp;<span class="ident" id="6139217">pkga</span>&nbsp;<span class="builtintype" id="6139222">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139230">var</span>&nbsp;<span class="ident" id="6139234">pkgerr</span>&nbsp;<span class="builtintype" id="6139241">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139248">switch</span>&nbsp;<span class="ident" id="6139255">ctxt</span><span class="op" id="6139259">.</span><span class="ident" id="6139260">Compiler</span>&nbsp;<span class="op" id="6139269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139272">case</span>&nbsp;<span class="string" id="6139277">&#34;gccgo&#34;</span><span class="op" id="6139284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139288">dir</span><span class="op" id="6139291">,</span>&nbsp;<span class="ident" id="6139293">elem</span>&nbsp;<span class="op" id="6139298">:=</span>&nbsp;<span class="ident" id="6139301">pathpkg</span><span class="op" id="6139308">.</span><span class="ident" id="6139309">Split</span><span class="op" id="6139314">(</span><span class="ident" id="6139315">p</span><span class="op" id="6139316">.</span><span class="ident" id="6139317">ImportPath</span><span class="op" id="6139327">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139331">pkga</span>&nbsp;<span class="op" id="6139336">=</span>&nbsp;<span class="string" id="6139338">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="6139351">+</span>&nbsp;<span class="ident" id="6139353">ctxt</span><span class="op" id="6139357">.</span><span class="ident" id="6139358">GOOS</span>&nbsp;<span class="op" id="6139363">+</span>&nbsp;<span class="string" id="6139365">&#34;_&#34;</span>&nbsp;<span class="op" id="6139369">+</span>&nbsp;<span class="ident" id="6139371">ctxt</span><span class="op" id="6139375">.</span><span class="ident" id="6139376">GOARCH</span>&nbsp;<span class="op" id="6139383">+</span>&nbsp;<span class="string" id="6139385">&#34;/&#34;</span>&nbsp;<span class="op" id="6139389">+</span>&nbsp;<span class="ident" id="6139391">dir</span>&nbsp;<span class="op" id="6139395">+</span>&nbsp;<span class="string" id="6139397">&#34;lib&#34;</span>&nbsp;<span class="op" id="6139403">+</span>&nbsp;<span class="ident" id="6139405">elem</span>&nbsp;<span class="op" id="6139410">+</span>&nbsp;<span class="string" id="6139412">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139418">case</span>&nbsp;<span class="string" id="6139423">&#34;gc&#34;</span><span class="op" id="6139427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139431">suffix</span>&nbsp;<span class="op" id="6139438">:=</span>&nbsp;<span class="string" id="6139441">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139446">if</span>&nbsp;<span class="ident" id="6139449">ctxt</span><span class="op" id="6139453">.</span><span class="ident" id="6139454">InstallSuffix</span>&nbsp;<span class="op" id="6139468">!=</span>&nbsp;<span class="string" id="6139471">&#34;&#34;</span>&nbsp;<span class="op" id="6139474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139479">suffix</span>&nbsp;<span class="op" id="6139486">=</span>&nbsp;<span class="string" id="6139488">&#34;_&#34;</span>&nbsp;<span class="op" id="6139492">+</span>&nbsp;<span class="ident" id="6139494">ctxt</span><span class="op" id="6139498">.</span><span class="ident" id="6139499">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139519">pkga</span>&nbsp;<span class="op" id="6139524">=</span>&nbsp;<span class="string" id="6139526">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="6139533">+</span>&nbsp;<span class="ident" id="6139535">ctxt</span><span class="op" id="6139539">.</span><span class="ident" id="6139540">GOOS</span>&nbsp;<span class="op" id="6139545">+</span>&nbsp;<span class="string" id="6139547">&#34;_&#34;</span>&nbsp;<span class="op" id="6139551">+</span>&nbsp;<span class="ident" id="6139553">ctxt</span><span class="op" id="6139557">.</span><span class="ident" id="6139558">GOARCH</span>&nbsp;<span class="op" id="6139565">+</span>&nbsp;<span class="ident" id="6139567">suffix</span>&nbsp;<span class="op" id="6139574">+</span>&nbsp;<span class="string" id="6139576">&#34;/&#34;</span>&nbsp;<span class="op" id="6139580">+</span>&nbsp;<span class="ident" id="6139582">p</span><span class="op" id="6139583">.</span><span class="ident" id="6139584">ImportPath</span>&nbsp;<span class="op" id="6139595">+</span>&nbsp;<span class="string" id="6139597">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139603">default</span><span class="op" id="6139610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6139614">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139651">pkgerr</span>&nbsp;<span class="op" id="6139658">=</span>&nbsp;<span class="ident" id="6139660">fmt</span><span class="op" id="6139663">.</span><span class="ident" id="6139664">Errorf</span><span class="op" id="6139670">(</span><span class="string" id="6139671">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="6139703">,</span>&nbsp;<span class="ident" id="6139705">path</span><span class="op" id="6139709">,</span>&nbsp;<span class="ident" id="6139711">ctxt</span><span class="op" id="6139715">.</span><span class="ident" id="6139716">Compiler</span><span class="op" id="6139724">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139731">binaryOnly</span>&nbsp;<span class="op" id="6139742">:=</span>&nbsp;<span class="builtintype" id="6139745">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139752">if</span>&nbsp;<span class="ident" id="6139755">IsLocalImport</span><span class="op" id="6139768">(</span><span class="ident" id="6139769">path</span><span class="op" id="6139773">)</span>&nbsp;<span class="op" id="6139775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139779">pkga</span>&nbsp;<span class="op" id="6139784">=</span>&nbsp;<span class="string" id="6139786">&#34;&#34;</span>&nbsp;<span class="comment" id="6139789">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139831">if</span>&nbsp;<span class="ident" id="6139834">srcDir</span>&nbsp;<span class="op" id="6139841">==</span>&nbsp;<span class="string" id="6139844">&#34;&#34;</span>&nbsp;<span class="op" id="6139847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139852">return</span>&nbsp;<span class="ident" id="6139859">p</span><span class="op" id="6139860">,</span>&nbsp;<span class="ident" id="6139862">fmt</span><span class="op" id="6139865">.</span><span class="ident" id="6139866">Errorf</span><span class="op" id="6139872">(</span><span class="string" id="6139873">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="6139922">,</span>&nbsp;<span class="ident" id="6139924">path</span><span class="op" id="6139928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139936">if</span>&nbsp;<span class="op" id="6139939">!</span><span class="ident" id="6139940">ctxt</span><span class="op" id="6139944">.</span><span class="ident" id="6139945">isAbsPath</span><span class="op" id="6139954">(</span><span class="ident" id="6139955">path</span><span class="op" id="6139959">)</span>&nbsp;<span class="op" id="6139961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139966">p</span><span class="op" id="6139967">.</span><span class="ident" id="6139968">Dir</span>&nbsp;<span class="op" id="6139972">=</span>&nbsp;<span class="ident" id="6139974">ctxt</span><span class="op" id="6139978">.</span><span class="ident" id="6139979">joinPath</span><span class="op" id="6139987">(</span><span class="ident" id="6139988">srcDir</span><span class="op" id="6139994">,</span>&nbsp;<span class="ident" id="6139996">path</span><span class="op" id="6140000">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140008">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140054">if</span>&nbsp;<span class="ident" id="6140057">ctxt</span><span class="op" id="6140061">.</span><span class="ident" id="6140062">GOROOT</span>&nbsp;<span class="op" id="6140069">!=</span>&nbsp;<span class="string" id="6140072">&#34;&#34;</span>&nbsp;<span class="op" id="6140075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140080">root</span>&nbsp;<span class="op" id="6140085">:=</span>&nbsp;<span class="ident" id="6140088">ctxt</span><span class="op" id="6140092">.</span><span class="ident" id="6140093">joinPath</span><span class="op" id="6140101">(</span><span class="ident" id="6140102">ctxt</span><span class="op" id="6140106">.</span><span class="ident" id="6140107">GOROOT</span><span class="op" id="6140113">,</span>&nbsp;<span class="string" id="6140115">&#34;src&#34;</span><span class="op" id="6140120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140125">if</span>&nbsp;<span class="ident" id="6140128">sub</span><span class="op" id="6140131">,</span>&nbsp;<span class="ident" id="6140133">ok</span>&nbsp;<span class="op" id="6140136">:=</span>&nbsp;<span class="ident" id="6140139">ctxt</span><span class="op" id="6140143">.</span><span class="ident" id="6140144">hasSubdir</span><span class="op" id="6140153">(</span><span class="ident" id="6140154">root</span><span class="op" id="6140158">,</span>&nbsp;<span class="ident" id="6140160">p</span><span class="op" id="6140161">.</span><span class="ident" id="6140162">Dir</span><span class="op" id="6140165">)</span><span class="op" id="6140166">;</span>&nbsp;<span class="ident" id="6140168">ok</span>&nbsp;<span class="op" id="6140171">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140177">p</span><span class="op" id="6140178">.</span><span class="ident" id="6140179">Goroot</span>&nbsp;<span class="op" id="6140186">=</span>&nbsp;<span class="builtintype" id="6140188">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140197">p</span><span class="op" id="6140198">.</span><span class="ident" id="6140199">ImportPath</span>&nbsp;<span class="op" id="6140210">=</span>&nbsp;<span class="ident" id="6140212">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140220">p</span><span class="op" id="6140221">.</span><span class="ident" id="6140222">Root</span>&nbsp;<span class="op" id="6140227">=</span>&nbsp;<span class="ident" id="6140229">ctxt</span><span class="op" id="6140233">.</span><span class="ident" id="6140234">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140245">goto</span>&nbsp;<span class="ident" id="6140250">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140259">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140267">all</span>&nbsp;<span class="op" id="6140271">:=</span>&nbsp;<span class="ident" id="6140274">ctxt</span><span class="op" id="6140278">.</span><span class="ident" id="6140279">gopath</span><span class="op" id="6140285">(</span><span class="op" id="6140286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140290">for</span>&nbsp;<span class="ident" id="6140294">i</span><span class="op" id="6140295">,</span>&nbsp;<span class="ident" id="6140297">root</span>&nbsp;<span class="op" id="6140302">:=</span>&nbsp;<span class="keyword" id="6140305">range</span>&nbsp;<span class="ident" id="6140311">all</span>&nbsp;<span class="op" id="6140315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140320">rootsrc</span>&nbsp;<span class="op" id="6140328">:=</span>&nbsp;<span class="ident" id="6140331">ctxt</span><span class="op" id="6140335">.</span><span class="ident" id="6140336">joinPath</span><span class="op" id="6140344">(</span><span class="ident" id="6140345">root</span><span class="op" id="6140349">,</span>&nbsp;<span class="string" id="6140351">&#34;src&#34;</span><span class="op" id="6140356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140361">if</span>&nbsp;<span class="ident" id="6140364">sub</span><span class="op" id="6140367">,</span>&nbsp;<span class="ident" id="6140369">ok</span>&nbsp;<span class="op" id="6140372">:=</span>&nbsp;<span class="ident" id="6140375">ctxt</span><span class="op" id="6140379">.</span><span class="ident" id="6140380">hasSubdir</span><span class="op" id="6140389">(</span><span class="ident" id="6140390">rootsrc</span><span class="op" id="6140397">,</span>&nbsp;<span class="ident" id="6140399">p</span><span class="op" id="6140400">.</span><span class="ident" id="6140401">Dir</span><span class="op" id="6140404">)</span><span class="op" id="6140405">;</span>&nbsp;<span class="ident" id="6140407">ok</span>&nbsp;<span class="op" id="6140410">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140416">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140465">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140520">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140539">if</span>&nbsp;<span class="ident" id="6140542">ctxt</span><span class="op" id="6140546">.</span><span class="ident" id="6140547">GOROOT</span>&nbsp;<span class="op" id="6140554">!=</span>&nbsp;<span class="string" id="6140557">&#34;&#34;</span>&nbsp;<span class="op" id="6140560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140567">if</span>&nbsp;<span class="ident" id="6140570">dir</span>&nbsp;<span class="op" id="6140574">:=</span>&nbsp;<span class="ident" id="6140577">ctxt</span><span class="op" id="6140581">.</span><span class="ident" id="6140582">joinPath</span><span class="op" id="6140590">(</span><span class="ident" id="6140591">ctxt</span><span class="op" id="6140595">.</span><span class="ident" id="6140596">GOROOT</span><span class="op" id="6140602">,</span>&nbsp;<span class="string" id="6140604">&#34;src&#34;</span><span class="op" id="6140609">,</span>&nbsp;<span class="ident" id="6140611">sub</span><span class="op" id="6140614">)</span><span class="op" id="6140615">;</span>&nbsp;<span class="ident" id="6140617">ctxt</span><span class="op" id="6140621">.</span><span class="ident" id="6140622">isDir</span><span class="op" id="6140627">(</span><span class="ident" id="6140628">dir</span><span class="op" id="6140631">)</span>&nbsp;<span class="op" id="6140633">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140641">p</span><span class="op" id="6140642">.</span><span class="ident" id="6140643">ConflictDir</span>&nbsp;<span class="op" id="6140655">=</span>&nbsp;<span class="ident" id="6140657">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140667">goto</span>&nbsp;<span class="ident" id="6140672">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140695">for</span>&nbsp;<span class="ident" id="6140699">_</span><span class="op" id="6140700">,</span>&nbsp;<span class="ident" id="6140702">earlyRoot</span>&nbsp;<span class="op" id="6140712">:=</span>&nbsp;<span class="keyword" id="6140715">range</span>&nbsp;<span class="ident" id="6140721">all</span><span class="op" id="6140724">[</span><span class="op" id="6140725">:</span><span class="ident" id="6140726">i</span><span class="op" id="6140727">]</span>&nbsp;<span class="op" id="6140729">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140736">if</span>&nbsp;<span class="ident" id="6140739">dir</span>&nbsp;<span class="op" id="6140743">:=</span>&nbsp;<span class="ident" id="6140746">ctxt</span><span class="op" id="6140750">.</span><span class="ident" id="6140751">joinPath</span><span class="op" id="6140759">(</span><span class="ident" id="6140760">earlyRoot</span><span class="op" id="6140769">,</span>&nbsp;<span class="string" id="6140771">&#34;src&#34;</span><span class="op" id="6140776">,</span>&nbsp;<span class="ident" id="6140778">sub</span><span class="op" id="6140781">)</span><span class="op" id="6140782">;</span>&nbsp;<span class="ident" id="6140784">ctxt</span><span class="op" id="6140788">.</span><span class="ident" id="6140789">isDir</span><span class="op" id="6140794">(</span><span class="ident" id="6140795">dir</span><span class="op" id="6140798">)</span>&nbsp;<span class="op" id="6140800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140808">p</span><span class="op" id="6140809">.</span><span class="ident" id="6140810">ConflictDir</span>&nbsp;<span class="op" id="6140822">=</span>&nbsp;<span class="ident" id="6140824">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140834">goto</span>&nbsp;<span class="ident" id="6140839">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6140856">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140863">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6140931">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140949">p</span><span class="op" id="6140950">.</span><span class="ident" id="6140951">ImportPath</span>&nbsp;<span class="op" id="6140962">=</span>&nbsp;<span class="ident" id="6140964">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6140972">p</span><span class="op" id="6140973">.</span><span class="ident" id="6140974">Root</span>&nbsp;<span class="op" id="6140979">=</span>&nbsp;<span class="ident" id="6140981">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6140990">goto</span>&nbsp;<span class="ident" id="6140995">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6141012">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6141070">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141115">}</span>&nbsp;<span class="keyword" id="6141117">else</span>&nbsp;<span class="op" id="6141122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141126">if</span>&nbsp;<span class="ident" id="6141129">strings</span><span class="op" id="6141136">.</span><span class="ident" id="6141137">HasPrefix</span><span class="op" id="6141146">(</span><span class="ident" id="6141147">path</span><span class="op" id="6141151">,</span>&nbsp;<span class="string" id="6141153">&#34;/&#34;</span><span class="op" id="6141156">)</span>&nbsp;<span class="op" id="6141158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141163">return</span>&nbsp;<span class="ident" id="6141170">p</span><span class="op" id="6141171">,</span>&nbsp;<span class="ident" id="6141173">fmt</span><span class="op" id="6141176">.</span><span class="ident" id="6141177">Errorf</span><span class="op" id="6141183">(</span><span class="string" id="6141184">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="6141224">,</span>&nbsp;<span class="ident" id="6141226">path</span><span class="op" id="6141230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6141239">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141303">var</span>&nbsp;<span class="ident" id="6141307">tried</span>&nbsp;<span class="keyword" id="6141313">struct</span>&nbsp;<span class="op" id="6141320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141325">goroot</span>&nbsp;<span class="builtintype" id="6141332">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141342">gopath</span>&nbsp;<span class="op" id="6141349">[</span><span class="op" id="6141350">]</span><span class="builtintype" id="6141351">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141360">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6141365">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141408">if</span>&nbsp;<span class="ident" id="6141411">ctxt</span><span class="op" id="6141415">.</span><span class="ident" id="6141416">GOROOT</span>&nbsp;<span class="op" id="6141423">!=</span>&nbsp;<span class="string" id="6141426">&#34;&#34;</span>&nbsp;<span class="op" id="6141429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141434">dir</span>&nbsp;<span class="op" id="6141438">:=</span>&nbsp;<span class="ident" id="6141441">ctxt</span><span class="op" id="6141445">.</span><span class="ident" id="6141446">joinPath</span><span class="op" id="6141454">(</span><span class="ident" id="6141455">ctxt</span><span class="op" id="6141459">.</span><span class="ident" id="6141460">GOROOT</span><span class="op" id="6141466">,</span>&nbsp;<span class="string" id="6141468">&#34;src&#34;</span><span class="op" id="6141473">,</span>&nbsp;<span class="ident" id="6141475">path</span><span class="op" id="6141479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141484">isDir</span>&nbsp;<span class="op" id="6141490">:=</span>&nbsp;<span class="ident" id="6141493">ctxt</span><span class="op" id="6141497">.</span><span class="ident" id="6141498">isDir</span><span class="op" id="6141503">(</span><span class="ident" id="6141504">dir</span><span class="op" id="6141507">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141512">binaryOnly</span>&nbsp;<span class="op" id="6141523">=</span>&nbsp;<span class="op" id="6141525">!</span><span class="ident" id="6141526">isDir</span>&nbsp;<span class="op" id="6141532">&amp;&amp;</span>&nbsp;<span class="ident" id="6141535">mode</span><span class="op" id="6141539">&amp;</span><span class="ident" id="6141540">AllowBinary</span>&nbsp;<span class="op" id="6141552">!=</span>&nbsp;<span class="num" id="6141555">0</span>&nbsp;<span class="op" id="6141557">&amp;&amp;</span>&nbsp;<span class="ident" id="6141560">pkga</span>&nbsp;<span class="op" id="6141565">!=</span>&nbsp;<span class="string" id="6141568">&#34;&#34;</span>&nbsp;<span class="op" id="6141571">&amp;&amp;</span>&nbsp;<span class="ident" id="6141574">ctxt</span><span class="op" id="6141578">.</span><span class="ident" id="6141579">isFile</span><span class="op" id="6141585">(</span><span class="ident" id="6141586">ctxt</span><span class="op" id="6141590">.</span><span class="ident" id="6141591">joinPath</span><span class="op" id="6141599">(</span><span class="ident" id="6141600">ctxt</span><span class="op" id="6141604">.</span><span class="ident" id="6141605">GOROOT</span><span class="op" id="6141611">,</span>&nbsp;<span class="ident" id="6141613">pkga</span><span class="op" id="6141617">)</span><span class="op" id="6141618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141623">if</span>&nbsp;<span class="ident" id="6141626">isDir</span>&nbsp;<span class="op" id="6141632">||</span>&nbsp;<span class="ident" id="6141635">binaryOnly</span>&nbsp;<span class="op" id="6141646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141652">p</span><span class="op" id="6141653">.</span><span class="ident" id="6141654">Dir</span>&nbsp;<span class="op" id="6141658">=</span>&nbsp;<span class="ident" id="6141660">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141668">p</span><span class="op" id="6141669">.</span><span class="ident" id="6141670">Goroot</span>&nbsp;<span class="op" id="6141677">=</span>&nbsp;<span class="builtintype" id="6141679">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141688">p</span><span class="op" id="6141689">.</span><span class="ident" id="6141690">Root</span>&nbsp;<span class="op" id="6141695">=</span>&nbsp;<span class="ident" id="6141697">ctxt</span><span class="op" id="6141701">.</span><span class="ident" id="6141702">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141713">goto</span>&nbsp;<span class="ident" id="6141718">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141732">tried</span><span class="op" id="6141737">.</span><span class="ident" id="6141738">goroot</span>&nbsp;<span class="op" id="6141745">=</span>&nbsp;<span class="ident" id="6141747">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6141753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141757">for</span>&nbsp;<span class="ident" id="6141761">_</span><span class="op" id="6141762">,</span>&nbsp;<span class="ident" id="6141764">root</span>&nbsp;<span class="op" id="6141769">:=</span>&nbsp;<span class="keyword" id="6141772">range</span>&nbsp;<span class="ident" id="6141778">ctxt</span><span class="op" id="6141782">.</span><span class="ident" id="6141783">gopath</span><span class="op" id="6141789">(</span><span class="op" id="6141790">)</span>&nbsp;<span class="op" id="6141792">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141797">dir</span>&nbsp;<span class="op" id="6141801">:=</span>&nbsp;<span class="ident" id="6141804">ctxt</span><span class="op" id="6141808">.</span><span class="ident" id="6141809">joinPath</span><span class="op" id="6141817">(</span><span class="ident" id="6141818">root</span><span class="op" id="6141822">,</span>&nbsp;<span class="string" id="6141824">&#34;src&#34;</span><span class="op" id="6141829">,</span>&nbsp;<span class="ident" id="6141831">path</span><span class="op" id="6141835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141840">isDir</span>&nbsp;<span class="op" id="6141846">:=</span>&nbsp;<span class="ident" id="6141849">ctxt</span><span class="op" id="6141853">.</span><span class="ident" id="6141854">isDir</span><span class="op" id="6141859">(</span><span class="ident" id="6141860">dir</span><span class="op" id="6141863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6141868">binaryOnly</span>&nbsp;<span class="op" id="6141879">=</span>&nbsp;<span class="op" id="6141881">!</span><span class="ident" id="6141882">isDir</span>&nbsp;<span class="op" id="6141888">&amp;&amp;</span>&nbsp;<span class="ident" id="6141891">mode</span><span class="op" id="6141895">&amp;</span><span class="ident" id="6141896">AllowBinary</span>&nbsp;<span class="op" id="6141908">!=</span>&nbsp;<span class="num" id="6141911">0</span>&nbsp;<span class="op" id="6141913">&amp;&amp;</span>&nbsp;<span class="ident" id="6141916">pkga</span>&nbsp;<span class="op" id="6141921">!=</span>&nbsp;<span class="string" id="6141924">&#34;&#34;</span>&nbsp;<span class="op" id="6141927">&amp;&amp;</span>&nbsp;<span class="ident" id="6141930">ctxt</span><span class="op" id="6141934">.</span><span class="ident" id="6141935">isFile</span><span class="op" id="6141941">(</span><span class="ident" id="6141942">ctxt</span><span class="op" id="6141946">.</span><span class="ident" id="6141947">joinPath</span><span class="op" id="6141955">(</span><span class="ident" id="6141956">root</span><span class="op" id="6141960">,</span>&nbsp;<span class="ident" id="6141962">pkga</span><span class="op" id="6141966">)</span><span class="op" id="6141967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6141972">if</span>&nbsp;<span class="ident" id="6141975">isDir</span>&nbsp;<span class="op" id="6141981">||</span>&nbsp;<span class="ident" id="6141984">binaryOnly</span>&nbsp;<span class="op" id="6141995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142001">p</span><span class="op" id="6142002">.</span><span class="ident" id="6142003">Dir</span>&nbsp;<span class="op" id="6142007">=</span>&nbsp;<span class="ident" id="6142009">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142017">p</span><span class="op" id="6142018">.</span><span class="ident" id="6142019">Root</span>&nbsp;<span class="op" id="6142024">=</span>&nbsp;<span class="ident" id="6142026">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142035">goto</span>&nbsp;<span class="ident" id="6142040">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142054">tried</span><span class="op" id="6142059">.</span><span class="ident" id="6142060">gopath</span>&nbsp;<span class="op" id="6142067">=</span>&nbsp;<span class="builtinfunc" id="6142069">append</span><span class="op" id="6142075">(</span><span class="ident" id="6142076">tried</span><span class="op" id="6142081">.</span><span class="ident" id="6142082">gopath</span><span class="op" id="6142088">,</span>&nbsp;<span class="ident" id="6142090">dir</span><span class="op" id="6142093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142097">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6142102">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142129">var</span>&nbsp;<span class="ident" id="6142133">paths</span>&nbsp;<span class="op" id="6142139">[</span><span class="op" id="6142140">]</span><span class="builtintype" id="6142141">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142150">if</span>&nbsp;<span class="ident" id="6142153">tried</span><span class="op" id="6142158">.</span><span class="ident" id="6142159">goroot</span>&nbsp;<span class="op" id="6142166">!=</span>&nbsp;<span class="string" id="6142169">&#34;&#34;</span>&nbsp;<span class="op" id="6142172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142177">paths</span>&nbsp;<span class="op" id="6142183">=</span>&nbsp;<span class="builtinfunc" id="6142185">append</span><span class="op" id="6142191">(</span><span class="ident" id="6142192">paths</span><span class="op" id="6142197">,</span>&nbsp;<span class="ident" id="6142199">fmt</span><span class="op" id="6142202">.</span><span class="ident" id="6142203">Sprintf</span><span class="op" id="6142210">(</span><span class="string" id="6142211">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="6142232">,</span>&nbsp;<span class="ident" id="6142234">tried</span><span class="op" id="6142239">.</span><span class="ident" id="6142240">goroot</span><span class="op" id="6142246">)</span><span class="op" id="6142247">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142251">}</span>&nbsp;<span class="keyword" id="6142253">else</span>&nbsp;<span class="op" id="6142258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142263">paths</span>&nbsp;<span class="op" id="6142269">=</span>&nbsp;<span class="builtinfunc" id="6142271">append</span><span class="op" id="6142277">(</span><span class="ident" id="6142278">paths</span><span class="op" id="6142283">,</span>&nbsp;<span class="string" id="6142285">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6142306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142314">var</span>&nbsp;<span class="ident" id="6142318">i</span>&nbsp;<span class="builtintype" id="6142320">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142326">var</span>&nbsp;<span class="ident" id="6142330">format</span>&nbsp;<span class="op" id="6142337">=</span>&nbsp;<span class="string" id="6142339">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142363">for</span>&nbsp;<span class="op" id="6142367">;</span>&nbsp;<span class="ident" id="6142369">i</span>&nbsp;<span class="op" id="6142371">&lt;</span>&nbsp;<span class="builtinfunc" id="6142373">len</span><span class="op" id="6142376">(</span><span class="ident" id="6142377">tried</span><span class="op" id="6142382">.</span><span class="ident" id="6142383">gopath</span><span class="op" id="6142389">)</span><span class="op" id="6142390">;</span>&nbsp;<span class="ident" id="6142392">i</span><span class="op" id="6142393">++</span>&nbsp;<span class="op" id="6142396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142401">if</span>&nbsp;<span class="ident" id="6142404">i</span>&nbsp;<span class="op" id="6142406">&gt;</span>&nbsp;<span class="num" id="6142408">0</span>&nbsp;<span class="op" id="6142410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142416">format</span>&nbsp;<span class="op" id="6142423">=</span>&nbsp;<span class="string" id="6142425">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142440">paths</span>&nbsp;<span class="op" id="6142446">=</span>&nbsp;<span class="builtinfunc" id="6142448">append</span><span class="op" id="6142454">(</span><span class="ident" id="6142455">paths</span><span class="op" id="6142460">,</span>&nbsp;<span class="ident" id="6142462">fmt</span><span class="op" id="6142465">.</span><span class="ident" id="6142466">Sprintf</span><span class="op" id="6142473">(</span><span class="ident" id="6142474">format</span><span class="op" id="6142480">,</span>&nbsp;<span class="ident" id="6142482">tried</span><span class="op" id="6142487">.</span><span class="ident" id="6142488">gopath</span><span class="op" id="6142494">[</span><span class="ident" id="6142495">i</span><span class="op" id="6142496">]</span><span class="op" id="6142497">)</span><span class="op" id="6142498">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142506">if</span>&nbsp;<span class="ident" id="6142509">i</span>&nbsp;<span class="op" id="6142511">==</span>&nbsp;<span class="num" id="6142514">0</span>&nbsp;<span class="op" id="6142516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142521">paths</span>&nbsp;<span class="op" id="6142527">=</span>&nbsp;<span class="builtinfunc" id="6142529">append</span><span class="op" id="6142535">(</span><span class="ident" id="6142536">paths</span><span class="op" id="6142541">,</span>&nbsp;<span class="string" id="6142543">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6142564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142572">return</span>&nbsp;<span class="ident" id="6142579">p</span><span class="op" id="6142580">,</span>&nbsp;<span class="ident" id="6142582">fmt</span><span class="op" id="6142585">.</span><span class="ident" id="6142586">Errorf</span><span class="op" id="6142592">(</span><span class="string" id="6142593">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="6142632">,</span>&nbsp;<span class="ident" id="6142634">path</span><span class="op" id="6142638">,</span>&nbsp;<span class="ident" id="6142640">strings</span><span class="op" id="6142647">.</span><span class="ident" id="6142648">Join</span><span class="op" id="6142652">(</span><span class="ident" id="6142653">paths</span><span class="op" id="6142658">,</span>&nbsp;<span class="string" id="6142660">&#34;\n&#34;</span><span class="op" id="6142664">)</span><span class="op" id="6142665">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6142671">Found</span><span class="op" id="6142676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142679">if</span>&nbsp;<span class="ident" id="6142682">p</span><span class="op" id="6142683">.</span><span class="ident" id="6142684">Root</span>&nbsp;<span class="op" id="6142689">!=</span>&nbsp;<span class="string" id="6142692">&#34;&#34;</span>&nbsp;<span class="op" id="6142695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142699">p</span><span class="op" id="6142700">.</span><span class="ident" id="6142701">SrcRoot</span>&nbsp;<span class="op" id="6142709">=</span>&nbsp;<span class="ident" id="6142711">ctxt</span><span class="op" id="6142715">.</span><span class="ident" id="6142716">joinPath</span><span class="op" id="6142724">(</span><span class="ident" id="6142725">p</span><span class="op" id="6142726">.</span><span class="ident" id="6142727">Root</span><span class="op" id="6142731">,</span>&nbsp;<span class="string" id="6142733">&#34;src&#34;</span><span class="op" id="6142738">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142742">p</span><span class="op" id="6142743">.</span><span class="ident" id="6142744">PkgRoot</span>&nbsp;<span class="op" id="6142752">=</span>&nbsp;<span class="ident" id="6142754">ctxt</span><span class="op" id="6142758">.</span><span class="ident" id="6142759">joinPath</span><span class="op" id="6142767">(</span><span class="ident" id="6142768">p</span><span class="op" id="6142769">.</span><span class="ident" id="6142770">Root</span><span class="op" id="6142774">,</span>&nbsp;<span class="string" id="6142776">&#34;pkg&#34;</span><span class="op" id="6142781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142785">p</span><span class="op" id="6142786">.</span><span class="ident" id="6142787">BinDir</span>&nbsp;<span class="op" id="6142794">=</span>&nbsp;<span class="ident" id="6142796">ctxt</span><span class="op" id="6142800">.</span><span class="ident" id="6142801">joinPath</span><span class="op" id="6142809">(</span><span class="ident" id="6142810">p</span><span class="op" id="6142811">.</span><span class="ident" id="6142812">Root</span><span class="op" id="6142816">,</span>&nbsp;<span class="string" id="6142818">&#34;bin&#34;</span><span class="op" id="6142823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142827">if</span>&nbsp;<span class="ident" id="6142830">pkga</span>&nbsp;<span class="op" id="6142835">!=</span>&nbsp;<span class="string" id="6142838">&#34;&#34;</span>&nbsp;<span class="op" id="6142841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6142846">p</span><span class="op" id="6142847">.</span><span class="ident" id="6142848">PkgObj</span>&nbsp;<span class="op" id="6142855">=</span>&nbsp;<span class="ident" id="6142857">ctxt</span><span class="op" id="6142861">.</span><span class="ident" id="6142862">joinPath</span><span class="op" id="6142870">(</span><span class="ident" id="6142871">p</span><span class="op" id="6142872">.</span><span class="ident" id="6142873">Root</span><span class="op" id="6142877">,</span>&nbsp;<span class="ident" id="6142879">pkga</span><span class="op" id="6142883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142887">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142894">if</span>&nbsp;<span class="ident" id="6142897">mode</span><span class="op" id="6142901">&amp;</span><span class="ident" id="6142902">FindOnly</span>&nbsp;<span class="op" id="6142911">!=</span>&nbsp;<span class="num" id="6142914">0</span>&nbsp;<span class="op" id="6142916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142920">return</span>&nbsp;<span class="ident" id="6142927">p</span><span class="op" id="6142928">,</span>&nbsp;<span class="ident" id="6142930">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6142938">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142941">if</span>&nbsp;<span class="ident" id="6142944">binaryOnly</span>&nbsp;<span class="op" id="6142955">&amp;&amp;</span>&nbsp;<span class="op" id="6142958">(</span><span class="ident" id="6142959">mode</span><span class="op" id="6142963">&amp;</span><span class="ident" id="6142964">AllowBinary</span><span class="op" id="6142975">)</span>&nbsp;<span class="op" id="6142977">!=</span>&nbsp;<span class="num" id="6142980">0</span>&nbsp;<span class="op" id="6142982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6142986">return</span>&nbsp;<span class="ident" id="6142993">p</span><span class="op" id="6142994">,</span>&nbsp;<span class="ident" id="6142996">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143008">dirs</span><span class="op" id="6143012">,</span>&nbsp;<span class="ident" id="6143014">err</span>&nbsp;<span class="op" id="6143018">:=</span>&nbsp;<span class="ident" id="6143021">ctxt</span><span class="op" id="6143025">.</span><span class="ident" id="6143026">readDir</span><span class="op" id="6143033">(</span><span class="ident" id="6143034">p</span><span class="op" id="6143035">.</span><span class="ident" id="6143036">Dir</span><span class="op" id="6143039">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143042">if</span>&nbsp;<span class="ident" id="6143045">err</span>&nbsp;<span class="op" id="6143049">!=</span>&nbsp;<span class="ident" id="6143052">nil</span>&nbsp;<span class="op" id="6143056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143060">return</span>&nbsp;<span class="ident" id="6143067">p</span><span class="op" id="6143068">,</span>&nbsp;<span class="ident" id="6143070">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143079">var</span>&nbsp;<span class="ident" id="6143083">Sfiles</span>&nbsp;<span class="op" id="6143090">[</span><span class="op" id="6143091">]</span><span class="builtintype" id="6143092">string</span>&nbsp;<span class="comment" id="6143099">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143131">var</span>&nbsp;<span class="ident" id="6143135">firstFile</span><span class="op" id="6143144">,</span>&nbsp;<span class="ident" id="6143146">firstCommentFile</span>&nbsp;<span class="builtintype" id="6143163">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143171">imported</span>&nbsp;<span class="op" id="6143180">:=</span>&nbsp;<span class="builtinfunc" id="6143183">make</span><span class="op" id="6143187">(</span><span class="keyword" id="6143188">map</span><span class="op" id="6143191">[</span><span class="builtintype" id="6143192">string</span><span class="op" id="6143198">]</span><span class="op" id="6143199">[</span><span class="op" id="6143200">]</span><span class="ident" id="6143201">token</span><span class="op" id="6143206">.</span><span class="ident" id="6143207">Position</span><span class="op" id="6143215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143218">testImported</span>&nbsp;<span class="op" id="6143231">:=</span>&nbsp;<span class="builtinfunc" id="6143234">make</span><span class="op" id="6143238">(</span><span class="keyword" id="6143239">map</span><span class="op" id="6143242">[</span><span class="builtintype" id="6143243">string</span><span class="op" id="6143249">]</span><span class="op" id="6143250">[</span><span class="op" id="6143251">]</span><span class="ident" id="6143252">token</span><span class="op" id="6143257">.</span><span class="ident" id="6143258">Position</span><span class="op" id="6143266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143269">xTestImported</span>&nbsp;<span class="op" id="6143283">:=</span>&nbsp;<span class="builtinfunc" id="6143286">make</span><span class="op" id="6143290">(</span><span class="keyword" id="6143291">map</span><span class="op" id="6143294">[</span><span class="builtintype" id="6143295">string</span><span class="op" id="6143301">]</span><span class="op" id="6143302">[</span><span class="op" id="6143303">]</span><span class="ident" id="6143304">token</span><span class="op" id="6143309">.</span><span class="ident" id="6143310">Position</span><span class="op" id="6143318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143321">allTags</span>&nbsp;<span class="op" id="6143329">:=</span>&nbsp;<span class="builtinfunc" id="6143332">make</span><span class="op" id="6143336">(</span><span class="keyword" id="6143337">map</span><span class="op" id="6143340">[</span><span class="builtintype" id="6143341">string</span><span class="op" id="6143347">]</span><span class="builtintype" id="6143348">bool</span><span class="op" id="6143352">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143355">fset</span>&nbsp;<span class="op" id="6143360">:=</span>&nbsp;<span class="ident" id="6143363">token</span><span class="op" id="6143368">.</span><span class="ident" id="6143369">NewFileSet</span><span class="op" id="6143379">(</span><span class="op" id="6143380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143383">for</span>&nbsp;<span class="ident" id="6143387">_</span><span class="op" id="6143388">,</span>&nbsp;<span class="ident" id="6143390">d</span>&nbsp;<span class="op" id="6143392">:=</span>&nbsp;<span class="keyword" id="6143395">range</span>&nbsp;<span class="ident" id="6143401">dirs</span>&nbsp;<span class="op" id="6143406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143410">if</span>&nbsp;<span class="ident" id="6143413">d</span><span class="op" id="6143414">.</span><span class="ident" id="6143415">IsDir</span><span class="op" id="6143420">(</span><span class="op" id="6143421">)</span>&nbsp;<span class="op" id="6143423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143428">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143439">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143444">name</span>&nbsp;<span class="op" id="6143449">:=</span>&nbsp;<span class="ident" id="6143452">d</span><span class="op" id="6143453">.</span><span class="ident" id="6143454">Name</span><span class="op" id="6143458">(</span><span class="op" id="6143459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143463">ext</span>&nbsp;<span class="op" id="6143467">:=</span>&nbsp;<span class="ident" id="6143470">nameExt</span><span class="op" id="6143477">(</span><span class="ident" id="6143478">name</span><span class="op" id="6143482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143487">match</span><span class="op" id="6143492">,</span>&nbsp;<span class="ident" id="6143494">data</span><span class="op" id="6143498">,</span>&nbsp;<span class="ident" id="6143500">filename</span><span class="op" id="6143508">,</span>&nbsp;<span class="ident" id="6143510">err</span>&nbsp;<span class="op" id="6143514">:=</span>&nbsp;<span class="ident" id="6143517">ctxt</span><span class="op" id="6143521">.</span><span class="ident" id="6143522">matchFile</span><span class="op" id="6143531">(</span><span class="ident" id="6143532">p</span><span class="op" id="6143533">.</span><span class="ident" id="6143534">Dir</span><span class="op" id="6143537">,</span>&nbsp;<span class="ident" id="6143539">name</span><span class="op" id="6143543">,</span>&nbsp;<span class="builtintype" id="6143545">true</span><span class="op" id="6143549">,</span>&nbsp;<span class="ident" id="6143551">allTags</span><span class="op" id="6143558">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143562">if</span>&nbsp;<span class="ident" id="6143565">err</span>&nbsp;<span class="op" id="6143569">!=</span>&nbsp;<span class="ident" id="6143572">nil</span>&nbsp;<span class="op" id="6143576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143581">return</span>&nbsp;<span class="ident" id="6143588">p</span><span class="op" id="6143589">,</span>&nbsp;<span class="ident" id="6143591">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143601">if</span>&nbsp;<span class="op" id="6143604">!</span><span class="ident" id="6143605">match</span>&nbsp;<span class="op" id="6143611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143616">if</span>&nbsp;<span class="ident" id="6143619">ext</span>&nbsp;<span class="op" id="6143623">==</span>&nbsp;<span class="string" id="6143626">&#34;.go&#34;</span>&nbsp;<span class="op" id="6143632">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143638">p</span><span class="op" id="6143639">.</span><span class="ident" id="6143640">IgnoredGoFiles</span>&nbsp;<span class="op" id="6143655">=</span>&nbsp;<span class="builtinfunc" id="6143657">append</span><span class="op" id="6143663">(</span><span class="ident" id="6143664">p</span><span class="op" id="6143665">.</span><span class="ident" id="6143666">IgnoredGoFiles</span><span class="op" id="6143680">,</span>&nbsp;<span class="ident" id="6143682">name</span><span class="op" id="6143686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143696">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6143707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6143712">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143775">switch</span>&nbsp;<span class="ident" id="6143782">ext</span>&nbsp;<span class="op" id="6143786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143790">case</span>&nbsp;<span class="string" id="6143795">&#34;.c&#34;</span><span class="op" id="6143799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143804">p</span><span class="op" id="6143805">.</span><span class="ident" id="6143806">CFiles</span>&nbsp;<span class="op" id="6143813">=</span>&nbsp;<span class="builtinfunc" id="6143815">append</span><span class="op" id="6143821">(</span><span class="ident" id="6143822">p</span><span class="op" id="6143823">.</span><span class="ident" id="6143824">CFiles</span><span class="op" id="6143830">,</span>&nbsp;<span class="ident" id="6143832">name</span><span class="op" id="6143836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143841">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143852">case</span>&nbsp;<span class="string" id="6143857">&#34;.cc&#34;</span><span class="op" id="6143862">,</span>&nbsp;<span class="string" id="6143864">&#34;.cpp&#34;</span><span class="op" id="6143870">,</span>&nbsp;<span class="string" id="6143872">&#34;.cxx&#34;</span><span class="op" id="6143878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143883">p</span><span class="op" id="6143884">.</span><span class="ident" id="6143885">CXXFiles</span>&nbsp;<span class="op" id="6143894">=</span>&nbsp;<span class="builtinfunc" id="6143896">append</span><span class="op" id="6143902">(</span><span class="ident" id="6143903">p</span><span class="op" id="6143904">.</span><span class="ident" id="6143905">CXXFiles</span><span class="op" id="6143913">,</span>&nbsp;<span class="ident" id="6143915">name</span><span class="op" id="6143919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143924">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143935">case</span>&nbsp;<span class="string" id="6143940">&#34;.m&#34;</span><span class="op" id="6143944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6143949">p</span><span class="op" id="6143950">.</span><span class="ident" id="6143951">MFiles</span>&nbsp;<span class="op" id="6143958">=</span>&nbsp;<span class="builtinfunc" id="6143960">append</span><span class="op" id="6143966">(</span><span class="ident" id="6143967">p</span><span class="op" id="6143968">.</span><span class="ident" id="6143969">MFiles</span><span class="op" id="6143975">,</span>&nbsp;<span class="ident" id="6143977">name</span><span class="op" id="6143981">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143986">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6143997">case</span>&nbsp;<span class="string" id="6144002">&#34;.h&#34;</span><span class="op" id="6144006">,</span>&nbsp;<span class="string" id="6144008">&#34;.hh&#34;</span><span class="op" id="6144013">,</span>&nbsp;<span class="string" id="6144015">&#34;.hpp&#34;</span><span class="op" id="6144021">,</span>&nbsp;<span class="string" id="6144023">&#34;.hxx&#34;</span><span class="op" id="6144029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144034">p</span><span class="op" id="6144035">.</span><span class="ident" id="6144036">HFiles</span>&nbsp;<span class="op" id="6144043">=</span>&nbsp;<span class="builtinfunc" id="6144045">append</span><span class="op" id="6144051">(</span><span class="ident" id="6144052">p</span><span class="op" id="6144053">.</span><span class="ident" id="6144054">HFiles</span><span class="op" id="6144060">,</span>&nbsp;<span class="ident" id="6144062">name</span><span class="op" id="6144066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144071">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144082">case</span>&nbsp;<span class="string" id="6144087">&#34;.s&#34;</span><span class="op" id="6144091">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144096">p</span><span class="op" id="6144097">.</span><span class="ident" id="6144098">SFiles</span>&nbsp;<span class="op" id="6144105">=</span>&nbsp;<span class="builtinfunc" id="6144107">append</span><span class="op" id="6144113">(</span><span class="ident" id="6144114">p</span><span class="op" id="6144115">.</span><span class="ident" id="6144116">SFiles</span><span class="op" id="6144122">,</span>&nbsp;<span class="ident" id="6144124">name</span><span class="op" id="6144128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144133">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144144">case</span>&nbsp;<span class="string" id="6144149">&#34;.S&#34;</span><span class="op" id="6144153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144158">Sfiles</span>&nbsp;<span class="op" id="6144165">=</span>&nbsp;<span class="builtinfunc" id="6144167">append</span><span class="op" id="6144173">(</span><span class="ident" id="6144174">Sfiles</span><span class="op" id="6144180">,</span>&nbsp;<span class="ident" id="6144182">name</span><span class="op" id="6144186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144191">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144202">case</span>&nbsp;<span class="string" id="6144207">&#34;.swig&#34;</span><span class="op" id="6144214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144219">p</span><span class="op" id="6144220">.</span><span class="ident" id="6144221">SwigFiles</span>&nbsp;<span class="op" id="6144231">=</span>&nbsp;<span class="builtinfunc" id="6144233">append</span><span class="op" id="6144239">(</span><span class="ident" id="6144240">p</span><span class="op" id="6144241">.</span><span class="ident" id="6144242">SwigFiles</span><span class="op" id="6144251">,</span>&nbsp;<span class="ident" id="6144253">name</span><span class="op" id="6144257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144262">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144273">case</span>&nbsp;<span class="string" id="6144278">&#34;.swigcxx&#34;</span><span class="op" id="6144288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144293">p</span><span class="op" id="6144294">.</span><span class="ident" id="6144295">SwigCXXFiles</span>&nbsp;<span class="op" id="6144308">=</span>&nbsp;<span class="builtinfunc" id="6144310">append</span><span class="op" id="6144316">(</span><span class="ident" id="6144317">p</span><span class="op" id="6144318">.</span><span class="ident" id="6144319">SwigCXXFiles</span><span class="op" id="6144331">,</span>&nbsp;<span class="ident" id="6144333">name</span><span class="op" id="6144337">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144342">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144353">case</span>&nbsp;<span class="string" id="6144358">&#34;.syso&#34;</span><span class="op" id="6144365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6144370">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6144417">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6144464">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144517">p</span><span class="op" id="6144518">.</span><span class="ident" id="6144519">SysoFiles</span>&nbsp;<span class="op" id="6144529">=</span>&nbsp;<span class="builtinfunc" id="6144531">append</span><span class="op" id="6144537">(</span><span class="ident" id="6144538">p</span><span class="op" id="6144539">.</span><span class="ident" id="6144540">SysoFiles</span><span class="op" id="6144549">,</span>&nbsp;<span class="ident" id="6144551">name</span><span class="op" id="6144555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144560">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6144571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144576">pf</span><span class="op" id="6144578">,</span>&nbsp;<span class="ident" id="6144580">err</span>&nbsp;<span class="op" id="6144584">:=</span>&nbsp;<span class="ident" id="6144587">parser</span><span class="op" id="6144593">.</span><span class="ident" id="6144594">ParseFile</span><span class="op" id="6144603">(</span><span class="ident" id="6144604">fset</span><span class="op" id="6144608">,</span>&nbsp;<span class="ident" id="6144610">filename</span><span class="op" id="6144618">,</span>&nbsp;<span class="ident" id="6144620">data</span><span class="op" id="6144624">,</span>&nbsp;<span class="ident" id="6144626">parser</span><span class="op" id="6144632">.</span><span class="ident" id="6144633">ImportsOnly</span><span class="op" id="6144644">|</span><span class="ident" id="6144645">parser</span><span class="op" id="6144651">.</span><span class="ident" id="6144652">ParseComments</span><span class="op" id="6144665">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144669">if</span>&nbsp;<span class="ident" id="6144672">err</span>&nbsp;<span class="op" id="6144676">!=</span>&nbsp;<span class="ident" id="6144679">nil</span>&nbsp;<span class="op" id="6144683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144688">return</span>&nbsp;<span class="ident" id="6144695">p</span><span class="op" id="6144696">,</span>&nbsp;<span class="ident" id="6144698">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6144704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144709">pkg</span>&nbsp;<span class="op" id="6144713">:=</span>&nbsp;<span class="ident" id="6144716">pf</span><span class="op" id="6144718">.</span><span class="ident" id="6144719">Name</span><span class="op" id="6144723">.</span><span class="ident" id="6144724">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144731">if</span>&nbsp;<span class="ident" id="6144734">pkg</span>&nbsp;<span class="op" id="6144738">==</span>&nbsp;<span class="string" id="6144741">&#34;documentation&#34;</span>&nbsp;<span class="op" id="6144757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144762">p</span><span class="op" id="6144763">.</span><span class="ident" id="6144764">IgnoredGoFiles</span>&nbsp;<span class="op" id="6144779">=</span>&nbsp;<span class="builtinfunc" id="6144781">append</span><span class="op" id="6144787">(</span><span class="ident" id="6144788">p</span><span class="op" id="6144789">.</span><span class="ident" id="6144790">IgnoredGoFiles</span><span class="op" id="6144804">,</span>&nbsp;<span class="ident" id="6144806">name</span><span class="op" id="6144810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144815">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6144826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144831">isTest</span>&nbsp;<span class="op" id="6144838">:=</span>&nbsp;<span class="ident" id="6144841">strings</span><span class="op" id="6144848">.</span><span class="ident" id="6144849">HasSuffix</span><span class="op" id="6144858">(</span><span class="ident" id="6144859">name</span><span class="op" id="6144863">,</span>&nbsp;<span class="string" id="6144865">&#34;_test.go&#34;</span><span class="op" id="6144875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144879">isXTest</span>&nbsp;<span class="op" id="6144887">:=</span>&nbsp;<span class="builtintype" id="6144890">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6144898">if</span>&nbsp;<span class="ident" id="6144901">isTest</span>&nbsp;<span class="op" id="6144908">&amp;&amp;</span>&nbsp;<span class="ident" id="6144911">strings</span><span class="op" id="6144918">.</span><span class="ident" id="6144919">HasSuffix</span><span class="op" id="6144928">(</span><span class="ident" id="6144929">pkg</span><span class="op" id="6144932">,</span>&nbsp;<span class="string" id="6144934">&#34;_test&#34;</span><span class="op" id="6144941">)</span>&nbsp;<span class="op" id="6144943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144948">isXTest</span>&nbsp;<span class="op" id="6144956">=</span>&nbsp;<span class="builtintype" id="6144958">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6144966">pkg</span>&nbsp;<span class="op" id="6144970">=</span>&nbsp;<span class="ident" id="6144972">pkg</span><span class="op" id="6144975">[</span><span class="op" id="6144976">:</span><span class="builtinfunc" id="6144977">len</span><span class="op" id="6144980">(</span><span class="ident" id="6144981">pkg</span><span class="op" id="6144984">)</span><span class="op" id="6144985">-</span><span class="builtinfunc" id="6144986">len</span><span class="op" id="6144989">(</span><span class="string" id="6144990">&#34;_test&#34;</span><span class="op" id="6144997">)</span><span class="op" id="6144998">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145007">if</span>&nbsp;<span class="ident" id="6145010">p</span><span class="op" id="6145011">.</span><span class="ident" id="6145012">Name</span>&nbsp;<span class="op" id="6145017">==</span>&nbsp;<span class="string" id="6145020">&#34;&#34;</span>&nbsp;<span class="op" id="6145023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145028">p</span><span class="op" id="6145029">.</span><span class="ident" id="6145030">Name</span>&nbsp;<span class="op" id="6145035">=</span>&nbsp;<span class="ident" id="6145037">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145044">firstFile</span>&nbsp;<span class="op" id="6145054">=</span>&nbsp;<span class="ident" id="6145056">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145063">}</span>&nbsp;<span class="keyword" id="6145065">else</span>&nbsp;<span class="keyword" id="6145070">if</span>&nbsp;<span class="ident" id="6145073">pkg</span>&nbsp;<span class="op" id="6145077">!=</span>&nbsp;<span class="ident" id="6145080">p</span><span class="op" id="6145081">.</span><span class="ident" id="6145082">Name</span>&nbsp;<span class="op" id="6145087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145092">return</span>&nbsp;<span class="ident" id="6145099">p</span><span class="op" id="6145100">,</span>&nbsp;<span class="op" id="6145102">&amp;</span><span class="ident" id="6145103">MultiplePackageError</span><span class="op" id="6145123">{</span><span class="ident" id="6145124">p</span><span class="op" id="6145125">.</span><span class="ident" id="6145126">Dir</span><span class="op" id="6145129">,</span>&nbsp;<span class="op" id="6145131">[</span><span class="op" id="6145132">]</span><span class="builtintype" id="6145133">string</span><span class="op" id="6145139">{</span><span class="ident" id="6145140">firstFile</span><span class="op" id="6145149">,</span>&nbsp;<span class="ident" id="6145151">name</span><span class="op" id="6145155">}</span><span class="op" id="6145156">,</span>&nbsp;<span class="op" id="6145158">[</span><span class="op" id="6145159">]</span><span class="builtintype" id="6145160">string</span><span class="op" id="6145166">{</span><span class="ident" id="6145167">p</span><span class="op" id="6145168">.</span><span class="ident" id="6145169">Name</span><span class="op" id="6145173">,</span>&nbsp;<span class="ident" id="6145175">pkg</span><span class="op" id="6145178">}</span><span class="op" id="6145179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145187">if</span>&nbsp;<span class="ident" id="6145190">pf</span><span class="op" id="6145192">.</span><span class="ident" id="6145193">Doc</span>&nbsp;<span class="op" id="6145197">!=</span>&nbsp;<span class="ident" id="6145200">nil</span>&nbsp;<span class="op" id="6145204">&amp;&amp;</span>&nbsp;<span class="ident" id="6145207">p</span><span class="op" id="6145208">.</span><span class="ident" id="6145209">Doc</span>&nbsp;<span class="op" id="6145213">==</span>&nbsp;<span class="string" id="6145216">&#34;&#34;</span>&nbsp;<span class="op" id="6145219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145224">p</span><span class="op" id="6145225">.</span><span class="ident" id="6145226">Doc</span>&nbsp;<span class="op" id="6145230">=</span>&nbsp;<span class="ident" id="6145232">doc</span><span class="op" id="6145235">.</span><span class="ident" id="6145236">Synopsis</span><span class="op" id="6145244">(</span><span class="ident" id="6145245">pf</span><span class="op" id="6145247">.</span><span class="ident" id="6145248">Doc</span><span class="op" id="6145251">.</span><span class="ident" id="6145252">Text</span><span class="op" id="6145256">(</span><span class="op" id="6145257">)</span><span class="op" id="6145258">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145267">if</span>&nbsp;<span class="ident" id="6145270">mode</span><span class="op" id="6145274">&amp;</span><span class="ident" id="6145275">ImportComment</span>&nbsp;<span class="op" id="6145289">!=</span>&nbsp;<span class="num" id="6145292">0</span>&nbsp;<span class="op" id="6145294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145299">qcom</span><span class="op" id="6145303">,</span>&nbsp;<span class="ident" id="6145305">line</span>&nbsp;<span class="op" id="6145310">:=</span>&nbsp;<span class="ident" id="6145313">findImportComment</span><span class="op" id="6145330">(</span><span class="ident" id="6145331">data</span><span class="op" id="6145335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145340">if</span>&nbsp;<span class="ident" id="6145343">line</span>&nbsp;<span class="op" id="6145348">!=</span>&nbsp;<span class="num" id="6145351">0</span>&nbsp;<span class="op" id="6145353">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145359">com</span><span class="op" id="6145362">,</span>&nbsp;<span class="ident" id="6145364">err</span>&nbsp;<span class="op" id="6145368">:=</span>&nbsp;<span class="ident" id="6145371">strconv</span><span class="op" id="6145378">.</span><span class="ident" id="6145379">Unquote</span><span class="op" id="6145386">(</span><span class="ident" id="6145387">qcom</span><span class="op" id="6145391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145397">if</span>&nbsp;<span class="ident" id="6145400">err</span>&nbsp;<span class="op" id="6145404">!=</span>&nbsp;<span class="ident" id="6145407">nil</span>&nbsp;<span class="op" id="6145411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145418">return</span>&nbsp;<span class="ident" id="6145425">p</span><span class="op" id="6145426">,</span>&nbsp;<span class="ident" id="6145428">fmt</span><span class="op" id="6145431">.</span><span class="ident" id="6145432">Errorf</span><span class="op" id="6145438">(</span><span class="string" id="6145439">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="6145475">,</span>&nbsp;<span class="ident" id="6145477">filename</span><span class="op" id="6145485">,</span>&nbsp;<span class="ident" id="6145487">line</span><span class="op" id="6145491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145503">if</span>&nbsp;<span class="ident" id="6145506">p</span><span class="op" id="6145507">.</span><span class="ident" id="6145508">ImportComment</span>&nbsp;<span class="op" id="6145522">==</span>&nbsp;<span class="string" id="6145525">&#34;&#34;</span>&nbsp;<span class="op" id="6145528">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145535">p</span><span class="op" id="6145536">.</span><span class="ident" id="6145537">ImportComment</span>&nbsp;<span class="op" id="6145551">=</span>&nbsp;<span class="ident" id="6145553">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145562">firstCommentFile</span>&nbsp;<span class="op" id="6145579">=</span>&nbsp;<span class="ident" id="6145581">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145590">}</span>&nbsp;<span class="keyword" id="6145592">else</span>&nbsp;<span class="keyword" id="6145597">if</span>&nbsp;<span class="ident" id="6145600">p</span><span class="op" id="6145601">.</span><span class="ident" id="6145602">ImportComment</span>&nbsp;<span class="op" id="6145616">!=</span>&nbsp;<span class="ident" id="6145619">com</span>&nbsp;<span class="op" id="6145623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145630">return</span>&nbsp;<span class="ident" id="6145637">p</span><span class="op" id="6145638">,</span>&nbsp;<span class="ident" id="6145640">fmt</span><span class="op" id="6145643">.</span><span class="ident" id="6145644">Errorf</span><span class="op" id="6145650">(</span><span class="string" id="6145651">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6145700">,</span>&nbsp;<span class="ident" id="6145702">p</span><span class="op" id="6145703">.</span><span class="ident" id="6145704">ImportComment</span><span class="op" id="6145717">,</span>&nbsp;<span class="ident" id="6145719">firstCommentFile</span><span class="op" id="6145735">,</span>&nbsp;<span class="ident" id="6145737">com</span><span class="op" id="6145740">,</span>&nbsp;<span class="ident" id="6145742">name</span><span class="op" id="6145746">,</span>&nbsp;<span class="ident" id="6145748">p</span><span class="op" id="6145749">.</span><span class="ident" id="6145750">Dir</span><span class="op" id="6145753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145759">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6145773">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145820">isCgo</span>&nbsp;<span class="op" id="6145826">:=</span>&nbsp;<span class="builtintype" id="6145829">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145837">for</span>&nbsp;<span class="ident" id="6145841">_</span><span class="op" id="6145842">,</span>&nbsp;<span class="ident" id="6145844">decl</span>&nbsp;<span class="op" id="6145849">:=</span>&nbsp;<span class="keyword" id="6145852">range</span>&nbsp;<span class="ident" id="6145858">pf</span><span class="op" id="6145860">.</span><span class="ident" id="6145861">Decls</span>&nbsp;<span class="op" id="6145867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145872">d</span><span class="op" id="6145873">,</span>&nbsp;<span class="ident" id="6145875">ok</span>&nbsp;<span class="op" id="6145878">:=</span>&nbsp;<span class="ident" id="6145881">decl</span><span class="op" id="6145885">.</span><span class="op" id="6145886">(</span><span class="op" id="6145887">*</span><span class="ident" id="6145888">ast</span><span class="op" id="6145891">.</span><span class="ident" id="6145892">GenDecl</span><span class="op" id="6145899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145904">if</span>&nbsp;<span class="op" id="6145907">!</span><span class="ident" id="6145908">ok</span>&nbsp;<span class="op" id="6145911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145917">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6145929">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6145934">for</span>&nbsp;<span class="ident" id="6145938">_</span><span class="op" id="6145939">,</span>&nbsp;<span class="ident" id="6145941">dspec</span>&nbsp;<span class="op" id="6145947">:=</span>&nbsp;<span class="keyword" id="6145950">range</span>&nbsp;<span class="ident" id="6145956">d</span><span class="op" id="6145957">.</span><span class="ident" id="6145958">Specs</span>&nbsp;<span class="op" id="6145964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6145970">spec</span><span class="op" id="6145974">,</span>&nbsp;<span class="ident" id="6145976">ok</span>&nbsp;<span class="op" id="6145979">:=</span>&nbsp;<span class="ident" id="6145982">dspec</span><span class="op" id="6145987">.</span><span class="op" id="6145988">(</span><span class="op" id="6145989">*</span><span class="ident" id="6145990">ast</span><span class="op" id="6145993">.</span><span class="ident" id="6145994">ImportSpec</span><span class="op" id="6146004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146010">if</span>&nbsp;<span class="op" id="6146013">!</span><span class="ident" id="6146014">ok</span>&nbsp;<span class="op" id="6146017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146024">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146037">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146043">quoted</span>&nbsp;<span class="op" id="6146050">:=</span>&nbsp;<span class="ident" id="6146053">spec</span><span class="op" id="6146057">.</span><span class="ident" id="6146058">Path</span><span class="op" id="6146062">.</span><span class="ident" id="6146063">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146073">path</span><span class="op" id="6146077">,</span>&nbsp;<span class="ident" id="6146079">err</span>&nbsp;<span class="op" id="6146083">:=</span>&nbsp;<span class="ident" id="6146086">strconv</span><span class="op" id="6146093">.</span><span class="ident" id="6146094">Unquote</span><span class="op" id="6146101">(</span><span class="ident" id="6146102">quoted</span><span class="op" id="6146108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146114">if</span>&nbsp;<span class="ident" id="6146117">err</span>&nbsp;<span class="op" id="6146121">!=</span>&nbsp;<span class="ident" id="6146124">nil</span>&nbsp;<span class="op" id="6146128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146135">log</span><span class="op" id="6146138">.</span><span class="ident" id="6146139">Panicf</span><span class="op" id="6146145">(</span><span class="string" id="6146146">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6146195">,</span>&nbsp;<span class="ident" id="6146197">filename</span><span class="op" id="6146205">,</span>&nbsp;<span class="ident" id="6146207">quoted</span><span class="op" id="6146213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146219">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146225">if</span>&nbsp;<span class="ident" id="6146228">isXTest</span>&nbsp;<span class="op" id="6146236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146243">xTestImported</span><span class="op" id="6146256">[</span><span class="ident" id="6146257">path</span><span class="op" id="6146261">]</span>&nbsp;<span class="op" id="6146263">=</span>&nbsp;<span class="builtinfunc" id="6146265">append</span><span class="op" id="6146271">(</span><span class="ident" id="6146272">xTestImported</span><span class="op" id="6146285">[</span><span class="ident" id="6146286">path</span><span class="op" id="6146290">]</span><span class="op" id="6146291">,</span>&nbsp;<span class="ident" id="6146293">fset</span><span class="op" id="6146297">.</span><span class="ident" id="6146298">Position</span><span class="op" id="6146306">(</span><span class="ident" id="6146307">spec</span><span class="op" id="6146311">.</span><span class="ident" id="6146312">Pos</span><span class="op" id="6146315">(</span><span class="op" id="6146316">)</span><span class="op" id="6146317">)</span><span class="op" id="6146318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146324">}</span>&nbsp;<span class="keyword" id="6146326">else</span>&nbsp;<span class="keyword" id="6146331">if</span>&nbsp;<span class="ident" id="6146334">isTest</span>&nbsp;<span class="op" id="6146341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146348">testImported</span><span class="op" id="6146360">[</span><span class="ident" id="6146361">path</span><span class="op" id="6146365">]</span>&nbsp;<span class="op" id="6146367">=</span>&nbsp;<span class="builtinfunc" id="6146369">append</span><span class="op" id="6146375">(</span><span class="ident" id="6146376">testImported</span><span class="op" id="6146388">[</span><span class="ident" id="6146389">path</span><span class="op" id="6146393">]</span><span class="op" id="6146394">,</span>&nbsp;<span class="ident" id="6146396">fset</span><span class="op" id="6146400">.</span><span class="ident" id="6146401">Position</span><span class="op" id="6146409">(</span><span class="ident" id="6146410">spec</span><span class="op" id="6146414">.</span><span class="ident" id="6146415">Pos</span><span class="op" id="6146418">(</span><span class="op" id="6146419">)</span><span class="op" id="6146420">)</span><span class="op" id="6146421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146427">}</span>&nbsp;<span class="keyword" id="6146429">else</span>&nbsp;<span class="op" id="6146434">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146441">imported</span><span class="op" id="6146449">[</span><span class="ident" id="6146450">path</span><span class="op" id="6146454">]</span>&nbsp;<span class="op" id="6146456">=</span>&nbsp;<span class="builtinfunc" id="6146458">append</span><span class="op" id="6146464">(</span><span class="ident" id="6146465">imported</span><span class="op" id="6146473">[</span><span class="ident" id="6146474">path</span><span class="op" id="6146478">]</span><span class="op" id="6146479">,</span>&nbsp;<span class="ident" id="6146481">fset</span><span class="op" id="6146485">.</span><span class="ident" id="6146486">Position</span><span class="op" id="6146494">(</span><span class="ident" id="6146495">spec</span><span class="op" id="6146499">.</span><span class="ident" id="6146500">Pos</span><span class="op" id="6146503">(</span><span class="op" id="6146504">)</span><span class="op" id="6146505">)</span><span class="op" id="6146506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146518">if</span>&nbsp;<span class="ident" id="6146521">path</span>&nbsp;<span class="op" id="6146526">==</span>&nbsp;<span class="string" id="6146529">&#34;C&#34;</span>&nbsp;<span class="op" id="6146533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146540">if</span>&nbsp;<span class="ident" id="6146543">isTest</span>&nbsp;<span class="op" id="6146550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146558">return</span>&nbsp;<span class="ident" id="6146565">p</span><span class="op" id="6146566">,</span>&nbsp;<span class="ident" id="6146568">fmt</span><span class="op" id="6146571">.</span><span class="ident" id="6146572">Errorf</span><span class="op" id="6146578">(</span><span class="string" id="6146579">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6146616">,</span>&nbsp;<span class="ident" id="6146618">filename</span><span class="op" id="6146626">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146640">cg</span>&nbsp;<span class="op" id="6146643">:=</span>&nbsp;<span class="ident" id="6146646">spec</span><span class="op" id="6146650">.</span><span class="ident" id="6146651">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146660">if</span>&nbsp;<span class="ident" id="6146663">cg</span>&nbsp;<span class="op" id="6146666">==</span>&nbsp;<span class="ident" id="6146669">nil</span>&nbsp;<span class="op" id="6146673">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6146676">len</span><span class="op" id="6146679">(</span><span class="ident" id="6146680">d</span><span class="op" id="6146681">.</span><span class="ident" id="6146682">Specs</span><span class="op" id="6146687">)</span>&nbsp;<span class="op" id="6146689">==</span>&nbsp;<span class="num" id="6146692">1</span>&nbsp;<span class="op" id="6146694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146702">cg</span>&nbsp;<span class="op" id="6146705">=</span>&nbsp;<span class="ident" id="6146707">d</span><span class="op" id="6146708">.</span><span class="ident" id="6146709">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146718">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146725">if</span>&nbsp;<span class="ident" id="6146728">cg</span>&nbsp;<span class="op" id="6146731">!=</span>&nbsp;<span class="ident" id="6146734">nil</span>&nbsp;<span class="op" id="6146738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146746">if</span>&nbsp;<span class="ident" id="6146749">err</span>&nbsp;<span class="op" id="6146753">:=</span>&nbsp;<span class="ident" id="6146756">ctxt</span><span class="op" id="6146760">.</span><span class="ident" id="6146761">saveCgo</span><span class="op" id="6146768">(</span><span class="ident" id="6146769">filename</span><span class="op" id="6146777">,</span>&nbsp;<span class="ident" id="6146779">p</span><span class="op" id="6146780">,</span>&nbsp;<span class="ident" id="6146782">cg</span><span class="op" id="6146784">)</span><span class="op" id="6146785">;</span>&nbsp;<span class="ident" id="6146787">err</span>&nbsp;<span class="op" id="6146791">!=</span>&nbsp;<span class="ident" id="6146794">nil</span>&nbsp;<span class="op" id="6146798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146807">return</span>&nbsp;<span class="ident" id="6146814">p</span><span class="op" id="6146815">,</span>&nbsp;<span class="ident" id="6146817">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146834">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146841">isCgo</span>&nbsp;<span class="op" id="6146847">=</span>&nbsp;<span class="builtintype" id="6146849">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146871">if</span>&nbsp;<span class="ident" id="6146874">isCgo</span>&nbsp;<span class="op" id="6146880">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146885">allTags</span><span class="op" id="6146892">[</span><span class="string" id="6146893">&#34;cgo&#34;</span><span class="op" id="6146898">]</span>&nbsp;<span class="op" id="6146900">=</span>&nbsp;<span class="builtintype" id="6146902">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6146910">if</span>&nbsp;<span class="ident" id="6146913">ctxt</span><span class="op" id="6146917">.</span><span class="ident" id="6146918">CgoEnabled</span>&nbsp;<span class="op" id="6146929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146935">p</span><span class="op" id="6146936">.</span><span class="ident" id="6146937">CgoFiles</span>&nbsp;<span class="op" id="6146946">=</span>&nbsp;<span class="builtinfunc" id="6146948">append</span><span class="op" id="6146954">(</span><span class="ident" id="6146955">p</span><span class="op" id="6146956">.</span><span class="ident" id="6146957">CgoFiles</span><span class="op" id="6146965">,</span>&nbsp;<span class="ident" id="6146967">name</span><span class="op" id="6146971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6146976">}</span>&nbsp;<span class="keyword" id="6146978">else</span>&nbsp;<span class="op" id="6146983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6146989">p</span><span class="op" id="6146990">.</span><span class="ident" id="6146991">IgnoredGoFiles</span>&nbsp;<span class="op" id="6147006">=</span>&nbsp;<span class="builtinfunc" id="6147008">append</span><span class="op" id="6147014">(</span><span class="ident" id="6147015">p</span><span class="op" id="6147016">.</span><span class="ident" id="6147017">IgnoredGoFiles</span><span class="op" id="6147031">,</span>&nbsp;<span class="ident" id="6147033">name</span><span class="op" id="6147037">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147046">}</span>&nbsp;<span class="keyword" id="6147048">else</span>&nbsp;<span class="keyword" id="6147053">if</span>&nbsp;<span class="ident" id="6147056">isXTest</span>&nbsp;<span class="op" id="6147064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147069">p</span><span class="op" id="6147070">.</span><span class="ident" id="6147071">XTestGoFiles</span>&nbsp;<span class="op" id="6147084">=</span>&nbsp;<span class="builtinfunc" id="6147086">append</span><span class="op" id="6147092">(</span><span class="ident" id="6147093">p</span><span class="op" id="6147094">.</span><span class="ident" id="6147095">XTestGoFiles</span><span class="op" id="6147107">,</span>&nbsp;<span class="ident" id="6147109">name</span><span class="op" id="6147113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147117">}</span>&nbsp;<span class="keyword" id="6147119">else</span>&nbsp;<span class="keyword" id="6147124">if</span>&nbsp;<span class="ident" id="6147127">isTest</span>&nbsp;<span class="op" id="6147134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147139">p</span><span class="op" id="6147140">.</span><span class="ident" id="6147141">TestGoFiles</span>&nbsp;<span class="op" id="6147153">=</span>&nbsp;<span class="builtinfunc" id="6147155">append</span><span class="op" id="6147161">(</span><span class="ident" id="6147162">p</span><span class="op" id="6147163">.</span><span class="ident" id="6147164">TestGoFiles</span><span class="op" id="6147175">,</span>&nbsp;<span class="ident" id="6147177">name</span><span class="op" id="6147181">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147185">}</span>&nbsp;<span class="keyword" id="6147187">else</span>&nbsp;<span class="op" id="6147192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147197">p</span><span class="op" id="6147198">.</span><span class="ident" id="6147199">GoFiles</span>&nbsp;<span class="op" id="6147207">=</span>&nbsp;<span class="builtinfunc" id="6147209">append</span><span class="op" id="6147215">(</span><span class="ident" id="6147216">p</span><span class="op" id="6147217">.</span><span class="ident" id="6147218">GoFiles</span><span class="op" id="6147225">,</span>&nbsp;<span class="ident" id="6147227">name</span><span class="op" id="6147231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147241">if</span>&nbsp;<span class="builtinfunc" id="6147244">len</span><span class="op" id="6147247">(</span><span class="ident" id="6147248">p</span><span class="op" id="6147249">.</span><span class="ident" id="6147250">GoFiles</span><span class="op" id="6147257">)</span><span class="op" id="6147258">+</span><span class="builtinfunc" id="6147259">len</span><span class="op" id="6147262">(</span><span class="ident" id="6147263">p</span><span class="op" id="6147264">.</span><span class="ident" id="6147265">CgoFiles</span><span class="op" id="6147273">)</span><span class="op" id="6147274">+</span><span class="builtinfunc" id="6147275">len</span><span class="op" id="6147278">(</span><span class="ident" id="6147279">p</span><span class="op" id="6147280">.</span><span class="ident" id="6147281">TestGoFiles</span><span class="op" id="6147292">)</span><span class="op" id="6147293">+</span><span class="builtinfunc" id="6147294">len</span><span class="op" id="6147297">(</span><span class="ident" id="6147298">p</span><span class="op" id="6147299">.</span><span class="ident" id="6147300">XTestGoFiles</span><span class="op" id="6147312">)</span>&nbsp;<span class="op" id="6147314">==</span>&nbsp;<span class="num" id="6147317">0</span>&nbsp;<span class="op" id="6147319">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147323">return</span>&nbsp;<span class="ident" id="6147330">p</span><span class="op" id="6147331">,</span>&nbsp;<span class="op" id="6147333">&amp;</span><span class="ident" id="6147334">NoGoError</span><span class="op" id="6147343">{</span><span class="ident" id="6147344">p</span><span class="op" id="6147345">.</span><span class="ident" id="6147346">Dir</span><span class="op" id="6147349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147356">for</span>&nbsp;<span class="ident" id="6147360">tag</span>&nbsp;<span class="op" id="6147364">:=</span>&nbsp;<span class="keyword" id="6147367">range</span>&nbsp;<span class="ident" id="6147373">allTags</span>&nbsp;<span class="op" id="6147381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147385">p</span><span class="op" id="6147386">.</span><span class="ident" id="6147387">AllTags</span>&nbsp;<span class="op" id="6147395">=</span>&nbsp;<span class="builtinfunc" id="6147397">append</span><span class="op" id="6147403">(</span><span class="ident" id="6147404">p</span><span class="op" id="6147405">.</span><span class="ident" id="6147406">AllTags</span><span class="op" id="6147413">,</span>&nbsp;<span class="ident" id="6147415">tag</span><span class="op" id="6147418">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147424">sort</span><span class="op" id="6147428">.</span><span class="ident" id="6147429">Strings</span><span class="op" id="6147436">(</span><span class="ident" id="6147437">p</span><span class="op" id="6147438">.</span><span class="ident" id="6147439">AllTags</span><span class="op" id="6147446">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147450">p</span><span class="op" id="6147451">.</span><span class="ident" id="6147452">Imports</span><span class="op" id="6147459">,</span>&nbsp;<span class="ident" id="6147461">p</span><span class="op" id="6147462">.</span><span class="ident" id="6147463">ImportPos</span>&nbsp;<span class="op" id="6147473">=</span>&nbsp;<span class="ident" id="6147475">cleanImports</span><span class="op" id="6147487">(</span><span class="ident" id="6147488">imported</span><span class="op" id="6147496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147499">p</span><span class="op" id="6147500">.</span><span class="ident" id="6147501">TestImports</span><span class="op" id="6147512">,</span>&nbsp;<span class="ident" id="6147514">p</span><span class="op" id="6147515">.</span><span class="ident" id="6147516">TestImportPos</span>&nbsp;<span class="op" id="6147530">=</span>&nbsp;<span class="ident" id="6147532">cleanImports</span><span class="op" id="6147544">(</span><span class="ident" id="6147545">testImported</span><span class="op" id="6147557">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147560">p</span><span class="op" id="6147561">.</span><span class="ident" id="6147562">XTestImports</span><span class="op" id="6147574">,</span>&nbsp;<span class="ident" id="6147576">p</span><span class="op" id="6147577">.</span><span class="ident" id="6147578">XTestImportPos</span>&nbsp;<span class="op" id="6147593">=</span>&nbsp;<span class="ident" id="6147595">cleanImports</span><span class="op" id="6147607">(</span><span class="ident" id="6147608">xTestImported</span><span class="op" id="6147621">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6147625">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6147671">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6147712">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147757">if</span>&nbsp;<span class="builtinfunc" id="6147760">len</span><span class="op" id="6147763">(</span><span class="ident" id="6147764">p</span><span class="op" id="6147765">.</span><span class="ident" id="6147766">CgoFiles</span><span class="op" id="6147774">)</span>&nbsp;<span class="op" id="6147776">&gt;</span>&nbsp;<span class="num" id="6147778">0</span>&nbsp;<span class="op" id="6147780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147784">p</span><span class="op" id="6147785">.</span><span class="ident" id="6147786">SFiles</span>&nbsp;<span class="op" id="6147793">=</span>&nbsp;<span class="builtinfunc" id="6147795">append</span><span class="op" id="6147801">(</span><span class="ident" id="6147802">p</span><span class="op" id="6147803">.</span><span class="ident" id="6147804">SFiles</span><span class="op" id="6147810">,</span>&nbsp;<span class="ident" id="6147812">Sfiles</span><span class="op" id="6147818">...</span><span class="op" id="6147821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147825">sort</span><span class="op" id="6147829">.</span><span class="ident" id="6147830">Strings</span><span class="op" id="6147837">(</span><span class="ident" id="6147838">p</span><span class="op" id="6147839">.</span><span class="ident" id="6147840">SFiles</span><span class="op" id="6147846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6147849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147853">return</span>&nbsp;<span class="ident" id="6147860">p</span><span class="op" id="6147861">,</span>&nbsp;<span class="ident" id="6147863">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="6147870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6147873">func</span>&nbsp;<span class="ident" id="6147878">findImportComment</span><span class="op" id="6147895">(</span><span class="ident" id="6147896">data</span>&nbsp;<span class="op" id="6147901">[</span><span class="op" id="6147902">]</span><span class="builtintype" id="6147903">byte</span><span class="op" id="6147907">)</span>&nbsp;<span class="op" id="6147909">(</span><span class="ident" id="6147910">s</span>&nbsp;<span class="builtintype" id="6147912">string</span><span class="op" id="6147918">,</span>&nbsp;<span class="ident" id="6147920">line</span>&nbsp;<span class="builtintype" id="6147925">int</span><span class="op" id="6147928">)</span>&nbsp;<span class="op" id="6147930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6147933">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6147960">word</span><span class="op" id="6147964">,</span>&nbsp;<span class="ident" id="6147966">data</span>&nbsp;<span class="op" id="6147971">:=</span>&nbsp;<span class="ident" id="6147974">parseWord</span><span class="op" id="6147983">(</span><span class="ident" id="6147984">data</span><span class="op" id="6147988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6147991">if</span>&nbsp;<span class="builtintype" id="6147994">string</span><span class="op" id="6148000">(</span><span class="ident" id="6148001">word</span><span class="op" id="6148005">)</span>&nbsp;<span class="op" id="6148007">!=</span>&nbsp;<span class="string" id="6148010">&#34;package&#34;</span>&nbsp;<span class="op" id="6148020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148024">return</span>&nbsp;<span class="string" id="6148031">&#34;&#34;</span><span class="op" id="6148033">,</span>&nbsp;<span class="num" id="6148035">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6148042">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148066">_</span><span class="op" id="6148067">,</span>&nbsp;<span class="ident" id="6148069">data</span>&nbsp;<span class="op" id="6148074">=</span>&nbsp;<span class="ident" id="6148076">parseWord</span><span class="op" id="6148085">(</span><span class="ident" id="6148086">data</span><span class="op" id="6148090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6148094">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6148150">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148196">for</span>&nbsp;<span class="builtinfunc" id="6148200">len</span><span class="op" id="6148203">(</span><span class="ident" id="6148204">data</span><span class="op" id="6148208">)</span>&nbsp;<span class="op" id="6148210">&gt;</span>&nbsp;<span class="num" id="6148212">0</span>&nbsp;<span class="op" id="6148214">&amp;&amp;</span>&nbsp;<span class="op" id="6148217">(</span><span class="ident" id="6148218">data</span><span class="op" id="6148222">[</span><span class="num" id="6148223">0</span><span class="op" id="6148224">]</span>&nbsp;<span class="op" id="6148226">==</span>&nbsp;<span class="string" id="6148229">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6148233">||</span>&nbsp;<span class="ident" id="6148236">data</span><span class="op" id="6148240">[</span><span class="num" id="6148241">0</span><span class="op" id="6148242">]</span>&nbsp;<span class="op" id="6148244">==</span>&nbsp;<span class="string" id="6148247">&#39;\t&#39;</span>&nbsp;<span class="op" id="6148252">||</span>&nbsp;<span class="ident" id="6148255">data</span><span class="op" id="6148259">[</span><span class="num" id="6148260">0</span><span class="op" id="6148261">]</span>&nbsp;<span class="op" id="6148263">==</span>&nbsp;<span class="string" id="6148266">&#39;\r&#39;</span><span class="op" id="6148270">)</span>&nbsp;<span class="op" id="6148272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148276">data</span>&nbsp;<span class="op" id="6148281">=</span>&nbsp;<span class="ident" id="6148283">data</span><span class="op" id="6148287">[</span><span class="num" id="6148288">1</span><span class="op" id="6148289">:</span><span class="op" id="6148290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148297">var</span>&nbsp;<span class="ident" id="6148301">comment</span>&nbsp;<span class="op" id="6148309">[</span><span class="op" id="6148310">]</span><span class="builtintype" id="6148311">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148317">switch</span>&nbsp;<span class="op" id="6148324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148327">case</span>&nbsp;<span class="ident" id="6148332">bytes</span><span class="op" id="6148337">.</span><span class="ident" id="6148338">HasPrefix</span><span class="op" id="6148347">(</span><span class="ident" id="6148348">data</span><span class="op" id="6148352">,</span>&nbsp;<span class="ident" id="6148354">slashSlash</span><span class="op" id="6148364">)</span><span class="op" id="6148365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148369">i</span>&nbsp;<span class="op" id="6148371">:=</span>&nbsp;<span class="ident" id="6148374">bytes</span><span class="op" id="6148379">.</span><span class="ident" id="6148380">Index</span><span class="op" id="6148385">(</span><span class="ident" id="6148386">data</span><span class="op" id="6148390">,</span>&nbsp;<span class="ident" id="6148392">newline</span><span class="op" id="6148399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148403">if</span>&nbsp;<span class="ident" id="6148406">i</span>&nbsp;<span class="op" id="6148408">&lt;</span>&nbsp;<span class="num" id="6148410">0</span>&nbsp;<span class="op" id="6148412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148417">i</span>&nbsp;<span class="op" id="6148419">=</span>&nbsp;<span class="builtinfunc" id="6148421">len</span><span class="op" id="6148424">(</span><span class="ident" id="6148425">data</span><span class="op" id="6148429">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148437">comment</span>&nbsp;<span class="op" id="6148445">=</span>&nbsp;<span class="ident" id="6148447">data</span><span class="op" id="6148451">[</span><span class="num" id="6148452">2</span><span class="op" id="6148453">:</span><span class="ident" id="6148454">i</span><span class="op" id="6148455">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148458">case</span>&nbsp;<span class="ident" id="6148463">bytes</span><span class="op" id="6148468">.</span><span class="ident" id="6148469">HasPrefix</span><span class="op" id="6148478">(</span><span class="ident" id="6148479">data</span><span class="op" id="6148483">,</span>&nbsp;<span class="ident" id="6148485">slashStar</span><span class="op" id="6148494">)</span><span class="op" id="6148495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148499">data</span>&nbsp;<span class="op" id="6148504">=</span>&nbsp;<span class="ident" id="6148506">data</span><span class="op" id="6148510">[</span><span class="num" id="6148511">2</span><span class="op" id="6148512">:</span><span class="op" id="6148513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148517">i</span>&nbsp;<span class="op" id="6148519">:=</span>&nbsp;<span class="ident" id="6148522">bytes</span><span class="op" id="6148527">.</span><span class="ident" id="6148528">Index</span><span class="op" id="6148533">(</span><span class="ident" id="6148534">data</span><span class="op" id="6148538">,</span>&nbsp;<span class="ident" id="6148540">starSlash</span><span class="op" id="6148549">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148553">if</span>&nbsp;<span class="ident" id="6148556">i</span>&nbsp;<span class="op" id="6148558">&lt;</span>&nbsp;<span class="num" id="6148560">0</span>&nbsp;<span class="op" id="6148562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6148567">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148591">return</span>&nbsp;<span class="string" id="6148598">&#34;&#34;</span><span class="op" id="6148600">,</span>&nbsp;<span class="num" id="6148602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148610">comment</span>&nbsp;<span class="op" id="6148618">=</span>&nbsp;<span class="ident" id="6148620">data</span><span class="op" id="6148624">[</span><span class="op" id="6148625">:</span><span class="ident" id="6148626">i</span><span class="op" id="6148627">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148631">if</span>&nbsp;<span class="ident" id="6148634">bytes</span><span class="op" id="6148639">.</span><span class="ident" id="6148640">Contains</span><span class="op" id="6148648">(</span><span class="ident" id="6148649">comment</span><span class="op" id="6148656">,</span>&nbsp;<span class="ident" id="6148658">newline</span><span class="op" id="6148665">)</span>&nbsp;<span class="op" id="6148667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148672">return</span>&nbsp;<span class="string" id="6148679">&#34;&#34;</span><span class="op" id="6148681">,</span>&nbsp;<span class="num" id="6148683">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148693">comment</span>&nbsp;<span class="op" id="6148701">=</span>&nbsp;<span class="ident" id="6148703">bytes</span><span class="op" id="6148708">.</span><span class="ident" id="6148709">TrimSpace</span><span class="op" id="6148718">(</span><span class="ident" id="6148719">comment</span><span class="op" id="6148726">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6148730">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148771">word</span><span class="op" id="6148775">,</span>&nbsp;<span class="ident" id="6148777">arg</span>&nbsp;<span class="op" id="6148781">:=</span>&nbsp;<span class="ident" id="6148784">parseWord</span><span class="op" id="6148793">(</span><span class="ident" id="6148794">comment</span><span class="op" id="6148801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148804">if</span>&nbsp;<span class="builtintype" id="6148807">string</span><span class="op" id="6148813">(</span><span class="ident" id="6148814">word</span><span class="op" id="6148818">)</span>&nbsp;<span class="op" id="6148820">!=</span>&nbsp;<span class="string" id="6148823">&#34;import&#34;</span>&nbsp;<span class="op" id="6148832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148836">return</span>&nbsp;<span class="string" id="6148843">&#34;&#34;</span><span class="op" id="6148845">,</span>&nbsp;<span class="num" id="6148847">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6148850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148854">line</span>&nbsp;<span class="op" id="6148859">=</span>&nbsp;<span class="num" id="6148861">1</span>&nbsp;<span class="op" id="6148863">+</span>&nbsp;<span class="ident" id="6148865">bytes</span><span class="op" id="6148870">.</span><span class="ident" id="6148871">Count</span><span class="op" id="6148876">(</span><span class="ident" id="6148877">data</span><span class="op" id="6148881">[</span><span class="op" id="6148882">:</span><span class="builtinfunc" id="6148883">cap</span><span class="op" id="6148886">(</span><span class="ident" id="6148887">data</span><span class="op" id="6148891">)</span><span class="op" id="6148892">-</span><span class="builtinfunc" id="6148893">cap</span><span class="op" id="6148896">(</span><span class="ident" id="6148897">arg</span><span class="op" id="6148900">)</span><span class="op" id="6148901">]</span><span class="op" id="6148902">,</span>&nbsp;<span class="ident" id="6148904">newline</span><span class="op" id="6148911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6148914">return</span>&nbsp;<span class="ident" id="6148921">strings</span><span class="op" id="6148928">.</span><span class="ident" id="6148929">TrimSpace</span><span class="op" id="6148938">(</span><span class="builtintype" id="6148939">string</span><span class="op" id="6148945">(</span><span class="ident" id="6148946">arg</span><span class="op" id="6148949">)</span><span class="op" id="6148950">)</span><span class="op" id="6148951">,</span>&nbsp;<span class="ident" id="6148953">line</span><br>
<span class="lineno"></span><span class="op" id="6148958">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6148961">var</span>&nbsp;<span class="op" id="6148965">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148968">slashSlash</span>&nbsp;<span class="op" id="6148979">=</span>&nbsp;<span class="op" id="6148981">[</span><span class="op" id="6148982">]</span><span class="builtintype" id="6148983">byte</span><span class="op" id="6148987">(</span><span class="string" id="6148988">&#34;//&#34;</span><span class="op" id="6148992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6148995">slashStar</span>&nbsp;&nbsp;<span class="op" id="6149006">=</span>&nbsp;<span class="op" id="6149008">[</span><span class="op" id="6149009">]</span><span class="builtintype" id="6149010">byte</span><span class="op" id="6149014">(</span><span class="string" id="6149015">&#34;/*&#34;</span><span class="op" id="6149019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149022">starSlash</span>&nbsp;&nbsp;<span class="op" id="6149033">=</span>&nbsp;<span class="op" id="6149035">[</span><span class="op" id="6149036">]</span><span class="builtintype" id="6149037">byte</span><span class="op" id="6149041">(</span><span class="string" id="6149042">&#34;*/&#34;</span><span class="op" id="6149046">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149049">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149060">=</span>&nbsp;<span class="op" id="6149062">[</span><span class="op" id="6149063">]</span><span class="builtintype" id="6149064">byte</span><span class="op" id="6149068">(</span><span class="string" id="6149069">&#34;\n&#34;</span><span class="op" id="6149073">)</span><br>
<span class="lineno"></span><span class="op" id="6149075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6149078">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="6149158">func</span>&nbsp;<span class="ident" id="6149163">skipSpaceOrComment</span><span class="op" id="6149181">(</span><span class="ident" id="6149182">data</span>&nbsp;<span class="op" id="6149187">[</span><span class="op" id="6149188">]</span><span class="builtintype" id="6149189">byte</span><span class="op" id="6149193">)</span>&nbsp;<span class="op" id="6149195">[</span><span class="op" id="6149196">]</span><span class="builtintype" id="6149197">byte</span>&nbsp;<span class="op" id="6149202">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149205">for</span>&nbsp;<span class="builtinfunc" id="6149209">len</span><span class="op" id="6149212">(</span><span class="ident" id="6149213">data</span><span class="op" id="6149217">)</span>&nbsp;<span class="op" id="6149219">&gt;</span>&nbsp;<span class="num" id="6149221">0</span>&nbsp;<span class="op" id="6149223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149227">switch</span>&nbsp;<span class="ident" id="6149234">data</span><span class="op" id="6149238">[</span><span class="num" id="6149239">0</span><span class="op" id="6149240">]</span>&nbsp;<span class="op" id="6149242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149246">case</span>&nbsp;<span class="string" id="6149251">&#39;&nbsp;&#39;</span><span class="op" id="6149254">,</span>&nbsp;<span class="string" id="6149256">&#39;\t&#39;</span><span class="op" id="6149260">,</span>&nbsp;<span class="string" id="6149262">&#39;\r&#39;</span><span class="op" id="6149266">,</span>&nbsp;<span class="string" id="6149268">&#39;\n&#39;</span><span class="op" id="6149272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149277">data</span>&nbsp;<span class="op" id="6149282">=</span>&nbsp;<span class="ident" id="6149284">data</span><span class="op" id="6149288">[</span><span class="num" id="6149289">1</span><span class="op" id="6149290">:</span><span class="op" id="6149291">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149296">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149307">case</span>&nbsp;<span class="string" id="6149312">&#39;/&#39;</span><span class="op" id="6149315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149320">if</span>&nbsp;<span class="ident" id="6149323">bytes</span><span class="op" id="6149328">.</span><span class="ident" id="6149329">HasPrefix</span><span class="op" id="6149338">(</span><span class="ident" id="6149339">data</span><span class="op" id="6149343">,</span>&nbsp;<span class="ident" id="6149345">slashSlash</span><span class="op" id="6149355">)</span>&nbsp;<span class="op" id="6149357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149363">i</span>&nbsp;<span class="op" id="6149365">:=</span>&nbsp;<span class="ident" id="6149368">bytes</span><span class="op" id="6149373">.</span><span class="ident" id="6149374">Index</span><span class="op" id="6149379">(</span><span class="ident" id="6149380">data</span><span class="op" id="6149384">,</span>&nbsp;<span class="ident" id="6149386">newline</span><span class="op" id="6149393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149399">if</span>&nbsp;<span class="ident" id="6149402">i</span>&nbsp;<span class="op" id="6149404">&lt;</span>&nbsp;<span class="num" id="6149406">0</span>&nbsp;<span class="op" id="6149408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149415">return</span>&nbsp;<span class="ident" id="6149422">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149436">data</span>&nbsp;<span class="op" id="6149441">=</span>&nbsp;<span class="ident" id="6149443">data</span><span class="op" id="6149447">[</span><span class="ident" id="6149448">i</span><span class="op" id="6149449">+</span><span class="num" id="6149450">1</span><span class="op" id="6149451">:</span><span class="op" id="6149452">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149458">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149475">if</span>&nbsp;<span class="ident" id="6149478">bytes</span><span class="op" id="6149483">.</span><span class="ident" id="6149484">HasPrefix</span><span class="op" id="6149493">(</span><span class="ident" id="6149494">data</span><span class="op" id="6149498">,</span>&nbsp;<span class="ident" id="6149500">slashStar</span><span class="op" id="6149509">)</span>&nbsp;<span class="op" id="6149511">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149517">data</span>&nbsp;<span class="op" id="6149522">=</span>&nbsp;<span class="ident" id="6149524">data</span><span class="op" id="6149528">[</span><span class="num" id="6149529">2</span><span class="op" id="6149530">:</span><span class="op" id="6149531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149537">i</span>&nbsp;<span class="op" id="6149539">:=</span>&nbsp;<span class="ident" id="6149542">bytes</span><span class="op" id="6149547">.</span><span class="ident" id="6149548">Index</span><span class="op" id="6149553">(</span><span class="ident" id="6149554">data</span><span class="op" id="6149558">,</span>&nbsp;<span class="ident" id="6149560">starSlash</span><span class="op" id="6149569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149575">if</span>&nbsp;<span class="ident" id="6149578">i</span>&nbsp;<span class="op" id="6149580">&lt;</span>&nbsp;<span class="num" id="6149582">0</span>&nbsp;<span class="op" id="6149584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149591">return</span>&nbsp;<span class="ident" id="6149598">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149606">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149612">data</span>&nbsp;<span class="op" id="6149617">=</span>&nbsp;<span class="ident" id="6149619">data</span><span class="op" id="6149623">[</span><span class="ident" id="6149624">i</span><span class="op" id="6149625">+</span><span class="num" id="6149626">2</span><span class="op" id="6149627">:</span><span class="op" id="6149628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149634">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149654">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6149661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6149664">return</span>&nbsp;<span class="ident" id="6149671">data</span><br>
<span class="lineno"></span><span class="op" id="6149676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6149679">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="6149737">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="6149807">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="6149863">func</span>&nbsp;<span class="ident" id="6149868">parseWord</span><span class="op" id="6149877">(</span><span class="ident" id="6149878">data</span>&nbsp;<span class="op" id="6149883">[</span><span class="op" id="6149884">]</span><span class="builtintype" id="6149885">byte</span><span class="op" id="6149889">)</span>&nbsp;<span class="op" id="6149891">(</span><span class="ident" id="6149892">word</span><span class="op" id="6149896">,</span>&nbsp;<span class="ident" id="6149898">rest</span>&nbsp;<span class="op" id="6149903">[</span><span class="op" id="6149904">]</span><span class="builtintype" id="6149905">byte</span><span class="op" id="6149909">)</span>&nbsp;<span class="op" id="6149911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149914">data</span>&nbsp;<span class="op" id="6149919">=</span>&nbsp;<span class="ident" id="6149921">skipSpaceOrComment</span><span class="op" id="6149939">(</span><span class="ident" id="6149940">data</span><span class="op" id="6149944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6149948">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6149988">rest</span>&nbsp;<span class="op" id="6149993">=</span>&nbsp;<span class="ident" id="6149995">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150001">for</span>&nbsp;<span class="op" id="6150005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6150009">r</span><span class="op" id="6150010">,</span>&nbsp;<span class="ident" id="6150012">size</span>&nbsp;<span class="op" id="6150017">:=</span>&nbsp;<span class="ident" id="6150020">utf8</span><span class="op" id="6150024">.</span><span class="ident" id="6150025">DecodeRune</span><span class="op" id="6150035">(</span><span class="ident" id="6150036">rest</span><span class="op" id="6150040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150044">if</span>&nbsp;<span class="ident" id="6150047">unicode</span><span class="op" id="6150054">.</span><span class="ident" id="6150055">IsLetter</span><span class="op" id="6150063">(</span><span class="ident" id="6150064">r</span><span class="op" id="6150065">)</span>&nbsp;<span class="op" id="6150067">||</span>&nbsp;<span class="string" id="6150070">&#39;0&#39;</span>&nbsp;<span class="op" id="6150074">&lt;=</span>&nbsp;<span class="ident" id="6150077">r</span>&nbsp;<span class="op" id="6150079">&amp;&amp;</span>&nbsp;<span class="ident" id="6150082">r</span>&nbsp;<span class="op" id="6150084">&lt;=</span>&nbsp;<span class="string" id="6150087">&#39;9&#39;</span>&nbsp;<span class="op" id="6150091">||</span>&nbsp;<span class="ident" id="6150094">r</span>&nbsp;<span class="op" id="6150096">==</span>&nbsp;<span class="string" id="6150099">&#39;_&#39;</span>&nbsp;<span class="op" id="6150103">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6150108">rest</span>&nbsp;<span class="op" id="6150113">=</span>&nbsp;<span class="ident" id="6150115">rest</span><span class="op" id="6150119">[</span><span class="ident" id="6150120">size</span><span class="op" id="6150124">:</span><span class="op" id="6150125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150130">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6150141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150145">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6150152">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6150156">word</span>&nbsp;<span class="op" id="6150161">=</span>&nbsp;<span class="ident" id="6150163">data</span><span class="op" id="6150167">[</span><span class="op" id="6150168">:</span><span class="builtinfunc" id="6150169">len</span><span class="op" id="6150172">(</span><span class="ident" id="6150173">data</span><span class="op" id="6150177">)</span><span class="op" id="6150178">-</span><span class="builtinfunc" id="6150179">len</span><span class="op" id="6150182">(</span><span class="ident" id="6150183">rest</span><span class="op" id="6150187">)</span><span class="op" id="6150188">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150191">if</span>&nbsp;<span class="builtinfunc" id="6150194">len</span><span class="op" id="6150197">(</span><span class="ident" id="6150198">word</span><span class="op" id="6150202">)</span>&nbsp;<span class="op" id="6150204">==</span>&nbsp;<span class="num" id="6150207">0</span>&nbsp;<span class="op" id="6150209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150213">return</span>&nbsp;<span class="ident" id="6150220">nil</span><span class="op" id="6150223">,</span>&nbsp;<span class="ident" id="6150225">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6150230">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150234">return</span>&nbsp;<span class="ident" id="6150241">word</span><span class="op" id="6150245">,</span>&nbsp;<span class="ident" id="6150247">rest</span><br>
<span class="lineno"></span><span class="op" id="6150252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6150255">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="6150336">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="6150415">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6150437">//</span><br>
<span class="lineno"></span><span class="comment" id="6150440">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6150513">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="6150556">func</span>&nbsp;<span class="op" id="6150561">(</span><span class="ident" id="6150562">ctxt</span>&nbsp;<span class="op" id="6150567">*</span><span class="ident" id="6150568">Context</span><span class="op" id="6150575">)</span>&nbsp;<span class="ident" id="6150577">MatchFile</span><span class="op" id="6150586">(</span><span class="ident" id="6150587">dir</span><span class="op" id="6150590">,</span>&nbsp;<span class="ident" id="6150592">name</span>&nbsp;<span class="builtintype" id="6150597">string</span><span class="op" id="6150603">)</span>&nbsp;<span class="op" id="6150605">(</span><span class="ident" id="6150606">match</span>&nbsp;<span class="builtintype" id="6150612">bool</span><span class="op" id="6150616">,</span>&nbsp;<span class="ident" id="6150618">err</span>&nbsp;<span class="builtintype" id="6150622">error</span><span class="op" id="6150627">)</span>&nbsp;<span class="op" id="6150629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6150632">match</span><span class="op" id="6150637">,</span>&nbsp;<span class="ident" id="6150639">_</span><span class="op" id="6150640">,</span>&nbsp;<span class="ident" id="6150642">_</span><span class="op" id="6150643">,</span>&nbsp;<span class="ident" id="6150645">err</span>&nbsp;<span class="op" id="6150649">=</span>&nbsp;<span class="ident" id="6150651">ctxt</span><span class="op" id="6150655">.</span><span class="ident" id="6150656">matchFile</span><span class="op" id="6150665">(</span><span class="ident" id="6150666">dir</span><span class="op" id="6150669">,</span>&nbsp;<span class="ident" id="6150671">name</span><span class="op" id="6150675">,</span>&nbsp;<span class="builtintype" id="6150677">false</span><span class="op" id="6150682">,</span>&nbsp;<span class="ident" id="6150684">nil</span><span class="op" id="6150687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6150690">return</span><br>
<span class="lineno"></span><span class="op" id="6150697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="6150700">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="6150784">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="6150840">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6150883">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="6150958">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="6151034">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="6151081">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="6151151">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="6151186">func</span>&nbsp;<span class="op" id="6151191">(</span><span class="ident" id="6151192">ctxt</span>&nbsp;<span class="op" id="6151197">*</span><span class="ident" id="6151198">Context</span><span class="op" id="6151205">)</span>&nbsp;<span class="ident" id="6151207">matchFile</span><span class="op" id="6151216">(</span><span class="ident" id="6151217">dir</span><span class="op" id="6151220">,</span>&nbsp;<span class="ident" id="6151222">name</span>&nbsp;<span class="builtintype" id="6151227">string</span><span class="op" id="6151233">,</span>&nbsp;<span class="ident" id="6151235">returnImports</span>&nbsp;<span class="builtintype" id="6151249">bool</span><span class="op" id="6151253">,</span>&nbsp;<span class="ident" id="6151255">allTags</span>&nbsp;<span class="keyword" id="6151263">map</span><span class="op" id="6151266">[</span><span class="builtintype" id="6151267">string</span><span class="op" id="6151273">]</span><span class="builtintype" id="6151274">bool</span><span class="op" id="6151278">)</span>&nbsp;<span class="op" id="6151280">(</span><span class="ident" id="6151281">match</span>&nbsp;<span class="builtintype" id="6151287">bool</span><span class="op" id="6151291">,</span>&nbsp;<span class="ident" id="6151293">data</span>&nbsp;<span class="op" id="6151298">[</span><span class="op" id="6151299">]</span><span class="builtintype" id="6151300">byte</span><span class="op" id="6151304">,</span>&nbsp;<span class="ident" id="6151306">filename</span>&nbsp;<span class="builtintype" id="6151315">string</span><span class="op" id="6151321">,</span>&nbsp;<span class="ident" id="6151323">err</span>&nbsp;<span class="builtintype" id="6151327">error</span><span class="op" id="6151332">)</span>&nbsp;<span class="op" id="6151334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151337">if</span>&nbsp;<span class="ident" id="6151340">strings</span><span class="op" id="6151347">.</span><span class="ident" id="6151348">HasPrefix</span><span class="op" id="6151357">(</span><span class="ident" id="6151358">name</span><span class="op" id="6151362">,</span>&nbsp;<span class="string" id="6151364">&#34;_&#34;</span><span class="op" id="6151367">)</span>&nbsp;<span class="op" id="6151369">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151374">strings</span><span class="op" id="6151381">.</span><span class="ident" id="6151382">HasPrefix</span><span class="op" id="6151391">(</span><span class="ident" id="6151392">name</span><span class="op" id="6151396">,</span>&nbsp;<span class="string" id="6151398">&#34;.&#34;</span><span class="op" id="6151401">)</span>&nbsp;<span class="op" id="6151403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6151415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151419">i</span>&nbsp;<span class="op" id="6151421">:=</span>&nbsp;<span class="ident" id="6151424">strings</span><span class="op" id="6151431">.</span><span class="ident" id="6151432">LastIndex</span><span class="op" id="6151441">(</span><span class="ident" id="6151442">name</span><span class="op" id="6151446">,</span>&nbsp;<span class="string" id="6151448">&#34;.&#34;</span><span class="op" id="6151451">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151454">if</span>&nbsp;<span class="ident" id="6151457">i</span>&nbsp;<span class="op" id="6151459">&lt;</span>&nbsp;<span class="num" id="6151461">0</span>&nbsp;<span class="op" id="6151463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151467">i</span>&nbsp;<span class="op" id="6151469">=</span>&nbsp;<span class="builtinfunc" id="6151471">len</span><span class="op" id="6151474">(</span><span class="ident" id="6151475">name</span><span class="op" id="6151479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6151482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151485">ext</span>&nbsp;<span class="op" id="6151489">:=</span>&nbsp;<span class="ident" id="6151492">name</span><span class="op" id="6151496">[</span><span class="ident" id="6151497">i</span><span class="op" id="6151498">:</span><span class="op" id="6151499">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151503">if</span>&nbsp;<span class="op" id="6151506">!</span><span class="ident" id="6151507">ctxt</span><span class="op" id="6151511">.</span><span class="ident" id="6151512">goodOSArchFile</span><span class="op" id="6151526">(</span><span class="ident" id="6151527">name</span><span class="op" id="6151531">,</span>&nbsp;<span class="ident" id="6151533">allTags</span><span class="op" id="6151540">)</span>&nbsp;<span class="op" id="6151542">&amp;&amp;</span>&nbsp;<span class="op" id="6151545">!</span><span class="ident" id="6151546">ctxt</span><span class="op" id="6151550">.</span><span class="ident" id="6151551">UseAllFiles</span>&nbsp;<span class="op" id="6151563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151567">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6151575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151579">switch</span>&nbsp;<span class="ident" id="6151586">ext</span>&nbsp;<span class="op" id="6151590">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151593">case</span>&nbsp;<span class="string" id="6151598">&#34;.go&#34;</span><span class="op" id="6151603">,</span>&nbsp;<span class="string" id="6151605">&#34;.c&#34;</span><span class="op" id="6151609">,</span>&nbsp;<span class="string" id="6151611">&#34;.cc&#34;</span><span class="op" id="6151616">,</span>&nbsp;<span class="string" id="6151618">&#34;.cxx&#34;</span><span class="op" id="6151624">,</span>&nbsp;<span class="string" id="6151626">&#34;.cpp&#34;</span><span class="op" id="6151632">,</span>&nbsp;<span class="string" id="6151634">&#34;.m&#34;</span><span class="op" id="6151638">,</span>&nbsp;<span class="string" id="6151640">&#34;.s&#34;</span><span class="op" id="6151644">,</span>&nbsp;<span class="string" id="6151646">&#34;.h&#34;</span><span class="op" id="6151650">,</span>&nbsp;<span class="string" id="6151652">&#34;.hh&#34;</span><span class="op" id="6151657">,</span>&nbsp;<span class="string" id="6151659">&#34;.hpp&#34;</span><span class="op" id="6151665">,</span>&nbsp;<span class="string" id="6151667">&#34;.hxx&#34;</span><span class="op" id="6151673">,</span>&nbsp;<span class="string" id="6151675">&#34;.S&#34;</span><span class="op" id="6151679">,</span>&nbsp;<span class="string" id="6151681">&#34;.swig&#34;</span><span class="op" id="6151688">,</span>&nbsp;<span class="string" id="6151690">&#34;.swigcxx&#34;</span><span class="op" id="6151700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6151704">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151745">case</span>&nbsp;<span class="string" id="6151750">&#34;.syso&#34;</span><span class="op" id="6151757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6151761">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151785">match</span>&nbsp;<span class="op" id="6151791">=</span>&nbsp;<span class="builtintype" id="6151793">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151800">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151808">default</span><span class="op" id="6151815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6151819">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6151837">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151841">filename</span>&nbsp;<span class="op" id="6151850">=</span>&nbsp;<span class="ident" id="6151852">ctxt</span><span class="op" id="6151856">.</span><span class="ident" id="6151857">joinPath</span><span class="op" id="6151865">(</span><span class="ident" id="6151866">dir</span><span class="op" id="6151869">,</span>&nbsp;<span class="ident" id="6151871">name</span><span class="op" id="6151875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151878">f</span><span class="op" id="6151879">,</span>&nbsp;<span class="ident" id="6151881">err</span>&nbsp;<span class="op" id="6151885">:=</span>&nbsp;<span class="ident" id="6151888">ctxt</span><span class="op" id="6151892">.</span><span class="ident" id="6151893">openFile</span><span class="op" id="6151901">(</span><span class="ident" id="6151902">filename</span><span class="op" id="6151910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151913">if</span>&nbsp;<span class="ident" id="6151916">err</span>&nbsp;<span class="op" id="6151920">!=</span>&nbsp;<span class="ident" id="6151923">nil</span>&nbsp;<span class="op" id="6151927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151931">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6151939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6151943">if</span>&nbsp;<span class="ident" id="6151946">strings</span><span class="op" id="6151953">.</span><span class="ident" id="6151954">HasSuffix</span><span class="op" id="6151963">(</span><span class="ident" id="6151964">filename</span><span class="op" id="6151972">,</span>&nbsp;<span class="string" id="6151974">&#34;.go&#34;</span><span class="op" id="6151979">)</span>&nbsp;<span class="op" id="6151981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6151985">data</span><span class="op" id="6151989">,</span>&nbsp;<span class="ident" id="6151991">err</span>&nbsp;<span class="op" id="6151995">=</span>&nbsp;<span class="ident" id="6151997">readImports</span><span class="op" id="6152008">(</span><span class="ident" id="6152009">f</span><span class="op" id="6152010">,</span>&nbsp;<span class="builtintype" id="6152012">false</span><span class="op" id="6152017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6152020">}</span>&nbsp;<span class="keyword" id="6152022">else</span>&nbsp;<span class="op" id="6152027">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152031">data</span><span class="op" id="6152035">,</span>&nbsp;<span class="ident" id="6152037">err</span>&nbsp;<span class="op" id="6152041">=</span>&nbsp;<span class="ident" id="6152043">readComments</span><span class="op" id="6152055">(</span><span class="ident" id="6152056">f</span><span class="op" id="6152057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6152060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152063">f</span><span class="op" id="6152064">.</span><span class="ident" id="6152065">Close</span><span class="op" id="6152070">(</span><span class="op" id="6152071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152074">if</span>&nbsp;<span class="ident" id="6152077">err</span>&nbsp;<span class="op" id="6152081">!=</span>&nbsp;<span class="ident" id="6152084">nil</span>&nbsp;<span class="op" id="6152088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152092">err</span>&nbsp;<span class="op" id="6152096">=</span>&nbsp;<span class="ident" id="6152098">fmt</span><span class="op" id="6152101">.</span><span class="ident" id="6152102">Errorf</span><span class="op" id="6152108">(</span><span class="string" id="6152109">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6152122">,</span>&nbsp;<span class="ident" id="6152124">filename</span><span class="op" id="6152132">,</span>&nbsp;<span class="ident" id="6152134">err</span><span class="op" id="6152137">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6152149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6152153">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152212">if</span>&nbsp;<span class="op" id="6152215">!</span><span class="ident" id="6152216">ctxt</span><span class="op" id="6152220">.</span><span class="ident" id="6152221">shouldBuild</span><span class="op" id="6152232">(</span><span class="ident" id="6152233">data</span><span class="op" id="6152237">,</span>&nbsp;<span class="ident" id="6152239">allTags</span><span class="op" id="6152246">)</span>&nbsp;<span class="op" id="6152248">&amp;&amp;</span>&nbsp;<span class="op" id="6152251">!</span><span class="ident" id="6152252">ctxt</span><span class="op" id="6152256">.</span><span class="ident" id="6152257">UseAllFiles</span>&nbsp;<span class="op" id="6152269">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152273">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6152281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152285">match</span>&nbsp;<span class="op" id="6152291">=</span>&nbsp;<span class="builtintype" id="6152293">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152299">return</span><br>
<span class="lineno">975</span><span class="op" id="6152306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6152309">func</span>&nbsp;<span class="ident" id="6152314">cleanImports</span><span class="op" id="6152326">(</span><span class="ident" id="6152327">m</span>&nbsp;<span class="keyword" id="6152329">map</span><span class="op" id="6152332">[</span><span class="builtintype" id="6152333">string</span><span class="op" id="6152339">]</span><span class="op" id="6152340">[</span><span class="op" id="6152341">]</span><span class="ident" id="6152342">token</span><span class="op" id="6152347">.</span><span class="ident" id="6152348">Position</span><span class="op" id="6152356">)</span>&nbsp;<span class="op" id="6152358">(</span><span class="op" id="6152359">[</span><span class="op" id="6152360">]</span><span class="builtintype" id="6152361">string</span><span class="op" id="6152367">,</span>&nbsp;<span class="keyword" id="6152369">map</span><span class="op" id="6152372">[</span><span class="builtintype" id="6152373">string</span><span class="op" id="6152379">]</span><span class="op" id="6152380">[</span><span class="op" id="6152381">]</span><span class="ident" id="6152382">token</span><span class="op" id="6152387">.</span><span class="ident" id="6152388">Position</span><span class="op" id="6152396">)</span>&nbsp;<span class="op" id="6152398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152401">all</span>&nbsp;<span class="op" id="6152405">:=</span>&nbsp;<span class="builtinfunc" id="6152408">make</span><span class="op" id="6152412">(</span><span class="op" id="6152413">[</span><span class="op" id="6152414">]</span><span class="builtintype" id="6152415">string</span><span class="op" id="6152421">,</span>&nbsp;<span class="num" id="6152423">0</span><span class="op" id="6152424">,</span>&nbsp;<span class="builtinfunc" id="6152426">len</span><span class="op" id="6152429">(</span><span class="ident" id="6152430">m</span><span class="op" id="6152431">)</span><span class="op" id="6152432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152435">for</span>&nbsp;<span class="ident" id="6152439">path</span>&nbsp;<span class="op" id="6152444">:=</span>&nbsp;<span class="keyword" id="6152447">range</span>&nbsp;<span class="ident" id="6152453">m</span>&nbsp;<span class="op" id="6152455">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152459">all</span>&nbsp;<span class="op" id="6152463">=</span>&nbsp;<span class="builtinfunc" id="6152465">append</span><span class="op" id="6152471">(</span><span class="ident" id="6152472">all</span><span class="op" id="6152475">,</span>&nbsp;<span class="ident" id="6152477">path</span><span class="op" id="6152481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6152484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6152487">sort</span><span class="op" id="6152491">.</span><span class="ident" id="6152492">Strings</span><span class="op" id="6152499">(</span><span class="ident" id="6152500">all</span><span class="op" id="6152503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152506">return</span>&nbsp;<span class="ident" id="6152513">all</span><span class="op" id="6152516">,</span>&nbsp;<span class="ident" id="6152518">m</span><br>
<span class="lineno"></span><span class="op" id="6152520">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="6152523">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="6152566">func</span>&nbsp;<span class="ident" id="6152571">Import</span><span class="op" id="6152577">(</span><span class="ident" id="6152578">path</span><span class="op" id="6152582">,</span>&nbsp;<span class="ident" id="6152584">srcDir</span>&nbsp;<span class="builtintype" id="6152591">string</span><span class="op" id="6152597">,</span>&nbsp;<span class="ident" id="6152599">mode</span>&nbsp;<span class="ident" id="6152604">ImportMode</span><span class="op" id="6152614">)</span>&nbsp;<span class="op" id="6152616">(</span><span class="op" id="6152617">*</span><span class="ident" id="6152618">Package</span><span class="op" id="6152625">,</span>&nbsp;<span class="builtintype" id="6152627">error</span><span class="op" id="6152632">)</span>&nbsp;<span class="op" id="6152634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152637">return</span>&nbsp;<span class="ident" id="6152644">Default</span><span class="op" id="6152651">.</span><span class="ident" id="6152652">Import</span><span class="op" id="6152658">(</span><span class="ident" id="6152659">path</span><span class="op" id="6152663">,</span>&nbsp;<span class="ident" id="6152665">srcDir</span><span class="op" id="6152671">,</span>&nbsp;<span class="ident" id="6152673">mode</span><span class="op" id="6152677">)</span><br>
<span class="lineno"></span><span class="op" id="6152679">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="6152682">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6152731">func</span>&nbsp;<span class="ident" id="6152736">ImportDir</span><span class="op" id="6152745">(</span><span class="ident" id="6152746">dir</span>&nbsp;<span class="builtintype" id="6152750">string</span><span class="op" id="6152756">,</span>&nbsp;<span class="ident" id="6152758">mode</span>&nbsp;<span class="ident" id="6152763">ImportMode</span><span class="op" id="6152773">)</span>&nbsp;<span class="op" id="6152775">(</span><span class="op" id="6152776">*</span><span class="ident" id="6152777">Package</span><span class="op" id="6152784">,</span>&nbsp;<span class="builtintype" id="6152786">error</span><span class="op" id="6152791">)</span>&nbsp;<span class="op" id="6152793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6152796">return</span>&nbsp;<span class="ident" id="6152803">Default</span><span class="op" id="6152810">.</span><span class="ident" id="6152811">ImportDir</span><span class="op" id="6152820">(</span><span class="ident" id="6152821">dir</span><span class="op" id="6152824">,</span>&nbsp;<span class="ident" id="6152826">mode</span><span class="op" id="6152830">)</span><br>
<span class="lineno"></span><span class="op" id="6152832">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="6152835">var</span>&nbsp;<span class="ident" id="6152839">slashslash</span>&nbsp;<span class="op" id="6152850">=</span>&nbsp;<span class="op" id="6152852">[</span><span class="op" id="6152853">]</span><span class="builtintype" id="6152854">byte</span><span class="op" id="6152858">(</span><span class="string" id="6152859">&#34;//&#34;</span><span class="op" id="6152863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6152866">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="6152926">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="6152987">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="6153046">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="6153103">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="6153170">//</span><br>
<span class="lineno"></span><span class="comment" id="6153173">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="6153236">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6153272">//</span><br>
<span class="lineno"></span><span class="comment" id="6153275">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="6153302">//</span><br>
<span class="lineno"></span><span class="comment" id="6153305">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="6153364">//</span><br>
<span class="lineno"></span><span class="keyword" id="6153367">func</span>&nbsp;<span class="op" id="6153372">(</span><span class="ident" id="6153373">ctxt</span>&nbsp;<span class="op" id="6153378">*</span><span class="ident" id="6153379">Context</span><span class="op" id="6153386">)</span>&nbsp;<span class="ident" id="6153388">shouldBuild</span><span class="op" id="6153399">(</span><span class="ident" id="6153400">content</span>&nbsp;<span class="op" id="6153408">[</span><span class="op" id="6153409">]</span><span class="builtintype" id="6153410">byte</span><span class="op" id="6153414">,</span>&nbsp;<span class="ident" id="6153416">allTags</span>&nbsp;<span class="keyword" id="6153424">map</span><span class="op" id="6153427">[</span><span class="builtintype" id="6153428">string</span><span class="op" id="6153434">]</span><span class="builtintype" id="6153435">bool</span><span class="op" id="6153439">)</span>&nbsp;<span class="builtintype" id="6153441">bool</span>&nbsp;<span class="op" id="6153446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6153449">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6153514">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153558">end</span>&nbsp;<span class="op" id="6153562">:=</span>&nbsp;<span class="num" id="6153565">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153568">p</span>&nbsp;<span class="op" id="6153570">:=</span>&nbsp;<span class="ident" id="6153573">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153582">for</span>&nbsp;<span class="builtinfunc" id="6153586">len</span><span class="op" id="6153589">(</span><span class="ident" id="6153590">p</span><span class="op" id="6153591">)</span>&nbsp;<span class="op" id="6153593">&gt;</span>&nbsp;<span class="num" id="6153595">0</span>&nbsp;<span class="op" id="6153597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153601">line</span>&nbsp;<span class="op" id="6153606">:=</span>&nbsp;<span class="ident" id="6153609">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153613">if</span>&nbsp;<span class="ident" id="6153616">i</span>&nbsp;<span class="op" id="6153618">:=</span>&nbsp;<span class="ident" id="6153621">bytes</span><span class="op" id="6153626">.</span><span class="ident" id="6153627">IndexByte</span><span class="op" id="6153636">(</span><span class="ident" id="6153637">line</span><span class="op" id="6153641">,</span>&nbsp;<span class="string" id="6153643">&#39;\n&#39;</span><span class="op" id="6153647">)</span><span class="op" id="6153648">;</span>&nbsp;<span class="ident" id="6153650">i</span>&nbsp;<span class="op" id="6153652">&gt;=</span>&nbsp;<span class="num" id="6153655">0</span>&nbsp;<span class="op" id="6153657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153662">line</span><span class="op" id="6153666">,</span>&nbsp;<span class="ident" id="6153668">p</span>&nbsp;<span class="op" id="6153670">=</span>&nbsp;<span class="ident" id="6153672">line</span><span class="op" id="6153676">[</span><span class="op" id="6153677">:</span><span class="ident" id="6153678">i</span><span class="op" id="6153679">]</span><span class="op" id="6153680">,</span>&nbsp;<span class="ident" id="6153682">p</span><span class="op" id="6153683">[</span><span class="ident" id="6153684">i</span><span class="op" id="6153685">+</span><span class="num" id="6153686">1</span><span class="op" id="6153687">:</span><span class="op" id="6153688">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6153692">}</span>&nbsp;<span class="keyword" id="6153694">else</span>&nbsp;<span class="op" id="6153699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153704">p</span>&nbsp;<span class="op" id="6153706">=</span>&nbsp;<span class="ident" id="6153708">p</span><span class="op" id="6153709">[</span><span class="builtinfunc" id="6153710">len</span><span class="op" id="6153713">(</span><span class="ident" id="6153714">p</span><span class="op" id="6153715">)</span><span class="op" id="6153716">:</span><span class="op" id="6153717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6153721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153725">line</span>&nbsp;<span class="op" id="6153730">=</span>&nbsp;<span class="ident" id="6153732">bytes</span><span class="op" id="6153737">.</span><span class="ident" id="6153738">TrimSpace</span><span class="op" id="6153747">(</span><span class="ident" id="6153748">line</span><span class="op" id="6153752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153756">if</span>&nbsp;<span class="builtinfunc" id="6153759">len</span><span class="op" id="6153762">(</span><span class="ident" id="6153763">line</span><span class="op" id="6153767">)</span>&nbsp;<span class="op" id="6153769">==</span>&nbsp;<span class="num" id="6153772">0</span>&nbsp;<span class="op" id="6153774">{</span>&nbsp;<span class="comment" id="6153776">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153793">end</span>&nbsp;<span class="op" id="6153797">=</span>&nbsp;<span class="builtinfunc" id="6153799">len</span><span class="op" id="6153802">(</span><span class="ident" id="6153803">content</span><span class="op" id="6153810">)</span>&nbsp;<span class="op" id="6153812">-</span>&nbsp;<span class="builtinfunc" id="6153814">len</span><span class="op" id="6153817">(</span><span class="ident" id="6153818">p</span><span class="op" id="6153819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153824">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6153835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153839">if</span>&nbsp;<span class="op" id="6153842">!</span><span class="ident" id="6153843">bytes</span><span class="op" id="6153848">.</span><span class="ident" id="6153849">HasPrefix</span><span class="op" id="6153858">(</span><span class="ident" id="6153859">line</span><span class="op" id="6153863">,</span>&nbsp;<span class="ident" id="6153865">slashslash</span><span class="op" id="6153875">)</span>&nbsp;<span class="op" id="6153877">{</span>&nbsp;<span class="comment" id="6153879">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6153902">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6153910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6153913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153916">content</span>&nbsp;<span class="op" id="6153924">=</span>&nbsp;<span class="ident" id="6153926">content</span><span class="op" id="6153933">[</span><span class="op" id="6153934">:</span><span class="ident" id="6153935">end</span><span class="op" id="6153938">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6153942">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153985">p</span>&nbsp;<span class="op" id="6153987">=</span>&nbsp;<span class="ident" id="6153989">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6153998">allok</span>&nbsp;<span class="op" id="6154004">:=</span>&nbsp;<span class="builtintype" id="6154007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154013">for</span>&nbsp;<span class="builtinfunc" id="6154017">len</span><span class="op" id="6154020">(</span><span class="ident" id="6154021">p</span><span class="op" id="6154022">)</span>&nbsp;<span class="op" id="6154024">&gt;</span>&nbsp;<span class="num" id="6154026">0</span>&nbsp;<span class="op" id="6154028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154032">line</span>&nbsp;<span class="op" id="6154037">:=</span>&nbsp;<span class="ident" id="6154040">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154044">if</span>&nbsp;<span class="ident" id="6154047">i</span>&nbsp;<span class="op" id="6154049">:=</span>&nbsp;<span class="ident" id="6154052">bytes</span><span class="op" id="6154057">.</span><span class="ident" id="6154058">IndexByte</span><span class="op" id="6154067">(</span><span class="ident" id="6154068">line</span><span class="op" id="6154072">,</span>&nbsp;<span class="string" id="6154074">&#39;\n&#39;</span><span class="op" id="6154078">)</span><span class="op" id="6154079">;</span>&nbsp;<span class="ident" id="6154081">i</span>&nbsp;<span class="op" id="6154083">&gt;=</span>&nbsp;<span class="num" id="6154086">0</span>&nbsp;<span class="op" id="6154088">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154093">line</span><span class="op" id="6154097">,</span>&nbsp;<span class="ident" id="6154099">p</span>&nbsp;<span class="op" id="6154101">=</span>&nbsp;<span class="ident" id="6154103">line</span><span class="op" id="6154107">[</span><span class="op" id="6154108">:</span><span class="ident" id="6154109">i</span><span class="op" id="6154110">]</span><span class="op" id="6154111">,</span>&nbsp;<span class="ident" id="6154113">p</span><span class="op" id="6154114">[</span><span class="ident" id="6154115">i</span><span class="op" id="6154116">+</span><span class="num" id="6154117">1</span><span class="op" id="6154118">:</span><span class="op" id="6154119">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154123">}</span>&nbsp;<span class="keyword" id="6154125">else</span>&nbsp;<span class="op" id="6154130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154135">p</span>&nbsp;<span class="op" id="6154137">=</span>&nbsp;<span class="ident" id="6154139">p</span><span class="op" id="6154140">[</span><span class="builtinfunc" id="6154141">len</span><span class="op" id="6154144">(</span><span class="ident" id="6154145">p</span><span class="op" id="6154146">)</span><span class="op" id="6154147">:</span><span class="op" id="6154148">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154156">line</span>&nbsp;<span class="op" id="6154161">=</span>&nbsp;<span class="ident" id="6154163">bytes</span><span class="op" id="6154168">.</span><span class="ident" id="6154169">TrimSpace</span><span class="op" id="6154178">(</span><span class="ident" id="6154179">line</span><span class="op" id="6154183">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154187">if</span>&nbsp;<span class="ident" id="6154190">bytes</span><span class="op" id="6154195">.</span><span class="ident" id="6154196">HasPrefix</span><span class="op" id="6154205">(</span><span class="ident" id="6154206">line</span><span class="op" id="6154210">,</span>&nbsp;<span class="ident" id="6154212">slashslash</span><span class="op" id="6154222">)</span>&nbsp;<span class="op" id="6154224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154229">line</span>&nbsp;<span class="op" id="6154234">=</span>&nbsp;<span class="ident" id="6154236">bytes</span><span class="op" id="6154241">.</span><span class="ident" id="6154242">TrimSpace</span><span class="op" id="6154251">(</span><span class="ident" id="6154252">line</span><span class="op" id="6154256">[</span><span class="builtinfunc" id="6154257">len</span><span class="op" id="6154260">(</span><span class="ident" id="6154261">slashslash</span><span class="op" id="6154271">)</span><span class="op" id="6154272">:</span><span class="op" id="6154273">]</span><span class="op" id="6154274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154279">if</span>&nbsp;<span class="builtinfunc" id="6154282">len</span><span class="op" id="6154285">(</span><span class="ident" id="6154286">line</span><span class="op" id="6154290">)</span>&nbsp;<span class="op" id="6154292">&gt;</span>&nbsp;<span class="num" id="6154294">0</span>&nbsp;<span class="op" id="6154296">&amp;&amp;</span>&nbsp;<span class="ident" id="6154299">line</span><span class="op" id="6154303">[</span><span class="num" id="6154304">0</span><span class="op" id="6154305">]</span>&nbsp;<span class="op" id="6154307">==</span>&nbsp;<span class="string" id="6154310">&#39;+&#39;</span>&nbsp;<span class="op" id="6154314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6154320">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154355">f</span>&nbsp;<span class="op" id="6154357">:=</span>&nbsp;<span class="ident" id="6154360">strings</span><span class="op" id="6154367">.</span><span class="ident" id="6154368">Fields</span><span class="op" id="6154374">(</span><span class="builtintype" id="6154375">string</span><span class="op" id="6154381">(</span><span class="ident" id="6154382">line</span><span class="op" id="6154386">)</span><span class="op" id="6154387">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154393">if</span>&nbsp;<span class="ident" id="6154396">f</span><span class="op" id="6154397">[</span><span class="num" id="6154398">0</span><span class="op" id="6154399">]</span>&nbsp;<span class="op" id="6154401">==</span>&nbsp;<span class="string" id="6154404">&#34;+build&#34;</span>&nbsp;<span class="op" id="6154413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154420">ok</span>&nbsp;<span class="op" id="6154423">:=</span>&nbsp;<span class="builtintype" id="6154426">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154437">for</span>&nbsp;<span class="ident" id="6154441">_</span><span class="op" id="6154442">,</span>&nbsp;<span class="ident" id="6154444">tok</span>&nbsp;<span class="op" id="6154448">:=</span>&nbsp;<span class="keyword" id="6154451">range</span>&nbsp;<span class="ident" id="6154457">f</span><span class="op" id="6154458">[</span><span class="num" id="6154459">1</span><span class="op" id="6154460">:</span><span class="op" id="6154461">]</span>&nbsp;<span class="op" id="6154463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154471">if</span>&nbsp;<span class="ident" id="6154474">ctxt</span><span class="op" id="6154478">.</span><span class="ident" id="6154479">match</span><span class="op" id="6154484">(</span><span class="ident" id="6154485">tok</span><span class="op" id="6154488">,</span>&nbsp;<span class="ident" id="6154490">allTags</span><span class="op" id="6154497">)</span>&nbsp;<span class="op" id="6154499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154508">ok</span>&nbsp;<span class="op" id="6154511">=</span>&nbsp;<span class="builtintype" id="6154513">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154538">if</span>&nbsp;<span class="op" id="6154541">!</span><span class="ident" id="6154542">ok</span>&nbsp;<span class="op" id="6154545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6154553">allok</span>&nbsp;<span class="op" id="6154559">=</span>&nbsp;<span class="builtintype" id="6154561">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154572">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6154590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6154594">return</span>&nbsp;<span class="ident" id="6154601">allok</span><br>
<span class="lineno"></span><span class="op" id="6154607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6154610">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="6154690">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="6154774">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="6154820">//</span><br>
<span class="lineno"></span><span class="comment" id="6154823">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="6154866">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="6154919">func</span>&nbsp;<span class="op" id="6154924">(</span><span class="ident" id="6154925">ctxt</span>&nbsp;<span class="op" id="6154930">*</span><span class="ident" id="6154931">Context</span><span class="op" id="6154938">)</span>&nbsp;<span class="ident" id="6154940">saveCgo</span><span class="op" id="6154947">(</span><span class="ident" id="6154948">filename</span>&nbsp;<span class="builtintype" id="6154957">string</span><span class="op" id="6154963">,</span>&nbsp;<span class="ident" id="6154965">di</span>&nbsp;<span class="op" id="6154968">*</span><span class="ident" id="6154969">Package</span><span class="op" id="6154976">,</span>&nbsp;<span class="ident" id="6154978">cg</span>&nbsp;<span class="op" id="6154981">*</span><span class="ident" id="6154982">ast</span><span class="op" id="6154985">.</span><span class="ident" id="6154986">CommentGroup</span><span class="op" id="6154998">)</span>&nbsp;<span class="builtintype" id="6155000">error</span>&nbsp;<span class="op" id="6155006">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155009">text</span>&nbsp;<span class="op" id="6155014">:=</span>&nbsp;<span class="ident" id="6155017">cg</span><span class="op" id="6155019">.</span><span class="ident" id="6155020">Text</span><span class="op" id="6155024">(</span><span class="op" id="6155025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155028">for</span>&nbsp;<span class="ident" id="6155032">_</span><span class="op" id="6155033">,</span>&nbsp;<span class="ident" id="6155035">line</span>&nbsp;<span class="op" id="6155040">:=</span>&nbsp;<span class="keyword" id="6155043">range</span>&nbsp;<span class="ident" id="6155049">strings</span><span class="op" id="6155056">.</span><span class="ident" id="6155057">Split</span><span class="op" id="6155062">(</span><span class="ident" id="6155063">text</span><span class="op" id="6155067">,</span>&nbsp;<span class="string" id="6155069">&#34;\n&#34;</span><span class="op" id="6155073">)</span>&nbsp;<span class="op" id="6155075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155079">orig</span>&nbsp;<span class="op" id="6155084">:=</span>&nbsp;<span class="ident" id="6155087">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6155095">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6155108">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6155150">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155155">line</span>&nbsp;<span class="op" id="6155160">=</span>&nbsp;<span class="ident" id="6155162">strings</span><span class="op" id="6155169">.</span><span class="ident" id="6155170">TrimSpace</span><span class="op" id="6155179">(</span><span class="ident" id="6155180">line</span><span class="op" id="6155184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155188">if</span>&nbsp;<span class="builtinfunc" id="6155191">len</span><span class="op" id="6155194">(</span><span class="ident" id="6155195">line</span><span class="op" id="6155199">)</span>&nbsp;<span class="op" id="6155201">&lt;</span>&nbsp;<span class="num" id="6155203">5</span>&nbsp;<span class="op" id="6155205">||</span>&nbsp;<span class="ident" id="6155208">line</span><span class="op" id="6155212">[</span><span class="op" id="6155213">:</span><span class="num" id="6155214">4</span><span class="op" id="6155215">]</span>&nbsp;<span class="op" id="6155217">!=</span>&nbsp;<span class="string" id="6155220">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="6155227">||</span>&nbsp;<span class="op" id="6155230">(</span><span class="ident" id="6155231">line</span><span class="op" id="6155235">[</span><span class="num" id="6155236">4</span><span class="op" id="6155237">]</span>&nbsp;<span class="op" id="6155239">!=</span>&nbsp;<span class="string" id="6155242">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6155246">&amp;&amp;</span>&nbsp;<span class="ident" id="6155249">line</span><span class="op" id="6155253">[</span><span class="num" id="6155254">4</span><span class="op" id="6155255">]</span>&nbsp;<span class="op" id="6155257">!=</span>&nbsp;<span class="string" id="6155260">&#39;\t&#39;</span><span class="op" id="6155264">)</span>&nbsp;<span class="op" id="6155266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155271">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6155287">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155308">line</span>&nbsp;<span class="op" id="6155313">=</span>&nbsp;<span class="ident" id="6155315">strings</span><span class="op" id="6155322">.</span><span class="ident" id="6155323">TrimSpace</span><span class="op" id="6155332">(</span><span class="ident" id="6155333">line</span><span class="op" id="6155337">[</span><span class="num" id="6155338">4</span><span class="op" id="6155339">:</span><span class="op" id="6155340">]</span><span class="op" id="6155341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155345">i</span>&nbsp;<span class="op" id="6155347">:=</span>&nbsp;<span class="ident" id="6155350">strings</span><span class="op" id="6155357">.</span><span class="ident" id="6155358">Index</span><span class="op" id="6155363">(</span><span class="ident" id="6155364">line</span><span class="op" id="6155368">,</span>&nbsp;<span class="string" id="6155370">&#34;:&#34;</span><span class="op" id="6155373">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155377">if</span>&nbsp;<span class="ident" id="6155380">i</span>&nbsp;<span class="op" id="6155382">&lt;</span>&nbsp;<span class="num" id="6155384">0</span>&nbsp;<span class="op" id="6155386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155391">return</span>&nbsp;<span class="ident" id="6155398">fmt</span><span class="op" id="6155401">.</span><span class="ident" id="6155402">Errorf</span><span class="op" id="6155408">(</span><span class="string" id="6155409">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6155436">,</span>&nbsp;<span class="ident" id="6155438">filename</span><span class="op" id="6155446">,</span>&nbsp;<span class="ident" id="6155448">orig</span><span class="op" id="6155452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155460">line</span><span class="op" id="6155464">,</span>&nbsp;<span class="ident" id="6155466">argstr</span>&nbsp;<span class="op" id="6155473">:=</span>&nbsp;<span class="ident" id="6155476">line</span><span class="op" id="6155480">[</span><span class="op" id="6155481">:</span><span class="ident" id="6155482">i</span><span class="op" id="6155483">]</span><span class="op" id="6155484">,</span>&nbsp;<span class="ident" id="6155486">line</span><span class="op" id="6155490">[</span><span class="ident" id="6155491">i</span><span class="op" id="6155492">+</span><span class="num" id="6155493">1</span><span class="op" id="6155494">:</span><span class="op" id="6155495">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6155500">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155530">f</span>&nbsp;<span class="op" id="6155532">:=</span>&nbsp;<span class="ident" id="6155535">strings</span><span class="op" id="6155542">.</span><span class="ident" id="6155543">Fields</span><span class="op" id="6155549">(</span><span class="ident" id="6155550">line</span><span class="op" id="6155554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155558">if</span>&nbsp;<span class="builtinfunc" id="6155561">len</span><span class="op" id="6155564">(</span><span class="ident" id="6155565">f</span><span class="op" id="6155566">)</span>&nbsp;<span class="op" id="6155568">&lt;</span>&nbsp;<span class="num" id="6155570">1</span>&nbsp;<span class="op" id="6155572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155577">return</span>&nbsp;<span class="ident" id="6155584">fmt</span><span class="op" id="6155587">.</span><span class="ident" id="6155588">Errorf</span><span class="op" id="6155594">(</span><span class="string" id="6155595">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6155622">,</span>&nbsp;<span class="ident" id="6155624">filename</span><span class="op" id="6155632">,</span>&nbsp;<span class="ident" id="6155634">orig</span><span class="op" id="6155638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155642">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155647">cond</span><span class="op" id="6155651">,</span>&nbsp;<span class="ident" id="6155653">verb</span>&nbsp;<span class="op" id="6155658">:=</span>&nbsp;<span class="ident" id="6155661">f</span><span class="op" id="6155662">[</span><span class="op" id="6155663">:</span><span class="builtinfunc" id="6155664">len</span><span class="op" id="6155667">(</span><span class="ident" id="6155668">f</span><span class="op" id="6155669">)</span><span class="op" id="6155670">-</span><span class="num" id="6155671">1</span><span class="op" id="6155672">]</span><span class="op" id="6155673">,</span>&nbsp;<span class="ident" id="6155675">f</span><span class="op" id="6155676">[</span><span class="builtinfunc" id="6155677">len</span><span class="op" id="6155680">(</span><span class="ident" id="6155681">f</span><span class="op" id="6155682">)</span><span class="op" id="6155683">-</span><span class="num" id="6155684">1</span><span class="op" id="6155685">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155689">if</span>&nbsp;<span class="builtinfunc" id="6155692">len</span><span class="op" id="6155695">(</span><span class="ident" id="6155696">cond</span><span class="op" id="6155700">)</span>&nbsp;<span class="op" id="6155702">&gt;</span>&nbsp;<span class="num" id="6155704">0</span>&nbsp;<span class="op" id="6155706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155711">ok</span>&nbsp;<span class="op" id="6155714">:=</span>&nbsp;<span class="builtintype" id="6155717">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155726">for</span>&nbsp;<span class="ident" id="6155730">_</span><span class="op" id="6155731">,</span>&nbsp;<span class="ident" id="6155733">c</span>&nbsp;<span class="op" id="6155735">:=</span>&nbsp;<span class="keyword" id="6155738">range</span>&nbsp;<span class="ident" id="6155744">cond</span>&nbsp;<span class="op" id="6155749">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155755">if</span>&nbsp;<span class="ident" id="6155758">ctxt</span><span class="op" id="6155762">.</span><span class="ident" id="6155763">match</span><span class="op" id="6155768">(</span><span class="ident" id="6155769">c</span><span class="op" id="6155770">,</span>&nbsp;<span class="ident" id="6155772">nil</span><span class="op" id="6155775">)</span>&nbsp;<span class="op" id="6155777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155784">ok</span>&nbsp;<span class="op" id="6155787">=</span>&nbsp;<span class="builtintype" id="6155789">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155799">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155814">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155819">if</span>&nbsp;<span class="op" id="6155822">!</span><span class="ident" id="6155823">ok</span>&nbsp;<span class="op" id="6155826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155832">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6155853">args</span><span class="op" id="6155857">,</span>&nbsp;<span class="ident" id="6155859">err</span>&nbsp;<span class="op" id="6155863">:=</span>&nbsp;<span class="ident" id="6155866">splitQuoted</span><span class="op" id="6155877">(</span><span class="ident" id="6155878">argstr</span><span class="op" id="6155884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155888">if</span>&nbsp;<span class="ident" id="6155891">err</span>&nbsp;<span class="op" id="6155895">!=</span>&nbsp;<span class="ident" id="6155898">nil</span>&nbsp;<span class="op" id="6155902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155907">return</span>&nbsp;<span class="ident" id="6155914">fmt</span><span class="op" id="6155917">.</span><span class="ident" id="6155918">Errorf</span><span class="op" id="6155924">(</span><span class="string" id="6155925">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6155952">,</span>&nbsp;<span class="ident" id="6155954">filename</span><span class="op" id="6155962">,</span>&nbsp;<span class="ident" id="6155964">orig</span><span class="op" id="6155968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6155972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6155976">for</span>&nbsp;<span class="ident" id="6155980">_</span><span class="op" id="6155981">,</span>&nbsp;<span class="ident" id="6155983">arg</span>&nbsp;<span class="op" id="6155987">:=</span>&nbsp;<span class="keyword" id="6155990">range</span>&nbsp;<span class="ident" id="6155996">args</span>&nbsp;<span class="op" id="6156001">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156006">if</span>&nbsp;<span class="op" id="6156009">!</span><span class="ident" id="6156010">safeCgoName</span><span class="op" id="6156021">(</span><span class="ident" id="6156022">arg</span><span class="op" id="6156025">)</span>&nbsp;<span class="op" id="6156027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156033">return</span>&nbsp;<span class="ident" id="6156040">fmt</span><span class="op" id="6156043">.</span><span class="ident" id="6156044">Errorf</span><span class="op" id="6156050">(</span><span class="string" id="6156051">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="6156084">,</span>&nbsp;<span class="ident" id="6156086">filename</span><span class="op" id="6156094">,</span>&nbsp;<span class="ident" id="6156096">arg</span><span class="op" id="6156099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6156104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6156108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156113">switch</span>&nbsp;<span class="ident" id="6156120">verb</span>&nbsp;<span class="op" id="6156125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156129">case</span>&nbsp;<span class="string" id="6156134">&#34;CFLAGS&#34;</span><span class="op" id="6156142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6156147">di</span><span class="op" id="6156149">.</span><span class="ident" id="6156150">CgoCFLAGS</span>&nbsp;<span class="op" id="6156160">=</span>&nbsp;<span class="builtinfunc" id="6156162">append</span><span class="op" id="6156168">(</span><span class="ident" id="6156169">di</span><span class="op" id="6156171">.</span><span class="ident" id="6156172">CgoCFLAGS</span><span class="op" id="6156181">,</span>&nbsp;<span class="ident" id="6156183">args</span><span class="op" id="6156187">...</span><span class="op" id="6156190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156194">case</span>&nbsp;<span class="string" id="6156199">&#34;CPPFLAGS&#34;</span><span class="op" id="6156209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6156214">di</span><span class="op" id="6156216">.</span><span class="ident" id="6156217">CgoCPPFLAGS</span>&nbsp;<span class="op" id="6156229">=</span>&nbsp;<span class="builtinfunc" id="6156231">append</span><span class="op" id="6156237">(</span><span class="ident" id="6156238">di</span><span class="op" id="6156240">.</span><span class="ident" id="6156241">CgoCPPFLAGS</span><span class="op" id="6156252">,</span>&nbsp;<span class="ident" id="6156254">args</span><span class="op" id="6156258">...</span><span class="op" id="6156261">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156265">case</span>&nbsp;<span class="string" id="6156270">&#34;CXXFLAGS&#34;</span><span class="op" id="6156280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6156285">di</span><span class="op" id="6156287">.</span><span class="ident" id="6156288">CgoCXXFLAGS</span>&nbsp;<span class="op" id="6156300">=</span>&nbsp;<span class="builtinfunc" id="6156302">append</span><span class="op" id="6156308">(</span><span class="ident" id="6156309">di</span><span class="op" id="6156311">.</span><span class="ident" id="6156312">CgoCXXFLAGS</span><span class="op" id="6156323">,</span>&nbsp;<span class="ident" id="6156325">args</span><span class="op" id="6156329">...</span><span class="op" id="6156332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156336">case</span>&nbsp;<span class="string" id="6156341">&#34;LDFLAGS&#34;</span><span class="op" id="6156350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6156355">di</span><span class="op" id="6156357">.</span><span class="ident" id="6156358">CgoLDFLAGS</span>&nbsp;<span class="op" id="6156369">=</span>&nbsp;<span class="builtinfunc" id="6156371">append</span><span class="op" id="6156377">(</span><span class="ident" id="6156378">di</span><span class="op" id="6156380">.</span><span class="ident" id="6156381">CgoLDFLAGS</span><span class="op" id="6156391">,</span>&nbsp;<span class="ident" id="6156393">args</span><span class="op" id="6156397">...</span><span class="op" id="6156400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156404">case</span>&nbsp;<span class="string" id="6156409">&#34;pkg-config&#34;</span><span class="op" id="6156421">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6156426">di</span><span class="op" id="6156428">.</span><span class="ident" id="6156429">CgoPkgConfig</span>&nbsp;<span class="op" id="6156442">=</span>&nbsp;<span class="builtinfunc" id="6156444">append</span><span class="op" id="6156450">(</span><span class="ident" id="6156451">di</span><span class="op" id="6156453">.</span><span class="ident" id="6156454">CgoPkgConfig</span><span class="op" id="6156466">,</span>&nbsp;<span class="ident" id="6156468">args</span><span class="op" id="6156472">...</span><span class="op" id="6156475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156479">default</span><span class="op" id="6156486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156491">return</span>&nbsp;<span class="ident" id="6156498">fmt</span><span class="op" id="6156501">.</span><span class="ident" id="6156502">Errorf</span><span class="op" id="6156508">(</span><span class="string" id="6156509">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="6156536">,</span>&nbsp;<span class="ident" id="6156538">filename</span><span class="op" id="6156546">,</span>&nbsp;<span class="ident" id="6156548">orig</span><span class="op" id="6156552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6156556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6156559">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156562">return</span>&nbsp;<span class="ident" id="6156569">nil</span><br>
<span class="lineno"></span><span class="op" id="6156573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6156576">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="6156681">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="6156791">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="6156821">var</span>&nbsp;<span class="ident" id="6156825">safeBytes</span>&nbsp;<span class="op" id="6156835">=</span>&nbsp;<span class="op" id="6156837">[</span><span class="op" id="6156838">]</span><span class="builtintype" id="6156839">byte</span><span class="op" id="6156843">(</span><span class="string" id="6156844">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="6156917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6156920">func</span>&nbsp;<span class="ident" id="6156925">safeCgoName</span><span class="op" id="6156936">(</span><span class="ident" id="6156937">s</span>&nbsp;<span class="builtintype" id="6156939">string</span><span class="op" id="6156945">)</span>&nbsp;<span class="builtintype" id="6156947">bool</span>&nbsp;<span class="op" id="6156952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156955">if</span>&nbsp;<span class="ident" id="6156958">s</span>&nbsp;<span class="op" id="6156960">==</span>&nbsp;<span class="string" id="6156963">&#34;&#34;</span>&nbsp;<span class="op" id="6156966">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156970">return</span>&nbsp;<span class="builtintype" id="6156977">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6156984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6156987">for</span>&nbsp;<span class="ident" id="6156991">i</span>&nbsp;<span class="op" id="6156993">:=</span>&nbsp;<span class="num" id="6156996">0</span><span class="op" id="6156997">;</span>&nbsp;<span class="ident" id="6156999">i</span>&nbsp;<span class="op" id="6157001">&lt;</span>&nbsp;<span class="builtinfunc" id="6157003">len</span><span class="op" id="6157006">(</span><span class="ident" id="6157007">s</span><span class="op" id="6157008">)</span><span class="op" id="6157009">;</span>&nbsp;<span class="ident" id="6157011">i</span><span class="op" id="6157012">++</span>&nbsp;<span class="op" id="6157015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6157019">if</span>&nbsp;<span class="ident" id="6157022">c</span>&nbsp;<span class="op" id="6157024">:=</span>&nbsp;<span class="ident" id="6157027">s</span><span class="op" id="6157028">[</span><span class="ident" id="6157029">i</span><span class="op" id="6157030">]</span><span class="op" id="6157031">;</span>&nbsp;<span class="ident" id="6157033">c</span>&nbsp;<span class="op" id="6157035">&lt;</span>&nbsp;<span class="num" id="6157037">0x80</span>&nbsp;<span class="op" id="6157042">&amp;&amp;</span>&nbsp;<span class="ident" id="6157045">bytes</span><span class="op" id="6157050">.</span><span class="ident" id="6157051">IndexByte</span><span class="op" id="6157060">(</span><span class="ident" id="6157061">safeBytes</span><span class="op" id="6157070">,</span>&nbsp;<span class="ident" id="6157072">c</span><span class="op" id="6157073">)</span>&nbsp;<span class="op" id="6157075">&lt;</span>&nbsp;<span class="num" id="6157077">0</span>&nbsp;<span class="op" id="6157079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6157084">return</span>&nbsp;<span class="builtintype" id="6157091">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6157099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6157102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6157105">return</span>&nbsp;<span class="builtintype" id="6157112">true</span><br>
<span class="lineno"></span><span class="op" id="6157117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="6157120">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="6157203">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6157280">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="6157368">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6157450">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="6157531">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6157608">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="6157662">//</span><br>
<span class="lineno"></span><span class="comment" id="6157665">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="6157703">//</span><br>
<span class="lineno">1170</span><span class="comment" id="6157706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6157737">//</span><br>
<span class="lineno"></span><span class="comment" id="6157740">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="6157763">//</span><br>
<span class="lineno"></span><span class="comment" id="6157766">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="6157808">//</span><br>
<span class="lineno"></span><span class="keyword" id="6157811">func</span>&nbsp;<span class="ident" id="6157816">splitQuoted</span><span class="op" id="6157827">(</span><span class="ident" id="6157828">s</span>&nbsp;<span class="builtintype" id="6157830">string</span><span class="op" id="6157836">)</span>&nbsp;<span class="op" id="6157838">(</span><span class="ident" id="6157839">r</span>&nbsp;<span class="op" id="6157841">[</span><span class="op" id="6157842">]</span><span class="builtintype" id="6157843">string</span><span class="op" id="6157849">,</span>&nbsp;<span class="ident" id="6157851">err</span>&nbsp;<span class="builtintype" id="6157855">error</span><span class="op" id="6157860">)</span>&nbsp;<span class="op" id="6157862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6157865">var</span>&nbsp;<span class="ident" id="6157869">args</span>&nbsp;<span class="op" id="6157874">[</span><span class="op" id="6157875">]</span><span class="builtintype" id="6157876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157884">arg</span>&nbsp;<span class="op" id="6157888">:=</span>&nbsp;<span class="builtinfunc" id="6157891">make</span><span class="op" id="6157895">(</span><span class="op" id="6157896">[</span><span class="op" id="6157897">]</span><span class="builtintype" id="6157898">rune</span><span class="op" id="6157902">,</span>&nbsp;<span class="builtinfunc" id="6157904">len</span><span class="op" id="6157907">(</span><span class="ident" id="6157908">s</span><span class="op" id="6157909">)</span><span class="op" id="6157910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157913">escaped</span>&nbsp;<span class="op" id="6157921">:=</span>&nbsp;<span class="builtintype" id="6157924">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157931">quoted</span>&nbsp;<span class="op" id="6157938">:=</span>&nbsp;<span class="builtintype" id="6157941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157948">quote</span>&nbsp;<span class="op" id="6157954">:=</span>&nbsp;<span class="string" id="6157957">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157965">i</span>&nbsp;<span class="op" id="6157967">:=</span>&nbsp;<span class="num" id="6157970">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6157973">for</span>&nbsp;<span class="ident" id="6157977">_</span><span class="op" id="6157978">,</span>&nbsp;<span class="builtintype" id="6157980">rune</span>&nbsp;<span class="op" id="6157985">:=</span>&nbsp;<span class="keyword" id="6157988">range</span>&nbsp;<span class="ident" id="6157994">s</span>&nbsp;<span class="op" id="6157996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158000">switch</span>&nbsp;<span class="op" id="6158007">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158011">case</span>&nbsp;<span class="ident" id="6158016">escaped</span><span class="op" id="6158023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158028">escaped</span>&nbsp;<span class="op" id="6158036">=</span>&nbsp;<span class="builtintype" id="6158038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158046">case</span>&nbsp;<span class="builtintype" id="6158051">rune</span>&nbsp;<span class="op" id="6158056">==</span>&nbsp;<span class="string" id="6158059">&#39;\\&#39;</span><span class="op" id="6158063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158068">escaped</span>&nbsp;<span class="op" id="6158076">=</span>&nbsp;<span class="builtintype" id="6158078">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158086">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158097">case</span>&nbsp;<span class="ident" id="6158102">quote</span>&nbsp;<span class="op" id="6158108">!=</span>&nbsp;<span class="string" id="6158111">&#39;\x00&#39;</span><span class="op" id="6158117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158122">if</span>&nbsp;<span class="builtintype" id="6158125">rune</span>&nbsp;<span class="op" id="6158130">==</span>&nbsp;<span class="ident" id="6158133">quote</span>&nbsp;<span class="op" id="6158139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158145">quote</span>&nbsp;<span class="op" id="6158151">=</span>&nbsp;<span class="string" id="6158153">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158164">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158176">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158180">case</span>&nbsp;<span class="builtintype" id="6158185">rune</span>&nbsp;<span class="op" id="6158190">==</span>&nbsp;<span class="string" id="6158193">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6158197">||</span>&nbsp;<span class="builtintype" id="6158200">rune</span>&nbsp;<span class="op" id="6158205">==</span>&nbsp;<span class="string" id="6158208">&#39;\&#39;&#39;</span><span class="op" id="6158212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158217">quoted</span>&nbsp;<span class="op" id="6158224">=</span>&nbsp;<span class="builtintype" id="6158226">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158234">quote</span>&nbsp;<span class="op" id="6158240">=</span>&nbsp;<span class="builtintype" id="6158242">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158250">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158261">case</span>&nbsp;<span class="ident" id="6158266">unicode</span><span class="op" id="6158273">.</span><span class="ident" id="6158274">IsSpace</span><span class="op" id="6158281">(</span><span class="builtintype" id="6158282">rune</span><span class="op" id="6158286">)</span><span class="op" id="6158287">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158292">if</span>&nbsp;<span class="ident" id="6158295">quoted</span>&nbsp;<span class="op" id="6158302">||</span>&nbsp;<span class="ident" id="6158305">i</span>&nbsp;<span class="op" id="6158307">&gt;</span>&nbsp;<span class="num" id="6158309">0</span>&nbsp;<span class="op" id="6158311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158317">quoted</span>&nbsp;<span class="op" id="6158324">=</span>&nbsp;<span class="builtintype" id="6158326">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158336">args</span>&nbsp;<span class="op" id="6158341">=</span>&nbsp;<span class="builtinfunc" id="6158343">append</span><span class="op" id="6158349">(</span><span class="ident" id="6158350">args</span><span class="op" id="6158354">,</span>&nbsp;<span class="builtintype" id="6158356">string</span><span class="op" id="6158362">(</span><span class="ident" id="6158363">arg</span><span class="op" id="6158366">[</span><span class="op" id="6158367">:</span><span class="ident" id="6158368">i</span><span class="op" id="6158369">]</span><span class="op" id="6158370">)</span><span class="op" id="6158371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158377">i</span>&nbsp;<span class="op" id="6158379">=</span>&nbsp;<span class="num" id="6158381">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158386">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158391">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158406">arg</span><span class="op" id="6158409">[</span><span class="ident" id="6158410">i</span><span class="op" id="6158411">]</span>&nbsp;<span class="op" id="6158413">=</span>&nbsp;<span class="builtintype" id="6158415">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158422">i</span><span class="op" id="6158423">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158427">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158430">if</span>&nbsp;<span class="ident" id="6158433">quoted</span>&nbsp;<span class="op" id="6158440">||</span>&nbsp;<span class="ident" id="6158443">i</span>&nbsp;<span class="op" id="6158445">&gt;</span>&nbsp;<span class="num" id="6158447">0</span>&nbsp;<span class="op" id="6158449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158453">args</span>&nbsp;<span class="op" id="6158458">=</span>&nbsp;<span class="builtinfunc" id="6158460">append</span><span class="op" id="6158466">(</span><span class="ident" id="6158467">args</span><span class="op" id="6158471">,</span>&nbsp;<span class="builtintype" id="6158473">string</span><span class="op" id="6158479">(</span><span class="ident" id="6158480">arg</span><span class="op" id="6158483">[</span><span class="op" id="6158484">:</span><span class="ident" id="6158485">i</span><span class="op" id="6158486">]</span><span class="op" id="6158487">)</span><span class="op" id="6158488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158494">if</span>&nbsp;<span class="ident" id="6158497">quote</span>&nbsp;<span class="op" id="6158503">!=</span>&nbsp;<span class="num" id="6158506">0</span>&nbsp;<span class="op" id="6158508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158512">err</span>&nbsp;<span class="op" id="6158516">=</span>&nbsp;<span class="ident" id="6158518">errors</span><span class="op" id="6158524">.</span><span class="ident" id="6158525">New</span><span class="op" id="6158528">(</span><span class="string" id="6158529">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="6158545">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158548">}</span>&nbsp;<span class="keyword" id="6158550">else</span>&nbsp;<span class="keyword" id="6158555">if</span>&nbsp;<span class="ident" id="6158558">escaped</span>&nbsp;<span class="op" id="6158566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158570">err</span>&nbsp;<span class="op" id="6158574">=</span>&nbsp;<span class="ident" id="6158576">errors</span><span class="op" id="6158582">.</span><span class="ident" id="6158583">New</span><span class="op" id="6158586">(</span><span class="string" id="6158587">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="6158608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158614">return</span>&nbsp;<span class="ident" id="6158621">args</span><span class="op" id="6158625">,</span>&nbsp;<span class="ident" id="6158627">err</span><br>
<span class="lineno"></span><span class="op" id="6158631">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="6158634">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="6158679">//</span><br>
<span class="lineno"></span><span class="comment" id="6158682">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="6158691">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="6158702">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="6158729">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="6158758">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6158775">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6158793">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="6158857">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="6158926">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="6158968">//</span><br>
<span class="lineno"></span><span class="keyword" id="6158971">func</span>&nbsp;<span class="op" id="6158976">(</span><span class="ident" id="6158977">ctxt</span>&nbsp;<span class="op" id="6158982">*</span><span class="ident" id="6158983">Context</span><span class="op" id="6158990">)</span>&nbsp;<span class="ident" id="6158992">match</span><span class="op" id="6158997">(</span><span class="ident" id="6158998">name</span>&nbsp;<span class="builtintype" id="6159003">string</span><span class="op" id="6159009">,</span>&nbsp;<span class="ident" id="6159011">allTags</span>&nbsp;<span class="keyword" id="6159019">map</span><span class="op" id="6159022">[</span><span class="builtintype" id="6159023">string</span><span class="op" id="6159029">]</span><span class="builtintype" id="6159030">bool</span><span class="op" id="6159034">)</span>&nbsp;<span class="builtintype" id="6159036">bool</span>&nbsp;<span class="op" id="6159041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159044">if</span>&nbsp;<span class="ident" id="6159047">name</span>&nbsp;<span class="op" id="6159052">==</span>&nbsp;<span class="string" id="6159055">&#34;&#34;</span>&nbsp;<span class="op" id="6159058">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159062">if</span>&nbsp;<span class="ident" id="6159065">allTags</span>&nbsp;<span class="op" id="6159073">!=</span>&nbsp;<span class="ident" id="6159076">nil</span>&nbsp;<span class="op" id="6159080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159085">allTags</span><span class="op" id="6159092">[</span><span class="ident" id="6159093">name</span><span class="op" id="6159097">]</span>&nbsp;<span class="op" id="6159099">=</span>&nbsp;<span class="builtintype" id="6159101">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159112">return</span>&nbsp;<span class="builtintype" id="6159119">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159126">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159129">if</span>&nbsp;<span class="ident" id="6159132">i</span>&nbsp;<span class="op" id="6159134">:=</span>&nbsp;<span class="ident" id="6159137">strings</span><span class="op" id="6159144">.</span><span class="ident" id="6159145">Index</span><span class="op" id="6159150">(</span><span class="ident" id="6159151">name</span><span class="op" id="6159155">,</span>&nbsp;<span class="string" id="6159157">&#34;,&#34;</span><span class="op" id="6159160">)</span><span class="op" id="6159161">;</span>&nbsp;<span class="ident" id="6159163">i</span>&nbsp;<span class="op" id="6159165">&gt;=</span>&nbsp;<span class="num" id="6159168">0</span>&nbsp;<span class="op" id="6159170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159174">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159200">ok1</span>&nbsp;<span class="op" id="6159204">:=</span>&nbsp;<span class="ident" id="6159207">ctxt</span><span class="op" id="6159211">.</span><span class="ident" id="6159212">match</span><span class="op" id="6159217">(</span><span class="ident" id="6159218">name</span><span class="op" id="6159222">[</span><span class="op" id="6159223">:</span><span class="ident" id="6159224">i</span><span class="op" id="6159225">]</span><span class="op" id="6159226">,</span>&nbsp;<span class="ident" id="6159228">allTags</span><span class="op" id="6159235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159239">ok2</span>&nbsp;<span class="op" id="6159243">:=</span>&nbsp;<span class="ident" id="6159246">ctxt</span><span class="op" id="6159250">.</span><span class="ident" id="6159251">match</span><span class="op" id="6159256">(</span><span class="ident" id="6159257">name</span><span class="op" id="6159261">[</span><span class="ident" id="6159262">i</span><span class="op" id="6159263">+</span><span class="num" id="6159264">1</span><span class="op" id="6159265">:</span><span class="op" id="6159266">]</span><span class="op" id="6159267">,</span>&nbsp;<span class="ident" id="6159269">allTags</span><span class="op" id="6159276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159280">return</span>&nbsp;<span class="ident" id="6159287">ok1</span>&nbsp;<span class="op" id="6159291">&amp;&amp;</span>&nbsp;<span class="ident" id="6159294">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159302">if</span>&nbsp;<span class="ident" id="6159305">strings</span><span class="op" id="6159312">.</span><span class="ident" id="6159313">HasPrefix</span><span class="op" id="6159322">(</span><span class="ident" id="6159323">name</span><span class="op" id="6159327">,</span>&nbsp;<span class="string" id="6159329">&#34;!!&#34;</span><span class="op" id="6159333">)</span>&nbsp;<span class="op" id="6159335">{</span>&nbsp;<span class="comment" id="6159337">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159368">return</span>&nbsp;<span class="builtintype" id="6159375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159385">if</span>&nbsp;<span class="ident" id="6159388">strings</span><span class="op" id="6159395">.</span><span class="ident" id="6159396">HasPrefix</span><span class="op" id="6159405">(</span><span class="ident" id="6159406">name</span><span class="op" id="6159410">,</span>&nbsp;<span class="string" id="6159412">&#34;!&#34;</span><span class="op" id="6159415">)</span>&nbsp;<span class="op" id="6159417">{</span>&nbsp;<span class="comment" id="6159419">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159433">return</span>&nbsp;<span class="builtinfunc" id="6159440">len</span><span class="op" id="6159443">(</span><span class="ident" id="6159444">name</span><span class="op" id="6159448">)</span>&nbsp;<span class="op" id="6159450">&gt;</span>&nbsp;<span class="num" id="6159452">1</span>&nbsp;<span class="op" id="6159454">&amp;&amp;</span>&nbsp;<span class="op" id="6159457">!</span><span class="ident" id="6159458">ctxt</span><span class="op" id="6159462">.</span><span class="ident" id="6159463">match</span><span class="op" id="6159468">(</span><span class="ident" id="6159469">name</span><span class="op" id="6159473">[</span><span class="num" id="6159474">1</span><span class="op" id="6159475">:</span><span class="op" id="6159476">]</span><span class="op" id="6159477">,</span>&nbsp;<span class="ident" id="6159479">allTags</span><span class="op" id="6159486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159493">if</span>&nbsp;<span class="ident" id="6159496">allTags</span>&nbsp;<span class="op" id="6159504">!=</span>&nbsp;<span class="ident" id="6159507">nil</span>&nbsp;<span class="op" id="6159511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159515">allTags</span><span class="op" id="6159522">[</span><span class="ident" id="6159523">name</span><span class="op" id="6159527">]</span>&nbsp;<span class="op" id="6159529">=</span>&nbsp;<span class="builtintype" id="6159531">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159541">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159596">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159661">for</span>&nbsp;<span class="ident" id="6159665">_</span><span class="op" id="6159666">,</span>&nbsp;<span class="ident" id="6159668">c</span>&nbsp;<span class="op" id="6159670">:=</span>&nbsp;<span class="keyword" id="6159673">range</span>&nbsp;<span class="ident" id="6159679">name</span>&nbsp;<span class="op" id="6159684">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159688">if</span>&nbsp;<span class="op" id="6159691">!</span><span class="ident" id="6159692">unicode</span><span class="op" id="6159699">.</span><span class="ident" id="6159700">IsLetter</span><span class="op" id="6159708">(</span><span class="ident" id="6159709">c</span><span class="op" id="6159710">)</span>&nbsp;<span class="op" id="6159712">&amp;&amp;</span>&nbsp;<span class="op" id="6159715">!</span><span class="ident" id="6159716">unicode</span><span class="op" id="6159723">.</span><span class="ident" id="6159724">IsDigit</span><span class="op" id="6159731">(</span><span class="ident" id="6159732">c</span><span class="op" id="6159733">)</span>&nbsp;<span class="op" id="6159735">&amp;&amp;</span>&nbsp;<span class="ident" id="6159738">c</span>&nbsp;<span class="op" id="6159740">!=</span>&nbsp;<span class="string" id="6159743">&#39;_&#39;</span>&nbsp;<span class="op" id="6159747">&amp;&amp;</span>&nbsp;<span class="ident" id="6159750">c</span>&nbsp;<span class="op" id="6159752">!=</span>&nbsp;<span class="string" id="6159755">&#39;.&#39;</span>&nbsp;<span class="op" id="6159759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159764">return</span>&nbsp;<span class="builtintype" id="6159771">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159786">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159803">if</span>&nbsp;<span class="ident" id="6159806">ctxt</span><span class="op" id="6159810">.</span><span class="ident" id="6159811">CgoEnabled</span>&nbsp;<span class="op" id="6159822">&amp;&amp;</span>&nbsp;<span class="ident" id="6159825">name</span>&nbsp;<span class="op" id="6159830">==</span>&nbsp;<span class="string" id="6159833">&#34;cgo&#34;</span>&nbsp;<span class="op" id="6159839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159843">return</span>&nbsp;<span class="builtintype" id="6159850">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159859">if</span>&nbsp;<span class="ident" id="6159862">name</span>&nbsp;<span class="op" id="6159867">==</span>&nbsp;<span class="ident" id="6159870">ctxt</span><span class="op" id="6159874">.</span><span class="ident" id="6159875">GOOS</span>&nbsp;<span class="op" id="6159880">||</span>&nbsp;<span class="ident" id="6159883">name</span>&nbsp;<span class="op" id="6159888">==</span>&nbsp;<span class="ident" id="6159891">ctxt</span><span class="op" id="6159895">.</span><span class="ident" id="6159896">GOARCH</span>&nbsp;<span class="op" id="6159903">||</span>&nbsp;<span class="ident" id="6159906">name</span>&nbsp;<span class="op" id="6159911">==</span>&nbsp;<span class="ident" id="6159914">ctxt</span><span class="op" id="6159918">.</span><span class="ident" id="6159919">Compiler</span>&nbsp;<span class="op" id="6159928">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159932">return</span>&nbsp;<span class="builtintype" id="6159939">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159948">if</span>&nbsp;<span class="ident" id="6159951">ctxt</span><span class="op" id="6159955">.</span><span class="ident" id="6159956">GOOS</span>&nbsp;<span class="op" id="6159961">==</span>&nbsp;<span class="string" id="6159964">&#34;android&#34;</span>&nbsp;<span class="op" id="6159974">&amp;&amp;</span>&nbsp;<span class="ident" id="6159977">name</span>&nbsp;<span class="op" id="6159982">==</span>&nbsp;<span class="string" id="6159985">&#34;linux&#34;</span>&nbsp;<span class="op" id="6159993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159997">return</span>&nbsp;<span class="builtintype" id="6160004">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160010">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160014">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160029">for</span>&nbsp;<span class="ident" id="6160033">_</span><span class="op" id="6160034">,</span>&nbsp;<span class="ident" id="6160036">tag</span>&nbsp;<span class="op" id="6160040">:=</span>&nbsp;<span class="keyword" id="6160043">range</span>&nbsp;<span class="ident" id="6160049">ctxt</span><span class="op" id="6160053">.</span><span class="ident" id="6160054">BuildTags</span>&nbsp;<span class="op" id="6160064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160068">if</span>&nbsp;<span class="ident" id="6160071">tag</span>&nbsp;<span class="op" id="6160075">==</span>&nbsp;<span class="ident" id="6160078">name</span>&nbsp;<span class="op" id="6160083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160088">return</span>&nbsp;<span class="builtintype" id="6160095">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160108">for</span>&nbsp;<span class="ident" id="6160112">_</span><span class="op" id="6160113">,</span>&nbsp;<span class="ident" id="6160115">tag</span>&nbsp;<span class="op" id="6160119">:=</span>&nbsp;<span class="keyword" id="6160122">range</span>&nbsp;<span class="ident" id="6160128">ctxt</span><span class="op" id="6160132">.</span><span class="ident" id="6160133">ReleaseTags</span>&nbsp;<span class="op" id="6160145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160149">if</span>&nbsp;<span class="ident" id="6160152">tag</span>&nbsp;<span class="op" id="6160156">==</span>&nbsp;<span class="ident" id="6160159">name</span>&nbsp;<span class="op" id="6160164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160169">return</span>&nbsp;<span class="builtintype" id="6160176">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160190">return</span>&nbsp;<span class="builtintype" id="6160197">false</span><br>
<span class="lineno"></span><span class="op" id="6160203">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="6160206">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="6160278">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="6160329">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6160365">//</span><br>
<span class="lineno">1295</span><span class="comment" id="6160368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="6160390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6160414">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6160446">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6160473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="6160502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6160539">//</span><br>
<span class="lineno"></span><span class="comment" id="6160542">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="6160621">func</span>&nbsp;<span class="op" id="6160626">(</span><span class="ident" id="6160627">ctxt</span>&nbsp;<span class="op" id="6160632">*</span><span class="ident" id="6160633">Context</span><span class="op" id="6160640">)</span>&nbsp;<span class="ident" id="6160642">goodOSArchFile</span><span class="op" id="6160656">(</span><span class="ident" id="6160657">name</span>&nbsp;<span class="builtintype" id="6160662">string</span><span class="op" id="6160668">,</span>&nbsp;<span class="ident" id="6160670">allTags</span>&nbsp;<span class="keyword" id="6160678">map</span><span class="op" id="6160681">[</span><span class="builtintype" id="6160682">string</span><span class="op" id="6160688">]</span><span class="builtintype" id="6160689">bool</span><span class="op" id="6160693">)</span>&nbsp;<span class="builtintype" id="6160695">bool</span>&nbsp;<span class="op" id="6160700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160703">if</span>&nbsp;<span class="ident" id="6160706">dot</span>&nbsp;<span class="op" id="6160710">:=</span>&nbsp;<span class="ident" id="6160713">strings</span><span class="op" id="6160720">.</span><span class="ident" id="6160721">Index</span><span class="op" id="6160726">(</span><span class="ident" id="6160727">name</span><span class="op" id="6160731">,</span>&nbsp;<span class="string" id="6160733">&#34;.&#34;</span><span class="op" id="6160736">)</span><span class="op" id="6160737">;</span>&nbsp;<span class="ident" id="6160739">dot</span>&nbsp;<span class="op" id="6160743">!=</span>&nbsp;<span class="op" id="6160746">-</span><span class="num" id="6160747">1</span>&nbsp;<span class="op" id="6160749">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160753">name</span>&nbsp;<span class="op" id="6160758">=</span>&nbsp;<span class="ident" id="6160760">name</span><span class="op" id="6160764">[</span><span class="op" id="6160765">:</span><span class="ident" id="6160766">dot</span><span class="op" id="6160769">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160776">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160852">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160927">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160995">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161073">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161148">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161223">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161261">i</span>&nbsp;<span class="op" id="6161263">:=</span>&nbsp;<span class="ident" id="6161266">strings</span><span class="op" id="6161273">.</span><span class="ident" id="6161274">Index</span><span class="op" id="6161279">(</span><span class="ident" id="6161280">name</span><span class="op" id="6161284">,</span>&nbsp;<span class="string" id="6161286">&#34;_&#34;</span><span class="op" id="6161289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161292">if</span>&nbsp;<span class="ident" id="6161295">i</span>&nbsp;<span class="op" id="6161297">&lt;</span>&nbsp;<span class="num" id="6161299">0</span>&nbsp;<span class="op" id="6161301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161305">return</span>&nbsp;<span class="builtintype" id="6161312">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161321">name</span>&nbsp;<span class="op" id="6161326">=</span>&nbsp;<span class="ident" id="6161328">name</span><span class="op" id="6161332">[</span><span class="ident" id="6161333">i</span><span class="op" id="6161334">:</span><span class="op" id="6161335">]</span>&nbsp;<span class="comment" id="6161337">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161375">l</span>&nbsp;<span class="op" id="6161377">:=</span>&nbsp;<span class="ident" id="6161380">strings</span><span class="op" id="6161387">.</span><span class="ident" id="6161388">Split</span><span class="op" id="6161393">(</span><span class="ident" id="6161394">name</span><span class="op" id="6161398">,</span>&nbsp;<span class="string" id="6161400">&#34;_&#34;</span><span class="op" id="6161403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161406">if</span>&nbsp;<span class="ident" id="6161409">n</span>&nbsp;<span class="op" id="6161411">:=</span>&nbsp;<span class="builtinfunc" id="6161414">len</span><span class="op" id="6161417">(</span><span class="ident" id="6161418">l</span><span class="op" id="6161419">)</span><span class="op" id="6161420">;</span>&nbsp;<span class="ident" id="6161422">n</span>&nbsp;<span class="op" id="6161424">&gt;</span>&nbsp;<span class="num" id="6161426">0</span>&nbsp;<span class="op" id="6161428">&amp;&amp;</span>&nbsp;<span class="ident" id="6161431">l</span><span class="op" id="6161432">[</span><span class="ident" id="6161433">n</span><span class="op" id="6161434">-</span><span class="num" id="6161435">1</span><span class="op" id="6161436">]</span>&nbsp;<span class="op" id="6161438">==</span>&nbsp;<span class="string" id="6161441">&#34;test&#34;</span>&nbsp;<span class="op" id="6161448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161452">l</span>&nbsp;<span class="op" id="6161454">=</span>&nbsp;<span class="ident" id="6161456">l</span><span class="op" id="6161457">[</span><span class="op" id="6161458">:</span><span class="ident" id="6161459">n</span><span class="op" id="6161460">-</span><span class="num" id="6161461">1</span><span class="op" id="6161462">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161465">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161468">n</span>&nbsp;<span class="op" id="6161470">:=</span>&nbsp;<span class="builtinfunc" id="6161473">len</span><span class="op" id="6161476">(</span><span class="ident" id="6161477">l</span><span class="op" id="6161478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161481">if</span>&nbsp;<span class="ident" id="6161484">n</span>&nbsp;<span class="op" id="6161486">&gt;=</span>&nbsp;<span class="num" id="6161489">2</span>&nbsp;<span class="op" id="6161491">&amp;&amp;</span>&nbsp;<span class="ident" id="6161494">knownOS</span><span class="op" id="6161501">[</span><span class="ident" id="6161502">l</span><span class="op" id="6161503">[</span><span class="ident" id="6161504">n</span><span class="op" id="6161505">-</span><span class="num" id="6161506">2</span><span class="op" id="6161507">]</span><span class="op" id="6161508">]</span>&nbsp;<span class="op" id="6161510">&amp;&amp;</span>&nbsp;<span class="ident" id="6161513">knownArch</span><span class="op" id="6161522">[</span><span class="ident" id="6161523">l</span><span class="op" id="6161524">[</span><span class="ident" id="6161525">n</span><span class="op" id="6161526">-</span><span class="num" id="6161527">1</span><span class="op" id="6161528">]</span><span class="op" id="6161529">]</span>&nbsp;<span class="op" id="6161531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161535">if</span>&nbsp;<span class="ident" id="6161538">allTags</span>&nbsp;<span class="op" id="6161546">!=</span>&nbsp;<span class="ident" id="6161549">nil</span>&nbsp;<span class="op" id="6161553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161558">allTags</span><span class="op" id="6161565">[</span><span class="ident" id="6161566">l</span><span class="op" id="6161567">[</span><span class="ident" id="6161568">n</span><span class="op" id="6161569">-</span><span class="num" id="6161570">2</span><span class="op" id="6161571">]</span><span class="op" id="6161572">]</span>&nbsp;<span class="op" id="6161574">=</span>&nbsp;<span class="builtintype" id="6161576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161584">allTags</span><span class="op" id="6161591">[</span><span class="ident" id="6161592">l</span><span class="op" id="6161593">[</span><span class="ident" id="6161594">n</span><span class="op" id="6161595">-</span><span class="num" id="6161596">1</span><span class="op" id="6161597">]</span><span class="op" id="6161598">]</span>&nbsp;<span class="op" id="6161600">=</span>&nbsp;<span class="builtintype" id="6161602">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161613">if</span>&nbsp;<span class="ident" id="6161616">l</span><span class="op" id="6161617">[</span><span class="ident" id="6161618">n</span><span class="op" id="6161619">-</span><span class="num" id="6161620">1</span><span class="op" id="6161621">]</span>&nbsp;<span class="op" id="6161623">!=</span>&nbsp;<span class="ident" id="6161626">ctxt</span><span class="op" id="6161630">.</span><span class="ident" id="6161631">GOARCH</span>&nbsp;<span class="op" id="6161638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161643">return</span>&nbsp;<span class="builtintype" id="6161650">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161662">if</span>&nbsp;<span class="ident" id="6161665">ctxt</span><span class="op" id="6161669">.</span><span class="ident" id="6161670">GOOS</span>&nbsp;<span class="op" id="6161675">==</span>&nbsp;<span class="string" id="6161678">&#34;android&#34;</span>&nbsp;<span class="op" id="6161688">&amp;&amp;</span>&nbsp;<span class="ident" id="6161691">l</span><span class="op" id="6161692">[</span><span class="ident" id="6161693">n</span><span class="op" id="6161694">-</span><span class="num" id="6161695">2</span><span class="op" id="6161696">]</span>&nbsp;<span class="op" id="6161698">==</span>&nbsp;<span class="string" id="6161701">&#34;linux&#34;</span>&nbsp;<span class="op" id="6161709">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161714">return</span>&nbsp;<span class="builtintype" id="6161721">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161732">return</span>&nbsp;<span class="ident" id="6161739">l</span><span class="op" id="6161740">[</span><span class="ident" id="6161741">n</span><span class="op" id="6161742">-</span><span class="num" id="6161743">2</span><span class="op" id="6161744">]</span>&nbsp;<span class="op" id="6161746">==</span>&nbsp;<span class="ident" id="6161749">ctxt</span><span class="op" id="6161753">.</span><span class="ident" id="6161754">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161763">if</span>&nbsp;<span class="ident" id="6161766">n</span>&nbsp;<span class="op" id="6161768">&gt;=</span>&nbsp;<span class="num" id="6161771">1</span>&nbsp;<span class="op" id="6161773">&amp;&amp;</span>&nbsp;<span class="ident" id="6161776">knownOS</span><span class="op" id="6161783">[</span><span class="ident" id="6161784">l</span><span class="op" id="6161785">[</span><span class="ident" id="6161786">n</span><span class="op" id="6161787">-</span><span class="num" id="6161788">1</span><span class="op" id="6161789">]</span><span class="op" id="6161790">]</span>&nbsp;<span class="op" id="6161792">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161796">if</span>&nbsp;<span class="ident" id="6161799">allTags</span>&nbsp;<span class="op" id="6161807">!=</span>&nbsp;<span class="ident" id="6161810">nil</span>&nbsp;<span class="op" id="6161814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161819">allTags</span><span class="op" id="6161826">[</span><span class="ident" id="6161827">l</span><span class="op" id="6161828">[</span><span class="ident" id="6161829">n</span><span class="op" id="6161830">-</span><span class="num" id="6161831">1</span><span class="op" id="6161832">]</span><span class="op" id="6161833">]</span>&nbsp;<span class="op" id="6161835">=</span>&nbsp;<span class="builtintype" id="6161837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161848">if</span>&nbsp;<span class="ident" id="6161851">ctxt</span><span class="op" id="6161855">.</span><span class="ident" id="6161856">GOOS</span>&nbsp;<span class="op" id="6161861">==</span>&nbsp;<span class="string" id="6161864">&#34;android&#34;</span>&nbsp;<span class="op" id="6161874">&amp;&amp;</span>&nbsp;<span class="ident" id="6161877">l</span><span class="op" id="6161878">[</span><span class="ident" id="6161879">n</span><span class="op" id="6161880">-</span><span class="num" id="6161881">1</span><span class="op" id="6161882">]</span>&nbsp;<span class="op" id="6161884">==</span>&nbsp;<span class="string" id="6161887">&#34;linux&#34;</span>&nbsp;<span class="op" id="6161895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161900">return</span>&nbsp;<span class="builtintype" id="6161907">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161918">return</span>&nbsp;<span class="ident" id="6161925">l</span><span class="op" id="6161926">[</span><span class="ident" id="6161927">n</span><span class="op" id="6161928">-</span><span class="num" id="6161929">1</span><span class="op" id="6161930">]</span>&nbsp;<span class="op" id="6161932">==</span>&nbsp;<span class="ident" id="6161935">ctxt</span><span class="op" id="6161939">.</span><span class="ident" id="6161940">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161949">if</span>&nbsp;<span class="ident" id="6161952">n</span>&nbsp;<span class="op" id="6161954">&gt;=</span>&nbsp;<span class="num" id="6161957">1</span>&nbsp;<span class="op" id="6161959">&amp;&amp;</span>&nbsp;<span class="ident" id="6161962">knownArch</span><span class="op" id="6161971">[</span><span class="ident" id="6161972">l</span><span class="op" id="6161973">[</span><span class="ident" id="6161974">n</span><span class="op" id="6161975">-</span><span class="num" id="6161976">1</span><span class="op" id="6161977">]</span><span class="op" id="6161978">]</span>&nbsp;<span class="op" id="6161980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161984">if</span>&nbsp;<span class="ident" id="6161987">allTags</span>&nbsp;<span class="op" id="6161995">!=</span>&nbsp;<span class="ident" id="6161998">nil</span>&nbsp;<span class="op" id="6162002">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162007">allTags</span><span class="op" id="6162014">[</span><span class="ident" id="6162015">l</span><span class="op" id="6162016">[</span><span class="ident" id="6162017">n</span><span class="op" id="6162018">-</span><span class="num" id="6162019">1</span><span class="op" id="6162020">]</span><span class="op" id="6162021">]</span>&nbsp;<span class="op" id="6162023">=</span>&nbsp;<span class="builtintype" id="6162025">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162036">return</span>&nbsp;<span class="ident" id="6162043">l</span><span class="op" id="6162044">[</span><span class="ident" id="6162045">n</span><span class="op" id="6162046">-</span><span class="num" id="6162047">1</span><span class="op" id="6162048">]</span>&nbsp;<span class="op" id="6162050">==</span>&nbsp;<span class="ident" id="6162053">ctxt</span><span class="op" id="6162057">.</span><span class="ident" id="6162058">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162069">return</span>&nbsp;<span class="builtintype" id="6162076">true</span><br>
<span class="lineno">1355</span><span class="op" id="6162081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6162084">var</span>&nbsp;<span class="ident" id="6162088">knownOS</span>&nbsp;<span class="op" id="6162096">=</span>&nbsp;<span class="builtinfunc" id="6162098">make</span><span class="op" id="6162102">(</span><span class="keyword" id="6162103">map</span><span class="op" id="6162106">[</span><span class="builtintype" id="6162107">string</span><span class="op" id="6162113">]</span><span class="builtintype" id="6162114">bool</span><span class="op" id="6162118">)</span><br>
<span class="lineno"></span><span class="keyword" id="6162120">var</span>&nbsp;<span class="ident" id="6162124">knownArch</span>&nbsp;<span class="op" id="6162134">=</span>&nbsp;<span class="builtinfunc" id="6162136">make</span><span class="op" id="6162140">(</span><span class="keyword" id="6162141">map</span><span class="op" id="6162144">[</span><span class="builtintype" id="6162145">string</span><span class="op" id="6162151">]</span><span class="builtintype" id="6162152">bool</span><span class="op" id="6162156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="6162159">func</span>&nbsp;<span class="ident" id="6162164">init</span><span class="op" id="6162168">(</span><span class="op" id="6162169">)</span>&nbsp;<span class="op" id="6162171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162174">for</span>&nbsp;<span class="ident" id="6162178">_</span><span class="op" id="6162179">,</span>&nbsp;<span class="ident" id="6162181">v</span>&nbsp;<span class="op" id="6162183">:=</span>&nbsp;<span class="keyword" id="6162186">range</span>&nbsp;<span class="ident" id="6162192">strings</span><span class="op" id="6162199">.</span><span class="ident" id="6162200">Fields</span><span class="op" id="6162206">(</span><span class="ident" id="6162207">goosList</span><span class="op" id="6162215">)</span>&nbsp;<span class="op" id="6162217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162221">knownOS</span><span class="op" id="6162228">[</span><span class="ident" id="6162229">v</span><span class="op" id="6162230">]</span>&nbsp;<span class="op" id="6162232">=</span>&nbsp;<span class="builtintype" id="6162234">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162243">for</span>&nbsp;<span class="ident" id="6162247">_</span><span class="op" id="6162248">,</span>&nbsp;<span class="ident" id="6162250">v</span>&nbsp;<span class="op" id="6162252">:=</span>&nbsp;<span class="keyword" id="6162255">range</span>&nbsp;<span class="ident" id="6162261">strings</span><span class="op" id="6162268">.</span><span class="ident" id="6162269">Fields</span><span class="op" id="6162275">(</span><span class="ident" id="6162276">goarchList</span><span class="op" id="6162286">)</span>&nbsp;<span class="op" id="6162288">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162292">knownArch</span><span class="op" id="6162301">[</span><span class="ident" id="6162302">v</span><span class="op" id="6162303">]</span>&nbsp;<span class="op" id="6162305">=</span>&nbsp;<span class="builtintype" id="6162307">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162313">}</span><br>
<span class="lineno"></span><span class="op" id="6162315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6162318">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="6162370">var</span>&nbsp;<span class="ident" id="6162374">ToolDir</span>&nbsp;<span class="op" id="6162382">=</span>&nbsp;<span class="ident" id="6162384">filepath</span><span class="op" id="6162392">.</span><span class="ident" id="6162393">Join</span><span class="op" id="6162397">(</span><span class="ident" id="6162398">runtime</span><span class="op" id="6162405">.</span><span class="ident" id="6162406">GOROOT</span><span class="op" id="6162412">(</span><span class="op" id="6162413">)</span><span class="op" id="6162414">,</span>&nbsp;<span class="string" id="6162416">&#34;pkg/tool/&#34;</span><span class="op" id="6162427">+</span><span class="ident" id="6162428">runtime</span><span class="op" id="6162435">.</span><span class="ident" id="6162436">GOOS</span><span class="op" id="6162440">+</span><span class="string" id="6162441">&#34;_&#34;</span><span class="op" id="6162444">+</span><span class="ident" id="6162445">runtime</span><span class="op" id="6162452">.</span><span class="ident" id="6162453">GOARCH</span><span class="op" id="6162459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6162462">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6162514">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6162576">func</span>&nbsp;<span class="ident" id="6162581">IsLocalImport</span><span class="op" id="6162594">(</span><span class="ident" id="6162595">path</span>&nbsp;<span class="builtintype" id="6162600">string</span><span class="op" id="6162606">)</span>&nbsp;<span class="builtintype" id="6162608">bool</span>&nbsp;<span class="op" id="6162613">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162616">return</span>&nbsp;<span class="ident" id="6162623">path</span>&nbsp;<span class="op" id="6162628">==</span>&nbsp;<span class="string" id="6162631">&#34;.&#34;</span>&nbsp;<span class="op" id="6162635">||</span>&nbsp;<span class="ident" id="6162638">path</span>&nbsp;<span class="op" id="6162643">==</span>&nbsp;<span class="string" id="6162646">&#34;..&#34;</span>&nbsp;<span class="op" id="6162651">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162656">strings</span><span class="op" id="6162663">.</span><span class="ident" id="6162664">HasPrefix</span><span class="op" id="6162673">(</span><span class="ident" id="6162674">path</span><span class="op" id="6162678">,</span>&nbsp;<span class="string" id="6162680">&#34;./&#34;</span><span class="op" id="6162684">)</span>&nbsp;<span class="op" id="6162686">||</span>&nbsp;<span class="ident" id="6162689">strings</span><span class="op" id="6162696">.</span><span class="ident" id="6162697">HasPrefix</span><span class="op" id="6162706">(</span><span class="ident" id="6162707">path</span><span class="op" id="6162711">,</span>&nbsp;<span class="string" id="6162713">&#34;../&#34;</span><span class="op" id="6162718">)</span><br>
<span class="lineno"></span><span class="op" id="6162720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6162723">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="6162792">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6162839">func</span>&nbsp;<span class="ident" id="6162844">ArchChar</span><span class="op" id="6162852">(</span><span class="ident" id="6162853">goarch</span>&nbsp;<span class="builtintype" id="6162860">string</span><span class="op" id="6162866">)</span>&nbsp;<span class="op" id="6162868">(</span><span class="builtintype" id="6162869">string</span><span class="op" id="6162875">,</span>&nbsp;<span class="builtintype" id="6162877">error</span><span class="op" id="6162882">)</span>&nbsp;<span class="op" id="6162884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162887">switch</span>&nbsp;<span class="ident" id="6162894">goarch</span>&nbsp;<span class="op" id="6162901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162904">case</span>&nbsp;<span class="string" id="6162909">&#34;386&#34;</span><span class="op" id="6162914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162918">return</span>&nbsp;<span class="string" id="6162925">&#34;8&#34;</span><span class="op" id="6162928">,</span>&nbsp;<span class="ident" id="6162930">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162935">case</span>&nbsp;<span class="string" id="6162940">&#34;amd64&#34;</span><span class="op" id="6162947">,</span>&nbsp;<span class="string" id="6162949">&#34;amd64p32&#34;</span><span class="op" id="6162959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162963">return</span>&nbsp;<span class="string" id="6162970">&#34;6&#34;</span><span class="op" id="6162973">,</span>&nbsp;<span class="ident" id="6162975">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162980">case</span>&nbsp;<span class="string" id="6162985">&#34;arm&#34;</span><span class="op" id="6162990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162994">return</span>&nbsp;<span class="string" id="6163001">&#34;5&#34;</span><span class="op" id="6163004">,</span>&nbsp;<span class="ident" id="6163006">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163011">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163014">return</span>&nbsp;<span class="string" id="6163021">&#34;&#34;</span><span class="op" id="6163023">,</span>&nbsp;<span class="ident" id="6163025">errors</span><span class="op" id="6163031">.</span><span class="ident" id="6163032">New</span><span class="op" id="6163035">(</span><span class="string" id="6163036">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="6163058">+</span>&nbsp;<span class="ident" id="6163060">goarch</span><span class="op" id="6163066">)</span><br>
<span class="lineno"></span><span class="op" id="6163068">}</span>
</div>
</body>
</html>
