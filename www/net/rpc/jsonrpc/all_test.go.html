<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8529071">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8529127">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8529181">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8529232">package</span>&nbsp;<span class="ident" id="8529240">jsonrpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8529249">import</span>&nbsp;<span class="op" id="8529256">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529259">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529268">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529285">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529295">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529302">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529308">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529321">&#34;net&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529328">&#34;net/rpc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529339">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529350">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8529360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8529363">type</span>&nbsp;<span class="ident" id="8529368">Args</span>&nbsp;<span class="keyword" id="8529373">struct</span>&nbsp;<span class="op" id="8529380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529383">A</span><span class="op" id="8529384">,</span>&nbsp;<span class="ident" id="8529386">B</span>&nbsp;<span class="builtintype" id="8529388">int</span><br>
<span class="lineno"></span><span class="op" id="8529392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8529395">type</span>&nbsp;<span class="ident" id="8529400">Reply</span>&nbsp;<span class="keyword" id="8529406">struct</span>&nbsp;<span class="op" id="8529413">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529416">C</span>&nbsp;<span class="builtintype" id="8529418">int</span><br>
<span class="lineno"></span><span class="op" id="8529422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8529425">type</span>&nbsp;<span class="ident" id="8529430">Arith</span>&nbsp;<span class="builtintype" id="8529436">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8529441">type</span>&nbsp;<span class="ident" id="8529446">ArithAddResp</span>&nbsp;<span class="keyword" id="8529459">struct</span>&nbsp;<span class="op" id="8529466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529469">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8529476">interface</span><span class="op" id="8529485">{</span><span class="op" id="8529486">}</span>&nbsp;<span class="string" id="8529488">`json:&#34;id&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529501">Result</span>&nbsp;<span class="ident" id="8529508"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8529520">`json:&#34;result&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529537">Error</span>&nbsp;&nbsp;<span class="keyword" id="8529544">interface</span><span class="op" id="8529553">{</span><span class="op" id="8529554">}</span>&nbsp;<span class="string" id="8529556">`json:&#34;error&#34;`</span><br>
<span class="lineno"></span><span class="op" id="8529571">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8529574">func</span>&nbsp;<span class="op" id="8529579">(</span><span class="ident" id="8529580">t</span>&nbsp;<span class="op" id="8529582">*</span><span class="ident" id="8529583"><a href="/net/rpc/jsonrpc/all_test.go.html#8529430">Arith</a></span><span class="op" id="8529588">)</span>&nbsp;<span class="ident" id="8529590">Add</span><span class="op" id="8529593">(</span><span class="ident" id="8529594">args</span>&nbsp;<span class="op" id="8529599">*</span><span class="ident" id="8529600"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8529604">,</span>&nbsp;<span class="ident" id="8529606">reply</span>&nbsp;<span class="op" id="8529612">*</span><span class="ident" id="8529613"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8529618">)</span>&nbsp;<span class="builtintype" id="8529620">error</span>&nbsp;<span class="op" id="8529626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529629"><a href="/net/rpc/jsonrpc/all_test.go.html#8529606">reply</a></span><span class="op" id="8529634">.</span><span class="ident" id="8529635">C</span>&nbsp;<span class="op" id="8529637">=</span>&nbsp;<span class="ident" id="8529639"><a href="/net/rpc/jsonrpc/all_test.go.html#8529594">args</a></span><span class="op" id="8529643">.</span><span class="ident" id="8529644">A</span>&nbsp;<span class="op" id="8529646">+</span>&nbsp;<span class="ident" id="8529648"><a href="/net/rpc/jsonrpc/all_test.go.html#8529594">args</a></span><span class="op" id="8529652">.</span><span class="ident" id="8529653">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529656">return</span>&nbsp;<span class="ident" id="8529663">nil</span><br>
<span class="lineno"></span><span class="op" id="8529667">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="8529670">func</span>&nbsp;<span class="op" id="8529675">(</span><span class="ident" id="8529676">t</span>&nbsp;<span class="op" id="8529678">*</span><span class="ident" id="8529679"><a href="/net/rpc/jsonrpc/all_test.go.html#8529430">Arith</a></span><span class="op" id="8529684">)</span>&nbsp;<span class="ident" id="8529686">Mul</span><span class="op" id="8529689">(</span><span class="ident" id="8529690">args</span>&nbsp;<span class="op" id="8529695">*</span><span class="ident" id="8529696"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8529700">,</span>&nbsp;<span class="ident" id="8529702">reply</span>&nbsp;<span class="op" id="8529708">*</span><span class="ident" id="8529709"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8529714">)</span>&nbsp;<span class="builtintype" id="8529716">error</span>&nbsp;<span class="op" id="8529722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529725"><a href="/net/rpc/jsonrpc/all_test.go.html#8529702">reply</a></span><span class="op" id="8529730">.</span><span class="ident" id="8529731">C</span>&nbsp;<span class="op" id="8529733">=</span>&nbsp;<span class="ident" id="8529735"><a href="/net/rpc/jsonrpc/all_test.go.html#8529690">args</a></span><span class="op" id="8529739">.</span><span class="ident" id="8529740">A</span>&nbsp;<span class="op" id="8529742">*</span>&nbsp;<span class="ident" id="8529744"><a href="/net/rpc/jsonrpc/all_test.go.html#8529690">args</a></span><span class="op" id="8529748">.</span><span class="ident" id="8529749">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529752">return</span>&nbsp;<span class="ident" id="8529759">nil</span><br>
<span class="lineno"></span><span class="op" id="8529763">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8529766">func</span>&nbsp;<span class="op" id="8529771">(</span><span class="ident" id="8529772">t</span>&nbsp;<span class="op" id="8529774">*</span><span class="ident" id="8529775"><a href="/net/rpc/jsonrpc/all_test.go.html#8529430">Arith</a></span><span class="op" id="8529780">)</span>&nbsp;<span class="ident" id="8529782">Div</span><span class="op" id="8529785">(</span><span class="ident" id="8529786">args</span>&nbsp;<span class="op" id="8529791">*</span><span class="ident" id="8529792"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8529796">,</span>&nbsp;<span class="ident" id="8529798">reply</span>&nbsp;<span class="op" id="8529804">*</span><span class="ident" id="8529805"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8529810">)</span>&nbsp;<span class="builtintype" id="8529812">error</span>&nbsp;<span class="op" id="8529818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529821">if</span>&nbsp;<span class="ident" id="8529824"><a href="/net/rpc/jsonrpc/all_test.go.html#8529786">args</a></span><span class="op" id="8529828">.</span><span class="ident" id="8529829">B</span>&nbsp;<span class="op" id="8529831">==</span>&nbsp;<span class="num" id="8529834">0</span>&nbsp;<span class="op" id="8529836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529840">return</span>&nbsp;<span class="ident" id="8529847"><a href="/net/rpc/jsonrpc/all_test.go.html#8529285">errors</a></span><span class="op" id="8529853">.</span><span class="ident" id="8529854">New</span><span class="op" id="8529857">(</span><span class="string" id="8529858">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="8529874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8529877">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529880"><a href="/net/rpc/jsonrpc/all_test.go.html#8529798">reply</a></span><span class="op" id="8529885">.</span><span class="ident" id="8529886">C</span>&nbsp;<span class="op" id="8529888">=</span>&nbsp;<span class="ident" id="8529890"><a href="/net/rpc/jsonrpc/all_test.go.html#8529786">args</a></span><span class="op" id="8529894">.</span><span class="ident" id="8529895">A</span>&nbsp;<span class="op" id="8529897">/</span>&nbsp;<span class="ident" id="8529899"><a href="/net/rpc/jsonrpc/all_test.go.html#8529786">args</a></span><span class="op" id="8529903">.</span><span class="ident" id="8529904">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529907">return</span>&nbsp;<span class="ident" id="8529914">nil</span><br>
<span class="lineno"></span><span class="op" id="8529918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8529921">func</span>&nbsp;<span class="op" id="8529926">(</span><span class="ident" id="8529927">t</span>&nbsp;<span class="op" id="8529929">*</span><span class="ident" id="8529930"><a href="/net/rpc/jsonrpc/all_test.go.html#8529430">Arith</a></span><span class="op" id="8529935">)</span>&nbsp;<span class="ident" id="8529937">Error</span><span class="op" id="8529942">(</span><span class="ident" id="8529943">args</span>&nbsp;<span class="op" id="8529948">*</span><span class="ident" id="8529949"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8529953">,</span>&nbsp;<span class="ident" id="8529955">reply</span>&nbsp;<span class="op" id="8529961">*</span><span class="ident" id="8529962"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8529967">)</span>&nbsp;<span class="builtintype" id="8529969">error</span>&nbsp;<span class="op" id="8529975">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8529978">panic</span><span class="op" id="8529983">(</span><span class="string" id="8529984">&#34;ERROR&#34;</span><span class="op" id="8529991">)</span><br>
<span class="lineno"></span><span class="op" id="8529993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8529996">func</span>&nbsp;<span class="ident" id="8530001">init</span><span class="op" id="8530005">(</span><span class="op" id="8530006">)</span>&nbsp;<span class="op" id="8530008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530011"><a href="/net/rpc/jsonrpc/all_test.go.html#8529328">rpc</a></span><span class="op" id="8530014">.</span><span class="ident" id="8530015">Register</span><span class="op" id="8530023">(</span><span class="builtinfunc" id="8530024">new</span><span class="op" id="8530027">(</span><span class="ident" id="8530028"><a href="/net/rpc/jsonrpc/all_test.go.html#8529430">Arith</a></span><span class="op" id="8530033">)</span><span class="op" id="8530034">)</span><br>
<span class="lineno">60</span><span class="op" id="8530036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530039">func</span>&nbsp;<span class="ident" id="8530044">TestServerNoParams</span><span class="op" id="8530062">(</span><span class="ident" id="8530063">t</span>&nbsp;<span class="op" id="8530065">*</span><span class="ident" id="8530066"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8530073">.</span><span class="ident" id="8530074">T</span><span class="op" id="8530075">)</span>&nbsp;<span class="op" id="8530077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530080">cli</span><span class="op" id="8530083">,</span>&nbsp;<span class="ident" id="8530085">srv</span>&nbsp;<span class="op" id="8530089">:=</span>&nbsp;<span class="ident" id="8530092"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8530095">.</span><span class="ident" id="8530096">Pipe</span><span class="op" id="8530100">(</span><span class="op" id="8530101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530104">defer</span>&nbsp;<span class="ident" id="8530110"><a href="/net/rpc/jsonrpc/all_test.go.html#8530080">cli</a></span><span class="op" id="8530113">.</span><span class="ident" id="8530114">Close</span><span class="op" id="8530119">(</span><span class="op" id="8530120">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530123">go</span>&nbsp;<span class="ident" id="8530126"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8530135">(</span><span class="ident" id="8530136"><a href="/net/rpc/jsonrpc/all_test.go.html#8530085">srv</a></span><span class="op" id="8530139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530142">dec</span>&nbsp;<span class="op" id="8530146">:=</span>&nbsp;<span class="ident" id="8530149"><a href="/net/rpc/jsonrpc/all_test.go.html#8529268">json</a></span><span class="op" id="8530153">.</span><span class="ident" id="8530154">NewDecoder</span><span class="op" id="8530164">(</span><span class="ident" id="8530165"><a href="/net/rpc/jsonrpc/all_test.go.html#8530080">cli</a></span><span class="op" id="8530168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530172"><a href="/net/rpc/jsonrpc/all_test.go.html#8529295">fmt</a></span><span class="op" id="8530175">.</span><span class="ident" id="8530176">Fprintf</span><span class="op" id="8530183">(</span><span class="ident" id="8530184"><a href="/net/rpc/jsonrpc/all_test.go.html#8530080">cli</a></span><span class="op" id="8530187">,</span>&nbsp;<span class="string" id="8530189">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;}`</span><span class="op" id="8530227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530230">var</span>&nbsp;<span class="ident" id="8530234">resp</span>&nbsp;<span class="ident" id="8530239"><a href="/net/rpc/jsonrpc/all_test.go.html#8529446">ArithAddResp</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530253">if</span>&nbsp;<span class="ident" id="8530256">err</span>&nbsp;<span class="op" id="8530260">:=</span>&nbsp;<span class="ident" id="8530263"><a href="/net/rpc/jsonrpc/all_test.go.html#8530142">dec</a></span><span class="op" id="8530266">.</span><span class="ident" id="8530267">Decode</span><span class="op" id="8530273">(</span><span class="op" id="8530274">&amp;</span><span class="ident" id="8530275"><a href="/net/rpc/jsonrpc/all_test.go.html#8530234">resp</a></span><span class="op" id="8530279">)</span><span class="op" id="8530280">;</span>&nbsp;<span class="ident" id="8530282"><a href="/net/rpc/jsonrpc/all_test.go.html#8530256">err</a></span>&nbsp;<span class="op" id="8530286">!=</span>&nbsp;<span class="ident" id="8530289">nil</span>&nbsp;<span class="op" id="8530293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530297"><a href="/net/rpc/jsonrpc/all_test.go.html#8530063">t</a></span><span class="op" id="8530298">.</span><span class="ident" id="8530299">Fatalf</span><span class="op" id="8530305">(</span><span class="string" id="8530306">&#34;Decode&nbsp;after&nbsp;no&nbsp;params:&nbsp;%s&#34;</span><span class="op" id="8530334">,</span>&nbsp;<span class="ident" id="8530336"><a href="/net/rpc/jsonrpc/all_test.go.html#8530256">err</a></span><span class="op" id="8530339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530345">if</span>&nbsp;<span class="ident" id="8530348"><a href="/net/rpc/jsonrpc/all_test.go.html#8530234">resp</a></span><span class="op" id="8530352">.</span><span class="ident" id="8530353">Error</span>&nbsp;<span class="op" id="8530359">==</span>&nbsp;<span class="ident" id="8530362">nil</span>&nbsp;<span class="op" id="8530366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530370"><a href="/net/rpc/jsonrpc/all_test.go.html#8530063">t</a></span><span class="op" id="8530371">.</span><span class="ident" id="8530372">Fatalf</span><span class="op" id="8530378">(</span><span class="string" id="8530379">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8530404">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530407">}</span><br>
<span class="lineno"></span><span class="op" id="8530409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530412">func</span>&nbsp;<span class="ident" id="8530417">TestServerEmptyMessage</span><span class="op" id="8530439">(</span><span class="ident" id="8530440">t</span>&nbsp;<span class="op" id="8530442">*</span><span class="ident" id="8530443"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8530450">.</span><span class="ident" id="8530451">T</span><span class="op" id="8530452">)</span>&nbsp;<span class="op" id="8530454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530457">cli</span><span class="op" id="8530460">,</span>&nbsp;<span class="ident" id="8530462">srv</span>&nbsp;<span class="op" id="8530466">:=</span>&nbsp;<span class="ident" id="8530469"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8530472">.</span><span class="ident" id="8530473">Pipe</span><span class="op" id="8530477">(</span><span class="op" id="8530478">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530481">defer</span>&nbsp;<span class="ident" id="8530487"><a href="/net/rpc/jsonrpc/all_test.go.html#8530457">cli</a></span><span class="op" id="8530490">.</span><span class="ident" id="8530491">Close</span><span class="op" id="8530496">(</span><span class="op" id="8530497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530500">go</span>&nbsp;<span class="ident" id="8530503"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8530512">(</span><span class="ident" id="8530513"><a href="/net/rpc/jsonrpc/all_test.go.html#8530462">srv</a></span><span class="op" id="8530516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530519">dec</span>&nbsp;<span class="op" id="8530523">:=</span>&nbsp;<span class="ident" id="8530526"><a href="/net/rpc/jsonrpc/all_test.go.html#8529268">json</a></span><span class="op" id="8530530">.</span><span class="ident" id="8530531">NewDecoder</span><span class="op" id="8530541">(</span><span class="ident" id="8530542"><a href="/net/rpc/jsonrpc/all_test.go.html#8530457">cli</a></span><span class="op" id="8530545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530549"><a href="/net/rpc/jsonrpc/all_test.go.html#8529295">fmt</a></span><span class="op" id="8530552">.</span><span class="ident" id="8530553">Fprintf</span><span class="op" id="8530560">(</span><span class="ident" id="8530561"><a href="/net/rpc/jsonrpc/all_test.go.html#8530457">cli</a></span><span class="op" id="8530564">,</span>&nbsp;<span class="string" id="8530566">&#34;{}&#34;</span><span class="op" id="8530570">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530573">var</span>&nbsp;<span class="ident" id="8530577">resp</span>&nbsp;<span class="ident" id="8530582"><a href="/net/rpc/jsonrpc/all_test.go.html#8529446">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530596">if</span>&nbsp;<span class="ident" id="8530599">err</span>&nbsp;<span class="op" id="8530603">:=</span>&nbsp;<span class="ident" id="8530606"><a href="/net/rpc/jsonrpc/all_test.go.html#8530519">dec</a></span><span class="op" id="8530609">.</span><span class="ident" id="8530610">Decode</span><span class="op" id="8530616">(</span><span class="op" id="8530617">&amp;</span><span class="ident" id="8530618"><a href="/net/rpc/jsonrpc/all_test.go.html#8530577">resp</a></span><span class="op" id="8530622">)</span><span class="op" id="8530623">;</span>&nbsp;<span class="ident" id="8530625"><a href="/net/rpc/jsonrpc/all_test.go.html#8530599">err</a></span>&nbsp;<span class="op" id="8530629">!=</span>&nbsp;<span class="ident" id="8530632">nil</span>&nbsp;<span class="op" id="8530636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530640"><a href="/net/rpc/jsonrpc/all_test.go.html#8530440">t</a></span><span class="op" id="8530641">.</span><span class="ident" id="8530642">Fatalf</span><span class="op" id="8530648">(</span><span class="string" id="8530649">&#34;Decode&nbsp;after&nbsp;empty:&nbsp;%s&#34;</span><span class="op" id="8530673">,</span>&nbsp;<span class="ident" id="8530675"><a href="/net/rpc/jsonrpc/all_test.go.html#8530599">err</a></span><span class="op" id="8530678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530684">if</span>&nbsp;<span class="ident" id="8530687"><a href="/net/rpc/jsonrpc/all_test.go.html#8530577">resp</a></span><span class="op" id="8530691">.</span><span class="ident" id="8530692">Error</span>&nbsp;<span class="op" id="8530698">==</span>&nbsp;<span class="ident" id="8530701">nil</span>&nbsp;<span class="op" id="8530705">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530709"><a href="/net/rpc/jsonrpc/all_test.go.html#8530440">t</a></span><span class="op" id="8530710">.</span><span class="ident" id="8530711">Fatalf</span><span class="op" id="8530717">(</span><span class="string" id="8530718">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8530743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530746">}</span><br>
<span class="lineno"></span><span class="op" id="8530748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530751">func</span>&nbsp;<span class="ident" id="8530756">TestServer</span><span class="op" id="8530766">(</span><span class="ident" id="8530767">t</span>&nbsp;<span class="op" id="8530769">*</span><span class="ident" id="8530770"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8530777">.</span><span class="ident" id="8530778">T</span><span class="op" id="8530779">)</span>&nbsp;<span class="op" id="8530781">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530784">cli</span><span class="op" id="8530787">,</span>&nbsp;<span class="ident" id="8530789">srv</span>&nbsp;<span class="op" id="8530793">:=</span>&nbsp;<span class="ident" id="8530796"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8530799">.</span><span class="ident" id="8530800">Pipe</span><span class="op" id="8530804">(</span><span class="op" id="8530805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530808">defer</span>&nbsp;<span class="ident" id="8530814"><a href="/net/rpc/jsonrpc/all_test.go.html#8530784">cli</a></span><span class="op" id="8530817">.</span><span class="ident" id="8530818">Close</span><span class="op" id="8530823">(</span><span class="op" id="8530824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530827">go</span>&nbsp;<span class="ident" id="8530830"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8530839">(</span><span class="ident" id="8530840"><a href="/net/rpc/jsonrpc/all_test.go.html#8530789">srv</a></span><span class="op" id="8530843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530846">dec</span>&nbsp;<span class="op" id="8530850">:=</span>&nbsp;<span class="ident" id="8530853"><a href="/net/rpc/jsonrpc/all_test.go.html#8529268">json</a></span><span class="op" id="8530857">.</span><span class="ident" id="8530858">NewDecoder</span><span class="op" id="8530868">(</span><span class="ident" id="8530869"><a href="/net/rpc/jsonrpc/all_test.go.html#8530784">cli</a></span><span class="op" id="8530872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530876">//&nbsp;Send&nbsp;hand-coded&nbsp;requests&nbsp;to&nbsp;server,&nbsp;parse&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530933">for</span>&nbsp;<span class="ident" id="8530937">i</span>&nbsp;<span class="op" id="8530939">:=</span>&nbsp;<span class="num" id="8530942">0</span><span class="op" id="8530943">;</span>&nbsp;<span class="ident" id="8530945"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span>&nbsp;<span class="op" id="8530947">&lt;</span>&nbsp;<span class="num" id="8530949">10</span><span class="op" id="8530951">;</span>&nbsp;<span class="ident" id="8530953"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8530954">++</span>&nbsp;<span class="op" id="8530957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530961"><a href="/net/rpc/jsonrpc/all_test.go.html#8529295">fmt</a></span><span class="op" id="8530964">.</span><span class="ident" id="8530965">Fprintf</span><span class="op" id="8530972">(</span><span class="ident" id="8530973"><a href="/net/rpc/jsonrpc/all_test.go.html#8530784">cli</a></span><span class="op" id="8530976">,</span>&nbsp;<span class="string" id="8530978">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;\u%04d&#34;,&nbsp;&#34;params&#34;:&nbsp;[{&#34;A&#34;:&nbsp;%d,&nbsp;&#34;B&#34;:&nbsp;%d}]}`</span><span class="op" id="8531051">,</span>&nbsp;<span class="ident" id="8531053"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531054">,</span>&nbsp;<span class="ident" id="8531056"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531057">,</span>&nbsp;<span class="ident" id="8531059"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531060">+</span><span class="num" id="8531061">1</span><span class="op" id="8531062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531066">var</span>&nbsp;<span class="ident" id="8531070">resp</span>&nbsp;<span class="ident" id="8531075"><a href="/net/rpc/jsonrpc/all_test.go.html#8529446">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531090">err</span>&nbsp;<span class="op" id="8531094">:=</span>&nbsp;<span class="ident" id="8531097"><a href="/net/rpc/jsonrpc/all_test.go.html#8530846">dec</a></span><span class="op" id="8531100">.</span><span class="ident" id="8531101">Decode</span><span class="op" id="8531107">(</span><span class="op" id="8531108">&amp;</span><span class="ident" id="8531109"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531113">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531117">if</span>&nbsp;<span class="ident" id="8531120"><a href="/net/rpc/jsonrpc/all_test.go.html#8531090">err</a></span>&nbsp;<span class="op" id="8531124">!=</span>&nbsp;<span class="ident" id="8531127">nil</span>&nbsp;<span class="op" id="8531131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531136"><a href="/net/rpc/jsonrpc/all_test.go.html#8530767">t</a></span><span class="op" id="8531137">.</span><span class="ident" id="8531138">Fatalf</span><span class="op" id="8531144">(</span><span class="string" id="8531145">&#34;Decode:&nbsp;%s&#34;</span><span class="op" id="8531157">,</span>&nbsp;<span class="ident" id="8531159"><a href="/net/rpc/jsonrpc/all_test.go.html#8531090">err</a></span><span class="op" id="8531162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531170">if</span>&nbsp;<span class="ident" id="8531173"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531177">.</span><span class="ident" id="8531178">Error</span>&nbsp;<span class="op" id="8531184">!=</span>&nbsp;<span class="ident" id="8531187">nil</span>&nbsp;<span class="op" id="8531191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531196"><a href="/net/rpc/jsonrpc/all_test.go.html#8530767">t</a></span><span class="op" id="8531197">.</span><span class="ident" id="8531198">Fatalf</span><span class="op" id="8531204">(</span><span class="string" id="8531205">&#34;resp.Error:&nbsp;%s&#34;</span><span class="op" id="8531221">,</span>&nbsp;<span class="ident" id="8531223"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531227">.</span><span class="ident" id="8531228">Error</span><span class="op" id="8531233">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531241">if</span>&nbsp;<span class="ident" id="8531244"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531248">.</span><span class="ident" id="8531249">Id</span><span class="op" id="8531251">.</span><span class="op" id="8531252">(</span><span class="builtintype" id="8531253">string</span><span class="op" id="8531259">)</span>&nbsp;<span class="op" id="8531261">!=</span>&nbsp;<span class="builtintype" id="8531264">string</span><span class="op" id="8531270">(</span><span class="ident" id="8531271"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531272">)</span>&nbsp;<span class="op" id="8531274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531279"><a href="/net/rpc/jsonrpc/all_test.go.html#8530767">t</a></span><span class="op" id="8531280">.</span><span class="ident" id="8531281">Fatalf</span><span class="op" id="8531287">(</span><span class="string" id="8531288">&#34;resp:&nbsp;bad&nbsp;id&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8531313">,</span>&nbsp;<span class="ident" id="8531315"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531319">.</span><span class="ident" id="8531320">Id</span><span class="op" id="8531322">.</span><span class="op" id="8531323">(</span><span class="builtintype" id="8531324">string</span><span class="op" id="8531330">)</span><span class="op" id="8531331">,</span>&nbsp;<span class="builtintype" id="8531333">string</span><span class="op" id="8531339">(</span><span class="ident" id="8531340"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531341">)</span><span class="op" id="8531342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531350">if</span>&nbsp;<span class="ident" id="8531353"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531357">.</span><span class="ident" id="8531358">Result</span><span class="op" id="8531364">.</span><span class="ident" id="8531365">C</span>&nbsp;<span class="op" id="8531367">!=</span>&nbsp;<span class="num" id="8531370">2</span><span class="op" id="8531371">*</span><span class="ident" id="8531372"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531373">+</span><span class="num" id="8531374">1</span>&nbsp;<span class="op" id="8531376">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531381"><a href="/net/rpc/jsonrpc/all_test.go.html#8530767">t</a></span><span class="op" id="8531382">.</span><span class="ident" id="8531383">Fatalf</span><span class="op" id="8531389">(</span><span class="string" id="8531390">&#34;resp:&nbsp;bad&nbsp;result:&nbsp;%d+%d=%d&#34;</span><span class="op" id="8531418">,</span>&nbsp;<span class="ident" id="8531420"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531421">,</span>&nbsp;<span class="ident" id="8531423"><a href="/net/rpc/jsonrpc/all_test.go.html#8530937">i</a></span><span class="op" id="8531424">+</span><span class="num" id="8531425">1</span><span class="op" id="8531426">,</span>&nbsp;<span class="ident" id="8531428"><a href="/net/rpc/jsonrpc/all_test.go.html#8531070">resp</a></span><span class="op" id="8531432">.</span><span class="ident" id="8531433">Result</span><span class="op" id="8531439">.</span><span class="ident" id="8531440">C</span><span class="op" id="8531441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531448">}</span><br>
<span class="lineno"></span><span class="op" id="8531450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="8531453">func</span>&nbsp;<span class="ident" id="8531458">TestClient</span><span class="op" id="8531468">(</span><span class="ident" id="8531469">t</span>&nbsp;<span class="op" id="8531471">*</span><span class="ident" id="8531472"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8531479">.</span><span class="ident" id="8531480">T</span><span class="op" id="8531481">)</span>&nbsp;<span class="op" id="8531483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8531486">//&nbsp;Assume&nbsp;server&nbsp;is&nbsp;okay&nbsp;(TestServer&nbsp;is&nbsp;above).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8531535">//&nbsp;Test&nbsp;client&nbsp;against&nbsp;server.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531567">cli</span><span class="op" id="8531570">,</span>&nbsp;<span class="ident" id="8531572">srv</span>&nbsp;<span class="op" id="8531576">:=</span>&nbsp;<span class="ident" id="8531579"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8531582">.</span><span class="ident" id="8531583">Pipe</span><span class="op" id="8531587">(</span><span class="op" id="8531588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531591">go</span>&nbsp;<span class="ident" id="8531594"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8531603">(</span><span class="ident" id="8531604"><a href="/net/rpc/jsonrpc/all_test.go.html#8531572">srv</a></span><span class="op" id="8531607">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531611">client</span>&nbsp;<span class="op" id="8531618">:=</span>&nbsp;<span class="ident" id="8531621"><a href="/net/rpc/jsonrpc/client.go.html#5774511">NewClient</a></span><span class="op" id="8531630">(</span><span class="ident" id="8531631"><a href="/net/rpc/jsonrpc/all_test.go.html#8531567">cli</a></span><span class="op" id="8531634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531637">defer</span>&nbsp;<span class="ident" id="8531643"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8531649">.</span><span class="ident" id="8531650">Close</span><span class="op" id="8531655">(</span><span class="op" id="8531656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8531660">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531682">args</span>&nbsp;<span class="op" id="8531687">:=</span>&nbsp;<span class="op" id="8531690">&amp;</span><span class="ident" id="8531691"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8531695">{</span><span class="num" id="8531696">7</span><span class="op" id="8531697">,</span>&nbsp;<span class="num" id="8531699">8</span><span class="op" id="8531700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531703">reply</span>&nbsp;<span class="op" id="8531709">:=</span>&nbsp;<span class="builtinfunc" id="8531712">new</span><span class="op" id="8531715">(</span><span class="ident" id="8531716"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8531721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531724">err</span>&nbsp;<span class="op" id="8531728">:=</span>&nbsp;<span class="ident" id="8531731"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8531737">.</span><span class="ident" id="8531738">Call</span><span class="op" id="8531742">(</span><span class="string" id="8531743">&#34;Arith.Add&#34;</span><span class="op" id="8531754">,</span>&nbsp;<span class="ident" id="8531756"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8531760">,</span>&nbsp;<span class="ident" id="8531762"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8531767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531770">if</span>&nbsp;<span class="ident" id="8531773"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span>&nbsp;<span class="op" id="8531777">!=</span>&nbsp;<span class="ident" id="8531780">nil</span>&nbsp;<span class="op" id="8531784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531788"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8531789">.</span><span class="ident" id="8531790">Errorf</span><span class="op" id="8531796">(</span><span class="string" id="8531797">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8531839">,</span>&nbsp;<span class="ident" id="8531841"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span><span class="op" id="8531844">.</span><span class="ident" id="8531845">Error</span><span class="op" id="8531850">(</span><span class="op" id="8531851">)</span><span class="op" id="8531852">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531858">if</span>&nbsp;<span class="ident" id="8531861"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8531866">.</span><span class="ident" id="8531867">C</span>&nbsp;<span class="op" id="8531869">!=</span>&nbsp;<span class="ident" id="8531872"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8531876">.</span><span class="ident" id="8531877">A</span><span class="op" id="8531878">+</span><span class="ident" id="8531879"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8531883">.</span><span class="ident" id="8531884">B</span>&nbsp;<span class="op" id="8531886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531890"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8531891">.</span><span class="ident" id="8531892">Errorf</span><span class="op" id="8531898">(</span><span class="string" id="8531899">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8531924">,</span>&nbsp;<span class="ident" id="8531926"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8531931">.</span><span class="ident" id="8531932">C</span><span class="op" id="8531933">,</span>&nbsp;<span class="ident" id="8531935"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8531939">.</span><span class="ident" id="8531940">A</span><span class="op" id="8531941">+</span><span class="ident" id="8531942"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8531946">.</span><span class="ident" id="8531947">B</span><span class="op" id="8531948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531955"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span>&nbsp;<span class="op" id="8531960">=</span>&nbsp;<span class="op" id="8531962">&amp;</span><span class="ident" id="8531963"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8531967">{</span><span class="num" id="8531968">7</span><span class="op" id="8531969">,</span>&nbsp;<span class="num" id="8531971">8</span><span class="op" id="8531972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531975"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span>&nbsp;<span class="op" id="8531981">=</span>&nbsp;<span class="builtinfunc" id="8531983">new</span><span class="op" id="8531986">(</span><span class="ident" id="8531987"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8531992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531995"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span>&nbsp;<span class="op" id="8531999">=</span>&nbsp;<span class="ident" id="8532001"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8532007">.</span><span class="ident" id="8532008">Call</span><span class="op" id="8532012">(</span><span class="string" id="8532013">&#34;Arith.Mul&#34;</span><span class="op" id="8532024">,</span>&nbsp;<span class="ident" id="8532026"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532030">,</span>&nbsp;<span class="ident" id="8532032"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8532037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532040">if</span>&nbsp;<span class="ident" id="8532043"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span>&nbsp;<span class="op" id="8532047">!=</span>&nbsp;<span class="ident" id="8532050">nil</span>&nbsp;<span class="op" id="8532054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532058"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532059">.</span><span class="ident" id="8532060">Errorf</span><span class="op" id="8532066">(</span><span class="string" id="8532067">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8532109">,</span>&nbsp;<span class="ident" id="8532111"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span><span class="op" id="8532114">.</span><span class="ident" id="8532115">Error</span><span class="op" id="8532120">(</span><span class="op" id="8532121">)</span><span class="op" id="8532122">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532128">if</span>&nbsp;<span class="ident" id="8532131"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8532136">.</span><span class="ident" id="8532137">C</span>&nbsp;<span class="op" id="8532139">!=</span>&nbsp;<span class="ident" id="8532142"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532146">.</span><span class="ident" id="8532147">A</span><span class="op" id="8532148">*</span><span class="ident" id="8532149"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532153">.</span><span class="ident" id="8532154">B</span>&nbsp;<span class="op" id="8532156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532160"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532161">.</span><span class="ident" id="8532162">Errorf</span><span class="op" id="8532168">(</span><span class="string" id="8532169">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8532194">,</span>&nbsp;<span class="ident" id="8532196"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8532201">.</span><span class="ident" id="8532202">C</span><span class="op" id="8532203">,</span>&nbsp;<span class="ident" id="8532205"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532209">.</span><span class="ident" id="8532210">A</span><span class="op" id="8532211">*</span><span class="ident" id="8532212"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532216">.</span><span class="ident" id="8532217">B</span><span class="op" id="8532218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8532225">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532243"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span>&nbsp;<span class="op" id="8532248">=</span>&nbsp;<span class="op" id="8532250">&amp;</span><span class="ident" id="8532251"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8532255">{</span><span class="num" id="8532256">7</span><span class="op" id="8532257">,</span>&nbsp;<span class="num" id="8532259">8</span><span class="op" id="8532260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532263">mulReply</span>&nbsp;<span class="op" id="8532272">:=</span>&nbsp;<span class="builtinfunc" id="8532275">new</span><span class="op" id="8532278">(</span><span class="ident" id="8532279"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8532284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532287">mulCall</span>&nbsp;<span class="op" id="8532295">:=</span>&nbsp;<span class="ident" id="8532298"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8532304">.</span><span class="ident" id="8532305">Go</span><span class="op" id="8532307">(</span><span class="string" id="8532308">&#34;Arith.Mul&#34;</span><span class="op" id="8532319">,</span>&nbsp;<span class="ident" id="8532321"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532325">,</span>&nbsp;<span class="ident" id="8532327"><a href="/net/rpc/jsonrpc/all_test.go.html#8532263">mulReply</a></span><span class="op" id="8532335">,</span>&nbsp;<span class="ident" id="8532337">nil</span><span class="op" id="8532340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532343">addReply</span>&nbsp;<span class="op" id="8532352">:=</span>&nbsp;<span class="builtinfunc" id="8532355">new</span><span class="op" id="8532358">(</span><span class="ident" id="8532359"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8532364">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532367">addCall</span>&nbsp;<span class="op" id="8532375">:=</span>&nbsp;<span class="ident" id="8532378"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8532384">.</span><span class="ident" id="8532385">Go</span><span class="op" id="8532387">(</span><span class="string" id="8532388">&#34;Arith.Add&#34;</span><span class="op" id="8532399">,</span>&nbsp;<span class="ident" id="8532401"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532405">,</span>&nbsp;<span class="ident" id="8532407"><a href="/net/rpc/jsonrpc/all_test.go.html#8532343">addReply</a></span><span class="op" id="8532415">,</span>&nbsp;<span class="ident" id="8532417">nil</span><span class="op" id="8532420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532424"><a href="/net/rpc/jsonrpc/all_test.go.html#8532367">addCall</a></span>&nbsp;<span class="op" id="8532432">=</span>&nbsp;<span class="op" id="8532434">&lt;-</span><span class="ident" id="8532436"><a href="/net/rpc/jsonrpc/all_test.go.html#8532367">addCall</a></span><span class="op" id="8532443">.</span><span class="ident" id="8532444">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532450">if</span>&nbsp;<span class="ident" id="8532453"><a href="/net/rpc/jsonrpc/all_test.go.html#8532367">addCall</a></span><span class="op" id="8532460">.</span><span class="ident" id="8532461">Error</span>&nbsp;<span class="op" id="8532467">!=</span>&nbsp;<span class="ident" id="8532470">nil</span>&nbsp;<span class="op" id="8532474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532478"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532479">.</span><span class="ident" id="8532480">Errorf</span><span class="op" id="8532486">(</span><span class="string" id="8532487">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8532529">,</span>&nbsp;<span class="ident" id="8532531"><a href="/net/rpc/jsonrpc/all_test.go.html#8532367">addCall</a></span><span class="op" id="8532538">.</span><span class="ident" id="8532539">Error</span><span class="op" id="8532544">.</span><span class="ident" id="8532545">Error</span><span class="op" id="8532550">(</span><span class="op" id="8532551">)</span><span class="op" id="8532552">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532558">if</span>&nbsp;<span class="ident" id="8532561"><a href="/net/rpc/jsonrpc/all_test.go.html#8532343">addReply</a></span><span class="op" id="8532569">.</span><span class="ident" id="8532570">C</span>&nbsp;<span class="op" id="8532572">!=</span>&nbsp;<span class="ident" id="8532575"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532579">.</span><span class="ident" id="8532580">A</span><span class="op" id="8532581">+</span><span class="ident" id="8532582"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532586">.</span><span class="ident" id="8532587">B</span>&nbsp;<span class="op" id="8532589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532593"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532594">.</span><span class="ident" id="8532595">Errorf</span><span class="op" id="8532601">(</span><span class="string" id="8532602">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8532627">,</span>&nbsp;<span class="ident" id="8532629"><a href="/net/rpc/jsonrpc/all_test.go.html#8532343">addReply</a></span><span class="op" id="8532637">.</span><span class="ident" id="8532638">C</span><span class="op" id="8532639">,</span>&nbsp;<span class="ident" id="8532641"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532645">.</span><span class="ident" id="8532646">A</span><span class="op" id="8532647">+</span><span class="ident" id="8532648"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532652">.</span><span class="ident" id="8532653">B</span><span class="op" id="8532654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532661"><a href="/net/rpc/jsonrpc/all_test.go.html#8532287">mulCall</a></span>&nbsp;<span class="op" id="8532669">=</span>&nbsp;<span class="op" id="8532671">&lt;-</span><span class="ident" id="8532673"><a href="/net/rpc/jsonrpc/all_test.go.html#8532287">mulCall</a></span><span class="op" id="8532680">.</span><span class="ident" id="8532681">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532687">if</span>&nbsp;<span class="ident" id="8532690"><a href="/net/rpc/jsonrpc/all_test.go.html#8532287">mulCall</a></span><span class="op" id="8532697">.</span><span class="ident" id="8532698">Error</span>&nbsp;<span class="op" id="8532704">!=</span>&nbsp;<span class="ident" id="8532707">nil</span>&nbsp;<span class="op" id="8532711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532715"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532716">.</span><span class="ident" id="8532717">Errorf</span><span class="op" id="8532723">(</span><span class="string" id="8532724">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8532766">,</span>&nbsp;<span class="ident" id="8532768"><a href="/net/rpc/jsonrpc/all_test.go.html#8532287">mulCall</a></span><span class="op" id="8532775">.</span><span class="ident" id="8532776">Error</span><span class="op" id="8532781">.</span><span class="ident" id="8532782">Error</span><span class="op" id="8532787">(</span><span class="op" id="8532788">)</span><span class="op" id="8532789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532795">if</span>&nbsp;<span class="ident" id="8532798"><a href="/net/rpc/jsonrpc/all_test.go.html#8532263">mulReply</a></span><span class="op" id="8532806">.</span><span class="ident" id="8532807">C</span>&nbsp;<span class="op" id="8532809">!=</span>&nbsp;<span class="ident" id="8532812"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532816">.</span><span class="ident" id="8532817">A</span><span class="op" id="8532818">*</span><span class="ident" id="8532819"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532823">.</span><span class="ident" id="8532824">B</span>&nbsp;<span class="op" id="8532826">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532830"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8532831">.</span><span class="ident" id="8532832">Errorf</span><span class="op" id="8532838">(</span><span class="string" id="8532839">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8532864">,</span>&nbsp;<span class="ident" id="8532866"><a href="/net/rpc/jsonrpc/all_test.go.html#8532263">mulReply</a></span><span class="op" id="8532874">.</span><span class="ident" id="8532875">C</span><span class="op" id="8532876">,</span>&nbsp;<span class="ident" id="8532878"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532882">.</span><span class="ident" id="8532883">A</span><span class="op" id="8532884">*</span><span class="ident" id="8532885"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532889">.</span><span class="ident" id="8532890">B</span><span class="op" id="8532891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8532898">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532913"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span>&nbsp;<span class="op" id="8532918">=</span>&nbsp;<span class="op" id="8532920">&amp;</span><span class="ident" id="8532921"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8532925">{</span><span class="num" id="8532926">7</span><span class="op" id="8532927">,</span>&nbsp;<span class="num" id="8532929">0</span><span class="op" id="8532930">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532933"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span>&nbsp;<span class="op" id="8532939">=</span>&nbsp;<span class="builtinfunc" id="8532941">new</span><span class="op" id="8532944">(</span><span class="ident" id="8532945"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8532950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532953"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span>&nbsp;<span class="op" id="8532957">=</span>&nbsp;<span class="ident" id="8532959"><a href="/net/rpc/jsonrpc/all_test.go.html#8531611">client</a></span><span class="op" id="8532965">.</span><span class="ident" id="8532966">Call</span><span class="op" id="8532970">(</span><span class="string" id="8532971">&#34;Arith.Div&#34;</span><span class="op" id="8532982">,</span>&nbsp;<span class="ident" id="8532984"><a href="/net/rpc/jsonrpc/all_test.go.html#8531682">args</a></span><span class="op" id="8532988">,</span>&nbsp;<span class="ident" id="8532990"><a href="/net/rpc/jsonrpc/all_test.go.html#8531703">reply</a></span><span class="op" id="8532995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8532998">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533031">if</span>&nbsp;<span class="ident" id="8533034"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span>&nbsp;<span class="op" id="8533038">==</span>&nbsp;<span class="ident" id="8533041">nil</span>&nbsp;<span class="op" id="8533045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533049"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8533050">.</span><span class="ident" id="8533051">Error</span><span class="op" id="8533056">(</span><span class="string" id="8533057">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8533078">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533081">}</span>&nbsp;<span class="keyword" id="8533083">else</span>&nbsp;<span class="keyword" id="8533088">if</span>&nbsp;<span class="ident" id="8533091"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span><span class="op" id="8533094">.</span><span class="ident" id="8533095">Error</span><span class="op" id="8533100">(</span><span class="op" id="8533101">)</span>&nbsp;<span class="op" id="8533103">!=</span>&nbsp;<span class="string" id="8533106">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="8533123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533127"><a href="/net/rpc/jsonrpc/all_test.go.html#8531469">t</a></span><span class="op" id="8533128">.</span><span class="ident" id="8533129">Error</span><span class="op" id="8533134">(</span><span class="string" id="8533135">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8533176">,</span>&nbsp;<span class="ident" id="8533178"><a href="/net/rpc/jsonrpc/all_test.go.html#8531724">err</a></span><span class="op" id="8533181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533184">}</span><br>
<span class="lineno"></span><span class="op" id="8533186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8533189">func</span>&nbsp;<span class="ident" id="8533194">TestMalformedInput</span><span class="op" id="8533212">(</span><span class="ident" id="8533213">t</span>&nbsp;<span class="op" id="8533215">*</span><span class="ident" id="8533216"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8533223">.</span><span class="ident" id="8533224">T</span><span class="op" id="8533225">)</span>&nbsp;<span class="op" id="8533227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533230">cli</span><span class="op" id="8533233">,</span>&nbsp;<span class="ident" id="8533235">srv</span>&nbsp;<span class="op" id="8533239">:=</span>&nbsp;<span class="ident" id="8533242"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8533245">.</span><span class="ident" id="8533246">Pipe</span><span class="op" id="8533250">(</span><span class="op" id="8533251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533254">go</span>&nbsp;<span class="ident" id="8533257"><a href="/net/rpc/jsonrpc/all_test.go.html#8533230">cli</a></span><span class="op" id="8533260">.</span><span class="ident" id="8533261">Write</span><span class="op" id="8533266">(</span><span class="op" id="8533267">[</span><span class="op" id="8533268">]</span><span class="builtintype" id="8533269">byte</span><span class="op" id="8533273">(</span><span class="string" id="8533274">`{id:1}`</span><span class="op" id="8533282">)</span><span class="op" id="8533283">)</span>&nbsp;<span class="comment" id="8533285">//&nbsp;invalid&nbsp;json</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533302"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8533311">(</span><span class="ident" id="8533312"><a href="/net/rpc/jsonrpc/all_test.go.html#8533235">srv</a></span><span class="op" id="8533315">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8533333">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8533358">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="8533361">func</span>&nbsp;<span class="ident" id="8533366">TestMalformedOutput</span><span class="op" id="8533385">(</span><span class="ident" id="8533386">t</span>&nbsp;<span class="op" id="8533388">*</span><span class="ident" id="8533389"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8533396">.</span><span class="ident" id="8533397">T</span><span class="op" id="8533398">)</span>&nbsp;<span class="op" id="8533400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533403">cli</span><span class="op" id="8533406">,</span>&nbsp;<span class="ident" id="8533408">srv</span>&nbsp;<span class="op" id="8533412">:=</span>&nbsp;<span class="ident" id="8533415"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8533418">.</span><span class="ident" id="8533419">Pipe</span><span class="op" id="8533423">(</span><span class="op" id="8533424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533427">go</span>&nbsp;<span class="ident" id="8533430"><a href="/net/rpc/jsonrpc/all_test.go.html#8533408">srv</a></span><span class="op" id="8533433">.</span><span class="ident" id="8533434">Write</span><span class="op" id="8533439">(</span><span class="op" id="8533440">[</span><span class="op" id="8533441">]</span><span class="builtintype" id="8533442">byte</span><span class="op" id="8533446">(</span><span class="string" id="8533447">`{&#34;id&#34;:0,&#34;result&#34;:null,&#34;error&#34;:null}`</span><span class="op" id="8533484">)</span><span class="op" id="8533485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533488">go</span>&nbsp;<span class="ident" id="8533491"><a href="/net/rpc/jsonrpc/all_test.go.html#8529308">ioutil</a></span><span class="op" id="8533497">.</span><span class="ident" id="8533498">ReadAll</span><span class="op" id="8533505">(</span><span class="ident" id="8533506"><a href="/net/rpc/jsonrpc/all_test.go.html#8533408">srv</a></span><span class="op" id="8533509">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533513">client</span>&nbsp;<span class="op" id="8533520">:=</span>&nbsp;<span class="ident" id="8533523"><a href="/net/rpc/jsonrpc/client.go.html#5774511">NewClient</a></span><span class="op" id="8533532">(</span><span class="ident" id="8533533"><a href="/net/rpc/jsonrpc/all_test.go.html#8533403">cli</a></span><span class="op" id="8533536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533539">defer</span>&nbsp;<span class="ident" id="8533545"><a href="/net/rpc/jsonrpc/all_test.go.html#8533513">client</a></span><span class="op" id="8533551">.</span><span class="ident" id="8533552">Close</span><span class="op" id="8533557">(</span><span class="op" id="8533558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533562">args</span>&nbsp;<span class="op" id="8533567">:=</span>&nbsp;<span class="op" id="8533570">&amp;</span><span class="ident" id="8533571"><a href="/net/rpc/jsonrpc/all_test.go.html#8529368">Args</a></span><span class="op" id="8533575">{</span><span class="num" id="8533576">7</span><span class="op" id="8533577">,</span>&nbsp;<span class="num" id="8533579">8</span><span class="op" id="8533580">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533583">reply</span>&nbsp;<span class="op" id="8533589">:=</span>&nbsp;<span class="builtinfunc" id="8533592">new</span><span class="op" id="8533595">(</span><span class="ident" id="8533596"><a href="/net/rpc/jsonrpc/all_test.go.html#8529400">Reply</a></span><span class="op" id="8533601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533604">err</span>&nbsp;<span class="op" id="8533608">:=</span>&nbsp;<span class="ident" id="8533611"><a href="/net/rpc/jsonrpc/all_test.go.html#8533513">client</a></span><span class="op" id="8533617">.</span><span class="ident" id="8533618">Call</span><span class="op" id="8533622">(</span><span class="string" id="8533623">&#34;Arith.Add&#34;</span><span class="op" id="8533634">,</span>&nbsp;<span class="ident" id="8533636"><a href="/net/rpc/jsonrpc/all_test.go.html#8533562">args</a></span><span class="op" id="8533640">,</span>&nbsp;<span class="ident" id="8533642"><a href="/net/rpc/jsonrpc/all_test.go.html#8533583">reply</a></span><span class="op" id="8533647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533650">if</span>&nbsp;<span class="ident" id="8533653"><a href="/net/rpc/jsonrpc/all_test.go.html#8533604">err</a></span>&nbsp;<span class="op" id="8533657">==</span>&nbsp;<span class="ident" id="8533660">nil</span>&nbsp;<span class="op" id="8533664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533668"><a href="/net/rpc/jsonrpc/all_test.go.html#8533386">t</a></span><span class="op" id="8533669">.</span><span class="ident" id="8533670">Error</span><span class="op" id="8533675">(</span><span class="string" id="8533676">&#34;expected&nbsp;error&#34;</span><span class="op" id="8533692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533695">}</span><br>
<span class="lineno">205</span><span class="op" id="8533697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8533700">func</span>&nbsp;<span class="ident" id="8533705">TestServerErrorHasNullResult</span><span class="op" id="8533733">(</span><span class="ident" id="8533734">t</span>&nbsp;<span class="op" id="8533736">*</span><span class="ident" id="8533737"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8533744">.</span><span class="ident" id="8533745">T</span><span class="op" id="8533746">)</span>&nbsp;<span class="op" id="8533748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533751">var</span>&nbsp;<span class="ident" id="8533755">out</span>&nbsp;<span class="ident" id="8533759"><a href="/net/rpc/jsonrpc/all_test.go.html#8529259">bytes</a></span><span class="op" id="8533764">.</span><span class="ident" id="8533765">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533773">sc</span>&nbsp;<span class="op" id="8533776">:=</span>&nbsp;<span class="ident" id="8533779"><a href="/net/rpc/jsonrpc/server.go.html#5775861">NewServerCodec</a></span><span class="op" id="8533793">(</span><span class="keyword" id="8533794">struct</span>&nbsp;<span class="op" id="8533801">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533805"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8533807">.</span><span class="ident" id="8533808">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533817"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8533819">.</span><span class="ident" id="8533820">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533829"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8533831">.</span><span class="ident" id="8533832">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533840">}</span><span class="op" id="8533841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533845">Reader</span><span class="op" id="8533851">:</span>&nbsp;<span class="ident" id="8533853"><a href="/net/rpc/jsonrpc/all_test.go.html#8529339">strings</a></span><span class="op" id="8533860">.</span><span class="ident" id="8533861">NewReader</span><span class="op" id="8533870">(</span><span class="string" id="8533871">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;,&nbsp;&#34;params&#34;:&nbsp;[]}`</span><span class="op" id="8533923">)</span><span class="op" id="8533924">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533928">Writer</span><span class="op" id="8533934">:</span>&nbsp;<span class="op" id="8533936">&amp;</span><span class="ident" id="8533937"><a href="/net/rpc/jsonrpc/all_test.go.html#8533755">out</a></span><span class="op" id="8533940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533944">Closer</span><span class="op" id="8533950">:</span>&nbsp;<span class="ident" id="8533952"><a href="/net/rpc/jsonrpc/all_test.go.html#8529308">ioutil</a></span><span class="op" id="8533958">.</span><span class="ident" id="8533959">NopCloser</span><span class="op" id="8533968">(</span><span class="ident" id="8533969">nil</span><span class="op" id="8533972">)</span><span class="op" id="8533973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533976">}</span><span class="op" id="8533977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533980">r</span>&nbsp;<span class="op" id="8533982">:=</span>&nbsp;<span class="builtinfunc" id="8533985">new</span><span class="op" id="8533988">(</span><span class="ident" id="8533989"><a href="/net/rpc/jsonrpc/all_test.go.html#8529328">rpc</a></span><span class="op" id="8533992">.</span><span class="ident" id="8533993">Request</span><span class="op" id="8534000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534003">if</span>&nbsp;<span class="ident" id="8534006">err</span>&nbsp;<span class="op" id="8534010">:=</span>&nbsp;<span class="ident" id="8534013"><a href="/net/rpc/jsonrpc/all_test.go.html#8533773">sc</a></span><span class="op" id="8534015">.</span><span class="ident" id="8534016">ReadRequestHeader</span><span class="op" id="8534033">(</span><span class="ident" id="8534034"><a href="/net/rpc/jsonrpc/all_test.go.html#8533980">r</a></span><span class="op" id="8534035">)</span><span class="op" id="8534036">;</span>&nbsp;<span class="ident" id="8534038"><a href="/net/rpc/jsonrpc/all_test.go.html#8534006">err</a></span>&nbsp;<span class="op" id="8534042">!=</span>&nbsp;<span class="ident" id="8534045">nil</span>&nbsp;<span class="op" id="8534049">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534053"><a href="/net/rpc/jsonrpc/all_test.go.html#8533734">t</a></span><span class="op" id="8534054">.</span><span class="ident" id="8534055">Fatal</span><span class="op" id="8534060">(</span><span class="ident" id="8534061"><a href="/net/rpc/jsonrpc/all_test.go.html#8534006">err</a></span><span class="op" id="8534064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534070">const</span>&nbsp;<span class="ident" id="8534076">valueText</span>&nbsp;<span class="op" id="8534086">=</span>&nbsp;<span class="string" id="8534088">&#34;the&nbsp;value&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;see&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534122">const</span>&nbsp;<span class="ident" id="8534128">errorText</span>&nbsp;<span class="op" id="8534138">=</span>&nbsp;<span class="string" id="8534140">&#34;some&nbsp;error&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534154">err</span>&nbsp;<span class="op" id="8534158">:=</span>&nbsp;<span class="ident" id="8534161"><a href="/net/rpc/jsonrpc/all_test.go.html#8533773">sc</a></span><span class="op" id="8534163">.</span><span class="ident" id="8534164">WriteResponse</span><span class="op" id="8534177">(</span><span class="op" id="8534178">&amp;</span><span class="ident" id="8534179"><a href="/net/rpc/jsonrpc/all_test.go.html#8529328">rpc</a></span><span class="op" id="8534182">.</span><span class="ident" id="8534183">Response</span><span class="op" id="8534191">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534195">ServiceMethod</span><span class="op" id="8534208">:</span>&nbsp;<span class="string" id="8534210">&#34;Method&#34;</span><span class="op" id="8534218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534222">Seq</span><span class="op" id="8534225">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8534237">1</span><span class="op" id="8534238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534242">Error</span><span class="op" id="8534247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534257"><a href="/net/rpc/jsonrpc/all_test.go.html#8534128">errorText</a></span><span class="op" id="8534266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534269">}</span><span class="op" id="8534270">,</span>&nbsp;<span class="ident" id="8534272"><a href="/net/rpc/jsonrpc/all_test.go.html#8534076">valueText</a></span><span class="op" id="8534281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534284">if</span>&nbsp;<span class="ident" id="8534287"><a href="/net/rpc/jsonrpc/all_test.go.html#8534154">err</a></span>&nbsp;<span class="op" id="8534291">!=</span>&nbsp;<span class="ident" id="8534294">nil</span>&nbsp;<span class="op" id="8534298">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534302"><a href="/net/rpc/jsonrpc/all_test.go.html#8533734">t</a></span><span class="op" id="8534303">.</span><span class="ident" id="8534304">Fatal</span><span class="op" id="8534309">(</span><span class="ident" id="8534310"><a href="/net/rpc/jsonrpc/all_test.go.html#8534154">err</a></span><span class="op" id="8534313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534319">if</span>&nbsp;<span class="op" id="8534322">!</span><span class="ident" id="8534323"><a href="/net/rpc/jsonrpc/all_test.go.html#8529339">strings</a></span><span class="op" id="8534330">.</span><span class="ident" id="8534331">Contains</span><span class="op" id="8534339">(</span><span class="ident" id="8534340"><a href="/net/rpc/jsonrpc/all_test.go.html#8533755">out</a></span><span class="op" id="8534343">.</span><span class="ident" id="8534344">String</span><span class="op" id="8534350">(</span><span class="op" id="8534351">)</span><span class="op" id="8534352">,</span>&nbsp;<span class="ident" id="8534354"><a href="/net/rpc/jsonrpc/all_test.go.html#8534128">errorText</a></span><span class="op" id="8534363">)</span>&nbsp;<span class="op" id="8534365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534369"><a href="/net/rpc/jsonrpc/all_test.go.html#8533734">t</a></span><span class="op" id="8534370">.</span><span class="ident" id="8534371">Fatalf</span><span class="op" id="8534377">(</span><span class="string" id="8534378">&#34;Response&nbsp;didn&#39;t&nbsp;contain&nbsp;expected&nbsp;error&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="8534425">,</span>&nbsp;<span class="ident" id="8534427"><a href="/net/rpc/jsonrpc/all_test.go.html#8534128">errorText</a></span><span class="op" id="8534436">,</span>&nbsp;<span class="op" id="8534438">&amp;</span><span class="ident" id="8534439"><a href="/net/rpc/jsonrpc/all_test.go.html#8533755">out</a></span><span class="op" id="8534442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534445">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534448">if</span>&nbsp;<span class="ident" id="8534451"><a href="/net/rpc/jsonrpc/all_test.go.html#8529339">strings</a></span><span class="op" id="8534458">.</span><span class="ident" id="8534459">Contains</span><span class="op" id="8534467">(</span><span class="ident" id="8534468"><a href="/net/rpc/jsonrpc/all_test.go.html#8533755">out</a></span><span class="op" id="8534471">.</span><span class="ident" id="8534472">String</span><span class="op" id="8534478">(</span><span class="op" id="8534479">)</span><span class="op" id="8534480">,</span>&nbsp;<span class="ident" id="8534482"><a href="/net/rpc/jsonrpc/all_test.go.html#8534076">valueText</a></span><span class="op" id="8534491">)</span>&nbsp;<span class="op" id="8534493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534497"><a href="/net/rpc/jsonrpc/all_test.go.html#8533734">t</a></span><span class="op" id="8534498">.</span><span class="ident" id="8534499">Errorf</span><span class="op" id="8534505">(</span><span class="string" id="8534506">&#34;Response&nbsp;contains&nbsp;both&nbsp;an&nbsp;error&nbsp;and&nbsp;value:&nbsp;%s&#34;</span><span class="op" id="8534553">,</span>&nbsp;<span class="op" id="8534555">&amp;</span><span class="ident" id="8534556"><a href="/net/rpc/jsonrpc/all_test.go.html#8533755">out</a></span><span class="op" id="8534559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534562">}</span><br>
<span class="lineno"></span><span class="op" id="8534564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8534567">func</span>&nbsp;<span class="ident" id="8534572">TestUnexpectedError</span><span class="op" id="8534591">(</span><span class="ident" id="8534592">t</span>&nbsp;<span class="op" id="8534594">*</span><span class="ident" id="8534595"><a href="/net/rpc/jsonrpc/all_test.go.html#8529350">testing</a></span><span class="op" id="8534602">.</span><span class="ident" id="8534603">T</span><span class="op" id="8534604">)</span>&nbsp;<span class="op" id="8534606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534609">cli</span><span class="op" id="8534612">,</span>&nbsp;<span class="ident" id="8534614">srv</span>&nbsp;<span class="op" id="8534618">:=</span>&nbsp;<span class="ident" id="8534621"><a href="/net/rpc/jsonrpc/all_test.go.html#8534855">myPipe</a></span><span class="op" id="8534627">(</span><span class="op" id="8534628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534631">go</span>&nbsp;<span class="ident" id="8534634"><a href="/net/rpc/jsonrpc/all_test.go.html#8534609">cli</a></span><span class="op" id="8534637">.</span><span class="ident" id="8534638">PipeWriter</span><span class="op" id="8534648">.</span><span class="ident" id="8534649">CloseWithError</span><span class="op" id="8534663">(</span><span class="ident" id="8534664"><a href="/net/rpc/jsonrpc/all_test.go.html#8529285">errors</a></span><span class="op" id="8534670">.</span><span class="ident" id="8534671">New</span><span class="op" id="8534674">(</span><span class="string" id="8534675">&#34;unexpected&nbsp;error!&#34;</span><span class="op" id="8534694">)</span><span class="op" id="8534695">)</span>&nbsp;<span class="comment" id="8534697">//&nbsp;reader&nbsp;will&nbsp;get&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534728"><a href="/net/rpc/jsonrpc/server.go.html#5778055">ServeConn</a></span><span class="op" id="8534737">(</span><span class="ident" id="8534738"><a href="/net/rpc/jsonrpc/all_test.go.html#8534614">srv</a></span><span class="op" id="8534741">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8534794">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8534819">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="8534822">//&nbsp;Copied&nbsp;from&nbsp;package&nbsp;net.</span><br>
<span class="lineno"></span><span class="keyword" id="8534850">func</span>&nbsp;<span class="ident" id="8534855">myPipe</span><span class="op" id="8534861">(</span><span class="op" id="8534862">)</span>&nbsp;<span class="op" id="8534864">(</span><span class="op" id="8534865">*</span><span class="ident" id="8534866"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8534870">,</span>&nbsp;<span class="op" id="8534872">*</span><span class="ident" id="8534873"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8534877">)</span>&nbsp;<span class="op" id="8534879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534882">r1</span><span class="op" id="8534884">,</span>&nbsp;<span class="ident" id="8534886">w1</span>&nbsp;<span class="op" id="8534889">:=</span>&nbsp;<span class="ident" id="8534892"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8534894">.</span><span class="ident" id="8534895">Pipe</span><span class="op" id="8534899">(</span><span class="op" id="8534900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534903">r2</span><span class="op" id="8534905">,</span>&nbsp;<span class="ident" id="8534907">w2</span>&nbsp;<span class="op" id="8534910">:=</span>&nbsp;<span class="ident" id="8534913"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8534915">.</span><span class="ident" id="8534916">Pipe</span><span class="op" id="8534920">(</span><span class="op" id="8534921">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534925">return</span>&nbsp;<span class="op" id="8534932">&amp;</span><span class="ident" id="8534933"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8534937">{</span><span class="ident" id="8534938"><a href="/net/rpc/jsonrpc/all_test.go.html#8534882">r1</a></span><span class="op" id="8534940">,</span>&nbsp;<span class="ident" id="8534942"><a href="/net/rpc/jsonrpc/all_test.go.html#8534907">w2</a></span><span class="op" id="8534944">}</span><span class="op" id="8534945">,</span>&nbsp;<span class="op" id="8534947">&amp;</span><span class="ident" id="8534948"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8534952">{</span><span class="ident" id="8534953"><a href="/net/rpc/jsonrpc/all_test.go.html#8534903">r2</a></span><span class="op" id="8534955">,</span>&nbsp;<span class="ident" id="8534957"><a href="/net/rpc/jsonrpc/all_test.go.html#8534886">w1</a></span><span class="op" id="8534959">}</span><br>
<span class="lineno"></span><span class="op" id="8534961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534964">type</span>&nbsp;<span class="ident" id="8534969">pipe</span>&nbsp;<span class="keyword" id="8534974">struct</span>&nbsp;<span class="op" id="8534981">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534984">*</span><span class="ident" id="8534985"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8534987">.</span><span class="ident" id="8534988">PipeReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535000">*</span><span class="ident" id="8535001"><a href="/net/rpc/jsonrpc/all_test.go.html#8529302">io</a></span><span class="op" id="8535003">.</span><span class="ident" id="8535004">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="8535015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535018">type</span>&nbsp;<span class="ident" id="8535023">pipeAddr</span>&nbsp;<span class="builtintype" id="8535032">int</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8535037">func</span>&nbsp;<span class="op" id="8535042">(</span><span class="ident" id="8535043"><a href="/net/rpc/jsonrpc/all_test.go.html#8535023">pipeAddr</a></span><span class="op" id="8535051">)</span>&nbsp;<span class="ident" id="8535053">Network</span><span class="op" id="8535060">(</span><span class="op" id="8535061">)</span>&nbsp;<span class="builtintype" id="8535063">string</span>&nbsp;<span class="op" id="8535070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535073">return</span>&nbsp;<span class="string" id="8535080">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8535087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="8535090">func</span>&nbsp;<span class="op" id="8535095">(</span><span class="ident" id="8535096"><a href="/net/rpc/jsonrpc/all_test.go.html#8535023">pipeAddr</a></span><span class="op" id="8535104">)</span>&nbsp;<span class="ident" id="8535106">String</span><span class="op" id="8535112">(</span><span class="op" id="8535113">)</span>&nbsp;<span class="builtintype" id="8535115">string</span>&nbsp;<span class="op" id="8535122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535125">return</span>&nbsp;<span class="string" id="8535132">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8535139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535142">func</span>&nbsp;<span class="op" id="8535147">(</span><span class="ident" id="8535148">p</span>&nbsp;<span class="op" id="8535150">*</span><span class="ident" id="8535151"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535155">)</span>&nbsp;<span class="ident" id="8535157">Close</span><span class="op" id="8535162">(</span><span class="op" id="8535163">)</span>&nbsp;<span class="builtintype" id="8535165">error</span>&nbsp;<span class="op" id="8535171">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535174">err</span>&nbsp;<span class="op" id="8535178">:=</span>&nbsp;<span class="ident" id="8535181"><a href="/net/rpc/jsonrpc/all_test.go.html#8535148">p</a></span><span class="op" id="8535182">.</span><span class="ident" id="8535183">PipeReader</span><span class="op" id="8535193">.</span><span class="ident" id="8535194">Close</span><span class="op" id="8535199">(</span><span class="op" id="8535200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535203">err1</span>&nbsp;<span class="op" id="8535208">:=</span>&nbsp;<span class="ident" id="8535211"><a href="/net/rpc/jsonrpc/all_test.go.html#8535148">p</a></span><span class="op" id="8535212">.</span><span class="ident" id="8535213">PipeWriter</span><span class="op" id="8535223">.</span><span class="ident" id="8535224">Close</span><span class="op" id="8535229">(</span><span class="op" id="8535230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535233">if</span>&nbsp;<span class="ident" id="8535236"><a href="/net/rpc/jsonrpc/all_test.go.html#8535174">err</a></span>&nbsp;<span class="op" id="8535240">==</span>&nbsp;<span class="ident" id="8535243">nil</span>&nbsp;<span class="op" id="8535247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535251"><a href="/net/rpc/jsonrpc/all_test.go.html#8535174">err</a></span>&nbsp;<span class="op" id="8535255">=</span>&nbsp;<span class="ident" id="8535257"><a href="/net/rpc/jsonrpc/all_test.go.html#8535203">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535263">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535266">return</span>&nbsp;<span class="ident" id="8535273"><a href="/net/rpc/jsonrpc/all_test.go.html#8535174">err</a></span><br>
<span class="lineno"></span><span class="op" id="8535277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535280">func</span>&nbsp;<span class="op" id="8535285">(</span><span class="ident" id="8535286">p</span>&nbsp;<span class="op" id="8535288">*</span><span class="ident" id="8535289"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535293">)</span>&nbsp;<span class="ident" id="8535295">LocalAddr</span><span class="op" id="8535304">(</span><span class="op" id="8535305">)</span>&nbsp;<span class="ident" id="8535307"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8535310">.</span><span class="ident" id="8535311">Addr</span>&nbsp;<span class="op" id="8535316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535319">return</span>&nbsp;<span class="ident" id="8535326"><a href="/net/rpc/jsonrpc/all_test.go.html#8535023">pipeAddr</a></span><span class="op" id="8535334">(</span><span class="num" id="8535335">0</span><span class="op" id="8535336">)</span><br>
<span class="lineno">280</span><span class="op" id="8535338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535341">func</span>&nbsp;<span class="op" id="8535346">(</span><span class="ident" id="8535347">p</span>&nbsp;<span class="op" id="8535349">*</span><span class="ident" id="8535350"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535354">)</span>&nbsp;<span class="ident" id="8535356">RemoteAddr</span><span class="op" id="8535366">(</span><span class="op" id="8535367">)</span>&nbsp;<span class="ident" id="8535369"><a href="/net/rpc/jsonrpc/all_test.go.html#8529321">net</a></span><span class="op" id="8535372">.</span><span class="ident" id="8535373">Addr</span>&nbsp;<span class="op" id="8535378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535381">return</span>&nbsp;<span class="ident" id="8535388"><a href="/net/rpc/jsonrpc/all_test.go.html#8535023">pipeAddr</a></span><span class="op" id="8535396">(</span><span class="num" id="8535397">0</span><span class="op" id="8535398">)</span><br>
<span class="lineno"></span><span class="op" id="8535400">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="8535403">func</span>&nbsp;<span class="op" id="8535408">(</span><span class="ident" id="8535409">p</span>&nbsp;<span class="op" id="8535411">*</span><span class="ident" id="8535412"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535416">)</span>&nbsp;<span class="ident" id="8535418">SetTimeout</span><span class="op" id="8535428">(</span><span class="ident" id="8535429">nsec</span>&nbsp;<span class="ident" id="8535434">int64</span><span class="op" id="8535439">)</span>&nbsp;<span class="builtintype" id="8535441">error</span>&nbsp;<span class="op" id="8535447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535450">return</span>&nbsp;<span class="ident" id="8535457"><a href="/net/rpc/jsonrpc/all_test.go.html#8529285">errors</a></span><span class="op" id="8535463">.</span><span class="ident" id="8535464">New</span><span class="op" id="8535467">(</span><span class="string" id="8535468">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8535504">)</span><br>
<span class="lineno"></span><span class="op" id="8535506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="8535509">func</span>&nbsp;<span class="op" id="8535514">(</span><span class="ident" id="8535515">p</span>&nbsp;<span class="op" id="8535517">*</span><span class="ident" id="8535518"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535522">)</span>&nbsp;<span class="ident" id="8535524">SetReadTimeout</span><span class="op" id="8535538">(</span><span class="ident" id="8535539">nsec</span>&nbsp;<span class="ident" id="8535544">int64</span><span class="op" id="8535549">)</span>&nbsp;<span class="builtintype" id="8535551">error</span>&nbsp;<span class="op" id="8535557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535560">return</span>&nbsp;<span class="ident" id="8535567"><a href="/net/rpc/jsonrpc/all_test.go.html#8529285">errors</a></span><span class="op" id="8535573">.</span><span class="ident" id="8535574">New</span><span class="op" id="8535577">(</span><span class="string" id="8535578">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8535614">)</span><br>
<span class="lineno"></span><span class="op" id="8535616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535619">func</span>&nbsp;<span class="op" id="8535624">(</span><span class="ident" id="8535625">p</span>&nbsp;<span class="op" id="8535627">*</span><span class="ident" id="8535628"><a href="/net/rpc/jsonrpc/all_test.go.html#8534969">pipe</a></span><span class="op" id="8535632">)</span>&nbsp;<span class="ident" id="8535634">SetWriteTimeout</span><span class="op" id="8535649">(</span><span class="ident" id="8535650">nsec</span>&nbsp;<span class="ident" id="8535655">int64</span><span class="op" id="8535660">)</span>&nbsp;<span class="builtintype" id="8535662">error</span>&nbsp;<span class="op" id="8535668">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535671">return</span>&nbsp;<span class="ident" id="8535678"><a href="/net/rpc/jsonrpc/all_test.go.html#8529285">errors</a></span><span class="op" id="8535684">.</span><span class="ident" id="8535685">New</span><span class="op" id="8535688">(</span><span class="string" id="8535689">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8535725">)</span><br>
<span class="lineno"></span><span class="op" id="8535727">}</span>
</div>
</body>
</html>
