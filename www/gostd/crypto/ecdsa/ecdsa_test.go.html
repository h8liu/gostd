<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7736361">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7736416">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7736470">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7736521">package</span>&nbsp;<span class="ident" id="7736529">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7736536">import</span>&nbsp;<span class="op" id="7736543">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736546">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736555">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736573">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736592">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736607">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736622">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736639">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736656">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736672">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736680">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736686">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736698">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736704">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7736715">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7736725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7736728">func</span>&nbsp;<span class="ident" id="7736733">testKeyGeneration</span><span class="op" id="7736750">(</span><span class="ident" id="7736751">t</span>&nbsp;<span class="op" id="7736753">*</span><span class="ident" id="7736754">testing</span><span class="op" id="7736761">.</span><span class="ident" id="7736762">T</span><span class="op" id="7736763">,</span>&nbsp;<span class="ident" id="7736765">c</span>&nbsp;<span class="ident" id="7736767">elliptic</span><span class="op" id="7736775">.</span><span class="ident" id="7736776">Curve</span><span class="op" id="7736781">,</span>&nbsp;<span class="ident" id="7736783">tag</span>&nbsp;<span class="builtintype" id="7736787">string</span><span class="op" id="7736793">)</span>&nbsp;<span class="op" id="7736795">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7736798">priv</span><span class="op" id="7736802">,</span>&nbsp;<span class="ident" id="7736804">err</span>&nbsp;<span class="op" id="7736808">:=</span>&nbsp;<span class="ident" id="7736811">GenerateKey</span><span class="op" id="7736822">(</span><span class="ident" id="7736823">c</span><span class="op" id="7736824">,</span>&nbsp;<span class="ident" id="7736826">rand</span><span class="op" id="7736830">.</span><span class="ident" id="7736831">Reader</span><span class="op" id="7736837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7736840">if</span>&nbsp;<span class="ident" id="7736843">err</span>&nbsp;<span class="op" id="7736847">!=</span>&nbsp;<span class="ident" id="7736850">nil</span>&nbsp;<span class="op" id="7736854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7736858">t</span><span class="op" id="7736859">.</span><span class="ident" id="7736860">Errorf</span><span class="op" id="7736866">(</span><span class="string" id="7736867">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7736882">,</span>&nbsp;<span class="ident" id="7736884">tag</span><span class="op" id="7736887">,</span>&nbsp;<span class="ident" id="7736889">err</span><span class="op" id="7736892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7736896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7736904">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7736907">if</span>&nbsp;<span class="op" id="7736910">!</span><span class="ident" id="7736911">c</span><span class="op" id="7736912">.</span><span class="ident" id="7736913">IsOnCurve</span><span class="op" id="7736922">(</span><span class="ident" id="7736923">priv</span><span class="op" id="7736927">.</span><span class="ident" id="7736928">PublicKey</span><span class="op" id="7736937">.</span><span class="ident" id="7736938">X</span><span class="op" id="7736939">,</span>&nbsp;<span class="ident" id="7736941">priv</span><span class="op" id="7736945">.</span><span class="ident" id="7736946">PublicKey</span><span class="op" id="7736955">.</span><span class="ident" id="7736956">Y</span><span class="op" id="7736957">)</span>&nbsp;<span class="op" id="7736959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7736963">t</span><span class="op" id="7736964">.</span><span class="ident" id="7736965">Errorf</span><span class="op" id="7736971">(</span><span class="string" id="7736972">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7737000">,</span>&nbsp;<span class="ident" id="7737002">tag</span><span class="op" id="7737005">,</span>&nbsp;<span class="ident" id="7737007">err</span><span class="op" id="7737010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737013">}</span><br>
<span class="lineno"></span><span class="op" id="7737015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7737018">func</span>&nbsp;<span class="ident" id="7737023">TestKeyGeneration</span><span class="op" id="7737040">(</span><span class="ident" id="7737041">t</span>&nbsp;<span class="op" id="7737043">*</span><span class="ident" id="7737044">testing</span><span class="op" id="7737051">.</span><span class="ident" id="7737052">T</span><span class="op" id="7737053">)</span>&nbsp;<span class="op" id="7737055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737058">testKeyGeneration</span><span class="op" id="7737075">(</span><span class="ident" id="7737076">t</span><span class="op" id="7737077">,</span>&nbsp;<span class="ident" id="7737079">elliptic</span><span class="op" id="7737087">.</span><span class="ident" id="7737088">P224</span><span class="op" id="7737092">(</span><span class="op" id="7737093">)</span><span class="op" id="7737094">,</span>&nbsp;<span class="string" id="7737096">&#34;p224&#34;</span><span class="op" id="7737102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737105">if</span>&nbsp;<span class="ident" id="7737108">testing</span><span class="op" id="7737115">.</span><span class="ident" id="7737116">Short</span><span class="op" id="7737121">(</span><span class="op" id="7737122">)</span>&nbsp;<span class="op" id="7737124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737128">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737136">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737139">testKeyGeneration</span><span class="op" id="7737156">(</span><span class="ident" id="7737157">t</span><span class="op" id="7737158">,</span>&nbsp;<span class="ident" id="7737160">elliptic</span><span class="op" id="7737168">.</span><span class="ident" id="7737169">P256</span><span class="op" id="7737173">(</span><span class="op" id="7737174">)</span><span class="op" id="7737175">,</span>&nbsp;<span class="string" id="7737177">&#34;p256&#34;</span><span class="op" id="7737183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737186">testKeyGeneration</span><span class="op" id="7737203">(</span><span class="ident" id="7737204">t</span><span class="op" id="7737205">,</span>&nbsp;<span class="ident" id="7737207">elliptic</span><span class="op" id="7737215">.</span><span class="ident" id="7737216">P384</span><span class="op" id="7737220">(</span><span class="op" id="7737221">)</span><span class="op" id="7737222">,</span>&nbsp;<span class="string" id="7737224">&#34;p384&#34;</span><span class="op" id="7737230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737233">testKeyGeneration</span><span class="op" id="7737250">(</span><span class="ident" id="7737251">t</span><span class="op" id="7737252">,</span>&nbsp;<span class="ident" id="7737254">elliptic</span><span class="op" id="7737262">.</span><span class="ident" id="7737263">P521</span><span class="op" id="7737267">(</span><span class="op" id="7737268">)</span><span class="op" id="7737269">,</span>&nbsp;<span class="string" id="7737271">&#34;p521&#34;</span><span class="op" id="7737277">)</span><br>
<span class="lineno"></span><span class="op" id="7737279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7737282">func</span>&nbsp;<span class="ident" id="7737287">testSignAndVerify</span><span class="op" id="7737304">(</span><span class="ident" id="7737305">t</span>&nbsp;<span class="op" id="7737307">*</span><span class="ident" id="7737308">testing</span><span class="op" id="7737315">.</span><span class="ident" id="7737316">T</span><span class="op" id="7737317">,</span>&nbsp;<span class="ident" id="7737319">c</span>&nbsp;<span class="ident" id="7737321">elliptic</span><span class="op" id="7737329">.</span><span class="ident" id="7737330">Curve</span><span class="op" id="7737335">,</span>&nbsp;<span class="ident" id="7737337">tag</span>&nbsp;<span class="builtintype" id="7737341">string</span><span class="op" id="7737347">)</span>&nbsp;<span class="op" id="7737349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737352">priv</span><span class="op" id="7737356">,</span>&nbsp;<span class="ident" id="7737358">_</span>&nbsp;<span class="op" id="7737360">:=</span>&nbsp;<span class="ident" id="7737363">GenerateKey</span><span class="op" id="7737374">(</span><span class="ident" id="7737375">c</span><span class="op" id="7737376">,</span>&nbsp;<span class="ident" id="7737378">rand</span><span class="op" id="7737382">.</span><span class="ident" id="7737383">Reader</span><span class="op" id="7737389">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737393">hashed</span>&nbsp;<span class="op" id="7737400">:=</span>&nbsp;<span class="op" id="7737403">[</span><span class="op" id="7737404">]</span><span class="builtintype" id="7737405">byte</span><span class="op" id="7737409">(</span><span class="string" id="7737410">&#34;testing&#34;</span><span class="op" id="7737419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737422">r</span><span class="op" id="7737423">,</span>&nbsp;<span class="ident" id="7737425">s</span><span class="op" id="7737426">,</span>&nbsp;<span class="ident" id="7737428">err</span>&nbsp;<span class="op" id="7737432">:=</span>&nbsp;<span class="ident" id="7737435">Sign</span><span class="op" id="7737439">(</span><span class="ident" id="7737440">rand</span><span class="op" id="7737444">.</span><span class="ident" id="7737445">Reader</span><span class="op" id="7737451">,</span>&nbsp;<span class="ident" id="7737453">priv</span><span class="op" id="7737457">,</span>&nbsp;<span class="ident" id="7737459">hashed</span><span class="op" id="7737465">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737468">if</span>&nbsp;<span class="ident" id="7737471">err</span>&nbsp;<span class="op" id="7737475">!=</span>&nbsp;<span class="ident" id="7737478">nil</span>&nbsp;<span class="op" id="7737482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737486">t</span><span class="op" id="7737487">.</span><span class="ident" id="7737488">Errorf</span><span class="op" id="7737494">(</span><span class="string" id="7737495">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7737518">,</span>&nbsp;<span class="ident" id="7737520">tag</span><span class="op" id="7737523">,</span>&nbsp;<span class="ident" id="7737525">err</span><span class="op" id="7737528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737544">if</span>&nbsp;<span class="op" id="7737547">!</span><span class="ident" id="7737548">Verify</span><span class="op" id="7737554">(</span><span class="op" id="7737555">&amp;</span><span class="ident" id="7737556">priv</span><span class="op" id="7737560">.</span><span class="ident" id="7737561">PublicKey</span><span class="op" id="7737570">,</span>&nbsp;<span class="ident" id="7737572">hashed</span><span class="op" id="7737578">,</span>&nbsp;<span class="ident" id="7737580">r</span><span class="op" id="7737581">,</span>&nbsp;<span class="ident" id="7737583">s</span><span class="op" id="7737584">)</span>&nbsp;<span class="op" id="7737586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737590">t</span><span class="op" id="7737591">.</span><span class="ident" id="7737592">Errorf</span><span class="op" id="7737598">(</span><span class="string" id="7737599">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7737618">,</span>&nbsp;<span class="ident" id="7737620">tag</span><span class="op" id="7737623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737630">hashed</span><span class="op" id="7737636">[</span><span class="num" id="7737637">0</span><span class="op" id="7737638">]</span>&nbsp;<span class="op" id="7737640">^=</span>&nbsp;<span class="num" id="7737643">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737649">if</span>&nbsp;<span class="ident" id="7737652">Verify</span><span class="op" id="7737658">(</span><span class="op" id="7737659">&amp;</span><span class="ident" id="7737660">priv</span><span class="op" id="7737664">.</span><span class="ident" id="7737665">PublicKey</span><span class="op" id="7737674">,</span>&nbsp;<span class="ident" id="7737676">hashed</span><span class="op" id="7737682">,</span>&nbsp;<span class="ident" id="7737684">r</span><span class="op" id="7737685">,</span>&nbsp;<span class="ident" id="7737687">s</span><span class="op" id="7737688">)</span>&nbsp;<span class="op" id="7737690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737694">t</span><span class="op" id="7737695">.</span><span class="ident" id="7737696">Errorf</span><span class="op" id="7737702">(</span><span class="string" id="7737703">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7737729">,</span>&nbsp;<span class="ident" id="7737731">tag</span><span class="op" id="7737734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737737">}</span><br>
<span class="lineno"></span><span class="op" id="7737739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7737742">func</span>&nbsp;<span class="ident" id="7737747">TestSignAndVerify</span><span class="op" id="7737764">(</span><span class="ident" id="7737765">t</span>&nbsp;<span class="op" id="7737767">*</span><span class="ident" id="7737768">testing</span><span class="op" id="7737775">.</span><span class="ident" id="7737776">T</span><span class="op" id="7737777">)</span>&nbsp;<span class="op" id="7737779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737782">testSignAndVerify</span><span class="op" id="7737799">(</span><span class="ident" id="7737800">t</span><span class="op" id="7737801">,</span>&nbsp;<span class="ident" id="7737803">elliptic</span><span class="op" id="7737811">.</span><span class="ident" id="7737812">P224</span><span class="op" id="7737816">(</span><span class="op" id="7737817">)</span><span class="op" id="7737818">,</span>&nbsp;<span class="string" id="7737820">&#34;p224&#34;</span><span class="op" id="7737826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737829">if</span>&nbsp;<span class="ident" id="7737832">testing</span><span class="op" id="7737839">.</span><span class="ident" id="7737840">Short</span><span class="op" id="7737845">(</span><span class="op" id="7737846">)</span>&nbsp;<span class="op" id="7737848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7737852">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7737860">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737863">testSignAndVerify</span><span class="op" id="7737880">(</span><span class="ident" id="7737881">t</span><span class="op" id="7737882">,</span>&nbsp;<span class="ident" id="7737884">elliptic</span><span class="op" id="7737892">.</span><span class="ident" id="7737893">P256</span><span class="op" id="7737897">(</span><span class="op" id="7737898">)</span><span class="op" id="7737899">,</span>&nbsp;<span class="string" id="7737901">&#34;p256&#34;</span><span class="op" id="7737907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737910">testSignAndVerify</span><span class="op" id="7737927">(</span><span class="ident" id="7737928">t</span><span class="op" id="7737929">,</span>&nbsp;<span class="ident" id="7737931">elliptic</span><span class="op" id="7737939">.</span><span class="ident" id="7737940">P384</span><span class="op" id="7737944">(</span><span class="op" id="7737945">)</span><span class="op" id="7737946">,</span>&nbsp;<span class="string" id="7737948">&#34;p384&#34;</span><span class="op" id="7737954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7737957">testSignAndVerify</span><span class="op" id="7737974">(</span><span class="ident" id="7737975">t</span><span class="op" id="7737976">,</span>&nbsp;<span class="ident" id="7737978">elliptic</span><span class="op" id="7737986">.</span><span class="ident" id="7737987">P521</span><span class="op" id="7737991">(</span><span class="op" id="7737992">)</span><span class="op" id="7737993">,</span>&nbsp;<span class="string" id="7737995">&#34;p521&#34;</span><span class="op" id="7738001">)</span><br>
<span class="lineno"></span><span class="op" id="7738003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7738006">func</span>&nbsp;<span class="ident" id="7738011">fromHex</span><span class="op" id="7738018">(</span><span class="ident" id="7738019">s</span>&nbsp;<span class="builtintype" id="7738021">string</span><span class="op" id="7738027">)</span>&nbsp;<span class="op" id="7738029">*</span><span class="ident" id="7738030">big</span><span class="op" id="7738033">.</span><span class="ident" id="7738034">Int</span>&nbsp;<span class="op" id="7738038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738041">r</span><span class="op" id="7738042">,</span>&nbsp;<span class="ident" id="7738044">ok</span>&nbsp;<span class="op" id="7738047">:=</span>&nbsp;<span class="builtinfunc" id="7738050">new</span><span class="op" id="7738053">(</span><span class="ident" id="7738054">big</span><span class="op" id="7738057">.</span><span class="ident" id="7738058">Int</span><span class="op" id="7738061">)</span><span class="op" id="7738062">.</span><span class="ident" id="7738063">SetString</span><span class="op" id="7738072">(</span><span class="ident" id="7738073">s</span><span class="op" id="7738074">,</span>&nbsp;<span class="num" id="7738076">16</span><span class="op" id="7738078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738081">if</span>&nbsp;<span class="op" id="7738084">!</span><span class="ident" id="7738085">ok</span>&nbsp;<span class="op" id="7738088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7738092">panic</span><span class="op" id="7738097">(</span><span class="string" id="7738098">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7738107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7738110">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738113">return</span>&nbsp;<span class="ident" id="7738120">r</span><br>
<span class="lineno"></span><span class="op" id="7738122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7738125">func</span>&nbsp;<span class="ident" id="7738130">TestVectors</span><span class="op" id="7738141">(</span><span class="ident" id="7738142">t</span>&nbsp;<span class="op" id="7738144">*</span><span class="ident" id="7738145">testing</span><span class="op" id="7738152">.</span><span class="ident" id="7738153">T</span><span class="op" id="7738154">)</span>&nbsp;<span class="op" id="7738156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738159">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738217">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738298">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738302">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738369">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738422">if</span>&nbsp;<span class="ident" id="7738425">testing</span><span class="op" id="7738432">.</span><span class="ident" id="7738433">Short</span><span class="op" id="7738438">(</span><span class="op" id="7738439">)</span>&nbsp;<span class="op" id="7738441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738445">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7738453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738457">f</span><span class="op" id="7738458">,</span>&nbsp;<span class="ident" id="7738460">err</span>&nbsp;<span class="op" id="7738464">:=</span>&nbsp;<span class="ident" id="7738467">os</span><span class="op" id="7738469">.</span><span class="ident" id="7738470">Open</span><span class="op" id="7738474">(</span><span class="string" id="7738475">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7738500">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738503">if</span>&nbsp;<span class="ident" id="7738506">err</span>&nbsp;<span class="op" id="7738510">!=</span>&nbsp;<span class="ident" id="7738513">nil</span>&nbsp;<span class="op" id="7738517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738521">t</span><span class="op" id="7738522">.</span><span class="ident" id="7738523">Fatal</span><span class="op" id="7738528">(</span><span class="ident" id="7738529">err</span><span class="op" id="7738532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7738535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738539">buf</span>&nbsp;<span class="op" id="7738543">:=</span>&nbsp;<span class="ident" id="7738546">bufio</span><span class="op" id="7738551">.</span><span class="ident" id="7738552">NewReader</span><span class="op" id="7738561">(</span><span class="ident" id="7738562">bzip2</span><span class="op" id="7738567">.</span><span class="ident" id="7738568">NewReader</span><span class="op" id="7738577">(</span><span class="ident" id="7738578">f</span><span class="op" id="7738579">)</span><span class="op" id="7738580">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738584">lineNo</span>&nbsp;<span class="op" id="7738591">:=</span>&nbsp;<span class="num" id="7738594">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738597">var</span>&nbsp;<span class="ident" id="7738601">h</span>&nbsp;<span class="ident" id="7738603">hash</span><span class="op" id="7738607">.</span><span class="ident" id="7738608">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738614">var</span>&nbsp;<span class="ident" id="7738618">msg</span>&nbsp;<span class="op" id="7738622">[</span><span class="op" id="7738623">]</span><span class="builtintype" id="7738624">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738630">var</span>&nbsp;<span class="ident" id="7738634">hashed</span>&nbsp;<span class="op" id="7738641">[</span><span class="op" id="7738642">]</span><span class="builtintype" id="7738643">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738649">var</span>&nbsp;<span class="ident" id="7738653">r</span><span class="op" id="7738654">,</span>&nbsp;<span class="ident" id="7738656">s</span>&nbsp;<span class="op" id="7738658">*</span><span class="ident" id="7738659">big</span><span class="op" id="7738662">.</span><span class="ident" id="7738663">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738668">pub</span>&nbsp;<span class="op" id="7738672">:=</span>&nbsp;<span class="builtinfunc" id="7738675">new</span><span class="op" id="7738678">(</span><span class="ident" id="7738679">PublicKey</span><span class="op" id="7738688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738692">for</span>&nbsp;<span class="op" id="7738696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738700">line</span><span class="op" id="7738704">,</span>&nbsp;<span class="ident" id="7738706">err</span>&nbsp;<span class="op" id="7738710">:=</span>&nbsp;<span class="ident" id="7738713">buf</span><span class="op" id="7738716">.</span><span class="ident" id="7738717">ReadString</span><span class="op" id="7738727">(</span><span class="string" id="7738728">&#39;\n&#39;</span><span class="op" id="7738732">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738736">if</span>&nbsp;<span class="builtinfunc" id="7738739">len</span><span class="op" id="7738742">(</span><span class="ident" id="7738743">line</span><span class="op" id="7738747">)</span>&nbsp;<span class="op" id="7738749">==</span>&nbsp;<span class="num" id="7738752">0</span>&nbsp;<span class="op" id="7738754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738759">if</span>&nbsp;<span class="ident" id="7738762">err</span>&nbsp;<span class="op" id="7738766">==</span>&nbsp;<span class="ident" id="7738769">io</span><span class="op" id="7738771">.</span><span class="ident" id="7738772">EOF</span>&nbsp;<span class="op" id="7738776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738782">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7738791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738796">t</span><span class="op" id="7738797">.</span><span class="ident" id="7738798">Fatalf</span><span class="op" id="7738804">(</span><span class="string" id="7738805">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7738835">,</span>&nbsp;<span class="ident" id="7738837">err</span><span class="op" id="7738840">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7738844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738848">lineNo</span><span class="op" id="7738854">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7738859">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7738910">if</span>&nbsp;<span class="op" id="7738913">!</span><span class="ident" id="7738914">strings</span><span class="op" id="7738921">.</span><span class="ident" id="7738922">HasSuffix</span><span class="op" id="7738931">(</span><span class="ident" id="7738932">line</span><span class="op" id="7738936">,</span>&nbsp;<span class="string" id="7738938">&#34;\r\n&#34;</span><span class="op" id="7738944">)</span>&nbsp;<span class="op" id="7738946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738951">t</span><span class="op" id="7738952">.</span><span class="ident" id="7738953">Fatalf</span><span class="op" id="7738959">(</span><span class="string" id="7738960">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7739006">,</span>&nbsp;<span class="ident" id="7739008">lineNo</span><span class="op" id="7739014">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739022">line</span>&nbsp;<span class="op" id="7739027">=</span>&nbsp;<span class="ident" id="7739029">line</span><span class="op" id="7739033">[</span><span class="op" id="7739034">:</span><span class="builtinfunc" id="7739035">len</span><span class="op" id="7739038">(</span><span class="ident" id="7739039">line</span><span class="op" id="7739043">)</span><span class="op" id="7739044">-</span><span class="num" id="7739045">2</span><span class="op" id="7739046">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739051">if</span>&nbsp;<span class="builtinfunc" id="7739054">len</span><span class="op" id="7739057">(</span><span class="ident" id="7739058">line</span><span class="op" id="7739062">)</span>&nbsp;<span class="op" id="7739064">==</span>&nbsp;<span class="num" id="7739067">0</span>&nbsp;<span class="op" id="7739069">||</span>&nbsp;<span class="ident" id="7739072">line</span><span class="op" id="7739076">[</span><span class="num" id="7739077">0</span><span class="op" id="7739078">]</span>&nbsp;<span class="op" id="7739080">==</span>&nbsp;<span class="string" id="7739083">&#39;#&#39;</span>&nbsp;<span class="op" id="7739087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739092">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739108">if</span>&nbsp;<span class="ident" id="7739111">line</span><span class="op" id="7739115">[</span><span class="num" id="7739116">0</span><span class="op" id="7739117">]</span>&nbsp;<span class="op" id="7739119">==</span>&nbsp;<span class="string" id="7739122">&#39;[&#39;</span>&nbsp;<span class="op" id="7739126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739131">line</span>&nbsp;<span class="op" id="7739136">=</span>&nbsp;<span class="ident" id="7739138">line</span><span class="op" id="7739142">[</span><span class="num" id="7739143">1</span>&nbsp;<span class="op" id="7739145">:</span>&nbsp;<span class="builtinfunc" id="7739147">len</span><span class="op" id="7739150">(</span><span class="ident" id="7739151">line</span><span class="op" id="7739155">)</span><span class="op" id="7739156">-</span><span class="num" id="7739157">1</span><span class="op" id="7739158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739163">parts</span>&nbsp;<span class="op" id="7739169">:=</span>&nbsp;<span class="ident" id="7739172">strings</span><span class="op" id="7739179">.</span><span class="ident" id="7739180">SplitN</span><span class="op" id="7739186">(</span><span class="ident" id="7739187">line</span><span class="op" id="7739191">,</span>&nbsp;<span class="string" id="7739193">&#34;,&#34;</span><span class="op" id="7739196">,</span>&nbsp;<span class="num" id="7739198">2</span><span class="op" id="7739199">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739205">switch</span>&nbsp;<span class="ident" id="7739212">parts</span><span class="op" id="7739217">[</span><span class="num" id="7739218">0</span><span class="op" id="7739219">]</span>&nbsp;<span class="op" id="7739221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739226">case</span>&nbsp;<span class="string" id="7739231">&#34;P-224&#34;</span><span class="op" id="7739238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739244">pub</span><span class="op" id="7739247">.</span><span class="ident" id="7739248">Curve</span>&nbsp;<span class="op" id="7739254">=</span>&nbsp;<span class="ident" id="7739256">elliptic</span><span class="op" id="7739264">.</span><span class="ident" id="7739265">P224</span><span class="op" id="7739269">(</span><span class="op" id="7739270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739275">case</span>&nbsp;<span class="string" id="7739280">&#34;P-256&#34;</span><span class="op" id="7739287">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739293">pub</span><span class="op" id="7739296">.</span><span class="ident" id="7739297">Curve</span>&nbsp;<span class="op" id="7739303">=</span>&nbsp;<span class="ident" id="7739305">elliptic</span><span class="op" id="7739313">.</span><span class="ident" id="7739314">P256</span><span class="op" id="7739318">(</span><span class="op" id="7739319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739324">case</span>&nbsp;<span class="string" id="7739329">&#34;P-384&#34;</span><span class="op" id="7739336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739342">pub</span><span class="op" id="7739345">.</span><span class="ident" id="7739346">Curve</span>&nbsp;<span class="op" id="7739352">=</span>&nbsp;<span class="ident" id="7739354">elliptic</span><span class="op" id="7739362">.</span><span class="ident" id="7739363">P384</span><span class="op" id="7739367">(</span><span class="op" id="7739368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739373">case</span>&nbsp;<span class="string" id="7739378">&#34;P-521&#34;</span><span class="op" id="7739385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739391">pub</span><span class="op" id="7739394">.</span><span class="ident" id="7739395">Curve</span>&nbsp;<span class="op" id="7739401">=</span>&nbsp;<span class="ident" id="7739403">elliptic</span><span class="op" id="7739411">.</span><span class="ident" id="7739412">P521</span><span class="op" id="7739416">(</span><span class="op" id="7739417">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739422">default</span><span class="op" id="7739429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739435">pub</span><span class="op" id="7739438">.</span><span class="ident" id="7739439">Curve</span>&nbsp;<span class="op" id="7739445">=</span>&nbsp;<span class="ident" id="7739447">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739460">switch</span>&nbsp;<span class="ident" id="7739467">parts</span><span class="op" id="7739472">[</span><span class="num" id="7739473">1</span><span class="op" id="7739474">]</span>&nbsp;<span class="op" id="7739476">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739481">case</span>&nbsp;<span class="string" id="7739486">&#34;SHA-1&#34;</span><span class="op" id="7739493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739499">h</span>&nbsp;<span class="op" id="7739501">=</span>&nbsp;<span class="ident" id="7739503">sha1</span><span class="op" id="7739507">.</span><span class="ident" id="7739508">New</span><span class="op" id="7739511">(</span><span class="op" id="7739512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739517">case</span>&nbsp;<span class="string" id="7739522">&#34;SHA-224&#34;</span><span class="op" id="7739531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739537">h</span>&nbsp;<span class="op" id="7739539">=</span>&nbsp;<span class="ident" id="7739541">sha256</span><span class="op" id="7739547">.</span><span class="ident" id="7739548">New224</span><span class="op" id="7739554">(</span><span class="op" id="7739555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739560">case</span>&nbsp;<span class="string" id="7739565">&#34;SHA-256&#34;</span><span class="op" id="7739574">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739580">h</span>&nbsp;<span class="op" id="7739582">=</span>&nbsp;<span class="ident" id="7739584">sha256</span><span class="op" id="7739590">.</span><span class="ident" id="7739591">New</span><span class="op" id="7739594">(</span><span class="op" id="7739595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739600">case</span>&nbsp;<span class="string" id="7739605">&#34;SHA-384&#34;</span><span class="op" id="7739614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739620">h</span>&nbsp;<span class="op" id="7739622">=</span>&nbsp;<span class="ident" id="7739624">sha512</span><span class="op" id="7739630">.</span><span class="ident" id="7739631">New384</span><span class="op" id="7739637">(</span><span class="op" id="7739638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739643">case</span>&nbsp;<span class="string" id="7739648">&#34;SHA-512&#34;</span><span class="op" id="7739657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739663">h</span>&nbsp;<span class="op" id="7739665">=</span>&nbsp;<span class="ident" id="7739667">sha512</span><span class="op" id="7739673">.</span><span class="ident" id="7739674">New</span><span class="op" id="7739677">(</span><span class="op" id="7739678">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739683">default</span><span class="op" id="7739690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739696">h</span>&nbsp;<span class="op" id="7739698">=</span>&nbsp;<span class="ident" id="7739700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739713">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739729">if</span>&nbsp;<span class="ident" id="7739732">h</span>&nbsp;<span class="op" id="7739734">==</span>&nbsp;<span class="ident" id="7739737">nil</span>&nbsp;<span class="op" id="7739741">||</span>&nbsp;<span class="ident" id="7739744">pub</span><span class="op" id="7739747">.</span><span class="ident" id="7739748">Curve</span>&nbsp;<span class="op" id="7739754">==</span>&nbsp;<span class="ident" id="7739757">nil</span>&nbsp;<span class="op" id="7739761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739766">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739777">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739782">switch</span>&nbsp;<span class="op" id="7739789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739793">case</span>&nbsp;<span class="ident" id="7739798">strings</span><span class="op" id="7739805">.</span><span class="ident" id="7739806">HasPrefix</span><span class="op" id="7739815">(</span><span class="ident" id="7739816">line</span><span class="op" id="7739820">,</span>&nbsp;<span class="string" id="7739822">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7739830">)</span><span class="op" id="7739831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739836">if</span>&nbsp;<span class="ident" id="7739839">msg</span><span class="op" id="7739842">,</span>&nbsp;<span class="ident" id="7739844">err</span>&nbsp;<span class="op" id="7739848">=</span>&nbsp;<span class="ident" id="7739850">hex</span><span class="op" id="7739853">.</span><span class="ident" id="7739854">DecodeString</span><span class="op" id="7739866">(</span><span class="ident" id="7739867">line</span><span class="op" id="7739871">[</span><span class="num" id="7739872">6</span><span class="op" id="7739873">:</span><span class="op" id="7739874">]</span><span class="op" id="7739875">)</span><span class="op" id="7739876">;</span>&nbsp;<span class="ident" id="7739878">err</span>&nbsp;<span class="op" id="7739882">!=</span>&nbsp;<span class="ident" id="7739885">nil</span>&nbsp;<span class="op" id="7739889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739895">t</span><span class="op" id="7739896">.</span><span class="ident" id="7739897">Fatalf</span><span class="op" id="7739903">(</span><span class="string" id="7739904">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7739945">,</span>&nbsp;<span class="ident" id="7739947">lineNo</span><span class="op" id="7739953">,</span>&nbsp;<span class="ident" id="7739955">err</span><span class="op" id="7739958">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7739963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7739967">case</span>&nbsp;<span class="ident" id="7739972">strings</span><span class="op" id="7739979">.</span><span class="ident" id="7739980">HasPrefix</span><span class="op" id="7739989">(</span><span class="ident" id="7739990">line</span><span class="op" id="7739994">,</span>&nbsp;<span class="string" id="7739996">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7740003">)</span><span class="op" id="7740004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740009">pub</span><span class="op" id="7740012">.</span><span class="ident" id="7740013">X</span>&nbsp;<span class="op" id="7740015">=</span>&nbsp;<span class="ident" id="7740017">fromHex</span><span class="op" id="7740024">(</span><span class="ident" id="7740025">line</span><span class="op" id="7740029">[</span><span class="num" id="7740030">5</span><span class="op" id="7740031">:</span><span class="op" id="7740032">]</span><span class="op" id="7740033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740037">case</span>&nbsp;<span class="ident" id="7740042">strings</span><span class="op" id="7740049">.</span><span class="ident" id="7740050">HasPrefix</span><span class="op" id="7740059">(</span><span class="ident" id="7740060">line</span><span class="op" id="7740064">,</span>&nbsp;<span class="string" id="7740066">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7740073">)</span><span class="op" id="7740074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740079">pub</span><span class="op" id="7740082">.</span><span class="ident" id="7740083">Y</span>&nbsp;<span class="op" id="7740085">=</span>&nbsp;<span class="ident" id="7740087">fromHex</span><span class="op" id="7740094">(</span><span class="ident" id="7740095">line</span><span class="op" id="7740099">[</span><span class="num" id="7740100">5</span><span class="op" id="7740101">:</span><span class="op" id="7740102">]</span><span class="op" id="7740103">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740107">case</span>&nbsp;<span class="ident" id="7740112">strings</span><span class="op" id="7740119">.</span><span class="ident" id="7740120">HasPrefix</span><span class="op" id="7740129">(</span><span class="ident" id="7740130">line</span><span class="op" id="7740134">,</span>&nbsp;<span class="string" id="7740136">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7740142">)</span><span class="op" id="7740143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740148">r</span>&nbsp;<span class="op" id="7740150">=</span>&nbsp;<span class="ident" id="7740152">fromHex</span><span class="op" id="7740159">(</span><span class="ident" id="7740160">line</span><span class="op" id="7740164">[</span><span class="num" id="7740165">4</span><span class="op" id="7740166">:</span><span class="op" id="7740167">]</span><span class="op" id="7740168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740172">case</span>&nbsp;<span class="ident" id="7740177">strings</span><span class="op" id="7740184">.</span><span class="ident" id="7740185">HasPrefix</span><span class="op" id="7740194">(</span><span class="ident" id="7740195">line</span><span class="op" id="7740199">,</span>&nbsp;<span class="string" id="7740201">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7740207">)</span><span class="op" id="7740208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740213">s</span>&nbsp;<span class="op" id="7740215">=</span>&nbsp;<span class="ident" id="7740217">fromHex</span><span class="op" id="7740224">(</span><span class="ident" id="7740225">line</span><span class="op" id="7740229">[</span><span class="num" id="7740230">4</span><span class="op" id="7740231">:</span><span class="op" id="7740232">]</span><span class="op" id="7740233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740237">case</span>&nbsp;<span class="ident" id="7740242">strings</span><span class="op" id="7740249">.</span><span class="ident" id="7740250">HasPrefix</span><span class="op" id="7740259">(</span><span class="ident" id="7740260">line</span><span class="op" id="7740264">,</span>&nbsp;<span class="string" id="7740266">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7740277">)</span><span class="op" id="7740278">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740283">expected</span>&nbsp;<span class="op" id="7740292">:=</span>&nbsp;<span class="ident" id="7740295">line</span><span class="op" id="7740299">[</span><span class="num" id="7740300">9</span><span class="op" id="7740301">]</span>&nbsp;<span class="op" id="7740303">==</span>&nbsp;<span class="string" id="7740306">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740313">h</span><span class="op" id="7740314">.</span><span class="ident" id="7740315">Reset</span><span class="op" id="7740320">(</span><span class="op" id="7740321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740326">h</span><span class="op" id="7740327">.</span><span class="ident" id="7740328">Write</span><span class="op" id="7740333">(</span><span class="ident" id="7740334">msg</span><span class="op" id="7740337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740342">hashed</span>&nbsp;<span class="op" id="7740349">:=</span>&nbsp;<span class="ident" id="7740352">h</span><span class="op" id="7740353">.</span><span class="ident" id="7740354">Sum</span><span class="op" id="7740357">(</span><span class="ident" id="7740358">hashed</span><span class="op" id="7740364">[</span><span class="op" id="7740365">:</span><span class="num" id="7740366">0</span><span class="op" id="7740367">]</span><span class="op" id="7740368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740373">if</span>&nbsp;<span class="ident" id="7740376">Verify</span><span class="op" id="7740382">(</span><span class="ident" id="7740383">pub</span><span class="op" id="7740386">,</span>&nbsp;<span class="ident" id="7740388">hashed</span><span class="op" id="7740394">,</span>&nbsp;<span class="ident" id="7740396">r</span><span class="op" id="7740397">,</span>&nbsp;<span class="ident" id="7740399">s</span><span class="op" id="7740400">)</span>&nbsp;<span class="op" id="7740402">!=</span>&nbsp;<span class="ident" id="7740405">expected</span>&nbsp;<span class="op" id="7740414">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740420">t</span><span class="op" id="7740421">.</span><span class="ident" id="7740422">Fatalf</span><span class="op" id="7740428">(</span><span class="string" id="7740429">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7740458">,</span>&nbsp;<span class="ident" id="7740460">lineNo</span><span class="op" id="7740466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7740471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7740475">default</span><span class="op" id="7740482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740487">t</span><span class="op" id="7740488">.</span><span class="ident" id="7740489">Fatalf</span><span class="op" id="7740495">(</span><span class="string" id="7740496">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7740529">,</span>&nbsp;<span class="ident" id="7740531">lineNo</span><span class="op" id="7740537">,</span>&nbsp;<span class="ident" id="7740539">line</span><span class="op" id="7740543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7740547">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7740550">}</span><br>
<span class="lineno"></span><span class="op" id="7740552">}</span>
</div>
</body>
</html>
