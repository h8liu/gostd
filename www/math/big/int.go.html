<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;signed&nbsp;multi-precision&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">package</span>&nbsp;<span class="ident">big</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">import</span>&nbsp;<span class="op">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;strings&#34;</span><br>
<span class="lineno">15</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;An&nbsp;Int&nbsp;represents&nbsp;a&nbsp;signed&nbsp;multi-precision&nbsp;integer.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;an&nbsp;Int&nbsp;represents&nbsp;the&nbsp;value&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">Int</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="comment">//&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">abs</span>&nbsp;<span class="ident">nat</span>&nbsp;&nbsp;<span class="comment">//&nbsp;absolute&nbsp;value&nbsp;of&nbsp;the&nbsp;integer</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">intOne</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">&amp;</span><span class="ident">Int</span><span class="op">{</span><span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Sign&nbsp;returns:</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-1&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;0&nbsp;if&nbsp;x&nbsp;==&nbsp;0</span><br>
<span class="lineno">30</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp+1&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Sign</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">-</span><span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">1</span><br>
<span class="lineno">40</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetInt64&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetInt64</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">setUint64</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetUint64&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">55</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetUint64</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">uint64</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">setUint64</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;NewInt&nbsp;allocates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;Int&nbsp;set&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">NewInt</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Set&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Set</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">set</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment">//&nbsp;Bits&nbsp;provides&nbsp;raw&nbsp;(unchecked&nbsp;but&nbsp;fast)&nbsp;access&nbsp;to&nbsp;x&nbsp;by&nbsp;returning&nbsp;its</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;absolute&nbsp;value&nbsp;as&nbsp;a&nbsp;little-endian&nbsp;Word&nbsp;slice.&nbsp;The&nbsp;result&nbsp;and&nbsp;x&nbsp;share</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;same&nbsp;underlying&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Bits&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;implementation&nbsp;of&nbsp;missing&nbsp;low-level&nbsp;Int</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;functionality&nbsp;outside&nbsp;this&nbsp;package;&nbsp;it&nbsp;should&nbsp;be&nbsp;avoided&nbsp;otherwise.</span><br>
<span class="lineno">80</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Bits</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Word</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBits&nbsp;provides&nbsp;raw&nbsp;(unchecked&nbsp;but&nbsp;fast)&nbsp;access&nbsp;to&nbsp;z&nbsp;by&nbsp;setting&nbsp;its</span><br>
<span class="lineno">85</span><span class="comment">//&nbsp;value&nbsp;to&nbsp;abs,&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;little-endian&nbsp;Word&nbsp;slice,&nbsp;and&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;z.&nbsp;The&nbsp;result&nbsp;and&nbsp;abs&nbsp;share&nbsp;the&nbsp;same&nbsp;underlying&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBits&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;implementation&nbsp;of&nbsp;missing&nbsp;low-level&nbsp;Int</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;functionality&nbsp;outside&nbsp;this&nbsp;package;&nbsp;it&nbsp;should&nbsp;be&nbsp;avoided&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetBits</span><span class="op">(</span><span class="ident">abs</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">Word</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">abs</span><span class="op">)</span><span class="op">.</span><span class="ident">norm</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment">//&nbsp;Abs&nbsp;sets&nbsp;z&nbsp;to&nbsp;|x|&nbsp;(the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;x)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Abs</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">100</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Neg&nbsp;sets&nbsp;z&nbsp;to&nbsp;-x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Neg</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="op">!</span><span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Add&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;sum&nbsp;x+y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">110</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Add</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;+&nbsp;y&nbsp;==&nbsp;x&nbsp;+&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;+&nbsp;(-y)&nbsp;==&nbsp;-(x&nbsp;+&nbsp;y)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;+&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;-&nbsp;y&nbsp;==&nbsp;-(y&nbsp;-&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;+&nbsp;y&nbsp;==&nbsp;y&nbsp;-&nbsp;x&nbsp;==&nbsp;-(x&nbsp;-&nbsp;y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">cmp</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">!</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment">//&nbsp;Sub&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;difference&nbsp;x-y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Sub</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;-&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;+&nbsp;y</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;-&nbsp;y&nbsp;==&nbsp;-(x&nbsp;+&nbsp;y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;-&nbsp;y&nbsp;==&nbsp;x&nbsp;-&nbsp;y&nbsp;==&nbsp;-(y&nbsp;-&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;-&nbsp;(-y)&nbsp;==&nbsp;y&nbsp;-&nbsp;x&nbsp;==&nbsp;-(x&nbsp;-&nbsp;y)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">cmp</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">!</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Mul&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;product&nbsp;x*y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Mul</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;*&nbsp;y&nbsp;==&nbsp;x&nbsp;*&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;*&nbsp;(-y)&nbsp;==&nbsp;-(x&nbsp;*&nbsp;y)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;*&nbsp;y&nbsp;==&nbsp;-(x&nbsp;*&nbsp;y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;*&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;*&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">mul</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">160</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;MulRange&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;product&nbsp;of&nbsp;all&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[a,&nbsp;b]&nbsp;inclusively&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;a&nbsp;&gt;&nbsp;b&nbsp;(empty&nbsp;range),&nbsp;the&nbsp;result&nbsp;is&nbsp;1.</span><br>
<span class="lineno">165</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">MulRange</span><span class="op">(</span><span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">a</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">b</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;empty&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">a</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">0</span><span class="op">:</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;range&nbsp;includes&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;a&nbsp;&lt;=&nbsp;b&nbsp;&amp;&amp;&nbsp;(b&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;a&nbsp;&gt;&nbsp;0)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">a</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="ident">b</span><span class="op">-</span><span class="ident">a</span><span class="op">)</span><span class="op">&amp;</span><span class="num">1</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">b</span><span class="op">,</span>&nbsp;<span class="op">-</span><span class="ident">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">mulRange</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">a</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">b</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment">//&nbsp;Binomial&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;binomial&nbsp;coefficient&nbsp;of&nbsp;(n,&nbsp;k)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Binomial</span><span class="op">(</span><span class="ident">n</span><span class="op">,</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="ident">int64</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="ident">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">a</span><span class="op">.</span><span class="ident">MulRange</span><span class="op">(</span><span class="ident">n</span><span class="op">-</span><span class="ident">k</span><span class="op">+</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span><span class="op">.</span><span class="ident">MulRange</span><span class="op">(</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">Quo</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">a</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Quo&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;quotient&nbsp;x/y&nbsp;for&nbsp;y&nbsp;!=&nbsp;0&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno">195</span><span class="comment">//&nbsp;Quo&nbsp;implements&nbsp;truncated&nbsp;division&nbsp;(like&nbsp;Go);&nbsp;see&nbsp;QuoRem&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Quo</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">div</span><span class="op">(</span><span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">200</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Rem&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;remainder&nbsp;x%y&nbsp;for&nbsp;y&nbsp;!=&nbsp;0&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Rem&nbsp;implements&nbsp;truncated&nbsp;modulus&nbsp;(like&nbsp;Go);&nbsp;see&nbsp;QuoRem&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno">205</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Rem</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">div</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;QuoRem&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;quotient&nbsp;x/y&nbsp;and&nbsp;r&nbsp;to&nbsp;the&nbsp;remainder&nbsp;x%y</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;pair&nbsp;(z,&nbsp;r)&nbsp;for&nbsp;y&nbsp;!=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">215</span><span class="comment">//&nbsp;QuoRem&nbsp;implements&nbsp;T-division&nbsp;and&nbsp;modulus&nbsp;(like&nbsp;Go):</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspq&nbsp;=&nbsp;x/y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;result&nbsp;truncated&nbsp;to&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspr&nbsp;=&nbsp;x&nbsp;-&nbsp;y*q</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">220</span><span class="comment">//&nbsp;(See&nbsp;Daan&nbsp;Leijen,&nbsp;``Division&nbsp;and&nbsp;Modulus&nbsp;for&nbsp;Computer&nbsp;Scientists&#39;&#39;.)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;DivMod&nbsp;for&nbsp;Euclidean&nbsp;division&nbsp;and&nbsp;modulus&nbsp;(unlike&nbsp;Go).</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">QuoRem</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">r</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">r</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">div</span><span class="op">(</span><span class="ident">r</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span><span class="op">,</span>&nbsp;<span class="ident">r</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">r</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">r</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Div&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;quotient&nbsp;x/y&nbsp;for&nbsp;y&nbsp;!=&nbsp;0&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">230</span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Div&nbsp;implements&nbsp;Euclidean&nbsp;division&nbsp;(unlike&nbsp;Go);&nbsp;see&nbsp;DivMod&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Div</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y_neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;may&nbsp;be&nbsp;an&nbsp;alias&nbsp;for&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">r</span>&nbsp;<span class="ident">Int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">QuoRem</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">r</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">y_neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">intOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Sub</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">intOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Mod&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;modulus&nbsp;x%y&nbsp;for&nbsp;y&nbsp;!=&nbsp;0&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Mod&nbsp;implements&nbsp;Euclidean&nbsp;modulus&nbsp;(unlike&nbsp;Go);&nbsp;see&nbsp;DivMod&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Mod</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y0</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="comment">//&nbsp;save&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">alias</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y0</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">y</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">q</span>&nbsp;<span class="ident">Int</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span><span class="op">.</span><span class="ident">QuoRem</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">y0</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Sub</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">y0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">y0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;DivMod&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;quotient&nbsp;x&nbsp;div&nbsp;y&nbsp;and&nbsp;m&nbsp;to&nbsp;the&nbsp;modulus&nbsp;x&nbsp;mod&nbsp;y</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;pair&nbsp;(z,&nbsp;m)&nbsp;for&nbsp;y&nbsp;!=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">270</span><span class="comment">//&nbsp;DivMod&nbsp;implements&nbsp;Euclidean&nbsp;division&nbsp;and&nbsp;modulus&nbsp;(unlike&nbsp;Go):</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspq&nbsp;=&nbsp;x&nbsp;div&nbsp;y&nbsp;&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspm&nbsp;=&nbsp;x&nbsp;-&nbsp;y*q&nbsp;&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;m&nbsp;&lt;&nbsp;|q|</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">275</span><span class="comment">//&nbsp;(See&nbsp;Raymond&nbsp;T.&nbsp;Boute,&nbsp;``The&nbsp;Euclidean&nbsp;definition&nbsp;of&nbsp;the&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;div&nbsp;and&nbsp;mod&#39;&#39;.&nbsp;ACM&nbsp;Transactions&nbsp;on&nbsp;Programming&nbsp;Languages&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Systems&nbsp;(TOPLAS),&nbsp;14(2):127-144,&nbsp;New&nbsp;York,&nbsp;NY,&nbsp;USA,&nbsp;4/1992.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;ACM&nbsp;press.)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;QuoRem&nbsp;for&nbsp;T-division&nbsp;and&nbsp;modulus&nbsp;(like&nbsp;Go).</span><br>
<span class="lineno">280</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">DivMod</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y0</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="comment">//&nbsp;save&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">alias</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y0</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">y</span><span class="op">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">QuoRem</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">m</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">y0</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">intOne</span><span class="op">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span><span class="op">.</span><span class="ident">Sub</span><span class="op">(</span><span class="ident">m</span><span class="op">,</span>&nbsp;<span class="ident">y0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Sub</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">intOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">m</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">m</span><span class="op">,</span>&nbsp;<span class="ident">y0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">m</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Cmp&nbsp;compares&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;returns:</span><br>
<span class="lineno">300</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;-1&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;if&nbsp;x&nbsp;==&nbsp;y</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;+1&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">305</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Cmp</span><span class="op">(</span><span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">r</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;cmp&nbsp;y&nbsp;==&nbsp;x&nbsp;cmp&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;cmp&nbsp;(-y)&nbsp;==&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;cmp&nbsp;y&nbsp;==&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;cmp&nbsp;(-y)&nbsp;==&nbsp;-(x&nbsp;cmp&nbsp;y)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">cmp</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">r</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;-&#34;</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">decimalString</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">decimalString</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">charset</span><span class="op">(</span><span class="ident">ch</span>&nbsp;<span class="builtintype">rune</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;b&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">lowercaseDigits</span><span class="op">[</span><span class="num">0</span><span class="op">:</span><span class="num">2</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;o&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">lowercaseDigits</span><span class="op">[</span><span class="num">0</span><span class="op">:</span><span class="num">8</span><span class="op">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;d&#39;</span><span class="op">,</span>&nbsp;<span class="string">&#39;s&#39;</span><span class="op">,</span>&nbsp;<span class="string">&#39;v&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">lowercaseDigits</span><span class="op">[</span><span class="num">0</span><span class="op">:</span><span class="num">10</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;x&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">lowercaseDigits</span><span class="op">[</span><span class="num">0</span><span class="op">:</span><span class="num">16</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;X&#39;</span><span class="op">:</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">uppercaseDigits</span><span class="op">[</span><span class="num">0</span><span class="op">:</span><span class="num">16</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="comment">//&nbsp;unknown&nbsp;format</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment">//&nbsp;write&nbsp;count&nbsp;copies&nbsp;of&nbsp;text&nbsp;to&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">State</span><span class="op">,</span>&nbsp;<span class="ident">text</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">count</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">text</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="ident">text</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">count</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">count</span><span class="op">--</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">Write</span><span class="op">(</span><span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment">//&nbsp;Format&nbsp;is&nbsp;a&nbsp;support&nbsp;routine&nbsp;for&nbsp;fmt.Formatter.&nbsp;It&nbsp;accepts</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;formats&nbsp;&#39;b&#39;&nbsp;(binary),&nbsp;&#39;o&#39;&nbsp;(octal),&nbsp;&#39;d&#39;&nbsp;(decimal),&nbsp;&#39;x&#39;</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;(lowercase&nbsp;hexadecimal),&nbsp;and&nbsp;&#39;X&#39;&nbsp;(uppercase&nbsp;hexadecimal).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Also&nbsp;supported&nbsp;are&nbsp;the&nbsp;full&nbsp;suite&nbsp;of&nbsp;package&nbsp;fmt&#39;s&nbsp;format</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;verbs&nbsp;for&nbsp;integral&nbsp;types,&nbsp;including&nbsp;&#39;+&#39;,&nbsp;&#39;-&#39;,&nbsp;and&nbsp;&#39;&nbsp;&#39;</span><br>
<span class="lineno">365</span><span class="comment">//&nbsp;for&nbsp;sign&nbsp;control,&nbsp;&#39;#&#39;&nbsp;for&nbsp;leading&nbsp;zero&nbsp;in&nbsp;octal&nbsp;and&nbsp;for</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;hexadecimal,&nbsp;a&nbsp;leading&nbsp;&#34;0x&#34;&nbsp;or&nbsp;&#34;0X&#34;&nbsp;for&nbsp;&#34;%#x&#34;&nbsp;and&nbsp;&#34;%#X&#34;</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;respectively,&nbsp;specification&nbsp;of&nbsp;minimum&nbsp;digits&nbsp;precision,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;output&nbsp;field&nbsp;width,&nbsp;space&nbsp;or&nbsp;zero&nbsp;padding,&nbsp;and&nbsp;left&nbsp;or</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;right&nbsp;justification.</span><br>
<span class="lineno">370</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Format</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">State</span><span class="op">,</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="builtintype">rune</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">cs</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">charset</span><span class="op">(</span><span class="ident">ch</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">cs</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;unknown&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fmt</span><span class="op">.</span><span class="ident">Fprintf</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="string">&#34;%%!%c(big.Int=%s)&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ch</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">fmt</span><span class="op">.</span><span class="ident">Fprint</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="string">&#34;&lt;nil&gt;&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;sign&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="string">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;-&#34;</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Flag</span><span class="op">(</span><span class="string">&#39;+&#39;</span><span class="op">)</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;supersedes&nbsp;&#39;&nbsp;&#39;&nbsp;when&nbsp;both&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;+&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Flag</span><span class="op">(</span><span class="string">&#39;&nbsp;&#39;</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;prefix&nbsp;characters&nbsp;for&nbsp;indicating&nbsp;output&nbsp;base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">prefix</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="string">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Flag</span><span class="op">(</span><span class="string">&#39;#&#39;</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;o&#39;</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;octal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">prefix</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;x&#39;</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;hexadecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">prefix</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;0x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;X&#39;</span><span class="op">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">prefix</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;0X&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;digits&nbsp;with&nbsp;base&nbsp;set&nbsp;by&nbsp;len(cs)&nbsp;and&nbsp;digit&nbsp;characters&nbsp;from&nbsp;cs</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">digits</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="builtintype">string</span><span class="op">(</span><span class="ident">cs</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;number&nbsp;of&nbsp;characters&nbsp;for&nbsp;the&nbsp;three&nbsp;classes&nbsp;of&nbsp;number&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">left</span>&nbsp;<span class="builtintype">int</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;space&nbsp;characters&nbsp;to&nbsp;left&nbsp;of&nbsp;digits&nbsp;for&nbsp;right&nbsp;justification&nbsp;(&#34;%8d&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">zeroes</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="comment">//&nbsp;zero&nbsp;characters&nbsp;(actually&nbsp;cs[0])&nbsp;as&nbsp;left-most&nbsp;digits&nbsp;(&#34;%.8d&#34;)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">right</span>&nbsp;<span class="builtintype">int</span>&nbsp;&nbsp;<span class="comment">//&nbsp;space&nbsp;characters&nbsp;to&nbsp;right&nbsp;of&nbsp;digits&nbsp;for&nbsp;left&nbsp;justification&nbsp;(&#34;%-8d&#34;)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;number&nbsp;padding&nbsp;from&nbsp;precision:&nbsp;the&nbsp;least&nbsp;number&nbsp;of&nbsp;digits&nbsp;to&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">precision</span><span class="op">,</span>&nbsp;<span class="ident">precisionSet</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Precision</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">precisionSet</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">digits</span><span class="op">)</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">precision</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zeroes</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">precision</span>&nbsp;<span class="op">-</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">digits</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;count&nbsp;of&nbsp;zero&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">digits</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;0&#34;</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">precision</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="comment">//&nbsp;print&nbsp;nothing&nbsp;if&nbsp;zero&nbsp;value&nbsp;(x&nbsp;==&nbsp;0)&nbsp;and&nbsp;zero&nbsp;precision&nbsp;(&#34;.&#34;&nbsp;or&nbsp;&#34;.0&#34;)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;field&nbsp;pad&nbsp;from&nbsp;width:&nbsp;the&nbsp;least&nbsp;number&nbsp;of&nbsp;characters&nbsp;to&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">length</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">sign</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">prefix</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">zeroes</span>&nbsp;<span class="op">+</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">digits</span><span class="op">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">width</span><span class="op">,</span>&nbsp;<span class="ident">widthSet</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Width</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">widthSet</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">length</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">width</span>&nbsp;<span class="op">{</span>&nbsp;<span class="comment">//&nbsp;pad&nbsp;as&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">d</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">width</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">length</span><span class="op">;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Flag</span><span class="op">(</span><span class="string">&#39;-&#39;</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;pad&nbsp;on&nbsp;the&nbsp;right&nbsp;with&nbsp;spaces;&nbsp;supersedes&nbsp;&#39;0&#39;&nbsp;when&nbsp;both&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">right</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">d</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">s</span><span class="op">.</span><span class="ident">Flag</span><span class="op">(</span><span class="string">&#39;0&#39;</span><span class="op">)</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="op">!</span><span class="ident">precisionSet</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;pad&nbsp;with&nbsp;zeroes&nbsp;unless&nbsp;precision&nbsp;also&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zeroes</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;pad&nbsp;on&nbsp;the&nbsp;left&nbsp;with&nbsp;spaces</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">left</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;print&nbsp;number&nbsp;as&nbsp;[left&nbsp;pad][sign][prefix][zero&nbsp;pad][digits][right&nbsp;pad]</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="string">&#34;&nbsp;&#34;</span><span class="op">,</span>&nbsp;<span class="ident">left</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">sign</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">prefix</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="string">&#34;0&#34;</span><span class="op">,</span>&nbsp;<span class="ident">zeroes</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">digits</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">writeMultiple</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="string">&#34;&nbsp;&#34;</span><span class="op">,</span>&nbsp;<span class="ident">right</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;scan&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;integer&nbsp;value&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;longest&nbsp;possible&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;read&nbsp;from&nbsp;r&nbsp;representing&nbsp;a&nbsp;signed&nbsp;integer&nbsp;number&nbsp;in&nbsp;a&nbsp;given&nbsp;conversion&nbsp;base.</span><br>
<span class="lineno">455</span><span class="comment">//&nbsp;It&nbsp;returns&nbsp;z,&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base&nbsp;used,&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;In&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;error&nbsp;case,&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;undefined&nbsp;but&nbsp;the&nbsp;returned&nbsp;value&nbsp;is&nbsp;nil.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;syntax&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;of&nbsp;integer&nbsp;literals&nbsp;in&nbsp;Go.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;base&nbsp;argument&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;a&nbsp;value&nbsp;from&nbsp;2&nbsp;through&nbsp;MaxBase.&nbsp;If&nbsp;the&nbsp;base</span><br>
<span class="lineno">460</span><span class="comment">//&nbsp;is&nbsp;0,&nbsp;the&nbsp;string&nbsp;prefix&nbsp;determines&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base.&nbsp;A&nbsp;prefix&nbsp;of</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;``0x&#39;&#39;&nbsp;or&nbsp;``0X&#39;&#39;&nbsp;selects&nbsp;base&nbsp;16;&nbsp;the&nbsp;``0&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;8,&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;``0b&#39;&#39;&nbsp;or&nbsp;``0B&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;2.&nbsp;Otherwise&nbsp;the&nbsp;selected&nbsp;base&nbsp;is&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">scan</span><span class="op">(</span><span class="ident">r</span>&nbsp;<span class="ident">io</span><span class="op">.</span><span class="ident">RuneScanner</span><span class="op">,</span>&nbsp;<span class="ident">base</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="builtintype">int</span><span class="op">,</span>&nbsp;<span class="builtintype">error</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ch</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">r</span><span class="op">.</span><span class="ident">ReadRune</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="ident">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;-&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;+&#39;</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span><span class="op">.</span><span class="ident">UnreadRune</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;mantissa</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">scan</span><span class="op">(</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">,</span>&nbsp;<span class="ident">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Scan&nbsp;is&nbsp;a&nbsp;support&nbsp;routine&nbsp;for&nbsp;fmt.Scanner;&nbsp;it&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;value&nbsp;of</span><br>
<span class="lineno">490</span><span class="comment">//&nbsp;the&nbsp;scanned&nbsp;number.&nbsp;It&nbsp;accepts&nbsp;the&nbsp;formats&nbsp;&#39;b&#39;&nbsp;(binary),&nbsp;&#39;o&#39;&nbsp;(octal),</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&#39;d&#39;&nbsp;(decimal),&nbsp;&#39;x&#39;&nbsp;(lowercase&nbsp;hexadecimal),&nbsp;and&nbsp;&#39;X&#39;&nbsp;(uppercase&nbsp;hexadecimal).</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Scan</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">ScanState</span><span class="op">,</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="builtintype">rune</span><span class="op">)</span>&nbsp;<span class="builtintype">error</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">.</span><span class="ident">SkipSpace</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;skip&nbsp;leading&nbsp;space&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="ident">ch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;b&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;o&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">8</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;d&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;x&#39;</span><span class="op">,</span>&nbsp;<span class="string">&#39;X&#39;</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">base</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="string">&#39;s&#39;</span><span class="op">,</span>&nbsp;<span class="string">&#39;v&#39;</span><span class="op">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;let&nbsp;scan&nbsp;determine&nbsp;the&nbsp;base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">errors</span><span class="op">.</span><span class="ident">New</span><span class="op">(</span><span class="string">&#34;Int.Scan:&nbsp;invalid&nbsp;verb&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">scan</span><span class="op">(</span><span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">err</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;low32&nbsp;returns&nbsp;the&nbsp;least&nbsp;significant&nbsp;32&nbsp;bits&nbsp;of&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">low32</span><span class="op">(</span><span class="ident">z</span>&nbsp;<span class="ident">nat</span><span class="op">)</span>&nbsp;<span class="builtintype">uint32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">z</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;low64&nbsp;returns&nbsp;the&nbsp;least&nbsp;significant&nbsp;64&nbsp;bits&nbsp;of&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">low64</span><span class="op">(</span><span class="ident">z</span>&nbsp;<span class="ident">nat</span><span class="op">)</span>&nbsp;<span class="ident">uint64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">z</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">_W</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">32</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">z</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Int64&nbsp;returns&nbsp;the&nbsp;int64&nbsp;representation&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;in&nbsp;an&nbsp;int64,&nbsp;the&nbsp;result&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">535</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Int64</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">int64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">int64</span><span class="op">(</span><span class="ident">low64</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Uint64&nbsp;returns&nbsp;the&nbsp;uint64&nbsp;representation&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;x&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;in&nbsp;a&nbsp;uint64,&nbsp;the&nbsp;result&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">545</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Uint64</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="ident">uint64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">low64</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetString&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;value&nbsp;of&nbsp;s,&nbsp;interpreted&nbsp;in&nbsp;the&nbsp;given&nbsp;base,</span><br>
<span class="lineno">550</span><span class="comment">//&nbsp;and&nbsp;returns&nbsp;z&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;success.&nbsp;If&nbsp;SetString&nbsp;fails,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;undefined&nbsp;but&nbsp;the&nbsp;returned&nbsp;value&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;base&nbsp;argument&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;a&nbsp;value&nbsp;from&nbsp;2&nbsp;through&nbsp;MaxBase.&nbsp;If&nbsp;the&nbsp;base</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;is&nbsp;0,&nbsp;the&nbsp;string&nbsp;prefix&nbsp;determines&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base.&nbsp;A&nbsp;prefix&nbsp;of</span><br>
<span class="lineno">555</span><span class="comment">//&nbsp;``0x&#39;&#39;&nbsp;or&nbsp;``0X&#39;&#39;&nbsp;selects&nbsp;base&nbsp;16;&nbsp;the&nbsp;``0&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;8,&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;``0b&#39;&#39;&nbsp;or&nbsp;``0B&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;2.&nbsp;Otherwise&nbsp;the&nbsp;selected&nbsp;base&nbsp;is&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetString</span><span class="op">(</span><span class="ident">s</span>&nbsp;<span class="builtintype">string</span><span class="op">,</span>&nbsp;<span class="ident">base</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="builtintype">bool</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">strings</span><span class="op">.</span><span class="ident">NewReader</span><span class="op">(</span><span class="ident">s</span><span class="op">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">scan</span><span class="op">(</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="ident">base</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">r</span><span class="op">.</span><span class="ident">ReadRune</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">io</span><span class="op">.</span><span class="ident">EOF</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;err&nbsp;==&nbsp;io.EOF&nbsp;=&gt;&nbsp;scan&nbsp;consumed&nbsp;all&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBytes&nbsp;interprets&nbsp;buf&nbsp;as&nbsp;the&nbsp;bytes&nbsp;of&nbsp;a&nbsp;big-endian&nbsp;unsigned</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;integer,&nbsp;sets&nbsp;z&nbsp;to&nbsp;that&nbsp;value,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetBytes</span><span class="op">(</span><span class="ident">buf</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">setBytes</span><span class="op">(</span><span class="ident">buf</span><span class="op">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;x&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno">580</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Bytes</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">buf</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">*</span><span class="ident">_S</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">buf</span><span class="op">[</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">bytes</span><span class="op">(</span><span class="ident">buf</span><span class="op">)</span><span class="op">:</span><span class="op">]</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment">//&nbsp;BitLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;x&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;bit&nbsp;length&nbsp;of&nbsp;0&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">BitLen</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">bitLen</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Exp&nbsp;sets&nbsp;z&nbsp;=&nbsp;x**y&nbsp;mod&nbsp;|m|&nbsp;(i.e.&nbsp;the&nbsp;sign&nbsp;of&nbsp;m&nbsp;is&nbsp;ignored),&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;y&nbsp;&lt;=&nbsp;0,&nbsp;the&nbsp;result&nbsp;is&nbsp;1&nbsp;mod&nbsp;|m|;&nbsp;if&nbsp;m&nbsp;==&nbsp;nil&nbsp;or&nbsp;m&nbsp;==&nbsp;0,&nbsp;z&nbsp;=&nbsp;x**y.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;Knuth,&nbsp;volume&nbsp;2,&nbsp;section&nbsp;4.6.3.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Exp</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">yWords</span>&nbsp;<span class="ident">nat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yWords</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;y&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">mWords</span>&nbsp;<span class="ident">nat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mWords</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">m</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="comment">//&nbsp;m.abs&nbsp;may&nbsp;be&nbsp;nil&nbsp;for&nbsp;m&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">expNN</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">yWords</span><span class="op">,</span>&nbsp;<span class="ident">mWords</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">yWords</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">yWords</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">&amp;</span><span class="num">1</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">1</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">mWords</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;make&nbsp;modulus&nbsp;result&nbsp;positive</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">mWords</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;==&nbsp;x**y&nbsp;mod&nbsp;|m|&nbsp;&amp;&amp;&nbsp;0&nbsp;&lt;=&nbsp;z&nbsp;&lt;&nbsp;|m|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">615</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;GCD&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;greatest&nbsp;common&nbsp;divisor&nbsp;of&nbsp;a&nbsp;and&nbsp;b,&nbsp;which&nbsp;both&nbsp;must</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;be&nbsp;&gt;&nbsp;0,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;x&nbsp;and&nbsp;y&nbsp;are&nbsp;not&nbsp;nil,&nbsp;GCD&nbsp;sets&nbsp;x&nbsp;and&nbsp;y&nbsp;such&nbsp;that&nbsp;z&nbsp;=&nbsp;a*x&nbsp;+&nbsp;b*y.</span><br>
<span class="lineno">620</span><span class="comment">//&nbsp;If&nbsp;either&nbsp;a&nbsp;or&nbsp;b&nbsp;is&nbsp;&lt;=&nbsp;0,&nbsp;GCD&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;=&nbsp;y&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">GCD</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">a</span><span class="op">.</span><span class="ident">Sign</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">b</span><span class="op">.</span><span class="ident">Sign</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">binaryGCD</span><span class="op">(</span><span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">A</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">a</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">B</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">X</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Y</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">lastX</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">lastY</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">temp</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">B</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span><span class="op">,</span>&nbsp;<span class="ident">r</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q</span><span class="op">.</span><span class="ident">QuoRem</span><span class="op">(</span><span class="ident">A</span><span class="op">,</span>&nbsp;<span class="ident">B</span><span class="op">,</span>&nbsp;<span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">A</span><span class="op">,</span>&nbsp;<span class="ident">B</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">B</span><span class="op">,</span>&nbsp;<span class="ident">r</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">temp</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">X</span><span class="op">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">X</span><span class="op">.</span><span class="ident">Mul</span><span class="op">(</span><span class="ident">X</span><span class="op">,</span>&nbsp;<span class="ident">q</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">X</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">!</span><span class="ident">X</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">X</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">X</span><span class="op">,</span>&nbsp;<span class="ident">lastX</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">lastX</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">temp</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">temp</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">Y</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Y</span><span class="op">.</span><span class="ident">Mul</span><span class="op">(</span><span class="ident">Y</span><span class="op">,</span>&nbsp;<span class="ident">q</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">!</span><span class="ident">Y</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Y</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">Y</span><span class="op">,</span>&nbsp;<span class="ident">lastY</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">lastY</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">temp</span><span class="op">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">lastX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">y</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">lastY</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;binaryGCD&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;greatest&nbsp;common&nbsp;divisor&nbsp;of&nbsp;a&nbsp;and&nbsp;b,&nbsp;which&nbsp;both&nbsp;must</span><br>
<span class="lineno">680</span><span class="comment">//&nbsp;be&nbsp;&gt;&nbsp;0,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;Knuth,&nbsp;The&nbsp;Art&nbsp;of&nbsp;Computer&nbsp;Programming,&nbsp;Vol.&nbsp;2,&nbsp;Section&nbsp;4.5.2,&nbsp;Algorithm&nbsp;B.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">binaryGCD</span><span class="op">(</span><span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;use&nbsp;one&nbsp;Euclidean&nbsp;iteration&nbsp;to&nbsp;ensure&nbsp;that&nbsp;u&nbsp;and&nbsp;v&nbsp;are&nbsp;approx.&nbsp;the&nbsp;same&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">a</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">b</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">b</span><span class="op">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">Rem</span><span class="op">(</span><span class="ident">a</span><span class="op">,</span>&nbsp;<span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">a</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">b</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">a</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">Rem</span><span class="op">(</span><span class="ident">b</span><span class="op">,</span>&nbsp;<span class="ident">a</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">a</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;v&nbsp;might&nbsp;be&nbsp;0&nbsp;now</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;u&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;v&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;largest&nbsp;k&nbsp;such&nbsp;that&nbsp;u&nbsp;=&nbsp;u&#39;&nbsp;&lt;&lt;&nbsp;k,&nbsp;v&nbsp;=&nbsp;v&#39;&nbsp;&lt;&lt;&nbsp;k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">u</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">trailingZeroBits</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">vk</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">v</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">trailingZeroBits</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">vk</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">k</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">k</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">vk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span><span class="op">.</span><span class="ident">Rsh</span><span class="op">(</span><span class="ident">u</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">Rsh</span><span class="op">(</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;determine&nbsp;t&nbsp;(we&nbsp;know&nbsp;that&nbsp;u&nbsp;&gt;&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">u</span><span class="op">.</span><span class="ident">abs</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">&amp;</span><span class="num">1</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;u&nbsp;is&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Neg</span><span class="op">(</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Set</span><span class="op">(</span><span class="ident">u</span><span class="op">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">t</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;reduce&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Rsh</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">trailingZeroBits</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">v</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="op">!</span><span class="ident">v</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="comment">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span><span class="op">,</span>&nbsp;<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">u</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Sub</span><span class="op">(</span><span class="ident">u</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">Lsh</span><span class="op">(</span><span class="ident">u</span><span class="op">,</span>&nbsp;<span class="ident">k</span><span class="op">)</span><br>
<span class="lineno">735</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;ProbablyPrime&nbsp;performs&nbsp;n&nbsp;Miller-Rabin&nbsp;tests&nbsp;to&nbsp;check&nbsp;whether&nbsp;x&nbsp;is&nbsp;prime.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;true,&nbsp;x&nbsp;is&nbsp;prime&nbsp;with&nbsp;probability&nbsp;1&nbsp;-&nbsp;1/4^n.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;false,&nbsp;x&nbsp;is&nbsp;not&nbsp;prime.</span><br>
<span class="lineno">740</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">ProbablyPrime</span><span class="op">(</span><span class="ident">n</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">!</span><span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">probablyPrime</span><span class="op">(</span><span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Rand&nbsp;sets&nbsp;z&nbsp;to&nbsp;a&nbsp;pseudo-random&nbsp;number&nbsp;in&nbsp;[0,&nbsp;n)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">745</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Rand</span><span class="op">(</span><span class="ident">rnd</span>&nbsp;<span class="op">*</span><span class="ident">rand</span><span class="op">.</span><span class="ident">Rand</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">n</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="op">||</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">n</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">random</span><span class="op">(</span><span class="ident">rnd</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">bitLen</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="comment">//&nbsp;ModInverse&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;multiplicative&nbsp;inverse&nbsp;of&nbsp;g&nbsp;in&nbsp;the&nbsp;ring&nbsp;ℤ/nℤ</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and&nbsp;returns&nbsp;z.&nbsp;If&nbsp;g&nbsp;and&nbsp;n&nbsp;are&nbsp;not&nbsp;relatively&nbsp;prime,&nbsp;the&nbsp;result&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">ModInverse</span><span class="op">(</span><span class="ident">g</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">d</span>&nbsp;<span class="ident">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">d</span><span class="op">.</span><span class="ident">GCD</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">g</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;and&nbsp;y&nbsp;are&nbsp;such&nbsp;that&nbsp;g*x&nbsp;+&nbsp;n*y&nbsp;=&nbsp;d.&nbsp;Since&nbsp;g&nbsp;and&nbsp;n&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;relatively&nbsp;prime,&nbsp;d&nbsp;=&nbsp;1.&nbsp;Taking&nbsp;that&nbsp;modulo&nbsp;n&nbsp;results&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;g*x&nbsp;=&nbsp;1,&nbsp;therefore&nbsp;x&nbsp;is&nbsp;the&nbsp;inverse&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">z</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Lsh&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;&lt;&lt;&nbsp;n&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">770</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Lsh</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="builtintype">uint</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">shl</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">775</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Rsh&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;&gt;&gt;&nbsp;n&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Rsh</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">n</span>&nbsp;<span class="builtintype">uint</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;&gt;&gt;&nbsp;s&nbsp;==&nbsp;^(x-1)&nbsp;&gt;&gt;&nbsp;s&nbsp;==&nbsp;^((x-1)&nbsp;&gt;&gt;&nbsp;s)&nbsp;==&nbsp;-(((x-1)&nbsp;&gt;&gt;&nbsp;s)&nbsp;+&nbsp;1)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;no&nbsp;underflow&nbsp;because&nbsp;|x|&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">shr</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;x&nbsp;is&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">shr</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">n</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">790</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Bit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;i&#39;th&nbsp;bit&nbsp;of&nbsp;x.&nbsp;That&nbsp;is,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;returns&nbsp;(x&gt;&gt;i)&amp;1.&nbsp;The&nbsp;bit&nbsp;index&nbsp;i&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Bit</span><span class="op">(</span><span class="ident">i</span>&nbsp;<span class="builtintype">int</span><span class="op">)</span>&nbsp;<span class="builtintype">uint</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;optimization&nbsp;for&nbsp;common&nbsp;case:&nbsp;odd/even&nbsp;test&nbsp;of&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;bit&nbsp;0&nbsp;is&nbsp;same&nbsp;for&nbsp;-x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;negative&nbsp;bit&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">bit</span><span class="op">(</span><span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">^</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">bit</span><span class="op">(</span><span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBit&nbsp;sets&nbsp;z&nbsp;to&nbsp;x,&nbsp;with&nbsp;x&#39;s&nbsp;i&#39;th&nbsp;bit&nbsp;set&nbsp;to&nbsp;b&nbsp;(0&nbsp;or&nbsp;1).</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;That&nbsp;is,&nbsp;if&nbsp;b&nbsp;is&nbsp;1&nbsp;SetBit&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;|&nbsp;(1&nbsp;&lt;&lt;&nbsp;i);</span><br>
<span class="lineno">815</span><span class="comment">//&nbsp;if&nbsp;b&nbsp;is&nbsp;0&nbsp;SetBit&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;&amp;^&nbsp;(1&nbsp;&lt;&lt;&nbsp;i).&nbsp;If&nbsp;b&nbsp;is&nbsp;not&nbsp;0&nbsp;or&nbsp;1,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;SetBit&nbsp;will&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">SetBit</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="builtintype">int</span><span class="op">,</span>&nbsp;<span class="ident">b</span>&nbsp;<span class="builtintype">uint</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;negative&nbsp;bit&nbsp;index&#34;</span><span class="op">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">setBit</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">b</span><span class="op">^</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">t</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">t</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">setBit</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="ident">i</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">b</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;And&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;&amp;&nbsp;y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">And</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;&amp;&nbsp;(-y)&nbsp;==&nbsp;^(x-1)&nbsp;&amp;&nbsp;^(y-1)&nbsp;==&nbsp;^((x-1)&nbsp;|&nbsp;(y-1))&nbsp;==&nbsp;-(((x-1)&nbsp;|&nbsp;(y-1))&nbsp;+&nbsp;1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">or</span><span class="op">(</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;x&nbsp;and&nbsp;y&nbsp;are&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;&amp;&nbsp;y&nbsp;==&nbsp;x&nbsp;&amp;&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">and</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x.neg&nbsp;!=&nbsp;y.neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="comment">//&nbsp;&amp;&nbsp;is&nbsp;symmetric</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;&amp;&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;&amp;&nbsp;^(y-1)&nbsp;==&nbsp;x&nbsp;&amp;^&nbsp;(y-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">andNot</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;AndNot&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;&amp;^&nbsp;y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">AndNot</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;&amp;^&nbsp;(-y)&nbsp;==&nbsp;^(x-1)&nbsp;&amp;^&nbsp;^(y-1)&nbsp;==&nbsp;^(x-1)&nbsp;&amp;&nbsp;(y-1)&nbsp;==&nbsp;(y-1)&nbsp;&amp;^&nbsp;(x-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">andNot</span><span class="op">(</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;&amp;^&nbsp;y&nbsp;==&nbsp;x&nbsp;&amp;^&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">andNot</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;&amp;^&nbsp;y&nbsp;==&nbsp;^(x-1)&nbsp;&amp;^&nbsp;y&nbsp;==&nbsp;^(x-1)&nbsp;&amp;&nbsp;^y&nbsp;==&nbsp;^((x-1)&nbsp;|&nbsp;y)&nbsp;==&nbsp;-(((x-1)&nbsp;|&nbsp;y)&nbsp;+&nbsp;1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">or</span><span class="op">(</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;x&nbsp;is&nbsp;negative&nbsp;and&nbsp;y&nbsp;is&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;&amp;^&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;&amp;^&nbsp;^(y-1)&nbsp;==&nbsp;x&nbsp;&amp;&nbsp;(y-1)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">and</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Or&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;|&nbsp;y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Or</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;|&nbsp;(-y)&nbsp;==&nbsp;^(x-1)&nbsp;|&nbsp;^(y-1)&nbsp;==&nbsp;^((x-1)&nbsp;&amp;&nbsp;(y-1))&nbsp;==&nbsp;-(((x-1)&nbsp;&amp;&nbsp;(y-1))&nbsp;+&nbsp;1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">and</span><span class="op">(</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;x&nbsp;and&nbsp;y&nbsp;are&nbsp;negative</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;|&nbsp;y&nbsp;==&nbsp;x&nbsp;|&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">or</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x.neg&nbsp;!=&nbsp;y.neg</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="comment">//&nbsp;|&nbsp;is&nbsp;symmetric</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;|&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;|&nbsp;^(y-1)&nbsp;==&nbsp;^((y-1)&nbsp;&amp;^&nbsp;x)&nbsp;==&nbsp;-(^((y-1)&nbsp;&amp;^&nbsp;x)&nbsp;+&nbsp;1)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">andNot</span><span class="op">(</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;one&nbsp;of&nbsp;x&nbsp;or&nbsp;y&nbsp;is&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Xor&nbsp;sets&nbsp;z&nbsp;=&nbsp;x&nbsp;^&nbsp;y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Xor</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(-x)&nbsp;^&nbsp;(-y)&nbsp;==&nbsp;^(x-1)&nbsp;^&nbsp;^(y-1)&nbsp;==&nbsp;(x-1)&nbsp;^&nbsp;(y-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">xor</span><span class="op">(</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;^&nbsp;y&nbsp;==&nbsp;x&nbsp;^&nbsp;y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">xor</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x.neg&nbsp;!=&nbsp;y.neg</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="comment">//&nbsp;^&nbsp;is&nbsp;symmetric</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;x&nbsp;^&nbsp;(-y)&nbsp;==&nbsp;x&nbsp;^&nbsp;^(y-1)&nbsp;==&nbsp;^(x&nbsp;^&nbsp;(y-1))&nbsp;==&nbsp;-((x&nbsp;^&nbsp;(y-1))&nbsp;+&nbsp;1)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">y1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nat</span><span class="op">(</span><span class="ident">nil</span><span class="op">)</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">y</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">xor</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;only&nbsp;one&nbsp;of&nbsp;x&nbsp;or&nbsp;y&nbsp;is&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Not&nbsp;sets&nbsp;z&nbsp;=&nbsp;^x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">Not</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;^(-x)&nbsp;==&nbsp;^(^(x-1))&nbsp;==&nbsp;x-1</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">sub</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;^x&nbsp;==&nbsp;-x-1&nbsp;==&nbsp;-(x+1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">add</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">,</span>&nbsp;<span class="ident">natOne</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span>&nbsp;<span class="comment">//&nbsp;z&nbsp;cannot&nbsp;be&nbsp;zero&nbsp;if&nbsp;x&nbsp;is&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Gob&nbsp;codec&nbsp;version.&nbsp;Permits&nbsp;backward-compatible&nbsp;changes&nbsp;to&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="ident">intGobVersion</span>&nbsp;<span class="builtintype">byte</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno">975</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">GobEncode</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="builtintype">error</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">buf</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">make</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">+</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">)</span><span class="op">*</span><span class="ident">_S</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;extra&nbsp;byte&nbsp;for&nbsp;version&nbsp;and&nbsp;sign&nbsp;bit</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">bytes</span><span class="op">(</span><span class="ident">buf</span><span class="op">)</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;i&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">intGobVersion</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;make&nbsp;space&nbsp;for&nbsp;sign&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">buf</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">buf</span><span class="op">[</span><span class="ident">i</span><span class="op">:</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno">990</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">GobDecode</span><span class="op">(</span><span class="ident">buf</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="builtintype">error</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">buf</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Other&nbsp;side&nbsp;sent&nbsp;a&nbsp;nil&nbsp;or&nbsp;default&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">Int</span><span class="op">{</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">b</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">buf</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">b</span><span class="op">&gt;&gt;</span><span class="num">1</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">intGobVersion</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">errors</span><span class="op">.</span><span class="ident">New</span><span class="op">(</span><span class="ident">fmt</span><span class="op">.</span><span class="ident">Sprintf</span><span class="op">(</span><span class="string">&#34;Int.GobDecode:&nbsp;encoding&nbsp;version&nbsp;%d&nbsp;not&nbsp;supported&#34;</span><span class="op">,</span>&nbsp;<span class="ident">b</span><span class="op">&gt;&gt;</span><span class="num">1</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">neg</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">b</span><span class="op">&amp;</span><span class="num">1</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">abs</span><span class="op">.</span><span class="ident">setBytes</span><span class="op">(</span><span class="ident">buf</span><span class="op">[</span><span class="num">1</span><span class="op">:</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1005</span><span class="comment">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">MarshalJSON</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="builtintype">error</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO(gri):&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;[]byte/string&nbsp;conversions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1010</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">UnmarshalJSON</span><span class="op">(</span><span class="ident">text</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="builtintype">error</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;TODO(gri):&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;[]byte/string&nbsp;conversions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="builtintype">string</span><span class="op">(</span><span class="ident">text</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;math/big:&nbsp;cannot&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;a&nbsp;*big.Int&#34;</span><span class="op">,</span>&nbsp;<span class="ident">text</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1020</span><span class="comment">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">MarshalText</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">text</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="builtintype">error</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="ident">z</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span><span class="comment">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">z</span>&nbsp;<span class="op">*</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="ident">UnmarshalText</span><span class="op">(</span><span class="ident">text</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="builtintype">error</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="builtintype">string</span><span class="op">(</span><span class="ident">text</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;math/big:&nbsp;cannot&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;a&nbsp;*big.Int&#34;</span><span class="op">,</span>&nbsp;<span class="ident">text</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
