<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5433224">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5433279">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5433333">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5433384">package</span>&nbsp;<span class="ident" id="5433392">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5433399">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5433456">func</span>&nbsp;<span class="ident" id="5433461">RGBToYCbCr</span><span class="op" id="5433471">(</span><span class="ident" id="5433472">r</span><span class="op" id="5433473">,</span>&nbsp;<span class="ident" id="5433475">g</span><span class="op" id="5433476">,</span>&nbsp;<span class="ident" id="5433478">b</span>&nbsp;<span class="builtintype" id="5433480">uint8</span><span class="op" id="5433485">)</span>&nbsp;<span class="op" id="5433487">(</span><span class="builtintype" id="5433488">uint8</span><span class="op" id="5433493">,</span>&nbsp;<span class="builtintype" id="5433495">uint8</span><span class="op" id="5433500">,</span>&nbsp;<span class="builtintype" id="5433502">uint8</span><span class="op" id="5433507">)</span>&nbsp;<span class="op" id="5433509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5433512">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5433545">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5433586">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5433633">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5433680">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433747">r1</span>&nbsp;<span class="op" id="5433750">:=</span>&nbsp;<span class="builtintype" id="5433753">int</span><span class="op" id="5433756">(</span><span class="ident" id="5433757">r</span><span class="op" id="5433758">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433761">g1</span>&nbsp;<span class="op" id="5433764">:=</span>&nbsp;<span class="builtintype" id="5433767">int</span><span class="op" id="5433770">(</span><span class="ident" id="5433771">g</span><span class="op" id="5433772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433775">b1</span>&nbsp;<span class="op" id="5433778">:=</span>&nbsp;<span class="builtintype" id="5433781">int</span><span class="op" id="5433784">(</span><span class="ident" id="5433785">b</span><span class="op" id="5433786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433789">yy</span>&nbsp;<span class="op" id="5433792">:=</span>&nbsp;<span class="op" id="5433795">(</span><span class="num" id="5433796">19595</span><span class="op" id="5433801">*</span><span class="ident" id="5433802">r1</span>&nbsp;<span class="op" id="5433805">+</span>&nbsp;<span class="num" id="5433807">38470</span><span class="op" id="5433812">*</span><span class="ident" id="5433813">g1</span>&nbsp;<span class="op" id="5433816">+</span>&nbsp;<span class="num" id="5433818">7471</span><span class="op" id="5433822">*</span><span class="ident" id="5433823">b1</span>&nbsp;<span class="op" id="5433826">+</span>&nbsp;<span class="num" id="5433828">1</span><span class="op" id="5433829">&lt;&lt;</span><span class="num" id="5433831">15</span><span class="op" id="5433833">)</span>&nbsp;<span class="op" id="5433835">&gt;&gt;</span>&nbsp;<span class="num" id="5433838">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433842">cb</span>&nbsp;<span class="op" id="5433845">:=</span>&nbsp;<span class="op" id="5433848">(</span><span class="op" id="5433849">-</span><span class="num" id="5433850">11056</span><span class="op" id="5433855">*</span><span class="ident" id="5433856">r1</span>&nbsp;<span class="op" id="5433859">-</span>&nbsp;<span class="num" id="5433861">21712</span><span class="op" id="5433866">*</span><span class="ident" id="5433867">g1</span>&nbsp;<span class="op" id="5433870">+</span>&nbsp;<span class="num" id="5433872">32768</span><span class="op" id="5433877">*</span><span class="ident" id="5433878">b1</span>&nbsp;<span class="op" id="5433881">+</span>&nbsp;<span class="num" id="5433883">257</span><span class="op" id="5433886">&lt;&lt;</span><span class="num" id="5433888">15</span><span class="op" id="5433890">)</span>&nbsp;<span class="op" id="5433892">&gt;&gt;</span>&nbsp;<span class="num" id="5433895">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433899">cr</span>&nbsp;<span class="op" id="5433902">:=</span>&nbsp;<span class="op" id="5433905">(</span><span class="num" id="5433906">32768</span><span class="op" id="5433911">*</span><span class="ident" id="5433912">r1</span>&nbsp;<span class="op" id="5433915">-</span>&nbsp;<span class="num" id="5433917">27440</span><span class="op" id="5433922">*</span><span class="ident" id="5433923">g1</span>&nbsp;<span class="op" id="5433926">-</span>&nbsp;<span class="num" id="5433928">5328</span><span class="op" id="5433932">*</span><span class="ident" id="5433933">b1</span>&nbsp;<span class="op" id="5433936">+</span>&nbsp;<span class="num" id="5433938">257</span><span class="op" id="5433941">&lt;&lt;</span><span class="num" id="5433943">15</span><span class="op" id="5433945">)</span>&nbsp;<span class="op" id="5433947">&gt;&gt;</span>&nbsp;<span class="num" id="5433950">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5433954">if</span>&nbsp;<span class="ident" id="5433957">yy</span>&nbsp;<span class="op" id="5433960">&lt;</span>&nbsp;<span class="num" id="5433962">0</span>&nbsp;<span class="op" id="5433964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433968">yy</span>&nbsp;<span class="op" id="5433971">=</span>&nbsp;<span class="num" id="5433973">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5433976">}</span>&nbsp;<span class="keyword" id="5433978">else</span>&nbsp;<span class="keyword" id="5433983">if</span>&nbsp;<span class="ident" id="5433986">yy</span>&nbsp;<span class="op" id="5433989">&gt;</span>&nbsp;<span class="num" id="5433991">255</span>&nbsp;<span class="op" id="5433995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5433999">yy</span>&nbsp;<span class="op" id="5434002">=</span>&nbsp;<span class="num" id="5434004">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434009">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434012">if</span>&nbsp;<span class="ident" id="5434015">cb</span>&nbsp;<span class="op" id="5434018">&lt;</span>&nbsp;<span class="num" id="5434020">0</span>&nbsp;<span class="op" id="5434022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434026">cb</span>&nbsp;<span class="op" id="5434029">=</span>&nbsp;<span class="num" id="5434031">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434034">}</span>&nbsp;<span class="keyword" id="5434036">else</span>&nbsp;<span class="keyword" id="5434041">if</span>&nbsp;<span class="ident" id="5434044">cb</span>&nbsp;<span class="op" id="5434047">&gt;</span>&nbsp;<span class="num" id="5434049">255</span>&nbsp;<span class="op" id="5434053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434057">cb</span>&nbsp;<span class="op" id="5434060">=</span>&nbsp;<span class="num" id="5434062">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434067">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434070">if</span>&nbsp;<span class="ident" id="5434073">cr</span>&nbsp;<span class="op" id="5434076">&lt;</span>&nbsp;<span class="num" id="5434078">0</span>&nbsp;<span class="op" id="5434080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434084">cr</span>&nbsp;<span class="op" id="5434087">=</span>&nbsp;<span class="num" id="5434089">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434092">}</span>&nbsp;<span class="keyword" id="5434094">else</span>&nbsp;<span class="keyword" id="5434099">if</span>&nbsp;<span class="ident" id="5434102">cr</span>&nbsp;<span class="op" id="5434105">&gt;</span>&nbsp;<span class="num" id="5434107">255</span>&nbsp;<span class="op" id="5434111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434115">cr</span>&nbsp;<span class="op" id="5434118">=</span>&nbsp;<span class="num" id="5434120">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434125">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434128">return</span>&nbsp;<span class="builtintype" id="5434135">uint8</span><span class="op" id="5434140">(</span><span class="ident" id="5434141">yy</span><span class="op" id="5434143">)</span><span class="op" id="5434144">,</span>&nbsp;<span class="builtintype" id="5434146">uint8</span><span class="op" id="5434151">(</span><span class="ident" id="5434152">cb</span><span class="op" id="5434154">)</span><span class="op" id="5434155">,</span>&nbsp;<span class="builtintype" id="5434157">uint8</span><span class="op" id="5434162">(</span><span class="ident" id="5434163">cr</span><span class="op" id="5434165">)</span><br>
<span class="lineno"></span><span class="op" id="5434167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5434170">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5434227">func</span>&nbsp;<span class="ident" id="5434232">YCbCrToRGB</span><span class="op" id="5434242">(</span><span class="ident" id="5434243">y</span><span class="op" id="5434244">,</span>&nbsp;<span class="ident" id="5434246">cb</span><span class="op" id="5434248">,</span>&nbsp;<span class="ident" id="5434250">cr</span>&nbsp;<span class="builtintype" id="5434253">uint8</span><span class="op" id="5434258">)</span>&nbsp;<span class="op" id="5434260">(</span><span class="builtintype" id="5434261">uint8</span><span class="op" id="5434266">,</span>&nbsp;<span class="builtintype" id="5434268">uint8</span><span class="op" id="5434273">,</span>&nbsp;<span class="builtintype" id="5434275">uint8</span><span class="op" id="5434280">)</span>&nbsp;<span class="op" id="5434282">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5434285">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5434318">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5434348">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5434397">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5434427">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434494">yy1</span>&nbsp;<span class="op" id="5434498">:=</span>&nbsp;<span class="builtintype" id="5434501">int</span><span class="op" id="5434504">(</span><span class="ident" id="5434505">y</span><span class="op" id="5434506">)</span><span class="op" id="5434507">&lt;&lt;</span><span class="num" id="5434509">16</span>&nbsp;<span class="op" id="5434512">+</span>&nbsp;<span class="num" id="5434514">1</span><span class="op" id="5434515">&lt;&lt;</span><span class="num" id="5434517">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434521">cb1</span>&nbsp;<span class="op" id="5434525">:=</span>&nbsp;<span class="builtintype" id="5434528">int</span><span class="op" id="5434531">(</span><span class="ident" id="5434532">cb</span><span class="op" id="5434534">)</span>&nbsp;<span class="op" id="5434536">-</span>&nbsp;<span class="num" id="5434538">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434543">cr1</span>&nbsp;<span class="op" id="5434547">:=</span>&nbsp;<span class="builtintype" id="5434550">int</span><span class="op" id="5434553">(</span><span class="ident" id="5434554">cr</span><span class="op" id="5434556">)</span>&nbsp;<span class="op" id="5434558">-</span>&nbsp;<span class="num" id="5434560">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434565">r</span>&nbsp;<span class="op" id="5434567">:=</span>&nbsp;<span class="op" id="5434570">(</span><span class="ident" id="5434571">yy1</span>&nbsp;<span class="op" id="5434575">+</span>&nbsp;<span class="num" id="5434577">91881</span><span class="op" id="5434582">*</span><span class="ident" id="5434583">cr1</span><span class="op" id="5434586">)</span>&nbsp;<span class="op" id="5434588">&gt;&gt;</span>&nbsp;<span class="num" id="5434591">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434595">g</span>&nbsp;<span class="op" id="5434597">:=</span>&nbsp;<span class="op" id="5434600">(</span><span class="ident" id="5434601">yy1</span>&nbsp;<span class="op" id="5434605">-</span>&nbsp;<span class="num" id="5434607">22554</span><span class="op" id="5434612">*</span><span class="ident" id="5434613">cb1</span>&nbsp;<span class="op" id="5434617">-</span>&nbsp;<span class="num" id="5434619">46802</span><span class="op" id="5434624">*</span><span class="ident" id="5434625">cr1</span><span class="op" id="5434628">)</span>&nbsp;<span class="op" id="5434630">&gt;&gt;</span>&nbsp;<span class="num" id="5434633">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434637">b</span>&nbsp;<span class="op" id="5434639">:=</span>&nbsp;<span class="op" id="5434642">(</span><span class="ident" id="5434643">yy1</span>&nbsp;<span class="op" id="5434647">+</span>&nbsp;<span class="num" id="5434649">116130</span><span class="op" id="5434655">*</span><span class="ident" id="5434656">cb1</span><span class="op" id="5434659">)</span>&nbsp;<span class="op" id="5434661">&gt;&gt;</span>&nbsp;<span class="num" id="5434664">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434668">if</span>&nbsp;<span class="ident" id="5434671">r</span>&nbsp;<span class="op" id="5434673">&lt;</span>&nbsp;<span class="num" id="5434675">0</span>&nbsp;<span class="op" id="5434677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434681">r</span>&nbsp;<span class="op" id="5434683">=</span>&nbsp;<span class="num" id="5434685">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434688">}</span>&nbsp;<span class="keyword" id="5434690">else</span>&nbsp;<span class="keyword" id="5434695">if</span>&nbsp;<span class="ident" id="5434698">r</span>&nbsp;<span class="op" id="5434700">&gt;</span>&nbsp;<span class="num" id="5434702">255</span>&nbsp;<span class="op" id="5434706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434710">r</span>&nbsp;<span class="op" id="5434712">=</span>&nbsp;<span class="num" id="5434714">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434722">if</span>&nbsp;<span class="ident" id="5434725">g</span>&nbsp;<span class="op" id="5434727">&lt;</span>&nbsp;<span class="num" id="5434729">0</span>&nbsp;<span class="op" id="5434731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434735">g</span>&nbsp;<span class="op" id="5434737">=</span>&nbsp;<span class="num" id="5434739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434742">}</span>&nbsp;<span class="keyword" id="5434744">else</span>&nbsp;<span class="keyword" id="5434749">if</span>&nbsp;<span class="ident" id="5434752">g</span>&nbsp;<span class="op" id="5434754">&gt;</span>&nbsp;<span class="num" id="5434756">255</span>&nbsp;<span class="op" id="5434760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434764">g</span>&nbsp;<span class="op" id="5434766">=</span>&nbsp;<span class="num" id="5434768">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434776">if</span>&nbsp;<span class="ident" id="5434779">b</span>&nbsp;<span class="op" id="5434781">&lt;</span>&nbsp;<span class="num" id="5434783">0</span>&nbsp;<span class="op" id="5434785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434789">b</span>&nbsp;<span class="op" id="5434791">=</span>&nbsp;<span class="num" id="5434793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434796">}</span>&nbsp;<span class="keyword" id="5434798">else</span>&nbsp;<span class="keyword" id="5434803">if</span>&nbsp;<span class="ident" id="5434806">b</span>&nbsp;<span class="op" id="5434808">&gt;</span>&nbsp;<span class="num" id="5434810">255</span>&nbsp;<span class="op" id="5434814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5434818">b</span>&nbsp;<span class="op" id="5434820">=</span>&nbsp;<span class="num" id="5434822">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5434827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5434830">return</span>&nbsp;<span class="builtintype" id="5434837">uint8</span><span class="op" id="5434842">(</span><span class="ident" id="5434843">r</span><span class="op" id="5434844">)</span><span class="op" id="5434845">,</span>&nbsp;<span class="builtintype" id="5434847">uint8</span><span class="op" id="5434852">(</span><span class="ident" id="5434853">g</span><span class="op" id="5434854">)</span><span class="op" id="5434855">,</span>&nbsp;<span class="builtintype" id="5434857">uint8</span><span class="op" id="5434862">(</span><span class="ident" id="5434863">b</span><span class="op" id="5434864">)</span><br>
<span class="lineno"></span><span class="op" id="5434866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5434869">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="5434948">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="5434987">//</span><br>
<span class="lineno"></span><span class="comment" id="5434990">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="5435064">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="5435139">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="5435217">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="5435270">//</span><br>
<span class="lineno"></span><span class="comment" id="5435273">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="5435352">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="5435427">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="5435499">type</span>&nbsp;<span class="ident" id="5435504">YCbCr</span>&nbsp;<span class="keyword" id="5435510">struct</span>&nbsp;<span class="op" id="5435517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5435520">Y</span><span class="op" id="5435521">,</span>&nbsp;<span class="ident" id="5435523">Cb</span><span class="op" id="5435525">,</span>&nbsp;<span class="ident" id="5435527">Cr</span>&nbsp;<span class="builtintype" id="5435530">uint8</span><br>
<span class="lineno"></span><span class="op" id="5435536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5435539">func</span>&nbsp;<span class="op" id="5435544">(</span><span class="ident" id="5435545">c</span>&nbsp;<span class="ident" id="5435547">YCbCr</span><span class="op" id="5435552">)</span>&nbsp;<span class="ident" id="5435554">RGBA</span><span class="op" id="5435558">(</span><span class="op" id="5435559">)</span>&nbsp;<span class="op" id="5435561">(</span><span class="builtintype" id="5435562">uint32</span><span class="op" id="5435568">,</span>&nbsp;<span class="builtintype" id="5435570">uint32</span><span class="op" id="5435576">,</span>&nbsp;<span class="builtintype" id="5435578">uint32</span><span class="op" id="5435584">,</span>&nbsp;<span class="builtintype" id="5435586">uint32</span><span class="op" id="5435592">)</span>&nbsp;<span class="op" id="5435594">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5435597">r</span><span class="op" id="5435598">,</span>&nbsp;<span class="ident" id="5435600">g</span><span class="op" id="5435601">,</span>&nbsp;<span class="ident" id="5435603">b</span>&nbsp;<span class="op" id="5435605">:=</span>&nbsp;<span class="ident" id="5435608">YCbCrToRGB</span><span class="op" id="5435618">(</span><span class="ident" id="5435619">c</span><span class="op" id="5435620">.</span><span class="ident" id="5435621">Y</span><span class="op" id="5435622">,</span>&nbsp;<span class="ident" id="5435624">c</span><span class="op" id="5435625">.</span><span class="ident" id="5435626">Cb</span><span class="op" id="5435628">,</span>&nbsp;<span class="ident" id="5435630">c</span><span class="op" id="5435631">.</span><span class="ident" id="5435632">Cr</span><span class="op" id="5435634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5435637">return</span>&nbsp;<span class="builtintype" id="5435644">uint32</span><span class="op" id="5435650">(</span><span class="ident" id="5435651">r</span><span class="op" id="5435652">)</span>&nbsp;<span class="op" id="5435654">*</span>&nbsp;<span class="num" id="5435656">0x101</span><span class="op" id="5435661">,</span>&nbsp;<span class="builtintype" id="5435663">uint32</span><span class="op" id="5435669">(</span><span class="ident" id="5435670">g</span><span class="op" id="5435671">)</span>&nbsp;<span class="op" id="5435673">*</span>&nbsp;<span class="num" id="5435675">0x101</span><span class="op" id="5435680">,</span>&nbsp;<span class="builtintype" id="5435682">uint32</span><span class="op" id="5435688">(</span><span class="ident" id="5435689">b</span><span class="op" id="5435690">)</span>&nbsp;<span class="op" id="5435692">*</span>&nbsp;<span class="num" id="5435694">0x101</span><span class="op" id="5435699">,</span>&nbsp;<span class="num" id="5435701">0xffff</span><br>
<span class="lineno"></span><span class="op" id="5435708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5435711">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="5435757">var</span>&nbsp;<span class="ident" id="5435761">YCbCrModel</span>&nbsp;<span class="ident" id="5435772">Model</span>&nbsp;<span class="op" id="5435778">=</span>&nbsp;<span class="ident" id="5435780">ModelFunc</span><span class="op" id="5435789">(</span><span class="ident" id="5435790">yCbCrModel</span><span class="op" id="5435800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5435803">func</span>&nbsp;<span class="ident" id="5435808">yCbCrModel</span><span class="op" id="5435818">(</span><span class="ident" id="5435819">c</span>&nbsp;<span class="ident" id="5435821">Color</span><span class="op" id="5435826">)</span>&nbsp;<span class="ident" id="5435828">Color</span>&nbsp;<span class="op" id="5435834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5435837">if</span>&nbsp;<span class="ident" id="5435840">_</span><span class="op" id="5435841">,</span>&nbsp;<span class="ident" id="5435843">ok</span>&nbsp;<span class="op" id="5435846">:=</span>&nbsp;<span class="ident" id="5435849">c</span><span class="op" id="5435850">.</span><span class="op" id="5435851">(</span><span class="ident" id="5435852">YCbCr</span><span class="op" id="5435857">)</span><span class="op" id="5435858">;</span>&nbsp;<span class="ident" id="5435860">ok</span>&nbsp;<span class="op" id="5435863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5435867">return</span>&nbsp;<span class="ident" id="5435874">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5435877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5435880">r</span><span class="op" id="5435881">,</span>&nbsp;<span class="ident" id="5435883">g</span><span class="op" id="5435884">,</span>&nbsp;<span class="ident" id="5435886">b</span><span class="op" id="5435887">,</span>&nbsp;<span class="ident" id="5435889">_</span>&nbsp;<span class="op" id="5435891">:=</span>&nbsp;<span class="ident" id="5435894">c</span><span class="op" id="5435895">.</span><span class="ident" id="5435896">RGBA</span><span class="op" id="5435900">(</span><span class="op" id="5435901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5435904">y</span><span class="op" id="5435905">,</span>&nbsp;<span class="ident" id="5435907">u</span><span class="op" id="5435908">,</span>&nbsp;<span class="ident" id="5435910">v</span>&nbsp;<span class="op" id="5435912">:=</span>&nbsp;<span class="ident" id="5435915">RGBToYCbCr</span><span class="op" id="5435925">(</span><span class="builtintype" id="5435926">uint8</span><span class="op" id="5435931">(</span><span class="ident" id="5435932">r</span><span class="op" id="5435933">&gt;&gt;</span><span class="num" id="5435935">8</span><span class="op" id="5435936">)</span><span class="op" id="5435937">,</span>&nbsp;<span class="builtintype" id="5435939">uint8</span><span class="op" id="5435944">(</span><span class="ident" id="5435945">g</span><span class="op" id="5435946">&gt;&gt;</span><span class="num" id="5435948">8</span><span class="op" id="5435949">)</span><span class="op" id="5435950">,</span>&nbsp;<span class="builtintype" id="5435952">uint8</span><span class="op" id="5435957">(</span><span class="ident" id="5435958">b</span><span class="op" id="5435959">&gt;&gt;</span><span class="num" id="5435961">8</span><span class="op" id="5435962">)</span><span class="op" id="5435963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5435966">return</span>&nbsp;<span class="ident" id="5435973">YCbCr</span><span class="op" id="5435978">{</span><span class="ident" id="5435979">y</span><span class="op" id="5435980">,</span>&nbsp;<span class="ident" id="5435982">u</span><span class="op" id="5435983">,</span>&nbsp;<span class="ident" id="5435985">v</span><span class="op" id="5435986">}</span><br>
<span class="lineno"></span><span class="op" id="5435988">}</span>
</div>
</body>
</html>
