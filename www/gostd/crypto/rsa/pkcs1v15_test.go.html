<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8125735">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8125790">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8125844">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8125895">package</span>&nbsp;<span class="ident" id="8125903">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125908">import</span>&nbsp;<span class="op" id="8125915">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125918">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125927">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125937">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125952">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125967">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8125986">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126002">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126008">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126020">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126031">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8126047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8126050">func</span>&nbsp;<span class="ident" id="8126055">decodeBase64</span><span class="op" id="8126067">(</span><span class="ident" id="8126068">in</span>&nbsp;<span class="builtintype" id="8126071">string</span><span class="op" id="8126077">)</span>&nbsp;<span class="op" id="8126079">[</span><span class="op" id="8126080">]</span><span class="builtintype" id="8126081">byte</span>&nbsp;<span class="op" id="8126086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8126089">out</span>&nbsp;<span class="op" id="8126093">:=</span>&nbsp;<span class="builtinfunc" id="8126096">make</span><span class="op" id="8126100">(</span><span class="op" id="8126101">[</span><span class="op" id="8126102">]</span><span class="builtintype" id="8126103">byte</span><span class="op" id="8126107">,</span>&nbsp;<span class="ident" id="8126109">base64</span><span class="op" id="8126115">.</span><span class="ident" id="8126116">StdEncoding</span><span class="op" id="8126127">.</span><span class="ident" id="8126128">DecodedLen</span><span class="op" id="8126138">(</span><span class="builtinfunc" id="8126139">len</span><span class="op" id="8126142">(</span><span class="ident" id="8126143">in</span><span class="op" id="8126145">)</span><span class="op" id="8126146">)</span><span class="op" id="8126147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8126150">n</span><span class="op" id="8126151">,</span>&nbsp;<span class="ident" id="8126153">err</span>&nbsp;<span class="op" id="8126157">:=</span>&nbsp;<span class="ident" id="8126160">base64</span><span class="op" id="8126166">.</span><span class="ident" id="8126167">StdEncoding</span><span class="op" id="8126178">.</span><span class="ident" id="8126179">Decode</span><span class="op" id="8126185">(</span><span class="ident" id="8126186">out</span><span class="op" id="8126189">,</span>&nbsp;<span class="op" id="8126191">[</span><span class="op" id="8126192">]</span><span class="builtintype" id="8126193">byte</span><span class="op" id="8126197">(</span><span class="ident" id="8126198">in</span><span class="op" id="8126200">)</span><span class="op" id="8126201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8126204">if</span>&nbsp;<span class="ident" id="8126207">err</span>&nbsp;<span class="op" id="8126211">!=</span>&nbsp;<span class="builtintype" id="8126214">nil</span>&nbsp;<span class="op" id="8126218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8126222">return</span>&nbsp;<span class="builtintype" id="8126229">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8126237">return</span>&nbsp;<span class="ident" id="8126244">out</span><span class="op" id="8126247">[</span><span class="num" id="8126248">0</span><span class="op" id="8126249">:</span><span class="ident" id="8126250">n</span><span class="op" id="8126251">]</span><br>
<span class="lineno"></span><span class="op" id="8126253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8126256">type</span>&nbsp;<span class="ident" id="8126261">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8126281">struct</span>&nbsp;<span class="op" id="8126288">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8126291">in</span><span class="op" id="8126293">,</span>&nbsp;<span class="ident" id="8126295">out</span>&nbsp;<span class="builtintype" id="8126299">string</span><br>
<span class="lineno"></span><span class="op" id="8126306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8126309">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8126383">var</span>&nbsp;<span class="ident" id="8126387">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8126408">=</span>&nbsp;<span class="op" id="8126410">[</span><span class="op" id="8126411">]</span><span class="ident" id="8126412">DecryptPKCS1v15Test</span><span class="op" id="8126431">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126438">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8126528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126532">&#34;x&#34;</span><span class="op" id="8126535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126538">}</span><span class="op" id="8126539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126542">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126546">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8126636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126640">&#34;testing.&#34;</span><span class="op" id="8126650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126653">}</span><span class="op" id="8126654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126661">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8126751">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126755">&#34;testing.\n&#34;</span><span class="op" id="8126767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126770">}</span><span class="op" id="8126771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126778">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8126868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8126872">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8126927">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8126930">}</span><span class="op" id="8126931">,</span><br>
<span class="lineno"></span><span class="op" id="8126933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8126936">func</span>&nbsp;<span class="ident" id="8126941">TestDecryptPKCS1v15</span><span class="op" id="8126960">(</span><span class="ident" id="8126961">t</span>&nbsp;<span class="op" id="8126963">*</span><span class="ident" id="8126964">testing</span><span class="op" id="8126971">.</span><span class="ident" id="8126972">T</span><span class="op" id="8126973">)</span>&nbsp;<span class="op" id="8126975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8126978">for</span>&nbsp;<span class="ident" id="8126982">i</span><span class="op" id="8126983">,</span>&nbsp;<span class="ident" id="8126985">test</span>&nbsp;<span class="op" id="8126990">:=</span>&nbsp;<span class="keyword" id="8126993">range</span>&nbsp;<span class="ident" id="8126999">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8127020">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127024">out</span><span class="op" id="8127027">,</span>&nbsp;<span class="ident" id="8127029">err</span>&nbsp;<span class="op" id="8127033">:=</span>&nbsp;<span class="ident" id="8127036">DecryptPKCS1v15</span><span class="op" id="8127051">(</span><span class="builtintype" id="8127052">nil</span><span class="op" id="8127055">,</span>&nbsp;<span class="ident" id="8127057">rsaPrivateKey</span><span class="op" id="8127070">,</span>&nbsp;<span class="ident" id="8127072">decodeBase64</span><span class="op" id="8127084">(</span><span class="ident" id="8127085">test</span><span class="op" id="8127089">.</span><span class="ident" id="8127090">in</span><span class="op" id="8127092">)</span><span class="op" id="8127093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127097">if</span>&nbsp;<span class="ident" id="8127100">err</span>&nbsp;<span class="op" id="8127104">!=</span>&nbsp;<span class="builtintype" id="8127107">nil</span>&nbsp;<span class="op" id="8127111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127116">t</span><span class="op" id="8127117">.</span><span class="ident" id="8127118">Errorf</span><span class="op" id="8127124">(</span><span class="string" id="8127125">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8127147">,</span>&nbsp;<span class="ident" id="8127149">i</span><span class="op" id="8127150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127158">want</span>&nbsp;<span class="op" id="8127163">:=</span>&nbsp;<span class="op" id="8127166">[</span><span class="op" id="8127167">]</span><span class="builtintype" id="8127168">byte</span><span class="op" id="8127172">(</span><span class="ident" id="8127173">test</span><span class="op" id="8127177">.</span><span class="ident" id="8127178">out</span><span class="op" id="8127181">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127185">if</span>&nbsp;<span class="op" id="8127188">!</span><span class="ident" id="8127189">bytes</span><span class="op" id="8127194">.</span><span class="ident" id="8127195">Equal</span><span class="op" id="8127200">(</span><span class="ident" id="8127201">out</span><span class="op" id="8127204">,</span>&nbsp;<span class="ident" id="8127206">want</span><span class="op" id="8127210">)</span>&nbsp;<span class="op" id="8127212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127217">t</span><span class="op" id="8127218">.</span><span class="ident" id="8127219">Errorf</span><span class="op" id="8127225">(</span><span class="string" id="8127226">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8127248">,</span>&nbsp;<span class="ident" id="8127250">i</span><span class="op" id="8127251">,</span>&nbsp;<span class="ident" id="8127253">out</span><span class="op" id="8127256">,</span>&nbsp;<span class="ident" id="8127258">want</span><span class="op" id="8127262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127269">}</span><br>
<span class="lineno"></span><span class="op" id="8127271">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8127274">func</span>&nbsp;<span class="ident" id="8127279">TestEncryptPKCS1v15</span><span class="op" id="8127298">(</span><span class="ident" id="8127299">t</span>&nbsp;<span class="op" id="8127301">*</span><span class="ident" id="8127302">testing</span><span class="op" id="8127309">.</span><span class="ident" id="8127310">T</span><span class="op" id="8127311">)</span>&nbsp;<span class="op" id="8127313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127316">random</span>&nbsp;<span class="op" id="8127323">:=</span>&nbsp;<span class="ident" id="8127326">rand</span><span class="op" id="8127330">.</span><span class="ident" id="8127331">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127339">k</span>&nbsp;<span class="op" id="8127341">:=</span>&nbsp;<span class="op" id="8127344">(</span><span class="ident" id="8127345">rsaPrivateKey</span><span class="op" id="8127358">.</span><span class="ident" id="8127359">N</span><span class="op" id="8127360">.</span><span class="ident" id="8127361">BitLen</span><span class="op" id="8127367">(</span><span class="op" id="8127368">)</span>&nbsp;<span class="op" id="8127370">+</span>&nbsp;<span class="num" id="8127372">7</span><span class="op" id="8127373">)</span>&nbsp;<span class="op" id="8127375">/</span>&nbsp;<span class="num" id="8127377">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127381">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8127399">:=</span>&nbsp;<span class="keyword" id="8127402">func</span><span class="op" id="8127406">(</span><span class="ident" id="8127407">in</span>&nbsp;<span class="op" id="8127410">[</span><span class="op" id="8127411">]</span><span class="builtintype" id="8127412">byte</span><span class="op" id="8127416">,</span>&nbsp;<span class="ident" id="8127418">blind</span>&nbsp;<span class="builtintype" id="8127424">bool</span><span class="op" id="8127428">)</span>&nbsp;<span class="builtintype" id="8127430">bool</span>&nbsp;<span class="op" id="8127435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127439">if</span>&nbsp;<span class="builtinfunc" id="8127442">len</span><span class="op" id="8127445">(</span><span class="ident" id="8127446">in</span><span class="op" id="8127448">)</span>&nbsp;<span class="op" id="8127450">&gt;</span>&nbsp;<span class="ident" id="8127452">k</span><span class="op" id="8127453">-</span><span class="num" id="8127454">11</span>&nbsp;<span class="op" id="8127457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127462">in</span>&nbsp;<span class="op" id="8127465">=</span>&nbsp;<span class="ident" id="8127467">in</span><span class="op" id="8127469">[</span><span class="num" id="8127470">0</span>&nbsp;<span class="op" id="8127472">:</span>&nbsp;<span class="ident" id="8127474">k</span><span class="op" id="8127475">-</span><span class="num" id="8127476">11</span><span class="op" id="8127478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127487">ciphertext</span><span class="op" id="8127497">,</span>&nbsp;<span class="ident" id="8127499">err</span>&nbsp;<span class="op" id="8127503">:=</span>&nbsp;<span class="ident" id="8127506">EncryptPKCS1v15</span><span class="op" id="8127521">(</span><span class="ident" id="8127522">random</span><span class="op" id="8127528">,</span>&nbsp;<span class="op" id="8127530">&amp;</span><span class="ident" id="8127531">rsaPrivateKey</span><span class="op" id="8127544">.</span><span class="ident" id="8127545">PublicKey</span><span class="op" id="8127554">,</span>&nbsp;<span class="ident" id="8127556">in</span><span class="op" id="8127558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127562">if</span>&nbsp;<span class="ident" id="8127565">err</span>&nbsp;<span class="op" id="8127569">!=</span>&nbsp;<span class="builtintype" id="8127572">nil</span>&nbsp;<span class="op" id="8127576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127581">t</span><span class="op" id="8127582">.</span><span class="ident" id="8127583">Errorf</span><span class="op" id="8127589">(</span><span class="string" id="8127590">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8127612">,</span>&nbsp;<span class="ident" id="8127614">err</span><span class="op" id="8127617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127622">return</span>&nbsp;<span class="builtintype" id="8127629">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127637">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127642">var</span>&nbsp;<span class="ident" id="8127646">rand</span>&nbsp;<span class="ident" id="8127651">io</span><span class="op" id="8127653">.</span><span class="ident" id="8127654">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127663">if</span>&nbsp;<span class="op" id="8127666">!</span><span class="ident" id="8127667">blind</span>&nbsp;<span class="op" id="8127673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127678">rand</span>&nbsp;<span class="op" id="8127683">=</span>&nbsp;<span class="builtintype" id="8127685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127691">}</span>&nbsp;<span class="keyword" id="8127693">else</span>&nbsp;<span class="op" id="8127698">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127703">rand</span>&nbsp;<span class="op" id="8127708">=</span>&nbsp;<span class="ident" id="8127710">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127723">plaintext</span><span class="op" id="8127732">,</span>&nbsp;<span class="ident" id="8127734">err</span>&nbsp;<span class="op" id="8127738">:=</span>&nbsp;<span class="ident" id="8127741">DecryptPKCS1v15</span><span class="op" id="8127756">(</span><span class="ident" id="8127757">rand</span><span class="op" id="8127761">,</span>&nbsp;<span class="ident" id="8127763">rsaPrivateKey</span><span class="op" id="8127776">,</span>&nbsp;<span class="ident" id="8127778">ciphertext</span><span class="op" id="8127788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127792">if</span>&nbsp;<span class="ident" id="8127795">err</span>&nbsp;<span class="op" id="8127799">!=</span>&nbsp;<span class="builtintype" id="8127802">nil</span>&nbsp;<span class="op" id="8127806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127811">t</span><span class="op" id="8127812">.</span><span class="ident" id="8127813">Errorf</span><span class="op" id="8127819">(</span><span class="string" id="8127820">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8127842">,</span>&nbsp;<span class="ident" id="8127844">err</span><span class="op" id="8127847">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127852">return</span>&nbsp;<span class="builtintype" id="8127859">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127872">if</span>&nbsp;<span class="op" id="8127875">!</span><span class="ident" id="8127876">bytes</span><span class="op" id="8127881">.</span><span class="ident" id="8127882">Equal</span><span class="op" id="8127887">(</span><span class="ident" id="8127888">plaintext</span><span class="op" id="8127897">,</span>&nbsp;<span class="ident" id="8127899">in</span><span class="op" id="8127901">)</span>&nbsp;<span class="op" id="8127903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127908">t</span><span class="op" id="8127909">.</span><span class="ident" id="8127910">Errorf</span><span class="op" id="8127916">(</span><span class="string" id="8127917">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8127943">,</span>&nbsp;<span class="ident" id="8127945">plaintext</span><span class="op" id="8127954">,</span>&nbsp;<span class="ident" id="8127956">in</span><span class="op" id="8127958">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127963">return</span>&nbsp;<span class="builtintype" id="8127970">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8127982">return</span>&nbsp;<span class="builtintype" id="8127989">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8127995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8127999">config</span>&nbsp;<span class="op" id="8128006">:=</span>&nbsp;<span class="builtinfunc" id="8128009">new</span><span class="op" id="8128012">(</span><span class="ident" id="8128013">quick</span><span class="op" id="8128018">.</span><span class="ident" id="8128019">Config</span><span class="op" id="8128025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8128028">if</span>&nbsp;<span class="ident" id="8128031">testing</span><span class="op" id="8128038">.</span><span class="ident" id="8128039">Short</span><span class="op" id="8128044">(</span><span class="op" id="8128045">)</span>&nbsp;<span class="op" id="8128047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128051">config</span><span class="op" id="8128057">.</span><span class="ident" id="8128058">MaxCount</span>&nbsp;<span class="op" id="8128067">=</span>&nbsp;<span class="num" id="8128069">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128076">quick</span><span class="op" id="8128081">.</span><span class="ident" id="8128082">Check</span><span class="op" id="8128087">(</span><span class="ident" id="8128088">tryEncryptDecrypt</span><span class="op" id="8128105">,</span>&nbsp;<span class="ident" id="8128107">config</span><span class="op" id="8128113">)</span><br>
<span class="lineno">105</span><span class="op" id="8128115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8128118">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8128192">var</span>&nbsp;<span class="ident" id="8128196">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8128227">=</span>&nbsp;<span class="op" id="8128229">[</span><span class="op" id="8128230">]</span><span class="ident" id="8128231">DecryptPKCS1v15Test</span><span class="op" id="8128250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128253">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128257">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8128347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128351">&#34;1234&#34;</span><span class="op" id="8128357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128360">}</span><span class="op" id="8128361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128368">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8128458">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128462">&#34;FAIL&#34;</span><span class="op" id="8128468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128471">}</span><span class="op" id="8128472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128479">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8128569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128573">&#34;abcd&#34;</span><span class="op" id="8128579">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128582">}</span><span class="op" id="8128583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128590">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8128680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8128684">&#34;FAIL&#34;</span><span class="op" id="8128690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128693">}</span><span class="op" id="8128694">,</span><br>
<span class="lineno">125</span><span class="op" id="8128696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8128699">func</span>&nbsp;<span class="ident" id="8128704">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8128733">(</span><span class="ident" id="8128734">t</span>&nbsp;<span class="op" id="8128736">*</span><span class="ident" id="8128737">testing</span><span class="op" id="8128744">.</span><span class="ident" id="8128745">T</span><span class="op" id="8128746">)</span>&nbsp;<span class="op" id="8128748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8128751">for</span>&nbsp;<span class="ident" id="8128755">i</span><span class="op" id="8128756">,</span>&nbsp;<span class="ident" id="8128758">test</span>&nbsp;<span class="op" id="8128763">:=</span>&nbsp;<span class="keyword" id="8128766">range</span>&nbsp;<span class="ident" id="8128772">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8128803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128807">key</span>&nbsp;<span class="op" id="8128811">:=</span>&nbsp;<span class="op" id="8128814">[</span><span class="op" id="8128815">]</span><span class="builtintype" id="8128816">byte</span><span class="op" id="8128820">(</span><span class="string" id="8128821">&#34;FAIL&#34;</span><span class="op" id="8128827">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128831">err</span>&nbsp;<span class="op" id="8128835">:=</span>&nbsp;<span class="ident" id="8128838">DecryptPKCS1v15SessionKey</span><span class="op" id="8128863">(</span><span class="builtintype" id="8128864">nil</span><span class="op" id="8128867">,</span>&nbsp;<span class="ident" id="8128869">rsaPrivateKey</span><span class="op" id="8128882">,</span>&nbsp;<span class="ident" id="8128884">decodeBase64</span><span class="op" id="8128896">(</span><span class="ident" id="8128897">test</span><span class="op" id="8128901">.</span><span class="ident" id="8128902">in</span><span class="op" id="8128904">)</span><span class="op" id="8128905">,</span>&nbsp;<span class="ident" id="8128907">key</span><span class="op" id="8128910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8128914">if</span>&nbsp;<span class="ident" id="8128917">err</span>&nbsp;<span class="op" id="8128921">!=</span>&nbsp;<span class="builtintype" id="8128924">nil</span>&nbsp;<span class="op" id="8128928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128933">t</span><span class="op" id="8128934">.</span><span class="ident" id="8128935">Errorf</span><span class="op" id="8128941">(</span><span class="string" id="8128942">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8128964">,</span>&nbsp;<span class="ident" id="8128966">i</span><span class="op" id="8128967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8128971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8128975">want</span>&nbsp;<span class="op" id="8128980">:=</span>&nbsp;<span class="op" id="8128983">[</span><span class="op" id="8128984">]</span><span class="builtintype" id="8128985">byte</span><span class="op" id="8128989">(</span><span class="ident" id="8128990">test</span><span class="op" id="8128994">.</span><span class="ident" id="8128995">out</span><span class="op" id="8128998">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129002">if</span>&nbsp;<span class="op" id="8129005">!</span><span class="ident" id="8129006">bytes</span><span class="op" id="8129011">.</span><span class="ident" id="8129012">Equal</span><span class="op" id="8129017">(</span><span class="ident" id="8129018">key</span><span class="op" id="8129021">,</span>&nbsp;<span class="ident" id="8129023">want</span><span class="op" id="8129027">)</span>&nbsp;<span class="op" id="8129029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129034">t</span><span class="op" id="8129035">.</span><span class="ident" id="8129036">Errorf</span><span class="op" id="8129042">(</span><span class="string" id="8129043">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8129065">,</span>&nbsp;<span class="ident" id="8129067">i</span><span class="op" id="8129068">,</span>&nbsp;<span class="ident" id="8129070">key</span><span class="op" id="8129073">,</span>&nbsp;<span class="ident" id="8129075">want</span><span class="op" id="8129079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129086">}</span><br>
<span class="lineno"></span><span class="op" id="8129088">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8129091">func</span>&nbsp;<span class="ident" id="8129096">TestNonZeroRandomBytes</span><span class="op" id="8129118">(</span><span class="ident" id="8129119">t</span>&nbsp;<span class="op" id="8129121">*</span><span class="ident" id="8129122">testing</span><span class="op" id="8129129">.</span><span class="ident" id="8129130">T</span><span class="op" id="8129131">)</span>&nbsp;<span class="op" id="8129133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129136">random</span>&nbsp;<span class="op" id="8129143">:=</span>&nbsp;<span class="ident" id="8129146">rand</span><span class="op" id="8129150">.</span><span class="ident" id="8129151">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129160">b</span>&nbsp;<span class="op" id="8129162">:=</span>&nbsp;<span class="builtinfunc" id="8129165">make</span><span class="op" id="8129169">(</span><span class="op" id="8129170">[</span><span class="op" id="8129171">]</span><span class="builtintype" id="8129172">byte</span><span class="op" id="8129176">,</span>&nbsp;<span class="num" id="8129178">512</span><span class="op" id="8129181">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129184">err</span>&nbsp;<span class="op" id="8129188">:=</span>&nbsp;<span class="ident" id="8129191">nonZeroRandomBytes</span><span class="op" id="8129209">(</span><span class="ident" id="8129210">b</span><span class="op" id="8129211">,</span>&nbsp;<span class="ident" id="8129213">random</span><span class="op" id="8129219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129222">if</span>&nbsp;<span class="ident" id="8129225">err</span>&nbsp;<span class="op" id="8129229">!=</span>&nbsp;<span class="builtintype" id="8129232">nil</span>&nbsp;<span class="op" id="8129236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129240">t</span><span class="op" id="8129241">.</span><span class="ident" id="8129242">Errorf</span><span class="op" id="8129248">(</span><span class="string" id="8129249">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8129269">,</span>&nbsp;<span class="ident" id="8129271">err</span><span class="op" id="8129274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129280">for</span>&nbsp;<span class="ident" id="8129284">_</span><span class="op" id="8129285">,</span>&nbsp;<span class="ident" id="8129287">b</span>&nbsp;<span class="op" id="8129289">:=</span>&nbsp;<span class="keyword" id="8129292">range</span>&nbsp;<span class="ident" id="8129298">b</span>&nbsp;<span class="op" id="8129300">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129304">if</span>&nbsp;<span class="ident" id="8129307">b</span>&nbsp;<span class="op" id="8129309">==</span>&nbsp;<span class="num" id="8129312">0</span>&nbsp;<span class="op" id="8129314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129319">t</span><span class="op" id="8129320">.</span><span class="ident" id="8129321">Errorf</span><span class="op" id="8129327">(</span><span class="string" id="8129328">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8129346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129351">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129363">}</span><br>
<span class="lineno">155</span><span class="op" id="8129365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129368">type</span>&nbsp;<span class="ident" id="8129373">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8129390">struct</span>&nbsp;<span class="op" id="8129397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129400">in</span><span class="op" id="8129402">,</span>&nbsp;<span class="ident" id="8129404">out</span>&nbsp;<span class="builtintype" id="8129408">string</span><br>
<span class="lineno"></span><span class="op" id="8129415">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8129418">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8129457">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8129524">var</span>&nbsp;<span class="ident" id="8129528">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8129546">=</span>&nbsp;<span class="op" id="8129548">[</span><span class="op" id="8129549">]</span><span class="ident" id="8129550">signPKCS1v15Test</span><span class="op" id="8129566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129569">{</span><span class="string" id="8129570">&#34;Test.\n&#34;</span><span class="op" id="8129579">,</span>&nbsp;<span class="string" id="8129581">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8129711">}</span><span class="op" id="8129712">,</span><br>
<span class="lineno">165</span><span class="op" id="8129714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129717">func</span>&nbsp;<span class="ident" id="8129722">TestSignPKCS1v15</span><span class="op" id="8129738">(</span><span class="ident" id="8129739">t</span>&nbsp;<span class="op" id="8129741">*</span><span class="ident" id="8129742">testing</span><span class="op" id="8129749">.</span><span class="ident" id="8129750">T</span><span class="op" id="8129751">)</span>&nbsp;<span class="op" id="8129753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129756">for</span>&nbsp;<span class="ident" id="8129760">i</span><span class="op" id="8129761">,</span>&nbsp;<span class="ident" id="8129763">test</span>&nbsp;<span class="op" id="8129768">:=</span>&nbsp;<span class="keyword" id="8129771">range</span>&nbsp;<span class="ident" id="8129777">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8129795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129799">h</span>&nbsp;<span class="op" id="8129801">:=</span>&nbsp;<span class="ident" id="8129804">sha1</span><span class="op" id="8129808">.</span><span class="ident" id="8129809">New</span><span class="op" id="8129812">(</span><span class="op" id="8129813">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129817">h</span><span class="op" id="8129818">.</span><span class="ident" id="8129819">Write</span><span class="op" id="8129824">(</span><span class="op" id="8129825">[</span><span class="op" id="8129826">]</span><span class="builtintype" id="8129827">byte</span><span class="op" id="8129831">(</span><span class="ident" id="8129832">test</span><span class="op" id="8129836">.</span><span class="ident" id="8129837">in</span><span class="op" id="8129839">)</span><span class="op" id="8129840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129844">digest</span>&nbsp;<span class="op" id="8129851">:=</span>&nbsp;<span class="ident" id="8129854">h</span><span class="op" id="8129855">.</span><span class="ident" id="8129856">Sum</span><span class="op" id="8129859">(</span><span class="builtintype" id="8129860">nil</span><span class="op" id="8129863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129868">s</span><span class="op" id="8129869">,</span>&nbsp;<span class="ident" id="8129871">err</span>&nbsp;<span class="op" id="8129875">:=</span>&nbsp;<span class="ident" id="8129878">SignPKCS1v15</span><span class="op" id="8129890">(</span><span class="builtintype" id="8129891">nil</span><span class="op" id="8129894">,</span>&nbsp;<span class="ident" id="8129896">rsaPrivateKey</span><span class="op" id="8129909">,</span>&nbsp;<span class="ident" id="8129911">crypto</span><span class="op" id="8129917">.</span><span class="ident" id="8129918">SHA1</span><span class="op" id="8129922">,</span>&nbsp;<span class="ident" id="8129924">digest</span><span class="op" id="8129930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8129934">if</span>&nbsp;<span class="ident" id="8129937">err</span>&nbsp;<span class="op" id="8129941">!=</span>&nbsp;<span class="builtintype" id="8129944">nil</span>&nbsp;<span class="op" id="8129948">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129953">t</span><span class="op" id="8129954">.</span><span class="ident" id="8129955">Errorf</span><span class="op" id="8129961">(</span><span class="string" id="8129962">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8129970">,</span>&nbsp;<span class="ident" id="8129972">i</span><span class="op" id="8129973">,</span>&nbsp;<span class="ident" id="8129975">err</span><span class="op" id="8129978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8129987">expected</span><span class="op" id="8129995">,</span>&nbsp;<span class="ident" id="8129997">_</span>&nbsp;<span class="op" id="8129999">:=</span>&nbsp;<span class="ident" id="8130002">hex</span><span class="op" id="8130005">.</span><span class="ident" id="8130006">DecodeString</span><span class="op" id="8130018">(</span><span class="ident" id="8130019">test</span><span class="op" id="8130023">.</span><span class="ident" id="8130024">out</span><span class="op" id="8130027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8130031">if</span>&nbsp;<span class="op" id="8130034">!</span><span class="ident" id="8130035">bytes</span><span class="op" id="8130040">.</span><span class="ident" id="8130041">Equal</span><span class="op" id="8130046">(</span><span class="ident" id="8130047">s</span><span class="op" id="8130048">,</span>&nbsp;<span class="ident" id="8130050">expected</span><span class="op" id="8130058">)</span>&nbsp;<span class="op" id="8130060">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130065">t</span><span class="op" id="8130066">.</span><span class="ident" id="8130067">Errorf</span><span class="op" id="8130073">(</span><span class="string" id="8130074">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8130096">,</span>&nbsp;<span class="ident" id="8130098">i</span><span class="op" id="8130099">,</span>&nbsp;<span class="ident" id="8130101">s</span><span class="op" id="8130102">,</span>&nbsp;<span class="ident" id="8130104">expected</span><span class="op" id="8130112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130119">}</span><br>
<span class="lineno"></span><span class="op" id="8130121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8130124">func</span>&nbsp;<span class="ident" id="8130129">TestVerifyPKCS1v15</span><span class="op" id="8130147">(</span><span class="ident" id="8130148">t</span>&nbsp;<span class="op" id="8130150">*</span><span class="ident" id="8130151">testing</span><span class="op" id="8130158">.</span><span class="ident" id="8130159">T</span><span class="op" id="8130160">)</span>&nbsp;<span class="op" id="8130162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8130165">for</span>&nbsp;<span class="ident" id="8130169">i</span><span class="op" id="8130170">,</span>&nbsp;<span class="ident" id="8130172">test</span>&nbsp;<span class="op" id="8130177">:=</span>&nbsp;<span class="keyword" id="8130180">range</span>&nbsp;<span class="ident" id="8130186">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8130204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130208">h</span>&nbsp;<span class="op" id="8130210">:=</span>&nbsp;<span class="ident" id="8130213">sha1</span><span class="op" id="8130217">.</span><span class="ident" id="8130218">New</span><span class="op" id="8130221">(</span><span class="op" id="8130222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130226">h</span><span class="op" id="8130227">.</span><span class="ident" id="8130228">Write</span><span class="op" id="8130233">(</span><span class="op" id="8130234">[</span><span class="op" id="8130235">]</span><span class="builtintype" id="8130236">byte</span><span class="op" id="8130240">(</span><span class="ident" id="8130241">test</span><span class="op" id="8130245">.</span><span class="ident" id="8130246">in</span><span class="op" id="8130248">)</span><span class="op" id="8130249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130253">digest</span>&nbsp;<span class="op" id="8130260">:=</span>&nbsp;<span class="ident" id="8130263">h</span><span class="op" id="8130264">.</span><span class="ident" id="8130265">Sum</span><span class="op" id="8130268">(</span><span class="builtintype" id="8130269">nil</span><span class="op" id="8130272">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130277">sig</span><span class="op" id="8130280">,</span>&nbsp;<span class="ident" id="8130282">_</span>&nbsp;<span class="op" id="8130284">:=</span>&nbsp;<span class="ident" id="8130287">hex</span><span class="op" id="8130290">.</span><span class="ident" id="8130291">DecodeString</span><span class="op" id="8130303">(</span><span class="ident" id="8130304">test</span><span class="op" id="8130308">.</span><span class="ident" id="8130309">out</span><span class="op" id="8130312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130317">err</span>&nbsp;<span class="op" id="8130321">:=</span>&nbsp;<span class="ident" id="8130324">VerifyPKCS1v15</span><span class="op" id="8130338">(</span><span class="op" id="8130339">&amp;</span><span class="ident" id="8130340">rsaPrivateKey</span><span class="op" id="8130353">.</span><span class="ident" id="8130354">PublicKey</span><span class="op" id="8130363">,</span>&nbsp;<span class="ident" id="8130365">crypto</span><span class="op" id="8130371">.</span><span class="ident" id="8130372">SHA1</span><span class="op" id="8130376">,</span>&nbsp;<span class="ident" id="8130378">digest</span><span class="op" id="8130384">,</span>&nbsp;<span class="ident" id="8130386">sig</span><span class="op" id="8130389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8130393">if</span>&nbsp;<span class="ident" id="8130396">err</span>&nbsp;<span class="op" id="8130400">!=</span>&nbsp;<span class="builtintype" id="8130403">nil</span>&nbsp;<span class="op" id="8130407">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130412">t</span><span class="op" id="8130413">.</span><span class="ident" id="8130414">Errorf</span><span class="op" id="8130420">(</span><span class="string" id="8130421">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8130429">,</span>&nbsp;<span class="ident" id="8130431">i</span><span class="op" id="8130432">,</span>&nbsp;<span class="ident" id="8130434">err</span><span class="op" id="8130437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130444">}</span><br>
<span class="lineno"></span><span class="op" id="8130446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8130449">func</span>&nbsp;<span class="ident" id="8130454">TestOverlongMessagePKCS1v15</span><span class="op" id="8130481">(</span><span class="ident" id="8130482">t</span>&nbsp;<span class="op" id="8130484">*</span><span class="ident" id="8130485">testing</span><span class="op" id="8130492">.</span><span class="ident" id="8130493">T</span><span class="op" id="8130494">)</span>&nbsp;<span class="op" id="8130496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130499">ciphertext</span>&nbsp;<span class="op" id="8130510">:=</span>&nbsp;<span class="ident" id="8130513">decodeBase64</span><span class="op" id="8130525">(</span><span class="string" id="8130526">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8130618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130621">_</span><span class="op" id="8130622">,</span>&nbsp;<span class="ident" id="8130624">err</span>&nbsp;<span class="op" id="8130628">:=</span>&nbsp;<span class="ident" id="8130631">DecryptPKCS1v15</span><span class="op" id="8130646">(</span><span class="builtintype" id="8130647">nil</span><span class="op" id="8130650">,</span>&nbsp;<span class="ident" id="8130652">rsaPrivateKey</span><span class="op" id="8130665">,</span>&nbsp;<span class="ident" id="8130667">ciphertext</span><span class="op" id="8130677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8130680">if</span>&nbsp;<span class="ident" id="8130683">err</span>&nbsp;<span class="op" id="8130687">==</span>&nbsp;<span class="builtintype" id="8130690">nil</span>&nbsp;<span class="op" id="8130694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130698">t</span><span class="op" id="8130699">.</span><span class="ident" id="8130700">Error</span><span class="op" id="8130705">(</span><span class="string" id="8130706">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8130750">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130753">}</span><br>
<span class="lineno"></span><span class="op" id="8130755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8130758">func</span>&nbsp;<span class="ident" id="8130763">TestUnpaddedSignature</span><span class="op" id="8130784">(</span><span class="ident" id="8130785">t</span>&nbsp;<span class="op" id="8130787">*</span><span class="ident" id="8130788">testing</span><span class="op" id="8130795">.</span><span class="ident" id="8130796">T</span><span class="op" id="8130797">)</span>&nbsp;<span class="op" id="8130799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8130802">msg</span>&nbsp;<span class="op" id="8130806">:=</span>&nbsp;<span class="op" id="8130809">[</span><span class="op" id="8130810">]</span><span class="builtintype" id="8130811">byte</span><span class="op" id="8130815">(</span><span class="string" id="8130816">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8130848">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8130851">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8130893">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8130944">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8131009">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8131013">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8131086">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131096">expectedSig</span>&nbsp;<span class="op" id="8131108">:=</span>&nbsp;<span class="ident" id="8131111">decodeBase64</span><span class="op" id="8131123">(</span><span class="string" id="8131124">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8131214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131218">sig</span><span class="op" id="8131221">,</span>&nbsp;<span class="ident" id="8131223">err</span>&nbsp;<span class="op" id="8131227">:=</span>&nbsp;<span class="ident" id="8131230">SignPKCS1v15</span><span class="op" id="8131242">(</span><span class="builtintype" id="8131243">nil</span><span class="op" id="8131246">,</span>&nbsp;<span class="ident" id="8131248">rsaPrivateKey</span><span class="op" id="8131261">,</span>&nbsp;<span class="ident" id="8131263">crypto</span><span class="op" id="8131269">.</span><span class="ident" id="8131270">Hash</span><span class="op" id="8131274">(</span><span class="num" id="8131275">0</span><span class="op" id="8131276">)</span><span class="op" id="8131277">,</span>&nbsp;<span class="ident" id="8131279">msg</span><span class="op" id="8131282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131285">if</span>&nbsp;<span class="ident" id="8131288">err</span>&nbsp;<span class="op" id="8131292">!=</span>&nbsp;<span class="builtintype" id="8131295">nil</span>&nbsp;<span class="op" id="8131299">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131303">t</span><span class="op" id="8131304">.</span><span class="ident" id="8131305">Fatalf</span><span class="op" id="8131311">(</span><span class="string" id="8131312">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8131337">,</span>&nbsp;<span class="ident" id="8131339">err</span><span class="op" id="8131342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8131345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131348">if</span>&nbsp;<span class="op" id="8131351">!</span><span class="ident" id="8131352">bytes</span><span class="op" id="8131357">.</span><span class="ident" id="8131358">Equal</span><span class="op" id="8131363">(</span><span class="ident" id="8131364">sig</span><span class="op" id="8131367">,</span>&nbsp;<span class="ident" id="8131369">expectedSig</span><span class="op" id="8131380">)</span>&nbsp;<span class="op" id="8131382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131386">t</span><span class="op" id="8131387">.</span><span class="ident" id="8131388">Fatalf</span><span class="op" id="8131394">(</span><span class="string" id="8131395">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8131445">,</span>&nbsp;<span class="ident" id="8131447">sig</span><span class="op" id="8131450">,</span>&nbsp;<span class="ident" id="8131452">expectedSig</span><span class="op" id="8131463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8131466">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131469">if</span>&nbsp;<span class="ident" id="8131472">err</span>&nbsp;<span class="op" id="8131476">:=</span>&nbsp;<span class="ident" id="8131479">VerifyPKCS1v15</span><span class="op" id="8131493">(</span><span class="op" id="8131494">&amp;</span><span class="ident" id="8131495">rsaPrivateKey</span><span class="op" id="8131508">.</span><span class="ident" id="8131509">PublicKey</span><span class="op" id="8131518">,</span>&nbsp;<span class="ident" id="8131520">crypto</span><span class="op" id="8131526">.</span><span class="ident" id="8131527">Hash</span><span class="op" id="8131531">(</span><span class="num" id="8131532">0</span><span class="op" id="8131533">)</span><span class="op" id="8131534">,</span>&nbsp;<span class="ident" id="8131536">msg</span><span class="op" id="8131539">,</span>&nbsp;<span class="ident" id="8131541">sig</span><span class="op" id="8131544">)</span><span class="op" id="8131545">;</span>&nbsp;<span class="ident" id="8131547">err</span>&nbsp;<span class="op" id="8131551">!=</span>&nbsp;<span class="builtintype" id="8131554">nil</span>&nbsp;<span class="op" id="8131558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131562">t</span><span class="op" id="8131563">.</span><span class="ident" id="8131564">Fatalf</span><span class="op" id="8131570">(</span><span class="string" id="8131571">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8131603">,</span>&nbsp;<span class="ident" id="8131605">err</span><span class="op" id="8131608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8131611">}</span><br>
<span class="lineno"></span><span class="op" id="8131613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8131616">func</span>&nbsp;<span class="ident" id="8131621">TestShortSessionKey</span><span class="op" id="8131640">(</span><span class="ident" id="8131641">t</span>&nbsp;<span class="op" id="8131643">*</span><span class="ident" id="8131644">testing</span><span class="op" id="8131651">.</span><span class="ident" id="8131652">T</span><span class="op" id="8131653">)</span>&nbsp;<span class="op" id="8131655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8131658">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8131724">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131790">ciphertext</span><span class="op" id="8131800">,</span>&nbsp;<span class="ident" id="8131802">err</span>&nbsp;<span class="op" id="8131806">:=</span>&nbsp;<span class="ident" id="8131809">EncryptPKCS1v15</span><span class="op" id="8131824">(</span><span class="ident" id="8131825">rand</span><span class="op" id="8131829">.</span><span class="ident" id="8131830">Reader</span><span class="op" id="8131836">,</span>&nbsp;<span class="op" id="8131838">&amp;</span><span class="ident" id="8131839">rsaPrivateKey</span><span class="op" id="8131852">.</span><span class="ident" id="8131853">PublicKey</span><span class="op" id="8131862">,</span>&nbsp;<span class="op" id="8131864">[</span><span class="op" id="8131865">]</span><span class="builtintype" id="8131866">byte</span><span class="op" id="8131870">{</span><span class="num" id="8131871">1</span><span class="op" id="8131872">}</span><span class="op" id="8131873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131876">if</span>&nbsp;<span class="ident" id="8131879">err</span>&nbsp;<span class="op" id="8131883">!=</span>&nbsp;<span class="builtintype" id="8131886">nil</span>&nbsp;<span class="op" id="8131890">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8131894">t</span><span class="op" id="8131895">.</span><span class="ident" id="8131896">Fatalf</span><span class="op" id="8131902">(</span><span class="string" id="8131903">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8131940">,</span>&nbsp;<span class="ident" id="8131942">err</span><span class="op" id="8131945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8131948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131952">var</span>&nbsp;<span class="ident" id="8131956">key</span>&nbsp;<span class="op" id="8131960">[</span><span class="num" id="8131961">32</span><span class="op" id="8131963">]</span><span class="builtintype" id="8131964">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8131970">if</span>&nbsp;<span class="ident" id="8131973">err</span>&nbsp;<span class="op" id="8131977">:=</span>&nbsp;<span class="ident" id="8131980">DecryptPKCS1v15SessionKey</span><span class="op" id="8132005">(</span><span class="builtintype" id="8132006">nil</span><span class="op" id="8132009">,</span>&nbsp;<span class="ident" id="8132011">rsaPrivateKey</span><span class="op" id="8132024">,</span>&nbsp;<span class="ident" id="8132026">ciphertext</span><span class="op" id="8132036">,</span>&nbsp;<span class="ident" id="8132038">key</span><span class="op" id="8132041">[</span><span class="op" id="8132042">:</span><span class="op" id="8132043">]</span><span class="op" id="8132044">)</span><span class="op" id="8132045">;</span>&nbsp;<span class="ident" id="8132047">err</span>&nbsp;<span class="op" id="8132051">!=</span>&nbsp;<span class="builtintype" id="8132054">nil</span>&nbsp;<span class="op" id="8132058">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8132062">t</span><span class="op" id="8132063">.</span><span class="ident" id="8132064">Fatalf</span><span class="op" id="8132070">(</span><span class="string" id="8132071">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8132108">,</span>&nbsp;<span class="ident" id="8132110">err</span><span class="op" id="8132113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8132116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8132120">for</span>&nbsp;<span class="ident" id="8132124">_</span><span class="op" id="8132125">,</span>&nbsp;<span class="ident" id="8132127">v</span>&nbsp;<span class="op" id="8132129">:=</span>&nbsp;<span class="keyword" id="8132132">range</span>&nbsp;<span class="ident" id="8132138">key</span>&nbsp;<span class="op" id="8132142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8132146">if</span>&nbsp;<span class="ident" id="8132149">v</span>&nbsp;<span class="op" id="8132151">!=</span>&nbsp;<span class="num" id="8132154">0</span>&nbsp;<span class="op" id="8132156">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8132161">t</span><span class="op" id="8132162">.</span><span class="ident" id="8132163">Fatal</span><span class="op" id="8132168">(</span><span class="string" id="8132169">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8132215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8132219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8132222">}</span><br>
<span class="lineno"></span><span class="op" id="8132224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8132227">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8132306">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8132341">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8132409">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8132477">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8132545">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8132613">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8132681">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8132749">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8132793">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8132827">var</span>&nbsp;<span class="ident" id="8132831">rsaPrivateKey</span>&nbsp;<span class="op" id="8132845">=</span>&nbsp;<span class="op" id="8132847">&amp;</span><span class="ident" id="8132848">PrivateKey</span><span class="op" id="8132858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8132861">PublicKey</span><span class="op" id="8132870">:</span>&nbsp;<span class="ident" id="8132872">PublicKey</span><span class="op" id="8132881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8132885">N</span><span class="op" id="8132886">:</span>&nbsp;<span class="ident" id="8132888">fromBase10</span><span class="op" id="8132898">(</span><span class="string" id="8132899">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8133055">)</span><span class="op" id="8133056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133060">E</span><span class="op" id="8133061">:</span>&nbsp;<span class="num" id="8133063">65537</span><span class="op" id="8133068">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8133071">}</span><span class="op" id="8133072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133075">D</span><span class="op" id="8133076">:</span>&nbsp;<span class="ident" id="8133078">fromBase10</span><span class="op" id="8133088">(</span><span class="string" id="8133089">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8133245">)</span><span class="op" id="8133246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133249">Primes</span><span class="op" id="8133255">:</span>&nbsp;<span class="op" id="8133257">[</span><span class="op" id="8133258">]</span><span class="op" id="8133259">*</span><span class="ident" id="8133260">big</span><span class="op" id="8133263">.</span><span class="ident" id="8133264">Int</span><span class="op" id="8133267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133271">fromBase10</span><span class="op" id="8133281">(</span><span class="string" id="8133282">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8133361">)</span><span class="op" id="8133362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133366">fromBase10</span><span class="op" id="8133376">(</span><span class="string" id="8133377">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8133456">)</span><span class="op" id="8133457">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8133460">}</span><span class="op" id="8133461">,</span><br>
<span class="lineno"></span><span class="op" id="8133463">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
