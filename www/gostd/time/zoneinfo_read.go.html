<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2865666">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2865721">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2865775">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2865826">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2865862">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2865946">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2866003">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2866042">package</span>&nbsp;<span class="ident" id="2866050">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2866056">import</span>&nbsp;<span class="string" id="2866063">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2866073">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2866121">type</span>&nbsp;<span class="ident" id="2866126">data</span>&nbsp;<span class="keyword" id="2866131">struct</span>&nbsp;<span class="op" id="2866138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866141">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866147">[</span><span class="op" id="2866148">]</span><span class="builtintype" id="2866149">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2866155">error</span>&nbsp;<span class="builtintype" id="2866161">bool</span><br>
<span class="lineno"></span><span class="op" id="2866166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2866169">func</span>&nbsp;<span class="op" id="2866174">(</span><span class="ident" id="2866175">d</span>&nbsp;<span class="op" id="2866177">*</span><span class="ident" id="2866178">data</span><span class="op" id="2866182">)</span>&nbsp;<span class="ident" id="2866184">read</span><span class="op" id="2866188">(</span><span class="ident" id="2866189">n</span>&nbsp;<span class="builtintype" id="2866191">int</span><span class="op" id="2866194">)</span>&nbsp;<span class="op" id="2866196">[</span><span class="op" id="2866197">]</span><span class="builtintype" id="2866198">byte</span>&nbsp;<span class="op" id="2866203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866206">if</span>&nbsp;<span class="builtinfunc" id="2866209">len</span><span class="op" id="2866212">(</span><span class="ident" id="2866213">d</span><span class="op" id="2866214">.</span><span class="ident" id="2866215">p</span><span class="op" id="2866216">)</span>&nbsp;<span class="op" id="2866218">&lt;</span>&nbsp;<span class="ident" id="2866220">n</span>&nbsp;<span class="op" id="2866222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866226">d</span><span class="op" id="2866227">.</span><span class="ident" id="2866228">p</span>&nbsp;<span class="op" id="2866230">=</span>&nbsp;<span class="ident" id="2866232">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866238">d</span><span class="op" id="2866239">.</span><span class="builtintype" id="2866240">error</span>&nbsp;<span class="op" id="2866246">=</span>&nbsp;<span class="builtintype" id="2866248">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866255">return</span>&nbsp;<span class="ident" id="2866262">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2866267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866270">p</span>&nbsp;<span class="op" id="2866272">:=</span>&nbsp;<span class="ident" id="2866275">d</span><span class="op" id="2866276">.</span><span class="ident" id="2866277">p</span><span class="op" id="2866278">[</span><span class="num" id="2866279">0</span><span class="op" id="2866280">:</span><span class="ident" id="2866281">n</span><span class="op" id="2866282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866285">d</span><span class="op" id="2866286">.</span><span class="ident" id="2866287">p</span>&nbsp;<span class="op" id="2866289">=</span>&nbsp;<span class="ident" id="2866291">d</span><span class="op" id="2866292">.</span><span class="ident" id="2866293">p</span><span class="op" id="2866294">[</span><span class="ident" id="2866295">n</span><span class="op" id="2866296">:</span><span class="op" id="2866297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866300">return</span>&nbsp;<span class="ident" id="2866307">p</span><br>
<span class="lineno"></span><span class="op" id="2866309">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2866312">func</span>&nbsp;<span class="op" id="2866317">(</span><span class="ident" id="2866318">d</span>&nbsp;<span class="op" id="2866320">*</span><span class="ident" id="2866321">data</span><span class="op" id="2866325">)</span>&nbsp;<span class="ident" id="2866327">big4</span><span class="op" id="2866331">(</span><span class="op" id="2866332">)</span>&nbsp;<span class="op" id="2866334">(</span><span class="ident" id="2866335">n</span>&nbsp;<span class="builtintype" id="2866337">uint32</span><span class="op" id="2866343">,</span>&nbsp;<span class="ident" id="2866345">ok</span>&nbsp;<span class="builtintype" id="2866348">bool</span><span class="op" id="2866352">)</span>&nbsp;<span class="op" id="2866354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866357">p</span>&nbsp;<span class="op" id="2866359">:=</span>&nbsp;<span class="ident" id="2866362">d</span><span class="op" id="2866363">.</span><span class="ident" id="2866364">read</span><span class="op" id="2866368">(</span><span class="num" id="2866369">4</span><span class="op" id="2866370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866373">if</span>&nbsp;<span class="builtinfunc" id="2866376">len</span><span class="op" id="2866379">(</span><span class="ident" id="2866380">p</span><span class="op" id="2866381">)</span>&nbsp;<span class="op" id="2866383">&lt;</span>&nbsp;<span class="num" id="2866385">4</span>&nbsp;<span class="op" id="2866387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866391">d</span><span class="op" id="2866392">.</span><span class="builtintype" id="2866393">error</span>&nbsp;<span class="op" id="2866399">=</span>&nbsp;<span class="builtintype" id="2866401">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866408">return</span>&nbsp;<span class="num" id="2866415">0</span><span class="op" id="2866416">,</span>&nbsp;<span class="builtintype" id="2866418">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2866425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866428">return</span>&nbsp;<span class="builtintype" id="2866435">uint32</span><span class="op" id="2866441">(</span><span class="ident" id="2866442">p</span><span class="op" id="2866443">[</span><span class="num" id="2866444">0</span><span class="op" id="2866445">]</span><span class="op" id="2866446">)</span><span class="op" id="2866447">&lt;&lt;</span><span class="num" id="2866449">24</span>&nbsp;<span class="op" id="2866452">|</span>&nbsp;<span class="builtintype" id="2866454">uint32</span><span class="op" id="2866460">(</span><span class="ident" id="2866461">p</span><span class="op" id="2866462">[</span><span class="num" id="2866463">1</span><span class="op" id="2866464">]</span><span class="op" id="2866465">)</span><span class="op" id="2866466">&lt;&lt;</span><span class="num" id="2866468">16</span>&nbsp;<span class="op" id="2866471">|</span>&nbsp;<span class="builtintype" id="2866473">uint32</span><span class="op" id="2866479">(</span><span class="ident" id="2866480">p</span><span class="op" id="2866481">[</span><span class="num" id="2866482">2</span><span class="op" id="2866483">]</span><span class="op" id="2866484">)</span><span class="op" id="2866485">&lt;&lt;</span><span class="num" id="2866487">8</span>&nbsp;<span class="op" id="2866489">|</span>&nbsp;<span class="builtintype" id="2866491">uint32</span><span class="op" id="2866497">(</span><span class="ident" id="2866498">p</span><span class="op" id="2866499">[</span><span class="num" id="2866500">3</span><span class="op" id="2866501">]</span><span class="op" id="2866502">)</span><span class="op" id="2866503">,</span>&nbsp;<span class="builtintype" id="2866505">true</span><br>
<span class="lineno"></span><span class="op" id="2866510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2866513">func</span>&nbsp;<span class="op" id="2866518">(</span><span class="ident" id="2866519">d</span>&nbsp;<span class="op" id="2866521">*</span><span class="ident" id="2866522">data</span><span class="op" id="2866526">)</span>&nbsp;<span class="builtintype" id="2866528">byte</span><span class="op" id="2866532">(</span><span class="op" id="2866533">)</span>&nbsp;<span class="op" id="2866535">(</span><span class="ident" id="2866536">n</span>&nbsp;<span class="builtintype" id="2866538">byte</span><span class="op" id="2866542">,</span>&nbsp;<span class="ident" id="2866544">ok</span>&nbsp;<span class="builtintype" id="2866547">bool</span><span class="op" id="2866551">)</span>&nbsp;<span class="op" id="2866553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866556">p</span>&nbsp;<span class="op" id="2866558">:=</span>&nbsp;<span class="ident" id="2866561">d</span><span class="op" id="2866562">.</span><span class="ident" id="2866563">read</span><span class="op" id="2866567">(</span><span class="num" id="2866568">1</span><span class="op" id="2866569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866572">if</span>&nbsp;<span class="builtinfunc" id="2866575">len</span><span class="op" id="2866578">(</span><span class="ident" id="2866579">p</span><span class="op" id="2866580">)</span>&nbsp;<span class="op" id="2866582">&lt;</span>&nbsp;<span class="num" id="2866584">1</span>&nbsp;<span class="op" id="2866586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866590">d</span><span class="op" id="2866591">.</span><span class="builtintype" id="2866592">error</span>&nbsp;<span class="op" id="2866598">=</span>&nbsp;<span class="builtintype" id="2866600">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866607">return</span>&nbsp;<span class="num" id="2866614">0</span><span class="op" id="2866615">,</span>&nbsp;<span class="builtintype" id="2866617">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2866624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866627">return</span>&nbsp;<span class="ident" id="2866634">p</span><span class="op" id="2866635">[</span><span class="num" id="2866636">0</span><span class="op" id="2866637">]</span><span class="op" id="2866638">,</span>&nbsp;<span class="builtintype" id="2866640">true</span><br>
<span class="lineno"></span><span class="op" id="2866645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2866648">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2866694">func</span>&nbsp;<span class="ident" id="2866699">byteString</span><span class="op" id="2866709">(</span><span class="ident" id="2866710">p</span>&nbsp;<span class="op" id="2866712">[</span><span class="op" id="2866713">]</span><span class="builtintype" id="2866714">byte</span><span class="op" id="2866718">)</span>&nbsp;<span class="builtintype" id="2866720">string</span>&nbsp;<span class="op" id="2866727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866730">for</span>&nbsp;<span class="ident" id="2866734">i</span>&nbsp;<span class="op" id="2866736">:=</span>&nbsp;<span class="num" id="2866739">0</span><span class="op" id="2866740">;</span>&nbsp;<span class="ident" id="2866742">i</span>&nbsp;<span class="op" id="2866744">&lt;</span>&nbsp;<span class="builtinfunc" id="2866746">len</span><span class="op" id="2866749">(</span><span class="ident" id="2866750">p</span><span class="op" id="2866751">)</span><span class="op" id="2866752">;</span>&nbsp;<span class="ident" id="2866754">i</span><span class="op" id="2866755">++</span>&nbsp;<span class="op" id="2866758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866762">if</span>&nbsp;<span class="ident" id="2866765">p</span><span class="op" id="2866766">[</span><span class="ident" id="2866767">i</span><span class="op" id="2866768">]</span>&nbsp;<span class="op" id="2866770">==</span>&nbsp;<span class="num" id="2866773">0</span>&nbsp;<span class="op" id="2866775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866780">return</span>&nbsp;<span class="builtintype" id="2866787">string</span><span class="op" id="2866793">(</span><span class="ident" id="2866794">p</span><span class="op" id="2866795">[</span><span class="num" id="2866796">0</span><span class="op" id="2866797">:</span><span class="ident" id="2866798">i</span><span class="op" id="2866799">]</span><span class="op" id="2866800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2866804">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2866807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2866810">return</span>&nbsp;<span class="builtintype" id="2866817">string</span><span class="op" id="2866823">(</span><span class="ident" id="2866824">p</span><span class="op" id="2866825">)</span><br>
<span class="lineno"></span><span class="op" id="2866827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2866830">var</span>&nbsp;<span class="ident" id="2866834">badData</span>&nbsp;<span class="op" id="2866842">=</span>&nbsp;<span class="ident" id="2866844">errors</span><span class="op" id="2866850">.</span><span class="ident" id="2866851">New</span><span class="op" id="2866854">(</span><span class="string" id="2866855">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2866888">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2866891">func</span>&nbsp;<span class="ident" id="2866896">loadZoneData</span><span class="op" id="2866908">(</span><span class="ident" id="2866909">bytes</span>&nbsp;<span class="op" id="2866915">[</span><span class="op" id="2866916">]</span><span class="builtintype" id="2866917">byte</span><span class="op" id="2866921">)</span>&nbsp;<span class="op" id="2866923">(</span><span class="ident" id="2866924">l</span>&nbsp;<span class="op" id="2866926">*</span><span class="ident" id="2866927">Location</span><span class="op" id="2866935">,</span>&nbsp;<span class="ident" id="2866937">err</span>&nbsp;<span class="builtintype" id="2866941">error</span><span class="op" id="2866946">)</span>&nbsp;<span class="op" id="2866948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2866951">d</span>&nbsp;<span class="op" id="2866953">:=</span>&nbsp;<span class="ident" id="2866956">data</span><span class="op" id="2866960">{</span><span class="ident" id="2866961">bytes</span><span class="op" id="2866966">,</span>&nbsp;<span class="builtintype" id="2866968">false</span><span class="op" id="2866973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2866977">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867001">if</span>&nbsp;<span class="ident" id="2867004">magic</span>&nbsp;<span class="op" id="2867010">:=</span>&nbsp;<span class="ident" id="2867013">d</span><span class="op" id="2867014">.</span><span class="ident" id="2867015">read</span><span class="op" id="2867019">(</span><span class="num" id="2867020">4</span><span class="op" id="2867021">)</span><span class="op" id="2867022">;</span>&nbsp;<span class="builtintype" id="2867024">string</span><span class="op" id="2867030">(</span><span class="ident" id="2867031">magic</span><span class="op" id="2867036">)</span>&nbsp;<span class="op" id="2867038">!=</span>&nbsp;<span class="string" id="2867041">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2867048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867052">return</span>&nbsp;<span class="ident" id="2867059">nil</span><span class="op" id="2867062">,</span>&nbsp;<span class="ident" id="2867064">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2867073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867077">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867122">var</span>&nbsp;<span class="ident" id="2867126">p</span>&nbsp;<span class="op" id="2867128">[</span><span class="op" id="2867129">]</span><span class="builtintype" id="2867130">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867136">if</span>&nbsp;<span class="ident" id="2867139">p</span>&nbsp;<span class="op" id="2867141">=</span>&nbsp;<span class="ident" id="2867143">d</span><span class="op" id="2867144">.</span><span class="ident" id="2867145">read</span><span class="op" id="2867149">(</span><span class="num" id="2867150">16</span><span class="op" id="2867152">)</span><span class="op" id="2867153">;</span>&nbsp;<span class="builtinfunc" id="2867155">len</span><span class="op" id="2867158">(</span><span class="ident" id="2867159">p</span><span class="op" id="2867160">)</span>&nbsp;<span class="op" id="2867162">!=</span>&nbsp;<span class="num" id="2867165">16</span>&nbsp;<span class="op" id="2867168">||</span>&nbsp;<span class="ident" id="2867171">p</span><span class="op" id="2867172">[</span><span class="num" id="2867173">0</span><span class="op" id="2867174">]</span>&nbsp;<span class="op" id="2867176">!=</span>&nbsp;<span class="num" id="2867179">0</span>&nbsp;<span class="op" id="2867181">&amp;&amp;</span>&nbsp;<span class="ident" id="2867184">p</span><span class="op" id="2867185">[</span><span class="num" id="2867186">0</span><span class="op" id="2867187">]</span>&nbsp;<span class="op" id="2867189">!=</span>&nbsp;<span class="string" id="2867192">&#39;2&#39;</span>&nbsp;<span class="op" id="2867196">&amp;&amp;</span>&nbsp;<span class="ident" id="2867199">p</span><span class="op" id="2867200">[</span><span class="num" id="2867201">0</span><span class="op" id="2867202">]</span>&nbsp;<span class="op" id="2867204">!=</span>&nbsp;<span class="string" id="2867207">&#39;3&#39;</span>&nbsp;<span class="op" id="2867211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867215">return</span>&nbsp;<span class="ident" id="2867222">nil</span><span class="op" id="2867225">,</span>&nbsp;<span class="ident" id="2867227">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2867236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867240">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867276">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867311">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867350">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867377">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867408">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867439">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867492">const</span>&nbsp;<span class="op" id="2867498">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867502">NUTCLocal</span>&nbsp;<span class="op" id="2867512">=</span>&nbsp;<span class="ident" id="2867514">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867521">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867532">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867540">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867548">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867556">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2867563">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867566">var</span>&nbsp;<span class="ident" id="2867570">n</span>&nbsp;<span class="op" id="2867572">[</span><span class="num" id="2867573">6</span><span class="op" id="2867574">]</span><span class="builtintype" id="2867575">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867580">for</span>&nbsp;<span class="ident" id="2867584">i</span>&nbsp;<span class="op" id="2867586">:=</span>&nbsp;<span class="num" id="2867589">0</span><span class="op" id="2867590">;</span>&nbsp;<span class="ident" id="2867592">i</span>&nbsp;<span class="op" id="2867594">&lt;</span>&nbsp;<span class="num" id="2867596">6</span><span class="op" id="2867597">;</span>&nbsp;<span class="ident" id="2867599">i</span><span class="op" id="2867600">++</span>&nbsp;<span class="op" id="2867603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867607">nn</span><span class="op" id="2867609">,</span>&nbsp;<span class="ident" id="2867611">ok</span>&nbsp;<span class="op" id="2867614">:=</span>&nbsp;<span class="ident" id="2867617">d</span><span class="op" id="2867618">.</span><span class="ident" id="2867619">big4</span><span class="op" id="2867623">(</span><span class="op" id="2867624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867628">if</span>&nbsp;<span class="op" id="2867631">!</span><span class="ident" id="2867632">ok</span>&nbsp;<span class="op" id="2867635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2867640">return</span>&nbsp;<span class="ident" id="2867647">nil</span><span class="op" id="2867650">,</span>&nbsp;<span class="ident" id="2867652">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2867662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867666">n</span><span class="op" id="2867667">[</span><span class="ident" id="2867668">i</span><span class="op" id="2867669">]</span>&nbsp;<span class="op" id="2867671">=</span>&nbsp;<span class="builtintype" id="2867673">int</span><span class="op" id="2867676">(</span><span class="ident" id="2867677">nn</span><span class="op" id="2867679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2867682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867686">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867708">txtimes</span>&nbsp;<span class="op" id="2867716">:=</span>&nbsp;<span class="ident" id="2867719">data</span><span class="op" id="2867723">{</span><span class="ident" id="2867724">d</span><span class="op" id="2867725">.</span><span class="ident" id="2867726">read</span><span class="op" id="2867730">(</span><span class="ident" id="2867731">n</span><span class="op" id="2867732">[</span><span class="ident" id="2867733">NTime</span><span class="op" id="2867738">]</span>&nbsp;<span class="op" id="2867740">*</span>&nbsp;<span class="num" id="2867742">4</span><span class="op" id="2867743">)</span><span class="op" id="2867744">,</span>&nbsp;<span class="builtintype" id="2867746">false</span><span class="op" id="2867751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867755">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867799">txzones</span>&nbsp;<span class="op" id="2867807">:=</span>&nbsp;<span class="ident" id="2867810">d</span><span class="op" id="2867811">.</span><span class="ident" id="2867812">read</span><span class="op" id="2867816">(</span><span class="ident" id="2867817">n</span><span class="op" id="2867818">[</span><span class="ident" id="2867819">NTime</span><span class="op" id="2867824">]</span><span class="op" id="2867825">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867829">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867854">zonedata</span>&nbsp;<span class="op" id="2867863">:=</span>&nbsp;<span class="ident" id="2867866">data</span><span class="op" id="2867870">{</span><span class="ident" id="2867871">d</span><span class="op" id="2867872">.</span><span class="ident" id="2867873">read</span><span class="op" id="2867877">(</span><span class="ident" id="2867878">n</span><span class="op" id="2867879">[</span><span class="ident" id="2867880">NZone</span><span class="op" id="2867885">]</span>&nbsp;<span class="op" id="2867887">*</span>&nbsp;<span class="num" id="2867889">6</span><span class="op" id="2867890">)</span><span class="op" id="2867891">,</span>&nbsp;<span class="builtintype" id="2867893">false</span><span class="op" id="2867898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867902">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867931">abbrev</span>&nbsp;<span class="op" id="2867938">:=</span>&nbsp;<span class="ident" id="2867941">d</span><span class="op" id="2867942">.</span><span class="ident" id="2867943">read</span><span class="op" id="2867947">(</span><span class="ident" id="2867948">n</span><span class="op" id="2867949">[</span><span class="ident" id="2867950">NChar</span><span class="op" id="2867955">]</span><span class="op" id="2867956">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2867960">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2867987">d</span><span class="op" id="2867988">.</span><span class="ident" id="2867989">read</span><span class="op" id="2867993">(</span><span class="ident" id="2867994">n</span><span class="op" id="2867995">[</span><span class="ident" id="2867996">NLeap</span><span class="op" id="2868001">]</span>&nbsp;<span class="op" id="2868003">*</span>&nbsp;<span class="num" id="2868005">8</span><span class="op" id="2868006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868010">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868064">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868113">isstd</span>&nbsp;<span class="op" id="2868119">:=</span>&nbsp;<span class="ident" id="2868122">d</span><span class="op" id="2868123">.</span><span class="ident" id="2868124">read</span><span class="op" id="2868128">(</span><span class="ident" id="2868129">n</span><span class="op" id="2868130">[</span><span class="ident" id="2868131">NStdWall</span><span class="op" id="2868139">]</span><span class="op" id="2868140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868144">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868198">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868238">isutc</span>&nbsp;<span class="op" id="2868244">:=</span>&nbsp;<span class="ident" id="2868247">d</span><span class="op" id="2868248">.</span><span class="ident" id="2868249">read</span><span class="op" id="2868253">(</span><span class="ident" id="2868254">n</span><span class="op" id="2868255">[</span><span class="ident" id="2868256">NUTCLocal</span><span class="op" id="2868265">]</span><span class="op" id="2868266">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868270">if</span>&nbsp;<span class="ident" id="2868273">d</span><span class="op" id="2868274">.</span><span class="builtintype" id="2868275">error</span>&nbsp;<span class="op" id="2868281">{</span>&nbsp;<span class="comment" id="2868283">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868304">return</span>&nbsp;<span class="ident" id="2868311">nil</span><span class="op" id="2868314">,</span>&nbsp;<span class="ident" id="2868316">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2868325">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868329">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868396">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868442">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868479">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868528">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2868560">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868596">zone</span>&nbsp;<span class="op" id="2868601">:=</span>&nbsp;<span class="builtinfunc" id="2868604">make</span><span class="op" id="2868608">(</span><span class="op" id="2868609">[</span><span class="op" id="2868610">]</span><span class="ident" id="2868611">zone</span><span class="op" id="2868615">,</span>&nbsp;<span class="ident" id="2868617">n</span><span class="op" id="2868618">[</span><span class="ident" id="2868619">NZone</span><span class="op" id="2868624">]</span><span class="op" id="2868625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868628">for</span>&nbsp;<span class="ident" id="2868632">i</span>&nbsp;<span class="op" id="2868634">:=</span>&nbsp;<span class="keyword" id="2868637">range</span>&nbsp;<span class="ident" id="2868643">zone</span>&nbsp;<span class="op" id="2868648">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868652">var</span>&nbsp;<span class="ident" id="2868656">ok</span>&nbsp;<span class="builtintype" id="2868659">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868666">var</span>&nbsp;<span class="ident" id="2868670">n</span>&nbsp;<span class="builtintype" id="2868672">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868681">if</span>&nbsp;<span class="ident" id="2868684">n</span><span class="op" id="2868685">,</span>&nbsp;<span class="ident" id="2868687">ok</span>&nbsp;<span class="op" id="2868690">=</span>&nbsp;<span class="ident" id="2868692">zonedata</span><span class="op" id="2868700">.</span><span class="ident" id="2868701">big4</span><span class="op" id="2868705">(</span><span class="op" id="2868706">)</span><span class="op" id="2868707">;</span>&nbsp;<span class="op" id="2868709">!</span><span class="ident" id="2868710">ok</span>&nbsp;<span class="op" id="2868713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868718">return</span>&nbsp;<span class="ident" id="2868725">nil</span><span class="op" id="2868728">,</span>&nbsp;<span class="ident" id="2868730">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2868740">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868744">zone</span><span class="op" id="2868748">[</span><span class="ident" id="2868749">i</span><span class="op" id="2868750">]</span><span class="op" id="2868751">.</span><span class="ident" id="2868752">offset</span>&nbsp;<span class="op" id="2868759">=</span>&nbsp;<span class="builtintype" id="2868761">int</span><span class="op" id="2868764">(</span><span class="builtintype" id="2868765">int32</span><span class="op" id="2868770">(</span><span class="ident" id="2868771">n</span><span class="op" id="2868772">)</span><span class="op" id="2868773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868777">var</span>&nbsp;<span class="ident" id="2868781">b</span>&nbsp;<span class="builtintype" id="2868783">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868790">if</span>&nbsp;<span class="ident" id="2868793">b</span><span class="op" id="2868794">,</span>&nbsp;<span class="ident" id="2868796">ok</span>&nbsp;<span class="op" id="2868799">=</span>&nbsp;<span class="ident" id="2868801">zonedata</span><span class="op" id="2868809">.</span><span class="builtintype" id="2868810">byte</span><span class="op" id="2868814">(</span><span class="op" id="2868815">)</span><span class="op" id="2868816">;</span>&nbsp;<span class="op" id="2868818">!</span><span class="ident" id="2868819">ok</span>&nbsp;<span class="op" id="2868822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868827">return</span>&nbsp;<span class="ident" id="2868834">nil</span><span class="op" id="2868837">,</span>&nbsp;<span class="ident" id="2868839">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2868849">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868853">zone</span><span class="op" id="2868857">[</span><span class="ident" id="2868858">i</span><span class="op" id="2868859">]</span><span class="op" id="2868860">.</span><span class="ident" id="2868861">isDST</span>&nbsp;<span class="op" id="2868867">=</span>&nbsp;<span class="ident" id="2868869">b</span>&nbsp;<span class="op" id="2868871">!=</span>&nbsp;<span class="num" id="2868874">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868878">if</span>&nbsp;<span class="ident" id="2868881">b</span><span class="op" id="2868882">,</span>&nbsp;<span class="ident" id="2868884">ok</span>&nbsp;<span class="op" id="2868887">=</span>&nbsp;<span class="ident" id="2868889">zonedata</span><span class="op" id="2868897">.</span><span class="builtintype" id="2868898">byte</span><span class="op" id="2868902">(</span><span class="op" id="2868903">)</span><span class="op" id="2868904">;</span>&nbsp;<span class="op" id="2868906">!</span><span class="ident" id="2868907">ok</span>&nbsp;<span class="op" id="2868910">||</span>&nbsp;<span class="builtintype" id="2868913">int</span><span class="op" id="2868916">(</span><span class="ident" id="2868917">b</span><span class="op" id="2868918">)</span>&nbsp;<span class="op" id="2868920">&gt;=</span>&nbsp;<span class="builtinfunc" id="2868923">len</span><span class="op" id="2868926">(</span><span class="ident" id="2868927">abbrev</span><span class="op" id="2868933">)</span>&nbsp;<span class="op" id="2868935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2868940">return</span>&nbsp;<span class="ident" id="2868947">nil</span><span class="op" id="2868950">,</span>&nbsp;<span class="ident" id="2868952">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2868962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2868966">zone</span><span class="op" id="2868970">[</span><span class="ident" id="2868971">i</span><span class="op" id="2868972">]</span><span class="op" id="2868973">.</span><span class="ident" id="2868974">name</span>&nbsp;<span class="op" id="2868979">=</span>&nbsp;<span class="ident" id="2868981">byteString</span><span class="op" id="2868991">(</span><span class="ident" id="2868992">abbrev</span><span class="op" id="2868998">[</span><span class="ident" id="2868999">b</span><span class="op" id="2869000">:</span><span class="op" id="2869001">]</span><span class="op" id="2869002">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869009">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869043">tx</span>&nbsp;<span class="op" id="2869046">:=</span>&nbsp;<span class="builtinfunc" id="2869049">make</span><span class="op" id="2869053">(</span><span class="op" id="2869054">[</span><span class="op" id="2869055">]</span><span class="ident" id="2869056">zoneTrans</span><span class="op" id="2869065">,</span>&nbsp;<span class="ident" id="2869067">n</span><span class="op" id="2869068">[</span><span class="ident" id="2869069">NTime</span><span class="op" id="2869074">]</span><span class="op" id="2869075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869078">for</span>&nbsp;<span class="ident" id="2869082">i</span>&nbsp;<span class="op" id="2869084">:=</span>&nbsp;<span class="keyword" id="2869087">range</span>&nbsp;<span class="ident" id="2869093">tx</span>&nbsp;<span class="op" id="2869096">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869100">var</span>&nbsp;<span class="ident" id="2869104">ok</span>&nbsp;<span class="builtintype" id="2869107">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869114">var</span>&nbsp;<span class="ident" id="2869118">n</span>&nbsp;<span class="builtintype" id="2869120">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869129">if</span>&nbsp;<span class="ident" id="2869132">n</span><span class="op" id="2869133">,</span>&nbsp;<span class="ident" id="2869135">ok</span>&nbsp;<span class="op" id="2869138">=</span>&nbsp;<span class="ident" id="2869140">txtimes</span><span class="op" id="2869147">.</span><span class="ident" id="2869148">big4</span><span class="op" id="2869152">(</span><span class="op" id="2869153">)</span><span class="op" id="2869154">;</span>&nbsp;<span class="op" id="2869156">!</span><span class="ident" id="2869157">ok</span>&nbsp;<span class="op" id="2869160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869165">return</span>&nbsp;<span class="ident" id="2869172">nil</span><span class="op" id="2869175">,</span>&nbsp;<span class="ident" id="2869177">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869187">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869191">tx</span><span class="op" id="2869193">[</span><span class="ident" id="2869194">i</span><span class="op" id="2869195">]</span><span class="op" id="2869196">.</span><span class="ident" id="2869197">when</span>&nbsp;<span class="op" id="2869202">=</span>&nbsp;<span class="ident" id="2869204">int64</span><span class="op" id="2869209">(</span><span class="builtintype" id="2869210">int32</span><span class="op" id="2869215">(</span><span class="ident" id="2869216">n</span><span class="op" id="2869217">)</span><span class="op" id="2869218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869222">if</span>&nbsp;<span class="builtintype" id="2869225">int</span><span class="op" id="2869228">(</span><span class="ident" id="2869229">txzones</span><span class="op" id="2869236">[</span><span class="ident" id="2869237">i</span><span class="op" id="2869238">]</span><span class="op" id="2869239">)</span>&nbsp;<span class="op" id="2869241">&gt;=</span>&nbsp;<span class="builtinfunc" id="2869244">len</span><span class="op" id="2869247">(</span><span class="ident" id="2869248">zone</span><span class="op" id="2869252">)</span>&nbsp;<span class="op" id="2869254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869259">return</span>&nbsp;<span class="ident" id="2869266">nil</span><span class="op" id="2869269">,</span>&nbsp;<span class="ident" id="2869271">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869285">tx</span><span class="op" id="2869287">[</span><span class="ident" id="2869288">i</span><span class="op" id="2869289">]</span><span class="op" id="2869290">.</span><span class="ident" id="2869291">index</span>&nbsp;<span class="op" id="2869297">=</span>&nbsp;<span class="ident" id="2869299">txzones</span><span class="op" id="2869306">[</span><span class="ident" id="2869307">i</span><span class="op" id="2869308">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869312">if</span>&nbsp;<span class="ident" id="2869315">i</span>&nbsp;<span class="op" id="2869317">&lt;</span>&nbsp;<span class="builtinfunc" id="2869319">len</span><span class="op" id="2869322">(</span><span class="ident" id="2869323">isstd</span><span class="op" id="2869328">)</span>&nbsp;<span class="op" id="2869330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869335">tx</span><span class="op" id="2869337">[</span><span class="ident" id="2869338">i</span><span class="op" id="2869339">]</span><span class="op" id="2869340">.</span><span class="ident" id="2869341">isstd</span>&nbsp;<span class="op" id="2869347">=</span>&nbsp;<span class="ident" id="2869349">isstd</span><span class="op" id="2869354">[</span><span class="ident" id="2869355">i</span><span class="op" id="2869356">]</span>&nbsp;<span class="op" id="2869358">!=</span>&nbsp;<span class="num" id="2869361">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869369">if</span>&nbsp;<span class="ident" id="2869372">i</span>&nbsp;<span class="op" id="2869374">&lt;</span>&nbsp;<span class="builtinfunc" id="2869376">len</span><span class="op" id="2869379">(</span><span class="ident" id="2869380">isutc</span><span class="op" id="2869385">)</span>&nbsp;<span class="op" id="2869387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869392">tx</span><span class="op" id="2869394">[</span><span class="ident" id="2869395">i</span><span class="op" id="2869396">]</span><span class="op" id="2869397">.</span><span class="ident" id="2869398">isutc</span>&nbsp;<span class="op" id="2869404">=</span>&nbsp;<span class="ident" id="2869406">isutc</span><span class="op" id="2869411">[</span><span class="ident" id="2869412">i</span><span class="op" id="2869413">]</span>&nbsp;<span class="op" id="2869415">!=</span>&nbsp;<span class="num" id="2869418">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869429">if</span>&nbsp;<span class="builtinfunc" id="2869432">len</span><span class="op" id="2869435">(</span><span class="ident" id="2869436">tx</span><span class="op" id="2869438">)</span>&nbsp;<span class="op" id="2869440">==</span>&nbsp;<span class="num" id="2869443">0</span>&nbsp;<span class="op" id="2869445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869449">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869495">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869549">tx</span>&nbsp;<span class="op" id="2869552">=</span>&nbsp;<span class="builtinfunc" id="2869554">append</span><span class="op" id="2869560">(</span><span class="ident" id="2869561">tx</span><span class="op" id="2869563">,</span>&nbsp;<span class="ident" id="2869565">zoneTrans</span><span class="op" id="2869574">{</span><span class="ident" id="2869575">when</span><span class="op" id="2869579">:</span>&nbsp;<span class="ident" id="2869581">alpha</span><span class="op" id="2869586">,</span>&nbsp;<span class="ident" id="2869588">index</span><span class="op" id="2869593">:</span>&nbsp;<span class="num" id="2869595">0</span><span class="op" id="2869596">}</span><span class="op" id="2869597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869604">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869630">l</span>&nbsp;<span class="op" id="2869632">=</span>&nbsp;<span class="op" id="2869634">&amp;</span><span class="ident" id="2869635">Location</span><span class="op" id="2869643">{</span><span class="ident" id="2869644">zone</span><span class="op" id="2869648">:</span>&nbsp;<span class="ident" id="2869650">zone</span><span class="op" id="2869654">,</span>&nbsp;<span class="ident" id="2869656">tx</span><span class="op" id="2869658">:</span>&nbsp;<span class="ident" id="2869660">tx</span><span class="op" id="2869662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869666">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2869722">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869769">sec</span><span class="op" id="2869772">,</span>&nbsp;<span class="ident" id="2869774">_</span>&nbsp;<span class="op" id="2869776">:=</span>&nbsp;<span class="ident" id="2869779">now</span><span class="op" id="2869782">(</span><span class="op" id="2869783">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869786">for</span>&nbsp;<span class="ident" id="2869790">i</span>&nbsp;<span class="op" id="2869792">:=</span>&nbsp;<span class="keyword" id="2869795">range</span>&nbsp;<span class="ident" id="2869801">tx</span>&nbsp;<span class="op" id="2869804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869808">if</span>&nbsp;<span class="ident" id="2869811">tx</span><span class="op" id="2869813">[</span><span class="ident" id="2869814">i</span><span class="op" id="2869815">]</span><span class="op" id="2869816">.</span><span class="ident" id="2869817">when</span>&nbsp;<span class="op" id="2869822">&lt;=</span>&nbsp;<span class="ident" id="2869825">sec</span>&nbsp;<span class="op" id="2869829">&amp;&amp;</span>&nbsp;<span class="op" id="2869832">(</span><span class="ident" id="2869833">i</span><span class="op" id="2869834">+</span><span class="num" id="2869835">1</span>&nbsp;<span class="op" id="2869837">==</span>&nbsp;<span class="builtinfunc" id="2869840">len</span><span class="op" id="2869843">(</span><span class="ident" id="2869844">tx</span><span class="op" id="2869846">)</span>&nbsp;<span class="op" id="2869848">||</span>&nbsp;<span class="ident" id="2869851">sec</span>&nbsp;<span class="op" id="2869855">&lt;</span>&nbsp;<span class="ident" id="2869857">tx</span><span class="op" id="2869859">[</span><span class="ident" id="2869860">i</span><span class="op" id="2869861">+</span><span class="num" id="2869862">1</span><span class="op" id="2869863">]</span><span class="op" id="2869864">.</span><span class="ident" id="2869865">when</span><span class="op" id="2869869">)</span>&nbsp;<span class="op" id="2869871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869876">l</span><span class="op" id="2869877">.</span><span class="ident" id="2869878">cacheStart</span>&nbsp;<span class="op" id="2869889">=</span>&nbsp;<span class="ident" id="2869891">tx</span><span class="op" id="2869893">[</span><span class="ident" id="2869894">i</span><span class="op" id="2869895">]</span><span class="op" id="2869896">.</span><span class="ident" id="2869897">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869905">l</span><span class="op" id="2869906">.</span><span class="ident" id="2869907">cacheEnd</span>&nbsp;<span class="op" id="2869916">=</span>&nbsp;<span class="ident" id="2869918">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2869927">if</span>&nbsp;<span class="ident" id="2869930">i</span><span class="op" id="2869931">+</span><span class="num" id="2869932">1</span>&nbsp;<span class="op" id="2869934">&lt;</span>&nbsp;<span class="builtinfunc" id="2869936">len</span><span class="op" id="2869939">(</span><span class="ident" id="2869940">tx</span><span class="op" id="2869942">)</span>&nbsp;<span class="op" id="2869944">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869950">l</span><span class="op" id="2869951">.</span><span class="ident" id="2869952">cacheEnd</span>&nbsp;<span class="op" id="2869961">=</span>&nbsp;<span class="ident" id="2869963">tx</span><span class="op" id="2869965">[</span><span class="ident" id="2869966">i</span><span class="op" id="2869967">+</span><span class="num" id="2869968">1</span><span class="op" id="2869969">]</span><span class="op" id="2869970">.</span><span class="ident" id="2869971">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2869979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2869984">l</span><span class="op" id="2869985">.</span><span class="ident" id="2869986">cacheZone</span>&nbsp;<span class="op" id="2869996">=</span>&nbsp;<span class="op" id="2869998">&amp;</span><span class="ident" id="2869999">l</span><span class="op" id="2870000">.</span><span class="ident" id="2870001">zone</span><span class="op" id="2870005">[</span><span class="ident" id="2870006">tx</span><span class="op" id="2870008">[</span><span class="ident" id="2870009">i</span><span class="op" id="2870010">]</span><span class="op" id="2870011">.</span><span class="ident" id="2870012">index</span><span class="op" id="2870017">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870024">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870028">return</span>&nbsp;<span class="ident" id="2870035">l</span><span class="op" id="2870036">,</span>&nbsp;<span class="ident" id="2870038">nil</span><br>
<span class="lineno"></span><span class="op" id="2870042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2870045">func</span>&nbsp;<span class="ident" id="2870050">loadZoneFile</span><span class="op" id="2870062">(</span><span class="ident" id="2870063">dir</span><span class="op" id="2870066">,</span>&nbsp;<span class="ident" id="2870068">name</span>&nbsp;<span class="builtintype" id="2870073">string</span><span class="op" id="2870079">)</span>&nbsp;<span class="op" id="2870081">(</span><span class="ident" id="2870082">l</span>&nbsp;<span class="op" id="2870084">*</span><span class="ident" id="2870085">Location</span><span class="op" id="2870093">,</span>&nbsp;<span class="ident" id="2870095">err</span>&nbsp;<span class="builtintype" id="2870099">error</span><span class="op" id="2870104">)</span>&nbsp;<span class="op" id="2870106">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870109">if</span>&nbsp;<span class="builtinfunc" id="2870112">len</span><span class="op" id="2870115">(</span><span class="ident" id="2870116">dir</span><span class="op" id="2870119">)</span>&nbsp;<span class="op" id="2870121">&gt;</span>&nbsp;<span class="num" id="2870123">4</span>&nbsp;<span class="op" id="2870125">&amp;&amp;</span>&nbsp;<span class="ident" id="2870128">dir</span><span class="op" id="2870131">[</span><span class="builtinfunc" id="2870132">len</span><span class="op" id="2870135">(</span><span class="ident" id="2870136">dir</span><span class="op" id="2870139">)</span><span class="op" id="2870140">-</span><span class="num" id="2870141">4</span><span class="op" id="2870142">:</span><span class="op" id="2870143">]</span>&nbsp;<span class="op" id="2870145">==</span>&nbsp;<span class="string" id="2870148">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2870155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870159">return</span>&nbsp;<span class="ident" id="2870166">loadZoneZip</span><span class="op" id="2870177">(</span><span class="ident" id="2870178">dir</span><span class="op" id="2870181">,</span>&nbsp;<span class="ident" id="2870183">name</span><span class="op" id="2870187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870193">if</span>&nbsp;<span class="ident" id="2870196">dir</span>&nbsp;<span class="op" id="2870200">!=</span>&nbsp;<span class="string" id="2870203">&#34;&#34;</span>&nbsp;<span class="op" id="2870206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2870210">name</span>&nbsp;<span class="op" id="2870215">=</span>&nbsp;<span class="ident" id="2870217">dir</span>&nbsp;<span class="op" id="2870221">+</span>&nbsp;<span class="string" id="2870223">&#34;/&#34;</span>&nbsp;<span class="op" id="2870227">+</span>&nbsp;<span class="ident" id="2870229">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2870238">buf</span><span class="op" id="2870241">,</span>&nbsp;<span class="ident" id="2870243">err</span>&nbsp;<span class="op" id="2870247">:=</span>&nbsp;<span class="ident" id="2870250">readFile</span><span class="op" id="2870258">(</span><span class="ident" id="2870259">name</span><span class="op" id="2870263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870266">if</span>&nbsp;<span class="ident" id="2870269">err</span>&nbsp;<span class="op" id="2870273">!=</span>&nbsp;<span class="ident" id="2870276">nil</span>&nbsp;<span class="op" id="2870280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870284">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870292">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870295">return</span>&nbsp;<span class="ident" id="2870302">loadZoneData</span><span class="op" id="2870314">(</span><span class="ident" id="2870315">buf</span><span class="op" id="2870318">)</span><br>
<span class="lineno"></span><span class="op" id="2870320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2870323">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2870390">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2870449">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2870517">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2870586">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2870651">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2870720">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2870781">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2870834">func</span>&nbsp;<span class="ident" id="2870839">get4</span><span class="op" id="2870843">(</span><span class="ident" id="2870844">b</span>&nbsp;<span class="op" id="2870846">[</span><span class="op" id="2870847">]</span><span class="builtintype" id="2870848">byte</span><span class="op" id="2870852">)</span>&nbsp;<span class="builtintype" id="2870854">int</span>&nbsp;<span class="op" id="2870858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870861">if</span>&nbsp;<span class="builtinfunc" id="2870864">len</span><span class="op" id="2870867">(</span><span class="ident" id="2870868">b</span><span class="op" id="2870869">)</span>&nbsp;<span class="op" id="2870871">&lt;</span>&nbsp;<span class="num" id="2870873">4</span>&nbsp;<span class="op" id="2870875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870879">return</span>&nbsp;<span class="num" id="2870886">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2870889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2870892">return</span>&nbsp;<span class="builtintype" id="2870899">int</span><span class="op" id="2870902">(</span><span class="ident" id="2870903">b</span><span class="op" id="2870904">[</span><span class="num" id="2870905">0</span><span class="op" id="2870906">]</span><span class="op" id="2870907">)</span>&nbsp;<span class="op" id="2870909">|</span>&nbsp;<span class="builtintype" id="2870911">int</span><span class="op" id="2870914">(</span><span class="ident" id="2870915">b</span><span class="op" id="2870916">[</span><span class="num" id="2870917">1</span><span class="op" id="2870918">]</span><span class="op" id="2870919">)</span><span class="op" id="2870920">&lt;&lt;</span><span class="num" id="2870922">8</span>&nbsp;<span class="op" id="2870924">|</span>&nbsp;<span class="builtintype" id="2870926">int</span><span class="op" id="2870929">(</span><span class="ident" id="2870930">b</span><span class="op" id="2870931">[</span><span class="num" id="2870932">2</span><span class="op" id="2870933">]</span><span class="op" id="2870934">)</span><span class="op" id="2870935">&lt;&lt;</span><span class="num" id="2870937">16</span>&nbsp;<span class="op" id="2870940">|</span>&nbsp;<span class="builtintype" id="2870942">int</span><span class="op" id="2870945">(</span><span class="ident" id="2870946">b</span><span class="op" id="2870947">[</span><span class="num" id="2870948">3</span><span class="op" id="2870949">]</span><span class="op" id="2870950">)</span><span class="op" id="2870951">&lt;&lt;</span><span class="num" id="2870953">24</span><br>
<span class="lineno"></span><span class="op" id="2870956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2870959">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2871012">func</span>&nbsp;<span class="ident" id="2871017">get2</span><span class="op" id="2871021">(</span><span class="ident" id="2871022">b</span>&nbsp;<span class="op" id="2871024">[</span><span class="op" id="2871025">]</span><span class="builtintype" id="2871026">byte</span><span class="op" id="2871030">)</span>&nbsp;<span class="builtintype" id="2871032">int</span>&nbsp;<span class="op" id="2871036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871039">if</span>&nbsp;<span class="builtinfunc" id="2871042">len</span><span class="op" id="2871045">(</span><span class="ident" id="2871046">b</span><span class="op" id="2871047">)</span>&nbsp;<span class="op" id="2871049">&lt;</span>&nbsp;<span class="num" id="2871051">2</span>&nbsp;<span class="op" id="2871053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871057">return</span>&nbsp;<span class="num" id="2871064">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2871067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871070">return</span>&nbsp;<span class="builtintype" id="2871077">int</span><span class="op" id="2871080">(</span><span class="ident" id="2871081">b</span><span class="op" id="2871082">[</span><span class="num" id="2871083">0</span><span class="op" id="2871084">]</span><span class="op" id="2871085">)</span>&nbsp;<span class="op" id="2871087">|</span>&nbsp;<span class="builtintype" id="2871089">int</span><span class="op" id="2871092">(</span><span class="ident" id="2871093">b</span><span class="op" id="2871094">[</span><span class="num" id="2871095">1</span><span class="op" id="2871096">]</span><span class="op" id="2871097">)</span><span class="op" id="2871098">&lt;&lt;</span><span class="num" id="2871100">8</span><br>
<span class="lineno">235</span><span class="op" id="2871102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2871105">func</span>&nbsp;<span class="ident" id="2871110">loadZoneZip</span><span class="op" id="2871121">(</span><span class="ident" id="2871122">zipfile</span><span class="op" id="2871129">,</span>&nbsp;<span class="ident" id="2871131">name</span>&nbsp;<span class="builtintype" id="2871136">string</span><span class="op" id="2871142">)</span>&nbsp;<span class="op" id="2871144">(</span><span class="ident" id="2871145">l</span>&nbsp;<span class="op" id="2871147">*</span><span class="ident" id="2871148">Location</span><span class="op" id="2871156">,</span>&nbsp;<span class="ident" id="2871158">err</span>&nbsp;<span class="builtintype" id="2871162">error</span><span class="op" id="2871167">)</span>&nbsp;<span class="op" id="2871169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871172">fd</span><span class="op" id="2871174">,</span>&nbsp;<span class="ident" id="2871176">err</span>&nbsp;<span class="op" id="2871180">:=</span>&nbsp;<span class="ident" id="2871183">open</span><span class="op" id="2871187">(</span><span class="ident" id="2871188">zipfile</span><span class="op" id="2871195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871198">if</span>&nbsp;<span class="ident" id="2871201">err</span>&nbsp;<span class="op" id="2871205">!=</span>&nbsp;<span class="ident" id="2871208">nil</span>&nbsp;<span class="op" id="2871212">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871216">return</span>&nbsp;<span class="ident" id="2871223">nil</span><span class="op" id="2871226">,</span>&nbsp;<span class="ident" id="2871228">errors</span><span class="op" id="2871234">.</span><span class="ident" id="2871235">New</span><span class="op" id="2871238">(</span><span class="string" id="2871239">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2871247">+</span>&nbsp;<span class="ident" id="2871249">zipfile</span>&nbsp;<span class="op" id="2871257">+</span>&nbsp;<span class="string" id="2871259">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2871264">+</span>&nbsp;<span class="ident" id="2871266">err</span><span class="op" id="2871269">.</span><span class="ident" id="2871270">Error</span><span class="op" id="2871275">(</span><span class="op" id="2871276">)</span><span class="op" id="2871277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2871280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871283">defer</span>&nbsp;<span class="ident" id="2871289">closefd</span><span class="op" id="2871296">(</span><span class="ident" id="2871297">fd</span><span class="op" id="2871299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871303">const</span>&nbsp;<span class="op" id="2871309">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871313">zecheader</span>&nbsp;<span class="op" id="2871323">=</span>&nbsp;<span class="num" id="2871325">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871338">zcheader</span>&nbsp;&nbsp;<span class="op" id="2871348">=</span>&nbsp;<span class="num" id="2871350">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871363">ztailsize</span>&nbsp;<span class="op" id="2871373">=</span>&nbsp;<span class="num" id="2871375">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871381">zheadersize</span>&nbsp;<span class="op" id="2871393">=</span>&nbsp;<span class="num" id="2871395">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871400">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2871412">=</span>&nbsp;<span class="num" id="2871414">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2871426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871430">buf</span>&nbsp;<span class="op" id="2871434">:=</span>&nbsp;<span class="builtinfunc" id="2871437">make</span><span class="op" id="2871441">(</span><span class="op" id="2871442">[</span><span class="op" id="2871443">]</span><span class="builtintype" id="2871444">byte</span><span class="op" id="2871448">,</span>&nbsp;<span class="ident" id="2871450">ztailsize</span><span class="op" id="2871459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871462">if</span>&nbsp;<span class="ident" id="2871465">err</span>&nbsp;<span class="op" id="2871469">:=</span>&nbsp;<span class="ident" id="2871472">preadn</span><span class="op" id="2871478">(</span><span class="ident" id="2871479">fd</span><span class="op" id="2871481">,</span>&nbsp;<span class="ident" id="2871483">buf</span><span class="op" id="2871486">,</span>&nbsp;<span class="op" id="2871488">-</span><span class="ident" id="2871489">ztailsize</span><span class="op" id="2871498">)</span><span class="op" id="2871499">;</span>&nbsp;<span class="ident" id="2871501">err</span>&nbsp;<span class="op" id="2871505">!=</span>&nbsp;<span class="ident" id="2871508">nil</span>&nbsp;<span class="op" id="2871512">||</span>&nbsp;<span class="ident" id="2871515">get4</span><span class="op" id="2871519">(</span><span class="ident" id="2871520">buf</span><span class="op" id="2871523">)</span>&nbsp;<span class="op" id="2871525">!=</span>&nbsp;<span class="ident" id="2871528">zecheader</span>&nbsp;<span class="op" id="2871538">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871542">return</span>&nbsp;<span class="ident" id="2871549">nil</span><span class="op" id="2871552">,</span>&nbsp;<span class="ident" id="2871554">errors</span><span class="op" id="2871560">.</span><span class="ident" id="2871561">New</span><span class="op" id="2871564">(</span><span class="string" id="2871565">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2871585">+</span>&nbsp;<span class="ident" id="2871587">zipfile</span><span class="op" id="2871594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2871597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871600">n</span>&nbsp;<span class="op" id="2871602">:=</span>&nbsp;<span class="ident" id="2871605">get2</span><span class="op" id="2871609">(</span><span class="ident" id="2871610">buf</span><span class="op" id="2871613">[</span><span class="num" id="2871614">10</span><span class="op" id="2871616">:</span><span class="op" id="2871617">]</span><span class="op" id="2871618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871621">size</span>&nbsp;<span class="op" id="2871626">:=</span>&nbsp;<span class="ident" id="2871629">get4</span><span class="op" id="2871633">(</span><span class="ident" id="2871634">buf</span><span class="op" id="2871637">[</span><span class="num" id="2871638">12</span><span class="op" id="2871640">:</span><span class="op" id="2871641">]</span><span class="op" id="2871642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871645">off</span>&nbsp;<span class="op" id="2871649">:=</span>&nbsp;<span class="ident" id="2871652">get4</span><span class="op" id="2871656">(</span><span class="ident" id="2871657">buf</span><span class="op" id="2871660">[</span><span class="num" id="2871661">16</span><span class="op" id="2871663">:</span><span class="op" id="2871664">]</span><span class="op" id="2871665">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2871669">buf</span>&nbsp;<span class="op" id="2871673">=</span>&nbsp;<span class="builtinfunc" id="2871675">make</span><span class="op" id="2871679">(</span><span class="op" id="2871680">[</span><span class="op" id="2871681">]</span><span class="builtintype" id="2871682">byte</span><span class="op" id="2871686">,</span>&nbsp;<span class="ident" id="2871688">size</span><span class="op" id="2871692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871695">if</span>&nbsp;<span class="ident" id="2871698">err</span>&nbsp;<span class="op" id="2871702">:=</span>&nbsp;<span class="ident" id="2871705">preadn</span><span class="op" id="2871711">(</span><span class="ident" id="2871712">fd</span><span class="op" id="2871714">,</span>&nbsp;<span class="ident" id="2871716">buf</span><span class="op" id="2871719">,</span>&nbsp;<span class="ident" id="2871721">off</span><span class="op" id="2871724">)</span><span class="op" id="2871725">;</span>&nbsp;<span class="ident" id="2871727">err</span>&nbsp;<span class="op" id="2871731">!=</span>&nbsp;<span class="ident" id="2871734">nil</span>&nbsp;<span class="op" id="2871738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871742">return</span>&nbsp;<span class="ident" id="2871749">nil</span><span class="op" id="2871752">,</span>&nbsp;<span class="ident" id="2871754">errors</span><span class="op" id="2871760">.</span><span class="ident" id="2871761">New</span><span class="op" id="2871764">(</span><span class="string" id="2871765">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2871785">+</span>&nbsp;<span class="ident" id="2871787">zipfile</span><span class="op" id="2871794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2871797">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2871801">for</span>&nbsp;<span class="ident" id="2871805">i</span>&nbsp;<span class="op" id="2871807">:=</span>&nbsp;<span class="num" id="2871810">0</span><span class="op" id="2871811">;</span>&nbsp;<span class="ident" id="2871813">i</span>&nbsp;<span class="op" id="2871815">&lt;</span>&nbsp;<span class="ident" id="2871817">n</span><span class="op" id="2871818">;</span>&nbsp;<span class="ident" id="2871820">i</span><span class="op" id="2871821">++</span>&nbsp;<span class="op" id="2871824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871828">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871851">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871867">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871886">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871903">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871921">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871937">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871953">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871969">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2871988">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872007">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872022">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872039">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872058">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872077">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872093">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872110">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872129">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872146">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872163">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872178">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872200">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872241">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872246">if</span>&nbsp;<span class="ident" id="2872249">get4</span><span class="op" id="2872253">(</span><span class="ident" id="2872254">buf</span><span class="op" id="2872257">)</span>&nbsp;<span class="op" id="2872259">!=</span>&nbsp;<span class="ident" id="2872262">zcheader</span>&nbsp;<span class="op" id="2872271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872276">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2872284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872288">meth</span>&nbsp;<span class="op" id="2872293">:=</span>&nbsp;<span class="ident" id="2872296">get2</span><span class="op" id="2872300">(</span><span class="ident" id="2872301">buf</span><span class="op" id="2872304">[</span><span class="num" id="2872305">10</span><span class="op" id="2872307">:</span><span class="op" id="2872308">]</span><span class="op" id="2872309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872313">size</span>&nbsp;<span class="op" id="2872318">:=</span>&nbsp;<span class="ident" id="2872321">get4</span><span class="op" id="2872325">(</span><span class="ident" id="2872326">buf</span><span class="op" id="2872329">[</span><span class="num" id="2872330">24</span><span class="op" id="2872332">:</span><span class="op" id="2872333">]</span><span class="op" id="2872334">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872338">namelen</span>&nbsp;<span class="op" id="2872346">:=</span>&nbsp;<span class="ident" id="2872349">get2</span><span class="op" id="2872353">(</span><span class="ident" id="2872354">buf</span><span class="op" id="2872357">[</span><span class="num" id="2872358">28</span><span class="op" id="2872360">:</span><span class="op" id="2872361">]</span><span class="op" id="2872362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872366">xlen</span>&nbsp;<span class="op" id="2872371">:=</span>&nbsp;<span class="ident" id="2872374">get2</span><span class="op" id="2872378">(</span><span class="ident" id="2872379">buf</span><span class="op" id="2872382">[</span><span class="num" id="2872383">30</span><span class="op" id="2872385">:</span><span class="op" id="2872386">]</span><span class="op" id="2872387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872391">fclen</span>&nbsp;<span class="op" id="2872397">:=</span>&nbsp;<span class="ident" id="2872400">get2</span><span class="op" id="2872404">(</span><span class="ident" id="2872405">buf</span><span class="op" id="2872408">[</span><span class="num" id="2872409">32</span><span class="op" id="2872411">:</span><span class="op" id="2872412">]</span><span class="op" id="2872413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872417">off</span>&nbsp;<span class="op" id="2872421">:=</span>&nbsp;<span class="ident" id="2872424">get4</span><span class="op" id="2872428">(</span><span class="ident" id="2872429">buf</span><span class="op" id="2872432">[</span><span class="num" id="2872433">42</span><span class="op" id="2872435">:</span><span class="op" id="2872436">]</span><span class="op" id="2872437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872441">zname</span>&nbsp;<span class="op" id="2872447">:=</span>&nbsp;<span class="ident" id="2872450">buf</span><span class="op" id="2872453">[</span><span class="num" id="2872454">46</span>&nbsp;<span class="op" id="2872457">:</span>&nbsp;<span class="num" id="2872459">46</span><span class="op" id="2872461">+</span><span class="ident" id="2872462">namelen</span><span class="op" id="2872469">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872473">buf</span>&nbsp;<span class="op" id="2872477">=</span>&nbsp;<span class="ident" id="2872479">buf</span><span class="op" id="2872482">[</span><span class="num" id="2872483">46</span><span class="op" id="2872485">+</span><span class="ident" id="2872486">namelen</span><span class="op" id="2872493">+</span><span class="ident" id="2872494">xlen</span><span class="op" id="2872498">+</span><span class="ident" id="2872499">fclen</span><span class="op" id="2872504">:</span><span class="op" id="2872505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872509">if</span>&nbsp;<span class="builtintype" id="2872512">string</span><span class="op" id="2872518">(</span><span class="ident" id="2872519">zname</span><span class="op" id="2872524">)</span>&nbsp;<span class="op" id="2872526">!=</span>&nbsp;<span class="ident" id="2872529">name</span>&nbsp;<span class="op" id="2872534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872539">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2872550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872554">if</span>&nbsp;<span class="ident" id="2872557">meth</span>&nbsp;<span class="op" id="2872562">!=</span>&nbsp;<span class="num" id="2872565">0</span>&nbsp;<span class="op" id="2872567">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2872572">return</span>&nbsp;<span class="ident" id="2872579">nil</span><span class="op" id="2872582">,</span>&nbsp;<span class="ident" id="2872584">errors</span><span class="op" id="2872590">.</span><span class="ident" id="2872591">New</span><span class="op" id="2872594">(</span><span class="string" id="2872595">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2872626">+</span>&nbsp;<span class="ident" id="2872628">name</span>&nbsp;<span class="op" id="2872633">+</span>&nbsp;<span class="string" id="2872635">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2872642">+</span>&nbsp;<span class="ident" id="2872644">zipfile</span><span class="op" id="2872651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2872655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872660">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872693">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872709">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872727">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872743">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872759">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872774">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872793">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872812">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872827">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872844">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872863">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872882">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872898">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872920">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2872953">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2872958">buf</span>&nbsp;<span class="op" id="2872962">=</span>&nbsp;<span class="builtinfunc" id="2872964">make</span><span class="op" id="2872968">(</span><span class="op" id="2872969">[</span><span class="op" id="2872970">]</span><span class="builtintype" id="2872971">byte</span><span class="op" id="2872975">,</span>&nbsp;<span class="ident" id="2872977">zheadersize</span><span class="op" id="2872988">+</span><span class="ident" id="2872989">namelen</span><span class="op" id="2872996">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873000">if</span>&nbsp;<span class="ident" id="2873003">err</span>&nbsp;<span class="op" id="2873007">:=</span>&nbsp;<span class="ident" id="2873010">preadn</span><span class="op" id="2873016">(</span><span class="ident" id="2873017">fd</span><span class="op" id="2873019">,</span>&nbsp;<span class="ident" id="2873021">buf</span><span class="op" id="2873024">,</span>&nbsp;<span class="ident" id="2873026">off</span><span class="op" id="2873029">)</span><span class="op" id="2873030">;</span>&nbsp;<span class="ident" id="2873032">err</span>&nbsp;<span class="op" id="2873036">!=</span>&nbsp;<span class="ident" id="2873039">nil</span>&nbsp;<span class="op" id="2873043">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873049">get4</span><span class="op" id="2873053">(</span><span class="ident" id="2873054">buf</span><span class="op" id="2873057">)</span>&nbsp;<span class="op" id="2873059">!=</span>&nbsp;<span class="ident" id="2873062">zheader</span>&nbsp;<span class="op" id="2873070">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873076">get2</span><span class="op" id="2873080">(</span><span class="ident" id="2873081">buf</span><span class="op" id="2873084">[</span><span class="num" id="2873085">8</span><span class="op" id="2873086">:</span><span class="op" id="2873087">]</span><span class="op" id="2873088">)</span>&nbsp;<span class="op" id="2873090">!=</span>&nbsp;<span class="ident" id="2873093">meth</span>&nbsp;<span class="op" id="2873098">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873104">get2</span><span class="op" id="2873108">(</span><span class="ident" id="2873109">buf</span><span class="op" id="2873112">[</span><span class="num" id="2873113">26</span><span class="op" id="2873115">:</span><span class="op" id="2873116">]</span><span class="op" id="2873117">)</span>&nbsp;<span class="op" id="2873119">!=</span>&nbsp;<span class="ident" id="2873122">namelen</span>&nbsp;<span class="op" id="2873130">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2873136">string</span><span class="op" id="2873142">(</span><span class="ident" id="2873143">buf</span><span class="op" id="2873146">[</span><span class="num" id="2873147">30</span><span class="op" id="2873149">:</span><span class="num" id="2873150">30</span><span class="op" id="2873152">+</span><span class="ident" id="2873153">namelen</span><span class="op" id="2873160">]</span><span class="op" id="2873161">)</span>&nbsp;<span class="op" id="2873163">!=</span>&nbsp;<span class="ident" id="2873166">name</span>&nbsp;<span class="op" id="2873171">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873176">return</span>&nbsp;<span class="ident" id="2873183">nil</span><span class="op" id="2873186">,</span>&nbsp;<span class="ident" id="2873188">errors</span><span class="op" id="2873194">.</span><span class="ident" id="2873195">New</span><span class="op" id="2873198">(</span><span class="string" id="2873199">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2873219">+</span>&nbsp;<span class="ident" id="2873221">zipfile</span><span class="op" id="2873228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2873232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873236">xlen</span>&nbsp;<span class="op" id="2873241">=</span>&nbsp;<span class="ident" id="2873243">get2</span><span class="op" id="2873247">(</span><span class="ident" id="2873248">buf</span><span class="op" id="2873251">[</span><span class="num" id="2873252">28</span><span class="op" id="2873254">:</span><span class="op" id="2873255">]</span><span class="op" id="2873256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873261">buf</span>&nbsp;<span class="op" id="2873265">=</span>&nbsp;<span class="builtinfunc" id="2873267">make</span><span class="op" id="2873271">(</span><span class="op" id="2873272">[</span><span class="op" id="2873273">]</span><span class="builtintype" id="2873274">byte</span><span class="op" id="2873278">,</span>&nbsp;<span class="ident" id="2873280">size</span><span class="op" id="2873284">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873288">if</span>&nbsp;<span class="ident" id="2873291">err</span>&nbsp;<span class="op" id="2873295">:=</span>&nbsp;<span class="ident" id="2873298">preadn</span><span class="op" id="2873304">(</span><span class="ident" id="2873305">fd</span><span class="op" id="2873307">,</span>&nbsp;<span class="ident" id="2873309">buf</span><span class="op" id="2873312">,</span>&nbsp;<span class="ident" id="2873314">off</span><span class="op" id="2873317">+</span><span class="num" id="2873318">30</span><span class="op" id="2873320">+</span><span class="ident" id="2873321">namelen</span><span class="op" id="2873328">+</span><span class="ident" id="2873329">xlen</span><span class="op" id="2873333">)</span><span class="op" id="2873334">;</span>&nbsp;<span class="ident" id="2873336">err</span>&nbsp;<span class="op" id="2873340">!=</span>&nbsp;<span class="ident" id="2873343">nil</span>&nbsp;<span class="op" id="2873347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873352">return</span>&nbsp;<span class="ident" id="2873359">nil</span><span class="op" id="2873362">,</span>&nbsp;<span class="ident" id="2873364">errors</span><span class="op" id="2873370">.</span><span class="ident" id="2873371">New</span><span class="op" id="2873374">(</span><span class="string" id="2873375">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2873395">+</span>&nbsp;<span class="ident" id="2873397">zipfile</span><span class="op" id="2873404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2873408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873413">return</span>&nbsp;<span class="ident" id="2873420">loadZoneData</span><span class="op" id="2873432">(</span><span class="ident" id="2873433">buf</span><span class="op" id="2873436">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2873439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873443">return</span>&nbsp;<span class="ident" id="2873450">nil</span><span class="op" id="2873453">,</span>&nbsp;<span class="ident" id="2873455">errors</span><span class="op" id="2873461">.</span><span class="ident" id="2873462">New</span><span class="op" id="2873465">(</span><span class="string" id="2873466">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2873481">+</span>&nbsp;<span class="ident" id="2873483">name</span>&nbsp;<span class="op" id="2873488">+</span>&nbsp;<span class="string" id="2873490">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2873506">+</span>&nbsp;<span class="ident" id="2873508">zipfile</span><span class="op" id="2873515">)</span><br>
<span class="lineno"></span><span class="op" id="2873517">}</span>
</div>
</body>
</html>
