<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5512663">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5512719">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5512773">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5512824">package</span>&nbsp;<span class="ident" id="5512832">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5512840">//&nbsp;Simplify&nbsp;returns&nbsp;a&nbsp;regexp&nbsp;equivalent&nbsp;to&nbsp;re&nbsp;but&nbsp;without&nbsp;counted&nbsp;repetitions</span><br>
<span class="lineno"></span><span class="comment" id="5512918">//&nbsp;and&nbsp;with&nbsp;various&nbsp;other&nbsp;simplifications,&nbsp;such&nbsp;as&nbsp;rewriting&nbsp;/(?:a+)+/&nbsp;to&nbsp;/a+/.</span><br>
<span class="lineno"></span><span class="comment" id="5512998">//&nbsp;The&nbsp;resulting&nbsp;regexp&nbsp;will&nbsp;execute&nbsp;correctly&nbsp;but&nbsp;its&nbsp;string&nbsp;representation</span><br>
<span class="lineno">10</span><span class="comment" id="5513075">//&nbsp;will&nbsp;not&nbsp;produce&nbsp;the&nbsp;same&nbsp;parse&nbsp;tree,&nbsp;because&nbsp;capturing&nbsp;parentheses</span><br>
<span class="lineno"></span><span class="comment" id="5513146">//&nbsp;may&nbsp;have&nbsp;been&nbsp;duplicated&nbsp;or&nbsp;removed.&nbsp;&nbsp;For&nbsp;example,&nbsp;the&nbsp;simplified&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5513220">//&nbsp;for&nbsp;/(x){1,2}/&nbsp;is&nbsp;/(x)(x)?/&nbsp;but&nbsp;both&nbsp;parentheses&nbsp;capture&nbsp;as&nbsp;$1.</span><br>
<span class="lineno"></span><span class="comment" id="5513287">//&nbsp;The&nbsp;returned&nbsp;regexp&nbsp;may&nbsp;share&nbsp;structure&nbsp;with&nbsp;or&nbsp;be&nbsp;the&nbsp;original.</span><br>
<span class="lineno"></span><span class="keyword" id="5513355">func</span>&nbsp;<span class="op" id="5513360">(</span><span class="ident" id="5513361">re</span>&nbsp;<span class="op" id="5513364">*</span><span class="ident" id="5513365"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5513371">)</span>&nbsp;<span class="ident" id="5513373">Simplify</span><span class="op" id="5513381">(</span><span class="op" id="5513382">)</span>&nbsp;<span class="op" id="5513384">*</span><span class="ident" id="5513385"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span>&nbsp;<span class="op" id="5513392">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513395">if</span>&nbsp;<span class="ident" id="5513398"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span>&nbsp;<span class="op" id="5513401">==</span>&nbsp;<span class="ident" id="5513404">nil</span>&nbsp;<span class="op" id="5513408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513412">return</span>&nbsp;<span class="ident" id="5513419">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5513424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513427">switch</span>&nbsp;<span class="ident" id="5513434"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513436">.</span><span class="ident" id="5513437">Op</span>&nbsp;<span class="op" id="5513440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513443">case</span>&nbsp;<span class="ident" id="5513448"><a href="/regexp/syntax/regexp.go.html#5506766">OpCapture</a></span><span class="op" id="5513457">,</span>&nbsp;<span class="ident" id="5513459"><a href="/regexp/syntax/regexp.go.html#5507171">OpConcat</a></span><span class="op" id="5513467">,</span>&nbsp;<span class="ident" id="5513469"><a href="/regexp/syntax/regexp.go.html#5507236">OpAlternate</a></span><span class="op" id="5513480">:</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5513484">//&nbsp;Simplify&nbsp;children,&nbsp;building&nbsp;new&nbsp;Regexp&nbsp;if&nbsp;children&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513548">nre</span>&nbsp;<span class="op" id="5513552">:=</span>&nbsp;<span class="ident" id="5513555"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513560">for</span>&nbsp;<span class="ident" id="5513564">i</span><span class="op" id="5513565">,</span>&nbsp;<span class="ident" id="5513567">sub</span>&nbsp;<span class="op" id="5513571">:=</span>&nbsp;<span class="keyword" id="5513574">range</span>&nbsp;<span class="ident" id="5513580"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513582">.</span><span class="ident" id="5513583">Sub</span>&nbsp;<span class="op" id="5513587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513592">nsub</span>&nbsp;<span class="op" id="5513597">:=</span>&nbsp;<span class="ident" id="5513600"><a href="/regexp/syntax/simplify.go.html#5513567">sub</a></span><span class="op" id="5513603">.</span><span class="ident" id="5513604">Simplify</span><span class="op" id="5513612">(</span><span class="op" id="5513613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513618">if</span>&nbsp;<span class="ident" id="5513621"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span>&nbsp;<span class="op" id="5513625">==</span>&nbsp;<span class="ident" id="5513628"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span>&nbsp;<span class="op" id="5513631">&amp;&amp;</span>&nbsp;<span class="ident" id="5513634"><a href="/regexp/syntax/simplify.go.html#5513592">nsub</a></span>&nbsp;<span class="op" id="5513639">!=</span>&nbsp;<span class="ident" id="5513642"><a href="/regexp/syntax/simplify.go.html#5513567">sub</a></span>&nbsp;<span class="op" id="5513646">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5513652">//&nbsp;Start&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513673"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span>&nbsp;<span class="op" id="5513677">=</span>&nbsp;<span class="builtinfunc" id="5513679">new</span><span class="op" id="5513682">(</span><span class="ident" id="5513683"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5513689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5513695">*</span><span class="ident" id="5513696"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span>&nbsp;<span class="op" id="5513700">=</span>&nbsp;<span class="op" id="5513702">*</span><span class="ident" id="5513703"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513710"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><span class="op" id="5513713">.</span><span class="ident" id="5513714">Rune</span>&nbsp;<span class="op" id="5513719">=</span>&nbsp;<span class="ident" id="5513721">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513729"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><span class="op" id="5513732">.</span><span class="ident" id="5513733">Sub</span>&nbsp;<span class="op" id="5513737">=</span>&nbsp;<span class="builtinfunc" id="5513739">append</span><span class="op" id="5513745">(</span><span class="ident" id="5513746"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><span class="op" id="5513749">.</span><span class="ident" id="5513750">Sub0</span><span class="op" id="5513754">[</span><span class="op" id="5513755">:</span><span class="num" id="5513756">0</span><span class="op" id="5513757">]</span><span class="op" id="5513758">,</span>&nbsp;<span class="ident" id="5513760"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513762">.</span><span class="ident" id="5513763">Sub</span><span class="op" id="5513766">[</span><span class="op" id="5513767">:</span><span class="ident" id="5513768"><a href="/regexp/syntax/simplify.go.html#5513564">i</a></span><span class="op" id="5513769">]</span><span class="op" id="5513770">...</span><span class="op" id="5513773">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5513778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513783">if</span>&nbsp;<span class="ident" id="5513786"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span>&nbsp;<span class="op" id="5513790">!=</span>&nbsp;<span class="ident" id="5513793"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span>&nbsp;<span class="op" id="5513796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513802"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><span class="op" id="5513805">.</span><span class="ident" id="5513806">Sub</span>&nbsp;<span class="op" id="5513810">=</span>&nbsp;<span class="builtinfunc" id="5513812">append</span><span class="op" id="5513818">(</span><span class="ident" id="5513819"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><span class="op" id="5513822">.</span><span class="ident" id="5513823">Sub</span><span class="op" id="5513826">,</span>&nbsp;<span class="ident" id="5513828"><a href="/regexp/syntax/simplify.go.html#5513592">nsub</a></span><span class="op" id="5513832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5513837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5513841">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513845">return</span>&nbsp;<span class="ident" id="5513852"><a href="/regexp/syntax/simplify.go.html#5513548">nre</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513858">case</span>&nbsp;<span class="ident" id="5513863"><a href="/regexp/syntax/regexp.go.html#5506860">OpStar</a></span><span class="op" id="5513869">,</span>&nbsp;<span class="ident" id="5513871"><a href="/regexp/syntax/regexp.go.html#5506929">OpPlus</a></span><span class="op" id="5513877">,</span>&nbsp;<span class="ident" id="5513879"><a href="/regexp/syntax/regexp.go.html#5506997">OpQuest</a></span><span class="op" id="5513886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5513890">sub</span>&nbsp;<span class="op" id="5513894">:=</span>&nbsp;<span class="ident" id="5513897"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513899">.</span><span class="ident" id="5513900">Sub</span><span class="op" id="5513903">[</span><span class="num" id="5513904">0</span><span class="op" id="5513905">]</span><span class="op" id="5513906">.</span><span class="ident" id="5513907">Simplify</span><span class="op" id="5513915">(</span><span class="op" id="5513916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513920">return</span>&nbsp;<span class="ident" id="5513927"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5513936">(</span><span class="ident" id="5513937"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513939">.</span><span class="ident" id="5513940">Op</span><span class="op" id="5513942">,</span>&nbsp;<span class="ident" id="5513944"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513946">.</span><span class="ident" id="5513947">Flags</span><span class="op" id="5513952">,</span>&nbsp;<span class="ident" id="5513954"><a href="/regexp/syntax/simplify.go.html#5513890">sub</a></span><span class="op" id="5513957">,</span>&nbsp;<span class="ident" id="5513959"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5513961">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5513965">case</span>&nbsp;<span class="ident" id="5513970"><a href="/regexp/syntax/regexp.go.html#5507065">OpRepeat</a></span><span class="op" id="5513978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5513982">//&nbsp;Special&nbsp;special&nbsp;case:&nbsp;x{0}&nbsp;matches&nbsp;the&nbsp;empty&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514039">//&nbsp;and&nbsp;doesn&#39;t&nbsp;even&nbsp;need&nbsp;to&nbsp;consider&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514081">if</span>&nbsp;<span class="ident" id="5514084"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514086">.</span><span class="ident" id="5514087">Min</span>&nbsp;<span class="op" id="5514091">==</span>&nbsp;<span class="num" id="5514094">0</span>&nbsp;<span class="op" id="5514096">&amp;&amp;</span>&nbsp;<span class="ident" id="5514099"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514101">.</span><span class="ident" id="5514102">Max</span>&nbsp;<span class="op" id="5514106">==</span>&nbsp;<span class="num" id="5514109">0</span>&nbsp;<span class="op" id="5514111">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514116">return</span>&nbsp;<span class="op" id="5514123">&amp;</span><span class="ident" id="5514124"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5514130">{</span><span class="ident" id="5514131">Op</span><span class="op" id="5514133">:</span>&nbsp;<span class="ident" id="5514135"><a href="/regexp/syntax/regexp.go.html#5506019">OpEmptyMatch</a></span><span class="op" id="5514147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514156">//&nbsp;The&nbsp;fun&nbsp;begins.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5514177">sub</span>&nbsp;<span class="op" id="5514181">:=</span>&nbsp;<span class="ident" id="5514184"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514186">.</span><span class="ident" id="5514187">Sub</span><span class="op" id="5514190">[</span><span class="num" id="5514191">0</span><span class="op" id="5514192">]</span><span class="op" id="5514193">.</span><span class="ident" id="5514194">Simplify</span><span class="op" id="5514202">(</span><span class="op" id="5514203">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514208">//&nbsp;x{n,}&nbsp;means&nbsp;at&nbsp;least&nbsp;n&nbsp;matches&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514250">if</span>&nbsp;<span class="ident" id="5514253"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514255">.</span><span class="ident" id="5514256">Max</span>&nbsp;<span class="op" id="5514260">==</span>&nbsp;<span class="op" id="5514263">-</span><span class="num" id="5514264">1</span>&nbsp;<span class="op" id="5514266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514271">//&nbsp;Special&nbsp;case:&nbsp;x{0,}&nbsp;is&nbsp;x*.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514304">if</span>&nbsp;<span class="ident" id="5514307"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514309">.</span><span class="ident" id="5514310">Min</span>&nbsp;<span class="op" id="5514314">==</span>&nbsp;<span class="num" id="5514317">0</span>&nbsp;<span class="op" id="5514319">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514325">return</span>&nbsp;<span class="ident" id="5514332"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5514341">(</span><span class="ident" id="5514342"><a href="/regexp/syntax/regexp.go.html#5506860">OpStar</a></span><span class="op" id="5514348">,</span>&nbsp;<span class="ident" id="5514350"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514352">.</span><span class="ident" id="5514353">Flags</span><span class="op" id="5514358">,</span>&nbsp;<span class="ident" id="5514360"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5514363">,</span>&nbsp;<span class="ident" id="5514365">nil</span><span class="op" id="5514368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514379">//&nbsp;Special&nbsp;case:&nbsp;x{1,}&nbsp;is&nbsp;x+.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514412">if</span>&nbsp;<span class="ident" id="5514415"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514417">.</span><span class="ident" id="5514418">Min</span>&nbsp;<span class="op" id="5514422">==</span>&nbsp;<span class="num" id="5514425">1</span>&nbsp;<span class="op" id="5514427">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514433">return</span>&nbsp;<span class="ident" id="5514440"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5514449">(</span><span class="ident" id="5514450"><a href="/regexp/syntax/regexp.go.html#5506929">OpPlus</a></span><span class="op" id="5514456">,</span>&nbsp;<span class="ident" id="5514458"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514460">.</span><span class="ident" id="5514461">Flags</span><span class="op" id="5514466">,</span>&nbsp;<span class="ident" id="5514468"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5514471">,</span>&nbsp;<span class="ident" id="5514473">nil</span><span class="op" id="5514476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514487">//&nbsp;General&nbsp;case:&nbsp;x{4,}&nbsp;is&nbsp;xxxx+.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5514523">nre</span>&nbsp;<span class="op" id="5514527">:=</span>&nbsp;<span class="op" id="5514530">&amp;</span><span class="ident" id="5514531"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5514537">{</span><span class="ident" id="5514538">Op</span><span class="op" id="5514540">:</span>&nbsp;<span class="ident" id="5514542"><a href="/regexp/syntax/regexp.go.html#5507171">OpConcat</a></span><span class="op" id="5514550">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5514555"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514558">.</span><span class="ident" id="5514559">Sub</span>&nbsp;<span class="op" id="5514563">=</span>&nbsp;<span class="ident" id="5514565"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514568">.</span><span class="ident" id="5514569">Sub0</span><span class="op" id="5514573">[</span><span class="op" id="5514574">:</span><span class="num" id="5514575">0</span><span class="op" id="5514576">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514581">for</span>&nbsp;<span class="ident" id="5514585">i</span>&nbsp;<span class="op" id="5514587">:=</span>&nbsp;<span class="num" id="5514590">0</span><span class="op" id="5514591">;</span>&nbsp;<span class="ident" id="5514593"><a href="/regexp/syntax/simplify.go.html#5514585">i</a></span>&nbsp;<span class="op" id="5514595">&lt;</span>&nbsp;<span class="ident" id="5514597"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514599">.</span><span class="ident" id="5514600">Min</span><span class="op" id="5514603">-</span><span class="num" id="5514604">1</span><span class="op" id="5514605">;</span>&nbsp;<span class="ident" id="5514607"><a href="/regexp/syntax/simplify.go.html#5514585">i</a></span><span class="op" id="5514608">++</span>&nbsp;<span class="op" id="5514611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5514617"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514620">.</span><span class="ident" id="5514621">Sub</span>&nbsp;<span class="op" id="5514625">=</span>&nbsp;<span class="builtinfunc" id="5514627">append</span><span class="op" id="5514633">(</span><span class="ident" id="5514634"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514637">.</span><span class="ident" id="5514638">Sub</span><span class="op" id="5514641">,</span>&nbsp;<span class="ident" id="5514643"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5514646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5514656"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514659">.</span><span class="ident" id="5514660">Sub</span>&nbsp;<span class="op" id="5514664">=</span>&nbsp;<span class="builtinfunc" id="5514666">append</span><span class="op" id="5514672">(</span><span class="ident" id="5514673"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><span class="op" id="5514676">.</span><span class="ident" id="5514677">Sub</span><span class="op" id="5514680">,</span>&nbsp;<span class="ident" id="5514682"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5514691">(</span><span class="ident" id="5514692"><a href="/regexp/syntax/regexp.go.html#5506929">OpPlus</a></span><span class="op" id="5514698">,</span>&nbsp;<span class="ident" id="5514700"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514702">.</span><span class="ident" id="5514703">Flags</span><span class="op" id="5514708">,</span>&nbsp;<span class="ident" id="5514710"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5514713">,</span>&nbsp;<span class="ident" id="5514715">nil</span><span class="op" id="5514718">)</span><span class="op" id="5514719">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514724">return</span>&nbsp;<span class="ident" id="5514731"><a href="/regexp/syntax/simplify.go.html#5514523">nre</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514742">//&nbsp;Special&nbsp;case&nbsp;x{0}&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514781">//&nbsp;Special&nbsp;case:&nbsp;x{1}&nbsp;is&nbsp;just&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514816">if</span>&nbsp;<span class="ident" id="5514819"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514821">.</span><span class="ident" id="5514822">Min</span>&nbsp;<span class="op" id="5514826">==</span>&nbsp;<span class="num" id="5514829">1</span>&nbsp;<span class="op" id="5514831">&amp;&amp;</span>&nbsp;<span class="ident" id="5514834"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5514836">.</span><span class="ident" id="5514837">Max</span>&nbsp;<span class="op" id="5514841">==</span>&nbsp;<span class="num" id="5514844">1</span>&nbsp;<span class="op" id="5514846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5514851">return</span>&nbsp;<span class="ident" id="5514858"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5514864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514869">//&nbsp;General&nbsp;case:&nbsp;x{n,m}&nbsp;means&nbsp;n&nbsp;copies&nbsp;of&nbsp;x&nbsp;and&nbsp;m&nbsp;copies&nbsp;of&nbsp;x?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5514934">//&nbsp;The&nbsp;machine&nbsp;will&nbsp;do&nbsp;less&nbsp;work&nbsp;if&nbsp;we&nbsp;nest&nbsp;the&nbsp;final&nbsp;m&nbsp;copies,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5515000">//&nbsp;so&nbsp;that&nbsp;x{2,5}&nbsp;=&nbsp;xx(x(x(x)?)?)?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5515038">//&nbsp;Build&nbsp;leading&nbsp;prefix:&nbsp;xx.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515069">var</span>&nbsp;<span class="ident" id="5515073">prefix</span>&nbsp;<span class="op" id="5515080">*</span><span class="ident" id="5515081"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515090">if</span>&nbsp;<span class="ident" id="5515093"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515095">.</span><span class="ident" id="5515096">Min</span>&nbsp;<span class="op" id="5515100">&gt;</span>&nbsp;<span class="num" id="5515102">0</span>&nbsp;<span class="op" id="5515104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515109"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span>&nbsp;<span class="op" id="5515116">=</span>&nbsp;<span class="op" id="5515118">&amp;</span><span class="ident" id="5515119"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5515125">{</span><span class="ident" id="5515126">Op</span><span class="op" id="5515128">:</span>&nbsp;<span class="ident" id="5515130"><a href="/regexp/syntax/regexp.go.html#5507171">OpConcat</a></span><span class="op" id="5515138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515143"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515149">.</span><span class="ident" id="5515150">Sub</span>&nbsp;<span class="op" id="5515154">=</span>&nbsp;<span class="ident" id="5515156"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515162">.</span><span class="ident" id="5515163">Sub0</span><span class="op" id="5515167">[</span><span class="op" id="5515168">:</span><span class="num" id="5515169">0</span><span class="op" id="5515170">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515175">for</span>&nbsp;<span class="ident" id="5515179">i</span>&nbsp;<span class="op" id="5515181">:=</span>&nbsp;<span class="num" id="5515184">0</span><span class="op" id="5515185">;</span>&nbsp;<span class="ident" id="5515187"><a href="/regexp/syntax/simplify.go.html#5515179">i</a></span>&nbsp;<span class="op" id="5515189">&lt;</span>&nbsp;<span class="ident" id="5515191"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515193">.</span><span class="ident" id="5515194">Min</span><span class="op" id="5515197">;</span>&nbsp;<span class="ident" id="5515199"><a href="/regexp/syntax/simplify.go.html#5515179">i</a></span><span class="op" id="5515200">++</span>&nbsp;<span class="op" id="5515203">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515209"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515215">.</span><span class="ident" id="5515216">Sub</span>&nbsp;<span class="op" id="5515220">=</span>&nbsp;<span class="builtinfunc" id="5515222">append</span><span class="op" id="5515228">(</span><span class="ident" id="5515229"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515235">.</span><span class="ident" id="5515236">Sub</span><span class="op" id="5515239">,</span>&nbsp;<span class="ident" id="5515241"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5515244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5515258">//&nbsp;Build&nbsp;and&nbsp;attach&nbsp;suffix:&nbsp;(x(x(x)?)?)?</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515301">if</span>&nbsp;<span class="ident" id="5515304"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515306">.</span><span class="ident" id="5515307">Max</span>&nbsp;<span class="op" id="5515311">&gt;</span>&nbsp;<span class="ident" id="5515313"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515315">.</span><span class="ident" id="5515316">Min</span>&nbsp;<span class="op" id="5515320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515325">suffix</span>&nbsp;<span class="op" id="5515332">:=</span>&nbsp;<span class="ident" id="5515335"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5515344">(</span><span class="ident" id="5515345"><a href="/regexp/syntax/regexp.go.html#5506997">OpQuest</a></span><span class="op" id="5515352">,</span>&nbsp;<span class="ident" id="5515354"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515356">.</span><span class="ident" id="5515357">Flags</span><span class="op" id="5515362">,</span>&nbsp;<span class="ident" id="5515364"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5515367">,</span>&nbsp;<span class="ident" id="5515369">nil</span><span class="op" id="5515372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515377">for</span>&nbsp;<span class="ident" id="5515381">i</span>&nbsp;<span class="op" id="5515383">:=</span>&nbsp;<span class="ident" id="5515386"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515388">.</span><span class="ident" id="5515389">Min</span>&nbsp;<span class="op" id="5515393">+</span>&nbsp;<span class="num" id="5515395">1</span><span class="op" id="5515396">;</span>&nbsp;<span class="ident" id="5515398"><a href="/regexp/syntax/simplify.go.html#5515381">i</a></span>&nbsp;<span class="op" id="5515400">&lt;</span>&nbsp;<span class="ident" id="5515402"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515404">.</span><span class="ident" id="5515405">Max</span><span class="op" id="5515408">;</span>&nbsp;<span class="ident" id="5515410"><a href="/regexp/syntax/simplify.go.html#5515381">i</a></span><span class="op" id="5515411">++</span>&nbsp;<span class="op" id="5515414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515420">nre2</span>&nbsp;<span class="op" id="5515425">:=</span>&nbsp;<span class="op" id="5515428">&amp;</span><span class="ident" id="5515429"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5515435">{</span><span class="ident" id="5515436">Op</span><span class="op" id="5515438">:</span>&nbsp;<span class="ident" id="5515440"><a href="/regexp/syntax/regexp.go.html#5507171">OpConcat</a></span><span class="op" id="5515448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515454"><a href="/regexp/syntax/simplify.go.html#5515420">nre2</a></span><span class="op" id="5515458">.</span><span class="ident" id="5515459">Sub</span>&nbsp;<span class="op" id="5515463">=</span>&nbsp;<span class="builtinfunc" id="5515465">append</span><span class="op" id="5515471">(</span><span class="ident" id="5515472"><a href="/regexp/syntax/simplify.go.html#5515420">nre2</a></span><span class="op" id="5515476">.</span><span class="ident" id="5515477">Sub0</span><span class="op" id="5515481">[</span><span class="op" id="5515482">:</span><span class="num" id="5515483">0</span><span class="op" id="5515484">]</span><span class="op" id="5515485">,</span>&nbsp;<span class="ident" id="5515487"><a href="/regexp/syntax/simplify.go.html#5514177">sub</a></span><span class="op" id="5515490">,</span>&nbsp;<span class="ident" id="5515492"><a href="/regexp/syntax/simplify.go.html#5515325">suffix</a></span><span class="op" id="5515498">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515504"><a href="/regexp/syntax/simplify.go.html#5515325">suffix</a></span>&nbsp;<span class="op" id="5515511">=</span>&nbsp;<span class="ident" id="5515513"><a href="/regexp/syntax/simplify.go.html#5516442">simplify1</a></span><span class="op" id="5515522">(</span><span class="ident" id="5515523"><a href="/regexp/syntax/regexp.go.html#5506997">OpQuest</a></span><span class="op" id="5515530">,</span>&nbsp;<span class="ident" id="5515532"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><span class="op" id="5515534">.</span><span class="ident" id="5515535">Flags</span><span class="op" id="5515540">,</span>&nbsp;<span class="ident" id="5515542"><a href="/regexp/syntax/simplify.go.html#5515420">nre2</a></span><span class="op" id="5515546">,</span>&nbsp;<span class="ident" id="5515548">nil</span><span class="op" id="5515551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515561">if</span>&nbsp;<span class="ident" id="5515564"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span>&nbsp;<span class="op" id="5515571">==</span>&nbsp;<span class="ident" id="5515574">nil</span>&nbsp;<span class="op" id="5515578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515584">return</span>&nbsp;<span class="ident" id="5515591"><a href="/regexp/syntax/simplify.go.html#5515325">suffix</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515601">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5515606"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515612">.</span><span class="ident" id="5515613">Sub</span>&nbsp;<span class="op" id="5515617">=</span>&nbsp;<span class="builtinfunc" id="5515619">append</span><span class="op" id="5515625">(</span><span class="ident" id="5515626"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><span class="op" id="5515632">.</span><span class="ident" id="5515633">Sub</span><span class="op" id="5515636">,</span>&nbsp;<span class="ident" id="5515638"><a href="/regexp/syntax/simplify.go.html#5515325">suffix</a></span><span class="op" id="5515644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515652">if</span>&nbsp;<span class="ident" id="5515655"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span>&nbsp;<span class="op" id="5515662">!=</span>&nbsp;<span class="ident" id="5515665">nil</span>&nbsp;<span class="op" id="5515669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515674">return</span>&nbsp;<span class="ident" id="5515681"><a href="/regexp/syntax/simplify.go.html#5515073">prefix</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515690">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5515695">//&nbsp;Some&nbsp;degenerate&nbsp;case&nbsp;like&nbsp;min&nbsp;&gt;&nbsp;max&nbsp;or&nbsp;min&nbsp;&lt;&nbsp;max&nbsp;&lt;&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5515754">//&nbsp;Handle&nbsp;as&nbsp;impossible&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515787">return</span>&nbsp;<span class="op" id="5515794">&amp;</span><span class="ident" id="5515795"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5515801">{</span><span class="ident" id="5515802">Op</span><span class="op" id="5515804">:</span>&nbsp;<span class="ident" id="5515806"><a href="/regexp/syntax/regexp.go.html#5505965">OpNoMatch</a></span><span class="op" id="5515815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5515818">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5515822">return</span>&nbsp;<span class="ident" id="5515829"><a href="/regexp/syntax/simplify.go.html#5513361">re</a></span><br>
<span class="lineno"></span><span class="op" id="5515832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5515835">//&nbsp;simplify1&nbsp;implements&nbsp;Simplify&nbsp;for&nbsp;the&nbsp;unary&nbsp;OpStar,</span><br>
<span class="lineno">120</span><span class="comment" id="5515890">//&nbsp;OpPlus,&nbsp;and&nbsp;OpQuest&nbsp;operators.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;simple&nbsp;regexp</span><br>
<span class="lineno"></span><span class="comment" id="5515954">//&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5515971">//</span><br>
<span class="lineno"></span><span class="comment" id="5515974">//&nbsp;&nbsp;&nbsp;&nbspRegexp{Op:&nbsp;op,&nbsp;Flags:&nbsp;flags,&nbsp;Sub:&nbsp;{sub}}</span><br>
<span class="lineno"></span><span class="comment" id="5516018">//</span><br>
<span class="lineno">125</span><span class="comment" id="5516021">//&nbsp;under&nbsp;the&nbsp;assumption&nbsp;that&nbsp;sub&nbsp;is&nbsp;already&nbsp;simple,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5516077">//&nbsp;without&nbsp;first&nbsp;allocating&nbsp;that&nbsp;structure.&nbsp;&nbsp;If&nbsp;the&nbsp;regexp</span><br>
<span class="lineno"></span><span class="comment" id="5516136">//&nbsp;to&nbsp;be&nbsp;returned&nbsp;turns&nbsp;out&nbsp;to&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;re,&nbsp;simplify1</span><br>
<span class="lineno"></span><span class="comment" id="5516198">//&nbsp;returns&nbsp;re&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="5516221">//</span><br>
<span class="lineno">130</span><span class="comment" id="5516224">//&nbsp;simplify1&nbsp;is&nbsp;factored&nbsp;out&nbsp;of&nbsp;Simplify&nbsp;because&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="5516292">//&nbsp;for&nbsp;other&nbsp;operators&nbsp;generates&nbsp;these&nbsp;unary&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5516350">//&nbsp;Letting&nbsp;them&nbsp;call&nbsp;simplify1&nbsp;makes&nbsp;sure&nbsp;the&nbsp;expressions&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="5516413">//&nbsp;generate&nbsp;are&nbsp;simple.</span><br>
<span class="lineno"></span><span class="keyword" id="5516437">func</span>&nbsp;<span class="ident" id="5516442">simplify1</span><span class="op" id="5516451">(</span><span class="ident" id="5516452">op</span>&nbsp;<span class="ident" id="5516455"><a href="/regexp/syntax/regexp.go.html#5505750">Op</a></span><span class="op" id="5516457">,</span>&nbsp;<span class="ident" id="5516459">flags</span>&nbsp;<span class="ident" id="5516465"><a href="/regexp/syntax/parse.go.html#5449552">Flags</a></span><span class="op" id="5516470">,</span>&nbsp;<span class="ident" id="5516472">sub</span><span class="op" id="5516475">,</span>&nbsp;<span class="ident" id="5516477">re</span>&nbsp;<span class="op" id="5516480">*</span><span class="ident" id="5516481"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5516487">)</span>&nbsp;<span class="op" id="5516489">*</span><span class="ident" id="5516490"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span>&nbsp;<span class="op" id="5516497">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5516500">//&nbsp;Special&nbsp;case:&nbsp;repeat&nbsp;the&nbsp;empty&nbsp;string&nbsp;as&nbsp;much&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5516553">//&nbsp;you&nbsp;want,&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516600">if</span>&nbsp;<span class="ident" id="5516603"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><span class="op" id="5516606">.</span><span class="ident" id="5516607">Op</span>&nbsp;<span class="op" id="5516610">==</span>&nbsp;<span class="ident" id="5516613"><a href="/regexp/syntax/regexp.go.html#5506019">OpEmptyMatch</a></span>&nbsp;<span class="op" id="5516626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516630">return</span>&nbsp;<span class="ident" id="5516637"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5516642">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5516645">//&nbsp;The&nbsp;operators&nbsp;are&nbsp;idempotent&nbsp;if&nbsp;the&nbsp;flags&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516698">if</span>&nbsp;<span class="ident" id="5516701"><a href="/regexp/syntax/simplify.go.html#5516452">op</a></span>&nbsp;<span class="op" id="5516704">==</span>&nbsp;<span class="ident" id="5516707"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><span class="op" id="5516710">.</span><span class="ident" id="5516711">Op</span>&nbsp;<span class="op" id="5516714">&amp;&amp;</span>&nbsp;<span class="ident" id="5516717"><a href="/regexp/syntax/simplify.go.html#5516459">flags</a></span><span class="op" id="5516722">&amp;</span><span class="ident" id="5516723"><a href="/regexp/syntax/parse.go.html#5449964">NonGreedy</a></span>&nbsp;<span class="op" id="5516733">==</span>&nbsp;<span class="ident" id="5516736"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><span class="op" id="5516739">.</span><span class="ident" id="5516740">Flags</span><span class="op" id="5516745">&amp;</span><span class="ident" id="5516746"><a href="/regexp/syntax/parse.go.html#5449964">NonGreedy</a></span>&nbsp;<span class="op" id="5516756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516760">return</span>&nbsp;<span class="ident" id="5516767"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5516772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516775">if</span>&nbsp;<span class="ident" id="5516778"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span>&nbsp;<span class="op" id="5516781">!=</span>&nbsp;<span class="ident" id="5516784">nil</span>&nbsp;<span class="op" id="5516788">&amp;&amp;</span>&nbsp;<span class="ident" id="5516791"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><span class="op" id="5516793">.</span><span class="ident" id="5516794">Op</span>&nbsp;<span class="op" id="5516797">==</span>&nbsp;<span class="ident" id="5516800"><a href="/regexp/syntax/simplify.go.html#5516452">op</a></span>&nbsp;<span class="op" id="5516803">&amp;&amp;</span>&nbsp;<span class="ident" id="5516806"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><span class="op" id="5516808">.</span><span class="ident" id="5516809">Flags</span><span class="op" id="5516814">&amp;</span><span class="ident" id="5516815"><a href="/regexp/syntax/parse.go.html#5449964">NonGreedy</a></span>&nbsp;<span class="op" id="5516825">==</span>&nbsp;<span class="ident" id="5516828"><a href="/regexp/syntax/simplify.go.html#5516459">flags</a></span><span class="op" id="5516833">&amp;</span><span class="ident" id="5516834"><a href="/regexp/syntax/parse.go.html#5449964">NonGreedy</a></span>&nbsp;<span class="op" id="5516844">&amp;&amp;</span>&nbsp;<span class="ident" id="5516847"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span>&nbsp;<span class="op" id="5516851">==</span>&nbsp;<span class="ident" id="5516854"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><span class="op" id="5516856">.</span><span class="ident" id="5516857">Sub</span><span class="op" id="5516860">[</span><span class="num" id="5516861">0</span><span class="op" id="5516862">]</span>&nbsp;<span class="op" id="5516864">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516868">return</span>&nbsp;<span class="ident" id="5516875"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5516879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5516883"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span>&nbsp;<span class="op" id="5516886">=</span>&nbsp;<span class="op" id="5516888">&amp;</span><span class="ident" id="5516889"><a href="/regexp/syntax/regexp.go.html#5505274">Regexp</a></span><span class="op" id="5516895">{</span><span class="ident" id="5516896">Op</span><span class="op" id="5516898">:</span>&nbsp;<span class="ident" id="5516900"><a href="/regexp/syntax/simplify.go.html#5516452">op</a></span><span class="op" id="5516902">,</span>&nbsp;<span class="ident" id="5516904">Flags</span><span class="op" id="5516909">:</span>&nbsp;<span class="ident" id="5516911"><a href="/regexp/syntax/simplify.go.html#5516459">flags</a></span><span class="op" id="5516916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5516919"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><span class="op" id="5516921">.</span><span class="ident" id="5516922">Sub</span>&nbsp;<span class="op" id="5516926">=</span>&nbsp;<span class="builtinfunc" id="5516928">append</span><span class="op" id="5516934">(</span><span class="ident" id="5516935"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><span class="op" id="5516937">.</span><span class="ident" id="5516938">Sub0</span><span class="op" id="5516942">[</span><span class="op" id="5516943">:</span><span class="num" id="5516944">0</span><span class="op" id="5516945">]</span><span class="op" id="5516946">,</span>&nbsp;<span class="ident" id="5516948"><a href="/regexp/syntax/simplify.go.html#5516472">sub</a></span><span class="op" id="5516951">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5516954">return</span>&nbsp;<span class="ident" id="5516961"><a href="/regexp/syntax/simplify.go.html#5516477">re</a></span><br>
<span class="lineno"></span><span class="op" id="5516964">}</span>
</div>
</body>
</html>
