<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4159298">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4159354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4159408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4159459">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4159532">package</span>&nbsp;<span class="ident" id="4159540">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4159545">import</span>&nbsp;<span class="op" id="4159552">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4159555">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4159561">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4159571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4159574">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="4159593">func</span>&nbsp;<span class="ident" id="4159598">boolint</span><span class="op" id="4159605">(</span><span class="ident" id="4159606">b</span>&nbsp;<span class="builtintype" id="4159608">bool</span><span class="op" id="4159612">)</span>&nbsp;<span class="builtintype" id="4159614">int</span>&nbsp;<span class="op" id="4159618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159621">if</span>&nbsp;<span class="ident" id="4159624">b</span>&nbsp;<span class="op" id="4159626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159630">return</span>&nbsp;<span class="num" id="4159637">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159643">return</span>&nbsp;<span class="num" id="4159650">0</span><br>
<span class="lineno">20</span><span class="op" id="4159652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4159655">func</span>&nbsp;<span class="ident" id="4159660">ipv4AddrToInterface</span><span class="op" id="4159679">(</span><span class="ident" id="4159680">ip</span>&nbsp;<span class="ident" id="4159683">IP</span><span class="op" id="4159685">)</span>&nbsp;<span class="op" id="4159687">(</span><span class="op" id="4159688">*</span><span class="ident" id="4159689">Interface</span><span class="op" id="4159698">,</span>&nbsp;<span class="builtintype" id="4159700">error</span><span class="op" id="4159705">)</span>&nbsp;<span class="op" id="4159707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159710">ift</span><span class="op" id="4159713">,</span>&nbsp;<span class="ident" id="4159715">err</span>&nbsp;<span class="op" id="4159719">:=</span>&nbsp;<span class="ident" id="4159722">Interfaces</span><span class="op" id="4159732">(</span><span class="op" id="4159733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159736">if</span>&nbsp;<span class="ident" id="4159739">err</span>&nbsp;<span class="op" id="4159743">!=</span>&nbsp;<span class="ident" id="4159746">nil</span>&nbsp;<span class="op" id="4159750">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159754">return</span>&nbsp;<span class="ident" id="4159761">nil</span><span class="op" id="4159764">,</span>&nbsp;<span class="ident" id="4159766">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159774">for</span>&nbsp;<span class="ident" id="4159778">_</span><span class="op" id="4159779">,</span>&nbsp;<span class="ident" id="4159781">ifi</span>&nbsp;<span class="op" id="4159785">:=</span>&nbsp;<span class="keyword" id="4159788">range</span>&nbsp;<span class="ident" id="4159794">ift</span>&nbsp;<span class="op" id="4159798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159802">ifat</span><span class="op" id="4159806">,</span>&nbsp;<span class="ident" id="4159808">err</span>&nbsp;<span class="op" id="4159812">:=</span>&nbsp;<span class="ident" id="4159815">ifi</span><span class="op" id="4159818">.</span><span class="ident" id="4159819">Addrs</span><span class="op" id="4159824">(</span><span class="op" id="4159825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159829">if</span>&nbsp;<span class="ident" id="4159832">err</span>&nbsp;<span class="op" id="4159836">!=</span>&nbsp;<span class="ident" id="4159839">nil</span>&nbsp;<span class="op" id="4159843">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159848">return</span>&nbsp;<span class="ident" id="4159855">nil</span><span class="op" id="4159858">,</span>&nbsp;<span class="ident" id="4159860">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159870">for</span>&nbsp;<span class="ident" id="4159874">_</span><span class="op" id="4159875">,</span>&nbsp;<span class="ident" id="4159877">ifa</span>&nbsp;<span class="op" id="4159881">:=</span>&nbsp;<span class="keyword" id="4159884">range</span>&nbsp;<span class="ident" id="4159890">ifat</span>&nbsp;<span class="op" id="4159895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159900">switch</span>&nbsp;<span class="ident" id="4159907">v</span>&nbsp;<span class="op" id="4159909">:=</span>&nbsp;<span class="ident" id="4159912">ifa</span><span class="op" id="4159915">.</span><span class="op" id="4159916">(</span><span class="keyword" id="4159917">type</span><span class="op" id="4159921">)</span>&nbsp;<span class="op" id="4159923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159928">case</span>&nbsp;<span class="op" id="4159933">*</span><span class="ident" id="4159934">IPAddr</span><span class="op" id="4159940">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159946">if</span>&nbsp;<span class="ident" id="4159949">ip</span><span class="op" id="4159951">.</span><span class="ident" id="4159952">Equal</span><span class="op" id="4159957">(</span><span class="ident" id="4159958">v</span><span class="op" id="4159959">.</span><span class="ident" id="4159960">IP</span><span class="op" id="4159962">)</span>&nbsp;<span class="op" id="4159964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159971">return</span>&nbsp;<span class="op" id="4159978">&amp;</span><span class="ident" id="4159979">ifi</span><span class="op" id="4159982">,</span>&nbsp;<span class="ident" id="4159984">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159997">case</span>&nbsp;<span class="op" id="4160002">*</span><span class="ident" id="4160003">IPNet</span><span class="op" id="4160008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160014">if</span>&nbsp;<span class="ident" id="4160017">ip</span><span class="op" id="4160019">.</span><span class="ident" id="4160020">Equal</span><span class="op" id="4160025">(</span><span class="ident" id="4160026">v</span><span class="op" id="4160027">.</span><span class="ident" id="4160028">IP</span><span class="op" id="4160030">)</span>&nbsp;<span class="op" id="4160032">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160039">return</span>&nbsp;<span class="op" id="4160046">&amp;</span><span class="ident" id="4160047">ifi</span><span class="op" id="4160050">,</span>&nbsp;<span class="ident" id="4160052">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160072">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160075">if</span>&nbsp;<span class="ident" id="4160078">ip</span><span class="op" id="4160080">.</span><span class="ident" id="4160081">Equal</span><span class="op" id="4160086">(</span><span class="ident" id="4160087">IPv4zero</span><span class="op" id="4160095">)</span>&nbsp;<span class="op" id="4160097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160101">return</span>&nbsp;<span class="ident" id="4160108">nil</span><span class="op" id="4160111">,</span>&nbsp;<span class="ident" id="4160113">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160121">return</span>&nbsp;<span class="ident" id="4160128">nil</span><span class="op" id="4160131">,</span>&nbsp;<span class="ident" id="4160133">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4160152">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4160155">func</span>&nbsp;<span class="ident" id="4160160">interfaceToIPv4Addr</span><span class="op" id="4160179">(</span><span class="ident" id="4160180">ifi</span>&nbsp;<span class="op" id="4160184">*</span><span class="ident" id="4160185">Interface</span><span class="op" id="4160194">)</span>&nbsp;<span class="op" id="4160196">(</span><span class="ident" id="4160197">IP</span><span class="op" id="4160199">,</span>&nbsp;<span class="builtintype" id="4160201">error</span><span class="op" id="4160206">)</span>&nbsp;<span class="op" id="4160208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160211">if</span>&nbsp;<span class="ident" id="4160214">ifi</span>&nbsp;<span class="op" id="4160218">==</span>&nbsp;<span class="ident" id="4160221">nil</span>&nbsp;<span class="op" id="4160225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160229">return</span>&nbsp;<span class="ident" id="4160236">IPv4zero</span><span class="op" id="4160244">,</span>&nbsp;<span class="ident" id="4160246">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160251">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160254">ifat</span><span class="op" id="4160258">,</span>&nbsp;<span class="ident" id="4160260">err</span>&nbsp;<span class="op" id="4160264">:=</span>&nbsp;<span class="ident" id="4160267">ifi</span><span class="op" id="4160270">.</span><span class="ident" id="4160271">Addrs</span><span class="op" id="4160276">(</span><span class="op" id="4160277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160280">if</span>&nbsp;<span class="ident" id="4160283">err</span>&nbsp;<span class="op" id="4160287">!=</span>&nbsp;<span class="ident" id="4160290">nil</span>&nbsp;<span class="op" id="4160294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160298">return</span>&nbsp;<span class="ident" id="4160305">nil</span><span class="op" id="4160308">,</span>&nbsp;<span class="ident" id="4160310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160318">for</span>&nbsp;<span class="ident" id="4160322">_</span><span class="op" id="4160323">,</span>&nbsp;<span class="ident" id="4160325">ifa</span>&nbsp;<span class="op" id="4160329">:=</span>&nbsp;<span class="keyword" id="4160332">range</span>&nbsp;<span class="ident" id="4160338">ifat</span>&nbsp;<span class="op" id="4160343">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160347">switch</span>&nbsp;<span class="ident" id="4160354">v</span>&nbsp;<span class="op" id="4160356">:=</span>&nbsp;<span class="ident" id="4160359">ifa</span><span class="op" id="4160362">.</span><span class="op" id="4160363">(</span><span class="keyword" id="4160364">type</span><span class="op" id="4160368">)</span>&nbsp;<span class="op" id="4160370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160374">case</span>&nbsp;<span class="op" id="4160379">*</span><span class="ident" id="4160380">IPAddr</span><span class="op" id="4160386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160391">if</span>&nbsp;<span class="ident" id="4160394">v</span><span class="op" id="4160395">.</span><span class="ident" id="4160396">IP</span><span class="op" id="4160398">.</span><span class="ident" id="4160399">To4</span><span class="op" id="4160402">(</span><span class="op" id="4160403">)</span>&nbsp;<span class="op" id="4160405">!=</span>&nbsp;<span class="ident" id="4160408">nil</span>&nbsp;<span class="op" id="4160412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160418">return</span>&nbsp;<span class="ident" id="4160425">v</span><span class="op" id="4160426">.</span><span class="ident" id="4160427">IP</span><span class="op" id="4160429">,</span>&nbsp;<span class="ident" id="4160431">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160438">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160442">case</span>&nbsp;<span class="op" id="4160447">*</span><span class="ident" id="4160448">IPNet</span><span class="op" id="4160453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160458">if</span>&nbsp;<span class="ident" id="4160461">v</span><span class="op" id="4160462">.</span><span class="ident" id="4160463">IP</span><span class="op" id="4160465">.</span><span class="ident" id="4160466">To4</span><span class="op" id="4160469">(</span><span class="op" id="4160470">)</span>&nbsp;<span class="op" id="4160472">!=</span>&nbsp;<span class="ident" id="4160475">nil</span>&nbsp;<span class="op" id="4160479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160485">return</span>&nbsp;<span class="ident" id="4160492">v</span><span class="op" id="4160493">.</span><span class="ident" id="4160494">IP</span><span class="op" id="4160496">,</span>&nbsp;<span class="ident" id="4160498">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160509">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160515">return</span>&nbsp;<span class="ident" id="4160522">nil</span><span class="op" id="4160525">,</span>&nbsp;<span class="ident" id="4160527">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4160546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4160549">func</span>&nbsp;<span class="ident" id="4160554">setIPv4MreqToInterface</span><span class="op" id="4160576">(</span><span class="ident" id="4160577">mreq</span>&nbsp;<span class="op" id="4160582">*</span><span class="ident" id="4160583">syscall</span><span class="op" id="4160590">.</span><span class="ident" id="4160591">IPMreq</span><span class="op" id="4160597">,</span>&nbsp;<span class="ident" id="4160599">ifi</span>&nbsp;<span class="op" id="4160603">*</span><span class="ident" id="4160604">Interface</span><span class="op" id="4160613">)</span>&nbsp;<span class="builtintype" id="4160615">error</span>&nbsp;<span class="op" id="4160621">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160624">if</span>&nbsp;<span class="ident" id="4160627">ifi</span>&nbsp;<span class="op" id="4160631">==</span>&nbsp;<span class="ident" id="4160634">nil</span>&nbsp;<span class="op" id="4160638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160642">return</span>&nbsp;<span class="ident" id="4160649">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160657">ifat</span><span class="op" id="4160661">,</span>&nbsp;<span class="ident" id="4160663">err</span>&nbsp;<span class="op" id="4160667">:=</span>&nbsp;<span class="ident" id="4160670">ifi</span><span class="op" id="4160673">.</span><span class="ident" id="4160674">Addrs</span><span class="op" id="4160679">(</span><span class="op" id="4160680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160683">if</span>&nbsp;<span class="ident" id="4160686">err</span>&nbsp;<span class="op" id="4160690">!=</span>&nbsp;<span class="ident" id="4160693">nil</span>&nbsp;<span class="op" id="4160697">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160701">return</span>&nbsp;<span class="ident" id="4160708">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160716">for</span>&nbsp;<span class="ident" id="4160720">_</span><span class="op" id="4160721">,</span>&nbsp;<span class="ident" id="4160723">ifa</span>&nbsp;<span class="op" id="4160727">:=</span>&nbsp;<span class="keyword" id="4160730">range</span>&nbsp;<span class="ident" id="4160736">ifat</span>&nbsp;<span class="op" id="4160741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160745">switch</span>&nbsp;<span class="ident" id="4160752">v</span>&nbsp;<span class="op" id="4160754">:=</span>&nbsp;<span class="ident" id="4160757">ifa</span><span class="op" id="4160760">.</span><span class="op" id="4160761">(</span><span class="keyword" id="4160762">type</span><span class="op" id="4160766">)</span>&nbsp;<span class="op" id="4160768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160772">case</span>&nbsp;<span class="op" id="4160777">*</span><span class="ident" id="4160778">IPAddr</span><span class="op" id="4160784">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160789">if</span>&nbsp;<span class="ident" id="4160792">a</span>&nbsp;<span class="op" id="4160794">:=</span>&nbsp;<span class="ident" id="4160797">v</span><span class="op" id="4160798">.</span><span class="ident" id="4160799">IP</span><span class="op" id="4160801">.</span><span class="ident" id="4160802">To4</span><span class="op" id="4160805">(</span><span class="op" id="4160806">)</span><span class="op" id="4160807">;</span>&nbsp;<span class="ident" id="4160809">a</span>&nbsp;<span class="op" id="4160811">!=</span>&nbsp;<span class="ident" id="4160814">nil</span>&nbsp;<span class="op" id="4160818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4160824">copy</span><span class="op" id="4160828">(</span><span class="ident" id="4160829">mreq</span><span class="op" id="4160833">.</span><span class="ident" id="4160834">Interface</span><span class="op" id="4160843">[</span><span class="op" id="4160844">:</span><span class="op" id="4160845">]</span><span class="op" id="4160846">,</span>&nbsp;<span class="ident" id="4160848">a</span><span class="op" id="4160849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160855">goto</span>&nbsp;<span class="ident" id="4160860">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160872">case</span>&nbsp;<span class="op" id="4160877">*</span><span class="ident" id="4160878">IPNet</span><span class="op" id="4160883">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160888">if</span>&nbsp;<span class="ident" id="4160891">a</span>&nbsp;<span class="op" id="4160893">:=</span>&nbsp;<span class="ident" id="4160896">v</span><span class="op" id="4160897">.</span><span class="ident" id="4160898">IP</span><span class="op" id="4160900">.</span><span class="ident" id="4160901">To4</span><span class="op" id="4160904">(</span><span class="op" id="4160905">)</span><span class="op" id="4160906">;</span>&nbsp;<span class="ident" id="4160908">a</span>&nbsp;<span class="op" id="4160910">!=</span>&nbsp;<span class="ident" id="4160913">nil</span>&nbsp;<span class="op" id="4160917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4160923">copy</span><span class="op" id="4160927">(</span><span class="ident" id="4160928">mreq</span><span class="op" id="4160932">.</span><span class="ident" id="4160933">Interface</span><span class="op" id="4160942">[</span><span class="op" id="4160943">:</span><span class="op" id="4160944">]</span><span class="op" id="4160945">,</span>&nbsp;<span class="ident" id="4160947">a</span><span class="op" id="4160948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160954">goto</span>&nbsp;<span class="ident" id="4160959">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160971">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160974">}</span><br>
<span class="lineno"></span><span class="ident" id="4160976">done</span><span class="op" id="4160980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160983">if</span>&nbsp;<span class="ident" id="4160986">bytesEqual</span><span class="op" id="4160996">(</span><span class="ident" id="4160997">mreq</span><span class="op" id="4161001">.</span><span class="ident" id="4161002">Multiaddr</span><span class="op" id="4161011">[</span><span class="op" id="4161012">:</span><span class="op" id="4161013">]</span><span class="op" id="4161014">,</span>&nbsp;<span class="ident" id="4161016">IPv4zero</span><span class="op" id="4161024">.</span><span class="ident" id="4161025">To4</span><span class="op" id="4161028">(</span><span class="op" id="4161029">)</span><span class="op" id="4161030">)</span>&nbsp;<span class="op" id="4161032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161036">return</span>&nbsp;<span class="ident" id="4161043">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161072">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161075">return</span>&nbsp;<span class="ident" id="4161082">nil</span><br>
<span class="lineno"></span><span class="op" id="4161086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4161089">func</span>&nbsp;<span class="ident" id="4161094">setReadBuffer</span><span class="op" id="4161107">(</span><span class="ident" id="4161108">fd</span>&nbsp;<span class="op" id="4161111">*</span><span class="ident" id="4161112">netFD</span><span class="op" id="4161117">,</span>&nbsp;<span class="ident" id="4161119">bytes</span>&nbsp;<span class="builtintype" id="4161125">int</span><span class="op" id="4161128">)</span>&nbsp;<span class="builtintype" id="4161130">error</span>&nbsp;<span class="op" id="4161136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161139">if</span>&nbsp;<span class="ident" id="4161142">err</span>&nbsp;<span class="op" id="4161146">:=</span>&nbsp;<span class="ident" id="4161149">fd</span><span class="op" id="4161151">.</span><span class="ident" id="4161152">incref</span><span class="op" id="4161158">(</span><span class="op" id="4161159">)</span><span class="op" id="4161160">;</span>&nbsp;<span class="ident" id="4161162">err</span>&nbsp;<span class="op" id="4161166">!=</span>&nbsp;<span class="ident" id="4161169">nil</span>&nbsp;<span class="op" id="4161173">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161177">return</span>&nbsp;<span class="ident" id="4161184">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161192">defer</span>&nbsp;<span class="ident" id="4161198">fd</span><span class="op" id="4161200">.</span><span class="ident" id="4161201">decref</span><span class="op" id="4161207">(</span><span class="op" id="4161208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161211">return</span>&nbsp;<span class="ident" id="4161218">os</span><span class="op" id="4161220">.</span><span class="ident" id="4161221">NewSyscallError</span><span class="op" id="4161236">(</span><span class="string" id="4161237">&#34;setsockopt&#34;</span><span class="op" id="4161249">,</span>&nbsp;<span class="ident" id="4161251">syscall</span><span class="op" id="4161258">.</span><span class="ident" id="4161259">SetsockoptInt</span><span class="op" id="4161272">(</span><span class="ident" id="4161273">fd</span><span class="op" id="4161275">.</span><span class="ident" id="4161276">sysfd</span><span class="op" id="4161281">,</span>&nbsp;<span class="ident" id="4161283">syscall</span><span class="op" id="4161290">.</span><span class="ident" id="4161291">SOL_SOCKET</span><span class="op" id="4161301">,</span>&nbsp;<span class="ident" id="4161303">syscall</span><span class="op" id="4161310">.</span><span class="ident" id="4161311">SO_RCVBUF</span><span class="op" id="4161320">,</span>&nbsp;<span class="ident" id="4161322">bytes</span><span class="op" id="4161327">)</span><span class="op" id="4161328">)</span><br>
<span class="lineno"></span><span class="op" id="4161330">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="4161333">func</span>&nbsp;<span class="ident" id="4161338">setWriteBuffer</span><span class="op" id="4161352">(</span><span class="ident" id="4161353">fd</span>&nbsp;<span class="op" id="4161356">*</span><span class="ident" id="4161357">netFD</span><span class="op" id="4161362">,</span>&nbsp;<span class="ident" id="4161364">bytes</span>&nbsp;<span class="builtintype" id="4161370">int</span><span class="op" id="4161373">)</span>&nbsp;<span class="builtintype" id="4161375">error</span>&nbsp;<span class="op" id="4161381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161384">if</span>&nbsp;<span class="ident" id="4161387">err</span>&nbsp;<span class="op" id="4161391">:=</span>&nbsp;<span class="ident" id="4161394">fd</span><span class="op" id="4161396">.</span><span class="ident" id="4161397">incref</span><span class="op" id="4161403">(</span><span class="op" id="4161404">)</span><span class="op" id="4161405">;</span>&nbsp;<span class="ident" id="4161407">err</span>&nbsp;<span class="op" id="4161411">!=</span>&nbsp;<span class="ident" id="4161414">nil</span>&nbsp;<span class="op" id="4161418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161422">return</span>&nbsp;<span class="ident" id="4161429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161434">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161437">defer</span>&nbsp;<span class="ident" id="4161443">fd</span><span class="op" id="4161445">.</span><span class="ident" id="4161446">decref</span><span class="op" id="4161452">(</span><span class="op" id="4161453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161456">return</span>&nbsp;<span class="ident" id="4161463">os</span><span class="op" id="4161465">.</span><span class="ident" id="4161466">NewSyscallError</span><span class="op" id="4161481">(</span><span class="string" id="4161482">&#34;setsockopt&#34;</span><span class="op" id="4161494">,</span>&nbsp;<span class="ident" id="4161496">syscall</span><span class="op" id="4161503">.</span><span class="ident" id="4161504">SetsockoptInt</span><span class="op" id="4161517">(</span><span class="ident" id="4161518">fd</span><span class="op" id="4161520">.</span><span class="ident" id="4161521">sysfd</span><span class="op" id="4161526">,</span>&nbsp;<span class="ident" id="4161528">syscall</span><span class="op" id="4161535">.</span><span class="ident" id="4161536">SOL_SOCKET</span><span class="op" id="4161546">,</span>&nbsp;<span class="ident" id="4161548">syscall</span><span class="op" id="4161555">.</span><span class="ident" id="4161556">SO_SNDBUF</span><span class="op" id="4161565">,</span>&nbsp;<span class="ident" id="4161567">bytes</span><span class="op" id="4161572">)</span><span class="op" id="4161573">)</span><br>
<span class="lineno"></span><span class="op" id="4161575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4161578">func</span>&nbsp;<span class="ident" id="4161583">setKeepAlive</span><span class="op" id="4161595">(</span><span class="ident" id="4161596">fd</span>&nbsp;<span class="op" id="4161599">*</span><span class="ident" id="4161600">netFD</span><span class="op" id="4161605">,</span>&nbsp;<span class="ident" id="4161607">keepalive</span>&nbsp;<span class="builtintype" id="4161617">bool</span><span class="op" id="4161621">)</span>&nbsp;<span class="builtintype" id="4161623">error</span>&nbsp;<span class="op" id="4161629">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161632">if</span>&nbsp;<span class="ident" id="4161635">err</span>&nbsp;<span class="op" id="4161639">:=</span>&nbsp;<span class="ident" id="4161642">fd</span><span class="op" id="4161644">.</span><span class="ident" id="4161645">incref</span><span class="op" id="4161651">(</span><span class="op" id="4161652">)</span><span class="op" id="4161653">;</span>&nbsp;<span class="ident" id="4161655">err</span>&nbsp;<span class="op" id="4161659">!=</span>&nbsp;<span class="ident" id="4161662">nil</span>&nbsp;<span class="op" id="4161666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161670">return</span>&nbsp;<span class="ident" id="4161677">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161685">defer</span>&nbsp;<span class="ident" id="4161691">fd</span><span class="op" id="4161693">.</span><span class="ident" id="4161694">decref</span><span class="op" id="4161700">(</span><span class="op" id="4161701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161704">return</span>&nbsp;<span class="ident" id="4161711">os</span><span class="op" id="4161713">.</span><span class="ident" id="4161714">NewSyscallError</span><span class="op" id="4161729">(</span><span class="string" id="4161730">&#34;setsockopt&#34;</span><span class="op" id="4161742">,</span>&nbsp;<span class="ident" id="4161744">syscall</span><span class="op" id="4161751">.</span><span class="ident" id="4161752">SetsockoptInt</span><span class="op" id="4161765">(</span><span class="ident" id="4161766">fd</span><span class="op" id="4161768">.</span><span class="ident" id="4161769">sysfd</span><span class="op" id="4161774">,</span>&nbsp;<span class="ident" id="4161776">syscall</span><span class="op" id="4161783">.</span><span class="ident" id="4161784">SOL_SOCKET</span><span class="op" id="4161794">,</span>&nbsp;<span class="ident" id="4161796">syscall</span><span class="op" id="4161803">.</span><span class="ident" id="4161804">SO_KEEPALIVE</span><span class="op" id="4161816">,</span>&nbsp;<span class="ident" id="4161818">boolint</span><span class="op" id="4161825">(</span><span class="ident" id="4161826">keepalive</span><span class="op" id="4161835">)</span><span class="op" id="4161836">)</span><span class="op" id="4161837">)</span><br>
<span class="lineno">125</span><span class="op" id="4161839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4161842">func</span>&nbsp;<span class="ident" id="4161847">setLinger</span><span class="op" id="4161856">(</span><span class="ident" id="4161857">fd</span>&nbsp;<span class="op" id="4161860">*</span><span class="ident" id="4161861">netFD</span><span class="op" id="4161866">,</span>&nbsp;<span class="ident" id="4161868">sec</span>&nbsp;<span class="builtintype" id="4161872">int</span><span class="op" id="4161875">)</span>&nbsp;<span class="builtintype" id="4161877">error</span>&nbsp;<span class="op" id="4161883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161886">var</span>&nbsp;<span class="ident" id="4161890">l</span>&nbsp;<span class="ident" id="4161892">syscall</span><span class="op" id="4161899">.</span><span class="ident" id="4161900">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161908">if</span>&nbsp;<span class="ident" id="4161911">sec</span>&nbsp;<span class="op" id="4161915">&gt;=</span>&nbsp;<span class="num" id="4161918">0</span>&nbsp;<span class="op" id="4161920">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161924">l</span><span class="op" id="4161925">.</span><span class="ident" id="4161926">Onoff</span>&nbsp;<span class="op" id="4161932">=</span>&nbsp;<span class="num" id="4161934">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161938">l</span><span class="op" id="4161939">.</span><span class="ident" id="4161940">Linger</span>&nbsp;<span class="op" id="4161947">=</span>&nbsp;<span class="builtintype" id="4161949">int32</span><span class="op" id="4161954">(</span><span class="ident" id="4161955">sec</span><span class="op" id="4161958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161961">}</span>&nbsp;<span class="keyword" id="4161963">else</span>&nbsp;<span class="op" id="4161968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161972">l</span><span class="op" id="4161973">.</span><span class="ident" id="4161974">Onoff</span>&nbsp;<span class="op" id="4161980">=</span>&nbsp;<span class="num" id="4161982">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161986">l</span><span class="op" id="4161987">.</span><span class="ident" id="4161988">Linger</span>&nbsp;<span class="op" id="4161995">=</span>&nbsp;<span class="num" id="4161997">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162003">if</span>&nbsp;<span class="ident" id="4162006">err</span>&nbsp;<span class="op" id="4162010">:=</span>&nbsp;<span class="ident" id="4162013">fd</span><span class="op" id="4162015">.</span><span class="ident" id="4162016">incref</span><span class="op" id="4162022">(</span><span class="op" id="4162023">)</span><span class="op" id="4162024">;</span>&nbsp;<span class="ident" id="4162026">err</span>&nbsp;<span class="op" id="4162030">!=</span>&nbsp;<span class="ident" id="4162033">nil</span>&nbsp;<span class="op" id="4162037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162041">return</span>&nbsp;<span class="ident" id="4162048">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162056">defer</span>&nbsp;<span class="ident" id="4162062">fd</span><span class="op" id="4162064">.</span><span class="ident" id="4162065">decref</span><span class="op" id="4162071">(</span><span class="op" id="4162072">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162075">return</span>&nbsp;<span class="ident" id="4162082">os</span><span class="op" id="4162084">.</span><span class="ident" id="4162085">NewSyscallError</span><span class="op" id="4162100">(</span><span class="string" id="4162101">&#34;setsockopt&#34;</span><span class="op" id="4162113">,</span>&nbsp;<span class="ident" id="4162115">syscall</span><span class="op" id="4162122">.</span><span class="ident" id="4162123">SetsockoptLinger</span><span class="op" id="4162139">(</span><span class="ident" id="4162140">fd</span><span class="op" id="4162142">.</span><span class="ident" id="4162143">sysfd</span><span class="op" id="4162148">,</span>&nbsp;<span class="ident" id="4162150">syscall</span><span class="op" id="4162157">.</span><span class="ident" id="4162158">SOL_SOCKET</span><span class="op" id="4162168">,</span>&nbsp;<span class="ident" id="4162170">syscall</span><span class="op" id="4162177">.</span><span class="ident" id="4162178">SO_LINGER</span><span class="op" id="4162187">,</span>&nbsp;<span class="op" id="4162189">&amp;</span><span class="ident" id="4162190">l</span><span class="op" id="4162191">)</span><span class="op" id="4162192">)</span><br>
<span class="lineno"></span><span class="op" id="4162194">}</span>
</div>
</body>
</html>
