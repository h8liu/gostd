<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2797975">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2798030">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2798084">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2798135">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="2798208">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="2798242">//</span><br>
<span class="lineno"></span><span class="comment" id="2798245">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2798314">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="2798366">package</span>&nbsp;<span class="ident" id="2798374">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2798380">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="2798460">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="2798536">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="2798612">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="2798691">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="2798766">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="2798838">//</span><br>
<span class="lineno"></span><span class="comment" id="2798841">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="2798912">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2798941">import</span>&nbsp;<span class="op" id="2798948">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2798951">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2798958">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2798970">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2798981">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2798992">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2798999">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2799002">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="2799078">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="2799118">type</span>&nbsp;<span class="ident" id="2799123">StructuralError</span>&nbsp;<span class="keyword" id="2799139">struct</span>&nbsp;<span class="op" id="2799146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799149">Msg</span>&nbsp;<span class="builtintype" id="2799153">string</span><br>
<span class="lineno"></span><span class="op" id="2799160">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="2799163">func</span>&nbsp;<span class="op" id="2799168">(</span><span class="ident" id="2799169">e</span>&nbsp;<span class="ident" id="2799171"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2799186">)</span>&nbsp;<span class="ident" id="2799188">Error</span><span class="op" id="2799193">(</span><span class="op" id="2799194">)</span>&nbsp;<span class="builtintype" id="2799196">string</span>&nbsp;<span class="op" id="2799203">{</span>&nbsp;<span class="keyword" id="2799205">return</span>&nbsp;<span class="string" id="2799212">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="2799238">+</span>&nbsp;<span class="ident" id="2799240"><a href="/encoding/asn1/asn1.go.html#2799169">e</a></span><span class="op" id="2799241">.</span><span class="ident" id="2799242">Msg</span>&nbsp;<span class="op" id="2799246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799249">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2799307">type</span>&nbsp;<span class="ident" id="2799312">SyntaxError</span>&nbsp;<span class="keyword" id="2799324">struct</span>&nbsp;<span class="op" id="2799331">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799334">Msg</span>&nbsp;<span class="builtintype" id="2799338">string</span><br>
<span class="lineno"></span><span class="op" id="2799345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2799348">func</span>&nbsp;<span class="op" id="2799353">(</span><span class="ident" id="2799354">e</span>&nbsp;<span class="ident" id="2799356"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2799367">)</span>&nbsp;<span class="ident" id="2799369">Error</span><span class="op" id="2799374">(</span><span class="op" id="2799375">)</span>&nbsp;<span class="builtintype" id="2799377">string</span>&nbsp;<span class="op" id="2799384">{</span>&nbsp;<span class="keyword" id="2799386">return</span>&nbsp;<span class="string" id="2799393">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="2799416">+</span>&nbsp;<span class="ident" id="2799418"><a href="/encoding/asn1/asn1.go.html#2799354">e</a></span><span class="op" id="2799419">.</span><span class="ident" id="2799420">Msg</span>&nbsp;<span class="op" id="2799424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2799427">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799493">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2799505">func</span>&nbsp;<span class="ident" id="2799510">parseBool</span><span class="op" id="2799519">(</span><span class="ident" id="2799520">bytes</span>&nbsp;<span class="op" id="2799526">[</span><span class="op" id="2799527">]</span><span class="builtintype" id="2799528">byte</span><span class="op" id="2799532">)</span>&nbsp;<span class="op" id="2799534">(</span><span class="ident" id="2799535">ret</span>&nbsp;<span class="builtintype" id="2799539">bool</span><span class="op" id="2799543">,</span>&nbsp;<span class="ident" id="2799545">err</span>&nbsp;<span class="builtintype" id="2799549">error</span><span class="op" id="2799554">)</span>&nbsp;<span class="op" id="2799556">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799559">if</span>&nbsp;<span class="builtinfunc" id="2799562">len</span><span class="op" id="2799565">(</span><span class="ident" id="2799566"><a href="/encoding/asn1/asn1.go.html#2799520">bytes</a></span><span class="op" id="2799571">)</span>&nbsp;<span class="op" id="2799573">!=</span>&nbsp;<span class="num" id="2799576">1</span>&nbsp;<span class="op" id="2799578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799582"><a href="/encoding/asn1/asn1.go.html#2799545">err</a></span>&nbsp;<span class="op" id="2799586">=</span>&nbsp;<span class="ident" id="2799588"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2799599">{</span><span class="string" id="2799600">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="2799617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799633">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799706">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799775">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799825">switch</span>&nbsp;<span class="ident" id="2799832"><a href="/encoding/asn1/asn1.go.html#2799520">bytes</a></span><span class="op" id="2799837">[</span><span class="num" id="2799838">0</span><span class="op" id="2799839">]</span>&nbsp;<span class="op" id="2799841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799844">case</span>&nbsp;<span class="num" id="2799849">0</span><span class="op" id="2799850">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799854"><a href="/encoding/asn1/asn1.go.html#2799535">ret</a></span>&nbsp;<span class="op" id="2799858">=</span>&nbsp;<span class="ident" id="2799860">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799867">case</span>&nbsp;<span class="num" id="2799872">0xff</span><span class="op" id="2799876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799880"><a href="/encoding/asn1/asn1.go.html#2799535">ret</a></span>&nbsp;<span class="op" id="2799884">=</span>&nbsp;<span class="ident" id="2799886">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799892">default</span><span class="op" id="2799899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799903"><a href="/encoding/asn1/asn1.go.html#2799545">err</a></span>&nbsp;<span class="op" id="2799907">=</span>&nbsp;<span class="ident" id="2799909"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2799920">{</span><span class="string" id="2799921">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="2799938">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799945">return</span><br>
<span class="lineno"></span><span class="op" id="2799952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="2799955">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799967">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2800040">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="2800063">func</span>&nbsp;<span class="ident" id="2800068">parseInt64</span><span class="op" id="2800078">(</span><span class="ident" id="2800079">bytes</span>&nbsp;<span class="op" id="2800085">[</span><span class="op" id="2800086">]</span><span class="builtintype" id="2800087">byte</span><span class="op" id="2800091">)</span>&nbsp;<span class="op" id="2800093">(</span><span class="ident" id="2800094">ret</span>&nbsp;<span class="ident" id="2800098">int64</span><span class="op" id="2800103">,</span>&nbsp;<span class="ident" id="2800105">err</span>&nbsp;<span class="builtintype" id="2800109">error</span><span class="op" id="2800114">)</span>&nbsp;<span class="op" id="2800116">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800119">if</span>&nbsp;<span class="builtinfunc" id="2800122">len</span><span class="op" id="2800125">(</span><span class="ident" id="2800126"><a href="/encoding/asn1/asn1.go.html#2800079">bytes</a></span><span class="op" id="2800131">)</span>&nbsp;<span class="op" id="2800133">&gt;</span>&nbsp;<span class="num" id="2800135">8</span>&nbsp;<span class="op" id="2800137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800141">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800184"><a href="/encoding/asn1/asn1.go.html#2800105">err</a></span>&nbsp;<span class="op" id="2800188">=</span>&nbsp;<span class="ident" id="2800190"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2800205">{</span><span class="string" id="2800206">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="2800225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800229">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800237">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800240">for</span>&nbsp;<span class="ident" id="2800244">bytesRead</span>&nbsp;<span class="op" id="2800254">:=</span>&nbsp;<span class="num" id="2800257">0</span><span class="op" id="2800258">;</span>&nbsp;<span class="ident" id="2800260"><a href="/encoding/asn1/asn1.go.html#2800244">bytesRead</a></span>&nbsp;<span class="op" id="2800270">&lt;</span>&nbsp;<span class="builtinfunc" id="2800272">len</span><span class="op" id="2800275">(</span><span class="ident" id="2800276"><a href="/encoding/asn1/asn1.go.html#2800079">bytes</a></span><span class="op" id="2800281">)</span><span class="op" id="2800282">;</span>&nbsp;<span class="ident" id="2800284"><a href="/encoding/asn1/asn1.go.html#2800244">bytesRead</a></span><span class="op" id="2800293">++</span>&nbsp;<span class="op" id="2800296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800300"><a href="/encoding/asn1/asn1.go.html#2800094">ret</a></span>&nbsp;<span class="op" id="2800304">&lt;&lt;=</span>&nbsp;<span class="num" id="2800308">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800312"><a href="/encoding/asn1/asn1.go.html#2800094">ret</a></span>&nbsp;<span class="op" id="2800316">|=</span>&nbsp;<span class="ident" id="2800319">int64</span><span class="op" id="2800324">(</span><span class="ident" id="2800325"><a href="/encoding/asn1/asn1.go.html#2800079">bytes</a></span><span class="op" id="2800330">[</span><span class="ident" id="2800331"><a href="/encoding/asn1/asn1.go.html#2800244">bytesRead</a></span><span class="op" id="2800340">]</span><span class="op" id="2800341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800348">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800406"><a href="/encoding/asn1/asn1.go.html#2800094">ret</a></span>&nbsp;<span class="op" id="2800410">&lt;&lt;=</span>&nbsp;<span class="num" id="2800414">64</span>&nbsp;<span class="op" id="2800417">-</span>&nbsp;<span class="builtintype" id="2800419">uint8</span><span class="op" id="2800424">(</span><span class="builtinfunc" id="2800425">len</span><span class="op" id="2800428">(</span><span class="ident" id="2800429"><a href="/encoding/asn1/asn1.go.html#2800079">bytes</a></span><span class="op" id="2800434">)</span><span class="op" id="2800435">)</span><span class="op" id="2800436">*</span><span class="num" id="2800437">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800440"><a href="/encoding/asn1/asn1.go.html#2800094">ret</a></span>&nbsp;<span class="op" id="2800444">&gt;&gt;=</span>&nbsp;<span class="num" id="2800448">64</span>&nbsp;<span class="op" id="2800451">-</span>&nbsp;<span class="builtintype" id="2800453">uint8</span><span class="op" id="2800458">(</span><span class="builtinfunc" id="2800459">len</span><span class="op" id="2800462">(</span><span class="ident" id="2800463"><a href="/encoding/asn1/asn1.go.html#2800079">bytes</a></span><span class="op" id="2800468">)</span><span class="op" id="2800469">)</span><span class="op" id="2800470">*</span><span class="num" id="2800471">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800474">return</span><br>
<span class="lineno"></span><span class="op" id="2800481">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="2800484">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2800563">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="2800578">func</span>&nbsp;<span class="ident" id="2800583">parseInt32</span><span class="op" id="2800593">(</span><span class="ident" id="2800594">bytes</span>&nbsp;<span class="op" id="2800600">[</span><span class="op" id="2800601">]</span><span class="builtintype" id="2800602">byte</span><span class="op" id="2800606">)</span>&nbsp;<span class="op" id="2800608">(</span><span class="builtintype" id="2800609">int32</span><span class="op" id="2800614">,</span>&nbsp;<span class="builtintype" id="2800616">error</span><span class="op" id="2800621">)</span>&nbsp;<span class="op" id="2800623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800626">ret64</span><span class="op" id="2800631">,</span>&nbsp;<span class="ident" id="2800633">err</span>&nbsp;<span class="op" id="2800637">:=</span>&nbsp;<span class="ident" id="2800640"><a href="/encoding/asn1/asn1.go.html#2800068">parseInt64</a></span><span class="op" id="2800650">(</span><span class="ident" id="2800651"><a href="/encoding/asn1/asn1.go.html#2800594">bytes</a></span><span class="op" id="2800656">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800659">if</span>&nbsp;<span class="ident" id="2800662"><a href="/encoding/asn1/asn1.go.html#2800633">err</a></span>&nbsp;<span class="op" id="2800666">!=</span>&nbsp;<span class="ident" id="2800669">nil</span>&nbsp;<span class="op" id="2800673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800677">return</span>&nbsp;<span class="num" id="2800684">0</span><span class="op" id="2800685">,</span>&nbsp;<span class="ident" id="2800687"><a href="/encoding/asn1/asn1.go.html#2800633">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800695">if</span>&nbsp;<span class="ident" id="2800698"><a href="/encoding/asn1/asn1.go.html#2800626">ret64</a></span>&nbsp;<span class="op" id="2800704">!=</span>&nbsp;<span class="ident" id="2800707">int64</span><span class="op" id="2800712">(</span><span class="builtintype" id="2800713">int32</span><span class="op" id="2800718">(</span><span class="ident" id="2800719"><a href="/encoding/asn1/asn1.go.html#2800626">ret64</a></span><span class="op" id="2800724">)</span><span class="op" id="2800725">)</span>&nbsp;<span class="op" id="2800727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800731">return</span>&nbsp;<span class="num" id="2800738">0</span><span class="op" id="2800739">,</span>&nbsp;<span class="ident" id="2800741"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2800756">{</span><span class="string" id="2800757">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="2800776">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800782">return</span>&nbsp;<span class="builtintype" id="2800789">int32</span><span class="op" id="2800794">(</span><span class="ident" id="2800795"><a href="/encoding/asn1/asn1.go.html#2800626">ret64</a></span><span class="op" id="2800800">)</span><span class="op" id="2800801">,</span>&nbsp;<span class="ident" id="2800803">nil</span><br>
<span class="lineno"></span><span class="op" id="2800807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2800810">var</span>&nbsp;<span class="ident" id="2800814">bigOne</span>&nbsp;<span class="op" id="2800821">=</span>&nbsp;<span class="ident" id="2800823"><a href="/encoding/asn1/asn1.go.html#2798958">big</a></span><span class="op" id="2800826">.</span><span class="ident" id="2800827">NewInt</span><span class="op" id="2800833">(</span><span class="num" id="2800834">1</span><span class="op" id="2800835">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2800838">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2800920">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="2800935">func</span>&nbsp;<span class="ident" id="2800940">parseBigInt</span><span class="op" id="2800951">(</span><span class="ident" id="2800952">bytes</span>&nbsp;<span class="op" id="2800958">[</span><span class="op" id="2800959">]</span><span class="builtintype" id="2800960">byte</span><span class="op" id="2800964">)</span>&nbsp;<span class="op" id="2800966">*</span><span class="ident" id="2800967"><a href="/encoding/asn1/asn1.go.html#2798958">big</a></span><span class="op" id="2800970">.</span><span class="ident" id="2800971">Int</span>&nbsp;<span class="op" id="2800975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800978">ret</span>&nbsp;<span class="op" id="2800982">:=</span>&nbsp;<span class="builtinfunc" id="2800985">new</span><span class="op" id="2800988">(</span><span class="ident" id="2800989"><a href="/encoding/asn1/asn1.go.html#2798958">big</a></span><span class="op" id="2800992">.</span><span class="ident" id="2800993">Int</span><span class="op" id="2800996">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800999">if</span>&nbsp;<span class="builtinfunc" id="2801002">len</span><span class="op" id="2801005">(</span><span class="ident" id="2801006"><a href="/encoding/asn1/asn1.go.html#2800952">bytes</a></span><span class="op" id="2801011">)</span>&nbsp;<span class="op" id="2801013">&gt;</span>&nbsp;<span class="num" id="2801015">0</span>&nbsp;<span class="op" id="2801017">&amp;&amp;</span>&nbsp;<span class="ident" id="2801020"><a href="/encoding/asn1/asn1.go.html#2800952">bytes</a></span><span class="op" id="2801025">[</span><span class="num" id="2801026">0</span><span class="op" id="2801027">]</span><span class="op" id="2801028">&amp;</span><span class="num" id="2801029">0x80</span>&nbsp;<span class="op" id="2801034">==</span>&nbsp;<span class="num" id="2801037">0x80</span>&nbsp;<span class="op" id="2801042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801046">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801078">notBytes</span>&nbsp;<span class="op" id="2801087">:=</span>&nbsp;<span class="builtinfunc" id="2801090">make</span><span class="op" id="2801094">(</span><span class="op" id="2801095">[</span><span class="op" id="2801096">]</span><span class="builtintype" id="2801097">byte</span><span class="op" id="2801101">,</span>&nbsp;<span class="builtinfunc" id="2801103">len</span><span class="op" id="2801106">(</span><span class="ident" id="2801107"><a href="/encoding/asn1/asn1.go.html#2800952">bytes</a></span><span class="op" id="2801112">)</span><span class="op" id="2801113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801117">for</span>&nbsp;<span class="ident" id="2801121">i</span>&nbsp;<span class="op" id="2801123">:=</span>&nbsp;<span class="keyword" id="2801126">range</span>&nbsp;<span class="ident" id="2801132"><a href="/encoding/asn1/asn1.go.html#2801078">notBytes</a></span>&nbsp;<span class="op" id="2801141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801146"><a href="/encoding/asn1/asn1.go.html#2801078">notBytes</a></span><span class="op" id="2801154">[</span><span class="ident" id="2801155"><a href="/encoding/asn1/asn1.go.html#2801121">i</a></span><span class="op" id="2801156">]</span>&nbsp;<span class="op" id="2801158">=</span>&nbsp;<span class="op" id="2801160">^</span><span class="ident" id="2801161"><a href="/encoding/asn1/asn1.go.html#2800952">bytes</a></span><span class="op" id="2801166">[</span><span class="ident" id="2801167"><a href="/encoding/asn1/asn1.go.html#2801121">i</a></span><span class="op" id="2801168">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801176"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801179">.</span><span class="ident" id="2801180">SetBytes</span><span class="op" id="2801188">(</span><span class="ident" id="2801189"><a href="/encoding/asn1/asn1.go.html#2801078">notBytes</a></span><span class="op" id="2801197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801201"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801204">.</span><span class="ident" id="2801205">Add</span><span class="op" id="2801208">(</span><span class="ident" id="2801209"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801212">,</span>&nbsp;<span class="ident" id="2801214"><a href="/encoding/asn1/asn1.go.html#2800814">bigOne</a></span><span class="op" id="2801220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801224"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801227">.</span><span class="ident" id="2801228">Neg</span><span class="op" id="2801231">(</span><span class="ident" id="2801232"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801239">return</span>&nbsp;<span class="ident" id="2801246"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801254"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><span class="op" id="2801257">.</span><span class="ident" id="2801258">SetBytes</span><span class="op" id="2801266">(</span><span class="ident" id="2801267"><a href="/encoding/asn1/asn1.go.html#2800952">bytes</a></span><span class="op" id="2801272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801275">return</span>&nbsp;<span class="ident" id="2801282"><a href="/encoding/asn1/asn1.go.html#2800978">ret</a></span><br>
<span class="lineno"></span><span class="op" id="2801286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2801289">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2801304">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="2801383">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2801458">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="2801512">type</span>&nbsp;<span class="ident" id="2801517">BitString</span>&nbsp;<span class="keyword" id="2801527">struct</span>&nbsp;<span class="op" id="2801534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801537">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801547">[</span><span class="op" id="2801548">]</span><span class="builtintype" id="2801549">byte</span>&nbsp;<span class="comment" id="2801554">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801582">BitLength</span>&nbsp;<span class="builtintype" id="2801592">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801599">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="2801618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2801621">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2801695">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="2801713">func</span>&nbsp;<span class="op" id="2801718">(</span><span class="ident" id="2801719">b</span>&nbsp;<span class="ident" id="2801721"><a href="/encoding/asn1/asn1.go.html#2801517">BitString</a></span><span class="op" id="2801730">)</span>&nbsp;<span class="ident" id="2801732">At</span><span class="op" id="2801734">(</span><span class="ident" id="2801735">i</span>&nbsp;<span class="builtintype" id="2801737">int</span><span class="op" id="2801740">)</span>&nbsp;<span class="builtintype" id="2801742">int</span>&nbsp;<span class="op" id="2801746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801749">if</span>&nbsp;<span class="ident" id="2801752"><a href="/encoding/asn1/asn1.go.html#2801735">i</a></span>&nbsp;<span class="op" id="2801754">&lt;</span>&nbsp;<span class="num" id="2801756">0</span>&nbsp;<span class="op" id="2801758">||</span>&nbsp;<span class="ident" id="2801761"><a href="/encoding/asn1/asn1.go.html#2801735">i</a></span>&nbsp;<span class="op" id="2801763">&gt;=</span>&nbsp;<span class="ident" id="2801766"><a href="/encoding/asn1/asn1.go.html#2801719">b</a></span><span class="op" id="2801767">.</span><span class="ident" id="2801768">BitLength</span>&nbsp;<span class="op" id="2801778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801782">return</span>&nbsp;<span class="num" id="2801789">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801795">x</span>&nbsp;<span class="op" id="2801797">:=</span>&nbsp;<span class="ident" id="2801800"><a href="/encoding/asn1/asn1.go.html#2801735">i</a></span>&nbsp;<span class="op" id="2801802">/</span>&nbsp;<span class="num" id="2801804">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801807">y</span>&nbsp;<span class="op" id="2801809">:=</span>&nbsp;<span class="num" id="2801812">7</span>&nbsp;<span class="op" id="2801814">-</span>&nbsp;<span class="builtintype" id="2801816">uint</span><span class="op" id="2801820">(</span><span class="ident" id="2801821"><a href="/encoding/asn1/asn1.go.html#2801735">i</a></span><span class="op" id="2801822">%</span><span class="num" id="2801823">8</span><span class="op" id="2801824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801827">return</span>&nbsp;<span class="builtintype" id="2801834">int</span><span class="op" id="2801837">(</span><span class="ident" id="2801838"><a href="/encoding/asn1/asn1.go.html#2801719">b</a></span><span class="op" id="2801839">.</span><span class="ident" id="2801840">Bytes</span><span class="op" id="2801845">[</span><span class="ident" id="2801846"><a href="/encoding/asn1/asn1.go.html#2801795">x</a></span><span class="op" id="2801847">]</span><span class="op" id="2801848">&gt;&gt;</span><span class="ident" id="2801850"><a href="/encoding/asn1/asn1.go.html#2801807">y</a></span><span class="op" id="2801851">)</span>&nbsp;<span class="op" id="2801853">&amp;</span>&nbsp;<span class="num" id="2801855">1</span><br>
<span class="lineno"></span><span class="op" id="2801857">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="2801860">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2801939">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="2801985">func</span>&nbsp;<span class="op" id="2801990">(</span><span class="ident" id="2801991">b</span>&nbsp;<span class="ident" id="2801993"><a href="/encoding/asn1/asn1.go.html#2801517">BitString</a></span><span class="op" id="2802002">)</span>&nbsp;<span class="ident" id="2802004">RightAlign</span><span class="op" id="2802014">(</span><span class="op" id="2802015">)</span>&nbsp;<span class="op" id="2802017">[</span><span class="op" id="2802018">]</span><span class="builtintype" id="2802019">byte</span>&nbsp;<span class="op" id="2802024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802027">shift</span>&nbsp;<span class="op" id="2802033">:=</span>&nbsp;<span class="builtintype" id="2802036">uint</span><span class="op" id="2802040">(</span><span class="num" id="2802041">8</span>&nbsp;<span class="op" id="2802043">-</span>&nbsp;<span class="op" id="2802045">(</span><span class="ident" id="2802046"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802047">.</span><span class="ident" id="2802048">BitLength</span>&nbsp;<span class="op" id="2802058">%</span>&nbsp;<span class="num" id="2802060">8</span><span class="op" id="2802061">)</span><span class="op" id="2802062">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802065">if</span>&nbsp;<span class="ident" id="2802068"><a href="/encoding/asn1/asn1.go.html#2802027">shift</a></span>&nbsp;<span class="op" id="2802074">==</span>&nbsp;<span class="num" id="2802077">8</span>&nbsp;<span class="op" id="2802079">||</span>&nbsp;<span class="builtinfunc" id="2802082">len</span><span class="op" id="2802085">(</span><span class="ident" id="2802086"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802087">.</span><span class="ident" id="2802088">Bytes</span><span class="op" id="2802093">)</span>&nbsp;<span class="op" id="2802095">==</span>&nbsp;<span class="num" id="2802098">0</span>&nbsp;<span class="op" id="2802100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802104">return</span>&nbsp;<span class="ident" id="2802111"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802112">.</span><span class="ident" id="2802113">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2802120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802124">a</span>&nbsp;<span class="op" id="2802126">:=</span>&nbsp;<span class="builtinfunc" id="2802129">make</span><span class="op" id="2802133">(</span><span class="op" id="2802134">[</span><span class="op" id="2802135">]</span><span class="builtintype" id="2802136">byte</span><span class="op" id="2802140">,</span>&nbsp;<span class="builtinfunc" id="2802142">len</span><span class="op" id="2802145">(</span><span class="ident" id="2802146"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802147">.</span><span class="ident" id="2802148">Bytes</span><span class="op" id="2802153">)</span><span class="op" id="2802154">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802157"><a href="/encoding/asn1/asn1.go.html#2802124">a</a></span><span class="op" id="2802158">[</span><span class="num" id="2802159">0</span><span class="op" id="2802160">]</span>&nbsp;<span class="op" id="2802162">=</span>&nbsp;<span class="ident" id="2802164"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802165">.</span><span class="ident" id="2802166">Bytes</span><span class="op" id="2802171">[</span><span class="num" id="2802172">0</span><span class="op" id="2802173">]</span>&nbsp;<span class="op" id="2802175">&gt;&gt;</span>&nbsp;<span class="ident" id="2802178"><a href="/encoding/asn1/asn1.go.html#2802027">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802185">for</span>&nbsp;<span class="ident" id="2802189">i</span>&nbsp;<span class="op" id="2802191">:=</span>&nbsp;<span class="num" id="2802194">1</span><span class="op" id="2802195">;</span>&nbsp;<span class="ident" id="2802197"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span>&nbsp;<span class="op" id="2802199">&lt;</span>&nbsp;<span class="builtinfunc" id="2802201">len</span><span class="op" id="2802204">(</span><span class="ident" id="2802205"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802206">.</span><span class="ident" id="2802207">Bytes</span><span class="op" id="2802212">)</span><span class="op" id="2802213">;</span>&nbsp;<span class="ident" id="2802215"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span><span class="op" id="2802216">++</span>&nbsp;<span class="op" id="2802219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802223"><a href="/encoding/asn1/asn1.go.html#2802124">a</a></span><span class="op" id="2802224">[</span><span class="ident" id="2802225"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span><span class="op" id="2802226">]</span>&nbsp;<span class="op" id="2802228">=</span>&nbsp;<span class="ident" id="2802230"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802231">.</span><span class="ident" id="2802232">Bytes</span><span class="op" id="2802237">[</span><span class="ident" id="2802238"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span><span class="op" id="2802239">-</span><span class="num" id="2802240">1</span><span class="op" id="2802241">]</span>&nbsp;<span class="op" id="2802243">&lt;&lt;</span>&nbsp;<span class="op" id="2802246">(</span><span class="num" id="2802247">8</span>&nbsp;<span class="op" id="2802249">-</span>&nbsp;<span class="ident" id="2802251"><a href="/encoding/asn1/asn1.go.html#2802027">shift</a></span><span class="op" id="2802256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802260"><a href="/encoding/asn1/asn1.go.html#2802124">a</a></span><span class="op" id="2802261">[</span><span class="ident" id="2802262"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span><span class="op" id="2802263">]</span>&nbsp;<span class="op" id="2802265">|=</span>&nbsp;<span class="ident" id="2802268"><a href="/encoding/asn1/asn1.go.html#2801991">b</a></span><span class="op" id="2802269">.</span><span class="ident" id="2802270">Bytes</span><span class="op" id="2802275">[</span><span class="ident" id="2802276"><a href="/encoding/asn1/asn1.go.html#2802189">i</a></span><span class="op" id="2802277">]</span>&nbsp;<span class="op" id="2802279">&gt;&gt;</span>&nbsp;<span class="ident" id="2802282"><a href="/encoding/asn1/asn1.go.html#2802027">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2802289">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802293">return</span>&nbsp;<span class="ident" id="2802300"><a href="/encoding/asn1/asn1.go.html#2802124">a</a></span><br>
<span class="lineno"></span><span class="op" id="2802302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802305">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="2802392">func</span>&nbsp;<span class="ident" id="2802397">parseBitString</span><span class="op" id="2802411">(</span><span class="ident" id="2802412">bytes</span>&nbsp;<span class="op" id="2802418">[</span><span class="op" id="2802419">]</span><span class="builtintype" id="2802420">byte</span><span class="op" id="2802424">)</span>&nbsp;<span class="op" id="2802426">(</span><span class="ident" id="2802427">ret</span>&nbsp;<span class="ident" id="2802431"><a href="/encoding/asn1/asn1.go.html#2801517">BitString</a></span><span class="op" id="2802440">,</span>&nbsp;<span class="ident" id="2802442">err</span>&nbsp;<span class="builtintype" id="2802446">error</span><span class="op" id="2802451">)</span>&nbsp;<span class="op" id="2802453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802456">if</span>&nbsp;<span class="builtinfunc" id="2802459">len</span><span class="op" id="2802462">(</span><span class="ident" id="2802463"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802468">)</span>&nbsp;<span class="op" id="2802470">==</span>&nbsp;<span class="num" id="2802473">0</span>&nbsp;<span class="op" id="2802475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802479"><a href="/encoding/asn1/asn1.go.html#2802442">err</a></span>&nbsp;<span class="op" id="2802483">=</span>&nbsp;<span class="ident" id="2802485"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2802496">{</span><span class="string" id="2802497">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="2802521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802525">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2802533">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802536">paddingBits</span>&nbsp;<span class="op" id="2802548">:=</span>&nbsp;<span class="builtintype" id="2802551">int</span><span class="op" id="2802554">(</span><span class="ident" id="2802555"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802560">[</span><span class="num" id="2802561">0</span><span class="op" id="2802562">]</span><span class="op" id="2802563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802566">if</span>&nbsp;<span class="ident" id="2802569"><a href="/encoding/asn1/asn1.go.html#2802536">paddingBits</a></span>&nbsp;<span class="op" id="2802581">&gt;</span>&nbsp;<span class="num" id="2802583">7</span>&nbsp;<span class="op" id="2802585">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2802590">len</span><span class="op" id="2802593">(</span><span class="ident" id="2802594"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802599">)</span>&nbsp;<span class="op" id="2802601">==</span>&nbsp;<span class="num" id="2802604">1</span>&nbsp;<span class="op" id="2802606">&amp;&amp;</span>&nbsp;<span class="ident" id="2802609"><a href="/encoding/asn1/asn1.go.html#2802536">paddingBits</a></span>&nbsp;<span class="op" id="2802621">&gt;</span>&nbsp;<span class="num" id="2802623">0</span>&nbsp;<span class="op" id="2802625">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802630"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802635">[</span><span class="builtinfunc" id="2802636">len</span><span class="op" id="2802639">(</span><span class="ident" id="2802640"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802645">)</span><span class="op" id="2802646">-</span><span class="num" id="2802647">1</span><span class="op" id="2802648">]</span><span class="op" id="2802649">&amp;</span><span class="op" id="2802650">(</span><span class="op" id="2802651">(</span><span class="num" id="2802652">1</span><span class="op" id="2802653">&lt;&lt;</span><span class="ident" id="2802655"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802660">[</span><span class="num" id="2802661">0</span><span class="op" id="2802662">]</span><span class="op" id="2802663">)</span><span class="op" id="2802664">-</span><span class="num" id="2802665">1</span><span class="op" id="2802666">)</span>&nbsp;<span class="op" id="2802668">!=</span>&nbsp;<span class="num" id="2802671">0</span>&nbsp;<span class="op" id="2802673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802677"><a href="/encoding/asn1/asn1.go.html#2802442">err</a></span>&nbsp;<span class="op" id="2802681">=</span>&nbsp;<span class="ident" id="2802683"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2802694">{</span><span class="string" id="2802695">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="2802731">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802735">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2802743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802746"><a href="/encoding/asn1/asn1.go.html#2802427">ret</a></span><span class="op" id="2802749">.</span><span class="ident" id="2802750">BitLength</span>&nbsp;<span class="op" id="2802760">=</span>&nbsp;<span class="op" id="2802762">(</span><span class="builtinfunc" id="2802763">len</span><span class="op" id="2802766">(</span><span class="ident" id="2802767"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802772">)</span><span class="op" id="2802773">-</span><span class="num" id="2802774">1</span><span class="op" id="2802775">)</span><span class="op" id="2802776">*</span><span class="num" id="2802777">8</span>&nbsp;<span class="op" id="2802779">-</span>&nbsp;<span class="ident" id="2802781"><a href="/encoding/asn1/asn1.go.html#2802536">paddingBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802794"><a href="/encoding/asn1/asn1.go.html#2802427">ret</a></span><span class="op" id="2802797">.</span><span class="ident" id="2802798">Bytes</span>&nbsp;<span class="op" id="2802804">=</span>&nbsp;<span class="ident" id="2802806"><a href="/encoding/asn1/asn1.go.html#2802412">bytes</a></span><span class="op" id="2802811">[</span><span class="num" id="2802812">1</span><span class="op" id="2802813">:</span><span class="op" id="2802814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2802817">return</span><br>
<span class="lineno">180</span><span class="op" id="2802824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802827">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802849">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="2802911">type</span>&nbsp;<span class="ident" id="2802916">ObjectIdentifier</span>&nbsp;<span class="op" id="2802933">[</span><span class="op" id="2802934">]</span><span class="builtintype" id="2802935">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802940">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="2803009">func</span>&nbsp;<span class="op" id="2803014">(</span><span class="ident" id="2803015">oi</span>&nbsp;<span class="ident" id="2803018"><a href="/encoding/asn1/asn1.go.html#2802916">ObjectIdentifier</a></span><span class="op" id="2803034">)</span>&nbsp;<span class="ident" id="2803036">Equal</span><span class="op" id="2803041">(</span><span class="ident" id="2803042">other</span>&nbsp;<span class="ident" id="2803048"><a href="/encoding/asn1/asn1.go.html#2802916">ObjectIdentifier</a></span><span class="op" id="2803064">)</span>&nbsp;<span class="builtintype" id="2803066">bool</span>&nbsp;<span class="op" id="2803071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803074">if</span>&nbsp;<span class="builtinfunc" id="2803077">len</span><span class="op" id="2803080">(</span><span class="ident" id="2803081"><a href="/encoding/asn1/asn1.go.html#2803015">oi</a></span><span class="op" id="2803083">)</span>&nbsp;<span class="op" id="2803085">!=</span>&nbsp;<span class="builtinfunc" id="2803088">len</span><span class="op" id="2803091">(</span><span class="ident" id="2803092"><a href="/encoding/asn1/asn1.go.html#2803042">other</a></span><span class="op" id="2803097">)</span>&nbsp;<span class="op" id="2803099">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803103">return</span>&nbsp;<span class="ident" id="2803110">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803120">for</span>&nbsp;<span class="ident" id="2803124">i</span>&nbsp;<span class="op" id="2803126">:=</span>&nbsp;<span class="num" id="2803129">0</span><span class="op" id="2803130">;</span>&nbsp;<span class="ident" id="2803132"><a href="/encoding/asn1/asn1.go.html#2803124">i</a></span>&nbsp;<span class="op" id="2803134">&lt;</span>&nbsp;<span class="builtinfunc" id="2803136">len</span><span class="op" id="2803139">(</span><span class="ident" id="2803140"><a href="/encoding/asn1/asn1.go.html#2803015">oi</a></span><span class="op" id="2803142">)</span><span class="op" id="2803143">;</span>&nbsp;<span class="ident" id="2803145"><a href="/encoding/asn1/asn1.go.html#2803124">i</a></span><span class="op" id="2803146">++</span>&nbsp;<span class="op" id="2803149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803153">if</span>&nbsp;<span class="ident" id="2803156"><a href="/encoding/asn1/asn1.go.html#2803015">oi</a></span><span class="op" id="2803158">[</span><span class="ident" id="2803159"><a href="/encoding/asn1/asn1.go.html#2803124">i</a></span><span class="op" id="2803160">]</span>&nbsp;<span class="op" id="2803162">!=</span>&nbsp;<span class="ident" id="2803165"><a href="/encoding/asn1/asn1.go.html#2803042">other</a></span><span class="op" id="2803170">[</span><span class="ident" id="2803171"><a href="/encoding/asn1/asn1.go.html#2803124">i</a></span><span class="op" id="2803172">]</span>&nbsp;<span class="op" id="2803174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803179">return</span>&nbsp;<span class="ident" id="2803186">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803201">return</span>&nbsp;<span class="ident" id="2803208">true</span><br>
<span class="lineno"></span><span class="op" id="2803213">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="2803216">func</span>&nbsp;<span class="op" id="2803221">(</span><span class="ident" id="2803222">oi</span>&nbsp;<span class="ident" id="2803225"><a href="/encoding/asn1/asn1.go.html#2802916">ObjectIdentifier</a></span><span class="op" id="2803241">)</span>&nbsp;<span class="ident" id="2803243">String</span><span class="op" id="2803249">(</span><span class="op" id="2803250">)</span>&nbsp;<span class="builtintype" id="2803252">string</span>&nbsp;<span class="op" id="2803259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803262">var</span>&nbsp;<span class="ident" id="2803266">s</span>&nbsp;<span class="builtintype" id="2803268">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803277">for</span>&nbsp;<span class="ident" id="2803281">i</span><span class="op" id="2803282">,</span>&nbsp;<span class="ident" id="2803284">v</span>&nbsp;<span class="op" id="2803286">:=</span>&nbsp;<span class="keyword" id="2803289">range</span>&nbsp;<span class="ident" id="2803295"><a href="/encoding/asn1/asn1.go.html#2803222">oi</a></span>&nbsp;<span class="op" id="2803298">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803302">if</span>&nbsp;<span class="ident" id="2803305"><a href="/encoding/asn1/asn1.go.html#2803281">i</a></span>&nbsp;<span class="op" id="2803307">&gt;</span>&nbsp;<span class="num" id="2803309">0</span>&nbsp;<span class="op" id="2803311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803316"><a href="/encoding/asn1/asn1.go.html#2803266">s</a></span>&nbsp;<span class="op" id="2803318">+=</span>&nbsp;<span class="string" id="2803321">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803331"><a href="/encoding/asn1/asn1.go.html#2803266">s</a></span>&nbsp;<span class="op" id="2803333">+=</span>&nbsp;<span class="ident" id="2803336"><a href="/encoding/asn1/asn1.go.html#2798981">strconv</a></span><span class="op" id="2803343">.</span><span class="ident" id="2803344">Itoa</span><span class="op" id="2803348">(</span><span class="ident" id="2803349"><a href="/encoding/asn1/asn1.go.html#2803284">v</a></span><span class="op" id="2803350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803353">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803357">return</span>&nbsp;<span class="ident" id="2803364"><a href="/encoding/asn1/asn1.go.html#2803266">s</a></span><br>
<span class="lineno"></span><span class="op" id="2803366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2803369">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="2803447">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="2803525">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="2803562">func</span>&nbsp;<span class="ident" id="2803567">parseObjectIdentifier</span><span class="op" id="2803588">(</span><span class="ident" id="2803589">bytes</span>&nbsp;<span class="op" id="2803595">[</span><span class="op" id="2803596">]</span><span class="builtintype" id="2803597">byte</span><span class="op" id="2803601">)</span>&nbsp;<span class="op" id="2803603">(</span><span class="ident" id="2803604">s</span>&nbsp;<span class="op" id="2803606">[</span><span class="op" id="2803607">]</span><span class="builtintype" id="2803608">int</span><span class="op" id="2803611">,</span>&nbsp;<span class="ident" id="2803613">err</span>&nbsp;<span class="builtintype" id="2803617">error</span><span class="op" id="2803622">)</span>&nbsp;<span class="op" id="2803624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803627">if</span>&nbsp;<span class="builtinfunc" id="2803630">len</span><span class="op" id="2803633">(</span><span class="ident" id="2803634"><a href="/encoding/asn1/asn1.go.html#2803589">bytes</a></span><span class="op" id="2803639">)</span>&nbsp;<span class="op" id="2803641">==</span>&nbsp;<span class="num" id="2803644">0</span>&nbsp;<span class="op" id="2803646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803650"><a href="/encoding/asn1/asn1.go.html#2803613">err</a></span>&nbsp;<span class="op" id="2803654">=</span>&nbsp;<span class="ident" id="2803656"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2803667">{</span><span class="string" id="2803668">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="2803699">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2803703">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2803711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803715">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803788">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803858"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span>&nbsp;<span class="op" id="2803860">=</span>&nbsp;<span class="builtinfunc" id="2803862">make</span><span class="op" id="2803866">(</span><span class="op" id="2803867">[</span><span class="op" id="2803868">]</span><span class="builtintype" id="2803869">int</span><span class="op" id="2803872">,</span>&nbsp;<span class="builtinfunc" id="2803874">len</span><span class="op" id="2803877">(</span><span class="ident" id="2803878"><a href="/encoding/asn1/asn1.go.html#2803589">bytes</a></span><span class="op" id="2803883">)</span><span class="op" id="2803884">+</span><span class="num" id="2803885">1</span><span class="op" id="2803886">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803890">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803934">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804009">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804083">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804129">v</span><span class="op" id="2804130">,</span>&nbsp;<span class="ident" id="2804132">offset</span><span class="op" id="2804138">,</span>&nbsp;<span class="ident" id="2804140"><a href="/encoding/asn1/asn1.go.html#2803613">err</a></span>&nbsp;<span class="op" id="2804144">:=</span>&nbsp;<span class="ident" id="2804147"><a href="/encoding/asn1/asn1.go.html#2804761">parseBase128Int</a></span><span class="op" id="2804162">(</span><span class="ident" id="2804163"><a href="/encoding/asn1/asn1.go.html#2803589">bytes</a></span><span class="op" id="2804168">,</span>&nbsp;<span class="num" id="2804170">0</span><span class="op" id="2804171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804174">if</span>&nbsp;<span class="ident" id="2804177"><a href="/encoding/asn1/asn1.go.html#2803613">err</a></span>&nbsp;<span class="op" id="2804181">!=</span>&nbsp;<span class="ident" id="2804184">nil</span>&nbsp;<span class="op" id="2804188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804192">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804200">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804203">if</span>&nbsp;<span class="ident" id="2804206"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span>&nbsp;<span class="op" id="2804208">&lt;</span>&nbsp;<span class="num" id="2804210">80</span>&nbsp;<span class="op" id="2804213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804217"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804218">[</span><span class="num" id="2804219">0</span><span class="op" id="2804220">]</span>&nbsp;<span class="op" id="2804222">=</span>&nbsp;<span class="ident" id="2804224"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span>&nbsp;<span class="op" id="2804226">/</span>&nbsp;<span class="num" id="2804228">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804233"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804234">[</span><span class="num" id="2804235">1</span><span class="op" id="2804236">]</span>&nbsp;<span class="op" id="2804238">=</span>&nbsp;<span class="ident" id="2804240"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span>&nbsp;<span class="op" id="2804242">%</span>&nbsp;<span class="num" id="2804244">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804248">}</span>&nbsp;<span class="keyword" id="2804250">else</span>&nbsp;<span class="op" id="2804255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804259"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804260">[</span><span class="num" id="2804261">0</span><span class="op" id="2804262">]</span>&nbsp;<span class="op" id="2804264">=</span>&nbsp;<span class="num" id="2804266">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804270"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804271">[</span><span class="num" id="2804272">1</span><span class="op" id="2804273">]</span>&nbsp;<span class="op" id="2804275">=</span>&nbsp;<span class="ident" id="2804277"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span>&nbsp;<span class="op" id="2804279">-</span>&nbsp;<span class="num" id="2804281">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804289">i</span>&nbsp;<span class="op" id="2804291">:=</span>&nbsp;<span class="num" id="2804294">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804297">for</span>&nbsp;<span class="op" id="2804301">;</span>&nbsp;<span class="ident" id="2804303"><a href="/encoding/asn1/asn1.go.html#2804132">offset</a></span>&nbsp;<span class="op" id="2804310">&lt;</span>&nbsp;<span class="builtinfunc" id="2804312">len</span><span class="op" id="2804315">(</span><span class="ident" id="2804316"><a href="/encoding/asn1/asn1.go.html#2803589">bytes</a></span><span class="op" id="2804321">)</span><span class="op" id="2804322">;</span>&nbsp;<span class="ident" id="2804324"><a href="/encoding/asn1/asn1.go.html#2804289">i</a></span><span class="op" id="2804325">++</span>&nbsp;<span class="op" id="2804328">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804332"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span><span class="op" id="2804333">,</span>&nbsp;<span class="ident" id="2804335"><a href="/encoding/asn1/asn1.go.html#2804132">offset</a></span><span class="op" id="2804341">,</span>&nbsp;<span class="ident" id="2804343"><a href="/encoding/asn1/asn1.go.html#2803613">err</a></span>&nbsp;<span class="op" id="2804347">=</span>&nbsp;<span class="ident" id="2804349"><a href="/encoding/asn1/asn1.go.html#2804761">parseBase128Int</a></span><span class="op" id="2804364">(</span><span class="ident" id="2804365"><a href="/encoding/asn1/asn1.go.html#2803589">bytes</a></span><span class="op" id="2804370">,</span>&nbsp;<span class="ident" id="2804372"><a href="/encoding/asn1/asn1.go.html#2804132">offset</a></span><span class="op" id="2804378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804382">if</span>&nbsp;<span class="ident" id="2804385"><a href="/encoding/asn1/asn1.go.html#2803613">err</a></span>&nbsp;<span class="op" id="2804389">!=</span>&nbsp;<span class="ident" id="2804392">nil</span>&nbsp;<span class="op" id="2804396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804401">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804414"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804415">[</span><span class="ident" id="2804416"><a href="/encoding/asn1/asn1.go.html#2804289">i</a></span><span class="op" id="2804417">]</span>&nbsp;<span class="op" id="2804419">=</span>&nbsp;<span class="ident" id="2804421"><a href="/encoding/asn1/asn1.go.html#2804129">v</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804427"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span>&nbsp;<span class="op" id="2804429">=</span>&nbsp;<span class="ident" id="2804431"><a href="/encoding/asn1/asn1.go.html#2803604">s</a></span><span class="op" id="2804432">[</span><span class="num" id="2804433">0</span><span class="op" id="2804434">:</span><span class="ident" id="2804435"><a href="/encoding/asn1/asn1.go.html#2804289">i</a></span><span class="op" id="2804436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804439">return</span><br>
<span class="lineno"></span><span class="op" id="2804446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2804449">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2804464">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="2804512">type</span>&nbsp;<span class="ident" id="2804517">Enumerated</span>&nbsp;<span class="builtintype" id="2804528">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="2804533">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2804542">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2804600">type</span>&nbsp;<span class="ident" id="2804605">Flag</span>&nbsp;<span class="builtintype" id="2804610">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2804616">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2804694">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="2804756">func</span>&nbsp;<span class="ident" id="2804761">parseBase128Int</span><span class="op" id="2804776">(</span><span class="ident" id="2804777">bytes</span>&nbsp;<span class="op" id="2804783">[</span><span class="op" id="2804784">]</span><span class="builtintype" id="2804785">byte</span><span class="op" id="2804789">,</span>&nbsp;<span class="ident" id="2804791">initOffset</span>&nbsp;<span class="builtintype" id="2804802">int</span><span class="op" id="2804805">)</span>&nbsp;<span class="op" id="2804807">(</span><span class="ident" id="2804808">ret</span><span class="op" id="2804811">,</span>&nbsp;<span class="ident" id="2804813">offset</span>&nbsp;<span class="builtintype" id="2804820">int</span><span class="op" id="2804823">,</span>&nbsp;<span class="ident" id="2804825">err</span>&nbsp;<span class="builtintype" id="2804829">error</span><span class="op" id="2804834">)</span>&nbsp;<span class="op" id="2804836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804839"><a href="/encoding/asn1/asn1.go.html#2804813">offset</a></span>&nbsp;<span class="op" id="2804846">=</span>&nbsp;<span class="ident" id="2804848"><a href="/encoding/asn1/asn1.go.html#2804791">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804860">for</span>&nbsp;<span class="ident" id="2804864">shifted</span>&nbsp;<span class="op" id="2804872">:=</span>&nbsp;<span class="num" id="2804875">0</span><span class="op" id="2804876">;</span>&nbsp;<span class="ident" id="2804878"><a href="/encoding/asn1/asn1.go.html#2804813">offset</a></span>&nbsp;<span class="op" id="2804885">&lt;</span>&nbsp;<span class="builtinfunc" id="2804887">len</span><span class="op" id="2804890">(</span><span class="ident" id="2804891"><a href="/encoding/asn1/asn1.go.html#2804777">bytes</a></span><span class="op" id="2804896">)</span><span class="op" id="2804897">;</span>&nbsp;<span class="ident" id="2804899"><a href="/encoding/asn1/asn1.go.html#2804864">shifted</a></span><span class="op" id="2804906">++</span>&nbsp;<span class="op" id="2804909">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804913">if</span>&nbsp;<span class="ident" id="2804916"><a href="/encoding/asn1/asn1.go.html#2804864">shifted</a></span>&nbsp;<span class="op" id="2804924">&gt;</span>&nbsp;<span class="num" id="2804926">4</span>&nbsp;<span class="op" id="2804928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804933"><a href="/encoding/asn1/asn1.go.html#2804825">err</a></span>&nbsp;<span class="op" id="2804937">=</span>&nbsp;<span class="ident" id="2804939"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2804954">{</span><span class="string" id="2804955">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="2804983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804988">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805001"><a href="/encoding/asn1/asn1.go.html#2804808">ret</a></span>&nbsp;<span class="op" id="2805005">&lt;&lt;=</span>&nbsp;<span class="num" id="2805009">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805013">b</span>&nbsp;<span class="op" id="2805015">:=</span>&nbsp;<span class="ident" id="2805018"><a href="/encoding/asn1/asn1.go.html#2804777">bytes</a></span><span class="op" id="2805023">[</span><span class="ident" id="2805024"><a href="/encoding/asn1/asn1.go.html#2804813">offset</a></span><span class="op" id="2805030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805034"><a href="/encoding/asn1/asn1.go.html#2804808">ret</a></span>&nbsp;<span class="op" id="2805038">|=</span>&nbsp;<span class="builtintype" id="2805041">int</span><span class="op" id="2805044">(</span><span class="ident" id="2805045"><a href="/encoding/asn1/asn1.go.html#2805013">b</a></span>&nbsp;<span class="op" id="2805047">&amp;</span>&nbsp;<span class="num" id="2805049">0x7f</span><span class="op" id="2805053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805057"><a href="/encoding/asn1/asn1.go.html#2804813">offset</a></span><span class="op" id="2805063">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805068">if</span>&nbsp;<span class="ident" id="2805071"><a href="/encoding/asn1/asn1.go.html#2805013">b</a></span><span class="op" id="2805072">&amp;</span><span class="num" id="2805073">0x80</span>&nbsp;<span class="op" id="2805078">==</span>&nbsp;<span class="num" id="2805081">0</span>&nbsp;<span class="op" id="2805083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805088">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2805097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2805100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805103"><a href="/encoding/asn1/asn1.go.html#2804825">err</a></span>&nbsp;<span class="op" id="2805107">=</span>&nbsp;<span class="ident" id="2805109"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2805120">{</span><span class="string" id="2805121">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="2805149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805152">return</span><br>
<span class="lineno"></span><span class="op" id="2805159">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="2805162">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2805174">func</span>&nbsp;<span class="ident" id="2805179">parseUTCTime</span><span class="op" id="2805191">(</span><span class="ident" id="2805192">bytes</span>&nbsp;<span class="op" id="2805198">[</span><span class="op" id="2805199">]</span><span class="builtintype" id="2805200">byte</span><span class="op" id="2805204">)</span>&nbsp;<span class="op" id="2805206">(</span><span class="ident" id="2805207">ret</span>&nbsp;<span class="ident" id="2805211"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2805215">.</span><span class="ident" id="2805216">Time</span><span class="op" id="2805220">,</span>&nbsp;<span class="ident" id="2805222">err</span>&nbsp;<span class="builtintype" id="2805226">error</span><span class="op" id="2805231">)</span>&nbsp;<span class="op" id="2805233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805236">s</span>&nbsp;<span class="op" id="2805238">:=</span>&nbsp;<span class="builtintype" id="2805241">string</span><span class="op" id="2805247">(</span><span class="ident" id="2805248"><a href="/encoding/asn1/asn1.go.html#2805192">bytes</a></span><span class="op" id="2805253">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805256"><a href="/encoding/asn1/asn1.go.html#2805207">ret</a></span><span class="op" id="2805259">,</span>&nbsp;<span class="ident" id="2805261"><a href="/encoding/asn1/asn1.go.html#2805222">err</a></span>&nbsp;<span class="op" id="2805265">=</span>&nbsp;<span class="ident" id="2805267"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2805271">.</span><span class="ident" id="2805272">Parse</span><span class="op" id="2805277">(</span><span class="string" id="2805278">&#34;0601021504Z0700&#34;</span><span class="op" id="2805295">,</span>&nbsp;<span class="ident" id="2805297"><a href="/encoding/asn1/asn1.go.html#2805236">s</a></span><span class="op" id="2805298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805301">if</span>&nbsp;<span class="ident" id="2805304"><a href="/encoding/asn1/asn1.go.html#2805222">err</a></span>&nbsp;<span class="op" id="2805308">!=</span>&nbsp;<span class="ident" id="2805311">nil</span>&nbsp;<span class="op" id="2805315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805319"><a href="/encoding/asn1/asn1.go.html#2805207">ret</a></span><span class="op" id="2805322">,</span>&nbsp;<span class="ident" id="2805324"><a href="/encoding/asn1/asn1.go.html#2805222">err</a></span>&nbsp;<span class="op" id="2805328">=</span>&nbsp;<span class="ident" id="2805330"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2805334">.</span><span class="ident" id="2805335">Parse</span><span class="op" id="2805340">(</span><span class="string" id="2805341">&#34;060102150405Z0700&#34;</span><span class="op" id="2805360">,</span>&nbsp;<span class="ident" id="2805362"><a href="/encoding/asn1/asn1.go.html#2805236">s</a></span><span class="op" id="2805363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2805366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805369">if</span>&nbsp;<span class="ident" id="2805372"><a href="/encoding/asn1/asn1.go.html#2805222">err</a></span>&nbsp;<span class="op" id="2805376">==</span>&nbsp;<span class="ident" id="2805379">nil</span>&nbsp;<span class="op" id="2805383">&amp;&amp;</span>&nbsp;<span class="ident" id="2805386"><a href="/encoding/asn1/asn1.go.html#2805207">ret</a></span><span class="op" id="2805389">.</span><span class="ident" id="2805390">Year</span><span class="op" id="2805394">(</span><span class="op" id="2805395">)</span>&nbsp;<span class="op" id="2805397">&gt;=</span>&nbsp;<span class="num" id="2805400">2050</span>&nbsp;<span class="op" id="2805405">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805409">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805514"><a href="/encoding/asn1/asn1.go.html#2805207">ret</a></span>&nbsp;<span class="op" id="2805518">=</span>&nbsp;<span class="ident" id="2805520"><a href="/encoding/asn1/asn1.go.html#2805207">ret</a></span><span class="op" id="2805523">.</span><span class="ident" id="2805524">AddDate</span><span class="op" id="2805531">(</span><span class="op" id="2805532">-</span><span class="num" id="2805533">100</span><span class="op" id="2805536">,</span>&nbsp;<span class="num" id="2805538">0</span><span class="op" id="2805539">,</span>&nbsp;<span class="num" id="2805541">0</span><span class="op" id="2805542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2805545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805549">return</span><br>
<span class="lineno">300</span><span class="op" id="2805556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2805559">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="2805636">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2805671">func</span>&nbsp;<span class="ident" id="2805676">parseGeneralizedTime</span><span class="op" id="2805696">(</span><span class="ident" id="2805697">bytes</span>&nbsp;<span class="op" id="2805703">[</span><span class="op" id="2805704">]</span><span class="builtintype" id="2805705">byte</span><span class="op" id="2805709">)</span>&nbsp;<span class="op" id="2805711">(</span><span class="ident" id="2805712">ret</span>&nbsp;<span class="ident" id="2805716"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2805720">.</span><span class="ident" id="2805721">Time</span><span class="op" id="2805725">,</span>&nbsp;<span class="ident" id="2805727">err</span>&nbsp;<span class="builtintype" id="2805731">error</span><span class="op" id="2805736">)</span>&nbsp;<span class="op" id="2805738">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805741">return</span>&nbsp;<span class="ident" id="2805748"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2805752">.</span><span class="ident" id="2805753">Parse</span><span class="op" id="2805758">(</span><span class="string" id="2805759">&#34;20060102150405Z0700&#34;</span><span class="op" id="2805780">,</span>&nbsp;<span class="builtintype" id="2805782">string</span><span class="op" id="2805788">(</span><span class="ident" id="2805789"><a href="/encoding/asn1/asn1.go.html#2805697">bytes</a></span><span class="op" id="2805794">)</span><span class="op" id="2805795">)</span><br>
<span class="lineno"></span><span class="op" id="2805797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2805800">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2805820">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="2805895">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2805920">func</span>&nbsp;<span class="ident" id="2805925">parsePrintableString</span><span class="op" id="2805945">(</span><span class="ident" id="2805946">bytes</span>&nbsp;<span class="op" id="2805952">[</span><span class="op" id="2805953">]</span><span class="builtintype" id="2805954">byte</span><span class="op" id="2805958">)</span>&nbsp;<span class="op" id="2805960">(</span><span class="ident" id="2805961">ret</span>&nbsp;<span class="builtintype" id="2805965">string</span><span class="op" id="2805971">,</span>&nbsp;<span class="ident" id="2805973">err</span>&nbsp;<span class="builtintype" id="2805977">error</span><span class="op" id="2805982">)</span>&nbsp;<span class="op" id="2805984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805987">for</span>&nbsp;<span class="ident" id="2805991">_</span><span class="op" id="2805992">,</span>&nbsp;<span class="ident" id="2805994">b</span>&nbsp;<span class="op" id="2805996">:=</span>&nbsp;<span class="keyword" id="2805999">range</span>&nbsp;<span class="ident" id="2806005"><a href="/encoding/asn1/asn1.go.html#2805946">bytes</a></span>&nbsp;<span class="op" id="2806011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806015">if</span>&nbsp;<span class="op" id="2806018">!</span><span class="ident" id="2806019"><a href="/encoding/asn1/asn1.go.html#2806238">isPrintable</a></span><span class="op" id="2806030">(</span><span class="ident" id="2806031"><a href="/encoding/asn1/asn1.go.html#2805994">b</a></span><span class="op" id="2806032">)</span>&nbsp;<span class="op" id="2806034">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806039"><a href="/encoding/asn1/asn1.go.html#2805973">err</a></span>&nbsp;<span class="op" id="2806043">=</span>&nbsp;<span class="ident" id="2806045"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2806056">{</span><span class="string" id="2806057">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="2806101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2806115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2806118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806121"><a href="/encoding/asn1/asn1.go.html#2805961">ret</a></span>&nbsp;<span class="op" id="2806125">=</span>&nbsp;<span class="builtintype" id="2806127">string</span><span class="op" id="2806133">(</span><span class="ident" id="2806134"><a href="/encoding/asn1/asn1.go.html#2805946">bytes</a></span><span class="op" id="2806139">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806142">return</span><br>
<span class="lineno"></span><span class="op" id="2806149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806152">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2806233">func</span>&nbsp;<span class="ident" id="2806238">isPrintable</span><span class="op" id="2806249">(</span><span class="ident" id="2806250">b</span>&nbsp;<span class="builtintype" id="2806252">byte</span><span class="op" id="2806256">)</span>&nbsp;<span class="builtintype" id="2806258">bool</span>&nbsp;<span class="op" id="2806263">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806266">return</span>&nbsp;<span class="string" id="2806273">&#39;a&#39;</span>&nbsp;<span class="op" id="2806277">&lt;=</span>&nbsp;<span class="ident" id="2806280"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806282">&amp;&amp;</span>&nbsp;<span class="ident" id="2806285"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806287">&lt;=</span>&nbsp;<span class="string" id="2806290">&#39;z&#39;</span>&nbsp;<span class="op" id="2806294">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2806299">&#39;A&#39;</span>&nbsp;<span class="op" id="2806303">&lt;=</span>&nbsp;<span class="ident" id="2806306"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806308">&amp;&amp;</span>&nbsp;<span class="ident" id="2806311"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806313">&lt;=</span>&nbsp;<span class="string" id="2806316">&#39;Z&#39;</span>&nbsp;<span class="op" id="2806320">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2806325">&#39;0&#39;</span>&nbsp;<span class="op" id="2806329">&lt;=</span>&nbsp;<span class="ident" id="2806332"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806334">&amp;&amp;</span>&nbsp;<span class="ident" id="2806337"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806339">&lt;=</span>&nbsp;<span class="string" id="2806342">&#39;9&#39;</span>&nbsp;<span class="op" id="2806346">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2806351">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2806356">&lt;=</span>&nbsp;<span class="ident" id="2806359"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806361">&amp;&amp;</span>&nbsp;<span class="ident" id="2806364"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806366">&lt;=</span>&nbsp;<span class="string" id="2806369">&#39;)&#39;</span>&nbsp;<span class="op" id="2806373">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2806378">&#39;+&#39;</span>&nbsp;<span class="op" id="2806382">&lt;=</span>&nbsp;<span class="ident" id="2806385"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806387">&amp;&amp;</span>&nbsp;<span class="ident" id="2806390"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806392">&lt;=</span>&nbsp;<span class="string" id="2806395">&#39;/&#39;</span>&nbsp;<span class="op" id="2806399">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806404"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806406">==</span>&nbsp;<span class="string" id="2806409">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2806413">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806418"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806420">==</span>&nbsp;<span class="string" id="2806423">&#39;:&#39;</span>&nbsp;<span class="op" id="2806427">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806432"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806434">==</span>&nbsp;<span class="string" id="2806437">&#39;=&#39;</span>&nbsp;<span class="op" id="2806441">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806446"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806448">==</span>&nbsp;<span class="string" id="2806451">&#39;?&#39;</span>&nbsp;<span class="op" id="2806455">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806460">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806519">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806579">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806636"><a href="/encoding/asn1/asn1.go.html#2806250">b</a></span>&nbsp;<span class="op" id="2806638">==</span>&nbsp;<span class="string" id="2806641">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="2806645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="2806648">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806662">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="2806735">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2806765">func</span>&nbsp;<span class="ident" id="2806770">parseIA5String</span><span class="op" id="2806784">(</span><span class="ident" id="2806785">bytes</span>&nbsp;<span class="op" id="2806791">[</span><span class="op" id="2806792">]</span><span class="builtintype" id="2806793">byte</span><span class="op" id="2806797">)</span>&nbsp;<span class="op" id="2806799">(</span><span class="ident" id="2806800">ret</span>&nbsp;<span class="builtintype" id="2806804">string</span><span class="op" id="2806810">,</span>&nbsp;<span class="ident" id="2806812">err</span>&nbsp;<span class="builtintype" id="2806816">error</span><span class="op" id="2806821">)</span>&nbsp;<span class="op" id="2806823">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806826">for</span>&nbsp;<span class="ident" id="2806830">_</span><span class="op" id="2806831">,</span>&nbsp;<span class="ident" id="2806833">b</span>&nbsp;<span class="op" id="2806835">:=</span>&nbsp;<span class="keyword" id="2806838">range</span>&nbsp;<span class="ident" id="2806844"><a href="/encoding/asn1/asn1.go.html#2806785">bytes</a></span>&nbsp;<span class="op" id="2806850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806854">if</span>&nbsp;<span class="ident" id="2806857"><a href="/encoding/asn1/asn1.go.html#2806833">b</a></span>&nbsp;<span class="op" id="2806859">&gt;=</span>&nbsp;<span class="num" id="2806862">0x80</span>&nbsp;<span class="op" id="2806867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806872"><a href="/encoding/asn1/asn1.go.html#2806812">err</a></span>&nbsp;<span class="op" id="2806876">=</span>&nbsp;<span class="ident" id="2806878"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2806889">{</span><span class="string" id="2806890">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="2806928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806933">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2806942">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2806945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806948"><a href="/encoding/asn1/asn1.go.html#2806800">ret</a></span>&nbsp;<span class="op" id="2806952">=</span>&nbsp;<span class="builtintype" id="2806954">string</span><span class="op" id="2806960">(</span><span class="ident" id="2806961"><a href="/encoding/asn1/asn1.go.html#2806785">bytes</a></span><span class="op" id="2806966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806969">return</span><br>
<span class="lineno"></span><span class="op" id="2806976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="2806979">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806993">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="2807072">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2807102">func</span>&nbsp;<span class="ident" id="2807107">parseT61String</span><span class="op" id="2807121">(</span><span class="ident" id="2807122">bytes</span>&nbsp;<span class="op" id="2807128">[</span><span class="op" id="2807129">]</span><span class="builtintype" id="2807130">byte</span><span class="op" id="2807134">)</span>&nbsp;<span class="op" id="2807136">(</span><span class="ident" id="2807137">ret</span>&nbsp;<span class="builtintype" id="2807141">string</span><span class="op" id="2807147">,</span>&nbsp;<span class="ident" id="2807149">err</span>&nbsp;<span class="builtintype" id="2807153">error</span><span class="op" id="2807158">)</span>&nbsp;<span class="op" id="2807160">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807163">return</span>&nbsp;<span class="builtintype" id="2807170">string</span><span class="op" id="2807176">(</span><span class="ident" id="2807177"><a href="/encoding/asn1/asn1.go.html#2807122">bytes</a></span><span class="op" id="2807182">)</span><span class="op" id="2807183">,</span>&nbsp;<span class="ident" id="2807185">nil</span><br>
<span class="lineno"></span><span class="op" id="2807189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2807192">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2807207">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="2807284">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2807309">func</span>&nbsp;<span class="ident" id="2807314">parseUTF8String</span><span class="op" id="2807329">(</span><span class="ident" id="2807330">bytes</span>&nbsp;<span class="op" id="2807336">[</span><span class="op" id="2807337">]</span><span class="builtintype" id="2807338">byte</span><span class="op" id="2807342">)</span>&nbsp;<span class="op" id="2807344">(</span><span class="ident" id="2807345">ret</span>&nbsp;<span class="builtintype" id="2807349">string</span><span class="op" id="2807355">,</span>&nbsp;<span class="ident" id="2807357">err</span>&nbsp;<span class="builtintype" id="2807361">error</span><span class="op" id="2807366">)</span>&nbsp;<span class="op" id="2807368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807371">return</span>&nbsp;<span class="builtintype" id="2807378">string</span><span class="op" id="2807384">(</span><span class="ident" id="2807385"><a href="/encoding/asn1/asn1.go.html#2807330">bytes</a></span><span class="op" id="2807390">)</span><span class="op" id="2807391">,</span>&nbsp;<span class="ident" id="2807393">nil</span><br>
<span class="lineno"></span><span class="op" id="2807397">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2807400">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="2807452">type</span>&nbsp;<span class="ident" id="2807457">RawValue</span>&nbsp;<span class="keyword" id="2807466">struct</span>&nbsp;<span class="op" id="2807473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807476">Class</span><span class="op" id="2807481">,</span>&nbsp;<span class="ident" id="2807483">Tag</span>&nbsp;<span class="builtintype" id="2807487">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807492">IsCompound</span>&nbsp;<span class="builtintype" id="2807503">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807509">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807520">[</span><span class="op" id="2807521">]</span><span class="builtintype" id="2807522">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807528">FullBytes</span>&nbsp;&nbsp;<span class="op" id="2807539">[</span><span class="op" id="2807540">]</span><span class="builtintype" id="2807541">byte</span>&nbsp;<span class="comment" id="2807546">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="2807577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2807580">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="2807653">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2807731">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2807806">type</span>&nbsp;<span class="ident" id="2807811">RawContent</span>&nbsp;<span class="op" id="2807822">[</span><span class="op" id="2807823">]</span><span class="builtintype" id="2807824">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2807830">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="2807842">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="2807921">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2807998">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="2808074">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="2808147">func</span>&nbsp;<span class="ident" id="2808152">parseTagAndLength</span><span class="op" id="2808169">(</span><span class="ident" id="2808170">bytes</span>&nbsp;<span class="op" id="2808176">[</span><span class="op" id="2808177">]</span><span class="builtintype" id="2808178">byte</span><span class="op" id="2808182">,</span>&nbsp;<span class="ident" id="2808184">initOffset</span>&nbsp;<span class="builtintype" id="2808195">int</span><span class="op" id="2808198">)</span>&nbsp;<span class="op" id="2808200">(</span><span class="ident" id="2808201">ret</span>&nbsp;<span class="ident" id="2808205"><a href="/encoding/asn1/common.go.html#2824828">tagAndLength</a></span><span class="op" id="2808217">,</span>&nbsp;<span class="ident" id="2808219">offset</span>&nbsp;<span class="builtintype" id="2808226">int</span><span class="op" id="2808229">,</span>&nbsp;<span class="ident" id="2808231">err</span>&nbsp;<span class="builtintype" id="2808235">error</span><span class="op" id="2808240">)</span>&nbsp;<span class="op" id="2808242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808245"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span>&nbsp;<span class="op" id="2808252">=</span>&nbsp;<span class="ident" id="2808254"><a href="/encoding/asn1/asn1.go.html#2808184">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808266">b</span>&nbsp;<span class="op" id="2808268">:=</span>&nbsp;<span class="ident" id="2808271"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2808276">[</span><span class="ident" id="2808277"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808286"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808292">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808296"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808299">.</span><span class="ident" id="2808300">class</span>&nbsp;<span class="op" id="2808306">=</span>&nbsp;<span class="builtintype" id="2808308">int</span><span class="op" id="2808311">(</span><span class="ident" id="2808312"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2808314">&gt;&gt;</span>&nbsp;<span class="num" id="2808317">6</span><span class="op" id="2808318">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808321"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808324">.</span><span class="ident" id="2808325">isCompound</span>&nbsp;<span class="op" id="2808336">=</span>&nbsp;<span class="ident" id="2808338"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span><span class="op" id="2808339">&amp;</span><span class="num" id="2808340">0x20</span>&nbsp;<span class="op" id="2808345">==</span>&nbsp;<span class="num" id="2808348">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808354"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808357">.</span><span class="ident" id="2808358">tag</span>&nbsp;<span class="op" id="2808362">=</span>&nbsp;<span class="builtintype" id="2808364">int</span><span class="op" id="2808367">(</span><span class="ident" id="2808368"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2808370">&amp;</span>&nbsp;<span class="num" id="2808372">0x1f</span><span class="op" id="2808376">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808380">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808458">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808481">if</span>&nbsp;<span class="ident" id="2808484"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808487">.</span><span class="ident" id="2808488">tag</span>&nbsp;<span class="op" id="2808492">==</span>&nbsp;<span class="num" id="2808495">0x1f</span>&nbsp;<span class="op" id="2808500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808504"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808507">.</span><span class="ident" id="2808508">tag</span><span class="op" id="2808511">,</span>&nbsp;<span class="ident" id="2808513"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808519">,</span>&nbsp;<span class="ident" id="2808521"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2808525">=</span>&nbsp;<span class="ident" id="2808527"><a href="/encoding/asn1/asn1.go.html#2804761">parseBase128Int</a></span><span class="op" id="2808542">(</span><span class="ident" id="2808543"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2808548">,</span>&nbsp;<span class="ident" id="2808550"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808560">if</span>&nbsp;<span class="ident" id="2808563"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2808567">!=</span>&nbsp;<span class="ident" id="2808570">nil</span>&nbsp;<span class="op" id="2808574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808588">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808594">if</span>&nbsp;<span class="ident" id="2808597"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span>&nbsp;<span class="op" id="2808604">&gt;=</span>&nbsp;<span class="builtinfunc" id="2808607">len</span><span class="op" id="2808610">(</span><span class="ident" id="2808611"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2808616">)</span>&nbsp;<span class="op" id="2808618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808622"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2808626">=</span>&nbsp;<span class="ident" id="2808628"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2808639">{</span><span class="string" id="2808640">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="2808665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808677">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808680"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2808682">=</span>&nbsp;<span class="ident" id="2808684"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2808689">[</span><span class="ident" id="2808690"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808699"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2808705">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808709">if</span>&nbsp;<span class="ident" id="2808712"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span><span class="op" id="2808713">&amp;</span><span class="num" id="2808714">0x80</span>&nbsp;<span class="op" id="2808719">==</span>&nbsp;<span class="num" id="2808722">0</span>&nbsp;<span class="op" id="2808724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808728">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808777"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2808780">.</span><span class="ident" id="2808781">length</span>&nbsp;<span class="op" id="2808788">=</span>&nbsp;<span class="builtintype" id="2808790">int</span><span class="op" id="2808793">(</span><span class="ident" id="2808794"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2808796">&amp;</span>&nbsp;<span class="num" id="2808798">0x7f</span><span class="op" id="2808802">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808805">}</span>&nbsp;<span class="keyword" id="2808807">else</span>&nbsp;<span class="op" id="2808812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808816">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808878">numBytes</span>&nbsp;<span class="op" id="2808887">:=</span>&nbsp;<span class="builtintype" id="2808890">int</span><span class="op" id="2808893">(</span><span class="ident" id="2808894"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2808896">&amp;</span>&nbsp;<span class="num" id="2808898">0x7f</span><span class="op" id="2808902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808906">if</span>&nbsp;<span class="ident" id="2808909"><a href="/encoding/asn1/asn1.go.html#2808878">numBytes</a></span>&nbsp;<span class="op" id="2808918">==</span>&nbsp;<span class="num" id="2808921">0</span>&nbsp;<span class="op" id="2808923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808928"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2808932">=</span>&nbsp;<span class="ident" id="2808934"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2808945">{</span><span class="string" id="2808946">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="2808981">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808986">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808999"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2809002">.</span><span class="ident" id="2809003">length</span>&nbsp;<span class="op" id="2809010">=</span>&nbsp;<span class="num" id="2809012">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809016">for</span>&nbsp;<span class="ident" id="2809020">i</span>&nbsp;<span class="op" id="2809022">:=</span>&nbsp;<span class="num" id="2809025">0</span><span class="op" id="2809026">;</span>&nbsp;<span class="ident" id="2809028"><a href="/encoding/asn1/asn1.go.html#2809020">i</a></span>&nbsp;<span class="op" id="2809030">&lt;</span>&nbsp;<span class="ident" id="2809032"><a href="/encoding/asn1/asn1.go.html#2808878">numBytes</a></span><span class="op" id="2809040">;</span>&nbsp;<span class="ident" id="2809042"><a href="/encoding/asn1/asn1.go.html#2809020">i</a></span><span class="op" id="2809043">++</span>&nbsp;<span class="op" id="2809046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809051">if</span>&nbsp;<span class="ident" id="2809054"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span>&nbsp;<span class="op" id="2809061">&gt;=</span>&nbsp;<span class="builtinfunc" id="2809064">len</span><span class="op" id="2809067">(</span><span class="ident" id="2809068"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2809073">)</span>&nbsp;<span class="op" id="2809075">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809081"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2809085">=</span>&nbsp;<span class="ident" id="2809087"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2809098">{</span><span class="string" id="2809099">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="2809124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809130">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809145"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span>&nbsp;<span class="op" id="2809147">=</span>&nbsp;<span class="ident" id="2809149"><a href="/encoding/asn1/asn1.go.html#2808170">bytes</a></span><span class="op" id="2809154">[</span><span class="ident" id="2809155"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2809161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809166"><a href="/encoding/asn1/asn1.go.html#2808219">offset</a></span><span class="op" id="2809172">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809178">if</span>&nbsp;<span class="ident" id="2809181"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2809184">.</span><span class="ident" id="2809185">length</span>&nbsp;<span class="op" id="2809192">&gt;=</span>&nbsp;<span class="num" id="2809195">1</span><span class="op" id="2809196">&lt;&lt;</span><span class="num" id="2809198">23</span>&nbsp;<span class="op" id="2809201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809207">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809251">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809271"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2809275">=</span>&nbsp;<span class="ident" id="2809277"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2809292">{</span><span class="string" id="2809293">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="2809311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809317">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809332"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2809335">.</span><span class="ident" id="2809336">length</span>&nbsp;<span class="op" id="2809343">&lt;&lt;=</span>&nbsp;<span class="num" id="2809347">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809352"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2809355">.</span><span class="ident" id="2809356">length</span>&nbsp;<span class="op" id="2809363">|=</span>&nbsp;<span class="builtintype" id="2809366">int</span><span class="op" id="2809369">(</span><span class="ident" id="2809370"><a href="/encoding/asn1/asn1.go.html#2808266">b</a></span><span class="op" id="2809371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809376">if</span>&nbsp;<span class="ident" id="2809379"><a href="/encoding/asn1/asn1.go.html#2808201">ret</a></span><span class="op" id="2809382">.</span><span class="ident" id="2809383">length</span>&nbsp;<span class="op" id="2809390">==</span>&nbsp;<span class="num" id="2809393">0</span>&nbsp;<span class="op" id="2809395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809401">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809446"><a href="/encoding/asn1/asn1.go.html#2808231">err</a></span>&nbsp;<span class="op" id="2809450">=</span>&nbsp;<span class="ident" id="2809452"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2809467">{</span><span class="string" id="2809468">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="2809505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809511">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809528">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809532">return</span><br>
<span class="lineno"></span><span class="op" id="2809539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2809542">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="2809622">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2809698">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2809739">func</span>&nbsp;<span class="ident" id="2809744">parseSequenceOf</span><span class="op" id="2809759">(</span><span class="ident" id="2809760">bytes</span>&nbsp;<span class="op" id="2809766">[</span><span class="op" id="2809767">]</span><span class="builtintype" id="2809768">byte</span><span class="op" id="2809772">,</span>&nbsp;<span class="ident" id="2809774">sliceType</span>&nbsp;<span class="ident" id="2809784"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2809791">.</span><span class="ident" id="2809792">Type</span><span class="op" id="2809796">,</span>&nbsp;<span class="ident" id="2809798">elemType</span>&nbsp;<span class="ident" id="2809807"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2809814">.</span><span class="ident" id="2809815">Type</span><span class="op" id="2809819">)</span>&nbsp;<span class="op" id="2809821">(</span><span class="ident" id="2809822">ret</span>&nbsp;<span class="ident" id="2809826"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2809833">.</span><span class="ident" id="2809834">Value</span><span class="op" id="2809839">,</span>&nbsp;<span class="ident" id="2809841">err</span>&nbsp;<span class="builtintype" id="2809845">error</span><span class="op" id="2809850">)</span>&nbsp;<span class="op" id="2809852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809855">expectedTag</span><span class="op" id="2809866">,</span>&nbsp;<span class="ident" id="2809868">compoundType</span><span class="op" id="2809880">,</span>&nbsp;<span class="ident" id="2809882">ok</span>&nbsp;<span class="op" id="2809885">:=</span>&nbsp;<span class="ident" id="2809888"><a href="/encoding/asn1/common.go.html#2827789">getUniversalType</a></span><span class="op" id="2809904">(</span><span class="ident" id="2809905"><a href="/encoding/asn1/asn1.go.html#2809798">elemType</a></span><span class="op" id="2809913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809916">if</span>&nbsp;<span class="op" id="2809919">!</span><span class="ident" id="2809920"><a href="/encoding/asn1/asn1.go.html#2809882">ok</a></span>&nbsp;<span class="op" id="2809923">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809927"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2809931">=</span>&nbsp;<span class="ident" id="2809933"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2809948">{</span><span class="string" id="2809949">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="2809976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809980">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809992">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810062">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810116">numElements</span>&nbsp;<span class="op" id="2810128">:=</span>&nbsp;<span class="num" id="2810131">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810134">for</span>&nbsp;<span class="ident" id="2810138">offset</span>&nbsp;<span class="op" id="2810145">:=</span>&nbsp;<span class="num" id="2810148">0</span><span class="op" id="2810149">;</span>&nbsp;<span class="ident" id="2810151"><a href="/encoding/asn1/asn1.go.html#2810138">offset</a></span>&nbsp;<span class="op" id="2810158">&lt;</span>&nbsp;<span class="builtinfunc" id="2810160">len</span><span class="op" id="2810163">(</span><span class="ident" id="2810164"><a href="/encoding/asn1/asn1.go.html#2809760">bytes</a></span><span class="op" id="2810169">)</span><span class="op" id="2810170">;</span>&nbsp;<span class="op" id="2810172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810176">var</span>&nbsp;<span class="ident" id="2810180">t</span>&nbsp;<span class="ident" id="2810182"><a href="/encoding/asn1/common.go.html#2824828">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810197"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810198">,</span>&nbsp;<span class="ident" id="2810200"><a href="/encoding/asn1/asn1.go.html#2810138">offset</a></span><span class="op" id="2810206">,</span>&nbsp;<span class="ident" id="2810208"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2810212">=</span>&nbsp;<span class="ident" id="2810214"><a href="/encoding/asn1/asn1.go.html#2808152">parseTagAndLength</a></span><span class="op" id="2810231">(</span><span class="ident" id="2810232"><a href="/encoding/asn1/asn1.go.html#2809760">bytes</a></span><span class="op" id="2810237">,</span>&nbsp;<span class="ident" id="2810239"><a href="/encoding/asn1/asn1.go.html#2810138">offset</a></span><span class="op" id="2810245">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810249">if</span>&nbsp;<span class="ident" id="2810252"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2810256">!=</span>&nbsp;<span class="ident" id="2810259">nil</span>&nbsp;<span class="op" id="2810263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810268">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810281">switch</span>&nbsp;<span class="ident" id="2810288"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810289">.</span><span class="ident" id="2810290">tag</span>&nbsp;<span class="op" id="2810294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810298">case</span>&nbsp;<span class="ident" id="2810303"><a href="/encoding/asn1/common.go.html#2824606">tagIA5String</a></span><span class="op" id="2810315">,</span>&nbsp;<span class="ident" id="2810317"><a href="/encoding/asn1/common.go.html#2824681">tagGeneralString</a></span><span class="op" id="2810333">,</span>&nbsp;<span class="ident" id="2810335"><a href="/encoding/asn1/common.go.html#2824581">tagT61String</a></span><span class="op" id="2810347">,</span>&nbsp;<span class="ident" id="2810349"><a href="/encoding/asn1/common.go.html#2824481">tagUTF8String</a></span><span class="op" id="2810362">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810367">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810420">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810478">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810508"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810509">.</span><span class="ident" id="2810510">tag</span>&nbsp;<span class="op" id="2810514">=</span>&nbsp;<span class="ident" id="2810516"><a href="/encoding/asn1/common.go.html#2824556">tagPrintableString</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810537">case</span>&nbsp;<span class="ident" id="2810542"><a href="/encoding/asn1/common.go.html#2824656">tagGeneralizedTime</a></span><span class="op" id="2810560">,</span>&nbsp;<span class="ident" id="2810562"><a href="/encoding/asn1/common.go.html#2824631">tagUTCTime</a></span><span class="op" id="2810572">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810577">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810631"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810632">.</span><span class="ident" id="2810633">tag</span>&nbsp;<span class="op" id="2810637">=</span>&nbsp;<span class="ident" id="2810639"><a href="/encoding/asn1/common.go.html#2824631">tagUTCTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810657">if</span>&nbsp;<span class="ident" id="2810660"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810661">.</span><span class="ident" id="2810662">class</span>&nbsp;<span class="op" id="2810668">!=</span>&nbsp;<span class="ident" id="2810671"><a href="/encoding/asn1/common.go.html#2824717">classUniversal</a></span>&nbsp;<span class="op" id="2810686">||</span>&nbsp;<span class="ident" id="2810689"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810690">.</span><span class="ident" id="2810691">isCompound</span>&nbsp;<span class="op" id="2810702">!=</span>&nbsp;<span class="ident" id="2810705"><a href="/encoding/asn1/asn1.go.html#2809868">compoundType</a></span>&nbsp;<span class="op" id="2810718">||</span>&nbsp;<span class="ident" id="2810721"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810722">.</span><span class="ident" id="2810723">tag</span>&nbsp;<span class="op" id="2810727">!=</span>&nbsp;<span class="ident" id="2810730"><a href="/encoding/asn1/asn1.go.html#2809855">expectedTag</a></span>&nbsp;<span class="op" id="2810742">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810747"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2810751">=</span>&nbsp;<span class="ident" id="2810753"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2810768">{</span><span class="string" id="2810769">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="2810792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810810">if</span>&nbsp;<span class="ident" id="2810813"><a href="/encoding/asn1/asn1.go.html#2811752">invalidLength</a></span><span class="op" id="2810826">(</span><span class="ident" id="2810827"><a href="/encoding/asn1/asn1.go.html#2810138">offset</a></span><span class="op" id="2810833">,</span>&nbsp;<span class="ident" id="2810835"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810836">.</span><span class="ident" id="2810837">length</span><span class="op" id="2810843">,</span>&nbsp;<span class="builtinfunc" id="2810845">len</span><span class="op" id="2810848">(</span><span class="ident" id="2810849"><a href="/encoding/asn1/asn1.go.html#2809760">bytes</a></span><span class="op" id="2810854">)</span><span class="op" id="2810855">)</span>&nbsp;<span class="op" id="2810857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810862"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2810866">=</span>&nbsp;<span class="ident" id="2810868"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2810879">{</span><span class="string" id="2810880">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="2810900">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810905">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810918"><a href="/encoding/asn1/asn1.go.html#2810138">offset</a></span>&nbsp;<span class="op" id="2810925">+=</span>&nbsp;<span class="ident" id="2810928"><a href="/encoding/asn1/asn1.go.html#2810180">t</a></span><span class="op" id="2810929">.</span><span class="ident" id="2810930">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810939"><a href="/encoding/asn1/asn1.go.html#2810116">numElements</a></span><span class="op" id="2810950">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810954">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810957"><a href="/encoding/asn1/asn1.go.html#2809822">ret</a></span>&nbsp;<span class="op" id="2810961">=</span>&nbsp;<span class="ident" id="2810963"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2810970">.</span><span class="ident" id="2810971">MakeSlice</span><span class="op" id="2810980">(</span><span class="ident" id="2810981"><a href="/encoding/asn1/asn1.go.html#2809774">sliceType</a></span><span class="op" id="2810990">,</span>&nbsp;<span class="ident" id="2810992"><a href="/encoding/asn1/asn1.go.html#2810116">numElements</a></span><span class="op" id="2811003">,</span>&nbsp;<span class="ident" id="2811005"><a href="/encoding/asn1/asn1.go.html#2810116">numElements</a></span><span class="op" id="2811016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811019">params</span>&nbsp;<span class="op" id="2811026">:=</span>&nbsp;<span class="ident" id="2811029"><a href="/encoding/asn1/common.go.html#2825887">fieldParameters</a></span><span class="op" id="2811044">{</span><span class="op" id="2811045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811048">offset</span>&nbsp;<span class="op" id="2811055">:=</span>&nbsp;<span class="num" id="2811058">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811061">for</span>&nbsp;<span class="ident" id="2811065">i</span>&nbsp;<span class="op" id="2811067">:=</span>&nbsp;<span class="num" id="2811070">0</span><span class="op" id="2811071">;</span>&nbsp;<span class="ident" id="2811073"><a href="/encoding/asn1/asn1.go.html#2811065">i</a></span>&nbsp;<span class="op" id="2811075">&lt;</span>&nbsp;<span class="ident" id="2811077"><a href="/encoding/asn1/asn1.go.html#2810116">numElements</a></span><span class="op" id="2811088">;</span>&nbsp;<span class="ident" id="2811090"><a href="/encoding/asn1/asn1.go.html#2811065">i</a></span><span class="op" id="2811091">++</span>&nbsp;<span class="op" id="2811094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811098"><a href="/encoding/asn1/asn1.go.html#2811048">offset</a></span><span class="op" id="2811104">,</span>&nbsp;<span class="ident" id="2811106"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2811110">=</span>&nbsp;<span class="ident" id="2811112"><a href="/encoding/asn1/asn1.go.html#2812056">parseField</a></span><span class="op" id="2811122">(</span><span class="ident" id="2811123"><a href="/encoding/asn1/asn1.go.html#2809822">ret</a></span><span class="op" id="2811126">.</span><span class="ident" id="2811127">Index</span><span class="op" id="2811132">(</span><span class="ident" id="2811133"><a href="/encoding/asn1/asn1.go.html#2811065">i</a></span><span class="op" id="2811134">)</span><span class="op" id="2811135">,</span>&nbsp;<span class="ident" id="2811137"><a href="/encoding/asn1/asn1.go.html#2809760">bytes</a></span><span class="op" id="2811142">,</span>&nbsp;<span class="ident" id="2811144"><a href="/encoding/asn1/asn1.go.html#2811048">offset</a></span><span class="op" id="2811150">,</span>&nbsp;<span class="ident" id="2811152"><a href="/encoding/asn1/asn1.go.html#2811019">params</a></span><span class="op" id="2811158">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811162">if</span>&nbsp;<span class="ident" id="2811165"><a href="/encoding/asn1/asn1.go.html#2809841">err</a></span>&nbsp;<span class="op" id="2811169">!=</span>&nbsp;<span class="ident" id="2811172">nil</span>&nbsp;<span class="op" id="2811176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811181">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811196">return</span><br>
<span class="lineno">500</span><span class="op" id="2811203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2811206">var</span>&nbsp;<span class="op" id="2811210">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811213">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811234">=</span>&nbsp;<span class="ident" id="2811236"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811243">.</span><span class="ident" id="2811244">TypeOf</span><span class="op" id="2811250">(</span><span class="ident" id="2811251"><a href="/encoding/asn1/asn1.go.html#2801517">BitString</a></span><span class="op" id="2811260">{</span><span class="op" id="2811261">}</span><span class="op" id="2811262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811265">objectIdentifierType</span>&nbsp;<span class="op" id="2811286">=</span>&nbsp;<span class="ident" id="2811288"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811295">.</span><span class="ident" id="2811296">TypeOf</span><span class="op" id="2811302">(</span><span class="ident" id="2811303"><a href="/encoding/asn1/asn1.go.html#2802916">ObjectIdentifier</a></span><span class="op" id="2811319">{</span><span class="op" id="2811320">}</span><span class="op" id="2811321">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811324">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811345">=</span>&nbsp;<span class="ident" id="2811347"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811354">.</span><span class="ident" id="2811355">TypeOf</span><span class="op" id="2811361">(</span><span class="ident" id="2811362"><a href="/encoding/asn1/asn1.go.html#2804517">Enumerated</a></span><span class="op" id="2811372">(</span><span class="num" id="2811373">0</span><span class="op" id="2811374">)</span><span class="op" id="2811375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811378">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811399">=</span>&nbsp;<span class="ident" id="2811401"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811408">.</span><span class="ident" id="2811409">TypeOf</span><span class="op" id="2811415">(</span><span class="ident" id="2811416"><a href="/encoding/asn1/asn1.go.html#2804605">Flag</a></span><span class="op" id="2811420">(</span><span class="ident" id="2811421">false</span><span class="op" id="2811426">)</span><span class="op" id="2811427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811430">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811451">=</span>&nbsp;<span class="ident" id="2811453"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811460">.</span><span class="ident" id="2811461">TypeOf</span><span class="op" id="2811467">(</span><span class="ident" id="2811468"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2811472">.</span><span class="ident" id="2811473">Time</span><span class="op" id="2811477">{</span><span class="op" id="2811478">}</span><span class="op" id="2811479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811482">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811503">=</span>&nbsp;<span class="ident" id="2811505"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811512">.</span><span class="ident" id="2811513">TypeOf</span><span class="op" id="2811519">(</span><span class="ident" id="2811520"><a href="/encoding/asn1/asn1.go.html#2807457">RawValue</a></span><span class="op" id="2811528">{</span><span class="op" id="2811529">}</span><span class="op" id="2811530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811533">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811554">=</span>&nbsp;<span class="ident" id="2811556"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811563">.</span><span class="ident" id="2811564">TypeOf</span><span class="op" id="2811570">(</span><span class="ident" id="2811571"><a href="/encoding/asn1/asn1.go.html#2807811">RawContent</a></span><span class="op" id="2811581">(</span><span class="ident" id="2811582">nil</span><span class="op" id="2811585">)</span><span class="op" id="2811586">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811589">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811610">=</span>&nbsp;<span class="ident" id="2811612"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2811619">.</span><span class="ident" id="2811620">TypeOf</span><span class="op" id="2811626">(</span><span class="builtinfunc" id="2811627">new</span><span class="op" id="2811630">(</span><span class="ident" id="2811631"><a href="/encoding/asn1/asn1.go.html#2798958">big</a></span><span class="op" id="2811634">.</span><span class="ident" id="2811635">Int</span><span class="op" id="2811638">)</span><span class="op" id="2811639">)</span><br>
<span class="lineno"></span><span class="op" id="2811641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2811644">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2811719">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="2811747">func</span>&nbsp;<span class="ident" id="2811752">invalidLength</span><span class="op" id="2811765">(</span><span class="ident" id="2811766">offset</span><span class="op" id="2811772">,</span>&nbsp;<span class="ident" id="2811774">length</span><span class="op" id="2811780">,</span>&nbsp;<span class="ident" id="2811782">sliceLength</span>&nbsp;<span class="builtintype" id="2811794">int</span><span class="op" id="2811797">)</span>&nbsp;<span class="builtintype" id="2811799">bool</span>&nbsp;<span class="op" id="2811804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811807">return</span>&nbsp;<span class="ident" id="2811814"><a href="/encoding/asn1/asn1.go.html#2811766">offset</a></span><span class="op" id="2811820">+</span><span class="ident" id="2811821"><a href="/encoding/asn1/asn1.go.html#2811774">length</a></span>&nbsp;<span class="op" id="2811828">&lt;</span>&nbsp;<span class="ident" id="2811830"><a href="/encoding/asn1/asn1.go.html#2811766">offset</a></span>&nbsp;<span class="op" id="2811837">||</span>&nbsp;<span class="ident" id="2811840"><a href="/encoding/asn1/asn1.go.html#2811766">offset</a></span><span class="op" id="2811846">+</span><span class="ident" id="2811847"><a href="/encoding/asn1/asn1.go.html#2811774">length</a></span>&nbsp;<span class="op" id="2811854">&gt;</span>&nbsp;<span class="ident" id="2811856"><a href="/encoding/asn1/asn1.go.html#2811782">sliceLength</a></span><br>
<span class="lineno"></span><span class="op" id="2811868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2811871">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="2811948">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2812028">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="2812051">func</span>&nbsp;<span class="ident" id="2812056">parseField</span><span class="op" id="2812066">(</span><span class="ident" id="2812067">v</span>&nbsp;<span class="ident" id="2812069"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2812076">.</span><span class="ident" id="2812077">Value</span><span class="op" id="2812082">,</span>&nbsp;<span class="ident" id="2812084">bytes</span>&nbsp;<span class="op" id="2812090">[</span><span class="op" id="2812091">]</span><span class="builtintype" id="2812092">byte</span><span class="op" id="2812096">,</span>&nbsp;<span class="ident" id="2812098">initOffset</span>&nbsp;<span class="builtintype" id="2812109">int</span><span class="op" id="2812112">,</span>&nbsp;<span class="ident" id="2812114">params</span>&nbsp;<span class="ident" id="2812121"><a href="/encoding/asn1/common.go.html#2825887">fieldParameters</a></span><span class="op" id="2812136">)</span>&nbsp;<span class="op" id="2812138">(</span><span class="ident" id="2812139">offset</span>&nbsp;<span class="builtintype" id="2812146">int</span><span class="op" id="2812149">,</span>&nbsp;<span class="ident" id="2812151">err</span>&nbsp;<span class="builtintype" id="2812155">error</span><span class="op" id="2812160">)</span>&nbsp;<span class="op" id="2812162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812165"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2812172">=</span>&nbsp;<span class="ident" id="2812174"><a href="/encoding/asn1/asn1.go.html#2812098">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812186">fieldType</span>&nbsp;<span class="op" id="2812196">:=</span>&nbsp;<span class="ident" id="2812199"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2812200">.</span><span class="ident" id="2812201">Type</span><span class="op" id="2812205">(</span><span class="op" id="2812206">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812210">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812297">if</span>&nbsp;<span class="ident" id="2812300"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2812307">==</span>&nbsp;<span class="builtinfunc" id="2812310">len</span><span class="op" id="2812313">(</span><span class="ident" id="2812314"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2812319">)</span>&nbsp;<span class="op" id="2812321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812325">if</span>&nbsp;<span class="op" id="2812328">!</span><span class="ident" id="2812329"><a href="/encoding/asn1/asn1.go.html#2820892">setDefaultValue</a></span><span class="op" id="2812344">(</span><span class="ident" id="2812345"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2812346">,</span>&nbsp;<span class="ident" id="2812348"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2812354">)</span>&nbsp;<span class="op" id="2812356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812361"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2812365">=</span>&nbsp;<span class="ident" id="2812367"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2812378">{</span><span class="string" id="2812379">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="2812399">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812419">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812445">if</span>&nbsp;<span class="ident" id="2812448"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span>&nbsp;<span class="op" id="2812458">==</span>&nbsp;<span class="ident" id="2812461"><a href="/encoding/asn1/asn1.go.html#2811482">rawValueType</a></span>&nbsp;<span class="op" id="2812474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812478">var</span>&nbsp;<span class="ident" id="2812482">t</span>&nbsp;<span class="ident" id="2812484"><a href="/encoding/asn1/common.go.html#2824828">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812499"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812500">,</span>&nbsp;<span class="ident" id="2812502"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2812508">,</span>&nbsp;<span class="ident" id="2812510"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2812514">=</span>&nbsp;<span class="ident" id="2812516"><a href="/encoding/asn1/asn1.go.html#2808152">parseTagAndLength</a></span><span class="op" id="2812533">(</span><span class="ident" id="2812534"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2812539">,</span>&nbsp;<span class="ident" id="2812541"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2812547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812551">if</span>&nbsp;<span class="ident" id="2812554"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2812558">!=</span>&nbsp;<span class="ident" id="2812561">nil</span>&nbsp;<span class="op" id="2812565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812570">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812583">if</span>&nbsp;<span class="ident" id="2812586"><a href="/encoding/asn1/asn1.go.html#2811752">invalidLength</a></span><span class="op" id="2812599">(</span><span class="ident" id="2812600"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2812606">,</span>&nbsp;<span class="ident" id="2812608"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812609">.</span><span class="ident" id="2812610">length</span><span class="op" id="2812616">,</span>&nbsp;<span class="builtinfunc" id="2812618">len</span><span class="op" id="2812621">(</span><span class="ident" id="2812622"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2812627">)</span><span class="op" id="2812628">)</span>&nbsp;<span class="op" id="2812630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812635"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2812639">=</span>&nbsp;<span class="ident" id="2812641"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2812652">{</span><span class="string" id="2812653">&#34;data&nbsp;truncated&#34;</span><span class="op" id="2812669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812683">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812687">result</span>&nbsp;<span class="op" id="2812694">:=</span>&nbsp;<span class="ident" id="2812697"><a href="/encoding/asn1/asn1.go.html#2807457">RawValue</a></span><span class="op" id="2812705">{</span><span class="ident" id="2812706"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812707">.</span><span class="ident" id="2812708">class</span><span class="op" id="2812713">,</span>&nbsp;<span class="ident" id="2812715"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812716">.</span><span class="ident" id="2812717">tag</span><span class="op" id="2812720">,</span>&nbsp;<span class="ident" id="2812722"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812723">.</span><span class="ident" id="2812724">isCompound</span><span class="op" id="2812734">,</span>&nbsp;<span class="ident" id="2812736"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2812741">[</span><span class="ident" id="2812742"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2812749">:</span>&nbsp;<span class="ident" id="2812751"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2812757">+</span><span class="ident" id="2812758"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812759">.</span><span class="ident" id="2812760">length</span><span class="op" id="2812766">]</span><span class="op" id="2812767">,</span>&nbsp;<span class="ident" id="2812769"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2812774">[</span><span class="ident" id="2812775"><a href="/encoding/asn1/asn1.go.html#2812098">initOffset</a></span>&nbsp;<span class="op" id="2812786">:</span>&nbsp;<span class="ident" id="2812788"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2812794">+</span><span class="ident" id="2812795"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812796">.</span><span class="ident" id="2812797">length</span><span class="op" id="2812803">]</span><span class="op" id="2812804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812808"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2812815">+=</span>&nbsp;<span class="ident" id="2812818"><a href="/encoding/asn1/asn1.go.html#2812482">t</a></span><span class="op" id="2812819">.</span><span class="ident" id="2812820">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812829"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2812830">.</span><span class="ident" id="2812831">Set</span><span class="op" id="2812834">(</span><span class="ident" id="2812835"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2812842">.</span><span class="ident" id="2812843">ValueOf</span><span class="op" id="2812850">(</span><span class="ident" id="2812851"><a href="/encoding/asn1/asn1.go.html#2812687">result</a></span><span class="op" id="2812857">)</span><span class="op" id="2812858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812862">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812870">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812874">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812902">if</span>&nbsp;<span class="ident" id="2812905">ifaceType</span>&nbsp;<span class="op" id="2812915">:=</span>&nbsp;<span class="ident" id="2812918"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><span class="op" id="2812927">;</span>&nbsp;<span class="ident" id="2812929"><a href="/encoding/asn1/asn1.go.html#2812905">ifaceType</a></span><span class="op" id="2812938">.</span><span class="ident" id="2812939">Kind</span><span class="op" id="2812943">(</span><span class="op" id="2812944">)</span>&nbsp;<span class="op" id="2812946">==</span>&nbsp;<span class="ident" id="2812949"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2812956">.</span><span class="ident" id="2812957">Interface</span>&nbsp;<span class="op" id="2812967">&amp;&amp;</span>&nbsp;<span class="ident" id="2812970"><a href="/encoding/asn1/asn1.go.html#2812905">ifaceType</a></span><span class="op" id="2812979">.</span><span class="ident" id="2812980">NumMethod</span><span class="op" id="2812989">(</span><span class="op" id="2812990">)</span>&nbsp;<span class="op" id="2812992">==</span>&nbsp;<span class="num" id="2812995">0</span>&nbsp;<span class="op" id="2812997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813001">var</span>&nbsp;<span class="ident" id="2813005">t</span>&nbsp;<span class="ident" id="2813007"><a href="/encoding/asn1/common.go.html#2824828">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813022"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813023">,</span>&nbsp;<span class="ident" id="2813025"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2813031">,</span>&nbsp;<span class="ident" id="2813033"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813037">=</span>&nbsp;<span class="ident" id="2813039"><a href="/encoding/asn1/asn1.go.html#2808152">parseTagAndLength</a></span><span class="op" id="2813056">(</span><span class="ident" id="2813057"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2813062">,</span>&nbsp;<span class="ident" id="2813064"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2813070">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813074">if</span>&nbsp;<span class="ident" id="2813077"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813081">!=</span>&nbsp;<span class="ident" id="2813084">nil</span>&nbsp;<span class="op" id="2813088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2813102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813106">if</span>&nbsp;<span class="ident" id="2813109"><a href="/encoding/asn1/asn1.go.html#2811752">invalidLength</a></span><span class="op" id="2813122">(</span><span class="ident" id="2813123"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2813129">,</span>&nbsp;<span class="ident" id="2813131"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813132">.</span><span class="ident" id="2813133">length</span><span class="op" id="2813139">,</span>&nbsp;<span class="builtinfunc" id="2813141">len</span><span class="op" id="2813144">(</span><span class="ident" id="2813145"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2813150">)</span><span class="op" id="2813151">)</span>&nbsp;<span class="op" id="2813153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813158"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813162">=</span>&nbsp;<span class="ident" id="2813164"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2813175">{</span><span class="string" id="2813176">&#34;data&nbsp;truncated&#34;</span><span class="op" id="2813192">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813197">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2813206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813210">var</span>&nbsp;<span class="ident" id="2813214">result</span>&nbsp;<span class="keyword" id="2813221">interface</span><span class="op" id="2813230">{</span><span class="op" id="2813231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813235">if</span>&nbsp;<span class="op" id="2813238">!</span><span class="ident" id="2813239"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813240">.</span><span class="ident" id="2813241">isCompound</span>&nbsp;<span class="op" id="2813252">&amp;&amp;</span>&nbsp;<span class="ident" id="2813255"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813256">.</span><span class="ident" id="2813257">class</span>&nbsp;<span class="op" id="2813263">==</span>&nbsp;<span class="ident" id="2813266"><a href="/encoding/asn1/common.go.html#2824717">classUniversal</a></span>&nbsp;<span class="op" id="2813281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813286">innerBytes</span>&nbsp;<span class="op" id="2813297">:=</span>&nbsp;<span class="ident" id="2813300"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2813305">[</span><span class="ident" id="2813306"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2813313">:</span>&nbsp;<span class="ident" id="2813315"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2813321">+</span><span class="ident" id="2813322"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813323">.</span><span class="ident" id="2813324">length</span><span class="op" id="2813330">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813335">switch</span>&nbsp;<span class="ident" id="2813342"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2813343">.</span><span class="ident" id="2813344">tag</span>&nbsp;<span class="op" id="2813348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813353">case</span>&nbsp;<span class="ident" id="2813358"><a href="/encoding/asn1/common.go.html#2824556">tagPrintableString</a></span><span class="op" id="2813376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813382"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813388">,</span>&nbsp;<span class="ident" id="2813390"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813394">=</span>&nbsp;<span class="ident" id="2813396"><a href="/encoding/asn1/asn1.go.html#2805925">parsePrintableString</a></span><span class="op" id="2813416">(</span><span class="ident" id="2813417"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813432">case</span>&nbsp;<span class="ident" id="2813437"><a href="/encoding/asn1/common.go.html#2824606">tagIA5String</a></span><span class="op" id="2813449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813455"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813461">,</span>&nbsp;<span class="ident" id="2813463"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813467">=</span>&nbsp;<span class="ident" id="2813469"><a href="/encoding/asn1/asn1.go.html#2806770">parseIA5String</a></span><span class="op" id="2813483">(</span><span class="ident" id="2813484"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813494">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813499">case</span>&nbsp;<span class="ident" id="2813504"><a href="/encoding/asn1/common.go.html#2824581">tagT61String</a></span><span class="op" id="2813516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813522"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813528">,</span>&nbsp;<span class="ident" id="2813530"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813534">=</span>&nbsp;<span class="ident" id="2813536"><a href="/encoding/asn1/asn1.go.html#2807107">parseT61String</a></span><span class="op" id="2813550">(</span><span class="ident" id="2813551"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813566">case</span>&nbsp;<span class="ident" id="2813571"><a href="/encoding/asn1/common.go.html#2824481">tagUTF8String</a></span><span class="op" id="2813584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813590"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813596">,</span>&nbsp;<span class="ident" id="2813598"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813602">=</span>&nbsp;<span class="ident" id="2813604"><a href="/encoding/asn1/asn1.go.html#2807314">parseUTF8String</a></span><span class="op" id="2813619">(</span><span class="ident" id="2813620"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813635">case</span>&nbsp;<span class="ident" id="2813640"><a href="/encoding/asn1/common.go.html#2824360">tagInteger</a></span><span class="op" id="2813650">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813656"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813662">,</span>&nbsp;<span class="ident" id="2813664"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813668">=</span>&nbsp;<span class="ident" id="2813670"><a href="/encoding/asn1/asn1.go.html#2800068">parseInt64</a></span><span class="op" id="2813680">(</span><span class="ident" id="2813681"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813696">case</span>&nbsp;<span class="ident" id="2813701"><a href="/encoding/asn1/common.go.html#2824384">tagBitString</a></span><span class="op" id="2813713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813719"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813725">,</span>&nbsp;<span class="ident" id="2813727"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813731">=</span>&nbsp;<span class="ident" id="2813733"><a href="/encoding/asn1/asn1.go.html#2802397">parseBitString</a></span><span class="op" id="2813747">(</span><span class="ident" id="2813748"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813763">case</span>&nbsp;<span class="ident" id="2813768"><a href="/encoding/asn1/common.go.html#2824432">tagOID</a></span><span class="op" id="2813774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813780"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813786">,</span>&nbsp;<span class="ident" id="2813788"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813792">=</span>&nbsp;<span class="ident" id="2813794"><a href="/encoding/asn1/asn1.go.html#2803567">parseObjectIdentifier</a></span><span class="op" id="2813815">(</span><span class="ident" id="2813816"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813826">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813831">case</span>&nbsp;<span class="ident" id="2813836"><a href="/encoding/asn1/common.go.html#2824631">tagUTCTime</a></span><span class="op" id="2813846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813852"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2813858">,</span>&nbsp;<span class="ident" id="2813860"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2813864">=</span>&nbsp;<span class="ident" id="2813866"><a href="/encoding/asn1/asn1.go.html#2805179">parseUTCTime</a></span><span class="op" id="2813878">(</span><span class="ident" id="2813879"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><span class="op" id="2813889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813894">case</span>&nbsp;<span class="ident" id="2813899"><a href="/encoding/asn1/common.go.html#2824408">tagOctetString</a></span><span class="op" id="2813913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813919"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span>&nbsp;<span class="op" id="2813926">=</span>&nbsp;<span class="ident" id="2813928"><a href="/encoding/asn1/asn1.go.html#2813286">innerBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813942">default</span><span class="op" id="2813949">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813955">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814038"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2814045">+=</span>&nbsp;<span class="ident" id="2814048"><a href="/encoding/asn1/asn1.go.html#2813005">t</a></span><span class="op" id="2814049">.</span><span class="ident" id="2814050">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814059">if</span>&nbsp;<span class="ident" id="2814062"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814066">!=</span>&nbsp;<span class="ident" id="2814069">nil</span>&nbsp;<span class="op" id="2814073">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814078">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814091">if</span>&nbsp;<span class="ident" id="2814094"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span>&nbsp;<span class="op" id="2814101">!=</span>&nbsp;<span class="ident" id="2814104">nil</span>&nbsp;<span class="op" id="2814108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814113"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2814114">.</span><span class="ident" id="2814115">Set</span><span class="op" id="2814118">(</span><span class="ident" id="2814119"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2814126">.</span><span class="ident" id="2814127">ValueOf</span><span class="op" id="2814134">(</span><span class="ident" id="2814135"><a href="/encoding/asn1/asn1.go.html#2813214">result</a></span><span class="op" id="2814141">)</span><span class="op" id="2814142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814146">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814150">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814161">universalTag</span><span class="op" id="2814173">,</span>&nbsp;<span class="ident" id="2814175">compoundType</span><span class="op" id="2814187">,</span>&nbsp;<span class="ident" id="2814189">ok1</span>&nbsp;<span class="op" id="2814193">:=</span>&nbsp;<span class="ident" id="2814196"><a href="/encoding/asn1/common.go.html#2827789">getUniversalType</a></span><span class="op" id="2814212">(</span><span class="ident" id="2814213"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><span class="op" id="2814222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814225">if</span>&nbsp;<span class="op" id="2814228">!</span><span class="ident" id="2814229"><a href="/encoding/asn1/asn1.go.html#2814189">ok1</a></span>&nbsp;<span class="op" id="2814233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814237"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814241">=</span>&nbsp;<span class="ident" id="2814243"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2814258">{</span><span class="ident" id="2814259"><a href="/encoding/asn1/asn1.go.html#2798951">fmt</a></span><span class="op" id="2814262">.</span><span class="ident" id="2814263">Sprintf</span><span class="op" id="2814270">(</span><span class="string" id="2814271">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="2814292">,</span>&nbsp;<span class="ident" id="2814294"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><span class="op" id="2814303">)</span><span class="op" id="2814304">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814308">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814320">t</span><span class="op" id="2814321">,</span>&nbsp;<span class="ident" id="2814323"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2814329">,</span>&nbsp;<span class="ident" id="2814331"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814335">:=</span>&nbsp;<span class="ident" id="2814338"><a href="/encoding/asn1/asn1.go.html#2808152">parseTagAndLength</a></span><span class="op" id="2814355">(</span><span class="ident" id="2814356"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2814361">,</span>&nbsp;<span class="ident" id="2814363"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2814369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814372">if</span>&nbsp;<span class="ident" id="2814375"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814379">!=</span>&nbsp;<span class="ident" id="2814382">nil</span>&nbsp;<span class="op" id="2814386">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814390">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814401">if</span>&nbsp;<span class="ident" id="2814404"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2814410">.</span><span class="ident" id="2814411">explicit</span>&nbsp;<span class="op" id="2814420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814424">expectedClass</span>&nbsp;<span class="op" id="2814438">:=</span>&nbsp;<span class="ident" id="2814441"><a href="/encoding/asn1/common.go.html#2824769">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814464">if</span>&nbsp;<span class="ident" id="2814467"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2814473">.</span><span class="ident" id="2814474">application</span>&nbsp;<span class="op" id="2814486">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814491"><a href="/encoding/asn1/asn1.go.html#2814424">expectedClass</a></span>&nbsp;<span class="op" id="2814505">=</span>&nbsp;<span class="ident" id="2814507"><a href="/encoding/asn1/common.go.html#2824743">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814530">if</span>&nbsp;<span class="ident" id="2814533"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814534">.</span><span class="ident" id="2814535">class</span>&nbsp;<span class="op" id="2814541">==</span>&nbsp;<span class="ident" id="2814544"><a href="/encoding/asn1/asn1.go.html#2814424">expectedClass</a></span>&nbsp;<span class="op" id="2814558">&amp;&amp;</span>&nbsp;<span class="ident" id="2814561"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814562">.</span><span class="ident" id="2814563">tag</span>&nbsp;<span class="op" id="2814567">==</span>&nbsp;<span class="op" id="2814570">*</span><span class="ident" id="2814571"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2814577">.</span><span class="ident" id="2814578">tag</span>&nbsp;<span class="op" id="2814582">&amp;&amp;</span>&nbsp;<span class="op" id="2814585">(</span><span class="ident" id="2814586"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814587">.</span><span class="ident" id="2814588">length</span>&nbsp;<span class="op" id="2814595">==</span>&nbsp;<span class="num" id="2814598">0</span>&nbsp;<span class="op" id="2814600">||</span>&nbsp;<span class="ident" id="2814603"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814604">.</span><span class="ident" id="2814605">isCompound</span><span class="op" id="2814615">)</span>&nbsp;<span class="op" id="2814617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814622">if</span>&nbsp;<span class="ident" id="2814625"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814626">.</span><span class="ident" id="2814627">length</span>&nbsp;<span class="op" id="2814634">&gt;</span>&nbsp;<span class="num" id="2814636">0</span>&nbsp;<span class="op" id="2814638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814644"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2814645">,</span>&nbsp;<span class="ident" id="2814647"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2814653">,</span>&nbsp;<span class="ident" id="2814655"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814659">=</span>&nbsp;<span class="ident" id="2814661"><a href="/encoding/asn1/asn1.go.html#2808152">parseTagAndLength</a></span><span class="op" id="2814678">(</span><span class="ident" id="2814679"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2814684">,</span>&nbsp;<span class="ident" id="2814686"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2814692">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814698">if</span>&nbsp;<span class="ident" id="2814701"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814705">!=</span>&nbsp;<span class="ident" id="2814708">nil</span>&nbsp;<span class="op" id="2814712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814735">}</span>&nbsp;<span class="keyword" id="2814737">else</span>&nbsp;<span class="op" id="2814742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814748">if</span>&nbsp;<span class="ident" id="2814751"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span>&nbsp;<span class="op" id="2814761">!=</span>&nbsp;<span class="ident" id="2814764"><a href="/encoding/asn1/asn1.go.html#2811378">flagType</a></span>&nbsp;<span class="op" id="2814773">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814780"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2814784">=</span>&nbsp;<span class="ident" id="2814786"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2814801">{</span><span class="string" id="2814802">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="2814849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814856">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814873"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2814874">.</span><span class="ident" id="2814875">SetBool</span><span class="op" id="2814882">(</span><span class="ident" id="2814883">true</span><span class="op" id="2814887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814893">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814907">}</span>&nbsp;<span class="keyword" id="2814909">else</span>&nbsp;<span class="op" id="2814914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814919">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814981">ok</span>&nbsp;<span class="op" id="2814984">:=</span>&nbsp;<span class="ident" id="2814987"><a href="/encoding/asn1/asn1.go.html#2820892">setDefaultValue</a></span><span class="op" id="2815002">(</span><span class="ident" id="2815003"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2815004">,</span>&nbsp;<span class="ident" id="2815006"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2815012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815017">if</span>&nbsp;<span class="ident" id="2815020"><a href="/encoding/asn1/asn1.go.html#2814981">ok</a></span>&nbsp;<span class="op" id="2815023">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815029"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2815036">=</span>&nbsp;<span class="ident" id="2815038"><a href="/encoding/asn1/asn1.go.html#2812098">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815052">}</span>&nbsp;<span class="keyword" id="2815054">else</span>&nbsp;<span class="op" id="2815059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815065"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2815069">=</span>&nbsp;<span class="ident" id="2815071"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2815086">{</span><span class="string" id="2815087">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="2815126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815136">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815152">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815223">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815293">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815364">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815413">if</span>&nbsp;<span class="ident" id="2815416"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815429">==</span>&nbsp;<span class="ident" id="2815432"><a href="/encoding/asn1/common.go.html#2824556">tagPrintableString</a></span>&nbsp;<span class="op" id="2815451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815455">if</span>&nbsp;<span class="ident" id="2815458"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2815459">.</span><span class="ident" id="2815460">class</span>&nbsp;<span class="op" id="2815466">==</span>&nbsp;<span class="ident" id="2815469"><a href="/encoding/asn1/common.go.html#2824717">classUniversal</a></span>&nbsp;<span class="op" id="2815484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815489">switch</span>&nbsp;<span class="ident" id="2815496"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2815497">.</span><span class="ident" id="2815498">tag</span>&nbsp;<span class="op" id="2815502">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815507">case</span>&nbsp;<span class="ident" id="2815512"><a href="/encoding/asn1/common.go.html#2824606">tagIA5String</a></span><span class="op" id="2815524">,</span>&nbsp;<span class="ident" id="2815526"><a href="/encoding/asn1/common.go.html#2824681">tagGeneralString</a></span><span class="op" id="2815542">,</span>&nbsp;<span class="ident" id="2815544"><a href="/encoding/asn1/common.go.html#2824581">tagT61String</a></span><span class="op" id="2815556">,</span>&nbsp;<span class="ident" id="2815558"><a href="/encoding/asn1/common.go.html#2824481">tagUTF8String</a></span><span class="op" id="2815571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815577"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815590">=</span>&nbsp;<span class="ident" id="2815592"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2815593">.</span><span class="ident" id="2815594">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815605">}</span>&nbsp;<span class="keyword" id="2815607">else</span>&nbsp;<span class="keyword" id="2815612">if</span>&nbsp;<span class="ident" id="2815615"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2815621">.</span><span class="ident" id="2815622">stringType</span>&nbsp;<span class="op" id="2815633">!=</span>&nbsp;<span class="num" id="2815636">0</span>&nbsp;<span class="op" id="2815638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815643"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815656">=</span>&nbsp;<span class="ident" id="2815658"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2815664">.</span><span class="ident" id="2815665">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815685">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815756">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815779">if</span>&nbsp;<span class="ident" id="2815782"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815795">==</span>&nbsp;<span class="ident" id="2815798"><a href="/encoding/asn1/common.go.html#2824631">tagUTCTime</a></span>&nbsp;<span class="op" id="2815809">&amp;&amp;</span>&nbsp;<span class="ident" id="2815812"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2815813">.</span><span class="ident" id="2815814">tag</span>&nbsp;<span class="op" id="2815818">==</span>&nbsp;<span class="ident" id="2815821"><a href="/encoding/asn1/common.go.html#2824656">tagGeneralizedTime</a></span>&nbsp;<span class="op" id="2815840">&amp;&amp;</span>&nbsp;<span class="ident" id="2815843"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2815844">.</span><span class="ident" id="2815845">class</span>&nbsp;<span class="op" id="2815851">==</span>&nbsp;<span class="ident" id="2815854"><a href="/encoding/asn1/common.go.html#2824717">classUniversal</a></span>&nbsp;<span class="op" id="2815869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815873"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815886">=</span>&nbsp;<span class="ident" id="2815888"><a href="/encoding/asn1/common.go.html#2824656">tagGeneralizedTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815912">if</span>&nbsp;<span class="ident" id="2815915"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2815921">.</span><span class="ident" id="2815922">set</span>&nbsp;<span class="op" id="2815926">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815930"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2815943">=</span>&nbsp;<span class="ident" id="2815945"><a href="/encoding/asn1/common.go.html#2824531">tagSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815957">expectedClass</span>&nbsp;<span class="op" id="2815971">:=</span>&nbsp;<span class="ident" id="2815974"><a href="/encoding/asn1/common.go.html#2824717">classUniversal</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815990">expectedTag</span>&nbsp;<span class="op" id="2816002">:=</span>&nbsp;<span class="ident" id="2816005"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816020">if</span>&nbsp;<span class="op" id="2816023">!</span><span class="ident" id="2816024"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816030">.</span><span class="ident" id="2816031">explicit</span>&nbsp;<span class="op" id="2816040">&amp;&amp;</span>&nbsp;<span class="ident" id="2816043"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816049">.</span><span class="ident" id="2816050">tag</span>&nbsp;<span class="op" id="2816054">!=</span>&nbsp;<span class="ident" id="2816057">nil</span>&nbsp;<span class="op" id="2816061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816065"><a href="/encoding/asn1/asn1.go.html#2815957">expectedClass</a></span>&nbsp;<span class="op" id="2816079">=</span>&nbsp;<span class="ident" id="2816081"><a href="/encoding/asn1/common.go.html#2824769">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816104"><a href="/encoding/asn1/asn1.go.html#2815990">expectedTag</a></span>&nbsp;<span class="op" id="2816116">=</span>&nbsp;<span class="op" id="2816118">*</span><span class="ident" id="2816119"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816125">.</span><span class="ident" id="2816126">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816131">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816135">if</span>&nbsp;<span class="op" id="2816138">!</span><span class="ident" id="2816139"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816145">.</span><span class="ident" id="2816146">explicit</span>&nbsp;<span class="op" id="2816155">&amp;&amp;</span>&nbsp;<span class="ident" id="2816158"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816164">.</span><span class="ident" id="2816165">application</span>&nbsp;<span class="op" id="2816177">&amp;&amp;</span>&nbsp;<span class="ident" id="2816180"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816186">.</span><span class="ident" id="2816187">tag</span>&nbsp;<span class="op" id="2816191">!=</span>&nbsp;<span class="ident" id="2816194">nil</span>&nbsp;<span class="op" id="2816198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816202"><a href="/encoding/asn1/asn1.go.html#2815957">expectedClass</a></span>&nbsp;<span class="op" id="2816216">=</span>&nbsp;<span class="ident" id="2816218"><a href="/encoding/asn1/common.go.html#2824743">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816237"><a href="/encoding/asn1/asn1.go.html#2815990">expectedTag</a></span>&nbsp;<span class="op" id="2816249">=</span>&nbsp;<span class="op" id="2816251">*</span><span class="ident" id="2816252"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816258">.</span><span class="ident" id="2816259">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816264">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816268">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816326">if</span>&nbsp;<span class="ident" id="2816329"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816330">.</span><span class="ident" id="2816331">class</span>&nbsp;<span class="op" id="2816337">!=</span>&nbsp;<span class="ident" id="2816340"><a href="/encoding/asn1/asn1.go.html#2815957">expectedClass</a></span>&nbsp;<span class="op" id="2816354">||</span>&nbsp;<span class="ident" id="2816357"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816358">.</span><span class="ident" id="2816359">tag</span>&nbsp;<span class="op" id="2816363">!=</span>&nbsp;<span class="ident" id="2816366"><a href="/encoding/asn1/asn1.go.html#2815990">expectedTag</a></span>&nbsp;<span class="op" id="2816378">||</span>&nbsp;<span class="ident" id="2816381"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816382">.</span><span class="ident" id="2816383">isCompound</span>&nbsp;<span class="op" id="2816394">!=</span>&nbsp;<span class="ident" id="2816397"><a href="/encoding/asn1/asn1.go.html#2814175">compoundType</a></span>&nbsp;<span class="op" id="2816410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816414">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816477">ok</span>&nbsp;<span class="op" id="2816480">:=</span>&nbsp;<span class="ident" id="2816483"><a href="/encoding/asn1/asn1.go.html#2820892">setDefaultValue</a></span><span class="op" id="2816498">(</span><span class="ident" id="2816499"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2816500">,</span>&nbsp;<span class="ident" id="2816502"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816508">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816512">if</span>&nbsp;<span class="ident" id="2816515"><a href="/encoding/asn1/asn1.go.html#2816477">ok</a></span>&nbsp;<span class="op" id="2816518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816523"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2816530">=</span>&nbsp;<span class="ident" id="2816532"><a href="/encoding/asn1/asn1.go.html#2812098">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816545">}</span>&nbsp;<span class="keyword" id="2816547">else</span>&nbsp;<span class="op" id="2816552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816557"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2816561">=</span>&nbsp;<span class="ident" id="2816563"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2816578">{</span><span class="ident" id="2816579"><a href="/encoding/asn1/asn1.go.html#2798951">fmt</a></span><span class="op" id="2816582">.</span><span class="ident" id="2816583">Sprintf</span><span class="op" id="2816590">(</span><span class="string" id="2816591">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="2816632">,</span>&nbsp;<span class="ident" id="2816634"><a href="/encoding/asn1/asn1.go.html#2815990">expectedTag</a></span><span class="op" id="2816645">,</span>&nbsp;<span class="ident" id="2816647"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816648">,</span>&nbsp;<span class="ident" id="2816650"><a href="/encoding/asn1/asn1.go.html#2812114">params</a></span><span class="op" id="2816656">,</span>&nbsp;<span class="ident" id="2816658"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><span class="op" id="2816667">.</span><span class="ident" id="2816668">Name</span><span class="op" id="2816672">(</span><span class="op" id="2816673">)</span><span class="op" id="2816674">,</span>&nbsp;<span class="ident" id="2816676"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2816682">)</span><span class="op" id="2816683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816687">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816702">if</span>&nbsp;<span class="ident" id="2816705"><a href="/encoding/asn1/asn1.go.html#2811752">invalidLength</a></span><span class="op" id="2816718">(</span><span class="ident" id="2816719"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2816725">,</span>&nbsp;<span class="ident" id="2816727"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816728">.</span><span class="ident" id="2816729">length</span><span class="op" id="2816735">,</span>&nbsp;<span class="builtinfunc" id="2816737">len</span><span class="op" id="2816740">(</span><span class="ident" id="2816741"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2816746">)</span><span class="op" id="2816747">)</span>&nbsp;<span class="op" id="2816749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816753"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2816757">=</span>&nbsp;<span class="ident" id="2816759"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2816770">{</span><span class="string" id="2816771">&#34;data&nbsp;truncated&#34;</span><span class="op" id="2816787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816791">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816802">innerBytes</span>&nbsp;<span class="op" id="2816813">:=</span>&nbsp;<span class="ident" id="2816816"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2816821">[</span><span class="ident" id="2816822"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2816829">:</span>&nbsp;<span class="ident" id="2816831"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2816837">+</span><span class="ident" id="2816838"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816839">.</span><span class="ident" id="2816840">length</span><span class="op" id="2816846">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816849"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span>&nbsp;<span class="op" id="2816856">+=</span>&nbsp;<span class="ident" id="2816859"><a href="/encoding/asn1/asn1.go.html#2814320">t</a></span><span class="op" id="2816860">.</span><span class="ident" id="2816861">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816870">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816933">switch</span>&nbsp;<span class="ident" id="2816940"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span>&nbsp;<span class="op" id="2816950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816953">case</span>&nbsp;<span class="ident" id="2816958"><a href="/encoding/asn1/asn1.go.html#2811265">objectIdentifierType</a></span><span class="op" id="2816978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816982">newSlice</span><span class="op" id="2816990">,</span>&nbsp;<span class="ident" id="2816992">err1</span>&nbsp;<span class="op" id="2816997">:=</span>&nbsp;<span class="ident" id="2817000"><a href="/encoding/asn1/asn1.go.html#2803567">parseObjectIdentifier</a></span><span class="op" id="2817021">(</span><span class="ident" id="2817022"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817036"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817037">.</span><span class="ident" id="2817038">Set</span><span class="op" id="2817041">(</span><span class="ident" id="2817042"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817049">.</span><span class="ident" id="2817050">MakeSlice</span><span class="op" id="2817059">(</span><span class="ident" id="2817060"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817061">.</span><span class="ident" id="2817062">Type</span><span class="op" id="2817066">(</span><span class="op" id="2817067">)</span><span class="op" id="2817068">,</span>&nbsp;<span class="builtinfunc" id="2817070">len</span><span class="op" id="2817073">(</span><span class="ident" id="2817074"><a href="/encoding/asn1/asn1.go.html#2816982">newSlice</a></span><span class="op" id="2817082">)</span><span class="op" id="2817083">,</span>&nbsp;<span class="builtinfunc" id="2817085">len</span><span class="op" id="2817088">(</span><span class="ident" id="2817089"><a href="/encoding/asn1/asn1.go.html#2816982">newSlice</a></span><span class="op" id="2817097">)</span><span class="op" id="2817098">)</span><span class="op" id="2817099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817103">if</span>&nbsp;<span class="ident" id="2817106"><a href="/encoding/asn1/asn1.go.html#2816992">err1</a></span>&nbsp;<span class="op" id="2817111">==</span>&nbsp;<span class="ident" id="2817114">nil</span>&nbsp;<span class="op" id="2817118">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817123"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817130">.</span><span class="ident" id="2817131">Copy</span><span class="op" id="2817135">(</span><span class="ident" id="2817136"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817137">,</span>&nbsp;<span class="ident" id="2817139"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817146">.</span><span class="ident" id="2817147">ValueOf</span><span class="op" id="2817154">(</span><span class="ident" id="2817155"><a href="/encoding/asn1/asn1.go.html#2816982">newSlice</a></span><span class="op" id="2817163">)</span><span class="op" id="2817164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817172"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2817176">=</span>&nbsp;<span class="ident" id="2817178"><a href="/encoding/asn1/asn1.go.html#2816992">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817185">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817193">case</span>&nbsp;<span class="ident" id="2817198"><a href="/encoding/asn1/asn1.go.html#2811213">bitStringType</a></span><span class="op" id="2817211">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817215">bs</span><span class="op" id="2817217">,</span>&nbsp;<span class="ident" id="2817219">err1</span>&nbsp;<span class="op" id="2817224">:=</span>&nbsp;<span class="ident" id="2817227"><a href="/encoding/asn1/asn1.go.html#2802397">parseBitString</a></span><span class="op" id="2817241">(</span><span class="ident" id="2817242"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817256">if</span>&nbsp;<span class="ident" id="2817259"><a href="/encoding/asn1/asn1.go.html#2817219">err1</a></span>&nbsp;<span class="op" id="2817264">==</span>&nbsp;<span class="ident" id="2817267">nil</span>&nbsp;<span class="op" id="2817271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817276"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817277">.</span><span class="ident" id="2817278">Set</span><span class="op" id="2817281">(</span><span class="ident" id="2817282"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817289">.</span><span class="ident" id="2817290">ValueOf</span><span class="op" id="2817297">(</span><span class="ident" id="2817298"><a href="/encoding/asn1/asn1.go.html#2817215">bs</a></span><span class="op" id="2817300">)</span><span class="op" id="2817301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817309"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2817313">=</span>&nbsp;<span class="ident" id="2817315"><a href="/encoding/asn1/asn1.go.html#2817219">err1</a></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817330">case</span>&nbsp;<span class="ident" id="2817335"><a href="/encoding/asn1/asn1.go.html#2811430">timeType</a></span><span class="op" id="2817343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817347">var</span>&nbsp;<span class="ident" id="2817351">time</span>&nbsp;<span class="ident" id="2817356"><a href="/encoding/asn1/asn1.go.html#2798992">time</a></span><span class="op" id="2817360">.</span><span class="ident" id="2817361">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817368">var</span>&nbsp;<span class="ident" id="2817372">err1</span>&nbsp;<span class="builtintype" id="2817377">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817385">if</span>&nbsp;<span class="ident" id="2817388"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2817401">==</span>&nbsp;<span class="ident" id="2817404"><a href="/encoding/asn1/common.go.html#2824631">tagUTCTime</a></span>&nbsp;<span class="op" id="2817415">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817420"><a href="/encoding/asn1/asn1.go.html#2817351">time</a></span><span class="op" id="2817424">,</span>&nbsp;<span class="ident" id="2817426"><a href="/encoding/asn1/asn1.go.html#2817372">err1</a></span>&nbsp;<span class="op" id="2817431">=</span>&nbsp;<span class="ident" id="2817433"><a href="/encoding/asn1/asn1.go.html#2805179">parseUTCTime</a></span><span class="op" id="2817445">(</span><span class="ident" id="2817446"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817460">}</span>&nbsp;<span class="keyword" id="2817462">else</span>&nbsp;<span class="op" id="2817467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817472"><a href="/encoding/asn1/asn1.go.html#2817351">time</a></span><span class="op" id="2817476">,</span>&nbsp;<span class="ident" id="2817478"><a href="/encoding/asn1/asn1.go.html#2817372">err1</a></span>&nbsp;<span class="op" id="2817483">=</span>&nbsp;<span class="ident" id="2817485"><a href="/encoding/asn1/asn1.go.html#2805676">parseGeneralizedTime</a></span><span class="op" id="2817505">(</span><span class="ident" id="2817506"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817524">if</span>&nbsp;<span class="ident" id="2817527"><a href="/encoding/asn1/asn1.go.html#2817372">err1</a></span>&nbsp;<span class="op" id="2817532">==</span>&nbsp;<span class="ident" id="2817535">nil</span>&nbsp;<span class="op" id="2817539">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817544"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817545">.</span><span class="ident" id="2817546">Set</span><span class="op" id="2817549">(</span><span class="ident" id="2817550"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817557">.</span><span class="ident" id="2817558">ValueOf</span><span class="op" id="2817565">(</span><span class="ident" id="2817566"><a href="/encoding/asn1/asn1.go.html#2817351">time</a></span><span class="op" id="2817570">)</span><span class="op" id="2817571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817579"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2817583">=</span>&nbsp;<span class="ident" id="2817585"><a href="/encoding/asn1/asn1.go.html#2817372">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817592">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817600">case</span>&nbsp;<span class="ident" id="2817605"><a href="/encoding/asn1/asn1.go.html#2811324">enumeratedType</a></span><span class="op" id="2817619">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817623">parsedInt</span><span class="op" id="2817632">,</span>&nbsp;<span class="ident" id="2817634">err1</span>&nbsp;<span class="op" id="2817639">:=</span>&nbsp;<span class="ident" id="2817642"><a href="/encoding/asn1/asn1.go.html#2800583">parseInt32</a></span><span class="op" id="2817652">(</span><span class="ident" id="2817653"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817667">if</span>&nbsp;<span class="ident" id="2817670"><a href="/encoding/asn1/asn1.go.html#2817634">err1</a></span>&nbsp;<span class="op" id="2817675">==</span>&nbsp;<span class="ident" id="2817678">nil</span>&nbsp;<span class="op" id="2817682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817687"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817688">.</span><span class="ident" id="2817689">SetInt</span><span class="op" id="2817695">(</span><span class="ident" id="2817696">int64</span><span class="op" id="2817701">(</span><span class="ident" id="2817702"><a href="/encoding/asn1/asn1.go.html#2817623">parsedInt</a></span><span class="op" id="2817711">)</span><span class="op" id="2817712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817720"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2817724">=</span>&nbsp;<span class="ident" id="2817726"><a href="/encoding/asn1/asn1.go.html#2817634">err1</a></span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817733">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817741">case</span>&nbsp;<span class="ident" id="2817746"><a href="/encoding/asn1/asn1.go.html#2811378">flagType</a></span><span class="op" id="2817754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817758"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817759">.</span><span class="ident" id="2817760">SetBool</span><span class="op" id="2817767">(</span><span class="ident" id="2817768">true</span><span class="op" id="2817772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817776">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817784">case</span>&nbsp;<span class="ident" id="2817789"><a href="/encoding/asn1/asn1.go.html#2811589">bigIntType</a></span><span class="op" id="2817799">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817803">parsedInt</span>&nbsp;<span class="op" id="2817813">:=</span>&nbsp;<span class="ident" id="2817816"><a href="/encoding/asn1/asn1.go.html#2800940">parseBigInt</a></span><span class="op" id="2817827">(</span><span class="ident" id="2817828"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817842"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817843">.</span><span class="ident" id="2817844">Set</span><span class="op" id="2817847">(</span><span class="ident" id="2817848"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817855">.</span><span class="ident" id="2817856">ValueOf</span><span class="op" id="2817863">(</span><span class="ident" id="2817864"><a href="/encoding/asn1/asn1.go.html#2817803">parsedInt</a></span><span class="op" id="2817873">)</span><span class="op" id="2817874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817878">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817889">switch</span>&nbsp;<span class="ident" id="2817896">val</span>&nbsp;<span class="op" id="2817900">:=</span>&nbsp;<span class="ident" id="2817903"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2817904">;</span>&nbsp;<span class="ident" id="2817906"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2817909">.</span><span class="ident" id="2817910">Kind</span><span class="op" id="2817914">(</span><span class="op" id="2817915">)</span>&nbsp;<span class="op" id="2817917">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817920">case</span>&nbsp;<span class="ident" id="2817925"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2817932">.</span><span class="ident" id="2817933">Bool</span><span class="op" id="2817937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817941">parsedBool</span><span class="op" id="2817951">,</span>&nbsp;<span class="ident" id="2817953">err1</span>&nbsp;<span class="op" id="2817958">:=</span>&nbsp;<span class="ident" id="2817961"><a href="/encoding/asn1/asn1.go.html#2799510">parseBool</a></span><span class="op" id="2817970">(</span><span class="ident" id="2817971"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2817981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817985">if</span>&nbsp;<span class="ident" id="2817988"><a href="/encoding/asn1/asn1.go.html#2817953">err1</a></span>&nbsp;<span class="op" id="2817993">==</span>&nbsp;<span class="ident" id="2817996">nil</span>&nbsp;<span class="op" id="2818000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818005"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818008">.</span><span class="ident" id="2818009">SetBool</span><span class="op" id="2818016">(</span><span class="ident" id="2818017"><a href="/encoding/asn1/asn1.go.html#2817941">parsedBool</a></span><span class="op" id="2818027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818031">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818035"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2818039">=</span>&nbsp;<span class="ident" id="2818041"><a href="/encoding/asn1/asn1.go.html#2817953">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818048">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818056">case</span>&nbsp;<span class="ident" id="2818061"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2818068">.</span><span class="ident" id="2818069">Int</span><span class="op" id="2818072">,</span>&nbsp;<span class="ident" id="2818074"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2818081">.</span><span class="ident" id="2818082">Int32</span><span class="op" id="2818087">,</span>&nbsp;<span class="ident" id="2818089"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2818096">.</span><span class="ident" id="2818097">Int64</span><span class="op" id="2818102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818106">if</span>&nbsp;<span class="ident" id="2818109"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818112">.</span><span class="ident" id="2818113">Type</span><span class="op" id="2818117">(</span><span class="op" id="2818118">)</span><span class="op" id="2818119">.</span><span class="ident" id="2818120">Size</span><span class="op" id="2818124">(</span><span class="op" id="2818125">)</span>&nbsp;<span class="op" id="2818127">==</span>&nbsp;<span class="num" id="2818130">4</span>&nbsp;<span class="op" id="2818132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818137">parsedInt</span><span class="op" id="2818146">,</span>&nbsp;<span class="ident" id="2818148">err1</span>&nbsp;<span class="op" id="2818153">:=</span>&nbsp;<span class="ident" id="2818156"><a href="/encoding/asn1/asn1.go.html#2800583">parseInt32</a></span><span class="op" id="2818166">(</span><span class="ident" id="2818167"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2818177">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818182">if</span>&nbsp;<span class="ident" id="2818185"><a href="/encoding/asn1/asn1.go.html#2818148">err1</a></span>&nbsp;<span class="op" id="2818190">==</span>&nbsp;<span class="ident" id="2818193">nil</span>&nbsp;<span class="op" id="2818197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818203"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818206">.</span><span class="ident" id="2818207">SetInt</span><span class="op" id="2818213">(</span><span class="ident" id="2818214">int64</span><span class="op" id="2818219">(</span><span class="ident" id="2818220"><a href="/encoding/asn1/asn1.go.html#2818137">parsedInt</a></span><span class="op" id="2818229">)</span><span class="op" id="2818230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818240"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2818244">=</span>&nbsp;<span class="ident" id="2818246"><a href="/encoding/asn1/asn1.go.html#2818148">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818253">}</span>&nbsp;<span class="keyword" id="2818255">else</span>&nbsp;<span class="op" id="2818260">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818265">parsedInt</span><span class="op" id="2818274">,</span>&nbsp;<span class="ident" id="2818276">err1</span>&nbsp;<span class="op" id="2818281">:=</span>&nbsp;<span class="ident" id="2818284"><a href="/encoding/asn1/asn1.go.html#2800068">parseInt64</a></span><span class="op" id="2818294">(</span><span class="ident" id="2818295"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2818305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818310">if</span>&nbsp;<span class="ident" id="2818313"><a href="/encoding/asn1/asn1.go.html#2818276">err1</a></span>&nbsp;<span class="op" id="2818318">==</span>&nbsp;<span class="ident" id="2818321">nil</span>&nbsp;<span class="op" id="2818325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818331"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818334">.</span><span class="ident" id="2818335">SetInt</span><span class="op" id="2818341">(</span><span class="ident" id="2818342"><a href="/encoding/asn1/asn1.go.html#2818265">parsedInt</a></span><span class="op" id="2818351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818361"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2818365">=</span>&nbsp;<span class="ident" id="2818367"><a href="/encoding/asn1/asn1.go.html#2818276">err1</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818378">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818386">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818444">case</span>&nbsp;<span class="ident" id="2818449"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2818456">.</span><span class="ident" id="2818457">Struct</span><span class="op" id="2818463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818467">structType</span>&nbsp;<span class="op" id="2818478">:=</span>&nbsp;<span class="ident" id="2818481"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818494">if</span>&nbsp;<span class="ident" id="2818497"><a href="/encoding/asn1/asn1.go.html#2818467">structType</a></span><span class="op" id="2818507">.</span><span class="ident" id="2818508">NumField</span><span class="op" id="2818516">(</span><span class="op" id="2818517">)</span>&nbsp;<span class="op" id="2818519">&gt;</span>&nbsp;<span class="num" id="2818521">0</span>&nbsp;<span class="op" id="2818523">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818529"><a href="/encoding/asn1/asn1.go.html#2818467">structType</a></span><span class="op" id="2818539">.</span><span class="ident" id="2818540">Field</span><span class="op" id="2818545">(</span><span class="num" id="2818546">0</span><span class="op" id="2818547">)</span><span class="op" id="2818548">.</span><span class="ident" id="2818549">Type</span>&nbsp;<span class="op" id="2818554">==</span>&nbsp;<span class="ident" id="2818557"><a href="/encoding/asn1/asn1.go.html#2811533">rawContentsType</a></span>&nbsp;<span class="op" id="2818573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818578">bytes</span>&nbsp;<span class="op" id="2818584">:=</span>&nbsp;<span class="ident" id="2818587"><a href="/encoding/asn1/asn1.go.html#2812084">bytes</a></span><span class="op" id="2818592">[</span><span class="ident" id="2818593"><a href="/encoding/asn1/asn1.go.html#2812098">initOffset</a></span><span class="op" id="2818603">:</span><span class="ident" id="2818604"><a href="/encoding/asn1/asn1.go.html#2812139">offset</a></span><span class="op" id="2818610">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818615"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818618">.</span><span class="ident" id="2818619">Field</span><span class="op" id="2818624">(</span><span class="num" id="2818625">0</span><span class="op" id="2818626">)</span><span class="op" id="2818627">.</span><span class="ident" id="2818628">Set</span><span class="op" id="2818631">(</span><span class="ident" id="2818632"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2818639">.</span><span class="ident" id="2818640">ValueOf</span><span class="op" id="2818647">(</span><span class="ident" id="2818648"><a href="/encoding/asn1/asn1.go.html#2807811">RawContent</a></span><span class="op" id="2818658">(</span><span class="ident" id="2818659"><a href="/encoding/asn1/asn1.go.html#2818578">bytes</a></span><span class="op" id="2818664">)</span><span class="op" id="2818665">)</span><span class="op" id="2818666">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818675">innerOffset</span>&nbsp;<span class="op" id="2818687">:=</span>&nbsp;<span class="num" id="2818690">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818694">for</span>&nbsp;<span class="ident" id="2818698">i</span>&nbsp;<span class="op" id="2818700">:=</span>&nbsp;<span class="num" id="2818703">0</span><span class="op" id="2818704">;</span>&nbsp;<span class="ident" id="2818706"><a href="/encoding/asn1/asn1.go.html#2818698">i</a></span>&nbsp;<span class="op" id="2818708">&lt;</span>&nbsp;<span class="ident" id="2818710"><a href="/encoding/asn1/asn1.go.html#2818467">structType</a></span><span class="op" id="2818720">.</span><span class="ident" id="2818721">NumField</span><span class="op" id="2818729">(</span><span class="op" id="2818730">)</span><span class="op" id="2818731">;</span>&nbsp;<span class="ident" id="2818733"><a href="/encoding/asn1/asn1.go.html#2818698">i</a></span><span class="op" id="2818734">++</span>&nbsp;<span class="op" id="2818737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818742">field</span>&nbsp;<span class="op" id="2818748">:=</span>&nbsp;<span class="ident" id="2818751"><a href="/encoding/asn1/asn1.go.html#2818467">structType</a></span><span class="op" id="2818761">.</span><span class="ident" id="2818762">Field</span><span class="op" id="2818767">(</span><span class="ident" id="2818768"><a href="/encoding/asn1/asn1.go.html#2818698">i</a></span><span class="op" id="2818769">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818774">if</span>&nbsp;<span class="ident" id="2818777"><a href="/encoding/asn1/asn1.go.html#2818698">i</a></span>&nbsp;<span class="op" id="2818779">==</span>&nbsp;<span class="num" id="2818782">0</span>&nbsp;<span class="op" id="2818784">&amp;&amp;</span>&nbsp;<span class="ident" id="2818787"><a href="/encoding/asn1/asn1.go.html#2818742">field</a></span><span class="op" id="2818792">.</span><span class="ident" id="2818793">Type</span>&nbsp;<span class="op" id="2818798">==</span>&nbsp;<span class="ident" id="2818801"><a href="/encoding/asn1/asn1.go.html#2811533">rawContentsType</a></span>&nbsp;<span class="op" id="2818817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818823">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818840"><a href="/encoding/asn1/asn1.go.html#2818675">innerOffset</a></span><span class="op" id="2818851">,</span>&nbsp;<span class="ident" id="2818853"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2818857">=</span>&nbsp;<span class="ident" id="2818859"><a href="/encoding/asn1/asn1.go.html#2812056">parseField</a></span><span class="op" id="2818869">(</span><span class="ident" id="2818870"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2818873">.</span><span class="ident" id="2818874">Field</span><span class="op" id="2818879">(</span><span class="ident" id="2818880"><a href="/encoding/asn1/asn1.go.html#2818698">i</a></span><span class="op" id="2818881">)</span><span class="op" id="2818882">,</span>&nbsp;<span class="ident" id="2818884"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2818894">,</span>&nbsp;<span class="ident" id="2818896"><a href="/encoding/asn1/asn1.go.html#2818675">innerOffset</a></span><span class="op" id="2818907">,</span>&nbsp;<span class="ident" id="2818909"><a href="/encoding/asn1/common.go.html#2826696">parseFieldParameters</a></span><span class="op" id="2818929">(</span><span class="ident" id="2818930"><a href="/encoding/asn1/asn1.go.html#2818742">field</a></span><span class="op" id="2818935">.</span><span class="ident" id="2818936">Tag</span><span class="op" id="2818939">.</span><span class="ident" id="2818940">Get</span><span class="op" id="2818943">(</span><span class="string" id="2818944">&#34;asn1&#34;</span><span class="op" id="2818950">)</span><span class="op" id="2818951">)</span><span class="op" id="2818952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818957">if</span>&nbsp;<span class="ident" id="2818960"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2818964">!=</span>&nbsp;<span class="ident" id="2818967">nil</span>&nbsp;<span class="op" id="2818971">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818977">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818995">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819056">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819118">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819163">case</span>&nbsp;<span class="ident" id="2819168"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819175">.</span><span class="ident" id="2819176">Slice</span><span class="op" id="2819181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819185">sliceType</span>&nbsp;<span class="op" id="2819195">:=</span>&nbsp;<span class="ident" id="2819198"><a href="/encoding/asn1/asn1.go.html#2812186">fieldType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819210">if</span>&nbsp;<span class="ident" id="2819213"><a href="/encoding/asn1/asn1.go.html#2819185">sliceType</a></span><span class="op" id="2819222">.</span><span class="ident" id="2819223">Elem</span><span class="op" id="2819227">(</span><span class="op" id="2819228">)</span><span class="op" id="2819229">.</span><span class="ident" id="2819230">Kind</span><span class="op" id="2819234">(</span><span class="op" id="2819235">)</span>&nbsp;<span class="op" id="2819237">==</span>&nbsp;<span class="ident" id="2819240"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819247">.</span><span class="ident" id="2819248">Uint8</span>&nbsp;<span class="op" id="2819254">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819259"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2819262">.</span><span class="ident" id="2819263">Set</span><span class="op" id="2819266">(</span><span class="ident" id="2819267"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819274">.</span><span class="ident" id="2819275">MakeSlice</span><span class="op" id="2819284">(</span><span class="ident" id="2819285"><a href="/encoding/asn1/asn1.go.html#2819185">sliceType</a></span><span class="op" id="2819294">,</span>&nbsp;<span class="builtinfunc" id="2819296">len</span><span class="op" id="2819299">(</span><span class="ident" id="2819300"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819310">)</span><span class="op" id="2819311">,</span>&nbsp;<span class="builtinfunc" id="2819313">len</span><span class="op" id="2819316">(</span><span class="ident" id="2819317"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819327">)</span><span class="op" id="2819328">)</span><span class="op" id="2819329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819334"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819341">.</span><span class="ident" id="2819342">Copy</span><span class="op" id="2819346">(</span><span class="ident" id="2819347"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2819350">,</span>&nbsp;<span class="ident" id="2819352"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819359">.</span><span class="ident" id="2819360">ValueOf</span><span class="op" id="2819367">(</span><span class="ident" id="2819368"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819378">)</span><span class="op" id="2819379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819384">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819397">newSlice</span><span class="op" id="2819405">,</span>&nbsp;<span class="ident" id="2819407">err1</span>&nbsp;<span class="op" id="2819412">:=</span>&nbsp;<span class="ident" id="2819415"><a href="/encoding/asn1/asn1.go.html#2809744">parseSequenceOf</a></span><span class="op" id="2819430">(</span><span class="ident" id="2819431"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819441">,</span>&nbsp;<span class="ident" id="2819443"><a href="/encoding/asn1/asn1.go.html#2819185">sliceType</a></span><span class="op" id="2819452">,</span>&nbsp;<span class="ident" id="2819454"><a href="/encoding/asn1/asn1.go.html#2819185">sliceType</a></span><span class="op" id="2819463">.</span><span class="ident" id="2819464">Elem</span><span class="op" id="2819468">(</span><span class="op" id="2819469">)</span><span class="op" id="2819470">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819474">if</span>&nbsp;<span class="ident" id="2819477"><a href="/encoding/asn1/asn1.go.html#2819407">err1</a></span>&nbsp;<span class="op" id="2819482">==</span>&nbsp;<span class="ident" id="2819485">nil</span>&nbsp;<span class="op" id="2819489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819494"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2819497">.</span><span class="ident" id="2819498">Set</span><span class="op" id="2819501">(</span><span class="ident" id="2819502"><a href="/encoding/asn1/asn1.go.html#2819397">newSlice</a></span><span class="op" id="2819510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819518"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2819522">=</span>&nbsp;<span class="ident" id="2819524"><a href="/encoding/asn1/asn1.go.html#2819407">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819531">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819539">case</span>&nbsp;<span class="ident" id="2819544"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2819551">.</span><span class="ident" id="2819552">String</span><span class="op" id="2819558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819562">var</span>&nbsp;<span class="ident" id="2819566">v</span>&nbsp;<span class="builtintype" id="2819568">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819577">switch</span>&nbsp;<span class="ident" id="2819584"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span>&nbsp;<span class="op" id="2819597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819601">case</span>&nbsp;<span class="ident" id="2819606"><a href="/encoding/asn1/common.go.html#2824556">tagPrintableString</a></span><span class="op" id="2819624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819629"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2819630">,</span>&nbsp;<span class="ident" id="2819632"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2819636">=</span>&nbsp;<span class="ident" id="2819638"><a href="/encoding/asn1/asn1.go.html#2805925">parsePrintableString</a></span><span class="op" id="2819658">(</span><span class="ident" id="2819659"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819669">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819673">case</span>&nbsp;<span class="ident" id="2819678"><a href="/encoding/asn1/common.go.html#2824606">tagIA5String</a></span><span class="op" id="2819690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819695"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2819696">,</span>&nbsp;<span class="ident" id="2819698"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2819702">=</span>&nbsp;<span class="ident" id="2819704"><a href="/encoding/asn1/asn1.go.html#2806770">parseIA5String</a></span><span class="op" id="2819718">(</span><span class="ident" id="2819719"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819733">case</span>&nbsp;<span class="ident" id="2819738"><a href="/encoding/asn1/common.go.html#2824581">tagT61String</a></span><span class="op" id="2819750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819755"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2819756">,</span>&nbsp;<span class="ident" id="2819758"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2819762">=</span>&nbsp;<span class="ident" id="2819764"><a href="/encoding/asn1/asn1.go.html#2807107">parseT61String</a></span><span class="op" id="2819778">(</span><span class="ident" id="2819779"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819793">case</span>&nbsp;<span class="ident" id="2819798"><a href="/encoding/asn1/common.go.html#2824481">tagUTF8String</a></span><span class="op" id="2819811">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819816"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2819817">,</span>&nbsp;<span class="ident" id="2819819"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2819823">=</span>&nbsp;<span class="ident" id="2819825"><a href="/encoding/asn1/asn1.go.html#2807314">parseUTF8String</a></span><span class="op" id="2819840">(</span><span class="ident" id="2819841"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2819851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819855">case</span>&nbsp;<span class="ident" id="2819860"><a href="/encoding/asn1/common.go.html#2824681">tagGeneralString</a></span><span class="op" id="2819876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819881">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819935">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819993">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2820047">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820102"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2820103">,</span>&nbsp;<span class="ident" id="2820105"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2820109">=</span>&nbsp;<span class="ident" id="2820111"><a href="/encoding/asn1/asn1.go.html#2807107">parseT61String</a></span><span class="op" id="2820125">(</span><span class="ident" id="2820126"><a href="/encoding/asn1/asn1.go.html#2816802">innerBytes</a></span><span class="op" id="2820136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820140">default</span><span class="op" id="2820147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820152"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2820156">=</span>&nbsp;<span class="ident" id="2820158"><a href="/encoding/asn1/asn1.go.html#2799312">SyntaxError</a></span><span class="op" id="2820169">{</span><span class="ident" id="2820170"><a href="/encoding/asn1/asn1.go.html#2798951">fmt</a></span><span class="op" id="2820173">.</span><span class="ident" id="2820174">Sprintf</span><span class="op" id="2820181">(</span><span class="string" id="2820182">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="2820222">,</span>&nbsp;<span class="ident" id="2820224"><a href="/encoding/asn1/asn1.go.html#2814161">universalTag</a></span><span class="op" id="2820236">)</span><span class="op" id="2820237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820241">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820245">if</span>&nbsp;<span class="ident" id="2820248"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2820252">==</span>&nbsp;<span class="ident" id="2820255">nil</span>&nbsp;<span class="op" id="2820259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820264"><a href="/encoding/asn1/asn1.go.html#2817896">val</a></span><span class="op" id="2820267">.</span><span class="ident" id="2820268">SetString</span><span class="op" id="2820277">(</span><span class="ident" id="2820278"><a href="/encoding/asn1/asn1.go.html#2819566">v</a></span><span class="op" id="2820279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820295">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820298"><a href="/encoding/asn1/asn1.go.html#2812151">err</a></span>&nbsp;<span class="op" id="2820302">=</span>&nbsp;<span class="ident" id="2820304"><a href="/encoding/asn1/asn1.go.html#2799123">StructuralError</a></span><span class="op" id="2820319">{</span><span class="string" id="2820320">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="2820336">+</span>&nbsp;<span class="ident" id="2820338"><a href="/encoding/asn1/asn1.go.html#2812067">v</a></span><span class="op" id="2820339">.</span><span class="ident" id="2820340">Type</span><span class="op" id="2820344">(</span><span class="op" id="2820345">)</span><span class="op" id="2820346">.</span><span class="ident" id="2820347">String</span><span class="op" id="2820353">(</span><span class="op" id="2820354">)</span><span class="op" id="2820355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820358">return</span><br>
<span class="lineno"></span><span class="op" id="2820365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2820368">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="2820446">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="2820493">func</span>&nbsp;<span class="ident" id="2820498">canHaveDefaultValue</span><span class="op" id="2820517">(</span><span class="ident" id="2820518">k</span>&nbsp;<span class="ident" id="2820520"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820527">.</span><span class="ident" id="2820528">Kind</span><span class="op" id="2820532">)</span>&nbsp;<span class="builtintype" id="2820534">bool</span>&nbsp;<span class="op" id="2820539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820542">switch</span>&nbsp;<span class="ident" id="2820549"><a href="/encoding/asn1/asn1.go.html#2820518">k</a></span>&nbsp;<span class="op" id="2820551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820554">case</span>&nbsp;<span class="ident" id="2820559"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820566">.</span><span class="ident" id="2820567">Int</span><span class="op" id="2820570">,</span>&nbsp;<span class="ident" id="2820572"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820579">.</span><span class="ident" id="2820580">Int8</span><span class="op" id="2820584">,</span>&nbsp;<span class="ident" id="2820586"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820593">.</span><span class="ident" id="2820594">Int16</span><span class="op" id="2820599">,</span>&nbsp;<span class="ident" id="2820601"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820608">.</span><span class="ident" id="2820609">Int32</span><span class="op" id="2820614">,</span>&nbsp;<span class="ident" id="2820616"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820623">.</span><span class="ident" id="2820624">Int64</span><span class="op" id="2820629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820633">return</span>&nbsp;<span class="ident" id="2820640">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820650">return</span>&nbsp;<span class="ident" id="2820657">false</span><br>
<span class="lineno"></span><span class="op" id="2820663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="2820666">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="2820745">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2820825">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="2820887">func</span>&nbsp;<span class="ident" id="2820892">setDefaultValue</span><span class="op" id="2820907">(</span><span class="ident" id="2820908">v</span>&nbsp;<span class="ident" id="2820910"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2820917">.</span><span class="ident" id="2820918">Value</span><span class="op" id="2820923">,</span>&nbsp;<span class="ident" id="2820925">params</span>&nbsp;<span class="ident" id="2820932"><a href="/encoding/asn1/common.go.html#2825887">fieldParameters</a></span><span class="op" id="2820947">)</span>&nbsp;<span class="op" id="2820949">(</span><span class="ident" id="2820950">ok</span>&nbsp;<span class="builtintype" id="2820953">bool</span><span class="op" id="2820957">)</span>&nbsp;<span class="op" id="2820959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820962">if</span>&nbsp;<span class="op" id="2820965">!</span><span class="ident" id="2820966"><a href="/encoding/asn1/asn1.go.html#2820925">params</a></span><span class="op" id="2820972">.</span><span class="ident" id="2820973">optional</span>&nbsp;<span class="op" id="2820982">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820986">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820997"><a href="/encoding/asn1/asn1.go.html#2820950">ok</a></span>&nbsp;<span class="op" id="2821000">=</span>&nbsp;<span class="ident" id="2821002">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821008">if</span>&nbsp;<span class="ident" id="2821011"><a href="/encoding/asn1/asn1.go.html#2820925">params</a></span><span class="op" id="2821017">.</span><span class="ident" id="2821018">defaultValue</span>&nbsp;<span class="op" id="2821031">==</span>&nbsp;<span class="ident" id="2821034">nil</span>&nbsp;<span class="op" id="2821038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821042">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821053">if</span>&nbsp;<span class="ident" id="2821056"><a href="/encoding/asn1/asn1.go.html#2820498">canHaveDefaultValue</a></span><span class="op" id="2821075">(</span><span class="ident" id="2821076"><a href="/encoding/asn1/asn1.go.html#2820908">v</a></span><span class="op" id="2821077">.</span><span class="ident" id="2821078">Kind</span><span class="op" id="2821082">(</span><span class="op" id="2821083">)</span><span class="op" id="2821084">)</span>&nbsp;<span class="op" id="2821086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821090"><a href="/encoding/asn1/asn1.go.html#2820908">v</a></span><span class="op" id="2821091">.</span><span class="ident" id="2821092">SetInt</span><span class="op" id="2821098">(</span><span class="op" id="2821099">*</span><span class="ident" id="2821100"><a href="/encoding/asn1/asn1.go.html#2820925">params</a></span><span class="op" id="2821106">.</span><span class="ident" id="2821107">defaultValue</span><span class="op" id="2821119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821125">return</span><br>
<span class="lineno">855</span><span class="op" id="2821132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2821135">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="2821194">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="2821275">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="2821334">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="2821387">//</span><br>
<span class="lineno"></span><span class="comment" id="2821390">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="2821450">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="2821494">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="2821547">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="2821583">//</span><br>
<span class="lineno"></span><span class="comment" id="2821586">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="2821640">//</span><br>
<span class="lineno"></span><span class="comment" id="2821643">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="2821696">//</span><br>
<span class="lineno"></span><span class="comment" id="2821699">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2821750">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="2821771">//</span><br>
<span class="lineno"></span><span class="comment" id="2821774">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="2821830">//</span><br>
<span class="lineno"></span><span class="comment" id="2821833">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="2821903">//</span><br>
<span class="lineno"></span><span class="comment" id="2821906">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2821975">//</span><br>
<span class="lineno">880</span><span class="comment" id="2821978">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2822045">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2822113">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="2822150">//</span><br>
<span class="lineno"></span><span class="comment" id="2822153">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="2822206">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2822272">//</span><br>
<span class="lineno"></span><span class="comment" id="2822275">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="2822330">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2822380">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="2822435">//</span><br>
<span class="lineno"></span><span class="comment" id="2822438">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="2822512">//</span><br>
<span class="lineno"></span><span class="comment" id="2822515">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="2822571">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="2822635">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2822713">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="2822759">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="2822824">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="2822897">//</span><br>
<span class="lineno">900</span><span class="comment" id="2822900">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="2822976">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2823029">//</span><br>
<span class="lineno"></span><span class="comment" id="2823032">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2823111">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="2823187">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="2823218">//</span><br>
<span class="lineno"></span><span class="comment" id="2823221">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="2823284">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2823320">func</span>&nbsp;<span class="ident" id="2823325">Unmarshal</span><span class="op" id="2823334">(</span><span class="ident" id="2823335">b</span>&nbsp;<span class="op" id="2823337">[</span><span class="op" id="2823338">]</span><span class="builtintype" id="2823339">byte</span><span class="op" id="2823343">,</span>&nbsp;<span class="ident" id="2823345">val</span>&nbsp;<span class="keyword" id="2823349">interface</span><span class="op" id="2823358">{</span><span class="op" id="2823359">}</span><span class="op" id="2823360">)</span>&nbsp;<span class="op" id="2823362">(</span><span class="ident" id="2823363">rest</span>&nbsp;<span class="op" id="2823368">[</span><span class="op" id="2823369">]</span><span class="builtintype" id="2823370">byte</span><span class="op" id="2823374">,</span>&nbsp;<span class="ident" id="2823376">err</span>&nbsp;<span class="builtintype" id="2823380">error</span><span class="op" id="2823385">)</span>&nbsp;<span class="op" id="2823387">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823390">return</span>&nbsp;<span class="ident" id="2823397"><a href="/encoding/asn1/asn1.go.html#2823584">UnmarshalWithParams</a></span><span class="op" id="2823416">(</span><span class="ident" id="2823417"><a href="/encoding/asn1/asn1.go.html#2823335">b</a></span><span class="op" id="2823418">,</span>&nbsp;<span class="ident" id="2823420"><a href="/encoding/asn1/asn1.go.html#2823345">val</a></span><span class="op" id="2823423">,</span>&nbsp;<span class="string" id="2823425">&#34;&#34;</span><span class="op" id="2823427">)</span><br>
<span class="lineno"></span><span class="op" id="2823429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823432">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2823503">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="2823579">func</span>&nbsp;<span class="ident" id="2823584">UnmarshalWithParams</span><span class="op" id="2823603">(</span><span class="ident" id="2823604">b</span>&nbsp;<span class="op" id="2823606">[</span><span class="op" id="2823607">]</span><span class="builtintype" id="2823608">byte</span><span class="op" id="2823612">,</span>&nbsp;<span class="ident" id="2823614">val</span>&nbsp;<span class="keyword" id="2823618">interface</span><span class="op" id="2823627">{</span><span class="op" id="2823628">}</span><span class="op" id="2823629">,</span>&nbsp;<span class="ident" id="2823631">params</span>&nbsp;<span class="builtintype" id="2823638">string</span><span class="op" id="2823644">)</span>&nbsp;<span class="op" id="2823646">(</span><span class="ident" id="2823647">rest</span>&nbsp;<span class="op" id="2823652">[</span><span class="op" id="2823653">]</span><span class="builtintype" id="2823654">byte</span><span class="op" id="2823658">,</span>&nbsp;<span class="ident" id="2823660">err</span>&nbsp;<span class="builtintype" id="2823664">error</span><span class="op" id="2823669">)</span>&nbsp;<span class="op" id="2823671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823674">v</span>&nbsp;<span class="op" id="2823676">:=</span>&nbsp;<span class="ident" id="2823679"><a href="/encoding/asn1/asn1.go.html#2798970">reflect</a></span><span class="op" id="2823686">.</span><span class="ident" id="2823687">ValueOf</span><span class="op" id="2823694">(</span><span class="ident" id="2823695"><a href="/encoding/asn1/asn1.go.html#2823614">val</a></span><span class="op" id="2823698">)</span><span class="op" id="2823699">.</span><span class="ident" id="2823700">Elem</span><span class="op" id="2823704">(</span><span class="op" id="2823705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823708">offset</span><span class="op" id="2823714">,</span>&nbsp;<span class="ident" id="2823716"><a href="/encoding/asn1/asn1.go.html#2823660">err</a></span>&nbsp;<span class="op" id="2823720">:=</span>&nbsp;<span class="ident" id="2823723"><a href="/encoding/asn1/asn1.go.html#2812056">parseField</a></span><span class="op" id="2823733">(</span><span class="ident" id="2823734"><a href="/encoding/asn1/asn1.go.html#2823674">v</a></span><span class="op" id="2823735">,</span>&nbsp;<span class="ident" id="2823737"><a href="/encoding/asn1/asn1.go.html#2823604">b</a></span><span class="op" id="2823738">,</span>&nbsp;<span class="num" id="2823740">0</span><span class="op" id="2823741">,</span>&nbsp;<span class="ident" id="2823743"><a href="/encoding/asn1/common.go.html#2826696">parseFieldParameters</a></span><span class="op" id="2823763">(</span><span class="ident" id="2823764"><a href="/encoding/asn1/asn1.go.html#2823631">params</a></span><span class="op" id="2823770">)</span><span class="op" id="2823771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823774">if</span>&nbsp;<span class="ident" id="2823777"><a href="/encoding/asn1/asn1.go.html#2823660">err</a></span>&nbsp;<span class="op" id="2823781">!=</span>&nbsp;<span class="ident" id="2823784">nil</span>&nbsp;<span class="op" id="2823788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823792">return</span>&nbsp;<span class="ident" id="2823799">nil</span><span class="op" id="2823802">,</span>&nbsp;<span class="ident" id="2823804"><a href="/encoding/asn1/asn1.go.html#2823660">err</a></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2823809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823812">return</span>&nbsp;<span class="ident" id="2823819"><a href="/encoding/asn1/asn1.go.html#2823604">b</a></span><span class="op" id="2823820">[</span><span class="ident" id="2823821"><a href="/encoding/asn1/asn1.go.html#2823708">offset</a></span><span class="op" id="2823827">:</span><span class="op" id="2823828">]</span><span class="op" id="2823829">,</span>&nbsp;<span class="ident" id="2823831">nil</span><br>
<span class="lineno"></span><span class="op" id="2823835">}</span>
</div>
</body>
</html>
