<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3111029">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3111084">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3111138">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3111189">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3111228">//</span><br>
<span class="lineno"></span><span class="comment" id="3111231">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3111291">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3111330">//</span><br>
<span class="lineno">10</span><span class="comment" id="3111333">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3111393">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3111458">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3111525">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3111549">//</span><br>
<span class="lineno">15</span><span class="comment" id="3111552">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3111616">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3111686">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3111749">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3111782">//</span><br>
<span class="lineno">20</span><span class="comment" id="3111785">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3111861">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3111928">package</span>&nbsp;<span class="ident" id="3111936">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3111941">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3111960">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3111979">const</span>&nbsp;<span class="op" id="3111985">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3111988">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112040">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112053">=</span>&nbsp;<span class="num" id="3112055">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112058">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112071">=</span>&nbsp;<span class="num" id="3112073">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112076">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112089">=</span>&nbsp;<span class="num" id="3112091">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112094">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112107">=</span>&nbsp;<span class="num" id="3112109">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112112">dnsTypeCNAME</span>&nbsp;<span class="op" id="3112125">=</span>&nbsp;<span class="num" id="3112127">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112130">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112143">=</span>&nbsp;<span class="num" id="3112145">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112148">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112161">=</span>&nbsp;<span class="num" id="3112163">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112166">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112179">=</span>&nbsp;<span class="num" id="3112181">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112184">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112197">=</span>&nbsp;<span class="num" id="3112199">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112202">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3112215">=</span>&nbsp;<span class="num" id="3112217">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112221">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112234">=</span>&nbsp;<span class="num" id="3112236">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112240">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112253">=</span>&nbsp;<span class="num" id="3112255">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112259">dnsTypeHINFO</span>&nbsp;<span class="op" id="3112272">=</span>&nbsp;<span class="num" id="3112274">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112278">dnsTypeMINFO</span>&nbsp;<span class="op" id="3112291">=</span>&nbsp;<span class="num" id="3112293">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112297">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112310">=</span>&nbsp;<span class="num" id="3112312">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112316">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112329">=</span>&nbsp;<span class="num" id="3112331">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112335">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3112348">=</span>&nbsp;<span class="num" id="3112350">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112354">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112367">=</span>&nbsp;<span class="num" id="3112369">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3112374">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112407">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3112420">=</span>&nbsp;<span class="num" id="3112422">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112427">dnsTypeMAILB</span>&nbsp;<span class="op" id="3112440">=</span>&nbsp;<span class="num" id="3112442">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112447">dnsTypeMAILA</span>&nbsp;<span class="op" id="3112460">=</span>&nbsp;<span class="num" id="3112462">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112467">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112480">=</span>&nbsp;<span class="num" id="3112482">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3112488">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112517">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3112532">=</span>&nbsp;<span class="num" id="3112534">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112537">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3112552">=</span>&nbsp;<span class="num" id="3112554">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112557">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3112572">=</span>&nbsp;<span class="num" id="3112574">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112577">dnsClassHESIOD</span>&nbsp;<span class="op" id="3112592">=</span>&nbsp;<span class="num" id="3112594">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112597">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112612">=</span>&nbsp;<span class="num" id="3112614">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3112620">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112637">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112660">=</span>&nbsp;<span class="num" id="3112662">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112665">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112688">=</span>&nbsp;<span class="num" id="3112690">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112693">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3112716">=</span>&nbsp;<span class="num" id="3112718">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112721">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112744">=</span>&nbsp;<span class="num" id="3112746">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112749">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3112772">=</span>&nbsp;<span class="num" id="3112774">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112777">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112800">=</span>&nbsp;<span class="num" id="3112802">5</span><br>
<span class="lineno"></span><span class="op" id="3112804">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3112807">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3112874">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3112901">type</span>&nbsp;<span class="ident" id="3112906">dnsStruct</span>&nbsp;<span class="keyword" id="3112916">interface</span>&nbsp;<span class="op" id="3112926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3112929">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3112986">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113044">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113100">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113150">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113206">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113248">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113304">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113342">Walk</span><span class="op" id="3113346">(</span><span class="ident" id="3113347">f</span>&nbsp;<span class="keyword" id="3113349">func</span><span class="op" id="3113353">(</span><span class="ident" id="3113354">v</span>&nbsp;<span class="keyword" id="3113356">interface</span><span class="op" id="3113365">{</span><span class="op" id="3113366">}</span><span class="op" id="3113367">,</span>&nbsp;<span class="ident" id="3113369">name</span><span class="op" id="3113373">,</span>&nbsp;<span class="ident" id="3113375">tag</span>&nbsp;<span class="builtintype" id="3113379">string</span><span class="op" id="3113385">)</span>&nbsp;<span class="op" id="3113387">(</span><span class="ident" id="3113388">ok</span>&nbsp;<span class="builtintype" id="3113391">bool</span><span class="op" id="3113395">)</span><span class="op" id="3113396">)</span>&nbsp;<span class="op" id="3113398">(</span><span class="ident" id="3113399">ok</span>&nbsp;<span class="builtintype" id="3113402">bool</span><span class="op" id="3113406">)</span><br>
<span class="lineno"></span><span class="op" id="3113408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3113411">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3113457">type</span>&nbsp;<span class="ident" id="3113462">dnsHeader</span>&nbsp;<span class="keyword" id="3113472">struct</span>&nbsp;<span class="op" id="3113479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113482">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3113517">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113525">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3113560">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113568">Qdcount</span><span class="op" id="3113575">,</span>&nbsp;<span class="ident" id="3113577">Ancount</span><span class="op" id="3113584">,</span>&nbsp;<span class="ident" id="3113586">Nscount</span><span class="op" id="3113593">,</span>&nbsp;<span class="ident" id="3113595">Arcount</span>&nbsp;<span class="builtintype" id="3113603">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3113610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3113613">func</span>&nbsp;<span class="op" id="3113618">(</span><span class="ident" id="3113619">h</span>&nbsp;<span class="op" id="3113621">*</span><span class="ident" id="3113622">dnsHeader</span><span class="op" id="3113631">)</span>&nbsp;<span class="ident" id="3113633">Walk</span><span class="op" id="3113637">(</span><span class="ident" id="3113638">f</span>&nbsp;<span class="keyword" id="3113640">func</span><span class="op" id="3113644">(</span><span class="ident" id="3113645">v</span>&nbsp;<span class="keyword" id="3113647">interface</span><span class="op" id="3113656">{</span><span class="op" id="3113657">}</span><span class="op" id="3113658">,</span>&nbsp;<span class="ident" id="3113660">name</span><span class="op" id="3113664">,</span>&nbsp;<span class="ident" id="3113666">tag</span>&nbsp;<span class="builtintype" id="3113670">string</span><span class="op" id="3113676">)</span>&nbsp;<span class="builtintype" id="3113678">bool</span><span class="op" id="3113682">)</span>&nbsp;<span class="builtintype" id="3113684">bool</span>&nbsp;<span class="op" id="3113689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113692">return</span>&nbsp;<span class="ident" id="3113699">f</span><span class="op" id="3113700">(</span><span class="op" id="3113701">&amp;</span><span class="ident" id="3113702">h</span><span class="op" id="3113703">.</span><span class="ident" id="3113704">Id</span><span class="op" id="3113706">,</span>&nbsp;<span class="string" id="3113708">&#34;Id&#34;</span><span class="op" id="3113712">,</span>&nbsp;<span class="string" id="3113714">&#34;&#34;</span><span class="op" id="3113716">)</span>&nbsp;<span class="op" id="3113718">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113723">f</span><span class="op" id="3113724">(</span><span class="op" id="3113725">&amp;</span><span class="ident" id="3113726">h</span><span class="op" id="3113727">.</span><span class="ident" id="3113728">Bits</span><span class="op" id="3113732">,</span>&nbsp;<span class="string" id="3113734">&#34;Bits&#34;</span><span class="op" id="3113740">,</span>&nbsp;<span class="string" id="3113742">&#34;&#34;</span><span class="op" id="3113744">)</span>&nbsp;<span class="op" id="3113746">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113751">f</span><span class="op" id="3113752">(</span><span class="op" id="3113753">&amp;</span><span class="ident" id="3113754">h</span><span class="op" id="3113755">.</span><span class="ident" id="3113756">Qdcount</span><span class="op" id="3113763">,</span>&nbsp;<span class="string" id="3113765">&#34;Qdcount&#34;</span><span class="op" id="3113774">,</span>&nbsp;<span class="string" id="3113776">&#34;&#34;</span><span class="op" id="3113778">)</span>&nbsp;<span class="op" id="3113780">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113785">f</span><span class="op" id="3113786">(</span><span class="op" id="3113787">&amp;</span><span class="ident" id="3113788">h</span><span class="op" id="3113789">.</span><span class="ident" id="3113790">Ancount</span><span class="op" id="3113797">,</span>&nbsp;<span class="string" id="3113799">&#34;Ancount&#34;</span><span class="op" id="3113808">,</span>&nbsp;<span class="string" id="3113810">&#34;&#34;</span><span class="op" id="3113812">)</span>&nbsp;<span class="op" id="3113814">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113819">f</span><span class="op" id="3113820">(</span><span class="op" id="3113821">&amp;</span><span class="ident" id="3113822">h</span><span class="op" id="3113823">.</span><span class="ident" id="3113824">Nscount</span><span class="op" id="3113831">,</span>&nbsp;<span class="string" id="3113833">&#34;Nscount&#34;</span><span class="op" id="3113842">,</span>&nbsp;<span class="string" id="3113844">&#34;&#34;</span><span class="op" id="3113846">)</span>&nbsp;<span class="op" id="3113848">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113853">f</span><span class="op" id="3113854">(</span><span class="op" id="3113855">&amp;</span><span class="ident" id="3113856">h</span><span class="op" id="3113857">.</span><span class="ident" id="3113858">Arcount</span><span class="op" id="3113865">,</span>&nbsp;<span class="string" id="3113867">&#34;Arcount&#34;</span><span class="op" id="3113876">,</span>&nbsp;<span class="string" id="3113878">&#34;&#34;</span><span class="op" id="3113880">)</span><br>
<span class="lineno"></span><span class="op" id="3113882">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3113885">const</span>&nbsp;<span class="op" id="3113891">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113894">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113913">_QR</span>&nbsp;<span class="op" id="3113917">=</span>&nbsp;<span class="num" id="3113919">1</span>&nbsp;<span class="op" id="3113921">&lt;&lt;</span>&nbsp;<span class="num" id="3113924">15</span>&nbsp;<span class="comment" id="3113927">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113959">_AA</span>&nbsp;<span class="op" id="3113963">=</span>&nbsp;<span class="num" id="3113965">1</span>&nbsp;<span class="op" id="3113967">&lt;&lt;</span>&nbsp;<span class="num" id="3113970">10</span>&nbsp;<span class="comment" id="3113973">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113991">_TC</span>&nbsp;<span class="op" id="3113995">=</span>&nbsp;<span class="num" id="3113997">1</span>&nbsp;<span class="op" id="3113999">&lt;&lt;</span>&nbsp;<span class="num" id="3114002">9</span>&nbsp;&nbsp;<span class="comment" id="3114005">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114019">_RD</span>&nbsp;<span class="op" id="3114023">=</span>&nbsp;<span class="num" id="3114025">1</span>&nbsp;<span class="op" id="3114027">&lt;&lt;</span>&nbsp;<span class="num" id="3114030">8</span>&nbsp;&nbsp;<span class="comment" id="3114033">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114055">_RA</span>&nbsp;<span class="op" id="3114059">=</span>&nbsp;<span class="num" id="3114061">1</span>&nbsp;<span class="op" id="3114063">&lt;&lt;</span>&nbsp;<span class="num" id="3114066">7</span>&nbsp;&nbsp;<span class="comment" id="3114069">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3114092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3114095">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3114111">type</span>&nbsp;<span class="ident" id="3114116">dnsQuestion</span>&nbsp;<span class="keyword" id="3114128">struct</span>&nbsp;<span class="op" id="3114135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114138">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3114145">string</span>&nbsp;<span class="string" id="3114152">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3114172">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114234">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3114241">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114249">Qclass</span>&nbsp;<span class="builtintype" id="3114256">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3114263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3114266">func</span>&nbsp;<span class="op" id="3114271">(</span><span class="ident" id="3114272">q</span>&nbsp;<span class="op" id="3114274">*</span><span class="ident" id="3114275">dnsQuestion</span><span class="op" id="3114286">)</span>&nbsp;<span class="ident" id="3114288">Walk</span><span class="op" id="3114292">(</span><span class="ident" id="3114293">f</span>&nbsp;<span class="keyword" id="3114295">func</span><span class="op" id="3114299">(</span><span class="ident" id="3114300">v</span>&nbsp;<span class="keyword" id="3114302">interface</span><span class="op" id="3114311">{</span><span class="op" id="3114312">}</span><span class="op" id="3114313">,</span>&nbsp;<span class="ident" id="3114315">name</span><span class="op" id="3114319">,</span>&nbsp;<span class="ident" id="3114321">tag</span>&nbsp;<span class="builtintype" id="3114325">string</span><span class="op" id="3114331">)</span>&nbsp;<span class="builtintype" id="3114333">bool</span><span class="op" id="3114337">)</span>&nbsp;<span class="builtintype" id="3114339">bool</span>&nbsp;<span class="op" id="3114344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114347">return</span>&nbsp;<span class="ident" id="3114354">f</span><span class="op" id="3114355">(</span><span class="op" id="3114356">&amp;</span><span class="ident" id="3114357">q</span><span class="op" id="3114358">.</span><span class="ident" id="3114359">Name</span><span class="op" id="3114363">,</span>&nbsp;<span class="string" id="3114365">&#34;Name&#34;</span><span class="op" id="3114371">,</span>&nbsp;<span class="string" id="3114373">&#34;domain&#34;</span><span class="op" id="3114381">)</span>&nbsp;<span class="op" id="3114383">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114388">f</span><span class="op" id="3114389">(</span><span class="op" id="3114390">&amp;</span><span class="ident" id="3114391">q</span><span class="op" id="3114392">.</span><span class="ident" id="3114393">Qtype</span><span class="op" id="3114398">,</span>&nbsp;<span class="string" id="3114400">&#34;Qtype&#34;</span><span class="op" id="3114407">,</span>&nbsp;<span class="string" id="3114409">&#34;&#34;</span><span class="op" id="3114411">)</span>&nbsp;<span class="op" id="3114413">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114418">f</span><span class="op" id="3114419">(</span><span class="op" id="3114420">&amp;</span><span class="ident" id="3114421">q</span><span class="op" id="3114422">.</span><span class="ident" id="3114423">Qclass</span><span class="op" id="3114429">,</span>&nbsp;<span class="string" id="3114431">&#34;Qclass&#34;</span><span class="op" id="3114439">,</span>&nbsp;<span class="string" id="3114441">&#34;&#34;</span><span class="op" id="3114443">)</span><br>
<span class="lineno"></span><span class="op" id="3114445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3114448">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3114485">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3114522">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3114561">type</span>&nbsp;<span class="ident" id="3114566">dnsRR_Header</span>&nbsp;<span class="keyword" id="3114579">struct</span>&nbsp;<span class="op" id="3114586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114589">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3114598">string</span>&nbsp;<span class="string" id="3114605">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114626">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3114635">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114643">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3114652">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114660">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3114669">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114677">Rdlength</span>&nbsp;<span class="builtintype" id="3114686">uint16</span>&nbsp;<span class="comment" id="3114693">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3114724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3114727">func</span>&nbsp;<span class="op" id="3114732">(</span><span class="ident" id="3114733">h</span>&nbsp;<span class="op" id="3114735">*</span><span class="ident" id="3114736">dnsRR_Header</span><span class="op" id="3114748">)</span>&nbsp;<span class="ident" id="3114750">Header</span><span class="op" id="3114756">(</span><span class="op" id="3114757">)</span>&nbsp;<span class="op" id="3114759">*</span><span class="ident" id="3114760">dnsRR_Header</span>&nbsp;<span class="op" id="3114773">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114776">return</span>&nbsp;<span class="ident" id="3114783">h</span><br>
<span class="lineno"></span><span class="op" id="3114785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3114788">func</span>&nbsp;<span class="op" id="3114793">(</span><span class="ident" id="3114794">h</span>&nbsp;<span class="op" id="3114796">*</span><span class="ident" id="3114797">dnsRR_Header</span><span class="op" id="3114809">)</span>&nbsp;<span class="ident" id="3114811">Walk</span><span class="op" id="3114815">(</span><span class="ident" id="3114816">f</span>&nbsp;<span class="keyword" id="3114818">func</span><span class="op" id="3114822">(</span><span class="ident" id="3114823">v</span>&nbsp;<span class="keyword" id="3114825">interface</span><span class="op" id="3114834">{</span><span class="op" id="3114835">}</span><span class="op" id="3114836">,</span>&nbsp;<span class="ident" id="3114838">name</span><span class="op" id="3114842">,</span>&nbsp;<span class="ident" id="3114844">tag</span>&nbsp;<span class="builtintype" id="3114848">string</span><span class="op" id="3114854">)</span>&nbsp;<span class="builtintype" id="3114856">bool</span><span class="op" id="3114860">)</span>&nbsp;<span class="builtintype" id="3114862">bool</span>&nbsp;<span class="op" id="3114867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114870">return</span>&nbsp;<span class="ident" id="3114877">f</span><span class="op" id="3114878">(</span><span class="op" id="3114879">&amp;</span><span class="ident" id="3114880">h</span><span class="op" id="3114881">.</span><span class="ident" id="3114882">Name</span><span class="op" id="3114886">,</span>&nbsp;<span class="string" id="3114888">&#34;Name&#34;</span><span class="op" id="3114894">,</span>&nbsp;<span class="string" id="3114896">&#34;domain&#34;</span><span class="op" id="3114904">)</span>&nbsp;<span class="op" id="3114906">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114911">f</span><span class="op" id="3114912">(</span><span class="op" id="3114913">&amp;</span><span class="ident" id="3114914">h</span><span class="op" id="3114915">.</span><span class="ident" id="3114916">Rrtype</span><span class="op" id="3114922">,</span>&nbsp;<span class="string" id="3114924">&#34;Rrtype&#34;</span><span class="op" id="3114932">,</span>&nbsp;<span class="string" id="3114934">&#34;&#34;</span><span class="op" id="3114936">)</span>&nbsp;<span class="op" id="3114938">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114943">f</span><span class="op" id="3114944">(</span><span class="op" id="3114945">&amp;</span><span class="ident" id="3114946">h</span><span class="op" id="3114947">.</span><span class="ident" id="3114948">Class</span><span class="op" id="3114953">,</span>&nbsp;<span class="string" id="3114955">&#34;Class&#34;</span><span class="op" id="3114962">,</span>&nbsp;<span class="string" id="3114964">&#34;&#34;</span><span class="op" id="3114966">)</span>&nbsp;<span class="op" id="3114968">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114973">f</span><span class="op" id="3114974">(</span><span class="op" id="3114975">&amp;</span><span class="ident" id="3114976">h</span><span class="op" id="3114977">.</span><span class="ident" id="3114978">Ttl</span><span class="op" id="3114981">,</span>&nbsp;<span class="string" id="3114983">&#34;Ttl&#34;</span><span class="op" id="3114988">,</span>&nbsp;<span class="string" id="3114990">&#34;&#34;</span><span class="op" id="3114992">)</span>&nbsp;<span class="op" id="3114994">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114999">f</span><span class="op" id="3115000">(</span><span class="op" id="3115001">&amp;</span><span class="ident" id="3115002">h</span><span class="op" id="3115003">.</span><span class="ident" id="3115004">Rdlength</span><span class="op" id="3115012">,</span>&nbsp;<span class="string" id="3115014">&#34;Rdlength&#34;</span><span class="op" id="3115024">,</span>&nbsp;<span class="string" id="3115026">&#34;&#34;</span><span class="op" id="3115028">)</span><br>
<span class="lineno"></span><span class="op" id="3115030">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3115033">type</span>&nbsp;<span class="ident" id="3115038">dnsRR</span>&nbsp;<span class="keyword" id="3115044">interface</span>&nbsp;<span class="op" id="3115054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115057">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115068">Header</span><span class="op" id="3115074">(</span><span class="op" id="3115075">)</span>&nbsp;<span class="op" id="3115077">*</span><span class="ident" id="3115078">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3115091">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3115094">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3115143">type</span>&nbsp;<span class="ident" id="3115148">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3115160">struct</span>&nbsp;<span class="op" id="3115167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115170">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3115176">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115190">Cname</span>&nbsp;<span class="builtintype" id="3115196">string</span>&nbsp;<span class="string" id="3115203">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3115223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3115226">func</span>&nbsp;<span class="op" id="3115231">(</span><span class="ident" id="3115232">rr</span>&nbsp;<span class="op" id="3115235">*</span><span class="ident" id="3115236">dnsRR_CNAME</span><span class="op" id="3115247">)</span>&nbsp;<span class="ident" id="3115249">Header</span><span class="op" id="3115255">(</span><span class="op" id="3115256">)</span>&nbsp;<span class="op" id="3115258">*</span><span class="ident" id="3115259">dnsRR_Header</span>&nbsp;<span class="op" id="3115272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115275">return</span>&nbsp;<span class="op" id="3115282">&amp;</span><span class="ident" id="3115283">rr</span><span class="op" id="3115285">.</span><span class="ident" id="3115286">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3115290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3115293">func</span>&nbsp;<span class="op" id="3115298">(</span><span class="ident" id="3115299">rr</span>&nbsp;<span class="op" id="3115302">*</span><span class="ident" id="3115303">dnsRR_CNAME</span><span class="op" id="3115314">)</span>&nbsp;<span class="ident" id="3115316">Walk</span><span class="op" id="3115320">(</span><span class="ident" id="3115321">f</span>&nbsp;<span class="keyword" id="3115323">func</span><span class="op" id="3115327">(</span><span class="ident" id="3115328">v</span>&nbsp;<span class="keyword" id="3115330">interface</span><span class="op" id="3115339">{</span><span class="op" id="3115340">}</span><span class="op" id="3115341">,</span>&nbsp;<span class="ident" id="3115343">name</span><span class="op" id="3115347">,</span>&nbsp;<span class="ident" id="3115349">tag</span>&nbsp;<span class="builtintype" id="3115353">string</span><span class="op" id="3115359">)</span>&nbsp;<span class="builtintype" id="3115361">bool</span><span class="op" id="3115365">)</span>&nbsp;<span class="builtintype" id="3115367">bool</span>&nbsp;<span class="op" id="3115372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115375">return</span>&nbsp;<span class="ident" id="3115382">rr</span><span class="op" id="3115384">.</span><span class="ident" id="3115385">Hdr</span><span class="op" id="3115388">.</span><span class="ident" id="3115389">Walk</span><span class="op" id="3115393">(</span><span class="ident" id="3115394">f</span><span class="op" id="3115395">)</span>&nbsp;<span class="op" id="3115397">&amp;&amp;</span>&nbsp;<span class="ident" id="3115400">f</span><span class="op" id="3115401">(</span><span class="op" id="3115402">&amp;</span><span class="ident" id="3115403">rr</span><span class="op" id="3115405">.</span><span class="ident" id="3115406">Cname</span><span class="op" id="3115411">,</span>&nbsp;<span class="string" id="3115413">&#34;Cname&#34;</span><span class="op" id="3115420">,</span>&nbsp;<span class="string" id="3115422">&#34;domain&#34;</span><span class="op" id="3115430">)</span><br>
<span class="lineno"></span><span class="op" id="3115432">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3115435">type</span>&nbsp;<span class="ident" id="3115440">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3115452">struct</span>&nbsp;<span class="op" id="3115459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115462">Hdr</span>&nbsp;<span class="ident" id="3115466">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115480">Cpu</span>&nbsp;<span class="builtintype" id="3115484">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115492">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3115496">string</span><br>
<span class="lineno">170</span><span class="op" id="3115503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3115506">func</span>&nbsp;<span class="op" id="3115511">(</span><span class="ident" id="3115512">rr</span>&nbsp;<span class="op" id="3115515">*</span><span class="ident" id="3115516">dnsRR_HINFO</span><span class="op" id="3115527">)</span>&nbsp;<span class="ident" id="3115529">Header</span><span class="op" id="3115535">(</span><span class="op" id="3115536">)</span>&nbsp;<span class="op" id="3115538">*</span><span class="ident" id="3115539">dnsRR_Header</span>&nbsp;<span class="op" id="3115552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115555">return</span>&nbsp;<span class="op" id="3115562">&amp;</span><span class="ident" id="3115563">rr</span><span class="op" id="3115565">.</span><span class="ident" id="3115566">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3115570">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3115573">func</span>&nbsp;<span class="op" id="3115578">(</span><span class="ident" id="3115579">rr</span>&nbsp;<span class="op" id="3115582">*</span><span class="ident" id="3115583">dnsRR_HINFO</span><span class="op" id="3115594">)</span>&nbsp;<span class="ident" id="3115596">Walk</span><span class="op" id="3115600">(</span><span class="ident" id="3115601">f</span>&nbsp;<span class="keyword" id="3115603">func</span><span class="op" id="3115607">(</span><span class="ident" id="3115608">v</span>&nbsp;<span class="keyword" id="3115610">interface</span><span class="op" id="3115619">{</span><span class="op" id="3115620">}</span><span class="op" id="3115621">,</span>&nbsp;<span class="ident" id="3115623">name</span><span class="op" id="3115627">,</span>&nbsp;<span class="ident" id="3115629">tag</span>&nbsp;<span class="builtintype" id="3115633">string</span><span class="op" id="3115639">)</span>&nbsp;<span class="builtintype" id="3115641">bool</span><span class="op" id="3115645">)</span>&nbsp;<span class="builtintype" id="3115647">bool</span>&nbsp;<span class="op" id="3115652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115655">return</span>&nbsp;<span class="ident" id="3115662">rr</span><span class="op" id="3115664">.</span><span class="ident" id="3115665">Hdr</span><span class="op" id="3115668">.</span><span class="ident" id="3115669">Walk</span><span class="op" id="3115673">(</span><span class="ident" id="3115674">f</span><span class="op" id="3115675">)</span>&nbsp;<span class="op" id="3115677">&amp;&amp;</span>&nbsp;<span class="ident" id="3115680">f</span><span class="op" id="3115681">(</span><span class="op" id="3115682">&amp;</span><span class="ident" id="3115683">rr</span><span class="op" id="3115685">.</span><span class="ident" id="3115686">Cpu</span><span class="op" id="3115689">,</span>&nbsp;<span class="string" id="3115691">&#34;Cpu&#34;</span><span class="op" id="3115696">,</span>&nbsp;<span class="string" id="3115698">&#34;&#34;</span><span class="op" id="3115700">)</span>&nbsp;<span class="op" id="3115702">&amp;&amp;</span>&nbsp;<span class="ident" id="3115705">f</span><span class="op" id="3115706">(</span><span class="op" id="3115707">&amp;</span><span class="ident" id="3115708">rr</span><span class="op" id="3115710">.</span><span class="ident" id="3115711">Os</span><span class="op" id="3115713">,</span>&nbsp;<span class="string" id="3115715">&#34;Os&#34;</span><span class="op" id="3115719">,</span>&nbsp;<span class="string" id="3115721">&#34;&#34;</span><span class="op" id="3115723">)</span><br>
<span class="lineno"></span><span class="op" id="3115725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3115728">type</span>&nbsp;<span class="ident" id="3115733">dnsRR_MB</span>&nbsp;<span class="keyword" id="3115742">struct</span>&nbsp;<span class="op" id="3115749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115752">Hdr</span>&nbsp;<span class="ident" id="3115756">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115770">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3115774">string</span>&nbsp;<span class="string" id="3115781">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3115801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3115804">func</span>&nbsp;<span class="op" id="3115809">(</span><span class="ident" id="3115810">rr</span>&nbsp;<span class="op" id="3115813">*</span><span class="ident" id="3115814">dnsRR_MB</span><span class="op" id="3115822">)</span>&nbsp;<span class="ident" id="3115824">Header</span><span class="op" id="3115830">(</span><span class="op" id="3115831">)</span>&nbsp;<span class="op" id="3115833">*</span><span class="ident" id="3115834">dnsRR_Header</span>&nbsp;<span class="op" id="3115847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115850">return</span>&nbsp;<span class="op" id="3115857">&amp;</span><span class="ident" id="3115858">rr</span><span class="op" id="3115860">.</span><span class="ident" id="3115861">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3115865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3115868">func</span>&nbsp;<span class="op" id="3115873">(</span><span class="ident" id="3115874">rr</span>&nbsp;<span class="op" id="3115877">*</span><span class="ident" id="3115878">dnsRR_MB</span><span class="op" id="3115886">)</span>&nbsp;<span class="ident" id="3115888">Walk</span><span class="op" id="3115892">(</span><span class="ident" id="3115893">f</span>&nbsp;<span class="keyword" id="3115895">func</span><span class="op" id="3115899">(</span><span class="ident" id="3115900">v</span>&nbsp;<span class="keyword" id="3115902">interface</span><span class="op" id="3115911">{</span><span class="op" id="3115912">}</span><span class="op" id="3115913">,</span>&nbsp;<span class="ident" id="3115915">name</span><span class="op" id="3115919">,</span>&nbsp;<span class="ident" id="3115921">tag</span>&nbsp;<span class="builtintype" id="3115925">string</span><span class="op" id="3115931">)</span>&nbsp;<span class="builtintype" id="3115933">bool</span><span class="op" id="3115937">)</span>&nbsp;<span class="builtintype" id="3115939">bool</span>&nbsp;<span class="op" id="3115944">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115947">return</span>&nbsp;<span class="ident" id="3115954">rr</span><span class="op" id="3115956">.</span><span class="ident" id="3115957">Hdr</span><span class="op" id="3115960">.</span><span class="ident" id="3115961">Walk</span><span class="op" id="3115965">(</span><span class="ident" id="3115966">f</span><span class="op" id="3115967">)</span>&nbsp;<span class="op" id="3115969">&amp;&amp;</span>&nbsp;<span class="ident" id="3115972">f</span><span class="op" id="3115973">(</span><span class="op" id="3115974">&amp;</span><span class="ident" id="3115975">rr</span><span class="op" id="3115977">.</span><span class="ident" id="3115978">Mb</span><span class="op" id="3115980">,</span>&nbsp;<span class="string" id="3115982">&#34;Mb&#34;</span><span class="op" id="3115986">,</span>&nbsp;<span class="string" id="3115988">&#34;domain&#34;</span><span class="op" id="3115996">)</span><br>
<span class="lineno"></span><span class="op" id="3115998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116001">type</span>&nbsp;<span class="ident" id="3116006">dnsRR_MG</span>&nbsp;<span class="keyword" id="3116015">struct</span>&nbsp;<span class="op" id="3116022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116025">Hdr</span>&nbsp;<span class="ident" id="3116029">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116043">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3116047">string</span>&nbsp;<span class="string" id="3116054">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3116074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116077">func</span>&nbsp;<span class="op" id="3116082">(</span><span class="ident" id="3116083">rr</span>&nbsp;<span class="op" id="3116086">*</span><span class="ident" id="3116087">dnsRR_MG</span><span class="op" id="3116095">)</span>&nbsp;<span class="ident" id="3116097">Header</span><span class="op" id="3116103">(</span><span class="op" id="3116104">)</span>&nbsp;<span class="op" id="3116106">*</span><span class="ident" id="3116107">dnsRR_Header</span>&nbsp;<span class="op" id="3116120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116123">return</span>&nbsp;<span class="op" id="3116130">&amp;</span><span class="ident" id="3116131">rr</span><span class="op" id="3116133">.</span><span class="ident" id="3116134">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3116138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116141">func</span>&nbsp;<span class="op" id="3116146">(</span><span class="ident" id="3116147">rr</span>&nbsp;<span class="op" id="3116150">*</span><span class="ident" id="3116151">dnsRR_MG</span><span class="op" id="3116159">)</span>&nbsp;<span class="ident" id="3116161">Walk</span><span class="op" id="3116165">(</span><span class="ident" id="3116166">f</span>&nbsp;<span class="keyword" id="3116168">func</span><span class="op" id="3116172">(</span><span class="ident" id="3116173">v</span>&nbsp;<span class="keyword" id="3116175">interface</span><span class="op" id="3116184">{</span><span class="op" id="3116185">}</span><span class="op" id="3116186">,</span>&nbsp;<span class="ident" id="3116188">name</span><span class="op" id="3116192">,</span>&nbsp;<span class="ident" id="3116194">tag</span>&nbsp;<span class="builtintype" id="3116198">string</span><span class="op" id="3116204">)</span>&nbsp;<span class="builtintype" id="3116206">bool</span><span class="op" id="3116210">)</span>&nbsp;<span class="builtintype" id="3116212">bool</span>&nbsp;<span class="op" id="3116217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116220">return</span>&nbsp;<span class="ident" id="3116227">rr</span><span class="op" id="3116229">.</span><span class="ident" id="3116230">Hdr</span><span class="op" id="3116233">.</span><span class="ident" id="3116234">Walk</span><span class="op" id="3116238">(</span><span class="ident" id="3116239">f</span><span class="op" id="3116240">)</span>&nbsp;<span class="op" id="3116242">&amp;&amp;</span>&nbsp;<span class="ident" id="3116245">f</span><span class="op" id="3116246">(</span><span class="op" id="3116247">&amp;</span><span class="ident" id="3116248">rr</span><span class="op" id="3116250">.</span><span class="ident" id="3116251">Mg</span><span class="op" id="3116253">,</span>&nbsp;<span class="string" id="3116255">&#34;Mg&#34;</span><span class="op" id="3116259">,</span>&nbsp;<span class="string" id="3116261">&#34;domain&#34;</span><span class="op" id="3116269">)</span><br>
<span class="lineno"></span><span class="op" id="3116271">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3116274">type</span>&nbsp;<span class="ident" id="3116279">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3116291">struct</span>&nbsp;<span class="op" id="3116298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116301">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3116307">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116321">Rmail</span>&nbsp;<span class="builtintype" id="3116327">string</span>&nbsp;<span class="string" id="3116334">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116355">Email</span>&nbsp;<span class="builtintype" id="3116361">string</span>&nbsp;<span class="string" id="3116368">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3116388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116391">func</span>&nbsp;<span class="op" id="3116396">(</span><span class="ident" id="3116397">rr</span>&nbsp;<span class="op" id="3116400">*</span><span class="ident" id="3116401">dnsRR_MINFO</span><span class="op" id="3116412">)</span>&nbsp;<span class="ident" id="3116414">Header</span><span class="op" id="3116420">(</span><span class="op" id="3116421">)</span>&nbsp;<span class="op" id="3116423">*</span><span class="ident" id="3116424">dnsRR_Header</span>&nbsp;<span class="op" id="3116437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116440">return</span>&nbsp;<span class="op" id="3116447">&amp;</span><span class="ident" id="3116448">rr</span><span class="op" id="3116450">.</span><span class="ident" id="3116451">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3116455">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3116458">func</span>&nbsp;<span class="op" id="3116463">(</span><span class="ident" id="3116464">rr</span>&nbsp;<span class="op" id="3116467">*</span><span class="ident" id="3116468">dnsRR_MINFO</span><span class="op" id="3116479">)</span>&nbsp;<span class="ident" id="3116481">Walk</span><span class="op" id="3116485">(</span><span class="ident" id="3116486">f</span>&nbsp;<span class="keyword" id="3116488">func</span><span class="op" id="3116492">(</span><span class="ident" id="3116493">v</span>&nbsp;<span class="keyword" id="3116495">interface</span><span class="op" id="3116504">{</span><span class="op" id="3116505">}</span><span class="op" id="3116506">,</span>&nbsp;<span class="ident" id="3116508">name</span><span class="op" id="3116512">,</span>&nbsp;<span class="ident" id="3116514">tag</span>&nbsp;<span class="builtintype" id="3116518">string</span><span class="op" id="3116524">)</span>&nbsp;<span class="builtintype" id="3116526">bool</span><span class="op" id="3116530">)</span>&nbsp;<span class="builtintype" id="3116532">bool</span>&nbsp;<span class="op" id="3116537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116540">return</span>&nbsp;<span class="ident" id="3116547">rr</span><span class="op" id="3116549">.</span><span class="ident" id="3116550">Hdr</span><span class="op" id="3116553">.</span><span class="ident" id="3116554">Walk</span><span class="op" id="3116558">(</span><span class="ident" id="3116559">f</span><span class="op" id="3116560">)</span>&nbsp;<span class="op" id="3116562">&amp;&amp;</span>&nbsp;<span class="ident" id="3116565">f</span><span class="op" id="3116566">(</span><span class="op" id="3116567">&amp;</span><span class="ident" id="3116568">rr</span><span class="op" id="3116570">.</span><span class="ident" id="3116571">Rmail</span><span class="op" id="3116576">,</span>&nbsp;<span class="string" id="3116578">&#34;Rmail&#34;</span><span class="op" id="3116585">,</span>&nbsp;<span class="string" id="3116587">&#34;domain&#34;</span><span class="op" id="3116595">)</span>&nbsp;<span class="op" id="3116597">&amp;&amp;</span>&nbsp;<span class="ident" id="3116600">f</span><span class="op" id="3116601">(</span><span class="op" id="3116602">&amp;</span><span class="ident" id="3116603">rr</span><span class="op" id="3116605">.</span><span class="ident" id="3116606">Email</span><span class="op" id="3116611">,</span>&nbsp;<span class="string" id="3116613">&#34;Email&#34;</span><span class="op" id="3116620">,</span>&nbsp;<span class="string" id="3116622">&#34;domain&#34;</span><span class="op" id="3116630">)</span><br>
<span class="lineno"></span><span class="op" id="3116632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3116635">type</span>&nbsp;<span class="ident" id="3116640">dnsRR_MR</span>&nbsp;<span class="keyword" id="3116649">struct</span>&nbsp;<span class="op" id="3116656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116659">Hdr</span>&nbsp;<span class="ident" id="3116663">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116677">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3116681">string</span>&nbsp;<span class="string" id="3116688">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3116708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3116711">func</span>&nbsp;<span class="op" id="3116716">(</span><span class="ident" id="3116717">rr</span>&nbsp;<span class="op" id="3116720">*</span><span class="ident" id="3116721">dnsRR_MR</span><span class="op" id="3116729">)</span>&nbsp;<span class="ident" id="3116731">Header</span><span class="op" id="3116737">(</span><span class="op" id="3116738">)</span>&nbsp;<span class="op" id="3116740">*</span><span class="ident" id="3116741">dnsRR_Header</span>&nbsp;<span class="op" id="3116754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116757">return</span>&nbsp;<span class="op" id="3116764">&amp;</span><span class="ident" id="3116765">rr</span><span class="op" id="3116767">.</span><span class="ident" id="3116768">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3116772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116775">func</span>&nbsp;<span class="op" id="3116780">(</span><span class="ident" id="3116781">rr</span>&nbsp;<span class="op" id="3116784">*</span><span class="ident" id="3116785">dnsRR_MR</span><span class="op" id="3116793">)</span>&nbsp;<span class="ident" id="3116795">Walk</span><span class="op" id="3116799">(</span><span class="ident" id="3116800">f</span>&nbsp;<span class="keyword" id="3116802">func</span><span class="op" id="3116806">(</span><span class="ident" id="3116807">v</span>&nbsp;<span class="keyword" id="3116809">interface</span><span class="op" id="3116818">{</span><span class="op" id="3116819">}</span><span class="op" id="3116820">,</span>&nbsp;<span class="ident" id="3116822">name</span><span class="op" id="3116826">,</span>&nbsp;<span class="ident" id="3116828">tag</span>&nbsp;<span class="builtintype" id="3116832">string</span><span class="op" id="3116838">)</span>&nbsp;<span class="builtintype" id="3116840">bool</span><span class="op" id="3116844">)</span>&nbsp;<span class="builtintype" id="3116846">bool</span>&nbsp;<span class="op" id="3116851">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116854">return</span>&nbsp;<span class="ident" id="3116861">rr</span><span class="op" id="3116863">.</span><span class="ident" id="3116864">Hdr</span><span class="op" id="3116867">.</span><span class="ident" id="3116868">Walk</span><span class="op" id="3116872">(</span><span class="ident" id="3116873">f</span><span class="op" id="3116874">)</span>&nbsp;<span class="op" id="3116876">&amp;&amp;</span>&nbsp;<span class="ident" id="3116879">f</span><span class="op" id="3116880">(</span><span class="op" id="3116881">&amp;</span><span class="ident" id="3116882">rr</span><span class="op" id="3116884">.</span><span class="ident" id="3116885">Mr</span><span class="op" id="3116887">,</span>&nbsp;<span class="string" id="3116889">&#34;Mr&#34;</span><span class="op" id="3116893">,</span>&nbsp;<span class="string" id="3116895">&#34;domain&#34;</span><span class="op" id="3116903">)</span><br>
<span class="lineno"></span><span class="op" id="3116905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116908">type</span>&nbsp;<span class="ident" id="3116913">dnsRR_MX</span>&nbsp;<span class="keyword" id="3116922">struct</span>&nbsp;<span class="op" id="3116929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116932">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3116937">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116951">Pref</span>&nbsp;<span class="builtintype" id="3116956">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116964">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3116969">string</span>&nbsp;<span class="string" id="3116976">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3116996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116999">func</span>&nbsp;<span class="op" id="3117004">(</span><span class="ident" id="3117005">rr</span>&nbsp;<span class="op" id="3117008">*</span><span class="ident" id="3117009">dnsRR_MX</span><span class="op" id="3117017">)</span>&nbsp;<span class="ident" id="3117019">Header</span><span class="op" id="3117025">(</span><span class="op" id="3117026">)</span>&nbsp;<span class="op" id="3117028">*</span><span class="ident" id="3117029">dnsRR_Header</span>&nbsp;<span class="op" id="3117042">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117045">return</span>&nbsp;<span class="op" id="3117052">&amp;</span><span class="ident" id="3117053">rr</span><span class="op" id="3117055">.</span><span class="ident" id="3117056">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3117060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117063">func</span>&nbsp;<span class="op" id="3117068">(</span><span class="ident" id="3117069">rr</span>&nbsp;<span class="op" id="3117072">*</span><span class="ident" id="3117073">dnsRR_MX</span><span class="op" id="3117081">)</span>&nbsp;<span class="ident" id="3117083">Walk</span><span class="op" id="3117087">(</span><span class="ident" id="3117088">f</span>&nbsp;<span class="keyword" id="3117090">func</span><span class="op" id="3117094">(</span><span class="ident" id="3117095">v</span>&nbsp;<span class="keyword" id="3117097">interface</span><span class="op" id="3117106">{</span><span class="op" id="3117107">}</span><span class="op" id="3117108">,</span>&nbsp;<span class="ident" id="3117110">name</span><span class="op" id="3117114">,</span>&nbsp;<span class="ident" id="3117116">tag</span>&nbsp;<span class="builtintype" id="3117120">string</span><span class="op" id="3117126">)</span>&nbsp;<span class="builtintype" id="3117128">bool</span><span class="op" id="3117132">)</span>&nbsp;<span class="builtintype" id="3117134">bool</span>&nbsp;<span class="op" id="3117139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117142">return</span>&nbsp;<span class="ident" id="3117149">rr</span><span class="op" id="3117151">.</span><span class="ident" id="3117152">Hdr</span><span class="op" id="3117155">.</span><span class="ident" id="3117156">Walk</span><span class="op" id="3117160">(</span><span class="ident" id="3117161">f</span><span class="op" id="3117162">)</span>&nbsp;<span class="op" id="3117164">&amp;&amp;</span>&nbsp;<span class="ident" id="3117167">f</span><span class="op" id="3117168">(</span><span class="op" id="3117169">&amp;</span><span class="ident" id="3117170">rr</span><span class="op" id="3117172">.</span><span class="ident" id="3117173">Pref</span><span class="op" id="3117177">,</span>&nbsp;<span class="string" id="3117179">&#34;Pref&#34;</span><span class="op" id="3117185">,</span>&nbsp;<span class="string" id="3117187">&#34;&#34;</span><span class="op" id="3117189">)</span>&nbsp;<span class="op" id="3117191">&amp;&amp;</span>&nbsp;<span class="ident" id="3117194">f</span><span class="op" id="3117195">(</span><span class="op" id="3117196">&amp;</span><span class="ident" id="3117197">rr</span><span class="op" id="3117199">.</span><span class="ident" id="3117200">Mx</span><span class="op" id="3117202">,</span>&nbsp;<span class="string" id="3117204">&#34;Mx&#34;</span><span class="op" id="3117208">,</span>&nbsp;<span class="string" id="3117210">&#34;domain&#34;</span><span class="op" id="3117218">)</span><br>
<span class="lineno">245</span><span class="op" id="3117220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117223">type</span>&nbsp;<span class="ident" id="3117228">dnsRR_NS</span>&nbsp;<span class="keyword" id="3117237">struct</span>&nbsp;<span class="op" id="3117244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117247">Hdr</span>&nbsp;<span class="ident" id="3117251">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117265">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3117269">string</span>&nbsp;<span class="string" id="3117276">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3117296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117299">func</span>&nbsp;<span class="op" id="3117304">(</span><span class="ident" id="3117305">rr</span>&nbsp;<span class="op" id="3117308">*</span><span class="ident" id="3117309">dnsRR_NS</span><span class="op" id="3117317">)</span>&nbsp;<span class="ident" id="3117319">Header</span><span class="op" id="3117325">(</span><span class="op" id="3117326">)</span>&nbsp;<span class="op" id="3117328">*</span><span class="ident" id="3117329">dnsRR_Header</span>&nbsp;<span class="op" id="3117342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117345">return</span>&nbsp;<span class="op" id="3117352">&amp;</span><span class="ident" id="3117353">rr</span><span class="op" id="3117355">.</span><span class="ident" id="3117356">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3117360">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3117363">func</span>&nbsp;<span class="op" id="3117368">(</span><span class="ident" id="3117369">rr</span>&nbsp;<span class="op" id="3117372">*</span><span class="ident" id="3117373">dnsRR_NS</span><span class="op" id="3117381">)</span>&nbsp;<span class="ident" id="3117383">Walk</span><span class="op" id="3117387">(</span><span class="ident" id="3117388">f</span>&nbsp;<span class="keyword" id="3117390">func</span><span class="op" id="3117394">(</span><span class="ident" id="3117395">v</span>&nbsp;<span class="keyword" id="3117397">interface</span><span class="op" id="3117406">{</span><span class="op" id="3117407">}</span><span class="op" id="3117408">,</span>&nbsp;<span class="ident" id="3117410">name</span><span class="op" id="3117414">,</span>&nbsp;<span class="ident" id="3117416">tag</span>&nbsp;<span class="builtintype" id="3117420">string</span><span class="op" id="3117426">)</span>&nbsp;<span class="builtintype" id="3117428">bool</span><span class="op" id="3117432">)</span>&nbsp;<span class="builtintype" id="3117434">bool</span>&nbsp;<span class="op" id="3117439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117442">return</span>&nbsp;<span class="ident" id="3117449">rr</span><span class="op" id="3117451">.</span><span class="ident" id="3117452">Hdr</span><span class="op" id="3117455">.</span><span class="ident" id="3117456">Walk</span><span class="op" id="3117460">(</span><span class="ident" id="3117461">f</span><span class="op" id="3117462">)</span>&nbsp;<span class="op" id="3117464">&amp;&amp;</span>&nbsp;<span class="ident" id="3117467">f</span><span class="op" id="3117468">(</span><span class="op" id="3117469">&amp;</span><span class="ident" id="3117470">rr</span><span class="op" id="3117472">.</span><span class="ident" id="3117473">Ns</span><span class="op" id="3117475">,</span>&nbsp;<span class="string" id="3117477">&#34;Ns&#34;</span><span class="op" id="3117481">,</span>&nbsp;<span class="string" id="3117483">&#34;domain&#34;</span><span class="op" id="3117491">)</span><br>
<span class="lineno"></span><span class="op" id="3117493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3117496">type</span>&nbsp;<span class="ident" id="3117501">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3117511">struct</span>&nbsp;<span class="op" id="3117518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117521">Hdr</span>&nbsp;<span class="ident" id="3117525">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117539">Ptr</span>&nbsp;<span class="builtintype" id="3117543">string</span>&nbsp;<span class="string" id="3117550">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3117570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3117573">func</span>&nbsp;<span class="op" id="3117578">(</span><span class="ident" id="3117579">rr</span>&nbsp;<span class="op" id="3117582">*</span><span class="ident" id="3117583">dnsRR_PTR</span><span class="op" id="3117592">)</span>&nbsp;<span class="ident" id="3117594">Header</span><span class="op" id="3117600">(</span><span class="op" id="3117601">)</span>&nbsp;<span class="op" id="3117603">*</span><span class="ident" id="3117604">dnsRR_Header</span>&nbsp;<span class="op" id="3117617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117620">return</span>&nbsp;<span class="op" id="3117627">&amp;</span><span class="ident" id="3117628">rr</span><span class="op" id="3117630">.</span><span class="ident" id="3117631">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3117635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117638">func</span>&nbsp;<span class="op" id="3117643">(</span><span class="ident" id="3117644">rr</span>&nbsp;<span class="op" id="3117647">*</span><span class="ident" id="3117648">dnsRR_PTR</span><span class="op" id="3117657">)</span>&nbsp;<span class="ident" id="3117659">Walk</span><span class="op" id="3117663">(</span><span class="ident" id="3117664">f</span>&nbsp;<span class="keyword" id="3117666">func</span><span class="op" id="3117670">(</span><span class="ident" id="3117671">v</span>&nbsp;<span class="keyword" id="3117673">interface</span><span class="op" id="3117682">{</span><span class="op" id="3117683">}</span><span class="op" id="3117684">,</span>&nbsp;<span class="ident" id="3117686">name</span><span class="op" id="3117690">,</span>&nbsp;<span class="ident" id="3117692">tag</span>&nbsp;<span class="builtintype" id="3117696">string</span><span class="op" id="3117702">)</span>&nbsp;<span class="builtintype" id="3117704">bool</span><span class="op" id="3117708">)</span>&nbsp;<span class="builtintype" id="3117710">bool</span>&nbsp;<span class="op" id="3117715">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117718">return</span>&nbsp;<span class="ident" id="3117725">rr</span><span class="op" id="3117727">.</span><span class="ident" id="3117728">Hdr</span><span class="op" id="3117731">.</span><span class="ident" id="3117732">Walk</span><span class="op" id="3117736">(</span><span class="ident" id="3117737">f</span><span class="op" id="3117738">)</span>&nbsp;<span class="op" id="3117740">&amp;&amp;</span>&nbsp;<span class="ident" id="3117743">f</span><span class="op" id="3117744">(</span><span class="op" id="3117745">&amp;</span><span class="ident" id="3117746">rr</span><span class="op" id="3117748">.</span><span class="ident" id="3117749">Ptr</span><span class="op" id="3117752">,</span>&nbsp;<span class="string" id="3117754">&#34;Ptr&#34;</span><span class="op" id="3117759">,</span>&nbsp;<span class="string" id="3117761">&#34;domain&#34;</span><span class="op" id="3117769">)</span><br>
<span class="lineno"></span><span class="op" id="3117771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117774">type</span>&nbsp;<span class="ident" id="3117779">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3117789">struct</span>&nbsp;<span class="op" id="3117796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117799">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3117807">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117821">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3117829">string</span>&nbsp;<span class="string" id="3117836">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117857">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3117865">string</span>&nbsp;<span class="string" id="3117872">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117893">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3117901">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117909">Refresh</span>&nbsp;<span class="builtintype" id="3117917">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117925">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3117933">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117941">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3117949">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117957">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3117965">uint32</span><br>
<span class="lineno"></span><span class="op" id="3117972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117975">func</span>&nbsp;<span class="op" id="3117980">(</span><span class="ident" id="3117981">rr</span>&nbsp;<span class="op" id="3117984">*</span><span class="ident" id="3117985">dnsRR_SOA</span><span class="op" id="3117994">)</span>&nbsp;<span class="ident" id="3117996">Header</span><span class="op" id="3118002">(</span><span class="op" id="3118003">)</span>&nbsp;<span class="op" id="3118005">*</span><span class="ident" id="3118006">dnsRR_Header</span>&nbsp;<span class="op" id="3118019">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118022">return</span>&nbsp;<span class="op" id="3118029">&amp;</span><span class="ident" id="3118030">rr</span><span class="op" id="3118032">.</span><span class="ident" id="3118033">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3118037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118040">func</span>&nbsp;<span class="op" id="3118045">(</span><span class="ident" id="3118046">rr</span>&nbsp;<span class="op" id="3118049">*</span><span class="ident" id="3118050">dnsRR_SOA</span><span class="op" id="3118059">)</span>&nbsp;<span class="ident" id="3118061">Walk</span><span class="op" id="3118065">(</span><span class="ident" id="3118066">f</span>&nbsp;<span class="keyword" id="3118068">func</span><span class="op" id="3118072">(</span><span class="ident" id="3118073">v</span>&nbsp;<span class="keyword" id="3118075">interface</span><span class="op" id="3118084">{</span><span class="op" id="3118085">}</span><span class="op" id="3118086">,</span>&nbsp;<span class="ident" id="3118088">name</span><span class="op" id="3118092">,</span>&nbsp;<span class="ident" id="3118094">tag</span>&nbsp;<span class="builtintype" id="3118098">string</span><span class="op" id="3118104">)</span>&nbsp;<span class="builtintype" id="3118106">bool</span><span class="op" id="3118110">)</span>&nbsp;<span class="builtintype" id="3118112">bool</span>&nbsp;<span class="op" id="3118117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118120">return</span>&nbsp;<span class="ident" id="3118127">rr</span><span class="op" id="3118129">.</span><span class="ident" id="3118130">Hdr</span><span class="op" id="3118133">.</span><span class="ident" id="3118134">Walk</span><span class="op" id="3118138">(</span><span class="ident" id="3118139">f</span><span class="op" id="3118140">)</span>&nbsp;<span class="op" id="3118142">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118147">f</span><span class="op" id="3118148">(</span><span class="op" id="3118149">&amp;</span><span class="ident" id="3118150">rr</span><span class="op" id="3118152">.</span><span class="ident" id="3118153">Ns</span><span class="op" id="3118155">,</span>&nbsp;<span class="string" id="3118157">&#34;Ns&#34;</span><span class="op" id="3118161">,</span>&nbsp;<span class="string" id="3118163">&#34;domain&#34;</span><span class="op" id="3118171">)</span>&nbsp;<span class="op" id="3118173">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118178">f</span><span class="op" id="3118179">(</span><span class="op" id="3118180">&amp;</span><span class="ident" id="3118181">rr</span><span class="op" id="3118183">.</span><span class="ident" id="3118184">Mbox</span><span class="op" id="3118188">,</span>&nbsp;<span class="string" id="3118190">&#34;Mbox&#34;</span><span class="op" id="3118196">,</span>&nbsp;<span class="string" id="3118198">&#34;domain&#34;</span><span class="op" id="3118206">)</span>&nbsp;<span class="op" id="3118208">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118213">f</span><span class="op" id="3118214">(</span><span class="op" id="3118215">&amp;</span><span class="ident" id="3118216">rr</span><span class="op" id="3118218">.</span><span class="ident" id="3118219">Serial</span><span class="op" id="3118225">,</span>&nbsp;<span class="string" id="3118227">&#34;Serial&#34;</span><span class="op" id="3118235">,</span>&nbsp;<span class="string" id="3118237">&#34;&#34;</span><span class="op" id="3118239">)</span>&nbsp;<span class="op" id="3118241">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118246">f</span><span class="op" id="3118247">(</span><span class="op" id="3118248">&amp;</span><span class="ident" id="3118249">rr</span><span class="op" id="3118251">.</span><span class="ident" id="3118252">Refresh</span><span class="op" id="3118259">,</span>&nbsp;<span class="string" id="3118261">&#34;Refresh&#34;</span><span class="op" id="3118270">,</span>&nbsp;<span class="string" id="3118272">&#34;&#34;</span><span class="op" id="3118274">)</span>&nbsp;<span class="op" id="3118276">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118281">f</span><span class="op" id="3118282">(</span><span class="op" id="3118283">&amp;</span><span class="ident" id="3118284">rr</span><span class="op" id="3118286">.</span><span class="ident" id="3118287">Retry</span><span class="op" id="3118292">,</span>&nbsp;<span class="string" id="3118294">&#34;Retry&#34;</span><span class="op" id="3118301">,</span>&nbsp;<span class="string" id="3118303">&#34;&#34;</span><span class="op" id="3118305">)</span>&nbsp;<span class="op" id="3118307">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118312">f</span><span class="op" id="3118313">(</span><span class="op" id="3118314">&amp;</span><span class="ident" id="3118315">rr</span><span class="op" id="3118317">.</span><span class="ident" id="3118318">Expire</span><span class="op" id="3118324">,</span>&nbsp;<span class="string" id="3118326">&#34;Expire&#34;</span><span class="op" id="3118334">,</span>&nbsp;<span class="string" id="3118336">&#34;&#34;</span><span class="op" id="3118338">)</span>&nbsp;<span class="op" id="3118340">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118345">f</span><span class="op" id="3118346">(</span><span class="op" id="3118347">&amp;</span><span class="ident" id="3118348">rr</span><span class="op" id="3118350">.</span><span class="ident" id="3118351">Minttl</span><span class="op" id="3118357">,</span>&nbsp;<span class="string" id="3118359">&#34;Minttl&#34;</span><span class="op" id="3118367">,</span>&nbsp;<span class="string" id="3118369">&#34;&#34;</span><span class="op" id="3118371">)</span><br>
<span class="lineno"></span><span class="op" id="3118373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118376">type</span>&nbsp;<span class="ident" id="3118381">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3118391">struct</span>&nbsp;<span class="op" id="3118398">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118401">Hdr</span>&nbsp;<span class="ident" id="3118405">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118419">Txt</span>&nbsp;<span class="builtintype" id="3118423">string</span>&nbsp;<span class="comment" id="3118430">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3118449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118452">func</span>&nbsp;<span class="op" id="3118457">(</span><span class="ident" id="3118458">rr</span>&nbsp;<span class="op" id="3118461">*</span><span class="ident" id="3118462">dnsRR_TXT</span><span class="op" id="3118471">)</span>&nbsp;<span class="ident" id="3118473">Header</span><span class="op" id="3118479">(</span><span class="op" id="3118480">)</span>&nbsp;<span class="op" id="3118482">*</span><span class="ident" id="3118483">dnsRR_Header</span>&nbsp;<span class="op" id="3118496">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118499">return</span>&nbsp;<span class="op" id="3118506">&amp;</span><span class="ident" id="3118507">rr</span><span class="op" id="3118509">.</span><span class="ident" id="3118510">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3118514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118517">func</span>&nbsp;<span class="op" id="3118522">(</span><span class="ident" id="3118523">rr</span>&nbsp;<span class="op" id="3118526">*</span><span class="ident" id="3118527">dnsRR_TXT</span><span class="op" id="3118536">)</span>&nbsp;<span class="ident" id="3118538">Walk</span><span class="op" id="3118542">(</span><span class="ident" id="3118543">f</span>&nbsp;<span class="keyword" id="3118545">func</span><span class="op" id="3118549">(</span><span class="ident" id="3118550">v</span>&nbsp;<span class="keyword" id="3118552">interface</span><span class="op" id="3118561">{</span><span class="op" id="3118562">}</span><span class="op" id="3118563">,</span>&nbsp;<span class="ident" id="3118565">name</span><span class="op" id="3118569">,</span>&nbsp;<span class="ident" id="3118571">tag</span>&nbsp;<span class="builtintype" id="3118575">string</span><span class="op" id="3118581">)</span>&nbsp;<span class="builtintype" id="3118583">bool</span><span class="op" id="3118587">)</span>&nbsp;<span class="builtintype" id="3118589">bool</span>&nbsp;<span class="op" id="3118594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118597">return</span>&nbsp;<span class="ident" id="3118604">rr</span><span class="op" id="3118606">.</span><span class="ident" id="3118607">Hdr</span><span class="op" id="3118610">.</span><span class="ident" id="3118611">Walk</span><span class="op" id="3118615">(</span><span class="ident" id="3118616">f</span><span class="op" id="3118617">)</span>&nbsp;<span class="op" id="3118619">&amp;&amp;</span>&nbsp;<span class="ident" id="3118622">f</span><span class="op" id="3118623">(</span><span class="op" id="3118624">&amp;</span><span class="ident" id="3118625">rr</span><span class="op" id="3118627">.</span><span class="ident" id="3118628">Txt</span><span class="op" id="3118631">,</span>&nbsp;<span class="string" id="3118633">&#34;Txt&#34;</span><span class="op" id="3118638">,</span>&nbsp;<span class="string" id="3118640">&#34;&#34;</span><span class="op" id="3118642">)</span><br>
<span class="lineno">310</span><span class="op" id="3118644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118647">type</span>&nbsp;<span class="ident" id="3118652">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3118662">struct</span>&nbsp;<span class="op" id="3118669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118672">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3118681">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118695">Priority</span>&nbsp;<span class="builtintype" id="3118704">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118712">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3118721">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118729">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3118738">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118746">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3118755">string</span>&nbsp;<span class="string" id="3118762">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3118782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3118785">func</span>&nbsp;<span class="op" id="3118790">(</span><span class="ident" id="3118791">rr</span>&nbsp;<span class="op" id="3118794">*</span><span class="ident" id="3118795">dnsRR_SRV</span><span class="op" id="3118804">)</span>&nbsp;<span class="ident" id="3118806">Header</span><span class="op" id="3118812">(</span><span class="op" id="3118813">)</span>&nbsp;<span class="op" id="3118815">*</span><span class="ident" id="3118816">dnsRR_Header</span>&nbsp;<span class="op" id="3118829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118832">return</span>&nbsp;<span class="op" id="3118839">&amp;</span><span class="ident" id="3118840">rr</span><span class="op" id="3118842">.</span><span class="ident" id="3118843">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3118847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3118850">func</span>&nbsp;<span class="op" id="3118855">(</span><span class="ident" id="3118856">rr</span>&nbsp;<span class="op" id="3118859">*</span><span class="ident" id="3118860">dnsRR_SRV</span><span class="op" id="3118869">)</span>&nbsp;<span class="ident" id="3118871">Walk</span><span class="op" id="3118875">(</span><span class="ident" id="3118876">f</span>&nbsp;<span class="keyword" id="3118878">func</span><span class="op" id="3118882">(</span><span class="ident" id="3118883">v</span>&nbsp;<span class="keyword" id="3118885">interface</span><span class="op" id="3118894">{</span><span class="op" id="3118895">}</span><span class="op" id="3118896">,</span>&nbsp;<span class="ident" id="3118898">name</span><span class="op" id="3118902">,</span>&nbsp;<span class="ident" id="3118904">tag</span>&nbsp;<span class="builtintype" id="3118908">string</span><span class="op" id="3118914">)</span>&nbsp;<span class="builtintype" id="3118916">bool</span><span class="op" id="3118920">)</span>&nbsp;<span class="builtintype" id="3118922">bool</span>&nbsp;<span class="op" id="3118927">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118930">return</span>&nbsp;<span class="ident" id="3118937">rr</span><span class="op" id="3118939">.</span><span class="ident" id="3118940">Hdr</span><span class="op" id="3118943">.</span><span class="ident" id="3118944">Walk</span><span class="op" id="3118948">(</span><span class="ident" id="3118949">f</span><span class="op" id="3118950">)</span>&nbsp;<span class="op" id="3118952">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118957">f</span><span class="op" id="3118958">(</span><span class="op" id="3118959">&amp;</span><span class="ident" id="3118960">rr</span><span class="op" id="3118962">.</span><span class="ident" id="3118963">Priority</span><span class="op" id="3118971">,</span>&nbsp;<span class="string" id="3118973">&#34;Priority&#34;</span><span class="op" id="3118983">,</span>&nbsp;<span class="string" id="3118985">&#34;&#34;</span><span class="op" id="3118987">)</span>&nbsp;<span class="op" id="3118989">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118994">f</span><span class="op" id="3118995">(</span><span class="op" id="3118996">&amp;</span><span class="ident" id="3118997">rr</span><span class="op" id="3118999">.</span><span class="ident" id="3119000">Weight</span><span class="op" id="3119006">,</span>&nbsp;<span class="string" id="3119008">&#34;Weight&#34;</span><span class="op" id="3119016">,</span>&nbsp;<span class="string" id="3119018">&#34;&#34;</span><span class="op" id="3119020">)</span>&nbsp;<span class="op" id="3119022">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119027">f</span><span class="op" id="3119028">(</span><span class="op" id="3119029">&amp;</span><span class="ident" id="3119030">rr</span><span class="op" id="3119032">.</span><span class="ident" id="3119033">Port</span><span class="op" id="3119037">,</span>&nbsp;<span class="string" id="3119039">&#34;Port&#34;</span><span class="op" id="3119045">,</span>&nbsp;<span class="string" id="3119047">&#34;&#34;</span><span class="op" id="3119049">)</span>&nbsp;<span class="op" id="3119051">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119056">f</span><span class="op" id="3119057">(</span><span class="op" id="3119058">&amp;</span><span class="ident" id="3119059">rr</span><span class="op" id="3119061">.</span><span class="ident" id="3119062">Target</span><span class="op" id="3119068">,</span>&nbsp;<span class="string" id="3119070">&#34;Target&#34;</span><span class="op" id="3119078">,</span>&nbsp;<span class="string" id="3119080">&#34;domain&#34;</span><span class="op" id="3119088">)</span><br>
<span class="lineno">330</span><span class="op" id="3119090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3119093">type</span>&nbsp;<span class="ident" id="3119098">dnsRR_A</span>&nbsp;<span class="keyword" id="3119106">struct</span>&nbsp;<span class="op" id="3119113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119116">Hdr</span>&nbsp;<span class="ident" id="3119120">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119134">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3119138">uint32</span>&nbsp;<span class="string" id="3119145">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3119158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3119161">func</span>&nbsp;<span class="op" id="3119166">(</span><span class="ident" id="3119167">rr</span>&nbsp;<span class="op" id="3119170">*</span><span class="ident" id="3119171">dnsRR_A</span><span class="op" id="3119178">)</span>&nbsp;<span class="ident" id="3119180">Header</span><span class="op" id="3119186">(</span><span class="op" id="3119187">)</span>&nbsp;<span class="op" id="3119189">*</span><span class="ident" id="3119190">dnsRR_Header</span>&nbsp;<span class="op" id="3119203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119206">return</span>&nbsp;<span class="op" id="3119213">&amp;</span><span class="ident" id="3119214">rr</span><span class="op" id="3119216">.</span><span class="ident" id="3119217">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3119221">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3119224">func</span>&nbsp;<span class="op" id="3119229">(</span><span class="ident" id="3119230">rr</span>&nbsp;<span class="op" id="3119233">*</span><span class="ident" id="3119234">dnsRR_A</span><span class="op" id="3119241">)</span>&nbsp;<span class="ident" id="3119243">Walk</span><span class="op" id="3119247">(</span><span class="ident" id="3119248">f</span>&nbsp;<span class="keyword" id="3119250">func</span><span class="op" id="3119254">(</span><span class="ident" id="3119255">v</span>&nbsp;<span class="keyword" id="3119257">interface</span><span class="op" id="3119266">{</span><span class="op" id="3119267">}</span><span class="op" id="3119268">,</span>&nbsp;<span class="ident" id="3119270">name</span><span class="op" id="3119274">,</span>&nbsp;<span class="ident" id="3119276">tag</span>&nbsp;<span class="builtintype" id="3119280">string</span><span class="op" id="3119286">)</span>&nbsp;<span class="builtintype" id="3119288">bool</span><span class="op" id="3119292">)</span>&nbsp;<span class="builtintype" id="3119294">bool</span>&nbsp;<span class="op" id="3119299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119302">return</span>&nbsp;<span class="ident" id="3119309">rr</span><span class="op" id="3119311">.</span><span class="ident" id="3119312">Hdr</span><span class="op" id="3119315">.</span><span class="ident" id="3119316">Walk</span><span class="op" id="3119320">(</span><span class="ident" id="3119321">f</span><span class="op" id="3119322">)</span>&nbsp;<span class="op" id="3119324">&amp;&amp;</span>&nbsp;<span class="ident" id="3119327">f</span><span class="op" id="3119328">(</span><span class="op" id="3119329">&amp;</span><span class="ident" id="3119330">rr</span><span class="op" id="3119332">.</span><span class="ident" id="3119333">A</span><span class="op" id="3119334">,</span>&nbsp;<span class="string" id="3119336">&#34;A&#34;</span><span class="op" id="3119339">,</span>&nbsp;<span class="string" id="3119341">&#34;ipv4&#34;</span><span class="op" id="3119347">)</span><br>
<span class="lineno"></span><span class="op" id="3119349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3119352">type</span>&nbsp;<span class="ident" id="3119357">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3119368">struct</span>&nbsp;<span class="op" id="3119375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119378">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3119383">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119397">AAAA</span>&nbsp;<span class="op" id="3119402">[</span><span class="num" id="3119403">16</span><span class="op" id="3119405">]</span><span class="builtintype" id="3119406">byte</span>&nbsp;<span class="string" id="3119411">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3119424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3119427">func</span>&nbsp;<span class="op" id="3119432">(</span><span class="ident" id="3119433">rr</span>&nbsp;<span class="op" id="3119436">*</span><span class="ident" id="3119437">dnsRR_AAAA</span><span class="op" id="3119447">)</span>&nbsp;<span class="ident" id="3119449">Header</span><span class="op" id="3119455">(</span><span class="op" id="3119456">)</span>&nbsp;<span class="op" id="3119458">*</span><span class="ident" id="3119459">dnsRR_Header</span>&nbsp;<span class="op" id="3119472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119475">return</span>&nbsp;<span class="op" id="3119482">&amp;</span><span class="ident" id="3119483">rr</span><span class="op" id="3119485">.</span><span class="ident" id="3119486">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3119490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3119493">func</span>&nbsp;<span class="op" id="3119498">(</span><span class="ident" id="3119499">rr</span>&nbsp;<span class="op" id="3119502">*</span><span class="ident" id="3119503">dnsRR_AAAA</span><span class="op" id="3119513">)</span>&nbsp;<span class="ident" id="3119515">Walk</span><span class="op" id="3119519">(</span><span class="ident" id="3119520">f</span>&nbsp;<span class="keyword" id="3119522">func</span><span class="op" id="3119526">(</span><span class="ident" id="3119527">v</span>&nbsp;<span class="keyword" id="3119529">interface</span><span class="op" id="3119538">{</span><span class="op" id="3119539">}</span><span class="op" id="3119540">,</span>&nbsp;<span class="ident" id="3119542">name</span><span class="op" id="3119546">,</span>&nbsp;<span class="ident" id="3119548">tag</span>&nbsp;<span class="builtintype" id="3119552">string</span><span class="op" id="3119558">)</span>&nbsp;<span class="builtintype" id="3119560">bool</span><span class="op" id="3119564">)</span>&nbsp;<span class="builtintype" id="3119566">bool</span>&nbsp;<span class="op" id="3119571">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119574">return</span>&nbsp;<span class="ident" id="3119581">rr</span><span class="op" id="3119583">.</span><span class="ident" id="3119584">Hdr</span><span class="op" id="3119587">.</span><span class="ident" id="3119588">Walk</span><span class="op" id="3119592">(</span><span class="ident" id="3119593">f</span><span class="op" id="3119594">)</span>&nbsp;<span class="op" id="3119596">&amp;&amp;</span>&nbsp;<span class="ident" id="3119599">f</span><span class="op" id="3119600">(</span><span class="ident" id="3119601">rr</span><span class="op" id="3119603">.</span><span class="ident" id="3119604">AAAA</span><span class="op" id="3119608">[</span><span class="op" id="3119609">:</span><span class="op" id="3119610">]</span><span class="op" id="3119611">,</span>&nbsp;<span class="string" id="3119613">&#34;AAAA&#34;</span><span class="op" id="3119619">,</span>&nbsp;<span class="string" id="3119621">&#34;ipv6&#34;</span><span class="op" id="3119627">)</span><br>
<span class="lineno"></span><span class="op" id="3119629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3119632">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3119658">//</span><br>
<span class="lineno">360</span><span class="comment" id="3119661">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3119723">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3119790">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3119852">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3119918">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3119940">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3119986">var</span>&nbsp;<span class="ident" id="3119990">rr_mk</span>&nbsp;<span class="op" id="3119996">=</span>&nbsp;<span class="keyword" id="3119998">map</span><span class="op" id="3120001">[</span><span class="builtintype" id="3120002">int</span><span class="op" id="3120005">]</span><span class="keyword" id="3120006">func</span><span class="op" id="3120010">(</span><span class="op" id="3120011">)</span>&nbsp;<span class="ident" id="3120013">dnsRR</span><span class="op" id="3120018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120021">dnsTypeCNAME</span><span class="op" id="3120033">:</span>&nbsp;<span class="keyword" id="3120035">func</span><span class="op" id="3120039">(</span><span class="op" id="3120040">)</span>&nbsp;<span class="ident" id="3120042">dnsRR</span>&nbsp;<span class="op" id="3120048">{</span>&nbsp;<span class="keyword" id="3120050">return</span>&nbsp;<span class="builtinfunc" id="3120057">new</span><span class="op" id="3120060">(</span><span class="ident" id="3120061">dnsRR_CNAME</span><span class="op" id="3120072">)</span>&nbsp;<span class="op" id="3120074">}</span><span class="op" id="3120075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120078">dnsTypeHINFO</span><span class="op" id="3120090">:</span>&nbsp;<span class="keyword" id="3120092">func</span><span class="op" id="3120096">(</span><span class="op" id="3120097">)</span>&nbsp;<span class="ident" id="3120099">dnsRR</span>&nbsp;<span class="op" id="3120105">{</span>&nbsp;<span class="keyword" id="3120107">return</span>&nbsp;<span class="builtinfunc" id="3120114">new</span><span class="op" id="3120117">(</span><span class="ident" id="3120118">dnsRR_HINFO</span><span class="op" id="3120129">)</span>&nbsp;<span class="op" id="3120131">}</span><span class="op" id="3120132">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120135">dnsTypeMB</span><span class="op" id="3120144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120149">func</span><span class="op" id="3120153">(</span><span class="op" id="3120154">)</span>&nbsp;<span class="ident" id="3120156">dnsRR</span>&nbsp;<span class="op" id="3120162">{</span>&nbsp;<span class="keyword" id="3120164">return</span>&nbsp;<span class="builtinfunc" id="3120171">new</span><span class="op" id="3120174">(</span><span class="ident" id="3120175">dnsRR_MB</span><span class="op" id="3120183">)</span>&nbsp;<span class="op" id="3120185">}</span><span class="op" id="3120186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120189">dnsTypeMG</span><span class="op" id="3120198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120203">func</span><span class="op" id="3120207">(</span><span class="op" id="3120208">)</span>&nbsp;<span class="ident" id="3120210">dnsRR</span>&nbsp;<span class="op" id="3120216">{</span>&nbsp;<span class="keyword" id="3120218">return</span>&nbsp;<span class="builtinfunc" id="3120225">new</span><span class="op" id="3120228">(</span><span class="ident" id="3120229">dnsRR_MG</span><span class="op" id="3120237">)</span>&nbsp;<span class="op" id="3120239">}</span><span class="op" id="3120240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120243">dnsTypeMINFO</span><span class="op" id="3120255">:</span>&nbsp;<span class="keyword" id="3120257">func</span><span class="op" id="3120261">(</span><span class="op" id="3120262">)</span>&nbsp;<span class="ident" id="3120264">dnsRR</span>&nbsp;<span class="op" id="3120270">{</span>&nbsp;<span class="keyword" id="3120272">return</span>&nbsp;<span class="builtinfunc" id="3120279">new</span><span class="op" id="3120282">(</span><span class="ident" id="3120283">dnsRR_MINFO</span><span class="op" id="3120294">)</span>&nbsp;<span class="op" id="3120296">}</span><span class="op" id="3120297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120300">dnsTypeMR</span><span class="op" id="3120309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120314">func</span><span class="op" id="3120318">(</span><span class="op" id="3120319">)</span>&nbsp;<span class="ident" id="3120321">dnsRR</span>&nbsp;<span class="op" id="3120327">{</span>&nbsp;<span class="keyword" id="3120329">return</span>&nbsp;<span class="builtinfunc" id="3120336">new</span><span class="op" id="3120339">(</span><span class="ident" id="3120340">dnsRR_MR</span><span class="op" id="3120348">)</span>&nbsp;<span class="op" id="3120350">}</span><span class="op" id="3120351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120354">dnsTypeMX</span><span class="op" id="3120363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120368">func</span><span class="op" id="3120372">(</span><span class="op" id="3120373">)</span>&nbsp;<span class="ident" id="3120375">dnsRR</span>&nbsp;<span class="op" id="3120381">{</span>&nbsp;<span class="keyword" id="3120383">return</span>&nbsp;<span class="builtinfunc" id="3120390">new</span><span class="op" id="3120393">(</span><span class="ident" id="3120394">dnsRR_MX</span><span class="op" id="3120402">)</span>&nbsp;<span class="op" id="3120404">}</span><span class="op" id="3120405">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120408">dnsTypeNS</span><span class="op" id="3120417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120422">func</span><span class="op" id="3120426">(</span><span class="op" id="3120427">)</span>&nbsp;<span class="ident" id="3120429">dnsRR</span>&nbsp;<span class="op" id="3120435">{</span>&nbsp;<span class="keyword" id="3120437">return</span>&nbsp;<span class="builtinfunc" id="3120444">new</span><span class="op" id="3120447">(</span><span class="ident" id="3120448">dnsRR_NS</span><span class="op" id="3120456">)</span>&nbsp;<span class="op" id="3120458">}</span><span class="op" id="3120459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120462">dnsTypePTR</span><span class="op" id="3120472">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120476">func</span><span class="op" id="3120480">(</span><span class="op" id="3120481">)</span>&nbsp;<span class="ident" id="3120483">dnsRR</span>&nbsp;<span class="op" id="3120489">{</span>&nbsp;<span class="keyword" id="3120491">return</span>&nbsp;<span class="builtinfunc" id="3120498">new</span><span class="op" id="3120501">(</span><span class="ident" id="3120502">dnsRR_PTR</span><span class="op" id="3120511">)</span>&nbsp;<span class="op" id="3120513">}</span><span class="op" id="3120514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120517">dnsTypeSOA</span><span class="op" id="3120527">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120531">func</span><span class="op" id="3120535">(</span><span class="op" id="3120536">)</span>&nbsp;<span class="ident" id="3120538">dnsRR</span>&nbsp;<span class="op" id="3120544">{</span>&nbsp;<span class="keyword" id="3120546">return</span>&nbsp;<span class="builtinfunc" id="3120553">new</span><span class="op" id="3120556">(</span><span class="ident" id="3120557">dnsRR_SOA</span><span class="op" id="3120566">)</span>&nbsp;<span class="op" id="3120568">}</span><span class="op" id="3120569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120572">dnsTypeTXT</span><span class="op" id="3120582">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120586">func</span><span class="op" id="3120590">(</span><span class="op" id="3120591">)</span>&nbsp;<span class="ident" id="3120593">dnsRR</span>&nbsp;<span class="op" id="3120599">{</span>&nbsp;<span class="keyword" id="3120601">return</span>&nbsp;<span class="builtinfunc" id="3120608">new</span><span class="op" id="3120611">(</span><span class="ident" id="3120612">dnsRR_TXT</span><span class="op" id="3120621">)</span>&nbsp;<span class="op" id="3120623">}</span><span class="op" id="3120624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120627">dnsTypeSRV</span><span class="op" id="3120637">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120641">func</span><span class="op" id="3120645">(</span><span class="op" id="3120646">)</span>&nbsp;<span class="ident" id="3120648">dnsRR</span>&nbsp;<span class="op" id="3120654">{</span>&nbsp;<span class="keyword" id="3120656">return</span>&nbsp;<span class="builtinfunc" id="3120663">new</span><span class="op" id="3120666">(</span><span class="ident" id="3120667">dnsRR_SRV</span><span class="op" id="3120676">)</span>&nbsp;<span class="op" id="3120678">}</span><span class="op" id="3120679">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120682">dnsTypeA</span><span class="op" id="3120690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3120696">func</span><span class="op" id="3120700">(</span><span class="op" id="3120701">)</span>&nbsp;<span class="ident" id="3120703">dnsRR</span>&nbsp;<span class="op" id="3120709">{</span>&nbsp;<span class="keyword" id="3120711">return</span>&nbsp;<span class="builtinfunc" id="3120718">new</span><span class="op" id="3120721">(</span><span class="ident" id="3120722">dnsRR_A</span><span class="op" id="3120729">)</span>&nbsp;<span class="op" id="3120731">}</span><span class="op" id="3120732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120735">dnsTypeAAAA</span><span class="op" id="3120746">:</span>&nbsp;&nbsp;<span class="keyword" id="3120749">func</span><span class="op" id="3120753">(</span><span class="op" id="3120754">)</span>&nbsp;<span class="ident" id="3120756">dnsRR</span>&nbsp;<span class="op" id="3120762">{</span>&nbsp;<span class="keyword" id="3120764">return</span>&nbsp;<span class="builtinfunc" id="3120771">new</span><span class="op" id="3120774">(</span><span class="ident" id="3120775">dnsRR_AAAA</span><span class="op" id="3120785">)</span>&nbsp;<span class="op" id="3120787">}</span><span class="op" id="3120788">,</span><br>
<span class="lineno"></span><span class="op" id="3120790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3120793">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3120833">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3120883">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3120942">func</span>&nbsp;<span class="ident" id="3120947">packDomainName</span><span class="op" id="3120961">(</span><span class="ident" id="3120962">s</span>&nbsp;<span class="builtintype" id="3120964">string</span><span class="op" id="3120970">,</span>&nbsp;<span class="ident" id="3120972">msg</span>&nbsp;<span class="op" id="3120976">[</span><span class="op" id="3120977">]</span><span class="builtintype" id="3120978">byte</span><span class="op" id="3120982">,</span>&nbsp;<span class="ident" id="3120984">off</span>&nbsp;<span class="builtintype" id="3120988">int</span><span class="op" id="3120991">)</span>&nbsp;<span class="op" id="3120993">(</span><span class="ident" id="3120994">off1</span>&nbsp;<span class="builtintype" id="3120999">int</span><span class="op" id="3121002">,</span>&nbsp;<span class="ident" id="3121004">ok</span>&nbsp;<span class="builtintype" id="3121007">bool</span><span class="op" id="3121011">)</span>&nbsp;<span class="op" id="3121013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121016">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121059">if</span>&nbsp;<span class="ident" id="3121062">n</span>&nbsp;<span class="op" id="3121064">:=</span>&nbsp;<span class="builtinfunc" id="3121067">len</span><span class="op" id="3121070">(</span><span class="ident" id="3121071">s</span><span class="op" id="3121072">)</span><span class="op" id="3121073">;</span>&nbsp;<span class="ident" id="3121075">n</span>&nbsp;<span class="op" id="3121077">==</span>&nbsp;<span class="num" id="3121080">0</span>&nbsp;<span class="op" id="3121082">||</span>&nbsp;<span class="ident" id="3121085">s</span><span class="op" id="3121086">[</span><span class="ident" id="3121087">n</span><span class="op" id="3121088">-</span><span class="num" id="3121089">1</span><span class="op" id="3121090">]</span>&nbsp;<span class="op" id="3121092">!=</span>&nbsp;<span class="string" id="3121095">&#39;.&#39;</span>&nbsp;<span class="op" id="3121099">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121103">s</span>&nbsp;<span class="op" id="3121105">+=</span>&nbsp;<span class="string" id="3121108">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121117">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121158">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121204">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121239">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121285">tot</span>&nbsp;<span class="op" id="3121289">:=</span>&nbsp;<span class="builtinfunc" id="3121292">len</span><span class="op" id="3121295">(</span><span class="ident" id="3121296">s</span><span class="op" id="3121297">)</span>&nbsp;<span class="op" id="3121299">+</span>&nbsp;<span class="num" id="3121301">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121304">if</span>&nbsp;<span class="ident" id="3121307">off</span><span class="op" id="3121310">+</span><span class="ident" id="3121311">tot</span>&nbsp;<span class="op" id="3121315">&gt;</span>&nbsp;<span class="builtinfunc" id="3121317">len</span><span class="op" id="3121320">(</span><span class="ident" id="3121321">msg</span><span class="op" id="3121324">)</span>&nbsp;<span class="op" id="3121326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121330">return</span>&nbsp;<span class="builtinfunc" id="3121337">len</span><span class="op" id="3121340">(</span><span class="ident" id="3121341">msg</span><span class="op" id="3121344">)</span><span class="op" id="3121345">,</span>&nbsp;<span class="builtintype" id="3121347">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121358">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121414">begin</span>&nbsp;<span class="op" id="3121420">:=</span>&nbsp;<span class="num" id="3121423">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121426">for</span>&nbsp;<span class="ident" id="3121430">i</span>&nbsp;<span class="op" id="3121432">:=</span>&nbsp;<span class="num" id="3121435">0</span><span class="op" id="3121436">;</span>&nbsp;<span class="ident" id="3121438">i</span>&nbsp;<span class="op" id="3121440">&lt;</span>&nbsp;<span class="builtinfunc" id="3121442">len</span><span class="op" id="3121445">(</span><span class="ident" id="3121446">s</span><span class="op" id="3121447">)</span><span class="op" id="3121448">;</span>&nbsp;<span class="ident" id="3121450">i</span><span class="op" id="3121451">++</span>&nbsp;<span class="op" id="3121454">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121458">if</span>&nbsp;<span class="ident" id="3121461">s</span><span class="op" id="3121462">[</span><span class="ident" id="3121463">i</span><span class="op" id="3121464">]</span>&nbsp;<span class="op" id="3121466">==</span>&nbsp;<span class="string" id="3121469">&#39;.&#39;</span>&nbsp;<span class="op" id="3121473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121478">if</span>&nbsp;<span class="ident" id="3121481">i</span><span class="op" id="3121482">-</span><span class="ident" id="3121483">begin</span>&nbsp;<span class="op" id="3121489">&gt;=</span>&nbsp;<span class="num" id="3121492">1</span><span class="op" id="3121493">&lt;&lt;</span><span class="num" id="3121495">6</span>&nbsp;<span class="op" id="3121497">{</span>&nbsp;<span class="comment" id="3121499">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121543">return</span>&nbsp;<span class="builtinfunc" id="3121550">len</span><span class="op" id="3121553">(</span><span class="ident" id="3121554">msg</span><span class="op" id="3121557">)</span><span class="op" id="3121558">,</span>&nbsp;<span class="builtintype" id="3121560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121574">msg</span><span class="op" id="3121577">[</span><span class="ident" id="3121578">off</span><span class="op" id="3121581">]</span>&nbsp;<span class="op" id="3121583">=</span>&nbsp;<span class="builtintype" id="3121585">byte</span><span class="op" id="3121589">(</span><span class="ident" id="3121590">i</span>&nbsp;<span class="op" id="3121592">-</span>&nbsp;<span class="ident" id="3121594">begin</span><span class="op" id="3121599">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121604">off</span><span class="op" id="3121607">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121613">for</span>&nbsp;<span class="ident" id="3121617">j</span>&nbsp;<span class="op" id="3121619">:=</span>&nbsp;<span class="ident" id="3121622">begin</span><span class="op" id="3121627">;</span>&nbsp;<span class="ident" id="3121629">j</span>&nbsp;<span class="op" id="3121631">&lt;</span>&nbsp;<span class="ident" id="3121633">i</span><span class="op" id="3121634">;</span>&nbsp;<span class="ident" id="3121636">j</span><span class="op" id="3121637">++</span>&nbsp;<span class="op" id="3121640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121646">msg</span><span class="op" id="3121649">[</span><span class="ident" id="3121650">off</span><span class="op" id="3121653">]</span>&nbsp;<span class="op" id="3121655">=</span>&nbsp;<span class="ident" id="3121657">s</span><span class="op" id="3121658">[</span><span class="ident" id="3121659">j</span><span class="op" id="3121660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121666">off</span><span class="op" id="3121669">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121675">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121680">begin</span>&nbsp;<span class="op" id="3121686">=</span>&nbsp;<span class="ident" id="3121688">i</span>&nbsp;<span class="op" id="3121690">+</span>&nbsp;<span class="num" id="3121692">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121702">msg</span><span class="op" id="3121705">[</span><span class="ident" id="3121706">off</span><span class="op" id="3121709">]</span>&nbsp;<span class="op" id="3121711">=</span>&nbsp;<span class="num" id="3121713">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121716">off</span><span class="op" id="3121719">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121723">return</span>&nbsp;<span class="ident" id="3121730">off</span><span class="op" id="3121733">,</span>&nbsp;<span class="builtintype" id="3121735">true</span><br>
<span class="lineno"></span><span class="op" id="3121740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3121743">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3121768">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3121833">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3121898">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3121959">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3122020">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3122083">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3122152">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3122190">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3122239">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3122305">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3122351">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3122413">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3122474">func</span>&nbsp;<span class="ident" id="3122479">unpackDomainName</span><span class="op" id="3122495">(</span><span class="ident" id="3122496">msg</span>&nbsp;<span class="op" id="3122500">[</span><span class="op" id="3122501">]</span><span class="builtintype" id="3122502">byte</span><span class="op" id="3122506">,</span>&nbsp;<span class="ident" id="3122508">off</span>&nbsp;<span class="builtintype" id="3122512">int</span><span class="op" id="3122515">)</span>&nbsp;<span class="op" id="3122517">(</span><span class="ident" id="3122518">s</span>&nbsp;<span class="builtintype" id="3122520">string</span><span class="op" id="3122526">,</span>&nbsp;<span class="ident" id="3122528">off1</span>&nbsp;<span class="builtintype" id="3122533">int</span><span class="op" id="3122536">,</span>&nbsp;<span class="ident" id="3122538">ok</span>&nbsp;<span class="builtintype" id="3122541">bool</span><span class="op" id="3122545">)</span>&nbsp;<span class="op" id="3122547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122550">s</span>&nbsp;<span class="op" id="3122552">=</span>&nbsp;<span class="string" id="3122554">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122558">ptr</span>&nbsp;<span class="op" id="3122562">:=</span>&nbsp;<span class="num" id="3122565">0</span>&nbsp;<span class="comment" id="3122567">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3122598">Loop</span><span class="op" id="3122602">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122605">for</span>&nbsp;<span class="op" id="3122609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122613">if</span>&nbsp;<span class="ident" id="3122616">off</span>&nbsp;<span class="op" id="3122620">&gt;=</span>&nbsp;<span class="builtinfunc" id="3122623">len</span><span class="op" id="3122626">(</span><span class="ident" id="3122627">msg</span><span class="op" id="3122630">)</span>&nbsp;<span class="op" id="3122632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122637">return</span>&nbsp;<span class="string" id="3122644">&#34;&#34;</span><span class="op" id="3122646">,</span>&nbsp;<span class="builtinfunc" id="3122648">len</span><span class="op" id="3122651">(</span><span class="ident" id="3122652">msg</span><span class="op" id="3122655">)</span><span class="op" id="3122656">,</span>&nbsp;<span class="builtintype" id="3122658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122670">c</span>&nbsp;<span class="op" id="3122672">:=</span>&nbsp;<span class="builtintype" id="3122675">int</span><span class="op" id="3122678">(</span><span class="ident" id="3122679">msg</span><span class="op" id="3122682">[</span><span class="ident" id="3122683">off</span><span class="op" id="3122686">]</span><span class="op" id="3122687">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122691">off</span><span class="op" id="3122694">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122699">switch</span>&nbsp;<span class="ident" id="3122706">c</span>&nbsp;<span class="op" id="3122708">&amp;</span>&nbsp;<span class="num" id="3122710">0xC0</span>&nbsp;<span class="op" id="3122715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122719">case</span>&nbsp;<span class="num" id="3122724">0x00</span><span class="op" id="3122728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122733">if</span>&nbsp;<span class="ident" id="3122736">c</span>&nbsp;<span class="op" id="3122738">==</span>&nbsp;<span class="num" id="3122741">0x00</span>&nbsp;<span class="op" id="3122746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3122752">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122771">break</span>&nbsp;<span class="ident" id="3122777">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3122790">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122811">if</span>&nbsp;<span class="ident" id="3122814">off</span><span class="op" id="3122817">+</span><span class="ident" id="3122818">c</span>&nbsp;<span class="op" id="3122820">&gt;</span>&nbsp;<span class="builtinfunc" id="3122822">len</span><span class="op" id="3122825">(</span><span class="ident" id="3122826">msg</span><span class="op" id="3122829">)</span>&nbsp;<span class="op" id="3122831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122837">return</span>&nbsp;<span class="string" id="3122844">&#34;&#34;</span><span class="op" id="3122846">,</span>&nbsp;<span class="builtinfunc" id="3122848">len</span><span class="op" id="3122851">(</span><span class="ident" id="3122852">msg</span><span class="op" id="3122855">)</span><span class="op" id="3122856">,</span>&nbsp;<span class="builtintype" id="3122858">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122872">s</span>&nbsp;<span class="op" id="3122874">+=</span>&nbsp;<span class="builtintype" id="3122877">string</span><span class="op" id="3122883">(</span><span class="ident" id="3122884">msg</span><span class="op" id="3122887">[</span><span class="ident" id="3122888">off</span><span class="op" id="3122891">:</span><span class="ident" id="3122892">off</span><span class="op" id="3122895">+</span><span class="ident" id="3122896">c</span><span class="op" id="3122897">]</span><span class="op" id="3122898">)</span>&nbsp;<span class="op" id="3122900">+</span>&nbsp;<span class="string" id="3122902">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122909">off</span>&nbsp;<span class="op" id="3122913">+=</span>&nbsp;<span class="ident" id="3122916">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122920">case</span>&nbsp;<span class="num" id="3122925">0xC0</span><span class="op" id="3122929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3122934">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3122974">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3123015">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3123062">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3123108">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123136">if</span>&nbsp;<span class="ident" id="3123139">off</span>&nbsp;<span class="op" id="3123143">&gt;=</span>&nbsp;<span class="builtinfunc" id="3123146">len</span><span class="op" id="3123149">(</span><span class="ident" id="3123150">msg</span><span class="op" id="3123153">)</span>&nbsp;<span class="op" id="3123155">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123161">return</span>&nbsp;<span class="string" id="3123168">&#34;&#34;</span><span class="op" id="3123170">,</span>&nbsp;<span class="builtinfunc" id="3123172">len</span><span class="op" id="3123175">(</span><span class="ident" id="3123176">msg</span><span class="op" id="3123179">)</span><span class="op" id="3123180">,</span>&nbsp;<span class="builtintype" id="3123182">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123196">c1</span>&nbsp;<span class="op" id="3123199">:=</span>&nbsp;<span class="ident" id="3123202">msg</span><span class="op" id="3123205">[</span><span class="ident" id="3123206">off</span><span class="op" id="3123209">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123214">off</span><span class="op" id="3123217">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123223">if</span>&nbsp;<span class="ident" id="3123226">ptr</span>&nbsp;<span class="op" id="3123230">==</span>&nbsp;<span class="num" id="3123233">0</span>&nbsp;<span class="op" id="3123235">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123241">off1</span>&nbsp;<span class="op" id="3123246">=</span>&nbsp;<span class="ident" id="3123248">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123260">if</span>&nbsp;<span class="ident" id="3123263">ptr</span><span class="op" id="3123266">++</span><span class="op" id="3123268">;</span>&nbsp;<span class="ident" id="3123270">ptr</span>&nbsp;<span class="op" id="3123274">&gt;</span>&nbsp;<span class="num" id="3123276">10</span>&nbsp;<span class="op" id="3123279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123285">return</span>&nbsp;<span class="string" id="3123292">&#34;&#34;</span><span class="op" id="3123294">,</span>&nbsp;<span class="builtinfunc" id="3123296">len</span><span class="op" id="3123299">(</span><span class="ident" id="3123300">msg</span><span class="op" id="3123303">)</span><span class="op" id="3123304">,</span>&nbsp;<span class="builtintype" id="3123306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123315">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123320">off</span>&nbsp;<span class="op" id="3123324">=</span>&nbsp;<span class="op" id="3123326">(</span><span class="ident" id="3123327">c</span><span class="op" id="3123328">^</span><span class="num" id="3123329">0xC0</span><span class="op" id="3123333">)</span><span class="op" id="3123334">&lt;&lt;</span><span class="num" id="3123336">8</span>&nbsp;<span class="op" id="3123338">|</span>&nbsp;<span class="builtintype" id="3123340">int</span><span class="op" id="3123343">(</span><span class="ident" id="3123344">c1</span><span class="op" id="3123346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123350">default</span><span class="op" id="3123357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3123362">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123395">return</span>&nbsp;<span class="string" id="3123402">&#34;&#34;</span><span class="op" id="3123404">,</span>&nbsp;<span class="builtinfunc" id="3123406">len</span><span class="op" id="3123409">(</span><span class="ident" id="3123410">msg</span><span class="op" id="3123413">)</span><span class="op" id="3123414">,</span>&nbsp;<span class="builtintype" id="3123416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123424">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123430">if</span>&nbsp;<span class="ident" id="3123433">ptr</span>&nbsp;<span class="op" id="3123437">==</span>&nbsp;<span class="num" id="3123440">0</span>&nbsp;<span class="op" id="3123442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123446">off1</span>&nbsp;<span class="op" id="3123451">=</span>&nbsp;<span class="ident" id="3123453">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123461">return</span>&nbsp;<span class="ident" id="3123468">s</span><span class="op" id="3123469">,</span>&nbsp;<span class="ident" id="3123471">off1</span><span class="op" id="3123475">,</span>&nbsp;<span class="builtintype" id="3123477">true</span><br>
<span class="lineno">485</span><span class="op" id="3123482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3123485">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3123555">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3123616">func</span>&nbsp;<span class="ident" id="3123621">packStruct</span><span class="op" id="3123631">(</span><span class="ident" id="3123632">any</span>&nbsp;<span class="ident" id="3123636">dnsStruct</span><span class="op" id="3123645">,</span>&nbsp;<span class="ident" id="3123647">msg</span>&nbsp;<span class="op" id="3123651">[</span><span class="op" id="3123652">]</span><span class="builtintype" id="3123653">byte</span><span class="op" id="3123657">,</span>&nbsp;<span class="ident" id="3123659">off</span>&nbsp;<span class="builtintype" id="3123663">int</span><span class="op" id="3123666">)</span>&nbsp;<span class="op" id="3123668">(</span><span class="ident" id="3123669">off1</span>&nbsp;<span class="builtintype" id="3123674">int</span><span class="op" id="3123677">,</span>&nbsp;<span class="ident" id="3123679">ok</span>&nbsp;<span class="builtintype" id="3123682">bool</span><span class="op" id="3123686">)</span>&nbsp;<span class="op" id="3123688">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123691">ok</span>&nbsp;<span class="op" id="3123694">=</span>&nbsp;<span class="ident" id="3123696">any</span><span class="op" id="3123699">.</span><span class="ident" id="3123700">Walk</span><span class="op" id="3123704">(</span><span class="keyword" id="3123705">func</span><span class="op" id="3123709">(</span><span class="ident" id="3123710">field</span>&nbsp;<span class="keyword" id="3123716">interface</span><span class="op" id="3123725">{</span><span class="op" id="3123726">}</span><span class="op" id="3123727">,</span>&nbsp;<span class="ident" id="3123729">name</span><span class="op" id="3123733">,</span>&nbsp;<span class="ident" id="3123735">tag</span>&nbsp;<span class="builtintype" id="3123739">string</span><span class="op" id="3123745">)</span>&nbsp;<span class="builtintype" id="3123747">bool</span>&nbsp;<span class="op" id="3123752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123756">switch</span>&nbsp;<span class="ident" id="3123763">fv</span>&nbsp;<span class="op" id="3123766">:=</span>&nbsp;<span class="ident" id="3123769">field</span><span class="op" id="3123774">.</span><span class="op" id="3123775">(</span><span class="keyword" id="3123776">type</span><span class="op" id="3123780">)</span>&nbsp;<span class="op" id="3123782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123786">default</span><span class="op" id="3123793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3123798">println</span><span class="op" id="3123805">(</span><span class="string" id="3123806">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3123838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123843">return</span>&nbsp;<span class="builtintype" id="3123850">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123858">case</span>&nbsp;<span class="op" id="3123863">*</span><span class="builtintype" id="3123864">uint16</span><span class="op" id="3123870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123875">i</span>&nbsp;<span class="op" id="3123877">:=</span>&nbsp;<span class="op" id="3123880">*</span><span class="ident" id="3123881">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123887">if</span>&nbsp;<span class="ident" id="3123890">off</span><span class="op" id="3123893">+</span><span class="num" id="3123894">2</span>&nbsp;<span class="op" id="3123896">&gt;</span>&nbsp;<span class="builtinfunc" id="3123898">len</span><span class="op" id="3123901">(</span><span class="ident" id="3123902">msg</span><span class="op" id="3123905">)</span>&nbsp;<span class="op" id="3123907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123913">return</span>&nbsp;<span class="builtintype" id="3123920">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123929">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123934">msg</span><span class="op" id="3123937">[</span><span class="ident" id="3123938">off</span><span class="op" id="3123941">]</span>&nbsp;<span class="op" id="3123943">=</span>&nbsp;<span class="builtintype" id="3123945">byte</span><span class="op" id="3123949">(</span><span class="ident" id="3123950">i</span>&nbsp;<span class="op" id="3123952">&gt;&gt;</span>&nbsp;<span class="num" id="3123955">8</span><span class="op" id="3123956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123961">msg</span><span class="op" id="3123964">[</span><span class="ident" id="3123965">off</span><span class="op" id="3123968">+</span><span class="num" id="3123969">1</span><span class="op" id="3123970">]</span>&nbsp;<span class="op" id="3123972">=</span>&nbsp;<span class="builtintype" id="3123974">byte</span><span class="op" id="3123978">(</span><span class="ident" id="3123979">i</span><span class="op" id="3123980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123985">off</span>&nbsp;<span class="op" id="3123989">+=</span>&nbsp;<span class="num" id="3123992">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123996">case</span>&nbsp;<span class="op" id="3124001">*</span><span class="builtintype" id="3124002">uint32</span><span class="op" id="3124008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124013">i</span>&nbsp;<span class="op" id="3124015">:=</span>&nbsp;<span class="op" id="3124018">*</span><span class="ident" id="3124019">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124025">msg</span><span class="op" id="3124028">[</span><span class="ident" id="3124029">off</span><span class="op" id="3124032">]</span>&nbsp;<span class="op" id="3124034">=</span>&nbsp;<span class="builtintype" id="3124036">byte</span><span class="op" id="3124040">(</span><span class="ident" id="3124041">i</span>&nbsp;<span class="op" id="3124043">&gt;&gt;</span>&nbsp;<span class="num" id="3124046">24</span><span class="op" id="3124048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124053">msg</span><span class="op" id="3124056">[</span><span class="ident" id="3124057">off</span><span class="op" id="3124060">+</span><span class="num" id="3124061">1</span><span class="op" id="3124062">]</span>&nbsp;<span class="op" id="3124064">=</span>&nbsp;<span class="builtintype" id="3124066">byte</span><span class="op" id="3124070">(</span><span class="ident" id="3124071">i</span>&nbsp;<span class="op" id="3124073">&gt;&gt;</span>&nbsp;<span class="num" id="3124076">16</span><span class="op" id="3124078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124083">msg</span><span class="op" id="3124086">[</span><span class="ident" id="3124087">off</span><span class="op" id="3124090">+</span><span class="num" id="3124091">2</span><span class="op" id="3124092">]</span>&nbsp;<span class="op" id="3124094">=</span>&nbsp;<span class="builtintype" id="3124096">byte</span><span class="op" id="3124100">(</span><span class="ident" id="3124101">i</span>&nbsp;<span class="op" id="3124103">&gt;&gt;</span>&nbsp;<span class="num" id="3124106">8</span><span class="op" id="3124107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124112">msg</span><span class="op" id="3124115">[</span><span class="ident" id="3124116">off</span><span class="op" id="3124119">+</span><span class="num" id="3124120">3</span><span class="op" id="3124121">]</span>&nbsp;<span class="op" id="3124123">=</span>&nbsp;<span class="builtintype" id="3124125">byte</span><span class="op" id="3124129">(</span><span class="ident" id="3124130">i</span><span class="op" id="3124131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124136">off</span>&nbsp;<span class="op" id="3124140">+=</span>&nbsp;<span class="num" id="3124143">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124147">case</span>&nbsp;<span class="op" id="3124152">[</span><span class="op" id="3124153">]</span><span class="builtintype" id="3124154">byte</span><span class="op" id="3124158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124163">n</span>&nbsp;<span class="op" id="3124165">:=</span>&nbsp;<span class="builtinfunc" id="3124168">len</span><span class="op" id="3124171">(</span><span class="ident" id="3124172">fv</span><span class="op" id="3124174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124179">if</span>&nbsp;<span class="ident" id="3124182">off</span><span class="op" id="3124185">+</span><span class="ident" id="3124186">n</span>&nbsp;<span class="op" id="3124188">&gt;</span>&nbsp;<span class="builtinfunc" id="3124190">len</span><span class="op" id="3124193">(</span><span class="ident" id="3124194">msg</span><span class="op" id="3124197">)</span>&nbsp;<span class="op" id="3124199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124205">return</span>&nbsp;<span class="builtintype" id="3124212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124221">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3124226">copy</span><span class="op" id="3124230">(</span><span class="ident" id="3124231">msg</span><span class="op" id="3124234">[</span><span class="ident" id="3124235">off</span><span class="op" id="3124238">:</span><span class="ident" id="3124239">off</span><span class="op" id="3124242">+</span><span class="ident" id="3124243">n</span><span class="op" id="3124244">]</span><span class="op" id="3124245">,</span>&nbsp;<span class="ident" id="3124247">fv</span><span class="op" id="3124249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124254">off</span>&nbsp;<span class="op" id="3124258">+=</span>&nbsp;<span class="ident" id="3124261">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124265">case</span>&nbsp;<span class="op" id="3124270">*</span><span class="builtintype" id="3124271">string</span><span class="op" id="3124277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124282">s</span>&nbsp;<span class="op" id="3124284">:=</span>&nbsp;<span class="op" id="3124287">*</span><span class="ident" id="3124288">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124294">switch</span>&nbsp;<span class="ident" id="3124301">tag</span>&nbsp;<span class="op" id="3124305">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124310">default</span><span class="op" id="3124317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3124323">println</span><span class="op" id="3124330">(</span><span class="string" id="3124331">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3124361">,</span>&nbsp;<span class="ident" id="3124363">tag</span><span class="op" id="3124366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124372">return</span>&nbsp;<span class="builtintype" id="3124379">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124388">case</span>&nbsp;<span class="string" id="3124393">&#34;domain&#34;</span><span class="op" id="3124401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124407">off</span><span class="op" id="3124410">,</span>&nbsp;<span class="ident" id="3124412">ok</span>&nbsp;<span class="op" id="3124415">=</span>&nbsp;<span class="ident" id="3124417">packDomainName</span><span class="op" id="3124431">(</span><span class="ident" id="3124432">s</span><span class="op" id="3124433">,</span>&nbsp;<span class="ident" id="3124435">msg</span><span class="op" id="3124438">,</span>&nbsp;<span class="ident" id="3124440">off</span><span class="op" id="3124443">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124449">if</span>&nbsp;<span class="op" id="3124452">!</span><span class="ident" id="3124453">ok</span>&nbsp;<span class="op" id="3124456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124463">return</span>&nbsp;<span class="builtintype" id="3124470">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124485">case</span>&nbsp;<span class="string" id="3124490">&#34;&#34;</span><span class="op" id="3124492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3124498">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124536">if</span>&nbsp;<span class="builtinfunc" id="3124539">len</span><span class="op" id="3124542">(</span><span class="ident" id="3124543">s</span><span class="op" id="3124544">)</span>&nbsp;<span class="op" id="3124546">&gt;</span>&nbsp;<span class="num" id="3124548">255</span>&nbsp;<span class="op" id="3124552">||</span>&nbsp;<span class="ident" id="3124555">off</span><span class="op" id="3124558">+</span><span class="num" id="3124559">1</span><span class="op" id="3124560">+</span><span class="builtinfunc" id="3124561">len</span><span class="op" id="3124564">(</span><span class="ident" id="3124565">s</span><span class="op" id="3124566">)</span>&nbsp;<span class="op" id="3124568">&gt;</span>&nbsp;<span class="builtinfunc" id="3124570">len</span><span class="op" id="3124573">(</span><span class="ident" id="3124574">msg</span><span class="op" id="3124577">)</span>&nbsp;<span class="op" id="3124579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124586">return</span>&nbsp;<span class="builtintype" id="3124593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124609">msg</span><span class="op" id="3124612">[</span><span class="ident" id="3124613">off</span><span class="op" id="3124616">]</span>&nbsp;<span class="op" id="3124618">=</span>&nbsp;<span class="builtintype" id="3124620">byte</span><span class="op" id="3124624">(</span><span class="builtinfunc" id="3124625">len</span><span class="op" id="3124628">(</span><span class="ident" id="3124629">s</span><span class="op" id="3124630">)</span><span class="op" id="3124631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124637">off</span><span class="op" id="3124640">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124647">off</span>&nbsp;<span class="op" id="3124651">+=</span>&nbsp;<span class="builtinfunc" id="3124654">copy</span><span class="op" id="3124658">(</span><span class="ident" id="3124659">msg</span><span class="op" id="3124662">[</span><span class="ident" id="3124663">off</span><span class="op" id="3124666">:</span><span class="op" id="3124667">]</span><span class="op" id="3124668">,</span>&nbsp;<span class="ident" id="3124670">s</span><span class="op" id="3124671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124684">return</span>&nbsp;<span class="builtintype" id="3124691">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124697">}</span><span class="op" id="3124698">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124701">if</span>&nbsp;<span class="op" id="3124704">!</span><span class="ident" id="3124705">ok</span>&nbsp;<span class="op" id="3124708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124712">return</span>&nbsp;<span class="builtinfunc" id="3124719">len</span><span class="op" id="3124722">(</span><span class="ident" id="3124723">msg</span><span class="op" id="3124726">)</span><span class="op" id="3124727">,</span>&nbsp;<span class="builtintype" id="3124729">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124739">return</span>&nbsp;<span class="ident" id="3124746">off</span><span class="op" id="3124749">,</span>&nbsp;<span class="builtintype" id="3124751">true</span><br>
<span class="lineno"></span><span class="op" id="3124756">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3124759">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3124824">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3124885">func</span>&nbsp;<span class="ident" id="3124890">unpackStruct</span><span class="op" id="3124902">(</span><span class="ident" id="3124903">any</span>&nbsp;<span class="ident" id="3124907">dnsStruct</span><span class="op" id="3124916">,</span>&nbsp;<span class="ident" id="3124918">msg</span>&nbsp;<span class="op" id="3124922">[</span><span class="op" id="3124923">]</span><span class="builtintype" id="3124924">byte</span><span class="op" id="3124928">,</span>&nbsp;<span class="ident" id="3124930">off</span>&nbsp;<span class="builtintype" id="3124934">int</span><span class="op" id="3124937">)</span>&nbsp;<span class="op" id="3124939">(</span><span class="ident" id="3124940">off1</span>&nbsp;<span class="builtintype" id="3124945">int</span><span class="op" id="3124948">,</span>&nbsp;<span class="ident" id="3124950">ok</span>&nbsp;<span class="builtintype" id="3124953">bool</span><span class="op" id="3124957">)</span>&nbsp;<span class="op" id="3124959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124962">ok</span>&nbsp;<span class="op" id="3124965">=</span>&nbsp;<span class="ident" id="3124967">any</span><span class="op" id="3124970">.</span><span class="ident" id="3124971">Walk</span><span class="op" id="3124975">(</span><span class="keyword" id="3124976">func</span><span class="op" id="3124980">(</span><span class="ident" id="3124981">field</span>&nbsp;<span class="keyword" id="3124987">interface</span><span class="op" id="3124996">{</span><span class="op" id="3124997">}</span><span class="op" id="3124998">,</span>&nbsp;<span class="ident" id="3125000">name</span><span class="op" id="3125004">,</span>&nbsp;<span class="ident" id="3125006">tag</span>&nbsp;<span class="builtintype" id="3125010">string</span><span class="op" id="3125016">)</span>&nbsp;<span class="builtintype" id="3125018">bool</span>&nbsp;<span class="op" id="3125023">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125027">switch</span>&nbsp;<span class="ident" id="3125034">fv</span>&nbsp;<span class="op" id="3125037">:=</span>&nbsp;<span class="ident" id="3125040">field</span><span class="op" id="3125045">.</span><span class="op" id="3125046">(</span><span class="keyword" id="3125047">type</span><span class="op" id="3125051">)</span>&nbsp;<span class="op" id="3125053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125057">default</span><span class="op" id="3125064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3125069">println</span><span class="op" id="3125076">(</span><span class="string" id="3125077">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3125109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125114">return</span>&nbsp;<span class="builtintype" id="3125121">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125129">case</span>&nbsp;<span class="op" id="3125134">*</span><span class="builtintype" id="3125135">uint16</span><span class="op" id="3125141">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125146">if</span>&nbsp;<span class="ident" id="3125149">off</span><span class="op" id="3125152">+</span><span class="num" id="3125153">2</span>&nbsp;<span class="op" id="3125155">&gt;</span>&nbsp;<span class="builtinfunc" id="3125157">len</span><span class="op" id="3125160">(</span><span class="ident" id="3125161">msg</span><span class="op" id="3125164">)</span>&nbsp;<span class="op" id="3125166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125172">return</span>&nbsp;<span class="builtintype" id="3125179">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125193">*</span><span class="ident" id="3125194">fv</span>&nbsp;<span class="op" id="3125197">=</span>&nbsp;<span class="builtintype" id="3125199">uint16</span><span class="op" id="3125205">(</span><span class="ident" id="3125206">msg</span><span class="op" id="3125209">[</span><span class="ident" id="3125210">off</span><span class="op" id="3125213">]</span><span class="op" id="3125214">)</span><span class="op" id="3125215">&lt;&lt;</span><span class="num" id="3125217">8</span>&nbsp;<span class="op" id="3125219">|</span>&nbsp;<span class="builtintype" id="3125221">uint16</span><span class="op" id="3125227">(</span><span class="ident" id="3125228">msg</span><span class="op" id="3125231">[</span><span class="ident" id="3125232">off</span><span class="op" id="3125235">+</span><span class="num" id="3125236">1</span><span class="op" id="3125237">]</span><span class="op" id="3125238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125243">off</span>&nbsp;<span class="op" id="3125247">+=</span>&nbsp;<span class="num" id="3125250">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125254">case</span>&nbsp;<span class="op" id="3125259">*</span><span class="builtintype" id="3125260">uint32</span><span class="op" id="3125266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125271">if</span>&nbsp;<span class="ident" id="3125274">off</span><span class="op" id="3125277">+</span><span class="num" id="3125278">4</span>&nbsp;<span class="op" id="3125280">&gt;</span>&nbsp;<span class="builtinfunc" id="3125282">len</span><span class="op" id="3125285">(</span><span class="ident" id="3125286">msg</span><span class="op" id="3125289">)</span>&nbsp;<span class="op" id="3125291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125297">return</span>&nbsp;<span class="builtintype" id="3125304">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125318">*</span><span class="ident" id="3125319">fv</span>&nbsp;<span class="op" id="3125322">=</span>&nbsp;<span class="builtintype" id="3125324">uint32</span><span class="op" id="3125330">(</span><span class="ident" id="3125331">msg</span><span class="op" id="3125334">[</span><span class="ident" id="3125335">off</span><span class="op" id="3125338">]</span><span class="op" id="3125339">)</span><span class="op" id="3125340">&lt;&lt;</span><span class="num" id="3125342">24</span>&nbsp;<span class="op" id="3125345">|</span>&nbsp;<span class="builtintype" id="3125347">uint32</span><span class="op" id="3125353">(</span><span class="ident" id="3125354">msg</span><span class="op" id="3125357">[</span><span class="ident" id="3125358">off</span><span class="op" id="3125361">+</span><span class="num" id="3125362">1</span><span class="op" id="3125363">]</span><span class="op" id="3125364">)</span><span class="op" id="3125365">&lt;&lt;</span><span class="num" id="3125367">16</span>&nbsp;<span class="op" id="3125370">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3125376">uint32</span><span class="op" id="3125382">(</span><span class="ident" id="3125383">msg</span><span class="op" id="3125386">[</span><span class="ident" id="3125387">off</span><span class="op" id="3125390">+</span><span class="num" id="3125391">2</span><span class="op" id="3125392">]</span><span class="op" id="3125393">)</span><span class="op" id="3125394">&lt;&lt;</span><span class="num" id="3125396">8</span>&nbsp;<span class="op" id="3125398">|</span>&nbsp;<span class="builtintype" id="3125400">uint32</span><span class="op" id="3125406">(</span><span class="ident" id="3125407">msg</span><span class="op" id="3125410">[</span><span class="ident" id="3125411">off</span><span class="op" id="3125414">+</span><span class="num" id="3125415">3</span><span class="op" id="3125416">]</span><span class="op" id="3125417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125422">off</span>&nbsp;<span class="op" id="3125426">+=</span>&nbsp;<span class="num" id="3125429">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125433">case</span>&nbsp;<span class="op" id="3125438">[</span><span class="op" id="3125439">]</span><span class="builtintype" id="3125440">byte</span><span class="op" id="3125444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125449">n</span>&nbsp;<span class="op" id="3125451">:=</span>&nbsp;<span class="builtinfunc" id="3125454">len</span><span class="op" id="3125457">(</span><span class="ident" id="3125458">fv</span><span class="op" id="3125460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125465">if</span>&nbsp;<span class="ident" id="3125468">off</span><span class="op" id="3125471">+</span><span class="ident" id="3125472">n</span>&nbsp;<span class="op" id="3125474">&gt;</span>&nbsp;<span class="builtinfunc" id="3125476">len</span><span class="op" id="3125479">(</span><span class="ident" id="3125480">msg</span><span class="op" id="3125483">)</span>&nbsp;<span class="op" id="3125485">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125491">return</span>&nbsp;<span class="builtintype" id="3125498">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3125512">copy</span><span class="op" id="3125516">(</span><span class="ident" id="3125517">fv</span><span class="op" id="3125519">,</span>&nbsp;<span class="ident" id="3125521">msg</span><span class="op" id="3125524">[</span><span class="ident" id="3125525">off</span><span class="op" id="3125528">:</span><span class="ident" id="3125529">off</span><span class="op" id="3125532">+</span><span class="ident" id="3125533">n</span><span class="op" id="3125534">]</span><span class="op" id="3125535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125540">off</span>&nbsp;<span class="op" id="3125544">+=</span>&nbsp;<span class="ident" id="3125547">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125551">case</span>&nbsp;<span class="op" id="3125556">*</span><span class="builtintype" id="3125557">string</span><span class="op" id="3125563">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125568">var</span>&nbsp;<span class="ident" id="3125572">s</span>&nbsp;<span class="builtintype" id="3125574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125584">switch</span>&nbsp;<span class="ident" id="3125591">tag</span>&nbsp;<span class="op" id="3125595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125600">default</span><span class="op" id="3125607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3125613">println</span><span class="op" id="3125620">(</span><span class="string" id="3125621">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3125651">,</span>&nbsp;<span class="ident" id="3125653">tag</span><span class="op" id="3125656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125662">return</span>&nbsp;<span class="builtintype" id="3125669">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125678">case</span>&nbsp;<span class="string" id="3125683">&#34;domain&#34;</span><span class="op" id="3125691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125697">s</span><span class="op" id="3125698">,</span>&nbsp;<span class="ident" id="3125700">off</span><span class="op" id="3125703">,</span>&nbsp;<span class="ident" id="3125705">ok</span>&nbsp;<span class="op" id="3125708">=</span>&nbsp;<span class="ident" id="3125710">unpackDomainName</span><span class="op" id="3125726">(</span><span class="ident" id="3125727">msg</span><span class="op" id="3125730">,</span>&nbsp;<span class="ident" id="3125732">off</span><span class="op" id="3125735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125741">if</span>&nbsp;<span class="op" id="3125744">!</span><span class="ident" id="3125745">ok</span>&nbsp;<span class="op" id="3125748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125755">return</span>&nbsp;<span class="builtintype" id="3125762">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125772">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125777">case</span>&nbsp;<span class="string" id="3125782">&#34;&#34;</span><span class="op" id="3125784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125790">if</span>&nbsp;<span class="ident" id="3125793">off</span>&nbsp;<span class="op" id="3125797">&gt;=</span>&nbsp;<span class="builtinfunc" id="3125800">len</span><span class="op" id="3125803">(</span><span class="ident" id="3125804">msg</span><span class="op" id="3125807">)</span>&nbsp;<span class="op" id="3125809">||</span>&nbsp;<span class="ident" id="3125812">off</span><span class="op" id="3125815">+</span><span class="num" id="3125816">1</span><span class="op" id="3125817">+</span><span class="builtintype" id="3125818">int</span><span class="op" id="3125821">(</span><span class="ident" id="3125822">msg</span><span class="op" id="3125825">[</span><span class="ident" id="3125826">off</span><span class="op" id="3125829">]</span><span class="op" id="3125830">)</span>&nbsp;<span class="op" id="3125832">&gt;</span>&nbsp;<span class="builtinfunc" id="3125834">len</span><span class="op" id="3125837">(</span><span class="ident" id="3125838">msg</span><span class="op" id="3125841">)</span>&nbsp;<span class="op" id="3125843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125850">return</span>&nbsp;<span class="builtintype" id="3125857">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125873">n</span>&nbsp;<span class="op" id="3125875">:=</span>&nbsp;<span class="builtintype" id="3125878">int</span><span class="op" id="3125881">(</span><span class="ident" id="3125882">msg</span><span class="op" id="3125885">[</span><span class="ident" id="3125886">off</span><span class="op" id="3125889">]</span><span class="op" id="3125890">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125896">off</span><span class="op" id="3125899">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125906">b</span>&nbsp;<span class="op" id="3125908">:=</span>&nbsp;<span class="builtinfunc" id="3125911">make</span><span class="op" id="3125915">(</span><span class="op" id="3125916">[</span><span class="op" id="3125917">]</span><span class="builtintype" id="3125918">byte</span><span class="op" id="3125922">,</span>&nbsp;<span class="ident" id="3125924">n</span><span class="op" id="3125925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125931">for</span>&nbsp;<span class="ident" id="3125935">i</span>&nbsp;<span class="op" id="3125937">:=</span>&nbsp;<span class="num" id="3125940">0</span><span class="op" id="3125941">;</span>&nbsp;<span class="ident" id="3125943">i</span>&nbsp;<span class="op" id="3125945">&lt;</span>&nbsp;<span class="ident" id="3125947">n</span><span class="op" id="3125948">;</span>&nbsp;<span class="ident" id="3125950">i</span><span class="op" id="3125951">++</span>&nbsp;<span class="op" id="3125954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125961">b</span><span class="op" id="3125962">[</span><span class="ident" id="3125963">i</span><span class="op" id="3125964">]</span>&nbsp;<span class="op" id="3125966">=</span>&nbsp;<span class="ident" id="3125968">msg</span><span class="op" id="3125971">[</span><span class="ident" id="3125972">off</span><span class="op" id="3125975">+</span><span class="ident" id="3125976">i</span><span class="op" id="3125977">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125983">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125989">off</span>&nbsp;<span class="op" id="3125993">+=</span>&nbsp;<span class="ident" id="3125996">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126002">s</span>&nbsp;<span class="op" id="3126004">=</span>&nbsp;<span class="builtintype" id="3126006">string</span><span class="op" id="3126012">(</span><span class="ident" id="3126013">b</span><span class="op" id="3126014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126024">*</span><span class="ident" id="3126025">fv</span>&nbsp;<span class="op" id="3126028">=</span>&nbsp;<span class="ident" id="3126030">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126034">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126038">return</span>&nbsp;<span class="builtintype" id="3126045">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126051">}</span><span class="op" id="3126052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126055">if</span>&nbsp;<span class="op" id="3126058">!</span><span class="ident" id="3126059">ok</span>&nbsp;<span class="op" id="3126062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126066">return</span>&nbsp;<span class="builtinfunc" id="3126073">len</span><span class="op" id="3126076">(</span><span class="ident" id="3126077">msg</span><span class="op" id="3126080">)</span><span class="op" id="3126081">,</span>&nbsp;<span class="builtintype" id="3126083">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126090">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126093">return</span>&nbsp;<span class="ident" id="3126100">off</span><span class="op" id="3126103">,</span>&nbsp;<span class="builtintype" id="3126105">true</span><br>
<span class="lineno"></span><span class="op" id="3126110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3126113">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3126180">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3126200">func</span>&nbsp;<span class="ident" id="3126205">printStruct</span><span class="op" id="3126216">(</span><span class="ident" id="3126217">any</span>&nbsp;<span class="ident" id="3126221">dnsStruct</span><span class="op" id="3126230">)</span>&nbsp;<span class="builtintype" id="3126232">string</span>&nbsp;<span class="op" id="3126239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126242">s</span>&nbsp;<span class="op" id="3126244">:=</span>&nbsp;<span class="string" id="3126247">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126252">i</span>&nbsp;<span class="op" id="3126254">:=</span>&nbsp;<span class="num" id="3126257">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126260">any</span><span class="op" id="3126263">.</span><span class="ident" id="3126264">Walk</span><span class="op" id="3126268">(</span><span class="keyword" id="3126269">func</span><span class="op" id="3126273">(</span><span class="ident" id="3126274">val</span>&nbsp;<span class="keyword" id="3126278">interface</span><span class="op" id="3126287">{</span><span class="op" id="3126288">}</span><span class="op" id="3126289">,</span>&nbsp;<span class="ident" id="3126291">name</span><span class="op" id="3126295">,</span>&nbsp;<span class="ident" id="3126297">tag</span>&nbsp;<span class="builtintype" id="3126301">string</span><span class="op" id="3126307">)</span>&nbsp;<span class="builtintype" id="3126309">bool</span>&nbsp;<span class="op" id="3126314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126318">i</span><span class="op" id="3126319">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126324">if</span>&nbsp;<span class="ident" id="3126327">i</span>&nbsp;<span class="op" id="3126329">&gt;</span>&nbsp;<span class="num" id="3126331">1</span>&nbsp;<span class="op" id="3126333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126338">s</span>&nbsp;<span class="op" id="3126340">+=</span>&nbsp;<span class="string" id="3126343">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126354">s</span>&nbsp;<span class="op" id="3126356">+=</span>&nbsp;<span class="ident" id="3126359">name</span>&nbsp;<span class="op" id="3126364">+</span>&nbsp;<span class="string" id="3126366">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126372">switch</span>&nbsp;<span class="ident" id="3126379">tag</span>&nbsp;<span class="op" id="3126383">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126387">case</span>&nbsp;<span class="string" id="3126392">&#34;ipv4&#34;</span><span class="op" id="3126398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126403">i</span>&nbsp;<span class="op" id="3126405">:=</span>&nbsp;<span class="op" id="3126408">*</span><span class="ident" id="3126409">val</span><span class="op" id="3126412">.</span><span class="op" id="3126413">(</span><span class="op" id="3126414">*</span><span class="builtintype" id="3126415">uint32</span><span class="op" id="3126421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126426">s</span>&nbsp;<span class="op" id="3126428">+=</span>&nbsp;<span class="ident" id="3126431">IPv4</span><span class="op" id="3126435">(</span><span class="builtintype" id="3126436">byte</span><span class="op" id="3126440">(</span><span class="ident" id="3126441">i</span><span class="op" id="3126442">&gt;&gt;</span><span class="num" id="3126444">24</span><span class="op" id="3126446">)</span><span class="op" id="3126447">,</span>&nbsp;<span class="builtintype" id="3126449">byte</span><span class="op" id="3126453">(</span><span class="ident" id="3126454">i</span><span class="op" id="3126455">&gt;&gt;</span><span class="num" id="3126457">16</span><span class="op" id="3126459">)</span><span class="op" id="3126460">,</span>&nbsp;<span class="builtintype" id="3126462">byte</span><span class="op" id="3126466">(</span><span class="ident" id="3126467">i</span><span class="op" id="3126468">&gt;&gt;</span><span class="num" id="3126470">8</span><span class="op" id="3126471">)</span><span class="op" id="3126472">,</span>&nbsp;<span class="builtintype" id="3126474">byte</span><span class="op" id="3126478">(</span><span class="ident" id="3126479">i</span><span class="op" id="3126480">)</span><span class="op" id="3126481">)</span><span class="op" id="3126482">.</span><span class="ident" id="3126483">String</span><span class="op" id="3126489">(</span><span class="op" id="3126490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126494">case</span>&nbsp;<span class="string" id="3126499">&#34;ipv6&#34;</span><span class="op" id="3126505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126510">i</span>&nbsp;<span class="op" id="3126512">:=</span>&nbsp;<span class="ident" id="3126515">val</span><span class="op" id="3126518">.</span><span class="op" id="3126519">(</span><span class="op" id="3126520">[</span><span class="op" id="3126521">]</span><span class="builtintype" id="3126522">byte</span><span class="op" id="3126526">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126531">s</span>&nbsp;<span class="op" id="3126533">+=</span>&nbsp;<span class="ident" id="3126536">IP</span><span class="op" id="3126538">(</span><span class="ident" id="3126539">i</span><span class="op" id="3126540">)</span><span class="op" id="3126541">.</span><span class="ident" id="3126542">String</span><span class="op" id="3126548">(</span><span class="op" id="3126549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126553">default</span><span class="op" id="3126560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126565">var</span>&nbsp;<span class="ident" id="3126569">i</span>&nbsp;<span class="ident" id="3126571">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126580">switch</span>&nbsp;<span class="ident" id="3126587">v</span>&nbsp;<span class="op" id="3126589">:=</span>&nbsp;<span class="ident" id="3126592">val</span><span class="op" id="3126595">.</span><span class="op" id="3126596">(</span><span class="keyword" id="3126597">type</span><span class="op" id="3126601">)</span>&nbsp;<span class="op" id="3126603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126608">default</span><span class="op" id="3126615">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3126621">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126649">s</span>&nbsp;<span class="op" id="3126651">+=</span>&nbsp;<span class="string" id="3126654">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126675">return</span>&nbsp;<span class="builtintype" id="3126682">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126690">case</span>&nbsp;<span class="op" id="3126695">*</span><span class="builtintype" id="3126696">string</span><span class="op" id="3126702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126708">s</span>&nbsp;<span class="op" id="3126710">+=</span>&nbsp;<span class="op" id="3126713">*</span><span class="ident" id="3126714">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126720">return</span>&nbsp;<span class="builtintype" id="3126727">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126735">case</span>&nbsp;<span class="op" id="3126740">[</span><span class="op" id="3126741">]</span><span class="builtintype" id="3126742">byte</span><span class="op" id="3126746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126752">s</span>&nbsp;<span class="op" id="3126754">+=</span>&nbsp;<span class="builtintype" id="3126757">string</span><span class="op" id="3126763">(</span><span class="ident" id="3126764">v</span><span class="op" id="3126765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126771">return</span>&nbsp;<span class="builtintype" id="3126778">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126786">case</span>&nbsp;<span class="op" id="3126791">*</span><span class="builtintype" id="3126792">bool</span><span class="op" id="3126796">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126802">if</span>&nbsp;<span class="op" id="3126805">*</span><span class="ident" id="3126806">v</span>&nbsp;<span class="op" id="3126808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126815">s</span>&nbsp;<span class="op" id="3126817">+=</span>&nbsp;<span class="string" id="3126820">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126831">}</span>&nbsp;<span class="keyword" id="3126833">else</span>&nbsp;<span class="op" id="3126838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126845">s</span>&nbsp;<span class="op" id="3126847">+=</span>&nbsp;<span class="string" id="3126850">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126862">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126868">return</span>&nbsp;<span class="builtintype" id="3126875">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126883">case</span>&nbsp;<span class="op" id="3126888">*</span><span class="builtintype" id="3126889">int</span><span class="op" id="3126892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126898">i</span>&nbsp;<span class="op" id="3126900">=</span>&nbsp;<span class="ident" id="3126902">int64</span><span class="op" id="3126907">(</span><span class="op" id="3126908">*</span><span class="ident" id="3126909">v</span><span class="op" id="3126910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126915">case</span>&nbsp;<span class="op" id="3126920">*</span><span class="builtintype" id="3126921">uint</span><span class="op" id="3126925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126931">i</span>&nbsp;<span class="op" id="3126933">=</span>&nbsp;<span class="ident" id="3126935">int64</span><span class="op" id="3126940">(</span><span class="op" id="3126941">*</span><span class="ident" id="3126942">v</span><span class="op" id="3126943">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126948">case</span>&nbsp;<span class="op" id="3126953">*</span><span class="builtintype" id="3126954">uint8</span><span class="op" id="3126959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126965">i</span>&nbsp;<span class="op" id="3126967">=</span>&nbsp;<span class="ident" id="3126969">int64</span><span class="op" id="3126974">(</span><span class="op" id="3126975">*</span><span class="ident" id="3126976">v</span><span class="op" id="3126977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126982">case</span>&nbsp;<span class="op" id="3126987">*</span><span class="builtintype" id="3126988">uint16</span><span class="op" id="3126994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127000">i</span>&nbsp;<span class="op" id="3127002">=</span>&nbsp;<span class="ident" id="3127004">int64</span><span class="op" id="3127009">(</span><span class="op" id="3127010">*</span><span class="ident" id="3127011">v</span><span class="op" id="3127012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127017">case</span>&nbsp;<span class="op" id="3127022">*</span><span class="builtintype" id="3127023">uint32</span><span class="op" id="3127029">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127035">i</span>&nbsp;<span class="op" id="3127037">=</span>&nbsp;<span class="ident" id="3127039">int64</span><span class="op" id="3127044">(</span><span class="op" id="3127045">*</span><span class="ident" id="3127046">v</span><span class="op" id="3127047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127052">case</span>&nbsp;<span class="op" id="3127057">*</span><span class="ident" id="3127058">uint64</span><span class="op" id="3127064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127070">i</span>&nbsp;<span class="op" id="3127072">=</span>&nbsp;<span class="ident" id="3127074">int64</span><span class="op" id="3127079">(</span><span class="op" id="3127080">*</span><span class="ident" id="3127081">v</span><span class="op" id="3127082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127087">case</span>&nbsp;<span class="op" id="3127092">*</span><span class="builtintype" id="3127093">uintptr</span><span class="op" id="3127100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127106">i</span>&nbsp;<span class="op" id="3127108">=</span>&nbsp;<span class="ident" id="3127110">int64</span><span class="op" id="3127115">(</span><span class="op" id="3127116">*</span><span class="ident" id="3127117">v</span><span class="op" id="3127118">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127128">s</span>&nbsp;<span class="op" id="3127130">+=</span>&nbsp;<span class="ident" id="3127133">itoa</span><span class="op" id="3127137">(</span><span class="builtintype" id="3127138">int</span><span class="op" id="3127141">(</span><span class="ident" id="3127142">i</span><span class="op" id="3127143">)</span><span class="op" id="3127144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127152">return</span>&nbsp;<span class="builtintype" id="3127159">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127165">}</span><span class="op" id="3127166">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127169">s</span>&nbsp;<span class="op" id="3127171">+=</span>&nbsp;<span class="string" id="3127174">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127179">return</span>&nbsp;<span class="ident" id="3127186">s</span><br>
<span class="lineno"></span><span class="op" id="3127188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3127191">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3127218">func</span>&nbsp;<span class="ident" id="3127223">packRR</span><span class="op" id="3127229">(</span><span class="ident" id="3127230">rr</span>&nbsp;<span class="ident" id="3127233">dnsRR</span><span class="op" id="3127238">,</span>&nbsp;<span class="ident" id="3127240">msg</span>&nbsp;<span class="op" id="3127244">[</span><span class="op" id="3127245">]</span><span class="builtintype" id="3127246">byte</span><span class="op" id="3127250">,</span>&nbsp;<span class="ident" id="3127252">off</span>&nbsp;<span class="builtintype" id="3127256">int</span><span class="op" id="3127259">)</span>&nbsp;<span class="op" id="3127261">(</span><span class="ident" id="3127262">off2</span>&nbsp;<span class="builtintype" id="3127267">int</span><span class="op" id="3127270">,</span>&nbsp;<span class="ident" id="3127272">ok</span>&nbsp;<span class="builtintype" id="3127275">bool</span><span class="op" id="3127279">)</span>&nbsp;<span class="op" id="3127281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127284">var</span>&nbsp;<span class="ident" id="3127288">off1</span>&nbsp;<span class="builtintype" id="3127293">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127298">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127341">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127378">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127434">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127460">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127482">off1</span><span class="op" id="3127486">,</span>&nbsp;<span class="ident" id="3127488">ok</span>&nbsp;<span class="op" id="3127491">=</span>&nbsp;<span class="ident" id="3127493">packStruct</span><span class="op" id="3127503">(</span><span class="ident" id="3127504">rr</span><span class="op" id="3127506">.</span><span class="ident" id="3127507">Header</span><span class="op" id="3127513">(</span><span class="op" id="3127514">)</span><span class="op" id="3127515">,</span>&nbsp;<span class="ident" id="3127517">msg</span><span class="op" id="3127520">,</span>&nbsp;<span class="ident" id="3127522">off</span><span class="op" id="3127525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127528">off2</span><span class="op" id="3127532">,</span>&nbsp;<span class="ident" id="3127534">ok</span>&nbsp;<span class="op" id="3127537">=</span>&nbsp;<span class="ident" id="3127539">packStruct</span><span class="op" id="3127549">(</span><span class="ident" id="3127550">rr</span><span class="op" id="3127552">,</span>&nbsp;<span class="ident" id="3127554">msg</span><span class="op" id="3127557">,</span>&nbsp;<span class="ident" id="3127559">off</span><span class="op" id="3127562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127565">if</span>&nbsp;<span class="op" id="3127568">!</span><span class="ident" id="3127569">ok</span>&nbsp;<span class="op" id="3127572">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127576">return</span>&nbsp;<span class="builtinfunc" id="3127583">len</span><span class="op" id="3127586">(</span><span class="ident" id="3127587">msg</span><span class="op" id="3127590">)</span><span class="op" id="3127591">,</span>&nbsp;<span class="builtintype" id="3127593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127603">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127663">rr</span><span class="op" id="3127665">.</span><span class="ident" id="3127666">Header</span><span class="op" id="3127672">(</span><span class="op" id="3127673">)</span><span class="op" id="3127674">.</span><span class="ident" id="3127675">Rdlength</span>&nbsp;<span class="op" id="3127684">=</span>&nbsp;<span class="builtintype" id="3127686">uint16</span><span class="op" id="3127692">(</span><span class="ident" id="3127693">off2</span>&nbsp;<span class="op" id="3127698">-</span>&nbsp;<span class="ident" id="3127700">off1</span><span class="op" id="3127704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127707">packStruct</span><span class="op" id="3127717">(</span><span class="ident" id="3127718">rr</span><span class="op" id="3127720">.</span><span class="ident" id="3127721">Header</span><span class="op" id="3127727">(</span><span class="op" id="3127728">)</span><span class="op" id="3127729">,</span>&nbsp;<span class="ident" id="3127731">msg</span><span class="op" id="3127734">,</span>&nbsp;<span class="ident" id="3127736">off</span><span class="op" id="3127739">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127742">return</span>&nbsp;<span class="ident" id="3127749">off2</span><span class="op" id="3127753">,</span>&nbsp;<span class="builtintype" id="3127755">true</span><br>
<span class="lineno"></span><span class="op" id="3127760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3127763">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3127792">func</span>&nbsp;<span class="ident" id="3127797">unpackRR</span><span class="op" id="3127805">(</span><span class="ident" id="3127806">msg</span>&nbsp;<span class="op" id="3127810">[</span><span class="op" id="3127811">]</span><span class="builtintype" id="3127812">byte</span><span class="op" id="3127816">,</span>&nbsp;<span class="ident" id="3127818">off</span>&nbsp;<span class="builtintype" id="3127822">int</span><span class="op" id="3127825">)</span>&nbsp;<span class="op" id="3127827">(</span><span class="ident" id="3127828">rr</span>&nbsp;<span class="ident" id="3127831">dnsRR</span><span class="op" id="3127836">,</span>&nbsp;<span class="ident" id="3127838">off1</span>&nbsp;<span class="builtintype" id="3127843">int</span><span class="op" id="3127846">,</span>&nbsp;<span class="ident" id="3127848">ok</span>&nbsp;<span class="builtintype" id="3127851">bool</span><span class="op" id="3127855">)</span>&nbsp;<span class="op" id="3127857">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127860">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127919">var</span>&nbsp;<span class="ident" id="3127923">h</span>&nbsp;<span class="ident" id="3127925">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127939">off0</span>&nbsp;<span class="op" id="3127944">:=</span>&nbsp;<span class="ident" id="3127947">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127952">if</span>&nbsp;<span class="ident" id="3127955">off</span><span class="op" id="3127958">,</span>&nbsp;<span class="ident" id="3127960">ok</span>&nbsp;<span class="op" id="3127963">=</span>&nbsp;<span class="ident" id="3127965">unpackStruct</span><span class="op" id="3127977">(</span><span class="op" id="3127978">&amp;</span><span class="ident" id="3127979">h</span><span class="op" id="3127980">,</span>&nbsp;<span class="ident" id="3127982">msg</span><span class="op" id="3127985">,</span>&nbsp;<span class="ident" id="3127987">off</span><span class="op" id="3127990">)</span><span class="op" id="3127991">;</span>&nbsp;<span class="op" id="3127993">!</span><span class="ident" id="3127994">ok</span>&nbsp;<span class="op" id="3127997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128001">return</span>&nbsp;<span class="ident" id="3128008">nil</span><span class="op" id="3128011">,</span>&nbsp;<span class="builtinfunc" id="3128013">len</span><span class="op" id="3128016">(</span><span class="ident" id="3128017">msg</span><span class="op" id="3128020">)</span><span class="op" id="3128021">,</span>&nbsp;<span class="builtintype" id="3128023">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3128030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128033">end</span>&nbsp;<span class="op" id="3128037">:=</span>&nbsp;<span class="ident" id="3128040">off</span>&nbsp;<span class="op" id="3128044">+</span>&nbsp;<span class="builtintype" id="3128046">int</span><span class="op" id="3128049">(</span><span class="ident" id="3128050">h</span><span class="op" id="3128051">.</span><span class="ident" id="3128052">Rdlength</span><span class="op" id="3128060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3128064">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3128107">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128158">mk</span><span class="op" id="3128160">,</span>&nbsp;<span class="ident" id="3128162">known</span>&nbsp;<span class="op" id="3128168">:=</span>&nbsp;<span class="ident" id="3128171">rr_mk</span><span class="op" id="3128176">[</span><span class="builtintype" id="3128177">int</span><span class="op" id="3128180">(</span><span class="ident" id="3128181">h</span><span class="op" id="3128182">.</span><span class="ident" id="3128183">Rrtype</span><span class="op" id="3128189">)</span><span class="op" id="3128190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128193">if</span>&nbsp;<span class="op" id="3128196">!</span><span class="ident" id="3128197">known</span>&nbsp;<span class="op" id="3128203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128207">return</span>&nbsp;<span class="op" id="3128214">&amp;</span><span class="ident" id="3128215">h</span><span class="op" id="3128216">,</span>&nbsp;<span class="ident" id="3128218">end</span><span class="op" id="3128221">,</span>&nbsp;<span class="builtintype" id="3128223">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3128229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128232">rr</span>&nbsp;<span class="op" id="3128235">=</span>&nbsp;<span class="ident" id="3128237">mk</span><span class="op" id="3128239">(</span><span class="op" id="3128240">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128243">off</span><span class="op" id="3128246">,</span>&nbsp;<span class="ident" id="3128248">ok</span>&nbsp;<span class="op" id="3128251">=</span>&nbsp;<span class="ident" id="3128253">unpackStruct</span><span class="op" id="3128265">(</span><span class="ident" id="3128266">rr</span><span class="op" id="3128268">,</span>&nbsp;<span class="ident" id="3128270">msg</span><span class="op" id="3128273">,</span>&nbsp;<span class="ident" id="3128275">off0</span><span class="op" id="3128279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128282">if</span>&nbsp;<span class="ident" id="3128285">off</span>&nbsp;<span class="op" id="3128289">!=</span>&nbsp;<span class="ident" id="3128292">end</span>&nbsp;<span class="op" id="3128296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128300">return</span>&nbsp;<span class="op" id="3128307">&amp;</span><span class="ident" id="3128308">h</span><span class="op" id="3128309">,</span>&nbsp;<span class="ident" id="3128311">end</span><span class="op" id="3128314">,</span>&nbsp;<span class="builtintype" id="3128316">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3128322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128325">return</span>&nbsp;<span class="ident" id="3128332">rr</span><span class="op" id="3128334">,</span>&nbsp;<span class="ident" id="3128336">off</span><span class="op" id="3128339">,</span>&nbsp;<span class="ident" id="3128341">ok</span><br>
<span class="lineno">710</span><span class="op" id="3128344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3128347">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3128390">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3128436">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3128484">type</span>&nbsp;<span class="ident" id="3128489">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3128499">struct</span>&nbsp;<span class="op" id="3128506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128509">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128529">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128537">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128557">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128563">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128583">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128588">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128608">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128614">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128634">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128640">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128660">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128666">recursion_available</span>&nbsp;<span class="builtintype" id="3128686">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128692">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3128712">int</span><br>
<span class="lineno">725</span><span class="op" id="3128716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3128719">func</span>&nbsp;<span class="op" id="3128724">(</span><span class="ident" id="3128725">h</span>&nbsp;<span class="op" id="3128727">*</span><span class="ident" id="3128728">dnsMsgHdr</span><span class="op" id="3128737">)</span>&nbsp;<span class="ident" id="3128739">Walk</span><span class="op" id="3128743">(</span><span class="ident" id="3128744">f</span>&nbsp;<span class="keyword" id="3128746">func</span><span class="op" id="3128750">(</span><span class="ident" id="3128751">v</span>&nbsp;<span class="keyword" id="3128753">interface</span><span class="op" id="3128762">{</span><span class="op" id="3128763">}</span><span class="op" id="3128764">,</span>&nbsp;<span class="ident" id="3128766">name</span><span class="op" id="3128770">,</span>&nbsp;<span class="ident" id="3128772">tag</span>&nbsp;<span class="builtintype" id="3128776">string</span><span class="op" id="3128782">)</span>&nbsp;<span class="builtintype" id="3128784">bool</span><span class="op" id="3128788">)</span>&nbsp;<span class="builtintype" id="3128790">bool</span>&nbsp;<span class="op" id="3128795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128798">return</span>&nbsp;<span class="ident" id="3128805">f</span><span class="op" id="3128806">(</span><span class="op" id="3128807">&amp;</span><span class="ident" id="3128808">h</span><span class="op" id="3128809">.</span><span class="ident" id="3128810">id</span><span class="op" id="3128812">,</span>&nbsp;<span class="string" id="3128814">&#34;id&#34;</span><span class="op" id="3128818">,</span>&nbsp;<span class="string" id="3128820">&#34;&#34;</span><span class="op" id="3128822">)</span>&nbsp;<span class="op" id="3128824">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128829">f</span><span class="op" id="3128830">(</span><span class="op" id="3128831">&amp;</span><span class="ident" id="3128832">h</span><span class="op" id="3128833">.</span><span class="ident" id="3128834">response</span><span class="op" id="3128842">,</span>&nbsp;<span class="string" id="3128844">&#34;response&#34;</span><span class="op" id="3128854">,</span>&nbsp;<span class="string" id="3128856">&#34;&#34;</span><span class="op" id="3128858">)</span>&nbsp;<span class="op" id="3128860">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128865">f</span><span class="op" id="3128866">(</span><span class="op" id="3128867">&amp;</span><span class="ident" id="3128868">h</span><span class="op" id="3128869">.</span><span class="ident" id="3128870">opcode</span><span class="op" id="3128876">,</span>&nbsp;<span class="string" id="3128878">&#34;opcode&#34;</span><span class="op" id="3128886">,</span>&nbsp;<span class="string" id="3128888">&#34;&#34;</span><span class="op" id="3128890">)</span>&nbsp;<span class="op" id="3128892">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128897">f</span><span class="op" id="3128898">(</span><span class="op" id="3128899">&amp;</span><span class="ident" id="3128900">h</span><span class="op" id="3128901">.</span><span class="ident" id="3128902">authoritative</span><span class="op" id="3128915">,</span>&nbsp;<span class="string" id="3128917">&#34;authoritative&#34;</span><span class="op" id="3128932">,</span>&nbsp;<span class="string" id="3128934">&#34;&#34;</span><span class="op" id="3128936">)</span>&nbsp;<span class="op" id="3128938">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128943">f</span><span class="op" id="3128944">(</span><span class="op" id="3128945">&amp;</span><span class="ident" id="3128946">h</span><span class="op" id="3128947">.</span><span class="ident" id="3128948">truncated</span><span class="op" id="3128957">,</span>&nbsp;<span class="string" id="3128959">&#34;truncated&#34;</span><span class="op" id="3128970">,</span>&nbsp;<span class="string" id="3128972">&#34;&#34;</span><span class="op" id="3128974">)</span>&nbsp;<span class="op" id="3128976">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128981">f</span><span class="op" id="3128982">(</span><span class="op" id="3128983">&amp;</span><span class="ident" id="3128984">h</span><span class="op" id="3128985">.</span><span class="ident" id="3128986">recursion_desired</span><span class="op" id="3129003">,</span>&nbsp;<span class="string" id="3129005">&#34;recursion_desired&#34;</span><span class="op" id="3129024">,</span>&nbsp;<span class="string" id="3129026">&#34;&#34;</span><span class="op" id="3129028">)</span>&nbsp;<span class="op" id="3129030">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129035">f</span><span class="op" id="3129036">(</span><span class="op" id="3129037">&amp;</span><span class="ident" id="3129038">h</span><span class="op" id="3129039">.</span><span class="ident" id="3129040">recursion_available</span><span class="op" id="3129059">,</span>&nbsp;<span class="string" id="3129061">&#34;recursion_available&#34;</span><span class="op" id="3129082">,</span>&nbsp;<span class="string" id="3129084">&#34;&#34;</span><span class="op" id="3129086">)</span>&nbsp;<span class="op" id="3129088">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129093">f</span><span class="op" id="3129094">(</span><span class="op" id="3129095">&amp;</span><span class="ident" id="3129096">h</span><span class="op" id="3129097">.</span><span class="ident" id="3129098">rcode</span><span class="op" id="3129103">,</span>&nbsp;<span class="string" id="3129105">&#34;rcode&#34;</span><span class="op" id="3129112">,</span>&nbsp;<span class="string" id="3129114">&#34;&#34;</span><span class="op" id="3129116">)</span><br>
<span class="lineno"></span><span class="op" id="3129118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3129121">type</span>&nbsp;<span class="ident" id="3129126">dnsMsg</span>&nbsp;<span class="keyword" id="3129133">struct</span>&nbsp;<span class="op" id="3129140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129143">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129154">question</span>&nbsp;<span class="op" id="3129163">[</span><span class="op" id="3129164">]</span><span class="ident" id="3129165">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129178">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3129187">[</span><span class="op" id="3129188">]</span><span class="ident" id="3129189">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129196">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3129205">[</span><span class="op" id="3129206">]</span><span class="ident" id="3129207">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129214">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3129223">[</span><span class="op" id="3129224">]</span><span class="ident" id="3129225">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3129231">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3129234">func</span>&nbsp;<span class="op" id="3129239">(</span><span class="ident" id="3129240">dns</span>&nbsp;<span class="op" id="3129244">*</span><span class="ident" id="3129245">dnsMsg</span><span class="op" id="3129251">)</span>&nbsp;<span class="ident" id="3129253">Pack</span><span class="op" id="3129257">(</span><span class="op" id="3129258">)</span>&nbsp;<span class="op" id="3129260">(</span><span class="ident" id="3129261">msg</span>&nbsp;<span class="op" id="3129265">[</span><span class="op" id="3129266">]</span><span class="builtintype" id="3129267">byte</span><span class="op" id="3129271">,</span>&nbsp;<span class="ident" id="3129273">ok</span>&nbsp;<span class="builtintype" id="3129276">bool</span><span class="op" id="3129280">)</span>&nbsp;<span class="op" id="3129282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129285">var</span>&nbsp;<span class="ident" id="3129289">dh</span>&nbsp;<span class="ident" id="3129292">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129304">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129360">dh</span><span class="op" id="3129362">.</span><span class="ident" id="3129363">Id</span>&nbsp;<span class="op" id="3129366">=</span>&nbsp;<span class="ident" id="3129368">dns</span><span class="op" id="3129371">.</span><span class="ident" id="3129372">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129376">dh</span><span class="op" id="3129378">.</span><span class="ident" id="3129379">Bits</span>&nbsp;<span class="op" id="3129384">=</span>&nbsp;<span class="builtintype" id="3129386">uint16</span><span class="op" id="3129392">(</span><span class="ident" id="3129393">dns</span><span class="op" id="3129396">.</span><span class="ident" id="3129397">opcode</span><span class="op" id="3129403">)</span><span class="op" id="3129404">&lt;&lt;</span><span class="num" id="3129406">11</span>&nbsp;<span class="op" id="3129409">|</span>&nbsp;<span class="builtintype" id="3129411">uint16</span><span class="op" id="3129417">(</span><span class="ident" id="3129418">dns</span><span class="op" id="3129421">.</span><span class="ident" id="3129422">rcode</span><span class="op" id="3129427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129430">if</span>&nbsp;<span class="ident" id="3129433">dns</span><span class="op" id="3129436">.</span><span class="ident" id="3129437">recursion_available</span>&nbsp;<span class="op" id="3129457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129461">dh</span><span class="op" id="3129463">.</span><span class="ident" id="3129464">Bits</span>&nbsp;<span class="op" id="3129469">|=</span>&nbsp;<span class="ident" id="3129472">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129477">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129480">if</span>&nbsp;<span class="ident" id="3129483">dns</span><span class="op" id="3129486">.</span><span class="ident" id="3129487">recursion_desired</span>&nbsp;<span class="op" id="3129505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129509">dh</span><span class="op" id="3129511">.</span><span class="ident" id="3129512">Bits</span>&nbsp;<span class="op" id="3129517">|=</span>&nbsp;<span class="ident" id="3129520">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129528">if</span>&nbsp;<span class="ident" id="3129531">dns</span><span class="op" id="3129534">.</span><span class="ident" id="3129535">truncated</span>&nbsp;<span class="op" id="3129545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129549">dh</span><span class="op" id="3129551">.</span><span class="ident" id="3129552">Bits</span>&nbsp;<span class="op" id="3129557">|=</span>&nbsp;<span class="ident" id="3129560">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129568">if</span>&nbsp;<span class="ident" id="3129571">dns</span><span class="op" id="3129574">.</span><span class="ident" id="3129575">authoritative</span>&nbsp;<span class="op" id="3129589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129593">dh</span><span class="op" id="3129595">.</span><span class="ident" id="3129596">Bits</span>&nbsp;<span class="op" id="3129601">|=</span>&nbsp;<span class="ident" id="3129604">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129612">if</span>&nbsp;<span class="ident" id="3129615">dns</span><span class="op" id="3129618">.</span><span class="ident" id="3129619">response</span>&nbsp;<span class="op" id="3129628">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129632">dh</span><span class="op" id="3129634">.</span><span class="ident" id="3129635">Bits</span>&nbsp;<span class="op" id="3129640">|=</span>&nbsp;<span class="ident" id="3129643">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129652">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129687">question</span>&nbsp;<span class="op" id="3129696">:=</span>&nbsp;<span class="ident" id="3129699">dns</span><span class="op" id="3129702">.</span><span class="ident" id="3129703">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129713">answer</span>&nbsp;<span class="op" id="3129720">:=</span>&nbsp;<span class="ident" id="3129723">dns</span><span class="op" id="3129726">.</span><span class="ident" id="3129727">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129735">ns</span>&nbsp;<span class="op" id="3129738">:=</span>&nbsp;<span class="ident" id="3129741">dns</span><span class="op" id="3129744">.</span><span class="ident" id="3129745">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129749">extra</span>&nbsp;<span class="op" id="3129755">:=</span>&nbsp;<span class="ident" id="3129758">dns</span><span class="op" id="3129761">.</span><span class="ident" id="3129762">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129770">dh</span><span class="op" id="3129772">.</span><span class="ident" id="3129773">Qdcount</span>&nbsp;<span class="op" id="3129781">=</span>&nbsp;<span class="builtintype" id="3129783">uint16</span><span class="op" id="3129789">(</span><span class="builtinfunc" id="3129790">len</span><span class="op" id="3129793">(</span><span class="ident" id="3129794">question</span><span class="op" id="3129802">)</span><span class="op" id="3129803">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129806">dh</span><span class="op" id="3129808">.</span><span class="ident" id="3129809">Ancount</span>&nbsp;<span class="op" id="3129817">=</span>&nbsp;<span class="builtintype" id="3129819">uint16</span><span class="op" id="3129825">(</span><span class="builtinfunc" id="3129826">len</span><span class="op" id="3129829">(</span><span class="ident" id="3129830">answer</span><span class="op" id="3129836">)</span><span class="op" id="3129837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129840">dh</span><span class="op" id="3129842">.</span><span class="ident" id="3129843">Nscount</span>&nbsp;<span class="op" id="3129851">=</span>&nbsp;<span class="builtintype" id="3129853">uint16</span><span class="op" id="3129859">(</span><span class="builtinfunc" id="3129860">len</span><span class="op" id="3129863">(</span><span class="ident" id="3129864">ns</span><span class="op" id="3129866">)</span><span class="op" id="3129867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129870">dh</span><span class="op" id="3129872">.</span><span class="ident" id="3129873">Arcount</span>&nbsp;<span class="op" id="3129881">=</span>&nbsp;<span class="builtintype" id="3129883">uint16</span><span class="op" id="3129889">(</span><span class="builtinfunc" id="3129890">len</span><span class="op" id="3129893">(</span><span class="ident" id="3129894">extra</span><span class="op" id="3129899">)</span><span class="op" id="3129900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129904">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129953">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129999">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130037">msg</span>&nbsp;<span class="op" id="3130041">=</span>&nbsp;<span class="builtinfunc" id="3130043">make</span><span class="op" id="3130047">(</span><span class="op" id="3130048">[</span><span class="op" id="3130049">]</span><span class="builtintype" id="3130050">byte</span><span class="op" id="3130054">,</span>&nbsp;<span class="num" id="3130056">2000</span><span class="op" id="3130060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3130064">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130108">off</span>&nbsp;<span class="op" id="3130112">:=</span>&nbsp;<span class="num" id="3130115">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130118">off</span><span class="op" id="3130121">,</span>&nbsp;<span class="ident" id="3130123">ok</span>&nbsp;<span class="op" id="3130126">=</span>&nbsp;<span class="ident" id="3130128">packStruct</span><span class="op" id="3130138">(</span><span class="op" id="3130139">&amp;</span><span class="ident" id="3130140">dh</span><span class="op" id="3130142">,</span>&nbsp;<span class="ident" id="3130144">msg</span><span class="op" id="3130147">,</span>&nbsp;<span class="ident" id="3130149">off</span><span class="op" id="3130152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130155">for</span>&nbsp;<span class="ident" id="3130159">i</span>&nbsp;<span class="op" id="3130161">:=</span>&nbsp;<span class="num" id="3130164">0</span><span class="op" id="3130165">;</span>&nbsp;<span class="ident" id="3130167">i</span>&nbsp;<span class="op" id="3130169">&lt;</span>&nbsp;<span class="builtinfunc" id="3130171">len</span><span class="op" id="3130174">(</span><span class="ident" id="3130175">question</span><span class="op" id="3130183">)</span><span class="op" id="3130184">;</span>&nbsp;<span class="ident" id="3130186">i</span><span class="op" id="3130187">++</span>&nbsp;<span class="op" id="3130190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130194">off</span><span class="op" id="3130197">,</span>&nbsp;<span class="ident" id="3130199">ok</span>&nbsp;<span class="op" id="3130202">=</span>&nbsp;<span class="ident" id="3130204">packStruct</span><span class="op" id="3130214">(</span><span class="op" id="3130215">&amp;</span><span class="ident" id="3130216">question</span><span class="op" id="3130224">[</span><span class="ident" id="3130225">i</span><span class="op" id="3130226">]</span><span class="op" id="3130227">,</span>&nbsp;<span class="ident" id="3130229">msg</span><span class="op" id="3130232">,</span>&nbsp;<span class="ident" id="3130234">off</span><span class="op" id="3130237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130240">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130243">for</span>&nbsp;<span class="ident" id="3130247">i</span>&nbsp;<span class="op" id="3130249">:=</span>&nbsp;<span class="num" id="3130252">0</span><span class="op" id="3130253">;</span>&nbsp;<span class="ident" id="3130255">i</span>&nbsp;<span class="op" id="3130257">&lt;</span>&nbsp;<span class="builtinfunc" id="3130259">len</span><span class="op" id="3130262">(</span><span class="ident" id="3130263">answer</span><span class="op" id="3130269">)</span><span class="op" id="3130270">;</span>&nbsp;<span class="ident" id="3130272">i</span><span class="op" id="3130273">++</span>&nbsp;<span class="op" id="3130276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130280">off</span><span class="op" id="3130283">,</span>&nbsp;<span class="ident" id="3130285">ok</span>&nbsp;<span class="op" id="3130288">=</span>&nbsp;<span class="ident" id="3130290">packRR</span><span class="op" id="3130296">(</span><span class="ident" id="3130297">answer</span><span class="op" id="3130303">[</span><span class="ident" id="3130304">i</span><span class="op" id="3130305">]</span><span class="op" id="3130306">,</span>&nbsp;<span class="ident" id="3130308">msg</span><span class="op" id="3130311">,</span>&nbsp;<span class="ident" id="3130313">off</span><span class="op" id="3130316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130322">for</span>&nbsp;<span class="ident" id="3130326">i</span>&nbsp;<span class="op" id="3130328">:=</span>&nbsp;<span class="num" id="3130331">0</span><span class="op" id="3130332">;</span>&nbsp;<span class="ident" id="3130334">i</span>&nbsp;<span class="op" id="3130336">&lt;</span>&nbsp;<span class="builtinfunc" id="3130338">len</span><span class="op" id="3130341">(</span><span class="ident" id="3130342">ns</span><span class="op" id="3130344">)</span><span class="op" id="3130345">;</span>&nbsp;<span class="ident" id="3130347">i</span><span class="op" id="3130348">++</span>&nbsp;<span class="op" id="3130351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130355">off</span><span class="op" id="3130358">,</span>&nbsp;<span class="ident" id="3130360">ok</span>&nbsp;<span class="op" id="3130363">=</span>&nbsp;<span class="ident" id="3130365">packRR</span><span class="op" id="3130371">(</span><span class="ident" id="3130372">ns</span><span class="op" id="3130374">[</span><span class="ident" id="3130375">i</span><span class="op" id="3130376">]</span><span class="op" id="3130377">,</span>&nbsp;<span class="ident" id="3130379">msg</span><span class="op" id="3130382">,</span>&nbsp;<span class="ident" id="3130384">off</span><span class="op" id="3130387">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130393">for</span>&nbsp;<span class="ident" id="3130397">i</span>&nbsp;<span class="op" id="3130399">:=</span>&nbsp;<span class="num" id="3130402">0</span><span class="op" id="3130403">;</span>&nbsp;<span class="ident" id="3130405">i</span>&nbsp;<span class="op" id="3130407">&lt;</span>&nbsp;<span class="builtinfunc" id="3130409">len</span><span class="op" id="3130412">(</span><span class="ident" id="3130413">extra</span><span class="op" id="3130418">)</span><span class="op" id="3130419">;</span>&nbsp;<span class="ident" id="3130421">i</span><span class="op" id="3130422">++</span>&nbsp;<span class="op" id="3130425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130429">off</span><span class="op" id="3130432">,</span>&nbsp;<span class="ident" id="3130434">ok</span>&nbsp;<span class="op" id="3130437">=</span>&nbsp;<span class="ident" id="3130439">packRR</span><span class="op" id="3130445">(</span><span class="ident" id="3130446">extra</span><span class="op" id="3130451">[</span><span class="ident" id="3130452">i</span><span class="op" id="3130453">]</span><span class="op" id="3130454">,</span>&nbsp;<span class="ident" id="3130456">msg</span><span class="op" id="3130459">,</span>&nbsp;<span class="ident" id="3130461">off</span><span class="op" id="3130464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130470">if</span>&nbsp;<span class="op" id="3130473">!</span><span class="ident" id="3130474">ok</span>&nbsp;<span class="op" id="3130477">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130481">return</span>&nbsp;<span class="ident" id="3130488">nil</span><span class="op" id="3130491">,</span>&nbsp;<span class="builtintype" id="3130493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130503">return</span>&nbsp;<span class="ident" id="3130510">msg</span><span class="op" id="3130513">[</span><span class="num" id="3130514">0</span><span class="op" id="3130515">:</span><span class="ident" id="3130516">off</span><span class="op" id="3130519">]</span><span class="op" id="3130520">,</span>&nbsp;<span class="builtintype" id="3130522">true</span><br>
<span class="lineno"></span><span class="op" id="3130527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3130530">func</span>&nbsp;<span class="op" id="3130535">(</span><span class="ident" id="3130536">dns</span>&nbsp;<span class="op" id="3130540">*</span><span class="ident" id="3130541">dnsMsg</span><span class="op" id="3130547">)</span>&nbsp;<span class="ident" id="3130549">Unpack</span><span class="op" id="3130555">(</span><span class="ident" id="3130556">msg</span>&nbsp;<span class="op" id="3130560">[</span><span class="op" id="3130561">]</span><span class="builtintype" id="3130562">byte</span><span class="op" id="3130566">)</span>&nbsp;<span class="builtintype" id="3130568">bool</span>&nbsp;<span class="op" id="3130573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3130576">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130588">var</span>&nbsp;<span class="ident" id="3130592">dh</span>&nbsp;<span class="ident" id="3130595">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130606">off</span>&nbsp;<span class="op" id="3130610">:=</span>&nbsp;<span class="num" id="3130613">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130616">var</span>&nbsp;<span class="ident" id="3130620">ok</span>&nbsp;<span class="builtintype" id="3130623">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130629">if</span>&nbsp;<span class="ident" id="3130632">off</span><span class="op" id="3130635">,</span>&nbsp;<span class="ident" id="3130637">ok</span>&nbsp;<span class="op" id="3130640">=</span>&nbsp;<span class="ident" id="3130642">unpackStruct</span><span class="op" id="3130654">(</span><span class="op" id="3130655">&amp;</span><span class="ident" id="3130656">dh</span><span class="op" id="3130658">,</span>&nbsp;<span class="ident" id="3130660">msg</span><span class="op" id="3130663">,</span>&nbsp;<span class="ident" id="3130665">off</span><span class="op" id="3130668">)</span><span class="op" id="3130669">;</span>&nbsp;<span class="op" id="3130671">!</span><span class="ident" id="3130672">ok</span>&nbsp;<span class="op" id="3130675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130679">return</span>&nbsp;<span class="builtintype" id="3130686">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130696">dns</span><span class="op" id="3130699">.</span><span class="ident" id="3130700">id</span>&nbsp;<span class="op" id="3130703">=</span>&nbsp;<span class="ident" id="3130705">dh</span><span class="op" id="3130707">.</span><span class="ident" id="3130708">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130712">dns</span><span class="op" id="3130715">.</span><span class="ident" id="3130716">response</span>&nbsp;<span class="op" id="3130725">=</span>&nbsp;<span class="op" id="3130727">(</span><span class="ident" id="3130728">dh</span><span class="op" id="3130730">.</span><span class="ident" id="3130731">Bits</span>&nbsp;<span class="op" id="3130736">&amp;</span>&nbsp;<span class="ident" id="3130738">_QR</span><span class="op" id="3130741">)</span>&nbsp;<span class="op" id="3130743">!=</span>&nbsp;<span class="num" id="3130746">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130749">dns</span><span class="op" id="3130752">.</span><span class="ident" id="3130753">opcode</span>&nbsp;<span class="op" id="3130760">=</span>&nbsp;<span class="builtintype" id="3130762">int</span><span class="op" id="3130765">(</span><span class="ident" id="3130766">dh</span><span class="op" id="3130768">.</span><span class="ident" id="3130769">Bits</span><span class="op" id="3130773">&gt;&gt;</span><span class="num" id="3130775">11</span><span class="op" id="3130777">)</span>&nbsp;<span class="op" id="3130779">&amp;</span>&nbsp;<span class="num" id="3130781">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130786">dns</span><span class="op" id="3130789">.</span><span class="ident" id="3130790">authoritative</span>&nbsp;<span class="op" id="3130804">=</span>&nbsp;<span class="op" id="3130806">(</span><span class="ident" id="3130807">dh</span><span class="op" id="3130809">.</span><span class="ident" id="3130810">Bits</span>&nbsp;<span class="op" id="3130815">&amp;</span>&nbsp;<span class="ident" id="3130817">_AA</span><span class="op" id="3130820">)</span>&nbsp;<span class="op" id="3130822">!=</span>&nbsp;<span class="num" id="3130825">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130828">dns</span><span class="op" id="3130831">.</span><span class="ident" id="3130832">truncated</span>&nbsp;<span class="op" id="3130842">=</span>&nbsp;<span class="op" id="3130844">(</span><span class="ident" id="3130845">dh</span><span class="op" id="3130847">.</span><span class="ident" id="3130848">Bits</span>&nbsp;<span class="op" id="3130853">&amp;</span>&nbsp;<span class="ident" id="3130855">_TC</span><span class="op" id="3130858">)</span>&nbsp;<span class="op" id="3130860">!=</span>&nbsp;<span class="num" id="3130863">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130866">dns</span><span class="op" id="3130869">.</span><span class="ident" id="3130870">recursion_desired</span>&nbsp;<span class="op" id="3130888">=</span>&nbsp;<span class="op" id="3130890">(</span><span class="ident" id="3130891">dh</span><span class="op" id="3130893">.</span><span class="ident" id="3130894">Bits</span>&nbsp;<span class="op" id="3130899">&amp;</span>&nbsp;<span class="ident" id="3130901">_RD</span><span class="op" id="3130904">)</span>&nbsp;<span class="op" id="3130906">!=</span>&nbsp;<span class="num" id="3130909">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130912">dns</span><span class="op" id="3130915">.</span><span class="ident" id="3130916">recursion_available</span>&nbsp;<span class="op" id="3130936">=</span>&nbsp;<span class="op" id="3130938">(</span><span class="ident" id="3130939">dh</span><span class="op" id="3130941">.</span><span class="ident" id="3130942">Bits</span>&nbsp;<span class="op" id="3130947">&amp;</span>&nbsp;<span class="ident" id="3130949">_RA</span><span class="op" id="3130952">)</span>&nbsp;<span class="op" id="3130954">!=</span>&nbsp;<span class="num" id="3130957">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130960">dns</span><span class="op" id="3130963">.</span><span class="ident" id="3130964">rcode</span>&nbsp;<span class="op" id="3130970">=</span>&nbsp;<span class="builtintype" id="3130972">int</span><span class="op" id="3130975">(</span><span class="ident" id="3130976">dh</span><span class="op" id="3130978">.</span><span class="ident" id="3130979">Bits</span>&nbsp;<span class="op" id="3130984">&amp;</span>&nbsp;<span class="num" id="3130986">0xF</span><span class="op" id="3130989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3130993">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131005">dns</span><span class="op" id="3131008">.</span><span class="ident" id="3131009">question</span>&nbsp;<span class="op" id="3131018">=</span>&nbsp;<span class="builtinfunc" id="3131020">make</span><span class="op" id="3131024">(</span><span class="op" id="3131025">[</span><span class="op" id="3131026">]</span><span class="ident" id="3131027">dnsQuestion</span><span class="op" id="3131038">,</span>&nbsp;<span class="ident" id="3131040">dh</span><span class="op" id="3131042">.</span><span class="ident" id="3131043">Qdcount</span><span class="op" id="3131050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131053">dns</span><span class="op" id="3131056">.</span><span class="ident" id="3131057">answer</span>&nbsp;<span class="op" id="3131064">=</span>&nbsp;<span class="builtinfunc" id="3131066">make</span><span class="op" id="3131070">(</span><span class="op" id="3131071">[</span><span class="op" id="3131072">]</span><span class="ident" id="3131073">dnsRR</span><span class="op" id="3131078">,</span>&nbsp;<span class="num" id="3131080">0</span><span class="op" id="3131081">,</span>&nbsp;<span class="ident" id="3131083">dh</span><span class="op" id="3131085">.</span><span class="ident" id="3131086">Ancount</span><span class="op" id="3131093">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131096">dns</span><span class="op" id="3131099">.</span><span class="ident" id="3131100">ns</span>&nbsp;<span class="op" id="3131103">=</span>&nbsp;<span class="builtinfunc" id="3131105">make</span><span class="op" id="3131109">(</span><span class="op" id="3131110">[</span><span class="op" id="3131111">]</span><span class="ident" id="3131112">dnsRR</span><span class="op" id="3131117">,</span>&nbsp;<span class="num" id="3131119">0</span><span class="op" id="3131120">,</span>&nbsp;<span class="ident" id="3131122">dh</span><span class="op" id="3131124">.</span><span class="ident" id="3131125">Nscount</span><span class="op" id="3131132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131135">dns</span><span class="op" id="3131138">.</span><span class="ident" id="3131139">extra</span>&nbsp;<span class="op" id="3131145">=</span>&nbsp;<span class="builtinfunc" id="3131147">make</span><span class="op" id="3131151">(</span><span class="op" id="3131152">[</span><span class="op" id="3131153">]</span><span class="ident" id="3131154">dnsRR</span><span class="op" id="3131159">,</span>&nbsp;<span class="num" id="3131161">0</span><span class="op" id="3131162">,</span>&nbsp;<span class="ident" id="3131164">dh</span><span class="op" id="3131166">.</span><span class="ident" id="3131167">Arcount</span><span class="op" id="3131174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131178">var</span>&nbsp;<span class="ident" id="3131182">rec</span>&nbsp;<span class="ident" id="3131186">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131194">for</span>&nbsp;<span class="ident" id="3131198">i</span>&nbsp;<span class="op" id="3131200">:=</span>&nbsp;<span class="num" id="3131203">0</span><span class="op" id="3131204">;</span>&nbsp;<span class="ident" id="3131206">i</span>&nbsp;<span class="op" id="3131208">&lt;</span>&nbsp;<span class="builtinfunc" id="3131210">len</span><span class="op" id="3131213">(</span><span class="ident" id="3131214">dns</span><span class="op" id="3131217">.</span><span class="ident" id="3131218">question</span><span class="op" id="3131226">)</span><span class="op" id="3131227">;</span>&nbsp;<span class="ident" id="3131229">i</span><span class="op" id="3131230">++</span>&nbsp;<span class="op" id="3131233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131237">off</span><span class="op" id="3131240">,</span>&nbsp;<span class="ident" id="3131242">ok</span>&nbsp;<span class="op" id="3131245">=</span>&nbsp;<span class="ident" id="3131247">unpackStruct</span><span class="op" id="3131259">(</span><span class="op" id="3131260">&amp;</span><span class="ident" id="3131261">dns</span><span class="op" id="3131264">.</span><span class="ident" id="3131265">question</span><span class="op" id="3131273">[</span><span class="ident" id="3131274">i</span><span class="op" id="3131275">]</span><span class="op" id="3131276">,</span>&nbsp;<span class="ident" id="3131278">msg</span><span class="op" id="3131281">,</span>&nbsp;<span class="ident" id="3131283">off</span><span class="op" id="3131286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131292">for</span>&nbsp;<span class="ident" id="3131296">i</span>&nbsp;<span class="op" id="3131298">:=</span>&nbsp;<span class="num" id="3131301">0</span><span class="op" id="3131302">;</span>&nbsp;<span class="ident" id="3131304">i</span>&nbsp;<span class="op" id="3131306">&lt;</span>&nbsp;<span class="builtintype" id="3131308">int</span><span class="op" id="3131311">(</span><span class="ident" id="3131312">dh</span><span class="op" id="3131314">.</span><span class="ident" id="3131315">Ancount</span><span class="op" id="3131322">)</span><span class="op" id="3131323">;</span>&nbsp;<span class="ident" id="3131325">i</span><span class="op" id="3131326">++</span>&nbsp;<span class="op" id="3131329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131333">rec</span><span class="op" id="3131336">,</span>&nbsp;<span class="ident" id="3131338">off</span><span class="op" id="3131341">,</span>&nbsp;<span class="ident" id="3131343">ok</span>&nbsp;<span class="op" id="3131346">=</span>&nbsp;<span class="ident" id="3131348">unpackRR</span><span class="op" id="3131356">(</span><span class="ident" id="3131357">msg</span><span class="op" id="3131360">,</span>&nbsp;<span class="ident" id="3131362">off</span><span class="op" id="3131365">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131369">if</span>&nbsp;<span class="op" id="3131372">!</span><span class="ident" id="3131373">ok</span>&nbsp;<span class="op" id="3131376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131381">return</span>&nbsp;<span class="builtintype" id="3131388">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131400">dns</span><span class="op" id="3131403">.</span><span class="ident" id="3131404">answer</span>&nbsp;<span class="op" id="3131411">=</span>&nbsp;<span class="builtinfunc" id="3131413">append</span><span class="op" id="3131419">(</span><span class="ident" id="3131420">dns</span><span class="op" id="3131423">.</span><span class="ident" id="3131424">answer</span><span class="op" id="3131430">,</span>&nbsp;<span class="ident" id="3131432">rec</span><span class="op" id="3131435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131438">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131441">for</span>&nbsp;<span class="ident" id="3131445">i</span>&nbsp;<span class="op" id="3131447">:=</span>&nbsp;<span class="num" id="3131450">0</span><span class="op" id="3131451">;</span>&nbsp;<span class="ident" id="3131453">i</span>&nbsp;<span class="op" id="3131455">&lt;</span>&nbsp;<span class="builtintype" id="3131457">int</span><span class="op" id="3131460">(</span><span class="ident" id="3131461">dh</span><span class="op" id="3131463">.</span><span class="ident" id="3131464">Nscount</span><span class="op" id="3131471">)</span><span class="op" id="3131472">;</span>&nbsp;<span class="ident" id="3131474">i</span><span class="op" id="3131475">++</span>&nbsp;<span class="op" id="3131478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131482">rec</span><span class="op" id="3131485">,</span>&nbsp;<span class="ident" id="3131487">off</span><span class="op" id="3131490">,</span>&nbsp;<span class="ident" id="3131492">ok</span>&nbsp;<span class="op" id="3131495">=</span>&nbsp;<span class="ident" id="3131497">unpackRR</span><span class="op" id="3131505">(</span><span class="ident" id="3131506">msg</span><span class="op" id="3131509">,</span>&nbsp;<span class="ident" id="3131511">off</span><span class="op" id="3131514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131518">if</span>&nbsp;<span class="op" id="3131521">!</span><span class="ident" id="3131522">ok</span>&nbsp;<span class="op" id="3131525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131530">return</span>&nbsp;<span class="builtintype" id="3131537">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131545">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131549">dns</span><span class="op" id="3131552">.</span><span class="ident" id="3131553">ns</span>&nbsp;<span class="op" id="3131556">=</span>&nbsp;<span class="builtinfunc" id="3131558">append</span><span class="op" id="3131564">(</span><span class="ident" id="3131565">dns</span><span class="op" id="3131568">.</span><span class="ident" id="3131569">ns</span><span class="op" id="3131571">,</span>&nbsp;<span class="ident" id="3131573">rec</span><span class="op" id="3131576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131582">for</span>&nbsp;<span class="ident" id="3131586">i</span>&nbsp;<span class="op" id="3131588">:=</span>&nbsp;<span class="num" id="3131591">0</span><span class="op" id="3131592">;</span>&nbsp;<span class="ident" id="3131594">i</span>&nbsp;<span class="op" id="3131596">&lt;</span>&nbsp;<span class="builtintype" id="3131598">int</span><span class="op" id="3131601">(</span><span class="ident" id="3131602">dh</span><span class="op" id="3131604">.</span><span class="ident" id="3131605">Arcount</span><span class="op" id="3131612">)</span><span class="op" id="3131613">;</span>&nbsp;<span class="ident" id="3131615">i</span><span class="op" id="3131616">++</span>&nbsp;<span class="op" id="3131619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131623">rec</span><span class="op" id="3131626">,</span>&nbsp;<span class="ident" id="3131628">off</span><span class="op" id="3131631">,</span>&nbsp;<span class="ident" id="3131633">ok</span>&nbsp;<span class="op" id="3131636">=</span>&nbsp;<span class="ident" id="3131638">unpackRR</span><span class="op" id="3131646">(</span><span class="ident" id="3131647">msg</span><span class="op" id="3131650">,</span>&nbsp;<span class="ident" id="3131652">off</span><span class="op" id="3131655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131659">if</span>&nbsp;<span class="op" id="3131662">!</span><span class="ident" id="3131663">ok</span>&nbsp;<span class="op" id="3131666">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131671">return</span>&nbsp;<span class="builtintype" id="3131678">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131690">dns</span><span class="op" id="3131693">.</span><span class="ident" id="3131694">extra</span>&nbsp;<span class="op" id="3131700">=</span>&nbsp;<span class="builtinfunc" id="3131702">append</span><span class="op" id="3131708">(</span><span class="ident" id="3131709">dns</span><span class="op" id="3131712">.</span><span class="ident" id="3131713">extra</span><span class="op" id="3131718">,</span>&nbsp;<span class="ident" id="3131720">rec</span><span class="op" id="3131723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3131729">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3131754">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3131817">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131823">return</span>&nbsp;<span class="builtintype" id="3131830">true</span><br>
<span class="lineno"></span><span class="op" id="3131835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3131838">func</span>&nbsp;<span class="op" id="3131843">(</span><span class="ident" id="3131844">dns</span>&nbsp;<span class="op" id="3131848">*</span><span class="ident" id="3131849">dnsMsg</span><span class="op" id="3131855">)</span>&nbsp;<span class="ident" id="3131857">String</span><span class="op" id="3131863">(</span><span class="op" id="3131864">)</span>&nbsp;<span class="builtintype" id="3131866">string</span>&nbsp;<span class="op" id="3131873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131876">s</span>&nbsp;<span class="op" id="3131878">:=</span>&nbsp;<span class="string" id="3131881">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3131889">+</span>&nbsp;<span class="ident" id="3131891">printStruct</span><span class="op" id="3131902">(</span><span class="op" id="3131903">&amp;</span><span class="ident" id="3131904">dns</span><span class="op" id="3131907">.</span><span class="ident" id="3131908">dnsMsgHdr</span><span class="op" id="3131917">)</span>&nbsp;<span class="op" id="3131919">+</span>&nbsp;<span class="string" id="3131921">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131927">if</span>&nbsp;<span class="builtinfunc" id="3131930">len</span><span class="op" id="3131933">(</span><span class="ident" id="3131934">dns</span><span class="op" id="3131937">.</span><span class="ident" id="3131938">question</span><span class="op" id="3131946">)</span>&nbsp;<span class="op" id="3131948">&gt;</span>&nbsp;<span class="num" id="3131950">0</span>&nbsp;<span class="op" id="3131952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131956">s</span>&nbsp;<span class="op" id="3131958">+=</span>&nbsp;<span class="string" id="3131961">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131980">for</span>&nbsp;<span class="ident" id="3131984">i</span>&nbsp;<span class="op" id="3131986">:=</span>&nbsp;<span class="num" id="3131989">0</span><span class="op" id="3131990">;</span>&nbsp;<span class="ident" id="3131992">i</span>&nbsp;<span class="op" id="3131994">&lt;</span>&nbsp;<span class="builtinfunc" id="3131996">len</span><span class="op" id="3131999">(</span><span class="ident" id="3132000">dns</span><span class="op" id="3132003">.</span><span class="ident" id="3132004">question</span><span class="op" id="3132012">)</span><span class="op" id="3132013">;</span>&nbsp;<span class="ident" id="3132015">i</span><span class="op" id="3132016">++</span>&nbsp;<span class="op" id="3132019">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132024">s</span>&nbsp;<span class="op" id="3132026">+=</span>&nbsp;<span class="ident" id="3132029">printStruct</span><span class="op" id="3132040">(</span><span class="op" id="3132041">&amp;</span><span class="ident" id="3132042">dns</span><span class="op" id="3132045">.</span><span class="ident" id="3132046">question</span><span class="op" id="3132054">[</span><span class="ident" id="3132055">i</span><span class="op" id="3132056">]</span><span class="op" id="3132057">)</span>&nbsp;<span class="op" id="3132059">+</span>&nbsp;<span class="string" id="3132061">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132074">if</span>&nbsp;<span class="builtinfunc" id="3132077">len</span><span class="op" id="3132080">(</span><span class="ident" id="3132081">dns</span><span class="op" id="3132084">.</span><span class="ident" id="3132085">answer</span><span class="op" id="3132091">)</span>&nbsp;<span class="op" id="3132093">&gt;</span>&nbsp;<span class="num" id="3132095">0</span>&nbsp;<span class="op" id="3132097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132101">s</span>&nbsp;<span class="op" id="3132103">+=</span>&nbsp;<span class="string" id="3132106">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132123">for</span>&nbsp;<span class="ident" id="3132127">i</span>&nbsp;<span class="op" id="3132129">:=</span>&nbsp;<span class="num" id="3132132">0</span><span class="op" id="3132133">;</span>&nbsp;<span class="ident" id="3132135">i</span>&nbsp;<span class="op" id="3132137">&lt;</span>&nbsp;<span class="builtinfunc" id="3132139">len</span><span class="op" id="3132142">(</span><span class="ident" id="3132143">dns</span><span class="op" id="3132146">.</span><span class="ident" id="3132147">answer</span><span class="op" id="3132153">)</span><span class="op" id="3132154">;</span>&nbsp;<span class="ident" id="3132156">i</span><span class="op" id="3132157">++</span>&nbsp;<span class="op" id="3132160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132165">s</span>&nbsp;<span class="op" id="3132167">+=</span>&nbsp;<span class="ident" id="3132170">printStruct</span><span class="op" id="3132181">(</span><span class="ident" id="3132182">dns</span><span class="op" id="3132185">.</span><span class="ident" id="3132186">answer</span><span class="op" id="3132192">[</span><span class="ident" id="3132193">i</span><span class="op" id="3132194">]</span><span class="op" id="3132195">)</span>&nbsp;<span class="op" id="3132197">+</span>&nbsp;<span class="string" id="3132199">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132212">if</span>&nbsp;<span class="builtinfunc" id="3132215">len</span><span class="op" id="3132218">(</span><span class="ident" id="3132219">dns</span><span class="op" id="3132222">.</span><span class="ident" id="3132223">ns</span><span class="op" id="3132225">)</span>&nbsp;<span class="op" id="3132227">&gt;</span>&nbsp;<span class="num" id="3132229">0</span>&nbsp;<span class="op" id="3132231">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132235">s</span>&nbsp;<span class="op" id="3132237">+=</span>&nbsp;<span class="string" id="3132240">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132262">for</span>&nbsp;<span class="ident" id="3132266">i</span>&nbsp;<span class="op" id="3132268">:=</span>&nbsp;<span class="num" id="3132271">0</span><span class="op" id="3132272">;</span>&nbsp;<span class="ident" id="3132274">i</span>&nbsp;<span class="op" id="3132276">&lt;</span>&nbsp;<span class="builtinfunc" id="3132278">len</span><span class="op" id="3132281">(</span><span class="ident" id="3132282">dns</span><span class="op" id="3132285">.</span><span class="ident" id="3132286">ns</span><span class="op" id="3132288">)</span><span class="op" id="3132289">;</span>&nbsp;<span class="ident" id="3132291">i</span><span class="op" id="3132292">++</span>&nbsp;<span class="op" id="3132295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132300">s</span>&nbsp;<span class="op" id="3132302">+=</span>&nbsp;<span class="ident" id="3132305">printStruct</span><span class="op" id="3132316">(</span><span class="ident" id="3132317">dns</span><span class="op" id="3132320">.</span><span class="ident" id="3132321">ns</span><span class="op" id="3132323">[</span><span class="ident" id="3132324">i</span><span class="op" id="3132325">]</span><span class="op" id="3132326">)</span>&nbsp;<span class="op" id="3132328">+</span>&nbsp;<span class="string" id="3132330">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132340">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132343">if</span>&nbsp;<span class="builtinfunc" id="3132346">len</span><span class="op" id="3132349">(</span><span class="ident" id="3132350">dns</span><span class="op" id="3132353">.</span><span class="ident" id="3132354">extra</span><span class="op" id="3132359">)</span>&nbsp;<span class="op" id="3132361">&gt;</span>&nbsp;<span class="num" id="3132363">0</span>&nbsp;<span class="op" id="3132365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132369">s</span>&nbsp;<span class="op" id="3132371">+=</span>&nbsp;<span class="string" id="3132374">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132389">for</span>&nbsp;<span class="ident" id="3132393">i</span>&nbsp;<span class="op" id="3132395">:=</span>&nbsp;<span class="num" id="3132398">0</span><span class="op" id="3132399">;</span>&nbsp;<span class="ident" id="3132401">i</span>&nbsp;<span class="op" id="3132403">&lt;</span>&nbsp;<span class="builtinfunc" id="3132405">len</span><span class="op" id="3132408">(</span><span class="ident" id="3132409">dns</span><span class="op" id="3132412">.</span><span class="ident" id="3132413">extra</span><span class="op" id="3132418">)</span><span class="op" id="3132419">;</span>&nbsp;<span class="ident" id="3132421">i</span><span class="op" id="3132422">++</span>&nbsp;<span class="op" id="3132425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132430">s</span>&nbsp;<span class="op" id="3132432">+=</span>&nbsp;<span class="ident" id="3132435">printStruct</span><span class="op" id="3132446">(</span><span class="ident" id="3132447">dns</span><span class="op" id="3132450">.</span><span class="ident" id="3132451">extra</span><span class="op" id="3132456">[</span><span class="ident" id="3132457">i</span><span class="op" id="3132458">]</span><span class="op" id="3132459">)</span>&nbsp;<span class="op" id="3132461">+</span>&nbsp;<span class="string" id="3132463">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132470">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132476">return</span>&nbsp;<span class="ident" id="3132483">s</span><br>
<span class="lineno"></span><span class="op" id="3132485">}</span>
</div>
</body>
</html>
