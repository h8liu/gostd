<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3137259">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3137314">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3137368">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3137419">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3137492">package</span>&nbsp;<span class="ident" id="3137500">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3137505">import</span>&nbsp;<span class="op" id="3137512">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3137515">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3137523">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3137534">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3137541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3137544">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="3137622">func</span>&nbsp;<span class="ident" id="3137627">runtimeNano</span><span class="op" id="3137638">(</span><span class="op" id="3137639">)</span>&nbsp;<span class="ident" id="3137641">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3137648">func</span>&nbsp;<span class="ident" id="3137653">runtime_pollServerInit</span><span class="op" id="3137675">(</span><span class="op" id="3137676">)</span><br>
<span class="lineno"></span><span class="keyword" id="3137678">func</span>&nbsp;<span class="ident" id="3137683">runtime_pollOpen</span><span class="op" id="3137699">(</span><span class="ident" id="3137700">fd</span>&nbsp;<span class="builtintype" id="3137703">uintptr</span><span class="op" id="3137710">)</span>&nbsp;<span class="op" id="3137712">(</span><span class="builtintype" id="3137713">uintptr</span><span class="op" id="3137720">,</span>&nbsp;<span class="builtintype" id="3137722">int</span><span class="op" id="3137725">)</span><br>
<span class="lineno">20</span><span class="keyword" id="3137727">func</span>&nbsp;<span class="ident" id="3137732">runtime_pollClose</span><span class="op" id="3137749">(</span><span class="ident" id="3137750">ctx</span>&nbsp;<span class="builtintype" id="3137754">uintptr</span><span class="op" id="3137761">)</span><br>
<span class="lineno"></span><span class="keyword" id="3137763">func</span>&nbsp;<span class="ident" id="3137768">runtime_pollWait</span><span class="op" id="3137784">(</span><span class="ident" id="3137785">ctx</span>&nbsp;<span class="builtintype" id="3137789">uintptr</span><span class="op" id="3137796">,</span>&nbsp;<span class="ident" id="3137798">mode</span>&nbsp;<span class="builtintype" id="3137803">int</span><span class="op" id="3137806">)</span>&nbsp;<span class="builtintype" id="3137808">int</span><br>
<span class="lineno"></span><span class="keyword" id="3137812">func</span>&nbsp;<span class="ident" id="3137817">runtime_pollWaitCanceled</span><span class="op" id="3137841">(</span><span class="ident" id="3137842">ctx</span>&nbsp;<span class="builtintype" id="3137846">uintptr</span><span class="op" id="3137853">,</span>&nbsp;<span class="ident" id="3137855">mode</span>&nbsp;<span class="builtintype" id="3137860">int</span><span class="op" id="3137863">)</span>&nbsp;<span class="builtintype" id="3137865">int</span><br>
<span class="lineno"></span><span class="keyword" id="3137869">func</span>&nbsp;<span class="ident" id="3137874">runtime_pollReset</span><span class="op" id="3137891">(</span><span class="ident" id="3137892">ctx</span>&nbsp;<span class="builtintype" id="3137896">uintptr</span><span class="op" id="3137903">,</span>&nbsp;<span class="ident" id="3137905">mode</span>&nbsp;<span class="builtintype" id="3137910">int</span><span class="op" id="3137913">)</span>&nbsp;<span class="builtintype" id="3137915">int</span><br>
<span class="lineno"></span><span class="keyword" id="3137919">func</span>&nbsp;<span class="ident" id="3137924">runtime_pollSetDeadline</span><span class="op" id="3137947">(</span><span class="ident" id="3137948">ctx</span>&nbsp;<span class="builtintype" id="3137952">uintptr</span><span class="op" id="3137959">,</span>&nbsp;<span class="ident" id="3137961">d</span>&nbsp;<span class="ident" id="3137963">int64</span><span class="op" id="3137968">,</span>&nbsp;<span class="ident" id="3137970">mode</span>&nbsp;<span class="builtintype" id="3137975">int</span><span class="op" id="3137978">)</span><br>
<span class="lineno">25</span><span class="keyword" id="3137980">func</span>&nbsp;<span class="ident" id="3137985">runtime_pollUnblock</span><span class="op" id="3138004">(</span><span class="ident" id="3138005">ctx</span>&nbsp;<span class="builtintype" id="3138009">uintptr</span><span class="op" id="3138016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138019">type</span>&nbsp;<span class="ident" id="3138024">pollDesc</span>&nbsp;<span class="keyword" id="3138033">struct</span>&nbsp;<span class="op" id="3138040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138043">runtimeCtx</span>&nbsp;<span class="builtintype" id="3138054">uintptr</span><br>
<span class="lineno"></span><span class="op" id="3138062">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3138065">var</span>&nbsp;<span class="ident" id="3138069">serverInit</span>&nbsp;<span class="ident" id="3138080">sync</span><span class="op" id="3138084">.</span><span class="ident" id="3138085">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138091">func</span>&nbsp;<span class="op" id="3138096">(</span><span class="ident" id="3138097">pd</span>&nbsp;<span class="op" id="3138100">*</span><span class="ident" id="3138101">pollDesc</span><span class="op" id="3138109">)</span>&nbsp;<span class="ident" id="3138111">Init</span><span class="op" id="3138115">(</span><span class="ident" id="3138116">fd</span>&nbsp;<span class="op" id="3138119">*</span><span class="ident" id="3138120">netFD</span><span class="op" id="3138125">)</span>&nbsp;<span class="builtintype" id="3138127">error</span>&nbsp;<span class="op" id="3138133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138136">serverInit</span><span class="op" id="3138146">.</span><span class="ident" id="3138147">Do</span><span class="op" id="3138149">(</span><span class="ident" id="3138150">runtime_pollServerInit</span><span class="op" id="3138172">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138175">ctx</span><span class="op" id="3138178">,</span>&nbsp;<span class="ident" id="3138180">errno</span>&nbsp;<span class="op" id="3138186">:=</span>&nbsp;<span class="ident" id="3138189">runtime_pollOpen</span><span class="op" id="3138205">(</span><span class="builtintype" id="3138206">uintptr</span><span class="op" id="3138213">(</span><span class="ident" id="3138214">fd</span><span class="op" id="3138216">.</span><span class="ident" id="3138217">sysfd</span><span class="op" id="3138222">)</span><span class="op" id="3138223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138226">if</span>&nbsp;<span class="ident" id="3138229">errno</span>&nbsp;<span class="op" id="3138235">!=</span>&nbsp;<span class="num" id="3138238">0</span>&nbsp;<span class="op" id="3138240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138244">return</span>&nbsp;<span class="ident" id="3138251">syscall</span><span class="op" id="3138258">.</span><span class="ident" id="3138259">Errno</span><span class="op" id="3138264">(</span><span class="ident" id="3138265">errno</span><span class="op" id="3138270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138276">pd</span><span class="op" id="3138278">.</span><span class="ident" id="3138279">runtimeCtx</span>&nbsp;<span class="op" id="3138290">=</span>&nbsp;<span class="ident" id="3138292">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138297">return</span>&nbsp;<span class="ident" id="3138304">nil</span><br>
<span class="lineno"></span><span class="op" id="3138308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138311">func</span>&nbsp;<span class="op" id="3138316">(</span><span class="ident" id="3138317">pd</span>&nbsp;<span class="op" id="3138320">*</span><span class="ident" id="3138321">pollDesc</span><span class="op" id="3138329">)</span>&nbsp;<span class="ident" id="3138331">Close</span><span class="op" id="3138336">(</span><span class="op" id="3138337">)</span>&nbsp;<span class="op" id="3138339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138342">if</span>&nbsp;<span class="ident" id="3138345">pd</span><span class="op" id="3138347">.</span><span class="ident" id="3138348">runtimeCtx</span>&nbsp;<span class="op" id="3138359">==</span>&nbsp;<span class="num" id="3138362">0</span>&nbsp;<span class="op" id="3138364">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138368">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138379">runtime_pollClose</span><span class="op" id="3138396">(</span><span class="ident" id="3138397">pd</span><span class="op" id="3138399">.</span><span class="ident" id="3138400">runtimeCtx</span><span class="op" id="3138410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138413">pd</span><span class="op" id="3138415">.</span><span class="ident" id="3138416">runtimeCtx</span>&nbsp;<span class="op" id="3138427">=</span>&nbsp;<span class="num" id="3138429">0</span><br>
<span class="lineno"></span><span class="op" id="3138431">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3138434">func</span>&nbsp;<span class="op" id="3138439">(</span><span class="ident" id="3138440">pd</span>&nbsp;<span class="op" id="3138443">*</span><span class="ident" id="3138444">pollDesc</span><span class="op" id="3138452">)</span>&nbsp;<span class="ident" id="3138454">Lock</span><span class="op" id="3138458">(</span><span class="op" id="3138459">)</span>&nbsp;<span class="op" id="3138461">{</span><br>
<span class="lineno"></span><span class="op" id="3138463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138466">func</span>&nbsp;<span class="op" id="3138471">(</span><span class="ident" id="3138472">pd</span>&nbsp;<span class="op" id="3138475">*</span><span class="ident" id="3138476">pollDesc</span><span class="op" id="3138484">)</span>&nbsp;<span class="ident" id="3138486">Unlock</span><span class="op" id="3138492">(</span><span class="op" id="3138493">)</span>&nbsp;<span class="op" id="3138495">{</span><br>
<span class="lineno">55</span><span class="op" id="3138497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138500">func</span>&nbsp;<span class="op" id="3138505">(</span><span class="ident" id="3138506">pd</span>&nbsp;<span class="op" id="3138509">*</span><span class="ident" id="3138510">pollDesc</span><span class="op" id="3138518">)</span>&nbsp;<span class="ident" id="3138520">Wakeup</span><span class="op" id="3138526">(</span><span class="op" id="3138527">)</span>&nbsp;<span class="op" id="3138529">{</span><br>
<span class="lineno"></span><span class="op" id="3138531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3138534">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="3138610">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="3138672">func</span>&nbsp;<span class="op" id="3138677">(</span><span class="ident" id="3138678">pd</span>&nbsp;<span class="op" id="3138681">*</span><span class="ident" id="3138682">pollDesc</span><span class="op" id="3138690">)</span>&nbsp;<span class="ident" id="3138692">Evict</span><span class="op" id="3138697">(</span><span class="op" id="3138698">)</span>&nbsp;<span class="builtintype" id="3138700">bool</span>&nbsp;<span class="op" id="3138705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138708">if</span>&nbsp;<span class="ident" id="3138711">pd</span><span class="op" id="3138713">.</span><span class="ident" id="3138714">runtimeCtx</span>&nbsp;<span class="op" id="3138725">==</span>&nbsp;<span class="num" id="3138728">0</span>&nbsp;<span class="op" id="3138730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138734">return</span>&nbsp;<span class="builtintype" id="3138741">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138751">runtime_pollUnblock</span><span class="op" id="3138770">(</span><span class="ident" id="3138771">pd</span><span class="op" id="3138773">.</span><span class="ident" id="3138774">runtimeCtx</span><span class="op" id="3138784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138787">return</span>&nbsp;<span class="builtintype" id="3138794">false</span><br>
<span class="lineno"></span><span class="op" id="3138800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3138803">func</span>&nbsp;<span class="op" id="3138808">(</span><span class="ident" id="3138809">pd</span>&nbsp;<span class="op" id="3138812">*</span><span class="ident" id="3138813">pollDesc</span><span class="op" id="3138821">)</span>&nbsp;<span class="ident" id="3138823">Prepare</span><span class="op" id="3138830">(</span><span class="ident" id="3138831">mode</span>&nbsp;<span class="builtintype" id="3138836">int</span><span class="op" id="3138839">)</span>&nbsp;<span class="builtintype" id="3138841">error</span>&nbsp;<span class="op" id="3138847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138850">res</span>&nbsp;<span class="op" id="3138854">:=</span>&nbsp;<span class="ident" id="3138857">runtime_pollReset</span><span class="op" id="3138874">(</span><span class="ident" id="3138875">pd</span><span class="op" id="3138877">.</span><span class="ident" id="3138878">runtimeCtx</span><span class="op" id="3138888">,</span>&nbsp;<span class="ident" id="3138890">mode</span><span class="op" id="3138894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138897">return</span>&nbsp;<span class="ident" id="3138904">convertErr</span><span class="op" id="3138914">(</span><span class="ident" id="3138915">res</span><span class="op" id="3138918">)</span><br>
<span class="lineno"></span><span class="op" id="3138920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="3138923">func</span>&nbsp;<span class="op" id="3138928">(</span><span class="ident" id="3138929">pd</span>&nbsp;<span class="op" id="3138932">*</span><span class="ident" id="3138933">pollDesc</span><span class="op" id="3138941">)</span>&nbsp;<span class="ident" id="3138943">PrepareRead</span><span class="op" id="3138954">(</span><span class="op" id="3138955">)</span>&nbsp;<span class="builtintype" id="3138957">error</span>&nbsp;<span class="op" id="3138963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138966">return</span>&nbsp;<span class="ident" id="3138973">pd</span><span class="op" id="3138975">.</span><span class="ident" id="3138976">Prepare</span><span class="op" id="3138983">(</span><span class="string" id="3138984">&#39;r&#39;</span><span class="op" id="3138987">)</span><br>
<span class="lineno"></span><span class="op" id="3138989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138992">func</span>&nbsp;<span class="op" id="3138997">(</span><span class="ident" id="3138998">pd</span>&nbsp;<span class="op" id="3139001">*</span><span class="ident" id="3139002">pollDesc</span><span class="op" id="3139010">)</span>&nbsp;<span class="ident" id="3139012">PrepareWrite</span><span class="op" id="3139024">(</span><span class="op" id="3139025">)</span>&nbsp;<span class="builtintype" id="3139027">error</span>&nbsp;<span class="op" id="3139033">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139036">return</span>&nbsp;<span class="ident" id="3139043">pd</span><span class="op" id="3139045">.</span><span class="ident" id="3139046">Prepare</span><span class="op" id="3139053">(</span><span class="string" id="3139054">&#39;w&#39;</span><span class="op" id="3139057">)</span><br>
<span class="lineno"></span><span class="op" id="3139059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139062">func</span>&nbsp;<span class="op" id="3139067">(</span><span class="ident" id="3139068">pd</span>&nbsp;<span class="op" id="3139071">*</span><span class="ident" id="3139072">pollDesc</span><span class="op" id="3139080">)</span>&nbsp;<span class="ident" id="3139082">Wait</span><span class="op" id="3139086">(</span><span class="ident" id="3139087">mode</span>&nbsp;<span class="builtintype" id="3139092">int</span><span class="op" id="3139095">)</span>&nbsp;<span class="builtintype" id="3139097">error</span>&nbsp;<span class="op" id="3139103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139106">res</span>&nbsp;<span class="op" id="3139110">:=</span>&nbsp;<span class="ident" id="3139113">runtime_pollWait</span><span class="op" id="3139129">(</span><span class="ident" id="3139130">pd</span><span class="op" id="3139132">.</span><span class="ident" id="3139133">runtimeCtx</span><span class="op" id="3139143">,</span>&nbsp;<span class="ident" id="3139145">mode</span><span class="op" id="3139149">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139152">return</span>&nbsp;<span class="ident" id="3139159">convertErr</span><span class="op" id="3139169">(</span><span class="ident" id="3139170">res</span><span class="op" id="3139173">)</span><br>
<span class="lineno"></span><span class="op" id="3139175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139178">func</span>&nbsp;<span class="op" id="3139183">(</span><span class="ident" id="3139184">pd</span>&nbsp;<span class="op" id="3139187">*</span><span class="ident" id="3139188">pollDesc</span><span class="op" id="3139196">)</span>&nbsp;<span class="ident" id="3139198">WaitRead</span><span class="op" id="3139206">(</span><span class="op" id="3139207">)</span>&nbsp;<span class="builtintype" id="3139209">error</span>&nbsp;<span class="op" id="3139215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139218">return</span>&nbsp;<span class="ident" id="3139225">pd</span><span class="op" id="3139227">.</span><span class="ident" id="3139228">Wait</span><span class="op" id="3139232">(</span><span class="string" id="3139233">&#39;r&#39;</span><span class="op" id="3139236">)</span><br>
<span class="lineno">90</span><span class="op" id="3139238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139241">func</span>&nbsp;<span class="op" id="3139246">(</span><span class="ident" id="3139247">pd</span>&nbsp;<span class="op" id="3139250">*</span><span class="ident" id="3139251">pollDesc</span><span class="op" id="3139259">)</span>&nbsp;<span class="ident" id="3139261">WaitWrite</span><span class="op" id="3139270">(</span><span class="op" id="3139271">)</span>&nbsp;<span class="builtintype" id="3139273">error</span>&nbsp;<span class="op" id="3139279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139282">return</span>&nbsp;<span class="ident" id="3139289">pd</span><span class="op" id="3139291">.</span><span class="ident" id="3139292">Wait</span><span class="op" id="3139296">(</span><span class="string" id="3139297">&#39;w&#39;</span><span class="op" id="3139300">)</span><br>
<span class="lineno"></span><span class="op" id="3139302">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3139305">func</span>&nbsp;<span class="op" id="3139310">(</span><span class="ident" id="3139311">pd</span>&nbsp;<span class="op" id="3139314">*</span><span class="ident" id="3139315">pollDesc</span><span class="op" id="3139323">)</span>&nbsp;<span class="ident" id="3139325">WaitCanceled</span><span class="op" id="3139337">(</span><span class="ident" id="3139338">mode</span>&nbsp;<span class="builtintype" id="3139343">int</span><span class="op" id="3139346">)</span>&nbsp;<span class="op" id="3139348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139351">runtime_pollWaitCanceled</span><span class="op" id="3139375">(</span><span class="ident" id="3139376">pd</span><span class="op" id="3139378">.</span><span class="ident" id="3139379">runtimeCtx</span><span class="op" id="3139389">,</span>&nbsp;<span class="ident" id="3139391">mode</span><span class="op" id="3139395">)</span><br>
<span class="lineno"></span><span class="op" id="3139397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3139400">func</span>&nbsp;<span class="op" id="3139405">(</span><span class="ident" id="3139406">pd</span>&nbsp;<span class="op" id="3139409">*</span><span class="ident" id="3139410">pollDesc</span><span class="op" id="3139418">)</span>&nbsp;<span class="ident" id="3139420">WaitCanceledRead</span><span class="op" id="3139436">(</span><span class="op" id="3139437">)</span>&nbsp;<span class="op" id="3139439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139442">pd</span><span class="op" id="3139444">.</span><span class="ident" id="3139445">WaitCanceled</span><span class="op" id="3139457">(</span><span class="string" id="3139458">&#39;r&#39;</span><span class="op" id="3139461">)</span><br>
<span class="lineno"></span><span class="op" id="3139463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139466">func</span>&nbsp;<span class="op" id="3139471">(</span><span class="ident" id="3139472">pd</span>&nbsp;<span class="op" id="3139475">*</span><span class="ident" id="3139476">pollDesc</span><span class="op" id="3139484">)</span>&nbsp;<span class="ident" id="3139486">WaitCanceledWrite</span><span class="op" id="3139503">(</span><span class="op" id="3139504">)</span>&nbsp;<span class="op" id="3139506">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139509">pd</span><span class="op" id="3139511">.</span><span class="ident" id="3139512">WaitCanceled</span><span class="op" id="3139524">(</span><span class="string" id="3139525">&#39;w&#39;</span><span class="op" id="3139528">)</span><br>
<span class="lineno"></span><span class="op" id="3139530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139533">func</span>&nbsp;<span class="ident" id="3139538">convertErr</span><span class="op" id="3139548">(</span><span class="ident" id="3139549">res</span>&nbsp;<span class="builtintype" id="3139553">int</span><span class="op" id="3139556">)</span>&nbsp;<span class="builtintype" id="3139558">error</span>&nbsp;<span class="op" id="3139564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139567">switch</span>&nbsp;<span class="ident" id="3139574">res</span>&nbsp;<span class="op" id="3139578">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139581">case</span>&nbsp;<span class="num" id="3139586">0</span><span class="op" id="3139587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139591">return</span>&nbsp;<span class="ident" id="3139598">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139603">case</span>&nbsp;<span class="num" id="3139608">1</span><span class="op" id="3139609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139613">return</span>&nbsp;<span class="ident" id="3139620">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139632">case</span>&nbsp;<span class="num" id="3139637">2</span><span class="op" id="3139638">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139642">return</span>&nbsp;<span class="ident" id="3139649">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3139661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3139664">println</span><span class="op" id="3139671">(</span><span class="string" id="3139672">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="3139687">,</span>&nbsp;<span class="ident" id="3139689">res</span><span class="op" id="3139692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3139695">panic</span><span class="op" id="3139700">(</span><span class="string" id="3139701">&#34;unreachable&#34;</span><span class="op" id="3139714">)</span><br>
<span class="lineno"></span><span class="op" id="3139716">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3139719">func</span>&nbsp;<span class="op" id="3139724">(</span><span class="ident" id="3139725">fd</span>&nbsp;<span class="op" id="3139728">*</span><span class="ident" id="3139729">netFD</span><span class="op" id="3139734">)</span>&nbsp;<span class="ident" id="3139736">setDeadline</span><span class="op" id="3139747">(</span><span class="ident" id="3139748">t</span>&nbsp;<span class="ident" id="3139750">time</span><span class="op" id="3139754">.</span><span class="ident" id="3139755">Time</span><span class="op" id="3139759">)</span>&nbsp;<span class="builtintype" id="3139761">error</span>&nbsp;<span class="op" id="3139767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139770">return</span>&nbsp;<span class="ident" id="3139777">setDeadlineImpl</span><span class="op" id="3139792">(</span><span class="ident" id="3139793">fd</span><span class="op" id="3139795">,</span>&nbsp;<span class="ident" id="3139797">t</span><span class="op" id="3139798">,</span>&nbsp;<span class="string" id="3139800">&#39;r&#39;</span><span class="op" id="3139803">+</span><span class="string" id="3139804">&#39;w&#39;</span><span class="op" id="3139807">)</span><br>
<span class="lineno"></span><span class="op" id="3139809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3139812">func</span>&nbsp;<span class="op" id="3139817">(</span><span class="ident" id="3139818">fd</span>&nbsp;<span class="op" id="3139821">*</span><span class="ident" id="3139822">netFD</span><span class="op" id="3139827">)</span>&nbsp;<span class="ident" id="3139829">setReadDeadline</span><span class="op" id="3139844">(</span><span class="ident" id="3139845">t</span>&nbsp;<span class="ident" id="3139847">time</span><span class="op" id="3139851">.</span><span class="ident" id="3139852">Time</span><span class="op" id="3139856">)</span>&nbsp;<span class="builtintype" id="3139858">error</span>&nbsp;<span class="op" id="3139864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139867">return</span>&nbsp;<span class="ident" id="3139874">setDeadlineImpl</span><span class="op" id="3139889">(</span><span class="ident" id="3139890">fd</span><span class="op" id="3139892">,</span>&nbsp;<span class="ident" id="3139894">t</span><span class="op" id="3139895">,</span>&nbsp;<span class="string" id="3139897">&#39;r&#39;</span><span class="op" id="3139900">)</span><br>
<span class="lineno"></span><span class="op" id="3139902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139905">func</span>&nbsp;<span class="op" id="3139910">(</span><span class="ident" id="3139911">fd</span>&nbsp;<span class="op" id="3139914">*</span><span class="ident" id="3139915">netFD</span><span class="op" id="3139920">)</span>&nbsp;<span class="ident" id="3139922">setWriteDeadline</span><span class="op" id="3139938">(</span><span class="ident" id="3139939">t</span>&nbsp;<span class="ident" id="3139941">time</span><span class="op" id="3139945">.</span><span class="ident" id="3139946">Time</span><span class="op" id="3139950">)</span>&nbsp;<span class="builtintype" id="3139952">error</span>&nbsp;<span class="op" id="3139958">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139961">return</span>&nbsp;<span class="ident" id="3139968">setDeadlineImpl</span><span class="op" id="3139983">(</span><span class="ident" id="3139984">fd</span><span class="op" id="3139986">,</span>&nbsp;<span class="ident" id="3139988">t</span><span class="op" id="3139989">,</span>&nbsp;<span class="string" id="3139991">&#39;w&#39;</span><span class="op" id="3139994">)</span><br>
<span class="lineno"></span><span class="op" id="3139996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139999">func</span>&nbsp;<span class="ident" id="3140004">setDeadlineImpl</span><span class="op" id="3140019">(</span><span class="ident" id="3140020">fd</span>&nbsp;<span class="op" id="3140023">*</span><span class="ident" id="3140024">netFD</span><span class="op" id="3140029">,</span>&nbsp;<span class="ident" id="3140031">t</span>&nbsp;<span class="ident" id="3140033">time</span><span class="op" id="3140037">.</span><span class="ident" id="3140038">Time</span><span class="op" id="3140042">,</span>&nbsp;<span class="ident" id="3140044">mode</span>&nbsp;<span class="builtintype" id="3140049">int</span><span class="op" id="3140052">)</span>&nbsp;<span class="builtintype" id="3140054">error</span>&nbsp;<span class="op" id="3140060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140063">d</span>&nbsp;<span class="op" id="3140065">:=</span>&nbsp;<span class="ident" id="3140068">runtimeNano</span><span class="op" id="3140079">(</span><span class="op" id="3140080">)</span>&nbsp;<span class="op" id="3140082">+</span>&nbsp;<span class="ident" id="3140084">int64</span><span class="op" id="3140089">(</span><span class="ident" id="3140090">t</span><span class="op" id="3140091">.</span><span class="ident" id="3140092">Sub</span><span class="op" id="3140095">(</span><span class="ident" id="3140096">time</span><span class="op" id="3140100">.</span><span class="ident" id="3140101">Now</span><span class="op" id="3140104">(</span><span class="op" id="3140105">)</span><span class="op" id="3140106">)</span><span class="op" id="3140107">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140110">if</span>&nbsp;<span class="ident" id="3140113">t</span><span class="op" id="3140114">.</span><span class="ident" id="3140115">IsZero</span><span class="op" id="3140121">(</span><span class="op" id="3140122">)</span>&nbsp;<span class="op" id="3140124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140128">d</span>&nbsp;<span class="op" id="3140130">=</span>&nbsp;<span class="num" id="3140132">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3140135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140138">if</span>&nbsp;<span class="ident" id="3140141">err</span>&nbsp;<span class="op" id="3140145">:=</span>&nbsp;<span class="ident" id="3140148">fd</span><span class="op" id="3140150">.</span><span class="ident" id="3140151">incref</span><span class="op" id="3140157">(</span><span class="op" id="3140158">)</span><span class="op" id="3140159">;</span>&nbsp;<span class="ident" id="3140161">err</span>&nbsp;<span class="op" id="3140165">!=</span>&nbsp;<span class="ident" id="3140168">nil</span>&nbsp;<span class="op" id="3140172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140176">return</span>&nbsp;<span class="ident" id="3140183">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3140188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140191">runtime_pollSetDeadline</span><span class="op" id="3140214">(</span><span class="ident" id="3140215">fd</span><span class="op" id="3140217">.</span><span class="ident" id="3140218">pd</span><span class="op" id="3140220">.</span><span class="ident" id="3140221">runtimeCtx</span><span class="op" id="3140231">,</span>&nbsp;<span class="ident" id="3140233">d</span><span class="op" id="3140234">,</span>&nbsp;<span class="ident" id="3140236">mode</span><span class="op" id="3140240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140243">fd</span><span class="op" id="3140245">.</span><span class="ident" id="3140246">decref</span><span class="op" id="3140252">(</span><span class="op" id="3140253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140256">return</span>&nbsp;<span class="ident" id="3140263">nil</span><br>
<span class="lineno"></span><span class="op" id="3140267">}</span>
</div>
</body>
</html>
