<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3363421">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3363476">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3363530">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3363581">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3363609">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3363654">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3363695">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3363756">package</span>&nbsp;<span class="ident" id="3363764">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3363770">import</span>&nbsp;<span class="string" id="3363777">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3363785">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3363832">type</span>&nbsp;<span class="ident" id="3363837">Zipf</span>&nbsp;<span class="keyword" id="3363842">struct</span>&nbsp;<span class="op" id="3363849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363852">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363865">*</span><span class="ident" id="3363866">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363872">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363885">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363894">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363907">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363916">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363929">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363938">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363951">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363960">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363973">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363982">oneminusQinv</span>&nbsp;<span class="builtintype" id="3363995">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364004">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3364017">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364026">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3364039">float64</span><br>
<span class="lineno">25</span><span class="op" id="3364047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364050">func</span>&nbsp;<span class="op" id="3364055">(</span><span class="ident" id="3364056">z</span>&nbsp;<span class="op" id="3364058">*</span><span class="ident" id="3364059">Zipf</span><span class="op" id="3364063">)</span>&nbsp;<span class="ident" id="3364065">h</span><span class="op" id="3364066">(</span><span class="ident" id="3364067">x</span>&nbsp;<span class="builtintype" id="3364069">float64</span><span class="op" id="3364076">)</span>&nbsp;<span class="builtintype" id="3364078">float64</span>&nbsp;<span class="op" id="3364086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364089">return</span>&nbsp;<span class="ident" id="3364096">math</span><span class="op" id="3364100">.</span><span class="ident" id="3364101">Exp</span><span class="op" id="3364104">(</span><span class="ident" id="3364105">z</span><span class="op" id="3364106">.</span><span class="ident" id="3364107">oneminusQ</span><span class="op" id="3364116">*</span><span class="ident" id="3364117">math</span><span class="op" id="3364121">.</span><span class="ident" id="3364122">Log</span><span class="op" id="3364125">(</span><span class="ident" id="3364126">z</span><span class="op" id="3364127">.</span><span class="ident" id="3364128">v</span><span class="op" id="3364129">+</span><span class="ident" id="3364130">x</span><span class="op" id="3364131">)</span><span class="op" id="3364132">)</span>&nbsp;<span class="op" id="3364134">*</span>&nbsp;<span class="ident" id="3364136">z</span><span class="op" id="3364137">.</span><span class="ident" id="3364138">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3364151">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3364154">func</span>&nbsp;<span class="op" id="3364159">(</span><span class="ident" id="3364160">z</span>&nbsp;<span class="op" id="3364162">*</span><span class="ident" id="3364163">Zipf</span><span class="op" id="3364167">)</span>&nbsp;<span class="ident" id="3364169">hinv</span><span class="op" id="3364173">(</span><span class="ident" id="3364174">x</span>&nbsp;<span class="builtintype" id="3364176">float64</span><span class="op" id="3364183">)</span>&nbsp;<span class="builtintype" id="3364185">float64</span>&nbsp;<span class="op" id="3364193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364196">return</span>&nbsp;<span class="ident" id="3364203">math</span><span class="op" id="3364207">.</span><span class="ident" id="3364208">Exp</span><span class="op" id="3364211">(</span><span class="ident" id="3364212">z</span><span class="op" id="3364213">.</span><span class="ident" id="3364214">oneminusQinv</span><span class="op" id="3364226">*</span><span class="ident" id="3364227">math</span><span class="op" id="3364231">.</span><span class="ident" id="3364232">Log</span><span class="op" id="3364235">(</span><span class="ident" id="3364236">z</span><span class="op" id="3364237">.</span><span class="ident" id="3364238">oneminusQ</span><span class="op" id="3364247">*</span><span class="ident" id="3364248">x</span><span class="op" id="3364249">)</span><span class="op" id="3364250">)</span>&nbsp;<span class="op" id="3364252">-</span>&nbsp;<span class="ident" id="3364254">z</span><span class="op" id="3364255">.</span><span class="ident" id="3364256">v</span><br>
<span class="lineno"></span><span class="op" id="3364258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3364261">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3364325">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3364386">func</span>&nbsp;<span class="ident" id="3364391">NewZipf</span><span class="op" id="3364398">(</span><span class="ident" id="3364399">r</span>&nbsp;<span class="op" id="3364401">*</span><span class="ident" id="3364402">Rand</span><span class="op" id="3364406">,</span>&nbsp;<span class="ident" id="3364408">s</span>&nbsp;<span class="builtintype" id="3364410">float64</span><span class="op" id="3364417">,</span>&nbsp;<span class="ident" id="3364419">v</span>&nbsp;<span class="builtintype" id="3364421">float64</span><span class="op" id="3364428">,</span>&nbsp;<span class="ident" id="3364430">imax</span>&nbsp;<span class="ident" id="3364435">uint64</span><span class="op" id="3364441">)</span>&nbsp;<span class="op" id="3364443">*</span><span class="ident" id="3364444">Zipf</span>&nbsp;<span class="op" id="3364449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364452">z</span>&nbsp;<span class="op" id="3364454">:=</span>&nbsp;<span class="builtinfunc" id="3364457">new</span><span class="op" id="3364460">(</span><span class="ident" id="3364461">Zipf</span><span class="op" id="3364465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364468">if</span>&nbsp;<span class="ident" id="3364471">s</span>&nbsp;<span class="op" id="3364473">&lt;=</span>&nbsp;<span class="num" id="3364476">1.0</span>&nbsp;<span class="op" id="3364480">||</span>&nbsp;<span class="ident" id="3364483">v</span>&nbsp;<span class="op" id="3364485">&lt;</span>&nbsp;<span class="num" id="3364487">1</span>&nbsp;<span class="op" id="3364489">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364493">return</span>&nbsp;<span class="ident" id="3364500">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3364505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364508">z</span><span class="op" id="3364509">.</span><span class="ident" id="3364510">r</span>&nbsp;<span class="op" id="3364512">=</span>&nbsp;<span class="ident" id="3364514">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364517">z</span><span class="op" id="3364518">.</span><span class="ident" id="3364519">imax</span>&nbsp;<span class="op" id="3364524">=</span>&nbsp;<span class="builtintype" id="3364526">float64</span><span class="op" id="3364533">(</span><span class="ident" id="3364534">imax</span><span class="op" id="3364538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364541">z</span><span class="op" id="3364542">.</span><span class="ident" id="3364543">v</span>&nbsp;<span class="op" id="3364545">=</span>&nbsp;<span class="ident" id="3364547">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364550">z</span><span class="op" id="3364551">.</span><span class="ident" id="3364552">q</span>&nbsp;<span class="op" id="3364554">=</span>&nbsp;<span class="ident" id="3364556">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364559">z</span><span class="op" id="3364560">.</span><span class="ident" id="3364561">oneminusQ</span>&nbsp;<span class="op" id="3364571">=</span>&nbsp;<span class="num" id="3364573">1.0</span>&nbsp;<span class="op" id="3364577">-</span>&nbsp;<span class="ident" id="3364579">z</span><span class="op" id="3364580">.</span><span class="ident" id="3364581">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364584">z</span><span class="op" id="3364585">.</span><span class="ident" id="3364586">oneminusQinv</span>&nbsp;<span class="op" id="3364599">=</span>&nbsp;<span class="num" id="3364601">1.0</span>&nbsp;<span class="op" id="3364605">/</span>&nbsp;<span class="ident" id="3364607">z</span><span class="op" id="3364608">.</span><span class="ident" id="3364609">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364620">z</span><span class="op" id="3364621">.</span><span class="ident" id="3364622">hxm</span>&nbsp;<span class="op" id="3364626">=</span>&nbsp;<span class="ident" id="3364628">z</span><span class="op" id="3364629">.</span><span class="ident" id="3364630">h</span><span class="op" id="3364631">(</span><span class="ident" id="3364632">z</span><span class="op" id="3364633">.</span><span class="ident" id="3364634">imax</span>&nbsp;<span class="op" id="3364639">+</span>&nbsp;<span class="num" id="3364641">0.5</span><span class="op" id="3364644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364647">z</span><span class="op" id="3364648">.</span><span class="ident" id="3364649">hx0minusHxm</span>&nbsp;<span class="op" id="3364661">=</span>&nbsp;<span class="ident" id="3364663">z</span><span class="op" id="3364664">.</span><span class="ident" id="3364665">h</span><span class="op" id="3364666">(</span><span class="num" id="3364667">0.5</span><span class="op" id="3364670">)</span>&nbsp;<span class="op" id="3364672">-</span>&nbsp;<span class="ident" id="3364674">math</span><span class="op" id="3364678">.</span><span class="ident" id="3364679">Exp</span><span class="op" id="3364682">(</span><span class="ident" id="3364683">math</span><span class="op" id="3364687">.</span><span class="ident" id="3364688">Log</span><span class="op" id="3364691">(</span><span class="ident" id="3364692">z</span><span class="op" id="3364693">.</span><span class="ident" id="3364694">v</span><span class="op" id="3364695">)</span><span class="op" id="3364696">*</span><span class="op" id="3364697">(</span><span class="op" id="3364698">-</span><span class="ident" id="3364699">z</span><span class="op" id="3364700">.</span><span class="ident" id="3364701">q</span><span class="op" id="3364702">)</span><span class="op" id="3364703">)</span>&nbsp;<span class="op" id="3364705">-</span>&nbsp;<span class="ident" id="3364707">z</span><span class="op" id="3364708">.</span><span class="ident" id="3364709">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364714">z</span><span class="op" id="3364715">.</span><span class="ident" id="3364716">s</span>&nbsp;<span class="op" id="3364718">=</span>&nbsp;<span class="num" id="3364720">1</span>&nbsp;<span class="op" id="3364722">-</span>&nbsp;<span class="ident" id="3364724">z</span><span class="op" id="3364725">.</span><span class="ident" id="3364726">hinv</span><span class="op" id="3364730">(</span><span class="ident" id="3364731">z</span><span class="op" id="3364732">.</span><span class="ident" id="3364733">h</span><span class="op" id="3364734">(</span><span class="num" id="3364735">1.5</span><span class="op" id="3364738">)</span><span class="op" id="3364739">-</span><span class="ident" id="3364740">math</span><span class="op" id="3364744">.</span><span class="ident" id="3364745">Exp</span><span class="op" id="3364748">(</span><span class="op" id="3364749">-</span><span class="ident" id="3364750">z</span><span class="op" id="3364751">.</span><span class="ident" id="3364752">q</span><span class="op" id="3364753">*</span><span class="ident" id="3364754">math</span><span class="op" id="3364758">.</span><span class="ident" id="3364759">Log</span><span class="op" id="3364762">(</span><span class="ident" id="3364763">z</span><span class="op" id="3364764">.</span><span class="ident" id="3364765">v</span><span class="op" id="3364766">+</span><span class="num" id="3364767">1.0</span><span class="op" id="3364770">)</span><span class="op" id="3364771">)</span><span class="op" id="3364772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364775">return</span>&nbsp;<span class="ident" id="3364782">z</span><br>
<span class="lineno"></span><span class="op" id="3364784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3364787">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3364856">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3364879">func</span>&nbsp;<span class="op" id="3364884">(</span><span class="ident" id="3364885">z</span>&nbsp;<span class="op" id="3364887">*</span><span class="ident" id="3364888">Zipf</span><span class="op" id="3364892">)</span>&nbsp;<span class="ident" id="3364894">Uint64</span><span class="op" id="3364900">(</span><span class="op" id="3364901">)</span>&nbsp;<span class="ident" id="3364903">uint64</span>&nbsp;<span class="op" id="3364910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364913">if</span>&nbsp;<span class="ident" id="3364916">z</span>&nbsp;<span class="op" id="3364918">==</span>&nbsp;<span class="ident" id="3364921">nil</span>&nbsp;<span class="op" id="3364925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3364929">panic</span><span class="op" id="3364934">(</span><span class="string" id="3364935">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3364951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3364954">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364957">k</span>&nbsp;<span class="op" id="3364959">:=</span>&nbsp;<span class="num" id="3364962">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3364968">for</span>&nbsp;<span class="op" id="3364972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364976">r</span>&nbsp;<span class="op" id="3364978">:=</span>&nbsp;<span class="ident" id="3364981">z</span><span class="op" id="3364982">.</span><span class="ident" id="3364983">r</span><span class="op" id="3364984">.</span><span class="ident" id="3364985">Float64</span><span class="op" id="3364992">(</span><span class="op" id="3364993">)</span>&nbsp;<span class="comment" id="3364995">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365011">ur</span>&nbsp;<span class="op" id="3365014">:=</span>&nbsp;<span class="ident" id="3365017">z</span><span class="op" id="3365018">.</span><span class="ident" id="3365019">hxm</span>&nbsp;<span class="op" id="3365023">+</span>&nbsp;<span class="ident" id="3365025">r</span><span class="op" id="3365026">*</span><span class="ident" id="3365027">z</span><span class="op" id="3365028">.</span><span class="ident" id="3365029">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365043">x</span>&nbsp;<span class="op" id="3365045">:=</span>&nbsp;<span class="ident" id="3365048">z</span><span class="op" id="3365049">.</span><span class="ident" id="3365050">hinv</span><span class="op" id="3365054">(</span><span class="ident" id="3365055">ur</span><span class="op" id="3365057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365061">k</span>&nbsp;<span class="op" id="3365063">=</span>&nbsp;<span class="ident" id="3365065">math</span><span class="op" id="3365069">.</span><span class="ident" id="3365070">Floor</span><span class="op" id="3365075">(</span><span class="ident" id="3365076">x</span>&nbsp;<span class="op" id="3365078">+</span>&nbsp;<span class="num" id="3365080">0.5</span><span class="op" id="3365083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365087">if</span>&nbsp;<span class="ident" id="3365090">k</span><span class="op" id="3365091">-</span><span class="ident" id="3365092">x</span>&nbsp;<span class="op" id="3365094">&lt;=</span>&nbsp;<span class="ident" id="3365097">z</span><span class="op" id="3365098">.</span><span class="ident" id="3365099">s</span>&nbsp;<span class="op" id="3365101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365106">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3365114">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365118">if</span>&nbsp;<span class="ident" id="3365121">ur</span>&nbsp;<span class="op" id="3365124">&gt;=</span>&nbsp;<span class="ident" id="3365127">z</span><span class="op" id="3365128">.</span><span class="ident" id="3365129">h</span><span class="op" id="3365130">(</span><span class="ident" id="3365131">k</span><span class="op" id="3365132">+</span><span class="num" id="3365133">0.5</span><span class="op" id="3365136">)</span><span class="op" id="3365137">-</span><span class="ident" id="3365138">math</span><span class="op" id="3365142">.</span><span class="ident" id="3365143">Exp</span><span class="op" id="3365146">(</span><span class="op" id="3365147">-</span><span class="ident" id="3365148">math</span><span class="op" id="3365152">.</span><span class="ident" id="3365153">Log</span><span class="op" id="3365156">(</span><span class="ident" id="3365157">k</span><span class="op" id="3365158">+</span><span class="ident" id="3365159">z</span><span class="op" id="3365160">.</span><span class="ident" id="3365161">v</span><span class="op" id="3365162">)</span><span class="op" id="3365163">*</span><span class="ident" id="3365164">z</span><span class="op" id="3365165">.</span><span class="ident" id="3365166">q</span><span class="op" id="3365167">)</span>&nbsp;<span class="op" id="3365169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365174">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3365182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3365185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365188">return</span>&nbsp;<span class="ident" id="3365195">uint64</span><span class="op" id="3365201">(</span><span class="ident" id="3365202">k</span><span class="op" id="3365203">)</span><br>
<span class="lineno">75</span><span class="op" id="3365205">}</span>
</div>
</body>
</html>
