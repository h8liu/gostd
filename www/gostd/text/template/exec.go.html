<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5302981">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5303036">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5303090">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5303141">package</span>&nbsp;<span class="ident" id="5303149">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5303159">import</span>&nbsp;<span class="op" id="5303166">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303169">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303178">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303185">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303191">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303202">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303213">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303221">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5303232">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="5303254">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303257">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5303325">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="5303386">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5303414">type</span>&nbsp;<span class="ident" id="5303419">state</span>&nbsp;<span class="keyword" id="5303425">struct</span>&nbsp;<span class="op" id="5303432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303435">tmpl</span>&nbsp;<span class="op" id="5303440">*</span><span class="ident" id="5303441">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303451">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5303456">io</span><span class="op" id="5303458">.</span><span class="ident" id="5303459">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303467">node</span>&nbsp;<span class="ident" id="5303472">parse</span><span class="op" id="5303477">.</span><span class="ident" id="5303478">Node</span>&nbsp;<span class="comment" id="5303483">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303512">vars</span>&nbsp;<span class="op" id="5303517">[</span><span class="op" id="5303518">]</span><span class="ident" id="5303519">variable</span>&nbsp;<span class="comment" id="5303528">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="5303567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303570">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="5303639">type</span>&nbsp;<span class="ident" id="5303644">variable</span>&nbsp;<span class="keyword" id="5303653">struct</span>&nbsp;<span class="op" id="5303660">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303663">name</span>&nbsp;&nbsp;<span class="builtintype" id="5303669">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303677">value</span>&nbsp;<span class="ident" id="5303683">reflect</span><span class="op" id="5303690">.</span><span class="ident" id="5303691">Value</span><br>
<span class="lineno"></span><span class="op" id="5303697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303700">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="5303744">func</span>&nbsp;<span class="op" id="5303749">(</span><span class="ident" id="5303750">s</span>&nbsp;<span class="op" id="5303752">*</span><span class="ident" id="5303753">state</span><span class="op" id="5303758">)</span>&nbsp;<span class="ident" id="5303760">push</span><span class="op" id="5303764">(</span><span class="ident" id="5303765">name</span>&nbsp;<span class="builtintype" id="5303770">string</span><span class="op" id="5303776">,</span>&nbsp;<span class="ident" id="5303778">value</span>&nbsp;<span class="ident" id="5303784">reflect</span><span class="op" id="5303791">.</span><span class="ident" id="5303792">Value</span><span class="op" id="5303797">)</span>&nbsp;<span class="op" id="5303799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5303802">s</span><span class="op" id="5303803">.</span><span class="ident" id="5303804">vars</span>&nbsp;<span class="op" id="5303809">=</span>&nbsp;<span class="builtinfunc" id="5303811">append</span><span class="op" id="5303817">(</span><span class="ident" id="5303818">s</span><span class="op" id="5303819">.</span><span class="ident" id="5303820">vars</span><span class="op" id="5303824">,</span>&nbsp;<span class="ident" id="5303826">variable</span><span class="op" id="5303834">{</span><span class="ident" id="5303835">name</span><span class="op" id="5303839">,</span>&nbsp;<span class="ident" id="5303841">value</span><span class="op" id="5303846">}</span><span class="op" id="5303847">)</span><br>
<span class="lineno"></span><span class="op" id="5303849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303852">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="5303902">func</span>&nbsp;<span class="op" id="5303907">(</span><span class="ident" id="5303908">s</span>&nbsp;<span class="op" id="5303910">*</span><span class="ident" id="5303911">state</span><span class="op" id="5303916">)</span>&nbsp;<span class="ident" id="5303918">mark</span><span class="op" id="5303922">(</span><span class="op" id="5303923">)</span>&nbsp;<span class="builtintype" id="5303925">int</span>&nbsp;<span class="op" id="5303929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5303932">return</span>&nbsp;<span class="builtinfunc" id="5303939">len</span><span class="op" id="5303942">(</span><span class="ident" id="5303943">s</span><span class="op" id="5303944">.</span><span class="ident" id="5303945">vars</span><span class="op" id="5303949">)</span><br>
<span class="lineno"></span><span class="op" id="5303951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303954">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="5304001">func</span>&nbsp;<span class="op" id="5304006">(</span><span class="ident" id="5304007">s</span>&nbsp;<span class="op" id="5304009">*</span><span class="ident" id="5304010">state</span><span class="op" id="5304015">)</span>&nbsp;<span class="ident" id="5304017">pop</span><span class="op" id="5304020">(</span><span class="ident" id="5304021">mark</span>&nbsp;<span class="builtintype" id="5304026">int</span><span class="op" id="5304029">)</span>&nbsp;<span class="op" id="5304031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304034">s</span><span class="op" id="5304035">.</span><span class="ident" id="5304036">vars</span>&nbsp;<span class="op" id="5304041">=</span>&nbsp;<span class="ident" id="5304043">s</span><span class="op" id="5304044">.</span><span class="ident" id="5304045">vars</span><span class="op" id="5304049">[</span><span class="num" id="5304050">0</span><span class="op" id="5304051">:</span><span class="ident" id="5304052">mark</span><span class="op" id="5304056">]</span><br>
<span class="lineno"></span><span class="op" id="5304058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304061">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="5304143">func</span>&nbsp;<span class="op" id="5304148">(</span><span class="ident" id="5304149">s</span>&nbsp;<span class="op" id="5304151">*</span><span class="ident" id="5304152">state</span><span class="op" id="5304157">)</span>&nbsp;<span class="ident" id="5304159">setVar</span><span class="op" id="5304165">(</span><span class="ident" id="5304166">n</span>&nbsp;<span class="builtintype" id="5304168">int</span><span class="op" id="5304171">,</span>&nbsp;<span class="ident" id="5304173">value</span>&nbsp;<span class="ident" id="5304179">reflect</span><span class="op" id="5304186">.</span><span class="ident" id="5304187">Value</span><span class="op" id="5304192">)</span>&nbsp;<span class="op" id="5304194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304197">s</span><span class="op" id="5304198">.</span><span class="ident" id="5304199">vars</span><span class="op" id="5304203">[</span><span class="builtinfunc" id="5304204">len</span><span class="op" id="5304207">(</span><span class="ident" id="5304208">s</span><span class="op" id="5304209">.</span><span class="ident" id="5304210">vars</span><span class="op" id="5304214">)</span><span class="op" id="5304215">-</span><span class="ident" id="5304216">n</span><span class="op" id="5304217">]</span><span class="op" id="5304218">.</span><span class="ident" id="5304219">value</span>&nbsp;<span class="op" id="5304225">=</span>&nbsp;<span class="ident" id="5304227">value</span><br>
<span class="lineno"></span><span class="op" id="5304233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304236">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="5304289">func</span>&nbsp;<span class="op" id="5304294">(</span><span class="ident" id="5304295">s</span>&nbsp;<span class="op" id="5304297">*</span><span class="ident" id="5304298">state</span><span class="op" id="5304303">)</span>&nbsp;<span class="ident" id="5304305">varValue</span><span class="op" id="5304313">(</span><span class="ident" id="5304314">name</span>&nbsp;<span class="builtintype" id="5304319">string</span><span class="op" id="5304325">)</span>&nbsp;<span class="ident" id="5304327">reflect</span><span class="op" id="5304334">.</span><span class="ident" id="5304335">Value</span>&nbsp;<span class="op" id="5304341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304344">for</span>&nbsp;<span class="ident" id="5304348">i</span>&nbsp;<span class="op" id="5304350">:=</span>&nbsp;<span class="ident" id="5304353">s</span><span class="op" id="5304354">.</span><span class="ident" id="5304355">mark</span><span class="op" id="5304359">(</span><span class="op" id="5304360">)</span>&nbsp;<span class="op" id="5304362">-</span>&nbsp;<span class="num" id="5304364">1</span><span class="op" id="5304365">;</span>&nbsp;<span class="ident" id="5304367">i</span>&nbsp;<span class="op" id="5304369">&gt;=</span>&nbsp;<span class="num" id="5304372">0</span><span class="op" id="5304373">;</span>&nbsp;<span class="ident" id="5304375">i</span><span class="op" id="5304376">--</span>&nbsp;<span class="op" id="5304379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304383">if</span>&nbsp;<span class="ident" id="5304386">s</span><span class="op" id="5304387">.</span><span class="ident" id="5304388">vars</span><span class="op" id="5304392">[</span><span class="ident" id="5304393">i</span><span class="op" id="5304394">]</span><span class="op" id="5304395">.</span><span class="ident" id="5304396">name</span>&nbsp;<span class="op" id="5304401">==</span>&nbsp;<span class="ident" id="5304404">name</span>&nbsp;<span class="op" id="5304409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304414">return</span>&nbsp;<span class="ident" id="5304421">s</span><span class="op" id="5304422">.</span><span class="ident" id="5304423">vars</span><span class="op" id="5304427">[</span><span class="ident" id="5304428">i</span><span class="op" id="5304429">]</span><span class="op" id="5304430">.</span><span class="ident" id="5304431">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304439">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304445">s</span><span class="op" id="5304446">.</span><span class="ident" id="5304447">errorf</span><span class="op" id="5304453">(</span><span class="string" id="5304454">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="5304478">,</span>&nbsp;<span class="ident" id="5304480">name</span><span class="op" id="5304484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304487">return</span>&nbsp;<span class="ident" id="5304494">zero</span><br>
<span class="lineno"></span><span class="op" id="5304499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="5304502">var</span>&nbsp;<span class="ident" id="5304506">zero</span>&nbsp;<span class="ident" id="5304511">reflect</span><span class="op" id="5304518">.</span><span class="ident" id="5304519">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304526">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="5304586">func</span>&nbsp;<span class="op" id="5304591">(</span><span class="ident" id="5304592">s</span>&nbsp;<span class="op" id="5304594">*</span><span class="ident" id="5304595">state</span><span class="op" id="5304600">)</span>&nbsp;<span class="ident" id="5304602">at</span><span class="op" id="5304604">(</span><span class="ident" id="5304605">node</span>&nbsp;<span class="ident" id="5304610">parse</span><span class="op" id="5304615">.</span><span class="ident" id="5304616">Node</span><span class="op" id="5304620">)</span>&nbsp;<span class="op" id="5304622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304625">s</span><span class="op" id="5304626">.</span><span class="ident" id="5304627">node</span>&nbsp;<span class="op" id="5304632">=</span>&nbsp;<span class="ident" id="5304634">node</span><br>
<span class="lineno">70</span><span class="op" id="5304639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304642">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="5304717">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5304776">func</span>&nbsp;<span class="ident" id="5304781">doublePercent</span><span class="op" id="5304794">(</span><span class="ident" id="5304795">str</span>&nbsp;<span class="builtintype" id="5304799">string</span><span class="op" id="5304805">)</span>&nbsp;<span class="builtintype" id="5304807">string</span>&nbsp;<span class="op" id="5304814">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304817">if</span>&nbsp;<span class="ident" id="5304820">strings</span><span class="op" id="5304827">.</span><span class="ident" id="5304828">Contains</span><span class="op" id="5304836">(</span><span class="ident" id="5304837">str</span><span class="op" id="5304840">,</span>&nbsp;<span class="string" id="5304842">&#34;%&#34;</span><span class="op" id="5304845">)</span>&nbsp;<span class="op" id="5304847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5304851">str</span>&nbsp;<span class="op" id="5304855">=</span>&nbsp;<span class="ident" id="5304857">strings</span><span class="op" id="5304864">.</span><span class="ident" id="5304865">Replace</span><span class="op" id="5304872">(</span><span class="ident" id="5304873">str</span><span class="op" id="5304876">,</span>&nbsp;<span class="string" id="5304878">&#34;%&#34;</span><span class="op" id="5304881">,</span>&nbsp;<span class="string" id="5304883">&#34;%%&#34;</span><span class="op" id="5304887">,</span>&nbsp;<span class="op" id="5304889">-</span><span class="num" id="5304890">1</span><span class="op" id="5304891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5304894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5304897">return</span>&nbsp;<span class="ident" id="5304904">str</span><br>
<span class="lineno"></span><span class="op" id="5304908">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5304911">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="5304966">func</span>&nbsp;<span class="op" id="5304971">(</span><span class="ident" id="5304972">s</span>&nbsp;<span class="op" id="5304974">*</span><span class="ident" id="5304975">state</span><span class="op" id="5304980">)</span>&nbsp;<span class="ident" id="5304982">errorf</span><span class="op" id="5304988">(</span><span class="ident" id="5304989">format</span>&nbsp;<span class="builtintype" id="5304996">string</span><span class="op" id="5305002">,</span>&nbsp;<span class="ident" id="5305004">args</span>&nbsp;<span class="op" id="5305009">...</span><span class="keyword" id="5305012">interface</span><span class="op" id="5305021">{</span><span class="op" id="5305022">}</span><span class="op" id="5305023">)</span>&nbsp;<span class="op" id="5305025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5305028">name</span>&nbsp;<span class="op" id="5305033">:=</span>&nbsp;<span class="ident" id="5305036">doublePercent</span><span class="op" id="5305049">(</span><span class="ident" id="5305050">s</span><span class="op" id="5305051">.</span><span class="ident" id="5305052">tmpl</span><span class="op" id="5305056">.</span><span class="ident" id="5305057">Name</span><span class="op" id="5305061">(</span><span class="op" id="5305062">)</span><span class="op" id="5305063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305066">if</span>&nbsp;<span class="ident" id="5305069">s</span><span class="op" id="5305070">.</span><span class="ident" id="5305071">node</span>&nbsp;<span class="op" id="5305076">==</span>&nbsp;<span class="ident" id="5305079">nil</span>&nbsp;<span class="op" id="5305083">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5305087">format</span>&nbsp;<span class="op" id="5305094">=</span>&nbsp;<span class="ident" id="5305096">fmt</span><span class="op" id="5305099">.</span><span class="ident" id="5305100">Sprintf</span><span class="op" id="5305107">(</span><span class="string" id="5305108">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="5305126">,</span>&nbsp;<span class="ident" id="5305128">name</span><span class="op" id="5305132">,</span>&nbsp;<span class="ident" id="5305134">format</span><span class="op" id="5305140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5305143">}</span>&nbsp;<span class="keyword" id="5305145">else</span>&nbsp;<span class="op" id="5305150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5305154">location</span><span class="op" id="5305162">,</span>&nbsp;<span class="ident" id="5305164">context</span>&nbsp;<span class="op" id="5305172">:=</span>&nbsp;<span class="ident" id="5305175">s</span><span class="op" id="5305176">.</span><span class="ident" id="5305177">tmpl</span><span class="op" id="5305181">.</span><span class="ident" id="5305182">ErrorContext</span><span class="op" id="5305194">(</span><span class="ident" id="5305195">s</span><span class="op" id="5305196">.</span><span class="ident" id="5305197">node</span><span class="op" id="5305201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5305205">format</span>&nbsp;<span class="op" id="5305212">=</span>&nbsp;<span class="ident" id="5305214">fmt</span><span class="op" id="5305217">.</span><span class="ident" id="5305218">Sprintf</span><span class="op" id="5305225">(</span><span class="string" id="5305226">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="5305266">,</span>&nbsp;<span class="ident" id="5305268">location</span><span class="op" id="5305276">,</span>&nbsp;<span class="ident" id="5305278">name</span><span class="op" id="5305282">,</span>&nbsp;<span class="ident" id="5305284">doublePercent</span><span class="op" id="5305297">(</span><span class="ident" id="5305298">context</span><span class="op" id="5305305">)</span><span class="op" id="5305306">,</span>&nbsp;<span class="ident" id="5305308">format</span><span class="op" id="5305314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5305317">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5305320">panic</span><span class="op" id="5305325">(</span><span class="ident" id="5305326">fmt</span><span class="op" id="5305329">.</span><span class="ident" id="5305330">Errorf</span><span class="op" id="5305336">(</span><span class="ident" id="5305337">format</span><span class="op" id="5305343">,</span>&nbsp;<span class="ident" id="5305345">args</span><span class="op" id="5305349">...</span><span class="op" id="5305352">)</span><span class="op" id="5305353">)</span><br>
<span class="lineno"></span><span class="op" id="5305355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305358">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="5305431">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="5305450">func</span>&nbsp;<span class="ident" id="5305455">errRecover</span><span class="op" id="5305465">(</span><span class="ident" id="5305466">errp</span>&nbsp;<span class="op" id="5305471">*</span><span class="builtintype" id="5305472">error</span><span class="op" id="5305477">)</span>&nbsp;<span class="op" id="5305479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5305482">e</span>&nbsp;<span class="op" id="5305484">:=</span>&nbsp;<span class="builtinfunc" id="5305487">recover</span><span class="op" id="5305494">(</span><span class="op" id="5305495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305498">if</span>&nbsp;<span class="ident" id="5305501">e</span>&nbsp;<span class="op" id="5305503">!=</span>&nbsp;<span class="ident" id="5305506">nil</span>&nbsp;<span class="op" id="5305510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305514">switch</span>&nbsp;<span class="ident" id="5305521">err</span>&nbsp;<span class="op" id="5305525">:=</span>&nbsp;<span class="ident" id="5305528">e</span><span class="op" id="5305529">.</span><span class="op" id="5305530">(</span><span class="keyword" id="5305531">type</span><span class="op" id="5305535">)</span>&nbsp;<span class="op" id="5305537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305541">case</span>&nbsp;<span class="ident" id="5305546">runtime</span><span class="op" id="5305553">.</span><span class="ident" id="5305554">Error</span><span class="op" id="5305559">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5305564">panic</span><span class="op" id="5305569">(</span><span class="ident" id="5305570">e</span><span class="op" id="5305571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305575">case</span>&nbsp;<span class="builtintype" id="5305580">error</span><span class="op" id="5305585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5305590">*</span><span class="ident" id="5305591">errp</span>&nbsp;<span class="op" id="5305596">=</span>&nbsp;<span class="ident" id="5305598">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5305604">default</span><span class="op" id="5305611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5305616">panic</span><span class="op" id="5305621">(</span><span class="ident" id="5305622">e</span><span class="op" id="5305623">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5305627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5305630">}</span><br>
<span class="lineno"></span><span class="op" id="5305632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305635">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="5305717">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5305778">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5305846">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5305919">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5305941">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="5305991">func</span>&nbsp;<span class="op" id="5305996">(</span><span class="ident" id="5305997">t</span>&nbsp;<span class="op" id="5305999">*</span><span class="ident" id="5306000">Template</span><span class="op" id="5306008">)</span>&nbsp;<span class="ident" id="5306010">ExecuteTemplate</span><span class="op" id="5306025">(</span><span class="ident" id="5306026">wr</span>&nbsp;<span class="ident" id="5306029">io</span><span class="op" id="5306031">.</span><span class="ident" id="5306032">Writer</span><span class="op" id="5306038">,</span>&nbsp;<span class="ident" id="5306040">name</span>&nbsp;<span class="builtintype" id="5306045">string</span><span class="op" id="5306051">,</span>&nbsp;<span class="ident" id="5306053">data</span>&nbsp;<span class="keyword" id="5306058">interface</span><span class="op" id="5306067">{</span><span class="op" id="5306068">}</span><span class="op" id="5306069">)</span>&nbsp;<span class="builtintype" id="5306071">error</span>&nbsp;<span class="op" id="5306077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306080">tmpl</span>&nbsp;<span class="op" id="5306085">:=</span>&nbsp;<span class="ident" id="5306088">t</span><span class="op" id="5306089">.</span><span class="ident" id="5306090">tmpl</span><span class="op" id="5306094">[</span><span class="ident" id="5306095">name</span><span class="op" id="5306099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306102">if</span>&nbsp;<span class="ident" id="5306105">tmpl</span>&nbsp;<span class="op" id="5306110">==</span>&nbsp;<span class="ident" id="5306113">nil</span>&nbsp;<span class="op" id="5306117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306121">return</span>&nbsp;<span class="ident" id="5306128">fmt</span><span class="op" id="5306131">.</span><span class="ident" id="5306132">Errorf</span><span class="op" id="5306138">(</span><span class="string" id="5306139">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="5306193">,</span>&nbsp;<span class="ident" id="5306195">name</span><span class="op" id="5306199">,</span>&nbsp;<span class="ident" id="5306201">t</span><span class="op" id="5306202">.</span><span class="ident" id="5306203">name</span><span class="op" id="5306207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306210">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306213">return</span>&nbsp;<span class="ident" id="5306220">tmpl</span><span class="op" id="5306224">.</span><span class="ident" id="5306225">Execute</span><span class="op" id="5306232">(</span><span class="ident" id="5306233">wr</span><span class="op" id="5306235">,</span>&nbsp;<span class="ident" id="5306237">data</span><span class="op" id="5306241">)</span><br>
<span class="lineno"></span><span class="op" id="5306243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306246">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5306313">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="5306345">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5306413">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5306486">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5306508">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5306558">func</span>&nbsp;<span class="op" id="5306563">(</span><span class="ident" id="5306564">t</span>&nbsp;<span class="op" id="5306566">*</span><span class="ident" id="5306567">Template</span><span class="op" id="5306575">)</span>&nbsp;<span class="ident" id="5306577">Execute</span><span class="op" id="5306584">(</span><span class="ident" id="5306585">wr</span>&nbsp;<span class="ident" id="5306588">io</span><span class="op" id="5306590">.</span><span class="ident" id="5306591">Writer</span><span class="op" id="5306597">,</span>&nbsp;<span class="ident" id="5306599">data</span>&nbsp;<span class="keyword" id="5306604">interface</span><span class="op" id="5306613">{</span><span class="op" id="5306614">}</span><span class="op" id="5306615">)</span>&nbsp;<span class="op" id="5306617">(</span><span class="ident" id="5306618">err</span>&nbsp;<span class="builtintype" id="5306622">error</span><span class="op" id="5306627">)</span>&nbsp;<span class="op" id="5306629">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306632">defer</span>&nbsp;<span class="ident" id="5306638">errRecover</span><span class="op" id="5306648">(</span><span class="op" id="5306649">&amp;</span><span class="ident" id="5306650">err</span><span class="op" id="5306653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306656">value</span>&nbsp;<span class="op" id="5306662">:=</span>&nbsp;<span class="ident" id="5306665">reflect</span><span class="op" id="5306672">.</span><span class="ident" id="5306673">ValueOf</span><span class="op" id="5306680">(</span><span class="ident" id="5306681">data</span><span class="op" id="5306685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306688">state</span>&nbsp;<span class="op" id="5306694">:=</span>&nbsp;<span class="op" id="5306697">&amp;</span><span class="ident" id="5306698">state</span><span class="op" id="5306703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306707">tmpl</span><span class="op" id="5306711">:</span>&nbsp;<span class="ident" id="5306713">t</span><span class="op" id="5306714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306718">wr</span><span class="op" id="5306720">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5306724">wr</span><span class="op" id="5306726">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306730">vars</span><span class="op" id="5306734">:</span>&nbsp;<span class="op" id="5306736">[</span><span class="op" id="5306737">]</span><span class="ident" id="5306738">variable</span><span class="op" id="5306746">{</span><span class="op" id="5306747">{</span><span class="string" id="5306748">&#34;$&#34;</span><span class="op" id="5306751">,</span>&nbsp;<span class="ident" id="5306753">value</span><span class="op" id="5306758">}</span><span class="op" id="5306759">}</span><span class="op" id="5306760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306766">t</span><span class="op" id="5306767">.</span><span class="ident" id="5306768">init</span><span class="op" id="5306772">(</span><span class="op" id="5306773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306776">if</span>&nbsp;<span class="ident" id="5306779">t</span><span class="op" id="5306780">.</span><span class="ident" id="5306781">Tree</span>&nbsp;<span class="op" id="5306786">==</span>&nbsp;<span class="ident" id="5306789">nil</span>&nbsp;<span class="op" id="5306793">||</span>&nbsp;<span class="ident" id="5306796">t</span><span class="op" id="5306797">.</span><span class="ident" id="5306798">Root</span>&nbsp;<span class="op" id="5306803">==</span>&nbsp;<span class="ident" id="5306806">nil</span>&nbsp;<span class="op" id="5306810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306814">var</span>&nbsp;<span class="ident" id="5306818">b</span>&nbsp;<span class="ident" id="5306820">bytes</span><span class="op" id="5306825">.</span><span class="ident" id="5306826">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306835">for</span>&nbsp;<span class="ident" id="5306839">name</span><span class="op" id="5306843">,</span>&nbsp;<span class="ident" id="5306845">tmpl</span>&nbsp;<span class="op" id="5306850">:=</span>&nbsp;<span class="keyword" id="5306853">range</span>&nbsp;<span class="ident" id="5306859">t</span><span class="op" id="5306860">.</span><span class="ident" id="5306861">tmpl</span>&nbsp;<span class="op" id="5306866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306871">if</span>&nbsp;<span class="ident" id="5306874">tmpl</span><span class="op" id="5306878">.</span><span class="ident" id="5306879">Tree</span>&nbsp;<span class="op" id="5306884">==</span>&nbsp;<span class="ident" id="5306887">nil</span>&nbsp;<span class="op" id="5306891">||</span>&nbsp;<span class="ident" id="5306894">tmpl</span><span class="op" id="5306898">.</span><span class="ident" id="5306899">Root</span>&nbsp;<span class="op" id="5306904">==</span>&nbsp;<span class="ident" id="5306907">nil</span>&nbsp;<span class="op" id="5306911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306917">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5306934">if</span>&nbsp;<span class="ident" id="5306937">b</span><span class="op" id="5306938">.</span><span class="ident" id="5306939">Len</span><span class="op" id="5306942">(</span><span class="op" id="5306943">)</span>&nbsp;<span class="op" id="5306945">&gt;</span>&nbsp;<span class="num" id="5306947">0</span>&nbsp;<span class="op" id="5306949">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306955">b</span><span class="op" id="5306956">.</span><span class="ident" id="5306957">WriteString</span><span class="op" id="5306968">(</span><span class="string" id="5306969">&#34;,&nbsp;&#34;</span><span class="op" id="5306973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306983">fmt</span><span class="op" id="5306986">.</span><span class="ident" id="5306987">Fprintf</span><span class="op" id="5306994">(</span><span class="op" id="5306995">&amp;</span><span class="ident" id="5306996">b</span><span class="op" id="5306997">,</span>&nbsp;<span class="string" id="5306999">&#34;%q&#34;</span><span class="op" id="5307003">,</span>&nbsp;<span class="ident" id="5307005">name</span><span class="op" id="5307009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307017">var</span>&nbsp;<span class="ident" id="5307021">s</span>&nbsp;<span class="builtintype" id="5307023">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307032">if</span>&nbsp;<span class="ident" id="5307035">b</span><span class="op" id="5307036">.</span><span class="ident" id="5307037">Len</span><span class="op" id="5307040">(</span><span class="op" id="5307041">)</span>&nbsp;<span class="op" id="5307043">&gt;</span>&nbsp;<span class="num" id="5307045">0</span>&nbsp;<span class="op" id="5307047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307052">s</span>&nbsp;<span class="op" id="5307054">=</span>&nbsp;<span class="string" id="5307056">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="5307084">+</span>&nbsp;<span class="ident" id="5307086">b</span><span class="op" id="5307087">.</span><span class="ident" id="5307088">String</span><span class="op" id="5307094">(</span><span class="op" id="5307095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307103">state</span><span class="op" id="5307108">.</span><span class="ident" id="5307109">errorf</span><span class="op" id="5307115">(</span><span class="string" id="5307116">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="5307157">,</span>&nbsp;<span class="ident" id="5307159">t</span><span class="op" id="5307160">.</span><span class="ident" id="5307161">Name</span><span class="op" id="5307165">(</span><span class="op" id="5307166">)</span><span class="op" id="5307167">,</span>&nbsp;<span class="ident" id="5307169">s</span><span class="op" id="5307170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307173">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307176">state</span><span class="op" id="5307181">.</span><span class="ident" id="5307182">walk</span><span class="op" id="5307186">(</span><span class="ident" id="5307187">value</span><span class="op" id="5307192">,</span>&nbsp;<span class="ident" id="5307194">t</span><span class="op" id="5307195">.</span><span class="ident" id="5307196">Root</span><span class="op" id="5307200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307203">return</span><br>
<span class="lineno"></span><span class="op" id="5307210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307213">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="5307288">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="5307321">func</span>&nbsp;<span class="op" id="5307326">(</span><span class="ident" id="5307327">s</span>&nbsp;<span class="op" id="5307329">*</span><span class="ident" id="5307330">state</span><span class="op" id="5307335">)</span>&nbsp;<span class="ident" id="5307337">walk</span><span class="op" id="5307341">(</span><span class="ident" id="5307342">dot</span>&nbsp;<span class="ident" id="5307346">reflect</span><span class="op" id="5307353">.</span><span class="ident" id="5307354">Value</span><span class="op" id="5307359">,</span>&nbsp;<span class="ident" id="5307361">node</span>&nbsp;<span class="ident" id="5307366">parse</span><span class="op" id="5307371">.</span><span class="ident" id="5307372">Node</span><span class="op" id="5307376">)</span>&nbsp;<span class="op" id="5307378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307381">s</span><span class="op" id="5307382">.</span><span class="ident" id="5307383">at</span><span class="op" id="5307385">(</span><span class="ident" id="5307386">node</span><span class="op" id="5307390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307393">switch</span>&nbsp;<span class="ident" id="5307400">node</span>&nbsp;<span class="op" id="5307405">:=</span>&nbsp;<span class="ident" id="5307408">node</span><span class="op" id="5307412">.</span><span class="op" id="5307413">(</span><span class="keyword" id="5307414">type</span><span class="op" id="5307418">)</span>&nbsp;<span class="op" id="5307420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307423">case</span>&nbsp;<span class="op" id="5307428">*</span><span class="ident" id="5307429">parse</span><span class="op" id="5307434">.</span><span class="ident" id="5307435">ActionNode</span><span class="op" id="5307445">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5307449">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5307507">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307576">val</span>&nbsp;<span class="op" id="5307580">:=</span>&nbsp;<span class="ident" id="5307583">s</span><span class="op" id="5307584">.</span><span class="ident" id="5307585">evalPipeline</span><span class="op" id="5307597">(</span><span class="ident" id="5307598">dot</span><span class="op" id="5307601">,</span>&nbsp;<span class="ident" id="5307603">node</span><span class="op" id="5307607">.</span><span class="ident" id="5307608">Pipe</span><span class="op" id="5307612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307616">if</span>&nbsp;<span class="builtinfunc" id="5307619">len</span><span class="op" id="5307622">(</span><span class="ident" id="5307623">node</span><span class="op" id="5307627">.</span><span class="ident" id="5307628">Pipe</span><span class="op" id="5307632">.</span><span class="ident" id="5307633">Decl</span><span class="op" id="5307637">)</span>&nbsp;<span class="op" id="5307639">==</span>&nbsp;<span class="num" id="5307642">0</span>&nbsp;<span class="op" id="5307644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307649">s</span><span class="op" id="5307650">.</span><span class="ident" id="5307651">printValue</span><span class="op" id="5307661">(</span><span class="ident" id="5307662">node</span><span class="op" id="5307666">,</span>&nbsp;<span class="ident" id="5307668">val</span><span class="op" id="5307671">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307678">case</span>&nbsp;<span class="op" id="5307683">*</span><span class="ident" id="5307684">parse</span><span class="op" id="5307689">.</span><span class="ident" id="5307690">IfNode</span><span class="op" id="5307696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307700">s</span><span class="op" id="5307701">.</span><span class="ident" id="5307702">walkIfOrWith</span><span class="op" id="5307714">(</span><span class="ident" id="5307715">parse</span><span class="op" id="5307720">.</span><span class="ident" id="5307721">NodeIf</span><span class="op" id="5307727">,</span>&nbsp;<span class="ident" id="5307729">dot</span><span class="op" id="5307732">,</span>&nbsp;<span class="ident" id="5307734">node</span><span class="op" id="5307738">.</span><span class="ident" id="5307739">Pipe</span><span class="op" id="5307743">,</span>&nbsp;<span class="ident" id="5307745">node</span><span class="op" id="5307749">.</span><span class="ident" id="5307750">List</span><span class="op" id="5307754">,</span>&nbsp;<span class="ident" id="5307756">node</span><span class="op" id="5307760">.</span><span class="ident" id="5307761">ElseList</span><span class="op" id="5307769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307772">case</span>&nbsp;<span class="op" id="5307777">*</span><span class="ident" id="5307778">parse</span><span class="op" id="5307783">.</span><span class="ident" id="5307784">ListNode</span><span class="op" id="5307792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307796">for</span>&nbsp;<span class="ident" id="5307800">_</span><span class="op" id="5307801">,</span>&nbsp;<span class="ident" id="5307803">node</span>&nbsp;<span class="op" id="5307808">:=</span>&nbsp;<span class="keyword" id="5307811">range</span>&nbsp;<span class="ident" id="5307817">node</span><span class="op" id="5307821">.</span><span class="ident" id="5307822">Nodes</span>&nbsp;<span class="op" id="5307828">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307833">s</span><span class="op" id="5307834">.</span><span class="ident" id="5307835">walk</span><span class="op" id="5307839">(</span><span class="ident" id="5307840">dot</span><span class="op" id="5307843">,</span>&nbsp;<span class="ident" id="5307845">node</span><span class="op" id="5307849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5307853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307856">case</span>&nbsp;<span class="op" id="5307861">*</span><span class="ident" id="5307862">parse</span><span class="op" id="5307867">.</span><span class="ident" id="5307868">RangeNode</span><span class="op" id="5307877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307881">s</span><span class="op" id="5307882">.</span><span class="ident" id="5307883">walkRange</span><span class="op" id="5307892">(</span><span class="ident" id="5307893">dot</span><span class="op" id="5307896">,</span>&nbsp;<span class="ident" id="5307898">node</span><span class="op" id="5307902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307905">case</span>&nbsp;<span class="op" id="5307910">*</span><span class="ident" id="5307911">parse</span><span class="op" id="5307916">.</span><span class="ident" id="5307917">TemplateNode</span><span class="op" id="5307929">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5307933">s</span><span class="op" id="5307934">.</span><span class="ident" id="5307935">walkTemplate</span><span class="op" id="5307947">(</span><span class="ident" id="5307948">dot</span><span class="op" id="5307951">,</span>&nbsp;<span class="ident" id="5307953">node</span><span class="op" id="5307957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307960">case</span>&nbsp;<span class="op" id="5307965">*</span><span class="ident" id="5307966">parse</span><span class="op" id="5307971">.</span><span class="ident" id="5307972">TextNode</span><span class="op" id="5307980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5307984">if</span>&nbsp;<span class="ident" id="5307987">_</span><span class="op" id="5307988">,</span>&nbsp;<span class="ident" id="5307990">err</span>&nbsp;<span class="op" id="5307994">:=</span>&nbsp;<span class="ident" id="5307997">s</span><span class="op" id="5307998">.</span><span class="ident" id="5307999">wr</span><span class="op" id="5308001">.</span><span class="ident" id="5308002">Write</span><span class="op" id="5308007">(</span><span class="ident" id="5308008">node</span><span class="op" id="5308012">.</span><span class="ident" id="5308013">Text</span><span class="op" id="5308017">)</span><span class="op" id="5308018">;</span>&nbsp;<span class="ident" id="5308020">err</span>&nbsp;<span class="op" id="5308024">!=</span>&nbsp;<span class="ident" id="5308027">nil</span>&nbsp;<span class="op" id="5308031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308036">s</span><span class="op" id="5308037">.</span><span class="ident" id="5308038">errorf</span><span class="op" id="5308044">(</span><span class="string" id="5308045">&#34;%s&#34;</span><span class="op" id="5308049">,</span>&nbsp;<span class="ident" id="5308051">err</span><span class="op" id="5308054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308058">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308061">case</span>&nbsp;<span class="op" id="5308066">*</span><span class="ident" id="5308067">parse</span><span class="op" id="5308072">.</span><span class="ident" id="5308073">WithNode</span><span class="op" id="5308081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308085">s</span><span class="op" id="5308086">.</span><span class="ident" id="5308087">walkIfOrWith</span><span class="op" id="5308099">(</span><span class="ident" id="5308100">parse</span><span class="op" id="5308105">.</span><span class="ident" id="5308106">NodeWith</span><span class="op" id="5308114">,</span>&nbsp;<span class="ident" id="5308116">dot</span><span class="op" id="5308119">,</span>&nbsp;<span class="ident" id="5308121">node</span><span class="op" id="5308125">.</span><span class="ident" id="5308126">Pipe</span><span class="op" id="5308130">,</span>&nbsp;<span class="ident" id="5308132">node</span><span class="op" id="5308136">.</span><span class="ident" id="5308137">List</span><span class="op" id="5308141">,</span>&nbsp;<span class="ident" id="5308143">node</span><span class="op" id="5308147">.</span><span class="ident" id="5308148">ElseList</span><span class="op" id="5308156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308159">default</span><span class="op" id="5308166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308170">s</span><span class="op" id="5308171">.</span><span class="ident" id="5308172">errorf</span><span class="op" id="5308178">(</span><span class="string" id="5308179">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="5308197">,</span>&nbsp;<span class="ident" id="5308199">node</span><span class="op" id="5308203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308206">}</span><br>
<span class="lineno">190</span><span class="op" id="5308208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5308211">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="5308284">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="5308342">func</span>&nbsp;<span class="op" id="5308347">(</span><span class="ident" id="5308348">s</span>&nbsp;<span class="op" id="5308350">*</span><span class="ident" id="5308351">state</span><span class="op" id="5308356">)</span>&nbsp;<span class="ident" id="5308358">walkIfOrWith</span><span class="op" id="5308370">(</span><span class="ident" id="5308371">typ</span>&nbsp;<span class="ident" id="5308375">parse</span><span class="op" id="5308380">.</span><span class="ident" id="5308381">NodeType</span><span class="op" id="5308389">,</span>&nbsp;<span class="ident" id="5308391">dot</span>&nbsp;<span class="ident" id="5308395">reflect</span><span class="op" id="5308402">.</span><span class="ident" id="5308403">Value</span><span class="op" id="5308408">,</span>&nbsp;<span class="ident" id="5308410">pipe</span>&nbsp;<span class="op" id="5308415">*</span><span class="ident" id="5308416">parse</span><span class="op" id="5308421">.</span><span class="ident" id="5308422">PipeNode</span><span class="op" id="5308430">,</span>&nbsp;<span class="ident" id="5308432">list</span><span class="op" id="5308436">,</span>&nbsp;<span class="ident" id="5308438">elseList</span>&nbsp;<span class="op" id="5308447">*</span><span class="ident" id="5308448">parse</span><span class="op" id="5308453">.</span><span class="ident" id="5308454">ListNode</span><span class="op" id="5308462">)</span>&nbsp;<span class="op" id="5308464">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308467">defer</span>&nbsp;<span class="ident" id="5308473">s</span><span class="op" id="5308474">.</span><span class="ident" id="5308475">pop</span><span class="op" id="5308478">(</span><span class="ident" id="5308479">s</span><span class="op" id="5308480">.</span><span class="ident" id="5308481">mark</span><span class="op" id="5308485">(</span><span class="op" id="5308486">)</span><span class="op" id="5308487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308490">val</span>&nbsp;<span class="op" id="5308494">:=</span>&nbsp;<span class="ident" id="5308497">s</span><span class="op" id="5308498">.</span><span class="ident" id="5308499">evalPipeline</span><span class="op" id="5308511">(</span><span class="ident" id="5308512">dot</span><span class="op" id="5308515">,</span>&nbsp;<span class="ident" id="5308517">pipe</span><span class="op" id="5308521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308524">truth</span><span class="op" id="5308529">,</span>&nbsp;<span class="ident" id="5308531">ok</span>&nbsp;<span class="op" id="5308534">:=</span>&nbsp;<span class="ident" id="5308537">isTrue</span><span class="op" id="5308543">(</span><span class="ident" id="5308544">val</span><span class="op" id="5308547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308550">if</span>&nbsp;<span class="op" id="5308553">!</span><span class="ident" id="5308554">ok</span>&nbsp;<span class="op" id="5308557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308561">s</span><span class="op" id="5308562">.</span><span class="ident" id="5308563">errorf</span><span class="op" id="5308569">(</span><span class="string" id="5308570">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="5308592">,</span>&nbsp;<span class="ident" id="5308594">val</span><span class="op" id="5308597">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308603">if</span>&nbsp;<span class="ident" id="5308606">truth</span>&nbsp;<span class="op" id="5308612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308616">if</span>&nbsp;<span class="ident" id="5308619">typ</span>&nbsp;<span class="op" id="5308623">==</span>&nbsp;<span class="ident" id="5308626">parse</span><span class="op" id="5308631">.</span><span class="ident" id="5308632">NodeWith</span>&nbsp;<span class="op" id="5308641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308646">s</span><span class="op" id="5308647">.</span><span class="ident" id="5308648">walk</span><span class="op" id="5308652">(</span><span class="ident" id="5308653">val</span><span class="op" id="5308656">,</span>&nbsp;<span class="ident" id="5308658">list</span><span class="op" id="5308662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308666">}</span>&nbsp;<span class="keyword" id="5308668">else</span>&nbsp;<span class="op" id="5308673">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308678">s</span><span class="op" id="5308679">.</span><span class="ident" id="5308680">walk</span><span class="op" id="5308684">(</span><span class="ident" id="5308685">dot</span><span class="op" id="5308688">,</span>&nbsp;<span class="ident" id="5308690">list</span><span class="op" id="5308694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308701">}</span>&nbsp;<span class="keyword" id="5308703">else</span>&nbsp;<span class="keyword" id="5308708">if</span>&nbsp;<span class="ident" id="5308711">elseList</span>&nbsp;<span class="op" id="5308720">!=</span>&nbsp;<span class="ident" id="5308723">nil</span>&nbsp;<span class="op" id="5308727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5308731">s</span><span class="op" id="5308732">.</span><span class="ident" id="5308733">walk</span><span class="op" id="5308737">(</span><span class="ident" id="5308738">dot</span><span class="op" id="5308741">,</span>&nbsp;<span class="ident" id="5308743">elseList</span><span class="op" id="5308751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5308754">}</span><br>
<span class="lineno">210</span><span class="op" id="5308756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5308759">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="5308848">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5308903">func</span>&nbsp;<span class="ident" id="5308908">isTrue</span><span class="op" id="5308914">(</span><span class="ident" id="5308915">val</span>&nbsp;<span class="ident" id="5308919">reflect</span><span class="op" id="5308926">.</span><span class="ident" id="5308927">Value</span><span class="op" id="5308932">)</span>&nbsp;<span class="op" id="5308934">(</span><span class="ident" id="5308935">truth</span><span class="op" id="5308940">,</span>&nbsp;<span class="ident" id="5308942">ok</span>&nbsp;<span class="builtintype" id="5308945">bool</span><span class="op" id="5308949">)</span>&nbsp;<span class="op" id="5308951">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5308954">if</span>&nbsp;<span class="op" id="5308957">!</span><span class="ident" id="5308958">val</span><span class="op" id="5308961">.</span><span class="ident" id="5308962">IsValid</span><span class="op" id="5308969">(</span><span class="op" id="5308970">)</span>&nbsp;<span class="op" id="5308972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5308976">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309046">return</span>&nbsp;<span class="builtintype" id="5309053">false</span><span class="op" id="5309058">,</span>&nbsp;<span class="builtintype" id="5309060">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309069">switch</span>&nbsp;<span class="ident" id="5309076">val</span><span class="op" id="5309079">.</span><span class="ident" id="5309080">Kind</span><span class="op" id="5309084">(</span><span class="op" id="5309085">)</span>&nbsp;<span class="op" id="5309087">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309090">case</span>&nbsp;<span class="ident" id="5309095">reflect</span><span class="op" id="5309102">.</span><span class="ident" id="5309103">Array</span><span class="op" id="5309108">,</span>&nbsp;<span class="ident" id="5309110">reflect</span><span class="op" id="5309117">.</span><span class="ident" id="5309118">Map</span><span class="op" id="5309121">,</span>&nbsp;<span class="ident" id="5309123">reflect</span><span class="op" id="5309130">.</span><span class="ident" id="5309131">Slice</span><span class="op" id="5309136">,</span>&nbsp;<span class="ident" id="5309138">reflect</span><span class="op" id="5309145">.</span><span class="ident" id="5309146">String</span><span class="op" id="5309152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309156">truth</span>&nbsp;<span class="op" id="5309162">=</span>&nbsp;<span class="ident" id="5309164">val</span><span class="op" id="5309167">.</span><span class="ident" id="5309168">Len</span><span class="op" id="5309171">(</span><span class="op" id="5309172">)</span>&nbsp;<span class="op" id="5309174">&gt;</span>&nbsp;<span class="num" id="5309176">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309179">case</span>&nbsp;<span class="ident" id="5309184">reflect</span><span class="op" id="5309191">.</span><span class="ident" id="5309192">Bool</span><span class="op" id="5309196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309200">truth</span>&nbsp;<span class="op" id="5309206">=</span>&nbsp;<span class="ident" id="5309208">val</span><span class="op" id="5309211">.</span><span class="ident" id="5309212">Bool</span><span class="op" id="5309216">(</span><span class="op" id="5309217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309220">case</span>&nbsp;<span class="ident" id="5309225">reflect</span><span class="op" id="5309232">.</span><span class="ident" id="5309233">Complex64</span><span class="op" id="5309242">,</span>&nbsp;<span class="ident" id="5309244">reflect</span><span class="op" id="5309251">.</span><span class="ident" id="5309252">Complex128</span><span class="op" id="5309262">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309266">truth</span>&nbsp;<span class="op" id="5309272">=</span>&nbsp;<span class="ident" id="5309274">val</span><span class="op" id="5309277">.</span><span class="ident" id="5309278">Complex</span><span class="op" id="5309285">(</span><span class="op" id="5309286">)</span>&nbsp;<span class="op" id="5309288">!=</span>&nbsp;<span class="num" id="5309291">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309294">case</span>&nbsp;<span class="ident" id="5309299">reflect</span><span class="op" id="5309306">.</span><span class="ident" id="5309307">Chan</span><span class="op" id="5309311">,</span>&nbsp;<span class="ident" id="5309313">reflect</span><span class="op" id="5309320">.</span><span class="ident" id="5309321">Func</span><span class="op" id="5309325">,</span>&nbsp;<span class="ident" id="5309327">reflect</span><span class="op" id="5309334">.</span><span class="ident" id="5309335">Ptr</span><span class="op" id="5309338">,</span>&nbsp;<span class="ident" id="5309340">reflect</span><span class="op" id="5309347">.</span><span class="ident" id="5309348">Interface</span><span class="op" id="5309357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309361">truth</span>&nbsp;<span class="op" id="5309367">=</span>&nbsp;<span class="op" id="5309369">!</span><span class="ident" id="5309370">val</span><span class="op" id="5309373">.</span><span class="ident" id="5309374">IsNil</span><span class="op" id="5309379">(</span><span class="op" id="5309380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309383">case</span>&nbsp;<span class="ident" id="5309388">reflect</span><span class="op" id="5309395">.</span><span class="ident" id="5309396">Int</span><span class="op" id="5309399">,</span>&nbsp;<span class="ident" id="5309401">reflect</span><span class="op" id="5309408">.</span><span class="ident" id="5309409">Int8</span><span class="op" id="5309413">,</span>&nbsp;<span class="ident" id="5309415">reflect</span><span class="op" id="5309422">.</span><span class="ident" id="5309423">Int16</span><span class="op" id="5309428">,</span>&nbsp;<span class="ident" id="5309430">reflect</span><span class="op" id="5309437">.</span><span class="ident" id="5309438">Int32</span><span class="op" id="5309443">,</span>&nbsp;<span class="ident" id="5309445">reflect</span><span class="op" id="5309452">.</span><span class="ident" id="5309453">Int64</span><span class="op" id="5309458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309462">truth</span>&nbsp;<span class="op" id="5309468">=</span>&nbsp;<span class="ident" id="5309470">val</span><span class="op" id="5309473">.</span><span class="ident" id="5309474">Int</span><span class="op" id="5309477">(</span><span class="op" id="5309478">)</span>&nbsp;<span class="op" id="5309480">!=</span>&nbsp;<span class="num" id="5309483">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309486">case</span>&nbsp;<span class="ident" id="5309491">reflect</span><span class="op" id="5309498">.</span><span class="ident" id="5309499">Float32</span><span class="op" id="5309506">,</span>&nbsp;<span class="ident" id="5309508">reflect</span><span class="op" id="5309515">.</span><span class="ident" id="5309516">Float64</span><span class="op" id="5309523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309527">truth</span>&nbsp;<span class="op" id="5309533">=</span>&nbsp;<span class="ident" id="5309535">val</span><span class="op" id="5309538">.</span><span class="ident" id="5309539">Float</span><span class="op" id="5309544">(</span><span class="op" id="5309545">)</span>&nbsp;<span class="op" id="5309547">!=</span>&nbsp;<span class="num" id="5309550">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309553">case</span>&nbsp;<span class="ident" id="5309558">reflect</span><span class="op" id="5309565">.</span><span class="ident" id="5309566">Uint</span><span class="op" id="5309570">,</span>&nbsp;<span class="ident" id="5309572">reflect</span><span class="op" id="5309579">.</span><span class="ident" id="5309580">Uint8</span><span class="op" id="5309585">,</span>&nbsp;<span class="ident" id="5309587">reflect</span><span class="op" id="5309594">.</span><span class="ident" id="5309595">Uint16</span><span class="op" id="5309601">,</span>&nbsp;<span class="ident" id="5309603">reflect</span><span class="op" id="5309610">.</span><span class="ident" id="5309611">Uint32</span><span class="op" id="5309617">,</span>&nbsp;<span class="ident" id="5309619">reflect</span><span class="op" id="5309626">.</span><span class="ident" id="5309627">Uint64</span><span class="op" id="5309633">,</span>&nbsp;<span class="ident" id="5309635">reflect</span><span class="op" id="5309642">.</span><span class="ident" id="5309643">Uintptr</span><span class="op" id="5309650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309654">truth</span>&nbsp;<span class="op" id="5309660">=</span>&nbsp;<span class="ident" id="5309662">val</span><span class="op" id="5309665">.</span><span class="ident" id="5309666">Uint</span><span class="op" id="5309670">(</span><span class="op" id="5309671">)</span>&nbsp;<span class="op" id="5309673">!=</span>&nbsp;<span class="num" id="5309676">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309679">case</span>&nbsp;<span class="ident" id="5309684">reflect</span><span class="op" id="5309691">.</span><span class="ident" id="5309692">Struct</span><span class="op" id="5309698">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309702">truth</span>&nbsp;<span class="op" id="5309708">=</span>&nbsp;<span class="builtintype" id="5309710">true</span>&nbsp;<span class="comment" id="5309715">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309750">default</span><span class="op" id="5309757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5309769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309772">return</span>&nbsp;<span class="ident" id="5309779">truth</span><span class="op" id="5309784">,</span>&nbsp;<span class="builtintype" id="5309786">true</span><br>
<span class="lineno">240</span><span class="op" id="5309791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5309794">func</span>&nbsp;<span class="op" id="5309799">(</span><span class="ident" id="5309800">s</span>&nbsp;<span class="op" id="5309802">*</span><span class="ident" id="5309803">state</span><span class="op" id="5309808">)</span>&nbsp;<span class="ident" id="5309810">walkRange</span><span class="op" id="5309819">(</span><span class="ident" id="5309820">dot</span>&nbsp;<span class="ident" id="5309824">reflect</span><span class="op" id="5309831">.</span><span class="ident" id="5309832">Value</span><span class="op" id="5309837">,</span>&nbsp;<span class="ident" id="5309839">r</span>&nbsp;<span class="op" id="5309841">*</span><span class="ident" id="5309842">parse</span><span class="op" id="5309847">.</span><span class="ident" id="5309848">RangeNode</span><span class="op" id="5309857">)</span>&nbsp;<span class="op" id="5309859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309862">s</span><span class="op" id="5309863">.</span><span class="ident" id="5309864">at</span><span class="op" id="5309866">(</span><span class="ident" id="5309867">r</span><span class="op" id="5309868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5309871">defer</span>&nbsp;<span class="ident" id="5309877">s</span><span class="op" id="5309878">.</span><span class="ident" id="5309879">pop</span><span class="op" id="5309882">(</span><span class="ident" id="5309883">s</span><span class="op" id="5309884">.</span><span class="ident" id="5309885">mark</span><span class="op" id="5309889">(</span><span class="op" id="5309890">)</span><span class="op" id="5309891">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5309894">val</span><span class="op" id="5309897">,</span>&nbsp;<span class="ident" id="5309899">_</span>&nbsp;<span class="op" id="5309901">:=</span>&nbsp;<span class="ident" id="5309904">indirect</span><span class="op" id="5309912">(</span><span class="ident" id="5309913">s</span><span class="op" id="5309914">.</span><span class="ident" id="5309915">evalPipeline</span><span class="op" id="5309927">(</span><span class="ident" id="5309928">dot</span><span class="op" id="5309931">,</span>&nbsp;<span class="ident" id="5309933">r</span><span class="op" id="5309934">.</span><span class="ident" id="5309935">Pipe</span><span class="op" id="5309939">)</span><span class="op" id="5309940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5309943">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310010">mark</span>&nbsp;<span class="op" id="5310015">:=</span>&nbsp;<span class="ident" id="5310018">s</span><span class="op" id="5310019">.</span><span class="ident" id="5310020">mark</span><span class="op" id="5310024">(</span><span class="op" id="5310025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310028">oneIteration</span>&nbsp;<span class="op" id="5310041">:=</span>&nbsp;<span class="keyword" id="5310044">func</span><span class="op" id="5310048">(</span><span class="ident" id="5310049">index</span><span class="op" id="5310054">,</span>&nbsp;<span class="ident" id="5310056">elem</span>&nbsp;<span class="ident" id="5310061">reflect</span><span class="op" id="5310068">.</span><span class="ident" id="5310069">Value</span><span class="op" id="5310074">)</span>&nbsp;<span class="op" id="5310076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5310080">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310153">if</span>&nbsp;<span class="builtinfunc" id="5310156">len</span><span class="op" id="5310159">(</span><span class="ident" id="5310160">r</span><span class="op" id="5310161">.</span><span class="ident" id="5310162">Pipe</span><span class="op" id="5310166">.</span><span class="ident" id="5310167">Decl</span><span class="op" id="5310171">)</span>&nbsp;<span class="op" id="5310173">&gt;</span>&nbsp;<span class="num" id="5310175">0</span>&nbsp;<span class="op" id="5310177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310182">s</span><span class="op" id="5310183">.</span><span class="ident" id="5310184">setVar</span><span class="op" id="5310190">(</span><span class="num" id="5310191">1</span><span class="op" id="5310192">,</span>&nbsp;<span class="ident" id="5310194">elem</span><span class="op" id="5310198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5310206">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310277">if</span>&nbsp;<span class="builtinfunc" id="5310280">len</span><span class="op" id="5310283">(</span><span class="ident" id="5310284">r</span><span class="op" id="5310285">.</span><span class="ident" id="5310286">Pipe</span><span class="op" id="5310290">.</span><span class="ident" id="5310291">Decl</span><span class="op" id="5310295">)</span>&nbsp;<span class="op" id="5310297">&gt;</span>&nbsp;<span class="num" id="5310299">1</span>&nbsp;<span class="op" id="5310301">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310306">s</span><span class="op" id="5310307">.</span><span class="ident" id="5310308">setVar</span><span class="op" id="5310314">(</span><span class="num" id="5310315">2</span><span class="op" id="5310316">,</span>&nbsp;<span class="ident" id="5310318">index</span><span class="op" id="5310323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310331">s</span><span class="op" id="5310332">.</span><span class="ident" id="5310333">walk</span><span class="op" id="5310337">(</span><span class="ident" id="5310338">elem</span><span class="op" id="5310342">,</span>&nbsp;<span class="ident" id="5310344">r</span><span class="op" id="5310345">.</span><span class="ident" id="5310346">List</span><span class="op" id="5310350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310354">s</span><span class="op" id="5310355">.</span><span class="ident" id="5310356">pop</span><span class="op" id="5310359">(</span><span class="ident" id="5310360">mark</span><span class="op" id="5310364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310367">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310370">switch</span>&nbsp;<span class="ident" id="5310377">val</span><span class="op" id="5310380">.</span><span class="ident" id="5310381">Kind</span><span class="op" id="5310385">(</span><span class="op" id="5310386">)</span>&nbsp;<span class="op" id="5310388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310391">case</span>&nbsp;<span class="ident" id="5310396">reflect</span><span class="op" id="5310403">.</span><span class="ident" id="5310404">Array</span><span class="op" id="5310409">,</span>&nbsp;<span class="ident" id="5310411">reflect</span><span class="op" id="5310418">.</span><span class="ident" id="5310419">Slice</span><span class="op" id="5310424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310428">if</span>&nbsp;<span class="ident" id="5310431">val</span><span class="op" id="5310434">.</span><span class="ident" id="5310435">Len</span><span class="op" id="5310438">(</span><span class="op" id="5310439">)</span>&nbsp;<span class="op" id="5310441">==</span>&nbsp;<span class="num" id="5310444">0</span>&nbsp;<span class="op" id="5310446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310451">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310459">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310463">for</span>&nbsp;<span class="ident" id="5310467">i</span>&nbsp;<span class="op" id="5310469">:=</span>&nbsp;<span class="num" id="5310472">0</span><span class="op" id="5310473">;</span>&nbsp;<span class="ident" id="5310475">i</span>&nbsp;<span class="op" id="5310477">&lt;</span>&nbsp;<span class="ident" id="5310479">val</span><span class="op" id="5310482">.</span><span class="ident" id="5310483">Len</span><span class="op" id="5310486">(</span><span class="op" id="5310487">)</span><span class="op" id="5310488">;</span>&nbsp;<span class="ident" id="5310490">i</span><span class="op" id="5310491">++</span>&nbsp;<span class="op" id="5310494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310499">oneIteration</span><span class="op" id="5310511">(</span><span class="ident" id="5310512">reflect</span><span class="op" id="5310519">.</span><span class="ident" id="5310520">ValueOf</span><span class="op" id="5310527">(</span><span class="ident" id="5310528">i</span><span class="op" id="5310529">)</span><span class="op" id="5310530">,</span>&nbsp;<span class="ident" id="5310532">val</span><span class="op" id="5310535">.</span><span class="ident" id="5310536">Index</span><span class="op" id="5310541">(</span><span class="ident" id="5310542">i</span><span class="op" id="5310543">)</span><span class="op" id="5310544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310552">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310560">case</span>&nbsp;<span class="ident" id="5310565">reflect</span><span class="op" id="5310572">.</span><span class="ident" id="5310573">Map</span><span class="op" id="5310576">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310580">if</span>&nbsp;<span class="ident" id="5310583">val</span><span class="op" id="5310586">.</span><span class="ident" id="5310587">Len</span><span class="op" id="5310590">(</span><span class="op" id="5310591">)</span>&nbsp;<span class="op" id="5310593">==</span>&nbsp;<span class="num" id="5310596">0</span>&nbsp;<span class="op" id="5310598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310603">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310615">for</span>&nbsp;<span class="ident" id="5310619">_</span><span class="op" id="5310620">,</span>&nbsp;<span class="ident" id="5310622">key</span>&nbsp;<span class="op" id="5310626">:=</span>&nbsp;<span class="keyword" id="5310629">range</span>&nbsp;<span class="ident" id="5310635">sortKeys</span><span class="op" id="5310643">(</span><span class="ident" id="5310644">val</span><span class="op" id="5310647">.</span><span class="ident" id="5310648">MapKeys</span><span class="op" id="5310655">(</span><span class="op" id="5310656">)</span><span class="op" id="5310657">)</span>&nbsp;<span class="op" id="5310659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310664">oneIteration</span><span class="op" id="5310676">(</span><span class="ident" id="5310677">key</span><span class="op" id="5310680">,</span>&nbsp;<span class="ident" id="5310682">val</span><span class="op" id="5310685">.</span><span class="ident" id="5310686">MapIndex</span><span class="op" id="5310694">(</span><span class="ident" id="5310695">key</span><span class="op" id="5310698">)</span><span class="op" id="5310699">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310707">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310715">case</span>&nbsp;<span class="ident" id="5310720">reflect</span><span class="op" id="5310727">.</span><span class="ident" id="5310728">Chan</span><span class="op" id="5310732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310736">if</span>&nbsp;<span class="ident" id="5310739">val</span><span class="op" id="5310742">.</span><span class="ident" id="5310743">IsNil</span><span class="op" id="5310748">(</span><span class="op" id="5310749">)</span>&nbsp;<span class="op" id="5310751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310756">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310768">i</span>&nbsp;<span class="op" id="5310770">:=</span>&nbsp;<span class="num" id="5310773">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310777">for</span>&nbsp;<span class="op" id="5310781">;</span>&nbsp;<span class="op" id="5310783">;</span>&nbsp;<span class="ident" id="5310785">i</span><span class="op" id="5310786">++</span>&nbsp;<span class="op" id="5310789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310794">elem</span><span class="op" id="5310798">,</span>&nbsp;<span class="ident" id="5310800">ok</span>&nbsp;<span class="op" id="5310803">:=</span>&nbsp;<span class="ident" id="5310806">val</span><span class="op" id="5310809">.</span><span class="ident" id="5310810">Recv</span><span class="op" id="5310814">(</span><span class="op" id="5310815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310820">if</span>&nbsp;<span class="op" id="5310823">!</span><span class="ident" id="5310824">ok</span>&nbsp;<span class="op" id="5310827">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310833">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5310847">oneIteration</span><span class="op" id="5310859">(</span><span class="ident" id="5310860">reflect</span><span class="op" id="5310867">.</span><span class="ident" id="5310868">ValueOf</span><span class="op" id="5310875">(</span><span class="ident" id="5310876">i</span><span class="op" id="5310877">)</span><span class="op" id="5310878">,</span>&nbsp;<span class="ident" id="5310880">elem</span><span class="op" id="5310884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310892">if</span>&nbsp;<span class="ident" id="5310895">i</span>&nbsp;<span class="op" id="5310897">==</span>&nbsp;<span class="num" id="5310900">0</span>&nbsp;<span class="op" id="5310902">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310907">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5310915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310927">case</span>&nbsp;<span class="ident" id="5310932">reflect</span><span class="op" id="5310939">.</span><span class="ident" id="5310940">Invalid</span><span class="op" id="5310947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5310951">break</span>&nbsp;<span class="comment" id="5310957">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311032">default</span><span class="op" id="5311039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311043">s</span><span class="op" id="5311044">.</span><span class="ident" id="5311045">errorf</span><span class="op" id="5311051">(</span><span class="string" id="5311052">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="5311081">,</span>&nbsp;<span class="ident" id="5311083">val</span><span class="op" id="5311086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5311089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311092">if</span>&nbsp;<span class="ident" id="5311095">r</span><span class="op" id="5311096">.</span><span class="ident" id="5311097">ElseList</span>&nbsp;<span class="op" id="5311106">!=</span>&nbsp;<span class="ident" id="5311109">nil</span>&nbsp;<span class="op" id="5311113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311117">s</span><span class="op" id="5311118">.</span><span class="ident" id="5311119">walk</span><span class="op" id="5311123">(</span><span class="ident" id="5311124">dot</span><span class="op" id="5311127">,</span>&nbsp;<span class="ident" id="5311129">r</span><span class="op" id="5311130">.</span><span class="ident" id="5311131">ElseList</span><span class="op" id="5311139">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5311142">}</span><br>
<span class="lineno"></span><span class="op" id="5311144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5311147">func</span>&nbsp;<span class="op" id="5311152">(</span><span class="ident" id="5311153">s</span>&nbsp;<span class="op" id="5311155">*</span><span class="ident" id="5311156">state</span><span class="op" id="5311161">)</span>&nbsp;<span class="ident" id="5311163">walkTemplate</span><span class="op" id="5311175">(</span><span class="ident" id="5311176">dot</span>&nbsp;<span class="ident" id="5311180">reflect</span><span class="op" id="5311187">.</span><span class="ident" id="5311188">Value</span><span class="op" id="5311193">,</span>&nbsp;<span class="ident" id="5311195">t</span>&nbsp;<span class="op" id="5311197">*</span><span class="ident" id="5311198">parse</span><span class="op" id="5311203">.</span><span class="ident" id="5311204">TemplateNode</span><span class="op" id="5311216">)</span>&nbsp;<span class="op" id="5311218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311221">s</span><span class="op" id="5311222">.</span><span class="ident" id="5311223">at</span><span class="op" id="5311225">(</span><span class="ident" id="5311226">t</span><span class="op" id="5311227">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311230">tmpl</span>&nbsp;<span class="op" id="5311235">:=</span>&nbsp;<span class="ident" id="5311238">s</span><span class="op" id="5311239">.</span><span class="ident" id="5311240">tmpl</span><span class="op" id="5311244">.</span><span class="ident" id="5311245">tmpl</span><span class="op" id="5311249">[</span><span class="ident" id="5311250">t</span><span class="op" id="5311251">.</span><span class="ident" id="5311252">Name</span><span class="op" id="5311256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5311259">if</span>&nbsp;<span class="ident" id="5311262">tmpl</span>&nbsp;<span class="op" id="5311267">==</span>&nbsp;<span class="ident" id="5311270">nil</span>&nbsp;<span class="op" id="5311274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311278">s</span><span class="op" id="5311279">.</span><span class="ident" id="5311280">errorf</span><span class="op" id="5311286">(</span><span class="string" id="5311287">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="5311312">,</span>&nbsp;<span class="ident" id="5311314">t</span><span class="op" id="5311315">.</span><span class="ident" id="5311316">Name</span><span class="op" id="5311320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5311323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5311326">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311374">dot</span>&nbsp;<span class="op" id="5311378">=</span>&nbsp;<span class="ident" id="5311380">s</span><span class="op" id="5311381">.</span><span class="ident" id="5311382">evalPipeline</span><span class="op" id="5311394">(</span><span class="ident" id="5311395">dot</span><span class="op" id="5311398">,</span>&nbsp;<span class="ident" id="5311400">t</span><span class="op" id="5311401">.</span><span class="ident" id="5311402">Pipe</span><span class="op" id="5311406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311409">newState</span>&nbsp;<span class="op" id="5311418">:=</span>&nbsp;<span class="op" id="5311421">*</span><span class="ident" id="5311422">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311425">newState</span><span class="op" id="5311433">.</span><span class="ident" id="5311434">tmpl</span>&nbsp;<span class="op" id="5311439">=</span>&nbsp;<span class="ident" id="5311441">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5311447">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311514">newState</span><span class="op" id="5311522">.</span><span class="ident" id="5311523">vars</span>&nbsp;<span class="op" id="5311528">=</span>&nbsp;<span class="op" id="5311530">[</span><span class="op" id="5311531">]</span><span class="ident" id="5311532">variable</span><span class="op" id="5311540">{</span><span class="op" id="5311541">{</span><span class="string" id="5311542">&#34;$&#34;</span><span class="op" id="5311545">,</span>&nbsp;<span class="ident" id="5311547">dot</span><span class="op" id="5311550">}</span><span class="op" id="5311551">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5311554">newState</span><span class="op" id="5311562">.</span><span class="ident" id="5311563">walk</span><span class="op" id="5311567">(</span><span class="ident" id="5311568">dot</span><span class="op" id="5311571">,</span>&nbsp;<span class="ident" id="5311573">tmpl</span><span class="op" id="5311577">.</span><span class="ident" id="5311578">Root</span><span class="op" id="5311582">)</span><br>
<span class="lineno"></span><span class="op" id="5311584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5311587">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="5311666">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="5311749">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5311819">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5311895">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5311970">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="5312043">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5312098">func</span>&nbsp;<span class="op" id="5312103">(</span><span class="ident" id="5312104">s</span>&nbsp;<span class="op" id="5312106">*</span><span class="ident" id="5312107">state</span><span class="op" id="5312112">)</span>&nbsp;<span class="ident" id="5312114">evalPipeline</span><span class="op" id="5312126">(</span><span class="ident" id="5312127">dot</span>&nbsp;<span class="ident" id="5312131">reflect</span><span class="op" id="5312138">.</span><span class="ident" id="5312139">Value</span><span class="op" id="5312144">,</span>&nbsp;<span class="ident" id="5312146">pipe</span>&nbsp;<span class="op" id="5312151">*</span><span class="ident" id="5312152">parse</span><span class="op" id="5312157">.</span><span class="ident" id="5312158">PipeNode</span><span class="op" id="5312166">)</span>&nbsp;<span class="op" id="5312168">(</span><span class="ident" id="5312169">value</span>&nbsp;<span class="ident" id="5312175">reflect</span><span class="op" id="5312182">.</span><span class="ident" id="5312183">Value</span><span class="op" id="5312188">)</span>&nbsp;<span class="op" id="5312190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312193">if</span>&nbsp;<span class="ident" id="5312196">pipe</span>&nbsp;<span class="op" id="5312201">==</span>&nbsp;<span class="ident" id="5312204">nil</span>&nbsp;<span class="op" id="5312208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312220">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312223">s</span><span class="op" id="5312224">.</span><span class="ident" id="5312225">at</span><span class="op" id="5312227">(</span><span class="ident" id="5312228">pipe</span><span class="op" id="5312232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312235">for</span>&nbsp;<span class="ident" id="5312239">_</span><span class="op" id="5312240">,</span>&nbsp;<span class="ident" id="5312242">cmd</span>&nbsp;<span class="op" id="5312246">:=</span>&nbsp;<span class="keyword" id="5312249">range</span>&nbsp;<span class="ident" id="5312255">pipe</span><span class="op" id="5312259">.</span><span class="ident" id="5312260">Cmds</span>&nbsp;<span class="op" id="5312265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312269">value</span>&nbsp;<span class="op" id="5312275">=</span>&nbsp;<span class="ident" id="5312277">s</span><span class="op" id="5312278">.</span><span class="ident" id="5312279">evalCommand</span><span class="op" id="5312290">(</span><span class="ident" id="5312291">dot</span><span class="op" id="5312294">,</span>&nbsp;<span class="ident" id="5312296">cmd</span><span class="op" id="5312299">,</span>&nbsp;<span class="ident" id="5312301">value</span><span class="op" id="5312306">)</span>&nbsp;<span class="comment" id="5312308">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5312353">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312434">if</span>&nbsp;<span class="ident" id="5312437">value</span><span class="op" id="5312442">.</span><span class="ident" id="5312443">Kind</span><span class="op" id="5312447">(</span><span class="op" id="5312448">)</span>&nbsp;<span class="op" id="5312450">==</span>&nbsp;<span class="ident" id="5312453">reflect</span><span class="op" id="5312460">.</span><span class="ident" id="5312461">Interface</span>&nbsp;<span class="op" id="5312471">&amp;&amp;</span>&nbsp;<span class="ident" id="5312474">value</span><span class="op" id="5312479">.</span><span class="ident" id="5312480">Type</span><span class="op" id="5312484">(</span><span class="op" id="5312485">)</span><span class="op" id="5312486">.</span><span class="ident" id="5312487">NumMethod</span><span class="op" id="5312496">(</span><span class="op" id="5312497">)</span>&nbsp;<span class="op" id="5312499">==</span>&nbsp;<span class="num" id="5312502">0</span>&nbsp;<span class="op" id="5312504">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312509">value</span>&nbsp;<span class="op" id="5312515">=</span>&nbsp;<span class="ident" id="5312517">reflect</span><span class="op" id="5312524">.</span><span class="ident" id="5312525">ValueOf</span><span class="op" id="5312532">(</span><span class="ident" id="5312533">value</span><span class="op" id="5312538">.</span><span class="ident" id="5312539">Interface</span><span class="op" id="5312548">(</span><span class="op" id="5312549">)</span><span class="op" id="5312550">)</span>&nbsp;<span class="comment" id="5312552">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312571">for</span>&nbsp;<span class="ident" id="5312575">_</span><span class="op" id="5312576">,</span>&nbsp;<span class="ident" id="5312578">variable</span>&nbsp;<span class="op" id="5312587">:=</span>&nbsp;<span class="keyword" id="5312590">range</span>&nbsp;<span class="ident" id="5312596">pipe</span><span class="op" id="5312600">.</span><span class="ident" id="5312601">Decl</span>&nbsp;<span class="op" id="5312606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312610">s</span><span class="op" id="5312611">.</span><span class="ident" id="5312612">push</span><span class="op" id="5312616">(</span><span class="ident" id="5312617">variable</span><span class="op" id="5312625">.</span><span class="ident" id="5312626">Ident</span><span class="op" id="5312631">[</span><span class="num" id="5312632">0</span><span class="op" id="5312633">]</span><span class="op" id="5312634">,</span>&nbsp;<span class="ident" id="5312636">value</span><span class="op" id="5312641">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312647">return</span>&nbsp;<span class="ident" id="5312654">value</span><br>
<span class="lineno"></span><span class="op" id="5312660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5312663">func</span>&nbsp;<span class="op" id="5312668">(</span><span class="ident" id="5312669">s</span>&nbsp;<span class="op" id="5312671">*</span><span class="ident" id="5312672">state</span><span class="op" id="5312677">)</span>&nbsp;<span class="ident" id="5312679">notAFunction</span><span class="op" id="5312691">(</span><span class="ident" id="5312692">args</span>&nbsp;<span class="op" id="5312697">[</span><span class="op" id="5312698">]</span><span class="ident" id="5312699">parse</span><span class="op" id="5312704">.</span><span class="ident" id="5312705">Node</span><span class="op" id="5312709">,</span>&nbsp;<span class="ident" id="5312711">final</span>&nbsp;<span class="ident" id="5312717">reflect</span><span class="op" id="5312724">.</span><span class="ident" id="5312725">Value</span><span class="op" id="5312730">)</span>&nbsp;<span class="op" id="5312732">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312735">if</span>&nbsp;<span class="builtinfunc" id="5312738">len</span><span class="op" id="5312741">(</span><span class="ident" id="5312742">args</span><span class="op" id="5312746">)</span>&nbsp;<span class="op" id="5312748">&gt;</span>&nbsp;<span class="num" id="5312750">1</span>&nbsp;<span class="op" id="5312752">||</span>&nbsp;<span class="ident" id="5312755">final</span><span class="op" id="5312760">.</span><span class="ident" id="5312761">IsValid</span><span class="op" id="5312768">(</span><span class="op" id="5312769">)</span>&nbsp;<span class="op" id="5312771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312775">s</span><span class="op" id="5312776">.</span><span class="ident" id="5312777">errorf</span><span class="op" id="5312783">(</span><span class="string" id="5312784">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="5312824">,</span>&nbsp;<span class="ident" id="5312826">args</span><span class="op" id="5312830">[</span><span class="num" id="5312831">0</span><span class="op" id="5312832">]</span><span class="op" id="5312833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5312836">}</span><br>
<span class="lineno"></span><span class="op" id="5312838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5312841">func</span>&nbsp;<span class="op" id="5312846">(</span><span class="ident" id="5312847">s</span>&nbsp;<span class="op" id="5312849">*</span><span class="ident" id="5312850">state</span><span class="op" id="5312855">)</span>&nbsp;<span class="ident" id="5312857">evalCommand</span><span class="op" id="5312868">(</span><span class="ident" id="5312869">dot</span>&nbsp;<span class="ident" id="5312873">reflect</span><span class="op" id="5312880">.</span><span class="ident" id="5312881">Value</span><span class="op" id="5312886">,</span>&nbsp;<span class="ident" id="5312888">cmd</span>&nbsp;<span class="op" id="5312892">*</span><span class="ident" id="5312893">parse</span><span class="op" id="5312898">.</span><span class="ident" id="5312899">CommandNode</span><span class="op" id="5312910">,</span>&nbsp;<span class="ident" id="5312912">final</span>&nbsp;<span class="ident" id="5312918">reflect</span><span class="op" id="5312925">.</span><span class="ident" id="5312926">Value</span><span class="op" id="5312931">)</span>&nbsp;<span class="ident" id="5312933">reflect</span><span class="op" id="5312940">.</span><span class="ident" id="5312941">Value</span>&nbsp;<span class="op" id="5312947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5312950">firstWord</span>&nbsp;<span class="op" id="5312960">:=</span>&nbsp;<span class="ident" id="5312963">cmd</span><span class="op" id="5312966">.</span><span class="ident" id="5312967">Args</span><span class="op" id="5312971">[</span><span class="num" id="5312972">0</span><span class="op" id="5312973">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5312976">switch</span>&nbsp;<span class="ident" id="5312983">n</span>&nbsp;<span class="op" id="5312985">:=</span>&nbsp;<span class="ident" id="5312988">firstWord</span><span class="op" id="5312997">.</span><span class="op" id="5312998">(</span><span class="keyword" id="5312999">type</span><span class="op" id="5313003">)</span>&nbsp;<span class="op" id="5313005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313008">case</span>&nbsp;<span class="op" id="5313013">*</span><span class="ident" id="5313014">parse</span><span class="op" id="5313019">.</span><span class="ident" id="5313020">FieldNode</span><span class="op" id="5313029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313033">return</span>&nbsp;<span class="ident" id="5313040">s</span><span class="op" id="5313041">.</span><span class="ident" id="5313042">evalFieldNode</span><span class="op" id="5313055">(</span><span class="ident" id="5313056">dot</span><span class="op" id="5313059">,</span>&nbsp;<span class="ident" id="5313061">n</span><span class="op" id="5313062">,</span>&nbsp;<span class="ident" id="5313064">cmd</span><span class="op" id="5313067">.</span><span class="ident" id="5313068">Args</span><span class="op" id="5313072">,</span>&nbsp;<span class="ident" id="5313074">final</span><span class="op" id="5313079">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313082">case</span>&nbsp;<span class="op" id="5313087">*</span><span class="ident" id="5313088">parse</span><span class="op" id="5313093">.</span><span class="ident" id="5313094">ChainNode</span><span class="op" id="5313103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313107">return</span>&nbsp;<span class="ident" id="5313114">s</span><span class="op" id="5313115">.</span><span class="ident" id="5313116">evalChainNode</span><span class="op" id="5313129">(</span><span class="ident" id="5313130">dot</span><span class="op" id="5313133">,</span>&nbsp;<span class="ident" id="5313135">n</span><span class="op" id="5313136">,</span>&nbsp;<span class="ident" id="5313138">cmd</span><span class="op" id="5313141">.</span><span class="ident" id="5313142">Args</span><span class="op" id="5313146">,</span>&nbsp;<span class="ident" id="5313148">final</span><span class="op" id="5313153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313156">case</span>&nbsp;<span class="op" id="5313161">*</span><span class="ident" id="5313162">parse</span><span class="op" id="5313167">.</span><span class="ident" id="5313168">IdentifierNode</span><span class="op" id="5313182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5313186">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313211">return</span>&nbsp;<span class="ident" id="5313218">s</span><span class="op" id="5313219">.</span><span class="ident" id="5313220">evalFunction</span><span class="op" id="5313232">(</span><span class="ident" id="5313233">dot</span><span class="op" id="5313236">,</span>&nbsp;<span class="ident" id="5313238">n</span><span class="op" id="5313239">,</span>&nbsp;<span class="ident" id="5313241">cmd</span><span class="op" id="5313244">,</span>&nbsp;<span class="ident" id="5313246">cmd</span><span class="op" id="5313249">.</span><span class="ident" id="5313250">Args</span><span class="op" id="5313254">,</span>&nbsp;<span class="ident" id="5313256">final</span><span class="op" id="5313261">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313264">case</span>&nbsp;<span class="op" id="5313269">*</span><span class="ident" id="5313270">parse</span><span class="op" id="5313275">.</span><span class="ident" id="5313276">PipeNode</span><span class="op" id="5313284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5313288">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313378">return</span>&nbsp;<span class="ident" id="5313385">s</span><span class="op" id="5313386">.</span><span class="ident" id="5313387">evalPipeline</span><span class="op" id="5313399">(</span><span class="ident" id="5313400">dot</span><span class="op" id="5313403">,</span>&nbsp;<span class="ident" id="5313405">n</span><span class="op" id="5313406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313409">case</span>&nbsp;<span class="op" id="5313414">*</span><span class="ident" id="5313415">parse</span><span class="op" id="5313420">.</span><span class="ident" id="5313421">VariableNode</span><span class="op" id="5313433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313437">return</span>&nbsp;<span class="ident" id="5313444">s</span><span class="op" id="5313445">.</span><span class="ident" id="5313446">evalVariableNode</span><span class="op" id="5313462">(</span><span class="ident" id="5313463">dot</span><span class="op" id="5313466">,</span>&nbsp;<span class="ident" id="5313468">n</span><span class="op" id="5313469">,</span>&nbsp;<span class="ident" id="5313471">cmd</span><span class="op" id="5313474">.</span><span class="ident" id="5313475">Args</span><span class="op" id="5313479">,</span>&nbsp;<span class="ident" id="5313481">final</span><span class="op" id="5313486">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313492">s</span><span class="op" id="5313493">.</span><span class="ident" id="5313494">at</span><span class="op" id="5313496">(</span><span class="ident" id="5313497">firstWord</span><span class="op" id="5313506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313509">s</span><span class="op" id="5313510">.</span><span class="ident" id="5313511">notAFunction</span><span class="op" id="5313523">(</span><span class="ident" id="5313524">cmd</span><span class="op" id="5313527">.</span><span class="ident" id="5313528">Args</span><span class="op" id="5313532">,</span>&nbsp;<span class="ident" id="5313534">final</span><span class="op" id="5313539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313542">switch</span>&nbsp;<span class="ident" id="5313549">word</span>&nbsp;<span class="op" id="5313554">:=</span>&nbsp;<span class="ident" id="5313557">firstWord</span><span class="op" id="5313566">.</span><span class="op" id="5313567">(</span><span class="keyword" id="5313568">type</span><span class="op" id="5313572">)</span>&nbsp;<span class="op" id="5313574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313577">case</span>&nbsp;<span class="op" id="5313582">*</span><span class="ident" id="5313583">parse</span><span class="op" id="5313588">.</span><span class="ident" id="5313589">BoolNode</span><span class="op" id="5313597">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313601">return</span>&nbsp;<span class="ident" id="5313608">reflect</span><span class="op" id="5313615">.</span><span class="ident" id="5313616">ValueOf</span><span class="op" id="5313623">(</span><span class="ident" id="5313624">word</span><span class="op" id="5313628">.</span><span class="ident" id="5313629">True</span><span class="op" id="5313633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313636">case</span>&nbsp;<span class="op" id="5313641">*</span><span class="ident" id="5313642">parse</span><span class="op" id="5313647">.</span><span class="ident" id="5313648">DotNode</span><span class="op" id="5313655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313659">return</span>&nbsp;<span class="ident" id="5313666">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313671">case</span>&nbsp;<span class="op" id="5313676">*</span><span class="ident" id="5313677">parse</span><span class="op" id="5313682">.</span><span class="ident" id="5313683">NilNode</span><span class="op" id="5313690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313694">s</span><span class="op" id="5313695">.</span><span class="ident" id="5313696">errorf</span><span class="op" id="5313702">(</span><span class="string" id="5313703">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="5313725">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313728">case</span>&nbsp;<span class="op" id="5313733">*</span><span class="ident" id="5313734">parse</span><span class="op" id="5313739">.</span><span class="ident" id="5313740">NumberNode</span><span class="op" id="5313750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313754">return</span>&nbsp;<span class="ident" id="5313761">s</span><span class="op" id="5313762">.</span><span class="ident" id="5313763">idealConstant</span><span class="op" id="5313776">(</span><span class="ident" id="5313777">word</span><span class="op" id="5313781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313784">case</span>&nbsp;<span class="op" id="5313789">*</span><span class="ident" id="5313790">parse</span><span class="op" id="5313795">.</span><span class="ident" id="5313796">StringNode</span><span class="op" id="5313806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5313810">return</span>&nbsp;<span class="ident" id="5313817">reflect</span><span class="op" id="5313824">.</span><span class="ident" id="5313825">ValueOf</span><span class="op" id="5313832">(</span><span class="ident" id="5313833">word</span><span class="op" id="5313837">.</span><span class="ident" id="5313838">Text</span><span class="op" id="5313842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5313845">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5313848">s</span><span class="op" id="5313849">.</span><span class="ident" id="5313850">errorf</span><span class="op" id="5313856">(</span><span class="string" id="5313857">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="5313884">,</span>&nbsp;<span class="ident" id="5313886">firstWord</span><span class="op" id="5313895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5313898">panic</span><span class="op" id="5313903">(</span><span class="string" id="5313904">&#34;not&nbsp;reached&#34;</span><span class="op" id="5313917">)</span><br>
<span class="lineno"></span><span class="op" id="5313919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5313922">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="5314000">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="5314075">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5314152">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5314228">func</span>&nbsp;<span class="op" id="5314233">(</span><span class="ident" id="5314234">s</span>&nbsp;<span class="op" id="5314236">*</span><span class="ident" id="5314237">state</span><span class="op" id="5314242">)</span>&nbsp;<span class="ident" id="5314244">idealConstant</span><span class="op" id="5314257">(</span><span class="ident" id="5314258">constant</span>&nbsp;<span class="op" id="5314267">*</span><span class="ident" id="5314268">parse</span><span class="op" id="5314273">.</span><span class="ident" id="5314274">NumberNode</span><span class="op" id="5314284">)</span>&nbsp;<span class="ident" id="5314286">reflect</span><span class="op" id="5314293">.</span><span class="ident" id="5314294">Value</span>&nbsp;<span class="op" id="5314300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5314303">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5314360">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5314419">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314485">s</span><span class="op" id="5314486">.</span><span class="ident" id="5314487">at</span><span class="op" id="5314489">(</span><span class="ident" id="5314490">constant</span><span class="op" id="5314498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314501">switch</span>&nbsp;<span class="op" id="5314508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314511">case</span>&nbsp;<span class="ident" id="5314516">constant</span><span class="op" id="5314524">.</span><span class="ident" id="5314525">IsComplex</span><span class="op" id="5314534">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314538">return</span>&nbsp;<span class="ident" id="5314545">reflect</span><span class="op" id="5314552">.</span><span class="ident" id="5314553">ValueOf</span><span class="op" id="5314560">(</span><span class="ident" id="5314561">constant</span><span class="op" id="5314569">.</span><span class="ident" id="5314570">Complex128</span><span class="op" id="5314580">)</span>&nbsp;<span class="comment" id="5314582">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314604">case</span>&nbsp;<span class="ident" id="5314609">constant</span><span class="op" id="5314617">.</span><span class="ident" id="5314618">IsFloat</span>&nbsp;<span class="op" id="5314626">&amp;&amp;</span>&nbsp;<span class="op" id="5314629">!</span><span class="ident" id="5314630">isHexConstant</span><span class="op" id="5314643">(</span><span class="ident" id="5314644">constant</span><span class="op" id="5314652">.</span><span class="ident" id="5314653">Text</span><span class="op" id="5314657">)</span>&nbsp;<span class="op" id="5314659">&amp;&amp;</span>&nbsp;<span class="ident" id="5314662">strings</span><span class="op" id="5314669">.</span><span class="ident" id="5314670">IndexAny</span><span class="op" id="5314678">(</span><span class="ident" id="5314679">constant</span><span class="op" id="5314687">.</span><span class="ident" id="5314688">Text</span><span class="op" id="5314692">,</span>&nbsp;<span class="string" id="5314694">&#34;.eE&#34;</span><span class="op" id="5314699">)</span>&nbsp;<span class="op" id="5314701">&gt;=</span>&nbsp;<span class="num" id="5314704">0</span><span class="op" id="5314705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314709">return</span>&nbsp;<span class="ident" id="5314716">reflect</span><span class="op" id="5314723">.</span><span class="ident" id="5314724">ValueOf</span><span class="op" id="5314731">(</span><span class="ident" id="5314732">constant</span><span class="op" id="5314740">.</span><span class="ident" id="5314741">Float64</span><span class="op" id="5314748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314751">case</span>&nbsp;<span class="ident" id="5314756">constant</span><span class="op" id="5314764">.</span><span class="ident" id="5314765">IsInt</span><span class="op" id="5314770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314774">n</span>&nbsp;<span class="op" id="5314776">:=</span>&nbsp;<span class="builtintype" id="5314779">int</span><span class="op" id="5314782">(</span><span class="ident" id="5314783">constant</span><span class="op" id="5314791">.</span><span class="ident" id="5314792">Int64</span><span class="op" id="5314797">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314801">if</span>&nbsp;<span class="ident" id="5314804">int64</span><span class="op" id="5314809">(</span><span class="ident" id="5314810">n</span><span class="op" id="5314811">)</span>&nbsp;<span class="op" id="5314813">!=</span>&nbsp;<span class="ident" id="5314816">constant</span><span class="op" id="5314824">.</span><span class="ident" id="5314825">Int64</span>&nbsp;<span class="op" id="5314831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314836">s</span><span class="op" id="5314837">.</span><span class="ident" id="5314838">errorf</span><span class="op" id="5314844">(</span><span class="string" id="5314845">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="5314863">,</span>&nbsp;<span class="ident" id="5314865">constant</span><span class="op" id="5314873">.</span><span class="ident" id="5314874">Text</span><span class="op" id="5314878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5314882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314886">return</span>&nbsp;<span class="ident" id="5314893">reflect</span><span class="op" id="5314900">.</span><span class="ident" id="5314901">ValueOf</span><span class="op" id="5314908">(</span><span class="ident" id="5314909">n</span><span class="op" id="5314910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314913">case</span>&nbsp;<span class="ident" id="5314918">constant</span><span class="op" id="5314926">.</span><span class="ident" id="5314927">IsUint</span><span class="op" id="5314933">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5314937">s</span><span class="op" id="5314938">.</span><span class="ident" id="5314939">errorf</span><span class="op" id="5314945">(</span><span class="string" id="5314946">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="5314964">,</span>&nbsp;<span class="ident" id="5314966">constant</span><span class="op" id="5314974">.</span><span class="ident" id="5314975">Text</span><span class="op" id="5314979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5314982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5314985">return</span>&nbsp;<span class="ident" id="5314992">zero</span><br>
<span class="lineno"></span><span class="op" id="5314997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="5315000">func</span>&nbsp;<span class="ident" id="5315005">isHexConstant</span><span class="op" id="5315018">(</span><span class="ident" id="5315019">s</span>&nbsp;<span class="builtintype" id="5315021">string</span><span class="op" id="5315027">)</span>&nbsp;<span class="builtintype" id="5315029">bool</span>&nbsp;<span class="op" id="5315034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315037">return</span>&nbsp;<span class="builtinfunc" id="5315044">len</span><span class="op" id="5315047">(</span><span class="ident" id="5315048">s</span><span class="op" id="5315049">)</span>&nbsp;<span class="op" id="5315051">&gt;</span>&nbsp;<span class="num" id="5315053">2</span>&nbsp;<span class="op" id="5315055">&amp;&amp;</span>&nbsp;<span class="ident" id="5315058">s</span><span class="op" id="5315059">[</span><span class="num" id="5315060">0</span><span class="op" id="5315061">]</span>&nbsp;<span class="op" id="5315063">==</span>&nbsp;<span class="string" id="5315066">&#39;0&#39;</span>&nbsp;<span class="op" id="5315070">&amp;&amp;</span>&nbsp;<span class="op" id="5315073">(</span><span class="ident" id="5315074">s</span><span class="op" id="5315075">[</span><span class="num" id="5315076">1</span><span class="op" id="5315077">]</span>&nbsp;<span class="op" id="5315079">==</span>&nbsp;<span class="string" id="5315082">&#39;x&#39;</span>&nbsp;<span class="op" id="5315086">||</span>&nbsp;<span class="ident" id="5315089">s</span><span class="op" id="5315090">[</span><span class="num" id="5315091">1</span><span class="op" id="5315092">]</span>&nbsp;<span class="op" id="5315094">==</span>&nbsp;<span class="string" id="5315097">&#39;X&#39;</span><span class="op" id="5315100">)</span><br>
<span class="lineno"></span><span class="op" id="5315102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5315105">func</span>&nbsp;<span class="op" id="5315110">(</span><span class="ident" id="5315111">s</span>&nbsp;<span class="op" id="5315113">*</span><span class="ident" id="5315114">state</span><span class="op" id="5315119">)</span>&nbsp;<span class="ident" id="5315121">evalFieldNode</span><span class="op" id="5315134">(</span><span class="ident" id="5315135">dot</span>&nbsp;<span class="ident" id="5315139">reflect</span><span class="op" id="5315146">.</span><span class="ident" id="5315147">Value</span><span class="op" id="5315152">,</span>&nbsp;<span class="ident" id="5315154">field</span>&nbsp;<span class="op" id="5315160">*</span><span class="ident" id="5315161">parse</span><span class="op" id="5315166">.</span><span class="ident" id="5315167">FieldNode</span><span class="op" id="5315176">,</span>&nbsp;<span class="ident" id="5315178">args</span>&nbsp;<span class="op" id="5315183">[</span><span class="op" id="5315184">]</span><span class="ident" id="5315185">parse</span><span class="op" id="5315190">.</span><span class="ident" id="5315191">Node</span><span class="op" id="5315195">,</span>&nbsp;<span class="ident" id="5315197">final</span>&nbsp;<span class="ident" id="5315203">reflect</span><span class="op" id="5315210">.</span><span class="ident" id="5315211">Value</span><span class="op" id="5315216">)</span>&nbsp;<span class="ident" id="5315218">reflect</span><span class="op" id="5315225">.</span><span class="ident" id="5315226">Value</span>&nbsp;<span class="op" id="5315232">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315235">s</span><span class="op" id="5315236">.</span><span class="ident" id="5315237">at</span><span class="op" id="5315239">(</span><span class="ident" id="5315240">field</span><span class="op" id="5315245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315248">return</span>&nbsp;<span class="ident" id="5315255">s</span><span class="op" id="5315256">.</span><span class="ident" id="5315257">evalFieldChain</span><span class="op" id="5315271">(</span><span class="ident" id="5315272">dot</span><span class="op" id="5315275">,</span>&nbsp;<span class="ident" id="5315277">dot</span><span class="op" id="5315280">,</span>&nbsp;<span class="ident" id="5315282">field</span><span class="op" id="5315287">,</span>&nbsp;<span class="ident" id="5315289">field</span><span class="op" id="5315294">.</span><span class="ident" id="5315295">Ident</span><span class="op" id="5315300">,</span>&nbsp;<span class="ident" id="5315302">args</span><span class="op" id="5315306">,</span>&nbsp;<span class="ident" id="5315308">final</span><span class="op" id="5315313">)</span><br>
<span class="lineno"></span><span class="op" id="5315315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5315318">func</span>&nbsp;<span class="op" id="5315323">(</span><span class="ident" id="5315324">s</span>&nbsp;<span class="op" id="5315326">*</span><span class="ident" id="5315327">state</span><span class="op" id="5315332">)</span>&nbsp;<span class="ident" id="5315334">evalChainNode</span><span class="op" id="5315347">(</span><span class="ident" id="5315348">dot</span>&nbsp;<span class="ident" id="5315352">reflect</span><span class="op" id="5315359">.</span><span class="ident" id="5315360">Value</span><span class="op" id="5315365">,</span>&nbsp;<span class="ident" id="5315367">chain</span>&nbsp;<span class="op" id="5315373">*</span><span class="ident" id="5315374">parse</span><span class="op" id="5315379">.</span><span class="ident" id="5315380">ChainNode</span><span class="op" id="5315389">,</span>&nbsp;<span class="ident" id="5315391">args</span>&nbsp;<span class="op" id="5315396">[</span><span class="op" id="5315397">]</span><span class="ident" id="5315398">parse</span><span class="op" id="5315403">.</span><span class="ident" id="5315404">Node</span><span class="op" id="5315408">,</span>&nbsp;<span class="ident" id="5315410">final</span>&nbsp;<span class="ident" id="5315416">reflect</span><span class="op" id="5315423">.</span><span class="ident" id="5315424">Value</span><span class="op" id="5315429">)</span>&nbsp;<span class="ident" id="5315431">reflect</span><span class="op" id="5315438">.</span><span class="ident" id="5315439">Value</span>&nbsp;<span class="op" id="5315445">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315448">s</span><span class="op" id="5315449">.</span><span class="ident" id="5315450">at</span><span class="op" id="5315452">(</span><span class="ident" id="5315453">chain</span><span class="op" id="5315458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5315461">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315559">pipe</span>&nbsp;<span class="op" id="5315564">:=</span>&nbsp;<span class="ident" id="5315567">s</span><span class="op" id="5315568">.</span><span class="ident" id="5315569">evalArg</span><span class="op" id="5315576">(</span><span class="ident" id="5315577">dot</span><span class="op" id="5315580">,</span>&nbsp;<span class="ident" id="5315582">nil</span><span class="op" id="5315585">,</span>&nbsp;<span class="ident" id="5315587">chain</span><span class="op" id="5315592">.</span><span class="ident" id="5315593">Node</span><span class="op" id="5315597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315600">if</span>&nbsp;<span class="builtinfunc" id="5315603">len</span><span class="op" id="5315606">(</span><span class="ident" id="5315607">chain</span><span class="op" id="5315612">.</span><span class="ident" id="5315613">Field</span><span class="op" id="5315618">)</span>&nbsp;<span class="op" id="5315620">==</span>&nbsp;<span class="num" id="5315623">0</span>&nbsp;<span class="op" id="5315625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315629">s</span><span class="op" id="5315630">.</span><span class="ident" id="5315631">errorf</span><span class="op" id="5315637">(</span><span class="string" id="5315638">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="5315682">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5315688">return</span>&nbsp;<span class="ident" id="5315695">s</span><span class="op" id="5315696">.</span><span class="ident" id="5315697">evalFieldChain</span><span class="op" id="5315711">(</span><span class="ident" id="5315712">dot</span><span class="op" id="5315715">,</span>&nbsp;<span class="ident" id="5315717">pipe</span><span class="op" id="5315721">,</span>&nbsp;<span class="ident" id="5315723">chain</span><span class="op" id="5315728">,</span>&nbsp;<span class="ident" id="5315730">chain</span><span class="op" id="5315735">.</span><span class="ident" id="5315736">Field</span><span class="op" id="5315741">,</span>&nbsp;<span class="ident" id="5315743">args</span><span class="op" id="5315747">,</span>&nbsp;<span class="ident" id="5315749">final</span><span class="op" id="5315754">)</span><br>
<span class="lineno"></span><span class="op" id="5315756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5315759">func</span>&nbsp;<span class="op" id="5315764">(</span><span class="ident" id="5315765">s</span>&nbsp;<span class="op" id="5315767">*</span><span class="ident" id="5315768">state</span><span class="op" id="5315773">)</span>&nbsp;<span class="ident" id="5315775">evalVariableNode</span><span class="op" id="5315791">(</span><span class="ident" id="5315792">dot</span>&nbsp;<span class="ident" id="5315796">reflect</span><span class="op" id="5315803">.</span><span class="ident" id="5315804">Value</span><span class="op" id="5315809">,</span>&nbsp;<span class="ident" id="5315811">variable</span>&nbsp;<span class="op" id="5315820">*</span><span class="ident" id="5315821">parse</span><span class="op" id="5315826">.</span><span class="ident" id="5315827">VariableNode</span><span class="op" id="5315839">,</span>&nbsp;<span class="ident" id="5315841">args</span>&nbsp;<span class="op" id="5315846">[</span><span class="op" id="5315847">]</span><span class="ident" id="5315848">parse</span><span class="op" id="5315853">.</span><span class="ident" id="5315854">Node</span><span class="op" id="5315858">,</span>&nbsp;<span class="ident" id="5315860">final</span>&nbsp;<span class="ident" id="5315866">reflect</span><span class="op" id="5315873">.</span><span class="ident" id="5315874">Value</span><span class="op" id="5315879">)</span>&nbsp;<span class="ident" id="5315881">reflect</span><span class="op" id="5315888">.</span><span class="ident" id="5315889">Value</span>&nbsp;<span class="op" id="5315895">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5315898">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5315990">s</span><span class="op" id="5315991">.</span><span class="ident" id="5315992">at</span><span class="op" id="5315994">(</span><span class="ident" id="5315995">variable</span><span class="op" id="5316003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316006">value</span>&nbsp;<span class="op" id="5316012">:=</span>&nbsp;<span class="ident" id="5316015">s</span><span class="op" id="5316016">.</span><span class="ident" id="5316017">varValue</span><span class="op" id="5316025">(</span><span class="ident" id="5316026">variable</span><span class="op" id="5316034">.</span><span class="ident" id="5316035">Ident</span><span class="op" id="5316040">[</span><span class="num" id="5316041">0</span><span class="op" id="5316042">]</span><span class="op" id="5316043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5316046">if</span>&nbsp;<span class="builtinfunc" id="5316049">len</span><span class="op" id="5316052">(</span><span class="ident" id="5316053">variable</span><span class="op" id="5316061">.</span><span class="ident" id="5316062">Ident</span><span class="op" id="5316067">)</span>&nbsp;<span class="op" id="5316069">==</span>&nbsp;<span class="num" id="5316072">1</span>&nbsp;<span class="op" id="5316074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316078">s</span><span class="op" id="5316079">.</span><span class="ident" id="5316080">notAFunction</span><span class="op" id="5316092">(</span><span class="ident" id="5316093">args</span><span class="op" id="5316097">,</span>&nbsp;<span class="ident" id="5316099">final</span><span class="op" id="5316104">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5316108">return</span>&nbsp;<span class="ident" id="5316115">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5316122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5316125">return</span>&nbsp;<span class="ident" id="5316132">s</span><span class="op" id="5316133">.</span><span class="ident" id="5316134">evalFieldChain</span><span class="op" id="5316148">(</span><span class="ident" id="5316149">dot</span><span class="op" id="5316152">,</span>&nbsp;<span class="ident" id="5316154">value</span><span class="op" id="5316159">,</span>&nbsp;<span class="ident" id="5316161">variable</span><span class="op" id="5316169">,</span>&nbsp;<span class="ident" id="5316171">variable</span><span class="op" id="5316179">.</span><span class="ident" id="5316180">Ident</span><span class="op" id="5316185">[</span><span class="num" id="5316186">1</span><span class="op" id="5316187">:</span><span class="op" id="5316188">]</span><span class="op" id="5316189">,</span>&nbsp;<span class="ident" id="5316191">args</span><span class="op" id="5316195">,</span>&nbsp;<span class="ident" id="5316197">final</span><span class="op" id="5316202">)</span><br>
<span class="lineno"></span><span class="op" id="5316204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="5316207">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5316274">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5316338">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="5316393">func</span>&nbsp;<span class="op" id="5316398">(</span><span class="ident" id="5316399">s</span>&nbsp;<span class="op" id="5316401">*</span><span class="ident" id="5316402">state</span><span class="op" id="5316407">)</span>&nbsp;<span class="ident" id="5316409">evalFieldChain</span><span class="op" id="5316423">(</span><span class="ident" id="5316424">dot</span><span class="op" id="5316427">,</span>&nbsp;<span class="ident" id="5316429">receiver</span>&nbsp;<span class="ident" id="5316438">reflect</span><span class="op" id="5316445">.</span><span class="ident" id="5316446">Value</span><span class="op" id="5316451">,</span>&nbsp;<span class="ident" id="5316453">node</span>&nbsp;<span class="ident" id="5316458">parse</span><span class="op" id="5316463">.</span><span class="ident" id="5316464">Node</span><span class="op" id="5316468">,</span>&nbsp;<span class="ident" id="5316470">ident</span>&nbsp;<span class="op" id="5316476">[</span><span class="op" id="5316477">]</span><span class="builtintype" id="5316478">string</span><span class="op" id="5316484">,</span>&nbsp;<span class="ident" id="5316486">args</span>&nbsp;<span class="op" id="5316491">[</span><span class="op" id="5316492">]</span><span class="ident" id="5316493">parse</span><span class="op" id="5316498">.</span><span class="ident" id="5316499">Node</span><span class="op" id="5316503">,</span>&nbsp;<span class="ident" id="5316505">final</span>&nbsp;<span class="ident" id="5316511">reflect</span><span class="op" id="5316518">.</span><span class="ident" id="5316519">Value</span><span class="op" id="5316524">)</span>&nbsp;<span class="ident" id="5316526">reflect</span><span class="op" id="5316533">.</span><span class="ident" id="5316534">Value</span>&nbsp;<span class="op" id="5316540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316543">n</span>&nbsp;<span class="op" id="5316545">:=</span>&nbsp;<span class="builtinfunc" id="5316548">len</span><span class="op" id="5316551">(</span><span class="ident" id="5316552">ident</span><span class="op" id="5316557">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5316560">for</span>&nbsp;<span class="ident" id="5316564">i</span>&nbsp;<span class="op" id="5316566">:=</span>&nbsp;<span class="num" id="5316569">0</span><span class="op" id="5316570">;</span>&nbsp;<span class="ident" id="5316572">i</span>&nbsp;<span class="op" id="5316574">&lt;</span>&nbsp;<span class="ident" id="5316576">n</span><span class="op" id="5316577">-</span><span class="num" id="5316578">1</span><span class="op" id="5316579">;</span>&nbsp;<span class="ident" id="5316581">i</span><span class="op" id="5316582">++</span>&nbsp;<span class="op" id="5316585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316589">receiver</span>&nbsp;<span class="op" id="5316598">=</span>&nbsp;<span class="ident" id="5316600">s</span><span class="op" id="5316601">.</span><span class="ident" id="5316602">evalField</span><span class="op" id="5316611">(</span><span class="ident" id="5316612">dot</span><span class="op" id="5316615">,</span>&nbsp;<span class="ident" id="5316617">ident</span><span class="op" id="5316622">[</span><span class="ident" id="5316623">i</span><span class="op" id="5316624">]</span><span class="op" id="5316625">,</span>&nbsp;<span class="ident" id="5316627">node</span><span class="op" id="5316631">,</span>&nbsp;<span class="ident" id="5316633">nil</span><span class="op" id="5316636">,</span>&nbsp;<span class="ident" id="5316638">zero</span><span class="op" id="5316642">,</span>&nbsp;<span class="ident" id="5316644">receiver</span><span class="op" id="5316652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5316655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5316658">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5316707">return</span>&nbsp;<span class="ident" id="5316714">s</span><span class="op" id="5316715">.</span><span class="ident" id="5316716">evalField</span><span class="op" id="5316725">(</span><span class="ident" id="5316726">dot</span><span class="op" id="5316729">,</span>&nbsp;<span class="ident" id="5316731">ident</span><span class="op" id="5316736">[</span><span class="ident" id="5316737">n</span><span class="op" id="5316738">-</span><span class="num" id="5316739">1</span><span class="op" id="5316740">]</span><span class="op" id="5316741">,</span>&nbsp;<span class="ident" id="5316743">node</span><span class="op" id="5316747">,</span>&nbsp;<span class="ident" id="5316749">args</span><span class="op" id="5316753">,</span>&nbsp;<span class="ident" id="5316755">final</span><span class="op" id="5316760">,</span>&nbsp;<span class="ident" id="5316762">receiver</span><span class="op" id="5316770">)</span><br>
<span class="lineno">450</span><span class="op" id="5316772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5316775">func</span>&nbsp;<span class="op" id="5316780">(</span><span class="ident" id="5316781">s</span>&nbsp;<span class="op" id="5316783">*</span><span class="ident" id="5316784">state</span><span class="op" id="5316789">)</span>&nbsp;<span class="ident" id="5316791">evalFunction</span><span class="op" id="5316803">(</span><span class="ident" id="5316804">dot</span>&nbsp;<span class="ident" id="5316808">reflect</span><span class="op" id="5316815">.</span><span class="ident" id="5316816">Value</span><span class="op" id="5316821">,</span>&nbsp;<span class="ident" id="5316823">node</span>&nbsp;<span class="op" id="5316828">*</span><span class="ident" id="5316829">parse</span><span class="op" id="5316834">.</span><span class="ident" id="5316835">IdentifierNode</span><span class="op" id="5316849">,</span>&nbsp;<span class="ident" id="5316851">cmd</span>&nbsp;<span class="ident" id="5316855">parse</span><span class="op" id="5316860">.</span><span class="ident" id="5316861">Node</span><span class="op" id="5316865">,</span>&nbsp;<span class="ident" id="5316867">args</span>&nbsp;<span class="op" id="5316872">[</span><span class="op" id="5316873">]</span><span class="ident" id="5316874">parse</span><span class="op" id="5316879">.</span><span class="ident" id="5316880">Node</span><span class="op" id="5316884">,</span>&nbsp;<span class="ident" id="5316886">final</span>&nbsp;<span class="ident" id="5316892">reflect</span><span class="op" id="5316899">.</span><span class="ident" id="5316900">Value</span><span class="op" id="5316905">)</span>&nbsp;<span class="ident" id="5316907">reflect</span><span class="op" id="5316914">.</span><span class="ident" id="5316915">Value</span>&nbsp;<span class="op" id="5316921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316924">s</span><span class="op" id="5316925">.</span><span class="ident" id="5316926">at</span><span class="op" id="5316928">(</span><span class="ident" id="5316929">node</span><span class="op" id="5316933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316936">name</span>&nbsp;<span class="op" id="5316941">:=</span>&nbsp;<span class="ident" id="5316944">node</span><span class="op" id="5316948">.</span><span class="ident" id="5316949">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5316956">function</span><span class="op" id="5316964">,</span>&nbsp;<span class="ident" id="5316966">ok</span>&nbsp;<span class="op" id="5316969">:=</span>&nbsp;<span class="ident" id="5316972">findFunction</span><span class="op" id="5316984">(</span><span class="ident" id="5316985">name</span><span class="op" id="5316989">,</span>&nbsp;<span class="ident" id="5316991">s</span><span class="op" id="5316992">.</span><span class="ident" id="5316993">tmpl</span><span class="op" id="5316997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317000">if</span>&nbsp;<span class="op" id="5317003">!</span><span class="ident" id="5317004">ok</span>&nbsp;<span class="op" id="5317007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317011">s</span><span class="op" id="5317012">.</span><span class="ident" id="5317013">errorf</span><span class="op" id="5317019">(</span><span class="string" id="5317020">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="5317050">,</span>&nbsp;<span class="ident" id="5317052">name</span><span class="op" id="5317056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317062">return</span>&nbsp;<span class="ident" id="5317069">s</span><span class="op" id="5317070">.</span><span class="ident" id="5317071">evalCall</span><span class="op" id="5317079">(</span><span class="ident" id="5317080">dot</span><span class="op" id="5317083">,</span>&nbsp;<span class="ident" id="5317085">function</span><span class="op" id="5317093">,</span>&nbsp;<span class="ident" id="5317095">cmd</span><span class="op" id="5317098">,</span>&nbsp;<span class="ident" id="5317100">name</span><span class="op" id="5317104">,</span>&nbsp;<span class="ident" id="5317106">args</span><span class="op" id="5317110">,</span>&nbsp;<span class="ident" id="5317112">final</span><span class="op" id="5317117">)</span><br>
<span class="lineno">460</span><span class="op" id="5317119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5317122">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="5317196">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="5317267">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="5317301">func</span>&nbsp;<span class="op" id="5317306">(</span><span class="ident" id="5317307">s</span>&nbsp;<span class="op" id="5317309">*</span><span class="ident" id="5317310">state</span><span class="op" id="5317315">)</span>&nbsp;<span class="ident" id="5317317">evalField</span><span class="op" id="5317326">(</span><span class="ident" id="5317327">dot</span>&nbsp;<span class="ident" id="5317331">reflect</span><span class="op" id="5317338">.</span><span class="ident" id="5317339">Value</span><span class="op" id="5317344">,</span>&nbsp;<span class="ident" id="5317346">fieldName</span>&nbsp;<span class="builtintype" id="5317356">string</span><span class="op" id="5317362">,</span>&nbsp;<span class="ident" id="5317364">node</span>&nbsp;<span class="ident" id="5317369">parse</span><span class="op" id="5317374">.</span><span class="ident" id="5317375">Node</span><span class="op" id="5317379">,</span>&nbsp;<span class="ident" id="5317381">args</span>&nbsp;<span class="op" id="5317386">[</span><span class="op" id="5317387">]</span><span class="ident" id="5317388">parse</span><span class="op" id="5317393">.</span><span class="ident" id="5317394">Node</span><span class="op" id="5317398">,</span>&nbsp;<span class="ident" id="5317400">final</span><span class="op" id="5317405">,</span>&nbsp;<span class="ident" id="5317407">receiver</span>&nbsp;<span class="ident" id="5317416">reflect</span><span class="op" id="5317423">.</span><span class="ident" id="5317424">Value</span><span class="op" id="5317429">)</span>&nbsp;<span class="ident" id="5317431">reflect</span><span class="op" id="5317438">.</span><span class="ident" id="5317439">Value</span>&nbsp;<span class="op" id="5317445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317448">if</span>&nbsp;<span class="op" id="5317451">!</span><span class="ident" id="5317452">receiver</span><span class="op" id="5317460">.</span><span class="ident" id="5317461">IsValid</span><span class="op" id="5317468">(</span><span class="op" id="5317469">)</span>&nbsp;<span class="op" id="5317471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317475">return</span>&nbsp;<span class="ident" id="5317482">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317491">typ</span>&nbsp;<span class="op" id="5317495">:=</span>&nbsp;<span class="ident" id="5317498">receiver</span><span class="op" id="5317506">.</span><span class="ident" id="5317507">Type</span><span class="op" id="5317511">(</span><span class="op" id="5317512">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317515">receiver</span><span class="op" id="5317523">,</span>&nbsp;<span class="ident" id="5317525">_</span>&nbsp;<span class="op" id="5317527">=</span>&nbsp;<span class="ident" id="5317529">indirect</span><span class="op" id="5317537">(</span><span class="ident" id="5317538">receiver</span><span class="op" id="5317546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5317549">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5317626">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317662">ptr</span>&nbsp;<span class="op" id="5317666">:=</span>&nbsp;<span class="ident" id="5317669">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317679">if</span>&nbsp;<span class="ident" id="5317682">ptr</span><span class="op" id="5317685">.</span><span class="ident" id="5317686">Kind</span><span class="op" id="5317690">(</span><span class="op" id="5317691">)</span>&nbsp;<span class="op" id="5317693">!=</span>&nbsp;<span class="ident" id="5317696">reflect</span><span class="op" id="5317703">.</span><span class="ident" id="5317704">Interface</span>&nbsp;<span class="op" id="5317714">&amp;&amp;</span>&nbsp;<span class="ident" id="5317717">ptr</span><span class="op" id="5317720">.</span><span class="ident" id="5317721">CanAddr</span><span class="op" id="5317728">(</span><span class="op" id="5317729">)</span>&nbsp;<span class="op" id="5317731">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317735">ptr</span>&nbsp;<span class="op" id="5317739">=</span>&nbsp;<span class="ident" id="5317741">ptr</span><span class="op" id="5317744">.</span><span class="ident" id="5317745">Addr</span><span class="op" id="5317749">(</span><span class="op" id="5317750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317756">if</span>&nbsp;<span class="ident" id="5317759">method</span>&nbsp;<span class="op" id="5317766">:=</span>&nbsp;<span class="ident" id="5317769">ptr</span><span class="op" id="5317772">.</span><span class="ident" id="5317773">MethodByName</span><span class="op" id="5317785">(</span><span class="ident" id="5317786">fieldName</span><span class="op" id="5317795">)</span><span class="op" id="5317796">;</span>&nbsp;<span class="ident" id="5317798">method</span><span class="op" id="5317804">.</span><span class="ident" id="5317805">IsValid</span><span class="op" id="5317812">(</span><span class="op" id="5317813">)</span>&nbsp;<span class="op" id="5317815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5317819">return</span>&nbsp;<span class="ident" id="5317826">s</span><span class="op" id="5317827">.</span><span class="ident" id="5317828">evalCall</span><span class="op" id="5317836">(</span><span class="ident" id="5317837">dot</span><span class="op" id="5317840">,</span>&nbsp;<span class="ident" id="5317842">method</span><span class="op" id="5317848">,</span>&nbsp;<span class="ident" id="5317850">node</span><span class="op" id="5317854">,</span>&nbsp;<span class="ident" id="5317856">fieldName</span><span class="op" id="5317865">,</span>&nbsp;<span class="ident" id="5317867">args</span><span class="op" id="5317871">,</span>&nbsp;<span class="ident" id="5317873">final</span><span class="op" id="5317878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5317881">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5317884">hasArgs</span>&nbsp;<span class="op" id="5317892">:=</span>&nbsp;<span class="builtinfunc" id="5317895">len</span><span class="op" id="5317898">(</span><span class="ident" id="5317899">args</span><span class="op" id="5317903">)</span>&nbsp;<span class="op" id="5317905">&gt;</span>&nbsp;<span class="num" id="5317907">1</span>&nbsp;<span class="op" id="5317909">||</span>&nbsp;<span class="ident" id="5317912">final</span><span class="op" id="5317917">.</span><span class="ident" id="5317918">IsValid</span><span class="op" id="5317925">(</span><span class="op" id="5317926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5317929">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318034">receiver</span><span class="op" id="5318042">,</span>&nbsp;<span class="ident" id="5318044">isNil</span>&nbsp;<span class="op" id="5318050">:=</span>&nbsp;<span class="ident" id="5318053">indirect</span><span class="op" id="5318061">(</span><span class="ident" id="5318062">receiver</span><span class="op" id="5318070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318073">if</span>&nbsp;<span class="ident" id="5318076">isNil</span>&nbsp;<span class="op" id="5318082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318086">s</span><span class="op" id="5318087">.</span><span class="ident" id="5318088">errorf</span><span class="op" id="5318094">(</span><span class="string" id="5318095">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="5318125">,</span>&nbsp;<span class="ident" id="5318127">typ</span><span class="op" id="5318130">,</span>&nbsp;<span class="ident" id="5318132">fieldName</span><span class="op" id="5318141">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318147">switch</span>&nbsp;<span class="ident" id="5318154">receiver</span><span class="op" id="5318162">.</span><span class="ident" id="5318163">Kind</span><span class="op" id="5318167">(</span><span class="op" id="5318168">)</span>&nbsp;<span class="op" id="5318170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318173">case</span>&nbsp;<span class="ident" id="5318178">reflect</span><span class="op" id="5318185">.</span><span class="ident" id="5318186">Struct</span><span class="op" id="5318192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318196">tField</span><span class="op" id="5318202">,</span>&nbsp;<span class="ident" id="5318204">ok</span>&nbsp;<span class="op" id="5318207">:=</span>&nbsp;<span class="ident" id="5318210">receiver</span><span class="op" id="5318218">.</span><span class="ident" id="5318219">Type</span><span class="op" id="5318223">(</span><span class="op" id="5318224">)</span><span class="op" id="5318225">.</span><span class="ident" id="5318226">FieldByName</span><span class="op" id="5318237">(</span><span class="ident" id="5318238">fieldName</span><span class="op" id="5318247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318251">if</span>&nbsp;<span class="ident" id="5318254">ok</span>&nbsp;<span class="op" id="5318257">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318262">field</span>&nbsp;<span class="op" id="5318268">:=</span>&nbsp;<span class="ident" id="5318271">receiver</span><span class="op" id="5318279">.</span><span class="ident" id="5318280">FieldByIndex</span><span class="op" id="5318292">(</span><span class="ident" id="5318293">tField</span><span class="op" id="5318299">.</span><span class="ident" id="5318300">Index</span><span class="op" id="5318305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318310">if</span>&nbsp;<span class="ident" id="5318313">tField</span><span class="op" id="5318319">.</span><span class="ident" id="5318320">PkgPath</span>&nbsp;<span class="op" id="5318328">!=</span>&nbsp;<span class="string" id="5318331">&#34;&#34;</span>&nbsp;<span class="op" id="5318334">{</span>&nbsp;<span class="comment" id="5318336">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318363">s</span><span class="op" id="5318364">.</span><span class="ident" id="5318365">errorf</span><span class="op" id="5318371">(</span><span class="string" id="5318372">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5318417">,</span>&nbsp;<span class="ident" id="5318419">fieldName</span><span class="op" id="5318428">,</span>&nbsp;<span class="ident" id="5318430">typ</span><span class="op" id="5318433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5318443">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318486">if</span>&nbsp;<span class="ident" id="5318489">hasArgs</span>&nbsp;<span class="op" id="5318497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318503">s</span><span class="op" id="5318504">.</span><span class="ident" id="5318505">errorf</span><span class="op" id="5318511">(</span><span class="string" id="5318512">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="5318564">,</span>&nbsp;<span class="ident" id="5318566">fieldName</span><span class="op" id="5318575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318585">return</span>&nbsp;<span class="ident" id="5318592">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318600">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318604">s</span><span class="op" id="5318605">.</span><span class="ident" id="5318606">errorf</span><span class="op" id="5318612">(</span><span class="string" id="5318613">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5318650">,</span>&nbsp;<span class="ident" id="5318652">fieldName</span><span class="op" id="5318661">,</span>&nbsp;<span class="ident" id="5318663">typ</span><span class="op" id="5318666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318669">case</span>&nbsp;<span class="ident" id="5318674">reflect</span><span class="op" id="5318681">.</span><span class="ident" id="5318682">Map</span><span class="op" id="5318685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5318689">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318749">nameVal</span>&nbsp;<span class="op" id="5318757">:=</span>&nbsp;<span class="ident" id="5318760">reflect</span><span class="op" id="5318767">.</span><span class="ident" id="5318768">ValueOf</span><span class="op" id="5318775">(</span><span class="ident" id="5318776">fieldName</span><span class="op" id="5318785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318789">if</span>&nbsp;<span class="ident" id="5318792">nameVal</span><span class="op" id="5318799">.</span><span class="ident" id="5318800">Type</span><span class="op" id="5318804">(</span><span class="op" id="5318805">)</span><span class="op" id="5318806">.</span><span class="ident" id="5318807">AssignableTo</span><span class="op" id="5318819">(</span><span class="ident" id="5318820">receiver</span><span class="op" id="5318828">.</span><span class="ident" id="5318829">Type</span><span class="op" id="5318833">(</span><span class="op" id="5318834">)</span><span class="op" id="5318835">.</span><span class="ident" id="5318836">Key</span><span class="op" id="5318839">(</span><span class="op" id="5318840">)</span><span class="op" id="5318841">)</span>&nbsp;<span class="op" id="5318843">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318848">if</span>&nbsp;<span class="ident" id="5318851">hasArgs</span>&nbsp;<span class="op" id="5318859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318865">s</span><span class="op" id="5318866">.</span><span class="ident" id="5318867">errorf</span><span class="op" id="5318873">(</span><span class="string" id="5318874">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="5318912">,</span>&nbsp;<span class="ident" id="5318914">fieldName</span><span class="op" id="5318923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5318933">return</span>&nbsp;<span class="ident" id="5318940">receiver</span><span class="op" id="5318948">.</span><span class="ident" id="5318949">MapIndex</span><span class="op" id="5318957">(</span><span class="ident" id="5318958">nameVal</span><span class="op" id="5318965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318969">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5318972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5318975">s</span><span class="op" id="5318976">.</span><span class="ident" id="5318977">errorf</span><span class="op" id="5318983">(</span><span class="string" id="5318984">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5319020">,</span>&nbsp;<span class="ident" id="5319022">fieldName</span><span class="op" id="5319031">,</span>&nbsp;<span class="ident" id="5319033">typ</span><span class="op" id="5319036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5319039">panic</span><span class="op" id="5319044">(</span><span class="string" id="5319045">&#34;not&nbsp;reached&#34;</span><span class="op" id="5319058">)</span><br>
<span class="lineno"></span><span class="op" id="5319060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="5319063">var</span>&nbsp;<span class="op" id="5319067">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319070">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319086">=</span>&nbsp;<span class="ident" id="5319088">reflect</span><span class="op" id="5319095">.</span><span class="ident" id="5319096">TypeOf</span><span class="op" id="5319102">(</span><span class="op" id="5319103">(</span><span class="op" id="5319104">*</span><span class="builtintype" id="5319105">error</span><span class="op" id="5319110">)</span><span class="op" id="5319111">(</span><span class="ident" id="5319112">nil</span><span class="op" id="5319115">)</span><span class="op" id="5319116">)</span><span class="op" id="5319117">.</span><span class="ident" id="5319118">Elem</span><span class="op" id="5319122">(</span><span class="op" id="5319123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319126">fmtStringerType</span>&nbsp;<span class="op" id="5319142">=</span>&nbsp;<span class="ident" id="5319144">reflect</span><span class="op" id="5319151">.</span><span class="ident" id="5319152">TypeOf</span><span class="op" id="5319158">(</span><span class="op" id="5319159">(</span><span class="op" id="5319160">*</span><span class="ident" id="5319161">fmt</span><span class="op" id="5319164">.</span><span class="ident" id="5319165">Stringer</span><span class="op" id="5319173">)</span><span class="op" id="5319174">(</span><span class="ident" id="5319175">nil</span><span class="op" id="5319178">)</span><span class="op" id="5319179">)</span><span class="op" id="5319180">.</span><span class="ident" id="5319181">Elem</span><span class="op" id="5319185">(</span><span class="op" id="5319186">)</span><br>
<span class="lineno"></span><span class="op" id="5319188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="5319191">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="5319296">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="5319408">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5319435">func</span>&nbsp;<span class="op" id="5319440">(</span><span class="ident" id="5319441">s</span>&nbsp;<span class="op" id="5319443">*</span><span class="ident" id="5319444">state</span><span class="op" id="5319449">)</span>&nbsp;<span class="ident" id="5319451">evalCall</span><span class="op" id="5319459">(</span><span class="ident" id="5319460">dot</span><span class="op" id="5319463">,</span>&nbsp;<span class="ident" id="5319465">fun</span>&nbsp;<span class="ident" id="5319469">reflect</span><span class="op" id="5319476">.</span><span class="ident" id="5319477">Value</span><span class="op" id="5319482">,</span>&nbsp;<span class="ident" id="5319484">node</span>&nbsp;<span class="ident" id="5319489">parse</span><span class="op" id="5319494">.</span><span class="ident" id="5319495">Node</span><span class="op" id="5319499">,</span>&nbsp;<span class="ident" id="5319501">name</span>&nbsp;<span class="builtintype" id="5319506">string</span><span class="op" id="5319512">,</span>&nbsp;<span class="ident" id="5319514">args</span>&nbsp;<span class="op" id="5319519">[</span><span class="op" id="5319520">]</span><span class="ident" id="5319521">parse</span><span class="op" id="5319526">.</span><span class="ident" id="5319527">Node</span><span class="op" id="5319531">,</span>&nbsp;<span class="ident" id="5319533">final</span>&nbsp;<span class="ident" id="5319539">reflect</span><span class="op" id="5319546">.</span><span class="ident" id="5319547">Value</span><span class="op" id="5319552">)</span>&nbsp;<span class="ident" id="5319554">reflect</span><span class="op" id="5319561">.</span><span class="ident" id="5319562">Value</span>&nbsp;<span class="op" id="5319568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319571">if</span>&nbsp;<span class="ident" id="5319574">args</span>&nbsp;<span class="op" id="5319579">!=</span>&nbsp;<span class="ident" id="5319582">nil</span>&nbsp;<span class="op" id="5319586">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319590">args</span>&nbsp;<span class="op" id="5319595">=</span>&nbsp;<span class="ident" id="5319597">args</span><span class="op" id="5319601">[</span><span class="num" id="5319602">1</span><span class="op" id="5319603">:</span><span class="op" id="5319604">]</span>&nbsp;<span class="comment" id="5319606">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319671">typ</span>&nbsp;<span class="op" id="5319675">:=</span>&nbsp;<span class="ident" id="5319678">fun</span><span class="op" id="5319681">.</span><span class="ident" id="5319682">Type</span><span class="op" id="5319686">(</span><span class="op" id="5319687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319690">numIn</span>&nbsp;<span class="op" id="5319696">:=</span>&nbsp;<span class="builtinfunc" id="5319699">len</span><span class="op" id="5319702">(</span><span class="ident" id="5319703">args</span><span class="op" id="5319707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319710">if</span>&nbsp;<span class="ident" id="5319713">final</span><span class="op" id="5319718">.</span><span class="ident" id="5319719">IsValid</span><span class="op" id="5319726">(</span><span class="op" id="5319727">)</span>&nbsp;<span class="op" id="5319729">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319733">numIn</span><span class="op" id="5319738">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319745">numFixed</span>&nbsp;<span class="op" id="5319754">:=</span>&nbsp;<span class="builtinfunc" id="5319757">len</span><span class="op" id="5319760">(</span><span class="ident" id="5319761">args</span><span class="op" id="5319765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319768">if</span>&nbsp;<span class="ident" id="5319771">typ</span><span class="op" id="5319774">.</span><span class="ident" id="5319775">IsVariadic</span><span class="op" id="5319785">(</span><span class="op" id="5319786">)</span>&nbsp;<span class="op" id="5319788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319792">numFixed</span>&nbsp;<span class="op" id="5319801">=</span>&nbsp;<span class="ident" id="5319803">typ</span><span class="op" id="5319806">.</span><span class="ident" id="5319807">NumIn</span><span class="op" id="5319812">(</span><span class="op" id="5319813">)</span>&nbsp;<span class="op" id="5319815">-</span>&nbsp;<span class="num" id="5319817">1</span>&nbsp;<span class="comment" id="5319819">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5319854">if</span>&nbsp;<span class="ident" id="5319857">numIn</span>&nbsp;<span class="op" id="5319863">&lt;</span>&nbsp;<span class="ident" id="5319865">numFixed</span>&nbsp;<span class="op" id="5319874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5319879">s</span><span class="op" id="5319880">.</span><span class="ident" id="5319881">errorf</span><span class="op" id="5319887">(</span><span class="string" id="5319888">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="5319942">,</span>&nbsp;<span class="ident" id="5319944">name</span><span class="op" id="5319948">,</span>&nbsp;<span class="ident" id="5319950">typ</span><span class="op" id="5319953">.</span><span class="ident" id="5319954">NumIn</span><span class="op" id="5319959">(</span><span class="op" id="5319960">)</span><span class="op" id="5319961">-</span><span class="num" id="5319962">1</span><span class="op" id="5319963">,</span>&nbsp;<span class="builtinfunc" id="5319965">len</span><span class="op" id="5319968">(</span><span class="ident" id="5319969">args</span><span class="op" id="5319973">)</span><span class="op" id="5319974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5319981">}</span>&nbsp;<span class="keyword" id="5319983">else</span>&nbsp;<span class="keyword" id="5319988">if</span>&nbsp;<span class="ident" id="5319991">numIn</span>&nbsp;<span class="op" id="5319997">&lt;</span>&nbsp;<span class="ident" id="5319999">typ</span><span class="op" id="5320002">.</span><span class="ident" id="5320003">NumIn</span><span class="op" id="5320008">(</span><span class="op" id="5320009">)</span><span class="op" id="5320010">-</span><span class="num" id="5320011">1</span>&nbsp;<span class="op" id="5320013">||</span>&nbsp;<span class="op" id="5320016">!</span><span class="ident" id="5320017">typ</span><span class="op" id="5320020">.</span><span class="ident" id="5320021">IsVariadic</span><span class="op" id="5320031">(</span><span class="op" id="5320032">)</span>&nbsp;<span class="op" id="5320034">&amp;&amp;</span>&nbsp;<span class="ident" id="5320037">numIn</span>&nbsp;<span class="op" id="5320043">!=</span>&nbsp;<span class="ident" id="5320046">typ</span><span class="op" id="5320049">.</span><span class="ident" id="5320050">NumIn</span><span class="op" id="5320055">(</span><span class="op" id="5320056">)</span>&nbsp;<span class="op" id="5320058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320062">s</span><span class="op" id="5320063">.</span><span class="ident" id="5320064">errorf</span><span class="op" id="5320070">(</span><span class="string" id="5320071">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="5320116">,</span>&nbsp;<span class="ident" id="5320118">name</span><span class="op" id="5320122">,</span>&nbsp;<span class="ident" id="5320124">typ</span><span class="op" id="5320127">.</span><span class="ident" id="5320128">NumIn</span><span class="op" id="5320133">(</span><span class="op" id="5320134">)</span><span class="op" id="5320135">,</span>&nbsp;<span class="builtinfunc" id="5320137">len</span><span class="op" id="5320140">(</span><span class="ident" id="5320141">args</span><span class="op" id="5320145">)</span><span class="op" id="5320146">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320152">if</span>&nbsp;<span class="op" id="5320155">!</span><span class="ident" id="5320156">goodFunc</span><span class="op" id="5320164">(</span><span class="ident" id="5320165">typ</span><span class="op" id="5320168">)</span>&nbsp;<span class="op" id="5320170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320174">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320260">s</span><span class="op" id="5320261">.</span><span class="ident" id="5320262">errorf</span><span class="op" id="5320268">(</span><span class="string" id="5320269">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="5320316">,</span>&nbsp;<span class="ident" id="5320318">name</span><span class="op" id="5320322">,</span>&nbsp;<span class="ident" id="5320324">typ</span><span class="op" id="5320327">.</span><span class="ident" id="5320328">NumOut</span><span class="op" id="5320334">(</span><span class="op" id="5320335">)</span><span class="op" id="5320336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320339">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320342">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320366">argv</span>&nbsp;<span class="op" id="5320371">:=</span>&nbsp;<span class="builtinfunc" id="5320374">make</span><span class="op" id="5320378">(</span><span class="op" id="5320379">[</span><span class="op" id="5320380">]</span><span class="ident" id="5320381">reflect</span><span class="op" id="5320388">.</span><span class="ident" id="5320389">Value</span><span class="op" id="5320394">,</span>&nbsp;<span class="ident" id="5320396">numIn</span><span class="op" id="5320401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320404">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320450">i</span>&nbsp;<span class="op" id="5320452">:=</span>&nbsp;<span class="num" id="5320455">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320458">for</span>&nbsp;<span class="op" id="5320462">;</span>&nbsp;<span class="ident" id="5320464">i</span>&nbsp;<span class="op" id="5320466">&lt;</span>&nbsp;<span class="ident" id="5320468">numFixed</span>&nbsp;<span class="op" id="5320477">&amp;&amp;</span>&nbsp;<span class="ident" id="5320480">i</span>&nbsp;<span class="op" id="5320482">&lt;</span>&nbsp;<span class="builtinfunc" id="5320484">len</span><span class="op" id="5320487">(</span><span class="ident" id="5320488">args</span><span class="op" id="5320492">)</span><span class="op" id="5320493">;</span>&nbsp;<span class="ident" id="5320495">i</span><span class="op" id="5320496">++</span>&nbsp;<span class="op" id="5320499">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320503">argv</span><span class="op" id="5320507">[</span><span class="ident" id="5320508">i</span><span class="op" id="5320509">]</span>&nbsp;<span class="op" id="5320511">=</span>&nbsp;<span class="ident" id="5320513">s</span><span class="op" id="5320514">.</span><span class="ident" id="5320515">evalArg</span><span class="op" id="5320522">(</span><span class="ident" id="5320523">dot</span><span class="op" id="5320526">,</span>&nbsp;<span class="ident" id="5320528">typ</span><span class="op" id="5320531">.</span><span class="ident" id="5320532">In</span><span class="op" id="5320534">(</span><span class="ident" id="5320535">i</span><span class="op" id="5320536">)</span><span class="op" id="5320537">,</span>&nbsp;<span class="ident" id="5320539">args</span><span class="op" id="5320543">[</span><span class="ident" id="5320544">i</span><span class="op" id="5320545">]</span><span class="op" id="5320546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320552">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320574">if</span>&nbsp;<span class="ident" id="5320577">typ</span><span class="op" id="5320580">.</span><span class="ident" id="5320581">IsVariadic</span><span class="op" id="5320591">(</span><span class="op" id="5320592">)</span>&nbsp;<span class="op" id="5320594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320598">argType</span>&nbsp;<span class="op" id="5320606">:=</span>&nbsp;<span class="ident" id="5320609">typ</span><span class="op" id="5320612">.</span><span class="ident" id="5320613">In</span><span class="op" id="5320615">(</span><span class="ident" id="5320616">typ</span><span class="op" id="5320619">.</span><span class="ident" id="5320620">NumIn</span><span class="op" id="5320625">(</span><span class="op" id="5320626">)</span>&nbsp;<span class="op" id="5320628">-</span>&nbsp;<span class="num" id="5320630">1</span><span class="op" id="5320631">)</span><span class="op" id="5320632">.</span><span class="ident" id="5320633">Elem</span><span class="op" id="5320637">(</span><span class="op" id="5320638">)</span>&nbsp;<span class="comment" id="5320640">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320666">for</span>&nbsp;<span class="op" id="5320670">;</span>&nbsp;<span class="ident" id="5320672">i</span>&nbsp;<span class="op" id="5320674">&lt;</span>&nbsp;<span class="builtinfunc" id="5320676">len</span><span class="op" id="5320679">(</span><span class="ident" id="5320680">args</span><span class="op" id="5320684">)</span><span class="op" id="5320685">;</span>&nbsp;<span class="ident" id="5320687">i</span><span class="op" id="5320688">++</span>&nbsp;<span class="op" id="5320691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320696">argv</span><span class="op" id="5320700">[</span><span class="ident" id="5320701">i</span><span class="op" id="5320702">]</span>&nbsp;<span class="op" id="5320704">=</span>&nbsp;<span class="ident" id="5320706">s</span><span class="op" id="5320707">.</span><span class="ident" id="5320708">evalArg</span><span class="op" id="5320715">(</span><span class="ident" id="5320716">dot</span><span class="op" id="5320719">,</span>&nbsp;<span class="ident" id="5320721">argType</span><span class="op" id="5320728">,</span>&nbsp;<span class="ident" id="5320730">args</span><span class="op" id="5320734">[</span><span class="ident" id="5320735">i</span><span class="op" id="5320736">]</span><span class="op" id="5320737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320747">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320781">if</span>&nbsp;<span class="ident" id="5320784">final</span><span class="op" id="5320789">.</span><span class="ident" id="5320790">IsValid</span><span class="op" id="5320797">(</span><span class="op" id="5320798">)</span>&nbsp;<span class="op" id="5320800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320804">t</span>&nbsp;<span class="op" id="5320806">:=</span>&nbsp;<span class="ident" id="5320809">typ</span><span class="op" id="5320812">.</span><span class="ident" id="5320813">In</span><span class="op" id="5320815">(</span><span class="ident" id="5320816">typ</span><span class="op" id="5320819">.</span><span class="ident" id="5320820">NumIn</span><span class="op" id="5320825">(</span><span class="op" id="5320826">)</span>&nbsp;<span class="op" id="5320828">-</span>&nbsp;<span class="num" id="5320830">1</span><span class="op" id="5320831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5320835">if</span>&nbsp;<span class="ident" id="5320838">typ</span><span class="op" id="5320841">.</span><span class="ident" id="5320842">IsVariadic</span><span class="op" id="5320852">(</span><span class="op" id="5320853">)</span>&nbsp;<span class="op" id="5320855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320860">t</span>&nbsp;<span class="op" id="5320862">=</span>&nbsp;<span class="ident" id="5320864">t</span><span class="op" id="5320865">.</span><span class="ident" id="5320866">Elem</span><span class="op" id="5320870">(</span><span class="op" id="5320871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320875">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320879">argv</span><span class="op" id="5320883">[</span><span class="ident" id="5320884">i</span><span class="op" id="5320885">]</span>&nbsp;<span class="op" id="5320887">=</span>&nbsp;<span class="ident" id="5320889">s</span><span class="op" id="5320890">.</span><span class="ident" id="5320891">validateType</span><span class="op" id="5320903">(</span><span class="ident" id="5320904">final</span><span class="op" id="5320909">,</span>&nbsp;<span class="ident" id="5320911">t</span><span class="op" id="5320912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5320915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5320918">result</span>&nbsp;<span class="op" id="5320925">:=</span>&nbsp;<span class="ident" id="5320928">fun</span><span class="op" id="5320931">.</span><span class="ident" id="5320932">Call</span><span class="op" id="5320936">(</span><span class="ident" id="5320937">argv</span><span class="op" id="5320941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5320944">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321037">if</span>&nbsp;<span class="builtinfunc" id="5321040">len</span><span class="op" id="5321043">(</span><span class="ident" id="5321044">result</span><span class="op" id="5321050">)</span>&nbsp;<span class="op" id="5321052">==</span>&nbsp;<span class="num" id="5321055">2</span>&nbsp;<span class="op" id="5321057">&amp;&amp;</span>&nbsp;<span class="op" id="5321060">!</span><span class="ident" id="5321061">result</span><span class="op" id="5321067">[</span><span class="num" id="5321068">1</span><span class="op" id="5321069">]</span><span class="op" id="5321070">.</span><span class="ident" id="5321071">IsNil</span><span class="op" id="5321076">(</span><span class="op" id="5321077">)</span>&nbsp;<span class="op" id="5321079">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321083">s</span><span class="op" id="5321084">.</span><span class="ident" id="5321085">at</span><span class="op" id="5321087">(</span><span class="ident" id="5321088">node</span><span class="op" id="5321092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321096">s</span><span class="op" id="5321097">.</span><span class="ident" id="5321098">errorf</span><span class="op" id="5321104">(</span><span class="string" id="5321105">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="5321127">,</span>&nbsp;<span class="ident" id="5321129">name</span><span class="op" id="5321133">,</span>&nbsp;<span class="ident" id="5321135">result</span><span class="op" id="5321141">[</span><span class="num" id="5321142">1</span><span class="op" id="5321143">]</span><span class="op" id="5321144">.</span><span class="ident" id="5321145">Interface</span><span class="op" id="5321154">(</span><span class="op" id="5321155">)</span><span class="op" id="5321156">.</span><span class="op" id="5321157">(</span><span class="builtintype" id="5321158">error</span><span class="op" id="5321163">)</span><span class="op" id="5321164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321170">return</span>&nbsp;<span class="ident" id="5321177">result</span><span class="op" id="5321183">[</span><span class="num" id="5321184">0</span><span class="op" id="5321185">]</span><br>
<span class="lineno"></span><span class="op" id="5321187">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="5321190">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="5321280">func</span>&nbsp;<span class="ident" id="5321285">canBeNil</span><span class="op" id="5321293">(</span><span class="ident" id="5321294">typ</span>&nbsp;<span class="ident" id="5321298">reflect</span><span class="op" id="5321305">.</span><span class="ident" id="5321306">Type</span><span class="op" id="5321310">)</span>&nbsp;<span class="builtintype" id="5321312">bool</span>&nbsp;<span class="op" id="5321317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321320">switch</span>&nbsp;<span class="ident" id="5321327">typ</span><span class="op" id="5321330">.</span><span class="ident" id="5321331">Kind</span><span class="op" id="5321335">(</span><span class="op" id="5321336">)</span>&nbsp;<span class="op" id="5321338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321341">case</span>&nbsp;<span class="ident" id="5321346">reflect</span><span class="op" id="5321353">.</span><span class="ident" id="5321354">Chan</span><span class="op" id="5321358">,</span>&nbsp;<span class="ident" id="5321360">reflect</span><span class="op" id="5321367">.</span><span class="ident" id="5321368">Func</span><span class="op" id="5321372">,</span>&nbsp;<span class="ident" id="5321374">reflect</span><span class="op" id="5321381">.</span><span class="ident" id="5321382">Interface</span><span class="op" id="5321391">,</span>&nbsp;<span class="ident" id="5321393">reflect</span><span class="op" id="5321400">.</span><span class="ident" id="5321401">Map</span><span class="op" id="5321404">,</span>&nbsp;<span class="ident" id="5321406">reflect</span><span class="op" id="5321413">.</span><span class="ident" id="5321414">Ptr</span><span class="op" id="5321417">,</span>&nbsp;<span class="ident" id="5321419">reflect</span><span class="op" id="5321426">.</span><span class="ident" id="5321427">Slice</span><span class="op" id="5321432">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321436">return</span>&nbsp;<span class="builtintype" id="5321443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321452">return</span>&nbsp;<span class="builtintype" id="5321459">false</span><br>
<span class="lineno"></span><span class="op" id="5321465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="5321468">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5321547">func</span>&nbsp;<span class="op" id="5321552">(</span><span class="ident" id="5321553">s</span>&nbsp;<span class="op" id="5321555">*</span><span class="ident" id="5321556">state</span><span class="op" id="5321561">)</span>&nbsp;<span class="ident" id="5321563">validateType</span><span class="op" id="5321575">(</span><span class="ident" id="5321576">value</span>&nbsp;<span class="ident" id="5321582">reflect</span><span class="op" id="5321589">.</span><span class="ident" id="5321590">Value</span><span class="op" id="5321595">,</span>&nbsp;<span class="ident" id="5321597">typ</span>&nbsp;<span class="ident" id="5321601">reflect</span><span class="op" id="5321608">.</span><span class="ident" id="5321609">Type</span><span class="op" id="5321613">)</span>&nbsp;<span class="ident" id="5321615">reflect</span><span class="op" id="5321622">.</span><span class="ident" id="5321623">Value</span>&nbsp;<span class="op" id="5321629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321632">if</span>&nbsp;<span class="op" id="5321635">!</span><span class="ident" id="5321636">value</span><span class="op" id="5321641">.</span><span class="ident" id="5321642">IsValid</span><span class="op" id="5321649">(</span><span class="op" id="5321650">)</span>&nbsp;<span class="op" id="5321652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321656">if</span>&nbsp;<span class="ident" id="5321659">typ</span>&nbsp;<span class="op" id="5321663">==</span>&nbsp;<span class="ident" id="5321666">nil</span>&nbsp;<span class="op" id="5321670">||</span>&nbsp;<span class="ident" id="5321673">canBeNil</span><span class="op" id="5321681">(</span><span class="ident" id="5321682">typ</span><span class="op" id="5321685">)</span>&nbsp;<span class="op" id="5321687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5321692">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321756">return</span>&nbsp;<span class="ident" id="5321763">reflect</span><span class="op" id="5321770">.</span><span class="ident" id="5321771">Zero</span><span class="op" id="5321775">(</span><span class="ident" id="5321776">typ</span><span class="op" id="5321779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321787">s</span><span class="op" id="5321788">.</span><span class="ident" id="5321789">errorf</span><span class="op" id="5321795">(</span><span class="string" id="5321796">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="5321824">,</span>&nbsp;<span class="ident" id="5321826">typ</span><span class="op" id="5321829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5321832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321835">if</span>&nbsp;<span class="ident" id="5321838">typ</span>&nbsp;<span class="op" id="5321842">!=</span>&nbsp;<span class="ident" id="5321845">nil</span>&nbsp;<span class="op" id="5321849">&amp;&amp;</span>&nbsp;<span class="op" id="5321852">!</span><span class="ident" id="5321853">value</span><span class="op" id="5321858">.</span><span class="ident" id="5321859">Type</span><span class="op" id="5321863">(</span><span class="op" id="5321864">)</span><span class="op" id="5321865">.</span><span class="ident" id="5321866">AssignableTo</span><span class="op" id="5321878">(</span><span class="ident" id="5321879">typ</span><span class="op" id="5321882">)</span>&nbsp;<span class="op" id="5321884">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321888">if</span>&nbsp;<span class="ident" id="5321891">value</span><span class="op" id="5321896">.</span><span class="ident" id="5321897">Kind</span><span class="op" id="5321901">(</span><span class="op" id="5321902">)</span>&nbsp;<span class="op" id="5321904">==</span>&nbsp;<span class="ident" id="5321907">reflect</span><span class="op" id="5321914">.</span><span class="ident" id="5321915">Interface</span>&nbsp;<span class="op" id="5321925">&amp;&amp;</span>&nbsp;<span class="op" id="5321928">!</span><span class="ident" id="5321929">value</span><span class="op" id="5321934">.</span><span class="ident" id="5321935">IsNil</span><span class="op" id="5321940">(</span><span class="op" id="5321941">)</span>&nbsp;<span class="op" id="5321943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5321948">value</span>&nbsp;<span class="op" id="5321954">=</span>&nbsp;<span class="ident" id="5321956">value</span><span class="op" id="5321961">.</span><span class="ident" id="5321962">Elem</span><span class="op" id="5321966">(</span><span class="op" id="5321967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5321972">if</span>&nbsp;<span class="ident" id="5321975">value</span><span class="op" id="5321980">.</span><span class="ident" id="5321981">Type</span><span class="op" id="5321985">(</span><span class="op" id="5321986">)</span><span class="op" id="5321987">.</span><span class="ident" id="5321988">AssignableTo</span><span class="op" id="5322000">(</span><span class="ident" id="5322001">typ</span><span class="op" id="5322004">)</span>&nbsp;<span class="op" id="5322006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322012">return</span>&nbsp;<span class="ident" id="5322019">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322028">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5322033">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5322054">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5322125">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5322197">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5322269">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322318">switch</span>&nbsp;<span class="op" id="5322325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322329">case</span>&nbsp;<span class="ident" id="5322334">value</span><span class="op" id="5322339">.</span><span class="ident" id="5322340">Kind</span><span class="op" id="5322344">(</span><span class="op" id="5322345">)</span>&nbsp;<span class="op" id="5322347">==</span>&nbsp;<span class="ident" id="5322350">reflect</span><span class="op" id="5322357">.</span><span class="ident" id="5322358">Ptr</span>&nbsp;<span class="op" id="5322362">&amp;&amp;</span>&nbsp;<span class="ident" id="5322365">value</span><span class="op" id="5322370">.</span><span class="ident" id="5322371">Type</span><span class="op" id="5322375">(</span><span class="op" id="5322376">)</span><span class="op" id="5322377">.</span><span class="ident" id="5322378">Elem</span><span class="op" id="5322382">(</span><span class="op" id="5322383">)</span><span class="op" id="5322384">.</span><span class="ident" id="5322385">AssignableTo</span><span class="op" id="5322397">(</span><span class="ident" id="5322398">typ</span><span class="op" id="5322401">)</span><span class="op" id="5322402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322407">value</span>&nbsp;<span class="op" id="5322413">=</span>&nbsp;<span class="ident" id="5322415">value</span><span class="op" id="5322420">.</span><span class="ident" id="5322421">Elem</span><span class="op" id="5322425">(</span><span class="op" id="5322426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322431">if</span>&nbsp;<span class="op" id="5322434">!</span><span class="ident" id="5322435">value</span><span class="op" id="5322440">.</span><span class="ident" id="5322441">IsValid</span><span class="op" id="5322448">(</span><span class="op" id="5322449">)</span>&nbsp;<span class="op" id="5322451">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322457">s</span><span class="op" id="5322458">.</span><span class="ident" id="5322459">errorf</span><span class="op" id="5322465">(</span><span class="string" id="5322466">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5322505">,</span>&nbsp;<span class="ident" id="5322507">typ</span><span class="op" id="5322510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322519">case</span>&nbsp;<span class="ident" id="5322524">reflect</span><span class="op" id="5322531">.</span><span class="ident" id="5322532">PtrTo</span><span class="op" id="5322537">(</span><span class="ident" id="5322538">value</span><span class="op" id="5322543">.</span><span class="ident" id="5322544">Type</span><span class="op" id="5322548">(</span><span class="op" id="5322549">)</span><span class="op" id="5322550">)</span><span class="op" id="5322551">.</span><span class="ident" id="5322552">AssignableTo</span><span class="op" id="5322564">(</span><span class="ident" id="5322565">typ</span><span class="op" id="5322568">)</span>&nbsp;<span class="op" id="5322570">&amp;&amp;</span>&nbsp;<span class="ident" id="5322573">value</span><span class="op" id="5322578">.</span><span class="ident" id="5322579">CanAddr</span><span class="op" id="5322586">(</span><span class="op" id="5322587">)</span><span class="op" id="5322588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322593">value</span>&nbsp;<span class="op" id="5322599">=</span>&nbsp;<span class="ident" id="5322601">value</span><span class="op" id="5322606">.</span><span class="ident" id="5322607">Addr</span><span class="op" id="5322611">(</span><span class="op" id="5322612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322616">default</span><span class="op" id="5322623">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322628">s</span><span class="op" id="5322629">.</span><span class="ident" id="5322630">errorf</span><span class="op" id="5322636">(</span><span class="string" id="5322637">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="5322680">,</span>&nbsp;<span class="ident" id="5322682">typ</span><span class="op" id="5322685">,</span>&nbsp;<span class="ident" id="5322687">value</span><span class="op" id="5322692">.</span><span class="ident" id="5322693">Type</span><span class="op" id="5322697">(</span><span class="op" id="5322698">)</span><span class="op" id="5322699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322709">return</span>&nbsp;<span class="ident" id="5322716">value</span><br>
<span class="lineno"></span><span class="op" id="5322722">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="5322725">func</span>&nbsp;<span class="op" id="5322730">(</span><span class="ident" id="5322731">s</span>&nbsp;<span class="op" id="5322733">*</span><span class="ident" id="5322734">state</span><span class="op" id="5322739">)</span>&nbsp;<span class="ident" id="5322741">evalArg</span><span class="op" id="5322748">(</span><span class="ident" id="5322749">dot</span>&nbsp;<span class="ident" id="5322753">reflect</span><span class="op" id="5322760">.</span><span class="ident" id="5322761">Value</span><span class="op" id="5322766">,</span>&nbsp;<span class="ident" id="5322768">typ</span>&nbsp;<span class="ident" id="5322772">reflect</span><span class="op" id="5322779">.</span><span class="ident" id="5322780">Type</span><span class="op" id="5322784">,</span>&nbsp;<span class="ident" id="5322786">n</span>&nbsp;<span class="ident" id="5322788">parse</span><span class="op" id="5322793">.</span><span class="ident" id="5322794">Node</span><span class="op" id="5322798">)</span>&nbsp;<span class="ident" id="5322800">reflect</span><span class="op" id="5322807">.</span><span class="ident" id="5322808">Value</span>&nbsp;<span class="op" id="5322814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322817">s</span><span class="op" id="5322818">.</span><span class="ident" id="5322819">at</span><span class="op" id="5322821">(</span><span class="ident" id="5322822">n</span><span class="op" id="5322823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322826">switch</span>&nbsp;<span class="ident" id="5322833">arg</span>&nbsp;<span class="op" id="5322837">:=</span>&nbsp;<span class="ident" id="5322840">n</span><span class="op" id="5322841">.</span><span class="op" id="5322842">(</span><span class="keyword" id="5322843">type</span><span class="op" id="5322847">)</span>&nbsp;<span class="op" id="5322849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322852">case</span>&nbsp;<span class="op" id="5322857">*</span><span class="ident" id="5322858">parse</span><span class="op" id="5322863">.</span><span class="ident" id="5322864">DotNode</span><span class="op" id="5322871">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322875">return</span>&nbsp;<span class="ident" id="5322882">s</span><span class="op" id="5322883">.</span><span class="ident" id="5322884">validateType</span><span class="op" id="5322896">(</span><span class="ident" id="5322897">dot</span><span class="op" id="5322900">,</span>&nbsp;<span class="ident" id="5322902">typ</span><span class="op" id="5322905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322908">case</span>&nbsp;<span class="op" id="5322913">*</span><span class="ident" id="5322914">parse</span><span class="op" id="5322919">.</span><span class="ident" id="5322920">NilNode</span><span class="op" id="5322927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322931">if</span>&nbsp;<span class="ident" id="5322934">canBeNil</span><span class="op" id="5322942">(</span><span class="ident" id="5322943">typ</span><span class="op" id="5322946">)</span>&nbsp;<span class="op" id="5322948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5322953">return</span>&nbsp;<span class="ident" id="5322960">reflect</span><span class="op" id="5322967">.</span><span class="ident" id="5322968">Zero</span><span class="op" id="5322972">(</span><span class="ident" id="5322973">typ</span><span class="op" id="5322976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5322980">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5322984">s</span><span class="op" id="5322985">.</span><span class="ident" id="5322986">errorf</span><span class="op" id="5322992">(</span><span class="string" id="5322993">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="5323018">,</span>&nbsp;<span class="ident" id="5323020">typ</span><span class="op" id="5323023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323026">case</span>&nbsp;<span class="op" id="5323031">*</span><span class="ident" id="5323032">parse</span><span class="op" id="5323037">.</span><span class="ident" id="5323038">FieldNode</span><span class="op" id="5323047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323051">return</span>&nbsp;<span class="ident" id="5323058">s</span><span class="op" id="5323059">.</span><span class="ident" id="5323060">validateType</span><span class="op" id="5323072">(</span><span class="ident" id="5323073">s</span><span class="op" id="5323074">.</span><span class="ident" id="5323075">evalFieldNode</span><span class="op" id="5323088">(</span><span class="ident" id="5323089">dot</span><span class="op" id="5323092">,</span>&nbsp;<span class="ident" id="5323094">arg</span><span class="op" id="5323097">,</span>&nbsp;<span class="op" id="5323099">[</span><span class="op" id="5323100">]</span><span class="ident" id="5323101">parse</span><span class="op" id="5323106">.</span><span class="ident" id="5323107">Node</span><span class="op" id="5323111">{</span><span class="ident" id="5323112">n</span><span class="op" id="5323113">}</span><span class="op" id="5323114">,</span>&nbsp;<span class="ident" id="5323116">zero</span><span class="op" id="5323120">)</span><span class="op" id="5323121">,</span>&nbsp;<span class="ident" id="5323123">typ</span><span class="op" id="5323126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323129">case</span>&nbsp;<span class="op" id="5323134">*</span><span class="ident" id="5323135">parse</span><span class="op" id="5323140">.</span><span class="ident" id="5323141">VariableNode</span><span class="op" id="5323153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323157">return</span>&nbsp;<span class="ident" id="5323164">s</span><span class="op" id="5323165">.</span><span class="ident" id="5323166">validateType</span><span class="op" id="5323178">(</span><span class="ident" id="5323179">s</span><span class="op" id="5323180">.</span><span class="ident" id="5323181">evalVariableNode</span><span class="op" id="5323197">(</span><span class="ident" id="5323198">dot</span><span class="op" id="5323201">,</span>&nbsp;<span class="ident" id="5323203">arg</span><span class="op" id="5323206">,</span>&nbsp;<span class="ident" id="5323208">nil</span><span class="op" id="5323211">,</span>&nbsp;<span class="ident" id="5323213">zero</span><span class="op" id="5323217">)</span><span class="op" id="5323218">,</span>&nbsp;<span class="ident" id="5323220">typ</span><span class="op" id="5323223">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323226">case</span>&nbsp;<span class="op" id="5323231">*</span><span class="ident" id="5323232">parse</span><span class="op" id="5323237">.</span><span class="ident" id="5323238">PipeNode</span><span class="op" id="5323246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323250">return</span>&nbsp;<span class="ident" id="5323257">s</span><span class="op" id="5323258">.</span><span class="ident" id="5323259">validateType</span><span class="op" id="5323271">(</span><span class="ident" id="5323272">s</span><span class="op" id="5323273">.</span><span class="ident" id="5323274">evalPipeline</span><span class="op" id="5323286">(</span><span class="ident" id="5323287">dot</span><span class="op" id="5323290">,</span>&nbsp;<span class="ident" id="5323292">arg</span><span class="op" id="5323295">)</span><span class="op" id="5323296">,</span>&nbsp;<span class="ident" id="5323298">typ</span><span class="op" id="5323301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323304">case</span>&nbsp;<span class="op" id="5323309">*</span><span class="ident" id="5323310">parse</span><span class="op" id="5323315">.</span><span class="ident" id="5323316">IdentifierNode</span><span class="op" id="5323330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323334">return</span>&nbsp;<span class="ident" id="5323341">s</span><span class="op" id="5323342">.</span><span class="ident" id="5323343">evalFunction</span><span class="op" id="5323355">(</span><span class="ident" id="5323356">dot</span><span class="op" id="5323359">,</span>&nbsp;<span class="ident" id="5323361">arg</span><span class="op" id="5323364">,</span>&nbsp;<span class="ident" id="5323366">arg</span><span class="op" id="5323369">,</span>&nbsp;<span class="ident" id="5323371">nil</span><span class="op" id="5323374">,</span>&nbsp;<span class="ident" id="5323376">zero</span><span class="op" id="5323380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323383">case</span>&nbsp;<span class="op" id="5323388">*</span><span class="ident" id="5323389">parse</span><span class="op" id="5323394">.</span><span class="ident" id="5323395">ChainNode</span><span class="op" id="5323404">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323408">return</span>&nbsp;<span class="ident" id="5323415">s</span><span class="op" id="5323416">.</span><span class="ident" id="5323417">validateType</span><span class="op" id="5323429">(</span><span class="ident" id="5323430">s</span><span class="op" id="5323431">.</span><span class="ident" id="5323432">evalChainNode</span><span class="op" id="5323445">(</span><span class="ident" id="5323446">dot</span><span class="op" id="5323449">,</span>&nbsp;<span class="ident" id="5323451">arg</span><span class="op" id="5323454">,</span>&nbsp;<span class="ident" id="5323456">nil</span><span class="op" id="5323459">,</span>&nbsp;<span class="ident" id="5323461">zero</span><span class="op" id="5323465">)</span><span class="op" id="5323466">,</span>&nbsp;<span class="ident" id="5323468">typ</span><span class="op" id="5323471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323477">switch</span>&nbsp;<span class="ident" id="5323484">typ</span><span class="op" id="5323487">.</span><span class="ident" id="5323488">Kind</span><span class="op" id="5323492">(</span><span class="op" id="5323493">)</span>&nbsp;<span class="op" id="5323495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323498">case</span>&nbsp;<span class="ident" id="5323503">reflect</span><span class="op" id="5323510">.</span><span class="ident" id="5323511">Bool</span><span class="op" id="5323515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323519">return</span>&nbsp;<span class="ident" id="5323526">s</span><span class="op" id="5323527">.</span><span class="ident" id="5323528">evalBool</span><span class="op" id="5323536">(</span><span class="ident" id="5323537">typ</span><span class="op" id="5323540">,</span>&nbsp;<span class="ident" id="5323542">n</span><span class="op" id="5323543">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323546">case</span>&nbsp;<span class="ident" id="5323551">reflect</span><span class="op" id="5323558">.</span><span class="ident" id="5323559">Complex64</span><span class="op" id="5323568">,</span>&nbsp;<span class="ident" id="5323570">reflect</span><span class="op" id="5323577">.</span><span class="ident" id="5323578">Complex128</span><span class="op" id="5323588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323592">return</span>&nbsp;<span class="ident" id="5323599">s</span><span class="op" id="5323600">.</span><span class="ident" id="5323601">evalComplex</span><span class="op" id="5323612">(</span><span class="ident" id="5323613">typ</span><span class="op" id="5323616">,</span>&nbsp;<span class="ident" id="5323618">n</span><span class="op" id="5323619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323622">case</span>&nbsp;<span class="ident" id="5323627">reflect</span><span class="op" id="5323634">.</span><span class="ident" id="5323635">Float32</span><span class="op" id="5323642">,</span>&nbsp;<span class="ident" id="5323644">reflect</span><span class="op" id="5323651">.</span><span class="ident" id="5323652">Float64</span><span class="op" id="5323659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323663">return</span>&nbsp;<span class="ident" id="5323670">s</span><span class="op" id="5323671">.</span><span class="ident" id="5323672">evalFloat</span><span class="op" id="5323681">(</span><span class="ident" id="5323682">typ</span><span class="op" id="5323685">,</span>&nbsp;<span class="ident" id="5323687">n</span><span class="op" id="5323688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323691">case</span>&nbsp;<span class="ident" id="5323696">reflect</span><span class="op" id="5323703">.</span><span class="ident" id="5323704">Int</span><span class="op" id="5323707">,</span>&nbsp;<span class="ident" id="5323709">reflect</span><span class="op" id="5323716">.</span><span class="ident" id="5323717">Int8</span><span class="op" id="5323721">,</span>&nbsp;<span class="ident" id="5323723">reflect</span><span class="op" id="5323730">.</span><span class="ident" id="5323731">Int16</span><span class="op" id="5323736">,</span>&nbsp;<span class="ident" id="5323738">reflect</span><span class="op" id="5323745">.</span><span class="ident" id="5323746">Int32</span><span class="op" id="5323751">,</span>&nbsp;<span class="ident" id="5323753">reflect</span><span class="op" id="5323760">.</span><span class="ident" id="5323761">Int64</span><span class="op" id="5323766">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323770">return</span>&nbsp;<span class="ident" id="5323777">s</span><span class="op" id="5323778">.</span><span class="ident" id="5323779">evalInteger</span><span class="op" id="5323790">(</span><span class="ident" id="5323791">typ</span><span class="op" id="5323794">,</span>&nbsp;<span class="ident" id="5323796">n</span><span class="op" id="5323797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323800">case</span>&nbsp;<span class="ident" id="5323805">reflect</span><span class="op" id="5323812">.</span><span class="ident" id="5323813">Interface</span><span class="op" id="5323822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323826">if</span>&nbsp;<span class="ident" id="5323829">typ</span><span class="op" id="5323832">.</span><span class="ident" id="5323833">NumMethod</span><span class="op" id="5323842">(</span><span class="op" id="5323843">)</span>&nbsp;<span class="op" id="5323845">==</span>&nbsp;<span class="num" id="5323848">0</span>&nbsp;<span class="op" id="5323850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323855">return</span>&nbsp;<span class="ident" id="5323862">s</span><span class="op" id="5323863">.</span><span class="ident" id="5323864">evalEmptyInterface</span><span class="op" id="5323882">(</span><span class="ident" id="5323883">dot</span><span class="op" id="5323886">,</span>&nbsp;<span class="ident" id="5323888">n</span><span class="op" id="5323889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5323893">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323896">case</span>&nbsp;<span class="ident" id="5323901">reflect</span><span class="op" id="5323908">.</span><span class="ident" id="5323909">String</span><span class="op" id="5323915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323919">return</span>&nbsp;<span class="ident" id="5323926">s</span><span class="op" id="5323927">.</span><span class="ident" id="5323928">evalString</span><span class="op" id="5323938">(</span><span class="ident" id="5323939">typ</span><span class="op" id="5323942">,</span>&nbsp;<span class="ident" id="5323944">n</span><span class="op" id="5323945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5323948">case</span>&nbsp;<span class="ident" id="5323953">reflect</span><span class="op" id="5323960">.</span><span class="ident" id="5323961">Uint</span><span class="op" id="5323965">,</span>&nbsp;<span class="ident" id="5323967">reflect</span><span class="op" id="5323974">.</span><span class="ident" id="5323975">Uint8</span><span class="op" id="5323980">,</span>&nbsp;<span class="ident" id="5323982">reflect</span><span class="op" id="5323989">.</span><span class="ident" id="5323990">Uint16</span><span class="op" id="5323996">,</span>&nbsp;<span class="ident" id="5323998">reflect</span><span class="op" id="5324005">.</span><span class="ident" id="5324006">Uint32</span><span class="op" id="5324012">,</span>&nbsp;<span class="ident" id="5324014">reflect</span><span class="op" id="5324021">.</span><span class="ident" id="5324022">Uint64</span><span class="op" id="5324028">,</span>&nbsp;<span class="ident" id="5324030">reflect</span><span class="op" id="5324037">.</span><span class="ident" id="5324038">Uintptr</span><span class="op" id="5324045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324049">return</span>&nbsp;<span class="ident" id="5324056">s</span><span class="op" id="5324057">.</span><span class="ident" id="5324058">evalUnsignedInteger</span><span class="op" id="5324077">(</span><span class="ident" id="5324078">typ</span><span class="op" id="5324081">,</span>&nbsp;<span class="ident" id="5324083">n</span><span class="op" id="5324084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324087">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324090">s</span><span class="op" id="5324091">.</span><span class="ident" id="5324092">errorf</span><span class="op" id="5324098">(</span><span class="string" id="5324099">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5324135">,</span>&nbsp;<span class="ident" id="5324137">n</span><span class="op" id="5324138">,</span>&nbsp;<span class="ident" id="5324140">typ</span><span class="op" id="5324143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5324146">panic</span><span class="op" id="5324151">(</span><span class="string" id="5324152">&#34;not&nbsp;reached&#34;</span><span class="op" id="5324165">)</span><br>
<span class="lineno"></span><span class="op" id="5324167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5324170">func</span>&nbsp;<span class="op" id="5324175">(</span><span class="ident" id="5324176">s</span>&nbsp;<span class="op" id="5324178">*</span><span class="ident" id="5324179">state</span><span class="op" id="5324184">)</span>&nbsp;<span class="ident" id="5324186">evalBool</span><span class="op" id="5324194">(</span><span class="ident" id="5324195">typ</span>&nbsp;<span class="ident" id="5324199">reflect</span><span class="op" id="5324206">.</span><span class="ident" id="5324207">Type</span><span class="op" id="5324211">,</span>&nbsp;<span class="ident" id="5324213">n</span>&nbsp;<span class="ident" id="5324215">parse</span><span class="op" id="5324220">.</span><span class="ident" id="5324221">Node</span><span class="op" id="5324225">)</span>&nbsp;<span class="ident" id="5324227">reflect</span><span class="op" id="5324234">.</span><span class="ident" id="5324235">Value</span>&nbsp;<span class="op" id="5324241">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324244">s</span><span class="op" id="5324245">.</span><span class="ident" id="5324246">at</span><span class="op" id="5324248">(</span><span class="ident" id="5324249">n</span><span class="op" id="5324250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324253">if</span>&nbsp;<span class="ident" id="5324256">n</span><span class="op" id="5324257">,</span>&nbsp;<span class="ident" id="5324259">ok</span>&nbsp;<span class="op" id="5324262">:=</span>&nbsp;<span class="ident" id="5324265">n</span><span class="op" id="5324266">.</span><span class="op" id="5324267">(</span><span class="op" id="5324268">*</span><span class="ident" id="5324269">parse</span><span class="op" id="5324274">.</span><span class="ident" id="5324275">BoolNode</span><span class="op" id="5324283">)</span><span class="op" id="5324284">;</span>&nbsp;<span class="ident" id="5324286">ok</span>&nbsp;<span class="op" id="5324289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324293">value</span>&nbsp;<span class="op" id="5324299">:=</span>&nbsp;<span class="ident" id="5324302">reflect</span><span class="op" id="5324309">.</span><span class="ident" id="5324310">New</span><span class="op" id="5324313">(</span><span class="ident" id="5324314">typ</span><span class="op" id="5324317">)</span><span class="op" id="5324318">.</span><span class="ident" id="5324319">Elem</span><span class="op" id="5324323">(</span><span class="op" id="5324324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324328">value</span><span class="op" id="5324333">.</span><span class="ident" id="5324334">SetBool</span><span class="op" id="5324341">(</span><span class="ident" id="5324342">n</span><span class="op" id="5324343">.</span><span class="ident" id="5324344">True</span><span class="op" id="5324348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324352">return</span>&nbsp;<span class="ident" id="5324359">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324369">s</span><span class="op" id="5324370">.</span><span class="ident" id="5324371">errorf</span><span class="op" id="5324377">(</span><span class="string" id="5324378">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5324403">,</span>&nbsp;<span class="ident" id="5324405">n</span><span class="op" id="5324406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5324409">panic</span><span class="op" id="5324414">(</span><span class="string" id="5324415">&#34;not&nbsp;reached&#34;</span><span class="op" id="5324428">)</span><br>
<span class="lineno"></span><span class="op" id="5324430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5324433">func</span>&nbsp;<span class="op" id="5324438">(</span><span class="ident" id="5324439">s</span>&nbsp;<span class="op" id="5324441">*</span><span class="ident" id="5324442">state</span><span class="op" id="5324447">)</span>&nbsp;<span class="ident" id="5324449">evalString</span><span class="op" id="5324459">(</span><span class="ident" id="5324460">typ</span>&nbsp;<span class="ident" id="5324464">reflect</span><span class="op" id="5324471">.</span><span class="ident" id="5324472">Type</span><span class="op" id="5324476">,</span>&nbsp;<span class="ident" id="5324478">n</span>&nbsp;<span class="ident" id="5324480">parse</span><span class="op" id="5324485">.</span><span class="ident" id="5324486">Node</span><span class="op" id="5324490">)</span>&nbsp;<span class="ident" id="5324492">reflect</span><span class="op" id="5324499">.</span><span class="ident" id="5324500">Value</span>&nbsp;<span class="op" id="5324506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324509">s</span><span class="op" id="5324510">.</span><span class="ident" id="5324511">at</span><span class="op" id="5324513">(</span><span class="ident" id="5324514">n</span><span class="op" id="5324515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324518">if</span>&nbsp;<span class="ident" id="5324521">n</span><span class="op" id="5324522">,</span>&nbsp;<span class="ident" id="5324524">ok</span>&nbsp;<span class="op" id="5324527">:=</span>&nbsp;<span class="ident" id="5324530">n</span><span class="op" id="5324531">.</span><span class="op" id="5324532">(</span><span class="op" id="5324533">*</span><span class="ident" id="5324534">parse</span><span class="op" id="5324539">.</span><span class="ident" id="5324540">StringNode</span><span class="op" id="5324550">)</span><span class="op" id="5324551">;</span>&nbsp;<span class="ident" id="5324553">ok</span>&nbsp;<span class="op" id="5324556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324560">value</span>&nbsp;<span class="op" id="5324566">:=</span>&nbsp;<span class="ident" id="5324569">reflect</span><span class="op" id="5324576">.</span><span class="ident" id="5324577">New</span><span class="op" id="5324580">(</span><span class="ident" id="5324581">typ</span><span class="op" id="5324584">)</span><span class="op" id="5324585">.</span><span class="ident" id="5324586">Elem</span><span class="op" id="5324590">(</span><span class="op" id="5324591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324595">value</span><span class="op" id="5324600">.</span><span class="ident" id="5324601">SetString</span><span class="op" id="5324610">(</span><span class="ident" id="5324611">n</span><span class="op" id="5324612">.</span><span class="ident" id="5324613">Text</span><span class="op" id="5324617">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324621">return</span>&nbsp;<span class="ident" id="5324628">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324638">s</span><span class="op" id="5324639">.</span><span class="ident" id="5324640">errorf</span><span class="op" id="5324646">(</span><span class="string" id="5324647">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5324674">,</span>&nbsp;<span class="ident" id="5324676">n</span><span class="op" id="5324677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5324680">panic</span><span class="op" id="5324685">(</span><span class="string" id="5324686">&#34;not&nbsp;reached&#34;</span><span class="op" id="5324699">)</span><br>
<span class="lineno"></span><span class="op" id="5324701">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="5324704">func</span>&nbsp;<span class="op" id="5324709">(</span><span class="ident" id="5324710">s</span>&nbsp;<span class="op" id="5324712">*</span><span class="ident" id="5324713">state</span><span class="op" id="5324718">)</span>&nbsp;<span class="ident" id="5324720">evalInteger</span><span class="op" id="5324731">(</span><span class="ident" id="5324732">typ</span>&nbsp;<span class="ident" id="5324736">reflect</span><span class="op" id="5324743">.</span><span class="ident" id="5324744">Type</span><span class="op" id="5324748">,</span>&nbsp;<span class="ident" id="5324750">n</span>&nbsp;<span class="ident" id="5324752">parse</span><span class="op" id="5324757">.</span><span class="ident" id="5324758">Node</span><span class="op" id="5324762">)</span>&nbsp;<span class="ident" id="5324764">reflect</span><span class="op" id="5324771">.</span><span class="ident" id="5324772">Value</span>&nbsp;<span class="op" id="5324778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324781">s</span><span class="op" id="5324782">.</span><span class="ident" id="5324783">at</span><span class="op" id="5324785">(</span><span class="ident" id="5324786">n</span><span class="op" id="5324787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324790">if</span>&nbsp;<span class="ident" id="5324793">n</span><span class="op" id="5324794">,</span>&nbsp;<span class="ident" id="5324796">ok</span>&nbsp;<span class="op" id="5324799">:=</span>&nbsp;<span class="ident" id="5324802">n</span><span class="op" id="5324803">.</span><span class="op" id="5324804">(</span><span class="op" id="5324805">*</span><span class="ident" id="5324806">parse</span><span class="op" id="5324811">.</span><span class="ident" id="5324812">NumberNode</span><span class="op" id="5324822">)</span><span class="op" id="5324823">;</span>&nbsp;<span class="ident" id="5324825">ok</span>&nbsp;<span class="op" id="5324828">&amp;&amp;</span>&nbsp;<span class="ident" id="5324831">n</span><span class="op" id="5324832">.</span><span class="ident" id="5324833">IsInt</span>&nbsp;<span class="op" id="5324839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324843">value</span>&nbsp;<span class="op" id="5324849">:=</span>&nbsp;<span class="ident" id="5324852">reflect</span><span class="op" id="5324859">.</span><span class="ident" id="5324860">New</span><span class="op" id="5324863">(</span><span class="ident" id="5324864">typ</span><span class="op" id="5324867">)</span><span class="op" id="5324868">.</span><span class="ident" id="5324869">Elem</span><span class="op" id="5324873">(</span><span class="op" id="5324874">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324878">value</span><span class="op" id="5324883">.</span><span class="ident" id="5324884">SetInt</span><span class="op" id="5324890">(</span><span class="ident" id="5324891">n</span><span class="op" id="5324892">.</span><span class="ident" id="5324893">Int64</span><span class="op" id="5324898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5324902">return</span>&nbsp;<span class="ident" id="5324909">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5324916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5324919">s</span><span class="op" id="5324920">.</span><span class="ident" id="5324921">errorf</span><span class="op" id="5324927">(</span><span class="string" id="5324928">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5324956">,</span>&nbsp;<span class="ident" id="5324958">n</span><span class="op" id="5324959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5324962">panic</span><span class="op" id="5324967">(</span><span class="string" id="5324968">&#34;not&nbsp;reached&#34;</span><span class="op" id="5324981">)</span><br>
<span class="lineno">695</span><span class="op" id="5324983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5324986">func</span>&nbsp;<span class="op" id="5324991">(</span><span class="ident" id="5324992">s</span>&nbsp;<span class="op" id="5324994">*</span><span class="ident" id="5324995">state</span><span class="op" id="5325000">)</span>&nbsp;<span class="ident" id="5325002">evalUnsignedInteger</span><span class="op" id="5325021">(</span><span class="ident" id="5325022">typ</span>&nbsp;<span class="ident" id="5325026">reflect</span><span class="op" id="5325033">.</span><span class="ident" id="5325034">Type</span><span class="op" id="5325038">,</span>&nbsp;<span class="ident" id="5325040">n</span>&nbsp;<span class="ident" id="5325042">parse</span><span class="op" id="5325047">.</span><span class="ident" id="5325048">Node</span><span class="op" id="5325052">)</span>&nbsp;<span class="ident" id="5325054">reflect</span><span class="op" id="5325061">.</span><span class="ident" id="5325062">Value</span>&nbsp;<span class="op" id="5325068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325071">s</span><span class="op" id="5325072">.</span><span class="ident" id="5325073">at</span><span class="op" id="5325075">(</span><span class="ident" id="5325076">n</span><span class="op" id="5325077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325080">if</span>&nbsp;<span class="ident" id="5325083">n</span><span class="op" id="5325084">,</span>&nbsp;<span class="ident" id="5325086">ok</span>&nbsp;<span class="op" id="5325089">:=</span>&nbsp;<span class="ident" id="5325092">n</span><span class="op" id="5325093">.</span><span class="op" id="5325094">(</span><span class="op" id="5325095">*</span><span class="ident" id="5325096">parse</span><span class="op" id="5325101">.</span><span class="ident" id="5325102">NumberNode</span><span class="op" id="5325112">)</span><span class="op" id="5325113">;</span>&nbsp;<span class="ident" id="5325115">ok</span>&nbsp;<span class="op" id="5325118">&amp;&amp;</span>&nbsp;<span class="ident" id="5325121">n</span><span class="op" id="5325122">.</span><span class="ident" id="5325123">IsUint</span>&nbsp;<span class="op" id="5325130">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325134">value</span>&nbsp;<span class="op" id="5325140">:=</span>&nbsp;<span class="ident" id="5325143">reflect</span><span class="op" id="5325150">.</span><span class="ident" id="5325151">New</span><span class="op" id="5325154">(</span><span class="ident" id="5325155">typ</span><span class="op" id="5325158">)</span><span class="op" id="5325159">.</span><span class="ident" id="5325160">Elem</span><span class="op" id="5325164">(</span><span class="op" id="5325165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325169">value</span><span class="op" id="5325174">.</span><span class="ident" id="5325175">SetUint</span><span class="op" id="5325182">(</span><span class="ident" id="5325183">n</span><span class="op" id="5325184">.</span><span class="ident" id="5325185">Uint64</span><span class="op" id="5325191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325195">return</span>&nbsp;<span class="ident" id="5325202">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325212">s</span><span class="op" id="5325213">.</span><span class="ident" id="5325214">errorf</span><span class="op" id="5325220">(</span><span class="string" id="5325221">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5325258">,</span>&nbsp;<span class="ident" id="5325260">n</span><span class="op" id="5325261">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5325264">panic</span><span class="op" id="5325269">(</span><span class="string" id="5325270">&#34;not&nbsp;reached&#34;</span><span class="op" id="5325283">)</span><br>
<span class="lineno"></span><span class="op" id="5325285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5325288">func</span>&nbsp;<span class="op" id="5325293">(</span><span class="ident" id="5325294">s</span>&nbsp;<span class="op" id="5325296">*</span><span class="ident" id="5325297">state</span><span class="op" id="5325302">)</span>&nbsp;<span class="ident" id="5325304">evalFloat</span><span class="op" id="5325313">(</span><span class="ident" id="5325314">typ</span>&nbsp;<span class="ident" id="5325318">reflect</span><span class="op" id="5325325">.</span><span class="ident" id="5325326">Type</span><span class="op" id="5325330">,</span>&nbsp;<span class="ident" id="5325332">n</span>&nbsp;<span class="ident" id="5325334">parse</span><span class="op" id="5325339">.</span><span class="ident" id="5325340">Node</span><span class="op" id="5325344">)</span>&nbsp;<span class="ident" id="5325346">reflect</span><span class="op" id="5325353">.</span><span class="ident" id="5325354">Value</span>&nbsp;<span class="op" id="5325360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325363">s</span><span class="op" id="5325364">.</span><span class="ident" id="5325365">at</span><span class="op" id="5325367">(</span><span class="ident" id="5325368">n</span><span class="op" id="5325369">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325372">if</span>&nbsp;<span class="ident" id="5325375">n</span><span class="op" id="5325376">,</span>&nbsp;<span class="ident" id="5325378">ok</span>&nbsp;<span class="op" id="5325381">:=</span>&nbsp;<span class="ident" id="5325384">n</span><span class="op" id="5325385">.</span><span class="op" id="5325386">(</span><span class="op" id="5325387">*</span><span class="ident" id="5325388">parse</span><span class="op" id="5325393">.</span><span class="ident" id="5325394">NumberNode</span><span class="op" id="5325404">)</span><span class="op" id="5325405">;</span>&nbsp;<span class="ident" id="5325407">ok</span>&nbsp;<span class="op" id="5325410">&amp;&amp;</span>&nbsp;<span class="ident" id="5325413">n</span><span class="op" id="5325414">.</span><span class="ident" id="5325415">IsFloat</span>&nbsp;<span class="op" id="5325423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325427">value</span>&nbsp;<span class="op" id="5325433">:=</span>&nbsp;<span class="ident" id="5325436">reflect</span><span class="op" id="5325443">.</span><span class="ident" id="5325444">New</span><span class="op" id="5325447">(</span><span class="ident" id="5325448">typ</span><span class="op" id="5325451">)</span><span class="op" id="5325452">.</span><span class="ident" id="5325453">Elem</span><span class="op" id="5325457">(</span><span class="op" id="5325458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325462">value</span><span class="op" id="5325467">.</span><span class="ident" id="5325468">SetFloat</span><span class="op" id="5325476">(</span><span class="ident" id="5325477">n</span><span class="op" id="5325478">.</span><span class="ident" id="5325479">Float64</span><span class="op" id="5325486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325490">return</span>&nbsp;<span class="ident" id="5325497">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325504">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325507">s</span><span class="op" id="5325508">.</span><span class="ident" id="5325509">errorf</span><span class="op" id="5325515">(</span><span class="string" id="5325516">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5325542">,</span>&nbsp;<span class="ident" id="5325544">n</span><span class="op" id="5325545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5325548">panic</span><span class="op" id="5325553">(</span><span class="string" id="5325554">&#34;not&nbsp;reached&#34;</span><span class="op" id="5325567">)</span><br>
<span class="lineno"></span><span class="op" id="5325569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5325572">func</span>&nbsp;<span class="op" id="5325577">(</span><span class="ident" id="5325578">s</span>&nbsp;<span class="op" id="5325580">*</span><span class="ident" id="5325581">state</span><span class="op" id="5325586">)</span>&nbsp;<span class="ident" id="5325588">evalComplex</span><span class="op" id="5325599">(</span><span class="ident" id="5325600">typ</span>&nbsp;<span class="ident" id="5325604">reflect</span><span class="op" id="5325611">.</span><span class="ident" id="5325612">Type</span><span class="op" id="5325616">,</span>&nbsp;<span class="ident" id="5325618">n</span>&nbsp;<span class="ident" id="5325620">parse</span><span class="op" id="5325625">.</span><span class="ident" id="5325626">Node</span><span class="op" id="5325630">)</span>&nbsp;<span class="ident" id="5325632">reflect</span><span class="op" id="5325639">.</span><span class="ident" id="5325640">Value</span>&nbsp;<span class="op" id="5325646">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325649">if</span>&nbsp;<span class="ident" id="5325652">n</span><span class="op" id="5325653">,</span>&nbsp;<span class="ident" id="5325655">ok</span>&nbsp;<span class="op" id="5325658">:=</span>&nbsp;<span class="ident" id="5325661">n</span><span class="op" id="5325662">.</span><span class="op" id="5325663">(</span><span class="op" id="5325664">*</span><span class="ident" id="5325665">parse</span><span class="op" id="5325670">.</span><span class="ident" id="5325671">NumberNode</span><span class="op" id="5325681">)</span><span class="op" id="5325682">;</span>&nbsp;<span class="ident" id="5325684">ok</span>&nbsp;<span class="op" id="5325687">&amp;&amp;</span>&nbsp;<span class="ident" id="5325690">n</span><span class="op" id="5325691">.</span><span class="ident" id="5325692">IsComplex</span>&nbsp;<span class="op" id="5325702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325706">value</span>&nbsp;<span class="op" id="5325712">:=</span>&nbsp;<span class="ident" id="5325715">reflect</span><span class="op" id="5325722">.</span><span class="ident" id="5325723">New</span><span class="op" id="5325726">(</span><span class="ident" id="5325727">typ</span><span class="op" id="5325730">)</span><span class="op" id="5325731">.</span><span class="ident" id="5325732">Elem</span><span class="op" id="5325736">(</span><span class="op" id="5325737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325741">value</span><span class="op" id="5325746">.</span><span class="ident" id="5325747">SetComplex</span><span class="op" id="5325757">(</span><span class="ident" id="5325758">n</span><span class="op" id="5325759">.</span><span class="ident" id="5325760">Complex128</span><span class="op" id="5325770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325774">return</span>&nbsp;<span class="ident" id="5325781">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5325788">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325791">s</span><span class="op" id="5325792">.</span><span class="ident" id="5325793">errorf</span><span class="op" id="5325799">(</span><span class="string" id="5325800">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5325828">,</span>&nbsp;<span class="ident" id="5325830">n</span><span class="op" id="5325831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5325834">panic</span><span class="op" id="5325839">(</span><span class="string" id="5325840">&#34;not&nbsp;reached&#34;</span><span class="op" id="5325853">)</span><br>
<span class="lineno"></span><span class="op" id="5325855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5325858">func</span>&nbsp;<span class="op" id="5325863">(</span><span class="ident" id="5325864">s</span>&nbsp;<span class="op" id="5325866">*</span><span class="ident" id="5325867">state</span><span class="op" id="5325872">)</span>&nbsp;<span class="ident" id="5325874">evalEmptyInterface</span><span class="op" id="5325892">(</span><span class="ident" id="5325893">dot</span>&nbsp;<span class="ident" id="5325897">reflect</span><span class="op" id="5325904">.</span><span class="ident" id="5325905">Value</span><span class="op" id="5325910">,</span>&nbsp;<span class="ident" id="5325912">n</span>&nbsp;<span class="ident" id="5325914">parse</span><span class="op" id="5325919">.</span><span class="ident" id="5325920">Node</span><span class="op" id="5325924">)</span>&nbsp;<span class="ident" id="5325926">reflect</span><span class="op" id="5325933">.</span><span class="ident" id="5325934">Value</span>&nbsp;<span class="op" id="5325940">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5325943">s</span><span class="op" id="5325944">.</span><span class="ident" id="5325945">at</span><span class="op" id="5325947">(</span><span class="ident" id="5325948">n</span><span class="op" id="5325949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325952">switch</span>&nbsp;<span class="ident" id="5325959">n</span>&nbsp;<span class="op" id="5325961">:=</span>&nbsp;<span class="ident" id="5325964">n</span><span class="op" id="5325965">.</span><span class="op" id="5325966">(</span><span class="keyword" id="5325967">type</span><span class="op" id="5325971">)</span>&nbsp;<span class="op" id="5325973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5325976">case</span>&nbsp;<span class="op" id="5325981">*</span><span class="ident" id="5325982">parse</span><span class="op" id="5325987">.</span><span class="ident" id="5325988">BoolNode</span><span class="op" id="5325996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326000">return</span>&nbsp;<span class="ident" id="5326007">reflect</span><span class="op" id="5326014">.</span><span class="ident" id="5326015">ValueOf</span><span class="op" id="5326022">(</span><span class="ident" id="5326023">n</span><span class="op" id="5326024">.</span><span class="ident" id="5326025">True</span><span class="op" id="5326029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326032">case</span>&nbsp;<span class="op" id="5326037">*</span><span class="ident" id="5326038">parse</span><span class="op" id="5326043">.</span><span class="ident" id="5326044">DotNode</span><span class="op" id="5326051">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326055">return</span>&nbsp;<span class="ident" id="5326062">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326067">case</span>&nbsp;<span class="op" id="5326072">*</span><span class="ident" id="5326073">parse</span><span class="op" id="5326078">.</span><span class="ident" id="5326079">FieldNode</span><span class="op" id="5326088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326092">return</span>&nbsp;<span class="ident" id="5326099">s</span><span class="op" id="5326100">.</span><span class="ident" id="5326101">evalFieldNode</span><span class="op" id="5326114">(</span><span class="ident" id="5326115">dot</span><span class="op" id="5326118">,</span>&nbsp;<span class="ident" id="5326120">n</span><span class="op" id="5326121">,</span>&nbsp;<span class="ident" id="5326123">nil</span><span class="op" id="5326126">,</span>&nbsp;<span class="ident" id="5326128">zero</span><span class="op" id="5326132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326135">case</span>&nbsp;<span class="op" id="5326140">*</span><span class="ident" id="5326141">parse</span><span class="op" id="5326146">.</span><span class="ident" id="5326147">IdentifierNode</span><span class="op" id="5326161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326165">return</span>&nbsp;<span class="ident" id="5326172">s</span><span class="op" id="5326173">.</span><span class="ident" id="5326174">evalFunction</span><span class="op" id="5326186">(</span><span class="ident" id="5326187">dot</span><span class="op" id="5326190">,</span>&nbsp;<span class="ident" id="5326192">n</span><span class="op" id="5326193">,</span>&nbsp;<span class="ident" id="5326195">n</span><span class="op" id="5326196">,</span>&nbsp;<span class="ident" id="5326198">nil</span><span class="op" id="5326201">,</span>&nbsp;<span class="ident" id="5326203">zero</span><span class="op" id="5326207">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326210">case</span>&nbsp;<span class="op" id="5326215">*</span><span class="ident" id="5326216">parse</span><span class="op" id="5326221">.</span><span class="ident" id="5326222">NilNode</span><span class="op" id="5326229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5326233">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326301">s</span><span class="op" id="5326302">.</span><span class="ident" id="5326303">errorf</span><span class="op" id="5326309">(</span><span class="string" id="5326310">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="5326350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326353">case</span>&nbsp;<span class="op" id="5326358">*</span><span class="ident" id="5326359">parse</span><span class="op" id="5326364">.</span><span class="ident" id="5326365">NumberNode</span><span class="op" id="5326375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326379">return</span>&nbsp;<span class="ident" id="5326386">s</span><span class="op" id="5326387">.</span><span class="ident" id="5326388">idealConstant</span><span class="op" id="5326401">(</span><span class="ident" id="5326402">n</span><span class="op" id="5326403">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326406">case</span>&nbsp;<span class="op" id="5326411">*</span><span class="ident" id="5326412">parse</span><span class="op" id="5326417">.</span><span class="ident" id="5326418">StringNode</span><span class="op" id="5326428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326432">return</span>&nbsp;<span class="ident" id="5326439">reflect</span><span class="op" id="5326446">.</span><span class="ident" id="5326447">ValueOf</span><span class="op" id="5326454">(</span><span class="ident" id="5326455">n</span><span class="op" id="5326456">.</span><span class="ident" id="5326457">Text</span><span class="op" id="5326461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326464">case</span>&nbsp;<span class="op" id="5326469">*</span><span class="ident" id="5326470">parse</span><span class="op" id="5326475">.</span><span class="ident" id="5326476">VariableNode</span><span class="op" id="5326488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326492">return</span>&nbsp;<span class="ident" id="5326499">s</span><span class="op" id="5326500">.</span><span class="ident" id="5326501">evalVariableNode</span><span class="op" id="5326517">(</span><span class="ident" id="5326518">dot</span><span class="op" id="5326521">,</span>&nbsp;<span class="ident" id="5326523">n</span><span class="op" id="5326524">,</span>&nbsp;<span class="ident" id="5326526">nil</span><span class="op" id="5326529">,</span>&nbsp;<span class="ident" id="5326531">zero</span><span class="op" id="5326535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326538">case</span>&nbsp;<span class="op" id="5326543">*</span><span class="ident" id="5326544">parse</span><span class="op" id="5326549">.</span><span class="ident" id="5326550">PipeNode</span><span class="op" id="5326558">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326562">return</span>&nbsp;<span class="ident" id="5326569">s</span><span class="op" id="5326570">.</span><span class="ident" id="5326571">evalPipeline</span><span class="op" id="5326583">(</span><span class="ident" id="5326584">dot</span><span class="op" id="5326587">,</span>&nbsp;<span class="ident" id="5326589">n</span><span class="op" id="5326590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5326593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5326596">s</span><span class="op" id="5326597">.</span><span class="ident" id="5326598">errorf</span><span class="op" id="5326604">(</span><span class="string" id="5326605">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="5326664">,</span>&nbsp;<span class="ident" id="5326666">n</span><span class="op" id="5326667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5326670">panic</span><span class="op" id="5326675">(</span><span class="string" id="5326676">&#34;not&nbsp;reached&#34;</span><span class="op" id="5326689">)</span><br>
<span class="lineno"></span><span class="op" id="5326691">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="5326694">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="5326786">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="5326854">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="5326906">func</span>&nbsp;<span class="ident" id="5326911">indirect</span><span class="op" id="5326919">(</span><span class="ident" id="5326920">v</span>&nbsp;<span class="ident" id="5326922">reflect</span><span class="op" id="5326929">.</span><span class="ident" id="5326930">Value</span><span class="op" id="5326935">)</span>&nbsp;<span class="op" id="5326937">(</span><span class="ident" id="5326938">rv</span>&nbsp;<span class="ident" id="5326941">reflect</span><span class="op" id="5326948">.</span><span class="ident" id="5326949">Value</span><span class="op" id="5326954">,</span>&nbsp;<span class="ident" id="5326956">isNil</span>&nbsp;<span class="builtintype" id="5326962">bool</span><span class="op" id="5326966">)</span>&nbsp;<span class="op" id="5326968">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5326971">for</span>&nbsp;<span class="op" id="5326975">;</span>&nbsp;<span class="ident" id="5326977">v</span><span class="op" id="5326978">.</span><span class="ident" id="5326979">Kind</span><span class="op" id="5326983">(</span><span class="op" id="5326984">)</span>&nbsp;<span class="op" id="5326986">==</span>&nbsp;<span class="ident" id="5326989">reflect</span><span class="op" id="5326996">.</span><span class="ident" id="5326997">Ptr</span>&nbsp;<span class="op" id="5327001">||</span>&nbsp;<span class="ident" id="5327004">v</span><span class="op" id="5327005">.</span><span class="ident" id="5327006">Kind</span><span class="op" id="5327010">(</span><span class="op" id="5327011">)</span>&nbsp;<span class="op" id="5327013">==</span>&nbsp;<span class="ident" id="5327016">reflect</span><span class="op" id="5327023">.</span><span class="ident" id="5327024">Interface</span><span class="op" id="5327033">;</span>&nbsp;<span class="ident" id="5327035">v</span>&nbsp;<span class="op" id="5327037">=</span>&nbsp;<span class="ident" id="5327039">v</span><span class="op" id="5327040">.</span><span class="ident" id="5327041">Elem</span><span class="op" id="5327045">(</span><span class="op" id="5327046">)</span>&nbsp;<span class="op" id="5327048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327052">if</span>&nbsp;<span class="ident" id="5327055">v</span><span class="op" id="5327056">.</span><span class="ident" id="5327057">IsNil</span><span class="op" id="5327062">(</span><span class="op" id="5327063">)</span>&nbsp;<span class="op" id="5327065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327070">return</span>&nbsp;<span class="ident" id="5327077">v</span><span class="op" id="5327078">,</span>&nbsp;<span class="builtintype" id="5327080">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327091">if</span>&nbsp;<span class="ident" id="5327094">v</span><span class="op" id="5327095">.</span><span class="ident" id="5327096">Kind</span><span class="op" id="5327100">(</span><span class="op" id="5327101">)</span>&nbsp;<span class="op" id="5327103">==</span>&nbsp;<span class="ident" id="5327106">reflect</span><span class="op" id="5327113">.</span><span class="ident" id="5327114">Interface</span>&nbsp;<span class="op" id="5327124">&amp;&amp;</span>&nbsp;<span class="ident" id="5327127">v</span><span class="op" id="5327128">.</span><span class="ident" id="5327129">NumMethod</span><span class="op" id="5327138">(</span><span class="op" id="5327139">)</span>&nbsp;<span class="op" id="5327141">&gt;</span>&nbsp;<span class="num" id="5327143">0</span>&nbsp;<span class="op" id="5327145">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327150">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327164">return</span>&nbsp;<span class="ident" id="5327171">v</span><span class="op" id="5327172">,</span>&nbsp;<span class="builtintype" id="5327174">false</span><br>
<span class="lineno"></span><span class="op" id="5327180">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="5327183">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5327261">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5327278">func</span>&nbsp;<span class="op" id="5327283">(</span><span class="ident" id="5327284">s</span>&nbsp;<span class="op" id="5327286">*</span><span class="ident" id="5327287">state</span><span class="op" id="5327292">)</span>&nbsp;<span class="ident" id="5327294">printValue</span><span class="op" id="5327304">(</span><span class="ident" id="5327305">n</span>&nbsp;<span class="ident" id="5327307">parse</span><span class="op" id="5327312">.</span><span class="ident" id="5327313">Node</span><span class="op" id="5327317">,</span>&nbsp;<span class="ident" id="5327319">v</span>&nbsp;<span class="ident" id="5327321">reflect</span><span class="op" id="5327328">.</span><span class="ident" id="5327329">Value</span><span class="op" id="5327334">)</span>&nbsp;<span class="op" id="5327336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327339">s</span><span class="op" id="5327340">.</span><span class="ident" id="5327341">at</span><span class="op" id="5327343">(</span><span class="ident" id="5327344">n</span><span class="op" id="5327345">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327348">iface</span><span class="op" id="5327353">,</span>&nbsp;<span class="ident" id="5327355">ok</span>&nbsp;<span class="op" id="5327358">:=</span>&nbsp;<span class="ident" id="5327361">printableValue</span><span class="op" id="5327375">(</span><span class="ident" id="5327376">v</span><span class="op" id="5327377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327380">if</span>&nbsp;<span class="op" id="5327383">!</span><span class="ident" id="5327384">ok</span>&nbsp;<span class="op" id="5327387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327391">s</span><span class="op" id="5327392">.</span><span class="ident" id="5327393">errorf</span><span class="op" id="5327399">(</span><span class="string" id="5327400">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5327427">,</span>&nbsp;<span class="ident" id="5327429">n</span><span class="op" id="5327430">,</span>&nbsp;<span class="ident" id="5327432">v</span><span class="op" id="5327433">.</span><span class="ident" id="5327434">Type</span><span class="op" id="5327438">(</span><span class="op" id="5327439">)</span><span class="op" id="5327440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327446">fmt</span><span class="op" id="5327449">.</span><span class="ident" id="5327450">Fprint</span><span class="op" id="5327456">(</span><span class="ident" id="5327457">s</span><span class="op" id="5327458">.</span><span class="ident" id="5327459">wr</span><span class="op" id="5327461">,</span>&nbsp;<span class="ident" id="5327463">iface</span><span class="op" id="5327468">)</span><br>
<span class="lineno">780</span><span class="op" id="5327470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5327473">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5327555">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="5327599">func</span>&nbsp;<span class="ident" id="5327604">printableValue</span><span class="op" id="5327618">(</span><span class="ident" id="5327619">v</span>&nbsp;<span class="ident" id="5327621">reflect</span><span class="op" id="5327628">.</span><span class="ident" id="5327629">Value</span><span class="op" id="5327634">)</span>&nbsp;<span class="op" id="5327636">(</span><span class="keyword" id="5327637">interface</span><span class="op" id="5327646">{</span><span class="op" id="5327647">}</span><span class="op" id="5327648">,</span>&nbsp;<span class="builtintype" id="5327650">bool</span><span class="op" id="5327654">)</span>&nbsp;<span class="op" id="5327656">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327659">if</span>&nbsp;<span class="ident" id="5327662">v</span><span class="op" id="5327663">.</span><span class="ident" id="5327664">Kind</span><span class="op" id="5327668">(</span><span class="op" id="5327669">)</span>&nbsp;<span class="op" id="5327671">==</span>&nbsp;<span class="ident" id="5327674">reflect</span><span class="op" id="5327681">.</span><span class="ident" id="5327682">Ptr</span>&nbsp;<span class="op" id="5327686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327690">v</span><span class="op" id="5327691">,</span>&nbsp;<span class="ident" id="5327693">_</span>&nbsp;<span class="op" id="5327695">=</span>&nbsp;<span class="ident" id="5327697">indirect</span><span class="op" id="5327705">(</span><span class="ident" id="5327706">v</span><span class="op" id="5327707">)</span>&nbsp;<span class="comment" id="5327709">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327740">if</span>&nbsp;<span class="op" id="5327743">!</span><span class="ident" id="5327744">v</span><span class="op" id="5327745">.</span><span class="ident" id="5327746">IsValid</span><span class="op" id="5327753">(</span><span class="op" id="5327754">)</span>&nbsp;<span class="op" id="5327756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327760">return</span>&nbsp;<span class="string" id="5327767">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="5327779">,</span>&nbsp;<span class="builtintype" id="5327781">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5327787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327791">if</span>&nbsp;<span class="op" id="5327794">!</span><span class="ident" id="5327795">v</span><span class="op" id="5327796">.</span><span class="ident" id="5327797">Type</span><span class="op" id="5327801">(</span><span class="op" id="5327802">)</span><span class="op" id="5327803">.</span><span class="ident" id="5327804">Implements</span><span class="op" id="5327814">(</span><span class="ident" id="5327815">errorType</span><span class="op" id="5327824">)</span>&nbsp;<span class="op" id="5327826">&amp;&amp;</span>&nbsp;<span class="op" id="5327829">!</span><span class="ident" id="5327830">v</span><span class="op" id="5327831">.</span><span class="ident" id="5327832">Type</span><span class="op" id="5327836">(</span><span class="op" id="5327837">)</span><span class="op" id="5327838">.</span><span class="ident" id="5327839">Implements</span><span class="op" id="5327849">(</span><span class="ident" id="5327850">fmtStringerType</span><span class="op" id="5327865">)</span>&nbsp;<span class="op" id="5327867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5327871">if</span>&nbsp;<span class="ident" id="5327874">v</span><span class="op" id="5327875">.</span><span class="ident" id="5327876">CanAddr</span><span class="op" id="5327883">(</span><span class="op" id="5327884">)</span>&nbsp;<span class="op" id="5327886">&amp;&amp;</span>&nbsp;<span class="op" id="5327889">(</span><span class="ident" id="5327890">reflect</span><span class="op" id="5327897">.</span><span class="ident" id="5327898">PtrTo</span><span class="op" id="5327903">(</span><span class="ident" id="5327904">v</span><span class="op" id="5327905">.</span><span class="ident" id="5327906">Type</span><span class="op" id="5327910">(</span><span class="op" id="5327911">)</span><span class="op" id="5327912">)</span><span class="op" id="5327913">.</span><span class="ident" id="5327914">Implements</span><span class="op" id="5327924">(</span><span class="ident" id="5327925">errorType</span><span class="op" id="5327934">)</span>&nbsp;<span class="op" id="5327936">||</span>&nbsp;<span class="ident" id="5327939">reflect</span><span class="op" id="5327946">.</span><span class="ident" id="5327947">PtrTo</span><span class="op" id="5327952">(</span><span class="ident" id="5327953">v</span><span class="op" id="5327954">.</span><span class="ident" id="5327955">Type</span><span class="op" id="5327959">(</span><span class="op" id="5327960">)</span><span class="op" id="5327961">)</span><span class="op" id="5327962">.</span><span class="ident" id="5327963">Implements</span><span class="op" id="5327973">(</span><span class="ident" id="5327974">fmtStringerType</span><span class="op" id="5327989">)</span><span class="op" id="5327990">)</span>&nbsp;<span class="op" id="5327992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5327997">v</span>&nbsp;<span class="op" id="5327999">=</span>&nbsp;<span class="ident" id="5328001">v</span><span class="op" id="5328002">.</span><span class="ident" id="5328003">Addr</span><span class="op" id="5328007">(</span><span class="op" id="5328008">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328012">}</span>&nbsp;<span class="keyword" id="5328014">else</span>&nbsp;<span class="op" id="5328019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328024">switch</span>&nbsp;<span class="ident" id="5328031">v</span><span class="op" id="5328032">.</span><span class="ident" id="5328033">Kind</span><span class="op" id="5328037">(</span><span class="op" id="5328038">)</span>&nbsp;<span class="op" id="5328040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328045">case</span>&nbsp;<span class="ident" id="5328050">reflect</span><span class="op" id="5328057">.</span><span class="ident" id="5328058">Chan</span><span class="op" id="5328062">,</span>&nbsp;<span class="ident" id="5328064">reflect</span><span class="op" id="5328071">.</span><span class="ident" id="5328072">Func</span><span class="op" id="5328076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328082">return</span>&nbsp;<span class="ident" id="5328089">nil</span><span class="op" id="5328092">,</span>&nbsp;<span class="builtintype" id="5328094">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328103">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328113">return</span>&nbsp;<span class="ident" id="5328120">v</span><span class="op" id="5328121">.</span><span class="ident" id="5328122">Interface</span><span class="op" id="5328131">(</span><span class="op" id="5328132">)</span><span class="op" id="5328133">,</span>&nbsp;<span class="builtintype" id="5328135">true</span><br>
<span class="lineno"></span><span class="op" id="5328140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="5328143">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328209">type</span>&nbsp;<span class="ident" id="5328214">rvs</span>&nbsp;<span class="op" id="5328218">[</span><span class="op" id="5328219">]</span><span class="ident" id="5328220">reflect</span><span class="op" id="5328227">.</span><span class="ident" id="5328228">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328235">func</span>&nbsp;<span class="op" id="5328240">(</span><span class="ident" id="5328241">x</span>&nbsp;<span class="ident" id="5328243">rvs</span><span class="op" id="5328246">)</span>&nbsp;<span class="ident" id="5328248">Len</span><span class="op" id="5328251">(</span><span class="op" id="5328252">)</span>&nbsp;<span class="builtintype" id="5328254">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328263">{</span>&nbsp;<span class="keyword" id="5328265">return</span>&nbsp;<span class="builtinfunc" id="5328272">len</span><span class="op" id="5328275">(</span><span class="ident" id="5328276">x</span><span class="op" id="5328277">)</span>&nbsp;<span class="op" id="5328279">}</span><br>
<span class="lineno">810</span><span class="keyword" id="5328281">func</span>&nbsp;<span class="op" id="5328286">(</span><span class="ident" id="5328287">x</span>&nbsp;<span class="ident" id="5328289">rvs</span><span class="op" id="5328292">)</span>&nbsp;<span class="ident" id="5328294">Swap</span><span class="op" id="5328298">(</span><span class="ident" id="5328299">i</span><span class="op" id="5328300">,</span>&nbsp;<span class="ident" id="5328302">j</span>&nbsp;<span class="builtintype" id="5328304">int</span><span class="op" id="5328307">)</span>&nbsp;<span class="op" id="5328309">{</span>&nbsp;<span class="ident" id="5328311">x</span><span class="op" id="5328312">[</span><span class="ident" id="5328313">i</span><span class="op" id="5328314">]</span><span class="op" id="5328315">,</span>&nbsp;<span class="ident" id="5328317">x</span><span class="op" id="5328318">[</span><span class="ident" id="5328319">j</span><span class="op" id="5328320">]</span>&nbsp;<span class="op" id="5328322">=</span>&nbsp;<span class="ident" id="5328324">x</span><span class="op" id="5328325">[</span><span class="ident" id="5328326">j</span><span class="op" id="5328327">]</span><span class="op" id="5328328">,</span>&nbsp;<span class="ident" id="5328330">x</span><span class="op" id="5328331">[</span><span class="ident" id="5328332">i</span><span class="op" id="5328333">]</span>&nbsp;<span class="op" id="5328335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328338">type</span>&nbsp;<span class="ident" id="5328343">rvInts</span>&nbsp;<span class="keyword" id="5328350">struct</span><span class="op" id="5328356">{</span>&nbsp;<span class="ident" id="5328358">rvs</span>&nbsp;<span class="op" id="5328362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328365">func</span>&nbsp;<span class="op" id="5328370">(</span><span class="ident" id="5328371">x</span>&nbsp;<span class="ident" id="5328373">rvInts</span><span class="op" id="5328379">)</span>&nbsp;<span class="ident" id="5328381">Less</span><span class="op" id="5328385">(</span><span class="ident" id="5328386">i</span><span class="op" id="5328387">,</span>&nbsp;<span class="ident" id="5328389">j</span>&nbsp;<span class="builtintype" id="5328391">int</span><span class="op" id="5328394">)</span>&nbsp;<span class="builtintype" id="5328396">bool</span>&nbsp;<span class="op" id="5328401">{</span>&nbsp;<span class="keyword" id="5328403">return</span>&nbsp;<span class="ident" id="5328410">x</span><span class="op" id="5328411">.</span><span class="ident" id="5328412">rvs</span><span class="op" id="5328415">[</span><span class="ident" id="5328416">i</span><span class="op" id="5328417">]</span><span class="op" id="5328418">.</span><span class="ident" id="5328419">Int</span><span class="op" id="5328422">(</span><span class="op" id="5328423">)</span>&nbsp;<span class="op" id="5328425">&lt;</span>&nbsp;<span class="ident" id="5328427">x</span><span class="op" id="5328428">.</span><span class="ident" id="5328429">rvs</span><span class="op" id="5328432">[</span><span class="ident" id="5328433">j</span><span class="op" id="5328434">]</span><span class="op" id="5328435">.</span><span class="ident" id="5328436">Int</span><span class="op" id="5328439">(</span><span class="op" id="5328440">)</span>&nbsp;<span class="op" id="5328442">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="5328445">type</span>&nbsp;<span class="ident" id="5328450">rvUints</span>&nbsp;<span class="keyword" id="5328458">struct</span><span class="op" id="5328464">{</span>&nbsp;<span class="ident" id="5328466">rvs</span>&nbsp;<span class="op" id="5328470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328473">func</span>&nbsp;<span class="op" id="5328478">(</span><span class="ident" id="5328479">x</span>&nbsp;<span class="ident" id="5328481">rvUints</span><span class="op" id="5328488">)</span>&nbsp;<span class="ident" id="5328490">Less</span><span class="op" id="5328494">(</span><span class="ident" id="5328495">i</span><span class="op" id="5328496">,</span>&nbsp;<span class="ident" id="5328498">j</span>&nbsp;<span class="builtintype" id="5328500">int</span><span class="op" id="5328503">)</span>&nbsp;<span class="builtintype" id="5328505">bool</span>&nbsp;<span class="op" id="5328510">{</span>&nbsp;<span class="keyword" id="5328512">return</span>&nbsp;<span class="ident" id="5328519">x</span><span class="op" id="5328520">.</span><span class="ident" id="5328521">rvs</span><span class="op" id="5328524">[</span><span class="ident" id="5328525">i</span><span class="op" id="5328526">]</span><span class="op" id="5328527">.</span><span class="ident" id="5328528">Uint</span><span class="op" id="5328532">(</span><span class="op" id="5328533">)</span>&nbsp;<span class="op" id="5328535">&lt;</span>&nbsp;<span class="ident" id="5328537">x</span><span class="op" id="5328538">.</span><span class="ident" id="5328539">rvs</span><span class="op" id="5328542">[</span><span class="ident" id="5328543">j</span><span class="op" id="5328544">]</span><span class="op" id="5328545">.</span><span class="ident" id="5328546">Uint</span><span class="op" id="5328550">(</span><span class="op" id="5328551">)</span>&nbsp;<span class="op" id="5328553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="5328556">type</span>&nbsp;<span class="ident" id="5328561">rvFloats</span>&nbsp;<span class="keyword" id="5328570">struct</span><span class="op" id="5328576">{</span>&nbsp;<span class="ident" id="5328578">rvs</span>&nbsp;<span class="op" id="5328582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328585">func</span>&nbsp;<span class="op" id="5328590">(</span><span class="ident" id="5328591">x</span>&nbsp;<span class="ident" id="5328593">rvFloats</span><span class="op" id="5328601">)</span>&nbsp;<span class="ident" id="5328603">Less</span><span class="op" id="5328607">(</span><span class="ident" id="5328608">i</span><span class="op" id="5328609">,</span>&nbsp;<span class="ident" id="5328611">j</span>&nbsp;<span class="builtintype" id="5328613">int</span><span class="op" id="5328616">)</span>&nbsp;<span class="builtintype" id="5328618">bool</span>&nbsp;<span class="op" id="5328623">{</span>&nbsp;<span class="keyword" id="5328625">return</span>&nbsp;<span class="ident" id="5328632">x</span><span class="op" id="5328633">.</span><span class="ident" id="5328634">rvs</span><span class="op" id="5328637">[</span><span class="ident" id="5328638">i</span><span class="op" id="5328639">]</span><span class="op" id="5328640">.</span><span class="ident" id="5328641">Float</span><span class="op" id="5328646">(</span><span class="op" id="5328647">)</span>&nbsp;<span class="op" id="5328649">&lt;</span>&nbsp;<span class="ident" id="5328651">x</span><span class="op" id="5328652">.</span><span class="ident" id="5328653">rvs</span><span class="op" id="5328656">[</span><span class="ident" id="5328657">j</span><span class="op" id="5328658">]</span><span class="op" id="5328659">.</span><span class="ident" id="5328660">Float</span><span class="op" id="5328665">(</span><span class="op" id="5328666">)</span>&nbsp;<span class="op" id="5328668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328671">type</span>&nbsp;<span class="ident" id="5328676">rvStrings</span>&nbsp;<span class="keyword" id="5328686">struct</span><span class="op" id="5328692">{</span>&nbsp;<span class="ident" id="5328694">rvs</span>&nbsp;<span class="op" id="5328698">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="5328701">func</span>&nbsp;<span class="op" id="5328706">(</span><span class="ident" id="5328707">x</span>&nbsp;<span class="ident" id="5328709">rvStrings</span><span class="op" id="5328718">)</span>&nbsp;<span class="ident" id="5328720">Less</span><span class="op" id="5328724">(</span><span class="ident" id="5328725">i</span><span class="op" id="5328726">,</span>&nbsp;<span class="ident" id="5328728">j</span>&nbsp;<span class="builtintype" id="5328730">int</span><span class="op" id="5328733">)</span>&nbsp;<span class="builtintype" id="5328735">bool</span>&nbsp;<span class="op" id="5328740">{</span>&nbsp;<span class="keyword" id="5328742">return</span>&nbsp;<span class="ident" id="5328749">x</span><span class="op" id="5328750">.</span><span class="ident" id="5328751">rvs</span><span class="op" id="5328754">[</span><span class="ident" id="5328755">i</span><span class="op" id="5328756">]</span><span class="op" id="5328757">.</span><span class="ident" id="5328758">String</span><span class="op" id="5328764">(</span><span class="op" id="5328765">)</span>&nbsp;<span class="op" id="5328767">&lt;</span>&nbsp;<span class="ident" id="5328769">x</span><span class="op" id="5328770">.</span><span class="ident" id="5328771">rvs</span><span class="op" id="5328774">[</span><span class="ident" id="5328775">j</span><span class="op" id="5328776">]</span><span class="op" id="5328777">.</span><span class="ident" id="5328778">String</span><span class="op" id="5328784">(</span><span class="op" id="5328785">)</span>&nbsp;<span class="op" id="5328787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5328790">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="5328879">func</span>&nbsp;<span class="ident" id="5328884">sortKeys</span><span class="op" id="5328892">(</span><span class="ident" id="5328893">v</span>&nbsp;<span class="op" id="5328895">[</span><span class="op" id="5328896">]</span><span class="ident" id="5328897">reflect</span><span class="op" id="5328904">.</span><span class="ident" id="5328905">Value</span><span class="op" id="5328910">)</span>&nbsp;<span class="op" id="5328912">[</span><span class="op" id="5328913">]</span><span class="ident" id="5328914">reflect</span><span class="op" id="5328921">.</span><span class="ident" id="5328922">Value</span>&nbsp;<span class="op" id="5328928">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328931">if</span>&nbsp;<span class="builtinfunc" id="5328934">len</span><span class="op" id="5328937">(</span><span class="ident" id="5328938">v</span><span class="op" id="5328939">)</span>&nbsp;<span class="op" id="5328941">&lt;=</span>&nbsp;<span class="num" id="5328944">1</span>&nbsp;<span class="op" id="5328946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328950">return</span>&nbsp;<span class="ident" id="5328957">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328963">switch</span>&nbsp;<span class="ident" id="5328970">v</span><span class="op" id="5328971">[</span><span class="num" id="5328972">0</span><span class="op" id="5328973">]</span><span class="op" id="5328974">.</span><span class="ident" id="5328975">Kind</span><span class="op" id="5328979">(</span><span class="op" id="5328980">)</span>&nbsp;<span class="op" id="5328982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328985">case</span>&nbsp;<span class="ident" id="5328990">reflect</span><span class="op" id="5328997">.</span><span class="ident" id="5328998">Float32</span><span class="op" id="5329005">,</span>&nbsp;<span class="ident" id="5329007">reflect</span><span class="op" id="5329014">.</span><span class="ident" id="5329015">Float64</span><span class="op" id="5329022">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329026">sort</span><span class="op" id="5329030">.</span><span class="ident" id="5329031">Sort</span><span class="op" id="5329035">(</span><span class="ident" id="5329036">rvFloats</span><span class="op" id="5329044">{</span><span class="ident" id="5329045">v</span><span class="op" id="5329046">}</span><span class="op" id="5329047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329050">case</span>&nbsp;<span class="ident" id="5329055">reflect</span><span class="op" id="5329062">.</span><span class="ident" id="5329063">Int</span><span class="op" id="5329066">,</span>&nbsp;<span class="ident" id="5329068">reflect</span><span class="op" id="5329075">.</span><span class="ident" id="5329076">Int8</span><span class="op" id="5329080">,</span>&nbsp;<span class="ident" id="5329082">reflect</span><span class="op" id="5329089">.</span><span class="ident" id="5329090">Int16</span><span class="op" id="5329095">,</span>&nbsp;<span class="ident" id="5329097">reflect</span><span class="op" id="5329104">.</span><span class="ident" id="5329105">Int32</span><span class="op" id="5329110">,</span>&nbsp;<span class="ident" id="5329112">reflect</span><span class="op" id="5329119">.</span><span class="ident" id="5329120">Int64</span><span class="op" id="5329125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329129">sort</span><span class="op" id="5329133">.</span><span class="ident" id="5329134">Sort</span><span class="op" id="5329138">(</span><span class="ident" id="5329139">rvInts</span><span class="op" id="5329145">{</span><span class="ident" id="5329146">v</span><span class="op" id="5329147">}</span><span class="op" id="5329148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329151">case</span>&nbsp;<span class="ident" id="5329156">reflect</span><span class="op" id="5329163">.</span><span class="ident" id="5329164">String</span><span class="op" id="5329170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329174">sort</span><span class="op" id="5329178">.</span><span class="ident" id="5329179">Sort</span><span class="op" id="5329183">(</span><span class="ident" id="5329184">rvStrings</span><span class="op" id="5329193">{</span><span class="ident" id="5329194">v</span><span class="op" id="5329195">}</span><span class="op" id="5329196">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329199">case</span>&nbsp;<span class="ident" id="5329204">reflect</span><span class="op" id="5329211">.</span><span class="ident" id="5329212">Uint</span><span class="op" id="5329216">,</span>&nbsp;<span class="ident" id="5329218">reflect</span><span class="op" id="5329225">.</span><span class="ident" id="5329226">Uint8</span><span class="op" id="5329231">,</span>&nbsp;<span class="ident" id="5329233">reflect</span><span class="op" id="5329240">.</span><span class="ident" id="5329241">Uint16</span><span class="op" id="5329247">,</span>&nbsp;<span class="ident" id="5329249">reflect</span><span class="op" id="5329256">.</span><span class="ident" id="5329257">Uint32</span><span class="op" id="5329263">,</span>&nbsp;<span class="ident" id="5329265">reflect</span><span class="op" id="5329272">.</span><span class="ident" id="5329273">Uint64</span><span class="op" id="5329279">,</span>&nbsp;<span class="ident" id="5329281">reflect</span><span class="op" id="5329288">.</span><span class="ident" id="5329289">Uintptr</span><span class="op" id="5329296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329300">sort</span><span class="op" id="5329304">.</span><span class="ident" id="5329305">Sort</span><span class="op" id="5329309">(</span><span class="ident" id="5329310">rvUints</span><span class="op" id="5329317">{</span><span class="ident" id="5329318">v</span><span class="op" id="5329319">}</span><span class="op" id="5329320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5329323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329326">return</span>&nbsp;<span class="ident" id="5329333">v</span><br>
<span class="lineno"></span><span class="op" id="5329335">}</span>
</div>
</body>
</html>
