<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7487784">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7487839">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7487893">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7487944">package</span>&nbsp;<span class="ident" id="7487952">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487959">import</span>&nbsp;<span class="op" id="7487966">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7487969">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7487978">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7487996">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488015">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488030">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488045">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488062">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488079">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488095">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488103">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488109">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488121">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488127">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7488138">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7488148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7488151">func</span>&nbsp;<span class="ident" id="7488156">testKeyGeneration</span><span class="op" id="7488173">(</span><span class="ident" id="7488174">t</span>&nbsp;<span class="op" id="7488176">*</span><span class="ident" id="7488177">testing</span><span class="op" id="7488184">.</span><span class="ident" id="7488185">T</span><span class="op" id="7488186">,</span>&nbsp;<span class="ident" id="7488188">c</span>&nbsp;<span class="ident" id="7488190">elliptic</span><span class="op" id="7488198">.</span><span class="ident" id="7488199">Curve</span><span class="op" id="7488204">,</span>&nbsp;<span class="ident" id="7488206">tag</span>&nbsp;<span class="builtintype" id="7488210">string</span><span class="op" id="7488216">)</span>&nbsp;<span class="op" id="7488218">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488221">priv</span><span class="op" id="7488225">,</span>&nbsp;<span class="ident" id="7488227">err</span>&nbsp;<span class="op" id="7488231">:=</span>&nbsp;<span class="ident" id="7488234">GenerateKey</span><span class="op" id="7488245">(</span><span class="ident" id="7488246">c</span><span class="op" id="7488247">,</span>&nbsp;<span class="ident" id="7488249">rand</span><span class="op" id="7488253">.</span><span class="ident" id="7488254">Reader</span><span class="op" id="7488260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488263">if</span>&nbsp;<span class="ident" id="7488266">err</span>&nbsp;<span class="op" id="7488270">!=</span>&nbsp;<span class="builtintype" id="7488273">nil</span>&nbsp;<span class="op" id="7488277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488281">t</span><span class="op" id="7488282">.</span><span class="ident" id="7488283">Errorf</span><span class="op" id="7488289">(</span><span class="string" id="7488290">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7488305">,</span>&nbsp;<span class="ident" id="7488307">tag</span><span class="op" id="7488310">,</span>&nbsp;<span class="ident" id="7488312">err</span><span class="op" id="7488315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488319">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488327">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488330">if</span>&nbsp;<span class="op" id="7488333">!</span><span class="ident" id="7488334">c</span><span class="op" id="7488335">.</span><span class="ident" id="7488336">IsOnCurve</span><span class="op" id="7488345">(</span><span class="ident" id="7488346">priv</span><span class="op" id="7488350">.</span><span class="ident" id="7488351">PublicKey</span><span class="op" id="7488360">.</span><span class="ident" id="7488361">X</span><span class="op" id="7488362">,</span>&nbsp;<span class="ident" id="7488364">priv</span><span class="op" id="7488368">.</span><span class="ident" id="7488369">PublicKey</span><span class="op" id="7488378">.</span><span class="ident" id="7488379">Y</span><span class="op" id="7488380">)</span>&nbsp;<span class="op" id="7488382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488386">t</span><span class="op" id="7488387">.</span><span class="ident" id="7488388">Errorf</span><span class="op" id="7488394">(</span><span class="string" id="7488395">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7488423">,</span>&nbsp;<span class="ident" id="7488425">tag</span><span class="op" id="7488428">,</span>&nbsp;<span class="ident" id="7488430">err</span><span class="op" id="7488433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488436">}</span><br>
<span class="lineno"></span><span class="op" id="7488438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7488441">func</span>&nbsp;<span class="ident" id="7488446">TestKeyGeneration</span><span class="op" id="7488463">(</span><span class="ident" id="7488464">t</span>&nbsp;<span class="op" id="7488466">*</span><span class="ident" id="7488467">testing</span><span class="op" id="7488474">.</span><span class="ident" id="7488475">T</span><span class="op" id="7488476">)</span>&nbsp;<span class="op" id="7488478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488481">testKeyGeneration</span><span class="op" id="7488498">(</span><span class="ident" id="7488499">t</span><span class="op" id="7488500">,</span>&nbsp;<span class="ident" id="7488502">elliptic</span><span class="op" id="7488510">.</span><span class="ident" id="7488511">P224</span><span class="op" id="7488515">(</span><span class="op" id="7488516">)</span><span class="op" id="7488517">,</span>&nbsp;<span class="string" id="7488519">&#34;p224&#34;</span><span class="op" id="7488525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488528">if</span>&nbsp;<span class="ident" id="7488531">testing</span><span class="op" id="7488538">.</span><span class="ident" id="7488539">Short</span><span class="op" id="7488544">(</span><span class="op" id="7488545">)</span>&nbsp;<span class="op" id="7488547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488559">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488562">testKeyGeneration</span><span class="op" id="7488579">(</span><span class="ident" id="7488580">t</span><span class="op" id="7488581">,</span>&nbsp;<span class="ident" id="7488583">elliptic</span><span class="op" id="7488591">.</span><span class="ident" id="7488592">P256</span><span class="op" id="7488596">(</span><span class="op" id="7488597">)</span><span class="op" id="7488598">,</span>&nbsp;<span class="string" id="7488600">&#34;p256&#34;</span><span class="op" id="7488606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488609">testKeyGeneration</span><span class="op" id="7488626">(</span><span class="ident" id="7488627">t</span><span class="op" id="7488628">,</span>&nbsp;<span class="ident" id="7488630">elliptic</span><span class="op" id="7488638">.</span><span class="ident" id="7488639">P384</span><span class="op" id="7488643">(</span><span class="op" id="7488644">)</span><span class="op" id="7488645">,</span>&nbsp;<span class="string" id="7488647">&#34;p384&#34;</span><span class="op" id="7488653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488656">testKeyGeneration</span><span class="op" id="7488673">(</span><span class="ident" id="7488674">t</span><span class="op" id="7488675">,</span>&nbsp;<span class="ident" id="7488677">elliptic</span><span class="op" id="7488685">.</span><span class="ident" id="7488686">P521</span><span class="op" id="7488690">(</span><span class="op" id="7488691">)</span><span class="op" id="7488692">,</span>&nbsp;<span class="string" id="7488694">&#34;p521&#34;</span><span class="op" id="7488700">)</span><br>
<span class="lineno"></span><span class="op" id="7488702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7488705">func</span>&nbsp;<span class="ident" id="7488710">testSignAndVerify</span><span class="op" id="7488727">(</span><span class="ident" id="7488728">t</span>&nbsp;<span class="op" id="7488730">*</span><span class="ident" id="7488731">testing</span><span class="op" id="7488738">.</span><span class="ident" id="7488739">T</span><span class="op" id="7488740">,</span>&nbsp;<span class="ident" id="7488742">c</span>&nbsp;<span class="ident" id="7488744">elliptic</span><span class="op" id="7488752">.</span><span class="ident" id="7488753">Curve</span><span class="op" id="7488758">,</span>&nbsp;<span class="ident" id="7488760">tag</span>&nbsp;<span class="builtintype" id="7488764">string</span><span class="op" id="7488770">)</span>&nbsp;<span class="op" id="7488772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488775">priv</span><span class="op" id="7488779">,</span>&nbsp;<span class="ident" id="7488781">_</span>&nbsp;<span class="op" id="7488783">:=</span>&nbsp;<span class="ident" id="7488786">GenerateKey</span><span class="op" id="7488797">(</span><span class="ident" id="7488798">c</span><span class="op" id="7488799">,</span>&nbsp;<span class="ident" id="7488801">rand</span><span class="op" id="7488805">.</span><span class="ident" id="7488806">Reader</span><span class="op" id="7488812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488816">hashed</span>&nbsp;<span class="op" id="7488823">:=</span>&nbsp;<span class="op" id="7488826">[</span><span class="op" id="7488827">]</span><span class="builtintype" id="7488828">byte</span><span class="op" id="7488832">(</span><span class="string" id="7488833">&#34;testing&#34;</span><span class="op" id="7488842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488845">r</span><span class="op" id="7488846">,</span>&nbsp;<span class="ident" id="7488848">s</span><span class="op" id="7488849">,</span>&nbsp;<span class="ident" id="7488851">err</span>&nbsp;<span class="op" id="7488855">:=</span>&nbsp;<span class="ident" id="7488858">Sign</span><span class="op" id="7488862">(</span><span class="ident" id="7488863">rand</span><span class="op" id="7488867">.</span><span class="ident" id="7488868">Reader</span><span class="op" id="7488874">,</span>&nbsp;<span class="ident" id="7488876">priv</span><span class="op" id="7488880">,</span>&nbsp;<span class="ident" id="7488882">hashed</span><span class="op" id="7488888">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488891">if</span>&nbsp;<span class="ident" id="7488894">err</span>&nbsp;<span class="op" id="7488898">!=</span>&nbsp;<span class="builtintype" id="7488901">nil</span>&nbsp;<span class="op" id="7488905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488909">t</span><span class="op" id="7488910">.</span><span class="ident" id="7488911">Errorf</span><span class="op" id="7488917">(</span><span class="string" id="7488918">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7488941">,</span>&nbsp;<span class="ident" id="7488943">tag</span><span class="op" id="7488946">,</span>&nbsp;<span class="ident" id="7488948">err</span><span class="op" id="7488951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488955">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488967">if</span>&nbsp;<span class="op" id="7488970">!</span><span class="ident" id="7488971">Verify</span><span class="op" id="7488977">(</span><span class="op" id="7488978">&amp;</span><span class="ident" id="7488979">priv</span><span class="op" id="7488983">.</span><span class="ident" id="7488984">PublicKey</span><span class="op" id="7488993">,</span>&nbsp;<span class="ident" id="7488995">hashed</span><span class="op" id="7489001">,</span>&nbsp;<span class="ident" id="7489003">r</span><span class="op" id="7489004">,</span>&nbsp;<span class="ident" id="7489006">s</span><span class="op" id="7489007">)</span>&nbsp;<span class="op" id="7489009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489013">t</span><span class="op" id="7489014">.</span><span class="ident" id="7489015">Errorf</span><span class="op" id="7489021">(</span><span class="string" id="7489022">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7489041">,</span>&nbsp;<span class="ident" id="7489043">tag</span><span class="op" id="7489046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489053">hashed</span><span class="op" id="7489059">[</span><span class="num" id="7489060">0</span><span class="op" id="7489061">]</span>&nbsp;<span class="op" id="7489063">^=</span>&nbsp;<span class="num" id="7489066">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489072">if</span>&nbsp;<span class="ident" id="7489075">Verify</span><span class="op" id="7489081">(</span><span class="op" id="7489082">&amp;</span><span class="ident" id="7489083">priv</span><span class="op" id="7489087">.</span><span class="ident" id="7489088">PublicKey</span><span class="op" id="7489097">,</span>&nbsp;<span class="ident" id="7489099">hashed</span><span class="op" id="7489105">,</span>&nbsp;<span class="ident" id="7489107">r</span><span class="op" id="7489108">,</span>&nbsp;<span class="ident" id="7489110">s</span><span class="op" id="7489111">)</span>&nbsp;<span class="op" id="7489113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489117">t</span><span class="op" id="7489118">.</span><span class="ident" id="7489119">Errorf</span><span class="op" id="7489125">(</span><span class="string" id="7489126">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7489152">,</span>&nbsp;<span class="ident" id="7489154">tag</span><span class="op" id="7489157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489160">}</span><br>
<span class="lineno"></span><span class="op" id="7489162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7489165">func</span>&nbsp;<span class="ident" id="7489170">TestSignAndVerify</span><span class="op" id="7489187">(</span><span class="ident" id="7489188">t</span>&nbsp;<span class="op" id="7489190">*</span><span class="ident" id="7489191">testing</span><span class="op" id="7489198">.</span><span class="ident" id="7489199">T</span><span class="op" id="7489200">)</span>&nbsp;<span class="op" id="7489202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489205">testSignAndVerify</span><span class="op" id="7489222">(</span><span class="ident" id="7489223">t</span><span class="op" id="7489224">,</span>&nbsp;<span class="ident" id="7489226">elliptic</span><span class="op" id="7489234">.</span><span class="ident" id="7489235">P224</span><span class="op" id="7489239">(</span><span class="op" id="7489240">)</span><span class="op" id="7489241">,</span>&nbsp;<span class="string" id="7489243">&#34;p224&#34;</span><span class="op" id="7489249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489252">if</span>&nbsp;<span class="ident" id="7489255">testing</span><span class="op" id="7489262">.</span><span class="ident" id="7489263">Short</span><span class="op" id="7489268">(</span><span class="op" id="7489269">)</span>&nbsp;<span class="op" id="7489271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489275">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489283">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489286">testSignAndVerify</span><span class="op" id="7489303">(</span><span class="ident" id="7489304">t</span><span class="op" id="7489305">,</span>&nbsp;<span class="ident" id="7489307">elliptic</span><span class="op" id="7489315">.</span><span class="ident" id="7489316">P256</span><span class="op" id="7489320">(</span><span class="op" id="7489321">)</span><span class="op" id="7489322">,</span>&nbsp;<span class="string" id="7489324">&#34;p256&#34;</span><span class="op" id="7489330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489333">testSignAndVerify</span><span class="op" id="7489350">(</span><span class="ident" id="7489351">t</span><span class="op" id="7489352">,</span>&nbsp;<span class="ident" id="7489354">elliptic</span><span class="op" id="7489362">.</span><span class="ident" id="7489363">P384</span><span class="op" id="7489367">(</span><span class="op" id="7489368">)</span><span class="op" id="7489369">,</span>&nbsp;<span class="string" id="7489371">&#34;p384&#34;</span><span class="op" id="7489377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489380">testSignAndVerify</span><span class="op" id="7489397">(</span><span class="ident" id="7489398">t</span><span class="op" id="7489399">,</span>&nbsp;<span class="ident" id="7489401">elliptic</span><span class="op" id="7489409">.</span><span class="ident" id="7489410">P521</span><span class="op" id="7489414">(</span><span class="op" id="7489415">)</span><span class="op" id="7489416">,</span>&nbsp;<span class="string" id="7489418">&#34;p521&#34;</span><span class="op" id="7489424">)</span><br>
<span class="lineno"></span><span class="op" id="7489426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7489429">func</span>&nbsp;<span class="ident" id="7489434">fromHex</span><span class="op" id="7489441">(</span><span class="ident" id="7489442">s</span>&nbsp;<span class="builtintype" id="7489444">string</span><span class="op" id="7489450">)</span>&nbsp;<span class="op" id="7489452">*</span><span class="ident" id="7489453">big</span><span class="op" id="7489456">.</span><span class="ident" id="7489457">Int</span>&nbsp;<span class="op" id="7489461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489464">r</span><span class="op" id="7489465">,</span>&nbsp;<span class="ident" id="7489467">ok</span>&nbsp;<span class="op" id="7489470">:=</span>&nbsp;<span class="builtinfunc" id="7489473">new</span><span class="op" id="7489476">(</span><span class="ident" id="7489477">big</span><span class="op" id="7489480">.</span><span class="ident" id="7489481">Int</span><span class="op" id="7489484">)</span><span class="op" id="7489485">.</span><span class="ident" id="7489486">SetString</span><span class="op" id="7489495">(</span><span class="ident" id="7489496">s</span><span class="op" id="7489497">,</span>&nbsp;<span class="num" id="7489499">16</span><span class="op" id="7489501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489504">if</span>&nbsp;<span class="op" id="7489507">!</span><span class="ident" id="7489508">ok</span>&nbsp;<span class="op" id="7489511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7489515">panic</span><span class="op" id="7489520">(</span><span class="string" id="7489521">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7489530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489533">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489536">return</span>&nbsp;<span class="ident" id="7489543">r</span><br>
<span class="lineno"></span><span class="op" id="7489545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7489548">func</span>&nbsp;<span class="ident" id="7489553">TestVectors</span><span class="op" id="7489564">(</span><span class="ident" id="7489565">t</span>&nbsp;<span class="op" id="7489567">*</span><span class="ident" id="7489568">testing</span><span class="op" id="7489575">.</span><span class="ident" id="7489576">T</span><span class="op" id="7489577">)</span>&nbsp;<span class="op" id="7489579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7489582">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7489640">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7489721">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7489725">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7489792">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489845">if</span>&nbsp;<span class="ident" id="7489848">testing</span><span class="op" id="7489855">.</span><span class="ident" id="7489856">Short</span><span class="op" id="7489861">(</span><span class="op" id="7489862">)</span>&nbsp;<span class="op" id="7489864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489868">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489880">f</span><span class="op" id="7489881">,</span>&nbsp;<span class="ident" id="7489883">err</span>&nbsp;<span class="op" id="7489887">:=</span>&nbsp;<span class="ident" id="7489890">os</span><span class="op" id="7489892">.</span><span class="ident" id="7489893">Open</span><span class="op" id="7489897">(</span><span class="string" id="7489898">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7489923">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7489926">if</span>&nbsp;<span class="ident" id="7489929">err</span>&nbsp;<span class="op" id="7489933">!=</span>&nbsp;<span class="builtintype" id="7489936">nil</span>&nbsp;<span class="op" id="7489940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489944">t</span><span class="op" id="7489945">.</span><span class="ident" id="7489946">Fatal</span><span class="op" id="7489951">(</span><span class="ident" id="7489952">err</span><span class="op" id="7489955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7489958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7489962">buf</span>&nbsp;<span class="op" id="7489966">:=</span>&nbsp;<span class="ident" id="7489969">bufio</span><span class="op" id="7489974">.</span><span class="ident" id="7489975">NewReader</span><span class="op" id="7489984">(</span><span class="ident" id="7489985">bzip2</span><span class="op" id="7489990">.</span><span class="ident" id="7489991">NewReader</span><span class="op" id="7490000">(</span><span class="ident" id="7490001">f</span><span class="op" id="7490002">)</span><span class="op" id="7490003">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490007">lineNo</span>&nbsp;<span class="op" id="7490014">:=</span>&nbsp;<span class="num" id="7490017">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490020">var</span>&nbsp;<span class="ident" id="7490024">h</span>&nbsp;<span class="ident" id="7490026">hash</span><span class="op" id="7490030">.</span><span class="ident" id="7490031">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490037">var</span>&nbsp;<span class="ident" id="7490041">msg</span>&nbsp;<span class="op" id="7490045">[</span><span class="op" id="7490046">]</span><span class="builtintype" id="7490047">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490053">var</span>&nbsp;<span class="ident" id="7490057">hashed</span>&nbsp;<span class="op" id="7490064">[</span><span class="op" id="7490065">]</span><span class="builtintype" id="7490066">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490072">var</span>&nbsp;<span class="ident" id="7490076">r</span><span class="op" id="7490077">,</span>&nbsp;<span class="ident" id="7490079">s</span>&nbsp;<span class="op" id="7490081">*</span><span class="ident" id="7490082">big</span><span class="op" id="7490085">.</span><span class="ident" id="7490086">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490091">pub</span>&nbsp;<span class="op" id="7490095">:=</span>&nbsp;<span class="builtinfunc" id="7490098">new</span><span class="op" id="7490101">(</span><span class="ident" id="7490102">PublicKey</span><span class="op" id="7490111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490115">for</span>&nbsp;<span class="op" id="7490119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490123">line</span><span class="op" id="7490127">,</span>&nbsp;<span class="ident" id="7490129">err</span>&nbsp;<span class="op" id="7490133">:=</span>&nbsp;<span class="ident" id="7490136">buf</span><span class="op" id="7490139">.</span><span class="ident" id="7490140">ReadString</span><span class="op" id="7490150">(</span><span class="string" id="7490151">&#39;\n&#39;</span><span class="op" id="7490155">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490159">if</span>&nbsp;<span class="builtinfunc" id="7490162">len</span><span class="op" id="7490165">(</span><span class="ident" id="7490166">line</span><span class="op" id="7490170">)</span>&nbsp;<span class="op" id="7490172">==</span>&nbsp;<span class="num" id="7490175">0</span>&nbsp;<span class="op" id="7490177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490182">if</span>&nbsp;<span class="ident" id="7490185">err</span>&nbsp;<span class="op" id="7490189">==</span>&nbsp;<span class="ident" id="7490192">io</span><span class="op" id="7490194">.</span><span class="ident" id="7490195">EOF</span>&nbsp;<span class="op" id="7490199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490205">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7490214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490219">t</span><span class="op" id="7490220">.</span><span class="ident" id="7490221">Fatalf</span><span class="op" id="7490227">(</span><span class="string" id="7490228">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7490258">,</span>&nbsp;<span class="ident" id="7490260">err</span><span class="op" id="7490263">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7490267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490271">lineNo</span><span class="op" id="7490277">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7490282">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490333">if</span>&nbsp;<span class="op" id="7490336">!</span><span class="ident" id="7490337">strings</span><span class="op" id="7490344">.</span><span class="ident" id="7490345">HasSuffix</span><span class="op" id="7490354">(</span><span class="ident" id="7490355">line</span><span class="op" id="7490359">,</span>&nbsp;<span class="string" id="7490361">&#34;\r\n&#34;</span><span class="op" id="7490367">)</span>&nbsp;<span class="op" id="7490369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490374">t</span><span class="op" id="7490375">.</span><span class="ident" id="7490376">Fatalf</span><span class="op" id="7490382">(</span><span class="string" id="7490383">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7490429">,</span>&nbsp;<span class="ident" id="7490431">lineNo</span><span class="op" id="7490437">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7490441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490445">line</span>&nbsp;<span class="op" id="7490450">=</span>&nbsp;<span class="ident" id="7490452">line</span><span class="op" id="7490456">[</span><span class="op" id="7490457">:</span><span class="builtinfunc" id="7490458">len</span><span class="op" id="7490461">(</span><span class="ident" id="7490462">line</span><span class="op" id="7490466">)</span><span class="op" id="7490467">-</span><span class="num" id="7490468">2</span><span class="op" id="7490469">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490474">if</span>&nbsp;<span class="builtinfunc" id="7490477">len</span><span class="op" id="7490480">(</span><span class="ident" id="7490481">line</span><span class="op" id="7490485">)</span>&nbsp;<span class="op" id="7490487">==</span>&nbsp;<span class="num" id="7490490">0</span>&nbsp;<span class="op" id="7490492">||</span>&nbsp;<span class="ident" id="7490495">line</span><span class="op" id="7490499">[</span><span class="num" id="7490500">0</span><span class="op" id="7490501">]</span>&nbsp;<span class="op" id="7490503">==</span>&nbsp;<span class="string" id="7490506">&#39;#&#39;</span>&nbsp;<span class="op" id="7490510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490515">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7490526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490531">if</span>&nbsp;<span class="ident" id="7490534">line</span><span class="op" id="7490538">[</span><span class="num" id="7490539">0</span><span class="op" id="7490540">]</span>&nbsp;<span class="op" id="7490542">==</span>&nbsp;<span class="string" id="7490545">&#39;[&#39;</span>&nbsp;<span class="op" id="7490549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490554">line</span>&nbsp;<span class="op" id="7490559">=</span>&nbsp;<span class="ident" id="7490561">line</span><span class="op" id="7490565">[</span><span class="num" id="7490566">1</span>&nbsp;<span class="op" id="7490568">:</span>&nbsp;<span class="builtinfunc" id="7490570">len</span><span class="op" id="7490573">(</span><span class="ident" id="7490574">line</span><span class="op" id="7490578">)</span><span class="op" id="7490579">-</span><span class="num" id="7490580">1</span><span class="op" id="7490581">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490586">parts</span>&nbsp;<span class="op" id="7490592">:=</span>&nbsp;<span class="ident" id="7490595">strings</span><span class="op" id="7490602">.</span><span class="ident" id="7490603">SplitN</span><span class="op" id="7490609">(</span><span class="ident" id="7490610">line</span><span class="op" id="7490614">,</span>&nbsp;<span class="string" id="7490616">&#34;,&#34;</span><span class="op" id="7490619">,</span>&nbsp;<span class="num" id="7490621">2</span><span class="op" id="7490622">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490628">switch</span>&nbsp;<span class="ident" id="7490635">parts</span><span class="op" id="7490640">[</span><span class="num" id="7490641">0</span><span class="op" id="7490642">]</span>&nbsp;<span class="op" id="7490644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490649">case</span>&nbsp;<span class="string" id="7490654">&#34;P-224&#34;</span><span class="op" id="7490661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490667">pub</span><span class="op" id="7490670">.</span><span class="ident" id="7490671">Curve</span>&nbsp;<span class="op" id="7490677">=</span>&nbsp;<span class="ident" id="7490679">elliptic</span><span class="op" id="7490687">.</span><span class="ident" id="7490688">P224</span><span class="op" id="7490692">(</span><span class="op" id="7490693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490698">case</span>&nbsp;<span class="string" id="7490703">&#34;P-256&#34;</span><span class="op" id="7490710">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490716">pub</span><span class="op" id="7490719">.</span><span class="ident" id="7490720">Curve</span>&nbsp;<span class="op" id="7490726">=</span>&nbsp;<span class="ident" id="7490728">elliptic</span><span class="op" id="7490736">.</span><span class="ident" id="7490737">P256</span><span class="op" id="7490741">(</span><span class="op" id="7490742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490747">case</span>&nbsp;<span class="string" id="7490752">&#34;P-384&#34;</span><span class="op" id="7490759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490765">pub</span><span class="op" id="7490768">.</span><span class="ident" id="7490769">Curve</span>&nbsp;<span class="op" id="7490775">=</span>&nbsp;<span class="ident" id="7490777">elliptic</span><span class="op" id="7490785">.</span><span class="ident" id="7490786">P384</span><span class="op" id="7490790">(</span><span class="op" id="7490791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490796">case</span>&nbsp;<span class="string" id="7490801">&#34;P-521&#34;</span><span class="op" id="7490808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490814">pub</span><span class="op" id="7490817">.</span><span class="ident" id="7490818">Curve</span>&nbsp;<span class="op" id="7490824">=</span>&nbsp;<span class="ident" id="7490826">elliptic</span><span class="op" id="7490834">.</span><span class="ident" id="7490835">P521</span><span class="op" id="7490839">(</span><span class="op" id="7490840">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490845">default</span><span class="op" id="7490852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490858">pub</span><span class="op" id="7490861">.</span><span class="ident" id="7490862">Curve</span>&nbsp;<span class="op" id="7490868">=</span>&nbsp;<span class="builtintype" id="7490870">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7490877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490883">switch</span>&nbsp;<span class="ident" id="7490890">parts</span><span class="op" id="7490895">[</span><span class="num" id="7490896">1</span><span class="op" id="7490897">]</span>&nbsp;<span class="op" id="7490899">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490904">case</span>&nbsp;<span class="string" id="7490909">&#34;SHA-1&#34;</span><span class="op" id="7490916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490922">h</span>&nbsp;<span class="op" id="7490924">=</span>&nbsp;<span class="ident" id="7490926">sha1</span><span class="op" id="7490930">.</span><span class="ident" id="7490931">New</span><span class="op" id="7490934">(</span><span class="op" id="7490935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490940">case</span>&nbsp;<span class="string" id="7490945">&#34;SHA-224&#34;</span><span class="op" id="7490954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7490960">h</span>&nbsp;<span class="op" id="7490962">=</span>&nbsp;<span class="ident" id="7490964">sha256</span><span class="op" id="7490970">.</span><span class="ident" id="7490971">New224</span><span class="op" id="7490977">(</span><span class="op" id="7490978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7490983">case</span>&nbsp;<span class="string" id="7490988">&#34;SHA-256&#34;</span><span class="op" id="7490997">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491003">h</span>&nbsp;<span class="op" id="7491005">=</span>&nbsp;<span class="ident" id="7491007">sha256</span><span class="op" id="7491013">.</span><span class="ident" id="7491014">New</span><span class="op" id="7491017">(</span><span class="op" id="7491018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491023">case</span>&nbsp;<span class="string" id="7491028">&#34;SHA-384&#34;</span><span class="op" id="7491037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491043">h</span>&nbsp;<span class="op" id="7491045">=</span>&nbsp;<span class="ident" id="7491047">sha512</span><span class="op" id="7491053">.</span><span class="ident" id="7491054">New384</span><span class="op" id="7491060">(</span><span class="op" id="7491061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491066">case</span>&nbsp;<span class="string" id="7491071">&#34;SHA-512&#34;</span><span class="op" id="7491080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491086">h</span>&nbsp;<span class="op" id="7491088">=</span>&nbsp;<span class="ident" id="7491090">sha512</span><span class="op" id="7491096">.</span><span class="ident" id="7491097">New</span><span class="op" id="7491100">(</span><span class="op" id="7491101">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491106">default</span><span class="op" id="7491113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491119">h</span>&nbsp;<span class="op" id="7491121">=</span>&nbsp;<span class="builtintype" id="7491123">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491136">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491152">if</span>&nbsp;<span class="ident" id="7491155">h</span>&nbsp;<span class="op" id="7491157">==</span>&nbsp;<span class="builtintype" id="7491160">nil</span>&nbsp;<span class="op" id="7491164">||</span>&nbsp;<span class="ident" id="7491167">pub</span><span class="op" id="7491170">.</span><span class="ident" id="7491171">Curve</span>&nbsp;<span class="op" id="7491177">==</span>&nbsp;<span class="builtintype" id="7491180">nil</span>&nbsp;<span class="op" id="7491184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491189">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491200">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491205">switch</span>&nbsp;<span class="op" id="7491212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491216">case</span>&nbsp;<span class="ident" id="7491221">strings</span><span class="op" id="7491228">.</span><span class="ident" id="7491229">HasPrefix</span><span class="op" id="7491238">(</span><span class="ident" id="7491239">line</span><span class="op" id="7491243">,</span>&nbsp;<span class="string" id="7491245">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7491253">)</span><span class="op" id="7491254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491259">if</span>&nbsp;<span class="ident" id="7491262">msg</span><span class="op" id="7491265">,</span>&nbsp;<span class="ident" id="7491267">err</span>&nbsp;<span class="op" id="7491271">=</span>&nbsp;<span class="ident" id="7491273">hex</span><span class="op" id="7491276">.</span><span class="ident" id="7491277">DecodeString</span><span class="op" id="7491289">(</span><span class="ident" id="7491290">line</span><span class="op" id="7491294">[</span><span class="num" id="7491295">6</span><span class="op" id="7491296">:</span><span class="op" id="7491297">]</span><span class="op" id="7491298">)</span><span class="op" id="7491299">;</span>&nbsp;<span class="ident" id="7491301">err</span>&nbsp;<span class="op" id="7491305">!=</span>&nbsp;<span class="builtintype" id="7491308">nil</span>&nbsp;<span class="op" id="7491312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491318">t</span><span class="op" id="7491319">.</span><span class="ident" id="7491320">Fatalf</span><span class="op" id="7491326">(</span><span class="string" id="7491327">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7491368">,</span>&nbsp;<span class="ident" id="7491370">lineNo</span><span class="op" id="7491376">,</span>&nbsp;<span class="ident" id="7491378">err</span><span class="op" id="7491381">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491390">case</span>&nbsp;<span class="ident" id="7491395">strings</span><span class="op" id="7491402">.</span><span class="ident" id="7491403">HasPrefix</span><span class="op" id="7491412">(</span><span class="ident" id="7491413">line</span><span class="op" id="7491417">,</span>&nbsp;<span class="string" id="7491419">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7491426">)</span><span class="op" id="7491427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491432">pub</span><span class="op" id="7491435">.</span><span class="ident" id="7491436">X</span>&nbsp;<span class="op" id="7491438">=</span>&nbsp;<span class="ident" id="7491440">fromHex</span><span class="op" id="7491447">(</span><span class="ident" id="7491448">line</span><span class="op" id="7491452">[</span><span class="num" id="7491453">5</span><span class="op" id="7491454">:</span><span class="op" id="7491455">]</span><span class="op" id="7491456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491460">case</span>&nbsp;<span class="ident" id="7491465">strings</span><span class="op" id="7491472">.</span><span class="ident" id="7491473">HasPrefix</span><span class="op" id="7491482">(</span><span class="ident" id="7491483">line</span><span class="op" id="7491487">,</span>&nbsp;<span class="string" id="7491489">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7491496">)</span><span class="op" id="7491497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491502">pub</span><span class="op" id="7491505">.</span><span class="ident" id="7491506">Y</span>&nbsp;<span class="op" id="7491508">=</span>&nbsp;<span class="ident" id="7491510">fromHex</span><span class="op" id="7491517">(</span><span class="ident" id="7491518">line</span><span class="op" id="7491522">[</span><span class="num" id="7491523">5</span><span class="op" id="7491524">:</span><span class="op" id="7491525">]</span><span class="op" id="7491526">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491530">case</span>&nbsp;<span class="ident" id="7491535">strings</span><span class="op" id="7491542">.</span><span class="ident" id="7491543">HasPrefix</span><span class="op" id="7491552">(</span><span class="ident" id="7491553">line</span><span class="op" id="7491557">,</span>&nbsp;<span class="string" id="7491559">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7491565">)</span><span class="op" id="7491566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491571">r</span>&nbsp;<span class="op" id="7491573">=</span>&nbsp;<span class="ident" id="7491575">fromHex</span><span class="op" id="7491582">(</span><span class="ident" id="7491583">line</span><span class="op" id="7491587">[</span><span class="num" id="7491588">4</span><span class="op" id="7491589">:</span><span class="op" id="7491590">]</span><span class="op" id="7491591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491595">case</span>&nbsp;<span class="ident" id="7491600">strings</span><span class="op" id="7491607">.</span><span class="ident" id="7491608">HasPrefix</span><span class="op" id="7491617">(</span><span class="ident" id="7491618">line</span><span class="op" id="7491622">,</span>&nbsp;<span class="string" id="7491624">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7491630">)</span><span class="op" id="7491631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491636">s</span>&nbsp;<span class="op" id="7491638">=</span>&nbsp;<span class="ident" id="7491640">fromHex</span><span class="op" id="7491647">(</span><span class="ident" id="7491648">line</span><span class="op" id="7491652">[</span><span class="num" id="7491653">4</span><span class="op" id="7491654">:</span><span class="op" id="7491655">]</span><span class="op" id="7491656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491660">case</span>&nbsp;<span class="ident" id="7491665">strings</span><span class="op" id="7491672">.</span><span class="ident" id="7491673">HasPrefix</span><span class="op" id="7491682">(</span><span class="ident" id="7491683">line</span><span class="op" id="7491687">,</span>&nbsp;<span class="string" id="7491689">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7491700">)</span><span class="op" id="7491701">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491706">expected</span>&nbsp;<span class="op" id="7491715">:=</span>&nbsp;<span class="ident" id="7491718">line</span><span class="op" id="7491722">[</span><span class="num" id="7491723">9</span><span class="op" id="7491724">]</span>&nbsp;<span class="op" id="7491726">==</span>&nbsp;<span class="string" id="7491729">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491736">h</span><span class="op" id="7491737">.</span><span class="ident" id="7491738">Reset</span><span class="op" id="7491743">(</span><span class="op" id="7491744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491749">h</span><span class="op" id="7491750">.</span><span class="ident" id="7491751">Write</span><span class="op" id="7491756">(</span><span class="ident" id="7491757">msg</span><span class="op" id="7491760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491765">hashed</span>&nbsp;<span class="op" id="7491772">:=</span>&nbsp;<span class="ident" id="7491775">h</span><span class="op" id="7491776">.</span><span class="ident" id="7491777">Sum</span><span class="op" id="7491780">(</span><span class="ident" id="7491781">hashed</span><span class="op" id="7491787">[</span><span class="op" id="7491788">:</span><span class="num" id="7491789">0</span><span class="op" id="7491790">]</span><span class="op" id="7491791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491796">if</span>&nbsp;<span class="ident" id="7491799">Verify</span><span class="op" id="7491805">(</span><span class="ident" id="7491806">pub</span><span class="op" id="7491809">,</span>&nbsp;<span class="ident" id="7491811">hashed</span><span class="op" id="7491817">,</span>&nbsp;<span class="ident" id="7491819">r</span><span class="op" id="7491820">,</span>&nbsp;<span class="ident" id="7491822">s</span><span class="op" id="7491823">)</span>&nbsp;<span class="op" id="7491825">!=</span>&nbsp;<span class="ident" id="7491828">expected</span>&nbsp;<span class="op" id="7491837">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491843">t</span><span class="op" id="7491844">.</span><span class="ident" id="7491845">Fatalf</span><span class="op" id="7491851">(</span><span class="string" id="7491852">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7491881">,</span>&nbsp;<span class="ident" id="7491883">lineNo</span><span class="op" id="7491889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7491898">default</span><span class="op" id="7491905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7491910">t</span><span class="op" id="7491911">.</span><span class="ident" id="7491912">Fatalf</span><span class="op" id="7491918">(</span><span class="string" id="7491919">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7491952">,</span>&nbsp;<span class="ident" id="7491954">lineNo</span><span class="op" id="7491960">,</span>&nbsp;<span class="ident" id="7491962">line</span><span class="op" id="7491966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491970">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7491973">}</span><br>
<span class="lineno"></span><span class="op" id="7491975">}</span>
</div>
</body>
</html>
