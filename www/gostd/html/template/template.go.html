<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2872722">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2872777">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2872831">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2872882">package</span>&nbsp;<span class="ident" id="2872890">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2872900">import</span>&nbsp;<span class="op" id="2872907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872910">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872917">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872923">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872936">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872953">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872961">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2872978">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="2873000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2873003">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="2873083">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="2873110">type</span>&nbsp;<span class="ident" id="2873115">Template</span>&nbsp;<span class="keyword" id="2873124">struct</span>&nbsp;<span class="op" id="2873131">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873134">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873170">escapeErr</span>&nbsp;<span class="builtintype" id="2873180">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873187">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873261">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873330">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873354">text</span>&nbsp;<span class="op" id="2873359">*</span><span class="ident" id="2873360">template</span><span class="op" id="2873368">.</span><span class="ident" id="2873369">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873379">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873446">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2873457">*</span><span class="ident" id="2873458">parse</span><span class="op" id="2873463">.</span><span class="ident" id="2873464">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2873470">*</span><span class="ident" id="2873471">nameSpace</span>&nbsp;<span class="comment" id="2873481">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="2873519">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="2873522">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="2873587">var</span>&nbsp;<span class="ident" id="2873591">escapeOK</span>&nbsp;<span class="op" id="2873600">=</span>&nbsp;<span class="ident" id="2873602">fmt</span><span class="op" id="2873605">.</span><span class="ident" id="2873606">Errorf</span><span class="op" id="2873612">(</span><span class="string" id="2873613">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="2873641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2873644">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="2873722">type</span>&nbsp;<span class="ident" id="2873727">nameSpace</span>&nbsp;<span class="keyword" id="2873737">struct</span>&nbsp;<span class="op" id="2873744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873747">mu</span>&nbsp;&nbsp;<span class="ident" id="2873751">sync</span><span class="op" id="2873755">.</span><span class="ident" id="2873756">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873763">set</span>&nbsp;<span class="keyword" id="2873767">map</span><span class="op" id="2873770">[</span><span class="builtintype" id="2873771">string</span><span class="op" id="2873777">]</span><span class="op" id="2873778">*</span><span class="ident" id="2873779">Template</span><br>
<span class="lineno"></span><span class="op" id="2873788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="2873791">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2873868">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="2873879">func</span>&nbsp;<span class="op" id="2873884">(</span><span class="ident" id="2873885">t</span>&nbsp;<span class="op" id="2873887">*</span><span class="ident" id="2873888">Template</span><span class="op" id="2873896">)</span>&nbsp;<span class="ident" id="2873898">Templates</span><span class="op" id="2873907">(</span><span class="op" id="2873908">)</span>&nbsp;<span class="op" id="2873910">[</span><span class="op" id="2873911">]</span><span class="op" id="2873912">*</span><span class="ident" id="2873913">Template</span>&nbsp;<span class="op" id="2873922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873925">ns</span>&nbsp;<span class="op" id="2873928">:=</span>&nbsp;<span class="ident" id="2873931">t</span><span class="op" id="2873932">.</span><span class="ident" id="2873933">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873944">ns</span><span class="op" id="2873946">.</span><span class="ident" id="2873947">mu</span><span class="op" id="2873949">.</span><span class="ident" id="2873950">Lock</span><span class="op" id="2873954">(</span><span class="op" id="2873955">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873958">defer</span>&nbsp;<span class="ident" id="2873964">ns</span><span class="op" id="2873966">.</span><span class="ident" id="2873967">mu</span><span class="op" id="2873969">.</span><span class="ident" id="2873970">Unlock</span><span class="op" id="2873976">(</span><span class="op" id="2873977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2873980">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874027">m</span>&nbsp;<span class="op" id="2874029">:=</span>&nbsp;<span class="builtinfunc" id="2874032">make</span><span class="op" id="2874036">(</span><span class="op" id="2874037">[</span><span class="op" id="2874038">]</span><span class="op" id="2874039">*</span><span class="ident" id="2874040">Template</span><span class="op" id="2874048">,</span>&nbsp;<span class="num" id="2874050">0</span><span class="op" id="2874051">,</span>&nbsp;<span class="builtinfunc" id="2874053">len</span><span class="op" id="2874056">(</span><span class="ident" id="2874057">ns</span><span class="op" id="2874059">.</span><span class="ident" id="2874060">set</span><span class="op" id="2874063">)</span><span class="op" id="2874064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874067">for</span>&nbsp;<span class="ident" id="2874071">_</span><span class="op" id="2874072">,</span>&nbsp;<span class="ident" id="2874074">v</span>&nbsp;<span class="op" id="2874076">:=</span>&nbsp;<span class="keyword" id="2874079">range</span>&nbsp;<span class="ident" id="2874085">ns</span><span class="op" id="2874087">.</span><span class="ident" id="2874088">set</span>&nbsp;<span class="op" id="2874092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874096">m</span>&nbsp;<span class="op" id="2874098">=</span>&nbsp;<span class="builtinfunc" id="2874100">append</span><span class="op" id="2874106">(</span><span class="ident" id="2874107">m</span><span class="op" id="2874108">,</span>&nbsp;<span class="ident" id="2874110">v</span><span class="op" id="2874111">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874117">return</span>&nbsp;<span class="ident" id="2874124">m</span><br>
<span class="lineno"></span><span class="op" id="2874126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2874129">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="2874173">func</span>&nbsp;<span class="op" id="2874178">(</span><span class="ident" id="2874179">t</span>&nbsp;<span class="op" id="2874181">*</span><span class="ident" id="2874182">Template</span><span class="op" id="2874190">)</span>&nbsp;<span class="ident" id="2874192">escape</span><span class="op" id="2874198">(</span><span class="op" id="2874199">)</span>&nbsp;<span class="builtintype" id="2874201">error</span>&nbsp;<span class="op" id="2874207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874210">t</span><span class="op" id="2874211">.</span><span class="ident" id="2874212">nameSpace</span><span class="op" id="2874221">.</span><span class="ident" id="2874222">mu</span><span class="op" id="2874224">.</span><span class="ident" id="2874225">Lock</span><span class="op" id="2874229">(</span><span class="op" id="2874230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874233">defer</span>&nbsp;<span class="ident" id="2874239">t</span><span class="op" id="2874240">.</span><span class="ident" id="2874241">nameSpace</span><span class="op" id="2874250">.</span><span class="ident" id="2874251">mu</span><span class="op" id="2874253">.</span><span class="ident" id="2874254">Unlock</span><span class="op" id="2874260">(</span><span class="op" id="2874261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874264">if</span>&nbsp;<span class="ident" id="2874267">t</span><span class="op" id="2874268">.</span><span class="ident" id="2874269">escapeErr</span>&nbsp;<span class="op" id="2874279">==</span>&nbsp;<span class="ident" id="2874282">nil</span>&nbsp;<span class="op" id="2874286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874290">if</span>&nbsp;<span class="ident" id="2874293">err</span>&nbsp;<span class="op" id="2874297">:=</span>&nbsp;<span class="ident" id="2874300">escapeTemplate</span><span class="op" id="2874314">(</span><span class="ident" id="2874315">t</span><span class="op" id="2874316">,</span>&nbsp;<span class="ident" id="2874318">t</span><span class="op" id="2874319">.</span><span class="ident" id="2874320">text</span><span class="op" id="2874324">.</span><span class="ident" id="2874325">Root</span><span class="op" id="2874329">,</span>&nbsp;<span class="ident" id="2874331">t</span><span class="op" id="2874332">.</span><span class="ident" id="2874333">Name</span><span class="op" id="2874337">(</span><span class="op" id="2874338">)</span><span class="op" id="2874339">)</span><span class="op" id="2874340">;</span>&nbsp;<span class="ident" id="2874342">err</span>&nbsp;<span class="op" id="2874346">!=</span>&nbsp;<span class="ident" id="2874349">nil</span>&nbsp;<span class="op" id="2874353">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874358">return</span>&nbsp;<span class="ident" id="2874365">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874374">}</span>&nbsp;<span class="keyword" id="2874376">else</span>&nbsp;<span class="keyword" id="2874381">if</span>&nbsp;<span class="ident" id="2874384">t</span><span class="op" id="2874385">.</span><span class="ident" id="2874386">escapeErr</span>&nbsp;<span class="op" id="2874396">!=</span>&nbsp;<span class="ident" id="2874399">escapeOK</span>&nbsp;<span class="op" id="2874408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874412">return</span>&nbsp;<span class="ident" id="2874419">t</span><span class="op" id="2874420">.</span><span class="ident" id="2874421">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874432">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874435">return</span>&nbsp;<span class="ident" id="2874442">nil</span><br>
<span class="lineno"></span><span class="op" id="2874446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2874449">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="2874516">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="2874545">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="2874613">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2874686">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="2874708">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="2874758">func</span>&nbsp;<span class="op" id="2874763">(</span><span class="ident" id="2874764">t</span>&nbsp;<span class="op" id="2874766">*</span><span class="ident" id="2874767">Template</span><span class="op" id="2874775">)</span>&nbsp;<span class="ident" id="2874777">Execute</span><span class="op" id="2874784">(</span><span class="ident" id="2874785">wr</span>&nbsp;<span class="ident" id="2874788">io</span><span class="op" id="2874790">.</span><span class="ident" id="2874791">Writer</span><span class="op" id="2874797">,</span>&nbsp;<span class="ident" id="2874799">data</span>&nbsp;<span class="keyword" id="2874804">interface</span><span class="op" id="2874813">{</span><span class="op" id="2874814">}</span><span class="op" id="2874815">)</span>&nbsp;<span class="builtintype" id="2874817">error</span>&nbsp;<span class="op" id="2874823">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874826">if</span>&nbsp;<span class="ident" id="2874829">err</span>&nbsp;<span class="op" id="2874833">:=</span>&nbsp;<span class="ident" id="2874836">t</span><span class="op" id="2874837">.</span><span class="ident" id="2874838">escape</span><span class="op" id="2874844">(</span><span class="op" id="2874845">)</span><span class="op" id="2874846">;</span>&nbsp;<span class="ident" id="2874848">err</span>&nbsp;<span class="op" id="2874852">!=</span>&nbsp;<span class="ident" id="2874855">nil</span>&nbsp;<span class="op" id="2874859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874863">return</span>&nbsp;<span class="ident" id="2874870">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874878">return</span>&nbsp;<span class="ident" id="2874885">t</span><span class="op" id="2874886">.</span><span class="ident" id="2874887">text</span><span class="op" id="2874891">.</span><span class="ident" id="2874892">Execute</span><span class="op" id="2874899">(</span><span class="ident" id="2874900">wr</span><span class="op" id="2874902">,</span>&nbsp;<span class="ident" id="2874904">data</span><span class="op" id="2874908">)</span><br>
<span class="lineno"></span><span class="op" id="2874910">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2874913">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="2874990">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="2875056">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="2875124">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="2875197">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="2875219">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="2875269">func</span>&nbsp;<span class="op" id="2875274">(</span><span class="ident" id="2875275">t</span>&nbsp;<span class="op" id="2875277">*</span><span class="ident" id="2875278">Template</span><span class="op" id="2875286">)</span>&nbsp;<span class="ident" id="2875288">ExecuteTemplate</span><span class="op" id="2875303">(</span><span class="ident" id="2875304">wr</span>&nbsp;<span class="ident" id="2875307">io</span><span class="op" id="2875309">.</span><span class="ident" id="2875310">Writer</span><span class="op" id="2875316">,</span>&nbsp;<span class="ident" id="2875318">name</span>&nbsp;<span class="builtintype" id="2875323">string</span><span class="op" id="2875329">,</span>&nbsp;<span class="ident" id="2875331">data</span>&nbsp;<span class="keyword" id="2875336">interface</span><span class="op" id="2875345">{</span><span class="op" id="2875346">}</span><span class="op" id="2875347">)</span>&nbsp;<span class="builtintype" id="2875349">error</span>&nbsp;<span class="op" id="2875355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875358">tmpl</span><span class="op" id="2875362">,</span>&nbsp;<span class="ident" id="2875364">err</span>&nbsp;<span class="op" id="2875368">:=</span>&nbsp;<span class="ident" id="2875371">t</span><span class="op" id="2875372">.</span><span class="ident" id="2875373">lookupAndEscapeTemplate</span><span class="op" id="2875396">(</span><span class="ident" id="2875397">name</span><span class="op" id="2875401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875404">if</span>&nbsp;<span class="ident" id="2875407">err</span>&nbsp;<span class="op" id="2875411">!=</span>&nbsp;<span class="ident" id="2875414">nil</span>&nbsp;<span class="op" id="2875418">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875422">return</span>&nbsp;<span class="ident" id="2875429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875437">return</span>&nbsp;<span class="ident" id="2875444">tmpl</span><span class="op" id="2875448">.</span><span class="ident" id="2875449">text</span><span class="op" id="2875453">.</span><span class="ident" id="2875454">Execute</span><span class="op" id="2875461">(</span><span class="ident" id="2875462">wr</span><span class="op" id="2875464">,</span>&nbsp;<span class="ident" id="2875466">data</span><span class="op" id="2875470">)</span><br>
<span class="lineno"></span><span class="op" id="2875472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="2875475">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="2875551">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="2875624">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="2875637">func</span>&nbsp;<span class="op" id="2875642">(</span><span class="ident" id="2875643">t</span>&nbsp;<span class="op" id="2875645">*</span><span class="ident" id="2875646">Template</span><span class="op" id="2875654">)</span>&nbsp;<span class="ident" id="2875656">lookupAndEscapeTemplate</span><span class="op" id="2875679">(</span><span class="ident" id="2875680">name</span>&nbsp;<span class="builtintype" id="2875685">string</span><span class="op" id="2875691">)</span>&nbsp;<span class="op" id="2875693">(</span><span class="ident" id="2875694">tmpl</span>&nbsp;<span class="op" id="2875699">*</span><span class="ident" id="2875700">Template</span><span class="op" id="2875708">,</span>&nbsp;<span class="ident" id="2875710">err</span>&nbsp;<span class="builtintype" id="2875714">error</span><span class="op" id="2875719">)</span>&nbsp;<span class="op" id="2875721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875724">t</span><span class="op" id="2875725">.</span><span class="ident" id="2875726">nameSpace</span><span class="op" id="2875735">.</span><span class="ident" id="2875736">mu</span><span class="op" id="2875738">.</span><span class="ident" id="2875739">Lock</span><span class="op" id="2875743">(</span><span class="op" id="2875744">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875747">defer</span>&nbsp;<span class="ident" id="2875753">t</span><span class="op" id="2875754">.</span><span class="ident" id="2875755">nameSpace</span><span class="op" id="2875764">.</span><span class="ident" id="2875765">mu</span><span class="op" id="2875767">.</span><span class="ident" id="2875768">Unlock</span><span class="op" id="2875774">(</span><span class="op" id="2875775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875778">tmpl</span>&nbsp;<span class="op" id="2875783">=</span>&nbsp;<span class="ident" id="2875785">t</span><span class="op" id="2875786">.</span><span class="ident" id="2875787">set</span><span class="op" id="2875790">[</span><span class="ident" id="2875791">name</span><span class="op" id="2875795">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875798">if</span>&nbsp;<span class="ident" id="2875801">tmpl</span>&nbsp;<span class="op" id="2875806">==</span>&nbsp;<span class="ident" id="2875809">nil</span>&nbsp;<span class="op" id="2875813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875817">return</span>&nbsp;<span class="ident" id="2875824">nil</span><span class="op" id="2875827">,</span>&nbsp;<span class="ident" id="2875829">fmt</span><span class="op" id="2875832">.</span><span class="ident" id="2875833">Errorf</span><span class="op" id="2875839">(</span><span class="string" id="2875840">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="2875872">,</span>&nbsp;<span class="ident" id="2875874">name</span><span class="op" id="2875878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875881">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875884">if</span>&nbsp;<span class="ident" id="2875887">tmpl</span><span class="op" id="2875891">.</span><span class="ident" id="2875892">escapeErr</span>&nbsp;<span class="op" id="2875902">!=</span>&nbsp;<span class="ident" id="2875905">nil</span>&nbsp;<span class="op" id="2875909">&amp;&amp;</span>&nbsp;<span class="ident" id="2875912">tmpl</span><span class="op" id="2875916">.</span><span class="ident" id="2875917">escapeErr</span>&nbsp;<span class="op" id="2875927">!=</span>&nbsp;<span class="ident" id="2875930">escapeOK</span>&nbsp;<span class="op" id="2875939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875943">return</span>&nbsp;<span class="ident" id="2875950">nil</span><span class="op" id="2875953">,</span>&nbsp;<span class="ident" id="2875955">tmpl</span><span class="op" id="2875959">.</span><span class="ident" id="2875960">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875974">if</span>&nbsp;<span class="ident" id="2875977">tmpl</span><span class="op" id="2875981">.</span><span class="ident" id="2875982">text</span><span class="op" id="2875986">.</span><span class="ident" id="2875987">Tree</span>&nbsp;<span class="op" id="2875992">==</span>&nbsp;<span class="ident" id="2875995">nil</span>&nbsp;<span class="op" id="2875999">||</span>&nbsp;<span class="ident" id="2876002">tmpl</span><span class="op" id="2876006">.</span><span class="ident" id="2876007">text</span><span class="op" id="2876011">.</span><span class="ident" id="2876012">Root</span>&nbsp;<span class="op" id="2876017">==</span>&nbsp;<span class="ident" id="2876020">nil</span>&nbsp;<span class="op" id="2876024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876028">return</span>&nbsp;<span class="ident" id="2876035">nil</span><span class="op" id="2876038">,</span>&nbsp;<span class="ident" id="2876040">fmt</span><span class="op" id="2876043">.</span><span class="ident" id="2876044">Errorf</span><span class="op" id="2876050">(</span><span class="string" id="2876051">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="2876096">,</span>&nbsp;<span class="ident" id="2876098">name</span><span class="op" id="2876102">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876108">if</span>&nbsp;<span class="ident" id="2876111">t</span><span class="op" id="2876112">.</span><span class="ident" id="2876113">text</span><span class="op" id="2876117">.</span><span class="ident" id="2876118">Lookup</span><span class="op" id="2876124">(</span><span class="ident" id="2876125">name</span><span class="op" id="2876129">)</span>&nbsp;<span class="op" id="2876131">==</span>&nbsp;<span class="ident" id="2876134">nil</span>&nbsp;<span class="op" id="2876138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2876142">panic</span><span class="op" id="2876147">(</span><span class="string" id="2876148">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="2876209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876215">if</span>&nbsp;<span class="ident" id="2876218">tmpl</span><span class="op" id="2876222">.</span><span class="ident" id="2876223">escapeErr</span>&nbsp;<span class="op" id="2876233">==</span>&nbsp;<span class="ident" id="2876236">nil</span>&nbsp;<span class="op" id="2876240">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876244">err</span>&nbsp;<span class="op" id="2876248">=</span>&nbsp;<span class="ident" id="2876250">escapeTemplate</span><span class="op" id="2876264">(</span><span class="ident" id="2876265">tmpl</span><span class="op" id="2876269">,</span>&nbsp;<span class="ident" id="2876271">tmpl</span><span class="op" id="2876275">.</span><span class="ident" id="2876276">text</span><span class="op" id="2876280">.</span><span class="ident" id="2876281">Root</span><span class="op" id="2876285">,</span>&nbsp;<span class="ident" id="2876287">name</span><span class="op" id="2876291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876297">return</span>&nbsp;<span class="ident" id="2876304">tmpl</span><span class="op" id="2876308">,</span>&nbsp;<span class="ident" id="2876310">err</span><br>
<span class="lineno"></span><span class="op" id="2876314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2876317">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="2876387">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2876453">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="2876525">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="2876598">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="2876662">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="2876733">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="2876800">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="2876858">func</span>&nbsp;<span class="op" id="2876863">(</span><span class="ident" id="2876864">t</span>&nbsp;<span class="op" id="2876866">*</span><span class="ident" id="2876867">Template</span><span class="op" id="2876875">)</span>&nbsp;<span class="ident" id="2876877">Parse</span><span class="op" id="2876882">(</span><span class="ident" id="2876883">src</span>&nbsp;<span class="builtintype" id="2876887">string</span><span class="op" id="2876893">)</span>&nbsp;<span class="op" id="2876895">(</span><span class="op" id="2876896">*</span><span class="ident" id="2876897">Template</span><span class="op" id="2876905">,</span>&nbsp;<span class="builtintype" id="2876907">error</span><span class="op" id="2876912">)</span>&nbsp;<span class="op" id="2876914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876917">t</span><span class="op" id="2876918">.</span><span class="ident" id="2876919">nameSpace</span><span class="op" id="2876928">.</span><span class="ident" id="2876929">mu</span><span class="op" id="2876931">.</span><span class="ident" id="2876932">Lock</span><span class="op" id="2876936">(</span><span class="op" id="2876937">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876940">t</span><span class="op" id="2876941">.</span><span class="ident" id="2876942">escapeErr</span>&nbsp;<span class="op" id="2876952">=</span>&nbsp;<span class="ident" id="2876954">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876959">t</span><span class="op" id="2876960">.</span><span class="ident" id="2876961">nameSpace</span><span class="op" id="2876970">.</span><span class="ident" id="2876971">mu</span><span class="op" id="2876973">.</span><span class="ident" id="2876974">Unlock</span><span class="op" id="2876980">(</span><span class="op" id="2876981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876984">ret</span><span class="op" id="2876987">,</span>&nbsp;<span class="ident" id="2876989">err</span>&nbsp;<span class="op" id="2876993">:=</span>&nbsp;<span class="ident" id="2876996">t</span><span class="op" id="2876997">.</span><span class="ident" id="2876998">text</span><span class="op" id="2877002">.</span><span class="ident" id="2877003">Parse</span><span class="op" id="2877008">(</span><span class="ident" id="2877009">src</span><span class="op" id="2877012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877015">if</span>&nbsp;<span class="ident" id="2877018">err</span>&nbsp;<span class="op" id="2877022">!=</span>&nbsp;<span class="ident" id="2877025">nil</span>&nbsp;<span class="op" id="2877029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877033">return</span>&nbsp;<span class="ident" id="2877040">nil</span><span class="op" id="2877043">,</span>&nbsp;<span class="ident" id="2877045">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2877050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877053">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877123">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877176">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877237">t</span><span class="op" id="2877238">.</span><span class="ident" id="2877239">nameSpace</span><span class="op" id="2877248">.</span><span class="ident" id="2877249">mu</span><span class="op" id="2877251">.</span><span class="ident" id="2877252">Lock</span><span class="op" id="2877256">(</span><span class="op" id="2877257">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877260">defer</span>&nbsp;<span class="ident" id="2877266">t</span><span class="op" id="2877267">.</span><span class="ident" id="2877268">nameSpace</span><span class="op" id="2877277">.</span><span class="ident" id="2877278">mu</span><span class="op" id="2877280">.</span><span class="ident" id="2877281">Unlock</span><span class="op" id="2877287">(</span><span class="op" id="2877288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877291">for</span>&nbsp;<span class="ident" id="2877295">_</span><span class="op" id="2877296">,</span>&nbsp;<span class="ident" id="2877298">v</span>&nbsp;<span class="op" id="2877300">:=</span>&nbsp;<span class="keyword" id="2877303">range</span>&nbsp;<span class="ident" id="2877309">ret</span><span class="op" id="2877312">.</span><span class="ident" id="2877313">Templates</span><span class="op" id="2877322">(</span><span class="op" id="2877323">)</span>&nbsp;<span class="op" id="2877325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877329">name</span>&nbsp;<span class="op" id="2877334">:=</span>&nbsp;<span class="ident" id="2877337">v</span><span class="op" id="2877338">.</span><span class="ident" id="2877339">Name</span><span class="op" id="2877343">(</span><span class="op" id="2877344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877348">tmpl</span>&nbsp;<span class="op" id="2877353">:=</span>&nbsp;<span class="ident" id="2877356">t</span><span class="op" id="2877357">.</span><span class="ident" id="2877358">set</span><span class="op" id="2877361">[</span><span class="ident" id="2877362">name</span><span class="op" id="2877366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877370">if</span>&nbsp;<span class="ident" id="2877373">tmpl</span>&nbsp;<span class="op" id="2877378">==</span>&nbsp;<span class="ident" id="2877381">nil</span>&nbsp;<span class="op" id="2877385">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877390">tmpl</span>&nbsp;<span class="op" id="2877395">=</span>&nbsp;<span class="ident" id="2877397">t</span><span class="op" id="2877398">.</span><span class="builtinfunc" id="2877399">new</span><span class="op" id="2877402">(</span><span class="ident" id="2877403">name</span><span class="op" id="2877407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2877411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877415">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877494">tmpl</span><span class="op" id="2877498">.</span><span class="ident" id="2877499">escapeErr</span>&nbsp;<span class="op" id="2877509">=</span>&nbsp;<span class="ident" id="2877511">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877517">tmpl</span><span class="op" id="2877521">.</span><span class="ident" id="2877522">text</span>&nbsp;<span class="op" id="2877527">=</span>&nbsp;<span class="ident" id="2877529">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877533">tmpl</span><span class="op" id="2877537">.</span><span class="ident" id="2877538">Tree</span>&nbsp;<span class="op" id="2877543">=</span>&nbsp;<span class="ident" id="2877545">v</span><span class="op" id="2877546">.</span><span class="ident" id="2877547">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2877553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877556">return</span>&nbsp;<span class="ident" id="2877563">t</span><span class="op" id="2877564">,</span>&nbsp;<span class="ident" id="2877566">nil</span><br>
<span class="lineno"></span><span class="op" id="2877570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="2877573">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="2877641">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2877670">//</span><br>
<span class="lineno"></span><span class="comment" id="2877673">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="2877728">func</span>&nbsp;<span class="op" id="2877733">(</span><span class="ident" id="2877734">t</span>&nbsp;<span class="op" id="2877736">*</span><span class="ident" id="2877737">Template</span><span class="op" id="2877745">)</span>&nbsp;<span class="ident" id="2877747">AddParseTree</span><span class="op" id="2877759">(</span><span class="ident" id="2877760">name</span>&nbsp;<span class="builtintype" id="2877765">string</span><span class="op" id="2877771">,</span>&nbsp;<span class="ident" id="2877773">tree</span>&nbsp;<span class="op" id="2877778">*</span><span class="ident" id="2877779">parse</span><span class="op" id="2877784">.</span><span class="ident" id="2877785">Tree</span><span class="op" id="2877789">)</span>&nbsp;<span class="op" id="2877791">(</span><span class="op" id="2877792">*</span><span class="ident" id="2877793">Template</span><span class="op" id="2877801">,</span>&nbsp;<span class="builtintype" id="2877803">error</span><span class="op" id="2877808">)</span>&nbsp;<span class="op" id="2877810">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877813">t</span><span class="op" id="2877814">.</span><span class="ident" id="2877815">nameSpace</span><span class="op" id="2877824">.</span><span class="ident" id="2877825">mu</span><span class="op" id="2877827">.</span><span class="ident" id="2877828">Lock</span><span class="op" id="2877832">(</span><span class="op" id="2877833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877836">defer</span>&nbsp;<span class="ident" id="2877842">t</span><span class="op" id="2877843">.</span><span class="ident" id="2877844">nameSpace</span><span class="op" id="2877853">.</span><span class="ident" id="2877854">mu</span><span class="op" id="2877856">.</span><span class="ident" id="2877857">Unlock</span><span class="op" id="2877863">(</span><span class="op" id="2877864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877867">if</span>&nbsp;<span class="ident" id="2877870">t</span><span class="op" id="2877871">.</span><span class="ident" id="2877872">escapeErr</span>&nbsp;<span class="op" id="2877882">!=</span>&nbsp;<span class="ident" id="2877885">nil</span>&nbsp;<span class="op" id="2877889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877893">return</span>&nbsp;<span class="ident" id="2877900">nil</span><span class="op" id="2877903">,</span>&nbsp;<span class="ident" id="2877905">fmt</span><span class="op" id="2877908">.</span><span class="ident" id="2877909">Errorf</span><span class="op" id="2877915">(</span><span class="string" id="2877916">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="2877980">,</span>&nbsp;<span class="ident" id="2877982">t</span><span class="op" id="2877983">.</span><span class="ident" id="2877984">Name</span><span class="op" id="2877988">(</span><span class="op" id="2877989">)</span><span class="op" id="2877990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2877993">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877996">text</span><span class="op" id="2878000">,</span>&nbsp;<span class="ident" id="2878002">err</span>&nbsp;<span class="op" id="2878006">:=</span>&nbsp;<span class="ident" id="2878009">t</span><span class="op" id="2878010">.</span><span class="ident" id="2878011">text</span><span class="op" id="2878015">.</span><span class="ident" id="2878016">AddParseTree</span><span class="op" id="2878028">(</span><span class="ident" id="2878029">name</span><span class="op" id="2878033">,</span>&nbsp;<span class="ident" id="2878035">tree</span><span class="op" id="2878039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878042">if</span>&nbsp;<span class="ident" id="2878045">err</span>&nbsp;<span class="op" id="2878049">!=</span>&nbsp;<span class="ident" id="2878052">nil</span>&nbsp;<span class="op" id="2878056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878060">return</span>&nbsp;<span class="ident" id="2878067">nil</span><span class="op" id="2878070">,</span>&nbsp;<span class="ident" id="2878072">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2878077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878080">ret</span>&nbsp;<span class="op" id="2878084">:=</span>&nbsp;<span class="op" id="2878087">&amp;</span><span class="ident" id="2878088">Template</span><span class="op" id="2878096">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878100">nil</span><span class="op" id="2878103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878107">text</span><span class="op" id="2878111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878115">text</span><span class="op" id="2878119">.</span><span class="ident" id="2878120">Tree</span><span class="op" id="2878124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878128">t</span><span class="op" id="2878129">.</span><span class="ident" id="2878130">nameSpace</span><span class="op" id="2878139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2878142">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878145">t</span><span class="op" id="2878146">.</span><span class="ident" id="2878147">set</span><span class="op" id="2878150">[</span><span class="ident" id="2878151">name</span><span class="op" id="2878155">]</span>&nbsp;<span class="op" id="2878157">=</span>&nbsp;<span class="ident" id="2878159">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878164">return</span>&nbsp;<span class="ident" id="2878171">ret</span><span class="op" id="2878174">,</span>&nbsp;<span class="ident" id="2878176">nil</span><br>
<span class="lineno"></span><span class="op" id="2878180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2878183">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="2878254">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2878331">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="2878406">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="2878485">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="2878563">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="2878614">//</span><br>
<span class="lineno"></span><span class="comment" id="2878617">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="2878672">func</span>&nbsp;<span class="op" id="2878677">(</span><span class="ident" id="2878678">t</span>&nbsp;<span class="op" id="2878680">*</span><span class="ident" id="2878681">Template</span><span class="op" id="2878689">)</span>&nbsp;<span class="ident" id="2878691">Clone</span><span class="op" id="2878696">(</span><span class="op" id="2878697">)</span>&nbsp;<span class="op" id="2878699">(</span><span class="op" id="2878700">*</span><span class="ident" id="2878701">Template</span><span class="op" id="2878709">,</span>&nbsp;<span class="builtintype" id="2878711">error</span><span class="op" id="2878716">)</span>&nbsp;<span class="op" id="2878718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878721">t</span><span class="op" id="2878722">.</span><span class="ident" id="2878723">nameSpace</span><span class="op" id="2878732">.</span><span class="ident" id="2878733">mu</span><span class="op" id="2878735">.</span><span class="ident" id="2878736">Lock</span><span class="op" id="2878740">(</span><span class="op" id="2878741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878744">defer</span>&nbsp;<span class="ident" id="2878750">t</span><span class="op" id="2878751">.</span><span class="ident" id="2878752">nameSpace</span><span class="op" id="2878761">.</span><span class="ident" id="2878762">mu</span><span class="op" id="2878764">.</span><span class="ident" id="2878765">Unlock</span><span class="op" id="2878771">(</span><span class="op" id="2878772">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878775">if</span>&nbsp;<span class="ident" id="2878778">t</span><span class="op" id="2878779">.</span><span class="ident" id="2878780">escapeErr</span>&nbsp;<span class="op" id="2878790">!=</span>&nbsp;<span class="ident" id="2878793">nil</span>&nbsp;<span class="op" id="2878797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878801">return</span>&nbsp;<span class="ident" id="2878808">nil</span><span class="op" id="2878811">,</span>&nbsp;<span class="ident" id="2878813">fmt</span><span class="op" id="2878816">.</span><span class="ident" id="2878817">Errorf</span><span class="op" id="2878823">(</span><span class="string" id="2878824">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="2878878">,</span>&nbsp;<span class="ident" id="2878880">t</span><span class="op" id="2878881">.</span><span class="ident" id="2878882">Name</span><span class="op" id="2878886">(</span><span class="op" id="2878887">)</span><span class="op" id="2878888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2878891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878894">textClone</span><span class="op" id="2878903">,</span>&nbsp;<span class="ident" id="2878905">err</span>&nbsp;<span class="op" id="2878909">:=</span>&nbsp;<span class="ident" id="2878912">t</span><span class="op" id="2878913">.</span><span class="ident" id="2878914">text</span><span class="op" id="2878918">.</span><span class="ident" id="2878919">Clone</span><span class="op" id="2878924">(</span><span class="op" id="2878925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878928">if</span>&nbsp;<span class="ident" id="2878931">err</span>&nbsp;<span class="op" id="2878935">!=</span>&nbsp;<span class="ident" id="2878938">nil</span>&nbsp;<span class="op" id="2878942">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878946">return</span>&nbsp;<span class="ident" id="2878953">nil</span><span class="op" id="2878956">,</span>&nbsp;<span class="ident" id="2878958">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2878963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878966">ret</span>&nbsp;<span class="op" id="2878970">:=</span>&nbsp;<span class="op" id="2878973">&amp;</span><span class="ident" id="2878974">Template</span><span class="op" id="2878982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878986">nil</span><span class="op" id="2878989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878993">textClone</span><span class="op" id="2879002">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879006">textClone</span><span class="op" id="2879015">.</span><span class="ident" id="2879016">Tree</span><span class="op" id="2879020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879024">&amp;</span><span class="ident" id="2879025">nameSpace</span><span class="op" id="2879034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879039">set</span><span class="op" id="2879042">:</span>&nbsp;<span class="builtinfunc" id="2879044">make</span><span class="op" id="2879048">(</span><span class="keyword" id="2879049">map</span><span class="op" id="2879052">[</span><span class="builtintype" id="2879053">string</span><span class="op" id="2879059">]</span><span class="op" id="2879060">*</span><span class="ident" id="2879061">Template</span><span class="op" id="2879069">)</span><span class="op" id="2879070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879074">}</span><span class="op" id="2879075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879078">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879081">for</span>&nbsp;<span class="ident" id="2879085">_</span><span class="op" id="2879086">,</span>&nbsp;<span class="ident" id="2879088">x</span>&nbsp;<span class="op" id="2879090">:=</span>&nbsp;<span class="keyword" id="2879093">range</span>&nbsp;<span class="ident" id="2879099">textClone</span><span class="op" id="2879108">.</span><span class="ident" id="2879109">Templates</span><span class="op" id="2879118">(</span><span class="op" id="2879119">)</span>&nbsp;<span class="op" id="2879121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879125">name</span>&nbsp;<span class="op" id="2879130">:=</span>&nbsp;<span class="ident" id="2879133">x</span><span class="op" id="2879134">.</span><span class="ident" id="2879135">Name</span><span class="op" id="2879139">(</span><span class="op" id="2879140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879144">src</span>&nbsp;<span class="op" id="2879148">:=</span>&nbsp;<span class="ident" id="2879151">t</span><span class="op" id="2879152">.</span><span class="ident" id="2879153">set</span><span class="op" id="2879156">[</span><span class="ident" id="2879157">name</span><span class="op" id="2879161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879165">if</span>&nbsp;<span class="ident" id="2879168">src</span>&nbsp;<span class="op" id="2879172">==</span>&nbsp;<span class="ident" id="2879175">nil</span>&nbsp;<span class="op" id="2879179">||</span>&nbsp;<span class="ident" id="2879182">src</span><span class="op" id="2879185">.</span><span class="ident" id="2879186">escapeErr</span>&nbsp;<span class="op" id="2879196">!=</span>&nbsp;<span class="ident" id="2879199">nil</span>&nbsp;<span class="op" id="2879203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879208">return</span>&nbsp;<span class="ident" id="2879215">nil</span><span class="op" id="2879218">,</span>&nbsp;<span class="ident" id="2879220">fmt</span><span class="op" id="2879223">.</span><span class="ident" id="2879224">Errorf</span><span class="op" id="2879230">(</span><span class="string" id="2879231">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="2879285">,</span>&nbsp;<span class="ident" id="2879287">t</span><span class="op" id="2879288">.</span><span class="ident" id="2879289">Name</span><span class="op" id="2879293">(</span><span class="op" id="2879294">)</span><span class="op" id="2879295">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879303">x</span><span class="op" id="2879304">.</span><span class="ident" id="2879305">Tree</span>&nbsp;<span class="op" id="2879310">=</span>&nbsp;<span class="ident" id="2879312">x</span><span class="op" id="2879313">.</span><span class="ident" id="2879314">Tree</span><span class="op" id="2879318">.</span><span class="ident" id="2879319">Copy</span><span class="op" id="2879323">(</span><span class="op" id="2879324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879328">ret</span><span class="op" id="2879331">.</span><span class="ident" id="2879332">set</span><span class="op" id="2879335">[</span><span class="ident" id="2879336">name</span><span class="op" id="2879340">]</span>&nbsp;<span class="op" id="2879342">=</span>&nbsp;<span class="op" id="2879344">&amp;</span><span class="ident" id="2879345">Template</span><span class="op" id="2879353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879358">nil</span><span class="op" id="2879361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879366">x</span><span class="op" id="2879367">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879372">x</span><span class="op" id="2879373">.</span><span class="ident" id="2879374">Tree</span><span class="op" id="2879378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879383">ret</span><span class="op" id="2879386">.</span><span class="ident" id="2879387">nameSpace</span><span class="op" id="2879396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879406">return</span>&nbsp;<span class="ident" id="2879413">ret</span><span class="op" id="2879416">,</span>&nbsp;<span class="ident" id="2879418">nil</span><br>
<span class="lineno">220</span><span class="op" id="2879422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2879425">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2879483">func</span>&nbsp;<span class="ident" id="2879488">New</span><span class="op" id="2879491">(</span><span class="ident" id="2879492">name</span>&nbsp;<span class="builtintype" id="2879497">string</span><span class="op" id="2879503">)</span>&nbsp;<span class="op" id="2879505">*</span><span class="ident" id="2879506">Template</span>&nbsp;<span class="op" id="2879515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879518">tmpl</span>&nbsp;<span class="op" id="2879523">:=</span>&nbsp;<span class="op" id="2879526">&amp;</span><span class="ident" id="2879527">Template</span><span class="op" id="2879535">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879539">nil</span><span class="op" id="2879542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879546">template</span><span class="op" id="2879554">.</span><span class="ident" id="2879555">New</span><span class="op" id="2879558">(</span><span class="ident" id="2879559">name</span><span class="op" id="2879563">)</span><span class="op" id="2879564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879568">nil</span><span class="op" id="2879571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879575">&amp;</span><span class="ident" id="2879576">nameSpace</span><span class="op" id="2879585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879590">set</span><span class="op" id="2879593">:</span>&nbsp;<span class="builtinfunc" id="2879595">make</span><span class="op" id="2879599">(</span><span class="keyword" id="2879600">map</span><span class="op" id="2879603">[</span><span class="builtintype" id="2879604">string</span><span class="op" id="2879610">]</span><span class="op" id="2879611">*</span><span class="ident" id="2879612">Template</span><span class="op" id="2879620">)</span><span class="op" id="2879621">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879625">}</span><span class="op" id="2879626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879632">tmpl</span><span class="op" id="2879636">.</span><span class="ident" id="2879637">set</span><span class="op" id="2879640">[</span><span class="ident" id="2879641">name</span><span class="op" id="2879645">]</span>&nbsp;<span class="op" id="2879647">=</span>&nbsp;<span class="ident" id="2879649">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879655">return</span>&nbsp;<span class="ident" id="2879662">tmpl</span><br>
<span class="lineno"></span><span class="op" id="2879667">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="2879670">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2879737">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="2879808">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="2879877">func</span>&nbsp;<span class="op" id="2879882">(</span><span class="ident" id="2879883">t</span>&nbsp;<span class="op" id="2879885">*</span><span class="ident" id="2879886">Template</span><span class="op" id="2879894">)</span>&nbsp;<span class="ident" id="2879896">New</span><span class="op" id="2879899">(</span><span class="ident" id="2879900">name</span>&nbsp;<span class="builtintype" id="2879905">string</span><span class="op" id="2879911">)</span>&nbsp;<span class="op" id="2879913">*</span><span class="ident" id="2879914">Template</span>&nbsp;<span class="op" id="2879923">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879926">t</span><span class="op" id="2879927">.</span><span class="ident" id="2879928">nameSpace</span><span class="op" id="2879937">.</span><span class="ident" id="2879938">mu</span><span class="op" id="2879940">.</span><span class="ident" id="2879941">Lock</span><span class="op" id="2879945">(</span><span class="op" id="2879946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879949">defer</span>&nbsp;<span class="ident" id="2879955">t</span><span class="op" id="2879956">.</span><span class="ident" id="2879957">nameSpace</span><span class="op" id="2879966">.</span><span class="ident" id="2879967">mu</span><span class="op" id="2879969">.</span><span class="ident" id="2879970">Unlock</span><span class="op" id="2879976">(</span><span class="op" id="2879977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879980">return</span>&nbsp;<span class="ident" id="2879987">t</span><span class="op" id="2879988">.</span><span class="builtinfunc" id="2879989">new</span><span class="op" id="2879992">(</span><span class="ident" id="2879993">name</span><span class="op" id="2879997">)</span><br>
<span class="lineno"></span><span class="op" id="2879999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2880002">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="2880057">func</span>&nbsp;<span class="op" id="2880062">(</span><span class="ident" id="2880063">t</span>&nbsp;<span class="op" id="2880065">*</span><span class="ident" id="2880066">Template</span><span class="op" id="2880074">)</span>&nbsp;<span class="builtinfunc" id="2880076">new</span><span class="op" id="2880079">(</span><span class="ident" id="2880080">name</span>&nbsp;<span class="builtintype" id="2880085">string</span><span class="op" id="2880091">)</span>&nbsp;<span class="op" id="2880093">*</span><span class="ident" id="2880094">Template</span>&nbsp;<span class="op" id="2880103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880106">tmpl</span>&nbsp;<span class="op" id="2880111">:=</span>&nbsp;<span class="op" id="2880114">&amp;</span><span class="ident" id="2880115">Template</span><span class="op" id="2880123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880127">nil</span><span class="op" id="2880130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880134">t</span><span class="op" id="2880135">.</span><span class="ident" id="2880136">text</span><span class="op" id="2880140">.</span><span class="ident" id="2880141">New</span><span class="op" id="2880144">(</span><span class="ident" id="2880145">name</span><span class="op" id="2880149">)</span><span class="op" id="2880150">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880154">nil</span><span class="op" id="2880157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880161">t</span><span class="op" id="2880162">.</span><span class="ident" id="2880163">nameSpace</span><span class="op" id="2880172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880178">tmpl</span><span class="op" id="2880182">.</span><span class="ident" id="2880183">set</span><span class="op" id="2880186">[</span><span class="ident" id="2880187">name</span><span class="op" id="2880191">]</span>&nbsp;<span class="op" id="2880193">=</span>&nbsp;<span class="ident" id="2880195">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880201">return</span>&nbsp;<span class="ident" id="2880208">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="2880213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2880216">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="2880258">func</span>&nbsp;<span class="op" id="2880263">(</span><span class="ident" id="2880264">t</span>&nbsp;<span class="op" id="2880266">*</span><span class="ident" id="2880267">Template</span><span class="op" id="2880275">)</span>&nbsp;<span class="ident" id="2880277">Name</span><span class="op" id="2880281">(</span><span class="op" id="2880282">)</span>&nbsp;<span class="builtintype" id="2880284">string</span>&nbsp;<span class="op" id="2880291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880294">return</span>&nbsp;<span class="ident" id="2880301">t</span><span class="op" id="2880302">.</span><span class="ident" id="2880303">text</span><span class="op" id="2880307">.</span><span class="ident" id="2880308">Name</span><span class="op" id="2880312">(</span><span class="op" id="2880313">)</span><br>
<span class="lineno">260</span><span class="op" id="2880315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2880318">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2880387">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="2880462">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="2880536">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="2880612">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="2880689">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="2880762">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2880782">type</span>&nbsp;<span class="ident" id="2880787">FuncMap</span>&nbsp;<span class="keyword" id="2880795">map</span><span class="op" id="2880798">[</span><span class="builtintype" id="2880799">string</span><span class="op" id="2880805">]</span><span class="keyword" id="2880806">interface</span><span class="op" id="2880815">{</span><span class="op" id="2880816">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2880819">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="2880898">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="2880975">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="2881050">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="2881101">func</span>&nbsp;<span class="op" id="2881106">(</span><span class="ident" id="2881107">t</span>&nbsp;<span class="op" id="2881109">*</span><span class="ident" id="2881110">Template</span><span class="op" id="2881118">)</span>&nbsp;<span class="ident" id="2881120">Funcs</span><span class="op" id="2881125">(</span><span class="ident" id="2881126">funcMap</span>&nbsp;<span class="ident" id="2881134">FuncMap</span><span class="op" id="2881141">)</span>&nbsp;<span class="op" id="2881143">*</span><span class="ident" id="2881144">Template</span>&nbsp;<span class="op" id="2881153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881156">t</span><span class="op" id="2881157">.</span><span class="ident" id="2881158">text</span><span class="op" id="2881162">.</span><span class="ident" id="2881163">Funcs</span><span class="op" id="2881168">(</span><span class="ident" id="2881169">template</span><span class="op" id="2881177">.</span><span class="ident" id="2881178">FuncMap</span><span class="op" id="2881185">(</span><span class="ident" id="2881186">funcMap</span><span class="op" id="2881193">)</span><span class="op" id="2881194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881197">return</span>&nbsp;<span class="ident" id="2881204">t</span><br>
<span class="lineno"></span><span class="op" id="2881206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="2881209">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2881286">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="2881358">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2881434">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="2881470">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="2881532">func</span>&nbsp;<span class="op" id="2881537">(</span><span class="ident" id="2881538">t</span>&nbsp;<span class="op" id="2881540">*</span><span class="ident" id="2881541">Template</span><span class="op" id="2881549">)</span>&nbsp;<span class="ident" id="2881551">Delims</span><span class="op" id="2881557">(</span><span class="ident" id="2881558">left</span><span class="op" id="2881562">,</span>&nbsp;<span class="ident" id="2881564">right</span>&nbsp;<span class="builtintype" id="2881570">string</span><span class="op" id="2881576">)</span>&nbsp;<span class="op" id="2881578">*</span><span class="ident" id="2881579">Template</span>&nbsp;<span class="op" id="2881588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881591">t</span><span class="op" id="2881592">.</span><span class="ident" id="2881593">text</span><span class="op" id="2881597">.</span><span class="ident" id="2881598">Delims</span><span class="op" id="2881604">(</span><span class="ident" id="2881605">left</span><span class="op" id="2881609">,</span>&nbsp;<span class="ident" id="2881611">right</span><span class="op" id="2881616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881619">return</span>&nbsp;<span class="ident" id="2881626">t</span><br>
<span class="lineno"></span><span class="op" id="2881628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="2881631">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="2881709">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="2881749">func</span>&nbsp;<span class="op" id="2881754">(</span><span class="ident" id="2881755">t</span>&nbsp;<span class="op" id="2881757">*</span><span class="ident" id="2881758">Template</span><span class="op" id="2881766">)</span>&nbsp;<span class="ident" id="2881768">Lookup</span><span class="op" id="2881774">(</span><span class="ident" id="2881775">name</span>&nbsp;<span class="builtintype" id="2881780">string</span><span class="op" id="2881786">)</span>&nbsp;<span class="op" id="2881788">*</span><span class="ident" id="2881789">Template</span>&nbsp;<span class="op" id="2881798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881801">t</span><span class="op" id="2881802">.</span><span class="ident" id="2881803">nameSpace</span><span class="op" id="2881812">.</span><span class="ident" id="2881813">mu</span><span class="op" id="2881815">.</span><span class="ident" id="2881816">Lock</span><span class="op" id="2881820">(</span><span class="op" id="2881821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881824">defer</span>&nbsp;<span class="ident" id="2881830">t</span><span class="op" id="2881831">.</span><span class="ident" id="2881832">nameSpace</span><span class="op" id="2881841">.</span><span class="ident" id="2881842">mu</span><span class="op" id="2881844">.</span><span class="ident" id="2881845">Unlock</span><span class="op" id="2881851">(</span><span class="op" id="2881852">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881855">return</span>&nbsp;<span class="ident" id="2881862">t</span><span class="op" id="2881863">.</span><span class="ident" id="2881864">set</span><span class="op" id="2881867">[</span><span class="ident" id="2881868">name</span><span class="op" id="2881872">]</span><br>
<span class="lineno"></span><span class="op" id="2881874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2881877">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2881958">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="2882048">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2882059">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="2882120">func</span>&nbsp;<span class="ident" id="2882125">Must</span><span class="op" id="2882129">(</span><span class="ident" id="2882130">t</span>&nbsp;<span class="op" id="2882132">*</span><span class="ident" id="2882133">Template</span><span class="op" id="2882141">,</span>&nbsp;<span class="ident" id="2882143">err</span>&nbsp;<span class="builtintype" id="2882147">error</span><span class="op" id="2882152">)</span>&nbsp;<span class="op" id="2882154">*</span><span class="ident" id="2882155">Template</span>&nbsp;<span class="op" id="2882164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882167">if</span>&nbsp;<span class="ident" id="2882170">err</span>&nbsp;<span class="op" id="2882174">!=</span>&nbsp;<span class="ident" id="2882177">nil</span>&nbsp;<span class="op" id="2882181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2882185">panic</span><span class="op" id="2882190">(</span><span class="ident" id="2882191">err</span><span class="op" id="2882194">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882200">return</span>&nbsp;<span class="ident" id="2882207">t</span><br>
<span class="lineno"></span><span class="op" id="2882209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2882212">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="2882290">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2882369">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2882442">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2882514">func</span>&nbsp;<span class="ident" id="2882519">ParseFiles</span><span class="op" id="2882529">(</span><span class="ident" id="2882530">filenames</span>&nbsp;<span class="op" id="2882540">...</span><span class="builtintype" id="2882543">string</span><span class="op" id="2882549">)</span>&nbsp;<span class="op" id="2882551">(</span><span class="op" id="2882552">*</span><span class="ident" id="2882553">Template</span><span class="op" id="2882561">,</span>&nbsp;<span class="builtintype" id="2882563">error</span><span class="op" id="2882568">)</span>&nbsp;<span class="op" id="2882570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882573">return</span>&nbsp;<span class="ident" id="2882580">parseFiles</span><span class="op" id="2882590">(</span><span class="ident" id="2882591">nil</span><span class="op" id="2882594">,</span>&nbsp;<span class="ident" id="2882596">filenames</span><span class="op" id="2882605">...</span><span class="op" id="2882608">)</span><br>
<span class="lineno">315</span><span class="op" id="2882610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2882613">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2882694">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="2882768">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="2882823">func</span>&nbsp;<span class="op" id="2882828">(</span><span class="ident" id="2882829">t</span>&nbsp;<span class="op" id="2882831">*</span><span class="ident" id="2882832">Template</span><span class="op" id="2882840">)</span>&nbsp;<span class="ident" id="2882842">ParseFiles</span><span class="op" id="2882852">(</span><span class="ident" id="2882853">filenames</span>&nbsp;<span class="op" id="2882863">...</span><span class="builtintype" id="2882866">string</span><span class="op" id="2882872">)</span>&nbsp;<span class="op" id="2882874">(</span><span class="op" id="2882875">*</span><span class="ident" id="2882876">Template</span><span class="op" id="2882884">,</span>&nbsp;<span class="builtintype" id="2882886">error</span><span class="op" id="2882891">)</span>&nbsp;<span class="op" id="2882893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882896">return</span>&nbsp;<span class="ident" id="2882903">parseFiles</span><span class="op" id="2882913">(</span><span class="ident" id="2882914">t</span><span class="op" id="2882915">,</span>&nbsp;<span class="ident" id="2882917">filenames</span><span class="op" id="2882926">...</span><span class="op" id="2882929">)</span><br>
<span class="lineno"></span><span class="op" id="2882931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2882934">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="2883007">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="2883062">func</span>&nbsp;<span class="ident" id="2883067">parseFiles</span><span class="op" id="2883077">(</span><span class="ident" id="2883078">t</span>&nbsp;<span class="op" id="2883080">*</span><span class="ident" id="2883081">Template</span><span class="op" id="2883089">,</span>&nbsp;<span class="ident" id="2883091">filenames</span>&nbsp;<span class="op" id="2883101">...</span><span class="builtintype" id="2883104">string</span><span class="op" id="2883110">)</span>&nbsp;<span class="op" id="2883112">(</span><span class="op" id="2883113">*</span><span class="ident" id="2883114">Template</span><span class="op" id="2883122">,</span>&nbsp;<span class="builtintype" id="2883124">error</span><span class="op" id="2883129">)</span>&nbsp;<span class="op" id="2883131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883134">if</span>&nbsp;<span class="builtinfunc" id="2883137">len</span><span class="op" id="2883140">(</span><span class="ident" id="2883141">filenames</span><span class="op" id="2883150">)</span>&nbsp;<span class="op" id="2883152">==</span>&nbsp;<span class="num" id="2883155">0</span>&nbsp;<span class="op" id="2883157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883161">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883207">return</span>&nbsp;<span class="ident" id="2883214">nil</span><span class="op" id="2883217">,</span>&nbsp;<span class="ident" id="2883219">fmt</span><span class="op" id="2883222">.</span><span class="ident" id="2883223">Errorf</span><span class="op" id="2883229">(</span><span class="string" id="2883230">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="2883283">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883289">for</span>&nbsp;<span class="ident" id="2883293">_</span><span class="op" id="2883294">,</span>&nbsp;<span class="ident" id="2883296">filename</span>&nbsp;<span class="op" id="2883305">:=</span>&nbsp;<span class="keyword" id="2883308">range</span>&nbsp;<span class="ident" id="2883314">filenames</span>&nbsp;<span class="op" id="2883324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883328">b</span><span class="op" id="2883329">,</span>&nbsp;<span class="ident" id="2883331">err</span>&nbsp;<span class="op" id="2883335">:=</span>&nbsp;<span class="ident" id="2883338">ioutil</span><span class="op" id="2883344">.</span><span class="ident" id="2883345">ReadFile</span><span class="op" id="2883353">(</span><span class="ident" id="2883354">filename</span><span class="op" id="2883362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883366">if</span>&nbsp;<span class="ident" id="2883369">err</span>&nbsp;<span class="op" id="2883373">!=</span>&nbsp;<span class="ident" id="2883376">nil</span>&nbsp;<span class="op" id="2883380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883385">return</span>&nbsp;<span class="ident" id="2883392">nil</span><span class="op" id="2883395">,</span>&nbsp;<span class="ident" id="2883397">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883407">s</span>&nbsp;<span class="op" id="2883409">:=</span>&nbsp;<span class="builtintype" id="2883412">string</span><span class="op" id="2883418">(</span><span class="ident" id="2883419">b</span><span class="op" id="2883420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883424">name</span>&nbsp;<span class="op" id="2883429">:=</span>&nbsp;<span class="ident" id="2883432">filepath</span><span class="op" id="2883440">.</span><span class="ident" id="2883441">Base</span><span class="op" id="2883445">(</span><span class="ident" id="2883446">filename</span><span class="op" id="2883454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883458">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883523">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883586">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883656">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883707">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883761">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883827">var</span>&nbsp;<span class="ident" id="2883831">tmpl</span>&nbsp;<span class="op" id="2883836">*</span><span class="ident" id="2883837">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883848">if</span>&nbsp;<span class="ident" id="2883851">t</span>&nbsp;<span class="op" id="2883853">==</span>&nbsp;<span class="ident" id="2883856">nil</span>&nbsp;<span class="op" id="2883860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883865">t</span>&nbsp;<span class="op" id="2883867">=</span>&nbsp;<span class="ident" id="2883869">New</span><span class="op" id="2883872">(</span><span class="ident" id="2883873">name</span><span class="op" id="2883877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883885">if</span>&nbsp;<span class="ident" id="2883888">name</span>&nbsp;<span class="op" id="2883893">==</span>&nbsp;<span class="ident" id="2883896">t</span><span class="op" id="2883897">.</span><span class="ident" id="2883898">Name</span><span class="op" id="2883902">(</span><span class="op" id="2883903">)</span>&nbsp;<span class="op" id="2883905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883910">tmpl</span>&nbsp;<span class="op" id="2883915">=</span>&nbsp;<span class="ident" id="2883917">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883921">}</span>&nbsp;<span class="keyword" id="2883923">else</span>&nbsp;<span class="op" id="2883928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883933">tmpl</span>&nbsp;<span class="op" id="2883938">=</span>&nbsp;<span class="ident" id="2883940">t</span><span class="op" id="2883941">.</span><span class="ident" id="2883942">New</span><span class="op" id="2883945">(</span><span class="ident" id="2883946">name</span><span class="op" id="2883950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883958">_</span><span class="op" id="2883959">,</span>&nbsp;<span class="ident" id="2883961">err</span>&nbsp;<span class="op" id="2883965">=</span>&nbsp;<span class="ident" id="2883967">tmpl</span><span class="op" id="2883971">.</span><span class="ident" id="2883972">Parse</span><span class="op" id="2883977">(</span><span class="ident" id="2883978">s</span><span class="op" id="2883979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883983">if</span>&nbsp;<span class="ident" id="2883986">err</span>&nbsp;<span class="op" id="2883990">!=</span>&nbsp;<span class="ident" id="2883993">nil</span>&nbsp;<span class="op" id="2883997">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884002">return</span>&nbsp;<span class="ident" id="2884009">nil</span><span class="op" id="2884012">,</span>&nbsp;<span class="ident" id="2884014">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884026">return</span>&nbsp;<span class="ident" id="2884033">t</span><span class="op" id="2884034">,</span>&nbsp;<span class="ident" id="2884036">nil</span><br>
<span class="lineno"></span><span class="op" id="2884040">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="2884043">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2884124">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2884200">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2884276">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="2884349">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="2884410">func</span>&nbsp;<span class="ident" id="2884415">ParseGlob</span><span class="op" id="2884424">(</span><span class="ident" id="2884425">pattern</span>&nbsp;<span class="builtintype" id="2884433">string</span><span class="op" id="2884439">)</span>&nbsp;<span class="op" id="2884441">(</span><span class="op" id="2884442">*</span><span class="ident" id="2884443">Template</span><span class="op" id="2884451">,</span>&nbsp;<span class="builtintype" id="2884453">error</span><span class="op" id="2884458">)</span>&nbsp;<span class="op" id="2884460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884463">return</span>&nbsp;<span class="ident" id="2884470">parseGlob</span><span class="op" id="2884479">(</span><span class="ident" id="2884480">nil</span><span class="op" id="2884483">,</span>&nbsp;<span class="ident" id="2884485">pattern</span><span class="op" id="2884492">)</span><br>
<span class="lineno"></span><span class="op" id="2884494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="2884497">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2884573">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2884646">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2884723">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2884799">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="2884811">func</span>&nbsp;<span class="op" id="2884816">(</span><span class="ident" id="2884817">t</span>&nbsp;<span class="op" id="2884819">*</span><span class="ident" id="2884820">Template</span><span class="op" id="2884828">)</span>&nbsp;<span class="ident" id="2884830">ParseGlob</span><span class="op" id="2884839">(</span><span class="ident" id="2884840">pattern</span>&nbsp;<span class="builtintype" id="2884848">string</span><span class="op" id="2884854">)</span>&nbsp;<span class="op" id="2884856">(</span><span class="op" id="2884857">*</span><span class="ident" id="2884858">Template</span><span class="op" id="2884866">,</span>&nbsp;<span class="builtintype" id="2884868">error</span><span class="op" id="2884873">)</span>&nbsp;<span class="op" id="2884875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884878">return</span>&nbsp;<span class="ident" id="2884885">parseGlob</span><span class="op" id="2884894">(</span><span class="ident" id="2884895">t</span><span class="op" id="2884896">,</span>&nbsp;<span class="ident" id="2884898">pattern</span><span class="op" id="2884905">)</span><br>
<span class="lineno"></span><span class="op" id="2884907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2884910">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="2884983">func</span>&nbsp;<span class="ident" id="2884988">parseGlob</span><span class="op" id="2884997">(</span><span class="ident" id="2884998">t</span>&nbsp;<span class="op" id="2885000">*</span><span class="ident" id="2885001">Template</span><span class="op" id="2885009">,</span>&nbsp;<span class="ident" id="2885011">pattern</span>&nbsp;<span class="builtintype" id="2885019">string</span><span class="op" id="2885025">)</span>&nbsp;<span class="op" id="2885027">(</span><span class="op" id="2885028">*</span><span class="ident" id="2885029">Template</span><span class="op" id="2885037">,</span>&nbsp;<span class="builtintype" id="2885039">error</span><span class="op" id="2885044">)</span>&nbsp;<span class="op" id="2885046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885049">filenames</span><span class="op" id="2885058">,</span>&nbsp;<span class="ident" id="2885060">err</span>&nbsp;<span class="op" id="2885064">:=</span>&nbsp;<span class="ident" id="2885067">filepath</span><span class="op" id="2885075">.</span><span class="ident" id="2885076">Glob</span><span class="op" id="2885080">(</span><span class="ident" id="2885081">pattern</span><span class="op" id="2885088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885091">if</span>&nbsp;<span class="ident" id="2885094">err</span>&nbsp;<span class="op" id="2885098">!=</span>&nbsp;<span class="ident" id="2885101">nil</span>&nbsp;<span class="op" id="2885105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885109">return</span>&nbsp;<span class="ident" id="2885116">nil</span><span class="op" id="2885119">,</span>&nbsp;<span class="ident" id="2885121">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885126">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885129">if</span>&nbsp;<span class="builtinfunc" id="2885132">len</span><span class="op" id="2885135">(</span><span class="ident" id="2885136">filenames</span><span class="op" id="2885145">)</span>&nbsp;<span class="op" id="2885147">==</span>&nbsp;<span class="num" id="2885150">0</span>&nbsp;<span class="op" id="2885152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885156">return</span>&nbsp;<span class="ident" id="2885163">nil</span><span class="op" id="2885166">,</span>&nbsp;<span class="ident" id="2885168">fmt</span><span class="op" id="2885171">.</span><span class="ident" id="2885172">Errorf</span><span class="op" id="2885178">(</span><span class="string" id="2885179">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="2885225">,</span>&nbsp;<span class="ident" id="2885227">pattern</span><span class="op" id="2885234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885240">return</span>&nbsp;<span class="ident" id="2885247">parseFiles</span><span class="op" id="2885257">(</span><span class="ident" id="2885258">t</span><span class="op" id="2885259">,</span>&nbsp;<span class="ident" id="2885261">filenames</span><span class="op" id="2885270">...</span><span class="op" id="2885273">)</span><br>
<span class="lineno"></span><span class="op" id="2885275">}</span>
</div>
</body>
</html>
