<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html" class="current">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4411751">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4411806">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4411860">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4411911">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4411935">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4411990">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4412043">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4412099">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412133">package</span>&nbsp;<span class="ident" id="4412141">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4412149">type</span>&nbsp;<span class="ident" id="4412154">ctr</span>&nbsp;<span class="keyword" id="4412158">struct</span>&nbsp;<span class="op" id="4412165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412168">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412176"><a href="/gostd/crypto/cipher/cipher.go.html#4410698">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412183">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412191">[</span><span class="op" id="4412192">]</span><span class="builtintype" id="4412193">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412199">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412207">[</span><span class="op" id="4412208">]</span><span class="builtintype" id="4412209">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412215">outUsed</span>&nbsp;<span class="builtintype" id="4412223">int</span><br>
<span class="lineno">20</span><span class="op" id="4412227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412230">const</span>&nbsp;<span class="ident" id="4412236">streamBufferSize</span>&nbsp;<span class="op" id="4412253">=</span>&nbsp;<span class="num" id="4412255">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412260">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="4412336">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="4412414">func</span>&nbsp;<span class="ident" id="4412419">NewCTR</span><span class="op" id="4412425">(</span><span class="ident" id="4412426">block</span>&nbsp;<span class="ident" id="4412432"><a href="/gostd/crypto/cipher/cipher.go.html#4410698">Block</a></span><span class="op" id="4412437">,</span>&nbsp;<span class="ident" id="4412439">iv</span>&nbsp;<span class="op" id="4412442">[</span><span class="op" id="4412443">]</span><span class="builtintype" id="4412444">byte</span><span class="op" id="4412448">)</span>&nbsp;<span class="ident" id="4412450"><a href="/gostd/crypto/cipher/cipher.go.html#4411082">Stream</a></span>&nbsp;<span class="op" id="4412457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412460">if</span>&nbsp;<span class="builtinfunc" id="4412463">len</span><span class="op" id="4412466">(</span><span class="ident" id="4412467"><a href="/gostd/crypto/cipher/ctr.go.html#4412439">iv</a></span><span class="op" id="4412469">)</span>&nbsp;<span class="op" id="4412471">!=</span>&nbsp;<span class="ident" id="4412474"><a href="/gostd/crypto/cipher/ctr.go.html#4412426">block</a></span><span class="op" id="4412479">.</span><span class="ident" id="4412480"><a href="/gostd/crypto/cipher/cipher.go.html#4410764">BlockSize</a></span><span class="op" id="4412489">(</span><span class="op" id="4412490">)</span>&nbsp;<span class="op" id="4412492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4412496">panic</span><span class="op" id="4412501">(</span><span class="string" id="4412502">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="4412550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412553">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412556">bufSize</span>&nbsp;<span class="op" id="4412564">:=</span>&nbsp;<span class="ident" id="4412567"><a href="/gostd/crypto/cipher/ctr.go.html#4412236">streamBufferSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412585">if</span>&nbsp;<span class="ident" id="4412588"><a href="/gostd/crypto/cipher/ctr.go.html#4412556">bufSize</a></span>&nbsp;<span class="op" id="4412596">&lt;</span>&nbsp;<span class="ident" id="4412598"><a href="/gostd/crypto/cipher/ctr.go.html#4412426">block</a></span><span class="op" id="4412603">.</span><span class="ident" id="4412604"><a href="/gostd/crypto/cipher/cipher.go.html#4410764">BlockSize</a></span><span class="op" id="4412613">(</span><span class="op" id="4412614">)</span>&nbsp;<span class="op" id="4412616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412620"><a href="/gostd/crypto/cipher/ctr.go.html#4412556">bufSize</a></span>&nbsp;<span class="op" id="4412628">=</span>&nbsp;<span class="ident" id="4412630"><a href="/gostd/crypto/cipher/ctr.go.html#4412426">block</a></span><span class="op" id="4412635">.</span><span class="ident" id="4412636"><a href="/gostd/crypto/cipher/cipher.go.html#4410764">BlockSize</a></span><span class="op" id="4412645">(</span><span class="op" id="4412646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412652">return</span>&nbsp;<span class="op" id="4412659">&amp;</span><span class="ident" id="4412660"><a href="/gostd/crypto/cipher/ctr.go.html#4412154">ctr</a></span><span class="op" id="4412663">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412667"><a href="/gostd/crypto/cipher/ctr.go.html#4412168">b</a></span><span class="op" id="4412668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412676"><a href="/gostd/crypto/cipher/ctr.go.html#4412426">block</a></span><span class="op" id="4412681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412685"><a href="/gostd/crypto/cipher/ctr.go.html#4412183">ctr</a></span><span class="op" id="4412688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412694"><a href="/gostd/crypto/cipher/cipher.go.html#4411676">dup</a></span><span class="op" id="4412697">(</span><span class="ident" id="4412698"><a href="/gostd/crypto/cipher/ctr.go.html#4412439">iv</a></span><span class="op" id="4412700">)</span><span class="op" id="4412701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412705"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4412714">make</span><span class="op" id="4412718">(</span><span class="op" id="4412719">[</span><span class="op" id="4412720">]</span><span class="builtintype" id="4412721">byte</span><span class="op" id="4412725">,</span>&nbsp;<span class="num" id="4412727">0</span><span class="op" id="4412728">,</span>&nbsp;<span class="ident" id="4412730"><a href="/gostd/crypto/cipher/ctr.go.html#4412556">bufSize</a></span><span class="op" id="4412737">)</span><span class="op" id="4412738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412742"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span><span class="op" id="4412749">:</span>&nbsp;<span class="num" id="4412751">0</span><span class="op" id="4412752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412755">}</span><br>
<span class="lineno">40</span><span class="op" id="4412757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412760">func</span>&nbsp;<span class="op" id="4412765">(</span><span class="ident" id="4412766">x</span>&nbsp;<span class="op" id="4412768">*</span><span class="ident" id="4412769"><a href="/gostd/crypto/cipher/ctr.go.html#4412154">ctr</a></span><span class="op" id="4412772">)</span>&nbsp;<span class="ident" id="4412774">refill</span><span class="op" id="4412780">(</span><span class="op" id="4412781">)</span>&nbsp;<span class="op" id="4412783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412786">remain</span>&nbsp;<span class="op" id="4412793">:=</span>&nbsp;<span class="builtinfunc" id="4412796">len</span><span class="op" id="4412799">(</span><span class="ident" id="4412800"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412801">.</span><span class="ident" id="4412802"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412805">)</span>&nbsp;<span class="op" id="4412807">-</span>&nbsp;<span class="ident" id="4412809"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412810">.</span><span class="ident" id="4412811"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412820">if</span>&nbsp;<span class="ident" id="4412823"><a href="/gostd/crypto/cipher/ctr.go.html#4412786">remain</a></span>&nbsp;<span class="op" id="4412830">&gt;</span>&nbsp;<span class="ident" id="4412832"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412833">.</span><span class="ident" id="4412834"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span>&nbsp;<span class="op" id="4412842">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412846">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4412857">copy</span><span class="op" id="4412861">(</span><span class="ident" id="4412862"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412863">.</span><span class="ident" id="4412864"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412867">,</span>&nbsp;<span class="ident" id="4412869"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412870">.</span><span class="ident" id="4412871"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412874">[</span><span class="ident" id="4412875"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412876">.</span><span class="ident" id="4412877"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span><span class="op" id="4412884">:</span><span class="op" id="4412885">]</span><span class="op" id="4412886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412889"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412890">.</span><span class="ident" id="4412891"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span>&nbsp;<span class="op" id="4412895">=</span>&nbsp;<span class="ident" id="4412897"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412898">.</span><span class="ident" id="4412899"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412902">[</span><span class="op" id="4412903">:</span><span class="builtinfunc" id="4412904">cap</span><span class="op" id="4412907">(</span><span class="ident" id="4412908"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412909">.</span><span class="ident" id="4412910"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412913">)</span><span class="op" id="4412914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412917">bs</span>&nbsp;<span class="op" id="4412920">:=</span>&nbsp;<span class="ident" id="4412923"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412924">.</span><span class="ident" id="4412925"><a href="/gostd/crypto/cipher/ctr.go.html#4412168">b</a></span><span class="op" id="4412926">.</span><span class="ident" id="4412927"><a href="/gostd/crypto/cipher/cipher.go.html#4410764">BlockSize</a></span><span class="op" id="4412936">(</span><span class="op" id="4412937">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412940">for</span>&nbsp;<span class="ident" id="4412944"><a href="/gostd/crypto/cipher/ctr.go.html#4412786">remain</a></span>&nbsp;<span class="op" id="4412951">&lt;</span>&nbsp;<span class="builtinfunc" id="4412953">len</span><span class="op" id="4412956">(</span><span class="ident" id="4412957"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412958">.</span><span class="ident" id="4412959"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412962">)</span><span class="op" id="4412963">-</span><span class="ident" id="4412964"><a href="/gostd/crypto/cipher/ctr.go.html#4412917">bs</a></span>&nbsp;<span class="op" id="4412967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412971"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412972">.</span><span class="ident" id="4412973"><a href="/gostd/crypto/cipher/ctr.go.html#4412168">b</a></span><span class="op" id="4412974">.</span><span class="ident" id="4412975"><a href="/gostd/crypto/cipher/cipher.go.html#4410882">Encrypt</a></span><span class="op" id="4412982">(</span><span class="ident" id="4412983"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4412984">.</span><span class="ident" id="4412985"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4412988">[</span><span class="ident" id="4412989"><a href="/gostd/crypto/cipher/ctr.go.html#4412786">remain</a></span><span class="op" id="4412995">:</span><span class="op" id="4412996">]</span><span class="op" id="4412997">,</span>&nbsp;<span class="ident" id="4412999"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413000">.</span><span class="ident" id="4413001"><a href="/gostd/crypto/cipher/ctr.go.html#4412183">ctr</a></span><span class="op" id="4413004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413008"><a href="/gostd/crypto/cipher/ctr.go.html#4412786">remain</a></span>&nbsp;<span class="op" id="4413015">+=</span>&nbsp;<span class="ident" id="4413018"><a href="/gostd/crypto/cipher/ctr.go.html#4412917">bs</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413024">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413047">for</span>&nbsp;<span class="ident" id="4413051">i</span>&nbsp;<span class="op" id="4413053">:=</span>&nbsp;<span class="builtinfunc" id="4413056">len</span><span class="op" id="4413059">(</span><span class="ident" id="4413060"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413061">.</span><span class="ident" id="4413062"><a href="/gostd/crypto/cipher/ctr.go.html#4412183">ctr</a></span><span class="op" id="4413065">)</span>&nbsp;<span class="op" id="4413067">-</span>&nbsp;<span class="num" id="4413069">1</span><span class="op" id="4413070">;</span>&nbsp;<span class="ident" id="4413072"><a href="/gostd/crypto/cipher/ctr.go.html#4413051">i</a></span>&nbsp;<span class="op" id="4413074">&gt;=</span>&nbsp;<span class="num" id="4413077">0</span><span class="op" id="4413078">;</span>&nbsp;<span class="ident" id="4413080"><a href="/gostd/crypto/cipher/ctr.go.html#4413051">i</a></span><span class="op" id="4413081">--</span>&nbsp;<span class="op" id="4413084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413089"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413090">.</span><span class="ident" id="4413091"><a href="/gostd/crypto/cipher/ctr.go.html#4412183">ctr</a></span><span class="op" id="4413094">[</span><span class="ident" id="4413095"><a href="/gostd/crypto/cipher/ctr.go.html#4413051">i</a></span><span class="op" id="4413096">]</span><span class="op" id="4413097">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413103">if</span>&nbsp;<span class="ident" id="4413106"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413107">.</span><span class="ident" id="4413108"><a href="/gostd/crypto/cipher/ctr.go.html#4412183">ctr</a></span><span class="op" id="4413111">[</span><span class="ident" id="4413112"><a href="/gostd/crypto/cipher/ctr.go.html#4413051">i</a></span><span class="op" id="4413113">]</span>&nbsp;<span class="op" id="4413115">!=</span>&nbsp;<span class="num" id="4413118">0</span>&nbsp;<span class="op" id="4413120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413126">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413135">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413145"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413146">.</span><span class="ident" id="4413147"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span>&nbsp;<span class="op" id="4413151">=</span>&nbsp;<span class="ident" id="4413153"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413154">.</span><span class="ident" id="4413155"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4413158">[</span><span class="op" id="4413159">:</span><span class="ident" id="4413160"><a href="/gostd/crypto/cipher/ctr.go.html#4412786">remain</a></span><span class="op" id="4413166">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413169"><a href="/gostd/crypto/cipher/ctr.go.html#4412766">x</a></span><span class="op" id="4413170">.</span><span class="ident" id="4413171"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span>&nbsp;<span class="op" id="4413179">=</span>&nbsp;<span class="num" id="4413181">0</span><br>
<span class="lineno"></span><span class="op" id="4413183">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4413186">func</span>&nbsp;<span class="op" id="4413191">(</span><span class="ident" id="4413192">x</span>&nbsp;<span class="op" id="4413194">*</span><span class="ident" id="4413195"><a href="/gostd/crypto/cipher/ctr.go.html#4412154">ctr</a></span><span class="op" id="4413198">)</span>&nbsp;<span class="ident" id="4413200">XORKeyStream</span><span class="op" id="4413212">(</span><span class="ident" id="4413213">dst</span><span class="op" id="4413216">,</span>&nbsp;<span class="ident" id="4413218">src</span>&nbsp;<span class="op" id="4413222">[</span><span class="op" id="4413223">]</span><span class="builtintype" id="4413224">byte</span><span class="op" id="4413228">)</span>&nbsp;<span class="op" id="4413230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413233">for</span>&nbsp;<span class="builtinfunc" id="4413237">len</span><span class="op" id="4413240">(</span><span class="ident" id="4413241"><a href="/gostd/crypto/cipher/ctr.go.html#4413218">src</a></span><span class="op" id="4413244">)</span>&nbsp;<span class="op" id="4413246">&gt;</span>&nbsp;<span class="num" id="4413248">0</span>&nbsp;<span class="op" id="4413250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413254">if</span>&nbsp;<span class="ident" id="4413257"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413258">.</span><span class="ident" id="4413259"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span>&nbsp;<span class="op" id="4413267">&gt;=</span>&nbsp;<span class="builtinfunc" id="4413270">len</span><span class="op" id="4413273">(</span><span class="ident" id="4413274"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413275">.</span><span class="ident" id="4413276"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4413279">)</span><span class="op" id="4413280">-</span><span class="ident" id="4413281"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413282">.</span><span class="ident" id="4413283"><a href="/gostd/crypto/cipher/ctr.go.html#4412168">b</a></span><span class="op" id="4413284">.</span><span class="ident" id="4413285"><a href="/gostd/crypto/cipher/cipher.go.html#4410764">BlockSize</a></span><span class="op" id="4413294">(</span><span class="op" id="4413295">)</span>&nbsp;<span class="op" id="4413297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413302"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413303">.</span><span class="ident" id="4413304"><a href="/gostd/crypto/cipher/ctr.go.html#4412774">refill</a></span><span class="op" id="4413310">(</span><span class="op" id="4413311">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413319">n</span>&nbsp;<span class="op" id="4413321">:=</span>&nbsp;<span class="ident" id="4413324"><a href="/gostd/crypto/cipher/xor.go.html#4427201">xorBytes</a></span><span class="op" id="4413332">(</span><span class="ident" id="4413333"><a href="/gostd/crypto/cipher/ctr.go.html#4413213">dst</a></span><span class="op" id="4413336">,</span>&nbsp;<span class="ident" id="4413338"><a href="/gostd/crypto/cipher/ctr.go.html#4413218">src</a></span><span class="op" id="4413341">,</span>&nbsp;<span class="ident" id="4413343"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413344">.</span><span class="ident" id="4413345"><a href="/gostd/crypto/cipher/ctr.go.html#4412199">out</a></span><span class="op" id="4413348">[</span><span class="ident" id="4413349"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413350">.</span><span class="ident" id="4413351"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span><span class="op" id="4413358">:</span><span class="op" id="4413359">]</span><span class="op" id="4413360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413364"><a href="/gostd/crypto/cipher/ctr.go.html#4413213">dst</a></span>&nbsp;<span class="op" id="4413368">=</span>&nbsp;<span class="ident" id="4413370"><a href="/gostd/crypto/cipher/ctr.go.html#4413213">dst</a></span><span class="op" id="4413373">[</span><span class="ident" id="4413374"><a href="/gostd/crypto/cipher/ctr.go.html#4413319">n</a></span><span class="op" id="4413375">:</span><span class="op" id="4413376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413380"><a href="/gostd/crypto/cipher/ctr.go.html#4413218">src</a></span>&nbsp;<span class="op" id="4413384">=</span>&nbsp;<span class="ident" id="4413386"><a href="/gostd/crypto/cipher/ctr.go.html#4413218">src</a></span><span class="op" id="4413389">[</span><span class="ident" id="4413390"><a href="/gostd/crypto/cipher/ctr.go.html#4413319">n</a></span><span class="op" id="4413391">:</span><span class="op" id="4413392">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413396"><a href="/gostd/crypto/cipher/ctr.go.html#4413192">x</a></span><span class="op" id="4413397">.</span><span class="ident" id="4413398"><a href="/gostd/crypto/cipher/ctr.go.html#4412215">outUsed</a></span>&nbsp;<span class="op" id="4413406">+=</span>&nbsp;<span class="ident" id="4413409"><a href="/gostd/crypto/cipher/ctr.go.html#4413319">n</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413412">}</span><br>
<span class="lineno"></span><span class="op" id="4413414">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
