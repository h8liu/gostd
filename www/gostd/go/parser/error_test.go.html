<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html" class="current">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8264895">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8264950">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8265004">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8265055">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;a&nbsp;parser&nbsp;test&nbsp;harness.&nbsp;The&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata</span><br>
<span class="lineno"></span><span class="comment" id="8265128">//&nbsp;directory&nbsp;are&nbsp;parsed&nbsp;and&nbsp;the&nbsp;errors&nbsp;reported&nbsp;are&nbsp;compared&nbsp;against&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8265201">//&nbsp;error&nbsp;messages&nbsp;expected&nbsp;in&nbsp;the&nbsp;test&nbsp;files.&nbsp;The&nbsp;test&nbsp;files&nbsp;must&nbsp;end&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="8265274">//&nbsp;.src&nbsp;rather&nbsp;than&nbsp;.go&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;disturbed&nbsp;by&nbsp;gofmt&nbsp;runs.</span><br>
<span class="lineno"></span><span class="comment" id="8265344">//</span><br>
<span class="lineno">10</span><span class="comment" id="8265347">//&nbsp;Expected&nbsp;errors&nbsp;are&nbsp;indicated&nbsp;in&nbsp;the&nbsp;test&nbsp;files&nbsp;by&nbsp;putting&nbsp;a&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="8265419">//&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;immediately&nbsp;following&nbsp;an&nbsp;offending&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="8265493">//&nbsp;The&nbsp;harness&nbsp;will&nbsp;verify&nbsp;that&nbsp;an&nbsp;error&nbsp;matching&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="8265566">//&nbsp;rx&nbsp;is&nbsp;reported&nbsp;at&nbsp;that&nbsp;source&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="8265609">//</span><br>
<span class="lineno">15</span><span class="comment" id="8265612">//&nbsp;For&nbsp;instance,&nbsp;the&nbsp;following&nbsp;test&nbsp;file&nbsp;indicates&nbsp;that&nbsp;a&nbsp;&#34;not&nbsp;declared&#34;</span><br>
<span class="lineno"></span><span class="comment" id="8265685">//&nbsp;error&nbsp;should&nbsp;be&nbsp;reported&nbsp;for&nbsp;the&nbsp;undeclared&nbsp;variable&nbsp;x:</span><br>
<span class="lineno"></span><span class="comment" id="8265744">//</span><br>
<span class="lineno"></span><span class="comment" id="8265747">//&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;p</span><br>
<span class="lineno"></span><span class="comment" id="8265760">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;f()&nbsp;{</span><br>
<span class="lineno">20</span><span class="comment" id="8265774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;=&nbsp;x&nbsp;/*&nbsp;ERROR&nbsp;&#34;not&nbsp;declared&#34;&nbsp;*/&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="8265815">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8265821">package</span>&nbsp;<span class="ident" id="8265829">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8265837">import</span>&nbsp;<span class="op" id="8265844">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265847">&#34;go/scanner&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265861">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265873">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265886">&#34;path/filepath&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265903">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265913">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265924">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8265934">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8265937">const</span>&nbsp;<span class="ident" id="8265943">testdata</span>&nbsp;<span class="op" id="8265952">=</span>&nbsp;<span class="string" id="8265954">&#34;testdata&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8265966">var</span>&nbsp;<span class="ident" id="8265970">fsetErrs</span>&nbsp;<span class="op" id="8265979">=</span>&nbsp;<span class="ident" id="8265981">token</span><span class="op" id="8265986">.</span><span class="ident" id="8265987">NewFileSet</span><span class="op" id="8265997">(</span><span class="op" id="8265998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8266001">//&nbsp;getFile&nbsp;assumes&nbsp;that&nbsp;each&nbsp;filename&nbsp;occurs&nbsp;at&nbsp;most&nbsp;once</span><br>
<span class="lineno">40</span><span class="keyword" id="8266059">func</span>&nbsp;<span class="ident" id="8266064">getFile</span><span class="op" id="8266071">(</span><span class="ident" id="8266072">filename</span>&nbsp;<span class="builtintype" id="8266081">string</span><span class="op" id="8266087">)</span>&nbsp;<span class="op" id="8266089">(</span><span class="ident" id="8266090">file</span>&nbsp;<span class="op" id="8266095">*</span><span class="ident" id="8266096">token</span><span class="op" id="8266101">.</span><span class="ident" id="8266102">File</span><span class="op" id="8266106">)</span>&nbsp;<span class="op" id="8266108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266111">fsetErrs</span><span class="op" id="8266119">.</span><span class="ident" id="8266120">Iterate</span><span class="op" id="8266127">(</span><span class="keyword" id="8266128">func</span><span class="op" id="8266132">(</span><span class="ident" id="8266133">f</span>&nbsp;<span class="op" id="8266135">*</span><span class="ident" id="8266136">token</span><span class="op" id="8266141">.</span><span class="ident" id="8266142">File</span><span class="op" id="8266146">)</span>&nbsp;<span class="builtintype" id="8266148">bool</span>&nbsp;<span class="op" id="8266153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266157">if</span>&nbsp;<span class="ident" id="8266160">f</span><span class="op" id="8266161">.</span><span class="ident" id="8266162">Name</span><span class="op" id="8266166">(</span><span class="op" id="8266167">)</span>&nbsp;<span class="op" id="8266169">==</span>&nbsp;<span class="ident" id="8266172">filename</span>&nbsp;<span class="op" id="8266181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266186">if</span>&nbsp;<span class="ident" id="8266189">file</span>&nbsp;<span class="op" id="8266194">!=</span>&nbsp;<span class="builtintype" id="8266197">nil</span>&nbsp;<span class="op" id="8266201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8266207">panic</span><span class="op" id="8266212">(</span><span class="ident" id="8266213">filename</span>&nbsp;<span class="op" id="8266222">+</span>&nbsp;<span class="string" id="8266224">&#34;&nbsp;used&nbsp;multiple&nbsp;times&#34;</span><span class="op" id="8266246">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266256">file</span>&nbsp;<span class="op" id="8266261">=</span>&nbsp;<span class="ident" id="8266263">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266271">return</span>&nbsp;<span class="builtintype" id="8266278">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266284">}</span><span class="op" id="8266285">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266288">return</span>&nbsp;<span class="ident" id="8266295">file</span><br>
<span class="lineno"></span><span class="op" id="8266300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8266303">func</span>&nbsp;<span class="ident" id="8266308">getPos</span><span class="op" id="8266314">(</span><span class="ident" id="8266315">filename</span>&nbsp;<span class="builtintype" id="8266324">string</span><span class="op" id="8266330">,</span>&nbsp;<span class="ident" id="8266332">offset</span>&nbsp;<span class="builtintype" id="8266339">int</span><span class="op" id="8266342">)</span>&nbsp;<span class="ident" id="8266344">token</span><span class="op" id="8266349">.</span><span class="ident" id="8266350">Pos</span>&nbsp;<span class="op" id="8266354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266357">if</span>&nbsp;<span class="ident" id="8266360">f</span>&nbsp;<span class="op" id="8266362">:=</span>&nbsp;<span class="ident" id="8266365">getFile</span><span class="op" id="8266372">(</span><span class="ident" id="8266373">filename</span><span class="op" id="8266381">)</span><span class="op" id="8266382">;</span>&nbsp;<span class="ident" id="8266384">f</span>&nbsp;<span class="op" id="8266386">!=</span>&nbsp;<span class="builtintype" id="8266389">nil</span>&nbsp;<span class="op" id="8266393">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266397">return</span>&nbsp;<span class="ident" id="8266404">f</span><span class="op" id="8266405">.</span><span class="ident" id="8266406">Pos</span><span class="op" id="8266409">(</span><span class="ident" id="8266410">offset</span><span class="op" id="8266416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266422">return</span>&nbsp;<span class="ident" id="8266429">token</span><span class="op" id="8266434">.</span><span class="ident" id="8266435">NoPos</span><br>
<span class="lineno"></span><span class="op" id="8266441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="8266444">//&nbsp;ERROR&nbsp;comments&nbsp;must&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;and&nbsp;rx&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="8266509">//&nbsp;a&nbsp;regular&nbsp;expression&nbsp;that&nbsp;matches&nbsp;the&nbsp;expected&nbsp;error&nbsp;message.</span><br>
<span class="lineno"></span><span class="comment" id="8266574">//&nbsp;The&nbsp;special&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;HERE&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;must&nbsp;be&nbsp;used&nbsp;for&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="8266639">//&nbsp;messages&nbsp;that&nbsp;appear&nbsp;immediately&nbsp;after&nbsp;a&nbsp;token,&nbsp;rather&nbsp;than&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="8266705">//&nbsp;a&nbsp;token&#39;s&nbsp;position.</span><br>
<span class="lineno">65</span><span class="comment" id="8266728">//</span><br>
<span class="lineno"></span><span class="keyword" id="8266731">var</span>&nbsp;<span class="ident" id="8266735">errRx</span>&nbsp;<span class="op" id="8266741">=</span>&nbsp;<span class="ident" id="8266743">regexp</span><span class="op" id="8266749">.</span><span class="ident" id="8266750">MustCompile</span><span class="op" id="8266761">(</span><span class="string" id="8266762">`^/\*&nbsp;*ERROR&nbsp;*(HERE)?&nbsp;*&#34;([^&#34;]*)&#34;&nbsp;*\*/$`</span><span class="op" id="8266801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8266804">//&nbsp;expectedErrors&nbsp;collects&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;of&nbsp;ERROR&nbsp;comments&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="8266879">//&nbsp;in&nbsp;files&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a&nbsp;map&nbsp;of&nbsp;error&nbsp;positions&nbsp;to&nbsp;error&nbsp;messages.</span><br>
<span class="lineno">70</span><span class="comment" id="8266955">//</span><br>
<span class="lineno"></span><span class="keyword" id="8266958">func</span>&nbsp;<span class="ident" id="8266963">expectedErrors</span><span class="op" id="8266977">(</span><span class="ident" id="8266978">t</span>&nbsp;<span class="op" id="8266980">*</span><span class="ident" id="8266981">testing</span><span class="op" id="8266988">.</span><span class="ident" id="8266989">T</span><span class="op" id="8266990">,</span>&nbsp;<span class="ident" id="8266992">filename</span>&nbsp;<span class="builtintype" id="8267001">string</span><span class="op" id="8267007">,</span>&nbsp;<span class="ident" id="8267009">src</span>&nbsp;<span class="op" id="8267013">[</span><span class="op" id="8267014">]</span><span class="builtintype" id="8267015">byte</span><span class="op" id="8267019">)</span>&nbsp;<span class="keyword" id="8267021">map</span><span class="op" id="8267024">[</span><span class="ident" id="8267025">token</span><span class="op" id="8267030">.</span><span class="ident" id="8267031">Pos</span><span class="op" id="8267034">]</span><span class="builtintype" id="8267035">string</span>&nbsp;<span class="op" id="8267042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267045">errors</span>&nbsp;<span class="op" id="8267052">:=</span>&nbsp;<span class="builtinfunc" id="8267055">make</span><span class="op" id="8267059">(</span><span class="keyword" id="8267060">map</span><span class="op" id="8267063">[</span><span class="ident" id="8267064">token</span><span class="op" id="8267069">.</span><span class="ident" id="8267070">Pos</span><span class="op" id="8267073">]</span><span class="builtintype" id="8267074">string</span><span class="op" id="8267080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267084">var</span>&nbsp;<span class="ident" id="8267088">s</span>&nbsp;<span class="ident" id="8267090">scanner</span><span class="op" id="8267097">.</span><span class="ident" id="8267098">Scanner</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8267107">//&nbsp;file&nbsp;was&nbsp;parsed&nbsp;already&nbsp;-&nbsp;do&nbsp;not&nbsp;add&nbsp;it&nbsp;again&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8267169">//&nbsp;set&nbsp;otherwise&nbsp;the&nbsp;position&nbsp;information&nbsp;returned&nbsp;here&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8267231">//&nbsp;not&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;collected&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267294">s</span><span class="op" id="8267295">.</span><span class="ident" id="8267296">Init</span><span class="op" id="8267300">(</span><span class="ident" id="8267301">getFile</span><span class="op" id="8267308">(</span><span class="ident" id="8267309">filename</span><span class="op" id="8267317">)</span><span class="op" id="8267318">,</span>&nbsp;<span class="ident" id="8267320">src</span><span class="op" id="8267323">,</span>&nbsp;<span class="builtintype" id="8267325">nil</span><span class="op" id="8267328">,</span>&nbsp;<span class="ident" id="8267330">scanner</span><span class="op" id="8267337">.</span><span class="ident" id="8267338">ScanComments</span><span class="op" id="8267350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267353">var</span>&nbsp;<span class="ident" id="8267357">prev</span>&nbsp;<span class="ident" id="8267362">token</span><span class="op" id="8267367">.</span><span class="ident" id="8267368">Pos</span>&nbsp;<span class="comment" id="8267372">//&nbsp;position&nbsp;of&nbsp;last&nbsp;non-comment,&nbsp;non-semicolon&nbsp;token</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267426">var</span>&nbsp;<span class="ident" id="8267430">here</span>&nbsp;<span class="ident" id="8267435">token</span><span class="op" id="8267440">.</span><span class="ident" id="8267441">Pos</span>&nbsp;<span class="comment" id="8267445">//&nbsp;position&nbsp;immediately&nbsp;after&nbsp;the&nbsp;token&nbsp;at&nbsp;position&nbsp;prev</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267504">for</span>&nbsp;<span class="op" id="8267508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267512">pos</span><span class="op" id="8267515">,</span>&nbsp;<span class="ident" id="8267517">tok</span><span class="op" id="8267520">,</span>&nbsp;<span class="ident" id="8267522">lit</span>&nbsp;<span class="op" id="8267526">:=</span>&nbsp;<span class="ident" id="8267529">s</span><span class="op" id="8267530">.</span><span class="ident" id="8267531">Scan</span><span class="op" id="8267535">(</span><span class="op" id="8267536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267540">switch</span>&nbsp;<span class="ident" id="8267547">tok</span>&nbsp;<span class="op" id="8267551">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267555">case</span>&nbsp;<span class="ident" id="8267560">token</span><span class="op" id="8267565">.</span><span class="ident" id="8267566">EOF</span><span class="op" id="8267569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267574">return</span>&nbsp;<span class="ident" id="8267581">errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267590">case</span>&nbsp;<span class="ident" id="8267595">token</span><span class="op" id="8267600">.</span><span class="ident" id="8267601">COMMENT</span><span class="op" id="8267608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267613">s</span>&nbsp;<span class="op" id="8267615">:=</span>&nbsp;<span class="ident" id="8267618">errRx</span><span class="op" id="8267623">.</span><span class="ident" id="8267624">FindStringSubmatch</span><span class="op" id="8267642">(</span><span class="ident" id="8267643">lit</span><span class="op" id="8267646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267651">if</span>&nbsp;<span class="builtinfunc" id="8267654">len</span><span class="op" id="8267657">(</span><span class="ident" id="8267658">s</span><span class="op" id="8267659">)</span>&nbsp;<span class="op" id="8267661">==</span>&nbsp;<span class="num" id="8267664">3</span>&nbsp;<span class="op" id="8267666">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267672">pos</span>&nbsp;<span class="op" id="8267676">:=</span>&nbsp;<span class="ident" id="8267679">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267688">if</span>&nbsp;<span class="ident" id="8267691">s</span><span class="op" id="8267692">[</span><span class="num" id="8267693">1</span><span class="op" id="8267694">]</span>&nbsp;<span class="op" id="8267696">==</span>&nbsp;<span class="string" id="8267699">&#34;HERE&#34;</span>&nbsp;<span class="op" id="8267706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267713">pos</span>&nbsp;<span class="op" id="8267717">=</span>&nbsp;<span class="ident" id="8267719">here</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267734">errors</span><span class="op" id="8267740">[</span><span class="ident" id="8267741">pos</span><span class="op" id="8267744">]</span>&nbsp;<span class="op" id="8267746">=</span>&nbsp;<span class="builtintype" id="8267748">string</span><span class="op" id="8267754">(</span><span class="ident" id="8267755">s</span><span class="op" id="8267756">[</span><span class="num" id="8267757">2</span><span class="op" id="8267758">]</span><span class="op" id="8267759">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267768">default</span><span class="op" id="8267775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267780">prev</span>&nbsp;<span class="op" id="8267785">=</span>&nbsp;<span class="ident" id="8267787">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267794">var</span>&nbsp;<span class="ident" id="8267798">l</span>&nbsp;<span class="builtintype" id="8267800">int</span>&nbsp;<span class="comment" id="8267804">//&nbsp;token&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267823">if</span>&nbsp;<span class="ident" id="8267826">tok</span><span class="op" id="8267829">.</span><span class="ident" id="8267830">IsLiteral</span><span class="op" id="8267839">(</span><span class="op" id="8267840">)</span>&nbsp;<span class="op" id="8267842">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267848">l</span>&nbsp;<span class="op" id="8267850">=</span>&nbsp;<span class="builtinfunc" id="8267852">len</span><span class="op" id="8267855">(</span><span class="ident" id="8267856">lit</span><span class="op" id="8267859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267864">}</span>&nbsp;<span class="keyword" id="8267866">else</span>&nbsp;<span class="op" id="8267871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267877">l</span>&nbsp;<span class="op" id="8267879">=</span>&nbsp;<span class="builtinfunc" id="8267881">len</span><span class="op" id="8267884">(</span><span class="ident" id="8267885">tok</span><span class="op" id="8267888">.</span><span class="ident" id="8267889">String</span><span class="op" id="8267895">(</span><span class="op" id="8267896">)</span><span class="op" id="8267897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267907">here</span>&nbsp;<span class="op" id="8267912">=</span>&nbsp;<span class="ident" id="8267914">prev</span>&nbsp;<span class="op" id="8267919">+</span>&nbsp;<span class="ident" id="8267921">token</span><span class="op" id="8267926">.</span><span class="ident" id="8267927">Pos</span><span class="op" id="8267930">(</span><span class="ident" id="8267931">l</span><span class="op" id="8267932">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267939">}</span><br>
<span class="lineno"></span><span class="op" id="8267941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8267944">//&nbsp;compareErrors&nbsp;compares&nbsp;the&nbsp;map&nbsp;of&nbsp;expected&nbsp;error&nbsp;messages&nbsp;with&nbsp;the&nbsp;list</span><br>
<span class="lineno">110</span><span class="comment" id="8268019">//&nbsp;of&nbsp;found&nbsp;errors&nbsp;and&nbsp;reports&nbsp;discrepancies.</span><br>
<span class="lineno"></span><span class="comment" id="8268065">//</span><br>
<span class="lineno"></span><span class="keyword" id="8268068">func</span>&nbsp;<span class="ident" id="8268073">compareErrors</span><span class="op" id="8268086">(</span><span class="ident" id="8268087">t</span>&nbsp;<span class="op" id="8268089">*</span><span class="ident" id="8268090">testing</span><span class="op" id="8268097">.</span><span class="ident" id="8268098">T</span><span class="op" id="8268099">,</span>&nbsp;<span class="ident" id="8268101">expected</span>&nbsp;<span class="keyword" id="8268110">map</span><span class="op" id="8268113">[</span><span class="ident" id="8268114">token</span><span class="op" id="8268119">.</span><span class="ident" id="8268120">Pos</span><span class="op" id="8268123">]</span><span class="builtintype" id="8268124">string</span><span class="op" id="8268130">,</span>&nbsp;<span class="ident" id="8268132">found</span>&nbsp;<span class="ident" id="8268138">scanner</span><span class="op" id="8268145">.</span><span class="ident" id="8268146">ErrorList</span><span class="op" id="8268155">)</span>&nbsp;<span class="op" id="8268157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268160">for</span>&nbsp;<span class="ident" id="8268164">_</span><span class="op" id="8268165">,</span>&nbsp;<span class="builtintype" id="8268167">error</span>&nbsp;<span class="op" id="8268173">:=</span>&nbsp;<span class="keyword" id="8268176">range</span>&nbsp;<span class="ident" id="8268182">found</span>&nbsp;<span class="op" id="8268188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268192">//&nbsp;error.Pos&nbsp;is&nbsp;a&nbsp;token.Position,&nbsp;but&nbsp;we&nbsp;want</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268240">//&nbsp;a&nbsp;token.Pos&nbsp;so&nbsp;we&nbsp;can&nbsp;do&nbsp;a&nbsp;map&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8268283">pos</span>&nbsp;<span class="op" id="8268287">:=</span>&nbsp;<span class="ident" id="8268290">getPos</span><span class="op" id="8268296">(</span><span class="builtintype" id="8268297">error</span><span class="op" id="8268302">.</span><span class="ident" id="8268303">Pos</span><span class="op" id="8268306">.</span><span class="ident" id="8268307">Filename</span><span class="op" id="8268315">,</span>&nbsp;<span class="builtintype" id="8268317">error</span><span class="op" id="8268322">.</span><span class="ident" id="8268323">Pos</span><span class="op" id="8268326">.</span><span class="ident" id="8268327">Offset</span><span class="op" id="8268333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268337">if</span>&nbsp;<span class="ident" id="8268340">msg</span><span class="op" id="8268343">,</span>&nbsp;<span class="ident" id="8268345">found</span>&nbsp;<span class="op" id="8268351">:=</span>&nbsp;<span class="ident" id="8268354">expected</span><span class="op" id="8268362">[</span><span class="ident" id="8268363">pos</span><span class="op" id="8268366">]</span><span class="op" id="8268367">;</span>&nbsp;<span class="ident" id="8268369">found</span>&nbsp;<span class="op" id="8268375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268380">//&nbsp;we&nbsp;expect&nbsp;a&nbsp;message&nbsp;at&nbsp;pos;&nbsp;check&nbsp;if&nbsp;it&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8268434">rx</span><span class="op" id="8268436">,</span>&nbsp;<span class="ident" id="8268438">err</span>&nbsp;<span class="op" id="8268442">:=</span>&nbsp;<span class="ident" id="8268445">regexp</span><span class="op" id="8268451">.</span><span class="ident" id="8268452">Compile</span><span class="op" id="8268459">(</span><span class="ident" id="8268460">msg</span><span class="op" id="8268463">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268468">if</span>&nbsp;<span class="ident" id="8268471">err</span>&nbsp;<span class="op" id="8268475">!=</span>&nbsp;<span class="builtintype" id="8268478">nil</span>&nbsp;<span class="op" id="8268482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8268488">t</span><span class="op" id="8268489">.</span><span class="ident" id="8268490">Errorf</span><span class="op" id="8268496">(</span><span class="string" id="8268497">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="8268505">,</span>&nbsp;<span class="builtintype" id="8268507">error</span><span class="op" id="8268512">.</span><span class="ident" id="8268513">Pos</span><span class="op" id="8268516">,</span>&nbsp;<span class="ident" id="8268518">err</span><span class="op" id="8268521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268527">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8268539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268544">if</span>&nbsp;<span class="ident" id="8268547">match</span>&nbsp;<span class="op" id="8268553">:=</span>&nbsp;<span class="ident" id="8268556">rx</span><span class="op" id="8268558">.</span><span class="ident" id="8268559">MatchString</span><span class="op" id="8268570">(</span><span class="builtintype" id="8268571">error</span><span class="op" id="8268576">.</span><span class="ident" id="8268577">Msg</span><span class="op" id="8268580">)</span><span class="op" id="8268581">;</span>&nbsp;<span class="op" id="8268583">!</span><span class="ident" id="8268584">match</span>&nbsp;<span class="op" id="8268590">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8268596">t</span><span class="op" id="8268597">.</span><span class="ident" id="8268598">Errorf</span><span class="op" id="8268604">(</span><span class="string" id="8268605">&#34;%s:&nbsp;%q&nbsp;does&nbsp;not&nbsp;match&nbsp;%q&#34;</span><span class="op" id="8268631">,</span>&nbsp;<span class="builtintype" id="8268633">error</span><span class="op" id="8268638">.</span><span class="ident" id="8268639">Pos</span><span class="op" id="8268642">,</span>&nbsp;<span class="builtintype" id="8268644">error</span><span class="op" id="8268649">.</span><span class="ident" id="8268650">Msg</span><span class="op" id="8268653">,</span>&nbsp;<span class="ident" id="8268655">msg</span><span class="op" id="8268658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8268664">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8268676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268681">//&nbsp;we&nbsp;have&nbsp;a&nbsp;match&nbsp;-&nbsp;eliminate&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8268726">delete</span><span class="op" id="8268732">(</span><span class="ident" id="8268733">expected</span><span class="op" id="8268741">,</span>&nbsp;<span class="ident" id="8268743">pos</span><span class="op" id="8268746">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8268750">}</span>&nbsp;<span class="keyword" id="8268752">else</span>&nbsp;<span class="op" id="8268757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268762">//&nbsp;To&nbsp;keep&nbsp;in&nbsp;mind&nbsp;when&nbsp;analyzing&nbsp;failed&nbsp;test&nbsp;output:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268819">//&nbsp;If&nbsp;the&nbsp;same&nbsp;error&nbsp;position&nbsp;occurs&nbsp;multiple&nbsp;times&nbsp;in&nbsp;errors,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268885">//&nbsp;this&nbsp;message&nbsp;will&nbsp;be&nbsp;triggered&nbsp;(because&nbsp;the&nbsp;first&nbsp;error&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8268950">//&nbsp;the&nbsp;position&nbsp;removes&nbsp;this&nbsp;position&nbsp;from&nbsp;the&nbsp;expected&nbsp;errors).</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269018">t</span><span class="op" id="8269019">.</span><span class="ident" id="8269020">Errorf</span><span class="op" id="8269026">(</span><span class="string" id="8269027">&#34;%s:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8269053">,</span>&nbsp;<span class="builtintype" id="8269055">error</span><span class="op" id="8269060">.</span><span class="ident" id="8269061">Pos</span><span class="op" id="8269064">,</span>&nbsp;<span class="builtintype" id="8269066">error</span><span class="op" id="8269071">.</span><span class="ident" id="8269072">Msg</span><span class="op" id="8269075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8269086">//&nbsp;there&nbsp;should&nbsp;be&nbsp;no&nbsp;expected&nbsp;errors&nbsp;left</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269130">if</span>&nbsp;<span class="builtinfunc" id="8269133">len</span><span class="op" id="8269136">(</span><span class="ident" id="8269137">expected</span><span class="op" id="8269145">)</span>&nbsp;<span class="op" id="8269147">&gt;</span>&nbsp;<span class="num" id="8269149">0</span>&nbsp;<span class="op" id="8269151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269155">t</span><span class="op" id="8269156">.</span><span class="ident" id="8269157">Errorf</span><span class="op" id="8269163">(</span><span class="string" id="8269164">&#34;%d&nbsp;errors&nbsp;not&nbsp;reported:&#34;</span><span class="op" id="8269189">,</span>&nbsp;<span class="builtinfunc" id="8269191">len</span><span class="op" id="8269194">(</span><span class="ident" id="8269195">expected</span><span class="op" id="8269203">)</span><span class="op" id="8269204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269208">for</span>&nbsp;<span class="ident" id="8269212">pos</span><span class="op" id="8269215">,</span>&nbsp;<span class="ident" id="8269217">msg</span>&nbsp;<span class="op" id="8269221">:=</span>&nbsp;<span class="keyword" id="8269224">range</span>&nbsp;<span class="ident" id="8269230">expected</span>&nbsp;<span class="op" id="8269239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269244">t</span><span class="op" id="8269245">.</span><span class="ident" id="8269246">Errorf</span><span class="op" id="8269252">(</span><span class="string" id="8269253">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="8269263">,</span>&nbsp;<span class="ident" id="8269265">fsetErrs</span><span class="op" id="8269273">.</span><span class="ident" id="8269274">Position</span><span class="op" id="8269282">(</span><span class="ident" id="8269283">pos</span><span class="op" id="8269286">)</span><span class="op" id="8269287">,</span>&nbsp;<span class="ident" id="8269289">msg</span><span class="op" id="8269292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269296">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269299">}</span><br>
<span class="lineno"></span><span class="op" id="8269301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8269304">func</span>&nbsp;<span class="ident" id="8269309">checkErrors</span><span class="op" id="8269320">(</span><span class="ident" id="8269321">t</span>&nbsp;<span class="op" id="8269323">*</span><span class="ident" id="8269324">testing</span><span class="op" id="8269331">.</span><span class="ident" id="8269332">T</span><span class="op" id="8269333">,</span>&nbsp;<span class="ident" id="8269335">filename</span>&nbsp;<span class="builtintype" id="8269344">string</span><span class="op" id="8269350">,</span>&nbsp;<span class="ident" id="8269352">input</span>&nbsp;<span class="keyword" id="8269358">interface</span><span class="op" id="8269367">{</span><span class="op" id="8269368">}</span><span class="op" id="8269369">)</span>&nbsp;<span class="op" id="8269371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269374">src</span><span class="op" id="8269377">,</span>&nbsp;<span class="ident" id="8269379">err</span>&nbsp;<span class="op" id="8269383">:=</span>&nbsp;<span class="ident" id="8269386">readSource</span><span class="op" id="8269396">(</span><span class="ident" id="8269397">filename</span><span class="op" id="8269405">,</span>&nbsp;<span class="ident" id="8269407">input</span><span class="op" id="8269412">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269415">if</span>&nbsp;<span class="ident" id="8269418">err</span>&nbsp;<span class="op" id="8269422">!=</span>&nbsp;<span class="builtintype" id="8269425">nil</span>&nbsp;<span class="op" id="8269429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269433">t</span><span class="op" id="8269434">.</span><span class="ident" id="8269435">Error</span><span class="op" id="8269440">(</span><span class="ident" id="8269441">err</span><span class="op" id="8269444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269448">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269460">_</span><span class="op" id="8269461">,</span>&nbsp;<span class="ident" id="8269463">err</span>&nbsp;<span class="op" id="8269467">=</span>&nbsp;<span class="ident" id="8269469">ParseFile</span><span class="op" id="8269478">(</span><span class="ident" id="8269479">fsetErrs</span><span class="op" id="8269487">,</span>&nbsp;<span class="ident" id="8269489">filename</span><span class="op" id="8269497">,</span>&nbsp;<span class="ident" id="8269499">src</span><span class="op" id="8269502">,</span>&nbsp;<span class="ident" id="8269504">DeclarationErrors</span><span class="op" id="8269521">|</span><span class="ident" id="8269522">AllErrors</span><span class="op" id="8269531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269534">found</span><span class="op" id="8269539">,</span>&nbsp;<span class="ident" id="8269541">ok</span>&nbsp;<span class="op" id="8269544">:=</span>&nbsp;<span class="ident" id="8269547">err</span><span class="op" id="8269550">.</span><span class="op" id="8269551">(</span><span class="ident" id="8269552">scanner</span><span class="op" id="8269559">.</span><span class="ident" id="8269560">ErrorList</span><span class="op" id="8269569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269572">if</span>&nbsp;<span class="ident" id="8269575">err</span>&nbsp;<span class="op" id="8269579">!=</span>&nbsp;<span class="builtintype" id="8269582">nil</span>&nbsp;<span class="op" id="8269586">&amp;&amp;</span>&nbsp;<span class="op" id="8269589">!</span><span class="ident" id="8269590">ok</span>&nbsp;<span class="op" id="8269593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269597">t</span><span class="op" id="8269598">.</span><span class="ident" id="8269599">Error</span><span class="op" id="8269604">(</span><span class="ident" id="8269605">err</span><span class="op" id="8269608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269612">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269623">found</span><span class="op" id="8269628">.</span><span class="ident" id="8269629">RemoveMultiples</span><span class="op" id="8269644">(</span><span class="op" id="8269645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8269649">//&nbsp;we&nbsp;are&nbsp;expecting&nbsp;the&nbsp;following&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8269691">//&nbsp;(collect&nbsp;these&nbsp;after&nbsp;parsing&nbsp;a&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;is&nbsp;found&nbsp;in&nbsp;the&nbsp;file&nbsp;set)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269768">expected</span>&nbsp;<span class="op" id="8269777">:=</span>&nbsp;<span class="ident" id="8269780">expectedErrors</span><span class="op" id="8269794">(</span><span class="ident" id="8269795">t</span><span class="op" id="8269796">,</span>&nbsp;<span class="ident" id="8269798">filename</span><span class="op" id="8269806">,</span>&nbsp;<span class="ident" id="8269808">src</span><span class="op" id="8269811">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8269815">//&nbsp;verify&nbsp;errors&nbsp;returned&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269856">compareErrors</span><span class="op" id="8269869">(</span><span class="ident" id="8269870">t</span><span class="op" id="8269871">,</span>&nbsp;<span class="ident" id="8269873">expected</span><span class="op" id="8269881">,</span>&nbsp;<span class="ident" id="8269883">found</span><span class="op" id="8269888">)</span><br>
<span class="lineno"></span><span class="op" id="8269890">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8269893">func</span>&nbsp;<span class="ident" id="8269898">TestErrors</span><span class="op" id="8269908">(</span><span class="ident" id="8269909">t</span>&nbsp;<span class="op" id="8269911">*</span><span class="ident" id="8269912">testing</span><span class="op" id="8269919">.</span><span class="ident" id="8269920">T</span><span class="op" id="8269921">)</span>&nbsp;<span class="op" id="8269923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269926">list</span><span class="op" id="8269930">,</span>&nbsp;<span class="ident" id="8269932">err</span>&nbsp;<span class="op" id="8269936">:=</span>&nbsp;<span class="ident" id="8269939">ioutil</span><span class="op" id="8269945">.</span><span class="ident" id="8269946">ReadDir</span><span class="op" id="8269953">(</span><span class="ident" id="8269954">testdata</span><span class="op" id="8269962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8269965">if</span>&nbsp;<span class="ident" id="8269968">err</span>&nbsp;<span class="op" id="8269972">!=</span>&nbsp;<span class="builtintype" id="8269975">nil</span>&nbsp;<span class="op" id="8269979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8269983">t</span><span class="op" id="8269984">.</span><span class="ident" id="8269985">Fatal</span><span class="op" id="8269990">(</span><span class="ident" id="8269991">err</span><span class="op" id="8269994">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8269997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8270000">for</span>&nbsp;<span class="ident" id="8270004">_</span><span class="op" id="8270005">,</span>&nbsp;<span class="ident" id="8270007">fi</span>&nbsp;<span class="op" id="8270010">:=</span>&nbsp;<span class="keyword" id="8270013">range</span>&nbsp;<span class="ident" id="8270019">list</span>&nbsp;<span class="op" id="8270024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8270028">name</span>&nbsp;<span class="op" id="8270033">:=</span>&nbsp;<span class="ident" id="8270036">fi</span><span class="op" id="8270038">.</span><span class="ident" id="8270039">Name</span><span class="op" id="8270043">(</span><span class="op" id="8270044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8270048">if</span>&nbsp;<span class="op" id="8270051">!</span><span class="ident" id="8270052">fi</span><span class="op" id="8270054">.</span><span class="ident" id="8270055">IsDir</span><span class="op" id="8270060">(</span><span class="op" id="8270061">)</span>&nbsp;<span class="op" id="8270063">&amp;&amp;</span>&nbsp;<span class="op" id="8270066">!</span><span class="ident" id="8270067">strings</span><span class="op" id="8270074">.</span><span class="ident" id="8270075">HasPrefix</span><span class="op" id="8270084">(</span><span class="ident" id="8270085">name</span><span class="op" id="8270089">,</span>&nbsp;<span class="string" id="8270091">&#34;.&#34;</span><span class="op" id="8270094">)</span>&nbsp;<span class="op" id="8270096">&amp;&amp;</span>&nbsp;<span class="ident" id="8270099">strings</span><span class="op" id="8270106">.</span><span class="ident" id="8270107">HasSuffix</span><span class="op" id="8270116">(</span><span class="ident" id="8270117">name</span><span class="op" id="8270121">,</span>&nbsp;<span class="string" id="8270123">&#34;.src&#34;</span><span class="op" id="8270129">)</span>&nbsp;<span class="op" id="8270131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8270136">checkErrors</span><span class="op" id="8270147">(</span><span class="ident" id="8270148">t</span><span class="op" id="8270149">,</span>&nbsp;<span class="ident" id="8270151">filepath</span><span class="op" id="8270159">.</span><span class="ident" id="8270160">Join</span><span class="op" id="8270164">(</span><span class="ident" id="8270165">testdata</span><span class="op" id="8270173">,</span>&nbsp;<span class="ident" id="8270175">name</span><span class="op" id="8270179">)</span><span class="op" id="8270180">,</span>&nbsp;<span class="builtintype" id="8270182">nil</span><span class="op" id="8270185">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8270189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8270192">}</span><br>
<span class="lineno"></span><span class="op" id="8270194">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
