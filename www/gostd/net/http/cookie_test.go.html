<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6543087">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6543143">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6543197">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6543248">package</span>&nbsp;<span class="ident" id="6543256">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6543262">import</span>&nbsp;<span class="op" id="6543269">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543272">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543281">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543298">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543305">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543312">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543318">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543329">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543340">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543351">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6543358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6543361">var</span>&nbsp;<span class="ident" id="6543365">writeSetCookiesTests</span>&nbsp;<span class="op" id="6543386">=</span>&nbsp;<span class="op" id="6543388">[</span><span class="op" id="6543389">]</span><span class="keyword" id="6543390">struct</span>&nbsp;<span class="op" id="6543397">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6543400">Cookie</span>&nbsp;<span class="op" id="6543407">*</span><span class="ident" id="6543408">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6543416">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6543423">string</span><br>
<span class="lineno"></span><span class="op" id="6543430">}</span><span class="op" id="6543431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543438">&amp;</span><span class="ident" id="6543439">Cookie</span><span class="op" id="6543445">{</span><span class="ident" id="6543446">Name</span><span class="op" id="6543450">:</span>&nbsp;<span class="string" id="6543452">&#34;cookie-1&#34;</span><span class="op" id="6543462">,</span>&nbsp;<span class="ident" id="6543464">Value</span><span class="op" id="6543469">:</span>&nbsp;<span class="string" id="6543471">&#34;v$1&#34;</span><span class="op" id="6543476">}</span><span class="op" id="6543477">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543481">&#34;cookie-1=v$1&#34;</span><span class="op" id="6543495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543498">}</span><span class="op" id="6543499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543506">&amp;</span><span class="ident" id="6543507">Cookie</span><span class="op" id="6543513">{</span><span class="ident" id="6543514">Name</span><span class="op" id="6543518">:</span>&nbsp;<span class="string" id="6543520">&#34;cookie-2&#34;</span><span class="op" id="6543530">,</span>&nbsp;<span class="ident" id="6543532">Value</span><span class="op" id="6543537">:</span>&nbsp;<span class="string" id="6543539">&#34;two&#34;</span><span class="op" id="6543544">,</span>&nbsp;<span class="ident" id="6543546">MaxAge</span><span class="op" id="6543552">:</span>&nbsp;<span class="num" id="6543554">3600</span><span class="op" id="6543558">}</span><span class="op" id="6543559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543563">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="6543591">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543594">}</span><span class="op" id="6543595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543602">&amp;</span><span class="ident" id="6543603">Cookie</span><span class="op" id="6543609">{</span><span class="ident" id="6543610">Name</span><span class="op" id="6543614">:</span>&nbsp;<span class="string" id="6543616">&#34;cookie-3&#34;</span><span class="op" id="6543626">,</span>&nbsp;<span class="ident" id="6543628">Value</span><span class="op" id="6543633">:</span>&nbsp;<span class="string" id="6543635">&#34;three&#34;</span><span class="op" id="6543642">,</span>&nbsp;<span class="ident" id="6543644">Domain</span><span class="op" id="6543650">:</span>&nbsp;<span class="string" id="6543652">&#34;.example.com&#34;</span><span class="op" id="6543666">}</span><span class="op" id="6543667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543671">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="6543707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543710">}</span><span class="op" id="6543711">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543718">&amp;</span><span class="ident" id="6543719">Cookie</span><span class="op" id="6543725">{</span><span class="ident" id="6543726">Name</span><span class="op" id="6543730">:</span>&nbsp;<span class="string" id="6543732">&#34;cookie-4&#34;</span><span class="op" id="6543742">,</span>&nbsp;<span class="ident" id="6543744">Value</span><span class="op" id="6543749">:</span>&nbsp;<span class="string" id="6543751">&#34;four&#34;</span><span class="op" id="6543757">,</span>&nbsp;<span class="ident" id="6543759">Path</span><span class="op" id="6543763">:</span>&nbsp;<span class="string" id="6543765">&#34;/restricted/&#34;</span><span class="op" id="6543779">}</span><span class="op" id="6543780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543784">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="6543818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543821">}</span><span class="op" id="6543822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543825">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543829">&amp;</span><span class="ident" id="6543830">Cookie</span><span class="op" id="6543836">{</span><span class="ident" id="6543837">Name</span><span class="op" id="6543841">:</span>&nbsp;<span class="string" id="6543843">&#34;cookie-5&#34;</span><span class="op" id="6543853">,</span>&nbsp;<span class="ident" id="6543855">Value</span><span class="op" id="6543860">:</span>&nbsp;<span class="string" id="6543862">&#34;five&#34;</span><span class="op" id="6543868">,</span>&nbsp;<span class="ident" id="6543870">Domain</span><span class="op" id="6543876">:</span>&nbsp;<span class="string" id="6543878">&#34;wrong;bad.abc&#34;</span><span class="op" id="6543893">}</span><span class="op" id="6543894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543898">&#34;cookie-5=five&#34;</span><span class="op" id="6543913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543916">}</span><span class="op" id="6543917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6543924">&amp;</span><span class="ident" id="6543925">Cookie</span><span class="op" id="6543931">{</span><span class="ident" id="6543932">Name</span><span class="op" id="6543936">:</span>&nbsp;<span class="string" id="6543938">&#34;cookie-6&#34;</span><span class="op" id="6543948">,</span>&nbsp;<span class="ident" id="6543950">Value</span><span class="op" id="6543955">:</span>&nbsp;<span class="string" id="6543957">&#34;six&#34;</span><span class="op" id="6543962">,</span>&nbsp;<span class="ident" id="6543964">Domain</span><span class="op" id="6543970">:</span>&nbsp;<span class="string" id="6543972">&#34;bad-.abc&#34;</span><span class="op" id="6543982">}</span><span class="op" id="6543983">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6543987">&#34;cookie-6=six&#34;</span><span class="op" id="6544001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544004">}</span><span class="op" id="6544005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544012">&amp;</span><span class="ident" id="6544013">Cookie</span><span class="op" id="6544019">{</span><span class="ident" id="6544020">Name</span><span class="op" id="6544024">:</span>&nbsp;<span class="string" id="6544026">&#34;cookie-7&#34;</span><span class="op" id="6544036">,</span>&nbsp;<span class="ident" id="6544038">Value</span><span class="op" id="6544043">:</span>&nbsp;<span class="string" id="6544045">&#34;seven&#34;</span><span class="op" id="6544052">,</span>&nbsp;<span class="ident" id="6544054">Domain</span><span class="op" id="6544060">:</span>&nbsp;<span class="string" id="6544062">&#34;127.0.0.1&#34;</span><span class="op" id="6544073">}</span><span class="op" id="6544074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544078">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="6544112">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544115">}</span><span class="op" id="6544116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544123">&amp;</span><span class="ident" id="6544124">Cookie</span><span class="op" id="6544130">{</span><span class="ident" id="6544131">Name</span><span class="op" id="6544135">:</span>&nbsp;<span class="string" id="6544137">&#34;cookie-8&#34;</span><span class="op" id="6544147">,</span>&nbsp;<span class="ident" id="6544149">Value</span><span class="op" id="6544154">:</span>&nbsp;<span class="string" id="6544156">&#34;eight&#34;</span><span class="op" id="6544163">,</span>&nbsp;<span class="ident" id="6544165">Domain</span><span class="op" id="6544171">:</span>&nbsp;<span class="string" id="6544173">&#34;::1&#34;</span><span class="op" id="6544178">}</span><span class="op" id="6544179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544183">&#34;cookie-8=eight&#34;</span><span class="op" id="6544199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544202">}</span><span class="op" id="6544203">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6544206">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6544278">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544341">&amp;</span><span class="ident" id="6544342">Cookie</span><span class="op" id="6544348">{</span><span class="ident" id="6544349">Name</span><span class="op" id="6544353">:</span>&nbsp;<span class="string" id="6544355">&#34;special-1&#34;</span><span class="op" id="6544366">,</span>&nbsp;<span class="ident" id="6544368">Value</span><span class="op" id="6544373">:</span>&nbsp;<span class="string" id="6544375">&#34;a&nbsp;z&#34;</span><span class="op" id="6544380">}</span><span class="op" id="6544381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544385">`special-1=a&nbsp;z`</span><span class="op" id="6544400">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544403">}</span><span class="op" id="6544404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544411">&amp;</span><span class="ident" id="6544412">Cookie</span><span class="op" id="6544418">{</span><span class="ident" id="6544419">Name</span><span class="op" id="6544423">:</span>&nbsp;<span class="string" id="6544425">&#34;special-2&#34;</span><span class="op" id="6544436">,</span>&nbsp;<span class="ident" id="6544438">Value</span><span class="op" id="6544443">:</span>&nbsp;<span class="string" id="6544445">&#34;&nbsp;z&#34;</span><span class="op" id="6544449">}</span><span class="op" id="6544450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544454">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6544470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544473">}</span><span class="op" id="6544474">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544481">&amp;</span><span class="ident" id="6544482">Cookie</span><span class="op" id="6544488">{</span><span class="ident" id="6544489">Name</span><span class="op" id="6544493">:</span>&nbsp;<span class="string" id="6544495">&#34;special-3&#34;</span><span class="op" id="6544506">,</span>&nbsp;<span class="ident" id="6544508">Value</span><span class="op" id="6544513">:</span>&nbsp;<span class="string" id="6544515">&#34;a&nbsp;&#34;</span><span class="op" id="6544519">}</span><span class="op" id="6544520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544524">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6544540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544543">}</span><span class="op" id="6544544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544547">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544551">&amp;</span><span class="ident" id="6544552">Cookie</span><span class="op" id="6544558">{</span><span class="ident" id="6544559">Name</span><span class="op" id="6544563">:</span>&nbsp;<span class="string" id="6544565">&#34;special-4&#34;</span><span class="op" id="6544576">,</span>&nbsp;<span class="ident" id="6544578">Value</span><span class="op" id="6544583">:</span>&nbsp;<span class="string" id="6544585">&#34;&nbsp;&#34;</span><span class="op" id="6544588">}</span><span class="op" id="6544589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544593">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6544608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544611">}</span><span class="op" id="6544612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544619">&amp;</span><span class="ident" id="6544620">Cookie</span><span class="op" id="6544626">{</span><span class="ident" id="6544627">Name</span><span class="op" id="6544631">:</span>&nbsp;<span class="string" id="6544633">&#34;special-5&#34;</span><span class="op" id="6544644">,</span>&nbsp;<span class="ident" id="6544646">Value</span><span class="op" id="6544651">:</span>&nbsp;<span class="string" id="6544653">&#34;a,z&#34;</span><span class="op" id="6544658">}</span><span class="op" id="6544659">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544663">`special-5=a,z`</span><span class="op" id="6544678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544681">}</span><span class="op" id="6544682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544689">&amp;</span><span class="ident" id="6544690">Cookie</span><span class="op" id="6544696">{</span><span class="ident" id="6544697">Name</span><span class="op" id="6544701">:</span>&nbsp;<span class="string" id="6544703">&#34;special-6&#34;</span><span class="op" id="6544714">,</span>&nbsp;<span class="ident" id="6544716">Value</span><span class="op" id="6544721">:</span>&nbsp;<span class="string" id="6544723">&#34;,z&#34;</span><span class="op" id="6544727">}</span><span class="op" id="6544728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544732">`special-6=&#34;,z&#34;`</span><span class="op" id="6544748">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544751">}</span><span class="op" id="6544752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544759">&amp;</span><span class="ident" id="6544760">Cookie</span><span class="op" id="6544766">{</span><span class="ident" id="6544767">Name</span><span class="op" id="6544771">:</span>&nbsp;<span class="string" id="6544773">&#34;special-7&#34;</span><span class="op" id="6544784">,</span>&nbsp;<span class="ident" id="6544786">Value</span><span class="op" id="6544791">:</span>&nbsp;<span class="string" id="6544793">&#34;a,&#34;</span><span class="op" id="6544797">}</span><span class="op" id="6544798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544802">`special-7=&#34;a,&#34;`</span><span class="op" id="6544818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544821">}</span><span class="op" id="6544822">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544829">&amp;</span><span class="ident" id="6544830">Cookie</span><span class="op" id="6544836">{</span><span class="ident" id="6544837">Name</span><span class="op" id="6544841">:</span>&nbsp;<span class="string" id="6544843">&#34;special-8&#34;</span><span class="op" id="6544854">,</span>&nbsp;<span class="ident" id="6544856">Value</span><span class="op" id="6544861">:</span>&nbsp;<span class="string" id="6544863">&#34;,&#34;</span><span class="op" id="6544866">}</span><span class="op" id="6544867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544871">`special-8=&#34;,&#34;`</span><span class="op" id="6544886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544889">}</span><span class="op" id="6544890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544893">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544897">&amp;</span><span class="ident" id="6544898">Cookie</span><span class="op" id="6544904">{</span><span class="ident" id="6544905">Name</span><span class="op" id="6544909">:</span>&nbsp;<span class="string" id="6544911">&#34;empty-value&#34;</span><span class="op" id="6544924">,</span>&nbsp;<span class="ident" id="6544926">Value</span><span class="op" id="6544931">:</span>&nbsp;<span class="string" id="6544933">&#34;&#34;</span><span class="op" id="6544935">}</span><span class="op" id="6544936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544940">`empty-value=`</span><span class="op" id="6544954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544957">}</span><span class="op" id="6544958">,</span><br>
<span class="lineno"></span><span class="op" id="6544960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6544963">func</span>&nbsp;<span class="ident" id="6544968">TestWriteSetCookies</span><span class="op" id="6544987">(</span><span class="ident" id="6544988">t</span>&nbsp;<span class="op" id="6544990">*</span><span class="ident" id="6544991">testing</span><span class="op" id="6544998">.</span><span class="ident" id="6544999">T</span><span class="op" id="6545000">)</span>&nbsp;<span class="op" id="6545002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545005">defer</span>&nbsp;<span class="ident" id="6545011">log</span><span class="op" id="6545014">.</span><span class="ident" id="6545015">SetOutput</span><span class="op" id="6545024">(</span><span class="ident" id="6545025">os</span><span class="op" id="6545027">.</span><span class="ident" id="6545028">Stderr</span><span class="op" id="6545034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545037">var</span>&nbsp;<span class="ident" id="6545041">logbuf</span>&nbsp;<span class="ident" id="6545048">bytes</span><span class="op" id="6545053">.</span><span class="ident" id="6545054">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545062">log</span><span class="op" id="6545065">.</span><span class="ident" id="6545066">SetOutput</span><span class="op" id="6545075">(</span><span class="op" id="6545076">&amp;</span><span class="ident" id="6545077">logbuf</span><span class="op" id="6545083">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545087">for</span>&nbsp;<span class="ident" id="6545091">i</span><span class="op" id="6545092">,</span>&nbsp;<span class="ident" id="6545094">tt</span>&nbsp;<span class="op" id="6545097">:=</span>&nbsp;<span class="keyword" id="6545100">range</span>&nbsp;<span class="ident" id="6545106">writeSetCookiesTests</span>&nbsp;<span class="op" id="6545127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545131">if</span>&nbsp;<span class="ident" id="6545134">g</span><span class="op" id="6545135">,</span>&nbsp;<span class="ident" id="6545137">e</span>&nbsp;<span class="op" id="6545139">:=</span>&nbsp;<span class="ident" id="6545142">tt</span><span class="op" id="6545144">.</span><span class="ident" id="6545145">Cookie</span><span class="op" id="6545151">.</span><span class="ident" id="6545152">String</span><span class="op" id="6545158">(</span><span class="op" id="6545159">)</span><span class="op" id="6545160">,</span>&nbsp;<span class="ident" id="6545162">tt</span><span class="op" id="6545164">.</span><span class="ident" id="6545165">Raw</span><span class="op" id="6545168">;</span>&nbsp;<span class="ident" id="6545170">g</span>&nbsp;<span class="op" id="6545172">!=</span>&nbsp;<span class="ident" id="6545175">e</span>&nbsp;<span class="op" id="6545177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545182">t</span><span class="op" id="6545183">.</span><span class="ident" id="6545184">Errorf</span><span class="op" id="6545190">(</span><span class="string" id="6545191">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6545228">,</span>&nbsp;<span class="ident" id="6545230">i</span><span class="op" id="6545231">,</span>&nbsp;<span class="ident" id="6545233">e</span><span class="op" id="6545234">,</span>&nbsp;<span class="ident" id="6545236">g</span><span class="op" id="6545237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545242">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545253">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545260">if</span>&nbsp;<span class="ident" id="6545263">got</span><span class="op" id="6545266">,</span>&nbsp;<span class="ident" id="6545268">sub</span>&nbsp;<span class="op" id="6545272">:=</span>&nbsp;<span class="ident" id="6545275">logbuf</span><span class="op" id="6545281">.</span><span class="ident" id="6545282">String</span><span class="op" id="6545288">(</span><span class="op" id="6545289">)</span><span class="op" id="6545290">,</span>&nbsp;<span class="string" id="6545292">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="6545319">;</span>&nbsp;<span class="op" id="6545321">!</span><span class="ident" id="6545322">strings</span><span class="op" id="6545329">.</span><span class="ident" id="6545330">Contains</span><span class="op" id="6545338">(</span><span class="ident" id="6545339">got</span><span class="op" id="6545342">,</span>&nbsp;<span class="ident" id="6545344">sub</span><span class="op" id="6545347">)</span>&nbsp;<span class="op" id="6545349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545353">t</span><span class="op" id="6545354">.</span><span class="ident" id="6545355">Errorf</span><span class="op" id="6545361">(</span><span class="string" id="6545362">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6545409">,</span>&nbsp;<span class="ident" id="6545411">sub</span><span class="op" id="6545414">,</span>&nbsp;<span class="ident" id="6545416">got</span><span class="op" id="6545419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545422">}</span><br>
<span class="lineno">110</span><span class="op" id="6545424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6545427">type</span>&nbsp;<span class="ident" id="6545432">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="6545457">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6545465">func</span>&nbsp;<span class="op" id="6545470">(</span><span class="ident" id="6545471">ho</span>&nbsp;<span class="ident" id="6545474">headerOnlyResponseWriter</span><span class="op" id="6545498">)</span>&nbsp;<span class="ident" id="6545500">Header</span><span class="op" id="6545506">(</span><span class="op" id="6545507">)</span>&nbsp;<span class="ident" id="6545509">Header</span>&nbsp;<span class="op" id="6545516">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545519">return</span>&nbsp;<span class="ident" id="6545526">Header</span><span class="op" id="6545532">(</span><span class="ident" id="6545533">ho</span><span class="op" id="6545535">)</span><br>
<span class="lineno"></span><span class="op" id="6545537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6545540">func</span>&nbsp;<span class="op" id="6545545">(</span><span class="ident" id="6545546">ho</span>&nbsp;<span class="ident" id="6545549">headerOnlyResponseWriter</span><span class="op" id="6545573">)</span>&nbsp;<span class="ident" id="6545575">Write</span><span class="op" id="6545580">(</span><span class="op" id="6545581">[</span><span class="op" id="6545582">]</span><span class="builtintype" id="6545583">byte</span><span class="op" id="6545587">)</span>&nbsp;<span class="op" id="6545589">(</span><span class="builtintype" id="6545590">int</span><span class="op" id="6545593">,</span>&nbsp;<span class="builtintype" id="6545595">error</span><span class="op" id="6545600">)</span>&nbsp;<span class="op" id="6545602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6545605">panic</span><span class="op" id="6545610">(</span><span class="string" id="6545611">&#34;NOIMPL&#34;</span><span class="op" id="6545619">)</span><br>
<span class="lineno">120</span><span class="op" id="6545621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6545624">func</span>&nbsp;<span class="op" id="6545629">(</span><span class="ident" id="6545630">ho</span>&nbsp;<span class="ident" id="6545633">headerOnlyResponseWriter</span><span class="op" id="6545657">)</span>&nbsp;<span class="ident" id="6545659">WriteHeader</span><span class="op" id="6545670">(</span><span class="builtintype" id="6545671">int</span><span class="op" id="6545674">)</span>&nbsp;<span class="op" id="6545676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6545679">panic</span><span class="op" id="6545684">(</span><span class="string" id="6545685">&#34;NOIMPL&#34;</span><span class="op" id="6545693">)</span><br>
<span class="lineno"></span><span class="op" id="6545695">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6545698">func</span>&nbsp;<span class="ident" id="6545703">TestSetCookie</span><span class="op" id="6545716">(</span><span class="ident" id="6545717">t</span>&nbsp;<span class="op" id="6545719">*</span><span class="ident" id="6545720">testing</span><span class="op" id="6545727">.</span><span class="ident" id="6545728">T</span><span class="op" id="6545729">)</span>&nbsp;<span class="op" id="6545731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545734">m</span>&nbsp;<span class="op" id="6545736">:=</span>&nbsp;<span class="builtinfunc" id="6545739">make</span><span class="op" id="6545743">(</span><span class="ident" id="6545744">Header</span><span class="op" id="6545750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545753">SetCookie</span><span class="op" id="6545762">(</span><span class="ident" id="6545763">headerOnlyResponseWriter</span><span class="op" id="6545787">(</span><span class="ident" id="6545788">m</span><span class="op" id="6545789">)</span><span class="op" id="6545790">,</span>&nbsp;<span class="op" id="6545792">&amp;</span><span class="ident" id="6545793">Cookie</span><span class="op" id="6545799">{</span><span class="ident" id="6545800">Name</span><span class="op" id="6545804">:</span>&nbsp;<span class="string" id="6545806">&#34;cookie-1&#34;</span><span class="op" id="6545816">,</span>&nbsp;<span class="ident" id="6545818">Value</span><span class="op" id="6545823">:</span>&nbsp;<span class="string" id="6545825">&#34;one&#34;</span><span class="op" id="6545830">,</span>&nbsp;<span class="ident" id="6545832">Path</span><span class="op" id="6545836">:</span>&nbsp;<span class="string" id="6545838">&#34;/restricted/&#34;</span><span class="op" id="6545852">}</span><span class="op" id="6545853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545856">SetCookie</span><span class="op" id="6545865">(</span><span class="ident" id="6545866">headerOnlyResponseWriter</span><span class="op" id="6545890">(</span><span class="ident" id="6545891">m</span><span class="op" id="6545892">)</span><span class="op" id="6545893">,</span>&nbsp;<span class="op" id="6545895">&amp;</span><span class="ident" id="6545896">Cookie</span><span class="op" id="6545902">{</span><span class="ident" id="6545903">Name</span><span class="op" id="6545907">:</span>&nbsp;<span class="string" id="6545909">&#34;cookie-2&#34;</span><span class="op" id="6545919">,</span>&nbsp;<span class="ident" id="6545921">Value</span><span class="op" id="6545926">:</span>&nbsp;<span class="string" id="6545928">&#34;two&#34;</span><span class="op" id="6545933">,</span>&nbsp;<span class="ident" id="6545935">MaxAge</span><span class="op" id="6545941">:</span>&nbsp;<span class="num" id="6545943">3600</span><span class="op" id="6545947">}</span><span class="op" id="6545948">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6545951">if</span>&nbsp;<span class="ident" id="6545954">l</span>&nbsp;<span class="op" id="6545956">:=</span>&nbsp;<span class="builtinfunc" id="6545959">len</span><span class="op" id="6545962">(</span><span class="ident" id="6545963">m</span><span class="op" id="6545964">[</span><span class="string" id="6545965">&#34;Set-Cookie&#34;</span><span class="op" id="6545977">]</span><span class="op" id="6545978">)</span><span class="op" id="6545979">;</span>&nbsp;<span class="ident" id="6545981">l</span>&nbsp;<span class="op" id="6545983">!=</span>&nbsp;<span class="num" id="6545986">2</span>&nbsp;<span class="op" id="6545988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545992">t</span><span class="op" id="6545993">.</span><span class="ident" id="6545994">Fatalf</span><span class="op" id="6546000">(</span><span class="string" id="6546001">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6546030">,</span>&nbsp;<span class="num" id="6546032">2</span><span class="op" id="6546033">,</span>&nbsp;<span class="ident" id="6546035">l</span><span class="op" id="6546036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546042">if</span>&nbsp;<span class="ident" id="6546045">g</span><span class="op" id="6546046">,</span>&nbsp;<span class="ident" id="6546048">e</span>&nbsp;<span class="op" id="6546050">:=</span>&nbsp;<span class="ident" id="6546053">m</span><span class="op" id="6546054">[</span><span class="string" id="6546055">&#34;Set-Cookie&#34;</span><span class="op" id="6546067">]</span><span class="op" id="6546068">[</span><span class="num" id="6546069">0</span><span class="op" id="6546070">]</span><span class="op" id="6546071">,</span>&nbsp;<span class="string" id="6546073">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="6546106">;</span>&nbsp;<span class="ident" id="6546108">g</span>&nbsp;<span class="op" id="6546110">!=</span>&nbsp;<span class="ident" id="6546113">e</span>&nbsp;<span class="op" id="6546115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546119">t</span><span class="op" id="6546120">.</span><span class="ident" id="6546121">Errorf</span><span class="op" id="6546127">(</span><span class="string" id="6546128">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6546156">,</span>&nbsp;<span class="ident" id="6546158">e</span><span class="op" id="6546159">,</span>&nbsp;<span class="ident" id="6546161">g</span><span class="op" id="6546162">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546168">if</span>&nbsp;<span class="ident" id="6546171">g</span><span class="op" id="6546172">,</span>&nbsp;<span class="ident" id="6546174">e</span>&nbsp;<span class="op" id="6546176">:=</span>&nbsp;<span class="ident" id="6546179">m</span><span class="op" id="6546180">[</span><span class="string" id="6546181">&#34;Set-Cookie&#34;</span><span class="op" id="6546193">]</span><span class="op" id="6546194">[</span><span class="num" id="6546195">1</span><span class="op" id="6546196">]</span><span class="op" id="6546197">,</span>&nbsp;<span class="string" id="6546199">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="6546227">;</span>&nbsp;<span class="ident" id="6546229">g</span>&nbsp;<span class="op" id="6546231">!=</span>&nbsp;<span class="ident" id="6546234">e</span>&nbsp;<span class="op" id="6546236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546240">t</span><span class="op" id="6546241">.</span><span class="ident" id="6546242">Errorf</span><span class="op" id="6546248">(</span><span class="string" id="6546249">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6546277">,</span>&nbsp;<span class="ident" id="6546279">e</span><span class="op" id="6546280">,</span>&nbsp;<span class="ident" id="6546282">g</span><span class="op" id="6546283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546286">}</span><br>
<span class="lineno"></span><span class="op" id="6546288">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6546291">var</span>&nbsp;<span class="ident" id="6546295">addCookieTests</span>&nbsp;<span class="op" id="6546310">=</span>&nbsp;<span class="op" id="6546312">[</span><span class="op" id="6546313">]</span><span class="keyword" id="6546314">struct</span>&nbsp;<span class="op" id="6546321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546324">Cookies</span>&nbsp;<span class="op" id="6546332">[</span><span class="op" id="6546333">]</span><span class="op" id="6546334">*</span><span class="ident" id="6546335">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546343">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6546351">string</span><br>
<span class="lineno"></span><span class="op" id="6546358">}</span><span class="op" id="6546359">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546366">[</span><span class="op" id="6546367">]</span><span class="op" id="6546368">*</span><span class="ident" id="6546369">Cookie</span><span class="op" id="6546375">{</span><span class="op" id="6546376">}</span><span class="op" id="6546377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546381">&#34;&#34;</span><span class="op" id="6546383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546386">}</span><span class="op" id="6546387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546390">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546394">[</span><span class="op" id="6546395">]</span><span class="op" id="6546396">*</span><span class="ident" id="6546397">Cookie</span><span class="op" id="6546403">{</span><span class="op" id="6546404">{</span><span class="ident" id="6546405">Name</span><span class="op" id="6546409">:</span>&nbsp;<span class="string" id="6546411">&#34;cookie-1&#34;</span><span class="op" id="6546421">,</span>&nbsp;<span class="ident" id="6546423">Value</span><span class="op" id="6546428">:</span>&nbsp;<span class="string" id="6546430">&#34;v$1&#34;</span><span class="op" id="6546435">}</span><span class="op" id="6546436">}</span><span class="op" id="6546437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546441">&#34;cookie-1=v$1&#34;</span><span class="op" id="6546455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546458">}</span><span class="op" id="6546459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546466">[</span><span class="op" id="6546467">]</span><span class="op" id="6546468">*</span><span class="ident" id="6546469">Cookie</span><span class="op" id="6546475">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546480">{</span><span class="ident" id="6546481">Name</span><span class="op" id="6546485">:</span>&nbsp;<span class="string" id="6546487">&#34;cookie-1&#34;</span><span class="op" id="6546497">,</span>&nbsp;<span class="ident" id="6546499">Value</span><span class="op" id="6546504">:</span>&nbsp;<span class="string" id="6546506">&#34;v$1&#34;</span><span class="op" id="6546511">}</span><span class="op" id="6546512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546517">{</span><span class="ident" id="6546518">Name</span><span class="op" id="6546522">:</span>&nbsp;<span class="string" id="6546524">&#34;cookie-2&#34;</span><span class="op" id="6546534">,</span>&nbsp;<span class="ident" id="6546536">Value</span><span class="op" id="6546541">:</span>&nbsp;<span class="string" id="6546543">&#34;v$2&#34;</span><span class="op" id="6546548">}</span><span class="op" id="6546549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546554">{</span><span class="ident" id="6546555">Name</span><span class="op" id="6546559">:</span>&nbsp;<span class="string" id="6546561">&#34;cookie-3&#34;</span><span class="op" id="6546571">,</span>&nbsp;<span class="ident" id="6546573">Value</span><span class="op" id="6546578">:</span>&nbsp;<span class="string" id="6546580">&#34;v$3&#34;</span><span class="op" id="6546585">}</span><span class="op" id="6546586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546590">}</span><span class="op" id="6546591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546595">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="6546637">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546640">}</span><span class="op" id="6546641">,</span><br>
<span class="lineno"></span><span class="op" id="6546643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6546646">func</span>&nbsp;<span class="ident" id="6546651">TestAddCookie</span><span class="op" id="6546664">(</span><span class="ident" id="6546665">t</span>&nbsp;<span class="op" id="6546667">*</span><span class="ident" id="6546668">testing</span><span class="op" id="6546675">.</span><span class="ident" id="6546676">T</span><span class="op" id="6546677">)</span>&nbsp;<span class="op" id="6546679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546682">for</span>&nbsp;<span class="ident" id="6546686">i</span><span class="op" id="6546687">,</span>&nbsp;<span class="ident" id="6546689">tt</span>&nbsp;<span class="op" id="6546692">:=</span>&nbsp;<span class="keyword" id="6546695">range</span>&nbsp;<span class="ident" id="6546701">addCookieTests</span>&nbsp;<span class="op" id="6546716">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546720">req</span><span class="op" id="6546723">,</span>&nbsp;<span class="ident" id="6546725">_</span>&nbsp;<span class="op" id="6546727">:=</span>&nbsp;<span class="ident" id="6546730">NewRequest</span><span class="op" id="6546740">(</span><span class="string" id="6546741">&#34;GET&#34;</span><span class="op" id="6546746">,</span>&nbsp;<span class="string" id="6546748">&#34;http://example.com/&#34;</span><span class="op" id="6546769">,</span>&nbsp;<span class="ident" id="6546771">nil</span><span class="op" id="6546774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546778">for</span>&nbsp;<span class="ident" id="6546782">_</span><span class="op" id="6546783">,</span>&nbsp;<span class="ident" id="6546785">c</span>&nbsp;<span class="op" id="6546787">:=</span>&nbsp;<span class="keyword" id="6546790">range</span>&nbsp;<span class="ident" id="6546796">tt</span><span class="op" id="6546798">.</span><span class="ident" id="6546799">Cookies</span>&nbsp;<span class="op" id="6546807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546812">req</span><span class="op" id="6546815">.</span><span class="ident" id="6546816">AddCookie</span><span class="op" id="6546825">(</span><span class="ident" id="6546826">c</span><span class="op" id="6546827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546835">if</span>&nbsp;<span class="ident" id="6546838">g</span>&nbsp;<span class="op" id="6546840">:=</span>&nbsp;<span class="ident" id="6546843">req</span><span class="op" id="6546846">.</span><span class="ident" id="6546847">Header</span><span class="op" id="6546853">.</span><span class="ident" id="6546854">Get</span><span class="op" id="6546857">(</span><span class="string" id="6546858">&#34;Cookie&#34;</span><span class="op" id="6546866">)</span><span class="op" id="6546867">;</span>&nbsp;<span class="ident" id="6546869">g</span>&nbsp;<span class="op" id="6546871">!=</span>&nbsp;<span class="ident" id="6546874">tt</span><span class="op" id="6546876">.</span><span class="ident" id="6546877">Raw</span>&nbsp;<span class="op" id="6546881">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546886">t</span><span class="op" id="6546887">.</span><span class="ident" id="6546888">Errorf</span><span class="op" id="6546894">(</span><span class="string" id="6546895">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="6546927">,</span>&nbsp;<span class="ident" id="6546929">i</span><span class="op" id="6546930">,</span>&nbsp;<span class="ident" id="6546932">tt</span><span class="op" id="6546934">.</span><span class="ident" id="6546935">Raw</span><span class="op" id="6546938">,</span>&nbsp;<span class="ident" id="6546940">g</span><span class="op" id="6546941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6546946">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546960">}</span><br>
<span class="lineno"></span><span class="op" id="6546962">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6546965">var</span>&nbsp;<span class="ident" id="6546969">readSetCookiesTests</span>&nbsp;<span class="op" id="6546989">=</span>&nbsp;<span class="op" id="6546991">[</span><span class="op" id="6546992">]</span><span class="keyword" id="6546993">struct</span>&nbsp;<span class="op" id="6547000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547003">Header</span>&nbsp;&nbsp;<span class="ident" id="6547011">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547019">Cookies</span>&nbsp;<span class="op" id="6547027">[</span><span class="op" id="6547028">]</span><span class="op" id="6547029">*</span><span class="ident" id="6547030">Cookie</span><br>
<span class="lineno"></span><span class="op" id="6547037">}</span><span class="op" id="6547038">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547045">Header</span><span class="op" id="6547051">{</span><span class="string" id="6547052">&#34;Set-Cookie&#34;</span><span class="op" id="6547064">:</span>&nbsp;<span class="op" id="6547066">{</span><span class="string" id="6547067">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6547081">}</span><span class="op" id="6547082">}</span><span class="op" id="6547083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547087">[</span><span class="op" id="6547088">]</span><span class="op" id="6547089">*</span><span class="ident" id="6547090">Cookie</span><span class="op" id="6547096">{</span><span class="op" id="6547097">{</span><span class="ident" id="6547098">Name</span><span class="op" id="6547102">:</span>&nbsp;<span class="string" id="6547104">&#34;Cookie-1&#34;</span><span class="op" id="6547114">,</span>&nbsp;<span class="ident" id="6547116">Value</span><span class="op" id="6547121">:</span>&nbsp;<span class="string" id="6547123">&#34;v$1&#34;</span><span class="op" id="6547128">,</span>&nbsp;<span class="ident" id="6547130">Raw</span><span class="op" id="6547133">:</span>&nbsp;<span class="string" id="6547135">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6547149">}</span><span class="op" id="6547150">}</span><span class="op" id="6547151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547154">}</span><span class="op" id="6547155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547158">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547162">Header</span><span class="op" id="6547168">{</span><span class="string" id="6547169">&#34;Set-Cookie&#34;</span><span class="op" id="6547181">:</span>&nbsp;<span class="op" id="6547183">{</span><span class="string" id="6547184">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="6547283">}</span><span class="op" id="6547284">}</span><span class="op" id="6547285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547289">[</span><span class="op" id="6547290">]</span><span class="op" id="6547291">*</span><span class="ident" id="6547292">Cookie</span><span class="op" id="6547298">{</span><span class="op" id="6547299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547304">Name</span><span class="op" id="6547308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547316">&#34;NID&#34;</span><span class="op" id="6547321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547326">Value</span><span class="op" id="6547331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547338">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="6547357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547362">Path</span><span class="op" id="6547366">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547374">&#34;/&#34;</span><span class="op" id="6547377">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547382">Domain</span><span class="op" id="6547388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547394">&#34;.google.ch&#34;</span><span class="op" id="6547406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547411">HttpOnly</span><span class="op" id="6547419">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6547423">true</span><span class="op" id="6547427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547432">Expires</span><span class="op" id="6547439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6547444">time</span><span class="op" id="6547448">.</span><span class="ident" id="6547449">Date</span><span class="op" id="6547453">(</span><span class="num" id="6547454">2011</span><span class="op" id="6547458">,</span>&nbsp;<span class="num" id="6547460">11</span><span class="op" id="6547462">,</span>&nbsp;<span class="num" id="6547464">23</span><span class="op" id="6547466">,</span>&nbsp;<span class="num" id="6547468">1</span><span class="op" id="6547469">,</span>&nbsp;<span class="num" id="6547471">5</span><span class="op" id="6547472">,</span>&nbsp;<span class="num" id="6547474">3</span><span class="op" id="6547475">,</span>&nbsp;<span class="num" id="6547477">0</span><span class="op" id="6547478">,</span>&nbsp;<span class="ident" id="6547480">time</span><span class="op" id="6547484">.</span><span class="ident" id="6547485">UTC</span><span class="op" id="6547488">)</span><span class="op" id="6547489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547494">RawExpires</span><span class="op" id="6547504">:</span>&nbsp;<span class="string" id="6547506">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="6547537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547542">Raw</span><span class="op" id="6547545">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547554">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="6547653">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547657">}</span><span class="op" id="6547658">}</span><span class="op" id="6547659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547662">}</span><span class="op" id="6547663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547670">Header</span><span class="op" id="6547676">{</span><span class="string" id="6547677">&#34;Set-Cookie&#34;</span><span class="op" id="6547689">:</span>&nbsp;<span class="op" id="6547691">{</span><span class="string" id="6547692">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6547766">}</span><span class="op" id="6547767">}</span><span class="op" id="6547768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547772">[</span><span class="op" id="6547773">]</span><span class="op" id="6547774">*</span><span class="ident" id="6547775">Cookie</span><span class="op" id="6547781">{</span><span class="op" id="6547782">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547787">Name</span><span class="op" id="6547791">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547799">&#34;.ASPXAUTH&#34;</span><span class="op" id="6547810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547815">Value</span><span class="op" id="6547820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547827">&#34;7E3AA&#34;</span><span class="op" id="6547834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547839">Path</span><span class="op" id="6547843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547851">&#34;/&#34;</span><span class="op" id="6547854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547859">Expires</span><span class="op" id="6547866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6547871">time</span><span class="op" id="6547875">.</span><span class="ident" id="6547876">Date</span><span class="op" id="6547880">(</span><span class="num" id="6547881">2012</span><span class="op" id="6547885">,</span>&nbsp;<span class="num" id="6547887">3</span><span class="op" id="6547888">,</span>&nbsp;<span class="num" id="6547890">7</span><span class="op" id="6547891">,</span>&nbsp;<span class="num" id="6547893">14</span><span class="op" id="6547895">,</span>&nbsp;<span class="num" id="6547897">25</span><span class="op" id="6547899">,</span>&nbsp;<span class="num" id="6547901">6</span><span class="op" id="6547902">,</span>&nbsp;<span class="num" id="6547904">0</span><span class="op" id="6547905">,</span>&nbsp;<span class="ident" id="6547907">time</span><span class="op" id="6547911">.</span><span class="ident" id="6547912">UTC</span><span class="op" id="6547915">)</span><span class="op" id="6547916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547921">RawExpires</span><span class="op" id="6547931">:</span>&nbsp;<span class="string" id="6547933">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="6547964">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547969">HttpOnly</span><span class="op" id="6547977">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6547981">true</span><span class="op" id="6547985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547990">Raw</span><span class="op" id="6547993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548002">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6548076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548080">}</span><span class="op" id="6548081">}</span><span class="op" id="6548082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548085">}</span><span class="op" id="6548086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548089">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548093">Header</span><span class="op" id="6548099">{</span><span class="string" id="6548100">&#34;Set-Cookie&#34;</span><span class="op" id="6548112">:</span>&nbsp;<span class="op" id="6548114">{</span><span class="string" id="6548115">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6548156">}</span><span class="op" id="6548157">}</span><span class="op" id="6548158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548162">[</span><span class="op" id="6548163">]</span><span class="op" id="6548164">*</span><span class="ident" id="6548165">Cookie</span><span class="op" id="6548171">{</span><span class="op" id="6548172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548177">Name</span><span class="op" id="6548181">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548187">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="6548206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548211">Value</span><span class="op" id="6548216">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548221">&#34;foo&#34;</span><span class="op" id="6548226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548231">Path</span><span class="op" id="6548235">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548241">&#34;/&#34;</span><span class="op" id="6548244">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548249">HttpOnly</span><span class="op" id="6548257">:</span>&nbsp;<span class="builtintype" id="6548259">true</span><span class="op" id="6548263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548268">Raw</span><span class="op" id="6548271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548278">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="6548319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548323">}</span><span class="op" id="6548324">}</span><span class="op" id="6548325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548328">}</span><span class="op" id="6548329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6548332">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6548405">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548453">Header</span><span class="op" id="6548459">{</span><span class="string" id="6548460">&#34;Set-Cookie&#34;</span><span class="op" id="6548472">:</span>&nbsp;<span class="op" id="6548474">{</span><span class="string" id="6548475">`special-1=a&nbsp;z`</span><span class="op" id="6548490">}</span><span class="op" id="6548491">}</span><span class="op" id="6548492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548496">[</span><span class="op" id="6548497">]</span><span class="op" id="6548498">*</span><span class="ident" id="6548499">Cookie</span><span class="op" id="6548505">{</span><span class="op" id="6548506">{</span><span class="ident" id="6548507">Name</span><span class="op" id="6548511">:</span>&nbsp;<span class="string" id="6548513">&#34;special-1&#34;</span><span class="op" id="6548524">,</span>&nbsp;<span class="ident" id="6548526">Value</span><span class="op" id="6548531">:</span>&nbsp;<span class="string" id="6548533">&#34;a&nbsp;z&#34;</span><span class="op" id="6548538">,</span>&nbsp;<span class="ident" id="6548540">Raw</span><span class="op" id="6548543">:</span>&nbsp;<span class="string" id="6548545">`special-1=a&nbsp;z`</span><span class="op" id="6548560">}</span><span class="op" id="6548561">}</span><span class="op" id="6548562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548565">}</span><span class="op" id="6548566">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548573">Header</span><span class="op" id="6548579">{</span><span class="string" id="6548580">&#34;Set-Cookie&#34;</span><span class="op" id="6548592">:</span>&nbsp;<span class="op" id="6548594">{</span><span class="string" id="6548595">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6548611">}</span><span class="op" id="6548612">}</span><span class="op" id="6548613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548617">[</span><span class="op" id="6548618">]</span><span class="op" id="6548619">*</span><span class="ident" id="6548620">Cookie</span><span class="op" id="6548626">{</span><span class="op" id="6548627">{</span><span class="ident" id="6548628">Name</span><span class="op" id="6548632">:</span>&nbsp;<span class="string" id="6548634">&#34;special-2&#34;</span><span class="op" id="6548645">,</span>&nbsp;<span class="ident" id="6548647">Value</span><span class="op" id="6548652">:</span>&nbsp;<span class="string" id="6548654">&#34;&nbsp;z&#34;</span><span class="op" id="6548658">,</span>&nbsp;<span class="ident" id="6548660">Raw</span><span class="op" id="6548663">:</span>&nbsp;<span class="string" id="6548665">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="6548681">}</span><span class="op" id="6548682">}</span><span class="op" id="6548683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548686">}</span><span class="op" id="6548687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548690">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548694">Header</span><span class="op" id="6548700">{</span><span class="string" id="6548701">&#34;Set-Cookie&#34;</span><span class="op" id="6548713">:</span>&nbsp;<span class="op" id="6548715">{</span><span class="string" id="6548716">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6548732">}</span><span class="op" id="6548733">}</span><span class="op" id="6548734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548738">[</span><span class="op" id="6548739">]</span><span class="op" id="6548740">*</span><span class="ident" id="6548741">Cookie</span><span class="op" id="6548747">{</span><span class="op" id="6548748">{</span><span class="ident" id="6548749">Name</span><span class="op" id="6548753">:</span>&nbsp;<span class="string" id="6548755">&#34;special-3&#34;</span><span class="op" id="6548766">,</span>&nbsp;<span class="ident" id="6548768">Value</span><span class="op" id="6548773">:</span>&nbsp;<span class="string" id="6548775">&#34;a&nbsp;&#34;</span><span class="op" id="6548779">,</span>&nbsp;<span class="ident" id="6548781">Raw</span><span class="op" id="6548784">:</span>&nbsp;<span class="string" id="6548786">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="6548802">}</span><span class="op" id="6548803">}</span><span class="op" id="6548804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548807">}</span><span class="op" id="6548808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548815">Header</span><span class="op" id="6548821">{</span><span class="string" id="6548822">&#34;Set-Cookie&#34;</span><span class="op" id="6548834">:</span>&nbsp;<span class="op" id="6548836">{</span><span class="string" id="6548837">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6548852">}</span><span class="op" id="6548853">}</span><span class="op" id="6548854">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548858">[</span><span class="op" id="6548859">]</span><span class="op" id="6548860">*</span><span class="ident" id="6548861">Cookie</span><span class="op" id="6548867">{</span><span class="op" id="6548868">{</span><span class="ident" id="6548869">Name</span><span class="op" id="6548873">:</span>&nbsp;<span class="string" id="6548875">&#34;special-4&#34;</span><span class="op" id="6548886">,</span>&nbsp;<span class="ident" id="6548888">Value</span><span class="op" id="6548893">:</span>&nbsp;<span class="string" id="6548895">&#34;&nbsp;&#34;</span><span class="op" id="6548898">,</span>&nbsp;<span class="ident" id="6548900">Raw</span><span class="op" id="6548903">:</span>&nbsp;<span class="string" id="6548905">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="6548920">}</span><span class="op" id="6548921">}</span><span class="op" id="6548922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548925">}</span><span class="op" id="6548926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548933">Header</span><span class="op" id="6548939">{</span><span class="string" id="6548940">&#34;Set-Cookie&#34;</span><span class="op" id="6548952">:</span>&nbsp;<span class="op" id="6548954">{</span><span class="string" id="6548955">`special-5=a,z`</span><span class="op" id="6548970">}</span><span class="op" id="6548971">}</span><span class="op" id="6548972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548976">[</span><span class="op" id="6548977">]</span><span class="op" id="6548978">*</span><span class="ident" id="6548979">Cookie</span><span class="op" id="6548985">{</span><span class="op" id="6548986">{</span><span class="ident" id="6548987">Name</span><span class="op" id="6548991">:</span>&nbsp;<span class="string" id="6548993">&#34;special-5&#34;</span><span class="op" id="6549004">,</span>&nbsp;<span class="ident" id="6549006">Value</span><span class="op" id="6549011">:</span>&nbsp;<span class="string" id="6549013">&#34;a,z&#34;</span><span class="op" id="6549018">,</span>&nbsp;<span class="ident" id="6549020">Raw</span><span class="op" id="6549023">:</span>&nbsp;<span class="string" id="6549025">`special-5=a,z`</span><span class="op" id="6549040">}</span><span class="op" id="6549041">}</span><span class="op" id="6549042">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549045">}</span><span class="op" id="6549046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549053">Header</span><span class="op" id="6549059">{</span><span class="string" id="6549060">&#34;Set-Cookie&#34;</span><span class="op" id="6549072">:</span>&nbsp;<span class="op" id="6549074">{</span><span class="string" id="6549075">`special-6=&#34;,z&#34;`</span><span class="op" id="6549091">}</span><span class="op" id="6549092">}</span><span class="op" id="6549093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549097">[</span><span class="op" id="6549098">]</span><span class="op" id="6549099">*</span><span class="ident" id="6549100">Cookie</span><span class="op" id="6549106">{</span><span class="op" id="6549107">{</span><span class="ident" id="6549108">Name</span><span class="op" id="6549112">:</span>&nbsp;<span class="string" id="6549114">&#34;special-6&#34;</span><span class="op" id="6549125">,</span>&nbsp;<span class="ident" id="6549127">Value</span><span class="op" id="6549132">:</span>&nbsp;<span class="string" id="6549134">&#34;,z&#34;</span><span class="op" id="6549138">,</span>&nbsp;<span class="ident" id="6549140">Raw</span><span class="op" id="6549143">:</span>&nbsp;<span class="string" id="6549145">`special-6=&#34;,z&#34;`</span><span class="op" id="6549161">}</span><span class="op" id="6549162">}</span><span class="op" id="6549163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549166">}</span><span class="op" id="6549167">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549174">Header</span><span class="op" id="6549180">{</span><span class="string" id="6549181">&#34;Set-Cookie&#34;</span><span class="op" id="6549193">:</span>&nbsp;<span class="op" id="6549195">{</span><span class="string" id="6549196">`special-7=a,`</span><span class="op" id="6549210">}</span><span class="op" id="6549211">}</span><span class="op" id="6549212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549216">[</span><span class="op" id="6549217">]</span><span class="op" id="6549218">*</span><span class="ident" id="6549219">Cookie</span><span class="op" id="6549225">{</span><span class="op" id="6549226">{</span><span class="ident" id="6549227">Name</span><span class="op" id="6549231">:</span>&nbsp;<span class="string" id="6549233">&#34;special-7&#34;</span><span class="op" id="6549244">,</span>&nbsp;<span class="ident" id="6549246">Value</span><span class="op" id="6549251">:</span>&nbsp;<span class="string" id="6549253">&#34;a,&#34;</span><span class="op" id="6549257">,</span>&nbsp;<span class="ident" id="6549259">Raw</span><span class="op" id="6549262">:</span>&nbsp;<span class="string" id="6549264">`special-7=a,`</span><span class="op" id="6549278">}</span><span class="op" id="6549279">}</span><span class="op" id="6549280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549283">}</span><span class="op" id="6549284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549287">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549291">Header</span><span class="op" id="6549297">{</span><span class="string" id="6549298">&#34;Set-Cookie&#34;</span><span class="op" id="6549310">:</span>&nbsp;<span class="op" id="6549312">{</span><span class="string" id="6549313">`special-8=&#34;,&#34;`</span><span class="op" id="6549328">}</span><span class="op" id="6549329">}</span><span class="op" id="6549330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549334">[</span><span class="op" id="6549335">]</span><span class="op" id="6549336">*</span><span class="ident" id="6549337">Cookie</span><span class="op" id="6549343">{</span><span class="op" id="6549344">{</span><span class="ident" id="6549345">Name</span><span class="op" id="6549349">:</span>&nbsp;<span class="string" id="6549351">&#34;special-8&#34;</span><span class="op" id="6549362">,</span>&nbsp;<span class="ident" id="6549364">Value</span><span class="op" id="6549369">:</span>&nbsp;<span class="string" id="6549371">&#34;,&#34;</span><span class="op" id="6549374">,</span>&nbsp;<span class="ident" id="6549376">Raw</span><span class="op" id="6549379">:</span>&nbsp;<span class="string" id="6549381">`special-8=&#34;,&#34;`</span><span class="op" id="6549396">}</span><span class="op" id="6549397">}</span><span class="op" id="6549398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549401">}</span><span class="op" id="6549402">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549406">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549465">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549528">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549592">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549603">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="6549747">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="6549750">func</span>&nbsp;<span class="ident" id="6549755">toJSON</span><span class="op" id="6549761">(</span><span class="ident" id="6549762">v</span>&nbsp;<span class="keyword" id="6549764">interface</span><span class="op" id="6549773">{</span><span class="op" id="6549774">}</span><span class="op" id="6549775">)</span>&nbsp;<span class="builtintype" id="6549777">string</span>&nbsp;<span class="op" id="6549784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549787">b</span><span class="op" id="6549788">,</span>&nbsp;<span class="ident" id="6549790">err</span>&nbsp;<span class="op" id="6549794">:=</span>&nbsp;<span class="ident" id="6549797">json</span><span class="op" id="6549801">.</span><span class="ident" id="6549802">Marshal</span><span class="op" id="6549809">(</span><span class="ident" id="6549810">v</span><span class="op" id="6549811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6549814">if</span>&nbsp;<span class="ident" id="6549817">err</span>&nbsp;<span class="op" id="6549821">!=</span>&nbsp;<span class="ident" id="6549824">nil</span>&nbsp;<span class="op" id="6549828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6549832">return</span>&nbsp;<span class="ident" id="6549839">fmt</span><span class="op" id="6549842">.</span><span class="ident" id="6549843">Sprintf</span><span class="op" id="6549850">(</span><span class="string" id="6549851">&#34;%#v&#34;</span><span class="op" id="6549856">,</span>&nbsp;<span class="ident" id="6549858">v</span><span class="op" id="6549859">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6549865">return</span>&nbsp;<span class="builtintype" id="6549872">string</span><span class="op" id="6549878">(</span><span class="ident" id="6549879">b</span><span class="op" id="6549880">)</span><br>
<span class="lineno"></span><span class="op" id="6549882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6549885">func</span>&nbsp;<span class="ident" id="6549890">TestReadSetCookies</span><span class="op" id="6549908">(</span><span class="ident" id="6549909">t</span>&nbsp;<span class="op" id="6549911">*</span><span class="ident" id="6549912">testing</span><span class="op" id="6549919">.</span><span class="ident" id="6549920">T</span><span class="op" id="6549921">)</span>&nbsp;<span class="op" id="6549923">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6549926">for</span>&nbsp;<span class="ident" id="6549930">i</span><span class="op" id="6549931">,</span>&nbsp;<span class="ident" id="6549933">tt</span>&nbsp;<span class="op" id="6549936">:=</span>&nbsp;<span class="keyword" id="6549939">range</span>&nbsp;<span class="ident" id="6549945">readSetCookiesTests</span>&nbsp;<span class="op" id="6549965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6549969">for</span>&nbsp;<span class="ident" id="6549973">n</span>&nbsp;<span class="op" id="6549975">:=</span>&nbsp;<span class="num" id="6549978">0</span><span class="op" id="6549979">;</span>&nbsp;<span class="ident" id="6549981">n</span>&nbsp;<span class="op" id="6549983">&lt;</span>&nbsp;<span class="num" id="6549985">2</span><span class="op" id="6549986">;</span>&nbsp;<span class="ident" id="6549988">n</span><span class="op" id="6549989">++</span>&nbsp;<span class="op" id="6549992">{</span>&nbsp;<span class="comment" id="6549994">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550050">c</span>&nbsp;<span class="op" id="6550052">:=</span>&nbsp;<span class="ident" id="6550055">readSetCookies</span><span class="op" id="6550069">(</span><span class="ident" id="6550070">tt</span><span class="op" id="6550072">.</span><span class="ident" id="6550073">Header</span><span class="op" id="6550079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550084">if</span>&nbsp;<span class="op" id="6550087">!</span><span class="ident" id="6550088">reflect</span><span class="op" id="6550095">.</span><span class="ident" id="6550096">DeepEqual</span><span class="op" id="6550105">(</span><span class="ident" id="6550106">c</span><span class="op" id="6550107">,</span>&nbsp;<span class="ident" id="6550109">tt</span><span class="op" id="6550111">.</span><span class="ident" id="6550112">Cookies</span><span class="op" id="6550119">)</span>&nbsp;<span class="op" id="6550121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550127">t</span><span class="op" id="6550128">.</span><span class="ident" id="6550129">Errorf</span><span class="op" id="6550135">(</span><span class="string" id="6550136">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="6550178">,</span>&nbsp;<span class="ident" id="6550180">i</span><span class="op" id="6550181">,</span>&nbsp;<span class="ident" id="6550183">toJSON</span><span class="op" id="6550189">(</span><span class="ident" id="6550190">c</span><span class="op" id="6550191">)</span><span class="op" id="6550192">,</span>&nbsp;<span class="ident" id="6550194">toJSON</span><span class="op" id="6550200">(</span><span class="ident" id="6550201">tt</span><span class="op" id="6550203">.</span><span class="ident" id="6550204">Cookies</span><span class="op" id="6550211">)</span><span class="op" id="6550212">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550218">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550237">}</span><br>
<span class="lineno"></span><span class="op" id="6550239">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="6550242">var</span>&nbsp;<span class="ident" id="6550246">readCookiesTests</span>&nbsp;<span class="op" id="6550263">=</span>&nbsp;<span class="op" id="6550265">[</span><span class="op" id="6550266">]</span><span class="keyword" id="6550267">struct</span>&nbsp;<span class="op" id="6550274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550277">Header</span>&nbsp;&nbsp;<span class="ident" id="6550285">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550293">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="6550301">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550309">Cookies</span>&nbsp;<span class="op" id="6550317">[</span><span class="op" id="6550318">]</span><span class="op" id="6550319">*</span><span class="ident" id="6550320">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="6550327">}</span><span class="op" id="6550328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550335">Header</span><span class="op" id="6550341">{</span><span class="string" id="6550342">&#34;Cookie&#34;</span><span class="op" id="6550350">:</span>&nbsp;<span class="op" id="6550352">{</span><span class="string" id="6550353">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6550367">,</span>&nbsp;<span class="string" id="6550369">&#34;c2=v2&#34;</span><span class="op" id="6550376">}</span><span class="op" id="6550377">}</span><span class="op" id="6550378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550382">&#34;&#34;</span><span class="op" id="6550384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550388">[</span><span class="op" id="6550389">]</span><span class="op" id="6550390">*</span><span class="ident" id="6550391">Cookie</span><span class="op" id="6550397">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550402">{</span><span class="ident" id="6550403">Name</span><span class="op" id="6550407">:</span>&nbsp;<span class="string" id="6550409">&#34;Cookie-1&#34;</span><span class="op" id="6550419">,</span>&nbsp;<span class="ident" id="6550421">Value</span><span class="op" id="6550426">:</span>&nbsp;<span class="string" id="6550428">&#34;v$1&#34;</span><span class="op" id="6550433">}</span><span class="op" id="6550434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550439">{</span><span class="ident" id="6550440">Name</span><span class="op" id="6550444">:</span>&nbsp;<span class="string" id="6550446">&#34;c2&#34;</span><span class="op" id="6550450">,</span>&nbsp;<span class="ident" id="6550452">Value</span><span class="op" id="6550457">:</span>&nbsp;<span class="string" id="6550459">&#34;v2&#34;</span><span class="op" id="6550463">}</span><span class="op" id="6550464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550468">}</span><span class="op" id="6550469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550472">}</span><span class="op" id="6550473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550476">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550480">Header</span><span class="op" id="6550486">{</span><span class="string" id="6550487">&#34;Cookie&#34;</span><span class="op" id="6550495">:</span>&nbsp;<span class="op" id="6550497">{</span><span class="string" id="6550498">&#34;Cookie-1=v$1&#34;</span><span class="op" id="6550512">,</span>&nbsp;<span class="string" id="6550514">&#34;c2=v2&#34;</span><span class="op" id="6550521">}</span><span class="op" id="6550522">}</span><span class="op" id="6550523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550527">&#34;c2&#34;</span><span class="op" id="6550531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550535">[</span><span class="op" id="6550536">]</span><span class="op" id="6550537">*</span><span class="ident" id="6550538">Cookie</span><span class="op" id="6550544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550549">{</span><span class="ident" id="6550550">Name</span><span class="op" id="6550554">:</span>&nbsp;<span class="string" id="6550556">&#34;c2&#34;</span><span class="op" id="6550560">,</span>&nbsp;<span class="ident" id="6550562">Value</span><span class="op" id="6550567">:</span>&nbsp;<span class="string" id="6550569">&#34;v2&#34;</span><span class="op" id="6550573">}</span><span class="op" id="6550574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550578">}</span><span class="op" id="6550579">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550582">}</span><span class="op" id="6550583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550590">Header</span><span class="op" id="6550596">{</span><span class="string" id="6550597">&#34;Cookie&#34;</span><span class="op" id="6550605">:</span>&nbsp;<span class="op" id="6550607">{</span><span class="string" id="6550608">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="6550629">}</span><span class="op" id="6550630">}</span><span class="op" id="6550631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550635">&#34;&#34;</span><span class="op" id="6550637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550641">[</span><span class="op" id="6550642">]</span><span class="op" id="6550643">*</span><span class="ident" id="6550644">Cookie</span><span class="op" id="6550650">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550655">{</span><span class="ident" id="6550656">Name</span><span class="op" id="6550660">:</span>&nbsp;<span class="string" id="6550662">&#34;Cookie-1&#34;</span><span class="op" id="6550672">,</span>&nbsp;<span class="ident" id="6550674">Value</span><span class="op" id="6550679">:</span>&nbsp;<span class="string" id="6550681">&#34;v$1&#34;</span><span class="op" id="6550686">}</span><span class="op" id="6550687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550692">{</span><span class="ident" id="6550693">Name</span><span class="op" id="6550697">:</span>&nbsp;<span class="string" id="6550699">&#34;c2&#34;</span><span class="op" id="6550703">,</span>&nbsp;<span class="ident" id="6550705">Value</span><span class="op" id="6550710">:</span>&nbsp;<span class="string" id="6550712">&#34;v2&#34;</span><span class="op" id="6550716">}</span><span class="op" id="6550717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550721">}</span><span class="op" id="6550722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550725">}</span><span class="op" id="6550726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550729">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550733">Header</span><span class="op" id="6550739">{</span><span class="string" id="6550740">&#34;Cookie&#34;</span><span class="op" id="6550748">:</span>&nbsp;<span class="op" id="6550750">{</span><span class="string" id="6550751">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="6550772">}</span><span class="op" id="6550773">}</span><span class="op" id="6550774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550778">&#34;c2&#34;</span><span class="op" id="6550782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550786">[</span><span class="op" id="6550787">]</span><span class="op" id="6550788">*</span><span class="ident" id="6550789">Cookie</span><span class="op" id="6550795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550800">{</span><span class="ident" id="6550801">Name</span><span class="op" id="6550805">:</span>&nbsp;<span class="string" id="6550807">&#34;c2&#34;</span><span class="op" id="6550811">,</span>&nbsp;<span class="ident" id="6550813">Value</span><span class="op" id="6550818">:</span>&nbsp;<span class="string" id="6550820">&#34;v2&#34;</span><span class="op" id="6550824">}</span><span class="op" id="6550825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550829">}</span><span class="op" id="6550830">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550833">}</span><span class="op" id="6550834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550841">Header</span><span class="op" id="6550847">{</span><span class="string" id="6550848">&#34;Cookie&#34;</span><span class="op" id="6550856">:</span>&nbsp;<span class="op" id="6550858">{</span><span class="string" id="6550859">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="6550884">}</span><span class="op" id="6550885">}</span><span class="op" id="6550886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550890">&#34;&#34;</span><span class="op" id="6550892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550896">[</span><span class="op" id="6550897">]</span><span class="op" id="6550898">*</span><span class="ident" id="6550899">Cookie</span><span class="op" id="6550905">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550910">{</span><span class="ident" id="6550911">Name</span><span class="op" id="6550915">:</span>&nbsp;<span class="string" id="6550917">&#34;Cookie-1&#34;</span><span class="op" id="6550927">,</span>&nbsp;<span class="ident" id="6550929">Value</span><span class="op" id="6550934">:</span>&nbsp;<span class="string" id="6550936">&#34;v$1&#34;</span><span class="op" id="6550941">}</span><span class="op" id="6550942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550947">{</span><span class="ident" id="6550948">Name</span><span class="op" id="6550952">:</span>&nbsp;<span class="string" id="6550954">&#34;c2&#34;</span><span class="op" id="6550958">,</span>&nbsp;<span class="ident" id="6550960">Value</span><span class="op" id="6550965">:</span>&nbsp;<span class="string" id="6550967">&#34;v2&#34;</span><span class="op" id="6550971">}</span><span class="op" id="6550972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550976">}</span><span class="op" id="6550977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550980">}</span><span class="op" id="6550981">,</span><br>
<span class="lineno"></span><span class="op" id="6550983">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="6550986">func</span>&nbsp;<span class="ident" id="6550991">TestReadCookies</span><span class="op" id="6551006">(</span><span class="ident" id="6551007">t</span>&nbsp;<span class="op" id="6551009">*</span><span class="ident" id="6551010">testing</span><span class="op" id="6551017">.</span><span class="ident" id="6551018">T</span><span class="op" id="6551019">)</span>&nbsp;<span class="op" id="6551021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551024">for</span>&nbsp;<span class="ident" id="6551028">i</span><span class="op" id="6551029">,</span>&nbsp;<span class="ident" id="6551031">tt</span>&nbsp;<span class="op" id="6551034">:=</span>&nbsp;<span class="keyword" id="6551037">range</span>&nbsp;<span class="ident" id="6551043">readCookiesTests</span>&nbsp;<span class="op" id="6551060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551064">for</span>&nbsp;<span class="ident" id="6551068">n</span>&nbsp;<span class="op" id="6551070">:=</span>&nbsp;<span class="num" id="6551073">0</span><span class="op" id="6551074">;</span>&nbsp;<span class="ident" id="6551076">n</span>&nbsp;<span class="op" id="6551078">&lt;</span>&nbsp;<span class="num" id="6551080">2</span><span class="op" id="6551081">;</span>&nbsp;<span class="ident" id="6551083">n</span><span class="op" id="6551084">++</span>&nbsp;<span class="op" id="6551087">{</span>&nbsp;<span class="comment" id="6551089">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551142">c</span>&nbsp;<span class="op" id="6551144">:=</span>&nbsp;<span class="ident" id="6551147">readCookies</span><span class="op" id="6551158">(</span><span class="ident" id="6551159">tt</span><span class="op" id="6551161">.</span><span class="ident" id="6551162">Header</span><span class="op" id="6551168">,</span>&nbsp;<span class="ident" id="6551170">tt</span><span class="op" id="6551172">.</span><span class="ident" id="6551173">Filter</span><span class="op" id="6551179">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551184">if</span>&nbsp;<span class="op" id="6551187">!</span><span class="ident" id="6551188">reflect</span><span class="op" id="6551195">.</span><span class="ident" id="6551196">DeepEqual</span><span class="op" id="6551205">(</span><span class="ident" id="6551206">c</span><span class="op" id="6551207">,</span>&nbsp;<span class="ident" id="6551209">tt</span><span class="op" id="6551211">.</span><span class="ident" id="6551212">Cookies</span><span class="op" id="6551219">)</span>&nbsp;<span class="op" id="6551221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551227">t</span><span class="op" id="6551228">.</span><span class="ident" id="6551229">Errorf</span><span class="op" id="6551235">(</span><span class="string" id="6551236">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="6551276">,</span>&nbsp;<span class="ident" id="6551278">i</span><span class="op" id="6551279">,</span>&nbsp;<span class="ident" id="6551281">toJSON</span><span class="op" id="6551287">(</span><span class="ident" id="6551288">c</span><span class="op" id="6551289">)</span><span class="op" id="6551290">,</span>&nbsp;<span class="ident" id="6551292">toJSON</span><span class="op" id="6551298">(</span><span class="ident" id="6551299">tt</span><span class="op" id="6551301">.</span><span class="ident" id="6551302">Cookies</span><span class="op" id="6551309">)</span><span class="op" id="6551310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551316">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551332">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551335">}</span><br>
<span class="lineno"></span><span class="op" id="6551337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6551340">func</span>&nbsp;<span class="ident" id="6551345">TestSetCookieDoubleQuotes</span><span class="op" id="6551370">(</span><span class="ident" id="6551371">t</span>&nbsp;<span class="op" id="6551373">*</span><span class="ident" id="6551374">testing</span><span class="op" id="6551381">.</span><span class="ident" id="6551382">T</span><span class="op" id="6551383">)</span>&nbsp;<span class="op" id="6551385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551388">res</span>&nbsp;<span class="op" id="6551392">:=</span>&nbsp;<span class="op" id="6551395">&amp;</span><span class="ident" id="6551396">Response</span><span class="op" id="6551404">{</span><span class="ident" id="6551405">Header</span><span class="op" id="6551411">:</span>&nbsp;<span class="ident" id="6551413">Header</span><span class="op" id="6551419">{</span><span class="op" id="6551420">}</span><span class="op" id="6551421">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551424">res</span><span class="op" id="6551427">.</span><span class="ident" id="6551428">Header</span><span class="op" id="6551434">.</span><span class="ident" id="6551435">Add</span><span class="op" id="6551438">(</span><span class="string" id="6551439">&#34;Set-Cookie&#34;</span><span class="op" id="6551451">,</span>&nbsp;<span class="string" id="6551453">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="6551479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551482">res</span><span class="op" id="6551485">.</span><span class="ident" id="6551486">Header</span><span class="op" id="6551492">.</span><span class="ident" id="6551493">Add</span><span class="op" id="6551496">(</span><span class="string" id="6551497">&#34;Set-Cookie&#34;</span><span class="op" id="6551509">,</span>&nbsp;<span class="string" id="6551511">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="6551546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551549">res</span><span class="op" id="6551552">.</span><span class="ident" id="6551553">Header</span><span class="op" id="6551559">.</span><span class="ident" id="6551560">Add</span><span class="op" id="6551563">(</span><span class="string" id="6551564">&#34;Set-Cookie&#34;</span><span class="op" id="6551576">,</span>&nbsp;<span class="string" id="6551578">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="6551610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551613">res</span><span class="op" id="6551616">.</span><span class="ident" id="6551617">Header</span><span class="op" id="6551623">.</span><span class="ident" id="6551624">Add</span><span class="op" id="6551627">(</span><span class="string" id="6551628">&#34;Set-Cookie&#34;</span><span class="op" id="6551640">,</span>&nbsp;<span class="string" id="6551642">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="6551672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551675">got</span>&nbsp;<span class="op" id="6551679">:=</span>&nbsp;<span class="ident" id="6551682">res</span><span class="op" id="6551685">.</span><span class="ident" id="6551686">Cookies</span><span class="op" id="6551693">(</span><span class="op" id="6551694">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551697">want</span>&nbsp;<span class="op" id="6551702">:=</span>&nbsp;<span class="op" id="6551705">[</span><span class="op" id="6551706">]</span><span class="op" id="6551707">*</span><span class="ident" id="6551708">Cookie</span><span class="op" id="6551714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551718">{</span><span class="ident" id="6551719">Name</span><span class="op" id="6551723">:</span>&nbsp;<span class="string" id="6551725">&#34;quoted0&#34;</span><span class="op" id="6551734">,</span>&nbsp;<span class="ident" id="6551736">Value</span><span class="op" id="6551741">:</span>&nbsp;<span class="string" id="6551743">&#34;none&#34;</span><span class="op" id="6551749">,</span>&nbsp;<span class="ident" id="6551751">MaxAge</span><span class="op" id="6551757">:</span>&nbsp;<span class="num" id="6551759">30</span><span class="op" id="6551761">}</span><span class="op" id="6551762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551766">{</span><span class="ident" id="6551767">Name</span><span class="op" id="6551771">:</span>&nbsp;<span class="string" id="6551773">&#34;quoted1&#34;</span><span class="op" id="6551782">,</span>&nbsp;<span class="ident" id="6551784">Value</span><span class="op" id="6551789">:</span>&nbsp;<span class="string" id="6551791">&#34;cookieValue&#34;</span><span class="op" id="6551804">,</span>&nbsp;<span class="ident" id="6551806">MaxAge</span><span class="op" id="6551812">:</span>&nbsp;<span class="num" id="6551814">31</span><span class="op" id="6551816">}</span><span class="op" id="6551817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551821">{</span><span class="ident" id="6551822">Name</span><span class="op" id="6551826">:</span>&nbsp;<span class="string" id="6551828">&#34;quoted2&#34;</span><span class="op" id="6551837">,</span>&nbsp;<span class="ident" id="6551839">Value</span><span class="op" id="6551844">:</span>&nbsp;<span class="string" id="6551846">&#34;cookieAV&#34;</span><span class="op" id="6551856">}</span><span class="op" id="6551857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551861">{</span><span class="ident" id="6551862">Name</span><span class="op" id="6551866">:</span>&nbsp;<span class="string" id="6551868">&#34;quoted3&#34;</span><span class="op" id="6551877">,</span>&nbsp;<span class="ident" id="6551879">Value</span><span class="op" id="6551884">:</span>&nbsp;<span class="string" id="6551886">&#34;both&#34;</span><span class="op" id="6551892">}</span><span class="op" id="6551893">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551899">if</span>&nbsp;<span class="builtinfunc" id="6551902">len</span><span class="op" id="6551905">(</span><span class="ident" id="6551906">got</span><span class="op" id="6551909">)</span>&nbsp;<span class="op" id="6551911">!=</span>&nbsp;<span class="builtinfunc" id="6551914">len</span><span class="op" id="6551917">(</span><span class="ident" id="6551918">want</span><span class="op" id="6551922">)</span>&nbsp;<span class="op" id="6551924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551928">t</span><span class="op" id="6551929">.</span><span class="ident" id="6551930">Fatal</span><span class="op" id="6551935">(</span><span class="string" id="6551936">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6551961">,</span>&nbsp;<span class="builtinfunc" id="6551963">len</span><span class="op" id="6551966">(</span><span class="ident" id="6551967">got</span><span class="op" id="6551970">)</span><span class="op" id="6551971">,</span>&nbsp;<span class="builtinfunc" id="6551973">len</span><span class="op" id="6551976">(</span><span class="ident" id="6551977">want</span><span class="op" id="6551981">)</span><span class="op" id="6551982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551988">for</span>&nbsp;<span class="ident" id="6551992">i</span><span class="op" id="6551993">,</span>&nbsp;<span class="ident" id="6551995">w</span>&nbsp;<span class="op" id="6551997">:=</span>&nbsp;<span class="keyword" id="6552000">range</span>&nbsp;<span class="ident" id="6552006">want</span>&nbsp;<span class="op" id="6552011">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552015">g</span>&nbsp;<span class="op" id="6552017">:=</span>&nbsp;<span class="ident" id="6552020">got</span><span class="op" id="6552023">[</span><span class="ident" id="6552024">i</span><span class="op" id="6552025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552029">if</span>&nbsp;<span class="ident" id="6552032">g</span><span class="op" id="6552033">.</span><span class="ident" id="6552034">Name</span>&nbsp;<span class="op" id="6552039">!=</span>&nbsp;<span class="ident" id="6552042">w</span><span class="op" id="6552043">.</span><span class="ident" id="6552044">Name</span>&nbsp;<span class="op" id="6552049">||</span>&nbsp;<span class="ident" id="6552052">g</span><span class="op" id="6552053">.</span><span class="ident" id="6552054">Value</span>&nbsp;<span class="op" id="6552060">!=</span>&nbsp;<span class="ident" id="6552063">w</span><span class="op" id="6552064">.</span><span class="ident" id="6552065">Value</span>&nbsp;<span class="op" id="6552071">||</span>&nbsp;<span class="ident" id="6552074">g</span><span class="op" id="6552075">.</span><span class="ident" id="6552076">MaxAge</span>&nbsp;<span class="op" id="6552083">!=</span>&nbsp;<span class="ident" id="6552086">w</span><span class="op" id="6552087">.</span><span class="ident" id="6552088">MaxAge</span>&nbsp;<span class="op" id="6552095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552100">t</span><span class="op" id="6552101">.</span><span class="ident" id="6552102">Errorf</span><span class="op" id="6552108">(</span><span class="string" id="6552109">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="6552140">,</span>&nbsp;<span class="ident" id="6552142">i</span><span class="op" id="6552143">,</span>&nbsp;<span class="ident" id="6552145">g</span><span class="op" id="6552146">,</span>&nbsp;<span class="ident" id="6552148">w</span><span class="op" id="6552149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552156">}</span><br>
<span class="lineno">360</span><span class="op" id="6552158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6552161">func</span>&nbsp;<span class="ident" id="6552166">TestCookieSanitizeValue</span><span class="op" id="6552189">(</span><span class="ident" id="6552190">t</span>&nbsp;<span class="op" id="6552192">*</span><span class="ident" id="6552193">testing</span><span class="op" id="6552200">.</span><span class="ident" id="6552201">T</span><span class="op" id="6552202">)</span>&nbsp;<span class="op" id="6552204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552207">defer</span>&nbsp;<span class="ident" id="6552213">log</span><span class="op" id="6552216">.</span><span class="ident" id="6552217">SetOutput</span><span class="op" id="6552226">(</span><span class="ident" id="6552227">os</span><span class="op" id="6552229">.</span><span class="ident" id="6552230">Stderr</span><span class="op" id="6552236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552239">var</span>&nbsp;<span class="ident" id="6552243">logbuf</span>&nbsp;<span class="ident" id="6552250">bytes</span><span class="op" id="6552255">.</span><span class="ident" id="6552256">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552264">log</span><span class="op" id="6552267">.</span><span class="ident" id="6552268">SetOutput</span><span class="op" id="6552277">(</span><span class="op" id="6552278">&amp;</span><span class="ident" id="6552279">logbuf</span><span class="op" id="6552285">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552289">tests</span>&nbsp;<span class="op" id="6552295">:=</span>&nbsp;<span class="op" id="6552298">[</span><span class="op" id="6552299">]</span><span class="keyword" id="6552300">struct</span>&nbsp;<span class="op" id="6552307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552311">in</span><span class="op" id="6552313">,</span>&nbsp;<span class="ident" id="6552315">want</span>&nbsp;<span class="builtintype" id="6552320">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552328">}</span><span class="op" id="6552329">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552333">{</span><span class="string" id="6552334">&#34;foo&#34;</span><span class="op" id="6552339">,</span>&nbsp;<span class="string" id="6552341">&#34;foo&#34;</span><span class="op" id="6552346">}</span><span class="op" id="6552347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552351">{</span><span class="string" id="6552352">&#34;foo;bar&#34;</span><span class="op" id="6552361">,</span>&nbsp;<span class="string" id="6552363">&#34;foobar&#34;</span><span class="op" id="6552371">}</span><span class="op" id="6552372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552376">{</span><span class="string" id="6552377">&#34;foo\\bar&#34;</span><span class="op" id="6552387">,</span>&nbsp;<span class="string" id="6552389">&#34;foobar&#34;</span><span class="op" id="6552397">}</span><span class="op" id="6552398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552402">{</span><span class="string" id="6552403">&#34;foo\&#34;bar&#34;</span><span class="op" id="6552413">,</span>&nbsp;<span class="string" id="6552415">&#34;foobar&#34;</span><span class="op" id="6552423">}</span><span class="op" id="6552424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552428">{</span><span class="string" id="6552429">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="6552447">,</span>&nbsp;<span class="string" id="6552449">&#34;\x7e&#34;</span><span class="op" id="6552455">}</span><span class="op" id="6552456">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552460">{</span><span class="string" id="6552461">`&#34;withquotes&#34;`</span><span class="op" id="6552475">,</span>&nbsp;<span class="string" id="6552477">&#34;withquotes&#34;</span><span class="op" id="6552489">}</span><span class="op" id="6552490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552494">{</span><span class="string" id="6552495">&#34;a&nbsp;z&#34;</span><span class="op" id="6552500">,</span>&nbsp;<span class="string" id="6552502">&#34;a&nbsp;z&#34;</span><span class="op" id="6552507">}</span><span class="op" id="6552508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552512">{</span><span class="string" id="6552513">&#34;&nbsp;z&#34;</span><span class="op" id="6552517">,</span>&nbsp;<span class="string" id="6552519">`&#34;&nbsp;z&#34;`</span><span class="op" id="6552525">}</span><span class="op" id="6552526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552530">{</span><span class="string" id="6552531">&#34;a&nbsp;&#34;</span><span class="op" id="6552535">,</span>&nbsp;<span class="string" id="6552537">`&#34;a&nbsp;&#34;`</span><span class="op" id="6552543">}</span><span class="op" id="6552544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552547">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552550">for</span>&nbsp;<span class="ident" id="6552554">_</span><span class="op" id="6552555">,</span>&nbsp;<span class="ident" id="6552557">tt</span>&nbsp;<span class="op" id="6552560">:=</span>&nbsp;<span class="keyword" id="6552563">range</span>&nbsp;<span class="ident" id="6552569">tests</span>&nbsp;<span class="op" id="6552575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552579">if</span>&nbsp;<span class="ident" id="6552582">got</span>&nbsp;<span class="op" id="6552586">:=</span>&nbsp;<span class="ident" id="6552589">sanitizeCookieValue</span><span class="op" id="6552608">(</span><span class="ident" id="6552609">tt</span><span class="op" id="6552611">.</span><span class="ident" id="6552612">in</span><span class="op" id="6552614">)</span><span class="op" id="6552615">;</span>&nbsp;<span class="ident" id="6552617">got</span>&nbsp;<span class="op" id="6552621">!=</span>&nbsp;<span class="ident" id="6552624">tt</span><span class="op" id="6552626">.</span><span class="ident" id="6552627">want</span>&nbsp;<span class="op" id="6552632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552637">t</span><span class="op" id="6552638">.</span><span class="ident" id="6552639">Errorf</span><span class="op" id="6552645">(</span><span class="string" id="6552646">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6552685">,</span>&nbsp;<span class="ident" id="6552687">tt</span><span class="op" id="6552689">.</span><span class="ident" id="6552690">in</span><span class="op" id="6552692">,</span>&nbsp;<span class="ident" id="6552694">got</span><span class="op" id="6552697">,</span>&nbsp;<span class="ident" id="6552699">tt</span><span class="op" id="6552701">.</span><span class="ident" id="6552702">want</span><span class="op" id="6552706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552713">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552717">if</span>&nbsp;<span class="ident" id="6552720">got</span><span class="op" id="6552723">,</span>&nbsp;<span class="ident" id="6552725">sub</span>&nbsp;<span class="op" id="6552729">:=</span>&nbsp;<span class="ident" id="6552732">logbuf</span><span class="op" id="6552738">.</span><span class="ident" id="6552739">String</span><span class="op" id="6552745">(</span><span class="op" id="6552746">)</span><span class="op" id="6552747">,</span>&nbsp;<span class="string" id="6552749">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="6552773">;</span>&nbsp;<span class="op" id="6552775">!</span><span class="ident" id="6552776">strings</span><span class="op" id="6552783">.</span><span class="ident" id="6552784">Contains</span><span class="op" id="6552792">(</span><span class="ident" id="6552793">got</span><span class="op" id="6552796">,</span>&nbsp;<span class="ident" id="6552798">sub</span><span class="op" id="6552801">)</span>&nbsp;<span class="op" id="6552803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552807">t</span><span class="op" id="6552808">.</span><span class="ident" id="6552809">Errorf</span><span class="op" id="6552815">(</span><span class="string" id="6552816">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6552863">,</span>&nbsp;<span class="ident" id="6552865">sub</span><span class="op" id="6552868">,</span>&nbsp;<span class="ident" id="6552870">got</span><span class="op" id="6552873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552876">}</span><br>
<span class="lineno"></span><span class="op" id="6552878">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="6552881">func</span>&nbsp;<span class="ident" id="6552886">TestCookieSanitizePath</span><span class="op" id="6552908">(</span><span class="ident" id="6552909">t</span>&nbsp;<span class="op" id="6552911">*</span><span class="ident" id="6552912">testing</span><span class="op" id="6552919">.</span><span class="ident" id="6552920">T</span><span class="op" id="6552921">)</span>&nbsp;<span class="op" id="6552923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552926">defer</span>&nbsp;<span class="ident" id="6552932">log</span><span class="op" id="6552935">.</span><span class="ident" id="6552936">SetOutput</span><span class="op" id="6552945">(</span><span class="ident" id="6552946">os</span><span class="op" id="6552948">.</span><span class="ident" id="6552949">Stderr</span><span class="op" id="6552955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552958">var</span>&nbsp;<span class="ident" id="6552962">logbuf</span>&nbsp;<span class="ident" id="6552969">bytes</span><span class="op" id="6552974">.</span><span class="ident" id="6552975">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552983">log</span><span class="op" id="6552986">.</span><span class="ident" id="6552987">SetOutput</span><span class="op" id="6552996">(</span><span class="op" id="6552997">&amp;</span><span class="ident" id="6552998">logbuf</span><span class="op" id="6553004">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553008">tests</span>&nbsp;<span class="op" id="6553014">:=</span>&nbsp;<span class="op" id="6553017">[</span><span class="op" id="6553018">]</span><span class="keyword" id="6553019">struct</span>&nbsp;<span class="op" id="6553026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553030">in</span><span class="op" id="6553032">,</span>&nbsp;<span class="ident" id="6553034">want</span>&nbsp;<span class="builtintype" id="6553039">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553047">}</span><span class="op" id="6553048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553052">{</span><span class="string" id="6553053">&#34;/path&#34;</span><span class="op" id="6553060">,</span>&nbsp;<span class="string" id="6553062">&#34;/path&#34;</span><span class="op" id="6553069">}</span><span class="op" id="6553070">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553074">{</span><span class="string" id="6553075">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="6553094">,</span>&nbsp;<span class="string" id="6553096">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="6553115">}</span><span class="op" id="6553116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553120">{</span><span class="string" id="6553121">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="6553153">,</span>&nbsp;<span class="string" id="6553155">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="6553181">}</span><span class="op" id="6553182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553188">for</span>&nbsp;<span class="ident" id="6553192">_</span><span class="op" id="6553193">,</span>&nbsp;<span class="ident" id="6553195">tt</span>&nbsp;<span class="op" id="6553198">:=</span>&nbsp;<span class="keyword" id="6553201">range</span>&nbsp;<span class="ident" id="6553207">tests</span>&nbsp;<span class="op" id="6553213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553217">if</span>&nbsp;<span class="ident" id="6553220">got</span>&nbsp;<span class="op" id="6553224">:=</span>&nbsp;<span class="ident" id="6553227">sanitizeCookiePath</span><span class="op" id="6553245">(</span><span class="ident" id="6553246">tt</span><span class="op" id="6553248">.</span><span class="ident" id="6553249">in</span><span class="op" id="6553251">)</span><span class="op" id="6553252">;</span>&nbsp;<span class="ident" id="6553254">got</span>&nbsp;<span class="op" id="6553258">!=</span>&nbsp;<span class="ident" id="6553261">tt</span><span class="op" id="6553263">.</span><span class="ident" id="6553264">want</span>&nbsp;<span class="op" id="6553269">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553274">t</span><span class="op" id="6553275">.</span><span class="ident" id="6553276">Errorf</span><span class="op" id="6553282">(</span><span class="string" id="6553283">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6553321">,</span>&nbsp;<span class="ident" id="6553323">tt</span><span class="op" id="6553325">.</span><span class="ident" id="6553326">in</span><span class="op" id="6553328">,</span>&nbsp;<span class="ident" id="6553330">got</span><span class="op" id="6553333">,</span>&nbsp;<span class="ident" id="6553335">tt</span><span class="op" id="6553337">.</span><span class="ident" id="6553338">want</span><span class="op" id="6553342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553353">if</span>&nbsp;<span class="ident" id="6553356">got</span><span class="op" id="6553359">,</span>&nbsp;<span class="ident" id="6553361">sub</span>&nbsp;<span class="op" id="6553365">:=</span>&nbsp;<span class="ident" id="6553368">logbuf</span><span class="op" id="6553374">.</span><span class="ident" id="6553375">String</span><span class="op" id="6553381">(</span><span class="op" id="6553382">)</span><span class="op" id="6553383">,</span>&nbsp;<span class="string" id="6553385">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="6553409">;</span>&nbsp;<span class="op" id="6553411">!</span><span class="ident" id="6553412">strings</span><span class="op" id="6553419">.</span><span class="ident" id="6553420">Contains</span><span class="op" id="6553428">(</span><span class="ident" id="6553429">got</span><span class="op" id="6553432">,</span>&nbsp;<span class="ident" id="6553434">sub</span><span class="op" id="6553437">)</span>&nbsp;<span class="op" id="6553439">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553443">t</span><span class="op" id="6553444">.</span><span class="ident" id="6553445">Errorf</span><span class="op" id="6553451">(</span><span class="string" id="6553452">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="6553499">,</span>&nbsp;<span class="ident" id="6553501">sub</span><span class="op" id="6553504">,</span>&nbsp;<span class="ident" id="6553506">got</span><span class="op" id="6553509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553512">}</span><br>
<span class="lineno"></span><span class="op" id="6553514">}</span>
</div>
</body>
</html>
