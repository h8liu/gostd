<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1637310">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1637365">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1637419">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1637470">package</span>&nbsp;<span class="ident" id="1637478">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1637484">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1637524">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1637584">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="1637648">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="1637706">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1637764">//</span><br>
<span class="lineno"></span><span class="comment" id="1637767">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="1637781">//</span><br>
<span class="lineno"></span><span class="comment" id="1637784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="1637806">//</span><br>
<span class="lineno">20</span><span class="comment" id="1637809">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1637822">//</span><br>
<span class="lineno"></span><span class="comment" id="1637825">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="1637848">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1637865">//</span><br>
<span class="lineno">25</span><span class="comment" id="1637868">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1637884">//</span><br>
<span class="lineno"></span><span class="comment" id="1637887">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1637964">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="1638034">//</span><br>
<span class="lineno">30</span><span class="comment" id="1638037">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1638093">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1638143">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1638171">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="1638225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="1638253">//</span><br>
<span class="lineno"></span><span class="comment" id="1638256">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1638269">//</span><br>
<span class="lineno"></span><span class="comment" id="1638272">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1638312">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1638371">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="1638432">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1638493">//</span><br>
<span class="lineno"></span><span class="comment" id="1638496">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="1638574">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="1638650">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="1638692">//</span><br>
<span class="lineno"></span><span class="comment" id="1638695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="1638709">//</span><br>
<span class="lineno"></span><span class="comment" id="1638712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="1638736">//</span><br>
<span class="lineno"></span><span class="comment" id="1638739">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1638752">//</span><br>
<span class="lineno"></span><span class="comment" id="1638755">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="1638778">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="1638795">//</span><br>
<span class="lineno"></span><span class="comment" id="1638798">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1638814">//</span><br>
<span class="lineno"></span><span class="comment" id="1638817">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1638894">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="1638964">//</span><br>
<span class="lineno"></span><span class="comment" id="1638967">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1639023">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1639075">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1639103">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="1639155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1639183">//</span><br>
<span class="lineno"></span><span class="comment" id="1639186">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1639199">//</span><br>
<span class="lineno"></span><span class="comment" id="1639202">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="1639242">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="1639301">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1639362">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="1639423">//</span><br>
<span class="lineno"></span><span class="comment" id="1639426">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="1639474">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1639538">//</span><br>
<span class="lineno"></span><span class="comment" id="1639541">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1639602">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1639672">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="1639747">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1639814">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1639887">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1639959">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1639973">//</span><br>
<span class="lineno">85</span><span class="comment" id="1639976">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1640042">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1640108">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1640121">//</span><br>
<span class="lineno"></span><span class="comment" id="1640124">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="1640148">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1640178">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1640198">var</span>&nbsp;<span class="ident" id="1640202">_sin</span>&nbsp;<span class="op" id="1640207">=</span>&nbsp;<span class="op" id="1640209">[</span><span class="op" id="1640210">...</span><span class="op" id="1640213">]</span><span class="builtintype" id="1640214">float64</span><span class="op" id="1640221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640224">1.58962301576546568060E-10</span><span class="op" id="1640250">,</span>&nbsp;<span class="comment" id="1640252">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640275">-</span><span class="num" id="1640276">2.50507477628578072866E-8</span><span class="op" id="1640301">,</span>&nbsp;<span class="comment" id="1640303">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640326">2.75573136213857245213E-6</span><span class="op" id="1640351">,</span>&nbsp;&nbsp;<span class="comment" id="1640354">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640377">-</span><span class="num" id="1640378">1.98412698295895385996E-4</span><span class="op" id="1640403">,</span>&nbsp;<span class="comment" id="1640405">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640428">8.33333333332211858878E-3</span><span class="op" id="1640453">,</span>&nbsp;&nbsp;<span class="comment" id="1640456">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640479">-</span><span class="num" id="1640480">1.66666666666666307295E-1</span><span class="op" id="1640505">,</span>&nbsp;<span class="comment" id="1640507">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="1640529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1640532">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1640552">var</span>&nbsp;<span class="ident" id="1640556">_cos</span>&nbsp;<span class="op" id="1640561">=</span>&nbsp;<span class="op" id="1640563">[</span><span class="op" id="1640564">...</span><span class="op" id="1640567">]</span><span class="builtintype" id="1640568">float64</span><span class="op" id="1640575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640578">-</span><span class="num" id="1640579">1.13585365213876817300E-11</span><span class="op" id="1640605">,</span>&nbsp;<span class="comment" id="1640607">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640630">2.08757008419747316778E-9</span><span class="op" id="1640655">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1640659">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640682">-</span><span class="num" id="1640683">2.75573141792967388112E-7</span><span class="op" id="1640708">,</span>&nbsp;&nbsp;<span class="comment" id="1640711">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640734">2.48015872888517045348E-5</span><span class="op" id="1640759">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1640763">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640786">-</span><span class="num" id="1640787">1.38888888888730564116E-3</span><span class="op" id="1640812">,</span>&nbsp;&nbsp;<span class="comment" id="1640815">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1640838">4.16666666666665929218E-2</span><span class="op" id="1640863">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1640867">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="1640889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1640892">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1640944">//</span><br>
<span class="lineno"></span><span class="comment" id="1640947">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="1640969">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1640989">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1641007">func</span>&nbsp;<span class="ident" id="1641012">Cos</span><span class="op" id="1641015">(</span><span class="ident" id="1641016">x</span>&nbsp;<span class="builtintype" id="1641018">float64</span><span class="op" id="1641025">)</span>&nbsp;<span class="builtintype" id="1641027">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1641036">func</span>&nbsp;<span class="ident" id="1641041">cos</span><span class="op" id="1641044">(</span><span class="ident" id="1641045">x</span>&nbsp;<span class="builtintype" id="1641047">float64</span><span class="op" id="1641054">)</span>&nbsp;<span class="builtintype" id="1641056">float64</span>&nbsp;<span class="op" id="1641064">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641067">const</span>&nbsp;<span class="op" id="1641073">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641077">PI4A</span>&nbsp;<span class="op" id="1641082">=</span>&nbsp;<span class="num" id="1641084">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1641138">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641191">PI4B</span>&nbsp;<span class="op" id="1641196">=</span>&nbsp;<span class="num" id="1641198">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1641252">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641277">PI4C</span>&nbsp;<span class="op" id="1641282">=</span>&nbsp;<span class="num" id="1641284">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1641338">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641363">M4PI</span>&nbsp;<span class="op" id="1641368">=</span>&nbsp;<span class="num" id="1641370">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1641424">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641436">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641454">switch</span>&nbsp;<span class="op" id="1641461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641464">case</span>&nbsp;<span class="ident" id="1641469">IsNaN</span><span class="op" id="1641474">(</span><span class="ident" id="1641475">x</span><span class="op" id="1641476">)</span>&nbsp;<span class="op" id="1641478">||</span>&nbsp;<span class="ident" id="1641481">IsInf</span><span class="op" id="1641486">(</span><span class="ident" id="1641487">x</span><span class="op" id="1641488">,</span>&nbsp;<span class="num" id="1641490">0</span><span class="op" id="1641491">)</span><span class="op" id="1641492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641496">return</span>&nbsp;<span class="ident" id="1641503">NaN</span><span class="op" id="1641506">(</span><span class="op" id="1641507">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641514">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641541">sign</span>&nbsp;<span class="op" id="1641546">:=</span>&nbsp;<span class="builtintype" id="1641549">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641556">if</span>&nbsp;<span class="ident" id="1641559">x</span>&nbsp;<span class="op" id="1641561">&lt;</span>&nbsp;<span class="num" id="1641563">0</span>&nbsp;<span class="op" id="1641565">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641569">x</span>&nbsp;<span class="op" id="1641571">=</span>&nbsp;<span class="op" id="1641573">-</span><span class="ident" id="1641574">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641581">j</span>&nbsp;<span class="op" id="1641583">:=</span>&nbsp;<span class="ident" id="1641586">int64</span><span class="op" id="1641591">(</span><span class="ident" id="1641592">x</span>&nbsp;<span class="op" id="1641594">*</span>&nbsp;<span class="ident" id="1641596">M4PI</span><span class="op" id="1641600">)</span>&nbsp;<span class="comment" id="1641602">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641672">y</span>&nbsp;<span class="op" id="1641674">:=</span>&nbsp;<span class="builtintype" id="1641677">float64</span><span class="op" id="1641684">(</span><span class="ident" id="1641685">j</span><span class="op" id="1641686">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1641693">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641733">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641757">if</span>&nbsp;<span class="ident" id="1641760">j</span><span class="op" id="1641761">&amp;</span><span class="num" id="1641762">1</span>&nbsp;<span class="op" id="1641764">==</span>&nbsp;<span class="num" id="1641767">1</span>&nbsp;<span class="op" id="1641769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641773">j</span>&nbsp;<span class="op" id="1641775">+=</span>&nbsp;<span class="num" id="1641778">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641782">y</span>&nbsp;<span class="op" id="1641784">+=</span>&nbsp;<span class="num" id="1641787">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641793">j</span>&nbsp;<span class="op" id="1641795">&amp;=</span>&nbsp;<span class="num" id="1641798">7</span>&nbsp;<span class="comment" id="1641800">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641844">if</span>&nbsp;<span class="ident" id="1641847">j</span>&nbsp;<span class="op" id="1641849">&gt;</span>&nbsp;<span class="num" id="1641851">3</span>&nbsp;<span class="op" id="1641853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641857">j</span>&nbsp;<span class="op" id="1641859">-=</span>&nbsp;<span class="num" id="1641862">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641866">sign</span>&nbsp;<span class="op" id="1641871">=</span>&nbsp;<span class="op" id="1641873">!</span><span class="ident" id="1641874">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641883">if</span>&nbsp;<span class="ident" id="1641886">j</span>&nbsp;<span class="op" id="1641888">&gt;</span>&nbsp;<span class="num" id="1641890">1</span>&nbsp;<span class="op" id="1641892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641896">sign</span>&nbsp;<span class="op" id="1641901">=</span>&nbsp;<span class="op" id="1641903">!</span><span class="ident" id="1641904">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641914">z</span>&nbsp;<span class="op" id="1641916">:=</span>&nbsp;<span class="op" id="1641919">(</span><span class="op" id="1641920">(</span><span class="ident" id="1641921">x</span>&nbsp;<span class="op" id="1641923">-</span>&nbsp;<span class="ident" id="1641925">y</span><span class="op" id="1641926">*</span><span class="ident" id="1641927">PI4A</span><span class="op" id="1641931">)</span>&nbsp;<span class="op" id="1641933">-</span>&nbsp;<span class="ident" id="1641935">y</span><span class="op" id="1641936">*</span><span class="ident" id="1641937">PI4B</span><span class="op" id="1641941">)</span>&nbsp;<span class="op" id="1641943">-</span>&nbsp;<span class="ident" id="1641945">y</span><span class="op" id="1641946">*</span><span class="ident" id="1641947">PI4C</span>&nbsp;<span class="comment" id="1641952">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641994">zz</span>&nbsp;<span class="op" id="1641997">:=</span>&nbsp;<span class="ident" id="1642000">z</span>&nbsp;<span class="op" id="1642002">*</span>&nbsp;<span class="ident" id="1642004">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642007">if</span>&nbsp;<span class="ident" id="1642010">j</span>&nbsp;<span class="op" id="1642012">==</span>&nbsp;<span class="num" id="1642015">1</span>&nbsp;<span class="op" id="1642017">||</span>&nbsp;<span class="ident" id="1642020">j</span>&nbsp;<span class="op" id="1642022">==</span>&nbsp;<span class="num" id="1642025">2</span>&nbsp;<span class="op" id="1642027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642031">y</span>&nbsp;<span class="op" id="1642033">=</span>&nbsp;<span class="ident" id="1642035">z</span>&nbsp;<span class="op" id="1642037">+</span>&nbsp;<span class="ident" id="1642039">z</span><span class="op" id="1642040">*</span><span class="ident" id="1642041">zz</span><span class="op" id="1642043">*</span><span class="op" id="1642044">(</span><span class="op" id="1642045">(</span><span class="op" id="1642046">(</span><span class="op" id="1642047">(</span><span class="op" id="1642048">(</span><span class="op" id="1642049">(</span><span class="ident" id="1642050">_sin</span><span class="op" id="1642054">[</span><span class="num" id="1642055">0</span><span class="op" id="1642056">]</span><span class="op" id="1642057">*</span><span class="ident" id="1642058">zz</span><span class="op" id="1642060">)</span><span class="op" id="1642061">+</span><span class="ident" id="1642062">_sin</span><span class="op" id="1642066">[</span><span class="num" id="1642067">1</span><span class="op" id="1642068">]</span><span class="op" id="1642069">)</span><span class="op" id="1642070">*</span><span class="ident" id="1642071">zz</span><span class="op" id="1642073">+</span><span class="ident" id="1642074">_sin</span><span class="op" id="1642078">[</span><span class="num" id="1642079">2</span><span class="op" id="1642080">]</span><span class="op" id="1642081">)</span><span class="op" id="1642082">*</span><span class="ident" id="1642083">zz</span><span class="op" id="1642085">+</span><span class="ident" id="1642086">_sin</span><span class="op" id="1642090">[</span><span class="num" id="1642091">3</span><span class="op" id="1642092">]</span><span class="op" id="1642093">)</span><span class="op" id="1642094">*</span><span class="ident" id="1642095">zz</span><span class="op" id="1642097">+</span><span class="ident" id="1642098">_sin</span><span class="op" id="1642102">[</span><span class="num" id="1642103">4</span><span class="op" id="1642104">]</span><span class="op" id="1642105">)</span><span class="op" id="1642106">*</span><span class="ident" id="1642107">zz</span><span class="op" id="1642109">+</span><span class="ident" id="1642110">_sin</span><span class="op" id="1642114">[</span><span class="num" id="1642115">5</span><span class="op" id="1642116">]</span><span class="op" id="1642117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642120">}</span>&nbsp;<span class="keyword" id="1642122">else</span>&nbsp;<span class="op" id="1642127">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642131">y</span>&nbsp;<span class="op" id="1642133">=</span>&nbsp;<span class="num" id="1642135">1.0</span>&nbsp;<span class="op" id="1642139">-</span>&nbsp;<span class="num" id="1642141">0.5</span><span class="op" id="1642144">*</span><span class="ident" id="1642145">zz</span>&nbsp;<span class="op" id="1642148">+</span>&nbsp;<span class="ident" id="1642150">zz</span><span class="op" id="1642152">*</span><span class="ident" id="1642153">zz</span><span class="op" id="1642155">*</span><span class="op" id="1642156">(</span><span class="op" id="1642157">(</span><span class="op" id="1642158">(</span><span class="op" id="1642159">(</span><span class="op" id="1642160">(</span><span class="op" id="1642161">(</span><span class="ident" id="1642162">_cos</span><span class="op" id="1642166">[</span><span class="num" id="1642167">0</span><span class="op" id="1642168">]</span><span class="op" id="1642169">*</span><span class="ident" id="1642170">zz</span><span class="op" id="1642172">)</span><span class="op" id="1642173">+</span><span class="ident" id="1642174">_cos</span><span class="op" id="1642178">[</span><span class="num" id="1642179">1</span><span class="op" id="1642180">]</span><span class="op" id="1642181">)</span><span class="op" id="1642182">*</span><span class="ident" id="1642183">zz</span><span class="op" id="1642185">+</span><span class="ident" id="1642186">_cos</span><span class="op" id="1642190">[</span><span class="num" id="1642191">2</span><span class="op" id="1642192">]</span><span class="op" id="1642193">)</span><span class="op" id="1642194">*</span><span class="ident" id="1642195">zz</span><span class="op" id="1642197">+</span><span class="ident" id="1642198">_cos</span><span class="op" id="1642202">[</span><span class="num" id="1642203">3</span><span class="op" id="1642204">]</span><span class="op" id="1642205">)</span><span class="op" id="1642206">*</span><span class="ident" id="1642207">zz</span><span class="op" id="1642209">+</span><span class="ident" id="1642210">_cos</span><span class="op" id="1642214">[</span><span class="num" id="1642215">4</span><span class="op" id="1642216">]</span><span class="op" id="1642217">)</span><span class="op" id="1642218">*</span><span class="ident" id="1642219">zz</span><span class="op" id="1642221">+</span><span class="ident" id="1642222">_cos</span><span class="op" id="1642226">[</span><span class="num" id="1642227">5</span><span class="op" id="1642228">]</span><span class="op" id="1642229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642235">if</span>&nbsp;<span class="ident" id="1642238">sign</span>&nbsp;<span class="op" id="1642243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642247">y</span>&nbsp;<span class="op" id="1642249">=</span>&nbsp;<span class="op" id="1642251">-</span><span class="ident" id="1642252">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642255">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642258">return</span>&nbsp;<span class="ident" id="1642265">y</span><br>
<span class="lineno"></span><span class="op" id="1642267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1642270">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1642320">//</span><br>
<span class="lineno">170</span><span class="comment" id="1642323">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1642345">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1642363">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1642383">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1642401">func</span>&nbsp;<span class="ident" id="1642406">Sin</span><span class="op" id="1642409">(</span><span class="ident" id="1642410">x</span>&nbsp;<span class="builtintype" id="1642412">float64</span><span class="op" id="1642419">)</span>&nbsp;<span class="builtintype" id="1642421">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="1642430">func</span>&nbsp;<span class="ident" id="1642435">sin</span><span class="op" id="1642438">(</span><span class="ident" id="1642439">x</span>&nbsp;<span class="builtintype" id="1642441">float64</span><span class="op" id="1642448">)</span>&nbsp;<span class="builtintype" id="1642450">float64</span>&nbsp;<span class="op" id="1642458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642461">const</span>&nbsp;<span class="op" id="1642467">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642471">PI4A</span>&nbsp;<span class="op" id="1642476">=</span>&nbsp;<span class="num" id="1642478">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1642532">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642585">PI4B</span>&nbsp;<span class="op" id="1642590">=</span>&nbsp;<span class="num" id="1642592">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1642646">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642671">PI4C</span>&nbsp;<span class="op" id="1642676">=</span>&nbsp;<span class="num" id="1642678">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1642732">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642757">M4PI</span>&nbsp;<span class="op" id="1642762">=</span>&nbsp;<span class="num" id="1642764">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1642818">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1642830">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642848">switch</span>&nbsp;<span class="op" id="1642855">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642858">case</span>&nbsp;<span class="ident" id="1642863">x</span>&nbsp;<span class="op" id="1642865">==</span>&nbsp;<span class="num" id="1642868">0</span>&nbsp;<span class="op" id="1642870">||</span>&nbsp;<span class="ident" id="1642873">IsNaN</span><span class="op" id="1642878">(</span><span class="ident" id="1642879">x</span><span class="op" id="1642880">)</span><span class="op" id="1642881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642885">return</span>&nbsp;<span class="ident" id="1642892">x</span>&nbsp;<span class="comment" id="1642894">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642918">case</span>&nbsp;<span class="ident" id="1642923">IsInf</span><span class="op" id="1642928">(</span><span class="ident" id="1642929">x</span><span class="op" id="1642930">,</span>&nbsp;<span class="num" id="1642932">0</span><span class="op" id="1642933">)</span><span class="op" id="1642934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642938">return</span>&nbsp;<span class="ident" id="1642945">NaN</span><span class="op" id="1642948">(</span><span class="op" id="1642949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642952">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1642956">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643001">sign</span>&nbsp;<span class="op" id="1643006">:=</span>&nbsp;<span class="builtintype" id="1643009">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643016">if</span>&nbsp;<span class="ident" id="1643019">x</span>&nbsp;<span class="op" id="1643021">&lt;</span>&nbsp;<span class="num" id="1643023">0</span>&nbsp;<span class="op" id="1643025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643029">x</span>&nbsp;<span class="op" id="1643031">=</span>&nbsp;<span class="op" id="1643033">-</span><span class="ident" id="1643034">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643038">sign</span>&nbsp;<span class="op" id="1643043">=</span>&nbsp;<span class="builtintype" id="1643045">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643055">j</span>&nbsp;<span class="op" id="1643057">:=</span>&nbsp;<span class="ident" id="1643060">int64</span><span class="op" id="1643065">(</span><span class="ident" id="1643066">x</span>&nbsp;<span class="op" id="1643068">*</span>&nbsp;<span class="ident" id="1643070">M4PI</span><span class="op" id="1643074">)</span>&nbsp;<span class="comment" id="1643076">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643146">y</span>&nbsp;<span class="op" id="1643148">:=</span>&nbsp;<span class="builtintype" id="1643151">float64</span><span class="op" id="1643158">(</span><span class="ident" id="1643159">j</span><span class="op" id="1643160">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1643167">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1643207">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643231">if</span>&nbsp;<span class="ident" id="1643234">j</span><span class="op" id="1643235">&amp;</span><span class="num" id="1643236">1</span>&nbsp;<span class="op" id="1643238">==</span>&nbsp;<span class="num" id="1643241">1</span>&nbsp;<span class="op" id="1643243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643247">j</span>&nbsp;<span class="op" id="1643249">+=</span>&nbsp;<span class="num" id="1643252">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643256">y</span>&nbsp;<span class="op" id="1643258">+=</span>&nbsp;<span class="num" id="1643261">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643267">j</span>&nbsp;<span class="op" id="1643269">&amp;=</span>&nbsp;<span class="num" id="1643272">7</span>&nbsp;<span class="comment" id="1643274">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1643318">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643340">if</span>&nbsp;<span class="ident" id="1643343">j</span>&nbsp;<span class="op" id="1643345">&gt;</span>&nbsp;<span class="num" id="1643347">3</span>&nbsp;<span class="op" id="1643349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643353">sign</span>&nbsp;<span class="op" id="1643358">=</span>&nbsp;<span class="op" id="1643360">!</span><span class="ident" id="1643361">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643368">j</span>&nbsp;<span class="op" id="1643370">-=</span>&nbsp;<span class="num" id="1643373">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643380">z</span>&nbsp;<span class="op" id="1643382">:=</span>&nbsp;<span class="op" id="1643385">(</span><span class="op" id="1643386">(</span><span class="ident" id="1643387">x</span>&nbsp;<span class="op" id="1643389">-</span>&nbsp;<span class="ident" id="1643391">y</span><span class="op" id="1643392">*</span><span class="ident" id="1643393">PI4A</span><span class="op" id="1643397">)</span>&nbsp;<span class="op" id="1643399">-</span>&nbsp;<span class="ident" id="1643401">y</span><span class="op" id="1643402">*</span><span class="ident" id="1643403">PI4B</span><span class="op" id="1643407">)</span>&nbsp;<span class="op" id="1643409">-</span>&nbsp;<span class="ident" id="1643411">y</span><span class="op" id="1643412">*</span><span class="ident" id="1643413">PI4C</span>&nbsp;<span class="comment" id="1643418">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643460">zz</span>&nbsp;<span class="op" id="1643463">:=</span>&nbsp;<span class="ident" id="1643466">z</span>&nbsp;<span class="op" id="1643468">*</span>&nbsp;<span class="ident" id="1643470">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643473">if</span>&nbsp;<span class="ident" id="1643476">j</span>&nbsp;<span class="op" id="1643478">==</span>&nbsp;<span class="num" id="1643481">1</span>&nbsp;<span class="op" id="1643483">||</span>&nbsp;<span class="ident" id="1643486">j</span>&nbsp;<span class="op" id="1643488">==</span>&nbsp;<span class="num" id="1643491">2</span>&nbsp;<span class="op" id="1643493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643497">y</span>&nbsp;<span class="op" id="1643499">=</span>&nbsp;<span class="num" id="1643501">1.0</span>&nbsp;<span class="op" id="1643505">-</span>&nbsp;<span class="num" id="1643507">0.5</span><span class="op" id="1643510">*</span><span class="ident" id="1643511">zz</span>&nbsp;<span class="op" id="1643514">+</span>&nbsp;<span class="ident" id="1643516">zz</span><span class="op" id="1643518">*</span><span class="ident" id="1643519">zz</span><span class="op" id="1643521">*</span><span class="op" id="1643522">(</span><span class="op" id="1643523">(</span><span class="op" id="1643524">(</span><span class="op" id="1643525">(</span><span class="op" id="1643526">(</span><span class="op" id="1643527">(</span><span class="ident" id="1643528">_cos</span><span class="op" id="1643532">[</span><span class="num" id="1643533">0</span><span class="op" id="1643534">]</span><span class="op" id="1643535">*</span><span class="ident" id="1643536">zz</span><span class="op" id="1643538">)</span><span class="op" id="1643539">+</span><span class="ident" id="1643540">_cos</span><span class="op" id="1643544">[</span><span class="num" id="1643545">1</span><span class="op" id="1643546">]</span><span class="op" id="1643547">)</span><span class="op" id="1643548">*</span><span class="ident" id="1643549">zz</span><span class="op" id="1643551">+</span><span class="ident" id="1643552">_cos</span><span class="op" id="1643556">[</span><span class="num" id="1643557">2</span><span class="op" id="1643558">]</span><span class="op" id="1643559">)</span><span class="op" id="1643560">*</span><span class="ident" id="1643561">zz</span><span class="op" id="1643563">+</span><span class="ident" id="1643564">_cos</span><span class="op" id="1643568">[</span><span class="num" id="1643569">3</span><span class="op" id="1643570">]</span><span class="op" id="1643571">)</span><span class="op" id="1643572">*</span><span class="ident" id="1643573">zz</span><span class="op" id="1643575">+</span><span class="ident" id="1643576">_cos</span><span class="op" id="1643580">[</span><span class="num" id="1643581">4</span><span class="op" id="1643582">]</span><span class="op" id="1643583">)</span><span class="op" id="1643584">*</span><span class="ident" id="1643585">zz</span><span class="op" id="1643587">+</span><span class="ident" id="1643588">_cos</span><span class="op" id="1643592">[</span><span class="num" id="1643593">5</span><span class="op" id="1643594">]</span><span class="op" id="1643595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643598">}</span>&nbsp;<span class="keyword" id="1643600">else</span>&nbsp;<span class="op" id="1643605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643609">y</span>&nbsp;<span class="op" id="1643611">=</span>&nbsp;<span class="ident" id="1643613">z</span>&nbsp;<span class="op" id="1643615">+</span>&nbsp;<span class="ident" id="1643617">z</span><span class="op" id="1643618">*</span><span class="ident" id="1643619">zz</span><span class="op" id="1643621">*</span><span class="op" id="1643622">(</span><span class="op" id="1643623">(</span><span class="op" id="1643624">(</span><span class="op" id="1643625">(</span><span class="op" id="1643626">(</span><span class="op" id="1643627">(</span><span class="ident" id="1643628">_sin</span><span class="op" id="1643632">[</span><span class="num" id="1643633">0</span><span class="op" id="1643634">]</span><span class="op" id="1643635">*</span><span class="ident" id="1643636">zz</span><span class="op" id="1643638">)</span><span class="op" id="1643639">+</span><span class="ident" id="1643640">_sin</span><span class="op" id="1643644">[</span><span class="num" id="1643645">1</span><span class="op" id="1643646">]</span><span class="op" id="1643647">)</span><span class="op" id="1643648">*</span><span class="ident" id="1643649">zz</span><span class="op" id="1643651">+</span><span class="ident" id="1643652">_sin</span><span class="op" id="1643656">[</span><span class="num" id="1643657">2</span><span class="op" id="1643658">]</span><span class="op" id="1643659">)</span><span class="op" id="1643660">*</span><span class="ident" id="1643661">zz</span><span class="op" id="1643663">+</span><span class="ident" id="1643664">_sin</span><span class="op" id="1643668">[</span><span class="num" id="1643669">3</span><span class="op" id="1643670">]</span><span class="op" id="1643671">)</span><span class="op" id="1643672">*</span><span class="ident" id="1643673">zz</span><span class="op" id="1643675">+</span><span class="ident" id="1643676">_sin</span><span class="op" id="1643680">[</span><span class="num" id="1643681">4</span><span class="op" id="1643682">]</span><span class="op" id="1643683">)</span><span class="op" id="1643684">*</span><span class="ident" id="1643685">zz</span><span class="op" id="1643687">+</span><span class="ident" id="1643688">_sin</span><span class="op" id="1643692">[</span><span class="num" id="1643693">5</span><span class="op" id="1643694">]</span><span class="op" id="1643695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643698">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643701">if</span>&nbsp;<span class="ident" id="1643704">sign</span>&nbsp;<span class="op" id="1643709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643713">y</span>&nbsp;<span class="op" id="1643715">=</span>&nbsp;<span class="op" id="1643717">-</span><span class="ident" id="1643718">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1643721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643724">return</span>&nbsp;<span class="ident" id="1643731">y</span><br>
<span class="lineno"></span><span class="op" id="1643733">}</span>
</div>
</body>
</html>
