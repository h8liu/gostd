<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6390381">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6390437">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6390491">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6390542">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6390627">package</span>&nbsp;<span class="ident" id="6390635">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6390639">import</span>&nbsp;<span class="op" id="6390646">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390649">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390664">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390683">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390693">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390700">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390706">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6390712">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="6390722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6390725">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6390763">type</span>&nbsp;<span class="ident" id="6390768">File</span>&nbsp;<span class="keyword" id="6390773">struct</span>&nbsp;<span class="op" id="6390780">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390783">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390795">OptionalHeader</span>&nbsp;<span class="keyword" id="6390810">interface</span><span class="op" id="6390819">{</span><span class="op" id="6390820">}</span>&nbsp;<span class="comment" id="6390822">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390873">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6390888">[</span><span class="op" id="6390889">]</span><span class="op" id="6390890">*</span><span class="ident" id="6390891">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390900">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6390915">[</span><span class="op" id="6390916">]</span><span class="op" id="6390917">*</span><span class="ident" id="6390918">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390927">closer</span>&nbsp;<span class="ident" id="6390934">io</span><span class="op" id="6390936">.</span><span class="ident" id="6390937">Closer</span><br>
<span class="lineno"></span><span class="op" id="6390944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6390947">type</span>&nbsp;<span class="ident" id="6390952">SectionHeader</span>&nbsp;<span class="keyword" id="6390966">struct</span>&nbsp;<span class="op" id="6390973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6390976">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6390997">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391005">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391026">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391034">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391055">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391063">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391084">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391092">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391113">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391121">PointerToRelocations</span>&nbsp;<span class="builtintype" id="6391142">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391150">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="6391171">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391179">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="6391200">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391208">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="6391229">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391237">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391258">uint32</span><br>
<span class="lineno"></span><span class="op" id="6391265">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="6391268">type</span>&nbsp;<span class="ident" id="6391273">Section</span>&nbsp;<span class="keyword" id="6391281">struct</span>&nbsp;<span class="op" id="6391288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391291">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391307">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391345">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391385">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391420">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391468">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6391518">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391542">io</span><span class="op" id="6391544">.</span><span class="ident" id="6391545">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391555">sr</span>&nbsp;<span class="op" id="6391558">*</span><span class="ident" id="6391559">io</span><span class="op" id="6391561">.</span><span class="ident" id="6391562">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6391576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6391579">type</span>&nbsp;<span class="ident" id="6391584">Symbol</span>&nbsp;<span class="keyword" id="6391591">struct</span>&nbsp;<span class="op" id="6391598">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391601">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391615">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391623">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391637">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391645">SectionNumber</span>&nbsp;<span class="builtintype" id="6391659">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391666">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391680">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391688">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="6391702">uint8</span><br>
<span class="lineno">60</span><span class="op" id="6391708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6391711">type</span>&nbsp;<span class="ident" id="6391716">ImportDirectory</span>&nbsp;<span class="keyword" id="6391732">struct</span>&nbsp;<span class="op" id="6391739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391742">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="6391761">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391769">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391788">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391796">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391815">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391823">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391842">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391850">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6391869">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391878">dll</span>&nbsp;<span class="builtintype" id="6391882">string</span><br>
<span class="lineno">70</span><span class="op" id="6391889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6391892">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6391950">func</span>&nbsp;<span class="op" id="6391955">(</span><span class="ident" id="6391956">s</span>&nbsp;<span class="op" id="6391958">*</span><span class="ident" id="6391959">Section</span><span class="op" id="6391966">)</span>&nbsp;<span class="ident" id="6391968">Data</span><span class="op" id="6391972">(</span><span class="op" id="6391973">)</span>&nbsp;<span class="op" id="6391975">(</span><span class="op" id="6391976">[</span><span class="op" id="6391977">]</span><span class="builtintype" id="6391978">byte</span><span class="op" id="6391982">,</span>&nbsp;<span class="builtintype" id="6391984">error</span><span class="op" id="6391989">)</span>&nbsp;<span class="op" id="6391991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6391994">dat</span>&nbsp;<span class="op" id="6391998">:=</span>&nbsp;<span class="builtinfunc" id="6392001">make</span><span class="op" id="6392005">(</span><span class="op" id="6392006">[</span><span class="op" id="6392007">]</span><span class="builtintype" id="6392008">byte</span><span class="op" id="6392012">,</span>&nbsp;<span class="ident" id="6392014">s</span><span class="op" id="6392015">.</span><span class="ident" id="6392016">sr</span><span class="op" id="6392018">.</span><span class="ident" id="6392019">Size</span><span class="op" id="6392023">(</span><span class="op" id="6392024">)</span><span class="op" id="6392025">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392028">n</span><span class="op" id="6392029">,</span>&nbsp;<span class="ident" id="6392031">err</span>&nbsp;<span class="op" id="6392035">:=</span>&nbsp;<span class="ident" id="6392038">s</span><span class="op" id="6392039">.</span><span class="ident" id="6392040">sr</span><span class="op" id="6392042">.</span><span class="ident" id="6392043">ReadAt</span><span class="op" id="6392049">(</span><span class="ident" id="6392050">dat</span><span class="op" id="6392053">,</span>&nbsp;<span class="num" id="6392055">0</span><span class="op" id="6392056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392059">if</span>&nbsp;<span class="ident" id="6392062">n</span>&nbsp;<span class="op" id="6392064">==</span>&nbsp;<span class="builtinfunc" id="6392067">len</span><span class="op" id="6392070">(</span><span class="ident" id="6392071">dat</span><span class="op" id="6392074">)</span>&nbsp;<span class="op" id="6392076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392080">err</span>&nbsp;<span class="op" id="6392084">=</span>&nbsp;<span class="ident" id="6392086">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6392091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392094">return</span>&nbsp;<span class="ident" id="6392101">dat</span><span class="op" id="6392104">[</span><span class="num" id="6392105">0</span><span class="op" id="6392106">:</span><span class="ident" id="6392107">n</span><span class="op" id="6392108">]</span><span class="op" id="6392109">,</span>&nbsp;<span class="ident" id="6392111">err</span><br>
<span class="lineno">80</span><span class="op" id="6392115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6392118">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6392175">func</span>&nbsp;<span class="op" id="6392180">(</span><span class="ident" id="6392181">s</span>&nbsp;<span class="op" id="6392183">*</span><span class="ident" id="6392184">Section</span><span class="op" id="6392191">)</span>&nbsp;<span class="ident" id="6392193">Open</span><span class="op" id="6392197">(</span><span class="op" id="6392198">)</span>&nbsp;<span class="ident" id="6392200">io</span><span class="op" id="6392202">.</span><span class="ident" id="6392203">ReadSeeker</span>&nbsp;<span class="op" id="6392214">{</span>&nbsp;<span class="keyword" id="6392216">return</span>&nbsp;<span class="ident" id="6392223">io</span><span class="op" id="6392225">.</span><span class="ident" id="6392226">NewSectionReader</span><span class="op" id="6392242">(</span><span class="ident" id="6392243">s</span><span class="op" id="6392244">.</span><span class="ident" id="6392245">sr</span><span class="op" id="6392247">,</span>&nbsp;<span class="num" id="6392249">0</span><span class="op" id="6392250">,</span>&nbsp;<span class="num" id="6392252">1</span><span class="op" id="6392253">&lt;&lt;</span><span class="num" id="6392255">63</span><span class="op" id="6392257">-</span><span class="num" id="6392258">1</span><span class="op" id="6392259">)</span>&nbsp;<span class="op" id="6392261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="6392264">type</span>&nbsp;<span class="ident" id="6392269">FormatError</span>&nbsp;<span class="keyword" id="6392281">struct</span>&nbsp;<span class="op" id="6392288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392291">off</span>&nbsp;<span class="ident" id="6392295">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392302">msg</span>&nbsp;<span class="builtintype" id="6392306">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392314">val</span>&nbsp;<span class="keyword" id="6392318">interface</span><span class="op" id="6392327">{</span><span class="op" id="6392328">}</span><br>
<span class="lineno"></span><span class="op" id="6392330">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6392333">func</span>&nbsp;<span class="op" id="6392338">(</span><span class="ident" id="6392339">e</span>&nbsp;<span class="op" id="6392341">*</span><span class="ident" id="6392342">FormatError</span><span class="op" id="6392353">)</span>&nbsp;<span class="ident" id="6392355">Error</span><span class="op" id="6392360">(</span><span class="op" id="6392361">)</span>&nbsp;<span class="builtintype" id="6392363">string</span>&nbsp;<span class="op" id="6392370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392373">msg</span>&nbsp;<span class="op" id="6392377">:=</span>&nbsp;<span class="ident" id="6392380">e</span><span class="op" id="6392381">.</span><span class="ident" id="6392382">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392387">if</span>&nbsp;<span class="ident" id="6392390">e</span><span class="op" id="6392391">.</span><span class="ident" id="6392392">val</span>&nbsp;<span class="op" id="6392396">!=</span>&nbsp;<span class="ident" id="6392399">nil</span>&nbsp;<span class="op" id="6392403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392407">msg</span>&nbsp;<span class="op" id="6392411">+=</span>&nbsp;<span class="ident" id="6392414">fmt</span><span class="op" id="6392417">.</span><span class="ident" id="6392418">Sprintf</span><span class="op" id="6392425">(</span><span class="string" id="6392426">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6392433">,</span>&nbsp;<span class="ident" id="6392435">e</span><span class="op" id="6392436">.</span><span class="ident" id="6392437">val</span><span class="op" id="6392440">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6392443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392446">msg</span>&nbsp;<span class="op" id="6392450">+=</span>&nbsp;<span class="ident" id="6392453">fmt</span><span class="op" id="6392456">.</span><span class="ident" id="6392457">Sprintf</span><span class="op" id="6392464">(</span><span class="string" id="6392465">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6392489">,</span>&nbsp;<span class="ident" id="6392491">e</span><span class="op" id="6392492">.</span><span class="ident" id="6392493">off</span><span class="op" id="6392496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392499">return</span>&nbsp;<span class="ident" id="6392506">msg</span><br>
<span class="lineno"></span><span class="op" id="6392510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6392513">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6392596">func</span>&nbsp;<span class="ident" id="6392601">Open</span><span class="op" id="6392605">(</span><span class="ident" id="6392606">name</span>&nbsp;<span class="builtintype" id="6392611">string</span><span class="op" id="6392617">)</span>&nbsp;<span class="op" id="6392619">(</span><span class="op" id="6392620">*</span><span class="ident" id="6392621">File</span><span class="op" id="6392625">,</span>&nbsp;<span class="builtintype" id="6392627">error</span><span class="op" id="6392632">)</span>&nbsp;<span class="op" id="6392634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392637">f</span><span class="op" id="6392638">,</span>&nbsp;<span class="ident" id="6392640">err</span>&nbsp;<span class="op" id="6392644">:=</span>&nbsp;<span class="ident" id="6392647">os</span><span class="op" id="6392649">.</span><span class="ident" id="6392650">Open</span><span class="op" id="6392654">(</span><span class="ident" id="6392655">name</span><span class="op" id="6392659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392662">if</span>&nbsp;<span class="ident" id="6392665">err</span>&nbsp;<span class="op" id="6392669">!=</span>&nbsp;<span class="ident" id="6392672">nil</span>&nbsp;<span class="op" id="6392676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392680">return</span>&nbsp;<span class="ident" id="6392687">nil</span><span class="op" id="6392690">,</span>&nbsp;<span class="ident" id="6392692">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6392697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392700">ff</span><span class="op" id="6392702">,</span>&nbsp;<span class="ident" id="6392704">err</span>&nbsp;<span class="op" id="6392708">:=</span>&nbsp;<span class="ident" id="6392711">NewFile</span><span class="op" id="6392718">(</span><span class="ident" id="6392719">f</span><span class="op" id="6392720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392723">if</span>&nbsp;<span class="ident" id="6392726">err</span>&nbsp;<span class="op" id="6392730">!=</span>&nbsp;<span class="ident" id="6392733">nil</span>&nbsp;<span class="op" id="6392737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392741">f</span><span class="op" id="6392742">.</span><span class="ident" id="6392743">Close</span><span class="op" id="6392748">(</span><span class="op" id="6392749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392753">return</span>&nbsp;<span class="ident" id="6392760">nil</span><span class="op" id="6392763">,</span>&nbsp;<span class="ident" id="6392765">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6392770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392773">ff</span><span class="op" id="6392775">.</span><span class="ident" id="6392776">closer</span>&nbsp;<span class="op" id="6392783">=</span>&nbsp;<span class="ident" id="6392785">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392788">return</span>&nbsp;<span class="ident" id="6392795">ff</span><span class="op" id="6392797">,</span>&nbsp;<span class="ident" id="6392799">nil</span><br>
<span class="lineno"></span><span class="op" id="6392803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="6392806">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6392832">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6392899">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6392923">func</span>&nbsp;<span class="op" id="6392928">(</span><span class="ident" id="6392929">f</span>&nbsp;<span class="op" id="6392931">*</span><span class="ident" id="6392932">File</span><span class="op" id="6392936">)</span>&nbsp;<span class="ident" id="6392938">Close</span><span class="op" id="6392943">(</span><span class="op" id="6392944">)</span>&nbsp;<span class="builtintype" id="6392946">error</span>&nbsp;<span class="op" id="6392952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392955">var</span>&nbsp;<span class="ident" id="6392959">err</span>&nbsp;<span class="builtintype" id="6392963">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6392970">if</span>&nbsp;<span class="ident" id="6392973">f</span><span class="op" id="6392974">.</span><span class="ident" id="6392975">closer</span>&nbsp;<span class="op" id="6392982">!=</span>&nbsp;<span class="ident" id="6392985">nil</span>&nbsp;<span class="op" id="6392989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6392993">err</span>&nbsp;<span class="op" id="6392997">=</span>&nbsp;<span class="ident" id="6392999">f</span><span class="op" id="6393000">.</span><span class="ident" id="6393001">closer</span><span class="op" id="6393007">.</span><span class="ident" id="6393008">Close</span><span class="op" id="6393013">(</span><span class="op" id="6393014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393018">f</span><span class="op" id="6393019">.</span><span class="ident" id="6393020">closer</span>&nbsp;<span class="op" id="6393027">=</span>&nbsp;<span class="ident" id="6393029">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393037">return</span>&nbsp;<span class="ident" id="6393044">err</span><br>
<span class="lineno">125</span><span class="op" id="6393048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6393051">var</span>&nbsp;<span class="op" id="6393055">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393058">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="6393081">=</span>&nbsp;<span class="builtintype" id="6393083">uint16</span><span class="op" id="6393089">(</span><span class="ident" id="6393090">binary</span><span class="op" id="6393096">.</span><span class="ident" id="6393097">Size</span><span class="op" id="6393101">(</span><span class="ident" id="6393102">OptionalHeader32</span><span class="op" id="6393118">{</span><span class="op" id="6393119">}</span><span class="op" id="6393120">)</span><span class="op" id="6393121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393124">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="6393147">=</span>&nbsp;<span class="builtintype" id="6393149">uint16</span><span class="op" id="6393155">(</span><span class="ident" id="6393156">binary</span><span class="op" id="6393162">.</span><span class="ident" id="6393163">Size</span><span class="op" id="6393167">(</span><span class="ident" id="6393168">OptionalHeader64</span><span class="op" id="6393184">{</span><span class="op" id="6393185">}</span><span class="op" id="6393186">)</span><span class="op" id="6393187">)</span><br>
<span class="lineno">130</span><span class="op" id="6393189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6393192">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6393273">func</span>&nbsp;<span class="ident" id="6393278">NewFile</span><span class="op" id="6393285">(</span><span class="ident" id="6393286">r</span>&nbsp;<span class="ident" id="6393288">io</span><span class="op" id="6393290">.</span><span class="ident" id="6393291">ReaderAt</span><span class="op" id="6393299">)</span>&nbsp;<span class="op" id="6393301">(</span><span class="op" id="6393302">*</span><span class="ident" id="6393303">File</span><span class="op" id="6393307">,</span>&nbsp;<span class="builtintype" id="6393309">error</span><span class="op" id="6393314">)</span>&nbsp;<span class="op" id="6393316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393319">f</span>&nbsp;<span class="op" id="6393321">:=</span>&nbsp;<span class="builtinfunc" id="6393324">new</span><span class="op" id="6393327">(</span><span class="ident" id="6393328">File</span><span class="op" id="6393332">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393335">sr</span>&nbsp;<span class="op" id="6393338">:=</span>&nbsp;<span class="ident" id="6393341">io</span><span class="op" id="6393343">.</span><span class="ident" id="6393344">NewSectionReader</span><span class="op" id="6393360">(</span><span class="ident" id="6393361">r</span><span class="op" id="6393362">,</span>&nbsp;<span class="num" id="6393364">0</span><span class="op" id="6393365">,</span>&nbsp;<span class="num" id="6393367">1</span><span class="op" id="6393368">&lt;&lt;</span><span class="num" id="6393370">63</span><span class="op" id="6393372">-</span><span class="num" id="6393373">1</span><span class="op" id="6393374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393378">var</span>&nbsp;<span class="ident" id="6393382">dosheader</span>&nbsp;<span class="op" id="6393392">[</span><span class="num" id="6393393">96</span><span class="op" id="6393395">]</span><span class="builtintype" id="6393396">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393402">if</span>&nbsp;<span class="ident" id="6393405">_</span><span class="op" id="6393406">,</span>&nbsp;<span class="ident" id="6393408">err</span>&nbsp;<span class="op" id="6393412">:=</span>&nbsp;<span class="ident" id="6393415">r</span><span class="op" id="6393416">.</span><span class="ident" id="6393417">ReadAt</span><span class="op" id="6393423">(</span><span class="ident" id="6393424">dosheader</span><span class="op" id="6393433">[</span><span class="num" id="6393434">0</span><span class="op" id="6393435">:</span><span class="op" id="6393436">]</span><span class="op" id="6393437">,</span>&nbsp;<span class="num" id="6393439">0</span><span class="op" id="6393440">)</span><span class="op" id="6393441">;</span>&nbsp;<span class="ident" id="6393443">err</span>&nbsp;<span class="op" id="6393447">!=</span>&nbsp;<span class="ident" id="6393450">nil</span>&nbsp;<span class="op" id="6393454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393458">return</span>&nbsp;<span class="ident" id="6393465">nil</span><span class="op" id="6393468">,</span>&nbsp;<span class="ident" id="6393470">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393478">var</span>&nbsp;<span class="ident" id="6393482">base</span>&nbsp;<span class="ident" id="6393487">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393494">if</span>&nbsp;<span class="ident" id="6393497">dosheader</span><span class="op" id="6393506">[</span><span class="num" id="6393507">0</span><span class="op" id="6393508">]</span>&nbsp;<span class="op" id="6393510">==</span>&nbsp;<span class="string" id="6393513">&#39;M&#39;</span>&nbsp;<span class="op" id="6393517">&amp;&amp;</span>&nbsp;<span class="ident" id="6393520">dosheader</span><span class="op" id="6393529">[</span><span class="num" id="6393530">1</span><span class="op" id="6393531">]</span>&nbsp;<span class="op" id="6393533">==</span>&nbsp;<span class="string" id="6393536">&#39;Z&#39;</span>&nbsp;<span class="op" id="6393540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393544">signoff</span>&nbsp;<span class="op" id="6393552">:=</span>&nbsp;<span class="ident" id="6393555">int64</span><span class="op" id="6393560">(</span><span class="ident" id="6393561">binary</span><span class="op" id="6393567">.</span><span class="ident" id="6393568">LittleEndian</span><span class="op" id="6393580">.</span><span class="ident" id="6393581">Uint32</span><span class="op" id="6393587">(</span><span class="ident" id="6393588">dosheader</span><span class="op" id="6393597">[</span><span class="num" id="6393598">0x3c</span><span class="op" id="6393602">:</span><span class="op" id="6393603">]</span><span class="op" id="6393604">)</span><span class="op" id="6393605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393609">var</span>&nbsp;<span class="ident" id="6393613">sign</span>&nbsp;<span class="op" id="6393618">[</span><span class="num" id="6393619">4</span><span class="op" id="6393620">]</span><span class="builtintype" id="6393621">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393628">r</span><span class="op" id="6393629">.</span><span class="ident" id="6393630">ReadAt</span><span class="op" id="6393636">(</span><span class="ident" id="6393637">sign</span><span class="op" id="6393641">[</span><span class="op" id="6393642">:</span><span class="op" id="6393643">]</span><span class="op" id="6393644">,</span>&nbsp;<span class="ident" id="6393646">signoff</span><span class="op" id="6393653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393657">if</span>&nbsp;<span class="op" id="6393660">!</span><span class="op" id="6393661">(</span><span class="ident" id="6393662">sign</span><span class="op" id="6393666">[</span><span class="num" id="6393667">0</span><span class="op" id="6393668">]</span>&nbsp;<span class="op" id="6393670">==</span>&nbsp;<span class="string" id="6393673">&#39;P&#39;</span>&nbsp;<span class="op" id="6393677">&amp;&amp;</span>&nbsp;<span class="ident" id="6393680">sign</span><span class="op" id="6393684">[</span><span class="num" id="6393685">1</span><span class="op" id="6393686">]</span>&nbsp;<span class="op" id="6393688">==</span>&nbsp;<span class="string" id="6393691">&#39;E&#39;</span>&nbsp;<span class="op" id="6393695">&amp;&amp;</span>&nbsp;<span class="ident" id="6393698">sign</span><span class="op" id="6393702">[</span><span class="num" id="6393703">2</span><span class="op" id="6393704">]</span>&nbsp;<span class="op" id="6393706">==</span>&nbsp;<span class="num" id="6393709">0</span>&nbsp;<span class="op" id="6393711">&amp;&amp;</span>&nbsp;<span class="ident" id="6393714">sign</span><span class="op" id="6393718">[</span><span class="num" id="6393719">3</span><span class="op" id="6393720">]</span>&nbsp;<span class="op" id="6393722">==</span>&nbsp;<span class="num" id="6393725">0</span><span class="op" id="6393726">)</span>&nbsp;<span class="op" id="6393728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393733">return</span>&nbsp;<span class="ident" id="6393740">nil</span><span class="op" id="6393743">,</span>&nbsp;<span class="ident" id="6393745">errors</span><span class="op" id="6393751">.</span><span class="ident" id="6393752">New</span><span class="op" id="6393755">(</span><span class="string" id="6393756">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6393781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393789">base</span>&nbsp;<span class="op" id="6393794">=</span>&nbsp;<span class="ident" id="6393796">signoff</span>&nbsp;<span class="op" id="6393804">+</span>&nbsp;<span class="num" id="6393806">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393809">}</span>&nbsp;<span class="keyword" id="6393811">else</span>&nbsp;<span class="op" id="6393816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393820">base</span>&nbsp;<span class="op" id="6393825">=</span>&nbsp;<span class="ident" id="6393827">int64</span><span class="op" id="6393832">(</span><span class="num" id="6393833">0</span><span class="op" id="6393834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6393840">sr</span><span class="op" id="6393842">.</span><span class="ident" id="6393843">Seek</span><span class="op" id="6393847">(</span><span class="ident" id="6393848">base</span><span class="op" id="6393852">,</span>&nbsp;<span class="ident" id="6393854">os</span><span class="op" id="6393856">.</span><span class="ident" id="6393857">SEEK_SET</span><span class="op" id="6393865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393868">if</span>&nbsp;<span class="ident" id="6393871">err</span>&nbsp;<span class="op" id="6393875">:=</span>&nbsp;<span class="ident" id="6393878">binary</span><span class="op" id="6393884">.</span><span class="ident" id="6393885">Read</span><span class="op" id="6393889">(</span><span class="ident" id="6393890">sr</span><span class="op" id="6393892">,</span>&nbsp;<span class="ident" id="6393894">binary</span><span class="op" id="6393900">.</span><span class="ident" id="6393901">LittleEndian</span><span class="op" id="6393913">,</span>&nbsp;<span class="op" id="6393915">&amp;</span><span class="ident" id="6393916">f</span><span class="op" id="6393917">.</span><span class="ident" id="6393918">FileHeader</span><span class="op" id="6393928">)</span><span class="op" id="6393929">;</span>&nbsp;<span class="ident" id="6393931">err</span>&nbsp;<span class="op" id="6393935">!=</span>&nbsp;<span class="ident" id="6393938">nil</span>&nbsp;<span class="op" id="6393942">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393946">return</span>&nbsp;<span class="ident" id="6393953">nil</span><span class="op" id="6393956">,</span>&nbsp;<span class="ident" id="6393958">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6393963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6393966">if</span>&nbsp;<span class="ident" id="6393969">f</span><span class="op" id="6393970">.</span><span class="ident" id="6393971">FileHeader</span><span class="op" id="6393981">.</span><span class="ident" id="6393982">Machine</span>&nbsp;<span class="op" id="6393990">!=</span>&nbsp;<span class="ident" id="6393993">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="6394020">&amp;&amp;</span>&nbsp;<span class="ident" id="6394023">f</span><span class="op" id="6394024">.</span><span class="ident" id="6394025">FileHeader</span><span class="op" id="6394035">.</span><span class="ident" id="6394036">Machine</span>&nbsp;<span class="op" id="6394044">!=</span>&nbsp;<span class="ident" id="6394047">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="6394072">&amp;&amp;</span>&nbsp;<span class="ident" id="6394075">f</span><span class="op" id="6394076">.</span><span class="ident" id="6394077">FileHeader</span><span class="op" id="6394087">.</span><span class="ident" id="6394088">Machine</span>&nbsp;<span class="op" id="6394096">!=</span>&nbsp;<span class="ident" id="6394099">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="6394123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394127">return</span>&nbsp;<span class="ident" id="6394134">nil</span><span class="op" id="6394137">,</span>&nbsp;<span class="ident" id="6394139">errors</span><span class="op" id="6394145">.</span><span class="ident" id="6394146">New</span><span class="op" id="6394149">(</span><span class="string" id="6394150">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6394175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6394178">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394182">var</span>&nbsp;<span class="ident" id="6394186">ss</span>&nbsp;<span class="op" id="6394189">[</span><span class="op" id="6394190">]</span><span class="builtintype" id="6394191">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394197">if</span>&nbsp;<span class="ident" id="6394200">f</span><span class="op" id="6394201">.</span><span class="ident" id="6394202">FileHeader</span><span class="op" id="6394212">.</span><span class="ident" id="6394213">NumberOfSymbols</span>&nbsp;<span class="op" id="6394229">&gt;</span>&nbsp;<span class="num" id="6394231">0</span>&nbsp;<span class="op" id="6394233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6394237">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6394319">sr</span><span class="op" id="6394321">.</span><span class="ident" id="6394322">Seek</span><span class="op" id="6394326">(</span><span class="ident" id="6394327">int64</span><span class="op" id="6394332">(</span><span class="ident" id="6394333">f</span><span class="op" id="6394334">.</span><span class="ident" id="6394335">FileHeader</span><span class="op" id="6394345">.</span><span class="ident" id="6394346">PointerToSymbolTable</span><span class="op" id="6394366">+</span><span class="ident" id="6394367">COFFSymbolSize</span><span class="op" id="6394381">*</span><span class="ident" id="6394382">f</span><span class="op" id="6394383">.</span><span class="ident" id="6394384">FileHeader</span><span class="op" id="6394394">.</span><span class="ident" id="6394395">NumberOfSymbols</span><span class="op" id="6394410">)</span><span class="op" id="6394411">,</span>&nbsp;<span class="ident" id="6394413">os</span><span class="op" id="6394415">.</span><span class="ident" id="6394416">SEEK_SET</span><span class="op" id="6394424">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394428">var</span>&nbsp;<span class="ident" id="6394432">l</span>&nbsp;<span class="builtintype" id="6394434">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394443">if</span>&nbsp;<span class="ident" id="6394446">err</span>&nbsp;<span class="op" id="6394450">:=</span>&nbsp;<span class="ident" id="6394453">binary</span><span class="op" id="6394459">.</span><span class="ident" id="6394460">Read</span><span class="op" id="6394464">(</span><span class="ident" id="6394465">sr</span><span class="op" id="6394467">,</span>&nbsp;<span class="ident" id="6394469">binary</span><span class="op" id="6394475">.</span><span class="ident" id="6394476">LittleEndian</span><span class="op" id="6394488">,</span>&nbsp;<span class="op" id="6394490">&amp;</span><span class="ident" id="6394491">l</span><span class="op" id="6394492">)</span><span class="op" id="6394493">;</span>&nbsp;<span class="ident" id="6394495">err</span>&nbsp;<span class="op" id="6394499">!=</span>&nbsp;<span class="ident" id="6394502">nil</span>&nbsp;<span class="op" id="6394506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394511">return</span>&nbsp;<span class="ident" id="6394518">nil</span><span class="op" id="6394521">,</span>&nbsp;<span class="ident" id="6394523">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6394529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6394533">ss</span>&nbsp;<span class="op" id="6394536">=</span>&nbsp;<span class="builtinfunc" id="6394538">make</span><span class="op" id="6394542">(</span><span class="op" id="6394543">[</span><span class="op" id="6394544">]</span><span class="builtintype" id="6394545">byte</span><span class="op" id="6394549">,</span>&nbsp;<span class="ident" id="6394551">l</span><span class="op" id="6394552">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394556">if</span>&nbsp;<span class="ident" id="6394559">_</span><span class="op" id="6394560">,</span>&nbsp;<span class="ident" id="6394562">err</span>&nbsp;<span class="op" id="6394566">:=</span>&nbsp;<span class="ident" id="6394569">r</span><span class="op" id="6394570">.</span><span class="ident" id="6394571">ReadAt</span><span class="op" id="6394577">(</span><span class="ident" id="6394578">ss</span><span class="op" id="6394580">,</span>&nbsp;<span class="ident" id="6394582">int64</span><span class="op" id="6394587">(</span><span class="ident" id="6394588">f</span><span class="op" id="6394589">.</span><span class="ident" id="6394590">FileHeader</span><span class="op" id="6394600">.</span><span class="ident" id="6394601">PointerToSymbolTable</span><span class="op" id="6394621">+</span><span class="ident" id="6394622">COFFSymbolSize</span><span class="op" id="6394636">*</span><span class="ident" id="6394637">f</span><span class="op" id="6394638">.</span><span class="ident" id="6394639">FileHeader</span><span class="op" id="6394649">.</span><span class="ident" id="6394650">NumberOfSymbols</span><span class="op" id="6394665">)</span><span class="op" id="6394666">)</span><span class="op" id="6394667">;</span>&nbsp;<span class="ident" id="6394669">err</span>&nbsp;<span class="op" id="6394673">!=</span>&nbsp;<span class="ident" id="6394676">nil</span>&nbsp;<span class="op" id="6394680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394685">return</span>&nbsp;<span class="ident" id="6394692">nil</span><span class="op" id="6394695">,</span>&nbsp;<span class="ident" id="6394697">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6394703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6394708">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6394740">sr</span><span class="op" id="6394742">.</span><span class="ident" id="6394743">Seek</span><span class="op" id="6394747">(</span><span class="ident" id="6394748">int64</span><span class="op" id="6394753">(</span><span class="ident" id="6394754">f</span><span class="op" id="6394755">.</span><span class="ident" id="6394756">FileHeader</span><span class="op" id="6394766">.</span><span class="ident" id="6394767">PointerToSymbolTable</span><span class="op" id="6394787">)</span><span class="op" id="6394788">,</span>&nbsp;<span class="ident" id="6394790">os</span><span class="op" id="6394792">.</span><span class="ident" id="6394793">SEEK_SET</span><span class="op" id="6394801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6394805">aux</span>&nbsp;<span class="op" id="6394809">:=</span>&nbsp;<span class="builtintype" id="6394812">uint8</span><span class="op" id="6394817">(</span><span class="num" id="6394818">0</span><span class="op" id="6394819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394823">for</span>&nbsp;<span class="ident" id="6394827">i</span>&nbsp;<span class="op" id="6394829">:=</span>&nbsp;<span class="num" id="6394832">0</span><span class="op" id="6394833">;</span>&nbsp;<span class="ident" id="6394835">i</span>&nbsp;<span class="op" id="6394837">&lt;</span>&nbsp;<span class="builtintype" id="6394839">int</span><span class="op" id="6394842">(</span><span class="ident" id="6394843">f</span><span class="op" id="6394844">.</span><span class="ident" id="6394845">FileHeader</span><span class="op" id="6394855">.</span><span class="ident" id="6394856">NumberOfSymbols</span><span class="op" id="6394871">)</span><span class="op" id="6394872">;</span>&nbsp;<span class="ident" id="6394874">i</span><span class="op" id="6394875">++</span>&nbsp;<span class="op" id="6394878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6394883">cs</span>&nbsp;<span class="op" id="6394886">:=</span>&nbsp;<span class="builtinfunc" id="6394889">new</span><span class="op" id="6394892">(</span><span class="ident" id="6394893">COFFSymbol</span><span class="op" id="6394903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394908">if</span>&nbsp;<span class="ident" id="6394911">err</span>&nbsp;<span class="op" id="6394915">:=</span>&nbsp;<span class="ident" id="6394918">binary</span><span class="op" id="6394924">.</span><span class="ident" id="6394925">Read</span><span class="op" id="6394929">(</span><span class="ident" id="6394930">sr</span><span class="op" id="6394932">,</span>&nbsp;<span class="ident" id="6394934">binary</span><span class="op" id="6394940">.</span><span class="ident" id="6394941">LittleEndian</span><span class="op" id="6394953">,</span>&nbsp;<span class="ident" id="6394955">cs</span><span class="op" id="6394957">)</span><span class="op" id="6394958">;</span>&nbsp;<span class="ident" id="6394960">err</span>&nbsp;<span class="op" id="6394964">!=</span>&nbsp;<span class="ident" id="6394967">nil</span>&nbsp;<span class="op" id="6394971">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6394977">return</span>&nbsp;<span class="ident" id="6394984">nil</span><span class="op" id="6394987">,</span>&nbsp;<span class="ident" id="6394989">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6394996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395001">if</span>&nbsp;<span class="ident" id="6395004">aux</span>&nbsp;<span class="op" id="6395008">&gt;</span>&nbsp;<span class="num" id="6395010">0</span>&nbsp;<span class="op" id="6395012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395018">aux</span><span class="op" id="6395021">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395028">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395045">var</span>&nbsp;<span class="ident" id="6395049">name</span>&nbsp;<span class="builtintype" id="6395054">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395064">if</span>&nbsp;<span class="ident" id="6395067">cs</span><span class="op" id="6395069">.</span><span class="ident" id="6395070">Name</span><span class="op" id="6395074">[</span><span class="num" id="6395075">0</span><span class="op" id="6395076">]</span>&nbsp;<span class="op" id="6395078">==</span>&nbsp;<span class="num" id="6395081">0</span>&nbsp;<span class="op" id="6395083">&amp;&amp;</span>&nbsp;<span class="ident" id="6395086">cs</span><span class="op" id="6395088">.</span><span class="ident" id="6395089">Name</span><span class="op" id="6395093">[</span><span class="num" id="6395094">1</span><span class="op" id="6395095">]</span>&nbsp;<span class="op" id="6395097">==</span>&nbsp;<span class="num" id="6395100">0</span>&nbsp;<span class="op" id="6395102">&amp;&amp;</span>&nbsp;<span class="ident" id="6395105">cs</span><span class="op" id="6395107">.</span><span class="ident" id="6395108">Name</span><span class="op" id="6395112">[</span><span class="num" id="6395113">2</span><span class="op" id="6395114">]</span>&nbsp;<span class="op" id="6395116">==</span>&nbsp;<span class="num" id="6395119">0</span>&nbsp;<span class="op" id="6395121">&amp;&amp;</span>&nbsp;<span class="ident" id="6395124">cs</span><span class="op" id="6395126">.</span><span class="ident" id="6395127">Name</span><span class="op" id="6395131">[</span><span class="num" id="6395132">3</span><span class="op" id="6395133">]</span>&nbsp;<span class="op" id="6395135">==</span>&nbsp;<span class="num" id="6395138">0</span>&nbsp;<span class="op" id="6395140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395146">si</span>&nbsp;<span class="op" id="6395149">:=</span>&nbsp;<span class="builtintype" id="6395152">int</span><span class="op" id="6395155">(</span><span class="ident" id="6395156">binary</span><span class="op" id="6395162">.</span><span class="ident" id="6395163">LittleEndian</span><span class="op" id="6395175">.</span><span class="ident" id="6395176">Uint32</span><span class="op" id="6395182">(</span><span class="ident" id="6395183">cs</span><span class="op" id="6395185">.</span><span class="ident" id="6395186">Name</span><span class="op" id="6395190">[</span><span class="num" id="6395191">4</span><span class="op" id="6395192">:</span><span class="op" id="6395193">]</span><span class="op" id="6395194">)</span><span class="op" id="6395195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395201">name</span><span class="op" id="6395205">,</span>&nbsp;<span class="ident" id="6395207">_</span>&nbsp;<span class="op" id="6395209">=</span>&nbsp;<span class="ident" id="6395211">getString</span><span class="op" id="6395220">(</span><span class="ident" id="6395221">ss</span><span class="op" id="6395223">,</span>&nbsp;<span class="ident" id="6395225">si</span><span class="op" id="6395227">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395232">}</span>&nbsp;<span class="keyword" id="6395234">else</span>&nbsp;<span class="op" id="6395239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395245">name</span>&nbsp;<span class="op" id="6395250">=</span>&nbsp;<span class="ident" id="6395252">cstring</span><span class="op" id="6395259">(</span><span class="ident" id="6395260">cs</span><span class="op" id="6395262">.</span><span class="ident" id="6395263">Name</span><span class="op" id="6395267">[</span><span class="op" id="6395268">:</span><span class="op" id="6395269">]</span><span class="op" id="6395270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395280">aux</span>&nbsp;<span class="op" id="6395284">=</span>&nbsp;<span class="ident" id="6395286">cs</span><span class="op" id="6395288">.</span><span class="ident" id="6395289">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395311">s</span>&nbsp;<span class="op" id="6395313">:=</span>&nbsp;<span class="op" id="6395316">&amp;</span><span class="ident" id="6395317">Symbol</span><span class="op" id="6395323">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395329">Name</span><span class="op" id="6395333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395344">name</span><span class="op" id="6395348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395354">Value</span><span class="op" id="6395359">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395369">cs</span><span class="op" id="6395371">.</span><span class="ident" id="6395372">Value</span><span class="op" id="6395377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395383">SectionNumber</span><span class="op" id="6395396">:</span>&nbsp;<span class="ident" id="6395398">cs</span><span class="op" id="6395400">.</span><span class="ident" id="6395401">SectionNumber</span><span class="op" id="6395414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395420">Type</span><span class="op" id="6395424">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395435">cs</span><span class="op" id="6395437">.</span><span class="ident" id="6395438">Type</span><span class="op" id="6395442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395448">StorageClass</span><span class="op" id="6395460">:</span>&nbsp;&nbsp;<span class="ident" id="6395463">cs</span><span class="op" id="6395465">.</span><span class="ident" id="6395466">StorageClass</span><span class="op" id="6395478">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395488">f</span><span class="op" id="6395489">.</span><span class="ident" id="6395490">Symbols</span>&nbsp;<span class="op" id="6395498">=</span>&nbsp;<span class="builtinfunc" id="6395500">append</span><span class="op" id="6395506">(</span><span class="ident" id="6395507">f</span><span class="op" id="6395508">.</span><span class="ident" id="6395509">Symbols</span><span class="op" id="6395516">,</span>&nbsp;<span class="ident" id="6395518">s</span><span class="op" id="6395519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6395530">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395556">sr</span><span class="op" id="6395558">.</span><span class="ident" id="6395559">Seek</span><span class="op" id="6395563">(</span><span class="ident" id="6395564">base</span><span class="op" id="6395568">,</span>&nbsp;<span class="ident" id="6395570">os</span><span class="op" id="6395572">.</span><span class="ident" id="6395573">SEEK_SET</span><span class="op" id="6395581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395584">if</span>&nbsp;<span class="ident" id="6395587">err</span>&nbsp;<span class="op" id="6395591">:=</span>&nbsp;<span class="ident" id="6395594">binary</span><span class="op" id="6395600">.</span><span class="ident" id="6395601">Read</span><span class="op" id="6395605">(</span><span class="ident" id="6395606">sr</span><span class="op" id="6395608">,</span>&nbsp;<span class="ident" id="6395610">binary</span><span class="op" id="6395616">.</span><span class="ident" id="6395617">LittleEndian</span><span class="op" id="6395629">,</span>&nbsp;<span class="op" id="6395631">&amp;</span><span class="ident" id="6395632">f</span><span class="op" id="6395633">.</span><span class="ident" id="6395634">FileHeader</span><span class="op" id="6395644">)</span><span class="op" id="6395645">;</span>&nbsp;<span class="ident" id="6395647">err</span>&nbsp;<span class="op" id="6395651">!=</span>&nbsp;<span class="ident" id="6395654">nil</span>&nbsp;<span class="op" id="6395658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395662">return</span>&nbsp;<span class="ident" id="6395669">nil</span><span class="op" id="6395672">,</span>&nbsp;<span class="ident" id="6395674">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395679">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395682">var</span>&nbsp;<span class="ident" id="6395686">oh32</span>&nbsp;<span class="ident" id="6395691">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395709">var</span>&nbsp;<span class="ident" id="6395713">oh64</span>&nbsp;<span class="ident" id="6395718">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395736">switch</span>&nbsp;<span class="ident" id="6395743">f</span><span class="op" id="6395744">.</span><span class="ident" id="6395745">FileHeader</span><span class="op" id="6395755">.</span><span class="ident" id="6395756">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="6395777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395780">case</span>&nbsp;<span class="ident" id="6395785">sizeofOptionalHeader32</span><span class="op" id="6395807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395811">if</span>&nbsp;<span class="ident" id="6395814">err</span>&nbsp;<span class="op" id="6395818">:=</span>&nbsp;<span class="ident" id="6395821">binary</span><span class="op" id="6395827">.</span><span class="ident" id="6395828">Read</span><span class="op" id="6395832">(</span><span class="ident" id="6395833">sr</span><span class="op" id="6395835">,</span>&nbsp;<span class="ident" id="6395837">binary</span><span class="op" id="6395843">.</span><span class="ident" id="6395844">LittleEndian</span><span class="op" id="6395856">,</span>&nbsp;<span class="op" id="6395858">&amp;</span><span class="ident" id="6395859">oh32</span><span class="op" id="6395863">)</span><span class="op" id="6395864">;</span>&nbsp;<span class="ident" id="6395866">err</span>&nbsp;<span class="op" id="6395870">!=</span>&nbsp;<span class="ident" id="6395873">nil</span>&nbsp;<span class="op" id="6395877">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395882">return</span>&nbsp;<span class="ident" id="6395889">nil</span><span class="op" id="6395892">,</span>&nbsp;<span class="ident" id="6395894">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6395900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395904">if</span>&nbsp;<span class="ident" id="6395907">oh32</span><span class="op" id="6395911">.</span><span class="ident" id="6395912">Magic</span>&nbsp;<span class="op" id="6395918">!=</span>&nbsp;<span class="num" id="6395921">0x10b</span>&nbsp;<span class="op" id="6395927">{</span>&nbsp;<span class="comment" id="6395929">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6395940">return</span>&nbsp;<span class="ident" id="6395947">nil</span><span class="op" id="6395950">,</span>&nbsp;<span class="ident" id="6395952">fmt</span><span class="op" id="6395955">.</span><span class="ident" id="6395956">Errorf</span><span class="op" id="6395962">(</span><span class="string" id="6395963">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6396014">,</span>&nbsp;<span class="ident" id="6396016">oh32</span><span class="op" id="6396020">.</span><span class="ident" id="6396021">Magic</span><span class="op" id="6396026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396030">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396034">f</span><span class="op" id="6396035">.</span><span class="ident" id="6396036">OptionalHeader</span>&nbsp;<span class="op" id="6396051">=</span>&nbsp;<span class="op" id="6396053">&amp;</span><span class="ident" id="6396054">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396060">case</span>&nbsp;<span class="ident" id="6396065">sizeofOptionalHeader64</span><span class="op" id="6396087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396091">if</span>&nbsp;<span class="ident" id="6396094">err</span>&nbsp;<span class="op" id="6396098">:=</span>&nbsp;<span class="ident" id="6396101">binary</span><span class="op" id="6396107">.</span><span class="ident" id="6396108">Read</span><span class="op" id="6396112">(</span><span class="ident" id="6396113">sr</span><span class="op" id="6396115">,</span>&nbsp;<span class="ident" id="6396117">binary</span><span class="op" id="6396123">.</span><span class="ident" id="6396124">LittleEndian</span><span class="op" id="6396136">,</span>&nbsp;<span class="op" id="6396138">&amp;</span><span class="ident" id="6396139">oh64</span><span class="op" id="6396143">)</span><span class="op" id="6396144">;</span>&nbsp;<span class="ident" id="6396146">err</span>&nbsp;<span class="op" id="6396150">!=</span>&nbsp;<span class="ident" id="6396153">nil</span>&nbsp;<span class="op" id="6396157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396162">return</span>&nbsp;<span class="ident" id="6396169">nil</span><span class="op" id="6396172">,</span>&nbsp;<span class="ident" id="6396174">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396180">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396184">if</span>&nbsp;<span class="ident" id="6396187">oh64</span><span class="op" id="6396191">.</span><span class="ident" id="6396192">Magic</span>&nbsp;<span class="op" id="6396198">!=</span>&nbsp;<span class="num" id="6396201">0x20b</span>&nbsp;<span class="op" id="6396207">{</span>&nbsp;<span class="comment" id="6396209">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396221">return</span>&nbsp;<span class="ident" id="6396228">nil</span><span class="op" id="6396231">,</span>&nbsp;<span class="ident" id="6396233">fmt</span><span class="op" id="6396236">.</span><span class="ident" id="6396237">Errorf</span><span class="op" id="6396243">(</span><span class="string" id="6396244">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6396296">,</span>&nbsp;<span class="ident" id="6396298">oh64</span><span class="op" id="6396302">.</span><span class="ident" id="6396303">Magic</span><span class="op" id="6396308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396316">f</span><span class="op" id="6396317">.</span><span class="ident" id="6396318">OptionalHeader</span>&nbsp;<span class="op" id="6396333">=</span>&nbsp;<span class="op" id="6396335">&amp;</span><span class="ident" id="6396336">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396342">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396346">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396368">f</span><span class="op" id="6396369">.</span><span class="ident" id="6396370">Sections</span>&nbsp;<span class="op" id="6396379">=</span>&nbsp;<span class="builtinfunc" id="6396381">make</span><span class="op" id="6396385">(</span><span class="op" id="6396386">[</span><span class="op" id="6396387">]</span><span class="op" id="6396388">*</span><span class="ident" id="6396389">Section</span><span class="op" id="6396396">,</span>&nbsp;<span class="ident" id="6396398">f</span><span class="op" id="6396399">.</span><span class="ident" id="6396400">FileHeader</span><span class="op" id="6396410">.</span><span class="ident" id="6396411">NumberOfSections</span><span class="op" id="6396427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396430">for</span>&nbsp;<span class="ident" id="6396434">i</span>&nbsp;<span class="op" id="6396436">:=</span>&nbsp;<span class="num" id="6396439">0</span><span class="op" id="6396440">;</span>&nbsp;<span class="ident" id="6396442">i</span>&nbsp;<span class="op" id="6396444">&lt;</span>&nbsp;<span class="builtintype" id="6396446">int</span><span class="op" id="6396449">(</span><span class="ident" id="6396450">f</span><span class="op" id="6396451">.</span><span class="ident" id="6396452">FileHeader</span><span class="op" id="6396462">.</span><span class="ident" id="6396463">NumberOfSections</span><span class="op" id="6396479">)</span><span class="op" id="6396480">;</span>&nbsp;<span class="ident" id="6396482">i</span><span class="op" id="6396483">++</span>&nbsp;<span class="op" id="6396486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396490">sh</span>&nbsp;<span class="op" id="6396493">:=</span>&nbsp;<span class="builtinfunc" id="6396496">new</span><span class="op" id="6396499">(</span><span class="ident" id="6396500">SectionHeader32</span><span class="op" id="6396515">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396519">if</span>&nbsp;<span class="ident" id="6396522">err</span>&nbsp;<span class="op" id="6396526">:=</span>&nbsp;<span class="ident" id="6396529">binary</span><span class="op" id="6396535">.</span><span class="ident" id="6396536">Read</span><span class="op" id="6396540">(</span><span class="ident" id="6396541">sr</span><span class="op" id="6396543">,</span>&nbsp;<span class="ident" id="6396545">binary</span><span class="op" id="6396551">.</span><span class="ident" id="6396552">LittleEndian</span><span class="op" id="6396564">,</span>&nbsp;<span class="ident" id="6396566">sh</span><span class="op" id="6396568">)</span><span class="op" id="6396569">;</span>&nbsp;<span class="ident" id="6396571">err</span>&nbsp;<span class="op" id="6396575">!=</span>&nbsp;<span class="ident" id="6396578">nil</span>&nbsp;<span class="op" id="6396582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396587">return</span>&nbsp;<span class="ident" id="6396594">nil</span><span class="op" id="6396597">,</span>&nbsp;<span class="ident" id="6396599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396609">var</span>&nbsp;<span class="ident" id="6396613">name</span>&nbsp;<span class="builtintype" id="6396618">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396627">if</span>&nbsp;<span class="ident" id="6396630">sh</span><span class="op" id="6396632">.</span><span class="ident" id="6396633">Name</span><span class="op" id="6396637">[</span><span class="num" id="6396638">0</span><span class="op" id="6396639">]</span>&nbsp;<span class="op" id="6396641">==</span>&nbsp;<span class="string" id="6396644">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="6396651">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396656">si</span><span class="op" id="6396658">,</span>&nbsp;<span class="ident" id="6396660">_</span>&nbsp;<span class="op" id="6396662">:=</span>&nbsp;<span class="ident" id="6396665">strconv</span><span class="op" id="6396672">.</span><span class="ident" id="6396673">Atoi</span><span class="op" id="6396677">(</span><span class="ident" id="6396678">cstring</span><span class="op" id="6396685">(</span><span class="ident" id="6396686">sh</span><span class="op" id="6396688">.</span><span class="ident" id="6396689">Name</span><span class="op" id="6396693">[</span><span class="num" id="6396694">1</span><span class="op" id="6396695">:</span><span class="op" id="6396696">]</span><span class="op" id="6396697">)</span><span class="op" id="6396698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396703">name</span><span class="op" id="6396707">,</span>&nbsp;<span class="ident" id="6396709">_</span>&nbsp;<span class="op" id="6396711">=</span>&nbsp;<span class="ident" id="6396713">getString</span><span class="op" id="6396722">(</span><span class="ident" id="6396723">ss</span><span class="op" id="6396725">,</span>&nbsp;<span class="ident" id="6396727">si</span><span class="op" id="6396729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396733">}</span>&nbsp;<span class="keyword" id="6396735">else</span>&nbsp;<span class="op" id="6396740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396745">name</span>&nbsp;<span class="op" id="6396750">=</span>&nbsp;<span class="ident" id="6396752">cstring</span><span class="op" id="6396759">(</span><span class="ident" id="6396760">sh</span><span class="op" id="6396762">.</span><span class="ident" id="6396763">Name</span><span class="op" id="6396767">[</span><span class="num" id="6396768">0</span><span class="op" id="6396769">:</span><span class="op" id="6396770">]</span><span class="op" id="6396771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396775">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396779">s</span>&nbsp;<span class="op" id="6396781">:=</span>&nbsp;<span class="builtinfunc" id="6396784">new</span><span class="op" id="6396787">(</span><span class="ident" id="6396788">Section</span><span class="op" id="6396795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396799">s</span><span class="op" id="6396800">.</span><span class="ident" id="6396801">SectionHeader</span>&nbsp;<span class="op" id="6396815">=</span>&nbsp;<span class="ident" id="6396817">SectionHeader</span><span class="op" id="6396830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396835">Name</span><span class="op" id="6396839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396857">name</span><span class="op" id="6396861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396866">VirtualSize</span><span class="op" id="6396877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396888">sh</span><span class="op" id="6396890">.</span><span class="ident" id="6396891">VirtualSize</span><span class="op" id="6396902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396907">VirtualAddress</span><span class="op" id="6396921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396929">sh</span><span class="op" id="6396931">.</span><span class="ident" id="6396932">VirtualAddress</span><span class="op" id="6396946">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396951">Size</span><span class="op" id="6396955">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396973">sh</span><span class="op" id="6396975">.</span><span class="ident" id="6396976">SizeOfRawData</span><span class="op" id="6396989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396994">Offset</span><span class="op" id="6397000">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397016">sh</span><span class="op" id="6397018">.</span><span class="ident" id="6397019">PointerToRawData</span><span class="op" id="6397035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397040">PointerToRelocations</span><span class="op" id="6397060">:</span>&nbsp;<span class="ident" id="6397062">sh</span><span class="op" id="6397064">.</span><span class="ident" id="6397065">PointerToRelocations</span><span class="op" id="6397085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397090">PointerToLineNumbers</span><span class="op" id="6397110">:</span>&nbsp;<span class="ident" id="6397112">sh</span><span class="op" id="6397114">.</span><span class="ident" id="6397115">PointerToLineNumbers</span><span class="op" id="6397135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397140">NumberOfRelocations</span><span class="op" id="6397159">:</span>&nbsp;&nbsp;<span class="ident" id="6397162">sh</span><span class="op" id="6397164">.</span><span class="ident" id="6397165">NumberOfRelocations</span><span class="op" id="6397184">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397189">NumberOfLineNumbers</span><span class="op" id="6397208">:</span>&nbsp;&nbsp;<span class="ident" id="6397211">sh</span><span class="op" id="6397213">.</span><span class="ident" id="6397214">NumberOfLineNumbers</span><span class="op" id="6397233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397238">Characteristics</span><span class="op" id="6397253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397260">sh</span><span class="op" id="6397262">.</span><span class="ident" id="6397263">Characteristics</span><span class="op" id="6397278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397286">s</span><span class="op" id="6397287">.</span><span class="ident" id="6397288">sr</span>&nbsp;<span class="op" id="6397291">=</span>&nbsp;<span class="ident" id="6397293">io</span><span class="op" id="6397295">.</span><span class="ident" id="6397296">NewSectionReader</span><span class="op" id="6397312">(</span><span class="ident" id="6397313">r</span><span class="op" id="6397314">,</span>&nbsp;<span class="ident" id="6397316">int64</span><span class="op" id="6397321">(</span><span class="ident" id="6397322">s</span><span class="op" id="6397323">.</span><span class="ident" id="6397324">SectionHeader</span><span class="op" id="6397337">.</span><span class="ident" id="6397338">Offset</span><span class="op" id="6397344">)</span><span class="op" id="6397345">,</span>&nbsp;<span class="ident" id="6397347">int64</span><span class="op" id="6397352">(</span><span class="ident" id="6397353">s</span><span class="op" id="6397354">.</span><span class="ident" id="6397355">SectionHeader</span><span class="op" id="6397368">.</span><span class="ident" id="6397369">Size</span><span class="op" id="6397373">)</span><span class="op" id="6397374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397378">s</span><span class="op" id="6397379">.</span><span class="ident" id="6397380">ReaderAt</span>&nbsp;<span class="op" id="6397389">=</span>&nbsp;<span class="ident" id="6397391">s</span><span class="op" id="6397392">.</span><span class="ident" id="6397393">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397398">f</span><span class="op" id="6397399">.</span><span class="ident" id="6397400">Sections</span><span class="op" id="6397408">[</span><span class="ident" id="6397409">i</span><span class="op" id="6397410">]</span>&nbsp;<span class="op" id="6397412">=</span>&nbsp;<span class="ident" id="6397414">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397420">return</span>&nbsp;<span class="ident" id="6397427">f</span><span class="op" id="6397428">,</span>&nbsp;<span class="ident" id="6397430">nil</span><br>
<span class="lineno"></span><span class="op" id="6397434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="6397437">func</span>&nbsp;<span class="ident" id="6397442">cstring</span><span class="op" id="6397449">(</span><span class="ident" id="6397450">b</span>&nbsp;<span class="op" id="6397452">[</span><span class="op" id="6397453">]</span><span class="builtintype" id="6397454">byte</span><span class="op" id="6397458">)</span>&nbsp;<span class="builtintype" id="6397460">string</span>&nbsp;<span class="op" id="6397467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397470">var</span>&nbsp;<span class="ident" id="6397474">i</span>&nbsp;<span class="builtintype" id="6397476">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397481">for</span>&nbsp;<span class="ident" id="6397485">i</span>&nbsp;<span class="op" id="6397487">=</span>&nbsp;<span class="num" id="6397489">0</span><span class="op" id="6397490">;</span>&nbsp;<span class="ident" id="6397492">i</span>&nbsp;<span class="op" id="6397494">&lt;</span>&nbsp;<span class="builtinfunc" id="6397496">len</span><span class="op" id="6397499">(</span><span class="ident" id="6397500">b</span><span class="op" id="6397501">)</span>&nbsp;<span class="op" id="6397503">&amp;&amp;</span>&nbsp;<span class="ident" id="6397506">b</span><span class="op" id="6397507">[</span><span class="ident" id="6397508">i</span><span class="op" id="6397509">]</span>&nbsp;<span class="op" id="6397511">!=</span>&nbsp;<span class="num" id="6397514">0</span><span class="op" id="6397515">;</span>&nbsp;<span class="ident" id="6397517">i</span><span class="op" id="6397518">++</span>&nbsp;<span class="op" id="6397521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397527">return</span>&nbsp;<span class="builtintype" id="6397534">string</span><span class="op" id="6397540">(</span><span class="ident" id="6397541">b</span><span class="op" id="6397542">[</span><span class="num" id="6397543">0</span><span class="op" id="6397544">:</span><span class="ident" id="6397545">i</span><span class="op" id="6397546">]</span><span class="op" id="6397547">)</span><br>
<span class="lineno">270</span><span class="op" id="6397549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6397552">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6397609">func</span>&nbsp;<span class="ident" id="6397614">getString</span><span class="op" id="6397623">(</span><span class="ident" id="6397624">section</span>&nbsp;<span class="op" id="6397632">[</span><span class="op" id="6397633">]</span><span class="builtintype" id="6397634">byte</span><span class="op" id="6397638">,</span>&nbsp;<span class="ident" id="6397640">start</span>&nbsp;<span class="builtintype" id="6397646">int</span><span class="op" id="6397649">)</span>&nbsp;<span class="op" id="6397651">(</span><span class="builtintype" id="6397652">string</span><span class="op" id="6397658">,</span>&nbsp;<span class="builtintype" id="6397660">bool</span><span class="op" id="6397664">)</span>&nbsp;<span class="op" id="6397666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397669">if</span>&nbsp;<span class="ident" id="6397672">start</span>&nbsp;<span class="op" id="6397678">&lt;</span>&nbsp;<span class="num" id="6397680">0</span>&nbsp;<span class="op" id="6397682">||</span>&nbsp;<span class="ident" id="6397685">start</span>&nbsp;<span class="op" id="6397691">&gt;=</span>&nbsp;<span class="builtinfunc" id="6397694">len</span><span class="op" id="6397697">(</span><span class="ident" id="6397698">section</span><span class="op" id="6397705">)</span>&nbsp;<span class="op" id="6397707">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397711">return</span>&nbsp;<span class="string" id="6397718">&#34;&#34;</span><span class="op" id="6397720">,</span>&nbsp;<span class="builtintype" id="6397722">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397733">for</span>&nbsp;<span class="ident" id="6397737">end</span>&nbsp;<span class="op" id="6397741">:=</span>&nbsp;<span class="ident" id="6397744">start</span><span class="op" id="6397749">;</span>&nbsp;<span class="ident" id="6397751">end</span>&nbsp;<span class="op" id="6397755">&lt;</span>&nbsp;<span class="builtinfunc" id="6397757">len</span><span class="op" id="6397760">(</span><span class="ident" id="6397761">section</span><span class="op" id="6397768">)</span><span class="op" id="6397769">;</span>&nbsp;<span class="ident" id="6397771">end</span><span class="op" id="6397774">++</span>&nbsp;<span class="op" id="6397777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397781">if</span>&nbsp;<span class="ident" id="6397784">section</span><span class="op" id="6397791">[</span><span class="ident" id="6397792">end</span><span class="op" id="6397795">]</span>&nbsp;<span class="op" id="6397797">==</span>&nbsp;<span class="num" id="6397800">0</span>&nbsp;<span class="op" id="6397802">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397807">return</span>&nbsp;<span class="builtintype" id="6397814">string</span><span class="op" id="6397820">(</span><span class="ident" id="6397821">section</span><span class="op" id="6397828">[</span><span class="ident" id="6397829">start</span><span class="op" id="6397834">:</span><span class="ident" id="6397835">end</span><span class="op" id="6397838">]</span><span class="op" id="6397839">)</span><span class="op" id="6397840">,</span>&nbsp;<span class="builtintype" id="6397842">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397855">return</span>&nbsp;<span class="string" id="6397862">&#34;&#34;</span><span class="op" id="6397864">,</span>&nbsp;<span class="builtintype" id="6397866">false</span><br>
<span class="lineno"></span><span class="op" id="6397872">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="6397875">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6397951">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6397970">func</span>&nbsp;<span class="op" id="6397975">(</span><span class="ident" id="6397976">f</span>&nbsp;<span class="op" id="6397978">*</span><span class="ident" id="6397979">File</span><span class="op" id="6397983">)</span>&nbsp;<span class="ident" id="6397985">Section</span><span class="op" id="6397992">(</span><span class="ident" id="6397993">name</span>&nbsp;<span class="builtintype" id="6397998">string</span><span class="op" id="6398004">)</span>&nbsp;<span class="op" id="6398006">*</span><span class="ident" id="6398007">Section</span>&nbsp;<span class="op" id="6398015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398018">for</span>&nbsp;<span class="ident" id="6398022">_</span><span class="op" id="6398023">,</span>&nbsp;<span class="ident" id="6398025">s</span>&nbsp;<span class="op" id="6398027">:=</span>&nbsp;<span class="keyword" id="6398030">range</span>&nbsp;<span class="ident" id="6398036">f</span><span class="op" id="6398037">.</span><span class="ident" id="6398038">Sections</span>&nbsp;<span class="op" id="6398047">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398051">if</span>&nbsp;<span class="ident" id="6398054">s</span><span class="op" id="6398055">.</span><span class="ident" id="6398056">Name</span>&nbsp;<span class="op" id="6398061">==</span>&nbsp;<span class="ident" id="6398064">name</span>&nbsp;<span class="op" id="6398069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398074">return</span>&nbsp;<span class="ident" id="6398081">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398091">return</span>&nbsp;<span class="ident" id="6398098">nil</span><br>
<span class="lineno">295</span><span class="op" id="6398102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6398105">func</span>&nbsp;<span class="op" id="6398110">(</span><span class="ident" id="6398111">f</span>&nbsp;<span class="op" id="6398113">*</span><span class="ident" id="6398114">File</span><span class="op" id="6398118">)</span>&nbsp;<span class="ident" id="6398120">DWARF</span><span class="op" id="6398125">(</span><span class="op" id="6398126">)</span>&nbsp;<span class="op" id="6398128">(</span><span class="op" id="6398129">*</span><span class="ident" id="6398130">dwarf</span><span class="op" id="6398135">.</span><span class="ident" id="6398136">Data</span><span class="op" id="6398140">,</span>&nbsp;<span class="builtintype" id="6398142">error</span><span class="op" id="6398147">)</span>&nbsp;<span class="op" id="6398149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6398152">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6398203">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6398258">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398317">var</span>&nbsp;<span class="ident" id="6398321">names</span>&nbsp;<span class="op" id="6398327">=</span>&nbsp;<span class="op" id="6398329">[</span><span class="op" id="6398330">...</span><span class="op" id="6398333">]</span><span class="builtintype" id="6398334">string</span><span class="op" id="6398340">{</span><span class="string" id="6398341">&#34;abbrev&#34;</span><span class="op" id="6398349">,</span>&nbsp;<span class="string" id="6398351">&#34;info&#34;</span><span class="op" id="6398357">,</span>&nbsp;<span class="string" id="6398359">&#34;str&#34;</span><span class="op" id="6398364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398367">var</span>&nbsp;<span class="ident" id="6398371">dat</span>&nbsp;<span class="op" id="6398375">[</span><span class="builtinfunc" id="6398376">len</span><span class="op" id="6398379">(</span><span class="ident" id="6398380">names</span><span class="op" id="6398385">)</span><span class="op" id="6398386">]</span><span class="op" id="6398387">[</span><span class="op" id="6398388">]</span><span class="builtintype" id="6398389">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398395">for</span>&nbsp;<span class="ident" id="6398399">i</span><span class="op" id="6398400">,</span>&nbsp;<span class="ident" id="6398402">name</span>&nbsp;<span class="op" id="6398407">:=</span>&nbsp;<span class="keyword" id="6398410">range</span>&nbsp;<span class="ident" id="6398416">names</span>&nbsp;<span class="op" id="6398422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398426">name</span>&nbsp;<span class="op" id="6398431">=</span>&nbsp;<span class="string" id="6398433">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6398443">+</span>&nbsp;<span class="ident" id="6398445">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398452">s</span>&nbsp;<span class="op" id="6398454">:=</span>&nbsp;<span class="ident" id="6398457">f</span><span class="op" id="6398458">.</span><span class="ident" id="6398459">Section</span><span class="op" id="6398466">(</span><span class="ident" id="6398467">name</span><span class="op" id="6398471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398475">if</span>&nbsp;<span class="ident" id="6398478">s</span>&nbsp;<span class="op" id="6398480">==</span>&nbsp;<span class="ident" id="6398483">nil</span>&nbsp;<span class="op" id="6398487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398492">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398507">b</span><span class="op" id="6398508">,</span>&nbsp;<span class="ident" id="6398510">err</span>&nbsp;<span class="op" id="6398514">:=</span>&nbsp;<span class="ident" id="6398517">s</span><span class="op" id="6398518">.</span><span class="ident" id="6398519">Data</span><span class="op" id="6398523">(</span><span class="op" id="6398524">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398528">if</span>&nbsp;<span class="ident" id="6398531">err</span>&nbsp;<span class="op" id="6398535">!=</span>&nbsp;<span class="ident" id="6398538">nil</span>&nbsp;<span class="op" id="6398542">&amp;&amp;</span>&nbsp;<span class="builtintype" id="6398545">uint32</span><span class="op" id="6398551">(</span><span class="builtinfunc" id="6398552">len</span><span class="op" id="6398555">(</span><span class="ident" id="6398556">b</span><span class="op" id="6398557">)</span><span class="op" id="6398558">)</span>&nbsp;<span class="op" id="6398560">&lt;</span>&nbsp;<span class="ident" id="6398562">s</span><span class="op" id="6398563">.</span><span class="ident" id="6398564">Size</span>&nbsp;<span class="op" id="6398569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398574">return</span>&nbsp;<span class="ident" id="6398581">nil</span><span class="op" id="6398584">,</span>&nbsp;<span class="ident" id="6398586">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398596">dat</span><span class="op" id="6398599">[</span><span class="ident" id="6398600">i</span><span class="op" id="6398601">]</span>&nbsp;<span class="op" id="6398603">=</span>&nbsp;<span class="ident" id="6398605">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398608">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398612">abbrev</span><span class="op" id="6398618">,</span>&nbsp;<span class="ident" id="6398620">info</span><span class="op" id="6398624">,</span>&nbsp;<span class="ident" id="6398626">str</span>&nbsp;<span class="op" id="6398630">:=</span>&nbsp;<span class="ident" id="6398633">dat</span><span class="op" id="6398636">[</span><span class="num" id="6398637">0</span><span class="op" id="6398638">]</span><span class="op" id="6398639">,</span>&nbsp;<span class="ident" id="6398641">dat</span><span class="op" id="6398644">[</span><span class="num" id="6398645">1</span><span class="op" id="6398646">]</span><span class="op" id="6398647">,</span>&nbsp;<span class="ident" id="6398649">dat</span><span class="op" id="6398652">[</span><span class="num" id="6398653">2</span><span class="op" id="6398654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398657">return</span>&nbsp;<span class="ident" id="6398664">dwarf</span><span class="op" id="6398669">.</span><span class="ident" id="6398670">New</span><span class="op" id="6398673">(</span><span class="ident" id="6398674">abbrev</span><span class="op" id="6398680">,</span>&nbsp;<span class="ident" id="6398682">nil</span><span class="op" id="6398685">,</span>&nbsp;<span class="ident" id="6398687">nil</span><span class="op" id="6398690">,</span>&nbsp;<span class="ident" id="6398692">info</span><span class="op" id="6398696">,</span>&nbsp;<span class="ident" id="6398698">nil</span><span class="op" id="6398701">,</span>&nbsp;<span class="ident" id="6398703">nil</span><span class="op" id="6398706">,</span>&nbsp;<span class="ident" id="6398708">nil</span><span class="op" id="6398711">,</span>&nbsp;<span class="ident" id="6398713">str</span><span class="op" id="6398716">)</span><br>
<span class="lineno"></span><span class="op" id="6398718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="6398721">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6398773">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6398828">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6398882">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6398918">func</span>&nbsp;<span class="op" id="6398923">(</span><span class="ident" id="6398924">f</span>&nbsp;<span class="op" id="6398926">*</span><span class="ident" id="6398927">File</span><span class="op" id="6398931">)</span>&nbsp;<span class="ident" id="6398933">ImportedSymbols</span><span class="op" id="6398948">(</span><span class="op" id="6398949">)</span>&nbsp;<span class="op" id="6398951">(</span><span class="op" id="6398952">[</span><span class="op" id="6398953">]</span><span class="builtintype" id="6398954">string</span><span class="op" id="6398960">,</span>&nbsp;<span class="builtintype" id="6398962">error</span><span class="op" id="6398967">)</span>&nbsp;<span class="op" id="6398969">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398972">pe64</span>&nbsp;<span class="op" id="6398977">:=</span>&nbsp;<span class="ident" id="6398980">f</span><span class="op" id="6398981">.</span><span class="ident" id="6398982">Machine</span>&nbsp;<span class="op" id="6398990">==</span>&nbsp;<span class="ident" id="6398993">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399019">ds</span>&nbsp;<span class="op" id="6399022">:=</span>&nbsp;<span class="ident" id="6399025">f</span><span class="op" id="6399026">.</span><span class="ident" id="6399027">Section</span><span class="op" id="6399034">(</span><span class="string" id="6399035">&#34;.idata&#34;</span><span class="op" id="6399043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399046">if</span>&nbsp;<span class="ident" id="6399049">ds</span>&nbsp;<span class="op" id="6399052">==</span>&nbsp;<span class="ident" id="6399055">nil</span>&nbsp;<span class="op" id="6399059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6399063">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399097">return</span>&nbsp;<span class="ident" id="6399104">nil</span><span class="op" id="6399107">,</span>&nbsp;<span class="ident" id="6399109">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399117">d</span><span class="op" id="6399118">,</span>&nbsp;<span class="ident" id="6399120">err</span>&nbsp;<span class="op" id="6399124">:=</span>&nbsp;<span class="ident" id="6399127">ds</span><span class="op" id="6399129">.</span><span class="ident" id="6399130">Data</span><span class="op" id="6399134">(</span><span class="op" id="6399135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399138">if</span>&nbsp;<span class="ident" id="6399141">err</span>&nbsp;<span class="op" id="6399145">!=</span>&nbsp;<span class="ident" id="6399148">nil</span>&nbsp;<span class="op" id="6399152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399156">return</span>&nbsp;<span class="ident" id="6399163">nil</span><span class="op" id="6399166">,</span>&nbsp;<span class="ident" id="6399168">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399173">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399176">var</span>&nbsp;<span class="ident" id="6399180">ida</span>&nbsp;<span class="op" id="6399184">[</span><span class="op" id="6399185">]</span><span class="ident" id="6399186">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399203">for</span>&nbsp;<span class="builtinfunc" id="6399207">len</span><span class="op" id="6399210">(</span><span class="ident" id="6399211">d</span><span class="op" id="6399212">)</span>&nbsp;<span class="op" id="6399214">&gt;</span>&nbsp;<span class="num" id="6399216">0</span>&nbsp;<span class="op" id="6399218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399222">var</span>&nbsp;<span class="ident" id="6399226">dt</span>&nbsp;<span class="ident" id="6399229">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399247">dt</span><span class="op" id="6399249">.</span><span class="ident" id="6399250">OriginalFirstThunk</span>&nbsp;<span class="op" id="6399269">=</span>&nbsp;<span class="ident" id="6399271">binary</span><span class="op" id="6399277">.</span><span class="ident" id="6399278">LittleEndian</span><span class="op" id="6399290">.</span><span class="ident" id="6399291">Uint32</span><span class="op" id="6399297">(</span><span class="ident" id="6399298">d</span><span class="op" id="6399299">[</span><span class="num" id="6399300">0</span><span class="op" id="6399301">:</span><span class="num" id="6399302">4</span><span class="op" id="6399303">]</span><span class="op" id="6399304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399308">dt</span><span class="op" id="6399310">.</span><span class="ident" id="6399311">Name</span>&nbsp;<span class="op" id="6399316">=</span>&nbsp;<span class="ident" id="6399318">binary</span><span class="op" id="6399324">.</span><span class="ident" id="6399325">LittleEndian</span><span class="op" id="6399337">.</span><span class="ident" id="6399338">Uint32</span><span class="op" id="6399344">(</span><span class="ident" id="6399345">d</span><span class="op" id="6399346">[</span><span class="num" id="6399347">12</span><span class="op" id="6399349">:</span><span class="num" id="6399350">16</span><span class="op" id="6399352">]</span><span class="op" id="6399353">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399357">dt</span><span class="op" id="6399359">.</span><span class="ident" id="6399360">FirstThunk</span>&nbsp;<span class="op" id="6399371">=</span>&nbsp;<span class="ident" id="6399373">binary</span><span class="op" id="6399379">.</span><span class="ident" id="6399380">LittleEndian</span><span class="op" id="6399392">.</span><span class="ident" id="6399393">Uint32</span><span class="op" id="6399399">(</span><span class="ident" id="6399400">d</span><span class="op" id="6399401">[</span><span class="num" id="6399402">16</span><span class="op" id="6399404">:</span><span class="num" id="6399405">20</span><span class="op" id="6399407">]</span><span class="op" id="6399408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399412">d</span>&nbsp;<span class="op" id="6399414">=</span>&nbsp;<span class="ident" id="6399416">d</span><span class="op" id="6399417">[</span><span class="num" id="6399418">20</span><span class="op" id="6399420">:</span><span class="op" id="6399421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399425">if</span>&nbsp;<span class="ident" id="6399428">dt</span><span class="op" id="6399430">.</span><span class="ident" id="6399431">OriginalFirstThunk</span>&nbsp;<span class="op" id="6399450">==</span>&nbsp;<span class="num" id="6399453">0</span>&nbsp;<span class="op" id="6399455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399460">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399468">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399472">ida</span>&nbsp;<span class="op" id="6399476">=</span>&nbsp;<span class="builtinfunc" id="6399478">append</span><span class="op" id="6399484">(</span><span class="ident" id="6399485">ida</span><span class="op" id="6399488">,</span>&nbsp;<span class="ident" id="6399490">dt</span><span class="op" id="6399492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399498">names</span><span class="op" id="6399503">,</span>&nbsp;<span class="ident" id="6399505">_</span>&nbsp;<span class="op" id="6399507">:=</span>&nbsp;<span class="ident" id="6399510">ds</span><span class="op" id="6399512">.</span><span class="ident" id="6399513">Data</span><span class="op" id="6399517">(</span><span class="op" id="6399518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399521">var</span>&nbsp;<span class="ident" id="6399525">all</span>&nbsp;<span class="op" id="6399529">[</span><span class="op" id="6399530">]</span><span class="builtintype" id="6399531">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399539">for</span>&nbsp;<span class="ident" id="6399543">_</span><span class="op" id="6399544">,</span>&nbsp;<span class="ident" id="6399546">dt</span>&nbsp;<span class="op" id="6399549">:=</span>&nbsp;<span class="keyword" id="6399552">range</span>&nbsp;<span class="ident" id="6399558">ida</span>&nbsp;<span class="op" id="6399562">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399566">dt</span><span class="op" id="6399568">.</span><span class="ident" id="6399569">dll</span><span class="op" id="6399572">,</span>&nbsp;<span class="ident" id="6399574">_</span>&nbsp;<span class="op" id="6399576">=</span>&nbsp;<span class="ident" id="6399578">getString</span><span class="op" id="6399587">(</span><span class="ident" id="6399588">names</span><span class="op" id="6399593">,</span>&nbsp;<span class="builtintype" id="6399595">int</span><span class="op" id="6399598">(</span><span class="ident" id="6399599">dt</span><span class="op" id="6399601">.</span><span class="ident" id="6399602">Name</span><span class="op" id="6399606">-</span><span class="ident" id="6399607">ds</span><span class="op" id="6399609">.</span><span class="ident" id="6399610">VirtualAddress</span><span class="op" id="6399624">)</span><span class="op" id="6399625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399629">d</span><span class="op" id="6399630">,</span>&nbsp;<span class="ident" id="6399632">_</span>&nbsp;<span class="op" id="6399634">=</span>&nbsp;<span class="ident" id="6399636">ds</span><span class="op" id="6399638">.</span><span class="ident" id="6399639">Data</span><span class="op" id="6399643">(</span><span class="op" id="6399644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6399648">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399680">d</span>&nbsp;<span class="op" id="6399682">=</span>&nbsp;<span class="ident" id="6399684">d</span><span class="op" id="6399685">[</span><span class="ident" id="6399686">dt</span><span class="op" id="6399688">.</span><span class="ident" id="6399689">OriginalFirstThunk</span><span class="op" id="6399707">-</span><span class="ident" id="6399708">ds</span><span class="op" id="6399710">.</span><span class="ident" id="6399711">VirtualAddress</span><span class="op" id="6399725">:</span><span class="op" id="6399726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399730">for</span>&nbsp;<span class="builtinfunc" id="6399734">len</span><span class="op" id="6399737">(</span><span class="ident" id="6399738">d</span><span class="op" id="6399739">)</span>&nbsp;<span class="op" id="6399741">&gt;</span>&nbsp;<span class="num" id="6399743">0</span>&nbsp;<span class="op" id="6399745">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399750">if</span>&nbsp;<span class="ident" id="6399753">pe64</span>&nbsp;<span class="op" id="6399758">{</span>&nbsp;<span class="comment" id="6399760">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399773">va</span>&nbsp;<span class="op" id="6399776">:=</span>&nbsp;<span class="ident" id="6399779">binary</span><span class="op" id="6399785">.</span><span class="ident" id="6399786">LittleEndian</span><span class="op" id="6399798">.</span><span class="ident" id="6399799">Uint64</span><span class="op" id="6399805">(</span><span class="ident" id="6399806">d</span><span class="op" id="6399807">[</span><span class="num" id="6399808">0</span><span class="op" id="6399809">:</span><span class="num" id="6399810">8</span><span class="op" id="6399811">]</span><span class="op" id="6399812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399818">d</span>&nbsp;<span class="op" id="6399820">=</span>&nbsp;<span class="ident" id="6399822">d</span><span class="op" id="6399823">[</span><span class="num" id="6399824">8</span><span class="op" id="6399825">:</span><span class="op" id="6399826">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399832">if</span>&nbsp;<span class="ident" id="6399835">va</span>&nbsp;<span class="op" id="6399838">==</span>&nbsp;<span class="num" id="6399841">0</span>&nbsp;<span class="op" id="6399843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399850">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399866">if</span>&nbsp;<span class="ident" id="6399869">va</span><span class="op" id="6399871">&amp;</span><span class="num" id="6399872">0x8000000000000000</span>&nbsp;<span class="op" id="6399891">&gt;</span>&nbsp;<span class="num" id="6399893">0</span>&nbsp;<span class="op" id="6399895">{</span>&nbsp;<span class="comment" id="6399897">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6399916">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6399959">}</span>&nbsp;<span class="keyword" id="6399961">else</span>&nbsp;<span class="op" id="6399966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399973">fn</span><span class="op" id="6399975">,</span>&nbsp;<span class="ident" id="6399977">_</span>&nbsp;<span class="op" id="6399979">:=</span>&nbsp;<span class="ident" id="6399982">getString</span><span class="op" id="6399991">(</span><span class="ident" id="6399992">names</span><span class="op" id="6399997">,</span>&nbsp;<span class="builtintype" id="6399999">int</span><span class="op" id="6400002">(</span><span class="builtintype" id="6400003">uint32</span><span class="op" id="6400009">(</span><span class="ident" id="6400010">va</span><span class="op" id="6400012">)</span><span class="op" id="6400013">-</span><span class="ident" id="6400014">ds</span><span class="op" id="6400016">.</span><span class="ident" id="6400017">VirtualAddress</span><span class="op" id="6400031">+</span><span class="num" id="6400032">2</span><span class="op" id="6400033">)</span><span class="op" id="6400034">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400041">all</span>&nbsp;<span class="op" id="6400045">=</span>&nbsp;<span class="builtinfunc" id="6400047">append</span><span class="op" id="6400053">(</span><span class="ident" id="6400054">all</span><span class="op" id="6400057">,</span>&nbsp;<span class="ident" id="6400059">fn</span><span class="op" id="6400061">+</span><span class="string" id="6400062">&#34;:&#34;</span><span class="op" id="6400065">+</span><span class="ident" id="6400066">dt</span><span class="op" id="6400068">.</span><span class="ident" id="6400069">dll</span><span class="op" id="6400072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400083">}</span>&nbsp;<span class="keyword" id="6400085">else</span>&nbsp;<span class="op" id="6400090">{</span>&nbsp;<span class="comment" id="6400092">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400105">va</span>&nbsp;<span class="op" id="6400108">:=</span>&nbsp;<span class="ident" id="6400111">binary</span><span class="op" id="6400117">.</span><span class="ident" id="6400118">LittleEndian</span><span class="op" id="6400130">.</span><span class="ident" id="6400131">Uint32</span><span class="op" id="6400137">(</span><span class="ident" id="6400138">d</span><span class="op" id="6400139">[</span><span class="num" id="6400140">0</span><span class="op" id="6400141">:</span><span class="num" id="6400142">4</span><span class="op" id="6400143">]</span><span class="op" id="6400144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400150">d</span>&nbsp;<span class="op" id="6400152">=</span>&nbsp;<span class="ident" id="6400154">d</span><span class="op" id="6400155">[</span><span class="num" id="6400156">4</span><span class="op" id="6400157">:</span><span class="op" id="6400158">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400164">if</span>&nbsp;<span class="ident" id="6400167">va</span>&nbsp;<span class="op" id="6400170">==</span>&nbsp;<span class="num" id="6400173">0</span>&nbsp;<span class="op" id="6400175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400182">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400198">if</span>&nbsp;<span class="ident" id="6400201">va</span><span class="op" id="6400203">&amp;</span><span class="num" id="6400204">0x80000000</span>&nbsp;<span class="op" id="6400215">&gt;</span>&nbsp;<span class="num" id="6400217">0</span>&nbsp;<span class="op" id="6400219">{</span>&nbsp;<span class="comment" id="6400221">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6400240">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6400284">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400311">}</span>&nbsp;<span class="keyword" id="6400313">else</span>&nbsp;<span class="op" id="6400318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400325">fn</span><span class="op" id="6400327">,</span>&nbsp;<span class="ident" id="6400329">_</span>&nbsp;<span class="op" id="6400331">:=</span>&nbsp;<span class="ident" id="6400334">getString</span><span class="op" id="6400343">(</span><span class="ident" id="6400344">names</span><span class="op" id="6400349">,</span>&nbsp;<span class="builtintype" id="6400351">int</span><span class="op" id="6400354">(</span><span class="ident" id="6400355">va</span><span class="op" id="6400357">-</span><span class="ident" id="6400358">ds</span><span class="op" id="6400360">.</span><span class="ident" id="6400361">VirtualAddress</span><span class="op" id="6400375">+</span><span class="num" id="6400376">2</span><span class="op" id="6400377">)</span><span class="op" id="6400378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400385">all</span>&nbsp;<span class="op" id="6400389">=</span>&nbsp;<span class="builtinfunc" id="6400391">append</span><span class="op" id="6400397">(</span><span class="ident" id="6400398">all</span><span class="op" id="6400401">,</span>&nbsp;<span class="ident" id="6400403">fn</span><span class="op" id="6400405">+</span><span class="string" id="6400406">&#34;:&#34;</span><span class="op" id="6400409">+</span><span class="ident" id="6400410">dt</span><span class="op" id="6400412">.</span><span class="ident" id="6400413">dll</span><span class="op" id="6400416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400422">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400438">return</span>&nbsp;<span class="ident" id="6400445">all</span><span class="op" id="6400448">,</span>&nbsp;<span class="ident" id="6400450">nil</span><br>
<span class="lineno">385</span><span class="op" id="6400454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6400457">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6400513">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6400568">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="6400616">func</span>&nbsp;<span class="op" id="6400621">(</span><span class="ident" id="6400622">f</span>&nbsp;<span class="op" id="6400624">*</span><span class="ident" id="6400625">File</span><span class="op" id="6400629">)</span>&nbsp;<span class="ident" id="6400631">ImportedLibraries</span><span class="op" id="6400648">(</span><span class="op" id="6400649">)</span>&nbsp;<span class="op" id="6400651">(</span><span class="op" id="6400652">[</span><span class="op" id="6400653">]</span><span class="builtintype" id="6400654">string</span><span class="op" id="6400660">,</span>&nbsp;<span class="builtintype" id="6400662">error</span><span class="op" id="6400667">)</span>&nbsp;<span class="op" id="6400669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6400672">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6400681">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400747">return</span>&nbsp;<span class="ident" id="6400754">nil</span><span class="op" id="6400757">,</span>&nbsp;<span class="ident" id="6400759">nil</span><br>
<span class="lineno"></span><span class="op" id="6400763">}</span>
</div>
</body>
</html>
