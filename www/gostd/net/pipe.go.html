<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3373949">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3374005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3374059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3374110">package</span>&nbsp;<span class="ident" id="3374118">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374123">import</span>&nbsp;<span class="op" id="3374130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3374133">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3374143">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3374149">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3374156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3374159">//&nbsp;Pipe&nbsp;creates&nbsp;a&nbsp;synchronous,&nbsp;in-memory,&nbsp;full&nbsp;duplex</span><br>
<span class="lineno"></span><span class="comment" id="3374213">//&nbsp;network&nbsp;connection;&nbsp;both&nbsp;ends&nbsp;implement&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">15</span><span class="comment" id="3374276">//&nbsp;Reads&nbsp;on&nbsp;one&nbsp;end&nbsp;are&nbsp;matched&nbsp;with&nbsp;writes&nbsp;on&nbsp;the&nbsp;other,</span><br>
<span class="lineno"></span><span class="comment" id="3374334">//&nbsp;copying&nbsp;data&nbsp;directly&nbsp;between&nbsp;the&nbsp;two;&nbsp;there&nbsp;is&nbsp;no&nbsp;internal</span><br>
<span class="lineno"></span><span class="comment" id="3374397">//&nbsp;buffering.</span><br>
<span class="lineno"></span><span class="keyword" id="3374411">func</span>&nbsp;<span class="ident" id="3374416">Pipe</span><span class="op" id="3374420">(</span><span class="op" id="3374421">)</span>&nbsp;<span class="op" id="3374423">(</span><span class="ident" id="3374424">Conn</span><span class="op" id="3374428">,</span>&nbsp;<span class="ident" id="3374430">Conn</span><span class="op" id="3374434">)</span>&nbsp;<span class="op" id="3374436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374439">r1</span><span class="op" id="3374441">,</span>&nbsp;<span class="ident" id="3374443">w1</span>&nbsp;<span class="op" id="3374446">:=</span>&nbsp;<span class="ident" id="3374449">io</span><span class="op" id="3374451">.</span><span class="ident" id="3374452">Pipe</span><span class="op" id="3374456">(</span><span class="op" id="3374457">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374460">r2</span><span class="op" id="3374462">,</span>&nbsp;<span class="ident" id="3374464">w2</span>&nbsp;<span class="op" id="3374467">:=</span>&nbsp;<span class="ident" id="3374470">io</span><span class="op" id="3374472">.</span><span class="ident" id="3374473">Pipe</span><span class="op" id="3374477">(</span><span class="op" id="3374478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374482">return</span>&nbsp;<span class="op" id="3374489">&amp;</span><span class="ident" id="3374490">pipe</span><span class="op" id="3374494">{</span><span class="ident" id="3374495">r1</span><span class="op" id="3374497">,</span>&nbsp;<span class="ident" id="3374499">w2</span><span class="op" id="3374501">}</span><span class="op" id="3374502">,</span>&nbsp;<span class="op" id="3374504">&amp;</span><span class="ident" id="3374505">pipe</span><span class="op" id="3374509">{</span><span class="ident" id="3374510">r2</span><span class="op" id="3374512">,</span>&nbsp;<span class="ident" id="3374514">w1</span><span class="op" id="3374516">}</span><br>
<span class="lineno"></span><span class="op" id="3374518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3374521">type</span>&nbsp;<span class="ident" id="3374526">pipe</span>&nbsp;<span class="keyword" id="3374531">struct</span>&nbsp;<span class="op" id="3374538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374541">*</span><span class="ident" id="3374542">io</span><span class="op" id="3374544">.</span><span class="ident" id="3374545">PipeReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374557">*</span><span class="ident" id="3374558">io</span><span class="op" id="3374560">.</span><span class="ident" id="3374561">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3374572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3374575">type</span>&nbsp;<span class="ident" id="3374580">pipeAddr</span>&nbsp;<span class="builtintype" id="3374589">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374594">func</span>&nbsp;<span class="op" id="3374599">(</span><span class="ident" id="3374600">pipeAddr</span><span class="op" id="3374608">)</span>&nbsp;<span class="ident" id="3374610">Network</span><span class="op" id="3374617">(</span><span class="op" id="3374618">)</span>&nbsp;<span class="builtintype" id="3374620">string</span>&nbsp;<span class="op" id="3374627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374630">return</span>&nbsp;<span class="string" id="3374637">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3374644">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3374647">func</span>&nbsp;<span class="op" id="3374652">(</span><span class="ident" id="3374653">pipeAddr</span><span class="op" id="3374661">)</span>&nbsp;<span class="ident" id="3374663">String</span><span class="op" id="3374669">(</span><span class="op" id="3374670">)</span>&nbsp;<span class="builtintype" id="3374672">string</span>&nbsp;<span class="op" id="3374679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374682">return</span>&nbsp;<span class="string" id="3374689">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3374696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3374699">func</span>&nbsp;<span class="op" id="3374704">(</span><span class="ident" id="3374705">p</span>&nbsp;<span class="op" id="3374707">*</span><span class="ident" id="3374708">pipe</span><span class="op" id="3374712">)</span>&nbsp;<span class="ident" id="3374714">Close</span><span class="op" id="3374719">(</span><span class="op" id="3374720">)</span>&nbsp;<span class="builtintype" id="3374722">error</span>&nbsp;<span class="op" id="3374728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374731">err</span>&nbsp;<span class="op" id="3374735">:=</span>&nbsp;<span class="ident" id="3374738">p</span><span class="op" id="3374739">.</span><span class="ident" id="3374740">PipeReader</span><span class="op" id="3374750">.</span><span class="ident" id="3374751">Close</span><span class="op" id="3374756">(</span><span class="op" id="3374757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374760">err1</span>&nbsp;<span class="op" id="3374765">:=</span>&nbsp;<span class="ident" id="3374768">p</span><span class="op" id="3374769">.</span><span class="ident" id="3374770">PipeWriter</span><span class="op" id="3374780">.</span><span class="ident" id="3374781">Close</span><span class="op" id="3374786">(</span><span class="op" id="3374787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374790">if</span>&nbsp;<span class="ident" id="3374793">err</span>&nbsp;<span class="op" id="3374797">==</span>&nbsp;<span class="ident" id="3374800">nil</span>&nbsp;<span class="op" id="3374804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374808">err</span>&nbsp;<span class="op" id="3374812">=</span>&nbsp;<span class="ident" id="3374814">err1</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374823">return</span>&nbsp;<span class="ident" id="3374830">err</span><br>
<span class="lineno"></span><span class="op" id="3374834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374837">func</span>&nbsp;<span class="op" id="3374842">(</span><span class="ident" id="3374843">p</span>&nbsp;<span class="op" id="3374845">*</span><span class="ident" id="3374846">pipe</span><span class="op" id="3374850">)</span>&nbsp;<span class="ident" id="3374852">LocalAddr</span><span class="op" id="3374861">(</span><span class="op" id="3374862">)</span>&nbsp;<span class="ident" id="3374864">Addr</span>&nbsp;<span class="op" id="3374869">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374872">return</span>&nbsp;<span class="ident" id="3374879">pipeAddr</span><span class="op" id="3374887">(</span><span class="num" id="3374888">0</span><span class="op" id="3374889">)</span><br>
<span class="lineno"></span><span class="op" id="3374891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374894">func</span>&nbsp;<span class="op" id="3374899">(</span><span class="ident" id="3374900">p</span>&nbsp;<span class="op" id="3374902">*</span><span class="ident" id="3374903">pipe</span><span class="op" id="3374907">)</span>&nbsp;<span class="ident" id="3374909">RemoteAddr</span><span class="op" id="3374919">(</span><span class="op" id="3374920">)</span>&nbsp;<span class="ident" id="3374922">Addr</span>&nbsp;<span class="op" id="3374927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374930">return</span>&nbsp;<span class="ident" id="3374937">pipeAddr</span><span class="op" id="3374945">(</span><span class="num" id="3374946">0</span><span class="op" id="3374947">)</span><br>
<span class="lineno">55</span><span class="op" id="3374949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374952">func</span>&nbsp;<span class="op" id="3374957">(</span><span class="ident" id="3374958">p</span>&nbsp;<span class="op" id="3374960">*</span><span class="ident" id="3374961">pipe</span><span class="op" id="3374965">)</span>&nbsp;<span class="ident" id="3374967">SetDeadline</span><span class="op" id="3374978">(</span><span class="ident" id="3374979">t</span>&nbsp;<span class="ident" id="3374981">time</span><span class="op" id="3374985">.</span><span class="ident" id="3374986">Time</span><span class="op" id="3374990">)</span>&nbsp;<span class="builtintype" id="3374992">error</span>&nbsp;<span class="op" id="3374998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375001">return</span>&nbsp;<span class="ident" id="3375008">errors</span><span class="op" id="3375014">.</span><span class="ident" id="3375015">New</span><span class="op" id="3375018">(</span><span class="string" id="3375019">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3375056">)</span><br>
<span class="lineno"></span><span class="op" id="3375058">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3375061">func</span>&nbsp;<span class="op" id="3375066">(</span><span class="ident" id="3375067">p</span>&nbsp;<span class="op" id="3375069">*</span><span class="ident" id="3375070">pipe</span><span class="op" id="3375074">)</span>&nbsp;<span class="ident" id="3375076">SetReadDeadline</span><span class="op" id="3375091">(</span><span class="ident" id="3375092">t</span>&nbsp;<span class="ident" id="3375094">time</span><span class="op" id="3375098">.</span><span class="ident" id="3375099">Time</span><span class="op" id="3375103">)</span>&nbsp;<span class="builtintype" id="3375105">error</span>&nbsp;<span class="op" id="3375111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375114">return</span>&nbsp;<span class="ident" id="3375121">errors</span><span class="op" id="3375127">.</span><span class="ident" id="3375128">New</span><span class="op" id="3375131">(</span><span class="string" id="3375132">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3375169">)</span><br>
<span class="lineno"></span><span class="op" id="3375171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3375174">func</span>&nbsp;<span class="op" id="3375179">(</span><span class="ident" id="3375180">p</span>&nbsp;<span class="op" id="3375182">*</span><span class="ident" id="3375183">pipe</span><span class="op" id="3375187">)</span>&nbsp;<span class="ident" id="3375189">SetWriteDeadline</span><span class="op" id="3375205">(</span><span class="ident" id="3375206">t</span>&nbsp;<span class="ident" id="3375208">time</span><span class="op" id="3375212">.</span><span class="ident" id="3375213">Time</span><span class="op" id="3375217">)</span>&nbsp;<span class="builtintype" id="3375219">error</span>&nbsp;<span class="op" id="3375225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3375228">return</span>&nbsp;<span class="ident" id="3375235">errors</span><span class="op" id="3375241">.</span><span class="ident" id="3375242">New</span><span class="op" id="3375245">(</span><span class="string" id="3375246">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3375283">)</span><br>
<span class="lineno"></span><span class="op" id="3375285">}</span>
</div>
</body>
</html>
