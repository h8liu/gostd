<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4797890">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4797946">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4798000">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4798051">package</span>&nbsp;<span class="ident" id="4798059">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4798065">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="4798101">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="4798168">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="4798239">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="4798301">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="4798367">//</span><br>
<span class="lineno"></span><span class="comment" id="4798370">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="4798433">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4798476">import</span>&nbsp;<span class="string" id="4798483">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4798494">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="4798555">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="4798622">func</span>&nbsp;<span class="ident" id="4798627">checkValid</span><span class="op" id="4798637">(</span><span class="ident" id="4798638">data</span>&nbsp;<span class="op" id="4798643">[</span><span class="op" id="4798644">]</span><span class="builtintype" id="4798645">byte</span><span class="op" id="4798649">,</span>&nbsp;<span class="ident" id="4798651">scan</span>&nbsp;<span class="op" id="4798656">*</span><span class="ident" id="4798657">scanner</span><span class="op" id="4798664">)</span>&nbsp;<span class="builtintype" id="4798666">error</span>&nbsp;<span class="op" id="4798672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798675">scan</span><span class="op" id="4798679">.</span><span class="ident" id="4798680">reset</span><span class="op" id="4798685">(</span><span class="op" id="4798686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798689">for</span>&nbsp;<span class="ident" id="4798693">_</span><span class="op" id="4798694">,</span>&nbsp;<span class="ident" id="4798696">c</span>&nbsp;<span class="op" id="4798698">:=</span>&nbsp;<span class="keyword" id="4798701">range</span>&nbsp;<span class="ident" id="4798707">data</span>&nbsp;<span class="op" id="4798712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798716">scan</span><span class="op" id="4798720">.</span><span class="ident" id="4798721">bytes</span><span class="op" id="4798726">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798731">if</span>&nbsp;<span class="ident" id="4798734">scan</span><span class="op" id="4798738">.</span><span class="ident" id="4798739">step</span><span class="op" id="4798743">(</span><span class="ident" id="4798744">scan</span><span class="op" id="4798748">,</span>&nbsp;<span class="builtintype" id="4798750">int</span><span class="op" id="4798753">(</span><span class="ident" id="4798754">c</span><span class="op" id="4798755">)</span><span class="op" id="4798756">)</span>&nbsp;<span class="op" id="4798758">==</span>&nbsp;<span class="ident" id="4798761">scanError</span>&nbsp;<span class="op" id="4798771">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798776">return</span>&nbsp;<span class="ident" id="4798783">scan</span><span class="op" id="4798787">.</span><span class="ident" id="4798788">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798800">if</span>&nbsp;<span class="ident" id="4798803">scan</span><span class="op" id="4798807">.</span><span class="ident" id="4798808">eof</span><span class="op" id="4798811">(</span><span class="op" id="4798812">)</span>&nbsp;<span class="op" id="4798814">==</span>&nbsp;<span class="ident" id="4798817">scanError</span>&nbsp;<span class="op" id="4798827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798831">return</span>&nbsp;<span class="ident" id="4798838">scan</span><span class="op" id="4798842">.</span><span class="ident" id="4798843">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798851">return</span>&nbsp;<span class="ident" id="4798858">nil</span><br>
<span class="lineno"></span><span class="op" id="4798862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4798865">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="4798923">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="4798996">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="4799062">func</span>&nbsp;<span class="ident" id="4799067">nextValue</span><span class="op" id="4799076">(</span><span class="ident" id="4799077">data</span>&nbsp;<span class="op" id="4799082">[</span><span class="op" id="4799083">]</span><span class="builtintype" id="4799084">byte</span><span class="op" id="4799088">,</span>&nbsp;<span class="ident" id="4799090">scan</span>&nbsp;<span class="op" id="4799095">*</span><span class="ident" id="4799096">scanner</span><span class="op" id="4799103">)</span>&nbsp;<span class="op" id="4799105">(</span><span class="ident" id="4799106">value</span><span class="op" id="4799111">,</span>&nbsp;<span class="ident" id="4799113">rest</span>&nbsp;<span class="op" id="4799118">[</span><span class="op" id="4799119">]</span><span class="builtintype" id="4799120">byte</span><span class="op" id="4799124">,</span>&nbsp;<span class="ident" id="4799126">err</span>&nbsp;<span class="builtintype" id="4799130">error</span><span class="op" id="4799135">)</span>&nbsp;<span class="op" id="4799137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799140">scan</span><span class="op" id="4799144">.</span><span class="ident" id="4799145">reset</span><span class="op" id="4799150">(</span><span class="op" id="4799151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799154">for</span>&nbsp;<span class="ident" id="4799158">i</span><span class="op" id="4799159">,</span>&nbsp;<span class="ident" id="4799161">c</span>&nbsp;<span class="op" id="4799163">:=</span>&nbsp;<span class="keyword" id="4799166">range</span>&nbsp;<span class="ident" id="4799172">data</span>&nbsp;<span class="op" id="4799177">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799181">v</span>&nbsp;<span class="op" id="4799183">:=</span>&nbsp;<span class="ident" id="4799186">scan</span><span class="op" id="4799190">.</span><span class="ident" id="4799191">step</span><span class="op" id="4799195">(</span><span class="ident" id="4799196">scan</span><span class="op" id="4799200">,</span>&nbsp;<span class="builtintype" id="4799202">int</span><span class="op" id="4799205">(</span><span class="ident" id="4799206">c</span><span class="op" id="4799207">)</span><span class="op" id="4799208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799212">if</span>&nbsp;<span class="ident" id="4799215">v</span>&nbsp;<span class="op" id="4799217">&gt;=</span>&nbsp;<span class="ident" id="4799220">scanEnd</span>&nbsp;<span class="op" id="4799228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799233">switch</span>&nbsp;<span class="ident" id="4799240">v</span>&nbsp;<span class="op" id="4799242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799247">case</span>&nbsp;<span class="ident" id="4799252">scanError</span><span class="op" id="4799261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799267">return</span>&nbsp;<span class="ident" id="4799274">nil</span><span class="op" id="4799277">,</span>&nbsp;<span class="ident" id="4799279">nil</span><span class="op" id="4799282">,</span>&nbsp;<span class="ident" id="4799284">scan</span><span class="op" id="4799288">.</span><span class="ident" id="4799289">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799296">case</span>&nbsp;<span class="ident" id="4799301">scanEnd</span><span class="op" id="4799308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799314">return</span>&nbsp;<span class="ident" id="4799321">data</span><span class="op" id="4799325">[</span><span class="num" id="4799326">0</span><span class="op" id="4799327">:</span><span class="ident" id="4799328">i</span><span class="op" id="4799329">]</span><span class="op" id="4799330">,</span>&nbsp;<span class="ident" id="4799332">data</span><span class="op" id="4799336">[</span><span class="ident" id="4799337">i</span><span class="op" id="4799338">:</span><span class="op" id="4799339">]</span><span class="op" id="4799340">,</span>&nbsp;<span class="ident" id="4799342">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799356">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799359">if</span>&nbsp;<span class="ident" id="4799362">scan</span><span class="op" id="4799366">.</span><span class="ident" id="4799367">eof</span><span class="op" id="4799370">(</span><span class="op" id="4799371">)</span>&nbsp;<span class="op" id="4799373">==</span>&nbsp;<span class="ident" id="4799376">scanError</span>&nbsp;<span class="op" id="4799386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799390">return</span>&nbsp;<span class="ident" id="4799397">nil</span><span class="op" id="4799400">,</span>&nbsp;<span class="ident" id="4799402">nil</span><span class="op" id="4799405">,</span>&nbsp;<span class="ident" id="4799407">scan</span><span class="op" id="4799411">.</span><span class="ident" id="4799412">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799420">return</span>&nbsp;<span class="ident" id="4799427">data</span><span class="op" id="4799431">,</span>&nbsp;<span class="ident" id="4799433">nil</span><span class="op" id="4799436">,</span>&nbsp;<span class="ident" id="4799438">nil</span><br>
<span class="lineno"></span><span class="op" id="4799442">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4799445">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4799503">type</span>&nbsp;<span class="ident" id="4799508">SyntaxError</span>&nbsp;<span class="keyword" id="4799520">struct</span>&nbsp;<span class="op" id="4799527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799530">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4799537">string</span>&nbsp;<span class="comment" id="4799544">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799569">Offset</span>&nbsp;<span class="ident" id="4799576">int64</span>&nbsp;&nbsp;<span class="comment" id="4799583">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="4799628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4799631">func</span>&nbsp;<span class="op" id="4799636">(</span><span class="ident" id="4799637">e</span>&nbsp;<span class="op" id="4799639">*</span><span class="ident" id="4799640">SyntaxError</span><span class="op" id="4799651">)</span>&nbsp;<span class="ident" id="4799653">Error</span><span class="op" id="4799658">(</span><span class="op" id="4799659">)</span>&nbsp;<span class="builtintype" id="4799661">string</span>&nbsp;<span class="op" id="4799668">{</span>&nbsp;<span class="keyword" id="4799670">return</span>&nbsp;<span class="ident" id="4799677">e</span><span class="op" id="4799678">.</span><span class="ident" id="4799679">msg</span>&nbsp;<span class="op" id="4799683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4799686">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="4799733">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="4799799">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="4799848">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4799905">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="4799963">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="4800020">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="4800061">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="4800123">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4800180">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4800245">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="4800305">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="4800337">type</span>&nbsp;<span class="ident" id="4800342">scanner</span>&nbsp;<span class="keyword" id="4800350">struct</span>&nbsp;<span class="op" id="4800357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800360">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800428">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800487">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800549">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800599">step</span>&nbsp;<span class="keyword" id="4800604">func</span><span class="op" id="4800608">(</span><span class="op" id="4800609">*</span><span class="ident" id="4800610">scanner</span><span class="op" id="4800617">,</span>&nbsp;<span class="builtintype" id="4800619">int</span><span class="op" id="4800622">)</span>&nbsp;<span class="builtintype" id="4800624">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800630">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800666">endTop</span>&nbsp;<span class="builtintype" id="4800673">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800680">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800765">parseState</span>&nbsp;<span class="op" id="4800776">[</span><span class="op" id="4800777">]</span><span class="builtintype" id="4800778">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800784">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800817">err</span>&nbsp;<span class="builtintype" id="4800821">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800829">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800863">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4800873">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800879">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="4800889">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800894">redoState</span>&nbsp;<span class="keyword" id="4800904">func</span><span class="op" id="4800908">(</span><span class="op" id="4800909">*</span><span class="ident" id="4800910">scanner</span><span class="op" id="4800917">,</span>&nbsp;<span class="builtintype" id="4800919">int</span><span class="op" id="4800922">)</span>&nbsp;<span class="builtintype" id="4800924">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4800930">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800982">bytes</span>&nbsp;<span class="ident" id="4800988">int64</span><br>
<span class="lineno"></span><span class="op" id="4800994">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4800997">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="4801060">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="4801117">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4801179">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="4801225">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="4801284">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="4801341">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="4801393">const</span>&nbsp;<span class="op" id="4801399">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4801402">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801416">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801433">=</span>&nbsp;<span class="ident" id="4801435">iota</span>&nbsp;<span class="comment" id="4801440">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801463">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801487">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801534">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801558">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801575">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801599">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801637">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801661">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801701">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801725">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801778">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801802">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801818">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801842">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801872">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801896">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801947">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801971">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4802033">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802043">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4802053">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802131">scanError</span>&nbsp;<span class="comment" id="4802141">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="4802171">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4802174">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="4802226">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4802278">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4802336">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="4802404">const</span>&nbsp;<span class="op" id="4802410">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802413">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4802430">=</span>&nbsp;<span class="ident" id="4802432">iota</span>&nbsp;<span class="comment" id="4802437">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802475">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4802499">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802538">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4802562">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="4802585">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4802588">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="4802627">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="4802671">func</span>&nbsp;<span class="op" id="4802676">(</span><span class="ident" id="4802677">s</span>&nbsp;<span class="op" id="4802679">*</span><span class="ident" id="4802680">scanner</span><span class="op" id="4802687">)</span>&nbsp;<span class="ident" id="4802689">reset</span><span class="op" id="4802694">(</span><span class="op" id="4802695">)</span>&nbsp;<span class="op" id="4802697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802700">s</span><span class="op" id="4802701">.</span><span class="ident" id="4802702">step</span>&nbsp;<span class="op" id="4802707">=</span>&nbsp;<span class="ident" id="4802709">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802726">s</span><span class="op" id="4802727">.</span><span class="ident" id="4802728">parseState</span>&nbsp;<span class="op" id="4802739">=</span>&nbsp;<span class="ident" id="4802741">s</span><span class="op" id="4802742">.</span><span class="ident" id="4802743">parseState</span><span class="op" id="4802753">[</span><span class="num" id="4802754">0</span><span class="op" id="4802755">:</span><span class="num" id="4802756">0</span><span class="op" id="4802757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802760">s</span><span class="op" id="4802761">.</span><span class="ident" id="4802762">err</span>&nbsp;<span class="op" id="4802766">=</span>&nbsp;<span class="ident" id="4802768">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802773">s</span><span class="op" id="4802774">.</span><span class="ident" id="4802775">redo</span>&nbsp;<span class="op" id="4802780">=</span>&nbsp;<span class="builtintype" id="4802782">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802789">s</span><span class="op" id="4802790">.</span><span class="ident" id="4802791">endTop</span>&nbsp;<span class="op" id="4802798">=</span>&nbsp;<span class="builtintype" id="4802800">false</span><br>
<span class="lineno"></span><span class="op" id="4802806">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4802809">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="4802874">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="4802923">func</span>&nbsp;<span class="op" id="4802928">(</span><span class="ident" id="4802929">s</span>&nbsp;<span class="op" id="4802931">*</span><span class="ident" id="4802932">scanner</span><span class="op" id="4802939">)</span>&nbsp;<span class="ident" id="4802941">eof</span><span class="op" id="4802944">(</span><span class="op" id="4802945">)</span>&nbsp;<span class="builtintype" id="4802947">int</span>&nbsp;<span class="op" id="4802951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802954">if</span>&nbsp;<span class="ident" id="4802957">s</span><span class="op" id="4802958">.</span><span class="ident" id="4802959">err</span>&nbsp;<span class="op" id="4802963">!=</span>&nbsp;<span class="ident" id="4802966">nil</span>&nbsp;<span class="op" id="4802970">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802974">return</span>&nbsp;<span class="ident" id="4802981">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802995">if</span>&nbsp;<span class="ident" id="4802998">s</span><span class="op" id="4802999">.</span><span class="ident" id="4803000">endTop</span>&nbsp;<span class="op" id="4803007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803011">return</span>&nbsp;<span class="ident" id="4803018">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803027">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803030">s</span><span class="op" id="4803031">.</span><span class="ident" id="4803032">step</span><span class="op" id="4803036">(</span><span class="ident" id="4803037">s</span><span class="op" id="4803038">,</span>&nbsp;<span class="string" id="4803040">&#39;&nbsp;&#39;</span><span class="op" id="4803043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803046">if</span>&nbsp;<span class="ident" id="4803049">s</span><span class="op" id="4803050">.</span><span class="ident" id="4803051">endTop</span>&nbsp;<span class="op" id="4803058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803062">return</span>&nbsp;<span class="ident" id="4803069">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803081">if</span>&nbsp;<span class="ident" id="4803084">s</span><span class="op" id="4803085">.</span><span class="ident" id="4803086">err</span>&nbsp;<span class="op" id="4803090">==</span>&nbsp;<span class="ident" id="4803093">nil</span>&nbsp;<span class="op" id="4803097">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803101">s</span><span class="op" id="4803102">.</span><span class="ident" id="4803103">err</span>&nbsp;<span class="op" id="4803107">=</span>&nbsp;<span class="op" id="4803109">&amp;</span><span class="ident" id="4803110">SyntaxError</span><span class="op" id="4803121">{</span><span class="string" id="4803122">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="4803152">,</span>&nbsp;<span class="ident" id="4803154">s</span><span class="op" id="4803155">.</span><span class="ident" id="4803156">bytes</span><span class="op" id="4803161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803167">return</span>&nbsp;<span class="ident" id="4803174">scanError</span><br>
<span class="lineno"></span><span class="op" id="4803184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4803187">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4803254">func</span>&nbsp;<span class="op" id="4803259">(</span><span class="ident" id="4803260">s</span>&nbsp;<span class="op" id="4803262">*</span><span class="ident" id="4803263">scanner</span><span class="op" id="4803270">)</span>&nbsp;<span class="ident" id="4803272">pushParseState</span><span class="op" id="4803286">(</span><span class="ident" id="4803287">p</span>&nbsp;<span class="builtintype" id="4803289">int</span><span class="op" id="4803292">)</span>&nbsp;<span class="op" id="4803294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803297">s</span><span class="op" id="4803298">.</span><span class="ident" id="4803299">parseState</span>&nbsp;<span class="op" id="4803310">=</span>&nbsp;<span class="builtinfunc" id="4803312">append</span><span class="op" id="4803318">(</span><span class="ident" id="4803319">s</span><span class="op" id="4803320">.</span><span class="ident" id="4803321">parseState</span><span class="op" id="4803331">,</span>&nbsp;<span class="ident" id="4803333">p</span><span class="op" id="4803334">)</span><br>
<span class="lineno"></span><span class="op" id="4803336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="4803339">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4803408">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="4803443">func</span>&nbsp;<span class="op" id="4803448">(</span><span class="ident" id="4803449">s</span>&nbsp;<span class="op" id="4803451">*</span><span class="ident" id="4803452">scanner</span><span class="op" id="4803459">)</span>&nbsp;<span class="ident" id="4803461">popParseState</span><span class="op" id="4803474">(</span><span class="op" id="4803475">)</span>&nbsp;<span class="op" id="4803477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803480">n</span>&nbsp;<span class="op" id="4803482">:=</span>&nbsp;<span class="builtinfunc" id="4803485">len</span><span class="op" id="4803488">(</span><span class="ident" id="4803489">s</span><span class="op" id="4803490">.</span><span class="ident" id="4803491">parseState</span><span class="op" id="4803501">)</span>&nbsp;<span class="op" id="4803503">-</span>&nbsp;<span class="num" id="4803505">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803508">s</span><span class="op" id="4803509">.</span><span class="ident" id="4803510">parseState</span>&nbsp;<span class="op" id="4803521">=</span>&nbsp;<span class="ident" id="4803523">s</span><span class="op" id="4803524">.</span><span class="ident" id="4803525">parseState</span><span class="op" id="4803535">[</span><span class="num" id="4803536">0</span><span class="op" id="4803537">:</span><span class="ident" id="4803538">n</span><span class="op" id="4803539">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803542">s</span><span class="op" id="4803543">.</span><span class="ident" id="4803544">redo</span>&nbsp;<span class="op" id="4803549">=</span>&nbsp;<span class="builtintype" id="4803551">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803558">if</span>&nbsp;<span class="ident" id="4803561">n</span>&nbsp;<span class="op" id="4803563">==</span>&nbsp;<span class="num" id="4803566">0</span>&nbsp;<span class="op" id="4803568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803572">s</span><span class="op" id="4803573">.</span><span class="ident" id="4803574">step</span>&nbsp;<span class="op" id="4803579">=</span>&nbsp;<span class="ident" id="4803581">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803595">s</span><span class="op" id="4803596">.</span><span class="ident" id="4803597">endTop</span>&nbsp;<span class="op" id="4803604">=</span>&nbsp;<span class="builtintype" id="4803606">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803612">}</span>&nbsp;<span class="keyword" id="4803614">else</span>&nbsp;<span class="op" id="4803619">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803623">s</span><span class="op" id="4803624">.</span><span class="ident" id="4803625">step</span>&nbsp;<span class="op" id="4803630">=</span>&nbsp;<span class="ident" id="4803632">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803647">}</span><br>
<span class="lineno"></span><span class="op" id="4803649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803652">func</span>&nbsp;<span class="ident" id="4803657">isSpace</span><span class="op" id="4803664">(</span><span class="ident" id="4803665">c</span>&nbsp;<span class="builtintype" id="4803667">rune</span><span class="op" id="4803671">)</span>&nbsp;<span class="builtintype" id="4803673">bool</span>&nbsp;<span class="op" id="4803678">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803681">return</span>&nbsp;<span class="ident" id="4803688">c</span>&nbsp;<span class="op" id="4803690">==</span>&nbsp;<span class="string" id="4803693">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4803697">||</span>&nbsp;<span class="ident" id="4803700">c</span>&nbsp;<span class="op" id="4803702">==</span>&nbsp;<span class="string" id="4803705">&#39;\t&#39;</span>&nbsp;<span class="op" id="4803710">||</span>&nbsp;<span class="ident" id="4803713">c</span>&nbsp;<span class="op" id="4803715">==</span>&nbsp;<span class="string" id="4803718">&#39;\r&#39;</span>&nbsp;<span class="op" id="4803723">||</span>&nbsp;<span class="ident" id="4803726">c</span>&nbsp;<span class="op" id="4803728">==</span>&nbsp;<span class="string" id="4803731">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="4803736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803739">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="4803797">func</span>&nbsp;<span class="ident" id="4803802">stateBeginValueOrEmpty</span><span class="op" id="4803824">(</span><span class="ident" id="4803825">s</span>&nbsp;<span class="op" id="4803827">*</span><span class="ident" id="4803828">scanner</span><span class="op" id="4803835">,</span>&nbsp;<span class="ident" id="4803837">c</span>&nbsp;<span class="builtintype" id="4803839">int</span><span class="op" id="4803842">)</span>&nbsp;<span class="builtintype" id="4803844">int</span>&nbsp;<span class="op" id="4803848">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803851">if</span>&nbsp;<span class="ident" id="4803854">c</span>&nbsp;<span class="op" id="4803856">&lt;=</span>&nbsp;<span class="string" id="4803859">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4803863">&amp;&amp;</span>&nbsp;<span class="ident" id="4803866">isSpace</span><span class="op" id="4803873">(</span><span class="builtintype" id="4803874">rune</span><span class="op" id="4803878">(</span><span class="ident" id="4803879">c</span><span class="op" id="4803880">)</span><span class="op" id="4803881">)</span>&nbsp;<span class="op" id="4803883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803887">return</span>&nbsp;<span class="ident" id="4803894">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803912">if</span>&nbsp;<span class="ident" id="4803915">c</span>&nbsp;<span class="op" id="4803917">==</span>&nbsp;<span class="string" id="4803920">&#39;]&#39;</span>&nbsp;<span class="op" id="4803924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803928">return</span>&nbsp;<span class="ident" id="4803935">stateEndValue</span><span class="op" id="4803948">(</span><span class="ident" id="4803949">s</span><span class="op" id="4803950">,</span>&nbsp;<span class="ident" id="4803952">c</span><span class="op" id="4803953">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803959">return</span>&nbsp;<span class="ident" id="4803966">stateBeginValue</span><span class="op" id="4803981">(</span><span class="ident" id="4803982">s</span><span class="op" id="4803983">,</span>&nbsp;<span class="ident" id="4803985">c</span><span class="op" id="4803986">)</span><br>
<span class="lineno"></span><span class="op" id="4803988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803991">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="4804054">func</span>&nbsp;<span class="ident" id="4804059">stateBeginValue</span><span class="op" id="4804074">(</span><span class="ident" id="4804075">s</span>&nbsp;<span class="op" id="4804077">*</span><span class="ident" id="4804078">scanner</span><span class="op" id="4804085">,</span>&nbsp;<span class="ident" id="4804087">c</span>&nbsp;<span class="builtintype" id="4804089">int</span><span class="op" id="4804092">)</span>&nbsp;<span class="builtintype" id="4804094">int</span>&nbsp;<span class="op" id="4804098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804101">if</span>&nbsp;<span class="ident" id="4804104">c</span>&nbsp;<span class="op" id="4804106">&lt;=</span>&nbsp;<span class="string" id="4804109">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4804113">&amp;&amp;</span>&nbsp;<span class="ident" id="4804116">isSpace</span><span class="op" id="4804123">(</span><span class="builtintype" id="4804124">rune</span><span class="op" id="4804128">(</span><span class="ident" id="4804129">c</span><span class="op" id="4804130">)</span><span class="op" id="4804131">)</span>&nbsp;<span class="op" id="4804133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804137">return</span>&nbsp;<span class="ident" id="4804144">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804162">switch</span>&nbsp;<span class="ident" id="4804169">c</span>&nbsp;<span class="op" id="4804171">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804174">case</span>&nbsp;<span class="string" id="4804179">&#39;{&#39;</span><span class="op" id="4804182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804186">s</span><span class="op" id="4804187">.</span><span class="ident" id="4804188">step</span>&nbsp;<span class="op" id="4804193">=</span>&nbsp;<span class="ident" id="4804195">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804221">s</span><span class="op" id="4804222">.</span><span class="ident" id="4804223">pushParseState</span><span class="op" id="4804237">(</span><span class="ident" id="4804238">parseObjectKey</span><span class="op" id="4804252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804256">return</span>&nbsp;<span class="ident" id="4804263">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804280">case</span>&nbsp;<span class="string" id="4804285">&#39;[&#39;</span><span class="op" id="4804288">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804292">s</span><span class="op" id="4804293">.</span><span class="ident" id="4804294">step</span>&nbsp;<span class="op" id="4804299">=</span>&nbsp;<span class="ident" id="4804301">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804326">s</span><span class="op" id="4804327">.</span><span class="ident" id="4804328">pushParseState</span><span class="op" id="4804342">(</span><span class="ident" id="4804343">parseArrayValue</span><span class="op" id="4804358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804362">return</span>&nbsp;<span class="ident" id="4804369">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804385">case</span>&nbsp;<span class="string" id="4804390">&#39;&#34;&#39;</span><span class="op" id="4804393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804397">s</span><span class="op" id="4804398">.</span><span class="ident" id="4804399">step</span>&nbsp;<span class="op" id="4804404">=</span>&nbsp;<span class="ident" id="4804406">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804422">return</span>&nbsp;<span class="ident" id="4804429">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804447">case</span>&nbsp;<span class="string" id="4804452">&#39;-&#39;</span><span class="op" id="4804455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804459">s</span><span class="op" id="4804460">.</span><span class="ident" id="4804461">step</span>&nbsp;<span class="op" id="4804466">=</span>&nbsp;<span class="ident" id="4804468">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804479">return</span>&nbsp;<span class="ident" id="4804486">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804504">case</span>&nbsp;<span class="string" id="4804509">&#39;0&#39;</span><span class="op" id="4804512">:</span>&nbsp;<span class="comment" id="4804514">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804538">s</span><span class="op" id="4804539">.</span><span class="ident" id="4804540">step</span>&nbsp;<span class="op" id="4804545">=</span>&nbsp;<span class="ident" id="4804547">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804556">return</span>&nbsp;<span class="ident" id="4804563">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804581">case</span>&nbsp;<span class="string" id="4804586">&#39;t&#39;</span><span class="op" id="4804589">:</span>&nbsp;<span class="comment" id="4804591">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804614">s</span><span class="op" id="4804615">.</span><span class="ident" id="4804616">step</span>&nbsp;<span class="op" id="4804621">=</span>&nbsp;<span class="ident" id="4804623">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804632">return</span>&nbsp;<span class="ident" id="4804639">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804657">case</span>&nbsp;<span class="string" id="4804662">&#39;f&#39;</span><span class="op" id="4804665">:</span>&nbsp;<span class="comment" id="4804667">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804691">s</span><span class="op" id="4804692">.</span><span class="ident" id="4804693">step</span>&nbsp;<span class="op" id="4804698">=</span>&nbsp;<span class="ident" id="4804700">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804709">return</span>&nbsp;<span class="ident" id="4804716">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804734">case</span>&nbsp;<span class="string" id="4804739">&#39;n&#39;</span><span class="op" id="4804742">:</span>&nbsp;<span class="comment" id="4804744">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804767">s</span><span class="op" id="4804768">.</span><span class="ident" id="4804769">step</span>&nbsp;<span class="op" id="4804774">=</span>&nbsp;<span class="ident" id="4804776">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804785">return</span>&nbsp;<span class="ident" id="4804792">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804813">if</span>&nbsp;<span class="string" id="4804816">&#39;1&#39;</span>&nbsp;<span class="op" id="4804820">&lt;=</span>&nbsp;<span class="ident" id="4804823">c</span>&nbsp;<span class="op" id="4804825">&amp;&amp;</span>&nbsp;<span class="ident" id="4804828">c</span>&nbsp;<span class="op" id="4804830">&lt;=</span>&nbsp;<span class="string" id="4804833">&#39;9&#39;</span>&nbsp;<span class="op" id="4804837">{</span>&nbsp;<span class="comment" id="4804839">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804864">s</span><span class="op" id="4804865">.</span><span class="ident" id="4804866">step</span>&nbsp;<span class="op" id="4804871">=</span>&nbsp;<span class="ident" id="4804873">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804882">return</span>&nbsp;<span class="ident" id="4804889">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804910">return</span>&nbsp;<span class="ident" id="4804917">s</span><span class="op" id="4804918">.</span><span class="builtintype" id="4804919">error</span><span class="op" id="4804924">(</span><span class="ident" id="4804925">c</span><span class="op" id="4804926">,</span>&nbsp;<span class="string" id="4804928">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="4804960">)</span><br>
<span class="lineno"></span><span class="op" id="4804962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4804965">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="4805024">func</span>&nbsp;<span class="ident" id="4805029">stateBeginStringOrEmpty</span><span class="op" id="4805052">(</span><span class="ident" id="4805053">s</span>&nbsp;<span class="op" id="4805055">*</span><span class="ident" id="4805056">scanner</span><span class="op" id="4805063">,</span>&nbsp;<span class="ident" id="4805065">c</span>&nbsp;<span class="builtintype" id="4805067">int</span><span class="op" id="4805070">)</span>&nbsp;<span class="builtintype" id="4805072">int</span>&nbsp;<span class="op" id="4805076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805079">if</span>&nbsp;<span class="ident" id="4805082">c</span>&nbsp;<span class="op" id="4805084">&lt;=</span>&nbsp;<span class="string" id="4805087">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4805091">&amp;&amp;</span>&nbsp;<span class="ident" id="4805094">isSpace</span><span class="op" id="4805101">(</span><span class="builtintype" id="4805102">rune</span><span class="op" id="4805106">(</span><span class="ident" id="4805107">c</span><span class="op" id="4805108">)</span><span class="op" id="4805109">)</span>&nbsp;<span class="op" id="4805111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805115">return</span>&nbsp;<span class="ident" id="4805122">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805140">if</span>&nbsp;<span class="ident" id="4805143">c</span>&nbsp;<span class="op" id="4805145">==</span>&nbsp;<span class="string" id="4805148">&#39;}&#39;</span>&nbsp;<span class="op" id="4805152">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805156">n</span>&nbsp;<span class="op" id="4805158">:=</span>&nbsp;<span class="builtinfunc" id="4805161">len</span><span class="op" id="4805164">(</span><span class="ident" id="4805165">s</span><span class="op" id="4805166">.</span><span class="ident" id="4805167">parseState</span><span class="op" id="4805177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805181">s</span><span class="op" id="4805182">.</span><span class="ident" id="4805183">parseState</span><span class="op" id="4805193">[</span><span class="ident" id="4805194">n</span><span class="op" id="4805195">-</span><span class="num" id="4805196">1</span><span class="op" id="4805197">]</span>&nbsp;<span class="op" id="4805199">=</span>&nbsp;<span class="ident" id="4805201">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805220">return</span>&nbsp;<span class="ident" id="4805227">stateEndValue</span><span class="op" id="4805240">(</span><span class="ident" id="4805241">s</span><span class="op" id="4805242">,</span>&nbsp;<span class="ident" id="4805244">c</span><span class="op" id="4805245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805251">return</span>&nbsp;<span class="ident" id="4805258">stateBeginString</span><span class="op" id="4805274">(</span><span class="ident" id="4805275">s</span><span class="op" id="4805276">,</span>&nbsp;<span class="ident" id="4805278">c</span><span class="op" id="4805279">)</span><br>
<span class="lineno">250</span><span class="op" id="4805281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805284">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="4805349">func</span>&nbsp;<span class="ident" id="4805354">stateBeginString</span><span class="op" id="4805370">(</span><span class="ident" id="4805371">s</span>&nbsp;<span class="op" id="4805373">*</span><span class="ident" id="4805374">scanner</span><span class="op" id="4805381">,</span>&nbsp;<span class="ident" id="4805383">c</span>&nbsp;<span class="builtintype" id="4805385">int</span><span class="op" id="4805388">)</span>&nbsp;<span class="builtintype" id="4805390">int</span>&nbsp;<span class="op" id="4805394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805397">if</span>&nbsp;<span class="ident" id="4805400">c</span>&nbsp;<span class="op" id="4805402">&lt;=</span>&nbsp;<span class="string" id="4805405">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4805409">&amp;&amp;</span>&nbsp;<span class="ident" id="4805412">isSpace</span><span class="op" id="4805419">(</span><span class="builtintype" id="4805420">rune</span><span class="op" id="4805424">(</span><span class="ident" id="4805425">c</span><span class="op" id="4805426">)</span><span class="op" id="4805427">)</span>&nbsp;<span class="op" id="4805429">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805433">return</span>&nbsp;<span class="ident" id="4805440">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805458">if</span>&nbsp;<span class="ident" id="4805461">c</span>&nbsp;<span class="op" id="4805463">==</span>&nbsp;<span class="string" id="4805466">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4805470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805474">s</span><span class="op" id="4805475">.</span><span class="ident" id="4805476">step</span>&nbsp;<span class="op" id="4805481">=</span>&nbsp;<span class="ident" id="4805483">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805499">return</span>&nbsp;<span class="ident" id="4805506">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805527">return</span>&nbsp;<span class="ident" id="4805534">s</span><span class="op" id="4805535">.</span><span class="builtintype" id="4805536">error</span><span class="op" id="4805541">(</span><span class="ident" id="4805542">c</span><span class="op" id="4805543">,</span>&nbsp;<span class="string" id="4805545">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="4805589">)</span><br>
<span class="lineno"></span><span class="op" id="4805591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805594">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="4805650">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4805701">func</span>&nbsp;<span class="ident" id="4805706">stateEndValue</span><span class="op" id="4805719">(</span><span class="ident" id="4805720">s</span>&nbsp;<span class="op" id="4805722">*</span><span class="ident" id="4805723">scanner</span><span class="op" id="4805730">,</span>&nbsp;<span class="ident" id="4805732">c</span>&nbsp;<span class="builtintype" id="4805734">int</span><span class="op" id="4805737">)</span>&nbsp;<span class="builtintype" id="4805739">int</span>&nbsp;<span class="op" id="4805743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805746">n</span>&nbsp;<span class="op" id="4805748">:=</span>&nbsp;<span class="builtinfunc" id="4805751">len</span><span class="op" id="4805754">(</span><span class="ident" id="4805755">s</span><span class="op" id="4805756">.</span><span class="ident" id="4805757">parseState</span><span class="op" id="4805767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805770">if</span>&nbsp;<span class="ident" id="4805773">n</span>&nbsp;<span class="op" id="4805775">==</span>&nbsp;<span class="num" id="4805778">0</span>&nbsp;<span class="op" id="4805780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4805784">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805834">s</span><span class="op" id="4805835">.</span><span class="ident" id="4805836">step</span>&nbsp;<span class="op" id="4805841">=</span>&nbsp;<span class="ident" id="4805843">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805857">s</span><span class="op" id="4805858">.</span><span class="ident" id="4805859">endTop</span>&nbsp;<span class="op" id="4805866">=</span>&nbsp;<span class="builtintype" id="4805868">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805875">return</span>&nbsp;<span class="ident" id="4805882">stateEndTop</span><span class="op" id="4805893">(</span><span class="ident" id="4805894">s</span><span class="op" id="4805895">,</span>&nbsp;<span class="ident" id="4805897">c</span><span class="op" id="4805898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805904">if</span>&nbsp;<span class="ident" id="4805907">c</span>&nbsp;<span class="op" id="4805909">&lt;=</span>&nbsp;<span class="string" id="4805912">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4805916">&amp;&amp;</span>&nbsp;<span class="ident" id="4805919">isSpace</span><span class="op" id="4805926">(</span><span class="builtintype" id="4805927">rune</span><span class="op" id="4805931">(</span><span class="ident" id="4805932">c</span><span class="op" id="4805933">)</span><span class="op" id="4805934">)</span>&nbsp;<span class="op" id="4805936">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805940">s</span><span class="op" id="4805941">.</span><span class="ident" id="4805942">step</span>&nbsp;<span class="op" id="4805947">=</span>&nbsp;<span class="ident" id="4805949">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805965">return</span>&nbsp;<span class="ident" id="4805972">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805990">ps</span>&nbsp;<span class="op" id="4805993">:=</span>&nbsp;<span class="ident" id="4805996">s</span><span class="op" id="4805997">.</span><span class="ident" id="4805998">parseState</span><span class="op" id="4806008">[</span><span class="ident" id="4806009">n</span><span class="op" id="4806010">-</span><span class="num" id="4806011">1</span><span class="op" id="4806012">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806015">switch</span>&nbsp;<span class="ident" id="4806022">ps</span>&nbsp;<span class="op" id="4806025">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806028">case</span>&nbsp;<span class="ident" id="4806033">parseObjectKey</span><span class="op" id="4806047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806051">if</span>&nbsp;<span class="ident" id="4806054">c</span>&nbsp;<span class="op" id="4806056">==</span>&nbsp;<span class="string" id="4806059">&#39;:&#39;</span>&nbsp;<span class="op" id="4806063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806068">s</span><span class="op" id="4806069">.</span><span class="ident" id="4806070">parseState</span><span class="op" id="4806080">[</span><span class="ident" id="4806081">n</span><span class="op" id="4806082">-</span><span class="num" id="4806083">1</span><span class="op" id="4806084">]</span>&nbsp;<span class="op" id="4806086">=</span>&nbsp;<span class="ident" id="4806088">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806108">s</span><span class="op" id="4806109">.</span><span class="ident" id="4806110">step</span>&nbsp;<span class="op" id="4806115">=</span>&nbsp;<span class="ident" id="4806117">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806136">return</span>&nbsp;<span class="ident" id="4806143">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806163">return</span>&nbsp;<span class="ident" id="4806170">s</span><span class="op" id="4806171">.</span><span class="builtintype" id="4806172">error</span><span class="op" id="4806177">(</span><span class="ident" id="4806178">c</span><span class="op" id="4806179">,</span>&nbsp;<span class="string" id="4806181">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="4806199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806202">case</span>&nbsp;<span class="ident" id="4806207">parseObjectValue</span><span class="op" id="4806223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806227">if</span>&nbsp;<span class="ident" id="4806230">c</span>&nbsp;<span class="op" id="4806232">==</span>&nbsp;<span class="string" id="4806235">&#39;,&#39;</span>&nbsp;<span class="op" id="4806239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806244">s</span><span class="op" id="4806245">.</span><span class="ident" id="4806246">parseState</span><span class="op" id="4806256">[</span><span class="ident" id="4806257">n</span><span class="op" id="4806258">-</span><span class="num" id="4806259">1</span><span class="op" id="4806260">]</span>&nbsp;<span class="op" id="4806262">=</span>&nbsp;<span class="ident" id="4806264">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806282">s</span><span class="op" id="4806283">.</span><span class="ident" id="4806284">step</span>&nbsp;<span class="op" id="4806289">=</span>&nbsp;<span class="ident" id="4806291">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806311">return</span>&nbsp;<span class="ident" id="4806318">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806340">if</span>&nbsp;<span class="ident" id="4806343">c</span>&nbsp;<span class="op" id="4806345">==</span>&nbsp;<span class="string" id="4806348">&#39;}&#39;</span>&nbsp;<span class="op" id="4806352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806357">s</span><span class="op" id="4806358">.</span><span class="ident" id="4806359">popParseState</span><span class="op" id="4806372">(</span><span class="op" id="4806373">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806378">return</span>&nbsp;<span class="ident" id="4806385">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806405">return</span>&nbsp;<span class="ident" id="4806412">s</span><span class="op" id="4806413">.</span><span class="builtintype" id="4806414">error</span><span class="op" id="4806419">(</span><span class="ident" id="4806420">c</span><span class="op" id="4806421">,</span>&nbsp;<span class="string" id="4806423">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="4806452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806455">case</span>&nbsp;<span class="ident" id="4806460">parseArrayValue</span><span class="op" id="4806475">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806479">if</span>&nbsp;<span class="ident" id="4806482">c</span>&nbsp;<span class="op" id="4806484">==</span>&nbsp;<span class="string" id="4806487">&#39;,&#39;</span>&nbsp;<span class="op" id="4806491">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806496">s</span><span class="op" id="4806497">.</span><span class="ident" id="4806498">step</span>&nbsp;<span class="op" id="4806503">=</span>&nbsp;<span class="ident" id="4806505">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806524">return</span>&nbsp;<span class="ident" id="4806531">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806552">if</span>&nbsp;<span class="ident" id="4806555">c</span>&nbsp;<span class="op" id="4806557">==</span>&nbsp;<span class="string" id="4806560">&#39;]&#39;</span>&nbsp;<span class="op" id="4806564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806569">s</span><span class="op" id="4806570">.</span><span class="ident" id="4806571">popParseState</span><span class="op" id="4806584">(</span><span class="op" id="4806585">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806590">return</span>&nbsp;<span class="ident" id="4806597">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806616">return</span>&nbsp;<span class="ident" id="4806623">s</span><span class="op" id="4806624">.</span><span class="builtintype" id="4806625">error</span><span class="op" id="4806630">(</span><span class="ident" id="4806631">c</span><span class="op" id="4806632">,</span>&nbsp;<span class="string" id="4806634">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="4806655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806661">return</span>&nbsp;<span class="ident" id="4806668">s</span><span class="op" id="4806669">.</span><span class="builtintype" id="4806670">error</span><span class="op" id="4806675">(</span><span class="ident" id="4806676">c</span><span class="op" id="4806677">,</span>&nbsp;<span class="string" id="4806679">&#34;&#34;</span><span class="op" id="4806681">)</span><br>
<span class="lineno">310</span><span class="op" id="4806683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4806686">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4806751">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="4806795">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="4806840">func</span>&nbsp;<span class="ident" id="4806845">stateEndTop</span><span class="op" id="4806856">(</span><span class="ident" id="4806857">s</span>&nbsp;<span class="op" id="4806859">*</span><span class="ident" id="4806860">scanner</span><span class="op" id="4806867">,</span>&nbsp;<span class="ident" id="4806869">c</span>&nbsp;<span class="builtintype" id="4806871">int</span><span class="op" id="4806874">)</span>&nbsp;<span class="builtintype" id="4806876">int</span>&nbsp;<span class="op" id="4806880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806883">if</span>&nbsp;<span class="ident" id="4806886">c</span>&nbsp;<span class="op" id="4806888">!=</span>&nbsp;<span class="string" id="4806891">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4806895">&amp;&amp;</span>&nbsp;<span class="ident" id="4806898">c</span>&nbsp;<span class="op" id="4806900">!=</span>&nbsp;<span class="string" id="4806903">&#39;\t&#39;</span>&nbsp;<span class="op" id="4806908">&amp;&amp;</span>&nbsp;<span class="ident" id="4806911">c</span>&nbsp;<span class="op" id="4806913">!=</span>&nbsp;<span class="string" id="4806916">&#39;\r&#39;</span>&nbsp;<span class="op" id="4806921">&amp;&amp;</span>&nbsp;<span class="ident" id="4806924">c</span>&nbsp;<span class="op" id="4806926">!=</span>&nbsp;<span class="string" id="4806929">&#39;\n&#39;</span>&nbsp;<span class="op" id="4806934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806938">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806987">s</span><span class="op" id="4806988">.</span><span class="builtintype" id="4806989">error</span><span class="op" id="4806994">(</span><span class="ident" id="4806995">c</span><span class="op" id="4806996">,</span>&nbsp;<span class="string" id="4806998">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="4807021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807024">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807027">return</span>&nbsp;<span class="ident" id="4807034">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="4807042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4807045">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4807094">func</span>&nbsp;<span class="ident" id="4807099">stateInString</span><span class="op" id="4807112">(</span><span class="ident" id="4807113">s</span>&nbsp;<span class="op" id="4807115">*</span><span class="ident" id="4807116">scanner</span><span class="op" id="4807123">,</span>&nbsp;<span class="ident" id="4807125">c</span>&nbsp;<span class="builtintype" id="4807127">int</span><span class="op" id="4807130">)</span>&nbsp;<span class="builtintype" id="4807132">int</span>&nbsp;<span class="op" id="4807136">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807139">if</span>&nbsp;<span class="ident" id="4807142">c</span>&nbsp;<span class="op" id="4807144">==</span>&nbsp;<span class="string" id="4807147">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4807151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4807155">s</span><span class="op" id="4807156">.</span><span class="ident" id="4807157">step</span>&nbsp;<span class="op" id="4807162">=</span>&nbsp;<span class="ident" id="4807164">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807180">return</span>&nbsp;<span class="ident" id="4807187">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807204">if</span>&nbsp;<span class="ident" id="4807207">c</span>&nbsp;<span class="op" id="4807209">==</span>&nbsp;<span class="string" id="4807212">&#39;\\&#39;</span>&nbsp;<span class="op" id="4807217">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4807221">s</span><span class="op" id="4807222">.</span><span class="ident" id="4807223">step</span>&nbsp;<span class="op" id="4807228">=</span>&nbsp;<span class="ident" id="4807230">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807249">return</span>&nbsp;<span class="ident" id="4807256">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807273">if</span>&nbsp;<span class="ident" id="4807276">c</span>&nbsp;<span class="op" id="4807278">&lt;</span>&nbsp;<span class="num" id="4807280">0x20</span>&nbsp;<span class="op" id="4807285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807289">return</span>&nbsp;<span class="ident" id="4807296">s</span><span class="op" id="4807297">.</span><span class="builtintype" id="4807298">error</span><span class="op" id="4807303">(</span><span class="ident" id="4807304">c</span><span class="op" id="4807305">,</span>&nbsp;<span class="string" id="4807307">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="4807326">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807332">return</span>&nbsp;<span class="ident" id="4807339">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="4807352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4807355">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="4807431">func</span>&nbsp;<span class="ident" id="4807436">stateInStringEsc</span><span class="op" id="4807452">(</span><span class="ident" id="4807453">s</span>&nbsp;<span class="op" id="4807455">*</span><span class="ident" id="4807456">scanner</span><span class="op" id="4807463">,</span>&nbsp;<span class="ident" id="4807465">c</span>&nbsp;<span class="builtintype" id="4807467">int</span><span class="op" id="4807470">)</span>&nbsp;<span class="builtintype" id="4807472">int</span>&nbsp;<span class="op" id="4807476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807479">switch</span>&nbsp;<span class="ident" id="4807486">c</span>&nbsp;<span class="op" id="4807488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807491">case</span>&nbsp;<span class="string" id="4807496">&#39;b&#39;</span><span class="op" id="4807499">,</span>&nbsp;<span class="string" id="4807501">&#39;f&#39;</span><span class="op" id="4807504">,</span>&nbsp;<span class="string" id="4807506">&#39;n&#39;</span><span class="op" id="4807509">,</span>&nbsp;<span class="string" id="4807511">&#39;r&#39;</span><span class="op" id="4807514">,</span>&nbsp;<span class="string" id="4807516">&#39;t&#39;</span><span class="op" id="4807519">,</span>&nbsp;<span class="string" id="4807521">&#39;\\&#39;</span><span class="op" id="4807525">,</span>&nbsp;<span class="string" id="4807527">&#39;/&#39;</span><span class="op" id="4807530">,</span>&nbsp;<span class="string" id="4807532">&#39;&#34;&#39;</span><span class="op" id="4807535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4807539">s</span><span class="op" id="4807540">.</span><span class="ident" id="4807541">step</span>&nbsp;<span class="op" id="4807546">=</span>&nbsp;<span class="ident" id="4807548">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807564">return</span>&nbsp;<span class="ident" id="4807571">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807588">if</span>&nbsp;<span class="ident" id="4807591">c</span>&nbsp;<span class="op" id="4807593">==</span>&nbsp;<span class="string" id="4807596">&#39;u&#39;</span>&nbsp;<span class="op" id="4807600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4807604">s</span><span class="op" id="4807605">.</span><span class="ident" id="4807606">step</span>&nbsp;<span class="op" id="4807611">=</span>&nbsp;<span class="ident" id="4807613">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807633">return</span>&nbsp;<span class="ident" id="4807640">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807654">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807657">return</span>&nbsp;<span class="ident" id="4807664">s</span><span class="op" id="4807665">.</span><span class="builtintype" id="4807666">error</span><span class="op" id="4807671">(</span><span class="ident" id="4807672">c</span><span class="op" id="4807673">,</span>&nbsp;<span class="string" id="4807675">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="4807698">)</span><br>
<span class="lineno"></span><span class="op" id="4807700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4807703">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4807781">func</span>&nbsp;<span class="ident" id="4807786">stateInStringEscU</span><span class="op" id="4807803">(</span><span class="ident" id="4807804">s</span>&nbsp;<span class="op" id="4807806">*</span><span class="ident" id="4807807">scanner</span><span class="op" id="4807814">,</span>&nbsp;<span class="ident" id="4807816">c</span>&nbsp;<span class="builtintype" id="4807818">int</span><span class="op" id="4807821">)</span>&nbsp;<span class="builtintype" id="4807823">int</span>&nbsp;<span class="op" id="4807827">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807830">if</span>&nbsp;<span class="string" id="4807833">&#39;0&#39;</span>&nbsp;<span class="op" id="4807837">&lt;=</span>&nbsp;<span class="ident" id="4807840">c</span>&nbsp;<span class="op" id="4807842">&amp;&amp;</span>&nbsp;<span class="ident" id="4807845">c</span>&nbsp;<span class="op" id="4807847">&lt;=</span>&nbsp;<span class="string" id="4807850">&#39;9&#39;</span>&nbsp;<span class="op" id="4807854">||</span>&nbsp;<span class="string" id="4807857">&#39;a&#39;</span>&nbsp;<span class="op" id="4807861">&lt;=</span>&nbsp;<span class="ident" id="4807864">c</span>&nbsp;<span class="op" id="4807866">&amp;&amp;</span>&nbsp;<span class="ident" id="4807869">c</span>&nbsp;<span class="op" id="4807871">&lt;=</span>&nbsp;<span class="string" id="4807874">&#39;f&#39;</span>&nbsp;<span class="op" id="4807878">||</span>&nbsp;<span class="string" id="4807881">&#39;A&#39;</span>&nbsp;<span class="op" id="4807885">&lt;=</span>&nbsp;<span class="ident" id="4807888">c</span>&nbsp;<span class="op" id="4807890">&amp;&amp;</span>&nbsp;<span class="ident" id="4807893">c</span>&nbsp;<span class="op" id="4807895">&lt;=</span>&nbsp;<span class="string" id="4807898">&#39;F&#39;</span>&nbsp;<span class="op" id="4807902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4807906">s</span><span class="op" id="4807907">.</span><span class="ident" id="4807908">step</span>&nbsp;<span class="op" id="4807913">=</span>&nbsp;<span class="ident" id="4807915">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807936">return</span>&nbsp;<span class="ident" id="4807943">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4807957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4807960">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4807972">return</span>&nbsp;<span class="ident" id="4807979">s</span><span class="op" id="4807980">.</span><span class="builtintype" id="4807981">error</span><span class="op" id="4807986">(</span><span class="ident" id="4807987">c</span><span class="op" id="4807988">,</span>&nbsp;<span class="string" id="4807990">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4808027">)</span><br>
<span class="lineno"></span><span class="op" id="4808029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4808032">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4808112">func</span>&nbsp;<span class="ident" id="4808117">stateInStringEscU1</span><span class="op" id="4808135">(</span><span class="ident" id="4808136">s</span>&nbsp;<span class="op" id="4808138">*</span><span class="ident" id="4808139">scanner</span><span class="op" id="4808146">,</span>&nbsp;<span class="ident" id="4808148">c</span>&nbsp;<span class="builtintype" id="4808150">int</span><span class="op" id="4808153">)</span>&nbsp;<span class="builtintype" id="4808155">int</span>&nbsp;<span class="op" id="4808159">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808162">if</span>&nbsp;<span class="string" id="4808165">&#39;0&#39;</span>&nbsp;<span class="op" id="4808169">&lt;=</span>&nbsp;<span class="ident" id="4808172">c</span>&nbsp;<span class="op" id="4808174">&amp;&amp;</span>&nbsp;<span class="ident" id="4808177">c</span>&nbsp;<span class="op" id="4808179">&lt;=</span>&nbsp;<span class="string" id="4808182">&#39;9&#39;</span>&nbsp;<span class="op" id="4808186">||</span>&nbsp;<span class="string" id="4808189">&#39;a&#39;</span>&nbsp;<span class="op" id="4808193">&lt;=</span>&nbsp;<span class="ident" id="4808196">c</span>&nbsp;<span class="op" id="4808198">&amp;&amp;</span>&nbsp;<span class="ident" id="4808201">c</span>&nbsp;<span class="op" id="4808203">&lt;=</span>&nbsp;<span class="string" id="4808206">&#39;f&#39;</span>&nbsp;<span class="op" id="4808210">||</span>&nbsp;<span class="string" id="4808213">&#39;A&#39;</span>&nbsp;<span class="op" id="4808217">&lt;=</span>&nbsp;<span class="ident" id="4808220">c</span>&nbsp;<span class="op" id="4808222">&amp;&amp;</span>&nbsp;<span class="ident" id="4808225">c</span>&nbsp;<span class="op" id="4808227">&lt;=</span>&nbsp;<span class="string" id="4808230">&#39;F&#39;</span>&nbsp;<span class="op" id="4808234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4808238">s</span><span class="op" id="4808239">.</span><span class="ident" id="4808240">step</span>&nbsp;<span class="op" id="4808245">=</span>&nbsp;<span class="ident" id="4808247">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808269">return</span>&nbsp;<span class="ident" id="4808276">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4808290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4808293">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808305">return</span>&nbsp;<span class="ident" id="4808312">s</span><span class="op" id="4808313">.</span><span class="builtintype" id="4808314">error</span><span class="op" id="4808319">(</span><span class="ident" id="4808320">c</span><span class="op" id="4808321">,</span>&nbsp;<span class="string" id="4808323">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4808360">)</span><br>
<span class="lineno"></span><span class="op" id="4808362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4808365">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4808447">func</span>&nbsp;<span class="ident" id="4808452">stateInStringEscU12</span><span class="op" id="4808471">(</span><span class="ident" id="4808472">s</span>&nbsp;<span class="op" id="4808474">*</span><span class="ident" id="4808475">scanner</span><span class="op" id="4808482">,</span>&nbsp;<span class="ident" id="4808484">c</span>&nbsp;<span class="builtintype" id="4808486">int</span><span class="op" id="4808489">)</span>&nbsp;<span class="builtintype" id="4808491">int</span>&nbsp;<span class="op" id="4808495">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808498">if</span>&nbsp;<span class="string" id="4808501">&#39;0&#39;</span>&nbsp;<span class="op" id="4808505">&lt;=</span>&nbsp;<span class="ident" id="4808508">c</span>&nbsp;<span class="op" id="4808510">&amp;&amp;</span>&nbsp;<span class="ident" id="4808513">c</span>&nbsp;<span class="op" id="4808515">&lt;=</span>&nbsp;<span class="string" id="4808518">&#39;9&#39;</span>&nbsp;<span class="op" id="4808522">||</span>&nbsp;<span class="string" id="4808525">&#39;a&#39;</span>&nbsp;<span class="op" id="4808529">&lt;=</span>&nbsp;<span class="ident" id="4808532">c</span>&nbsp;<span class="op" id="4808534">&amp;&amp;</span>&nbsp;<span class="ident" id="4808537">c</span>&nbsp;<span class="op" id="4808539">&lt;=</span>&nbsp;<span class="string" id="4808542">&#39;f&#39;</span>&nbsp;<span class="op" id="4808546">||</span>&nbsp;<span class="string" id="4808549">&#39;A&#39;</span>&nbsp;<span class="op" id="4808553">&lt;=</span>&nbsp;<span class="ident" id="4808556">c</span>&nbsp;<span class="op" id="4808558">&amp;&amp;</span>&nbsp;<span class="ident" id="4808561">c</span>&nbsp;<span class="op" id="4808563">&lt;=</span>&nbsp;<span class="string" id="4808566">&#39;F&#39;</span>&nbsp;<span class="op" id="4808570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4808574">s</span><span class="op" id="4808575">.</span><span class="ident" id="4808576">step</span>&nbsp;<span class="op" id="4808581">=</span>&nbsp;<span class="ident" id="4808583">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808606">return</span>&nbsp;<span class="ident" id="4808613">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4808627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4808630">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808642">return</span>&nbsp;<span class="ident" id="4808649">s</span><span class="op" id="4808650">.</span><span class="builtintype" id="4808651">error</span><span class="op" id="4808656">(</span><span class="ident" id="4808657">c</span><span class="op" id="4808658">,</span>&nbsp;<span class="string" id="4808660">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4808697">)</span><br>
<span class="lineno"></span><span class="op" id="4808699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4808702">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4808786">func</span>&nbsp;<span class="ident" id="4808791">stateInStringEscU123</span><span class="op" id="4808811">(</span><span class="ident" id="4808812">s</span>&nbsp;<span class="op" id="4808814">*</span><span class="ident" id="4808815">scanner</span><span class="op" id="4808822">,</span>&nbsp;<span class="ident" id="4808824">c</span>&nbsp;<span class="builtintype" id="4808826">int</span><span class="op" id="4808829">)</span>&nbsp;<span class="builtintype" id="4808831">int</span>&nbsp;<span class="op" id="4808835">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808838">if</span>&nbsp;<span class="string" id="4808841">&#39;0&#39;</span>&nbsp;<span class="op" id="4808845">&lt;=</span>&nbsp;<span class="ident" id="4808848">c</span>&nbsp;<span class="op" id="4808850">&amp;&amp;</span>&nbsp;<span class="ident" id="4808853">c</span>&nbsp;<span class="op" id="4808855">&lt;=</span>&nbsp;<span class="string" id="4808858">&#39;9&#39;</span>&nbsp;<span class="op" id="4808862">||</span>&nbsp;<span class="string" id="4808865">&#39;a&#39;</span>&nbsp;<span class="op" id="4808869">&lt;=</span>&nbsp;<span class="ident" id="4808872">c</span>&nbsp;<span class="op" id="4808874">&amp;&amp;</span>&nbsp;<span class="ident" id="4808877">c</span>&nbsp;<span class="op" id="4808879">&lt;=</span>&nbsp;<span class="string" id="4808882">&#39;f&#39;</span>&nbsp;<span class="op" id="4808886">||</span>&nbsp;<span class="string" id="4808889">&#39;A&#39;</span>&nbsp;<span class="op" id="4808893">&lt;=</span>&nbsp;<span class="ident" id="4808896">c</span>&nbsp;<span class="op" id="4808898">&amp;&amp;</span>&nbsp;<span class="ident" id="4808901">c</span>&nbsp;<span class="op" id="4808903">&lt;=</span>&nbsp;<span class="string" id="4808906">&#39;F&#39;</span>&nbsp;<span class="op" id="4808910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4808914">s</span><span class="op" id="4808915">.</span><span class="ident" id="4808916">step</span>&nbsp;<span class="op" id="4808921">=</span>&nbsp;<span class="ident" id="4808923">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808939">return</span>&nbsp;<span class="ident" id="4808946">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4808960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4808963">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4808975">return</span>&nbsp;<span class="ident" id="4808982">s</span><span class="op" id="4808983">.</span><span class="builtintype" id="4808984">error</span><span class="op" id="4808989">(</span><span class="ident" id="4808990">c</span><span class="op" id="4808991">,</span>&nbsp;<span class="string" id="4808993">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4809030">)</span><br>
<span class="lineno"></span><span class="op" id="4809032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4809035">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4809095">func</span>&nbsp;<span class="ident" id="4809100">stateNeg</span><span class="op" id="4809108">(</span><span class="ident" id="4809109">s</span>&nbsp;<span class="op" id="4809111">*</span><span class="ident" id="4809112">scanner</span><span class="op" id="4809119">,</span>&nbsp;<span class="ident" id="4809121">c</span>&nbsp;<span class="builtintype" id="4809123">int</span><span class="op" id="4809126">)</span>&nbsp;<span class="builtintype" id="4809128">int</span>&nbsp;<span class="op" id="4809132">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809135">if</span>&nbsp;<span class="ident" id="4809138">c</span>&nbsp;<span class="op" id="4809140">==</span>&nbsp;<span class="string" id="4809143">&#39;0&#39;</span>&nbsp;<span class="op" id="4809147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809151">s</span><span class="op" id="4809152">.</span><span class="ident" id="4809153">step</span>&nbsp;<span class="op" id="4809158">=</span>&nbsp;<span class="ident" id="4809160">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809169">return</span>&nbsp;<span class="ident" id="4809176">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809193">if</span>&nbsp;<span class="string" id="4809196">&#39;1&#39;</span>&nbsp;<span class="op" id="4809200">&lt;=</span>&nbsp;<span class="ident" id="4809203">c</span>&nbsp;<span class="op" id="4809205">&amp;&amp;</span>&nbsp;<span class="ident" id="4809208">c</span>&nbsp;<span class="op" id="4809210">&lt;=</span>&nbsp;<span class="string" id="4809213">&#39;9&#39;</span>&nbsp;<span class="op" id="4809217">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809221">s</span><span class="op" id="4809222">.</span><span class="ident" id="4809223">step</span>&nbsp;<span class="op" id="4809228">=</span>&nbsp;<span class="ident" id="4809230">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809239">return</span>&nbsp;<span class="ident" id="4809246">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809263">return</span>&nbsp;<span class="ident" id="4809270">s</span><span class="op" id="4809271">.</span><span class="builtintype" id="4809272">error</span><span class="op" id="4809277">(</span><span class="ident" id="4809278">c</span><span class="op" id="4809279">,</span>&nbsp;<span class="string" id="4809281">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4809301">)</span><br>
<span class="lineno"></span><span class="op" id="4809303">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="4809306">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4809379">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="4809430">func</span>&nbsp;<span class="ident" id="4809435">state1</span><span class="op" id="4809441">(</span><span class="ident" id="4809442">s</span>&nbsp;<span class="op" id="4809444">*</span><span class="ident" id="4809445">scanner</span><span class="op" id="4809452">,</span>&nbsp;<span class="ident" id="4809454">c</span>&nbsp;<span class="builtintype" id="4809456">int</span><span class="op" id="4809459">)</span>&nbsp;<span class="builtintype" id="4809461">int</span>&nbsp;<span class="op" id="4809465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809468">if</span>&nbsp;<span class="string" id="4809471">&#39;0&#39;</span>&nbsp;<span class="op" id="4809475">&lt;=</span>&nbsp;<span class="ident" id="4809478">c</span>&nbsp;<span class="op" id="4809480">&amp;&amp;</span>&nbsp;<span class="ident" id="4809483">c</span>&nbsp;<span class="op" id="4809485">&lt;=</span>&nbsp;<span class="string" id="4809488">&#39;9&#39;</span>&nbsp;<span class="op" id="4809492">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809496">s</span><span class="op" id="4809497">.</span><span class="ident" id="4809498">step</span>&nbsp;<span class="op" id="4809503">=</span>&nbsp;<span class="ident" id="4809505">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809514">return</span>&nbsp;<span class="ident" id="4809521">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809538">return</span>&nbsp;<span class="ident" id="4809545">state0</span><span class="op" id="4809551">(</span><span class="ident" id="4809552">s</span><span class="op" id="4809553">,</span>&nbsp;<span class="ident" id="4809555">c</span><span class="op" id="4809556">)</span><br>
<span class="lineno"></span><span class="op" id="4809558">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="4809561">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4809619">func</span>&nbsp;<span class="ident" id="4809624">state0</span><span class="op" id="4809630">(</span><span class="ident" id="4809631">s</span>&nbsp;<span class="op" id="4809633">*</span><span class="ident" id="4809634">scanner</span><span class="op" id="4809641">,</span>&nbsp;<span class="ident" id="4809643">c</span>&nbsp;<span class="builtintype" id="4809645">int</span><span class="op" id="4809648">)</span>&nbsp;<span class="builtintype" id="4809650">int</span>&nbsp;<span class="op" id="4809654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809657">if</span>&nbsp;<span class="ident" id="4809660">c</span>&nbsp;<span class="op" id="4809662">==</span>&nbsp;<span class="string" id="4809665">&#39;.&#39;</span>&nbsp;<span class="op" id="4809669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809673">s</span><span class="op" id="4809674">.</span><span class="ident" id="4809675">step</span>&nbsp;<span class="op" id="4809680">=</span>&nbsp;<span class="ident" id="4809682">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809693">return</span>&nbsp;<span class="ident" id="4809700">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809717">if</span>&nbsp;<span class="ident" id="4809720">c</span>&nbsp;<span class="op" id="4809722">==</span>&nbsp;<span class="string" id="4809725">&#39;e&#39;</span>&nbsp;<span class="op" id="4809729">||</span>&nbsp;<span class="ident" id="4809732">c</span>&nbsp;<span class="op" id="4809734">==</span>&nbsp;<span class="string" id="4809737">&#39;E&#39;</span>&nbsp;<span class="op" id="4809741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809745">s</span><span class="op" id="4809746">.</span><span class="ident" id="4809747">step</span>&nbsp;<span class="op" id="4809752">=</span>&nbsp;<span class="ident" id="4809754">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809763">return</span>&nbsp;<span class="ident" id="4809770">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809787">return</span>&nbsp;<span class="ident" id="4809794">stateEndValue</span><span class="op" id="4809807">(</span><span class="ident" id="4809808">s</span><span class="op" id="4809809">,</span>&nbsp;<span class="ident" id="4809811">c</span><span class="op" id="4809812">)</span><br>
<span class="lineno"></span><span class="op" id="4809814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4809817">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="4809899">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="4809930">func</span>&nbsp;<span class="ident" id="4809935">stateDot</span><span class="op" id="4809943">(</span><span class="ident" id="4809944">s</span>&nbsp;<span class="op" id="4809946">*</span><span class="ident" id="4809947">scanner</span><span class="op" id="4809954">,</span>&nbsp;<span class="ident" id="4809956">c</span>&nbsp;<span class="builtintype" id="4809958">int</span><span class="op" id="4809961">)</span>&nbsp;<span class="builtintype" id="4809963">int</span>&nbsp;<span class="op" id="4809967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809970">if</span>&nbsp;<span class="string" id="4809973">&#39;0&#39;</span>&nbsp;<span class="op" id="4809977">&lt;=</span>&nbsp;<span class="ident" id="4809980">c</span>&nbsp;<span class="op" id="4809982">&amp;&amp;</span>&nbsp;<span class="ident" id="4809985">c</span>&nbsp;<span class="op" id="4809987">&lt;=</span>&nbsp;<span class="string" id="4809990">&#39;9&#39;</span>&nbsp;<span class="op" id="4809994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809998">s</span><span class="op" id="4809999">.</span><span class="ident" id="4810000">step</span>&nbsp;<span class="op" id="4810005">=</span>&nbsp;<span class="ident" id="4810007">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810019">return</span>&nbsp;<span class="ident" id="4810026">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810043">return</span>&nbsp;<span class="ident" id="4810050">s</span><span class="op" id="4810051">.</span><span class="builtintype" id="4810052">error</span><span class="op" id="4810057">(</span><span class="ident" id="4810058">c</span><span class="op" id="4810059">,</span>&nbsp;<span class="string" id="4810061">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4810101">)</span><br>
<span class="lineno"></span><span class="op" id="4810103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4810106">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="4810189">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="4810242">func</span>&nbsp;<span class="ident" id="4810247">stateDot0</span><span class="op" id="4810256">(</span><span class="ident" id="4810257">s</span>&nbsp;<span class="op" id="4810259">*</span><span class="ident" id="4810260">scanner</span><span class="op" id="4810267">,</span>&nbsp;<span class="ident" id="4810269">c</span>&nbsp;<span class="builtintype" id="4810271">int</span><span class="op" id="4810274">)</span>&nbsp;<span class="builtintype" id="4810276">int</span>&nbsp;<span class="op" id="4810280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810283">if</span>&nbsp;<span class="string" id="4810286">&#39;0&#39;</span>&nbsp;<span class="op" id="4810290">&lt;=</span>&nbsp;<span class="ident" id="4810293">c</span>&nbsp;<span class="op" id="4810295">&amp;&amp;</span>&nbsp;<span class="ident" id="4810298">c</span>&nbsp;<span class="op" id="4810300">&lt;=</span>&nbsp;<span class="string" id="4810303">&#39;9&#39;</span>&nbsp;<span class="op" id="4810307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810311">s</span><span class="op" id="4810312">.</span><span class="ident" id="4810313">step</span>&nbsp;<span class="op" id="4810318">=</span>&nbsp;<span class="ident" id="4810320">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810332">return</span>&nbsp;<span class="ident" id="4810339">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810356">if</span>&nbsp;<span class="ident" id="4810359">c</span>&nbsp;<span class="op" id="4810361">==</span>&nbsp;<span class="string" id="4810364">&#39;e&#39;</span>&nbsp;<span class="op" id="4810368">||</span>&nbsp;<span class="ident" id="4810371">c</span>&nbsp;<span class="op" id="4810373">==</span>&nbsp;<span class="string" id="4810376">&#39;E&#39;</span>&nbsp;<span class="op" id="4810380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810384">s</span><span class="op" id="4810385">.</span><span class="ident" id="4810386">step</span>&nbsp;<span class="op" id="4810391">=</span>&nbsp;<span class="ident" id="4810393">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810402">return</span>&nbsp;<span class="ident" id="4810409">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810423">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810426">return</span>&nbsp;<span class="ident" id="4810433">stateEndValue</span><span class="op" id="4810446">(</span><span class="ident" id="4810447">s</span><span class="op" id="4810448">,</span>&nbsp;<span class="ident" id="4810450">c</span><span class="op" id="4810451">)</span><br>
<span class="lineno"></span><span class="op" id="4810453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4810456">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4810525">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="4810570">func</span>&nbsp;<span class="ident" id="4810575">stateE</span><span class="op" id="4810581">(</span><span class="ident" id="4810582">s</span>&nbsp;<span class="op" id="4810584">*</span><span class="ident" id="4810585">scanner</span><span class="op" id="4810592">,</span>&nbsp;<span class="ident" id="4810594">c</span>&nbsp;<span class="builtintype" id="4810596">int</span><span class="op" id="4810599">)</span>&nbsp;<span class="builtintype" id="4810601">int</span>&nbsp;<span class="op" id="4810605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810608">if</span>&nbsp;<span class="ident" id="4810611">c</span>&nbsp;<span class="op" id="4810613">==</span>&nbsp;<span class="string" id="4810616">&#39;+&#39;</span>&nbsp;<span class="op" id="4810620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810624">s</span><span class="op" id="4810625">.</span><span class="ident" id="4810626">step</span>&nbsp;<span class="op" id="4810631">=</span>&nbsp;<span class="ident" id="4810633">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810646">return</span>&nbsp;<span class="ident" id="4810653">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810667">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810670">if</span>&nbsp;<span class="ident" id="4810673">c</span>&nbsp;<span class="op" id="4810675">==</span>&nbsp;<span class="string" id="4810678">&#39;-&#39;</span>&nbsp;<span class="op" id="4810682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810686">s</span><span class="op" id="4810687">.</span><span class="ident" id="4810688">step</span>&nbsp;<span class="op" id="4810693">=</span>&nbsp;<span class="ident" id="4810695">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810708">return</span>&nbsp;<span class="ident" id="4810715">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810732">return</span>&nbsp;<span class="ident" id="4810739">stateESign</span><span class="op" id="4810749">(</span><span class="ident" id="4810750">s</span><span class="op" id="4810751">,</span>&nbsp;<span class="ident" id="4810753">c</span><span class="op" id="4810754">)</span><br>
<span class="lineno">465</span><span class="op" id="4810756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4810759">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4810839">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="4810886">func</span>&nbsp;<span class="ident" id="4810891">stateESign</span><span class="op" id="4810901">(</span><span class="ident" id="4810902">s</span>&nbsp;<span class="op" id="4810904">*</span><span class="ident" id="4810905">scanner</span><span class="op" id="4810912">,</span>&nbsp;<span class="ident" id="4810914">c</span>&nbsp;<span class="builtintype" id="4810916">int</span><span class="op" id="4810919">)</span>&nbsp;<span class="builtintype" id="4810921">int</span>&nbsp;<span class="op" id="4810925">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810928">if</span>&nbsp;<span class="string" id="4810931">&#39;0&#39;</span>&nbsp;<span class="op" id="4810935">&lt;=</span>&nbsp;<span class="ident" id="4810938">c</span>&nbsp;<span class="op" id="4810940">&amp;&amp;</span>&nbsp;<span class="ident" id="4810943">c</span>&nbsp;<span class="op" id="4810945">&lt;=</span>&nbsp;<span class="string" id="4810948">&#39;9&#39;</span>&nbsp;<span class="op" id="4810952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810956">s</span><span class="op" id="4810957">.</span><span class="ident" id="4810958">step</span>&nbsp;<span class="op" id="4810963">=</span>&nbsp;<span class="ident" id="4810965">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810975">return</span>&nbsp;<span class="ident" id="4810982">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810999">return</span>&nbsp;<span class="ident" id="4811006">s</span><span class="op" id="4811007">.</span><span class="builtintype" id="4811008">error</span><span class="op" id="4811013">(</span><span class="ident" id="4811014">c</span><span class="op" id="4811015">,</span>&nbsp;<span class="string" id="4811017">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4811049">)</span><br>
<span class="lineno">475</span><span class="op" id="4811051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4811054">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="4811124">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4811179">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="4811240">func</span>&nbsp;<span class="ident" id="4811245">stateE0</span><span class="op" id="4811252">(</span><span class="ident" id="4811253">s</span>&nbsp;<span class="op" id="4811255">*</span><span class="ident" id="4811256">scanner</span><span class="op" id="4811263">,</span>&nbsp;<span class="ident" id="4811265">c</span>&nbsp;<span class="builtintype" id="4811267">int</span><span class="op" id="4811270">)</span>&nbsp;<span class="builtintype" id="4811272">int</span>&nbsp;<span class="op" id="4811276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811279">if</span>&nbsp;<span class="string" id="4811282">&#39;0&#39;</span>&nbsp;<span class="op" id="4811286">&lt;=</span>&nbsp;<span class="ident" id="4811289">c</span>&nbsp;<span class="op" id="4811291">&amp;&amp;</span>&nbsp;<span class="ident" id="4811294">c</span>&nbsp;<span class="op" id="4811296">&lt;=</span>&nbsp;<span class="string" id="4811299">&#39;9&#39;</span>&nbsp;<span class="op" id="4811303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4811307">s</span><span class="op" id="4811308">.</span><span class="ident" id="4811309">step</span>&nbsp;<span class="op" id="4811314">=</span>&nbsp;<span class="ident" id="4811316">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811326">return</span>&nbsp;<span class="ident" id="4811333">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4811347">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811350">return</span>&nbsp;<span class="ident" id="4811357">stateEndValue</span><span class="op" id="4811370">(</span><span class="ident" id="4811371">s</span><span class="op" id="4811372">,</span>&nbsp;<span class="ident" id="4811374">c</span><span class="op" id="4811375">)</span><br>
<span class="lineno"></span><span class="op" id="4811377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4811380">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="4811422">func</span>&nbsp;<span class="ident" id="4811427">stateT</span><span class="op" id="4811433">(</span><span class="ident" id="4811434">s</span>&nbsp;<span class="op" id="4811436">*</span><span class="ident" id="4811437">scanner</span><span class="op" id="4811444">,</span>&nbsp;<span class="ident" id="4811446">c</span>&nbsp;<span class="builtintype" id="4811448">int</span><span class="op" id="4811451">)</span>&nbsp;<span class="builtintype" id="4811453">int</span>&nbsp;<span class="op" id="4811457">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811460">if</span>&nbsp;<span class="ident" id="4811463">c</span>&nbsp;<span class="op" id="4811465">==</span>&nbsp;<span class="string" id="4811468">&#39;r&#39;</span>&nbsp;<span class="op" id="4811472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4811476">s</span><span class="op" id="4811477">.</span><span class="ident" id="4811478">step</span>&nbsp;<span class="op" id="4811483">=</span>&nbsp;<span class="ident" id="4811485">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811495">return</span>&nbsp;<span class="ident" id="4811502">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4811516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811519">return</span>&nbsp;<span class="ident" id="4811526">s</span><span class="op" id="4811527">.</span><span class="builtintype" id="4811528">error</span><span class="op" id="4811533">(</span><span class="ident" id="4811534">c</span><span class="op" id="4811535">,</span>&nbsp;<span class="string" id="4811537">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="4811570">)</span><br>
<span class="lineno">495</span><span class="op" id="4811572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4811575">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="4811619">func</span>&nbsp;<span class="ident" id="4811624">stateTr</span><span class="op" id="4811631">(</span><span class="ident" id="4811632">s</span>&nbsp;<span class="op" id="4811634">*</span><span class="ident" id="4811635">scanner</span><span class="op" id="4811642">,</span>&nbsp;<span class="ident" id="4811644">c</span>&nbsp;<span class="builtintype" id="4811646">int</span><span class="op" id="4811649">)</span>&nbsp;<span class="builtintype" id="4811651">int</span>&nbsp;<span class="op" id="4811655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811658">if</span>&nbsp;<span class="ident" id="4811661">c</span>&nbsp;<span class="op" id="4811663">==</span>&nbsp;<span class="string" id="4811666">&#39;u&#39;</span>&nbsp;<span class="op" id="4811670">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4811674">s</span><span class="op" id="4811675">.</span><span class="ident" id="4811676">step</span>&nbsp;<span class="op" id="4811681">=</span>&nbsp;<span class="ident" id="4811683">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811694">return</span>&nbsp;<span class="ident" id="4811701">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4811715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811718">return</span>&nbsp;<span class="ident" id="4811725">s</span><span class="op" id="4811726">.</span><span class="builtintype" id="4811727">error</span><span class="op" id="4811732">(</span><span class="ident" id="4811733">c</span><span class="op" id="4811734">,</span>&nbsp;<span class="string" id="4811736">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4811769">)</span><br>
<span class="lineno"></span><span class="op" id="4811771">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="4811774">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="4811820">func</span>&nbsp;<span class="ident" id="4811825">stateTru</span><span class="op" id="4811833">(</span><span class="ident" id="4811834">s</span>&nbsp;<span class="op" id="4811836">*</span><span class="ident" id="4811837">scanner</span><span class="op" id="4811844">,</span>&nbsp;<span class="ident" id="4811846">c</span>&nbsp;<span class="builtintype" id="4811848">int</span><span class="op" id="4811851">)</span>&nbsp;<span class="builtintype" id="4811853">int</span>&nbsp;<span class="op" id="4811857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811860">if</span>&nbsp;<span class="ident" id="4811863">c</span>&nbsp;<span class="op" id="4811865">==</span>&nbsp;<span class="string" id="4811868">&#39;e&#39;</span>&nbsp;<span class="op" id="4811872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4811876">s</span><span class="op" id="4811877">.</span><span class="ident" id="4811878">step</span>&nbsp;<span class="op" id="4811883">=</span>&nbsp;<span class="ident" id="4811885">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811901">return</span>&nbsp;<span class="ident" id="4811908">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4811922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811925">return</span>&nbsp;<span class="ident" id="4811932">s</span><span class="op" id="4811933">.</span><span class="builtintype" id="4811934">error</span><span class="op" id="4811939">(</span><span class="ident" id="4811940">c</span><span class="op" id="4811941">,</span>&nbsp;<span class="string" id="4811943">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4811976">)</span><br>
<span class="lineno"></span><span class="op" id="4811978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4811981">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="4812023">func</span>&nbsp;<span class="ident" id="4812028">stateF</span><span class="op" id="4812034">(</span><span class="ident" id="4812035">s</span>&nbsp;<span class="op" id="4812037">*</span><span class="ident" id="4812038">scanner</span><span class="op" id="4812045">,</span>&nbsp;<span class="ident" id="4812047">c</span>&nbsp;<span class="builtintype" id="4812049">int</span><span class="op" id="4812052">)</span>&nbsp;<span class="builtintype" id="4812054">int</span>&nbsp;<span class="op" id="4812058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812061">if</span>&nbsp;<span class="ident" id="4812064">c</span>&nbsp;<span class="op" id="4812066">==</span>&nbsp;<span class="string" id="4812069">&#39;a&#39;</span>&nbsp;<span class="op" id="4812073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4812077">s</span><span class="op" id="4812078">.</span><span class="ident" id="4812079">step</span>&nbsp;<span class="op" id="4812084">=</span>&nbsp;<span class="ident" id="4812086">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812096">return</span>&nbsp;<span class="ident" id="4812103">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4812117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812120">return</span>&nbsp;<span class="ident" id="4812127">s</span><span class="op" id="4812128">.</span><span class="builtintype" id="4812129">error</span><span class="op" id="4812134">(</span><span class="ident" id="4812135">c</span><span class="op" id="4812136">,</span>&nbsp;<span class="string" id="4812138">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="4812172">)</span><br>
<span class="lineno"></span><span class="op" id="4812174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4812177">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="4812221">func</span>&nbsp;<span class="ident" id="4812226">stateFa</span><span class="op" id="4812233">(</span><span class="ident" id="4812234">s</span>&nbsp;<span class="op" id="4812236">*</span><span class="ident" id="4812237">scanner</span><span class="op" id="4812244">,</span>&nbsp;<span class="ident" id="4812246">c</span>&nbsp;<span class="builtintype" id="4812248">int</span><span class="op" id="4812251">)</span>&nbsp;<span class="builtintype" id="4812253">int</span>&nbsp;<span class="op" id="4812257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812260">if</span>&nbsp;<span class="ident" id="4812263">c</span>&nbsp;<span class="op" id="4812265">==</span>&nbsp;<span class="string" id="4812268">&#39;l&#39;</span>&nbsp;<span class="op" id="4812272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4812276">s</span><span class="op" id="4812277">.</span><span class="ident" id="4812278">step</span>&nbsp;<span class="op" id="4812283">=</span>&nbsp;<span class="ident" id="4812285">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812296">return</span>&nbsp;<span class="ident" id="4812303">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4812317">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812320">return</span>&nbsp;<span class="ident" id="4812327">s</span><span class="op" id="4812328">.</span><span class="builtintype" id="4812329">error</span><span class="op" id="4812334">(</span><span class="ident" id="4812335">c</span><span class="op" id="4812336">,</span>&nbsp;<span class="string" id="4812338">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4812372">)</span><br>
<span class="lineno"></span><span class="op" id="4812374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4812377">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="4812423">func</span>&nbsp;<span class="ident" id="4812428">stateFal</span><span class="op" id="4812436">(</span><span class="ident" id="4812437">s</span>&nbsp;<span class="op" id="4812439">*</span><span class="ident" id="4812440">scanner</span><span class="op" id="4812447">,</span>&nbsp;<span class="ident" id="4812449">c</span>&nbsp;<span class="builtintype" id="4812451">int</span><span class="op" id="4812454">)</span>&nbsp;<span class="builtintype" id="4812456">int</span>&nbsp;<span class="op" id="4812460">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812463">if</span>&nbsp;<span class="ident" id="4812466">c</span>&nbsp;<span class="op" id="4812468">==</span>&nbsp;<span class="string" id="4812471">&#39;s&#39;</span>&nbsp;<span class="op" id="4812475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4812479">s</span><span class="op" id="4812480">.</span><span class="ident" id="4812481">step</span>&nbsp;<span class="op" id="4812486">=</span>&nbsp;<span class="ident" id="4812488">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812500">return</span>&nbsp;<span class="ident" id="4812507">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4812521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812524">return</span>&nbsp;<span class="ident" id="4812531">s</span><span class="op" id="4812532">.</span><span class="builtintype" id="4812533">error</span><span class="op" id="4812538">(</span><span class="ident" id="4812539">c</span><span class="op" id="4812540">,</span>&nbsp;<span class="string" id="4812542">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="4812576">)</span><br>
<span class="lineno">540</span><span class="op" id="4812578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4812581">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="4812629">func</span>&nbsp;<span class="ident" id="4812634">stateFals</span><span class="op" id="4812643">(</span><span class="ident" id="4812644">s</span>&nbsp;<span class="op" id="4812646">*</span><span class="ident" id="4812647">scanner</span><span class="op" id="4812654">,</span>&nbsp;<span class="ident" id="4812656">c</span>&nbsp;<span class="builtintype" id="4812658">int</span><span class="op" id="4812661">)</span>&nbsp;<span class="builtintype" id="4812663">int</span>&nbsp;<span class="op" id="4812667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812670">if</span>&nbsp;<span class="ident" id="4812673">c</span>&nbsp;<span class="op" id="4812675">==</span>&nbsp;<span class="string" id="4812678">&#39;e&#39;</span>&nbsp;<span class="op" id="4812682">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4812686">s</span><span class="op" id="4812687">.</span><span class="ident" id="4812688">step</span>&nbsp;<span class="op" id="4812693">=</span>&nbsp;<span class="ident" id="4812695">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812711">return</span>&nbsp;<span class="ident" id="4812718">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4812732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812735">return</span>&nbsp;<span class="ident" id="4812742">s</span><span class="op" id="4812743">.</span><span class="builtintype" id="4812744">error</span><span class="op" id="4812749">(</span><span class="ident" id="4812750">c</span><span class="op" id="4812751">,</span>&nbsp;<span class="string" id="4812753">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4812787">)</span><br>
<span class="lineno"></span><span class="op" id="4812789">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="4812792">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="4812834">func</span>&nbsp;<span class="ident" id="4812839">stateN</span><span class="op" id="4812845">(</span><span class="ident" id="4812846">s</span>&nbsp;<span class="op" id="4812848">*</span><span class="ident" id="4812849">scanner</span><span class="op" id="4812856">,</span>&nbsp;<span class="ident" id="4812858">c</span>&nbsp;<span class="builtintype" id="4812860">int</span><span class="op" id="4812863">)</span>&nbsp;<span class="builtintype" id="4812865">int</span>&nbsp;<span class="op" id="4812869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812872">if</span>&nbsp;<span class="ident" id="4812875">c</span>&nbsp;<span class="op" id="4812877">==</span>&nbsp;<span class="string" id="4812880">&#39;u&#39;</span>&nbsp;<span class="op" id="4812884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4812888">s</span><span class="op" id="4812889">.</span><span class="ident" id="4812890">step</span>&nbsp;<span class="op" id="4812895">=</span>&nbsp;<span class="ident" id="4812897">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812907">return</span>&nbsp;<span class="ident" id="4812914">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4812928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4812931">return</span>&nbsp;<span class="ident" id="4812938">s</span><span class="op" id="4812939">.</span><span class="builtintype" id="4812940">error</span><span class="op" id="4812945">(</span><span class="ident" id="4812946">c</span><span class="op" id="4812947">,</span>&nbsp;<span class="string" id="4812949">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4812982">)</span><br>
<span class="lineno"></span><span class="op" id="4812984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="4812987">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="4813031">func</span>&nbsp;<span class="ident" id="4813036">stateNu</span><span class="op" id="4813043">(</span><span class="ident" id="4813044">s</span>&nbsp;<span class="op" id="4813046">*</span><span class="ident" id="4813047">scanner</span><span class="op" id="4813054">,</span>&nbsp;<span class="ident" id="4813056">c</span>&nbsp;<span class="builtintype" id="4813058">int</span><span class="op" id="4813061">)</span>&nbsp;<span class="builtintype" id="4813063">int</span>&nbsp;<span class="op" id="4813067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813070">if</span>&nbsp;<span class="ident" id="4813073">c</span>&nbsp;<span class="op" id="4813075">==</span>&nbsp;<span class="string" id="4813078">&#39;l&#39;</span>&nbsp;<span class="op" id="4813082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4813086">s</span><span class="op" id="4813087">.</span><span class="ident" id="4813088">step</span>&nbsp;<span class="op" id="4813093">=</span>&nbsp;<span class="ident" id="4813095">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813106">return</span>&nbsp;<span class="ident" id="4813113">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4813127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813130">return</span>&nbsp;<span class="ident" id="4813137">s</span><span class="op" id="4813138">.</span><span class="builtintype" id="4813139">error</span><span class="op" id="4813144">(</span><span class="ident" id="4813145">c</span><span class="op" id="4813146">,</span>&nbsp;<span class="string" id="4813148">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4813181">)</span><br>
<span class="lineno"></span><span class="op" id="4813183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4813186">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="4813232">func</span>&nbsp;<span class="ident" id="4813237">stateNul</span><span class="op" id="4813245">(</span><span class="ident" id="4813246">s</span>&nbsp;<span class="op" id="4813248">*</span><span class="ident" id="4813249">scanner</span><span class="op" id="4813256">,</span>&nbsp;<span class="ident" id="4813258">c</span>&nbsp;<span class="builtintype" id="4813260">int</span><span class="op" id="4813263">)</span>&nbsp;<span class="builtintype" id="4813265">int</span>&nbsp;<span class="op" id="4813269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813272">if</span>&nbsp;<span class="ident" id="4813275">c</span>&nbsp;<span class="op" id="4813277">==</span>&nbsp;<span class="string" id="4813280">&#39;l&#39;</span>&nbsp;<span class="op" id="4813284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4813288">s</span><span class="op" id="4813289">.</span><span class="ident" id="4813290">step</span>&nbsp;<span class="op" id="4813295">=</span>&nbsp;<span class="ident" id="4813297">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813313">return</span>&nbsp;<span class="ident" id="4813320">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4813334">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813337">return</span>&nbsp;<span class="ident" id="4813344">s</span><span class="op" id="4813345">.</span><span class="builtintype" id="4813346">error</span><span class="op" id="4813351">(</span><span class="ident" id="4813352">c</span><span class="op" id="4813353">,</span>&nbsp;<span class="string" id="4813355">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4813388">)</span><br>
<span class="lineno"></span><span class="op" id="4813390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4813393">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4813451">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="4813494">func</span>&nbsp;<span class="ident" id="4813499">stateError</span><span class="op" id="4813509">(</span><span class="ident" id="4813510">s</span>&nbsp;<span class="op" id="4813512">*</span><span class="ident" id="4813513">scanner</span><span class="op" id="4813520">,</span>&nbsp;<span class="ident" id="4813522">c</span>&nbsp;<span class="builtintype" id="4813524">int</span><span class="op" id="4813527">)</span>&nbsp;<span class="builtintype" id="4813529">int</span>&nbsp;<span class="op" id="4813533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813536">return</span>&nbsp;<span class="ident" id="4813543">scanError</span><br>
<span class="lineno"></span><span class="op" id="4813553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4813556">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="4813615">func</span>&nbsp;<span class="op" id="4813620">(</span><span class="ident" id="4813621">s</span>&nbsp;<span class="op" id="4813623">*</span><span class="ident" id="4813624">scanner</span><span class="op" id="4813631">)</span>&nbsp;<span class="builtintype" id="4813633">error</span><span class="op" id="4813638">(</span><span class="ident" id="4813639">c</span>&nbsp;<span class="builtintype" id="4813641">int</span><span class="op" id="4813644">,</span>&nbsp;<span class="ident" id="4813646">context</span>&nbsp;<span class="builtintype" id="4813654">string</span><span class="op" id="4813660">)</span>&nbsp;<span class="builtintype" id="4813662">int</span>&nbsp;<span class="op" id="4813666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4813669">s</span><span class="op" id="4813670">.</span><span class="ident" id="4813671">step</span>&nbsp;<span class="op" id="4813676">=</span>&nbsp;<span class="ident" id="4813678">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4813690">s</span><span class="op" id="4813691">.</span><span class="ident" id="4813692">err</span>&nbsp;<span class="op" id="4813696">=</span>&nbsp;<span class="op" id="4813698">&amp;</span><span class="ident" id="4813699">SyntaxError</span><span class="op" id="4813710">{</span><span class="string" id="4813711">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="4813732">+</span>&nbsp;<span class="ident" id="4813734">quoteChar</span><span class="op" id="4813743">(</span><span class="ident" id="4813744">c</span><span class="op" id="4813745">)</span>&nbsp;<span class="op" id="4813747">+</span>&nbsp;<span class="string" id="4813749">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4813753">+</span>&nbsp;<span class="ident" id="4813755">context</span><span class="op" id="4813762">,</span>&nbsp;<span class="ident" id="4813764">s</span><span class="op" id="4813765">.</span><span class="ident" id="4813766">bytes</span><span class="op" id="4813771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813774">return</span>&nbsp;<span class="ident" id="4813781">scanError</span><br>
<span class="lineno"></span><span class="op" id="4813791">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4813794">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="4813847">func</span>&nbsp;<span class="ident" id="4813852">quoteChar</span><span class="op" id="4813861">(</span><span class="ident" id="4813862">c</span>&nbsp;<span class="builtintype" id="4813864">int</span><span class="op" id="4813867">)</span>&nbsp;<span class="builtintype" id="4813869">string</span>&nbsp;<span class="op" id="4813876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4813879">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813929">if</span>&nbsp;<span class="ident" id="4813932">c</span>&nbsp;<span class="op" id="4813934">==</span>&nbsp;<span class="string" id="4813937">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4813942">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813946">return</span>&nbsp;<span class="string" id="4813953">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4813961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813964">if</span>&nbsp;<span class="ident" id="4813967">c</span>&nbsp;<span class="op" id="4813969">==</span>&nbsp;<span class="string" id="4813972">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4813976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4813980">return</span>&nbsp;<span class="string" id="4813987">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4813994">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4813998">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814051">s</span>&nbsp;<span class="op" id="4814053">:=</span>&nbsp;<span class="ident" id="4814056">strconv</span><span class="op" id="4814063">.</span><span class="ident" id="4814064">Quote</span><span class="op" id="4814069">(</span><span class="builtintype" id="4814070">string</span><span class="op" id="4814076">(</span><span class="ident" id="4814077">c</span><span class="op" id="4814078">)</span><span class="op" id="4814079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4814082">return</span>&nbsp;<span class="string" id="4814089">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4814093">+</span>&nbsp;<span class="ident" id="4814095">s</span><span class="op" id="4814096">[</span><span class="num" id="4814097">1</span><span class="op" id="4814098">:</span><span class="builtinfunc" id="4814099">len</span><span class="op" id="4814102">(</span><span class="ident" id="4814103">s</span><span class="op" id="4814104">)</span><span class="op" id="4814105">-</span><span class="num" id="4814106">1</span><span class="op" id="4814107">]</span>&nbsp;<span class="op" id="4814109">+</span>&nbsp;<span class="string" id="4814111">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4814115">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="4814118">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="4814196">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="4814250">func</span>&nbsp;<span class="op" id="4814255">(</span><span class="ident" id="4814256">s</span>&nbsp;<span class="op" id="4814258">*</span><span class="ident" id="4814259">scanner</span><span class="op" id="4814266">)</span>&nbsp;<span class="ident" id="4814268">undo</span><span class="op" id="4814272">(</span><span class="ident" id="4814273">scanCode</span>&nbsp;<span class="builtintype" id="4814282">int</span><span class="op" id="4814285">)</span>&nbsp;<span class="op" id="4814287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4814290">if</span>&nbsp;<span class="ident" id="4814293">s</span><span class="op" id="4814294">.</span><span class="ident" id="4814295">redo</span>&nbsp;<span class="op" id="4814300">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4814304">panic</span><span class="op" id="4814309">(</span><span class="string" id="4814310">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="4814340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4814343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814346">s</span><span class="op" id="4814347">.</span><span class="ident" id="4814348">redoCode</span>&nbsp;<span class="op" id="4814357">=</span>&nbsp;<span class="ident" id="4814359">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814369">s</span><span class="op" id="4814370">.</span><span class="ident" id="4814371">redoState</span>&nbsp;<span class="op" id="4814381">=</span>&nbsp;<span class="ident" id="4814383">s</span><span class="op" id="4814384">.</span><span class="ident" id="4814385">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814391">s</span><span class="op" id="4814392">.</span><span class="ident" id="4814393">step</span>&nbsp;<span class="op" id="4814398">=</span>&nbsp;<span class="ident" id="4814400">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814411">s</span><span class="op" id="4814412">.</span><span class="ident" id="4814413">redo</span>&nbsp;<span class="op" id="4814418">=</span>&nbsp;<span class="builtintype" id="4814420">true</span><br>
<span class="lineno"></span><span class="op" id="4814425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4814428">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="4814484">func</span>&nbsp;<span class="ident" id="4814489">stateRedo</span><span class="op" id="4814498">(</span><span class="ident" id="4814499">s</span>&nbsp;<span class="op" id="4814501">*</span><span class="ident" id="4814502">scanner</span><span class="op" id="4814509">,</span>&nbsp;<span class="ident" id="4814511">c</span>&nbsp;<span class="builtintype" id="4814513">int</span><span class="op" id="4814516">)</span>&nbsp;<span class="builtintype" id="4814518">int</span>&nbsp;<span class="op" id="4814522">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814525">s</span><span class="op" id="4814526">.</span><span class="ident" id="4814527">redo</span>&nbsp;<span class="op" id="4814532">=</span>&nbsp;<span class="builtintype" id="4814534">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814541">s</span><span class="op" id="4814542">.</span><span class="ident" id="4814543">step</span>&nbsp;<span class="op" id="4814548">=</span>&nbsp;<span class="ident" id="4814550">s</span><span class="op" id="4814551">.</span><span class="ident" id="4814552">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4814563">return</span>&nbsp;<span class="ident" id="4814570">s</span><span class="op" id="4814571">.</span><span class="ident" id="4814572">redoCode</span><br>
<span class="lineno"></span><span class="op" id="4814581">}</span>
</div>
</body>
</html>
