<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html" class="current">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4625924">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4625979">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4626033">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4626084">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4626162">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4626180">package</span>&nbsp;<span class="ident" id="4626188">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626196">import</span>&nbsp;<span class="op" id="4626203">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4626206">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4626216">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4626223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626226">func</span>&nbsp;<span class="ident" id="4626231">init</span><span class="op" id="4626235">(</span><span class="op" id="4626236">)</span>&nbsp;<span class="op" id="4626238">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626241">crypto</span><span class="op" id="4626247">.</span><span class="ident" id="4626248">RegisterHash</span><span class="op" id="4626260">(</span><span class="ident" id="4626261">crypto</span><span class="op" id="4626267">.</span><span class="ident" id="4626268">SHA224</span><span class="op" id="4626274">,</span>&nbsp;<span class="ident" id="4626276">New224</span><span class="op" id="4626282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626285">crypto</span><span class="op" id="4626291">.</span><span class="ident" id="4626292">RegisterHash</span><span class="op" id="4626304">(</span><span class="ident" id="4626305">crypto</span><span class="op" id="4626311">.</span><span class="ident" id="4626312">SHA256</span><span class="op" id="4626318">,</span>&nbsp;<span class="ident" id="4626320">New</span><span class="op" id="4626323">)</span><br>
<span class="lineno"></span><span class="op" id="4626325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626328">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4626371">const</span>&nbsp;<span class="ident" id="4626377">Size</span>&nbsp;<span class="op" id="4626382">=</span>&nbsp;<span class="num" id="4626384">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626388">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4626431">const</span>&nbsp;<span class="ident" id="4626437">Size224</span>&nbsp;<span class="op" id="4626445">=</span>&nbsp;<span class="num" id="4626447">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4626451">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4626499">const</span>&nbsp;<span class="ident" id="4626505">BlockSize</span>&nbsp;<span class="op" id="4626515">=</span>&nbsp;<span class="num" id="4626517">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626521">const</span>&nbsp;<span class="op" id="4626527">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626530">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626540">=</span>&nbsp;<span class="num" id="4626542">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626546">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626556">=</span>&nbsp;<span class="num" id="4626558">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626570">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626580">=</span>&nbsp;<span class="num" id="4626582">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626594">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626604">=</span>&nbsp;<span class="num" id="4626606">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626618">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626628">=</span>&nbsp;<span class="num" id="4626630">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626642">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626652">=</span>&nbsp;<span class="num" id="4626654">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626666">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626676">=</span>&nbsp;<span class="num" id="4626678">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626690">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626700">=</span>&nbsp;<span class="num" id="4626702">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626714">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626724">=</span>&nbsp;<span class="num" id="4626726">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626738">init0_224</span>&nbsp;<span class="op" id="4626748">=</span>&nbsp;<span class="num" id="4626750">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626762">init1_224</span>&nbsp;<span class="op" id="4626772">=</span>&nbsp;<span class="num" id="4626774">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626786">init2_224</span>&nbsp;<span class="op" id="4626796">=</span>&nbsp;<span class="num" id="4626798">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626810">init3_224</span>&nbsp;<span class="op" id="4626820">=</span>&nbsp;<span class="num" id="4626822">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626834">init4_224</span>&nbsp;<span class="op" id="4626844">=</span>&nbsp;<span class="num" id="4626846">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626858">init5_224</span>&nbsp;<span class="op" id="4626868">=</span>&nbsp;<span class="num" id="4626870">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626882">init6_224</span>&nbsp;<span class="op" id="4626892">=</span>&nbsp;<span class="num" id="4626894">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626906">init7_224</span>&nbsp;<span class="op" id="4626916">=</span>&nbsp;<span class="num" id="4626918">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4626929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626932">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4626991">type</span>&nbsp;<span class="ident" id="4626996">digest</span>&nbsp;<span class="keyword" id="4627003">struct</span>&nbsp;<span class="op" id="4627010">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627013">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627019">[</span><span class="num" id="4627020">8</span><span class="op" id="4627021">]</span><span class="builtintype" id="4627022">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627030">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627036">[</span><span class="ident" id="4627037">chunk</span><span class="op" id="4627042">]</span><span class="builtintype" id="4627043">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627049">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4627055">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4627060">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4627066">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627074">is224</span>&nbsp;<span class="builtintype" id="4627080">bool</span>&nbsp;<span class="comment" id="4627085">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4627119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627122">func</span>&nbsp;<span class="op" id="4627127">(</span><span class="ident" id="4627128">d</span>&nbsp;<span class="op" id="4627130">*</span><span class="ident" id="4627131">digest</span><span class="op" id="4627137">)</span>&nbsp;<span class="ident" id="4627139">Reset</span><span class="op" id="4627144">(</span><span class="op" id="4627145">)</span>&nbsp;<span class="op" id="4627147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627150">if</span>&nbsp;<span class="op" id="4627153">!</span><span class="ident" id="4627154">d</span><span class="op" id="4627155">.</span><span class="ident" id="4627156">is224</span>&nbsp;<span class="op" id="4627162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627166">d</span><span class="op" id="4627167">.</span><span class="ident" id="4627168">h</span><span class="op" id="4627169">[</span><span class="num" id="4627170">0</span><span class="op" id="4627171">]</span>&nbsp;<span class="op" id="4627173">=</span>&nbsp;<span class="ident" id="4627175">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627183">d</span><span class="op" id="4627184">.</span><span class="ident" id="4627185">h</span><span class="op" id="4627186">[</span><span class="num" id="4627187">1</span><span class="op" id="4627188">]</span>&nbsp;<span class="op" id="4627190">=</span>&nbsp;<span class="ident" id="4627192">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627200">d</span><span class="op" id="4627201">.</span><span class="ident" id="4627202">h</span><span class="op" id="4627203">[</span><span class="num" id="4627204">2</span><span class="op" id="4627205">]</span>&nbsp;<span class="op" id="4627207">=</span>&nbsp;<span class="ident" id="4627209">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627217">d</span><span class="op" id="4627218">.</span><span class="ident" id="4627219">h</span><span class="op" id="4627220">[</span><span class="num" id="4627221">3</span><span class="op" id="4627222">]</span>&nbsp;<span class="op" id="4627224">=</span>&nbsp;<span class="ident" id="4627226">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627234">d</span><span class="op" id="4627235">.</span><span class="ident" id="4627236">h</span><span class="op" id="4627237">[</span><span class="num" id="4627238">4</span><span class="op" id="4627239">]</span>&nbsp;<span class="op" id="4627241">=</span>&nbsp;<span class="ident" id="4627243">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627251">d</span><span class="op" id="4627252">.</span><span class="ident" id="4627253">h</span><span class="op" id="4627254">[</span><span class="num" id="4627255">5</span><span class="op" id="4627256">]</span>&nbsp;<span class="op" id="4627258">=</span>&nbsp;<span class="ident" id="4627260">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627268">d</span><span class="op" id="4627269">.</span><span class="ident" id="4627270">h</span><span class="op" id="4627271">[</span><span class="num" id="4627272">6</span><span class="op" id="4627273">]</span>&nbsp;<span class="op" id="4627275">=</span>&nbsp;<span class="ident" id="4627277">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627285">d</span><span class="op" id="4627286">.</span><span class="ident" id="4627287">h</span><span class="op" id="4627288">[</span><span class="num" id="4627289">7</span><span class="op" id="4627290">]</span>&nbsp;<span class="op" id="4627292">=</span>&nbsp;<span class="ident" id="4627294">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627301">}</span>&nbsp;<span class="keyword" id="4627303">else</span>&nbsp;<span class="op" id="4627308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627312">d</span><span class="op" id="4627313">.</span><span class="ident" id="4627314">h</span><span class="op" id="4627315">[</span><span class="num" id="4627316">0</span><span class="op" id="4627317">]</span>&nbsp;<span class="op" id="4627319">=</span>&nbsp;<span class="ident" id="4627321">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627333">d</span><span class="op" id="4627334">.</span><span class="ident" id="4627335">h</span><span class="op" id="4627336">[</span><span class="num" id="4627337">1</span><span class="op" id="4627338">]</span>&nbsp;<span class="op" id="4627340">=</span>&nbsp;<span class="ident" id="4627342">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627354">d</span><span class="op" id="4627355">.</span><span class="ident" id="4627356">h</span><span class="op" id="4627357">[</span><span class="num" id="4627358">2</span><span class="op" id="4627359">]</span>&nbsp;<span class="op" id="4627361">=</span>&nbsp;<span class="ident" id="4627363">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627375">d</span><span class="op" id="4627376">.</span><span class="ident" id="4627377">h</span><span class="op" id="4627378">[</span><span class="num" id="4627379">3</span><span class="op" id="4627380">]</span>&nbsp;<span class="op" id="4627382">=</span>&nbsp;<span class="ident" id="4627384">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627396">d</span><span class="op" id="4627397">.</span><span class="ident" id="4627398">h</span><span class="op" id="4627399">[</span><span class="num" id="4627400">4</span><span class="op" id="4627401">]</span>&nbsp;<span class="op" id="4627403">=</span>&nbsp;<span class="ident" id="4627405">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627417">d</span><span class="op" id="4627418">.</span><span class="ident" id="4627419">h</span><span class="op" id="4627420">[</span><span class="num" id="4627421">5</span><span class="op" id="4627422">]</span>&nbsp;<span class="op" id="4627424">=</span>&nbsp;<span class="ident" id="4627426">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627438">d</span><span class="op" id="4627439">.</span><span class="ident" id="4627440">h</span><span class="op" id="4627441">[</span><span class="num" id="4627442">6</span><span class="op" id="4627443">]</span>&nbsp;<span class="op" id="4627445">=</span>&nbsp;<span class="ident" id="4627447">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627459">d</span><span class="op" id="4627460">.</span><span class="ident" id="4627461">h</span><span class="op" id="4627462">[</span><span class="num" id="4627463">7</span><span class="op" id="4627464">]</span>&nbsp;<span class="op" id="4627466">=</span>&nbsp;<span class="ident" id="4627468">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627482">d</span><span class="op" id="4627483">.</span><span class="ident" id="4627484">nx</span>&nbsp;<span class="op" id="4627487">=</span>&nbsp;<span class="num" id="4627489">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627492">d</span><span class="op" id="4627493">.</span><span class="builtinfunc" id="4627494">len</span>&nbsp;<span class="op" id="4627498">=</span>&nbsp;<span class="num" id="4627500">0</span><br>
<span class="lineno"></span><span class="op" id="4627502">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4627505">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4627567">func</span>&nbsp;<span class="ident" id="4627572">New</span><span class="op" id="4627575">(</span><span class="op" id="4627576">)</span>&nbsp;<span class="ident" id="4627578">hash</span><span class="op" id="4627582">.</span><span class="ident" id="4627583">Hash</span>&nbsp;<span class="op" id="4627588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627591">d</span>&nbsp;<span class="op" id="4627593">:=</span>&nbsp;<span class="builtinfunc" id="4627596">new</span><span class="op" id="4627599">(</span><span class="ident" id="4627600">digest</span><span class="op" id="4627606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627609">d</span><span class="op" id="4627610">.</span><span class="ident" id="4627611">Reset</span><span class="op" id="4627616">(</span><span class="op" id="4627617">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627620">return</span>&nbsp;<span class="ident" id="4627627">d</span><br>
<span class="lineno"></span><span class="op" id="4627629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4627632">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4627697">func</span>&nbsp;<span class="ident" id="4627702">New224</span><span class="op" id="4627708">(</span><span class="op" id="4627709">)</span>&nbsp;<span class="ident" id="4627711">hash</span><span class="op" id="4627715">.</span><span class="ident" id="4627716">Hash</span>&nbsp;<span class="op" id="4627721">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627724">d</span>&nbsp;<span class="op" id="4627726">:=</span>&nbsp;<span class="builtinfunc" id="4627729">new</span><span class="op" id="4627732">(</span><span class="ident" id="4627733">digest</span><span class="op" id="4627739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627742">d</span><span class="op" id="4627743">.</span><span class="ident" id="4627744">is224</span>&nbsp;<span class="op" id="4627750">=</span>&nbsp;<span class="builtintype" id="4627752">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627758">d</span><span class="op" id="4627759">.</span><span class="ident" id="4627760">Reset</span><span class="op" id="4627765">(</span><span class="op" id="4627766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627769">return</span>&nbsp;<span class="ident" id="4627776">d</span><br>
<span class="lineno"></span><span class="op" id="4627778">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4627781">func</span>&nbsp;<span class="op" id="4627786">(</span><span class="ident" id="4627787">d</span>&nbsp;<span class="op" id="4627789">*</span><span class="ident" id="4627790">digest</span><span class="op" id="4627796">)</span>&nbsp;<span class="ident" id="4627798">Size</span><span class="op" id="4627802">(</span><span class="op" id="4627803">)</span>&nbsp;<span class="builtintype" id="4627805">int</span>&nbsp;<span class="op" id="4627809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627812">if</span>&nbsp;<span class="op" id="4627815">!</span><span class="ident" id="4627816">d</span><span class="op" id="4627817">.</span><span class="ident" id="4627818">is224</span>&nbsp;<span class="op" id="4627824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627828">return</span>&nbsp;<span class="ident" id="4627835">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627841">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627844">return</span>&nbsp;<span class="ident" id="4627851">Size224</span><br>
<span class="lineno"></span><span class="op" id="4627859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627862">func</span>&nbsp;<span class="op" id="4627867">(</span><span class="ident" id="4627868">d</span>&nbsp;<span class="op" id="4627870">*</span><span class="ident" id="4627871">digest</span><span class="op" id="4627877">)</span>&nbsp;<span class="ident" id="4627879">BlockSize</span><span class="op" id="4627888">(</span><span class="op" id="4627889">)</span>&nbsp;<span class="builtintype" id="4627891">int</span>&nbsp;<span class="op" id="4627895">{</span>&nbsp;<span class="keyword" id="4627897">return</span>&nbsp;<span class="ident" id="4627904">BlockSize</span>&nbsp;<span class="op" id="4627914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4627917">func</span>&nbsp;<span class="op" id="4627922">(</span><span class="ident" id="4627923">d</span>&nbsp;<span class="op" id="4627925">*</span><span class="ident" id="4627926">digest</span><span class="op" id="4627932">)</span>&nbsp;<span class="ident" id="4627934">Write</span><span class="op" id="4627939">(</span><span class="ident" id="4627940">p</span>&nbsp;<span class="op" id="4627942">[</span><span class="op" id="4627943">]</span><span class="builtintype" id="4627944">byte</span><span class="op" id="4627948">)</span>&nbsp;<span class="op" id="4627950">(</span><span class="ident" id="4627951">nn</span>&nbsp;<span class="builtintype" id="4627954">int</span><span class="op" id="4627957">,</span>&nbsp;<span class="ident" id="4627959">err</span>&nbsp;<span class="builtintype" id="4627963">error</span><span class="op" id="4627968">)</span>&nbsp;<span class="op" id="4627970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627973">nn</span>&nbsp;<span class="op" id="4627976">=</span>&nbsp;<span class="builtinfunc" id="4627978">len</span><span class="op" id="4627981">(</span><span class="ident" id="4627982">p</span><span class="op" id="4627983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627986">d</span><span class="op" id="4627987">.</span><span class="builtinfunc" id="4627988">len</span>&nbsp;<span class="op" id="4627992">+=</span>&nbsp;<span class="builtintype" id="4627995">uint64</span><span class="op" id="4628001">(</span><span class="ident" id="4628002">nn</span><span class="op" id="4628004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628007">if</span>&nbsp;<span class="ident" id="4628010">d</span><span class="op" id="4628011">.</span><span class="ident" id="4628012">nx</span>&nbsp;<span class="op" id="4628015">&gt;</span>&nbsp;<span class="num" id="4628017">0</span>&nbsp;<span class="op" id="4628019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628023">n</span>&nbsp;<span class="op" id="4628025">:=</span>&nbsp;<span class="builtinfunc" id="4628028">copy</span><span class="op" id="4628032">(</span><span class="ident" id="4628033">d</span><span class="op" id="4628034">.</span><span class="ident" id="4628035">x</span><span class="op" id="4628036">[</span><span class="ident" id="4628037">d</span><span class="op" id="4628038">.</span><span class="ident" id="4628039">nx</span><span class="op" id="4628041">:</span><span class="op" id="4628042">]</span><span class="op" id="4628043">,</span>&nbsp;<span class="ident" id="4628045">p</span><span class="op" id="4628046">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628050">d</span><span class="op" id="4628051">.</span><span class="ident" id="4628052">nx</span>&nbsp;<span class="op" id="4628055">+=</span>&nbsp;<span class="ident" id="4628058">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628062">if</span>&nbsp;<span class="ident" id="4628065">d</span><span class="op" id="4628066">.</span><span class="ident" id="4628067">nx</span>&nbsp;<span class="op" id="4628070">==</span>&nbsp;<span class="ident" id="4628073">chunk</span>&nbsp;<span class="op" id="4628079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628084">block</span><span class="op" id="4628089">(</span><span class="ident" id="4628090">d</span><span class="op" id="4628091">,</span>&nbsp;<span class="ident" id="4628093">d</span><span class="op" id="4628094">.</span><span class="ident" id="4628095">x</span><span class="op" id="4628096">[</span><span class="op" id="4628097">:</span><span class="op" id="4628098">]</span><span class="op" id="4628099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628104">d</span><span class="op" id="4628105">.</span><span class="ident" id="4628106">nx</span>&nbsp;<span class="op" id="4628109">=</span>&nbsp;<span class="num" id="4628111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628115">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628119">p</span>&nbsp;<span class="op" id="4628121">=</span>&nbsp;<span class="ident" id="4628123">p</span><span class="op" id="4628124">[</span><span class="ident" id="4628125">n</span><span class="op" id="4628126">:</span><span class="op" id="4628127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628133">if</span>&nbsp;<span class="builtinfunc" id="4628136">len</span><span class="op" id="4628139">(</span><span class="ident" id="4628140">p</span><span class="op" id="4628141">)</span>&nbsp;<span class="op" id="4628143">&gt;=</span>&nbsp;<span class="ident" id="4628146">chunk</span>&nbsp;<span class="op" id="4628152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628156">n</span>&nbsp;<span class="op" id="4628158">:=</span>&nbsp;<span class="builtinfunc" id="4628161">len</span><span class="op" id="4628164">(</span><span class="ident" id="4628165">p</span><span class="op" id="4628166">)</span>&nbsp;<span class="op" id="4628168">&amp;^</span>&nbsp;<span class="op" id="4628171">(</span><span class="ident" id="4628172">chunk</span>&nbsp;<span class="op" id="4628178">-</span>&nbsp;<span class="num" id="4628180">1</span><span class="op" id="4628181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628185">block</span><span class="op" id="4628190">(</span><span class="ident" id="4628191">d</span><span class="op" id="4628192">,</span>&nbsp;<span class="ident" id="4628194">p</span><span class="op" id="4628195">[</span><span class="op" id="4628196">:</span><span class="ident" id="4628197">n</span><span class="op" id="4628198">]</span><span class="op" id="4628199">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628203">p</span>&nbsp;<span class="op" id="4628205">=</span>&nbsp;<span class="ident" id="4628207">p</span><span class="op" id="4628208">[</span><span class="ident" id="4628209">n</span><span class="op" id="4628210">:</span><span class="op" id="4628211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628217">if</span>&nbsp;<span class="builtinfunc" id="4628220">len</span><span class="op" id="4628223">(</span><span class="ident" id="4628224">p</span><span class="op" id="4628225">)</span>&nbsp;<span class="op" id="4628227">&gt;</span>&nbsp;<span class="num" id="4628229">0</span>&nbsp;<span class="op" id="4628231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628235">d</span><span class="op" id="4628236">.</span><span class="ident" id="4628237">nx</span>&nbsp;<span class="op" id="4628240">=</span>&nbsp;<span class="builtinfunc" id="4628242">copy</span><span class="op" id="4628246">(</span><span class="ident" id="4628247">d</span><span class="op" id="4628248">.</span><span class="ident" id="4628249">x</span><span class="op" id="4628250">[</span><span class="op" id="4628251">:</span><span class="op" id="4628252">]</span><span class="op" id="4628253">,</span>&nbsp;<span class="ident" id="4628255">p</span><span class="op" id="4628256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628259">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628262">return</span><br>
<span class="lineno"></span><span class="op" id="4628269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4628272">func</span>&nbsp;<span class="op" id="4628277">(</span><span class="ident" id="4628278">d0</span>&nbsp;<span class="op" id="4628281">*</span><span class="ident" id="4628282">digest</span><span class="op" id="4628288">)</span>&nbsp;<span class="ident" id="4628290">Sum</span><span class="op" id="4628293">(</span><span class="ident" id="4628294">in</span>&nbsp;<span class="op" id="4628297">[</span><span class="op" id="4628298">]</span><span class="builtintype" id="4628299">byte</span><span class="op" id="4628303">)</span>&nbsp;<span class="op" id="4628305">[</span><span class="op" id="4628306">]</span><span class="builtintype" id="4628307">byte</span>&nbsp;<span class="op" id="4628312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628315">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628382">d</span>&nbsp;<span class="op" id="4628384">:=</span>&nbsp;<span class="op" id="4628387">*</span><span class="ident" id="4628388">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628392">hash</span>&nbsp;<span class="op" id="4628397">:=</span>&nbsp;<span class="ident" id="4628400">d</span><span class="op" id="4628401">.</span><span class="ident" id="4628402">checkSum</span><span class="op" id="4628410">(</span><span class="op" id="4628411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628414">if</span>&nbsp;<span class="ident" id="4628417">d</span><span class="op" id="4628418">.</span><span class="ident" id="4628419">is224</span>&nbsp;<span class="op" id="4628425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628429">return</span>&nbsp;<span class="builtinfunc" id="4628436">append</span><span class="op" id="4628442">(</span><span class="ident" id="4628443">in</span><span class="op" id="4628445">,</span>&nbsp;<span class="ident" id="4628447">hash</span><span class="op" id="4628451">[</span><span class="op" id="4628452">:</span><span class="ident" id="4628453">Size224</span><span class="op" id="4628460">]</span><span class="op" id="4628461">...</span><span class="op" id="4628464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628467">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628470">return</span>&nbsp;<span class="builtinfunc" id="4628477">append</span><span class="op" id="4628483">(</span><span class="ident" id="4628484">in</span><span class="op" id="4628486">,</span>&nbsp;<span class="ident" id="4628488">hash</span><span class="op" id="4628492">[</span><span class="op" id="4628493">:</span><span class="op" id="4628494">]</span><span class="op" id="4628495">...</span><span class="op" id="4628498">)</span><br>
<span class="lineno"></span><span class="op" id="4628500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4628503">func</span>&nbsp;<span class="op" id="4628508">(</span><span class="ident" id="4628509">d</span>&nbsp;<span class="op" id="4628511">*</span><span class="ident" id="4628512">digest</span><span class="op" id="4628518">)</span>&nbsp;<span class="ident" id="4628520">checkSum</span><span class="op" id="4628528">(</span><span class="op" id="4628529">)</span>&nbsp;<span class="op" id="4628531">[</span><span class="ident" id="4628532">Size</span><span class="op" id="4628536">]</span><span class="builtintype" id="4628537">byte</span>&nbsp;<span class="op" id="4628542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4628545">len</span>&nbsp;<span class="op" id="4628549">:=</span>&nbsp;<span class="ident" id="4628552">d</span><span class="op" id="4628553">.</span><span class="builtinfunc" id="4628554">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628559">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628619">var</span>&nbsp;<span class="ident" id="4628623">tmp</span>&nbsp;<span class="op" id="4628627">[</span><span class="num" id="4628628">64</span><span class="op" id="4628630">]</span><span class="builtintype" id="4628631">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628637">tmp</span><span class="op" id="4628640">[</span><span class="num" id="4628641">0</span><span class="op" id="4628642">]</span>&nbsp;<span class="op" id="4628644">=</span>&nbsp;<span class="num" id="4628646">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628652">if</span>&nbsp;<span class="builtinfunc" id="4628655">len</span><span class="op" id="4628658">%</span><span class="num" id="4628659">64</span>&nbsp;<span class="op" id="4628662">&lt;</span>&nbsp;<span class="num" id="4628664">56</span>&nbsp;<span class="op" id="4628667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628671">d</span><span class="op" id="4628672">.</span><span class="ident" id="4628673">Write</span><span class="op" id="4628678">(</span><span class="ident" id="4628679">tmp</span><span class="op" id="4628682">[</span><span class="num" id="4628683">0</span>&nbsp;<span class="op" id="4628685">:</span>&nbsp;<span class="num" id="4628687">56</span><span class="op" id="4628689">-</span><span class="builtinfunc" id="4628690">len</span><span class="op" id="4628693">%</span><span class="num" id="4628694">64</span><span class="op" id="4628696">]</span><span class="op" id="4628697">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628700">}</span>&nbsp;<span class="keyword" id="4628702">else</span>&nbsp;<span class="op" id="4628707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628711">d</span><span class="op" id="4628712">.</span><span class="ident" id="4628713">Write</span><span class="op" id="4628718">(</span><span class="ident" id="4628719">tmp</span><span class="op" id="4628722">[</span><span class="num" id="4628723">0</span>&nbsp;<span class="op" id="4628725">:</span>&nbsp;<span class="num" id="4628727">64</span><span class="op" id="4628729">+</span><span class="num" id="4628730">56</span><span class="op" id="4628732">-</span><span class="builtinfunc" id="4628733">len</span><span class="op" id="4628736">%</span><span class="num" id="4628737">64</span><span class="op" id="4628739">]</span><span class="op" id="4628740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628747">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4628767">len</span>&nbsp;<span class="op" id="4628771">&lt;&lt;=</span>&nbsp;<span class="num" id="4628775">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628778">for</span>&nbsp;<span class="ident" id="4628782">i</span>&nbsp;<span class="op" id="4628784">:=</span>&nbsp;<span class="builtintype" id="4628787">uint</span><span class="op" id="4628791">(</span><span class="num" id="4628792">0</span><span class="op" id="4628793">)</span><span class="op" id="4628794">;</span>&nbsp;<span class="ident" id="4628796">i</span>&nbsp;<span class="op" id="4628798">&lt;</span>&nbsp;<span class="num" id="4628800">8</span><span class="op" id="4628801">;</span>&nbsp;<span class="ident" id="4628803">i</span><span class="op" id="4628804">++</span>&nbsp;<span class="op" id="4628807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628811">tmp</span><span class="op" id="4628814">[</span><span class="ident" id="4628815">i</span><span class="op" id="4628816">]</span>&nbsp;<span class="op" id="4628818">=</span>&nbsp;<span class="builtintype" id="4628820">byte</span><span class="op" id="4628824">(</span><span class="builtinfunc" id="4628825">len</span>&nbsp;<span class="op" id="4628829">&gt;&gt;</span>&nbsp;<span class="op" id="4628832">(</span><span class="num" id="4628833">56</span>&nbsp;<span class="op" id="4628836">-</span>&nbsp;<span class="num" id="4628838">8</span><span class="op" id="4628839">*</span><span class="ident" id="4628840">i</span><span class="op" id="4628841">)</span><span class="op" id="4628842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628848">d</span><span class="op" id="4628849">.</span><span class="ident" id="4628850">Write</span><span class="op" id="4628855">(</span><span class="ident" id="4628856">tmp</span><span class="op" id="4628859">[</span><span class="num" id="4628860">0</span><span class="op" id="4628861">:</span><span class="num" id="4628862">8</span><span class="op" id="4628863">]</span><span class="op" id="4628864">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628868">if</span>&nbsp;<span class="ident" id="4628871">d</span><span class="op" id="4628872">.</span><span class="ident" id="4628873">nx</span>&nbsp;<span class="op" id="4628876">!=</span>&nbsp;<span class="num" id="4628879">0</span>&nbsp;<span class="op" id="4628881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4628885">panic</span><span class="op" id="4628890">(</span><span class="string" id="4628891">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4628902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628909">h</span>&nbsp;<span class="op" id="4628911">:=</span>&nbsp;<span class="ident" id="4628914">d</span><span class="op" id="4628915">.</span><span class="ident" id="4628916">h</span><span class="op" id="4628917">[</span><span class="op" id="4628918">:</span><span class="op" id="4628919">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628922">if</span>&nbsp;<span class="ident" id="4628925">d</span><span class="op" id="4628926">.</span><span class="ident" id="4628927">is224</span>&nbsp;<span class="op" id="4628933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628937">h</span>&nbsp;<span class="op" id="4628939">=</span>&nbsp;<span class="ident" id="4628941">d</span><span class="op" id="4628942">.</span><span class="ident" id="4628943">h</span><span class="op" id="4628944">[</span><span class="op" id="4628945">:</span><span class="num" id="4628946">7</span><span class="op" id="4628947">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628954">var</span>&nbsp;<span class="ident" id="4628958">digest</span>&nbsp;<span class="op" id="4628965">[</span><span class="ident" id="4628966">Size</span><span class="op" id="4628970">]</span><span class="builtintype" id="4628971">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628977">for</span>&nbsp;<span class="ident" id="4628981">i</span><span class="op" id="4628982">,</span>&nbsp;<span class="ident" id="4628984">s</span>&nbsp;<span class="op" id="4628986">:=</span>&nbsp;<span class="keyword" id="4628989">range</span>&nbsp;<span class="ident" id="4628995">h</span>&nbsp;<span class="op" id="4628997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629001">digest</span><span class="op" id="4629007">[</span><span class="ident" id="4629008">i</span><span class="op" id="4629009">*</span><span class="num" id="4629010">4</span><span class="op" id="4629011">]</span>&nbsp;<span class="op" id="4629013">=</span>&nbsp;<span class="builtintype" id="4629015">byte</span><span class="op" id="4629019">(</span><span class="ident" id="4629020">s</span>&nbsp;<span class="op" id="4629022">&gt;&gt;</span>&nbsp;<span class="num" id="4629025">24</span><span class="op" id="4629027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629031">digest</span><span class="op" id="4629037">[</span><span class="ident" id="4629038">i</span><span class="op" id="4629039">*</span><span class="num" id="4629040">4</span><span class="op" id="4629041">+</span><span class="num" id="4629042">1</span><span class="op" id="4629043">]</span>&nbsp;<span class="op" id="4629045">=</span>&nbsp;<span class="builtintype" id="4629047">byte</span><span class="op" id="4629051">(</span><span class="ident" id="4629052">s</span>&nbsp;<span class="op" id="4629054">&gt;&gt;</span>&nbsp;<span class="num" id="4629057">16</span><span class="op" id="4629059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629063">digest</span><span class="op" id="4629069">[</span><span class="ident" id="4629070">i</span><span class="op" id="4629071">*</span><span class="num" id="4629072">4</span><span class="op" id="4629073">+</span><span class="num" id="4629074">2</span><span class="op" id="4629075">]</span>&nbsp;<span class="op" id="4629077">=</span>&nbsp;<span class="builtintype" id="4629079">byte</span><span class="op" id="4629083">(</span><span class="ident" id="4629084">s</span>&nbsp;<span class="op" id="4629086">&gt;&gt;</span>&nbsp;<span class="num" id="4629089">8</span><span class="op" id="4629090">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629094">digest</span><span class="op" id="4629100">[</span><span class="ident" id="4629101">i</span><span class="op" id="4629102">*</span><span class="num" id="4629103">4</span><span class="op" id="4629104">+</span><span class="num" id="4629105">3</span><span class="op" id="4629106">]</span>&nbsp;<span class="op" id="4629108">=</span>&nbsp;<span class="builtintype" id="4629110">byte</span><span class="op" id="4629114">(</span><span class="ident" id="4629115">s</span><span class="op" id="4629116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629123">return</span>&nbsp;<span class="ident" id="4629130">digest</span><br>
<span class="lineno"></span><span class="op" id="4629137">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4629140">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4629191">func</span>&nbsp;<span class="ident" id="4629196">Sum256</span><span class="op" id="4629202">(</span><span class="ident" id="4629203">data</span>&nbsp;<span class="op" id="4629208">[</span><span class="op" id="4629209">]</span><span class="builtintype" id="4629210">byte</span><span class="op" id="4629214">)</span>&nbsp;<span class="op" id="4629216">[</span><span class="ident" id="4629217">Size</span><span class="op" id="4629221">]</span><span class="builtintype" id="4629222">byte</span>&nbsp;<span class="op" id="4629227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629230">var</span>&nbsp;<span class="ident" id="4629234">d</span>&nbsp;<span class="ident" id="4629236">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629244">d</span><span class="op" id="4629245">.</span><span class="ident" id="4629246">Reset</span><span class="op" id="4629251">(</span><span class="op" id="4629252">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629255">d</span><span class="op" id="4629256">.</span><span class="ident" id="4629257">Write</span><span class="op" id="4629262">(</span><span class="ident" id="4629263">data</span><span class="op" id="4629267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629270">return</span>&nbsp;<span class="ident" id="4629277">d</span><span class="op" id="4629278">.</span><span class="ident" id="4629279">checkSum</span><span class="op" id="4629287">(</span><span class="op" id="4629288">)</span><br>
<span class="lineno"></span><span class="op" id="4629290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4629293">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4629344">func</span>&nbsp;<span class="ident" id="4629349">Sum224</span><span class="op" id="4629355">(</span><span class="ident" id="4629356">data</span>&nbsp;<span class="op" id="4629361">[</span><span class="op" id="4629362">]</span><span class="builtintype" id="4629363">byte</span><span class="op" id="4629367">)</span>&nbsp;<span class="op" id="4629369">(</span><span class="ident" id="4629370">sum224</span>&nbsp;<span class="op" id="4629377">[</span><span class="ident" id="4629378">Size224</span><span class="op" id="4629385">]</span><span class="builtintype" id="4629386">byte</span><span class="op" id="4629390">)</span>&nbsp;<span class="op" id="4629392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629395">var</span>&nbsp;<span class="ident" id="4629399">d</span>&nbsp;<span class="ident" id="4629401">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629409">d</span><span class="op" id="4629410">.</span><span class="ident" id="4629411">is224</span>&nbsp;<span class="op" id="4629417">=</span>&nbsp;<span class="builtintype" id="4629419">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629425">d</span><span class="op" id="4629426">.</span><span class="ident" id="4629427">Reset</span><span class="op" id="4629432">(</span><span class="op" id="4629433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629436">d</span><span class="op" id="4629437">.</span><span class="ident" id="4629438">Write</span><span class="op" id="4629443">(</span><span class="ident" id="4629444">data</span><span class="op" id="4629448">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629451">sum</span>&nbsp;<span class="op" id="4629455">:=</span>&nbsp;<span class="ident" id="4629458">d</span><span class="op" id="4629459">.</span><span class="ident" id="4629460">checkSum</span><span class="op" id="4629468">(</span><span class="op" id="4629469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4629472">copy</span><span class="op" id="4629476">(</span><span class="ident" id="4629477">sum224</span><span class="op" id="4629483">[</span><span class="op" id="4629484">:</span><span class="op" id="4629485">]</span><span class="op" id="4629486">,</span>&nbsp;<span class="ident" id="4629488">sum</span><span class="op" id="4629491">[</span><span class="op" id="4629492">:</span><span class="ident" id="4629493">Size224</span><span class="op" id="4629500">]</span><span class="op" id="4629501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629504">return</span><br>
<span class="lineno"></span><span class="op" id="4629511">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
