<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2163150">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2163205">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2163259">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2163310">package</span>&nbsp;<span class="ident" id="2163318">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2163324">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2163364">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2163424">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2163488">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2163546">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2163604">//</span><br>
<span class="lineno"></span><span class="comment" id="2163607">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2163621">//</span><br>
<span class="lineno"></span><span class="comment" id="2163624">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2163646">//</span><br>
<span class="lineno">20</span><span class="comment" id="2163649">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2163662">//</span><br>
<span class="lineno"></span><span class="comment" id="2163665">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2163688">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2163705">//</span><br>
<span class="lineno">25</span><span class="comment" id="2163708">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2163724">//</span><br>
<span class="lineno"></span><span class="comment" id="2163727">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2163804">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2163874">//</span><br>
<span class="lineno">30</span><span class="comment" id="2163877">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2163933">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2163983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2164011">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2164065">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2164093">//</span><br>
<span class="lineno"></span><span class="comment" id="2164096">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2164109">//</span><br>
<span class="lineno"></span><span class="comment" id="2164112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2164152">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2164211">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2164272">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2164333">//</span><br>
<span class="lineno"></span><span class="comment" id="2164336">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2164414">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2164490">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2164532">//</span><br>
<span class="lineno"></span><span class="comment" id="2164535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2164549">//</span><br>
<span class="lineno"></span><span class="comment" id="2164552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2164576">//</span><br>
<span class="lineno"></span><span class="comment" id="2164579">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2164592">//</span><br>
<span class="lineno"></span><span class="comment" id="2164595">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2164618">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2164635">//</span><br>
<span class="lineno"></span><span class="comment" id="2164638">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2164654">//</span><br>
<span class="lineno"></span><span class="comment" id="2164657">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2164734">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2164804">//</span><br>
<span class="lineno"></span><span class="comment" id="2164807">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2164863">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2164915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2164943">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2164995">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2165023">//</span><br>
<span class="lineno"></span><span class="comment" id="2165026">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2165039">//</span><br>
<span class="lineno"></span><span class="comment" id="2165042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2165082">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2165141">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2165202">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2165263">//</span><br>
<span class="lineno"></span><span class="comment" id="2165266">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2165314">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2165378">//</span><br>
<span class="lineno"></span><span class="comment" id="2165381">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2165442">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2165512">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2165587">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2165654">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2165727">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2165799">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2165813">//</span><br>
<span class="lineno">85</span><span class="comment" id="2165816">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2165882">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2165948">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2165961">//</span><br>
<span class="lineno"></span><span class="comment" id="2165964">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2165988">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166018">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2166038">var</span>&nbsp;<span class="ident" id="2166042">_sin</span>&nbsp;<span class="op" id="2166047">=</span>&nbsp;<span class="op" id="2166049">[</span><span class="op" id="2166050">...</span><span class="op" id="2166053">]</span><span class="builtintype" id="2166054">float64</span><span class="op" id="2166061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166064">1.58962301576546568060E-10</span><span class="op" id="2166090">,</span>&nbsp;<span class="comment" id="2166092">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166115">-</span><span class="num" id="2166116">2.50507477628578072866E-8</span><span class="op" id="2166141">,</span>&nbsp;<span class="comment" id="2166143">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166166">2.75573136213857245213E-6</span><span class="op" id="2166191">,</span>&nbsp;&nbsp;<span class="comment" id="2166194">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166217">-</span><span class="num" id="2166218">1.98412698295895385996E-4</span><span class="op" id="2166243">,</span>&nbsp;<span class="comment" id="2166245">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166268">8.33333333332211858878E-3</span><span class="op" id="2166293">,</span>&nbsp;&nbsp;<span class="comment" id="2166296">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166319">-</span><span class="num" id="2166320">1.66666666666666307295E-1</span><span class="op" id="2166345">,</span>&nbsp;<span class="comment" id="2166347">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2166369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166372">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2166392">var</span>&nbsp;<span class="ident" id="2166396">_cos</span>&nbsp;<span class="op" id="2166401">=</span>&nbsp;<span class="op" id="2166403">[</span><span class="op" id="2166404">...</span><span class="op" id="2166407">]</span><span class="builtintype" id="2166408">float64</span><span class="op" id="2166415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166418">-</span><span class="num" id="2166419">1.13585365213876817300E-11</span><span class="op" id="2166445">,</span>&nbsp;<span class="comment" id="2166447">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166470">2.08757008419747316778E-9</span><span class="op" id="2166495">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2166499">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166522">-</span><span class="num" id="2166523">2.75573141792967388112E-7</span><span class="op" id="2166548">,</span>&nbsp;&nbsp;<span class="comment" id="2166551">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166574">2.48015872888517045348E-5</span><span class="op" id="2166599">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2166603">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166626">-</span><span class="num" id="2166627">1.38888888888730564116E-3</span><span class="op" id="2166652">,</span>&nbsp;&nbsp;<span class="comment" id="2166655">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2166678">4.16666666666665929218E-2</span><span class="op" id="2166703">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2166707">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2166729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166732">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2166784">//</span><br>
<span class="lineno"></span><span class="comment" id="2166787">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2166809">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2166829">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2166847">func</span>&nbsp;<span class="ident" id="2166852">Cos</span><span class="op" id="2166855">(</span><span class="ident" id="2166856">x</span>&nbsp;<span class="builtintype" id="2166858">float64</span><span class="op" id="2166865">)</span>&nbsp;<span class="builtintype" id="2166867">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2166876">func</span>&nbsp;<span class="ident" id="2166881">cos</span><span class="op" id="2166884">(</span><span class="ident" id="2166885">x</span>&nbsp;<span class="builtintype" id="2166887">float64</span><span class="op" id="2166894">)</span>&nbsp;<span class="builtintype" id="2166896">float64</span>&nbsp;<span class="op" id="2166904">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166907">const</span>&nbsp;<span class="op" id="2166913">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166917">PI4A</span>&nbsp;<span class="op" id="2166922">=</span>&nbsp;<span class="num" id="2166924">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2166978">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167031">PI4B</span>&nbsp;<span class="op" id="2167036">=</span>&nbsp;<span class="num" id="2167038">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2167092">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167117">PI4C</span>&nbsp;<span class="op" id="2167122">=</span>&nbsp;<span class="num" id="2167124">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2167178">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167203">M4PI</span>&nbsp;<span class="op" id="2167208">=</span>&nbsp;<span class="num" id="2167210">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2167264">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167276">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167294">switch</span>&nbsp;<span class="op" id="2167301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167304">case</span>&nbsp;<span class="ident" id="2167309">IsNaN</span><span class="op" id="2167314">(</span><span class="ident" id="2167315">x</span><span class="op" id="2167316">)</span>&nbsp;<span class="op" id="2167318">||</span>&nbsp;<span class="ident" id="2167321">IsInf</span><span class="op" id="2167326">(</span><span class="ident" id="2167327">x</span><span class="op" id="2167328">,</span>&nbsp;<span class="num" id="2167330">0</span><span class="op" id="2167331">)</span><span class="op" id="2167332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167336">return</span>&nbsp;<span class="ident" id="2167343">NaN</span><span class="op" id="2167346">(</span><span class="op" id="2167347">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167354">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167381">sign</span>&nbsp;<span class="op" id="2167386">:=</span>&nbsp;<span class="builtintype" id="2167389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167396">if</span>&nbsp;<span class="ident" id="2167399">x</span>&nbsp;<span class="op" id="2167401">&lt;</span>&nbsp;<span class="num" id="2167403">0</span>&nbsp;<span class="op" id="2167405">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167409">x</span>&nbsp;<span class="op" id="2167411">=</span>&nbsp;<span class="op" id="2167413">-</span><span class="ident" id="2167414">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167421">j</span>&nbsp;<span class="op" id="2167423">:=</span>&nbsp;<span class="ident" id="2167426">int64</span><span class="op" id="2167431">(</span><span class="ident" id="2167432">x</span>&nbsp;<span class="op" id="2167434">*</span>&nbsp;<span class="ident" id="2167436">M4PI</span><span class="op" id="2167440">)</span>&nbsp;<span class="comment" id="2167442">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167512">y</span>&nbsp;<span class="op" id="2167514">:=</span>&nbsp;<span class="builtintype" id="2167517">float64</span><span class="op" id="2167524">(</span><span class="ident" id="2167525">j</span><span class="op" id="2167526">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2167533">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167573">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167597">if</span>&nbsp;<span class="ident" id="2167600">j</span><span class="op" id="2167601">&amp;</span><span class="num" id="2167602">1</span>&nbsp;<span class="op" id="2167604">==</span>&nbsp;<span class="num" id="2167607">1</span>&nbsp;<span class="op" id="2167609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167613">j</span>&nbsp;<span class="op" id="2167615">+=</span>&nbsp;<span class="num" id="2167618">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167622">y</span>&nbsp;<span class="op" id="2167624">+=</span>&nbsp;<span class="num" id="2167627">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167633">j</span>&nbsp;<span class="op" id="2167635">&amp;=</span>&nbsp;<span class="num" id="2167638">7</span>&nbsp;<span class="comment" id="2167640">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167684">if</span>&nbsp;<span class="ident" id="2167687">j</span>&nbsp;<span class="op" id="2167689">&gt;</span>&nbsp;<span class="num" id="2167691">3</span>&nbsp;<span class="op" id="2167693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167697">j</span>&nbsp;<span class="op" id="2167699">-=</span>&nbsp;<span class="num" id="2167702">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167706">sign</span>&nbsp;<span class="op" id="2167711">=</span>&nbsp;<span class="op" id="2167713">!</span><span class="ident" id="2167714">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167723">if</span>&nbsp;<span class="ident" id="2167726">j</span>&nbsp;<span class="op" id="2167728">&gt;</span>&nbsp;<span class="num" id="2167730">1</span>&nbsp;<span class="op" id="2167732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167736">sign</span>&nbsp;<span class="op" id="2167741">=</span>&nbsp;<span class="op" id="2167743">!</span><span class="ident" id="2167744">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167754">z</span>&nbsp;<span class="op" id="2167756">:=</span>&nbsp;<span class="op" id="2167759">(</span><span class="op" id="2167760">(</span><span class="ident" id="2167761">x</span>&nbsp;<span class="op" id="2167763">-</span>&nbsp;<span class="ident" id="2167765">y</span><span class="op" id="2167766">*</span><span class="ident" id="2167767">PI4A</span><span class="op" id="2167771">)</span>&nbsp;<span class="op" id="2167773">-</span>&nbsp;<span class="ident" id="2167775">y</span><span class="op" id="2167776">*</span><span class="ident" id="2167777">PI4B</span><span class="op" id="2167781">)</span>&nbsp;<span class="op" id="2167783">-</span>&nbsp;<span class="ident" id="2167785">y</span><span class="op" id="2167786">*</span><span class="ident" id="2167787">PI4C</span>&nbsp;<span class="comment" id="2167792">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167834">zz</span>&nbsp;<span class="op" id="2167837">:=</span>&nbsp;<span class="ident" id="2167840">z</span>&nbsp;<span class="op" id="2167842">*</span>&nbsp;<span class="ident" id="2167844">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167847">if</span>&nbsp;<span class="ident" id="2167850">j</span>&nbsp;<span class="op" id="2167852">==</span>&nbsp;<span class="num" id="2167855">1</span>&nbsp;<span class="op" id="2167857">||</span>&nbsp;<span class="ident" id="2167860">j</span>&nbsp;<span class="op" id="2167862">==</span>&nbsp;<span class="num" id="2167865">2</span>&nbsp;<span class="op" id="2167867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167871">y</span>&nbsp;<span class="op" id="2167873">=</span>&nbsp;<span class="ident" id="2167875">z</span>&nbsp;<span class="op" id="2167877">+</span>&nbsp;<span class="ident" id="2167879">z</span><span class="op" id="2167880">*</span><span class="ident" id="2167881">zz</span><span class="op" id="2167883">*</span><span class="op" id="2167884">(</span><span class="op" id="2167885">(</span><span class="op" id="2167886">(</span><span class="op" id="2167887">(</span><span class="op" id="2167888">(</span><span class="op" id="2167889">(</span><span class="ident" id="2167890">_sin</span><span class="op" id="2167894">[</span><span class="num" id="2167895">0</span><span class="op" id="2167896">]</span><span class="op" id="2167897">*</span><span class="ident" id="2167898">zz</span><span class="op" id="2167900">)</span><span class="op" id="2167901">+</span><span class="ident" id="2167902">_sin</span><span class="op" id="2167906">[</span><span class="num" id="2167907">1</span><span class="op" id="2167908">]</span><span class="op" id="2167909">)</span><span class="op" id="2167910">*</span><span class="ident" id="2167911">zz</span><span class="op" id="2167913">+</span><span class="ident" id="2167914">_sin</span><span class="op" id="2167918">[</span><span class="num" id="2167919">2</span><span class="op" id="2167920">]</span><span class="op" id="2167921">)</span><span class="op" id="2167922">*</span><span class="ident" id="2167923">zz</span><span class="op" id="2167925">+</span><span class="ident" id="2167926">_sin</span><span class="op" id="2167930">[</span><span class="num" id="2167931">3</span><span class="op" id="2167932">]</span><span class="op" id="2167933">)</span><span class="op" id="2167934">*</span><span class="ident" id="2167935">zz</span><span class="op" id="2167937">+</span><span class="ident" id="2167938">_sin</span><span class="op" id="2167942">[</span><span class="num" id="2167943">4</span><span class="op" id="2167944">]</span><span class="op" id="2167945">)</span><span class="op" id="2167946">*</span><span class="ident" id="2167947">zz</span><span class="op" id="2167949">+</span><span class="ident" id="2167950">_sin</span><span class="op" id="2167954">[</span><span class="num" id="2167955">5</span><span class="op" id="2167956">]</span><span class="op" id="2167957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167960">}</span>&nbsp;<span class="keyword" id="2167962">else</span>&nbsp;<span class="op" id="2167967">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167971">y</span>&nbsp;<span class="op" id="2167973">=</span>&nbsp;<span class="num" id="2167975">1.0</span>&nbsp;<span class="op" id="2167979">-</span>&nbsp;<span class="num" id="2167981">0.5</span><span class="op" id="2167984">*</span><span class="ident" id="2167985">zz</span>&nbsp;<span class="op" id="2167988">+</span>&nbsp;<span class="ident" id="2167990">zz</span><span class="op" id="2167992">*</span><span class="ident" id="2167993">zz</span><span class="op" id="2167995">*</span><span class="op" id="2167996">(</span><span class="op" id="2167997">(</span><span class="op" id="2167998">(</span><span class="op" id="2167999">(</span><span class="op" id="2168000">(</span><span class="op" id="2168001">(</span><span class="ident" id="2168002">_cos</span><span class="op" id="2168006">[</span><span class="num" id="2168007">0</span><span class="op" id="2168008">]</span><span class="op" id="2168009">*</span><span class="ident" id="2168010">zz</span><span class="op" id="2168012">)</span><span class="op" id="2168013">+</span><span class="ident" id="2168014">_cos</span><span class="op" id="2168018">[</span><span class="num" id="2168019">1</span><span class="op" id="2168020">]</span><span class="op" id="2168021">)</span><span class="op" id="2168022">*</span><span class="ident" id="2168023">zz</span><span class="op" id="2168025">+</span><span class="ident" id="2168026">_cos</span><span class="op" id="2168030">[</span><span class="num" id="2168031">2</span><span class="op" id="2168032">]</span><span class="op" id="2168033">)</span><span class="op" id="2168034">*</span><span class="ident" id="2168035">zz</span><span class="op" id="2168037">+</span><span class="ident" id="2168038">_cos</span><span class="op" id="2168042">[</span><span class="num" id="2168043">3</span><span class="op" id="2168044">]</span><span class="op" id="2168045">)</span><span class="op" id="2168046">*</span><span class="ident" id="2168047">zz</span><span class="op" id="2168049">+</span><span class="ident" id="2168050">_cos</span><span class="op" id="2168054">[</span><span class="num" id="2168055">4</span><span class="op" id="2168056">]</span><span class="op" id="2168057">)</span><span class="op" id="2168058">*</span><span class="ident" id="2168059">zz</span><span class="op" id="2168061">+</span><span class="ident" id="2168062">_cos</span><span class="op" id="2168066">[</span><span class="num" id="2168067">5</span><span class="op" id="2168068">]</span><span class="op" id="2168069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168075">if</span>&nbsp;<span class="ident" id="2168078">sign</span>&nbsp;<span class="op" id="2168083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168087">y</span>&nbsp;<span class="op" id="2168089">=</span>&nbsp;<span class="op" id="2168091">-</span><span class="ident" id="2168092">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168095">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168098">return</span>&nbsp;<span class="ident" id="2168105">y</span><br>
<span class="lineno"></span><span class="op" id="2168107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2168110">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2168160">//</span><br>
<span class="lineno">170</span><span class="comment" id="2168163">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2168185">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2168203">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2168223">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2168241">func</span>&nbsp;<span class="ident" id="2168246">Sin</span><span class="op" id="2168249">(</span><span class="ident" id="2168250">x</span>&nbsp;<span class="builtintype" id="2168252">float64</span><span class="op" id="2168259">)</span>&nbsp;<span class="builtintype" id="2168261">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2168270">func</span>&nbsp;<span class="ident" id="2168275">sin</span><span class="op" id="2168278">(</span><span class="ident" id="2168279">x</span>&nbsp;<span class="builtintype" id="2168281">float64</span><span class="op" id="2168288">)</span>&nbsp;<span class="builtintype" id="2168290">float64</span>&nbsp;<span class="op" id="2168298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168301">const</span>&nbsp;<span class="op" id="2168307">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168311">PI4A</span>&nbsp;<span class="op" id="2168316">=</span>&nbsp;<span class="num" id="2168318">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2168372">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168425">PI4B</span>&nbsp;<span class="op" id="2168430">=</span>&nbsp;<span class="num" id="2168432">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2168486">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168511">PI4C</span>&nbsp;<span class="op" id="2168516">=</span>&nbsp;<span class="num" id="2168518">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2168572">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168597">M4PI</span>&nbsp;<span class="op" id="2168602">=</span>&nbsp;<span class="num" id="2168604">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2168658">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168670">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168688">switch</span>&nbsp;<span class="op" id="2168695">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168698">case</span>&nbsp;<span class="ident" id="2168703">x</span>&nbsp;<span class="op" id="2168705">==</span>&nbsp;<span class="num" id="2168708">0</span>&nbsp;<span class="op" id="2168710">||</span>&nbsp;<span class="ident" id="2168713">IsNaN</span><span class="op" id="2168718">(</span><span class="ident" id="2168719">x</span><span class="op" id="2168720">)</span><span class="op" id="2168721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168725">return</span>&nbsp;<span class="ident" id="2168732">x</span>&nbsp;<span class="comment" id="2168734">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168758">case</span>&nbsp;<span class="ident" id="2168763">IsInf</span><span class="op" id="2168768">(</span><span class="ident" id="2168769">x</span><span class="op" id="2168770">,</span>&nbsp;<span class="num" id="2168772">0</span><span class="op" id="2168773">)</span><span class="op" id="2168774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168778">return</span>&nbsp;<span class="ident" id="2168785">NaN</span><span class="op" id="2168788">(</span><span class="op" id="2168789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168792">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168796">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168841">sign</span>&nbsp;<span class="op" id="2168846">:=</span>&nbsp;<span class="builtintype" id="2168849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168856">if</span>&nbsp;<span class="ident" id="2168859">x</span>&nbsp;<span class="op" id="2168861">&lt;</span>&nbsp;<span class="num" id="2168863">0</span>&nbsp;<span class="op" id="2168865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168869">x</span>&nbsp;<span class="op" id="2168871">=</span>&nbsp;<span class="op" id="2168873">-</span><span class="ident" id="2168874">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168878">sign</span>&nbsp;<span class="op" id="2168883">=</span>&nbsp;<span class="builtintype" id="2168885">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168895">j</span>&nbsp;<span class="op" id="2168897">:=</span>&nbsp;<span class="ident" id="2168900">int64</span><span class="op" id="2168905">(</span><span class="ident" id="2168906">x</span>&nbsp;<span class="op" id="2168908">*</span>&nbsp;<span class="ident" id="2168910">M4PI</span><span class="op" id="2168914">)</span>&nbsp;<span class="comment" id="2168916">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168986">y</span>&nbsp;<span class="op" id="2168988">:=</span>&nbsp;<span class="builtintype" id="2168991">float64</span><span class="op" id="2168998">(</span><span class="ident" id="2168999">j</span><span class="op" id="2169000">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2169007">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2169047">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2169071">if</span>&nbsp;<span class="ident" id="2169074">j</span><span class="op" id="2169075">&amp;</span><span class="num" id="2169076">1</span>&nbsp;<span class="op" id="2169078">==</span>&nbsp;<span class="num" id="2169081">1</span>&nbsp;<span class="op" id="2169083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169087">j</span>&nbsp;<span class="op" id="2169089">+=</span>&nbsp;<span class="num" id="2169092">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169096">y</span>&nbsp;<span class="op" id="2169098">+=</span>&nbsp;<span class="num" id="2169101">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2169104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169107">j</span>&nbsp;<span class="op" id="2169109">&amp;=</span>&nbsp;<span class="num" id="2169112">7</span>&nbsp;<span class="comment" id="2169114">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2169158">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2169180">if</span>&nbsp;<span class="ident" id="2169183">j</span>&nbsp;<span class="op" id="2169185">&gt;</span>&nbsp;<span class="num" id="2169187">3</span>&nbsp;<span class="op" id="2169189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169193">sign</span>&nbsp;<span class="op" id="2169198">=</span>&nbsp;<span class="op" id="2169200">!</span><span class="ident" id="2169201">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169208">j</span>&nbsp;<span class="op" id="2169210">-=</span>&nbsp;<span class="num" id="2169213">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2169216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169220">z</span>&nbsp;<span class="op" id="2169222">:=</span>&nbsp;<span class="op" id="2169225">(</span><span class="op" id="2169226">(</span><span class="ident" id="2169227">x</span>&nbsp;<span class="op" id="2169229">-</span>&nbsp;<span class="ident" id="2169231">y</span><span class="op" id="2169232">*</span><span class="ident" id="2169233">PI4A</span><span class="op" id="2169237">)</span>&nbsp;<span class="op" id="2169239">-</span>&nbsp;<span class="ident" id="2169241">y</span><span class="op" id="2169242">*</span><span class="ident" id="2169243">PI4B</span><span class="op" id="2169247">)</span>&nbsp;<span class="op" id="2169249">-</span>&nbsp;<span class="ident" id="2169251">y</span><span class="op" id="2169252">*</span><span class="ident" id="2169253">PI4C</span>&nbsp;<span class="comment" id="2169258">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169300">zz</span>&nbsp;<span class="op" id="2169303">:=</span>&nbsp;<span class="ident" id="2169306">z</span>&nbsp;<span class="op" id="2169308">*</span>&nbsp;<span class="ident" id="2169310">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2169313">if</span>&nbsp;<span class="ident" id="2169316">j</span>&nbsp;<span class="op" id="2169318">==</span>&nbsp;<span class="num" id="2169321">1</span>&nbsp;<span class="op" id="2169323">||</span>&nbsp;<span class="ident" id="2169326">j</span>&nbsp;<span class="op" id="2169328">==</span>&nbsp;<span class="num" id="2169331">2</span>&nbsp;<span class="op" id="2169333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169337">y</span>&nbsp;<span class="op" id="2169339">=</span>&nbsp;<span class="num" id="2169341">1.0</span>&nbsp;<span class="op" id="2169345">-</span>&nbsp;<span class="num" id="2169347">0.5</span><span class="op" id="2169350">*</span><span class="ident" id="2169351">zz</span>&nbsp;<span class="op" id="2169354">+</span>&nbsp;<span class="ident" id="2169356">zz</span><span class="op" id="2169358">*</span><span class="ident" id="2169359">zz</span><span class="op" id="2169361">*</span><span class="op" id="2169362">(</span><span class="op" id="2169363">(</span><span class="op" id="2169364">(</span><span class="op" id="2169365">(</span><span class="op" id="2169366">(</span><span class="op" id="2169367">(</span><span class="ident" id="2169368">_cos</span><span class="op" id="2169372">[</span><span class="num" id="2169373">0</span><span class="op" id="2169374">]</span><span class="op" id="2169375">*</span><span class="ident" id="2169376">zz</span><span class="op" id="2169378">)</span><span class="op" id="2169379">+</span><span class="ident" id="2169380">_cos</span><span class="op" id="2169384">[</span><span class="num" id="2169385">1</span><span class="op" id="2169386">]</span><span class="op" id="2169387">)</span><span class="op" id="2169388">*</span><span class="ident" id="2169389">zz</span><span class="op" id="2169391">+</span><span class="ident" id="2169392">_cos</span><span class="op" id="2169396">[</span><span class="num" id="2169397">2</span><span class="op" id="2169398">]</span><span class="op" id="2169399">)</span><span class="op" id="2169400">*</span><span class="ident" id="2169401">zz</span><span class="op" id="2169403">+</span><span class="ident" id="2169404">_cos</span><span class="op" id="2169408">[</span><span class="num" id="2169409">3</span><span class="op" id="2169410">]</span><span class="op" id="2169411">)</span><span class="op" id="2169412">*</span><span class="ident" id="2169413">zz</span><span class="op" id="2169415">+</span><span class="ident" id="2169416">_cos</span><span class="op" id="2169420">[</span><span class="num" id="2169421">4</span><span class="op" id="2169422">]</span><span class="op" id="2169423">)</span><span class="op" id="2169424">*</span><span class="ident" id="2169425">zz</span><span class="op" id="2169427">+</span><span class="ident" id="2169428">_cos</span><span class="op" id="2169432">[</span><span class="num" id="2169433">5</span><span class="op" id="2169434">]</span><span class="op" id="2169435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2169438">}</span>&nbsp;<span class="keyword" id="2169440">else</span>&nbsp;<span class="op" id="2169445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169449">y</span>&nbsp;<span class="op" id="2169451">=</span>&nbsp;<span class="ident" id="2169453">z</span>&nbsp;<span class="op" id="2169455">+</span>&nbsp;<span class="ident" id="2169457">z</span><span class="op" id="2169458">*</span><span class="ident" id="2169459">zz</span><span class="op" id="2169461">*</span><span class="op" id="2169462">(</span><span class="op" id="2169463">(</span><span class="op" id="2169464">(</span><span class="op" id="2169465">(</span><span class="op" id="2169466">(</span><span class="op" id="2169467">(</span><span class="ident" id="2169468">_sin</span><span class="op" id="2169472">[</span><span class="num" id="2169473">0</span><span class="op" id="2169474">]</span><span class="op" id="2169475">*</span><span class="ident" id="2169476">zz</span><span class="op" id="2169478">)</span><span class="op" id="2169479">+</span><span class="ident" id="2169480">_sin</span><span class="op" id="2169484">[</span><span class="num" id="2169485">1</span><span class="op" id="2169486">]</span><span class="op" id="2169487">)</span><span class="op" id="2169488">*</span><span class="ident" id="2169489">zz</span><span class="op" id="2169491">+</span><span class="ident" id="2169492">_sin</span><span class="op" id="2169496">[</span><span class="num" id="2169497">2</span><span class="op" id="2169498">]</span><span class="op" id="2169499">)</span><span class="op" id="2169500">*</span><span class="ident" id="2169501">zz</span><span class="op" id="2169503">+</span><span class="ident" id="2169504">_sin</span><span class="op" id="2169508">[</span><span class="num" id="2169509">3</span><span class="op" id="2169510">]</span><span class="op" id="2169511">)</span><span class="op" id="2169512">*</span><span class="ident" id="2169513">zz</span><span class="op" id="2169515">+</span><span class="ident" id="2169516">_sin</span><span class="op" id="2169520">[</span><span class="num" id="2169521">4</span><span class="op" id="2169522">]</span><span class="op" id="2169523">)</span><span class="op" id="2169524">*</span><span class="ident" id="2169525">zz</span><span class="op" id="2169527">+</span><span class="ident" id="2169528">_sin</span><span class="op" id="2169532">[</span><span class="num" id="2169533">5</span><span class="op" id="2169534">]</span><span class="op" id="2169535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2169538">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2169541">if</span>&nbsp;<span class="ident" id="2169544">sign</span>&nbsp;<span class="op" id="2169549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2169553">y</span>&nbsp;<span class="op" id="2169555">=</span>&nbsp;<span class="op" id="2169557">-</span><span class="ident" id="2169558">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2169561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2169564">return</span>&nbsp;<span class="ident" id="2169571">y</span><br>
<span class="lineno"></span><span class="op" id="2169573">}</span>
</div>
</body>
</html>
