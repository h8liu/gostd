<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1913461">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1913516">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1913570">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1913621">package</span>&nbsp;<span class="ident" id="1913629">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1913638">import</span>&nbsp;<span class="string" id="1913645">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1913655">//&nbsp;Breakpoint&nbsp;executes&nbsp;a&nbsp;breakpoint&nbsp;trap.</span><br>
<span class="lineno">10</span><span class="keyword" id="1913697">func</span>&nbsp;<span class="ident" id="1913702">Breakpoint</span><span class="op" id="1913712">(</span><span class="op" id="1913713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1913716">//&nbsp;LockOSThread&nbsp;wires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;to&nbsp;its&nbsp;current&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1913800">//&nbsp;Until&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;exits&nbsp;or&nbsp;calls&nbsp;UnlockOSThread,&nbsp;it&nbsp;will&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="1913877">//&nbsp;execute&nbsp;in&nbsp;that&nbsp;thread,&nbsp;and&nbsp;no&nbsp;other&nbsp;goroutine&nbsp;can.</span><br>
<span class="lineno">15</span><span class="keyword" id="1913932">func</span>&nbsp;<span class="ident" id="1913937">LockOSThread</span><span class="op" id="1913949">(</span><span class="op" id="1913950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1913953">//&nbsp;UnlockOSThread&nbsp;unwires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;from&nbsp;its&nbsp;fixed&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1914041">//&nbsp;If&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;has&nbsp;not&nbsp;called&nbsp;LockOSThread,&nbsp;UnlockOSThread&nbsp;is&nbsp;a&nbsp;no-op.</span><br>
<span class="lineno"></span><span class="keyword" id="1914125">func</span>&nbsp;<span class="ident" id="1914130">UnlockOSThread</span><span class="op" id="1914144">(</span><span class="op" id="1914145">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1914148">//&nbsp;GOMAXPROCS&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;that&nbsp;can&nbsp;be&nbsp;executing</span><br>
<span class="lineno"></span><span class="comment" id="1914216">//&nbsp;simultaneously&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.&nbsp;&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;1,&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1914291">//&nbsp;change&nbsp;the&nbsp;current&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="1914322">//&nbsp;The&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine&nbsp;can&nbsp;be&nbsp;queried&nbsp;with&nbsp;NumCPU.</span><br>
<span class="lineno">25</span><span class="comment" id="1914401">//&nbsp;This&nbsp;call&nbsp;will&nbsp;go&nbsp;away&nbsp;when&nbsp;the&nbsp;scheduler&nbsp;improves.</span><br>
<span class="lineno"></span><span class="keyword" id="1914456">func</span>&nbsp;<span class="ident" id="1914461">GOMAXPROCS</span><span class="op" id="1914471">(</span><span class="ident" id="1914472">n</span>&nbsp;<span class="builtintype" id="1914474">int</span><span class="op" id="1914477">)</span>&nbsp;<span class="builtintype" id="1914479">int</span>&nbsp;<span class="op" id="1914483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914486">if</span>&nbsp;<span class="ident" id="1914489"><a href="/runtime/debug.go.html#1914472">n</a></span>&nbsp;<span class="op" id="1914491">&gt;</span>&nbsp;<span class="ident" id="1914493"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2181973">_MaxGomaxprocs</a></span>&nbsp;<span class="op" id="1914508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914512"><a href="/runtime/debug.go.html#1914472">n</a></span>&nbsp;<span class="op" id="1914514">=</span>&nbsp;<span class="ident" id="1914516"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2181973">_MaxGomaxprocs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1914532">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914535"><a href="/runtime/lock_futex.go.html#1978439">lock</a></span><span class="op" id="1914539">(</span><span class="op" id="1914540">&amp;</span><span class="ident" id="1914541"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184660">sched</a></span><span class="op" id="1914546">.</span><span class="ident" id="1914547">lock</span><span class="op" id="1914551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914554">ret</span>&nbsp;<span class="op" id="1914558">:=</span>&nbsp;<span class="builtintype" id="1914561">int</span><span class="op" id="1914564">(</span><span class="ident" id="1914565"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184373">gomaxprocs</a></span><span class="op" id="1914575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914578"><a href="/runtime/lock_futex.go.html#1979731">unlock</a></span><span class="op" id="1914584">(</span><span class="op" id="1914585">&amp;</span><span class="ident" id="1914586"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184660">sched</a></span><span class="op" id="1914591">.</span><span class="ident" id="1914592">lock</span><span class="op" id="1914596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914599">if</span>&nbsp;<span class="ident" id="1914602"><a href="/runtime/debug.go.html#1914472">n</a></span>&nbsp;<span class="op" id="1914604">&lt;=</span>&nbsp;<span class="num" id="1914607">0</span>&nbsp;<span class="op" id="1914609">||</span>&nbsp;<span class="ident" id="1914612"><a href="/runtime/debug.go.html#1914472">n</a></span>&nbsp;<span class="op" id="1914614">==</span>&nbsp;<span class="ident" id="1914617"><a href="/runtime/debug.go.html#1914554">ret</a></span>&nbsp;<span class="op" id="1914621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914625">return</span>&nbsp;<span class="ident" id="1914632"><a href="/runtime/debug.go.html#1914554">ret</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1914637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914641"><a href="/runtime/sema.go.html#2096000">semacquire</a></span><span class="op" id="1914651">(</span><span class="op" id="1914652">&amp;</span><span class="ident" id="1914653"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="1914662">,</span>&nbsp;<span class="builtintype" id="1914664">false</span><span class="op" id="1914669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914672">gp</span>&nbsp;<span class="op" id="1914675">:=</span>&nbsp;<span class="ident" id="1914678"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="1914682">(</span><span class="op" id="1914683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914686"><a href="/runtime/debug.go.html#1914672">gp</a></span><span class="op" id="1914688">.</span><span class="ident" id="1914689">m</span><span class="op" id="1914690">.</span><span class="ident" id="1914691">gcing</span>&nbsp;<span class="op" id="1914697">=</span>&nbsp;<span class="num" id="1914699">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914702"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="1914705">(</span><span class="ident" id="1914706"><a href="/runtime/stubs.go.html#2135896">stoptheworld</a></span><span class="op" id="1914718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1914722">//&nbsp;newprocs&nbsp;will&nbsp;be&nbsp;processed&nbsp;by&nbsp;starttheworld</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914770"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184677">newprocs</a></span>&nbsp;<span class="op" id="1914779">=</span>&nbsp;<span class="builtintype" id="1914781">int32</span><span class="op" id="1914786">(</span><span class="ident" id="1914787"><a href="/runtime/debug.go.html#1914472">n</a></span><span class="op" id="1914788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914792"><a href="/runtime/debug.go.html#1914672">gp</a></span><span class="op" id="1914794">.</span><span class="ident" id="1914795">m</span><span class="op" id="1914796">.</span><span class="ident" id="1914797">gcing</span>&nbsp;<span class="op" id="1914803">=</span>&nbsp;<span class="num" id="1914805">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914808"><a href="/runtime/sema.go.html#2097084">semrelease</a></span><span class="op" id="1914818">(</span><span class="op" id="1914819">&amp;</span><span class="ident" id="1914820"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="1914829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914832"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="1914835">(</span><span class="ident" id="1914836"><a href="/runtime/stubs.go.html#2135875">starttheworld</a></span><span class="op" id="1914849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914852">return</span>&nbsp;<span class="ident" id="1914859"><a href="/runtime/debug.go.html#1914554">ret</a></span><br>
<span class="lineno"></span><span class="op" id="1914863">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="1914866">//&nbsp;NumCPU&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="1914933">func</span>&nbsp;<span class="ident" id="1914938">NumCPU</span><span class="op" id="1914944">(</span><span class="op" id="1914945">)</span>&nbsp;<span class="builtintype" id="1914947">int</span>&nbsp;<span class="op" id="1914951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914954">return</span>&nbsp;<span class="builtintype" id="1914961">int</span><span class="op" id="1914964">(</span><span class="ident" id="1914965"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184452">ncpu</a></span><span class="op" id="1914969">)</span><br>
<span class="lineno"></span><span class="op" id="1914971">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1914974">//&nbsp;NumCgoCall&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;cgo&nbsp;calls&nbsp;made&nbsp;by&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="1915049">func</span>&nbsp;<span class="ident" id="1915054">NumCgoCall</span><span class="op" id="1915064">(</span><span class="op" id="1915065">)</span>&nbsp;<span class="ident" id="1915067">int64</span>&nbsp;<span class="op" id="1915073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915076">var</span>&nbsp;<span class="ident" id="1915080">n</span>&nbsp;<span class="ident" id="1915082">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915089">for</span>&nbsp;<span class="ident" id="1915093">mp</span>&nbsp;<span class="op" id="1915096">:=</span>&nbsp;<span class="op" id="1915099">(</span><span class="op" id="1915100">*</span><span class="ident" id="1915101"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2180912">m</a></span><span class="op" id="1915102">)</span><span class="op" id="1915103">(</span><span class="ident" id="1915104"><a href="/runtime/atomic.go.html#1874536">atomicloadp</a></span><span class="op" id="1915115">(</span><span class="ident" id="1915116"><a href="/runtime/debug.go.html#1913645">unsafe</a></span><span class="op" id="1915122">.</span><span class="ident" id="1915123">Pointer</span><span class="op" id="1915130">(</span><span class="op" id="1915131">&amp;</span><span class="ident" id="1915132"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184344">allm</a></span><span class="op" id="1915136">)</span><span class="op" id="1915137">)</span><span class="op" id="1915138">)</span><span class="op" id="1915139">;</span>&nbsp;<span class="ident" id="1915141"><a href="/runtime/debug.go.html#1915093">mp</a></span>&nbsp;<span class="op" id="1915144">!=</span>&nbsp;<span class="ident" id="1915147">nil</span><span class="op" id="1915150">;</span>&nbsp;<span class="ident" id="1915152"><a href="/runtime/debug.go.html#1915093">mp</a></span>&nbsp;<span class="op" id="1915155">=</span>&nbsp;<span class="ident" id="1915157"><a href="/runtime/debug.go.html#1915093">mp</a></span><span class="op" id="1915159">.</span><span class="ident" id="1915160">alllink</span>&nbsp;<span class="op" id="1915168">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915172"><a href="/runtime/debug.go.html#1915080">n</a></span>&nbsp;<span class="op" id="1915174">+=</span>&nbsp;<span class="ident" id="1915177">int64</span><span class="op" id="1915182">(</span><span class="ident" id="1915183"><a href="/runtime/debug.go.html#1915093">mp</a></span><span class="op" id="1915185">.</span><span class="ident" id="1915186">ncgocall</span><span class="op" id="1915194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915200">return</span>&nbsp;<span class="ident" id="1915207"><a href="/runtime/debug.go.html#1915080">n</a></span><br>
<span class="lineno"></span><span class="op" id="1915209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="1915212">//&nbsp;NumGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines&nbsp;that&nbsp;currently&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="1915283">func</span>&nbsp;<span class="ident" id="1915288">NumGoroutine</span><span class="op" id="1915300">(</span><span class="op" id="1915301">)</span>&nbsp;<span class="builtintype" id="1915303">int</span>&nbsp;<span class="op" id="1915307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915310">return</span>&nbsp;<span class="builtintype" id="1915317">int</span><span class="op" id="1915320">(</span><span class="ident" id="1915321"><a href="/runtime/debug.go.html#1915339">gcount</a></span><span class="op" id="1915327">(</span><span class="op" id="1915328">)</span><span class="op" id="1915329">)</span><br>
<span class="lineno"></span><span class="op" id="1915331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="1915334">func</span>&nbsp;<span class="ident" id="1915339">gcount</span><span class="op" id="1915345">(</span><span class="op" id="1915346">)</span>&nbsp;<span class="builtintype" id="1915348">int32</span>
</div>
</body>
</html>
