<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8103198">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8103253">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8103307">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8103358">package</span>&nbsp;<span class="ident" id="8103366">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8103371">import</span>&nbsp;<span class="op" id="8103378">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103381">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103390">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103397">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8103407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8103410">type</span>&nbsp;<span class="ident" id="8103415">rc4Test</span>&nbsp;<span class="keyword" id="8103423">struct</span>&nbsp;<span class="op" id="8103430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103433">key</span><span class="op" id="8103436">,</span>&nbsp;<span class="ident" id="8103438">keystream</span>&nbsp;<span class="op" id="8103448">[</span><span class="op" id="8103449">]</span><span class="builtintype" id="8103450">byte</span><br>
<span class="lineno">15</span><span class="op" id="8103455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8103458">var</span>&nbsp;<span class="ident" id="8103462">golden</span>&nbsp;<span class="op" id="8103469">=</span>&nbsp;<span class="op" id="8103471">[</span><span class="op" id="8103472">]</span><span class="ident" id="8103473">rc4Test</span><span class="op" id="8103480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8103483">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8103546">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103624">[</span><span class="op" id="8103625">]</span><span class="builtintype" id="8103626">byte</span><span class="op" id="8103630">{</span><span class="num" id="8103631">0x01</span><span class="op" id="8103635">,</span>&nbsp;<span class="num" id="8103637">0x23</span><span class="op" id="8103641">,</span>&nbsp;<span class="num" id="8103643">0x45</span><span class="op" id="8103647">,</span>&nbsp;<span class="num" id="8103649">0x67</span><span class="op" id="8103653">,</span>&nbsp;<span class="num" id="8103655">0x89</span><span class="op" id="8103659">,</span>&nbsp;<span class="num" id="8103661">0xab</span><span class="op" id="8103665">,</span>&nbsp;<span class="num" id="8103667">0xcd</span><span class="op" id="8103671">,</span>&nbsp;<span class="num" id="8103673">0xef</span><span class="op" id="8103677">}</span><span class="op" id="8103678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103682">[</span><span class="op" id="8103683">]</span><span class="builtintype" id="8103684">byte</span><span class="op" id="8103688">{</span><span class="num" id="8103689">0x74</span><span class="op" id="8103693">,</span>&nbsp;<span class="num" id="8103695">0x94</span><span class="op" id="8103699">,</span>&nbsp;<span class="num" id="8103701">0xc2</span><span class="op" id="8103705">,</span>&nbsp;<span class="num" id="8103707">0xe7</span><span class="op" id="8103711">,</span>&nbsp;<span class="num" id="8103713">0x10</span><span class="op" id="8103717">,</span>&nbsp;<span class="num" id="8103719">0x4b</span><span class="op" id="8103723">,</span>&nbsp;<span class="num" id="8103725">0x08</span><span class="op" id="8103729">,</span>&nbsp;<span class="num" id="8103731">0x79</span><span class="op" id="8103735">}</span><span class="op" id="8103736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103739">}</span><span class="op" id="8103740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103743">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103747">[</span><span class="op" id="8103748">]</span><span class="builtintype" id="8103749">byte</span><span class="op" id="8103753">{</span><span class="num" id="8103754">0x00</span><span class="op" id="8103758">,</span>&nbsp;<span class="num" id="8103760">0x00</span><span class="op" id="8103764">,</span>&nbsp;<span class="num" id="8103766">0x00</span><span class="op" id="8103770">,</span>&nbsp;<span class="num" id="8103772">0x00</span><span class="op" id="8103776">,</span>&nbsp;<span class="num" id="8103778">0x00</span><span class="op" id="8103782">,</span>&nbsp;<span class="num" id="8103784">0x00</span><span class="op" id="8103788">,</span>&nbsp;<span class="num" id="8103790">0x00</span><span class="op" id="8103794">,</span>&nbsp;<span class="num" id="8103796">0x00</span><span class="op" id="8103800">}</span><span class="op" id="8103801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103805">[</span><span class="op" id="8103806">]</span><span class="builtintype" id="8103807">byte</span><span class="op" id="8103811">{</span><span class="num" id="8103812">0xde</span><span class="op" id="8103816">,</span>&nbsp;<span class="num" id="8103818">0x18</span><span class="op" id="8103822">,</span>&nbsp;<span class="num" id="8103824">0x89</span><span class="op" id="8103828">,</span>&nbsp;<span class="num" id="8103830">0x41</span><span class="op" id="8103834">,</span>&nbsp;<span class="num" id="8103836">0xa3</span><span class="op" id="8103840">,</span>&nbsp;<span class="num" id="8103842">0x37</span><span class="op" id="8103846">,</span>&nbsp;<span class="num" id="8103848">0x5d</span><span class="op" id="8103852">,</span>&nbsp;<span class="num" id="8103854">0x3a</span><span class="op" id="8103858">}</span><span class="op" id="8103859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103862">}</span><span class="op" id="8103863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103870">[</span><span class="op" id="8103871">]</span><span class="builtintype" id="8103872">byte</span><span class="op" id="8103876">{</span><span class="num" id="8103877">0xef</span><span class="op" id="8103881">,</span>&nbsp;<span class="num" id="8103883">0x01</span><span class="op" id="8103887">,</span>&nbsp;<span class="num" id="8103889">0x23</span><span class="op" id="8103893">,</span>&nbsp;<span class="num" id="8103895">0x45</span><span class="op" id="8103899">}</span><span class="op" id="8103900">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103904">[</span><span class="op" id="8103905">]</span><span class="builtintype" id="8103906">byte</span><span class="op" id="8103910">{</span><span class="num" id="8103911">0xd6</span><span class="op" id="8103915">,</span>&nbsp;<span class="num" id="8103917">0xa1</span><span class="op" id="8103921">,</span>&nbsp;<span class="num" id="8103923">0x41</span><span class="op" id="8103927">,</span>&nbsp;<span class="num" id="8103929">0xa7</span><span class="op" id="8103933">,</span>&nbsp;<span class="num" id="8103935">0xec</span><span class="op" id="8103939">,</span>&nbsp;<span class="num" id="8103941">0x3c</span><span class="op" id="8103945">,</span>&nbsp;<span class="num" id="8103947">0x38</span><span class="op" id="8103951">,</span>&nbsp;<span class="num" id="8103953">0xdf</span><span class="op" id="8103957">,</span>&nbsp;<span class="num" id="8103959">0xbd</span><span class="op" id="8103963">,</span>&nbsp;<span class="num" id="8103965">0x61</span><span class="op" id="8103969">}</span><span class="op" id="8103970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103973">}</span><span class="op" id="8103974">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8103978">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104053">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104057">[</span><span class="op" id="8104058">]</span><span class="builtintype" id="8104059">byte</span><span class="op" id="8104063">{</span><span class="num" id="8104064">0x4b</span><span class="op" id="8104068">,</span>&nbsp;<span class="num" id="8104070">0x65</span><span class="op" id="8104074">,</span>&nbsp;<span class="num" id="8104076">0x79</span><span class="op" id="8104080">}</span><span class="op" id="8104081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104085">[</span><span class="op" id="8104086">]</span><span class="builtintype" id="8104087">byte</span><span class="op" id="8104091">{</span><span class="num" id="8104092">0xeb</span><span class="op" id="8104096">,</span>&nbsp;<span class="num" id="8104098">0x9f</span><span class="op" id="8104102">,</span>&nbsp;<span class="num" id="8104104">0x77</span><span class="op" id="8104108">,</span>&nbsp;<span class="num" id="8104110">0x81</span><span class="op" id="8104114">,</span>&nbsp;<span class="num" id="8104116">0xb7</span><span class="op" id="8104120">,</span>&nbsp;<span class="num" id="8104122">0x34</span><span class="op" id="8104126">,</span>&nbsp;<span class="num" id="8104128">0xca</span><span class="op" id="8104132">,</span>&nbsp;<span class="num" id="8104134">0x72</span><span class="op" id="8104138">,</span>&nbsp;<span class="num" id="8104140">0xa7</span><span class="op" id="8104144">,</span>&nbsp;<span class="num" id="8104146">0x19</span><span class="op" id="8104150">}</span><span class="op" id="8104151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104154">}</span><span class="op" id="8104155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104162">[</span><span class="op" id="8104163">]</span><span class="builtintype" id="8104164">byte</span><span class="op" id="8104168">{</span><span class="num" id="8104169">0x57</span><span class="op" id="8104173">,</span>&nbsp;<span class="num" id="8104175">0x69</span><span class="op" id="8104179">,</span>&nbsp;<span class="num" id="8104181">0x6b</span><span class="op" id="8104185">,</span>&nbsp;<span class="num" id="8104187">0x69</span><span class="op" id="8104191">}</span><span class="op" id="8104192">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104196">[</span><span class="op" id="8104197">]</span><span class="builtintype" id="8104198">byte</span><span class="op" id="8104202">{</span><span class="num" id="8104203">0x60</span><span class="op" id="8104207">,</span>&nbsp;<span class="num" id="8104209">0x44</span><span class="op" id="8104213">,</span>&nbsp;<span class="num" id="8104215">0xdb</span><span class="op" id="8104219">,</span>&nbsp;<span class="num" id="8104221">0x6d</span><span class="op" id="8104225">,</span>&nbsp;<span class="num" id="8104227">0x41</span><span class="op" id="8104231">,</span>&nbsp;<span class="num" id="8104233">0xb7</span><span class="op" id="8104237">}</span><span class="op" id="8104238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104241">}</span><span class="op" id="8104242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104249">[</span><span class="op" id="8104250">]</span><span class="builtintype" id="8104251">byte</span><span class="op" id="8104255">{</span><span class="num" id="8104256">0x00</span><span class="op" id="8104260">,</span>&nbsp;<span class="num" id="8104262">0x00</span><span class="op" id="8104266">,</span>&nbsp;<span class="num" id="8104268">0x00</span><span class="op" id="8104272">,</span>&nbsp;<span class="num" id="8104274">0x00</span><span class="op" id="8104278">,</span>&nbsp;<span class="num" id="8104280">0x00</span><span class="op" id="8104284">,</span>&nbsp;<span class="num" id="8104286">0x00</span><span class="op" id="8104290">,</span>&nbsp;<span class="num" id="8104292">0x00</span><span class="op" id="8104296">,</span>&nbsp;<span class="num" id="8104298">0x00</span><span class="op" id="8104302">}</span><span class="op" id="8104303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104307">[</span><span class="op" id="8104308">]</span><span class="builtintype" id="8104309">byte</span><span class="op" id="8104313">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104318">0xde</span><span class="op" id="8104322">,</span>&nbsp;<span class="num" id="8104324">0x18</span><span class="op" id="8104328">,</span>&nbsp;<span class="num" id="8104330">0x89</span><span class="op" id="8104334">,</span>&nbsp;<span class="num" id="8104336">0x41</span><span class="op" id="8104340">,</span>&nbsp;<span class="num" id="8104342">0xa3</span><span class="op" id="8104346">,</span>&nbsp;<span class="num" id="8104348">0x37</span><span class="op" id="8104352">,</span>&nbsp;<span class="num" id="8104354">0x5d</span><span class="op" id="8104358">,</span>&nbsp;<span class="num" id="8104360">0x3a</span><span class="op" id="8104364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104369">0x8a</span><span class="op" id="8104373">,</span>&nbsp;<span class="num" id="8104375">0x06</span><span class="op" id="8104379">,</span>&nbsp;<span class="num" id="8104381">0x1e</span><span class="op" id="8104385">,</span>&nbsp;<span class="num" id="8104387">0x67</span><span class="op" id="8104391">,</span>&nbsp;<span class="num" id="8104393">0x57</span><span class="op" id="8104397">,</span>&nbsp;<span class="num" id="8104399">0x6e</span><span class="op" id="8104403">,</span>&nbsp;<span class="num" id="8104405">0x92</span><span class="op" id="8104409">,</span>&nbsp;<span class="num" id="8104411">0x6d</span><span class="op" id="8104415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104420">0xc7</span><span class="op" id="8104424">,</span>&nbsp;<span class="num" id="8104426">0x1a</span><span class="op" id="8104430">,</span>&nbsp;<span class="num" id="8104432">0x7f</span><span class="op" id="8104436">,</span>&nbsp;<span class="num" id="8104438">0xa3</span><span class="op" id="8104442">,</span>&nbsp;<span class="num" id="8104444">0xf0</span><span class="op" id="8104448">,</span>&nbsp;<span class="num" id="8104450">0xcc</span><span class="op" id="8104454">,</span>&nbsp;<span class="num" id="8104456">0xeb</span><span class="op" id="8104460">,</span>&nbsp;<span class="num" id="8104462">0x97</span><span class="op" id="8104466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104471">0x45</span><span class="op" id="8104475">,</span>&nbsp;<span class="num" id="8104477">0x2b</span><span class="op" id="8104481">,</span>&nbsp;<span class="num" id="8104483">0x4d</span><span class="op" id="8104487">,</span>&nbsp;<span class="num" id="8104489">0x32</span><span class="op" id="8104493">,</span>&nbsp;<span class="num" id="8104495">0x27</span><span class="op" id="8104499">,</span>&nbsp;<span class="num" id="8104501">0x96</span><span class="op" id="8104505">,</span>&nbsp;<span class="num" id="8104507">0x5f</span><span class="op" id="8104511">,</span>&nbsp;<span class="num" id="8104513">0x9e</span><span class="op" id="8104517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104522">0xa8</span><span class="op" id="8104526">,</span>&nbsp;<span class="num" id="8104528">0xcc</span><span class="op" id="8104532">,</span>&nbsp;<span class="num" id="8104534">0x75</span><span class="op" id="8104538">,</span>&nbsp;<span class="num" id="8104540">0x07</span><span class="op" id="8104544">,</span>&nbsp;<span class="num" id="8104546">0x6d</span><span class="op" id="8104550">,</span>&nbsp;<span class="num" id="8104552">0x9f</span><span class="op" id="8104556">,</span>&nbsp;<span class="num" id="8104558">0xb9</span><span class="op" id="8104562">,</span>&nbsp;<span class="num" id="8104564">0xc5</span><span class="op" id="8104568">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104573">0x41</span><span class="op" id="8104577">,</span>&nbsp;<span class="num" id="8104579">0x7a</span><span class="op" id="8104583">,</span>&nbsp;<span class="num" id="8104585">0xa5</span><span class="op" id="8104589">,</span>&nbsp;<span class="num" id="8104591">0xcb</span><span class="op" id="8104595">,</span>&nbsp;<span class="num" id="8104597">0x30</span><span class="op" id="8104601">,</span>&nbsp;<span class="num" id="8104603">0xfc</span><span class="op" id="8104607">,</span>&nbsp;<span class="num" id="8104609">0x22</span><span class="op" id="8104613">,</span>&nbsp;<span class="num" id="8104615">0x19</span><span class="op" id="8104619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104624">0x8b</span><span class="op" id="8104628">,</span>&nbsp;<span class="num" id="8104630">0x34</span><span class="op" id="8104634">,</span>&nbsp;<span class="num" id="8104636">0x98</span><span class="op" id="8104640">,</span>&nbsp;<span class="num" id="8104642">0x2d</span><span class="op" id="8104646">,</span>&nbsp;<span class="num" id="8104648">0xbb</span><span class="op" id="8104652">,</span>&nbsp;<span class="num" id="8104654">0x62</span><span class="op" id="8104658">,</span>&nbsp;<span class="num" id="8104660">0x9e</span><span class="op" id="8104664">,</span>&nbsp;<span class="num" id="8104666">0xc0</span><span class="op" id="8104670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104675">0x4b</span><span class="op" id="8104679">,</span>&nbsp;<span class="num" id="8104681">0x4f</span><span class="op" id="8104685">,</span>&nbsp;<span class="num" id="8104687">0x8b</span><span class="op" id="8104691">,</span>&nbsp;<span class="num" id="8104693">0x05</span><span class="op" id="8104697">,</span>&nbsp;<span class="num" id="8104699">0xa0</span><span class="op" id="8104703">,</span>&nbsp;<span class="num" id="8104705">0x71</span><span class="op" id="8104709">,</span>&nbsp;<span class="num" id="8104711">0x08</span><span class="op" id="8104715">,</span>&nbsp;<span class="num" id="8104717">0x50</span><span class="op" id="8104721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104726">0x92</span><span class="op" id="8104730">,</span>&nbsp;<span class="num" id="8104732">0xa0</span><span class="op" id="8104736">,</span>&nbsp;<span class="num" id="8104738">0xc3</span><span class="op" id="8104742">,</span>&nbsp;<span class="num" id="8104744">0x58</span><span class="op" id="8104748">,</span>&nbsp;<span class="num" id="8104750">0x4a</span><span class="op" id="8104754">,</span>&nbsp;<span class="num" id="8104756">0x48</span><span class="op" id="8104760">,</span>&nbsp;<span class="num" id="8104762">0xe4</span><span class="op" id="8104766">,</span>&nbsp;<span class="num" id="8104768">0xa3</span><span class="op" id="8104772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104777">0x0a</span><span class="op" id="8104781">,</span>&nbsp;<span class="num" id="8104783">0x39</span><span class="op" id="8104787">,</span>&nbsp;<span class="num" id="8104789">0x7b</span><span class="op" id="8104793">,</span>&nbsp;<span class="num" id="8104795">0x8a</span><span class="op" id="8104799">,</span>&nbsp;<span class="num" id="8104801">0xcd</span><span class="op" id="8104805">,</span>&nbsp;<span class="num" id="8104807">0x1d</span><span class="op" id="8104811">,</span>&nbsp;<span class="num" id="8104813">0x00</span><span class="op" id="8104817">,</span>&nbsp;<span class="num" id="8104819">0x9e</span><span class="op" id="8104823">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104828">0xc8</span><span class="op" id="8104832">,</span>&nbsp;<span class="num" id="8104834">0x7d</span><span class="op" id="8104838">,</span>&nbsp;<span class="num" id="8104840">0x68</span><span class="op" id="8104844">,</span>&nbsp;<span class="num" id="8104846">0x11</span><span class="op" id="8104850">,</span>&nbsp;<span class="num" id="8104852">0xf2</span><span class="op" id="8104856">,</span>&nbsp;<span class="num" id="8104858">0x2c</span><span class="op" id="8104862">,</span>&nbsp;<span class="num" id="8104864">0xf4</span><span class="op" id="8104868">,</span>&nbsp;<span class="num" id="8104870">0x9c</span><span class="op" id="8104874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104879">0xa3</span><span class="op" id="8104883">,</span>&nbsp;<span class="num" id="8104885">0xe5</span><span class="op" id="8104889">,</span>&nbsp;<span class="num" id="8104891">0x93</span><span class="op" id="8104895">,</span>&nbsp;<span class="num" id="8104897">0x54</span><span class="op" id="8104901">,</span>&nbsp;<span class="num" id="8104903">0xb9</span><span class="op" id="8104907">,</span>&nbsp;<span class="num" id="8104909">0x45</span><span class="op" id="8104913">,</span>&nbsp;<span class="num" id="8104915">0x15</span><span class="op" id="8104919">,</span>&nbsp;<span class="num" id="8104921">0x35</span><span class="op" id="8104925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104930">0xa2</span><span class="op" id="8104934">,</span>&nbsp;<span class="num" id="8104936">0x18</span><span class="op" id="8104940">,</span>&nbsp;<span class="num" id="8104942">0x7a</span><span class="op" id="8104946">,</span>&nbsp;<span class="num" id="8104948">0x86</span><span class="op" id="8104952">,</span>&nbsp;<span class="num" id="8104954">0x42</span><span class="op" id="8104958">,</span>&nbsp;<span class="num" id="8104960">0x6c</span><span class="op" id="8104964">,</span>&nbsp;<span class="num" id="8104966">0xca</span><span class="op" id="8104970">,</span>&nbsp;<span class="num" id="8104972">0x7d</span><span class="op" id="8104976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8104981">0x5e</span><span class="op" id="8104985">,</span>&nbsp;<span class="num" id="8104987">0x82</span><span class="op" id="8104991">,</span>&nbsp;<span class="num" id="8104993">0x3e</span><span class="op" id="8104997">,</span>&nbsp;<span class="num" id="8104999">0xba</span><span class="op" id="8105003">,</span>&nbsp;<span class="num" id="8105005">0x00</span><span class="op" id="8105009">,</span>&nbsp;<span class="num" id="8105011">0x44</span><span class="op" id="8105015">,</span>&nbsp;<span class="num" id="8105017">0x12</span><span class="op" id="8105021">,</span>&nbsp;<span class="num" id="8105023">0x67</span><span class="op" id="8105027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105032">0x12</span><span class="op" id="8105036">,</span>&nbsp;<span class="num" id="8105038">0x57</span><span class="op" id="8105042">,</span>&nbsp;<span class="num" id="8105044">0xb8</span><span class="op" id="8105048">,</span>&nbsp;<span class="num" id="8105050">0xd8</span><span class="op" id="8105054">,</span>&nbsp;<span class="num" id="8105056">0x60</span><span class="op" id="8105060">,</span>&nbsp;<span class="num" id="8105062">0xae</span><span class="op" id="8105066">,</span>&nbsp;<span class="num" id="8105068">0x4c</span><span class="op" id="8105072">,</span>&nbsp;<span class="num" id="8105074">0xbd</span><span class="op" id="8105078">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105083">0x4c</span><span class="op" id="8105087">,</span>&nbsp;<span class="num" id="8105089">0x49</span><span class="op" id="8105093">,</span>&nbsp;<span class="num" id="8105095">0x06</span><span class="op" id="8105099">,</span>&nbsp;<span class="num" id="8105101">0xbb</span><span class="op" id="8105105">,</span>&nbsp;<span class="num" id="8105107">0xc5</span><span class="op" id="8105111">,</span>&nbsp;<span class="num" id="8105113">0x35</span><span class="op" id="8105117">,</span>&nbsp;<span class="num" id="8105119">0xef</span><span class="op" id="8105123">,</span>&nbsp;<span class="num" id="8105125">0xe1</span><span class="op" id="8105129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105134">0x58</span><span class="op" id="8105138">,</span>&nbsp;<span class="num" id="8105140">0x7f</span><span class="op" id="8105144">,</span>&nbsp;<span class="num" id="8105146">0x08</span><span class="op" id="8105150">,</span>&nbsp;<span class="num" id="8105152">0xdb</span><span class="op" id="8105156">,</span>&nbsp;<span class="num" id="8105158">0x33</span><span class="op" id="8105162">,</span>&nbsp;<span class="num" id="8105164">0x95</span><span class="op" id="8105168">,</span>&nbsp;<span class="num" id="8105170">0x5c</span><span class="op" id="8105174">,</span>&nbsp;<span class="num" id="8105176">0xdb</span><span class="op" id="8105180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105185">0xcb</span><span class="op" id="8105189">,</span>&nbsp;<span class="num" id="8105191">0xad</span><span class="op" id="8105195">,</span>&nbsp;<span class="num" id="8105197">0x9b</span><span class="op" id="8105201">,</span>&nbsp;<span class="num" id="8105203">0x10</span><span class="op" id="8105207">,</span>&nbsp;<span class="num" id="8105209">0xf5</span><span class="op" id="8105213">,</span>&nbsp;<span class="num" id="8105215">0x3f</span><span class="op" id="8105219">,</span>&nbsp;<span class="num" id="8105221">0xc4</span><span class="op" id="8105225">,</span>&nbsp;<span class="num" id="8105227">0xe5</span><span class="op" id="8105231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105236">0x2c</span><span class="op" id="8105240">,</span>&nbsp;<span class="num" id="8105242">0x59</span><span class="op" id="8105246">,</span>&nbsp;<span class="num" id="8105248">0x15</span><span class="op" id="8105252">,</span>&nbsp;<span class="num" id="8105254">0x65</span><span class="op" id="8105258">,</span>&nbsp;<span class="num" id="8105260">0x51</span><span class="op" id="8105264">,</span>&nbsp;<span class="num" id="8105266">0x84</span><span class="op" id="8105270">,</span>&nbsp;<span class="num" id="8105272">0x87</span><span class="op" id="8105276">,</span>&nbsp;<span class="num" id="8105278">0xfe</span><span class="op" id="8105282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105287">0x08</span><span class="op" id="8105291">,</span>&nbsp;<span class="num" id="8105293">0x4d</span><span class="op" id="8105297">,</span>&nbsp;<span class="num" id="8105299">0x0e</span><span class="op" id="8105303">,</span>&nbsp;<span class="num" id="8105305">0x3f</span><span class="op" id="8105309">,</span>&nbsp;<span class="num" id="8105311">0x03</span><span class="op" id="8105315">,</span>&nbsp;<span class="num" id="8105317">0xde</span><span class="op" id="8105321">,</span>&nbsp;<span class="num" id="8105323">0xbc</span><span class="op" id="8105327">,</span>&nbsp;<span class="num" id="8105329">0xc9</span><span class="op" id="8105333">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105338">0xda</span><span class="op" id="8105342">,</span>&nbsp;<span class="num" id="8105344">0x1c</span><span class="op" id="8105348">,</span>&nbsp;<span class="num" id="8105350">0xe9</span><span class="op" id="8105354">,</span>&nbsp;<span class="num" id="8105356">0x0d</span><span class="op" id="8105360">,</span>&nbsp;<span class="num" id="8105362">0x08</span><span class="op" id="8105366">,</span>&nbsp;<span class="num" id="8105368">0x5c</span><span class="op" id="8105372">,</span>&nbsp;<span class="num" id="8105374">0x2d</span><span class="op" id="8105378">,</span>&nbsp;<span class="num" id="8105380">0x8a</span><span class="op" id="8105384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105389">0x19</span><span class="op" id="8105393">,</span>&nbsp;<span class="num" id="8105395">0xd8</span><span class="op" id="8105399">,</span>&nbsp;<span class="num" id="8105401">0x37</span><span class="op" id="8105405">,</span>&nbsp;<span class="num" id="8105407">0x30</span><span class="op" id="8105411">,</span>&nbsp;<span class="num" id="8105413">0x86</span><span class="op" id="8105417">,</span>&nbsp;<span class="num" id="8105419">0x16</span><span class="op" id="8105423">,</span>&nbsp;<span class="num" id="8105425">0x36</span><span class="op" id="8105429">,</span>&nbsp;<span class="num" id="8105431">0x92</span><span class="op" id="8105435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105440">0x14</span><span class="op" id="8105444">,</span>&nbsp;<span class="num" id="8105446">0x2b</span><span class="op" id="8105450">,</span>&nbsp;<span class="num" id="8105452">0xd8</span><span class="op" id="8105456">,</span>&nbsp;<span class="num" id="8105458">0xfc</span><span class="op" id="8105462">,</span>&nbsp;<span class="num" id="8105464">0x5d</span><span class="op" id="8105468">,</span>&nbsp;<span class="num" id="8105470">0x7a</span><span class="op" id="8105474">,</span>&nbsp;<span class="num" id="8105476">0x73</span><span class="op" id="8105480">,</span>&nbsp;<span class="num" id="8105482">0x49</span><span class="op" id="8105486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105491">0x6a</span><span class="op" id="8105495">,</span>&nbsp;<span class="num" id="8105497">0x8e</span><span class="op" id="8105501">,</span>&nbsp;<span class="num" id="8105503">0x59</span><span class="op" id="8105507">,</span>&nbsp;<span class="num" id="8105509">0xee</span><span class="op" id="8105513">,</span>&nbsp;<span class="num" id="8105515">0x7e</span><span class="op" id="8105519">,</span>&nbsp;<span class="num" id="8105521">0xcf</span><span class="op" id="8105525">,</span>&nbsp;<span class="num" id="8105527">0x6b</span><span class="op" id="8105531">,</span>&nbsp;<span class="num" id="8105533">0x94</span><span class="op" id="8105537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105542">0x06</span><span class="op" id="8105546">,</span>&nbsp;<span class="num" id="8105548">0x63</span><span class="op" id="8105552">,</span>&nbsp;<span class="num" id="8105554">0xf4</span><span class="op" id="8105558">,</span>&nbsp;<span class="num" id="8105560">0xa6</span><span class="op" id="8105564">,</span>&nbsp;<span class="num" id="8105566">0xbe</span><span class="op" id="8105570">,</span>&nbsp;<span class="num" id="8105572">0xe6</span><span class="op" id="8105576">,</span>&nbsp;<span class="num" id="8105578">0x5b</span><span class="op" id="8105582">,</span>&nbsp;<span class="num" id="8105584">0xd2</span><span class="op" id="8105588">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105593">0xc8</span><span class="op" id="8105597">,</span>&nbsp;<span class="num" id="8105599">0x5c</span><span class="op" id="8105603">,</span>&nbsp;<span class="num" id="8105605">0x46</span><span class="op" id="8105609">,</span>&nbsp;<span class="num" id="8105611">0x98</span><span class="op" id="8105615">,</span>&nbsp;<span class="num" id="8105617">0x6c</span><span class="op" id="8105621">,</span>&nbsp;<span class="num" id="8105623">0x1b</span><span class="op" id="8105627">,</span>&nbsp;<span class="num" id="8105629">0xef</span><span class="op" id="8105633">,</span>&nbsp;<span class="num" id="8105635">0x34</span><span class="op" id="8105639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105644">0x90</span><span class="op" id="8105648">,</span>&nbsp;<span class="num" id="8105650">0xd3</span><span class="op" id="8105654">,</span>&nbsp;<span class="num" id="8105656">0x7b</span><span class="op" id="8105660">,</span>&nbsp;<span class="num" id="8105662">0x38</span><span class="op" id="8105666">,</span>&nbsp;<span class="num" id="8105668">0xda</span><span class="op" id="8105672">,</span>&nbsp;<span class="num" id="8105674">0x85</span><span class="op" id="8105678">,</span>&nbsp;<span class="num" id="8105680">0xd3</span><span class="op" id="8105684">,</span>&nbsp;<span class="num" id="8105686">0x2e</span><span class="op" id="8105690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8105695">0x97</span><span class="op" id="8105699">,</span>&nbsp;<span class="num" id="8105701">0x39</span><span class="op" id="8105705">,</span>&nbsp;<span class="num" id="8105707">0xcb</span><span class="op" id="8105711">,</span>&nbsp;<span class="num" id="8105713">0x23</span><span class="op" id="8105717">,</span>&nbsp;<span class="num" id="8105719">0x4a</span><span class="op" id="8105723">,</span>&nbsp;<span class="num" id="8105725">0x2b</span><span class="op" id="8105729">,</span>&nbsp;<span class="num" id="8105731">0xe7</span><span class="op" id="8105735">,</span>&nbsp;<span class="num" id="8105737">0x40</span><span class="op" id="8105741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105745">}</span><span class="op" id="8105746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105749">}</span><span class="op" id="8105750">,</span><br>
<span class="lineno">75</span><span class="op" id="8105752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8105755">func</span>&nbsp;<span class="ident" id="8105760">testEncrypt</span><span class="op" id="8105771">(</span><span class="ident" id="8105772">t</span>&nbsp;<span class="op" id="8105774">*</span><span class="ident" id="8105775">testing</span><span class="op" id="8105782">.</span><span class="ident" id="8105783">T</span><span class="op" id="8105784">,</span>&nbsp;<span class="ident" id="8105786">desc</span>&nbsp;<span class="builtintype" id="8105791">string</span><span class="op" id="8105797">,</span>&nbsp;<span class="ident" id="8105799">c</span>&nbsp;<span class="op" id="8105801">*</span><span class="ident" id="8105802">Cipher</span><span class="op" id="8105808">,</span>&nbsp;<span class="ident" id="8105810">src</span><span class="op" id="8105813">,</span>&nbsp;<span class="ident" id="8105815">expect</span>&nbsp;<span class="op" id="8105822">[</span><span class="op" id="8105823">]</span><span class="builtintype" id="8105824">byte</span><span class="op" id="8105828">)</span>&nbsp;<span class="op" id="8105830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105833">dst</span>&nbsp;<span class="op" id="8105837">:=</span>&nbsp;<span class="builtinfunc" id="8105840">make</span><span class="op" id="8105844">(</span><span class="op" id="8105845">[</span><span class="op" id="8105846">]</span><span class="builtintype" id="8105847">byte</span><span class="op" id="8105851">,</span>&nbsp;<span class="builtinfunc" id="8105853">len</span><span class="op" id="8105856">(</span><span class="ident" id="8105857">src</span><span class="op" id="8105860">)</span><span class="op" id="8105861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105864">c</span><span class="op" id="8105865">.</span><span class="ident" id="8105866">XORKeyStream</span><span class="op" id="8105878">(</span><span class="ident" id="8105879">dst</span><span class="op" id="8105882">,</span>&nbsp;<span class="ident" id="8105884">src</span><span class="op" id="8105887">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105890">for</span>&nbsp;<span class="ident" id="8105894">i</span><span class="op" id="8105895">,</span>&nbsp;<span class="ident" id="8105897">v</span>&nbsp;<span class="op" id="8105899">:=</span>&nbsp;<span class="keyword" id="8105902">range</span>&nbsp;<span class="ident" id="8105908">dst</span>&nbsp;<span class="op" id="8105912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105916">if</span>&nbsp;<span class="ident" id="8105919">v</span>&nbsp;<span class="op" id="8105921">!=</span>&nbsp;<span class="ident" id="8105924">expect</span><span class="op" id="8105930">[</span><span class="ident" id="8105931">i</span><span class="op" id="8105932">]</span>&nbsp;<span class="op" id="8105934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105939">t</span><span class="op" id="8105940">.</span><span class="ident" id="8105941">Fatalf</span><span class="op" id="8105947">(</span><span class="string" id="8105948">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8105992">,</span>&nbsp;<span class="ident" id="8105994">desc</span><span class="op" id="8105998">,</span>&nbsp;<span class="ident" id="8106000">i</span><span class="op" id="8106001">,</span>&nbsp;<span class="ident" id="8106003">dst</span><span class="op" id="8106006">,</span>&nbsp;<span class="ident" id="8106008">expect</span><span class="op" id="8106014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106021">}</span><br>
<span class="lineno">85</span><span class="op" id="8106023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8106026">func</span>&nbsp;<span class="ident" id="8106031">TestGolden</span><span class="op" id="8106041">(</span><span class="ident" id="8106042">t</span>&nbsp;<span class="op" id="8106044">*</span><span class="ident" id="8106045">testing</span><span class="op" id="8106052">.</span><span class="ident" id="8106053">T</span><span class="op" id="8106054">)</span>&nbsp;<span class="op" id="8106056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106059">for</span>&nbsp;<span class="ident" id="8106063">gi</span><span class="op" id="8106065">,</span>&nbsp;<span class="ident" id="8106067">g</span>&nbsp;<span class="op" id="8106069">:=</span>&nbsp;<span class="keyword" id="8106072">range</span>&nbsp;<span class="ident" id="8106078">golden</span>&nbsp;<span class="op" id="8106085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106089">data</span>&nbsp;<span class="op" id="8106094">:=</span>&nbsp;<span class="builtinfunc" id="8106097">make</span><span class="op" id="8106101">(</span><span class="op" id="8106102">[</span><span class="op" id="8106103">]</span><span class="builtintype" id="8106104">byte</span><span class="op" id="8106108">,</span>&nbsp;<span class="builtinfunc" id="8106110">len</span><span class="op" id="8106113">(</span><span class="ident" id="8106114">g</span><span class="op" id="8106115">.</span><span class="ident" id="8106116">keystream</span><span class="op" id="8106125">)</span><span class="op" id="8106126">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106130">for</span>&nbsp;<span class="ident" id="8106134">i</span>&nbsp;<span class="op" id="8106136">:=</span>&nbsp;<span class="keyword" id="8106139">range</span>&nbsp;<span class="ident" id="8106145">data</span>&nbsp;<span class="op" id="8106150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106155">data</span><span class="op" id="8106159">[</span><span class="ident" id="8106160">i</span><span class="op" id="8106161">]</span>&nbsp;<span class="op" id="8106163">=</span>&nbsp;<span class="builtintype" id="8106165">byte</span><span class="op" id="8106169">(</span><span class="ident" id="8106170">i</span><span class="op" id="8106171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106180">expect</span>&nbsp;<span class="op" id="8106187">:=</span>&nbsp;<span class="builtinfunc" id="8106190">make</span><span class="op" id="8106194">(</span><span class="op" id="8106195">[</span><span class="op" id="8106196">]</span><span class="builtintype" id="8106197">byte</span><span class="op" id="8106201">,</span>&nbsp;<span class="builtinfunc" id="8106203">len</span><span class="op" id="8106206">(</span><span class="ident" id="8106207">g</span><span class="op" id="8106208">.</span><span class="ident" id="8106209">keystream</span><span class="op" id="8106218">)</span><span class="op" id="8106219">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106223">for</span>&nbsp;<span class="ident" id="8106227">i</span>&nbsp;<span class="op" id="8106229">:=</span>&nbsp;<span class="keyword" id="8106232">range</span>&nbsp;<span class="ident" id="8106238">expect</span>&nbsp;<span class="op" id="8106245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106250">expect</span><span class="op" id="8106256">[</span><span class="ident" id="8106257">i</span><span class="op" id="8106258">]</span>&nbsp;<span class="op" id="8106260">=</span>&nbsp;<span class="builtintype" id="8106262">byte</span><span class="op" id="8106266">(</span><span class="ident" id="8106267">i</span><span class="op" id="8106268">)</span>&nbsp;<span class="op" id="8106270">^</span>&nbsp;<span class="ident" id="8106272">g</span><span class="op" id="8106273">.</span><span class="ident" id="8106274">keystream</span><span class="op" id="8106283">[</span><span class="ident" id="8106284">i</span><span class="op" id="8106285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106294">for</span>&nbsp;<span class="ident" id="8106298">size</span>&nbsp;<span class="op" id="8106303">:=</span>&nbsp;<span class="num" id="8106306">1</span><span class="op" id="8106307">;</span>&nbsp;<span class="ident" id="8106309">size</span>&nbsp;<span class="op" id="8106314">&lt;=</span>&nbsp;<span class="builtinfunc" id="8106317">len</span><span class="op" id="8106320">(</span><span class="ident" id="8106321">g</span><span class="op" id="8106322">.</span><span class="ident" id="8106323">keystream</span><span class="op" id="8106332">)</span><span class="op" id="8106333">;</span>&nbsp;<span class="ident" id="8106335">size</span><span class="op" id="8106339">++</span>&nbsp;<span class="op" id="8106342">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106347">c</span><span class="op" id="8106348">,</span>&nbsp;<span class="ident" id="8106350">err</span>&nbsp;<span class="op" id="8106354">:=</span>&nbsp;<span class="ident" id="8106357">NewCipher</span><span class="op" id="8106366">(</span><span class="ident" id="8106367">g</span><span class="op" id="8106368">.</span><span class="ident" id="8106369">key</span><span class="op" id="8106372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106377">if</span>&nbsp;<span class="ident" id="8106380">err</span>&nbsp;<span class="op" id="8106384">!=</span>&nbsp;<span class="ident" id="8106387">nil</span>&nbsp;<span class="op" id="8106391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106397">t</span><span class="op" id="8106398">.</span><span class="ident" id="8106399">Fatalf</span><span class="op" id="8106405">(</span><span class="string" id="8106406">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8106426">,</span>&nbsp;<span class="ident" id="8106428">gi</span><span class="op" id="8106430">,</span>&nbsp;<span class="ident" id="8106432">err</span><span class="op" id="8106435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106446">off</span>&nbsp;<span class="op" id="8106450">:=</span>&nbsp;<span class="num" id="8106453">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106458">for</span>&nbsp;<span class="ident" id="8106462">off</span>&nbsp;<span class="op" id="8106466">&lt;</span>&nbsp;<span class="builtinfunc" id="8106468">len</span><span class="op" id="8106471">(</span><span class="ident" id="8106472">g</span><span class="op" id="8106473">.</span><span class="ident" id="8106474">keystream</span><span class="op" id="8106483">)</span>&nbsp;<span class="op" id="8106485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106491">n</span>&nbsp;<span class="op" id="8106493">:=</span>&nbsp;<span class="builtinfunc" id="8106496">len</span><span class="op" id="8106499">(</span><span class="ident" id="8106500">g</span><span class="op" id="8106501">.</span><span class="ident" id="8106502">keystream</span><span class="op" id="8106511">)</span>&nbsp;<span class="op" id="8106513">-</span>&nbsp;<span class="ident" id="8106515">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106523">if</span>&nbsp;<span class="ident" id="8106526">n</span>&nbsp;<span class="op" id="8106528">&gt;</span>&nbsp;<span class="ident" id="8106530">size</span>&nbsp;<span class="op" id="8106535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106542">n</span>&nbsp;<span class="op" id="8106544">=</span>&nbsp;<span class="ident" id="8106546">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106561">desc</span>&nbsp;<span class="op" id="8106566">:=</span>&nbsp;<span class="ident" id="8106569">fmt</span><span class="op" id="8106572">.</span><span class="ident" id="8106573">Sprintf</span><span class="op" id="8106580">(</span><span class="string" id="8106581">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8106594">,</span>&nbsp;<span class="ident" id="8106596">gi</span><span class="op" id="8106598">,</span>&nbsp;<span class="ident" id="8106600">off</span><span class="op" id="8106603">,</span>&nbsp;<span class="ident" id="8106605">off</span><span class="op" id="8106608">+</span><span class="ident" id="8106609">n</span><span class="op" id="8106610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106616">testEncrypt</span><span class="op" id="8106627">(</span><span class="ident" id="8106628">t</span><span class="op" id="8106629">,</span>&nbsp;<span class="ident" id="8106631">desc</span><span class="op" id="8106635">,</span>&nbsp;<span class="ident" id="8106637">c</span><span class="op" id="8106638">,</span>&nbsp;<span class="ident" id="8106640">data</span><span class="op" id="8106644">[</span><span class="ident" id="8106645">off</span><span class="op" id="8106648">:</span><span class="ident" id="8106649">off</span><span class="op" id="8106652">+</span><span class="ident" id="8106653">n</span><span class="op" id="8106654">]</span><span class="op" id="8106655">,</span>&nbsp;<span class="ident" id="8106657">expect</span><span class="op" id="8106663">[</span><span class="ident" id="8106664">off</span><span class="op" id="8106667">:</span><span class="ident" id="8106668">off</span><span class="op" id="8106671">+</span><span class="ident" id="8106672">n</span><span class="op" id="8106673">]</span><span class="op" id="8106674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106680">off</span>&nbsp;<span class="op" id="8106684">+=</span>&nbsp;<span class="ident" id="8106687">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106692">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106699">}</span><br>
<span class="lineno"></span><span class="op" id="8106701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8106704">func</span>&nbsp;<span class="ident" id="8106709">TestBlock</span><span class="op" id="8106718">(</span><span class="ident" id="8106719">t</span>&nbsp;<span class="op" id="8106721">*</span><span class="ident" id="8106722">testing</span><span class="op" id="8106729">.</span><span class="ident" id="8106730">T</span><span class="op" id="8106731">)</span>&nbsp;<span class="op" id="8106733">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106736">testBlock</span><span class="op" id="8106745">(</span><span class="ident" id="8106746">t</span><span class="op" id="8106747">,</span>&nbsp;<span class="op" id="8106749">(</span><span class="op" id="8106750">*</span><span class="ident" id="8106751">Cipher</span><span class="op" id="8106757">)</span><span class="op" id="8106758">.</span><span class="ident" id="8106759">XORKeyStream</span><span class="op" id="8106771">)</span><br>
<span class="lineno"></span><span class="op" id="8106773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8106776">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8106805">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8106872">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8106916">func</span>&nbsp;<span class="ident" id="8106921">TestBlockGeneric</span><span class="op" id="8106937">(</span><span class="ident" id="8106938">t</span>&nbsp;<span class="op" id="8106940">*</span><span class="ident" id="8106941">testing</span><span class="op" id="8106948">.</span><span class="ident" id="8106949">T</span><span class="op" id="8106950">)</span>&nbsp;<span class="op" id="8106952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106955">testBlock</span><span class="op" id="8106964">(</span><span class="ident" id="8106965">t</span><span class="op" id="8106966">,</span>&nbsp;<span class="op" id="8106968">(</span><span class="op" id="8106969">*</span><span class="ident" id="8106970">Cipher</span><span class="op" id="8106976">)</span><span class="op" id="8106977">.</span><span class="ident" id="8106978">xorKeyStreamGeneric</span><span class="op" id="8106997">)</span><br>
<span class="lineno"></span><span class="op" id="8106999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8107002">func</span>&nbsp;<span class="ident" id="8107007">testBlock</span><span class="op" id="8107016">(</span><span class="ident" id="8107017">t</span>&nbsp;<span class="op" id="8107019">*</span><span class="ident" id="8107020">testing</span><span class="op" id="8107027">.</span><span class="ident" id="8107028">T</span><span class="op" id="8107029">,</span>&nbsp;<span class="ident" id="8107031">xor</span>&nbsp;<span class="keyword" id="8107035">func</span><span class="op" id="8107039">(</span><span class="ident" id="8107040">c</span>&nbsp;<span class="op" id="8107042">*</span><span class="ident" id="8107043">Cipher</span><span class="op" id="8107049">,</span>&nbsp;<span class="ident" id="8107051">dst</span><span class="op" id="8107054">,</span>&nbsp;<span class="ident" id="8107056">src</span>&nbsp;<span class="op" id="8107060">[</span><span class="op" id="8107061">]</span><span class="builtintype" id="8107062">byte</span><span class="op" id="8107066">)</span><span class="op" id="8107067">)</span>&nbsp;<span class="op" id="8107069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107072">c1a</span><span class="op" id="8107075">,</span>&nbsp;<span class="ident" id="8107077">_</span>&nbsp;<span class="op" id="8107079">:=</span>&nbsp;<span class="ident" id="8107082">NewCipher</span><span class="op" id="8107091">(</span><span class="ident" id="8107092">golden</span><span class="op" id="8107098">[</span><span class="num" id="8107099">0</span><span class="op" id="8107100">]</span><span class="op" id="8107101">.</span><span class="ident" id="8107102">key</span><span class="op" id="8107105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107108">c1b</span><span class="op" id="8107111">,</span>&nbsp;<span class="ident" id="8107113">_</span>&nbsp;<span class="op" id="8107115">:=</span>&nbsp;<span class="ident" id="8107118">NewCipher</span><span class="op" id="8107127">(</span><span class="ident" id="8107128">golden</span><span class="op" id="8107134">[</span><span class="num" id="8107135">1</span><span class="op" id="8107136">]</span><span class="op" id="8107137">.</span><span class="ident" id="8107138">key</span><span class="op" id="8107141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107144">data1</span>&nbsp;<span class="op" id="8107150">:=</span>&nbsp;<span class="builtinfunc" id="8107153">make</span><span class="op" id="8107157">(</span><span class="op" id="8107158">[</span><span class="op" id="8107159">]</span><span class="builtintype" id="8107160">byte</span><span class="op" id="8107164">,</span>&nbsp;<span class="num" id="8107166">1</span><span class="op" id="8107167">&lt;&lt;</span><span class="num" id="8107169">20</span><span class="op" id="8107171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8107174">for</span>&nbsp;<span class="ident" id="8107178">i</span>&nbsp;<span class="op" id="8107180">:=</span>&nbsp;<span class="keyword" id="8107183">range</span>&nbsp;<span class="ident" id="8107189">data1</span>&nbsp;<span class="op" id="8107195">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107199">xor</span><span class="op" id="8107202">(</span><span class="ident" id="8107203">c1a</span><span class="op" id="8107206">,</span>&nbsp;<span class="ident" id="8107208">data1</span><span class="op" id="8107213">[</span><span class="ident" id="8107214">i</span><span class="op" id="8107215">:</span><span class="ident" id="8107216">i</span><span class="op" id="8107217">+</span><span class="num" id="8107218">1</span><span class="op" id="8107219">]</span><span class="op" id="8107220">,</span>&nbsp;<span class="ident" id="8107222">data1</span><span class="op" id="8107227">[</span><span class="ident" id="8107228">i</span><span class="op" id="8107229">:</span><span class="ident" id="8107230">i</span><span class="op" id="8107231">+</span><span class="num" id="8107232">1</span><span class="op" id="8107233">]</span><span class="op" id="8107234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107238">xor</span><span class="op" id="8107241">(</span><span class="ident" id="8107242">c1b</span><span class="op" id="8107245">,</span>&nbsp;<span class="ident" id="8107247">data1</span><span class="op" id="8107252">[</span><span class="ident" id="8107253">i</span><span class="op" id="8107254">:</span><span class="ident" id="8107255">i</span><span class="op" id="8107256">+</span><span class="num" id="8107257">1</span><span class="op" id="8107258">]</span><span class="op" id="8107259">,</span>&nbsp;<span class="ident" id="8107261">data1</span><span class="op" id="8107266">[</span><span class="ident" id="8107267">i</span><span class="op" id="8107268">:</span><span class="ident" id="8107269">i</span><span class="op" id="8107270">+</span><span class="num" id="8107271">1</span><span class="op" id="8107272">]</span><span class="op" id="8107273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8107276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107280">c2a</span><span class="op" id="8107283">,</span>&nbsp;<span class="ident" id="8107285">_</span>&nbsp;<span class="op" id="8107287">:=</span>&nbsp;<span class="ident" id="8107290">NewCipher</span><span class="op" id="8107299">(</span><span class="ident" id="8107300">golden</span><span class="op" id="8107306">[</span><span class="num" id="8107307">0</span><span class="op" id="8107308">]</span><span class="op" id="8107309">.</span><span class="ident" id="8107310">key</span><span class="op" id="8107313">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107316">c2b</span><span class="op" id="8107319">,</span>&nbsp;<span class="ident" id="8107321">_</span>&nbsp;<span class="op" id="8107323">:=</span>&nbsp;<span class="ident" id="8107326">NewCipher</span><span class="op" id="8107335">(</span><span class="ident" id="8107336">golden</span><span class="op" id="8107342">[</span><span class="num" id="8107343">1</span><span class="op" id="8107344">]</span><span class="op" id="8107345">.</span><span class="ident" id="8107346">key</span><span class="op" id="8107349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107352">data2</span>&nbsp;<span class="op" id="8107358">:=</span>&nbsp;<span class="builtinfunc" id="8107361">make</span><span class="op" id="8107365">(</span><span class="op" id="8107366">[</span><span class="op" id="8107367">]</span><span class="builtintype" id="8107368">byte</span><span class="op" id="8107372">,</span>&nbsp;<span class="num" id="8107374">1</span><span class="op" id="8107375">&lt;&lt;</span><span class="num" id="8107377">20</span><span class="op" id="8107379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107382">xor</span><span class="op" id="8107385">(</span><span class="ident" id="8107386">c2a</span><span class="op" id="8107389">,</span>&nbsp;<span class="ident" id="8107391">data2</span><span class="op" id="8107396">,</span>&nbsp;<span class="ident" id="8107398">data2</span><span class="op" id="8107403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107406">xor</span><span class="op" id="8107409">(</span><span class="ident" id="8107410">c2b</span><span class="op" id="8107413">,</span>&nbsp;<span class="ident" id="8107415">data2</span><span class="op" id="8107420">,</span>&nbsp;<span class="ident" id="8107422">data2</span><span class="op" id="8107427">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8107431">if</span>&nbsp;<span class="op" id="8107434">!</span><span class="ident" id="8107435">bytes</span><span class="op" id="8107440">.</span><span class="ident" id="8107441">Equal</span><span class="op" id="8107446">(</span><span class="ident" id="8107447">data1</span><span class="op" id="8107452">,</span>&nbsp;<span class="ident" id="8107454">data2</span><span class="op" id="8107459">)</span>&nbsp;<span class="op" id="8107461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107465">t</span><span class="op" id="8107466">.</span><span class="ident" id="8107467">Fatalf</span><span class="op" id="8107473">(</span><span class="string" id="8107474">&#34;bad&nbsp;block&#34;</span><span class="op" id="8107485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8107488">}</span><br>
<span class="lineno"></span><span class="op" id="8107490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8107493">func</span>&nbsp;<span class="ident" id="8107498">benchmark</span><span class="op" id="8107507">(</span><span class="ident" id="8107508">b</span>&nbsp;<span class="op" id="8107510">*</span><span class="ident" id="8107511">testing</span><span class="op" id="8107518">.</span><span class="ident" id="8107519">B</span><span class="op" id="8107520">,</span>&nbsp;<span class="ident" id="8107522">size</span>&nbsp;<span class="ident" id="8107527">int64</span><span class="op" id="8107532">)</span>&nbsp;<span class="op" id="8107534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107537">buf</span>&nbsp;<span class="op" id="8107541">:=</span>&nbsp;<span class="builtinfunc" id="8107544">make</span><span class="op" id="8107548">(</span><span class="op" id="8107549">[</span><span class="op" id="8107550">]</span><span class="builtintype" id="8107551">byte</span><span class="op" id="8107555">,</span>&nbsp;<span class="ident" id="8107557">size</span><span class="op" id="8107561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107564">c</span><span class="op" id="8107565">,</span>&nbsp;<span class="ident" id="8107567">err</span>&nbsp;<span class="op" id="8107571">:=</span>&nbsp;<span class="ident" id="8107574">NewCipher</span><span class="op" id="8107583">(</span><span class="ident" id="8107584">golden</span><span class="op" id="8107590">[</span><span class="num" id="8107591">0</span><span class="op" id="8107592">]</span><span class="op" id="8107593">.</span><span class="ident" id="8107594">key</span><span class="op" id="8107597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8107600">if</span>&nbsp;<span class="ident" id="8107603">err</span>&nbsp;<span class="op" id="8107607">!=</span>&nbsp;<span class="ident" id="8107610">nil</span>&nbsp;<span class="op" id="8107614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8107618">panic</span><span class="op" id="8107623">(</span><span class="ident" id="8107624">err</span><span class="op" id="8107627">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8107630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107633">b</span><span class="op" id="8107634">.</span><span class="ident" id="8107635">SetBytes</span><span class="op" id="8107643">(</span><span class="ident" id="8107644">size</span><span class="op" id="8107648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8107652">for</span>&nbsp;<span class="ident" id="8107656">i</span>&nbsp;<span class="op" id="8107658">:=</span>&nbsp;<span class="num" id="8107661">0</span><span class="op" id="8107662">;</span>&nbsp;<span class="ident" id="8107664">i</span>&nbsp;<span class="op" id="8107666">&lt;</span>&nbsp;<span class="ident" id="8107668">b</span><span class="op" id="8107669">.</span><span class="ident" id="8107670">N</span><span class="op" id="8107671">;</span>&nbsp;<span class="ident" id="8107673">i</span><span class="op" id="8107674">++</span>&nbsp;<span class="op" id="8107677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107681">c</span><span class="op" id="8107682">.</span><span class="ident" id="8107683">XORKeyStream</span><span class="op" id="8107695">(</span><span class="ident" id="8107696">buf</span><span class="op" id="8107699">,</span>&nbsp;<span class="ident" id="8107701">buf</span><span class="op" id="8107704">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8107707">}</span><br>
<span class="lineno"></span><span class="op" id="8107709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8107712">func</span>&nbsp;<span class="ident" id="8107717">BenchmarkRC4_128</span><span class="op" id="8107733">(</span><span class="ident" id="8107734">b</span>&nbsp;<span class="op" id="8107736">*</span><span class="ident" id="8107737">testing</span><span class="op" id="8107744">.</span><span class="ident" id="8107745">B</span><span class="op" id="8107746">)</span>&nbsp;<span class="op" id="8107748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107751">benchmark</span><span class="op" id="8107760">(</span><span class="ident" id="8107761">b</span><span class="op" id="8107762">,</span>&nbsp;<span class="num" id="8107764">128</span><span class="op" id="8107767">)</span><br>
<span class="lineno">165</span><span class="op" id="8107769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8107772">func</span>&nbsp;<span class="ident" id="8107777">BenchmarkRC4_1K</span><span class="op" id="8107792">(</span><span class="ident" id="8107793">b</span>&nbsp;<span class="op" id="8107795">*</span><span class="ident" id="8107796">testing</span><span class="op" id="8107803">.</span><span class="ident" id="8107804">B</span><span class="op" id="8107805">)</span>&nbsp;<span class="op" id="8107807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107810">benchmark</span><span class="op" id="8107819">(</span><span class="ident" id="8107820">b</span><span class="op" id="8107821">,</span>&nbsp;<span class="num" id="8107823">1024</span><span class="op" id="8107827">)</span><br>
<span class="lineno"></span><span class="op" id="8107829">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8107832">func</span>&nbsp;<span class="ident" id="8107837">BenchmarkRC4_8K</span><span class="op" id="8107852">(</span><span class="ident" id="8107853">b</span>&nbsp;<span class="op" id="8107855">*</span><span class="ident" id="8107856">testing</span><span class="op" id="8107863">.</span><span class="ident" id="8107864">B</span><span class="op" id="8107865">)</span>&nbsp;<span class="op" id="8107867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8107870">benchmark</span><span class="op" id="8107879">(</span><span class="ident" id="8107880">b</span><span class="op" id="8107881">,</span>&nbsp;<span class="num" id="8107883">8096</span><span class="op" id="8107887">)</span><br>
<span class="lineno"></span><span class="op" id="8107889">}</span>
</div>
</body>
</html>
