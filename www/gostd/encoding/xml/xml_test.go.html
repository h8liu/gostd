<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7258615">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7258671">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7258725">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7258776">package</span>&nbsp;<span class="ident" id="7258784">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258789">import</span>&nbsp;<span class="op" id="7258796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258799">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258808">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258815">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258821">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258832">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258843">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258854">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7258869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258872">const</span>&nbsp;<span class="ident" id="7258878">testInput</span>&nbsp;<span class="op" id="7258888">=</span>&nbsp;<span class="string" id="7258890">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="7259107">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7259110">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="7259119">+</span>&nbsp;<span class="string" id="7259121">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7259411">var</span>&nbsp;<span class="ident" id="7259415">testEntity</span>&nbsp;<span class="op" id="7259426">=</span>&nbsp;<span class="keyword" id="7259428">map</span><span class="op" id="7259431">[</span><span class="builtintype" id="7259432">string</span><span class="op" id="7259438">]</span><span class="builtintype" id="7259439">string</span><span class="op" id="7259445">{</span><span class="string" id="7259446">&#34;何&#34;</span><span class="op" id="7259451">:</span>&nbsp;<span class="string" id="7259453">&#34;What&#34;</span><span class="op" id="7259459">,</span>&nbsp;<span class="string" id="7259461">&#34;is-it&#34;</span><span class="op" id="7259468">:</span>&nbsp;<span class="string" id="7259470">&#34;is&nbsp;it?&#34;</span><span class="op" id="7259478">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7259481">var</span>&nbsp;<span class="ident" id="7259485">rawTokens</span>&nbsp;<span class="op" id="7259495">=</span>&nbsp;<span class="op" id="7259497">[</span><span class="op" id="7259498">]</span><span class="ident" id="7259499">Token</span><span class="op" id="7259504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259507">CharData</span><span class="op" id="7259515">(</span><span class="string" id="7259516">&#34;\n&#34;</span><span class="op" id="7259520">)</span><span class="op" id="7259521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259524">ProcInst</span><span class="op" id="7259532">{</span><span class="string" id="7259533">&#34;xml&#34;</span><span class="op" id="7259538">,</span>&nbsp;<span class="op" id="7259540">[</span><span class="op" id="7259541">]</span><span class="builtintype" id="7259542">byte</span><span class="op" id="7259546">(</span><span class="string" id="7259547">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7259579">)</span><span class="op" id="7259580">}</span><span class="op" id="7259581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259584">CharData</span><span class="op" id="7259592">(</span><span class="string" id="7259593">&#34;\n&#34;</span><span class="op" id="7259597">)</span><span class="op" id="7259598">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259601">Directive</span><span class="op" id="7259610">(</span><span class="string" id="7259611">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7259733">)</span><span class="op" id="7259734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259737">CharData</span><span class="op" id="7259745">(</span><span class="string" id="7259746">&#34;\n&#34;</span><span class="op" id="7259750">)</span><span class="op" id="7259751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259754">StartElement</span><span class="op" id="7259766">{</span><span class="ident" id="7259767">Name</span><span class="op" id="7259771">{</span><span class="string" id="7259772">&#34;&#34;</span><span class="op" id="7259774">,</span>&nbsp;<span class="string" id="7259776">&#34;body&#34;</span><span class="op" id="7259782">}</span><span class="op" id="7259783">,</span>&nbsp;<span class="op" id="7259785">[</span><span class="op" id="7259786">]</span><span class="ident" id="7259787">Attr</span><span class="op" id="7259791">{</span><span class="op" id="7259792">{</span><span class="ident" id="7259793">Name</span><span class="op" id="7259797">{</span><span class="string" id="7259798">&#34;xmlns&#34;</span><span class="op" id="7259805">,</span>&nbsp;<span class="string" id="7259807">&#34;foo&#34;</span><span class="op" id="7259812">}</span><span class="op" id="7259813">,</span>&nbsp;<span class="string" id="7259815">&#34;ns1&#34;</span><span class="op" id="7259820">}</span><span class="op" id="7259821">,</span>&nbsp;<span class="op" id="7259823">{</span><span class="ident" id="7259824">Name</span><span class="op" id="7259828">{</span><span class="string" id="7259829">&#34;&#34;</span><span class="op" id="7259831">,</span>&nbsp;<span class="string" id="7259833">&#34;xmlns&#34;</span><span class="op" id="7259840">}</span><span class="op" id="7259841">,</span>&nbsp;<span class="string" id="7259843">&#34;ns2&#34;</span><span class="op" id="7259848">}</span><span class="op" id="7259849">,</span>&nbsp;<span class="op" id="7259851">{</span><span class="ident" id="7259852">Name</span><span class="op" id="7259856">{</span><span class="string" id="7259857">&#34;xmlns&#34;</span><span class="op" id="7259864">,</span>&nbsp;<span class="string" id="7259866">&#34;tag&#34;</span><span class="op" id="7259871">}</span><span class="op" id="7259872">,</span>&nbsp;<span class="string" id="7259874">&#34;ns3&#34;</span><span class="op" id="7259879">}</span><span class="op" id="7259880">}</span><span class="op" id="7259881">}</span><span class="op" id="7259882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259885">CharData</span><span class="op" id="7259893">(</span><span class="string" id="7259894">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7259900">)</span><span class="op" id="7259901">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259904">StartElement</span><span class="op" id="7259916">{</span><span class="ident" id="7259917">Name</span><span class="op" id="7259921">{</span><span class="string" id="7259922">&#34;&#34;</span><span class="op" id="7259924">,</span>&nbsp;<span class="string" id="7259926">&#34;hello&#34;</span><span class="op" id="7259933">}</span><span class="op" id="7259934">,</span>&nbsp;<span class="op" id="7259936">[</span><span class="op" id="7259937">]</span><span class="ident" id="7259938">Attr</span><span class="op" id="7259942">{</span><span class="op" id="7259943">{</span><span class="ident" id="7259944">Name</span><span class="op" id="7259948">{</span><span class="string" id="7259949">&#34;&#34;</span><span class="op" id="7259951">,</span>&nbsp;<span class="string" id="7259953">&#34;lang&#34;</span><span class="op" id="7259959">}</span><span class="op" id="7259960">,</span>&nbsp;<span class="string" id="7259962">&#34;en&#34;</span><span class="op" id="7259966">}</span><span class="op" id="7259967">}</span><span class="op" id="7259968">}</span><span class="op" id="7259969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259972">CharData</span><span class="op" id="7259980">(</span><span class="string" id="7259981">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7260004">)</span><span class="op" id="7260005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260008">EndElement</span><span class="op" id="7260018">{</span><span class="ident" id="7260019">Name</span><span class="op" id="7260023">{</span><span class="string" id="7260024">&#34;&#34;</span><span class="op" id="7260026">,</span>&nbsp;<span class="string" id="7260028">&#34;hello&#34;</span><span class="op" id="7260035">}</span><span class="op" id="7260036">}</span><span class="op" id="7260037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260040">CharData</span><span class="op" id="7260048">(</span><span class="string" id="7260049">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260055">)</span><span class="op" id="7260056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260059">StartElement</span><span class="op" id="7260071">{</span><span class="ident" id="7260072">Name</span><span class="op" id="7260076">{</span><span class="string" id="7260077">&#34;&#34;</span><span class="op" id="7260079">,</span>&nbsp;<span class="string" id="7260081">&#34;query&#34;</span><span class="op" id="7260088">}</span><span class="op" id="7260089">,</span>&nbsp;<span class="op" id="7260091">[</span><span class="op" id="7260092">]</span><span class="ident" id="7260093">Attr</span><span class="op" id="7260097">{</span><span class="op" id="7260098">}</span><span class="op" id="7260099">}</span><span class="op" id="7260100">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260103">CharData</span><span class="op" id="7260111">(</span><span class="string" id="7260112">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7260125">)</span><span class="op" id="7260126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260129">EndElement</span><span class="op" id="7260139">{</span><span class="ident" id="7260140">Name</span><span class="op" id="7260144">{</span><span class="string" id="7260145">&#34;&#34;</span><span class="op" id="7260147">,</span>&nbsp;<span class="string" id="7260149">&#34;query&#34;</span><span class="op" id="7260156">}</span><span class="op" id="7260157">}</span><span class="op" id="7260158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260161">CharData</span><span class="op" id="7260169">(</span><span class="string" id="7260170">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260176">)</span><span class="op" id="7260177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260180">StartElement</span><span class="op" id="7260192">{</span><span class="ident" id="7260193">Name</span><span class="op" id="7260197">{</span><span class="string" id="7260198">&#34;&#34;</span><span class="op" id="7260200">,</span>&nbsp;<span class="string" id="7260202">&#34;goodbye&#34;</span><span class="op" id="7260211">}</span><span class="op" id="7260212">,</span>&nbsp;<span class="op" id="7260214">[</span><span class="op" id="7260215">]</span><span class="ident" id="7260216">Attr</span><span class="op" id="7260220">{</span><span class="op" id="7260221">}</span><span class="op" id="7260222">}</span><span class="op" id="7260223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260226">EndElement</span><span class="op" id="7260236">{</span><span class="ident" id="7260237">Name</span><span class="op" id="7260241">{</span><span class="string" id="7260242">&#34;&#34;</span><span class="op" id="7260244">,</span>&nbsp;<span class="string" id="7260246">&#34;goodbye&#34;</span><span class="op" id="7260255">}</span><span class="op" id="7260256">}</span><span class="op" id="7260257">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260260">CharData</span><span class="op" id="7260268">(</span><span class="string" id="7260269">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260275">)</span><span class="op" id="7260276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260279">StartElement</span><span class="op" id="7260291">{</span><span class="ident" id="7260292">Name</span><span class="op" id="7260296">{</span><span class="string" id="7260297">&#34;&#34;</span><span class="op" id="7260299">,</span>&nbsp;<span class="string" id="7260301">&#34;outer&#34;</span><span class="op" id="7260308">}</span><span class="op" id="7260309">,</span>&nbsp;<span class="op" id="7260311">[</span><span class="op" id="7260312">]</span><span class="ident" id="7260313">Attr</span><span class="op" id="7260317">{</span><span class="op" id="7260318">{</span><span class="ident" id="7260319">Name</span><span class="op" id="7260323">{</span><span class="string" id="7260324">&#34;foo&#34;</span><span class="op" id="7260329">,</span>&nbsp;<span class="string" id="7260331">&#34;attr&#34;</span><span class="op" id="7260337">}</span><span class="op" id="7260338">,</span>&nbsp;<span class="string" id="7260340">&#34;value&#34;</span><span class="op" id="7260347">}</span><span class="op" id="7260348">,</span>&nbsp;<span class="op" id="7260350">{</span><span class="ident" id="7260351">Name</span><span class="op" id="7260355">{</span><span class="string" id="7260356">&#34;xmlns&#34;</span><span class="op" id="7260363">,</span>&nbsp;<span class="string" id="7260365">&#34;tag&#34;</span><span class="op" id="7260370">}</span><span class="op" id="7260371">,</span>&nbsp;<span class="string" id="7260373">&#34;ns4&#34;</span><span class="op" id="7260378">}</span><span class="op" id="7260379">}</span><span class="op" id="7260380">}</span><span class="op" id="7260381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260384">CharData</span><span class="op" id="7260392">(</span><span class="string" id="7260393">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7260401">)</span><span class="op" id="7260402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260405">StartElement</span><span class="op" id="7260417">{</span><span class="ident" id="7260418">Name</span><span class="op" id="7260422">{</span><span class="string" id="7260423">&#34;&#34;</span><span class="op" id="7260425">,</span>&nbsp;<span class="string" id="7260427">&#34;inner&#34;</span><span class="op" id="7260434">}</span><span class="op" id="7260435">,</span>&nbsp;<span class="op" id="7260437">[</span><span class="op" id="7260438">]</span><span class="ident" id="7260439">Attr</span><span class="op" id="7260443">{</span><span class="op" id="7260444">}</span><span class="op" id="7260445">}</span><span class="op" id="7260446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260449">EndElement</span><span class="op" id="7260459">{</span><span class="ident" id="7260460">Name</span><span class="op" id="7260464">{</span><span class="string" id="7260465">&#34;&#34;</span><span class="op" id="7260467">,</span>&nbsp;<span class="string" id="7260469">&#34;inner&#34;</span><span class="op" id="7260476">}</span><span class="op" id="7260477">}</span><span class="op" id="7260478">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260481">CharData</span><span class="op" id="7260489">(</span><span class="string" id="7260490">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260496">)</span><span class="op" id="7260497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260500">EndElement</span><span class="op" id="7260510">{</span><span class="ident" id="7260511">Name</span><span class="op" id="7260515">{</span><span class="string" id="7260516">&#34;&#34;</span><span class="op" id="7260518">,</span>&nbsp;<span class="string" id="7260520">&#34;outer&#34;</span><span class="op" id="7260527">}</span><span class="op" id="7260528">}</span><span class="op" id="7260529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260532">CharData</span><span class="op" id="7260540">(</span><span class="string" id="7260541">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260547">)</span><span class="op" id="7260548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260551">StartElement</span><span class="op" id="7260563">{</span><span class="ident" id="7260564">Name</span><span class="op" id="7260568">{</span><span class="string" id="7260569">&#34;tag&#34;</span><span class="op" id="7260574">,</span>&nbsp;<span class="string" id="7260576">&#34;name&#34;</span><span class="op" id="7260582">}</span><span class="op" id="7260583">,</span>&nbsp;<span class="op" id="7260585">[</span><span class="op" id="7260586">]</span><span class="ident" id="7260587">Attr</span><span class="op" id="7260591">{</span><span class="op" id="7260592">}</span><span class="op" id="7260593">}</span><span class="op" id="7260594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260597">CharData</span><span class="op" id="7260605">(</span><span class="string" id="7260606">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7260614">)</span><span class="op" id="7260615">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260618">CharData</span><span class="op" id="7260626">(</span><span class="string" id="7260627">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7260644">)</span><span class="op" id="7260645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260648">CharData</span><span class="op" id="7260656">(</span><span class="string" id="7260657">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7260663">)</span><span class="op" id="7260664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260667">EndElement</span><span class="op" id="7260677">{</span><span class="ident" id="7260678">Name</span><span class="op" id="7260682">{</span><span class="string" id="7260683">&#34;tag&#34;</span><span class="op" id="7260688">,</span>&nbsp;<span class="string" id="7260690">&#34;name&#34;</span><span class="op" id="7260696">}</span><span class="op" id="7260697">}</span><span class="op" id="7260698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260701">CharData</span><span class="op" id="7260709">(</span><span class="string" id="7260710">&#34;\n&#34;</span><span class="op" id="7260714">)</span><span class="op" id="7260715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260718">EndElement</span><span class="op" id="7260728">{</span><span class="ident" id="7260729">Name</span><span class="op" id="7260733">{</span><span class="string" id="7260734">&#34;&#34;</span><span class="op" id="7260736">,</span>&nbsp;<span class="string" id="7260738">&#34;body&#34;</span><span class="op" id="7260744">}</span><span class="op" id="7260745">}</span><span class="op" id="7260746">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260749">Comment</span><span class="op" id="7260756">(</span><span class="string" id="7260757">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7260782">)</span><span class="op" id="7260783">,</span><br>
<span class="lineno"></span><span class="op" id="7260785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7260788">var</span>&nbsp;<span class="ident" id="7260792">cookedTokens</span>&nbsp;<span class="op" id="7260805">=</span>&nbsp;<span class="op" id="7260807">[</span><span class="op" id="7260808">]</span><span class="ident" id="7260809">Token</span><span class="op" id="7260814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260817">CharData</span><span class="op" id="7260825">(</span><span class="string" id="7260826">&#34;\n&#34;</span><span class="op" id="7260830">)</span><span class="op" id="7260831">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260834">ProcInst</span><span class="op" id="7260842">{</span><span class="string" id="7260843">&#34;xml&#34;</span><span class="op" id="7260848">,</span>&nbsp;<span class="op" id="7260850">[</span><span class="op" id="7260851">]</span><span class="builtintype" id="7260852">byte</span><span class="op" id="7260856">(</span><span class="string" id="7260857">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7260889">)</span><span class="op" id="7260890">}</span><span class="op" id="7260891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260894">CharData</span><span class="op" id="7260902">(</span><span class="string" id="7260903">&#34;\n&#34;</span><span class="op" id="7260907">)</span><span class="op" id="7260908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260911">Directive</span><span class="op" id="7260920">(</span><span class="string" id="7260921">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7261043">)</span><span class="op" id="7261044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261047">CharData</span><span class="op" id="7261055">(</span><span class="string" id="7261056">&#34;\n&#34;</span><span class="op" id="7261060">)</span><span class="op" id="7261061">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261064">StartElement</span><span class="op" id="7261076">{</span><span class="ident" id="7261077">Name</span><span class="op" id="7261081">{</span><span class="string" id="7261082">&#34;ns2&#34;</span><span class="op" id="7261087">,</span>&nbsp;<span class="string" id="7261089">&#34;body&#34;</span><span class="op" id="7261095">}</span><span class="op" id="7261096">,</span>&nbsp;<span class="op" id="7261098">[</span><span class="op" id="7261099">]</span><span class="ident" id="7261100">Attr</span><span class="op" id="7261104">{</span><span class="op" id="7261105">{</span><span class="ident" id="7261106">Name</span><span class="op" id="7261110">{</span><span class="string" id="7261111">&#34;xmlns&#34;</span><span class="op" id="7261118">,</span>&nbsp;<span class="string" id="7261120">&#34;foo&#34;</span><span class="op" id="7261125">}</span><span class="op" id="7261126">,</span>&nbsp;<span class="string" id="7261128">&#34;ns1&#34;</span><span class="op" id="7261133">}</span><span class="op" id="7261134">,</span>&nbsp;<span class="op" id="7261136">{</span><span class="ident" id="7261137">Name</span><span class="op" id="7261141">{</span><span class="string" id="7261142">&#34;&#34;</span><span class="op" id="7261144">,</span>&nbsp;<span class="string" id="7261146">&#34;xmlns&#34;</span><span class="op" id="7261153">}</span><span class="op" id="7261154">,</span>&nbsp;<span class="string" id="7261156">&#34;ns2&#34;</span><span class="op" id="7261161">}</span><span class="op" id="7261162">,</span>&nbsp;<span class="op" id="7261164">{</span><span class="ident" id="7261165">Name</span><span class="op" id="7261169">{</span><span class="string" id="7261170">&#34;xmlns&#34;</span><span class="op" id="7261177">,</span>&nbsp;<span class="string" id="7261179">&#34;tag&#34;</span><span class="op" id="7261184">}</span><span class="op" id="7261185">,</span>&nbsp;<span class="string" id="7261187">&#34;ns3&#34;</span><span class="op" id="7261192">}</span><span class="op" id="7261193">}</span><span class="op" id="7261194">}</span><span class="op" id="7261195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261198">CharData</span><span class="op" id="7261206">(</span><span class="string" id="7261207">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261213">)</span><span class="op" id="7261214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261217">StartElement</span><span class="op" id="7261229">{</span><span class="ident" id="7261230">Name</span><span class="op" id="7261234">{</span><span class="string" id="7261235">&#34;ns2&#34;</span><span class="op" id="7261240">,</span>&nbsp;<span class="string" id="7261242">&#34;hello&#34;</span><span class="op" id="7261249">}</span><span class="op" id="7261250">,</span>&nbsp;<span class="op" id="7261252">[</span><span class="op" id="7261253">]</span><span class="ident" id="7261254">Attr</span><span class="op" id="7261258">{</span><span class="op" id="7261259">{</span><span class="ident" id="7261260">Name</span><span class="op" id="7261264">{</span><span class="string" id="7261265">&#34;&#34;</span><span class="op" id="7261267">,</span>&nbsp;<span class="string" id="7261269">&#34;lang&#34;</span><span class="op" id="7261275">}</span><span class="op" id="7261276">,</span>&nbsp;<span class="string" id="7261278">&#34;en&#34;</span><span class="op" id="7261282">}</span><span class="op" id="7261283">}</span><span class="op" id="7261284">}</span><span class="op" id="7261285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261288">CharData</span><span class="op" id="7261296">(</span><span class="string" id="7261297">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7261320">)</span><span class="op" id="7261321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261324">EndElement</span><span class="op" id="7261334">{</span><span class="ident" id="7261335">Name</span><span class="op" id="7261339">{</span><span class="string" id="7261340">&#34;ns2&#34;</span><span class="op" id="7261345">,</span>&nbsp;<span class="string" id="7261347">&#34;hello&#34;</span><span class="op" id="7261354">}</span><span class="op" id="7261355">}</span><span class="op" id="7261356">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261359">CharData</span><span class="op" id="7261367">(</span><span class="string" id="7261368">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261374">)</span><span class="op" id="7261375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261378">StartElement</span><span class="op" id="7261390">{</span><span class="ident" id="7261391">Name</span><span class="op" id="7261395">{</span><span class="string" id="7261396">&#34;ns2&#34;</span><span class="op" id="7261401">,</span>&nbsp;<span class="string" id="7261403">&#34;query&#34;</span><span class="op" id="7261410">}</span><span class="op" id="7261411">,</span>&nbsp;<span class="op" id="7261413">[</span><span class="op" id="7261414">]</span><span class="ident" id="7261415">Attr</span><span class="op" id="7261419">{</span><span class="op" id="7261420">}</span><span class="op" id="7261421">}</span><span class="op" id="7261422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261425">CharData</span><span class="op" id="7261433">(</span><span class="string" id="7261434">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7261447">)</span><span class="op" id="7261448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261451">EndElement</span><span class="op" id="7261461">{</span><span class="ident" id="7261462">Name</span><span class="op" id="7261466">{</span><span class="string" id="7261467">&#34;ns2&#34;</span><span class="op" id="7261472">,</span>&nbsp;<span class="string" id="7261474">&#34;query&#34;</span><span class="op" id="7261481">}</span><span class="op" id="7261482">}</span><span class="op" id="7261483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261486">CharData</span><span class="op" id="7261494">(</span><span class="string" id="7261495">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261501">)</span><span class="op" id="7261502">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261505">StartElement</span><span class="op" id="7261517">{</span><span class="ident" id="7261518">Name</span><span class="op" id="7261522">{</span><span class="string" id="7261523">&#34;ns2&#34;</span><span class="op" id="7261528">,</span>&nbsp;<span class="string" id="7261530">&#34;goodbye&#34;</span><span class="op" id="7261539">}</span><span class="op" id="7261540">,</span>&nbsp;<span class="op" id="7261542">[</span><span class="op" id="7261543">]</span><span class="ident" id="7261544">Attr</span><span class="op" id="7261548">{</span><span class="op" id="7261549">}</span><span class="op" id="7261550">}</span><span class="op" id="7261551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261554">EndElement</span><span class="op" id="7261564">{</span><span class="ident" id="7261565">Name</span><span class="op" id="7261569">{</span><span class="string" id="7261570">&#34;ns2&#34;</span><span class="op" id="7261575">,</span>&nbsp;<span class="string" id="7261577">&#34;goodbye&#34;</span><span class="op" id="7261586">}</span><span class="op" id="7261587">}</span><span class="op" id="7261588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261591">CharData</span><span class="op" id="7261599">(</span><span class="string" id="7261600">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261606">)</span><span class="op" id="7261607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261610">StartElement</span><span class="op" id="7261622">{</span><span class="ident" id="7261623">Name</span><span class="op" id="7261627">{</span><span class="string" id="7261628">&#34;ns2&#34;</span><span class="op" id="7261633">,</span>&nbsp;<span class="string" id="7261635">&#34;outer&#34;</span><span class="op" id="7261642">}</span><span class="op" id="7261643">,</span>&nbsp;<span class="op" id="7261645">[</span><span class="op" id="7261646">]</span><span class="ident" id="7261647">Attr</span><span class="op" id="7261651">{</span><span class="op" id="7261652">{</span><span class="ident" id="7261653">Name</span><span class="op" id="7261657">{</span><span class="string" id="7261658">&#34;ns1&#34;</span><span class="op" id="7261663">,</span>&nbsp;<span class="string" id="7261665">&#34;attr&#34;</span><span class="op" id="7261671">}</span><span class="op" id="7261672">,</span>&nbsp;<span class="string" id="7261674">&#34;value&#34;</span><span class="op" id="7261681">}</span><span class="op" id="7261682">,</span>&nbsp;<span class="op" id="7261684">{</span><span class="ident" id="7261685">Name</span><span class="op" id="7261689">{</span><span class="string" id="7261690">&#34;xmlns&#34;</span><span class="op" id="7261697">,</span>&nbsp;<span class="string" id="7261699">&#34;tag&#34;</span><span class="op" id="7261704">}</span><span class="op" id="7261705">,</span>&nbsp;<span class="string" id="7261707">&#34;ns4&#34;</span><span class="op" id="7261712">}</span><span class="op" id="7261713">}</span><span class="op" id="7261714">}</span><span class="op" id="7261715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261718">CharData</span><span class="op" id="7261726">(</span><span class="string" id="7261727">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7261735">)</span><span class="op" id="7261736">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261739">StartElement</span><span class="op" id="7261751">{</span><span class="ident" id="7261752">Name</span><span class="op" id="7261756">{</span><span class="string" id="7261757">&#34;ns2&#34;</span><span class="op" id="7261762">,</span>&nbsp;<span class="string" id="7261764">&#34;inner&#34;</span><span class="op" id="7261771">}</span><span class="op" id="7261772">,</span>&nbsp;<span class="op" id="7261774">[</span><span class="op" id="7261775">]</span><span class="ident" id="7261776">Attr</span><span class="op" id="7261780">{</span><span class="op" id="7261781">}</span><span class="op" id="7261782">}</span><span class="op" id="7261783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261786">EndElement</span><span class="op" id="7261796">{</span><span class="ident" id="7261797">Name</span><span class="op" id="7261801">{</span><span class="string" id="7261802">&#34;ns2&#34;</span><span class="op" id="7261807">,</span>&nbsp;<span class="string" id="7261809">&#34;inner&#34;</span><span class="op" id="7261816">}</span><span class="op" id="7261817">}</span><span class="op" id="7261818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261821">CharData</span><span class="op" id="7261829">(</span><span class="string" id="7261830">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261836">)</span><span class="op" id="7261837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261840">EndElement</span><span class="op" id="7261850">{</span><span class="ident" id="7261851">Name</span><span class="op" id="7261855">{</span><span class="string" id="7261856">&#34;ns2&#34;</span><span class="op" id="7261861">,</span>&nbsp;<span class="string" id="7261863">&#34;outer&#34;</span><span class="op" id="7261870">}</span><span class="op" id="7261871">}</span><span class="op" id="7261872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261875">CharData</span><span class="op" id="7261883">(</span><span class="string" id="7261884">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7261890">)</span><span class="op" id="7261891">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261894">StartElement</span><span class="op" id="7261906">{</span><span class="ident" id="7261907">Name</span><span class="op" id="7261911">{</span><span class="string" id="7261912">&#34;ns3&#34;</span><span class="op" id="7261917">,</span>&nbsp;<span class="string" id="7261919">&#34;name&#34;</span><span class="op" id="7261925">}</span><span class="op" id="7261926">,</span>&nbsp;<span class="op" id="7261928">[</span><span class="op" id="7261929">]</span><span class="ident" id="7261930">Attr</span><span class="op" id="7261934">{</span><span class="op" id="7261935">}</span><span class="op" id="7261936">}</span><span class="op" id="7261937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261940">CharData</span><span class="op" id="7261948">(</span><span class="string" id="7261949">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7261957">)</span><span class="op" id="7261958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261961">CharData</span><span class="op" id="7261969">(</span><span class="string" id="7261970">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7261987">)</span><span class="op" id="7261988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261991">CharData</span><span class="op" id="7261999">(</span><span class="string" id="7262000">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7262006">)</span><span class="op" id="7262007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262010">EndElement</span><span class="op" id="7262020">{</span><span class="ident" id="7262021">Name</span><span class="op" id="7262025">{</span><span class="string" id="7262026">&#34;ns3&#34;</span><span class="op" id="7262031">,</span>&nbsp;<span class="string" id="7262033">&#34;name&#34;</span><span class="op" id="7262039">}</span><span class="op" id="7262040">}</span><span class="op" id="7262041">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262044">CharData</span><span class="op" id="7262052">(</span><span class="string" id="7262053">&#34;\n&#34;</span><span class="op" id="7262057">)</span><span class="op" id="7262058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262061">EndElement</span><span class="op" id="7262071">{</span><span class="ident" id="7262072">Name</span><span class="op" id="7262076">{</span><span class="string" id="7262077">&#34;ns2&#34;</span><span class="op" id="7262082">,</span>&nbsp;<span class="string" id="7262084">&#34;body&#34;</span><span class="op" id="7262090">}</span><span class="op" id="7262091">}</span><span class="op" id="7262092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262095">Comment</span><span class="op" id="7262102">(</span><span class="string" id="7262103">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7262128">)</span><span class="op" id="7262129">,</span><br>
<span class="lineno"></span><span class="op" id="7262131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7262134">const</span>&nbsp;<span class="ident" id="7262140">testInputAltEncoding</span>&nbsp;<span class="op" id="7262161">=</span>&nbsp;<span class="string" id="7262163">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7262237">var</span>&nbsp;<span class="ident" id="7262241">rawTokensAltEncoding</span>&nbsp;<span class="op" id="7262262">=</span>&nbsp;<span class="op" id="7262264">[</span><span class="op" id="7262265">]</span><span class="ident" id="7262266">Token</span><span class="op" id="7262271">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262274">CharData</span><span class="op" id="7262282">(</span><span class="string" id="7262283">&#34;\n&#34;</span><span class="op" id="7262287">)</span><span class="op" id="7262288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262291">ProcInst</span><span class="op" id="7262299">{</span><span class="string" id="7262300">&#34;xml&#34;</span><span class="op" id="7262305">,</span>&nbsp;<span class="op" id="7262307">[</span><span class="op" id="7262308">]</span><span class="builtintype" id="7262309">byte</span><span class="op" id="7262313">(</span><span class="string" id="7262314">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="7262360">)</span><span class="op" id="7262361">}</span><span class="op" id="7262362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262365">CharData</span><span class="op" id="7262373">(</span><span class="string" id="7262374">&#34;\n&#34;</span><span class="op" id="7262378">)</span><span class="op" id="7262379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262382">StartElement</span><span class="op" id="7262394">{</span><span class="ident" id="7262395">Name</span><span class="op" id="7262399">{</span><span class="string" id="7262400">&#34;&#34;</span><span class="op" id="7262402">,</span>&nbsp;<span class="string" id="7262404">&#34;tag&#34;</span><span class="op" id="7262409">}</span><span class="op" id="7262410">,</span>&nbsp;<span class="op" id="7262412">[</span><span class="op" id="7262413">]</span><span class="ident" id="7262414">Attr</span><span class="op" id="7262418">{</span><span class="op" id="7262419">}</span><span class="op" id="7262420">}</span><span class="op" id="7262421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262424">CharData</span><span class="op" id="7262432">(</span><span class="string" id="7262433">&#34;value&#34;</span><span class="op" id="7262440">)</span><span class="op" id="7262441">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262444">EndElement</span><span class="op" id="7262454">{</span><span class="ident" id="7262455">Name</span><span class="op" id="7262459">{</span><span class="string" id="7262460">&#34;&#34;</span><span class="op" id="7262462">,</span>&nbsp;<span class="string" id="7262464">&#34;tag&#34;</span><span class="op" id="7262469">}</span><span class="op" id="7262470">}</span><span class="op" id="7262471">,</span><br>
<span class="lineno"></span><span class="op" id="7262473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7262476">var</span>&nbsp;<span class="ident" id="7262480">xmlInput</span>&nbsp;<span class="op" id="7262489">=</span>&nbsp;<span class="op" id="7262491">[</span><span class="op" id="7262492">]</span><span class="builtintype" id="7262493">string</span><span class="op" id="7262499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262502">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262527">&#34;&lt;&#34;</span><span class="op" id="7262530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262533">&#34;&lt;t&#34;</span><span class="op" id="7262537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262540">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="7262545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262548">&#34;&lt;t/&#34;</span><span class="op" id="7262553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262556">&#34;&lt;!&#34;</span><span class="op" id="7262560">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262563">&#34;&lt;!-&#34;</span><span class="op" id="7262568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262571">&#34;&lt;!--&#34;</span><span class="op" id="7262577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262580">&#34;&lt;!--c-&#34;</span><span class="op" id="7262588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262591">&#34;&lt;!--c--&#34;</span><span class="op" id="7262600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262603">&#34;&lt;!d&#34;</span><span class="op" id="7262608">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262611">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="7262618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262621">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="7262629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262632">&#34;&lt;?&#34;</span><span class="op" id="7262636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262639">&#34;&lt;?p&#34;</span><span class="op" id="7262644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262647">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="7262653">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262656">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="7262663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262666">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="7262674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262677">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="7262686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262689">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="7262698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262701">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="7262711">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262714">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="7262730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262733">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="7262750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262753">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="7262771">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262775">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262799">&#34;&lt;&gt;&#34;</span><span class="op" id="7262803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262806">&#34;&lt;t/a&#34;</span><span class="op" id="7262812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262815">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="7262822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262825">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="7262832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262835">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262881">&#34;&lt;/0&gt;&#34;</span><span class="op" id="7262887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262890">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="7262900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262903">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="7262914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262917">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="7262928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262931">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="7262947">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262950">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="7262957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262960">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="7262968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7262971">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="7262980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262983">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263037">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="7263046">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263049">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="7263057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263060">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="7263069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263072">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="7263089">,</span><br>
<span class="lineno"></span><span class="op" id="7263091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7263094">func</span>&nbsp;<span class="ident" id="7263099">TestRawToken</span><span class="op" id="7263111">(</span><span class="ident" id="7263112">t</span>&nbsp;<span class="op" id="7263114">*</span><span class="ident" id="7263115">testing</span><span class="op" id="7263122">.</span><span class="ident" id="7263123">T</span><span class="op" id="7263124">)</span>&nbsp;<span class="op" id="7263126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263129">d</span>&nbsp;<span class="op" id="7263131">:=</span>&nbsp;<span class="ident" id="7263134">NewDecoder</span><span class="op" id="7263144">(</span><span class="ident" id="7263145">strings</span><span class="op" id="7263152">.</span><span class="ident" id="7263153">NewReader</span><span class="op" id="7263162">(</span><span class="ident" id="7263163">testInput</span><span class="op" id="7263172">)</span><span class="op" id="7263173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263176">d</span><span class="op" id="7263177">.</span><span class="ident" id="7263178">Entity</span>&nbsp;<span class="op" id="7263185">=</span>&nbsp;<span class="ident" id="7263187">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263199">testRawToken</span><span class="op" id="7263211">(</span><span class="ident" id="7263212">t</span><span class="op" id="7263213">,</span>&nbsp;<span class="ident" id="7263215">d</span><span class="op" id="7263216">,</span>&nbsp;<span class="ident" id="7263218">testInput</span><span class="op" id="7263227">,</span>&nbsp;<span class="ident" id="7263229">rawTokens</span><span class="op" id="7263238">)</span><br>
<span class="lineno"></span><span class="op" id="7263240">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7263243">const</span>&nbsp;<span class="ident" id="7263249">nonStrictInput</span>&nbsp;<span class="op" id="7263264">=</span>&nbsp;<span class="string" id="7263266">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7263428">var</span>&nbsp;<span class="ident" id="7263432">nonStringEntity</span>&nbsp;<span class="op" id="7263448">=</span>&nbsp;<span class="keyword" id="7263450">map</span><span class="op" id="7263453">[</span><span class="builtintype" id="7263454">string</span><span class="op" id="7263460">]</span><span class="builtintype" id="7263461">string</span><span class="op" id="7263467">{</span><span class="string" id="7263468">&#34;&#34;</span><span class="op" id="7263470">:</span>&nbsp;<span class="string" id="7263472">&#34;oops!&#34;</span><span class="op" id="7263479">,</span>&nbsp;<span class="string" id="7263481">&#34;0a&#34;</span><span class="op" id="7263485">:</span>&nbsp;<span class="string" id="7263487">&#34;oops!&#34;</span><span class="op" id="7263494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7263497">var</span>&nbsp;<span class="ident" id="7263501">nonStrictTokens</span>&nbsp;<span class="op" id="7263517">=</span>&nbsp;<span class="op" id="7263519">[</span><span class="op" id="7263520">]</span><span class="ident" id="7263521">Token</span><span class="op" id="7263526">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263529">CharData</span><span class="op" id="7263537">(</span><span class="string" id="7263538">&#34;\n&#34;</span><span class="op" id="7263542">)</span><span class="op" id="7263543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263546">StartElement</span><span class="op" id="7263558">{</span><span class="ident" id="7263559">Name</span><span class="op" id="7263563">{</span><span class="string" id="7263564">&#34;&#34;</span><span class="op" id="7263566">,</span>&nbsp;<span class="string" id="7263568">&#34;tag&#34;</span><span class="op" id="7263573">}</span><span class="op" id="7263574">,</span>&nbsp;<span class="op" id="7263576">[</span><span class="op" id="7263577">]</span><span class="ident" id="7263578">Attr</span><span class="op" id="7263582">{</span><span class="op" id="7263583">}</span><span class="op" id="7263584">}</span><span class="op" id="7263585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263588">CharData</span><span class="op" id="7263596">(</span><span class="string" id="7263597">&#34;non&amp;entity&#34;</span><span class="op" id="7263609">)</span><span class="op" id="7263610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263613">EndElement</span><span class="op" id="7263623">{</span><span class="ident" id="7263624">Name</span><span class="op" id="7263628">{</span><span class="string" id="7263629">&#34;&#34;</span><span class="op" id="7263631">,</span>&nbsp;<span class="string" id="7263633">&#34;tag&#34;</span><span class="op" id="7263638">}</span><span class="op" id="7263639">}</span><span class="op" id="7263640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263643">CharData</span><span class="op" id="7263651">(</span><span class="string" id="7263652">&#34;\n&#34;</span><span class="op" id="7263656">)</span><span class="op" id="7263657">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263660">StartElement</span><span class="op" id="7263672">{</span><span class="ident" id="7263673">Name</span><span class="op" id="7263677">{</span><span class="string" id="7263678">&#34;&#34;</span><span class="op" id="7263680">,</span>&nbsp;<span class="string" id="7263682">&#34;tag&#34;</span><span class="op" id="7263687">}</span><span class="op" id="7263688">,</span>&nbsp;<span class="op" id="7263690">[</span><span class="op" id="7263691">]</span><span class="ident" id="7263692">Attr</span><span class="op" id="7263696">{</span><span class="op" id="7263697">}</span><span class="op" id="7263698">}</span><span class="op" id="7263699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263702">CharData</span><span class="op" id="7263710">(</span><span class="string" id="7263711">&#34;&amp;unknown;entity&#34;</span><span class="op" id="7263728">)</span><span class="op" id="7263729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263732">EndElement</span><span class="op" id="7263742">{</span><span class="ident" id="7263743">Name</span><span class="op" id="7263747">{</span><span class="string" id="7263748">&#34;&#34;</span><span class="op" id="7263750">,</span>&nbsp;<span class="string" id="7263752">&#34;tag&#34;</span><span class="op" id="7263757">}</span><span class="op" id="7263758">}</span><span class="op" id="7263759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263762">CharData</span><span class="op" id="7263770">(</span><span class="string" id="7263771">&#34;\n&#34;</span><span class="op" id="7263775">)</span><span class="op" id="7263776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263779">StartElement</span><span class="op" id="7263791">{</span><span class="ident" id="7263792">Name</span><span class="op" id="7263796">{</span><span class="string" id="7263797">&#34;&#34;</span><span class="op" id="7263799">,</span>&nbsp;<span class="string" id="7263801">&#34;tag&#34;</span><span class="op" id="7263806">}</span><span class="op" id="7263807">,</span>&nbsp;<span class="op" id="7263809">[</span><span class="op" id="7263810">]</span><span class="ident" id="7263811">Attr</span><span class="op" id="7263815">{</span><span class="op" id="7263816">}</span><span class="op" id="7263817">}</span><span class="op" id="7263818">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263821">CharData</span><span class="op" id="7263829">(</span><span class="string" id="7263830">&#34;&amp;#123&#34;</span><span class="op" id="7263837">)</span><span class="op" id="7263838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263841">EndElement</span><span class="op" id="7263851">{</span><span class="ident" id="7263852">Name</span><span class="op" id="7263856">{</span><span class="string" id="7263857">&#34;&#34;</span><span class="op" id="7263859">,</span>&nbsp;<span class="string" id="7263861">&#34;tag&#34;</span><span class="op" id="7263866">}</span><span class="op" id="7263867">}</span><span class="op" id="7263868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263871">CharData</span><span class="op" id="7263879">(</span><span class="string" id="7263880">&#34;\n&#34;</span><span class="op" id="7263884">)</span><span class="op" id="7263885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263888">StartElement</span><span class="op" id="7263900">{</span><span class="ident" id="7263901">Name</span><span class="op" id="7263905">{</span><span class="string" id="7263906">&#34;&#34;</span><span class="op" id="7263908">,</span>&nbsp;<span class="string" id="7263910">&#34;tag&#34;</span><span class="op" id="7263915">}</span><span class="op" id="7263916">,</span>&nbsp;<span class="op" id="7263918">[</span><span class="op" id="7263919">]</span><span class="ident" id="7263920">Attr</span><span class="op" id="7263924">{</span><span class="op" id="7263925">}</span><span class="op" id="7263926">}</span><span class="op" id="7263927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263930">CharData</span><span class="op" id="7263938">(</span><span class="string" id="7263939">&#34;&amp;#zzz;&#34;</span><span class="op" id="7263947">)</span><span class="op" id="7263948">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263951">EndElement</span><span class="op" id="7263961">{</span><span class="ident" id="7263962">Name</span><span class="op" id="7263966">{</span><span class="string" id="7263967">&#34;&#34;</span><span class="op" id="7263969">,</span>&nbsp;<span class="string" id="7263971">&#34;tag&#34;</span><span class="op" id="7263976">}</span><span class="op" id="7263977">}</span><span class="op" id="7263978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263981">CharData</span><span class="op" id="7263989">(</span><span class="string" id="7263990">&#34;\n&#34;</span><span class="op" id="7263994">)</span><span class="op" id="7263995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263998">StartElement</span><span class="op" id="7264010">{</span><span class="ident" id="7264011">Name</span><span class="op" id="7264015">{</span><span class="string" id="7264016">&#34;&#34;</span><span class="op" id="7264018">,</span>&nbsp;<span class="string" id="7264020">&#34;tag&#34;</span><span class="op" id="7264025">}</span><span class="op" id="7264026">,</span>&nbsp;<span class="op" id="7264028">[</span><span class="op" id="7264029">]</span><span class="ident" id="7264030">Attr</span><span class="op" id="7264034">{</span><span class="op" id="7264035">}</span><span class="op" id="7264036">}</span><span class="op" id="7264037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264040">CharData</span><span class="op" id="7264048">(</span><span class="string" id="7264049">&#34;&amp;なまえ3;&#34;</span><span class="op" id="7264063">)</span><span class="op" id="7264064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264067">EndElement</span><span class="op" id="7264077">{</span><span class="ident" id="7264078">Name</span><span class="op" id="7264082">{</span><span class="string" id="7264083">&#34;&#34;</span><span class="op" id="7264085">,</span>&nbsp;<span class="string" id="7264087">&#34;tag&#34;</span><span class="op" id="7264092">}</span><span class="op" id="7264093">}</span><span class="op" id="7264094">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264097">CharData</span><span class="op" id="7264105">(</span><span class="string" id="7264106">&#34;\n&#34;</span><span class="op" id="7264110">)</span><span class="op" id="7264111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264114">StartElement</span><span class="op" id="7264126">{</span><span class="ident" id="7264127">Name</span><span class="op" id="7264131">{</span><span class="string" id="7264132">&#34;&#34;</span><span class="op" id="7264134">,</span>&nbsp;<span class="string" id="7264136">&#34;tag&#34;</span><span class="op" id="7264141">}</span><span class="op" id="7264142">,</span>&nbsp;<span class="op" id="7264144">[</span><span class="op" id="7264145">]</span><span class="ident" id="7264146">Attr</span><span class="op" id="7264150">{</span><span class="op" id="7264151">}</span><span class="op" id="7264152">}</span><span class="op" id="7264153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264156">CharData</span><span class="op" id="7264164">(</span><span class="string" id="7264165">&#34;&amp;lt-gt;&#34;</span><span class="op" id="7264174">)</span><span class="op" id="7264175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264178">EndElement</span><span class="op" id="7264188">{</span><span class="ident" id="7264189">Name</span><span class="op" id="7264193">{</span><span class="string" id="7264194">&#34;&#34;</span><span class="op" id="7264196">,</span>&nbsp;<span class="string" id="7264198">&#34;tag&#34;</span><span class="op" id="7264203">}</span><span class="op" id="7264204">}</span><span class="op" id="7264205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264208">CharData</span><span class="op" id="7264216">(</span><span class="string" id="7264217">&#34;\n&#34;</span><span class="op" id="7264221">)</span><span class="op" id="7264222">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264225">StartElement</span><span class="op" id="7264237">{</span><span class="ident" id="7264238">Name</span><span class="op" id="7264242">{</span><span class="string" id="7264243">&#34;&#34;</span><span class="op" id="7264245">,</span>&nbsp;<span class="string" id="7264247">&#34;tag&#34;</span><span class="op" id="7264252">}</span><span class="op" id="7264253">,</span>&nbsp;<span class="op" id="7264255">[</span><span class="op" id="7264256">]</span><span class="ident" id="7264257">Attr</span><span class="op" id="7264261">{</span><span class="op" id="7264262">}</span><span class="op" id="7264263">}</span><span class="op" id="7264264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264267">CharData</span><span class="op" id="7264275">(</span><span class="string" id="7264276">&#34;&amp;;&#34;</span><span class="op" id="7264280">)</span><span class="op" id="7264281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264284">EndElement</span><span class="op" id="7264294">{</span><span class="ident" id="7264295">Name</span><span class="op" id="7264299">{</span><span class="string" id="7264300">&#34;&#34;</span><span class="op" id="7264302">,</span>&nbsp;<span class="string" id="7264304">&#34;tag&#34;</span><span class="op" id="7264309">}</span><span class="op" id="7264310">}</span><span class="op" id="7264311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264314">CharData</span><span class="op" id="7264322">(</span><span class="string" id="7264323">&#34;\n&#34;</span><span class="op" id="7264327">)</span><span class="op" id="7264328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264331">StartElement</span><span class="op" id="7264343">{</span><span class="ident" id="7264344">Name</span><span class="op" id="7264348">{</span><span class="string" id="7264349">&#34;&#34;</span><span class="op" id="7264351">,</span>&nbsp;<span class="string" id="7264353">&#34;tag&#34;</span><span class="op" id="7264358">}</span><span class="op" id="7264359">,</span>&nbsp;<span class="op" id="7264361">[</span><span class="op" id="7264362">]</span><span class="ident" id="7264363">Attr</span><span class="op" id="7264367">{</span><span class="op" id="7264368">}</span><span class="op" id="7264369">}</span><span class="op" id="7264370">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264373">CharData</span><span class="op" id="7264381">(</span><span class="string" id="7264382">&#34;&amp;0a;&#34;</span><span class="op" id="7264388">)</span><span class="op" id="7264389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264392">EndElement</span><span class="op" id="7264402">{</span><span class="ident" id="7264403">Name</span><span class="op" id="7264407">{</span><span class="string" id="7264408">&#34;&#34;</span><span class="op" id="7264410">,</span>&nbsp;<span class="string" id="7264412">&#34;tag&#34;</span><span class="op" id="7264417">}</span><span class="op" id="7264418">}</span><span class="op" id="7264419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264422">CharData</span><span class="op" id="7264430">(</span><span class="string" id="7264431">&#34;\n&#34;</span><span class="op" id="7264435">)</span><span class="op" id="7264436">,</span><br>
<span class="lineno"></span><span class="op" id="7264438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7264441">func</span>&nbsp;<span class="ident" id="7264446">TestNonStrictRawToken</span><span class="op" id="7264467">(</span><span class="ident" id="7264468">t</span>&nbsp;<span class="op" id="7264470">*</span><span class="ident" id="7264471">testing</span><span class="op" id="7264478">.</span><span class="ident" id="7264479">T</span><span class="op" id="7264480">)</span>&nbsp;<span class="op" id="7264482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264485">d</span>&nbsp;<span class="op" id="7264487">:=</span>&nbsp;<span class="ident" id="7264490">NewDecoder</span><span class="op" id="7264500">(</span><span class="ident" id="7264501">strings</span><span class="op" id="7264508">.</span><span class="ident" id="7264509">NewReader</span><span class="op" id="7264518">(</span><span class="ident" id="7264519">nonStrictInput</span><span class="op" id="7264533">)</span><span class="op" id="7264534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264537">d</span><span class="op" id="7264538">.</span><span class="ident" id="7264539">Strict</span>&nbsp;<span class="op" id="7264546">=</span>&nbsp;<span class="builtintype" id="7264548">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264555">testRawToken</span><span class="op" id="7264567">(</span><span class="ident" id="7264568">t</span><span class="op" id="7264569">,</span>&nbsp;<span class="ident" id="7264571">d</span><span class="op" id="7264572">,</span>&nbsp;<span class="ident" id="7264574">nonStrictInput</span><span class="op" id="7264588">,</span>&nbsp;<span class="ident" id="7264590">nonStrictTokens</span><span class="op" id="7264605">)</span><br>
<span class="lineno"></span><span class="op" id="7264607">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7264610">type</span>&nbsp;<span class="ident" id="7264615">downCaser</span>&nbsp;<span class="keyword" id="7264625">struct</span>&nbsp;<span class="op" id="7264632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264635">t</span>&nbsp;<span class="op" id="7264637">*</span><span class="ident" id="7264638">testing</span><span class="op" id="7264645">.</span><span class="ident" id="7264646">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264649">r</span>&nbsp;<span class="ident" id="7264651">io</span><span class="op" id="7264653">.</span><span class="ident" id="7264654">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="7264665">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7264668">func</span>&nbsp;<span class="op" id="7264673">(</span><span class="ident" id="7264674">d</span>&nbsp;<span class="op" id="7264676">*</span><span class="ident" id="7264677">downCaser</span><span class="op" id="7264686">)</span>&nbsp;<span class="ident" id="7264688">ReadByte</span><span class="op" id="7264696">(</span><span class="op" id="7264697">)</span>&nbsp;<span class="op" id="7264699">(</span><span class="ident" id="7264700">c</span>&nbsp;<span class="builtintype" id="7264702">byte</span><span class="op" id="7264706">,</span>&nbsp;<span class="ident" id="7264708">err</span>&nbsp;<span class="builtintype" id="7264712">error</span><span class="op" id="7264717">)</span>&nbsp;<span class="op" id="7264719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264722">c</span><span class="op" id="7264723">,</span>&nbsp;<span class="ident" id="7264725">err</span>&nbsp;<span class="op" id="7264729">=</span>&nbsp;<span class="ident" id="7264731">d</span><span class="op" id="7264732">.</span><span class="ident" id="7264733">r</span><span class="op" id="7264734">.</span><span class="ident" id="7264735">ReadByte</span><span class="op" id="7264743">(</span><span class="op" id="7264744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264747">if</span>&nbsp;<span class="ident" id="7264750">c</span>&nbsp;<span class="op" id="7264752">&gt;=</span>&nbsp;<span class="string" id="7264755">&#39;A&#39;</span>&nbsp;<span class="op" id="7264759">&amp;&amp;</span>&nbsp;<span class="ident" id="7264762">c</span>&nbsp;<span class="op" id="7264764">&lt;=</span>&nbsp;<span class="string" id="7264767">&#39;Z&#39;</span>&nbsp;<span class="op" id="7264771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264775">c</span>&nbsp;<span class="op" id="7264777">+=</span>&nbsp;<span class="string" id="7264780">&#39;a&#39;</span>&nbsp;<span class="op" id="7264784">-</span>&nbsp;<span class="string" id="7264786">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264794">return</span><br>
<span class="lineno"></span><span class="op" id="7264801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264804">func</span>&nbsp;<span class="op" id="7264809">(</span><span class="ident" id="7264810">d</span>&nbsp;<span class="op" id="7264812">*</span><span class="ident" id="7264813">downCaser</span><span class="op" id="7264822">)</span>&nbsp;<span class="ident" id="7264824">Read</span><span class="op" id="7264828">(</span><span class="ident" id="7264829">p</span>&nbsp;<span class="op" id="7264831">[</span><span class="op" id="7264832">]</span><span class="builtintype" id="7264833">byte</span><span class="op" id="7264837">)</span>&nbsp;<span class="op" id="7264839">(</span><span class="builtintype" id="7264840">int</span><span class="op" id="7264843">,</span>&nbsp;<span class="builtintype" id="7264845">error</span><span class="op" id="7264850">)</span>&nbsp;<span class="op" id="7264852">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264855">d</span><span class="op" id="7264856">.</span><span class="ident" id="7264857">t</span><span class="op" id="7264858">.</span><span class="ident" id="7264859">Fatalf</span><span class="op" id="7264865">(</span><span class="string" id="7264866">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="7264908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7264911">panic</span><span class="op" id="7264916">(</span><span class="string" id="7264917">&#34;unreachable&#34;</span><span class="op" id="7264930">)</span><br>
<span class="lineno"></span><span class="op" id="7264932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264935">func</span>&nbsp;<span class="ident" id="7264940">TestRawTokenAltEncoding</span><span class="op" id="7264963">(</span><span class="ident" id="7264964">t</span>&nbsp;<span class="op" id="7264966">*</span><span class="ident" id="7264967">testing</span><span class="op" id="7264974">.</span><span class="ident" id="7264975">T</span><span class="op" id="7264976">)</span>&nbsp;<span class="op" id="7264978">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264981">d</span>&nbsp;<span class="op" id="7264983">:=</span>&nbsp;<span class="ident" id="7264986">NewDecoder</span><span class="op" id="7264996">(</span><span class="ident" id="7264997">strings</span><span class="op" id="7265004">.</span><span class="ident" id="7265005">NewReader</span><span class="op" id="7265014">(</span><span class="ident" id="7265015">testInputAltEncoding</span><span class="op" id="7265035">)</span><span class="op" id="7265036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265039">d</span><span class="op" id="7265040">.</span><span class="ident" id="7265041">CharsetReader</span>&nbsp;<span class="op" id="7265055">=</span>&nbsp;<span class="keyword" id="7265057">func</span><span class="op" id="7265061">(</span><span class="ident" id="7265062">charset</span>&nbsp;<span class="builtintype" id="7265070">string</span><span class="op" id="7265076">,</span>&nbsp;<span class="ident" id="7265078">input</span>&nbsp;<span class="ident" id="7265084">io</span><span class="op" id="7265086">.</span><span class="ident" id="7265087">Reader</span><span class="op" id="7265093">)</span>&nbsp;<span class="op" id="7265095">(</span><span class="ident" id="7265096">io</span><span class="op" id="7265098">.</span><span class="ident" id="7265099">Reader</span><span class="op" id="7265105">,</span>&nbsp;<span class="builtintype" id="7265107">error</span><span class="op" id="7265112">)</span>&nbsp;<span class="op" id="7265114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265118">if</span>&nbsp;<span class="ident" id="7265121">charset</span>&nbsp;<span class="op" id="7265129">!=</span>&nbsp;<span class="string" id="7265132">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="7265154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265159">t</span><span class="op" id="7265160">.</span><span class="ident" id="7265161">Fatalf</span><span class="op" id="7265167">(</span><span class="string" id="7265168">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="7265191">,</span>&nbsp;<span class="ident" id="7265193">charset</span><span class="op" id="7265200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265204">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265208">return</span>&nbsp;<span class="op" id="7265215">&amp;</span><span class="ident" id="7265216">downCaser</span><span class="op" id="7265225">{</span><span class="ident" id="7265226">t</span><span class="op" id="7265227">,</span>&nbsp;<span class="ident" id="7265229">input</span><span class="op" id="7265234">.</span><span class="op" id="7265235">(</span><span class="ident" id="7265236">io</span><span class="op" id="7265238">.</span><span class="ident" id="7265239">ByteReader</span><span class="op" id="7265249">)</span><span class="op" id="7265250">}</span><span class="op" id="7265251">,</span>&nbsp;<span class="builtintype" id="7265253">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265261">testRawToken</span><span class="op" id="7265273">(</span><span class="ident" id="7265274">t</span><span class="op" id="7265275">,</span>&nbsp;<span class="ident" id="7265277">d</span><span class="op" id="7265278">,</span>&nbsp;<span class="ident" id="7265280">testInputAltEncoding</span><span class="op" id="7265300">,</span>&nbsp;<span class="ident" id="7265302">rawTokensAltEncoding</span><span class="op" id="7265322">)</span><br>
<span class="lineno"></span><span class="op" id="7265324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="7265327">func</span>&nbsp;<span class="ident" id="7265332">TestRawTokenAltEncodingNoConverter</span><span class="op" id="7265366">(</span><span class="ident" id="7265367">t</span>&nbsp;<span class="op" id="7265369">*</span><span class="ident" id="7265370">testing</span><span class="op" id="7265377">.</span><span class="ident" id="7265378">T</span><span class="op" id="7265379">)</span>&nbsp;<span class="op" id="7265381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265384">d</span>&nbsp;<span class="op" id="7265386">:=</span>&nbsp;<span class="ident" id="7265389">NewDecoder</span><span class="op" id="7265399">(</span><span class="ident" id="7265400">strings</span><span class="op" id="7265407">.</span><span class="ident" id="7265408">NewReader</span><span class="op" id="7265417">(</span><span class="ident" id="7265418">testInputAltEncoding</span><span class="op" id="7265438">)</span><span class="op" id="7265439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265442">token</span><span class="op" id="7265447">,</span>&nbsp;<span class="ident" id="7265449">err</span>&nbsp;<span class="op" id="7265453">:=</span>&nbsp;<span class="ident" id="7265456">d</span><span class="op" id="7265457">.</span><span class="ident" id="7265458">RawToken</span><span class="op" id="7265466">(</span><span class="op" id="7265467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265470">if</span>&nbsp;<span class="ident" id="7265473">token</span>&nbsp;<span class="op" id="7265479">==</span>&nbsp;<span class="builtintype" id="7265482">nil</span>&nbsp;<span class="op" id="7265486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265490">t</span><span class="op" id="7265491">.</span><span class="ident" id="7265492">Fatalf</span><span class="op" id="7265498">(</span><span class="string" id="7265499">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7265540">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265546">if</span>&nbsp;<span class="ident" id="7265549">err</span>&nbsp;<span class="op" id="7265553">!=</span>&nbsp;<span class="builtintype" id="7265556">nil</span>&nbsp;<span class="op" id="7265560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265564">t</span><span class="op" id="7265565">.</span><span class="ident" id="7265566">Fatal</span><span class="op" id="7265571">(</span><span class="ident" id="7265572">err</span><span class="op" id="7265575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265581">token</span><span class="op" id="7265586">,</span>&nbsp;<span class="ident" id="7265588">err</span>&nbsp;<span class="op" id="7265592">=</span>&nbsp;<span class="ident" id="7265594">d</span><span class="op" id="7265595">.</span><span class="ident" id="7265596">RawToken</span><span class="op" id="7265604">(</span><span class="op" id="7265605">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265608">if</span>&nbsp;<span class="ident" id="7265611">token</span>&nbsp;<span class="op" id="7265617">!=</span>&nbsp;<span class="builtintype" id="7265620">nil</span>&nbsp;<span class="op" id="7265624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265628">t</span><span class="op" id="7265629">.</span><span class="ident" id="7265630">Errorf</span><span class="op" id="7265636">(</span><span class="string" id="7265637">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="7265668">,</span>&nbsp;<span class="ident" id="7265670">token</span><span class="op" id="7265675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265681">if</span>&nbsp;<span class="ident" id="7265684">err</span>&nbsp;<span class="op" id="7265688">==</span>&nbsp;<span class="builtintype" id="7265691">nil</span>&nbsp;<span class="op" id="7265695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265699">t</span><span class="op" id="7265700">.</span><span class="ident" id="7265701">Fatalf</span><span class="op" id="7265707">(</span><span class="string" id="7265708">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7265751">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265757">const</span>&nbsp;<span class="ident" id="7265763">encoding</span>&nbsp;<span class="op" id="7265772">=</span>&nbsp;<span class="string" id="7265774">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265797">if</span>&nbsp;<span class="op" id="7265800">!</span><span class="ident" id="7265801">strings</span><span class="op" id="7265808">.</span><span class="ident" id="7265809">Contains</span><span class="op" id="7265817">(</span><span class="ident" id="7265818">err</span><span class="op" id="7265821">.</span><span class="ident" id="7265822">Error</span><span class="op" id="7265827">(</span><span class="op" id="7265828">)</span><span class="op" id="7265829">,</span>&nbsp;<span class="ident" id="7265831">encoding</span><span class="op" id="7265839">)</span>&nbsp;<span class="op" id="7265841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265845">t</span><span class="op" id="7265846">.</span><span class="ident" id="7265847">Errorf</span><span class="op" id="7265853">(</span><span class="string" id="7265854">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7265899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265904">encoding</span><span class="op" id="7265912">,</span>&nbsp;<span class="ident" id="7265914">err</span><span class="op" id="7265917">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265920">}</span><br>
<span class="lineno"></span><span class="op" id="7265922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7265925">func</span>&nbsp;<span class="ident" id="7265930">testRawToken</span><span class="op" id="7265942">(</span><span class="ident" id="7265943">t</span>&nbsp;<span class="op" id="7265945">*</span><span class="ident" id="7265946">testing</span><span class="op" id="7265953">.</span><span class="ident" id="7265954">T</span><span class="op" id="7265955">,</span>&nbsp;<span class="ident" id="7265957">d</span>&nbsp;<span class="op" id="7265959">*</span><span class="ident" id="7265960">Decoder</span><span class="op" id="7265967">,</span>&nbsp;<span class="ident" id="7265969">raw</span>&nbsp;<span class="builtintype" id="7265973">string</span><span class="op" id="7265979">,</span>&nbsp;<span class="ident" id="7265981">rawTokens</span>&nbsp;<span class="op" id="7265991">[</span><span class="op" id="7265992">]</span><span class="ident" id="7265993">Token</span><span class="op" id="7265998">)</span>&nbsp;<span class="op" id="7266000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266003">lastEnd</span>&nbsp;<span class="op" id="7266011">:=</span>&nbsp;<span class="ident" id="7266014">int64</span><span class="op" id="7266019">(</span><span class="num" id="7266020">0</span><span class="op" id="7266021">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266024">for</span>&nbsp;<span class="ident" id="7266028">i</span><span class="op" id="7266029">,</span>&nbsp;<span class="ident" id="7266031">want</span>&nbsp;<span class="op" id="7266036">:=</span>&nbsp;<span class="keyword" id="7266039">range</span>&nbsp;<span class="ident" id="7266045">rawTokens</span>&nbsp;<span class="op" id="7266055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266059">start</span>&nbsp;<span class="op" id="7266065">:=</span>&nbsp;<span class="ident" id="7266068">d</span><span class="op" id="7266069">.</span><span class="ident" id="7266070">InputOffset</span><span class="op" id="7266081">(</span><span class="op" id="7266082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266086">have</span><span class="op" id="7266090">,</span>&nbsp;<span class="ident" id="7266092">err</span>&nbsp;<span class="op" id="7266096">:=</span>&nbsp;<span class="ident" id="7266099">d</span><span class="op" id="7266100">.</span><span class="ident" id="7266101">RawToken</span><span class="op" id="7266109">(</span><span class="op" id="7266110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266114">end</span>&nbsp;<span class="op" id="7266118">:=</span>&nbsp;<span class="ident" id="7266121">d</span><span class="op" id="7266122">.</span><span class="ident" id="7266123">InputOffset</span><span class="op" id="7266134">(</span><span class="op" id="7266135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266139">if</span>&nbsp;<span class="ident" id="7266142">err</span>&nbsp;<span class="op" id="7266146">!=</span>&nbsp;<span class="builtintype" id="7266149">nil</span>&nbsp;<span class="op" id="7266153">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266158">t</span><span class="op" id="7266159">.</span><span class="ident" id="7266160">Fatalf</span><span class="op" id="7266166">(</span><span class="string" id="7266167">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7266199">,</span>&nbsp;<span class="ident" id="7266201">i</span><span class="op" id="7266202">,</span>&nbsp;<span class="ident" id="7266204">err</span><span class="op" id="7266207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266215">if</span>&nbsp;<span class="op" id="7266218">!</span><span class="ident" id="7266219">reflect</span><span class="op" id="7266226">.</span><span class="ident" id="7266227">DeepEqual</span><span class="op" id="7266236">(</span><span class="ident" id="7266237">have</span><span class="op" id="7266241">,</span>&nbsp;<span class="ident" id="7266243">want</span><span class="op" id="7266247">)</span>&nbsp;<span class="op" id="7266249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266254">var</span>&nbsp;<span class="ident" id="7266258">shave</span><span class="op" id="7266263">,</span>&nbsp;<span class="ident" id="7266265">swant</span>&nbsp;<span class="builtintype" id="7266271">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266281">if</span>&nbsp;<span class="ident" id="7266284">_</span><span class="op" id="7266285">,</span>&nbsp;<span class="ident" id="7266287">ok</span>&nbsp;<span class="op" id="7266290">:=</span>&nbsp;<span class="ident" id="7266293">have</span><span class="op" id="7266297">.</span><span class="op" id="7266298">(</span><span class="ident" id="7266299">CharData</span><span class="op" id="7266307">)</span><span class="op" id="7266308">;</span>&nbsp;<span class="ident" id="7266310">ok</span>&nbsp;<span class="op" id="7266313">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266319">shave</span>&nbsp;<span class="op" id="7266325">=</span>&nbsp;<span class="ident" id="7266327">fmt</span><span class="op" id="7266330">.</span><span class="ident" id="7266331">Sprintf</span><span class="op" id="7266338">(</span><span class="string" id="7266339">&#34;CharData(%q)&#34;</span><span class="op" id="7266353">,</span>&nbsp;<span class="ident" id="7266355">have</span><span class="op" id="7266359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266364">}</span>&nbsp;<span class="keyword" id="7266366">else</span>&nbsp;<span class="op" id="7266371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266377">shave</span>&nbsp;<span class="op" id="7266383">=</span>&nbsp;<span class="ident" id="7266385">fmt</span><span class="op" id="7266388">.</span><span class="ident" id="7266389">Sprintf</span><span class="op" id="7266396">(</span><span class="string" id="7266397">&#34;%#v&#34;</span><span class="op" id="7266402">,</span>&nbsp;<span class="ident" id="7266404">have</span><span class="op" id="7266408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266418">if</span>&nbsp;<span class="ident" id="7266421">_</span><span class="op" id="7266422">,</span>&nbsp;<span class="ident" id="7266424">ok</span>&nbsp;<span class="op" id="7266427">:=</span>&nbsp;<span class="ident" id="7266430">want</span><span class="op" id="7266434">.</span><span class="op" id="7266435">(</span><span class="ident" id="7266436">CharData</span><span class="op" id="7266444">)</span><span class="op" id="7266445">;</span>&nbsp;<span class="ident" id="7266447">ok</span>&nbsp;<span class="op" id="7266450">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266456">swant</span>&nbsp;<span class="op" id="7266462">=</span>&nbsp;<span class="ident" id="7266464">fmt</span><span class="op" id="7266467">.</span><span class="ident" id="7266468">Sprintf</span><span class="op" id="7266475">(</span><span class="string" id="7266476">&#34;CharData(%q)&#34;</span><span class="op" id="7266490">,</span>&nbsp;<span class="ident" id="7266492">want</span><span class="op" id="7266496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266501">}</span>&nbsp;<span class="keyword" id="7266503">else</span>&nbsp;<span class="op" id="7266508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266514">swant</span>&nbsp;<span class="op" id="7266520">=</span>&nbsp;<span class="ident" id="7266522">fmt</span><span class="op" id="7266525">.</span><span class="ident" id="7266526">Sprintf</span><span class="op" id="7266533">(</span><span class="string" id="7266534">&#34;%#v&#34;</span><span class="op" id="7266539">,</span>&nbsp;<span class="ident" id="7266541">want</span><span class="op" id="7266545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266555">t</span><span class="op" id="7266556">.</span><span class="ident" id="7266557">Errorf</span><span class="op" id="7266563">(</span><span class="string" id="7266564">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7266588">,</span>&nbsp;<span class="ident" id="7266590">i</span><span class="op" id="7266591">,</span>&nbsp;<span class="ident" id="7266593">shave</span><span class="op" id="7266598">,</span>&nbsp;<span class="ident" id="7266600">swant</span><span class="op" id="7266605">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7266614">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266665">switch</span>&nbsp;<span class="op" id="7266672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266676">case</span>&nbsp;<span class="ident" id="7266681">start</span>&nbsp;<span class="op" id="7266687">&lt;</span>&nbsp;<span class="ident" id="7266689">lastEnd</span><span class="op" id="7266696">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266701">t</span><span class="op" id="7266702">.</span><span class="ident" id="7266703">Errorf</span><span class="op" id="7266709">(</span><span class="string" id="7266710">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="7266770">,</span>&nbsp;<span class="ident" id="7266772">i</span><span class="op" id="7266773">,</span>&nbsp;<span class="ident" id="7266775">start</span><span class="op" id="7266780">,</span>&nbsp;<span class="ident" id="7266782">end</span><span class="op" id="7266785">,</span>&nbsp;<span class="ident" id="7266787">have</span><span class="op" id="7266791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266795">case</span>&nbsp;<span class="ident" id="7266800">start</span>&nbsp;<span class="op" id="7266806">&gt;=</span>&nbsp;<span class="ident" id="7266809">end</span><span class="op" id="7266812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7266817">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266868">if</span>&nbsp;<span class="ident" id="7266871">start</span>&nbsp;<span class="op" id="7266877">==</span>&nbsp;<span class="ident" id="7266880">end</span>&nbsp;<span class="op" id="7266884">&amp;&amp;</span>&nbsp;<span class="ident" id="7266887">end</span>&nbsp;<span class="op" id="7266891">==</span>&nbsp;<span class="ident" id="7266894">lastEnd</span>&nbsp;<span class="op" id="7266902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266908">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266922">t</span><span class="op" id="7266923">.</span><span class="ident" id="7266924">Errorf</span><span class="op" id="7266930">(</span><span class="string" id="7266931">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="7266975">,</span>&nbsp;<span class="ident" id="7266977">i</span><span class="op" id="7266978">,</span>&nbsp;<span class="ident" id="7266980">start</span><span class="op" id="7266985">,</span>&nbsp;<span class="ident" id="7266987">end</span><span class="op" id="7266990">,</span>&nbsp;<span class="ident" id="7266992">have</span><span class="op" id="7266996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267000">case</span>&nbsp;<span class="ident" id="7267005">end</span>&nbsp;<span class="op" id="7267009">&gt;</span>&nbsp;<span class="ident" id="7267011">int64</span><span class="op" id="7267016">(</span><span class="builtinfunc" id="7267017">len</span><span class="op" id="7267020">(</span><span class="ident" id="7267021">raw</span><span class="op" id="7267024">)</span><span class="op" id="7267025">)</span><span class="op" id="7267026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267031">t</span><span class="op" id="7267032">.</span><span class="ident" id="7267033">Errorf</span><span class="op" id="7267039">(</span><span class="string" id="7267040">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="7267096">,</span>&nbsp;<span class="ident" id="7267098">i</span><span class="op" id="7267099">,</span>&nbsp;<span class="ident" id="7267101">start</span><span class="op" id="7267106">,</span>&nbsp;<span class="ident" id="7267108">end</span><span class="op" id="7267111">,</span>&nbsp;<span class="ident" id="7267113">have</span><span class="op" id="7267117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267121">default</span><span class="op" id="7267128">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267133">text</span>&nbsp;<span class="op" id="7267138">:=</span>&nbsp;<span class="ident" id="7267141">raw</span><span class="op" id="7267144">[</span><span class="ident" id="7267145">start</span><span class="op" id="7267150">:</span><span class="ident" id="7267151">end</span><span class="op" id="7267154">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267159">if</span>&nbsp;<span class="ident" id="7267162">strings</span><span class="op" id="7267169">.</span><span class="ident" id="7267170">ContainsAny</span><span class="op" id="7267181">(</span><span class="ident" id="7267182">text</span><span class="op" id="7267186">,</span>&nbsp;<span class="string" id="7267188">&#34;&lt;&gt;&#34;</span><span class="op" id="7267192">)</span>&nbsp;<span class="op" id="7267194">&amp;&amp;</span>&nbsp;<span class="op" id="7267197">(</span><span class="op" id="7267198">!</span><span class="ident" id="7267199">strings</span><span class="op" id="7267206">.</span><span class="ident" id="7267207">HasPrefix</span><span class="op" id="7267216">(</span><span class="ident" id="7267217">text</span><span class="op" id="7267221">,</span>&nbsp;<span class="string" id="7267223">&#34;&lt;&#34;</span><span class="op" id="7267226">)</span>&nbsp;<span class="op" id="7267228">||</span>&nbsp;<span class="op" id="7267231">!</span><span class="ident" id="7267232">strings</span><span class="op" id="7267239">.</span><span class="ident" id="7267240">HasSuffix</span><span class="op" id="7267249">(</span><span class="ident" id="7267250">text</span><span class="op" id="7267254">,</span>&nbsp;<span class="string" id="7267256">&#34;&gt;&#34;</span><span class="op" id="7267259">)</span><span class="op" id="7267260">)</span>&nbsp;<span class="op" id="7267262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267268">t</span><span class="op" id="7267269">.</span><span class="ident" id="7267270">Errorf</span><span class="op" id="7267276">(</span><span class="string" id="7267277">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="7267320">,</span>&nbsp;<span class="ident" id="7267322">i</span><span class="op" id="7267323">,</span>&nbsp;<span class="ident" id="7267325">text</span><span class="op" id="7267329">,</span>&nbsp;<span class="ident" id="7267331">have</span><span class="op" id="7267335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267344">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267348">lastEnd</span>&nbsp;<span class="op" id="7267356">=</span>&nbsp;<span class="ident" id="7267358">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267363">}</span><br>
<span class="lineno"></span><span class="op" id="7267365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7267368">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="7267439">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="7267507">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7267565">var</span>&nbsp;<span class="ident" id="7267569">nestedDirectivesInput</span>&nbsp;<span class="op" id="7267591">=</span>&nbsp;<span class="string" id="7267593">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7267859">var</span>&nbsp;<span class="ident" id="7267863">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7267886">=</span>&nbsp;<span class="op" id="7267888">[</span><span class="op" id="7267889">]</span><span class="ident" id="7267890">Token</span><span class="op" id="7267895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267898">CharData</span><span class="op" id="7267906">(</span><span class="string" id="7267907">&#34;\n&#34;</span><span class="op" id="7267911">)</span><span class="op" id="7267912">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267915">Directive</span><span class="op" id="7267924">(</span><span class="string" id="7267925">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7267996">)</span><span class="op" id="7267997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268000">CharData</span><span class="op" id="7268008">(</span><span class="string" id="7268009">&#34;\n&#34;</span><span class="op" id="7268013">)</span><span class="op" id="7268014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268017">Directive</span><span class="op" id="7268026">(</span><span class="string" id="7268027">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="7268056">)</span><span class="op" id="7268057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268060">CharData</span><span class="op" id="7268068">(</span><span class="string" id="7268069">&#34;\n&#34;</span><span class="op" id="7268073">)</span><span class="op" id="7268074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268077">Directive</span><span class="op" id="7268086">(</span><span class="string" id="7268087">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="7268116">)</span><span class="op" id="7268117">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268120">CharData</span><span class="op" id="7268128">(</span><span class="string" id="7268129">&#34;\n&#34;</span><span class="op" id="7268133">)</span><span class="op" id="7268134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268137">Directive</span><span class="op" id="7268146">(</span><span class="string" id="7268147">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="7268176">)</span><span class="op" id="7268177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268180">CharData</span><span class="op" id="7268188">(</span><span class="string" id="7268189">&#34;\n&#34;</span><span class="op" id="7268193">)</span><span class="op" id="7268194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268197">Directive</span><span class="op" id="7268206">(</span><span class="string" id="7268207">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="7268236">)</span><span class="op" id="7268237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268240">CharData</span><span class="op" id="7268248">(</span><span class="string" id="7268249">&#34;\n&#34;</span><span class="op" id="7268253">)</span><span class="op" id="7268254">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268257">Directive</span><span class="op" id="7268266">(</span><span class="string" id="7268267">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="7268297">)</span><span class="op" id="7268298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268301">CharData</span><span class="op" id="7268309">(</span><span class="string" id="7268310">&#34;\n&#34;</span><span class="op" id="7268314">)</span><span class="op" id="7268315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268318">Directive</span><span class="op" id="7268327">(</span><span class="string" id="7268328">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="7268358">)</span><span class="op" id="7268359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268362">CharData</span><span class="op" id="7268370">(</span><span class="string" id="7268371">&#34;\n&#34;</span><span class="op" id="7268375">)</span><span class="op" id="7268376">,</span><br>
<span class="lineno"></span><span class="op" id="7268378">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="7268381">func</span>&nbsp;<span class="ident" id="7268386">TestNestedDirectives</span><span class="op" id="7268406">(</span><span class="ident" id="7268407">t</span>&nbsp;<span class="op" id="7268409">*</span><span class="ident" id="7268410">testing</span><span class="op" id="7268417">.</span><span class="ident" id="7268418">T</span><span class="op" id="7268419">)</span>&nbsp;<span class="op" id="7268421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268424">d</span>&nbsp;<span class="op" id="7268426">:=</span>&nbsp;<span class="ident" id="7268429">NewDecoder</span><span class="op" id="7268439">(</span><span class="ident" id="7268440">strings</span><span class="op" id="7268447">.</span><span class="ident" id="7268448">NewReader</span><span class="op" id="7268457">(</span><span class="ident" id="7268458">nestedDirectivesInput</span><span class="op" id="7268479">)</span><span class="op" id="7268480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268484">for</span>&nbsp;<span class="ident" id="7268488">i</span><span class="op" id="7268489">,</span>&nbsp;<span class="ident" id="7268491">want</span>&nbsp;<span class="op" id="7268496">:=</span>&nbsp;<span class="keyword" id="7268499">range</span>&nbsp;<span class="ident" id="7268505">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7268528">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268532">have</span><span class="op" id="7268536">,</span>&nbsp;<span class="ident" id="7268538">err</span>&nbsp;<span class="op" id="7268542">:=</span>&nbsp;<span class="ident" id="7268545">d</span><span class="op" id="7268546">.</span><span class="ident" id="7268547">Token</span><span class="op" id="7268552">(</span><span class="op" id="7268553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268557">if</span>&nbsp;<span class="ident" id="7268560">err</span>&nbsp;<span class="op" id="7268564">!=</span>&nbsp;<span class="builtintype" id="7268567">nil</span>&nbsp;<span class="op" id="7268571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268576">t</span><span class="op" id="7268577">.</span><span class="ident" id="7268578">Fatalf</span><span class="op" id="7268584">(</span><span class="string" id="7268585">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7268617">,</span>&nbsp;<span class="ident" id="7268619">i</span><span class="op" id="7268620">,</span>&nbsp;<span class="ident" id="7268622">err</span><span class="op" id="7268625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268633">if</span>&nbsp;<span class="op" id="7268636">!</span><span class="ident" id="7268637">reflect</span><span class="op" id="7268644">.</span><span class="ident" id="7268645">DeepEqual</span><span class="op" id="7268654">(</span><span class="ident" id="7268655">have</span><span class="op" id="7268659">,</span>&nbsp;<span class="ident" id="7268661">want</span><span class="op" id="7268665">)</span>&nbsp;<span class="op" id="7268667">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268672">t</span><span class="op" id="7268673">.</span><span class="ident" id="7268674">Errorf</span><span class="op" id="7268680">(</span><span class="string" id="7268681">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7268706">,</span>&nbsp;<span class="ident" id="7268708">i</span><span class="op" id="7268709">,</span>&nbsp;<span class="ident" id="7268711">have</span><span class="op" id="7268715">,</span>&nbsp;<span class="ident" id="7268717">want</span><span class="op" id="7268721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268728">}</span><br>
<span class="lineno"></span><span class="op" id="7268730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="7268733">func</span>&nbsp;<span class="ident" id="7268738">TestToken</span><span class="op" id="7268747">(</span><span class="ident" id="7268748">t</span>&nbsp;<span class="op" id="7268750">*</span><span class="ident" id="7268751">testing</span><span class="op" id="7268758">.</span><span class="ident" id="7268759">T</span><span class="op" id="7268760">)</span>&nbsp;<span class="op" id="7268762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268765">d</span>&nbsp;<span class="op" id="7268767">:=</span>&nbsp;<span class="ident" id="7268770">NewDecoder</span><span class="op" id="7268780">(</span><span class="ident" id="7268781">strings</span><span class="op" id="7268788">.</span><span class="ident" id="7268789">NewReader</span><span class="op" id="7268798">(</span><span class="ident" id="7268799">testInput</span><span class="op" id="7268808">)</span><span class="op" id="7268809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268812">d</span><span class="op" id="7268813">.</span><span class="ident" id="7268814">Entity</span>&nbsp;<span class="op" id="7268821">=</span>&nbsp;<span class="ident" id="7268823">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268836">for</span>&nbsp;<span class="ident" id="7268840">i</span><span class="op" id="7268841">,</span>&nbsp;<span class="ident" id="7268843">want</span>&nbsp;<span class="op" id="7268848">:=</span>&nbsp;<span class="keyword" id="7268851">range</span>&nbsp;<span class="ident" id="7268857">cookedTokens</span>&nbsp;<span class="op" id="7268870">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268874">have</span><span class="op" id="7268878">,</span>&nbsp;<span class="ident" id="7268880">err</span>&nbsp;<span class="op" id="7268884">:=</span>&nbsp;<span class="ident" id="7268887">d</span><span class="op" id="7268888">.</span><span class="ident" id="7268889">Token</span><span class="op" id="7268894">(</span><span class="op" id="7268895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268899">if</span>&nbsp;<span class="ident" id="7268902">err</span>&nbsp;<span class="op" id="7268906">!=</span>&nbsp;<span class="builtintype" id="7268909">nil</span>&nbsp;<span class="op" id="7268913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268918">t</span><span class="op" id="7268919">.</span><span class="ident" id="7268920">Fatalf</span><span class="op" id="7268926">(</span><span class="string" id="7268927">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7268959">,</span>&nbsp;<span class="ident" id="7268961">i</span><span class="op" id="7268962">,</span>&nbsp;<span class="ident" id="7268964">err</span><span class="op" id="7268967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268975">if</span>&nbsp;<span class="op" id="7268978">!</span><span class="ident" id="7268979">reflect</span><span class="op" id="7268986">.</span><span class="ident" id="7268987">DeepEqual</span><span class="op" id="7268996">(</span><span class="ident" id="7268997">have</span><span class="op" id="7269001">,</span>&nbsp;<span class="ident" id="7269003">want</span><span class="op" id="7269007">)</span>&nbsp;<span class="op" id="7269009">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269014">t</span><span class="op" id="7269015">.</span><span class="ident" id="7269016">Errorf</span><span class="op" id="7269022">(</span><span class="string" id="7269023">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7269048">,</span>&nbsp;<span class="ident" id="7269050">i</span><span class="op" id="7269051">,</span>&nbsp;<span class="ident" id="7269053">have</span><span class="op" id="7269057">,</span>&nbsp;<span class="ident" id="7269059">want</span><span class="op" id="7269063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269070">}</span><br>
<span class="lineno"></span><span class="op" id="7269072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="7269075">func</span>&nbsp;<span class="ident" id="7269080">TestSyntax</span><span class="op" id="7269090">(</span><span class="ident" id="7269091">t</span>&nbsp;<span class="op" id="7269093">*</span><span class="ident" id="7269094">testing</span><span class="op" id="7269101">.</span><span class="ident" id="7269102">T</span><span class="op" id="7269103">)</span>&nbsp;<span class="op" id="7269105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269108">for</span>&nbsp;<span class="ident" id="7269112">i</span>&nbsp;<span class="op" id="7269114">:=</span>&nbsp;<span class="keyword" id="7269117">range</span>&nbsp;<span class="ident" id="7269123">xmlInput</span>&nbsp;<span class="op" id="7269132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269136">d</span>&nbsp;<span class="op" id="7269138">:=</span>&nbsp;<span class="ident" id="7269141">NewDecoder</span><span class="op" id="7269151">(</span><span class="ident" id="7269152">strings</span><span class="op" id="7269159">.</span><span class="ident" id="7269160">NewReader</span><span class="op" id="7269169">(</span><span class="ident" id="7269170">xmlInput</span><span class="op" id="7269178">[</span><span class="ident" id="7269179">i</span><span class="op" id="7269180">]</span><span class="op" id="7269181">)</span><span class="op" id="7269182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269186">var</span>&nbsp;<span class="ident" id="7269190">err</span>&nbsp;<span class="builtintype" id="7269194">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269202">for</span>&nbsp;<span class="ident" id="7269206">_</span><span class="op" id="7269207">,</span>&nbsp;<span class="ident" id="7269209">err</span>&nbsp;<span class="op" id="7269213">=</span>&nbsp;<span class="ident" id="7269215">d</span><span class="op" id="7269216">.</span><span class="ident" id="7269217">Token</span><span class="op" id="7269222">(</span><span class="op" id="7269223">)</span><span class="op" id="7269224">;</span>&nbsp;<span class="ident" id="7269226">err</span>&nbsp;<span class="op" id="7269230">==</span>&nbsp;<span class="builtintype" id="7269233">nil</span><span class="op" id="7269236">;</span>&nbsp;<span class="ident" id="7269238">_</span><span class="op" id="7269239">,</span>&nbsp;<span class="ident" id="7269241">err</span>&nbsp;<span class="op" id="7269245">=</span>&nbsp;<span class="ident" id="7269247">d</span><span class="op" id="7269248">.</span><span class="ident" id="7269249">Token</span><span class="op" id="7269254">(</span><span class="op" id="7269255">)</span>&nbsp;<span class="op" id="7269257">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269265">if</span>&nbsp;<span class="ident" id="7269268">_</span><span class="op" id="7269269">,</span>&nbsp;<span class="ident" id="7269271">ok</span>&nbsp;<span class="op" id="7269274">:=</span>&nbsp;<span class="ident" id="7269277">err</span><span class="op" id="7269280">.</span><span class="op" id="7269281">(</span><span class="op" id="7269282">*</span><span class="ident" id="7269283">SyntaxError</span><span class="op" id="7269294">)</span><span class="op" id="7269295">;</span>&nbsp;<span class="op" id="7269297">!</span><span class="ident" id="7269298">ok</span>&nbsp;<span class="op" id="7269301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269306">t</span><span class="op" id="7269307">.</span><span class="ident" id="7269308">Fatalf</span><span class="op" id="7269314">(</span><span class="string" id="7269315">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="7269365">,</span>&nbsp;<span class="ident" id="7269367">xmlInput</span><span class="op" id="7269375">[</span><span class="ident" id="7269376">i</span><span class="op" id="7269377">]</span><span class="op" id="7269378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269385">}</span><br>
<span class="lineno">400</span><span class="op" id="7269387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7269390">type</span>&nbsp;<span class="ident" id="7269395">allScalars</span>&nbsp;<span class="keyword" id="7269406">struct</span>&nbsp;<span class="op" id="7269413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269416">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269426">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269432">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269442">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269448">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269458">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269464">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269474">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269480">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269490">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269495">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269505">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269511">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269521">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269528">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269538">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269545">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269555">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269562">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269572">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269577">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269587">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269594">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269604">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269612">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269622">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269630">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269640">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269648">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269658">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269667">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269677">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269686">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269696">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269705">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269715">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269723">PtrString</span>&nbsp;<span class="op" id="7269733">*</span><span class="builtintype" id="7269734">string</span><br>
<span class="lineno"></span><span class="op" id="7269741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7269744">var</span>&nbsp;<span class="ident" id="7269748">all</span>&nbsp;<span class="op" id="7269752">=</span>&nbsp;<span class="ident" id="7269754">allScalars</span><span class="op" id="7269764">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269767">True1</span><span class="op" id="7269772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269778">true</span><span class="op" id="7269782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269785">True2</span><span class="op" id="7269790">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269796">true</span><span class="op" id="7269800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269803">False1</span><span class="op" id="7269809">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269814">false</span><span class="op" id="7269819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269822">False2</span><span class="op" id="7269828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7269833">false</span><span class="op" id="7269838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269841">Int</span><span class="op" id="7269844">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269852">1</span><span class="op" id="7269853">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269856">Int8</span><span class="op" id="7269860">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269867">-</span><span class="num" id="7269868">2</span><span class="op" id="7269869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269872">Int16</span><span class="op" id="7269877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269883">3</span><span class="op" id="7269884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269887">Int32</span><span class="op" id="7269892">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269898">-</span><span class="num" id="7269899">4</span><span class="op" id="7269900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269903">Int64</span><span class="op" id="7269908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269914">5</span><span class="op" id="7269915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269918">Uint</span><span class="op" id="7269922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269929">6</span><span class="op" id="7269930">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269933">Uint8</span><span class="op" id="7269938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269944">7</span><span class="op" id="7269945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269948">Uint16</span><span class="op" id="7269954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269959">8</span><span class="op" id="7269960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269963">Uint32</span><span class="op" id="7269969">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269974">9</span><span class="op" id="7269975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269978">Uint64</span><span class="op" id="7269984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7269989">10</span><span class="op" id="7269991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269994">Uintptr</span><span class="op" id="7270001">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7270005">11</span><span class="op" id="7270007">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270010">Float32</span><span class="op" id="7270017">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7270021">13.0</span><span class="op" id="7270025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270028">Float64</span><span class="op" id="7270035">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7270039">14.0</span><span class="op" id="7270043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270046">String</span><span class="op" id="7270052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7270057">&#34;15&#34;</span><span class="op" id="7270061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270064">PtrString</span><span class="op" id="7270073">:</span>&nbsp;<span class="op" id="7270075">&amp;</span><span class="ident" id="7270076">sixteen</span><span class="op" id="7270083">,</span><br>
<span class="lineno"></span><span class="op" id="7270085">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="7270088">var</span>&nbsp;<span class="ident" id="7270092">sixteen</span>&nbsp;<span class="op" id="7270100">=</span>&nbsp;<span class="string" id="7270102">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7270108">const</span>&nbsp;<span class="ident" id="7270114">testScalarsInput</span>&nbsp;<span class="op" id="7270131">=</span>&nbsp;<span class="string" id="7270133">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="7270569">func</span>&nbsp;<span class="ident" id="7270574">TestAllScalars</span><span class="op" id="7270588">(</span><span class="ident" id="7270589">t</span>&nbsp;<span class="op" id="7270591">*</span><span class="ident" id="7270592">testing</span><span class="op" id="7270599">.</span><span class="ident" id="7270600">T</span><span class="op" id="7270601">)</span>&nbsp;<span class="op" id="7270603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270606">var</span>&nbsp;<span class="ident" id="7270610">a</span>&nbsp;<span class="ident" id="7270612">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270624">err</span>&nbsp;<span class="op" id="7270628">:=</span>&nbsp;<span class="ident" id="7270631">Unmarshal</span><span class="op" id="7270640">(</span><span class="op" id="7270641">[</span><span class="op" id="7270642">]</span><span class="builtintype" id="7270643">byte</span><span class="op" id="7270647">(</span><span class="ident" id="7270648">testScalarsInput</span><span class="op" id="7270664">)</span><span class="op" id="7270665">,</span>&nbsp;<span class="op" id="7270667">&amp;</span><span class="ident" id="7270668">a</span><span class="op" id="7270669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270673">if</span>&nbsp;<span class="ident" id="7270676">err</span>&nbsp;<span class="op" id="7270680">!=</span>&nbsp;<span class="builtintype" id="7270683">nil</span>&nbsp;<span class="op" id="7270687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270691">t</span><span class="op" id="7270692">.</span><span class="ident" id="7270693">Fatal</span><span class="op" id="7270698">(</span><span class="ident" id="7270699">err</span><span class="op" id="7270702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270708">if</span>&nbsp;<span class="op" id="7270711">!</span><span class="ident" id="7270712">reflect</span><span class="op" id="7270719">.</span><span class="ident" id="7270720">DeepEqual</span><span class="op" id="7270729">(</span><span class="ident" id="7270730">a</span><span class="op" id="7270731">,</span>&nbsp;<span class="ident" id="7270733">all</span><span class="op" id="7270736">)</span>&nbsp;<span class="op" id="7270738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270742">t</span><span class="op" id="7270743">.</span><span class="ident" id="7270744">Errorf</span><span class="op" id="7270750">(</span><span class="string" id="7270751">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="7270770">,</span>&nbsp;<span class="ident" id="7270772">a</span><span class="op" id="7270773">,</span>&nbsp;<span class="ident" id="7270775">all</span><span class="op" id="7270778">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270781">}</span><br>
<span class="lineno"></span><span class="op" id="7270783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7270786">type</span>&nbsp;<span class="ident" id="7270791">item</span>&nbsp;<span class="keyword" id="7270796">struct</span>&nbsp;<span class="op" id="7270803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270806">Field_a</span>&nbsp;<span class="builtintype" id="7270814">string</span><br>
<span class="lineno">485</span><span class="op" id="7270821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7270824">func</span>&nbsp;<span class="ident" id="7270829">TestIssue569</span><span class="op" id="7270841">(</span><span class="ident" id="7270842">t</span>&nbsp;<span class="op" id="7270844">*</span><span class="ident" id="7270845">testing</span><span class="op" id="7270852">.</span><span class="ident" id="7270853">T</span><span class="op" id="7270854">)</span>&nbsp;<span class="op" id="7270856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270859">data</span>&nbsp;<span class="op" id="7270864">:=</span>&nbsp;<span class="string" id="7270867">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270907">var</span>&nbsp;<span class="ident" id="7270911">i</span>&nbsp;<span class="ident" id="7270913">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270919">err</span>&nbsp;<span class="op" id="7270923">:=</span>&nbsp;<span class="ident" id="7270926">Unmarshal</span><span class="op" id="7270935">(</span><span class="op" id="7270936">[</span><span class="op" id="7270937">]</span><span class="builtintype" id="7270938">byte</span><span class="op" id="7270942">(</span><span class="ident" id="7270943">data</span><span class="op" id="7270947">)</span><span class="op" id="7270948">,</span>&nbsp;<span class="op" id="7270950">&amp;</span><span class="ident" id="7270951">i</span><span class="op" id="7270952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270956">if</span>&nbsp;<span class="ident" id="7270959">err</span>&nbsp;<span class="op" id="7270963">!=</span>&nbsp;<span class="builtintype" id="7270966">nil</span>&nbsp;<span class="op" id="7270970">||</span>&nbsp;<span class="ident" id="7270973">i</span><span class="op" id="7270974">.</span><span class="ident" id="7270975">Field_a</span>&nbsp;<span class="op" id="7270983">!=</span>&nbsp;<span class="string" id="7270986">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7270993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270997">t</span><span class="op" id="7270998">.</span><span class="ident" id="7270999">Fatal</span><span class="op" id="7271004">(</span><span class="string" id="7271005">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="7271021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271024">}</span><br>
<span class="lineno">495</span><span class="op" id="7271026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7271029">func</span>&nbsp;<span class="ident" id="7271034">TestUnquotedAttrs</span><span class="op" id="7271051">(</span><span class="ident" id="7271052">t</span>&nbsp;<span class="op" id="7271054">*</span><span class="ident" id="7271055">testing</span><span class="op" id="7271062">.</span><span class="ident" id="7271063">T</span><span class="op" id="7271064">)</span>&nbsp;<span class="op" id="7271066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271069">data</span>&nbsp;<span class="op" id="7271074">:=</span>&nbsp;<span class="string" id="7271077">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271103">d</span>&nbsp;<span class="op" id="7271105">:=</span>&nbsp;<span class="ident" id="7271108">NewDecoder</span><span class="op" id="7271118">(</span><span class="ident" id="7271119">strings</span><span class="op" id="7271126">.</span><span class="ident" id="7271127">NewReader</span><span class="op" id="7271136">(</span><span class="ident" id="7271137">data</span><span class="op" id="7271141">)</span><span class="op" id="7271142">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271145">d</span><span class="op" id="7271146">.</span><span class="ident" id="7271147">Strict</span>&nbsp;<span class="op" id="7271154">=</span>&nbsp;<span class="builtintype" id="7271156">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271163">token</span><span class="op" id="7271168">,</span>&nbsp;<span class="ident" id="7271170">err</span>&nbsp;<span class="op" id="7271174">:=</span>&nbsp;<span class="ident" id="7271177">d</span><span class="op" id="7271178">.</span><span class="ident" id="7271179">Token</span><span class="op" id="7271184">(</span><span class="op" id="7271185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271188">if</span>&nbsp;<span class="ident" id="7271191">_</span><span class="op" id="7271192">,</span>&nbsp;<span class="ident" id="7271194">ok</span>&nbsp;<span class="op" id="7271197">:=</span>&nbsp;<span class="ident" id="7271200">err</span><span class="op" id="7271203">.</span><span class="op" id="7271204">(</span><span class="op" id="7271205">*</span><span class="ident" id="7271206">SyntaxError</span><span class="op" id="7271217">)</span><span class="op" id="7271218">;</span>&nbsp;<span class="ident" id="7271220">ok</span>&nbsp;<span class="op" id="7271223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271227">t</span><span class="op" id="7271228">.</span><span class="ident" id="7271229">Errorf</span><span class="op" id="7271235">(</span><span class="string" id="7271236">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7271258">,</span>&nbsp;<span class="ident" id="7271260">err</span><span class="op" id="7271263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271266">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271269">if</span>&nbsp;<span class="ident" id="7271272">token</span><span class="op" id="7271277">.</span><span class="op" id="7271278">(</span><span class="ident" id="7271279">StartElement</span><span class="op" id="7271291">)</span><span class="op" id="7271292">.</span><span class="ident" id="7271293">Name</span><span class="op" id="7271297">.</span><span class="ident" id="7271298">Local</span>&nbsp;<span class="op" id="7271304">!=</span>&nbsp;<span class="string" id="7271307">&#34;tag&#34;</span>&nbsp;<span class="op" id="7271313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271317">t</span><span class="op" id="7271318">.</span><span class="ident" id="7271319">Errorf</span><span class="op" id="7271325">(</span><span class="string" id="7271326">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7271351">,</span>&nbsp;<span class="ident" id="7271353">token</span><span class="op" id="7271358">.</span><span class="op" id="7271359">(</span><span class="ident" id="7271360">StartElement</span><span class="op" id="7271372">)</span><span class="op" id="7271373">.</span><span class="ident" id="7271374">Name</span><span class="op" id="7271378">.</span><span class="ident" id="7271379">Local</span><span class="op" id="7271384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271390">attr</span>&nbsp;<span class="op" id="7271395">:=</span>&nbsp;<span class="ident" id="7271398">token</span><span class="op" id="7271403">.</span><span class="op" id="7271404">(</span><span class="ident" id="7271405">StartElement</span><span class="op" id="7271417">)</span><span class="op" id="7271418">.</span><span class="ident" id="7271419">Attr</span><span class="op" id="7271423">[</span><span class="num" id="7271424">0</span><span class="op" id="7271425">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271428">if</span>&nbsp;<span class="ident" id="7271431">attr</span><span class="op" id="7271435">.</span><span class="ident" id="7271436">Value</span>&nbsp;<span class="op" id="7271442">!=</span>&nbsp;<span class="string" id="7271445">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="7271457">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271461">t</span><span class="op" id="7271462">.</span><span class="ident" id="7271463">Errorf</span><span class="op" id="7271469">(</span><span class="string" id="7271470">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7271502">,</span>&nbsp;<span class="ident" id="7271504">attr</span><span class="op" id="7271508">.</span><span class="ident" id="7271509">Value</span><span class="op" id="7271514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271520">if</span>&nbsp;<span class="ident" id="7271523">attr</span><span class="op" id="7271527">.</span><span class="ident" id="7271528">Name</span><span class="op" id="7271532">.</span><span class="ident" id="7271533">Local</span>&nbsp;<span class="op" id="7271539">!=</span>&nbsp;<span class="string" id="7271542">&#34;attr&#34;</span>&nbsp;<span class="op" id="7271549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271553">t</span><span class="op" id="7271554">.</span><span class="ident" id="7271555">Errorf</span><span class="op" id="7271561">(</span><span class="string" id="7271562">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7271593">,</span>&nbsp;<span class="ident" id="7271595">attr</span><span class="op" id="7271599">.</span><span class="ident" id="7271600">Name</span><span class="op" id="7271604">.</span><span class="ident" id="7271605">Local</span><span class="op" id="7271610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271613">}</span><br>
<span class="lineno">515</span><span class="op" id="7271615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7271618">func</span>&nbsp;<span class="ident" id="7271623">TestValuelessAttrs</span><span class="op" id="7271641">(</span><span class="ident" id="7271642">t</span>&nbsp;<span class="op" id="7271644">*</span><span class="ident" id="7271645">testing</span><span class="op" id="7271652">.</span><span class="ident" id="7271653">T</span><span class="op" id="7271654">)</span>&nbsp;<span class="op" id="7271656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271659">tests</span>&nbsp;<span class="op" id="7271665">:=</span>&nbsp;<span class="op" id="7271668">[</span><span class="op" id="7271669">]</span><span class="op" id="7271670">[</span><span class="num" id="7271671">3</span><span class="op" id="7271672">]</span><span class="builtintype" id="7271673">string</span><span class="op" id="7271679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271683">{</span><span class="string" id="7271684">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="7271696">,</span>&nbsp;<span class="string" id="7271698">&#34;p&#34;</span><span class="op" id="7271701">,</span>&nbsp;<span class="string" id="7271703">&#34;nowrap&#34;</span><span class="op" id="7271711">}</span><span class="op" id="7271712">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271716">{</span><span class="string" id="7271717">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="7271730">,</span>&nbsp;<span class="string" id="7271732">&#34;p&#34;</span><span class="op" id="7271735">,</span>&nbsp;<span class="string" id="7271737">&#34;nowrap&#34;</span><span class="op" id="7271745">}</span><span class="op" id="7271746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271750">{</span><span class="string" id="7271751">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="7271769">,</span>&nbsp;<span class="string" id="7271771">&#34;input&#34;</span><span class="op" id="7271778">,</span>&nbsp;<span class="string" id="7271780">&#34;checked&#34;</span><span class="op" id="7271789">}</span><span class="op" id="7271790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271794">{</span><span class="string" id="7271795">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="7271814">,</span>&nbsp;<span class="string" id="7271816">&#34;input&#34;</span><span class="op" id="7271823">,</span>&nbsp;<span class="string" id="7271825">&#34;checked&#34;</span><span class="op" id="7271834">}</span><span class="op" id="7271835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271841">for</span>&nbsp;<span class="ident" id="7271845">_</span><span class="op" id="7271846">,</span>&nbsp;<span class="ident" id="7271848">test</span>&nbsp;<span class="op" id="7271853">:=</span>&nbsp;<span class="keyword" id="7271856">range</span>&nbsp;<span class="ident" id="7271862">tests</span>&nbsp;<span class="op" id="7271868">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271872">d</span>&nbsp;<span class="op" id="7271874">:=</span>&nbsp;<span class="ident" id="7271877">NewDecoder</span><span class="op" id="7271887">(</span><span class="ident" id="7271888">strings</span><span class="op" id="7271895">.</span><span class="ident" id="7271896">NewReader</span><span class="op" id="7271905">(</span><span class="ident" id="7271906">test</span><span class="op" id="7271910">[</span><span class="num" id="7271911">0</span><span class="op" id="7271912">]</span><span class="op" id="7271913">)</span><span class="op" id="7271914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271918">d</span><span class="op" id="7271919">.</span><span class="ident" id="7271920">Strict</span>&nbsp;<span class="op" id="7271927">=</span>&nbsp;<span class="builtintype" id="7271929">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271937">token</span><span class="op" id="7271942">,</span>&nbsp;<span class="ident" id="7271944">err</span>&nbsp;<span class="op" id="7271948">:=</span>&nbsp;<span class="ident" id="7271951">d</span><span class="op" id="7271952">.</span><span class="ident" id="7271953">Token</span><span class="op" id="7271958">(</span><span class="op" id="7271959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271963">if</span>&nbsp;<span class="ident" id="7271966">_</span><span class="op" id="7271967">,</span>&nbsp;<span class="ident" id="7271969">ok</span>&nbsp;<span class="op" id="7271972">:=</span>&nbsp;<span class="ident" id="7271975">err</span><span class="op" id="7271978">.</span><span class="op" id="7271979">(</span><span class="op" id="7271980">*</span><span class="ident" id="7271981">SyntaxError</span><span class="op" id="7271992">)</span><span class="op" id="7271993">;</span>&nbsp;<span class="ident" id="7271995">ok</span>&nbsp;<span class="op" id="7271998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272003">t</span><span class="op" id="7272004">.</span><span class="ident" id="7272005">Errorf</span><span class="op" id="7272011">(</span><span class="string" id="7272012">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7272034">,</span>&nbsp;<span class="ident" id="7272036">err</span><span class="op" id="7272039">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272047">if</span>&nbsp;<span class="ident" id="7272050">token</span><span class="op" id="7272055">.</span><span class="op" id="7272056">(</span><span class="ident" id="7272057">StartElement</span><span class="op" id="7272069">)</span><span class="op" id="7272070">.</span><span class="ident" id="7272071">Name</span><span class="op" id="7272075">.</span><span class="ident" id="7272076">Local</span>&nbsp;<span class="op" id="7272082">!=</span>&nbsp;<span class="ident" id="7272085">test</span><span class="op" id="7272089">[</span><span class="num" id="7272090">1</span><span class="op" id="7272091">]</span>&nbsp;<span class="op" id="7272093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272098">t</span><span class="op" id="7272099">.</span><span class="ident" id="7272100">Errorf</span><span class="op" id="7272106">(</span><span class="string" id="7272107">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7272132">,</span>&nbsp;<span class="ident" id="7272134">token</span><span class="op" id="7272139">.</span><span class="op" id="7272140">(</span><span class="ident" id="7272141">StartElement</span><span class="op" id="7272153">)</span><span class="op" id="7272154">.</span><span class="ident" id="7272155">Name</span><span class="op" id="7272159">.</span><span class="ident" id="7272160">Local</span><span class="op" id="7272165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272173">attr</span>&nbsp;<span class="op" id="7272178">:=</span>&nbsp;<span class="ident" id="7272181">token</span><span class="op" id="7272186">.</span><span class="op" id="7272187">(</span><span class="ident" id="7272188">StartElement</span><span class="op" id="7272200">)</span><span class="op" id="7272201">.</span><span class="ident" id="7272202">Attr</span><span class="op" id="7272206">[</span><span class="num" id="7272207">0</span><span class="op" id="7272208">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272212">if</span>&nbsp;<span class="ident" id="7272215">attr</span><span class="op" id="7272219">.</span><span class="ident" id="7272220">Value</span>&nbsp;<span class="op" id="7272226">!=</span>&nbsp;<span class="ident" id="7272229">test</span><span class="op" id="7272233">[</span><span class="num" id="7272234">2</span><span class="op" id="7272235">]</span>&nbsp;<span class="op" id="7272237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272242">t</span><span class="op" id="7272243">.</span><span class="ident" id="7272244">Errorf</span><span class="op" id="7272250">(</span><span class="string" id="7272251">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7272283">,</span>&nbsp;<span class="ident" id="7272285">attr</span><span class="op" id="7272289">.</span><span class="ident" id="7272290">Value</span><span class="op" id="7272295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272303">if</span>&nbsp;<span class="ident" id="7272306">attr</span><span class="op" id="7272310">.</span><span class="ident" id="7272311">Name</span><span class="op" id="7272315">.</span><span class="ident" id="7272316">Local</span>&nbsp;<span class="op" id="7272322">!=</span>&nbsp;<span class="ident" id="7272325">test</span><span class="op" id="7272329">[</span><span class="num" id="7272330">2</span><span class="op" id="7272331">]</span>&nbsp;<span class="op" id="7272333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272338">t</span><span class="op" id="7272339">.</span><span class="ident" id="7272340">Errorf</span><span class="op" id="7272346">(</span><span class="string" id="7272347">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7272378">,</span>&nbsp;<span class="ident" id="7272380">attr</span><span class="op" id="7272384">.</span><span class="ident" id="7272385">Name</span><span class="op" id="7272389">.</span><span class="ident" id="7272390">Local</span><span class="op" id="7272395">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272402">}</span><br>
<span class="lineno"></span><span class="op" id="7272404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7272407">func</span>&nbsp;<span class="ident" id="7272412">TestCopyTokenCharData</span><span class="op" id="7272433">(</span><span class="ident" id="7272434">t</span>&nbsp;<span class="op" id="7272436">*</span><span class="ident" id="7272437">testing</span><span class="op" id="7272444">.</span><span class="ident" id="7272445">T</span><span class="op" id="7272446">)</span>&nbsp;<span class="op" id="7272448">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272451">data</span>&nbsp;<span class="op" id="7272456">:=</span>&nbsp;<span class="op" id="7272459">[</span><span class="op" id="7272460">]</span><span class="builtintype" id="7272461">byte</span><span class="op" id="7272465">(</span><span class="string" id="7272466">&#34;same&nbsp;data&#34;</span><span class="op" id="7272477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272480">var</span>&nbsp;<span class="ident" id="7272484">tok1</span>&nbsp;<span class="ident" id="7272489">Token</span>&nbsp;<span class="op" id="7272495">=</span>&nbsp;<span class="ident" id="7272497">CharData</span><span class="op" id="7272505">(</span><span class="ident" id="7272506">data</span><span class="op" id="7272510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272513">tok2</span>&nbsp;<span class="op" id="7272518">:=</span>&nbsp;<span class="ident" id="7272521">CopyToken</span><span class="op" id="7272530">(</span><span class="ident" id="7272531">tok1</span><span class="op" id="7272535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272538">if</span>&nbsp;<span class="op" id="7272541">!</span><span class="ident" id="7272542">reflect</span><span class="op" id="7272549">.</span><span class="ident" id="7272550">DeepEqual</span><span class="op" id="7272559">(</span><span class="ident" id="7272560">tok1</span><span class="op" id="7272564">,</span>&nbsp;<span class="ident" id="7272566">tok2</span><span class="op" id="7272570">)</span>&nbsp;<span class="op" id="7272572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272576">t</span><span class="op" id="7272577">.</span><span class="ident" id="7272578">Error</span><span class="op" id="7272583">(</span><span class="string" id="7272584">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="7272617">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272623">data</span><span class="op" id="7272627">[</span><span class="num" id="7272628">1</span><span class="op" id="7272629">]</span>&nbsp;<span class="op" id="7272631">=</span>&nbsp;<span class="string" id="7272633">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272638">if</span>&nbsp;<span class="ident" id="7272641">reflect</span><span class="op" id="7272648">.</span><span class="ident" id="7272649">DeepEqual</span><span class="op" id="7272658">(</span><span class="ident" id="7272659">tok1</span><span class="op" id="7272663">,</span>&nbsp;<span class="ident" id="7272665">tok2</span><span class="op" id="7272669">)</span>&nbsp;<span class="op" id="7272671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272675">t</span><span class="op" id="7272676">.</span><span class="ident" id="7272677">Error</span><span class="op" id="7272682">(</span><span class="string" id="7272683">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7272722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272725">}</span><br>
<span class="lineno">555</span><span class="op" id="7272727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7272730">func</span>&nbsp;<span class="ident" id="7272735">TestCopyTokenStartElement</span><span class="op" id="7272760">(</span><span class="ident" id="7272761">t</span>&nbsp;<span class="op" id="7272763">*</span><span class="ident" id="7272764">testing</span><span class="op" id="7272771">.</span><span class="ident" id="7272772">T</span><span class="op" id="7272773">)</span>&nbsp;<span class="op" id="7272775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272778">elt</span>&nbsp;<span class="op" id="7272782">:=</span>&nbsp;<span class="ident" id="7272785">StartElement</span><span class="op" id="7272797">{</span><span class="ident" id="7272798">Name</span><span class="op" id="7272802">{</span><span class="string" id="7272803">&#34;&#34;</span><span class="op" id="7272805">,</span>&nbsp;<span class="string" id="7272807">&#34;hello&#34;</span><span class="op" id="7272814">}</span><span class="op" id="7272815">,</span>&nbsp;<span class="op" id="7272817">[</span><span class="op" id="7272818">]</span><span class="ident" id="7272819">Attr</span><span class="op" id="7272823">{</span><span class="op" id="7272824">{</span><span class="ident" id="7272825">Name</span><span class="op" id="7272829">{</span><span class="string" id="7272830">&#34;&#34;</span><span class="op" id="7272832">,</span>&nbsp;<span class="string" id="7272834">&#34;lang&#34;</span><span class="op" id="7272840">}</span><span class="op" id="7272841">,</span>&nbsp;<span class="string" id="7272843">&#34;en&#34;</span><span class="op" id="7272847">}</span><span class="op" id="7272848">}</span><span class="op" id="7272849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272852">var</span>&nbsp;<span class="ident" id="7272856">tok1</span>&nbsp;<span class="ident" id="7272861">Token</span>&nbsp;<span class="op" id="7272867">=</span>&nbsp;<span class="ident" id="7272869">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272874">tok2</span>&nbsp;<span class="op" id="7272879">:=</span>&nbsp;<span class="ident" id="7272882">CopyToken</span><span class="op" id="7272891">(</span><span class="ident" id="7272892">tok1</span><span class="op" id="7272896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272899">if</span>&nbsp;<span class="ident" id="7272902">tok1</span><span class="op" id="7272906">.</span><span class="op" id="7272907">(</span><span class="ident" id="7272908">StartElement</span><span class="op" id="7272920">)</span><span class="op" id="7272921">.</span><span class="ident" id="7272922">Attr</span><span class="op" id="7272926">[</span><span class="num" id="7272927">0</span><span class="op" id="7272928">]</span><span class="op" id="7272929">.</span><span class="ident" id="7272930">Value</span>&nbsp;<span class="op" id="7272936">!=</span>&nbsp;<span class="string" id="7272939">&#34;en&#34;</span>&nbsp;<span class="op" id="7272944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272948">t</span><span class="op" id="7272949">.</span><span class="ident" id="7272950">Error</span><span class="op" id="7272955">(</span><span class="string" id="7272956">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="7272985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272991">if</span>&nbsp;<span class="op" id="7272994">!</span><span class="ident" id="7272995">reflect</span><span class="op" id="7273002">.</span><span class="ident" id="7273003">DeepEqual</span><span class="op" id="7273012">(</span><span class="ident" id="7273013">tok1</span><span class="op" id="7273017">,</span>&nbsp;<span class="ident" id="7273019">tok2</span><span class="op" id="7273023">)</span>&nbsp;<span class="op" id="7273025">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273029">t</span><span class="op" id="7273030">.</span><span class="ident" id="7273031">Error</span><span class="op" id="7273036">(</span><span class="string" id="7273037">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="7273078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273084">tok1</span><span class="op" id="7273088">.</span><span class="op" id="7273089">(</span><span class="ident" id="7273090">StartElement</span><span class="op" id="7273102">)</span><span class="op" id="7273103">.</span><span class="ident" id="7273104">Attr</span><span class="op" id="7273108">[</span><span class="num" id="7273109">0</span><span class="op" id="7273110">]</span>&nbsp;<span class="op" id="7273112">=</span>&nbsp;<span class="ident" id="7273114">Attr</span><span class="op" id="7273118">{</span><span class="ident" id="7273119">Name</span><span class="op" id="7273123">{</span><span class="string" id="7273124">&#34;&#34;</span><span class="op" id="7273126">,</span>&nbsp;<span class="string" id="7273128">&#34;lang&#34;</span><span class="op" id="7273134">}</span><span class="op" id="7273135">,</span>&nbsp;<span class="string" id="7273137">&#34;de&#34;</span><span class="op" id="7273141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273144">if</span>&nbsp;<span class="ident" id="7273147">reflect</span><span class="op" id="7273154">.</span><span class="ident" id="7273155">DeepEqual</span><span class="op" id="7273164">(</span><span class="ident" id="7273165">tok1</span><span class="op" id="7273169">,</span>&nbsp;<span class="ident" id="7273171">tok2</span><span class="op" id="7273175">)</span>&nbsp;<span class="op" id="7273177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273181">t</span><span class="op" id="7273182">.</span><span class="ident" id="7273183">Error</span><span class="op" id="7273188">(</span><span class="string" id="7273189">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7273228">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273231">}</span><br>
<span class="lineno"></span><span class="op" id="7273233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7273236">func</span>&nbsp;<span class="ident" id="7273241">TestSyntaxErrorLineNum</span><span class="op" id="7273263">(</span><span class="ident" id="7273264">t</span>&nbsp;<span class="op" id="7273266">*</span><span class="ident" id="7273267">testing</span><span class="op" id="7273274">.</span><span class="ident" id="7273275">T</span><span class="op" id="7273276">)</span>&nbsp;<span class="op" id="7273278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273281">testInput</span>&nbsp;<span class="op" id="7273291">:=</span>&nbsp;<span class="string" id="7273294">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273322">d</span>&nbsp;<span class="op" id="7273324">:=</span>&nbsp;<span class="ident" id="7273327">NewDecoder</span><span class="op" id="7273337">(</span><span class="ident" id="7273338">strings</span><span class="op" id="7273345">.</span><span class="ident" id="7273346">NewReader</span><span class="op" id="7273355">(</span><span class="ident" id="7273356">testInput</span><span class="op" id="7273365">)</span><span class="op" id="7273366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273369">var</span>&nbsp;<span class="ident" id="7273373">err</span>&nbsp;<span class="builtintype" id="7273377">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273384">for</span>&nbsp;<span class="ident" id="7273388">_</span><span class="op" id="7273389">,</span>&nbsp;<span class="ident" id="7273391">err</span>&nbsp;<span class="op" id="7273395">=</span>&nbsp;<span class="ident" id="7273397">d</span><span class="op" id="7273398">.</span><span class="ident" id="7273399">Token</span><span class="op" id="7273404">(</span><span class="op" id="7273405">)</span><span class="op" id="7273406">;</span>&nbsp;<span class="ident" id="7273408">err</span>&nbsp;<span class="op" id="7273412">==</span>&nbsp;<span class="builtintype" id="7273415">nil</span><span class="op" id="7273418">;</span>&nbsp;<span class="ident" id="7273420">_</span><span class="op" id="7273421">,</span>&nbsp;<span class="ident" id="7273423">err</span>&nbsp;<span class="op" id="7273427">=</span>&nbsp;<span class="ident" id="7273429">d</span><span class="op" id="7273430">.</span><span class="ident" id="7273431">Token</span><span class="op" id="7273436">(</span><span class="op" id="7273437">)</span>&nbsp;<span class="op" id="7273439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273445">synerr</span><span class="op" id="7273451">,</span>&nbsp;<span class="ident" id="7273453">ok</span>&nbsp;<span class="op" id="7273456">:=</span>&nbsp;<span class="ident" id="7273459">err</span><span class="op" id="7273462">.</span><span class="op" id="7273463">(</span><span class="op" id="7273464">*</span><span class="ident" id="7273465">SyntaxError</span><span class="op" id="7273476">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273479">if</span>&nbsp;<span class="op" id="7273482">!</span><span class="ident" id="7273483">ok</span>&nbsp;<span class="op" id="7273486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273490">t</span><span class="op" id="7273491">.</span><span class="ident" id="7273492">Error</span><span class="op" id="7273497">(</span><span class="string" id="7273498">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="7273521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273527">if</span>&nbsp;<span class="ident" id="7273530">synerr</span><span class="op" id="7273536">.</span><span class="ident" id="7273537">Line</span>&nbsp;<span class="op" id="7273542">!=</span>&nbsp;<span class="num" id="7273545">3</span>&nbsp;<span class="op" id="7273547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273551">t</span><span class="op" id="7273552">.</span><span class="ident" id="7273553">Error</span><span class="op" id="7273558">(</span><span class="string" id="7273559">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="7273605">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273608">}</span><br>
<span class="lineno"></span><span class="op" id="7273610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7273613">func</span>&nbsp;<span class="ident" id="7273618">TestTrailingRawToken</span><span class="op" id="7273638">(</span><span class="ident" id="7273639">t</span>&nbsp;<span class="op" id="7273641">*</span><span class="ident" id="7273642">testing</span><span class="op" id="7273649">.</span><span class="ident" id="7273650">T</span><span class="op" id="7273651">)</span>&nbsp;<span class="op" id="7273653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273656">input</span>&nbsp;<span class="op" id="7273662">:=</span>&nbsp;<span class="string" id="7273665">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273682">d</span>&nbsp;<span class="op" id="7273684">:=</span>&nbsp;<span class="ident" id="7273687">NewDecoder</span><span class="op" id="7273697">(</span><span class="ident" id="7273698">strings</span><span class="op" id="7273705">.</span><span class="ident" id="7273706">NewReader</span><span class="op" id="7273715">(</span><span class="ident" id="7273716">input</span><span class="op" id="7273721">)</span><span class="op" id="7273722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273725">var</span>&nbsp;<span class="ident" id="7273729">err</span>&nbsp;<span class="builtintype" id="7273733">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273740">for</span>&nbsp;<span class="ident" id="7273744">_</span><span class="op" id="7273745">,</span>&nbsp;<span class="ident" id="7273747">err</span>&nbsp;<span class="op" id="7273751">=</span>&nbsp;<span class="ident" id="7273753">d</span><span class="op" id="7273754">.</span><span class="ident" id="7273755">RawToken</span><span class="op" id="7273763">(</span><span class="op" id="7273764">)</span><span class="op" id="7273765">;</span>&nbsp;<span class="ident" id="7273767">err</span>&nbsp;<span class="op" id="7273771">==</span>&nbsp;<span class="builtintype" id="7273774">nil</span><span class="op" id="7273777">;</span>&nbsp;<span class="ident" id="7273779">_</span><span class="op" id="7273780">,</span>&nbsp;<span class="ident" id="7273782">err</span>&nbsp;<span class="op" id="7273786">=</span>&nbsp;<span class="ident" id="7273788">d</span><span class="op" id="7273789">.</span><span class="ident" id="7273790">RawToken</span><span class="op" id="7273798">(</span><span class="op" id="7273799">)</span>&nbsp;<span class="op" id="7273801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273807">if</span>&nbsp;<span class="ident" id="7273810">err</span>&nbsp;<span class="op" id="7273814">!=</span>&nbsp;<span class="ident" id="7273817">io</span><span class="op" id="7273819">.</span><span class="ident" id="7273820">EOF</span>&nbsp;<span class="op" id="7273824">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273828">t</span><span class="op" id="7273829">.</span><span class="ident" id="7273830">Fatalf</span><span class="op" id="7273836">(</span><span class="string" id="7273837">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7273875">,</span>&nbsp;<span class="ident" id="7273877">err</span><span class="op" id="7273880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273883">}</span><br>
<span class="lineno"></span><span class="op" id="7273885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7273888">func</span>&nbsp;<span class="ident" id="7273893">TestTrailingToken</span><span class="op" id="7273910">(</span><span class="ident" id="7273911">t</span>&nbsp;<span class="op" id="7273913">*</span><span class="ident" id="7273914">testing</span><span class="op" id="7273921">.</span><span class="ident" id="7273922">T</span><span class="op" id="7273923">)</span>&nbsp;<span class="op" id="7273925">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273928">input</span>&nbsp;<span class="op" id="7273934">:=</span>&nbsp;<span class="string" id="7273937">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273954">d</span>&nbsp;<span class="op" id="7273956">:=</span>&nbsp;<span class="ident" id="7273959">NewDecoder</span><span class="op" id="7273969">(</span><span class="ident" id="7273970">strings</span><span class="op" id="7273977">.</span><span class="ident" id="7273978">NewReader</span><span class="op" id="7273987">(</span><span class="ident" id="7273988">input</span><span class="op" id="7273993">)</span><span class="op" id="7273994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273997">var</span>&nbsp;<span class="ident" id="7274001">err</span>&nbsp;<span class="builtintype" id="7274005">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274012">for</span>&nbsp;<span class="ident" id="7274016">_</span><span class="op" id="7274017">,</span>&nbsp;<span class="ident" id="7274019">err</span>&nbsp;<span class="op" id="7274023">=</span>&nbsp;<span class="ident" id="7274025">d</span><span class="op" id="7274026">.</span><span class="ident" id="7274027">Token</span><span class="op" id="7274032">(</span><span class="op" id="7274033">)</span><span class="op" id="7274034">;</span>&nbsp;<span class="ident" id="7274036">err</span>&nbsp;<span class="op" id="7274040">==</span>&nbsp;<span class="builtintype" id="7274043">nil</span><span class="op" id="7274046">;</span>&nbsp;<span class="ident" id="7274048">_</span><span class="op" id="7274049">,</span>&nbsp;<span class="ident" id="7274051">err</span>&nbsp;<span class="op" id="7274055">=</span>&nbsp;<span class="ident" id="7274057">d</span><span class="op" id="7274058">.</span><span class="ident" id="7274059">Token</span><span class="op" id="7274064">(</span><span class="op" id="7274065">)</span>&nbsp;<span class="op" id="7274067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274070">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274073">if</span>&nbsp;<span class="ident" id="7274076">err</span>&nbsp;<span class="op" id="7274080">!=</span>&nbsp;<span class="ident" id="7274083">io</span><span class="op" id="7274085">.</span><span class="ident" id="7274086">EOF</span>&nbsp;<span class="op" id="7274090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274094">t</span><span class="op" id="7274095">.</span><span class="ident" id="7274096">Fatalf</span><span class="op" id="7274102">(</span><span class="string" id="7274103">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7274138">,</span>&nbsp;<span class="ident" id="7274140">err</span><span class="op" id="7274143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274146">}</span><br>
<span class="lineno"></span><span class="op" id="7274148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="7274151">func</span>&nbsp;<span class="ident" id="7274156">TestEntityInsideCDATA</span><span class="op" id="7274177">(</span><span class="ident" id="7274178">t</span>&nbsp;<span class="op" id="7274180">*</span><span class="ident" id="7274181">testing</span><span class="op" id="7274188">.</span><span class="ident" id="7274189">T</span><span class="op" id="7274190">)</span>&nbsp;<span class="op" id="7274192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274195">input</span>&nbsp;<span class="op" id="7274201">:=</span>&nbsp;<span class="string" id="7274204">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274243">d</span>&nbsp;<span class="op" id="7274245">:=</span>&nbsp;<span class="ident" id="7274248">NewDecoder</span><span class="op" id="7274258">(</span><span class="ident" id="7274259">strings</span><span class="op" id="7274266">.</span><span class="ident" id="7274267">NewReader</span><span class="op" id="7274276">(</span><span class="ident" id="7274277">input</span><span class="op" id="7274282">)</span><span class="op" id="7274283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274286">var</span>&nbsp;<span class="ident" id="7274290">err</span>&nbsp;<span class="builtintype" id="7274294">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274301">for</span>&nbsp;<span class="ident" id="7274305">_</span><span class="op" id="7274306">,</span>&nbsp;<span class="ident" id="7274308">err</span>&nbsp;<span class="op" id="7274312">=</span>&nbsp;<span class="ident" id="7274314">d</span><span class="op" id="7274315">.</span><span class="ident" id="7274316">Token</span><span class="op" id="7274321">(</span><span class="op" id="7274322">)</span><span class="op" id="7274323">;</span>&nbsp;<span class="ident" id="7274325">err</span>&nbsp;<span class="op" id="7274329">==</span>&nbsp;<span class="builtintype" id="7274332">nil</span><span class="op" id="7274335">;</span>&nbsp;<span class="ident" id="7274337">_</span><span class="op" id="7274338">,</span>&nbsp;<span class="ident" id="7274340">err</span>&nbsp;<span class="op" id="7274344">=</span>&nbsp;<span class="ident" id="7274346">d</span><span class="op" id="7274347">.</span><span class="ident" id="7274348">Token</span><span class="op" id="7274353">(</span><span class="op" id="7274354">)</span>&nbsp;<span class="op" id="7274356">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274362">if</span>&nbsp;<span class="ident" id="7274365">err</span>&nbsp;<span class="op" id="7274369">!=</span>&nbsp;<span class="ident" id="7274372">io</span><span class="op" id="7274374">.</span><span class="ident" id="7274375">EOF</span>&nbsp;<span class="op" id="7274379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274383">t</span><span class="op" id="7274384">.</span><span class="ident" id="7274385">Fatalf</span><span class="op" id="7274391">(</span><span class="string" id="7274392">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7274427">,</span>&nbsp;<span class="ident" id="7274429">err</span><span class="op" id="7274432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274435">}</span><br>
<span class="lineno"></span><span class="op" id="7274437">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="7274440">var</span>&nbsp;<span class="ident" id="7274444">characterTests</span>&nbsp;<span class="op" id="7274459">=</span>&nbsp;<span class="op" id="7274461">[</span><span class="op" id="7274462">]</span><span class="keyword" id="7274463">struct</span>&nbsp;<span class="op" id="7274470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274473">in</span>&nbsp;&nbsp;<span class="builtintype" id="7274477">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274485">err</span>&nbsp;<span class="builtintype" id="7274489">string</span><br>
<span class="lineno"></span><span class="op" id="7274496">}</span><span class="op" id="7274497">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274500">{</span><span class="string" id="7274501">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="7274513">,</span>&nbsp;<span class="string" id="7274515">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="7274546">}</span><span class="op" id="7274547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274550">{</span><span class="string" id="7274551">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="7274586">,</span>&nbsp;<span class="string" id="7274588">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="7274619">}</span><span class="op" id="7274620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274623">{</span><span class="string" id="7274624">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="7274644">,</span>&nbsp;<span class="string" id="7274646">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="7274677">}</span><span class="op" id="7274678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274681">{</span><span class="string" id="7274682">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="7274741">,</span>&nbsp;<span class="string" id="7274743">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="7274774">}</span><span class="op" id="7274775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274778">{</span><span class="string" id="7274779">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="7274837">,</span>&nbsp;<span class="string" id="7274839">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="7274875">}</span><span class="op" id="7274876">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274879">{</span><span class="string" id="7274880">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7274902">,</span>&nbsp;<span class="string" id="7274904">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7274950">}</span><span class="op" id="7274951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274954">{</span><span class="string" id="7274955">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7274974">,</span>&nbsp;<span class="string" id="7274976">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7275019">}</span><span class="op" id="7275020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275023">{</span><span class="string" id="7275024">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="7275051">,</span>&nbsp;<span class="string" id="7275053">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="7275088">}</span><span class="op" id="7275089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275092">{</span><span class="string" id="7275093">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="7275113">,</span>&nbsp;<span class="string" id="7275115">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="7275149">}</span><span class="op" id="7275150">,</span><br>
<span class="lineno"></span><span class="op" id="7275152">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="7275155">func</span>&nbsp;<span class="ident" id="7275160">TestDisallowedCharacters</span><span class="op" id="7275184">(</span><span class="ident" id="7275185">t</span>&nbsp;<span class="op" id="7275187">*</span><span class="ident" id="7275188">testing</span><span class="op" id="7275195">.</span><span class="ident" id="7275196">T</span><span class="op" id="7275197">)</span>&nbsp;<span class="op" id="7275199">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275203">for</span>&nbsp;<span class="ident" id="7275207">i</span><span class="op" id="7275208">,</span>&nbsp;<span class="ident" id="7275210">tt</span>&nbsp;<span class="op" id="7275213">:=</span>&nbsp;<span class="keyword" id="7275216">range</span>&nbsp;<span class="ident" id="7275222">characterTests</span>&nbsp;<span class="op" id="7275237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275241">d</span>&nbsp;<span class="op" id="7275243">:=</span>&nbsp;<span class="ident" id="7275246">NewDecoder</span><span class="op" id="7275256">(</span><span class="ident" id="7275257">strings</span><span class="op" id="7275264">.</span><span class="ident" id="7275265">NewReader</span><span class="op" id="7275274">(</span><span class="ident" id="7275275">tt</span><span class="op" id="7275277">.</span><span class="ident" id="7275278">in</span><span class="op" id="7275280">)</span><span class="op" id="7275281">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275285">var</span>&nbsp;<span class="ident" id="7275289">err</span>&nbsp;<span class="builtintype" id="7275293">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275302">for</span>&nbsp;<span class="ident" id="7275306">err</span>&nbsp;<span class="op" id="7275310">==</span>&nbsp;<span class="builtintype" id="7275313">nil</span>&nbsp;<span class="op" id="7275317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275322">_</span><span class="op" id="7275323">,</span>&nbsp;<span class="ident" id="7275325">err</span>&nbsp;<span class="op" id="7275329">=</span>&nbsp;<span class="ident" id="7275331">d</span><span class="op" id="7275332">.</span><span class="ident" id="7275333">Token</span><span class="op" id="7275338">(</span><span class="op" id="7275339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275343">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275347">synerr</span><span class="op" id="7275353">,</span>&nbsp;<span class="ident" id="7275355">ok</span>&nbsp;<span class="op" id="7275358">:=</span>&nbsp;<span class="ident" id="7275361">err</span><span class="op" id="7275364">.</span><span class="op" id="7275365">(</span><span class="op" id="7275366">*</span><span class="ident" id="7275367">SyntaxError</span><span class="op" id="7275378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275382">if</span>&nbsp;<span class="op" id="7275385">!</span><span class="ident" id="7275386">ok</span>&nbsp;<span class="op" id="7275389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275394">t</span><span class="op" id="7275395">.</span><span class="ident" id="7275396">Fatalf</span><span class="op" id="7275402">(</span><span class="string" id="7275403">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="7275453">,</span>&nbsp;<span class="ident" id="7275455">i</span><span class="op" id="7275456">,</span>&nbsp;<span class="ident" id="7275458">err</span><span class="op" id="7275461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275469">if</span>&nbsp;<span class="ident" id="7275472">synerr</span><span class="op" id="7275478">.</span><span class="ident" id="7275479">Msg</span>&nbsp;<span class="op" id="7275483">!=</span>&nbsp;<span class="ident" id="7275486">tt</span><span class="op" id="7275488">.</span><span class="ident" id="7275489">err</span>&nbsp;<span class="op" id="7275493">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275498">t</span><span class="op" id="7275499">.</span><span class="ident" id="7275500">Fatalf</span><span class="op" id="7275506">(</span><span class="string" id="7275507">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7275551">,</span>&nbsp;<span class="ident" id="7275553">i</span><span class="op" id="7275554">,</span>&nbsp;<span class="ident" id="7275556">tt</span><span class="op" id="7275558">.</span><span class="ident" id="7275559">err</span><span class="op" id="7275562">,</span>&nbsp;<span class="ident" id="7275564">synerr</span><span class="op" id="7275570">.</span><span class="ident" id="7275571">Msg</span><span class="op" id="7275574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275581">}</span><br>
<span class="lineno"></span><span class="op" id="7275583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="7275586">type</span>&nbsp;<span class="ident" id="7275591">procInstEncodingTest</span>&nbsp;<span class="keyword" id="7275612">struct</span>&nbsp;<span class="op" id="7275619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275622">expect</span><span class="op" id="7275628">,</span>&nbsp;<span class="ident" id="7275630">got</span>&nbsp;<span class="builtintype" id="7275634">string</span><br>
<span class="lineno"></span><span class="op" id="7275641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7275644">var</span>&nbsp;<span class="ident" id="7275648">procInstTests</span>&nbsp;<span class="op" id="7275662">=</span>&nbsp;<span class="op" id="7275664">[</span><span class="op" id="7275665">]</span><span class="keyword" id="7275666">struct</span>&nbsp;<span class="op" id="7275673">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275676">input</span><span class="op" id="7275681">,</span>&nbsp;<span class="ident" id="7275683">expect</span>&nbsp;<span class="builtintype" id="7275690">string</span><br>
<span class="lineno"></span><span class="op" id="7275697">}</span><span class="op" id="7275698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275701">{</span><span class="string" id="7275702">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="7275734">,</span>&nbsp;<span class="string" id="7275736">&#34;utf-8&#34;</span><span class="op" id="7275743">}</span><span class="op" id="7275744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275747">{</span><span class="string" id="7275748">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="7275780">,</span>&nbsp;<span class="string" id="7275782">&#34;utf-8&#34;</span><span class="op" id="7275789">}</span><span class="op" id="7275790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275793">{</span><span class="string" id="7275794">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="7275827">,</span>&nbsp;<span class="string" id="7275829">&#34;utf-8&#34;</span><span class="op" id="7275836">}</span><span class="op" id="7275837">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275840">{</span><span class="string" id="7275841">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="7275871">,</span>&nbsp;<span class="string" id="7275873">&#34;&#34;</span><span class="op" id="7275875">}</span><span class="op" id="7275876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275879">{</span><span class="string" id="7275880">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="7275897">,</span>&nbsp;<span class="string" id="7275899">&#34;FOO&#34;</span><span class="op" id="7275904">}</span><span class="op" id="7275905">,</span><br>
<span class="lineno"></span><span class="op" id="7275907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7275910">func</span>&nbsp;<span class="ident" id="7275915">TestProcInstEncoding</span><span class="op" id="7275935">(</span><span class="ident" id="7275936">t</span>&nbsp;<span class="op" id="7275938">*</span><span class="ident" id="7275939">testing</span><span class="op" id="7275946">.</span><span class="ident" id="7275947">T</span><span class="op" id="7275948">)</span>&nbsp;<span class="op" id="7275950">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275953">for</span>&nbsp;<span class="ident" id="7275957">_</span><span class="op" id="7275958">,</span>&nbsp;<span class="ident" id="7275960">test</span>&nbsp;<span class="op" id="7275965">:=</span>&nbsp;<span class="keyword" id="7275968">range</span>&nbsp;<span class="ident" id="7275974">procInstTests</span>&nbsp;<span class="op" id="7275988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275992">got</span>&nbsp;<span class="op" id="7275996">:=</span>&nbsp;<span class="ident" id="7275999">procInstEncoding</span><span class="op" id="7276015">(</span><span class="ident" id="7276016">test</span><span class="op" id="7276020">.</span><span class="ident" id="7276021">input</span><span class="op" id="7276026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276030">if</span>&nbsp;<span class="ident" id="7276033">got</span>&nbsp;<span class="op" id="7276037">!=</span>&nbsp;<span class="ident" id="7276040">test</span><span class="op" id="7276044">.</span><span class="ident" id="7276045">expect</span>&nbsp;<span class="op" id="7276052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276057">t</span><span class="op" id="7276058">.</span><span class="ident" id="7276059">Errorf</span><span class="op" id="7276065">(</span><span class="string" id="7276066">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7276102">,</span>&nbsp;<span class="ident" id="7276104">test</span><span class="op" id="7276108">.</span><span class="ident" id="7276109">input</span><span class="op" id="7276114">,</span>&nbsp;<span class="ident" id="7276116">got</span><span class="op" id="7276119">,</span>&nbsp;<span class="ident" id="7276121">test</span><span class="op" id="7276125">.</span><span class="ident" id="7276126">expect</span><span class="op" id="7276132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276136">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276139">}</span><br>
<span class="lineno"></span><span class="op" id="7276141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7276144">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="7276205">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7276240">var</span>&nbsp;<span class="ident" id="7276244">directivesWithCommentsInput</span>&nbsp;<span class="op" id="7276272">=</span>&nbsp;<span class="string" id="7276274">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7276510">var</span>&nbsp;<span class="ident" id="7276514">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7276543">=</span>&nbsp;<span class="op" id="7276545">[</span><span class="op" id="7276546">]</span><span class="ident" id="7276547">Token</span><span class="op" id="7276552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276555">CharData</span><span class="op" id="7276563">(</span><span class="string" id="7276564">&#34;\n&#34;</span><span class="op" id="7276568">)</span><span class="op" id="7276569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276572">Directive</span><span class="op" id="7276581">(</span><span class="string" id="7276582">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7276653">)</span><span class="op" id="7276654">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276657">CharData</span><span class="op" id="7276665">(</span><span class="string" id="7276666">&#34;\n&#34;</span><span class="op" id="7276670">)</span><span class="op" id="7276671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276674">Directive</span><span class="op" id="7276683">(</span><span class="string" id="7276684">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7276717">)</span><span class="op" id="7276718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276721">CharData</span><span class="op" id="7276729">(</span><span class="string" id="7276730">&#34;\n&#34;</span><span class="op" id="7276734">)</span><span class="op" id="7276735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276738">Directive</span><span class="op" id="7276747">(</span><span class="string" id="7276748">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7276793">)</span><span class="op" id="7276794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276797">CharData</span><span class="op" id="7276805">(</span><span class="string" id="7276806">&#34;\n&#34;</span><span class="op" id="7276810">)</span><span class="op" id="7276811">,</span><br>
<span class="lineno">695</span><span class="op" id="7276813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7276816">func</span>&nbsp;<span class="ident" id="7276821">TestDirectivesWithComments</span><span class="op" id="7276847">(</span><span class="ident" id="7276848">t</span>&nbsp;<span class="op" id="7276850">*</span><span class="ident" id="7276851">testing</span><span class="op" id="7276858">.</span><span class="ident" id="7276859">T</span><span class="op" id="7276860">)</span>&nbsp;<span class="op" id="7276862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276865">d</span>&nbsp;<span class="op" id="7276867">:=</span>&nbsp;<span class="ident" id="7276870">NewDecoder</span><span class="op" id="7276880">(</span><span class="ident" id="7276881">strings</span><span class="op" id="7276888">.</span><span class="ident" id="7276889">NewReader</span><span class="op" id="7276898">(</span><span class="ident" id="7276899">directivesWithCommentsInput</span><span class="op" id="7276926">)</span><span class="op" id="7276927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276931">for</span>&nbsp;<span class="ident" id="7276935">i</span><span class="op" id="7276936">,</span>&nbsp;<span class="ident" id="7276938">want</span>&nbsp;<span class="op" id="7276943">:=</span>&nbsp;<span class="keyword" id="7276946">range</span>&nbsp;<span class="ident" id="7276952">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7276981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276985">have</span><span class="op" id="7276989">,</span>&nbsp;<span class="ident" id="7276991">err</span>&nbsp;<span class="op" id="7276995">:=</span>&nbsp;<span class="ident" id="7276998">d</span><span class="op" id="7276999">.</span><span class="ident" id="7277000">Token</span><span class="op" id="7277005">(</span><span class="op" id="7277006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277010">if</span>&nbsp;<span class="ident" id="7277013">err</span>&nbsp;<span class="op" id="7277017">!=</span>&nbsp;<span class="builtintype" id="7277020">nil</span>&nbsp;<span class="op" id="7277024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277029">t</span><span class="op" id="7277030">.</span><span class="ident" id="7277031">Fatalf</span><span class="op" id="7277037">(</span><span class="string" id="7277038">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7277070">,</span>&nbsp;<span class="ident" id="7277072">i</span><span class="op" id="7277073">,</span>&nbsp;<span class="ident" id="7277075">err</span><span class="op" id="7277078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277082">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277086">if</span>&nbsp;<span class="op" id="7277089">!</span><span class="ident" id="7277090">reflect</span><span class="op" id="7277097">.</span><span class="ident" id="7277098">DeepEqual</span><span class="op" id="7277107">(</span><span class="ident" id="7277108">have</span><span class="op" id="7277112">,</span>&nbsp;<span class="ident" id="7277114">want</span><span class="op" id="7277118">)</span>&nbsp;<span class="op" id="7277120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277125">t</span><span class="op" id="7277126">.</span><span class="ident" id="7277127">Errorf</span><span class="op" id="7277133">(</span><span class="string" id="7277134">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7277159">,</span>&nbsp;<span class="ident" id="7277161">i</span><span class="op" id="7277162">,</span>&nbsp;<span class="ident" id="7277164">have</span><span class="op" id="7277168">,</span>&nbsp;<span class="ident" id="7277170">want</span><span class="op" id="7277174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277181">}</span><br>
<span class="lineno"></span><span class="op" id="7277183">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="7277186">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="7277240">type</span>&nbsp;<span class="ident" id="7277245">errWriter</span>&nbsp;<span class="keyword" id="7277255">struct</span><span class="op" id="7277261">{</span><span class="op" id="7277262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7277265">func</span>&nbsp;<span class="op" id="7277270">(</span><span class="ident" id="7277271">errWriter</span><span class="op" id="7277280">)</span>&nbsp;<span class="ident" id="7277282">Write</span><span class="op" id="7277287">(</span><span class="ident" id="7277288">p</span>&nbsp;<span class="op" id="7277290">[</span><span class="op" id="7277291">]</span><span class="builtintype" id="7277292">byte</span><span class="op" id="7277296">)</span>&nbsp;<span class="op" id="7277298">(</span><span class="ident" id="7277299">n</span>&nbsp;<span class="builtintype" id="7277301">int</span><span class="op" id="7277304">,</span>&nbsp;<span class="ident" id="7277306">err</span>&nbsp;<span class="builtintype" id="7277310">error</span><span class="op" id="7277315">)</span>&nbsp;<span class="op" id="7277317">{</span>&nbsp;<span class="keyword" id="7277319">return</span>&nbsp;<span class="num" id="7277326">0</span><span class="op" id="7277327">,</span>&nbsp;<span class="ident" id="7277329">fmt</span><span class="op" id="7277332">.</span><span class="ident" id="7277333">Errorf</span><span class="op" id="7277339">(</span><span class="string" id="7277340">&#34;unwritable&#34;</span><span class="op" id="7277352">)</span>&nbsp;<span class="op" id="7277354">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="7277357">func</span>&nbsp;<span class="ident" id="7277362">TestEscapeTextIOErrors</span><span class="op" id="7277384">(</span><span class="ident" id="7277385">t</span>&nbsp;<span class="op" id="7277387">*</span><span class="ident" id="7277388">testing</span><span class="op" id="7277395">.</span><span class="ident" id="7277396">T</span><span class="op" id="7277397">)</span>&nbsp;<span class="op" id="7277399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277402">expectErr</span>&nbsp;<span class="op" id="7277412">:=</span>&nbsp;<span class="string" id="7277415">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277429">err</span>&nbsp;<span class="op" id="7277433">:=</span>&nbsp;<span class="ident" id="7277436">EscapeText</span><span class="op" id="7277446">(</span><span class="ident" id="7277447">errWriter</span><span class="op" id="7277456">{</span><span class="op" id="7277457">}</span><span class="op" id="7277458">,</span>&nbsp;<span class="op" id="7277460">[</span><span class="op" id="7277461">]</span><span class="builtintype" id="7277462">byte</span><span class="op" id="7277466">{</span><span class="string" id="7277467">&#39;A&#39;</span><span class="op" id="7277470">}</span><span class="op" id="7277471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277475">if</span>&nbsp;<span class="ident" id="7277478">err</span>&nbsp;<span class="op" id="7277482">==</span>&nbsp;<span class="builtintype" id="7277485">nil</span>&nbsp;<span class="op" id="7277489">||</span>&nbsp;<span class="ident" id="7277492">err</span><span class="op" id="7277495">.</span><span class="ident" id="7277496">Error</span><span class="op" id="7277501">(</span><span class="op" id="7277502">)</span>&nbsp;<span class="op" id="7277504">!=</span>&nbsp;<span class="ident" id="7277507">expectErr</span>&nbsp;<span class="op" id="7277517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277521">t</span><span class="op" id="7277522">.</span><span class="ident" id="7277523">Errorf</span><span class="op" id="7277529">(</span><span class="string" id="7277530">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7277548">,</span>&nbsp;<span class="ident" id="7277550">err</span><span class="op" id="7277553">,</span>&nbsp;<span class="ident" id="7277555">expectErr</span><span class="op" id="7277564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277567">}</span><br>
<span class="lineno"></span><span class="op" id="7277569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="7277572">func</span>&nbsp;<span class="ident" id="7277577">TestEscapeTextInvalidChar</span><span class="op" id="7277602">(</span><span class="ident" id="7277603">t</span>&nbsp;<span class="op" id="7277605">*</span><span class="ident" id="7277606">testing</span><span class="op" id="7277613">.</span><span class="ident" id="7277614">T</span><span class="op" id="7277615">)</span>&nbsp;<span class="op" id="7277617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277620">input</span>&nbsp;<span class="op" id="7277626">:=</span>&nbsp;<span class="op" id="7277629">[</span><span class="op" id="7277630">]</span><span class="builtintype" id="7277631">byte</span><span class="op" id="7277635">(</span><span class="string" id="7277636">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="7277663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277666">expected</span>&nbsp;<span class="op" id="7277675">:=</span>&nbsp;<span class="string" id="7277678">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277710">buff</span>&nbsp;<span class="op" id="7277715">:=</span>&nbsp;<span class="builtinfunc" id="7277718">new</span><span class="op" id="7277721">(</span><span class="ident" id="7277722">bytes</span><span class="op" id="7277727">.</span><span class="ident" id="7277728">Buffer</span><span class="op" id="7277734">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277737">if</span>&nbsp;<span class="ident" id="7277740">err</span>&nbsp;<span class="op" id="7277744">:=</span>&nbsp;<span class="ident" id="7277747">EscapeText</span><span class="op" id="7277757">(</span><span class="ident" id="7277758">buff</span><span class="op" id="7277762">,</span>&nbsp;<span class="ident" id="7277764">input</span><span class="op" id="7277769">)</span><span class="op" id="7277770">;</span>&nbsp;<span class="ident" id="7277772">err</span>&nbsp;<span class="op" id="7277776">!=</span>&nbsp;<span class="builtintype" id="7277779">nil</span>&nbsp;<span class="op" id="7277783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277787">t</span><span class="op" id="7277788">.</span><span class="ident" id="7277789">Fatalf</span><span class="op" id="7277795">(</span><span class="string" id="7277796">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7277815">,</span>&nbsp;<span class="ident" id="7277817">err</span><span class="op" id="7277820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277826">text</span>&nbsp;<span class="op" id="7277831">:=</span>&nbsp;<span class="ident" id="7277834">buff</span><span class="op" id="7277838">.</span><span class="ident" id="7277839">String</span><span class="op" id="7277845">(</span><span class="op" id="7277846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277850">if</span>&nbsp;<span class="ident" id="7277853">text</span>&nbsp;<span class="op" id="7277858">!=</span>&nbsp;<span class="ident" id="7277861">expected</span>&nbsp;<span class="op" id="7277870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277874">t</span><span class="op" id="7277875">.</span><span class="ident" id="7277876">Errorf</span><span class="op" id="7277882">(</span><span class="string" id="7277883">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7277901">,</span>&nbsp;<span class="ident" id="7277903">text</span><span class="op" id="7277907">,</span>&nbsp;<span class="ident" id="7277909">expected</span><span class="op" id="7277917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277920">}</span><br>
<span class="lineno"></span><span class="op" id="7277922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="7277925">func</span>&nbsp;<span class="ident" id="7277930">TestIssue5880</span><span class="op" id="7277943">(</span><span class="ident" id="7277944">t</span>&nbsp;<span class="op" id="7277946">*</span><span class="ident" id="7277947">testing</span><span class="op" id="7277954">.</span><span class="ident" id="7277955">T</span><span class="op" id="7277956">)</span>&nbsp;<span class="op" id="7277958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277961">type</span>&nbsp;<span class="ident" id="7277966">T</span>&nbsp;<span class="op" id="7277968">[</span><span class="op" id="7277969">]</span><span class="builtintype" id="7277970">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277976">data</span><span class="op" id="7277980">,</span>&nbsp;<span class="ident" id="7277982">err</span>&nbsp;<span class="op" id="7277986">:=</span>&nbsp;<span class="ident" id="7277989">Marshal</span><span class="op" id="7277996">(</span><span class="ident" id="7277997">T</span><span class="op" id="7277998">{</span><span class="num" id="7277999">192</span><span class="op" id="7278002">,</span>&nbsp;<span class="num" id="7278004">168</span><span class="op" id="7278007">,</span>&nbsp;<span class="num" id="7278009">0</span><span class="op" id="7278010">,</span>&nbsp;<span class="num" id="7278012">1</span><span class="op" id="7278013">}</span><span class="op" id="7278014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278017">if</span>&nbsp;<span class="ident" id="7278020">err</span>&nbsp;<span class="op" id="7278024">!=</span>&nbsp;<span class="builtintype" id="7278027">nil</span>&nbsp;<span class="op" id="7278031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278035">t</span><span class="op" id="7278036">.</span><span class="ident" id="7278037">Errorf</span><span class="op" id="7278043">(</span><span class="string" id="7278044">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7278063">,</span>&nbsp;<span class="ident" id="7278065">err</span><span class="op" id="7278068">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278074">if</span>&nbsp;<span class="op" id="7278077">!</span><span class="ident" id="7278078">utf8</span><span class="op" id="7278082">.</span><span class="ident" id="7278083">Valid</span><span class="op" id="7278088">(</span><span class="ident" id="7278089">data</span><span class="op" id="7278093">)</span>&nbsp;<span class="op" id="7278095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278099">t</span><span class="op" id="7278100">.</span><span class="ident" id="7278101">Errorf</span><span class="op" id="7278107">(</span><span class="string" id="7278108">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="7278145">,</span>&nbsp;<span class="ident" id="7278147">data</span><span class="op" id="7278151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278154">}</span><br>
<span class="lineno"></span><span class="op" id="7278156">}</span>
</div>
</body>
</html>
