<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1652445">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1652501">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1652555">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1652606">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1652630">package</span>&nbsp;<span class="ident" id="1652638">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1652647">import</span>&nbsp;<span class="op" id="1652654">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1652657">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1652666">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1652669">func</span>&nbsp;<span class="ident" id="1652674">LsfStmt</span><span class="op" id="1652681">(</span><span class="ident" id="1652682">code</span><span class="op" id="1652686">,</span>&nbsp;<span class="ident" id="1652688">k</span>&nbsp;<span class="builtintype" id="1652690">int</span><span class="op" id="1652693">)</span>&nbsp;<span class="op" id="1652695">*</span><span class="ident" id="1652696"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span>&nbsp;<span class="op" id="1652707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1652710">return</span>&nbsp;<span class="op" id="1652717">&amp;</span><span class="ident" id="1652718"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span><span class="op" id="1652728">{</span><span class="ident" id="1652729">Code</span><span class="op" id="1652733">:</span>&nbsp;<span class="builtintype" id="1652735">uint16</span><span class="op" id="1652741">(</span><span class="ident" id="1652742"><a href="/syscall/lsf_linux.go.html#1652682">code</a></span><span class="op" id="1652746">)</span><span class="op" id="1652747">,</span>&nbsp;<span class="ident" id="1652749">K</span><span class="op" id="1652750">:</span>&nbsp;<span class="builtintype" id="1652752">uint32</span><span class="op" id="1652758">(</span><span class="ident" id="1652759"><a href="/syscall/lsf_linux.go.html#1652688">k</a></span><span class="op" id="1652760">)</span><span class="op" id="1652761">}</span><br>
<span class="lineno">15</span><span class="op" id="1652763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1652766">func</span>&nbsp;<span class="ident" id="1652771">LsfJump</span><span class="op" id="1652778">(</span><span class="ident" id="1652779">code</span><span class="op" id="1652783">,</span>&nbsp;<span class="ident" id="1652785">k</span><span class="op" id="1652786">,</span>&nbsp;<span class="ident" id="1652788">jt</span><span class="op" id="1652790">,</span>&nbsp;<span class="ident" id="1652792">jf</span>&nbsp;<span class="builtintype" id="1652795">int</span><span class="op" id="1652798">)</span>&nbsp;<span class="op" id="1652800">*</span><span class="ident" id="1652801"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span>&nbsp;<span class="op" id="1652812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1652815">return</span>&nbsp;<span class="op" id="1652822">&amp;</span><span class="ident" id="1652823"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span><span class="op" id="1652833">{</span><span class="ident" id="1652834">Code</span><span class="op" id="1652838">:</span>&nbsp;<span class="builtintype" id="1652840">uint16</span><span class="op" id="1652846">(</span><span class="ident" id="1652847"><a href="/syscall/lsf_linux.go.html#1652779">code</a></span><span class="op" id="1652851">)</span><span class="op" id="1652852">,</span>&nbsp;<span class="ident" id="1652854">Jt</span><span class="op" id="1652856">:</span>&nbsp;<span class="builtintype" id="1652858">uint8</span><span class="op" id="1652863">(</span><span class="ident" id="1652864"><a href="/syscall/lsf_linux.go.html#1652788">jt</a></span><span class="op" id="1652866">)</span><span class="op" id="1652867">,</span>&nbsp;<span class="ident" id="1652869">Jf</span><span class="op" id="1652871">:</span>&nbsp;<span class="builtintype" id="1652873">uint8</span><span class="op" id="1652878">(</span><span class="ident" id="1652879"><a href="/syscall/lsf_linux.go.html#1652792">jf</a></span><span class="op" id="1652881">)</span><span class="op" id="1652882">,</span>&nbsp;<span class="ident" id="1652884">K</span><span class="op" id="1652885">:</span>&nbsp;<span class="builtintype" id="1652887">uint32</span><span class="op" id="1652893">(</span><span class="ident" id="1652894"><a href="/syscall/lsf_linux.go.html#1652785">k</a></span><span class="op" id="1652895">)</span><span class="op" id="1652896">}</span><br>
<span class="lineno"></span><span class="op" id="1652898">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="1652901">func</span>&nbsp;<span class="ident" id="1652906">LsfSocket</span><span class="op" id="1652915">(</span><span class="ident" id="1652916">ifindex</span><span class="op" id="1652923">,</span>&nbsp;<span class="ident" id="1652925">proto</span>&nbsp;<span class="builtintype" id="1652931">int</span><span class="op" id="1652934">)</span>&nbsp;<span class="op" id="1652936">(</span><span class="builtintype" id="1652937">int</span><span class="op" id="1652940">,</span>&nbsp;<span class="builtintype" id="1652942">error</span><span class="op" id="1652947">)</span>&nbsp;<span class="op" id="1652949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1652952">var</span>&nbsp;<span class="ident" id="1652956">lsall</span>&nbsp;<span class="ident" id="1652962"><a href="/syscall/syscall_linux.go.html#1674086">SockaddrLinklayer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1652981">s</span><span class="op" id="1652982">,</span>&nbsp;<span class="ident" id="1652984">e</span>&nbsp;<span class="op" id="1652986">:=</span>&nbsp;<span class="ident" id="1652989"><a href="/syscall/syscall_unix.go.html#1705251">Socket</a></span><span class="op" id="1652995">(</span><span class="ident" id="1652996"><a href="/syscall/zerrors_linux_amd64.go.html#1707119">AF_PACKET</a></span><span class="op" id="1653005">,</span>&nbsp;<span class="ident" id="1653007"><a href="/syscall/zerrors_linux_amd64.go.html#1747259">SOCK_RAW</a></span><span class="op" id="1653015">,</span>&nbsp;<span class="ident" id="1653017"><a href="/syscall/lsf_linux.go.html#1652925">proto</a></span><span class="op" id="1653022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653025">if</span>&nbsp;<span class="ident" id="1653028"><a href="/syscall/lsf_linux.go.html#1652984">e</a></span>&nbsp;<span class="op" id="1653030">!=</span>&nbsp;<span class="ident" id="1653033">nil</span>&nbsp;<span class="op" id="1653037">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653041">return</span>&nbsp;<span class="num" id="1653048">0</span><span class="op" id="1653049">,</span>&nbsp;<span class="ident" id="1653051"><a href="/syscall/lsf_linux.go.html#1652984">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653057">p</span>&nbsp;<span class="op" id="1653059">:=</span>&nbsp;<span class="op" id="1653062">(</span><span class="op" id="1653063">*</span><span class="op" id="1653064">[</span><span class="num" id="1653065">2</span><span class="op" id="1653066">]</span><span class="builtintype" id="1653067">byte</span><span class="op" id="1653071">)</span><span class="op" id="1653072">(</span><span class="ident" id="1653073"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1653079">.</span><span class="ident" id="1653080">Pointer</span><span class="op" id="1653087">(</span><span class="op" id="1653088">&amp;</span><span class="ident" id="1653089"><a href="/syscall/lsf_linux.go.html#1652956">lsall</a></span><span class="op" id="1653094">.</span><span class="ident" id="1653095">Protocol</span><span class="op" id="1653103">)</span><span class="op" id="1653104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653107"><a href="/syscall/lsf_linux.go.html#1653057">p</a></span><span class="op" id="1653108">[</span><span class="num" id="1653109">0</span><span class="op" id="1653110">]</span>&nbsp;<span class="op" id="1653112">=</span>&nbsp;<span class="builtintype" id="1653114">byte</span><span class="op" id="1653118">(</span><span class="ident" id="1653119"><a href="/syscall/lsf_linux.go.html#1652925">proto</a></span>&nbsp;<span class="op" id="1653125">&gt;&gt;</span>&nbsp;<span class="num" id="1653128">8</span><span class="op" id="1653129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653132"><a href="/syscall/lsf_linux.go.html#1653057">p</a></span><span class="op" id="1653133">[</span><span class="num" id="1653134">1</span><span class="op" id="1653135">]</span>&nbsp;<span class="op" id="1653137">=</span>&nbsp;<span class="builtintype" id="1653139">byte</span><span class="op" id="1653143">(</span><span class="ident" id="1653144"><a href="/syscall/lsf_linux.go.html#1652925">proto</a></span><span class="op" id="1653149">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653152"><a href="/syscall/lsf_linux.go.html#1652956">lsall</a></span><span class="op" id="1653157">.</span><span class="ident" id="1653158">Ifindex</span>&nbsp;<span class="op" id="1653166">=</span>&nbsp;<span class="ident" id="1653168"><a href="/syscall/lsf_linux.go.html#1652916">ifindex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653177"><a href="/syscall/lsf_linux.go.html#1652984">e</a></span>&nbsp;<span class="op" id="1653179">=</span>&nbsp;<span class="ident" id="1653181"><a href="/syscall/syscall_unix.go.html#1702797">Bind</a></span><span class="op" id="1653185">(</span><span class="ident" id="1653186"><a href="/syscall/lsf_linux.go.html#1652981">s</a></span><span class="op" id="1653187">,</span>&nbsp;<span class="op" id="1653189">&amp;</span><span class="ident" id="1653190"><a href="/syscall/lsf_linux.go.html#1652956">lsall</a></span><span class="op" id="1653195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653198">if</span>&nbsp;<span class="ident" id="1653201"><a href="/syscall/lsf_linux.go.html#1652984">e</a></span>&nbsp;<span class="op" id="1653203">!=</span>&nbsp;<span class="ident" id="1653206">nil</span>&nbsp;<span class="op" id="1653210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653214"><a href="/syscall/zsyscall_linux_amd64.go.html#1772074">Close</a></span><span class="op" id="1653219">(</span><span class="ident" id="1653220"><a href="/syscall/lsf_linux.go.html#1652981">s</a></span><span class="op" id="1653221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653225">return</span>&nbsp;<span class="num" id="1653232">0</span><span class="op" id="1653233">,</span>&nbsp;<span class="ident" id="1653235"><a href="/syscall/lsf_linux.go.html#1652984">e</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653241">return</span>&nbsp;<span class="ident" id="1653248"><a href="/syscall/lsf_linux.go.html#1652981">s</a></span><span class="op" id="1653249">,</span>&nbsp;<span class="ident" id="1653251">nil</span><br>
<span class="lineno"></span><span class="op" id="1653255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1653258">type</span>&nbsp;<span class="ident" id="1653263">iflags</span>&nbsp;<span class="keyword" id="1653270">struct</span>&nbsp;<span class="op" id="1653277">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653280">name</span>&nbsp;&nbsp;<span class="op" id="1653286">[</span><span class="ident" id="1653287"><a href="/syscall/zerrors_linux_amd64.go.html#1719278">IFNAMSIZ</a></span><span class="op" id="1653295">]</span><span class="builtintype" id="1653296">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653302">flags</span>&nbsp;<span class="builtintype" id="1653308">uint16</span><br>
<span class="lineno"></span><span class="op" id="1653315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1653318">func</span>&nbsp;<span class="ident" id="1653323">SetLsfPromisc</span><span class="op" id="1653336">(</span><span class="ident" id="1653337">name</span>&nbsp;<span class="builtintype" id="1653342">string</span><span class="op" id="1653348">,</span>&nbsp;<span class="ident" id="1653350">m</span>&nbsp;<span class="builtintype" id="1653352">bool</span><span class="op" id="1653356">)</span>&nbsp;<span class="builtintype" id="1653358">error</span>&nbsp;<span class="op" id="1653364">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653367">s</span><span class="op" id="1653368">,</span>&nbsp;<span class="ident" id="1653370">e</span>&nbsp;<span class="op" id="1653372">:=</span>&nbsp;<span class="ident" id="1653375"><a href="/syscall/syscall_unix.go.html#1705251">Socket</a></span><span class="op" id="1653381">(</span><span class="ident" id="1653382"><a href="/syscall/zerrors_linux_amd64.go.html#1706593">AF_INET</a></span><span class="op" id="1653389">,</span>&nbsp;<span class="ident" id="1653391"><a href="/syscall/zerrors_linux_amd64.go.html#1747137">SOCK_DGRAM</a></span><span class="op" id="1653401">,</span>&nbsp;<span class="num" id="1653403">0</span><span class="op" id="1653404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653407">if</span>&nbsp;<span class="ident" id="1653410"><a href="/syscall/lsf_linux.go.html#1653370">e</a></span>&nbsp;<span class="op" id="1653412">!=</span>&nbsp;<span class="ident" id="1653415">nil</span>&nbsp;<span class="op" id="1653419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653423">return</span>&nbsp;<span class="ident" id="1653430"><a href="/syscall/lsf_linux.go.html#1653370">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653436">defer</span>&nbsp;<span class="ident" id="1653442"><a href="/syscall/zsyscall_linux_amd64.go.html#1772074">Close</a></span><span class="op" id="1653447">(</span><span class="ident" id="1653448"><a href="/syscall/lsf_linux.go.html#1653367">s</a></span><span class="op" id="1653449">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653452">var</span>&nbsp;<span class="ident" id="1653456">ifl</span>&nbsp;<span class="ident" id="1653460"><a href="/syscall/lsf_linux.go.html#1653263">iflags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1653468">copy</span><span class="op" id="1653472">(</span><span class="ident" id="1653473"><a href="/syscall/lsf_linux.go.html#1653456">ifl</a></span><span class="op" id="1653476">.</span><span class="ident" id="1653477">name</span><span class="op" id="1653481">[</span><span class="op" id="1653482">:</span><span class="op" id="1653483">]</span><span class="op" id="1653484">,</span>&nbsp;<span class="op" id="1653486">[</span><span class="op" id="1653487">]</span><span class="builtintype" id="1653488">byte</span><span class="op" id="1653492">(</span><span class="ident" id="1653493"><a href="/syscall/lsf_linux.go.html#1653337">name</a></span><span class="op" id="1653497">)</span><span class="op" id="1653498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653501">_</span><span class="op" id="1653502">,</span>&nbsp;<span class="ident" id="1653504">_</span><span class="op" id="1653505">,</span>&nbsp;<span class="ident" id="1653507">ep</span>&nbsp;<span class="op" id="1653510">:=</span>&nbsp;<span class="ident" id="1653513"><a href="/syscall/syscall_unix.go.html#1699211">Syscall</a></span><span class="op" id="1653520">(</span><span class="ident" id="1653521"><a href="/syscall/zsysnum_linux_amd64.go.html#1811851">SYS_IOCTL</a></span><span class="op" id="1653530">,</span>&nbsp;<span class="builtintype" id="1653532">uintptr</span><span class="op" id="1653539">(</span><span class="ident" id="1653540"><a href="/syscall/lsf_linux.go.html#1653367">s</a></span><span class="op" id="1653541">)</span><span class="op" id="1653542">,</span>&nbsp;<span class="ident" id="1653544"><a href="/syscall/zerrors_linux_amd64.go.html#1745376">SIOCGIFFLAGS</a></span><span class="op" id="1653556">,</span>&nbsp;<span class="builtintype" id="1653558">uintptr</span><span class="op" id="1653565">(</span><span class="ident" id="1653566"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1653572">.</span><span class="ident" id="1653573">Pointer</span><span class="op" id="1653580">(</span><span class="op" id="1653581">&amp;</span><span class="ident" id="1653582"><a href="/syscall/lsf_linux.go.html#1653456">ifl</a></span><span class="op" id="1653585">)</span><span class="op" id="1653586">)</span><span class="op" id="1653587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653590">if</span>&nbsp;<span class="ident" id="1653593"><a href="/syscall/lsf_linux.go.html#1653507">ep</a></span>&nbsp;<span class="op" id="1653596">!=</span>&nbsp;<span class="num" id="1653599">0</span>&nbsp;<span class="op" id="1653601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653605">return</span>&nbsp;<span class="ident" id="1653612"><a href="/syscall/syscall_unix.go.html#1701140">Errno</a></span><span class="op" id="1653617">(</span><span class="ident" id="1653618"><a href="/syscall/lsf_linux.go.html#1653507">ep</a></span><span class="op" id="1653620">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653626">if</span>&nbsp;<span class="ident" id="1653629"><a href="/syscall/lsf_linux.go.html#1653350">m</a></span>&nbsp;<span class="op" id="1653631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653635"><a href="/syscall/lsf_linux.go.html#1653456">ifl</a></span><span class="op" id="1653638">.</span><span class="ident" id="1653639">flags</span>&nbsp;<span class="op" id="1653645">|=</span>&nbsp;<span class="builtintype" id="1653648">uint16</span><span class="op" id="1653654">(</span><span class="ident" id="1653655"><a href="/syscall/zerrors_linux_amd64.go.html#1718947">IFF_PROMISC</a></span><span class="op" id="1653666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653669">}</span>&nbsp;<span class="keyword" id="1653671">else</span>&nbsp;<span class="op" id="1653676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653680"><a href="/syscall/lsf_linux.go.html#1653456">ifl</a></span><span class="op" id="1653683">.</span><span class="ident" id="1653684">flags</span>&nbsp;<span class="op" id="1653690">&amp;=</span>&nbsp;<span class="op" id="1653693">^</span><span class="builtintype" id="1653694">uint16</span><span class="op" id="1653700">(</span><span class="ident" id="1653701"><a href="/syscall/zerrors_linux_amd64.go.html#1718947">IFF_PROMISC</a></span><span class="op" id="1653712">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653718">_</span><span class="op" id="1653719">,</span>&nbsp;<span class="ident" id="1653721">_</span><span class="op" id="1653722">,</span>&nbsp;<span class="ident" id="1653724"><a href="/syscall/lsf_linux.go.html#1653507">ep</a></span>&nbsp;<span class="op" id="1653727">=</span>&nbsp;<span class="ident" id="1653729"><a href="/syscall/syscall_unix.go.html#1699211">Syscall</a></span><span class="op" id="1653736">(</span><span class="ident" id="1653737"><a href="/syscall/zsysnum_linux_amd64.go.html#1811851">SYS_IOCTL</a></span><span class="op" id="1653746">,</span>&nbsp;<span class="builtintype" id="1653748">uintptr</span><span class="op" id="1653755">(</span><span class="ident" id="1653756"><a href="/syscall/lsf_linux.go.html#1653367">s</a></span><span class="op" id="1653757">)</span><span class="op" id="1653758">,</span>&nbsp;<span class="ident" id="1653760"><a href="/syscall/zerrors_linux_amd64.go.html#1746408">SIOCSIFFLAGS</a></span><span class="op" id="1653772">,</span>&nbsp;<span class="builtintype" id="1653774">uintptr</span><span class="op" id="1653781">(</span><span class="ident" id="1653782"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1653788">.</span><span class="ident" id="1653789">Pointer</span><span class="op" id="1653796">(</span><span class="op" id="1653797">&amp;</span><span class="ident" id="1653798"><a href="/syscall/lsf_linux.go.html#1653456">ifl</a></span><span class="op" id="1653801">)</span><span class="op" id="1653802">)</span><span class="op" id="1653803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653806">if</span>&nbsp;<span class="ident" id="1653809"><a href="/syscall/lsf_linux.go.html#1653507">ep</a></span>&nbsp;<span class="op" id="1653812">!=</span>&nbsp;<span class="num" id="1653815">0</span>&nbsp;<span class="op" id="1653817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653821">return</span>&nbsp;<span class="ident" id="1653828"><a href="/syscall/syscall_unix.go.html#1701140">Errno</a></span><span class="op" id="1653833">(</span><span class="ident" id="1653834"><a href="/syscall/lsf_linux.go.html#1653507">ep</a></span><span class="op" id="1653836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1653839">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653842">return</span>&nbsp;<span class="ident" id="1653849">nil</span><br>
<span class="lineno"></span><span class="op" id="1653853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1653856">func</span>&nbsp;<span class="ident" id="1653861">AttachLsf</span><span class="op" id="1653870">(</span><span class="ident" id="1653871">fd</span>&nbsp;<span class="builtintype" id="1653874">int</span><span class="op" id="1653877">,</span>&nbsp;<span class="ident" id="1653879">i</span>&nbsp;<span class="op" id="1653881">[</span><span class="op" id="1653882">]</span><span class="ident" id="1653883"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span><span class="op" id="1653893">)</span>&nbsp;<span class="builtintype" id="1653895">error</span>&nbsp;<span class="op" id="1653901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653904">var</span>&nbsp;<span class="ident" id="1653908">p</span>&nbsp;<span class="ident" id="1653910"><a href="/syscall/ztypes_linux_amd64.go.html#1830229">SockFprog</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653921"><a href="/syscall/lsf_linux.go.html#1653908">p</a></span><span class="op" id="1653922">.</span><span class="ident" id="1653923">Len</span>&nbsp;<span class="op" id="1653927">=</span>&nbsp;<span class="builtintype" id="1653929">uint16</span><span class="op" id="1653935">(</span><span class="builtinfunc" id="1653936">len</span><span class="op" id="1653939">(</span><span class="ident" id="1653940"><a href="/syscall/lsf_linux.go.html#1653879">i</a></span><span class="op" id="1653941">)</span><span class="op" id="1653942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1653945"><a href="/syscall/lsf_linux.go.html#1653908">p</a></span><span class="op" id="1653946">.</span><span class="ident" id="1653947">Filter</span>&nbsp;<span class="op" id="1653954">=</span>&nbsp;<span class="op" id="1653956">(</span><span class="op" id="1653957">*</span><span class="ident" id="1653958"><a href="/syscall/ztypes_linux_amd64.go.html#1830151">SockFilter</a></span><span class="op" id="1653968">)</span><span class="op" id="1653969">(</span><span class="ident" id="1653970"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1653976">.</span><span class="ident" id="1653977">Pointer</span><span class="op" id="1653984">(</span><span class="op" id="1653985">&amp;</span><span class="ident" id="1653986"><a href="/syscall/lsf_linux.go.html#1653879">i</a></span><span class="op" id="1653987">[</span><span class="num" id="1653988">0</span><span class="op" id="1653989">]</span><span class="op" id="1653990">)</span><span class="op" id="1653991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1653994">return</span>&nbsp;<span class="ident" id="1654001"><a href="/syscall/zsyscall_linux_amd64.go.html#1807922">setsockopt</a></span><span class="op" id="1654011">(</span><span class="ident" id="1654012"><a href="/syscall/lsf_linux.go.html#1653871">fd</a></span><span class="op" id="1654014">,</span>&nbsp;<span class="ident" id="1654016"><a href="/syscall/zerrors_linux_amd64.go.html#1747792">SOL_SOCKET</a></span><span class="op" id="1654026">,</span>&nbsp;<span class="ident" id="1654028"><a href="/syscall/zerrors_linux_amd64.go.html#1747996">SO_ATTACH_FILTER</a></span><span class="op" id="1654044">,</span>&nbsp;<span class="ident" id="1654046"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1654052">.</span><span class="ident" id="1654053">Pointer</span><span class="op" id="1654060">(</span><span class="op" id="1654061">&amp;</span><span class="ident" id="1654062"><a href="/syscall/lsf_linux.go.html#1653908">p</a></span><span class="op" id="1654063">)</span><span class="op" id="1654064">,</span>&nbsp;<span class="ident" id="1654066"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1654072">.</span><span class="ident" id="1654073">Sizeof</span><span class="op" id="1654079">(</span><span class="ident" id="1654080"><a href="/syscall/lsf_linux.go.html#1653908">p</a></span><span class="op" id="1654081">)</span><span class="op" id="1654082">)</span><br>
<span class="lineno"></span><span class="op" id="1654084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="1654087">func</span>&nbsp;<span class="ident" id="1654092">DetachLsf</span><span class="op" id="1654101">(</span><span class="ident" id="1654102">fd</span>&nbsp;<span class="builtintype" id="1654105">int</span><span class="op" id="1654108">)</span>&nbsp;<span class="builtintype" id="1654110">error</span>&nbsp;<span class="op" id="1654116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1654119">var</span>&nbsp;<span class="ident" id="1654123">dummy</span>&nbsp;<span class="builtintype" id="1654129">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1654134">return</span>&nbsp;<span class="ident" id="1654141"><a href="/syscall/zsyscall_linux_amd64.go.html#1807922">setsockopt</a></span><span class="op" id="1654151">(</span><span class="ident" id="1654152"><a href="/syscall/lsf_linux.go.html#1654102">fd</a></span><span class="op" id="1654154">,</span>&nbsp;<span class="ident" id="1654156"><a href="/syscall/zerrors_linux_amd64.go.html#1747792">SOL_SOCKET</a></span><span class="op" id="1654166">,</span>&nbsp;<span class="ident" id="1654168"><a href="/syscall/zerrors_linux_amd64.go.html#1748198">SO_DETACH_FILTER</a></span><span class="op" id="1654184">,</span>&nbsp;<span class="ident" id="1654186"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1654192">.</span><span class="ident" id="1654193">Pointer</span><span class="op" id="1654200">(</span><span class="op" id="1654201">&amp;</span><span class="ident" id="1654202"><a href="/syscall/lsf_linux.go.html#1654123">dummy</a></span><span class="op" id="1654207">)</span><span class="op" id="1654208">,</span>&nbsp;<span class="ident" id="1654210"><a href="/syscall/lsf_linux.go.html#1652657">unsafe</a></span><span class="op" id="1654216">.</span><span class="ident" id="1654217">Sizeof</span><span class="op" id="1654223">(</span><span class="ident" id="1654224"><a href="/syscall/lsf_linux.go.html#1654123">dummy</a></span><span class="op" id="1654229">)</span><span class="op" id="1654230">)</span><br>
<span class="lineno"></span><span class="op" id="1654232">}</span>
</div>
</body>
</html>
