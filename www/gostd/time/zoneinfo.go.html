<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2776239">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2776294">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2776348">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2776399">package</span>&nbsp;<span class="ident" id="2776407">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2776413">import</span>&nbsp;<span class="op" id="2776420">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2776423">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2776431">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2776441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2776444">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2776510">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2776579">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2776654">type</span>&nbsp;<span class="ident" id="2776659">Location</span>&nbsp;<span class="keyword" id="2776668">struct</span>&nbsp;<span class="op" id="2776675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2776678">name</span>&nbsp;<span class="builtintype" id="2776683">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2776691">zone</span>&nbsp;<span class="op" id="2776696">[</span><span class="op" id="2776697">]</span><span class="ident" id="2776698">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2776704">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2776709">[</span><span class="op" id="2776710">]</span><span class="ident" id="2776711">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776723">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776770">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776820">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776872">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776925">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776961">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2776994">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2777048">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2777101">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777116">cacheStart</span>&nbsp;<span class="ident" id="2777127">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777134">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2777145">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777152">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2777163">*</span><span class="ident" id="2777164">zone</span><br>
<span class="lineno"></span><span class="op" id="2777169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2777172">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2777233">type</span>&nbsp;<span class="ident" id="2777238">zone</span>&nbsp;<span class="keyword" id="2777243">struct</span>&nbsp;<span class="op" id="2777250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777253">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2777260">string</span>&nbsp;<span class="comment" id="2777267">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777295">offset</span>&nbsp;<span class="builtintype" id="2777302">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777309">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777333">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2777340">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2777347">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2777386">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2777389">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2777446">type</span>&nbsp;<span class="ident" id="2777451">zoneTrans</span>&nbsp;<span class="keyword" id="2777461">struct</span>&nbsp;<span class="op" id="2777468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777471">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777484">int64</span>&nbsp;<span class="comment" id="2777490">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777537">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2777550">uint8</span>&nbsp;<span class="comment" id="2777556">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777617">isstd</span><span class="op" id="2777622">,</span>&nbsp;<span class="ident" id="2777624">isutc</span>&nbsp;<span class="builtintype" id="2777630">bool</span>&nbsp;&nbsp;<span class="comment" id="2777636">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2777673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2777676">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2777738">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2777754">const</span>&nbsp;<span class="op" id="2777760">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777763">alpha</span>&nbsp;<span class="op" id="2777769">=</span>&nbsp;<span class="op" id="2777771">-</span><span class="num" id="2777772">1</span>&nbsp;<span class="op" id="2777774">&lt;&lt;</span>&nbsp;<span class="num" id="2777777">63</span>&nbsp;&nbsp;<span class="comment" id="2777781">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2777799">omega</span>&nbsp;<span class="op" id="2777805">=</span>&nbsp;<span class="num" id="2777807">1</span><span class="op" id="2777808">&lt;&lt;</span><span class="num" id="2777810">63</span>&nbsp;<span class="op" id="2777813">-</span>&nbsp;<span class="num" id="2777815">1</span>&nbsp;<span class="comment" id="2777817">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2777834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2777837">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2777889">var</span>&nbsp;<span class="ident" id="2777893">UTC</span>&nbsp;<span class="op" id="2777897">*</span><span class="ident" id="2777898">Location</span>&nbsp;<span class="op" id="2777907">=</span>&nbsp;<span class="op" id="2777909">&amp;</span><span class="ident" id="2777910">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2777918">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2777973">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2778026">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2778077">var</span>&nbsp;<span class="ident" id="2778081">utcLoc</span>&nbsp;<span class="op" id="2778088">=</span>&nbsp;<span class="ident" id="2778090">Location</span><span class="op" id="2778098">{</span><span class="ident" id="2778099">name</span><span class="op" id="2778103">:</span>&nbsp;<span class="string" id="2778105">&#34;UTC&#34;</span><span class="op" id="2778110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2778113">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2778163">var</span>&nbsp;<span class="ident" id="2778167">Local</span>&nbsp;<span class="op" id="2778173">*</span><span class="ident" id="2778174">Location</span>&nbsp;<span class="op" id="2778183">=</span>&nbsp;<span class="op" id="2778185">&amp;</span><span class="ident" id="2778186">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2778196">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2778253">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2778295">var</span>&nbsp;<span class="ident" id="2778299">localLoc</span>&nbsp;<span class="ident" id="2778308">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2778317">var</span>&nbsp;<span class="ident" id="2778321">localOnce</span>&nbsp;<span class="ident" id="2778331">sync</span><span class="op" id="2778335">.</span><span class="ident" id="2778336">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2778342">func</span>&nbsp;<span class="op" id="2778347">(</span><span class="ident" id="2778348">l</span>&nbsp;<span class="op" id="2778350">*</span><span class="ident" id="2778351">Location</span><span class="op" id="2778359">)</span>&nbsp;<span class="ident" id="2778361">get</span><span class="op" id="2778364">(</span><span class="op" id="2778365">)</span>&nbsp;<span class="op" id="2778367">*</span><span class="ident" id="2778368">Location</span>&nbsp;<span class="op" id="2778377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2778380">if</span>&nbsp;<span class="ident" id="2778383">l</span>&nbsp;<span class="op" id="2778385">==</span>&nbsp;<span class="ident" id="2778388">nil</span>&nbsp;<span class="op" id="2778392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2778396">return</span>&nbsp;<span class="op" id="2778403">&amp;</span><span class="ident" id="2778404">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2778412">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2778415">if</span>&nbsp;<span class="ident" id="2778418">l</span>&nbsp;<span class="op" id="2778420">==</span>&nbsp;<span class="op" id="2778423">&amp;</span><span class="ident" id="2778424">localLoc</span>&nbsp;<span class="op" id="2778433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778437">localOnce</span><span class="op" id="2778446">.</span><span class="ident" id="2778447">Do</span><span class="op" id="2778449">(</span><span class="ident" id="2778450">initLocal</span><span class="op" id="2778459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2778462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2778465">return</span>&nbsp;<span class="ident" id="2778472">l</span><br>
<span class="lineno"></span><span class="op" id="2778474">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2778477">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2778545">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2778595">func</span>&nbsp;<span class="op" id="2778600">(</span><span class="ident" id="2778601">l</span>&nbsp;<span class="op" id="2778603">*</span><span class="ident" id="2778604">Location</span><span class="op" id="2778612">)</span>&nbsp;<span class="ident" id="2778614">String</span><span class="op" id="2778620">(</span><span class="op" id="2778621">)</span>&nbsp;<span class="builtintype" id="2778623">string</span>&nbsp;<span class="op" id="2778630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2778633">return</span>&nbsp;<span class="ident" id="2778640">l</span><span class="op" id="2778641">.</span><span class="ident" id="2778642">get</span><span class="op" id="2778645">(</span><span class="op" id="2778646">)</span><span class="op" id="2778647">.</span><span class="ident" id="2778648">name</span><br>
<span class="lineno">85</span><span class="op" id="2778653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2778656">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2778705">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2778762">func</span>&nbsp;<span class="ident" id="2778767">FixedZone</span><span class="op" id="2778776">(</span><span class="ident" id="2778777">name</span>&nbsp;<span class="builtintype" id="2778782">string</span><span class="op" id="2778788">,</span>&nbsp;<span class="ident" id="2778790">offset</span>&nbsp;<span class="builtintype" id="2778797">int</span><span class="op" id="2778800">)</span>&nbsp;<span class="op" id="2778802">*</span><span class="ident" id="2778803">Location</span>&nbsp;<span class="op" id="2778812">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778815">l</span>&nbsp;<span class="op" id="2778817">:=</span>&nbsp;<span class="op" id="2778820">&amp;</span><span class="ident" id="2778821">Location</span><span class="op" id="2778829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778833">name</span><span class="op" id="2778837">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778845">name</span><span class="op" id="2778849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778853">zone</span><span class="op" id="2778857">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2778865">[</span><span class="op" id="2778866">]</span><span class="ident" id="2778867">zone</span><span class="op" id="2778871">{</span><span class="op" id="2778872">{</span><span class="ident" id="2778873">name</span><span class="op" id="2778877">,</span>&nbsp;<span class="ident" id="2778879">offset</span><span class="op" id="2778885">,</span>&nbsp;<span class="builtintype" id="2778887">false</span><span class="op" id="2778892">}</span><span class="op" id="2778893">}</span><span class="op" id="2778894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778898">tx</span><span class="op" id="2778900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2778910">[</span><span class="op" id="2778911">]</span><span class="ident" id="2778912">zoneTrans</span><span class="op" id="2778921">{</span><span class="op" id="2778922">{</span><span class="ident" id="2778923">alpha</span><span class="op" id="2778928">,</span>&nbsp;<span class="num" id="2778930">0</span><span class="op" id="2778931">,</span>&nbsp;<span class="builtintype" id="2778933">false</span><span class="op" id="2778938">,</span>&nbsp;<span class="builtintype" id="2778940">false</span><span class="op" id="2778945">}</span><span class="op" id="2778946">}</span><span class="op" id="2778947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778951">cacheStart</span><span class="op" id="2778961">:</span>&nbsp;<span class="ident" id="2778963">alpha</span><span class="op" id="2778968">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778972">cacheEnd</span><span class="op" id="2778980">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2778984">omega</span><span class="op" id="2778989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2778992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2778995">l</span><span class="op" id="2778996">.</span><span class="ident" id="2778997">cacheZone</span>&nbsp;<span class="op" id="2779007">=</span>&nbsp;<span class="op" id="2779009">&amp;</span><span class="ident" id="2779010">l</span><span class="op" id="2779011">.</span><span class="ident" id="2779012">zone</span><span class="op" id="2779016">[</span><span class="num" id="2779017">0</span><span class="op" id="2779018">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779021">return</span>&nbsp;<span class="ident" id="2779028">l</span><br>
<span class="lineno"></span><span class="op" id="2779030">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2779033">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2779096">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2779172">//</span><br>
<span class="lineno"></span><span class="comment" id="2779175">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2779247">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2779318">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2779387">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2779443">func</span>&nbsp;<span class="op" id="2779448">(</span><span class="ident" id="2779449">l</span>&nbsp;<span class="op" id="2779451">*</span><span class="ident" id="2779452">Location</span><span class="op" id="2779460">)</span>&nbsp;<span class="ident" id="2779462">lookup</span><span class="op" id="2779468">(</span><span class="ident" id="2779469">sec</span>&nbsp;<span class="ident" id="2779473">int64</span><span class="op" id="2779478">)</span>&nbsp;<span class="op" id="2779480">(</span><span class="ident" id="2779481">name</span>&nbsp;<span class="builtintype" id="2779486">string</span><span class="op" id="2779492">,</span>&nbsp;<span class="ident" id="2779494">offset</span>&nbsp;<span class="builtintype" id="2779501">int</span><span class="op" id="2779504">,</span>&nbsp;<span class="ident" id="2779506">isDST</span>&nbsp;<span class="builtintype" id="2779512">bool</span><span class="op" id="2779516">,</span>&nbsp;<span class="ident" id="2779518">start</span><span class="op" id="2779523">,</span>&nbsp;<span class="ident" id="2779525">end</span>&nbsp;<span class="ident" id="2779529">int64</span><span class="op" id="2779534">)</span>&nbsp;<span class="op" id="2779536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779539">l</span>&nbsp;<span class="op" id="2779541">=</span>&nbsp;<span class="ident" id="2779543">l</span><span class="op" id="2779544">.</span><span class="ident" id="2779545">get</span><span class="op" id="2779548">(</span><span class="op" id="2779549">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779553">if</span>&nbsp;<span class="builtinfunc" id="2779556">len</span><span class="op" id="2779559">(</span><span class="ident" id="2779560">l</span><span class="op" id="2779561">.</span><span class="ident" id="2779562">zone</span><span class="op" id="2779566">)</span>&nbsp;<span class="op" id="2779568">==</span>&nbsp;<span class="num" id="2779571">0</span>&nbsp;<span class="op" id="2779573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779577">name</span>&nbsp;<span class="op" id="2779582">=</span>&nbsp;<span class="string" id="2779584">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779592">offset</span>&nbsp;<span class="op" id="2779599">=</span>&nbsp;<span class="num" id="2779601">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779605">isDST</span>&nbsp;<span class="op" id="2779611">=</span>&nbsp;<span class="builtintype" id="2779613">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779621">start</span>&nbsp;<span class="op" id="2779627">=</span>&nbsp;<span class="ident" id="2779629">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779637">end</span>&nbsp;<span class="op" id="2779641">=</span>&nbsp;<span class="ident" id="2779643">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779651">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2779659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779663">if</span>&nbsp;<span class="ident" id="2779666">zone</span>&nbsp;<span class="op" id="2779671">:=</span>&nbsp;<span class="ident" id="2779674">l</span><span class="op" id="2779675">.</span><span class="ident" id="2779676">cacheZone</span><span class="op" id="2779685">;</span>&nbsp;<span class="ident" id="2779687">zone</span>&nbsp;<span class="op" id="2779692">!=</span>&nbsp;<span class="ident" id="2779695">nil</span>&nbsp;<span class="op" id="2779699">&amp;&amp;</span>&nbsp;<span class="ident" id="2779702">l</span><span class="op" id="2779703">.</span><span class="ident" id="2779704">cacheStart</span>&nbsp;<span class="op" id="2779715">&lt;=</span>&nbsp;<span class="ident" id="2779718">sec</span>&nbsp;<span class="op" id="2779722">&amp;&amp;</span>&nbsp;<span class="ident" id="2779725">sec</span>&nbsp;<span class="op" id="2779729">&lt;</span>&nbsp;<span class="ident" id="2779731">l</span><span class="op" id="2779732">.</span><span class="ident" id="2779733">cacheEnd</span>&nbsp;<span class="op" id="2779742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779746">name</span>&nbsp;<span class="op" id="2779751">=</span>&nbsp;<span class="ident" id="2779753">zone</span><span class="op" id="2779757">.</span><span class="ident" id="2779758">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779765">offset</span>&nbsp;<span class="op" id="2779772">=</span>&nbsp;<span class="ident" id="2779774">zone</span><span class="op" id="2779778">.</span><span class="ident" id="2779779">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779788">isDST</span>&nbsp;<span class="op" id="2779794">=</span>&nbsp;<span class="ident" id="2779796">zone</span><span class="op" id="2779800">.</span><span class="ident" id="2779801">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779809">start</span>&nbsp;<span class="op" id="2779815">=</span>&nbsp;<span class="ident" id="2779817">l</span><span class="op" id="2779818">.</span><span class="ident" id="2779819">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779832">end</span>&nbsp;<span class="op" id="2779836">=</span>&nbsp;<span class="ident" id="2779838">l</span><span class="op" id="2779839">.</span><span class="ident" id="2779840">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779851">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2779859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2779863">if</span>&nbsp;<span class="builtinfunc" id="2779866">len</span><span class="op" id="2779869">(</span><span class="ident" id="2779870">l</span><span class="op" id="2779871">.</span><span class="ident" id="2779872">tx</span><span class="op" id="2779874">)</span>&nbsp;<span class="op" id="2779876">==</span>&nbsp;<span class="num" id="2779879">0</span>&nbsp;<span class="op" id="2779881">||</span>&nbsp;<span class="ident" id="2779884">sec</span>&nbsp;<span class="op" id="2779888">&lt;</span>&nbsp;<span class="ident" id="2779890">l</span><span class="op" id="2779891">.</span><span class="ident" id="2779892">tx</span><span class="op" id="2779894">[</span><span class="num" id="2779895">0</span><span class="op" id="2779896">]</span><span class="op" id="2779897">.</span><span class="ident" id="2779898">when</span>&nbsp;<span class="op" id="2779903">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779907">zone</span>&nbsp;<span class="op" id="2779912">:=</span>&nbsp;<span class="op" id="2779915">&amp;</span><span class="ident" id="2779916">l</span><span class="op" id="2779917">.</span><span class="ident" id="2779918">zone</span><span class="op" id="2779922">[</span><span class="ident" id="2779923">l</span><span class="op" id="2779924">.</span><span class="ident" id="2779925">lookupFirstZone</span><span class="op" id="2779940">(</span><span class="op" id="2779941">)</span><span class="op" id="2779942">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779946">name</span>&nbsp;<span class="op" id="2779951">=</span>&nbsp;<span class="ident" id="2779953">zone</span><span class="op" id="2779957">.</span><span class="ident" id="2779958">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779965">offset</span>&nbsp;<span class="op" id="2779972">=</span>&nbsp;<span class="ident" id="2779974">zone</span><span class="op" id="2779978">.</span><span class="ident" id="2779979">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2779988">isDST</span>&nbsp;<span class="op" id="2779994">=</span>&nbsp;<span class="ident" id="2779996">zone</span><span class="op" id="2780000">.</span><span class="ident" id="2780001">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780009">start</span>&nbsp;<span class="op" id="2780015">=</span>&nbsp;<span class="ident" id="2780017">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2780025">if</span>&nbsp;<span class="builtinfunc" id="2780028">len</span><span class="op" id="2780031">(</span><span class="ident" id="2780032">l</span><span class="op" id="2780033">.</span><span class="ident" id="2780034">tx</span><span class="op" id="2780036">)</span>&nbsp;<span class="op" id="2780038">&gt;</span>&nbsp;<span class="num" id="2780040">0</span>&nbsp;<span class="op" id="2780042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780047">end</span>&nbsp;<span class="op" id="2780051">=</span>&nbsp;<span class="ident" id="2780053">l</span><span class="op" id="2780054">.</span><span class="ident" id="2780055">tx</span><span class="op" id="2780057">[</span><span class="num" id="2780058">0</span><span class="op" id="2780059">]</span><span class="op" id="2780060">.</span><span class="ident" id="2780061">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780068">}</span>&nbsp;<span class="keyword" id="2780070">else</span>&nbsp;<span class="op" id="2780075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780080">end</span>&nbsp;<span class="op" id="2780084">=</span>&nbsp;<span class="ident" id="2780086">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780094">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2780098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2780110">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2780164">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780213">tx</span>&nbsp;<span class="op" id="2780216">:=</span>&nbsp;<span class="ident" id="2780219">l</span><span class="op" id="2780220">.</span><span class="ident" id="2780221">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780225">end</span>&nbsp;<span class="op" id="2780229">=</span>&nbsp;<span class="ident" id="2780231">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780238">lo</span>&nbsp;<span class="op" id="2780241">:=</span>&nbsp;<span class="num" id="2780244">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780247">hi</span>&nbsp;<span class="op" id="2780250">:=</span>&nbsp;<span class="builtinfunc" id="2780253">len</span><span class="op" id="2780256">(</span><span class="ident" id="2780257">tx</span><span class="op" id="2780259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2780262">for</span>&nbsp;<span class="ident" id="2780266">hi</span><span class="op" id="2780268">-</span><span class="ident" id="2780269">lo</span>&nbsp;<span class="op" id="2780272">&gt;</span>&nbsp;<span class="num" id="2780274">1</span>&nbsp;<span class="op" id="2780276">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780280">m</span>&nbsp;<span class="op" id="2780282">:=</span>&nbsp;<span class="ident" id="2780285">lo</span>&nbsp;<span class="op" id="2780288">+</span>&nbsp;<span class="op" id="2780290">(</span><span class="ident" id="2780291">hi</span><span class="op" id="2780293">-</span><span class="ident" id="2780294">lo</span><span class="op" id="2780296">)</span><span class="op" id="2780297">/</span><span class="num" id="2780298">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780302">lim</span>&nbsp;<span class="op" id="2780306">:=</span>&nbsp;<span class="ident" id="2780309">tx</span><span class="op" id="2780311">[</span><span class="ident" id="2780312">m</span><span class="op" id="2780313">]</span><span class="op" id="2780314">.</span><span class="ident" id="2780315">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2780322">if</span>&nbsp;<span class="ident" id="2780325">sec</span>&nbsp;<span class="op" id="2780329">&lt;</span>&nbsp;<span class="ident" id="2780331">lim</span>&nbsp;<span class="op" id="2780335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780340">end</span>&nbsp;<span class="op" id="2780344">=</span>&nbsp;<span class="ident" id="2780346">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780353">hi</span>&nbsp;<span class="op" id="2780356">=</span>&nbsp;<span class="ident" id="2780358">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780362">}</span>&nbsp;<span class="keyword" id="2780364">else</span>&nbsp;<span class="op" id="2780369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780374">lo</span>&nbsp;<span class="op" id="2780377">=</span>&nbsp;<span class="ident" id="2780379">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2780386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780389">zone</span>&nbsp;<span class="op" id="2780394">:=</span>&nbsp;<span class="op" id="2780397">&amp;</span><span class="ident" id="2780398">l</span><span class="op" id="2780399">.</span><span class="ident" id="2780400">zone</span><span class="op" id="2780404">[</span><span class="ident" id="2780405">tx</span><span class="op" id="2780407">[</span><span class="ident" id="2780408">lo</span><span class="op" id="2780410">]</span><span class="op" id="2780411">.</span><span class="ident" id="2780412">index</span><span class="op" id="2780417">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780420">name</span>&nbsp;<span class="op" id="2780425">=</span>&nbsp;<span class="ident" id="2780427">zone</span><span class="op" id="2780431">.</span><span class="ident" id="2780432">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780438">offset</span>&nbsp;<span class="op" id="2780445">=</span>&nbsp;<span class="ident" id="2780447">zone</span><span class="op" id="2780451">.</span><span class="ident" id="2780452">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780460">isDST</span>&nbsp;<span class="op" id="2780466">=</span>&nbsp;<span class="ident" id="2780468">zone</span><span class="op" id="2780472">.</span><span class="ident" id="2780473">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2780480">start</span>&nbsp;<span class="op" id="2780486">=</span>&nbsp;<span class="ident" id="2780488">tx</span><span class="op" id="2780490">[</span><span class="ident" id="2780491">lo</span><span class="op" id="2780493">]</span><span class="op" id="2780494">.</span><span class="ident" id="2780495">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2780501">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2780540">return</span><br>
<span class="lineno"></span><span class="op" id="2780547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2780550">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2780621">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2780690">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2780700">//</span><br>
<span class="lineno"></span><span class="comment" id="2780703">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2780755">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2780828">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2780883">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2780945">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2781007">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2781070">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2781142">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2781154">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2781220">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2781240">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2781277">func</span>&nbsp;<span class="op" id="2781282">(</span><span class="ident" id="2781283">l</span>&nbsp;<span class="op" id="2781285">*</span><span class="ident" id="2781286">Location</span><span class="op" id="2781294">)</span>&nbsp;<span class="ident" id="2781296">lookupFirstZone</span><span class="op" id="2781311">(</span><span class="op" id="2781312">)</span>&nbsp;<span class="builtintype" id="2781314">int</span>&nbsp;<span class="op" id="2781318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2781321">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781333">if</span>&nbsp;<span class="op" id="2781336">!</span><span class="ident" id="2781337">l</span><span class="op" id="2781338">.</span><span class="ident" id="2781339">firstZoneUsed</span><span class="op" id="2781352">(</span><span class="op" id="2781353">)</span>&nbsp;<span class="op" id="2781355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781359">return</span>&nbsp;<span class="num" id="2781366">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2781373">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781385">if</span>&nbsp;<span class="builtinfunc" id="2781388">len</span><span class="op" id="2781391">(</span><span class="ident" id="2781392">l</span><span class="op" id="2781393">.</span><span class="ident" id="2781394">tx</span><span class="op" id="2781396">)</span>&nbsp;<span class="op" id="2781398">&gt;</span>&nbsp;<span class="num" id="2781400">0</span>&nbsp;<span class="op" id="2781402">&amp;&amp;</span>&nbsp;<span class="ident" id="2781405">l</span><span class="op" id="2781406">.</span><span class="ident" id="2781407">zone</span><span class="op" id="2781411">[</span><span class="ident" id="2781412">l</span><span class="op" id="2781413">.</span><span class="ident" id="2781414">tx</span><span class="op" id="2781416">[</span><span class="num" id="2781417">0</span><span class="op" id="2781418">]</span><span class="op" id="2781419">.</span><span class="ident" id="2781420">index</span><span class="op" id="2781425">]</span><span class="op" id="2781426">.</span><span class="ident" id="2781427">isDST</span>&nbsp;<span class="op" id="2781433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781437">for</span>&nbsp;<span class="ident" id="2781441">zi</span>&nbsp;<span class="op" id="2781444">:=</span>&nbsp;<span class="builtintype" id="2781447">int</span><span class="op" id="2781450">(</span><span class="ident" id="2781451">l</span><span class="op" id="2781452">.</span><span class="ident" id="2781453">tx</span><span class="op" id="2781455">[</span><span class="num" id="2781456">0</span><span class="op" id="2781457">]</span><span class="op" id="2781458">.</span><span class="ident" id="2781459">index</span><span class="op" id="2781464">)</span>&nbsp;<span class="op" id="2781466">-</span>&nbsp;<span class="num" id="2781468">1</span><span class="op" id="2781469">;</span>&nbsp;<span class="ident" id="2781471">zi</span>&nbsp;<span class="op" id="2781474">&gt;=</span>&nbsp;<span class="num" id="2781477">0</span><span class="op" id="2781478">;</span>&nbsp;<span class="ident" id="2781480">zi</span><span class="op" id="2781482">--</span>&nbsp;<span class="op" id="2781485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781490">if</span>&nbsp;<span class="op" id="2781493">!</span><span class="ident" id="2781494">l</span><span class="op" id="2781495">.</span><span class="ident" id="2781496">zone</span><span class="op" id="2781500">[</span><span class="ident" id="2781501">zi</span><span class="op" id="2781503">]</span><span class="op" id="2781504">.</span><span class="ident" id="2781505">isDST</span>&nbsp;<span class="op" id="2781511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781517">return</span>&nbsp;<span class="ident" id="2781524">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781530">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2781541">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781553">for</span>&nbsp;<span class="ident" id="2781557">zi</span>&nbsp;<span class="op" id="2781560">:=</span>&nbsp;<span class="keyword" id="2781563">range</span>&nbsp;<span class="ident" id="2781569">l</span><span class="op" id="2781570">.</span><span class="ident" id="2781571">zone</span>&nbsp;<span class="op" id="2781576">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781580">if</span>&nbsp;<span class="op" id="2781583">!</span><span class="ident" id="2781584">l</span><span class="op" id="2781585">.</span><span class="ident" id="2781586">zone</span><span class="op" id="2781590">[</span><span class="ident" id="2781591">zi</span><span class="op" id="2781593">]</span><span class="op" id="2781594">.</span><span class="ident" id="2781595">isDST</span>&nbsp;<span class="op" id="2781601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781606">return</span>&nbsp;<span class="ident" id="2781613">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2781625">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781637">return</span>&nbsp;<span class="num" id="2781644">0</span><br>
<span class="lineno"></span><span class="op" id="2781646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2781649">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2781713">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2781728">func</span>&nbsp;<span class="op" id="2781733">(</span><span class="ident" id="2781734">l</span>&nbsp;<span class="op" id="2781736">*</span><span class="ident" id="2781737">Location</span><span class="op" id="2781745">)</span>&nbsp;<span class="ident" id="2781747">firstZoneUsed</span><span class="op" id="2781760">(</span><span class="op" id="2781761">)</span>&nbsp;<span class="builtintype" id="2781763">bool</span>&nbsp;<span class="op" id="2781768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781771">for</span>&nbsp;<span class="ident" id="2781775">_</span><span class="op" id="2781776">,</span>&nbsp;<span class="ident" id="2781778">tx</span>&nbsp;<span class="op" id="2781781">:=</span>&nbsp;<span class="keyword" id="2781784">range</span>&nbsp;<span class="ident" id="2781790">l</span><span class="op" id="2781791">.</span><span class="ident" id="2781792">tx</span>&nbsp;<span class="op" id="2781795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781799">if</span>&nbsp;<span class="ident" id="2781802">tx</span><span class="op" id="2781804">.</span><span class="ident" id="2781805">index</span>&nbsp;<span class="op" id="2781811">==</span>&nbsp;<span class="num" id="2781814">0</span>&nbsp;<span class="op" id="2781816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781821">return</span>&nbsp;<span class="builtintype" id="2781828">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2781838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2781841">return</span>&nbsp;<span class="builtintype" id="2781848">false</span><br>
<span class="lineno"></span><span class="op" id="2781854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2781857">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2781916">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2781980">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2782029">func</span>&nbsp;<span class="op" id="2782034">(</span><span class="ident" id="2782035">l</span>&nbsp;<span class="op" id="2782037">*</span><span class="ident" id="2782038">Location</span><span class="op" id="2782046">)</span>&nbsp;<span class="ident" id="2782048">lookupName</span><span class="op" id="2782058">(</span><span class="ident" id="2782059">name</span>&nbsp;<span class="builtintype" id="2782064">string</span><span class="op" id="2782070">,</span>&nbsp;<span class="ident" id="2782072">unix</span>&nbsp;<span class="ident" id="2782077">int64</span><span class="op" id="2782082">)</span>&nbsp;<span class="op" id="2782084">(</span><span class="ident" id="2782085">offset</span>&nbsp;<span class="builtintype" id="2782092">int</span><span class="op" id="2782095">,</span>&nbsp;<span class="ident" id="2782097">isDST</span>&nbsp;<span class="builtintype" id="2782103">bool</span><span class="op" id="2782107">,</span>&nbsp;<span class="ident" id="2782109">ok</span>&nbsp;<span class="builtintype" id="2782112">bool</span><span class="op" id="2782116">)</span>&nbsp;<span class="op" id="2782118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2782121">l</span>&nbsp;<span class="op" id="2782123">=</span>&nbsp;<span class="ident" id="2782125">l</span><span class="op" id="2782126">.</span><span class="ident" id="2782127">get</span><span class="op" id="2782130">(</span><span class="op" id="2782131">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782135">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782198">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782268">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782331">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782390">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782457">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782474">for</span>&nbsp;<span class="ident" id="2782478">i</span>&nbsp;<span class="op" id="2782480">:=</span>&nbsp;<span class="keyword" id="2782483">range</span>&nbsp;<span class="ident" id="2782489">l</span><span class="op" id="2782490">.</span><span class="ident" id="2782491">zone</span>&nbsp;<span class="op" id="2782496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2782500">zone</span>&nbsp;<span class="op" id="2782505">:=</span>&nbsp;<span class="op" id="2782508">&amp;</span><span class="ident" id="2782509">l</span><span class="op" id="2782510">.</span><span class="ident" id="2782511">zone</span><span class="op" id="2782515">[</span><span class="ident" id="2782516">i</span><span class="op" id="2782517">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782521">if</span>&nbsp;<span class="ident" id="2782524">zone</span><span class="op" id="2782528">.</span><span class="ident" id="2782529">name</span>&nbsp;<span class="op" id="2782534">==</span>&nbsp;<span class="ident" id="2782537">name</span>&nbsp;<span class="op" id="2782542">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2782547">nam</span><span class="op" id="2782550">,</span>&nbsp;<span class="ident" id="2782552">offset</span><span class="op" id="2782558">,</span>&nbsp;<span class="ident" id="2782560">isDST</span><span class="op" id="2782565">,</span>&nbsp;<span class="ident" id="2782567">_</span><span class="op" id="2782568">,</span>&nbsp;<span class="ident" id="2782570">_</span>&nbsp;<span class="op" id="2782572">:=</span>&nbsp;<span class="ident" id="2782575">l</span><span class="op" id="2782576">.</span><span class="ident" id="2782577">lookup</span><span class="op" id="2782583">(</span><span class="ident" id="2782584">unix</span>&nbsp;<span class="op" id="2782589">-</span>&nbsp;<span class="ident" id="2782591">int64</span><span class="op" id="2782596">(</span><span class="ident" id="2782597">zone</span><span class="op" id="2782601">.</span><span class="ident" id="2782602">offset</span><span class="op" id="2782608">)</span><span class="op" id="2782609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782614">if</span>&nbsp;<span class="ident" id="2782617">nam</span>&nbsp;<span class="op" id="2782621">==</span>&nbsp;<span class="ident" id="2782624">zone</span><span class="op" id="2782628">.</span><span class="ident" id="2782629">name</span>&nbsp;<span class="op" id="2782634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782640">return</span>&nbsp;<span class="ident" id="2782647">offset</span><span class="op" id="2782653">,</span>&nbsp;<span class="ident" id="2782655">isDST</span><span class="op" id="2782660">,</span>&nbsp;<span class="builtintype" id="2782662">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2782670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2782674">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2782677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782681">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782732">for</span>&nbsp;<span class="ident" id="2782736">i</span>&nbsp;<span class="op" id="2782738">:=</span>&nbsp;<span class="keyword" id="2782741">range</span>&nbsp;<span class="ident" id="2782747">l</span><span class="op" id="2782748">.</span><span class="ident" id="2782749">zone</span>&nbsp;<span class="op" id="2782754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2782758">zone</span>&nbsp;<span class="op" id="2782763">:=</span>&nbsp;<span class="op" id="2782766">&amp;</span><span class="ident" id="2782767">l</span><span class="op" id="2782768">.</span><span class="ident" id="2782769">zone</span><span class="op" id="2782773">[</span><span class="ident" id="2782774">i</span><span class="op" id="2782775">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782779">if</span>&nbsp;<span class="ident" id="2782782">zone</span><span class="op" id="2782786">.</span><span class="ident" id="2782787">name</span>&nbsp;<span class="op" id="2782792">==</span>&nbsp;<span class="ident" id="2782795">name</span>&nbsp;<span class="op" id="2782800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782805">return</span>&nbsp;<span class="ident" id="2782812">zone</span><span class="op" id="2782816">.</span><span class="ident" id="2782817">offset</span><span class="op" id="2782823">,</span>&nbsp;<span class="ident" id="2782825">zone</span><span class="op" id="2782829">.</span><span class="ident" id="2782830">isDST</span><span class="op" id="2782835">,</span>&nbsp;<span class="builtintype" id="2782837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2782844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2782847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2782851">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2782875">return</span><br>
<span class="lineno"></span><span class="op" id="2782882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2782885">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2782958">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2783019">var</span>&nbsp;<span class="ident" id="2783023">zoneinfo</span><span class="op" id="2783031">,</span>&nbsp;<span class="ident" id="2783033">_</span>&nbsp;<span class="op" id="2783035">=</span>&nbsp;<span class="ident" id="2783037">syscall</span><span class="op" id="2783044">.</span><span class="ident" id="2783045">Getenv</span><span class="op" id="2783051">(</span><span class="string" id="2783052">&#34;ZONEINFO&#34;</span><span class="op" id="2783062">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2783065">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2783123">//</span><br>
<span class="lineno"></span><span class="comment" id="2783126">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2783183">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2783238">//</span><br>
<span class="lineno"></span><span class="comment" id="2783241">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2783319">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2783382">//</span><br>
<span class="lineno"></span><span class="comment" id="2783385">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2783445">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2783501">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2783565">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2783634">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2783683">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2783738">func</span>&nbsp;<span class="ident" id="2783743">LoadLocation</span><span class="op" id="2783755">(</span><span class="ident" id="2783756">name</span>&nbsp;<span class="builtintype" id="2783761">string</span><span class="op" id="2783767">)</span>&nbsp;<span class="op" id="2783769">(</span><span class="op" id="2783770">*</span><span class="ident" id="2783771">Location</span><span class="op" id="2783779">,</span>&nbsp;<span class="builtintype" id="2783781">error</span><span class="op" id="2783786">)</span>&nbsp;<span class="op" id="2783788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783791">if</span>&nbsp;<span class="ident" id="2783794">name</span>&nbsp;<span class="op" id="2783799">==</span>&nbsp;<span class="string" id="2783802">&#34;&#34;</span>&nbsp;<span class="op" id="2783805">||</span>&nbsp;<span class="ident" id="2783808">name</span>&nbsp;<span class="op" id="2783813">==</span>&nbsp;<span class="string" id="2783816">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2783822">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783826">return</span>&nbsp;<span class="ident" id="2783833">UTC</span><span class="op" id="2783836">,</span>&nbsp;<span class="ident" id="2783838">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2783843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783846">if</span>&nbsp;<span class="ident" id="2783849">name</span>&nbsp;<span class="op" id="2783854">==</span>&nbsp;<span class="string" id="2783857">&#34;Local&#34;</span>&nbsp;<span class="op" id="2783865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783869">return</span>&nbsp;<span class="ident" id="2783876">Local</span><span class="op" id="2783881">,</span>&nbsp;<span class="ident" id="2783883">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2783888">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783891">if</span>&nbsp;<span class="ident" id="2783894">zoneinfo</span>&nbsp;<span class="op" id="2783903">!=</span>&nbsp;<span class="string" id="2783906">&#34;&#34;</span>&nbsp;<span class="op" id="2783909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783913">if</span>&nbsp;<span class="ident" id="2783916">z</span><span class="op" id="2783917">,</span>&nbsp;<span class="ident" id="2783919">err</span>&nbsp;<span class="op" id="2783923">:=</span>&nbsp;<span class="ident" id="2783926">loadZoneFile</span><span class="op" id="2783938">(</span><span class="ident" id="2783939">zoneinfo</span><span class="op" id="2783947">,</span>&nbsp;<span class="ident" id="2783949">name</span><span class="op" id="2783953">)</span><span class="op" id="2783954">;</span>&nbsp;<span class="ident" id="2783956">err</span>&nbsp;<span class="op" id="2783960">==</span>&nbsp;<span class="ident" id="2783963">nil</span>&nbsp;<span class="op" id="2783967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2783972">z</span><span class="op" id="2783973">.</span><span class="ident" id="2783974">name</span>&nbsp;<span class="op" id="2783979">=</span>&nbsp;<span class="ident" id="2783981">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2783989">return</span>&nbsp;<span class="ident" id="2783996">z</span><span class="op" id="2783997">,</span>&nbsp;<span class="ident" id="2783999">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784005">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784011">return</span>&nbsp;<span class="ident" id="2784018">loadLocation</span><span class="op" id="2784030">(</span><span class="ident" id="2784031">name</span><span class="op" id="2784035">)</span><br>
<span class="lineno"></span><span class="op" id="2784037">}</span>
</div>
</body>
</html>
