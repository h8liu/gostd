<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2039671">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2039726">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2039780">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2039831">package</span>&nbsp;<span class="ident" id="2039839">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2039845">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2039911">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2039965">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2040016">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2040071">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2040101">//</span><br>
<span class="lineno"></span><span class="comment" id="2040104">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2040160">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2040229">//</span><br>
<span class="lineno"></span><span class="comment" id="2040232">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2040291">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2040347">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2040404">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2040421">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2040477">//</span><br>
<span class="lineno">25</span><span class="comment" id="2040480">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2040522">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2040582">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2040596">//</span><br>
<span class="lineno"></span><span class="comment" id="2040599">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2040617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2040682">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2040745">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2040779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2040813">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2040847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2040899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2040939">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2040994">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2041049">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2041106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2041159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2041213">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2041247">//</span><br>
<span class="lineno"></span><span class="comment" id="2041250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2041301">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2041348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2041372">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2041433">//</span><br>
<span class="lineno">50</span><span class="comment" id="2041436">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2041458">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2041478">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2041498">func</span>&nbsp;<span class="ident" id="2041503">Jn</span><span class="op" id="2041505">(</span><span class="ident" id="2041506">n</span>&nbsp;<span class="builtintype" id="2041508">int</span><span class="op" id="2041511">,</span>&nbsp;<span class="ident" id="2041513">x</span>&nbsp;<span class="builtintype" id="2041515">float64</span><span class="op" id="2041522">)</span>&nbsp;<span class="builtintype" id="2041524">float64</span>&nbsp;<span class="op" id="2041532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041535">const</span>&nbsp;<span class="op" id="2041541">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041545">TwoM29</span>&nbsp;<span class="op" id="2041552">=</span>&nbsp;<span class="num" id="2041554">1.0</span>&nbsp;<span class="op" id="2041558">/</span>&nbsp;<span class="op" id="2041560">(</span><span class="num" id="2041561">1</span>&nbsp;<span class="op" id="2041563">&lt;&lt;</span>&nbsp;<span class="num" id="2041566">29</span><span class="op" id="2041568">)</span>&nbsp;<span class="comment" id="2041570">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041601">Two302</span>&nbsp;<span class="op" id="2041608">=</span>&nbsp;<span class="num" id="2041610">1</span>&nbsp;<span class="op" id="2041612">&lt;&lt;</span>&nbsp;<span class="num" id="2041615">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2041626">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2041659">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041677">switch</span>&nbsp;<span class="op" id="2041684">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041687">case</span>&nbsp;<span class="ident" id="2041692">IsNaN</span><span class="op" id="2041697">(</span><span class="ident" id="2041698">x</span><span class="op" id="2041699">)</span><span class="op" id="2041700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041704">return</span>&nbsp;<span class="ident" id="2041711">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041714">case</span>&nbsp;<span class="ident" id="2041719">IsInf</span><span class="op" id="2041724">(</span><span class="ident" id="2041725">x</span><span class="op" id="2041726">,</span>&nbsp;<span class="num" id="2041728">0</span><span class="op" id="2041729">)</span><span class="op" id="2041730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041734">return</span>&nbsp;<span class="num" id="2041741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041744">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2041747">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2041810">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041841">if</span>&nbsp;<span class="ident" id="2041844">n</span>&nbsp;<span class="op" id="2041846">==</span>&nbsp;<span class="num" id="2041849">0</span>&nbsp;<span class="op" id="2041851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041855">return</span>&nbsp;<span class="ident" id="2041862">J0</span><span class="op" id="2041864">(</span><span class="ident" id="2041865">x</span><span class="op" id="2041866">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041872">if</span>&nbsp;<span class="ident" id="2041875">x</span>&nbsp;<span class="op" id="2041877">==</span>&nbsp;<span class="num" id="2041880">0</span>&nbsp;<span class="op" id="2041882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041886">return</span>&nbsp;<span class="num" id="2041893">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041899">if</span>&nbsp;<span class="ident" id="2041902">n</span>&nbsp;<span class="op" id="2041904">&lt;</span>&nbsp;<span class="num" id="2041906">0</span>&nbsp;<span class="op" id="2041908">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041912">n</span><span class="op" id="2041913">,</span>&nbsp;<span class="ident" id="2041915">x</span>&nbsp;<span class="op" id="2041917">=</span>&nbsp;<span class="op" id="2041919">-</span><span class="ident" id="2041920">n</span><span class="op" id="2041921">,</span>&nbsp;<span class="op" id="2041923">-</span><span class="ident" id="2041924">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041930">if</span>&nbsp;<span class="ident" id="2041933">n</span>&nbsp;<span class="op" id="2041935">==</span>&nbsp;<span class="num" id="2041938">1</span>&nbsp;<span class="op" id="2041940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041944">return</span>&nbsp;<span class="ident" id="2041951">J1</span><span class="op" id="2041953">(</span><span class="ident" id="2041954">x</span><span class="op" id="2041955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041958">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041961">sign</span>&nbsp;<span class="op" id="2041966">:=</span>&nbsp;<span class="ident" id="2041969">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041976">if</span>&nbsp;<span class="ident" id="2041979">x</span>&nbsp;<span class="op" id="2041981">&lt;</span>&nbsp;<span class="num" id="2041983">0</span>&nbsp;<span class="op" id="2041985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041989">x</span>&nbsp;<span class="op" id="2041991">=</span>&nbsp;<span class="op" id="2041993">-</span><span class="ident" id="2041994">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041998">if</span>&nbsp;<span class="ident" id="2042001">n</span><span class="op" id="2042002">&amp;</span><span class="num" id="2042003">1</span>&nbsp;<span class="op" id="2042005">==</span>&nbsp;<span class="num" id="2042008">1</span>&nbsp;<span class="op" id="2042010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042015">sign</span>&nbsp;<span class="op" id="2042020">=</span>&nbsp;<span class="ident" id="2042022">true</span>&nbsp;<span class="comment" id="2042027">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042059">var</span>&nbsp;<span class="ident" id="2042063">b</span>&nbsp;<span class="builtintype" id="2042065">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042074">if</span>&nbsp;<span class="builtintype" id="2042077">float64</span><span class="op" id="2042084">(</span><span class="ident" id="2042085">n</span><span class="op" id="2042086">)</span>&nbsp;<span class="op" id="2042088">&lt;=</span>&nbsp;<span class="ident" id="2042091">x</span>&nbsp;<span class="op" id="2042093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042097">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042145">if</span>&nbsp;<span class="ident" id="2042148">x</span>&nbsp;<span class="op" id="2042150">&gt;=</span>&nbsp;<span class="ident" id="2042153">Two302</span>&nbsp;<span class="op" id="2042160">{</span>&nbsp;<span class="comment" id="2042162">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042180">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042253">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042308">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042347">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042404">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042466">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042520">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042616">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042664">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042713">var</span>&nbsp;<span class="ident" id="2042717">temp</span>&nbsp;<span class="builtintype" id="2042722">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042733">switch</span>&nbsp;<span class="ident" id="2042740">n</span>&nbsp;<span class="op" id="2042742">&amp;</span>&nbsp;<span class="num" id="2042744">3</span>&nbsp;<span class="op" id="2042746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042751">case</span>&nbsp;<span class="num" id="2042756">0</span><span class="op" id="2042757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042763">temp</span>&nbsp;<span class="op" id="2042768">=</span>&nbsp;<span class="ident" id="2042770">Cos</span><span class="op" id="2042773">(</span><span class="ident" id="2042774">x</span><span class="op" id="2042775">)</span>&nbsp;<span class="op" id="2042777">+</span>&nbsp;<span class="ident" id="2042779">Sin</span><span class="op" id="2042782">(</span><span class="ident" id="2042783">x</span><span class="op" id="2042784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042789">case</span>&nbsp;<span class="num" id="2042794">1</span><span class="op" id="2042795">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042801">temp</span>&nbsp;<span class="op" id="2042806">=</span>&nbsp;<span class="op" id="2042808">-</span><span class="ident" id="2042809">Cos</span><span class="op" id="2042812">(</span><span class="ident" id="2042813">x</span><span class="op" id="2042814">)</span>&nbsp;<span class="op" id="2042816">+</span>&nbsp;<span class="ident" id="2042818">Sin</span><span class="op" id="2042821">(</span><span class="ident" id="2042822">x</span><span class="op" id="2042823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042828">case</span>&nbsp;<span class="num" id="2042833">2</span><span class="op" id="2042834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042840">temp</span>&nbsp;<span class="op" id="2042845">=</span>&nbsp;<span class="op" id="2042847">-</span><span class="ident" id="2042848">Cos</span><span class="op" id="2042851">(</span><span class="ident" id="2042852">x</span><span class="op" id="2042853">)</span>&nbsp;<span class="op" id="2042855">-</span>&nbsp;<span class="ident" id="2042857">Sin</span><span class="op" id="2042860">(</span><span class="ident" id="2042861">x</span><span class="op" id="2042862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042867">case</span>&nbsp;<span class="num" id="2042872">3</span><span class="op" id="2042873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042879">temp</span>&nbsp;<span class="op" id="2042884">=</span>&nbsp;<span class="ident" id="2042886">Cos</span><span class="op" id="2042889">(</span><span class="ident" id="2042890">x</span><span class="op" id="2042891">)</span>&nbsp;<span class="op" id="2042893">-</span>&nbsp;<span class="ident" id="2042895">Sin</span><span class="op" id="2042898">(</span><span class="ident" id="2042899">x</span><span class="op" id="2042900">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042910">b</span>&nbsp;<span class="op" id="2042912">=</span>&nbsp;<span class="op" id="2042914">(</span><span class="num" id="2042915">1</span>&nbsp;<span class="op" id="2042917">/</span>&nbsp;<span class="ident" id="2042919">SqrtPi</span><span class="op" id="2042925">)</span>&nbsp;<span class="op" id="2042927">*</span>&nbsp;<span class="ident" id="2042929">temp</span>&nbsp;<span class="op" id="2042934">/</span>&nbsp;<span class="ident" id="2042936">Sqrt</span><span class="op" id="2042940">(</span><span class="ident" id="2042941">x</span><span class="op" id="2042942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042946">}</span>&nbsp;<span class="keyword" id="2042948">else</span>&nbsp;<span class="op" id="2042953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042958">b</span>&nbsp;<span class="op" id="2042960">=</span>&nbsp;<span class="ident" id="2042962">J1</span><span class="op" id="2042964">(</span><span class="ident" id="2042965">x</span><span class="op" id="2042966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042971">for</span>&nbsp;<span class="ident" id="2042975">i</span><span class="op" id="2042976">,</span>&nbsp;<span class="ident" id="2042978">a</span>&nbsp;<span class="op" id="2042980">:=</span>&nbsp;<span class="num" id="2042983">1</span><span class="op" id="2042984">,</span>&nbsp;<span class="ident" id="2042986">J0</span><span class="op" id="2042988">(</span><span class="ident" id="2042989">x</span><span class="op" id="2042990">)</span><span class="op" id="2042991">;</span>&nbsp;<span class="ident" id="2042993">i</span>&nbsp;<span class="op" id="2042995">&lt;</span>&nbsp;<span class="ident" id="2042997">n</span><span class="op" id="2042998">;</span>&nbsp;<span class="ident" id="2043000">i</span><span class="op" id="2043001">++</span>&nbsp;<span class="op" id="2043004">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043010">a</span><span class="op" id="2043011">,</span>&nbsp;<span class="ident" id="2043013">b</span>&nbsp;<span class="op" id="2043015">=</span>&nbsp;<span class="ident" id="2043017">b</span><span class="op" id="2043018">,</span>&nbsp;<span class="ident" id="2043020">b</span><span class="op" id="2043021">*</span><span class="op" id="2043022">(</span><span class="builtintype" id="2043023">float64</span><span class="op" id="2043030">(</span><span class="ident" id="2043031">i</span><span class="op" id="2043032">+</span><span class="ident" id="2043033">i</span><span class="op" id="2043034">)</span><span class="op" id="2043035">/</span><span class="ident" id="2043036">x</span><span class="op" id="2043037">)</span><span class="op" id="2043038">-</span><span class="ident" id="2043039">a</span>&nbsp;<span class="comment" id="2043041">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043070">}</span>&nbsp;<span class="keyword" id="2043072">else</span>&nbsp;<span class="op" id="2043077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043081">if</span>&nbsp;<span class="ident" id="2043084">x</span>&nbsp;<span class="op" id="2043086">&lt;</span>&nbsp;<span class="ident" id="2043088">TwoM29</span>&nbsp;<span class="op" id="2043095">{</span>&nbsp;<span class="comment" id="2043097">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043114">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043175">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043212">if</span>&nbsp;<span class="ident" id="2043215">n</span>&nbsp;<span class="op" id="2043217">&gt;</span>&nbsp;<span class="num" id="2043219">33</span>&nbsp;<span class="op" id="2043222">{</span>&nbsp;<span class="comment" id="2043224">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043241">b</span>&nbsp;<span class="op" id="2043243">=</span>&nbsp;<span class="num" id="2043245">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043250">}</span>&nbsp;<span class="keyword" id="2043252">else</span>&nbsp;<span class="op" id="2043257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043263">temp</span>&nbsp;<span class="op" id="2043268">:=</span>&nbsp;<span class="ident" id="2043271">x</span>&nbsp;<span class="op" id="2043273">*</span>&nbsp;<span class="num" id="2043275">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043283">b</span>&nbsp;<span class="op" id="2043285">=</span>&nbsp;<span class="ident" id="2043287">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043296">a</span>&nbsp;<span class="op" id="2043298">:=</span>&nbsp;<span class="num" id="2043301">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043309">for</span>&nbsp;<span class="ident" id="2043313">i</span>&nbsp;<span class="op" id="2043315">:=</span>&nbsp;<span class="num" id="2043318">2</span><span class="op" id="2043319">;</span>&nbsp;<span class="ident" id="2043321">i</span>&nbsp;<span class="op" id="2043323">&lt;=</span>&nbsp;<span class="ident" id="2043326">n</span><span class="op" id="2043327">;</span>&nbsp;<span class="ident" id="2043329">i</span><span class="op" id="2043330">++</span>&nbsp;<span class="op" id="2043333">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043340">a</span>&nbsp;<span class="op" id="2043342">*=</span>&nbsp;<span class="builtintype" id="2043345">float64</span><span class="op" id="2043352">(</span><span class="ident" id="2043353">i</span><span class="op" id="2043354">)</span>&nbsp;<span class="comment" id="2043356">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043371">b</span>&nbsp;<span class="op" id="2043373">*=</span>&nbsp;<span class="ident" id="2043376">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2043387">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043413">b</span>&nbsp;<span class="op" id="2043415">/=</span>&nbsp;<span class="ident" id="2043418">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043423">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043427">}</span>&nbsp;<span class="keyword" id="2043429">else</span>&nbsp;<span class="op" id="2043434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043439">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043518">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043624">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043675">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043829">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043875">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043881">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043935">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043977">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044134">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044169">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044206">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044212">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044258">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044293">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044331">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044369">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044407">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044450">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044468">w</span>&nbsp;<span class="op" id="2044470">:=</span>&nbsp;<span class="builtintype" id="2044473">float64</span><span class="op" id="2044480">(</span><span class="ident" id="2044481">n</span><span class="op" id="2044482">+</span><span class="ident" id="2044483">n</span><span class="op" id="2044484">)</span>&nbsp;<span class="op" id="2044486">/</span>&nbsp;<span class="ident" id="2044488">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044493">h</span>&nbsp;<span class="op" id="2044495">:=</span>&nbsp;<span class="num" id="2044498">2</span>&nbsp;<span class="op" id="2044500">/</span>&nbsp;<span class="ident" id="2044502">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044507">q0</span>&nbsp;<span class="op" id="2044510">:=</span>&nbsp;<span class="ident" id="2044513">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044518">z</span>&nbsp;<span class="op" id="2044520">:=</span>&nbsp;<span class="ident" id="2044523">w</span>&nbsp;<span class="op" id="2044525">+</span>&nbsp;<span class="ident" id="2044527">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044532">q1</span>&nbsp;<span class="op" id="2044535">:=</span>&nbsp;<span class="ident" id="2044538">w</span><span class="op" id="2044539">*</span><span class="ident" id="2044540">z</span>&nbsp;<span class="op" id="2044542">-</span>&nbsp;<span class="num" id="2044544">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044549">k</span>&nbsp;<span class="op" id="2044551">:=</span>&nbsp;<span class="num" id="2044554">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2044559">for</span>&nbsp;<span class="ident" id="2044563">q1</span>&nbsp;<span class="op" id="2044566">&lt;</span>&nbsp;<span class="num" id="2044568">1e9</span>&nbsp;<span class="op" id="2044572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044578">k</span>&nbsp;<span class="op" id="2044580">+=</span>&nbsp;<span class="num" id="2044583">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044589">z</span>&nbsp;<span class="op" id="2044591">+=</span>&nbsp;<span class="ident" id="2044594">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044600">q0</span><span class="op" id="2044602">,</span>&nbsp;<span class="ident" id="2044604">q1</span>&nbsp;<span class="op" id="2044607">=</span>&nbsp;<span class="ident" id="2044609">q1</span><span class="op" id="2044611">,</span>&nbsp;<span class="ident" id="2044613">z</span><span class="op" id="2044614">*</span><span class="ident" id="2044615">q1</span><span class="op" id="2044617">-</span><span class="ident" id="2044618">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2044624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044629">m</span>&nbsp;<span class="op" id="2044631">:=</span>&nbsp;<span class="ident" id="2044634">n</span>&nbsp;<span class="op" id="2044636">+</span>&nbsp;<span class="ident" id="2044638">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044643">t</span>&nbsp;<span class="op" id="2044645">:=</span>&nbsp;<span class="num" id="2044648">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2044655">for</span>&nbsp;<span class="ident" id="2044659">i</span>&nbsp;<span class="op" id="2044661">:=</span>&nbsp;<span class="num" id="2044664">2</span>&nbsp;<span class="op" id="2044666">*</span>&nbsp;<span class="op" id="2044668">(</span><span class="ident" id="2044669">n</span>&nbsp;<span class="op" id="2044671">+</span>&nbsp;<span class="ident" id="2044673">k</span><span class="op" id="2044674">)</span><span class="op" id="2044675">;</span>&nbsp;<span class="ident" id="2044677">i</span>&nbsp;<span class="op" id="2044679">&gt;=</span>&nbsp;<span class="ident" id="2044682">m</span><span class="op" id="2044683">;</span>&nbsp;<span class="ident" id="2044685">i</span>&nbsp;<span class="op" id="2044687">-=</span>&nbsp;<span class="num" id="2044690">2</span>&nbsp;<span class="op" id="2044692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044698">t</span>&nbsp;<span class="op" id="2044700">=</span>&nbsp;<span class="num" id="2044702">1</span>&nbsp;<span class="op" id="2044704">/</span>&nbsp;<span class="op" id="2044706">(</span><span class="builtintype" id="2044707">float64</span><span class="op" id="2044714">(</span><span class="ident" id="2044715">i</span><span class="op" id="2044716">)</span><span class="op" id="2044717">/</span><span class="ident" id="2044718">x</span>&nbsp;<span class="op" id="2044720">-</span>&nbsp;<span class="ident" id="2044722">t</span><span class="op" id="2044723">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2044728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044733">a</span>&nbsp;<span class="op" id="2044735">:=</span>&nbsp;<span class="ident" id="2044738">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2044743">b</span>&nbsp;<span class="op" id="2044745">=</span>&nbsp;<span class="num" id="2044747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044752">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044806">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044843">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044874">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044915">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2044981">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045040">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045073">tmp</span>&nbsp;<span class="op" id="2045077">:=</span>&nbsp;<span class="builtintype" id="2045080">float64</span><span class="op" id="2045087">(</span><span class="ident" id="2045088">n</span><span class="op" id="2045089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045094">v</span>&nbsp;<span class="op" id="2045096">:=</span>&nbsp;<span class="num" id="2045099">2</span>&nbsp;<span class="op" id="2045101">/</span>&nbsp;<span class="ident" id="2045103">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045108">tmp</span>&nbsp;<span class="op" id="2045112">=</span>&nbsp;<span class="ident" id="2045114">tmp</span>&nbsp;<span class="op" id="2045118">*</span>&nbsp;<span class="ident" id="2045120">Log</span><span class="op" id="2045123">(</span><span class="ident" id="2045124">Abs</span><span class="op" id="2045127">(</span><span class="ident" id="2045128">v</span><span class="op" id="2045129">*</span><span class="ident" id="2045130">tmp</span><span class="op" id="2045133">)</span><span class="op" id="2045134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045139">if</span>&nbsp;<span class="ident" id="2045142">tmp</span>&nbsp;<span class="op" id="2045146">&lt;</span>&nbsp;<span class="num" id="2045148">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2045175">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045181">for</span>&nbsp;<span class="ident" id="2045185">i</span>&nbsp;<span class="op" id="2045187">:=</span>&nbsp;<span class="ident" id="2045190">n</span>&nbsp;<span class="op" id="2045192">-</span>&nbsp;<span class="num" id="2045194">1</span><span class="op" id="2045195">;</span>&nbsp;<span class="ident" id="2045197">i</span>&nbsp;<span class="op" id="2045199">&gt;</span>&nbsp;<span class="num" id="2045201">0</span><span class="op" id="2045202">;</span>&nbsp;<span class="ident" id="2045204">i</span><span class="op" id="2045205">--</span>&nbsp;<span class="op" id="2045208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045215">di</span>&nbsp;<span class="op" id="2045218">:=</span>&nbsp;<span class="builtintype" id="2045221">float64</span><span class="op" id="2045228">(</span><span class="ident" id="2045229">i</span>&nbsp;<span class="op" id="2045231">+</span>&nbsp;<span class="ident" id="2045233">i</span><span class="op" id="2045234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045241">a</span><span class="op" id="2045242">,</span>&nbsp;<span class="ident" id="2045244">b</span>&nbsp;<span class="op" id="2045246">=</span>&nbsp;<span class="ident" id="2045248">b</span><span class="op" id="2045249">,</span>&nbsp;<span class="ident" id="2045251">b</span><span class="op" id="2045252">*</span><span class="ident" id="2045253">di</span><span class="op" id="2045255">/</span><span class="ident" id="2045256">x</span><span class="op" id="2045257">-</span><span class="ident" id="2045258">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045265">di</span>&nbsp;<span class="op" id="2045268">-=</span>&nbsp;<span class="num" id="2045271">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045277">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045282">}</span>&nbsp;<span class="keyword" id="2045284">else</span>&nbsp;<span class="op" id="2045289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045295">for</span>&nbsp;<span class="ident" id="2045299">i</span>&nbsp;<span class="op" id="2045301">:=</span>&nbsp;<span class="ident" id="2045304">n</span>&nbsp;<span class="op" id="2045306">-</span>&nbsp;<span class="num" id="2045308">1</span><span class="op" id="2045309">;</span>&nbsp;<span class="ident" id="2045311">i</span>&nbsp;<span class="op" id="2045313">&gt;</span>&nbsp;<span class="num" id="2045315">0</span><span class="op" id="2045316">;</span>&nbsp;<span class="ident" id="2045318">i</span><span class="op" id="2045319">--</span>&nbsp;<span class="op" id="2045322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045329">di</span>&nbsp;<span class="op" id="2045332">:=</span>&nbsp;<span class="builtintype" id="2045335">float64</span><span class="op" id="2045342">(</span><span class="ident" id="2045343">i</span>&nbsp;<span class="op" id="2045345">+</span>&nbsp;<span class="ident" id="2045347">i</span><span class="op" id="2045348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045355">a</span><span class="op" id="2045356">,</span>&nbsp;<span class="ident" id="2045358">b</span>&nbsp;<span class="op" id="2045360">=</span>&nbsp;<span class="ident" id="2045362">b</span><span class="op" id="2045363">,</span>&nbsp;<span class="ident" id="2045365">b</span><span class="op" id="2045366">*</span><span class="ident" id="2045367">di</span><span class="op" id="2045369">/</span><span class="ident" id="2045370">x</span><span class="op" id="2045371">-</span><span class="ident" id="2045372">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045379">di</span>&nbsp;<span class="op" id="2045382">-=</span>&nbsp;<span class="num" id="2045385">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045392">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045435">if</span>&nbsp;<span class="ident" id="2045438">b</span>&nbsp;<span class="op" id="2045440">&gt;</span>&nbsp;<span class="num" id="2045442">1e100</span>&nbsp;<span class="op" id="2045448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045456">a</span>&nbsp;<span class="op" id="2045458">/=</span>&nbsp;<span class="ident" id="2045461">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045469">t</span>&nbsp;<span class="op" id="2045471">/=</span>&nbsp;<span class="ident" id="2045474">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045482">b</span>&nbsp;<span class="op" id="2045484">=</span>&nbsp;<span class="num" id="2045486">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045509">b</span>&nbsp;<span class="op" id="2045511">=</span>&nbsp;<span class="ident" id="2045513">t</span>&nbsp;<span class="op" id="2045515">*</span>&nbsp;<span class="ident" id="2045517">J0</span><span class="op" id="2045519">(</span><span class="ident" id="2045520">x</span><span class="op" id="2045521">)</span>&nbsp;<span class="op" id="2045523">/</span>&nbsp;<span class="ident" id="2045525">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045529">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045535">if</span>&nbsp;<span class="ident" id="2045538">sign</span>&nbsp;<span class="op" id="2045543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045547">return</span>&nbsp;<span class="op" id="2045554">-</span><span class="ident" id="2045555">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045561">return</span>&nbsp;<span class="ident" id="2045568">b</span><br>
<span class="lineno">225</span><span class="op" id="2045570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2045573">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2045635">//</span><br>
<span class="lineno"></span><span class="comment" id="2045638">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2045660">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2045679">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2045702">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2045756">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2045778">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2045798">func</span>&nbsp;<span class="ident" id="2045803">Yn</span><span class="op" id="2045805">(</span><span class="ident" id="2045806">n</span>&nbsp;<span class="builtintype" id="2045808">int</span><span class="op" id="2045811">,</span>&nbsp;<span class="ident" id="2045813">x</span>&nbsp;<span class="builtintype" id="2045815">float64</span><span class="op" id="2045822">)</span>&nbsp;<span class="builtintype" id="2045824">float64</span>&nbsp;<span class="op" id="2045832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045835">const</span>&nbsp;<span class="ident" id="2045841">Two302</span>&nbsp;<span class="op" id="2045848">=</span>&nbsp;<span class="num" id="2045850">1</span>&nbsp;<span class="op" id="2045852">&lt;&lt;</span>&nbsp;<span class="num" id="2045855">302</span>&nbsp;<span class="comment" id="2045859">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045889">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045907">switch</span>&nbsp;<span class="op" id="2045914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045917">case</span>&nbsp;<span class="ident" id="2045922">x</span>&nbsp;<span class="op" id="2045924">&lt;</span>&nbsp;<span class="num" id="2045926">0</span>&nbsp;<span class="op" id="2045928">||</span>&nbsp;<span class="ident" id="2045931">IsNaN</span><span class="op" id="2045936">(</span><span class="ident" id="2045937">x</span><span class="op" id="2045938">)</span><span class="op" id="2045939">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045943">return</span>&nbsp;<span class="ident" id="2045950">NaN</span><span class="op" id="2045953">(</span><span class="op" id="2045954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045957">case</span>&nbsp;<span class="ident" id="2045962">IsInf</span><span class="op" id="2045967">(</span><span class="ident" id="2045968">x</span><span class="op" id="2045969">,</span>&nbsp;<span class="num" id="2045971">1</span><span class="op" id="2045972">)</span><span class="op" id="2045973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045977">return</span>&nbsp;<span class="num" id="2045984">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2045987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2045991">if</span>&nbsp;<span class="ident" id="2045994">n</span>&nbsp;<span class="op" id="2045996">==</span>&nbsp;<span class="num" id="2045999">0</span>&nbsp;<span class="op" id="2046001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046005">return</span>&nbsp;<span class="ident" id="2046012">Y0</span><span class="op" id="2046014">(</span><span class="ident" id="2046015">x</span><span class="op" id="2046016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046022">if</span>&nbsp;<span class="ident" id="2046025">x</span>&nbsp;<span class="op" id="2046027">==</span>&nbsp;<span class="num" id="2046030">0</span>&nbsp;<span class="op" id="2046032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046036">if</span>&nbsp;<span class="ident" id="2046039">n</span>&nbsp;<span class="op" id="2046041">&lt;</span>&nbsp;<span class="num" id="2046043">0</span>&nbsp;<span class="op" id="2046045">&amp;&amp;</span>&nbsp;<span class="ident" id="2046048">n</span><span class="op" id="2046049">&amp;</span><span class="num" id="2046050">1</span>&nbsp;<span class="op" id="2046052">==</span>&nbsp;<span class="num" id="2046055">1</span>&nbsp;<span class="op" id="2046057">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046062">return</span>&nbsp;<span class="ident" id="2046069">Inf</span><span class="op" id="2046072">(</span><span class="num" id="2046073">1</span><span class="op" id="2046074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046082">return</span>&nbsp;<span class="ident" id="2046089">Inf</span><span class="op" id="2046092">(</span><span class="op" id="2046093">-</span><span class="num" id="2046094">1</span><span class="op" id="2046095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046101">sign</span>&nbsp;<span class="op" id="2046106">:=</span>&nbsp;<span class="ident" id="2046109">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046116">if</span>&nbsp;<span class="ident" id="2046119">n</span>&nbsp;<span class="op" id="2046121">&lt;</span>&nbsp;<span class="num" id="2046123">0</span>&nbsp;<span class="op" id="2046125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046129">n</span>&nbsp;<span class="op" id="2046131">=</span>&nbsp;<span class="op" id="2046133">-</span><span class="ident" id="2046134">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046138">if</span>&nbsp;<span class="ident" id="2046141">n</span><span class="op" id="2046142">&amp;</span><span class="num" id="2046143">1</span>&nbsp;<span class="op" id="2046145">==</span>&nbsp;<span class="num" id="2046148">1</span>&nbsp;<span class="op" id="2046150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046155">sign</span>&nbsp;<span class="op" id="2046160">=</span>&nbsp;<span class="ident" id="2046162">true</span>&nbsp;<span class="comment" id="2046167">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046202">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046208">if</span>&nbsp;<span class="ident" id="2046211">n</span>&nbsp;<span class="op" id="2046213">==</span>&nbsp;<span class="num" id="2046216">1</span>&nbsp;<span class="op" id="2046218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046222">if</span>&nbsp;<span class="ident" id="2046225">sign</span>&nbsp;<span class="op" id="2046230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046235">return</span>&nbsp;<span class="op" id="2046242">-</span><span class="ident" id="2046243">Y1</span><span class="op" id="2046245">(</span><span class="ident" id="2046246">x</span><span class="op" id="2046247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046251">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046255">return</span>&nbsp;<span class="ident" id="2046262">Y1</span><span class="op" id="2046264">(</span><span class="ident" id="2046265">x</span><span class="op" id="2046266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046272">var</span>&nbsp;<span class="ident" id="2046276">b</span>&nbsp;<span class="builtintype" id="2046278">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046287">if</span>&nbsp;<span class="ident" id="2046290">x</span>&nbsp;<span class="op" id="2046292">&gt;=</span>&nbsp;<span class="ident" id="2046295">Two302</span>&nbsp;<span class="op" id="2046302">{</span>&nbsp;<span class="comment" id="2046304">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046320">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046337">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046386">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046435">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046468">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046512">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046517">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046554">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046595">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046617">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046640">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046662">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046685">var</span>&nbsp;<span class="ident" id="2046689">temp</span>&nbsp;<span class="builtintype" id="2046694">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046704">switch</span>&nbsp;<span class="ident" id="2046711">n</span>&nbsp;<span class="op" id="2046713">&amp;</span>&nbsp;<span class="num" id="2046715">3</span>&nbsp;<span class="op" id="2046717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046721">case</span>&nbsp;<span class="num" id="2046726">0</span><span class="op" id="2046727">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046732">temp</span>&nbsp;<span class="op" id="2046737">=</span>&nbsp;<span class="ident" id="2046739">Sin</span><span class="op" id="2046742">(</span><span class="ident" id="2046743">x</span><span class="op" id="2046744">)</span>&nbsp;<span class="op" id="2046746">-</span>&nbsp;<span class="ident" id="2046748">Cos</span><span class="op" id="2046751">(</span><span class="ident" id="2046752">x</span><span class="op" id="2046753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046757">case</span>&nbsp;<span class="num" id="2046762">1</span><span class="op" id="2046763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046768">temp</span>&nbsp;<span class="op" id="2046773">=</span>&nbsp;<span class="op" id="2046775">-</span><span class="ident" id="2046776">Sin</span><span class="op" id="2046779">(</span><span class="ident" id="2046780">x</span><span class="op" id="2046781">)</span>&nbsp;<span class="op" id="2046783">-</span>&nbsp;<span class="ident" id="2046785">Cos</span><span class="op" id="2046788">(</span><span class="ident" id="2046789">x</span><span class="op" id="2046790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046794">case</span>&nbsp;<span class="num" id="2046799">2</span><span class="op" id="2046800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046805">temp</span>&nbsp;<span class="op" id="2046810">=</span>&nbsp;<span class="op" id="2046812">-</span><span class="ident" id="2046813">Sin</span><span class="op" id="2046816">(</span><span class="ident" id="2046817">x</span><span class="op" id="2046818">)</span>&nbsp;<span class="op" id="2046820">+</span>&nbsp;<span class="ident" id="2046822">Cos</span><span class="op" id="2046825">(</span><span class="ident" id="2046826">x</span><span class="op" id="2046827">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046831">case</span>&nbsp;<span class="num" id="2046836">3</span><span class="op" id="2046837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046842">temp</span>&nbsp;<span class="op" id="2046847">=</span>&nbsp;<span class="ident" id="2046849">Sin</span><span class="op" id="2046852">(</span><span class="ident" id="2046853">x</span><span class="op" id="2046854">)</span>&nbsp;<span class="op" id="2046856">+</span>&nbsp;<span class="ident" id="2046858">Cos</span><span class="op" id="2046861">(</span><span class="ident" id="2046862">x</span><span class="op" id="2046863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046871">b</span>&nbsp;<span class="op" id="2046873">=</span>&nbsp;<span class="op" id="2046875">(</span><span class="num" id="2046876">1</span>&nbsp;<span class="op" id="2046878">/</span>&nbsp;<span class="ident" id="2046880">SqrtPi</span><span class="op" id="2046886">)</span>&nbsp;<span class="op" id="2046888">*</span>&nbsp;<span class="ident" id="2046890">temp</span>&nbsp;<span class="op" id="2046895">/</span>&nbsp;<span class="ident" id="2046897">Sqrt</span><span class="op" id="2046901">(</span><span class="ident" id="2046902">x</span><span class="op" id="2046903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046906">}</span>&nbsp;<span class="keyword" id="2046908">else</span>&nbsp;<span class="op" id="2046913">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046917">a</span>&nbsp;<span class="op" id="2046919">:=</span>&nbsp;<span class="ident" id="2046922">Y0</span><span class="op" id="2046924">(</span><span class="ident" id="2046925">x</span><span class="op" id="2046926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046930">b</span>&nbsp;<span class="op" id="2046932">=</span>&nbsp;<span class="ident" id="2046934">Y1</span><span class="op" id="2046936">(</span><span class="ident" id="2046937">x</span><span class="op" id="2046938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046942">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046965">for</span>&nbsp;<span class="ident" id="2046969">i</span>&nbsp;<span class="op" id="2046971">:=</span>&nbsp;<span class="num" id="2046974">1</span><span class="op" id="2046975">;</span>&nbsp;<span class="ident" id="2046977">i</span>&nbsp;<span class="op" id="2046979">&lt;</span>&nbsp;<span class="ident" id="2046981">n</span>&nbsp;<span class="op" id="2046983">&amp;&amp;</span>&nbsp;<span class="op" id="2046986">!</span><span class="ident" id="2046987">IsInf</span><span class="op" id="2046992">(</span><span class="ident" id="2046993">b</span><span class="op" id="2046994">,</span>&nbsp;<span class="op" id="2046996">-</span><span class="num" id="2046997">1</span><span class="op" id="2046998">)</span><span class="op" id="2046999">;</span>&nbsp;<span class="ident" id="2047001">i</span><span class="op" id="2047002">++</span>&nbsp;<span class="op" id="2047005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047010">a</span><span class="op" id="2047011">,</span>&nbsp;<span class="ident" id="2047013">b</span>&nbsp;<span class="op" id="2047015">=</span>&nbsp;<span class="ident" id="2047017">b</span><span class="op" id="2047018">,</span>&nbsp;<span class="op" id="2047020">(</span><span class="builtintype" id="2047021">float64</span><span class="op" id="2047028">(</span><span class="ident" id="2047029">i</span><span class="op" id="2047030">+</span><span class="ident" id="2047031">i</span><span class="op" id="2047032">)</span><span class="op" id="2047033">/</span><span class="ident" id="2047034">x</span><span class="op" id="2047035">)</span><span class="op" id="2047036">*</span><span class="ident" id="2047037">b</span><span class="op" id="2047038">-</span><span class="ident" id="2047039">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047049">if</span>&nbsp;<span class="ident" id="2047052">sign</span>&nbsp;<span class="op" id="2047057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047061">return</span>&nbsp;<span class="op" id="2047068">-</span><span class="ident" id="2047069">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047072">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047075">return</span>&nbsp;<span class="ident" id="2047082">b</span><br>
<span class="lineno"></span><span class="op" id="2047084">}</span>
</div>
</body>
</html>
