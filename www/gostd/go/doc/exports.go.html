<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4360944">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4360999">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4361053">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4361104">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;export&nbsp;filtering&nbsp;of&nbsp;an&nbsp;AST.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4361157">package</span>&nbsp;<span class="ident" id="4361165">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4361170">import</span>&nbsp;<span class="op" id="4361177">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4361180">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4361190">&#34;go/token&#34;</span><br>
<span class="lineno"></span><span class="op" id="4361201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4361204">//&nbsp;filterIdentList&nbsp;removes&nbsp;unexported&nbsp;names&nbsp;from&nbsp;list&nbsp;in&nbsp;place</span><br>
<span class="lineno">15</span><span class="comment" id="4361267">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;list.&nbsp;If&nbsp;blankOk&nbsp;is&nbsp;set,&nbsp;blank</span><br>
<span class="lineno"></span><span class="comment" id="4361327">//&nbsp;identifiers&nbsp;are&nbsp;considered&nbsp;exported&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4361373">//</span><br>
<span class="lineno"></span><span class="keyword" id="4361376">func</span>&nbsp;<span class="ident" id="4361381">filterIdentList</span><span class="op" id="4361396">(</span><span class="ident" id="4361397">list</span>&nbsp;<span class="op" id="4361402">[</span><span class="op" id="4361403">]</span><span class="op" id="4361404">*</span><span class="ident" id="4361405">ast</span><span class="op" id="4361408">.</span><span class="ident" id="4361409">Ident</span><span class="op" id="4361414">,</span>&nbsp;<span class="ident" id="4361416">blankOk</span>&nbsp;<span class="builtintype" id="4361424">bool</span><span class="op" id="4361428">)</span>&nbsp;<span class="op" id="4361430">[</span><span class="op" id="4361431">]</span><span class="op" id="4361432">*</span><span class="ident" id="4361433">ast</span><span class="op" id="4361436">.</span><span class="ident" id="4361437">Ident</span>&nbsp;<span class="op" id="4361443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361446">j</span>&nbsp;<span class="op" id="4361448">:=</span>&nbsp;<span class="num" id="4361451">0</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361454">for</span>&nbsp;<span class="ident" id="4361458">_</span><span class="op" id="4361459">,</span>&nbsp;<span class="ident" id="4361461">x</span>&nbsp;<span class="op" id="4361463">:=</span>&nbsp;<span class="keyword" id="4361466">range</span>&nbsp;<span class="ident" id="4361472">list</span>&nbsp;<span class="op" id="4361477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361481">if</span>&nbsp;<span class="ident" id="4361484">ast</span><span class="op" id="4361487">.</span><span class="ident" id="4361488">IsExported</span><span class="op" id="4361498">(</span><span class="ident" id="4361499">x</span><span class="op" id="4361500">.</span><span class="ident" id="4361501">Name</span><span class="op" id="4361505">)</span>&nbsp;<span class="op" id="4361507">||</span>&nbsp;<span class="op" id="4361510">(</span><span class="ident" id="4361511">blankOk</span>&nbsp;<span class="op" id="4361519">&amp;&amp;</span>&nbsp;<span class="ident" id="4361522">x</span><span class="op" id="4361523">.</span><span class="ident" id="4361524">Name</span>&nbsp;<span class="op" id="4361529">==</span>&nbsp;<span class="string" id="4361532">&#34;_&#34;</span><span class="op" id="4361535">)</span>&nbsp;<span class="op" id="4361537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361542">list</span><span class="op" id="4361546">[</span><span class="ident" id="4361547">j</span><span class="op" id="4361548">]</span>&nbsp;<span class="op" id="4361550">=</span>&nbsp;<span class="ident" id="4361552">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361557">j</span><span class="op" id="4361558">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361563">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361569">return</span>&nbsp;<span class="ident" id="4361576">list</span><span class="op" id="4361580">[</span><span class="num" id="4361581">0</span><span class="op" id="4361582">:</span><span class="ident" id="4361583">j</span><span class="op" id="4361584">]</span><br>
<span class="lineno"></span><span class="op" id="4361586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4361589">//&nbsp;removeErrorField&nbsp;removes&nbsp;anonymous&nbsp;fields&nbsp;named&nbsp;&#34;error&#34;&nbsp;from&nbsp;an&nbsp;interface.</span><br>
<span class="lineno">30</span><span class="comment" id="4361667">//&nbsp;This&nbsp;is&nbsp;called&nbsp;when&nbsp;&#34;error&#34;&nbsp;has&nbsp;been&nbsp;determined&nbsp;to&nbsp;be&nbsp;a&nbsp;local&nbsp;name,</span><br>
<span class="lineno"></span><span class="comment" id="4361738">//&nbsp;not&nbsp;the&nbsp;predeclared&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4361767">//</span><br>
<span class="lineno"></span><span class="keyword" id="4361770">func</span>&nbsp;<span class="ident" id="4361775">removeErrorField</span><span class="op" id="4361791">(</span><span class="ident" id="4361792">ityp</span>&nbsp;<span class="op" id="4361797">*</span><span class="ident" id="4361798">ast</span><span class="op" id="4361801">.</span><span class="ident" id="4361802">InterfaceType</span><span class="op" id="4361815">)</span>&nbsp;<span class="op" id="4361817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361820">list</span>&nbsp;<span class="op" id="4361825">:=</span>&nbsp;<span class="ident" id="4361828">ityp</span><span class="op" id="4361832">.</span><span class="ident" id="4361833">Methods</span><span class="op" id="4361840">.</span><span class="ident" id="4361841">List</span>&nbsp;<span class="comment" id="4361846">//&nbsp;we&nbsp;know&nbsp;that&nbsp;ityp.Methods&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361883">j</span>&nbsp;<span class="op" id="4361885">:=</span>&nbsp;<span class="num" id="4361888">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361891">for</span>&nbsp;<span class="ident" id="4361895">_</span><span class="op" id="4361896">,</span>&nbsp;<span class="ident" id="4361898">field</span>&nbsp;<span class="op" id="4361904">:=</span>&nbsp;<span class="keyword" id="4361907">range</span>&nbsp;<span class="ident" id="4361913">list</span>&nbsp;<span class="op" id="4361918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361922">keepField</span>&nbsp;<span class="op" id="4361932">:=</span>&nbsp;<span class="builtintype" id="4361935">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361942">if</span>&nbsp;<span class="ident" id="4361945">n</span>&nbsp;<span class="op" id="4361947">:=</span>&nbsp;<span class="builtinfunc" id="4361950">len</span><span class="op" id="4361953">(</span><span class="ident" id="4361954">field</span><span class="op" id="4361959">.</span><span class="ident" id="4361960">Names</span><span class="op" id="4361965">)</span><span class="op" id="4361966">;</span>&nbsp;<span class="ident" id="4361968">n</span>&nbsp;<span class="op" id="4361970">==</span>&nbsp;<span class="num" id="4361973">0</span>&nbsp;<span class="op" id="4361975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4361980">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362002">if</span>&nbsp;<span class="ident" id="4362005">fname</span><span class="op" id="4362010">,</span>&nbsp;<span class="ident" id="4362012">_</span>&nbsp;<span class="op" id="4362014">:=</span>&nbsp;<span class="ident" id="4362017">baseTypeName</span><span class="op" id="4362029">(</span><span class="ident" id="4362030">field</span><span class="op" id="4362035">.</span><span class="ident" id="4362036">Type</span><span class="op" id="4362040">)</span><span class="op" id="4362041">;</span>&nbsp;<span class="ident" id="4362043">fname</span>&nbsp;<span class="op" id="4362049">==</span>&nbsp;<span class="string" id="4362052">&#34;error&#34;</span>&nbsp;<span class="op" id="4362060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362066">keepField</span>&nbsp;<span class="op" id="4362076">=</span>&nbsp;<span class="builtintype" id="4362078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362095">if</span>&nbsp;<span class="ident" id="4362098">keepField</span>&nbsp;<span class="op" id="4362108">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362113">list</span><span class="op" id="4362117">[</span><span class="ident" id="4362118">j</span><span class="op" id="4362119">]</span>&nbsp;<span class="op" id="4362121">=</span>&nbsp;<span class="ident" id="4362123">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362132">j</span><span class="op" id="4362133">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362144">if</span>&nbsp;<span class="ident" id="4362147">j</span>&nbsp;<span class="op" id="4362149">&lt;</span>&nbsp;<span class="builtinfunc" id="4362151">len</span><span class="op" id="4362154">(</span><span class="ident" id="4362155">list</span><span class="op" id="4362159">)</span>&nbsp;<span class="op" id="4362161">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362165">ityp</span><span class="op" id="4362169">.</span><span class="ident" id="4362170">Incomplete</span>&nbsp;<span class="op" id="4362181">=</span>&nbsp;<span class="builtintype" id="4362183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362192">ityp</span><span class="op" id="4362196">.</span><span class="ident" id="4362197">Methods</span><span class="op" id="4362204">.</span><span class="ident" id="4362205">List</span>&nbsp;<span class="op" id="4362210">=</span>&nbsp;<span class="ident" id="4362212">list</span><span class="op" id="4362216">[</span><span class="num" id="4362217">0</span><span class="op" id="4362218">:</span><span class="ident" id="4362219">j</span><span class="op" id="4362220">]</span><br>
<span class="lineno"></span><span class="op" id="4362222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4362225">//&nbsp;filterFieldList&nbsp;removes&nbsp;unexported&nbsp;fields&nbsp;(field&nbsp;names)&nbsp;from&nbsp;the&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span><span class="comment" id="4362304">//&nbsp;in&nbsp;place&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;fields&nbsp;were&nbsp;removed.&nbsp;Anonymous&nbsp;fields&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4362378">//&nbsp;recorded&nbsp;with&nbsp;the&nbsp;parent&nbsp;type.&nbsp;filterType&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;types&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4362451">//&nbsp;all&nbsp;remaining&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="4362476">//</span><br>
<span class="lineno">60</span><span class="keyword" id="4362479">func</span>&nbsp;<span class="op" id="4362484">(</span><span class="ident" id="4362485">r</span>&nbsp;<span class="op" id="4362487">*</span><span class="ident" id="4362488">reader</span><span class="op" id="4362494">)</span>&nbsp;<span class="ident" id="4362496">filterFieldList</span><span class="op" id="4362511">(</span><span class="ident" id="4362512">parent</span>&nbsp;<span class="op" id="4362519">*</span><span class="ident" id="4362520">namedType</span><span class="op" id="4362529">,</span>&nbsp;<span class="ident" id="4362531">fields</span>&nbsp;<span class="op" id="4362538">*</span><span class="ident" id="4362539">ast</span><span class="op" id="4362542">.</span><span class="ident" id="4362543">FieldList</span><span class="op" id="4362552">,</span>&nbsp;<span class="ident" id="4362554">ityp</span>&nbsp;<span class="op" id="4362559">*</span><span class="ident" id="4362560">ast</span><span class="op" id="4362563">.</span><span class="ident" id="4362564">InterfaceType</span><span class="op" id="4362577">)</span>&nbsp;<span class="op" id="4362579">(</span><span class="ident" id="4362580">removedFields</span>&nbsp;<span class="builtintype" id="4362594">bool</span><span class="op" id="4362598">)</span>&nbsp;<span class="op" id="4362600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362603">if</span>&nbsp;<span class="ident" id="4362606">fields</span>&nbsp;<span class="op" id="4362613">==</span>&nbsp;<span class="ident" id="4362616">nil</span>&nbsp;<span class="op" id="4362620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362624">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362635">list</span>&nbsp;<span class="op" id="4362640">:=</span>&nbsp;<span class="ident" id="4362643">fields</span><span class="op" id="4362649">.</span><span class="ident" id="4362650">List</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362656">j</span>&nbsp;<span class="op" id="4362658">:=</span>&nbsp;<span class="num" id="4362661">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362664">for</span>&nbsp;<span class="ident" id="4362668">_</span><span class="op" id="4362669">,</span>&nbsp;<span class="ident" id="4362671">field</span>&nbsp;<span class="op" id="4362677">:=</span>&nbsp;<span class="keyword" id="4362680">range</span>&nbsp;<span class="ident" id="4362686">list</span>&nbsp;<span class="op" id="4362691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362695">keepField</span>&nbsp;<span class="op" id="4362705">:=</span>&nbsp;<span class="builtintype" id="4362708">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362716">if</span>&nbsp;<span class="ident" id="4362719">n</span>&nbsp;<span class="op" id="4362721">:=</span>&nbsp;<span class="builtinfunc" id="4362724">len</span><span class="op" id="4362727">(</span><span class="ident" id="4362728">field</span><span class="op" id="4362733">.</span><span class="ident" id="4362734">Names</span><span class="op" id="4362739">)</span><span class="op" id="4362740">;</span>&nbsp;<span class="ident" id="4362742">n</span>&nbsp;<span class="op" id="4362744">==</span>&nbsp;<span class="num" id="4362747">0</span>&nbsp;<span class="op" id="4362749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4362754">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362776">fname</span>&nbsp;<span class="op" id="4362782">:=</span>&nbsp;<span class="ident" id="4362785">r</span><span class="op" id="4362786">.</span><span class="ident" id="4362787">recordAnonymousField</span><span class="op" id="4362807">(</span><span class="ident" id="4362808">parent</span><span class="op" id="4362814">,</span>&nbsp;<span class="ident" id="4362816">field</span><span class="op" id="4362821">.</span><span class="ident" id="4362822">Type</span><span class="op" id="4362826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362831">if</span>&nbsp;<span class="ident" id="4362834">ast</span><span class="op" id="4362837">.</span><span class="ident" id="4362838">IsExported</span><span class="op" id="4362848">(</span><span class="ident" id="4362849">fname</span><span class="op" id="4362854">)</span>&nbsp;<span class="op" id="4362856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362862">keepField</span>&nbsp;<span class="op" id="4362872">=</span>&nbsp;<span class="builtintype" id="4362874">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362882">}</span>&nbsp;<span class="keyword" id="4362884">else</span>&nbsp;<span class="keyword" id="4362889">if</span>&nbsp;<span class="ident" id="4362892">ityp</span>&nbsp;<span class="op" id="4362897">!=</span>&nbsp;<span class="ident" id="4362900">nil</span>&nbsp;<span class="op" id="4362904">&amp;&amp;</span>&nbsp;<span class="ident" id="4362907">fname</span>&nbsp;<span class="op" id="4362913">==</span>&nbsp;<span class="string" id="4362916">&#34;error&#34;</span>&nbsp;<span class="op" id="4362924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4362930">//&nbsp;possibly&nbsp;the&nbsp;predeclared&nbsp;error&nbsp;interface;&nbsp;keep</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4362984">//&nbsp;it&nbsp;for&nbsp;now&nbsp;but&nbsp;remember&nbsp;this&nbsp;interface&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363038">//&nbsp;it&nbsp;can&nbsp;be&nbsp;fixed&nbsp;if&nbsp;error&nbsp;is&nbsp;also&nbsp;defined&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363094">keepField</span>&nbsp;<span class="op" id="4363104">=</span>&nbsp;<span class="builtintype" id="4363106">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363115">r</span><span class="op" id="4363116">.</span><span class="ident" id="4363117">remember</span><span class="op" id="4363125">(</span><span class="ident" id="4363126">ityp</span><span class="op" id="4363130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363135">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363139">}</span>&nbsp;<span class="keyword" id="4363141">else</span>&nbsp;<span class="op" id="4363146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363151">field</span><span class="op" id="4363156">.</span><span class="ident" id="4363157">Names</span>&nbsp;<span class="op" id="4363163">=</span>&nbsp;<span class="ident" id="4363165">filterIdentList</span><span class="op" id="4363180">(</span><span class="ident" id="4363181">field</span><span class="op" id="4363186">.</span><span class="ident" id="4363187">Names</span><span class="op" id="4363192">,</span>&nbsp;<span class="builtintype" id="4363194">false</span><span class="op" id="4363199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363204">if</span>&nbsp;<span class="builtinfunc" id="4363207">len</span><span class="op" id="4363210">(</span><span class="ident" id="4363211">field</span><span class="op" id="4363216">.</span><span class="ident" id="4363217">Names</span><span class="op" id="4363222">)</span>&nbsp;<span class="op" id="4363224">&lt;</span>&nbsp;<span class="ident" id="4363226">n</span>&nbsp;<span class="op" id="4363228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363234">removedFields</span>&nbsp;<span class="op" id="4363248">=</span>&nbsp;<span class="builtintype" id="4363250">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363258">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363263">if</span>&nbsp;<span class="builtinfunc" id="4363266">len</span><span class="op" id="4363269">(</span><span class="ident" id="4363270">field</span><span class="op" id="4363275">.</span><span class="ident" id="4363276">Names</span><span class="op" id="4363281">)</span>&nbsp;<span class="op" id="4363283">&gt;</span>&nbsp;<span class="num" id="4363285">0</span>&nbsp;<span class="op" id="4363287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363293">keepField</span>&nbsp;<span class="op" id="4363303">=</span>&nbsp;<span class="builtintype" id="4363305">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363321">if</span>&nbsp;<span class="ident" id="4363324">keepField</span>&nbsp;<span class="op" id="4363334">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363339">r</span><span class="op" id="4363340">.</span><span class="ident" id="4363341">filterType</span><span class="op" id="4363351">(</span><span class="ident" id="4363352">nil</span><span class="op" id="4363355">,</span>&nbsp;<span class="ident" id="4363357">field</span><span class="op" id="4363362">.</span><span class="ident" id="4363363">Type</span><span class="op" id="4363367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363372">list</span><span class="op" id="4363376">[</span><span class="ident" id="4363377">j</span><span class="op" id="4363378">]</span>&nbsp;<span class="op" id="4363380">=</span>&nbsp;<span class="ident" id="4363382">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363391">j</span><span class="op" id="4363392">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363400">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363403">if</span>&nbsp;<span class="ident" id="4363406">j</span>&nbsp;<span class="op" id="4363408">&lt;</span>&nbsp;<span class="builtinfunc" id="4363410">len</span><span class="op" id="4363413">(</span><span class="ident" id="4363414">list</span><span class="op" id="4363418">)</span>&nbsp;<span class="op" id="4363420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363424">removedFields</span>&nbsp;<span class="op" id="4363438">=</span>&nbsp;<span class="builtintype" id="4363440">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363449">fields</span><span class="op" id="4363455">.</span><span class="ident" id="4363456">List</span>&nbsp;<span class="op" id="4363461">=</span>&nbsp;<span class="ident" id="4363463">list</span><span class="op" id="4363467">[</span><span class="num" id="4363468">0</span><span class="op" id="4363469">:</span><span class="ident" id="4363470">j</span><span class="op" id="4363471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363474">return</span><br>
<span class="lineno">100</span><span class="op" id="4363481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4363484">//&nbsp;filterParamList&nbsp;applies&nbsp;filterType&nbsp;to&nbsp;each&nbsp;parameter&nbsp;type&nbsp;in&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="4363556">//</span><br>
<span class="lineno"></span><span class="keyword" id="4363559">func</span>&nbsp;<span class="op" id="4363564">(</span><span class="ident" id="4363565">r</span>&nbsp;<span class="op" id="4363567">*</span><span class="ident" id="4363568">reader</span><span class="op" id="4363574">)</span>&nbsp;<span class="ident" id="4363576">filterParamList</span><span class="op" id="4363591">(</span><span class="ident" id="4363592">fields</span>&nbsp;<span class="op" id="4363599">*</span><span class="ident" id="4363600">ast</span><span class="op" id="4363603">.</span><span class="ident" id="4363604">FieldList</span><span class="op" id="4363613">)</span>&nbsp;<span class="op" id="4363615">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363618">if</span>&nbsp;<span class="ident" id="4363621">fields</span>&nbsp;<span class="op" id="4363628">!=</span>&nbsp;<span class="ident" id="4363631">nil</span>&nbsp;<span class="op" id="4363635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363639">for</span>&nbsp;<span class="ident" id="4363643">_</span><span class="op" id="4363644">,</span>&nbsp;<span class="ident" id="4363646">f</span>&nbsp;<span class="op" id="4363648">:=</span>&nbsp;<span class="keyword" id="4363651">range</span>&nbsp;<span class="ident" id="4363657">fields</span><span class="op" id="4363663">.</span><span class="ident" id="4363664">List</span>&nbsp;<span class="op" id="4363669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363674">r</span><span class="op" id="4363675">.</span><span class="ident" id="4363676">filterType</span><span class="op" id="4363686">(</span><span class="ident" id="4363687">nil</span><span class="op" id="4363690">,</span>&nbsp;<span class="ident" id="4363692">f</span><span class="op" id="4363693">.</span><span class="ident" id="4363694">Type</span><span class="op" id="4363698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363705">}</span><br>
<span class="lineno">110</span><span class="op" id="4363707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4363710">//&nbsp;filterType&nbsp;strips&nbsp;any&nbsp;unexported&nbsp;struct&nbsp;fields&nbsp;or&nbsp;method&nbsp;types&nbsp;from&nbsp;typ</span><br>
<span class="lineno"></span><span class="comment" id="4363785">//&nbsp;in&nbsp;place.&nbsp;If&nbsp;fields&nbsp;(or&nbsp;methods)&nbsp;have&nbsp;been&nbsp;removed,&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="4363858">//&nbsp;struct&nbsp;or&nbsp;interface&nbsp;type&nbsp;has&nbsp;the&nbsp;Incomplete&nbsp;field&nbsp;set&nbsp;to&nbsp;true.</span><br>
<span class="lineno">115</span><span class="comment" id="4363924">//</span><br>
<span class="lineno"></span><span class="keyword" id="4363927">func</span>&nbsp;<span class="op" id="4363932">(</span><span class="ident" id="4363933">r</span>&nbsp;<span class="op" id="4363935">*</span><span class="ident" id="4363936">reader</span><span class="op" id="4363942">)</span>&nbsp;<span class="ident" id="4363944">filterType</span><span class="op" id="4363954">(</span><span class="ident" id="4363955">parent</span>&nbsp;<span class="op" id="4363962">*</span><span class="ident" id="4363963">namedType</span><span class="op" id="4363972">,</span>&nbsp;<span class="ident" id="4363974">typ</span>&nbsp;<span class="ident" id="4363978">ast</span><span class="op" id="4363981">.</span><span class="ident" id="4363982">Expr</span><span class="op" id="4363986">)</span>&nbsp;<span class="op" id="4363988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363991">switch</span>&nbsp;<span class="ident" id="4363998">t</span>&nbsp;<span class="op" id="4364000">:=</span>&nbsp;<span class="ident" id="4364003">typ</span><span class="op" id="4364006">.</span><span class="op" id="4364007">(</span><span class="keyword" id="4364008">type</span><span class="op" id="4364012">)</span>&nbsp;<span class="op" id="4364014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364017">case</span>&nbsp;<span class="op" id="4364022">*</span><span class="ident" id="4364023">ast</span><span class="op" id="4364026">.</span><span class="ident" id="4364027">Ident</span><span class="op" id="4364032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364036">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364054">case</span>&nbsp;<span class="op" id="4364059">*</span><span class="ident" id="4364060">ast</span><span class="op" id="4364063">.</span><span class="ident" id="4364064">ParenExpr</span><span class="op" id="4364073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364077">r</span><span class="op" id="4364078">.</span><span class="ident" id="4364079">filterType</span><span class="op" id="4364089">(</span><span class="ident" id="4364090">nil</span><span class="op" id="4364093">,</span>&nbsp;<span class="ident" id="4364095">t</span><span class="op" id="4364096">.</span><span class="ident" id="4364097">X</span><span class="op" id="4364098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364101">case</span>&nbsp;<span class="op" id="4364106">*</span><span class="ident" id="4364107">ast</span><span class="op" id="4364110">.</span><span class="ident" id="4364111">ArrayType</span><span class="op" id="4364120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364124">r</span><span class="op" id="4364125">.</span><span class="ident" id="4364126">filterType</span><span class="op" id="4364136">(</span><span class="ident" id="4364137">nil</span><span class="op" id="4364140">,</span>&nbsp;<span class="ident" id="4364142">t</span><span class="op" id="4364143">.</span><span class="ident" id="4364144">Elt</span><span class="op" id="4364147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364150">case</span>&nbsp;<span class="op" id="4364155">*</span><span class="ident" id="4364156">ast</span><span class="op" id="4364159">.</span><span class="ident" id="4364160">StructType</span><span class="op" id="4364170">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364174">if</span>&nbsp;<span class="ident" id="4364177">r</span><span class="op" id="4364178">.</span><span class="ident" id="4364179">filterFieldList</span><span class="op" id="4364194">(</span><span class="ident" id="4364195">parent</span><span class="op" id="4364201">,</span>&nbsp;<span class="ident" id="4364203">t</span><span class="op" id="4364204">.</span><span class="ident" id="4364205">Fields</span><span class="op" id="4364211">,</span>&nbsp;<span class="ident" id="4364213">nil</span><span class="op" id="4364216">)</span>&nbsp;<span class="op" id="4364218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364223">t</span><span class="op" id="4364224">.</span><span class="ident" id="4364225">Incomplete</span>&nbsp;<span class="op" id="4364236">=</span>&nbsp;<span class="builtintype" id="4364238">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364248">case</span>&nbsp;<span class="op" id="4364253">*</span><span class="ident" id="4364254">ast</span><span class="op" id="4364257">.</span><span class="ident" id="4364258">FuncType</span><span class="op" id="4364266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364270">r</span><span class="op" id="4364271">.</span><span class="ident" id="4364272">filterParamList</span><span class="op" id="4364287">(</span><span class="ident" id="4364288">t</span><span class="op" id="4364289">.</span><span class="ident" id="4364290">Params</span><span class="op" id="4364296">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364300">r</span><span class="op" id="4364301">.</span><span class="ident" id="4364302">filterParamList</span><span class="op" id="4364317">(</span><span class="ident" id="4364318">t</span><span class="op" id="4364319">.</span><span class="ident" id="4364320">Results</span><span class="op" id="4364327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364330">case</span>&nbsp;<span class="op" id="4364335">*</span><span class="ident" id="4364336">ast</span><span class="op" id="4364339">.</span><span class="ident" id="4364340">InterfaceType</span><span class="op" id="4364353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364357">if</span>&nbsp;<span class="ident" id="4364360">r</span><span class="op" id="4364361">.</span><span class="ident" id="4364362">filterFieldList</span><span class="op" id="4364377">(</span><span class="ident" id="4364378">parent</span><span class="op" id="4364384">,</span>&nbsp;<span class="ident" id="4364386">t</span><span class="op" id="4364387">.</span><span class="ident" id="4364388">Methods</span><span class="op" id="4364395">,</span>&nbsp;<span class="ident" id="4364397">t</span><span class="op" id="4364398">)</span>&nbsp;<span class="op" id="4364400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364405">t</span><span class="op" id="4364406">.</span><span class="ident" id="4364407">Incomplete</span>&nbsp;<span class="op" id="4364418">=</span>&nbsp;<span class="builtintype" id="4364420">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364427">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364430">case</span>&nbsp;<span class="op" id="4364435">*</span><span class="ident" id="4364436">ast</span><span class="op" id="4364439">.</span><span class="ident" id="4364440">MapType</span><span class="op" id="4364447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364451">r</span><span class="op" id="4364452">.</span><span class="ident" id="4364453">filterType</span><span class="op" id="4364463">(</span><span class="ident" id="4364464">nil</span><span class="op" id="4364467">,</span>&nbsp;<span class="ident" id="4364469">t</span><span class="op" id="4364470">.</span><span class="ident" id="4364471">Key</span><span class="op" id="4364474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364478">r</span><span class="op" id="4364479">.</span><span class="ident" id="4364480">filterType</span><span class="op" id="4364490">(</span><span class="ident" id="4364491">nil</span><span class="op" id="4364494">,</span>&nbsp;<span class="ident" id="4364496">t</span><span class="op" id="4364497">.</span><span class="ident" id="4364498">Value</span><span class="op" id="4364503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364506">case</span>&nbsp;<span class="op" id="4364511">*</span><span class="ident" id="4364512">ast</span><span class="op" id="4364515">.</span><span class="ident" id="4364516">ChanType</span><span class="op" id="4364524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364528">r</span><span class="op" id="4364529">.</span><span class="ident" id="4364530">filterType</span><span class="op" id="4364540">(</span><span class="ident" id="4364541">nil</span><span class="op" id="4364544">,</span>&nbsp;<span class="ident" id="4364546">t</span><span class="op" id="4364547">.</span><span class="ident" id="4364548">Value</span><span class="op" id="4364553">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364556">}</span><br>
<span class="lineno"></span><span class="op" id="4364558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4364561">func</span>&nbsp;<span class="op" id="4364566">(</span><span class="ident" id="4364567">r</span>&nbsp;<span class="op" id="4364569">*</span><span class="ident" id="4364570">reader</span><span class="op" id="4364576">)</span>&nbsp;<span class="ident" id="4364578">filterSpec</span><span class="op" id="4364588">(</span><span class="ident" id="4364589">spec</span>&nbsp;<span class="ident" id="4364594">ast</span><span class="op" id="4364597">.</span><span class="ident" id="4364598">Spec</span><span class="op" id="4364602">,</span>&nbsp;<span class="ident" id="4364604">tok</span>&nbsp;<span class="ident" id="4364608">token</span><span class="op" id="4364613">.</span><span class="ident" id="4364614">Token</span><span class="op" id="4364619">)</span>&nbsp;<span class="builtintype" id="4364621">bool</span>&nbsp;<span class="op" id="4364626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364629">switch</span>&nbsp;<span class="ident" id="4364636">s</span>&nbsp;<span class="op" id="4364638">:=</span>&nbsp;<span class="ident" id="4364641">spec</span><span class="op" id="4364645">.</span><span class="op" id="4364646">(</span><span class="keyword" id="4364647">type</span><span class="op" id="4364651">)</span>&nbsp;<span class="op" id="4364653">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364656">case</span>&nbsp;<span class="op" id="4364661">*</span><span class="ident" id="4364662">ast</span><span class="op" id="4364665">.</span><span class="ident" id="4364666">ImportSpec</span><span class="op" id="4364676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364680">//&nbsp;always&nbsp;keep&nbsp;imports&nbsp;so&nbsp;we&nbsp;can&nbsp;collect&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364728">return</span>&nbsp;<span class="builtintype" id="4364735">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364741">case</span>&nbsp;<span class="op" id="4364746">*</span><span class="ident" id="4364747">ast</span><span class="op" id="4364750">.</span><span class="ident" id="4364751">ValueSpec</span><span class="op" id="4364760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364764">//&nbsp;special&nbsp;case:&nbsp;consider&nbsp;blank&nbsp;constants&nbsp;as&nbsp;exported</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364820">//&nbsp;(work-around&nbsp;for&nbsp;issue&nbsp;5397)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364854">s</span><span class="op" id="4364855">.</span><span class="ident" id="4364856">Names</span>&nbsp;<span class="op" id="4364862">=</span>&nbsp;<span class="ident" id="4364864">filterIdentList</span><span class="op" id="4364879">(</span><span class="ident" id="4364880">s</span><span class="op" id="4364881">.</span><span class="ident" id="4364882">Names</span><span class="op" id="4364887">,</span>&nbsp;<span class="ident" id="4364889">tok</span>&nbsp;<span class="op" id="4364893">==</span>&nbsp;<span class="ident" id="4364896">token</span><span class="op" id="4364901">.</span><span class="ident" id="4364902">CONST</span><span class="op" id="4364907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364911">if</span>&nbsp;<span class="builtinfunc" id="4364914">len</span><span class="op" id="4364917">(</span><span class="ident" id="4364918">s</span><span class="op" id="4364919">.</span><span class="ident" id="4364920">Names</span><span class="op" id="4364925">)</span>&nbsp;<span class="op" id="4364927">&gt;</span>&nbsp;<span class="num" id="4364929">0</span>&nbsp;<span class="op" id="4364931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364936">r</span><span class="op" id="4364937">.</span><span class="ident" id="4364938">filterType</span><span class="op" id="4364948">(</span><span class="ident" id="4364949">nil</span><span class="op" id="4364952">,</span>&nbsp;<span class="ident" id="4364954">s</span><span class="op" id="4364955">.</span><span class="ident" id="4364956">Type</span><span class="op" id="4364960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364965">return</span>&nbsp;<span class="builtintype" id="4364972">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364982">case</span>&nbsp;<span class="op" id="4364987">*</span><span class="ident" id="4364988">ast</span><span class="op" id="4364991">.</span><span class="ident" id="4364992">TypeSpec</span><span class="op" id="4365000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365004">if</span>&nbsp;<span class="ident" id="4365007">name</span>&nbsp;<span class="op" id="4365012">:=</span>&nbsp;<span class="ident" id="4365015">s</span><span class="op" id="4365016">.</span><span class="ident" id="4365017">Name</span><span class="op" id="4365021">.</span><span class="ident" id="4365022">Name</span><span class="op" id="4365026">;</span>&nbsp;<span class="ident" id="4365028">ast</span><span class="op" id="4365031">.</span><span class="ident" id="4365032">IsExported</span><span class="op" id="4365042">(</span><span class="ident" id="4365043">name</span><span class="op" id="4365047">)</span>&nbsp;<span class="op" id="4365049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365054">r</span><span class="op" id="4365055">.</span><span class="ident" id="4365056">filterType</span><span class="op" id="4365066">(</span><span class="ident" id="4365067">r</span><span class="op" id="4365068">.</span><span class="ident" id="4365069">lookupType</span><span class="op" id="4365079">(</span><span class="ident" id="4365080">s</span><span class="op" id="4365081">.</span><span class="ident" id="4365082">Name</span><span class="op" id="4365086">.</span><span class="ident" id="4365087">Name</span><span class="op" id="4365091">)</span><span class="op" id="4365092">,</span>&nbsp;<span class="ident" id="4365094">s</span><span class="op" id="4365095">.</span><span class="ident" id="4365096">Type</span><span class="op" id="4365100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365105">return</span>&nbsp;<span class="builtintype" id="4365112">true</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365119">}</span>&nbsp;<span class="keyword" id="4365121">else</span>&nbsp;<span class="keyword" id="4365126">if</span>&nbsp;<span class="ident" id="4365129">name</span>&nbsp;<span class="op" id="4365134">==</span>&nbsp;<span class="string" id="4365137">&#34;error&#34;</span>&nbsp;<span class="op" id="4365145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365150">//&nbsp;special&nbsp;case:&nbsp;remember&nbsp;that&nbsp;error&nbsp;is&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365210">r</span><span class="op" id="4365211">.</span><span class="ident" id="4365212">errorDecl</span>&nbsp;<span class="op" id="4365222">=</span>&nbsp;<span class="builtintype" id="4365224">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365234">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365237">return</span>&nbsp;<span class="builtintype" id="4365244">false</span><br>
<span class="lineno"></span><span class="op" id="4365250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4365253">func</span>&nbsp;<span class="op" id="4365258">(</span><span class="ident" id="4365259">r</span>&nbsp;<span class="op" id="4365261">*</span><span class="ident" id="4365262">reader</span><span class="op" id="4365268">)</span>&nbsp;<span class="ident" id="4365270">filterSpecList</span><span class="op" id="4365284">(</span><span class="ident" id="4365285">list</span>&nbsp;<span class="op" id="4365290">[</span><span class="op" id="4365291">]</span><span class="ident" id="4365292">ast</span><span class="op" id="4365295">.</span><span class="ident" id="4365296">Spec</span><span class="op" id="4365300">,</span>&nbsp;<span class="ident" id="4365302">tok</span>&nbsp;<span class="ident" id="4365306">token</span><span class="op" id="4365311">.</span><span class="ident" id="4365312">Token</span><span class="op" id="4365317">)</span>&nbsp;<span class="op" id="4365319">[</span><span class="op" id="4365320">]</span><span class="ident" id="4365321">ast</span><span class="op" id="4365324">.</span><span class="ident" id="4365325">Spec</span>&nbsp;<span class="op" id="4365330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365333">j</span>&nbsp;<span class="op" id="4365335">:=</span>&nbsp;<span class="num" id="4365338">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365341">for</span>&nbsp;<span class="ident" id="4365345">_</span><span class="op" id="4365346">,</span>&nbsp;<span class="ident" id="4365348">s</span>&nbsp;<span class="op" id="4365350">:=</span>&nbsp;<span class="keyword" id="4365353">range</span>&nbsp;<span class="ident" id="4365359">list</span>&nbsp;<span class="op" id="4365364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365368">if</span>&nbsp;<span class="ident" id="4365371">r</span><span class="op" id="4365372">.</span><span class="ident" id="4365373">filterSpec</span><span class="op" id="4365383">(</span><span class="ident" id="4365384">s</span><span class="op" id="4365385">,</span>&nbsp;<span class="ident" id="4365387">tok</span><span class="op" id="4365390">)</span>&nbsp;<span class="op" id="4365392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365397">list</span><span class="op" id="4365401">[</span><span class="ident" id="4365402">j</span><span class="op" id="4365403">]</span>&nbsp;<span class="op" id="4365405">=</span>&nbsp;<span class="ident" id="4365407">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365412">j</span><span class="op" id="4365413">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365418">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365424">return</span>&nbsp;<span class="ident" id="4365431">list</span><span class="op" id="4365435">[</span><span class="num" id="4365436">0</span><span class="op" id="4365437">:</span><span class="ident" id="4365438">j</span><span class="op" id="4365439">]</span><br>
<span class="lineno"></span><span class="op" id="4365441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4365444">func</span>&nbsp;<span class="op" id="4365449">(</span><span class="ident" id="4365450">r</span>&nbsp;<span class="op" id="4365452">*</span><span class="ident" id="4365453">reader</span><span class="op" id="4365459">)</span>&nbsp;<span class="ident" id="4365461">filterDecl</span><span class="op" id="4365471">(</span><span class="ident" id="4365472">decl</span>&nbsp;<span class="ident" id="4365477">ast</span><span class="op" id="4365480">.</span><span class="ident" id="4365481">Decl</span><span class="op" id="4365485">)</span>&nbsp;<span class="builtintype" id="4365487">bool</span>&nbsp;<span class="op" id="4365492">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365495">switch</span>&nbsp;<span class="ident" id="4365502">d</span>&nbsp;<span class="op" id="4365504">:=</span>&nbsp;<span class="ident" id="4365507">decl</span><span class="op" id="4365511">.</span><span class="op" id="4365512">(</span><span class="keyword" id="4365513">type</span><span class="op" id="4365517">)</span>&nbsp;<span class="op" id="4365519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365522">case</span>&nbsp;<span class="op" id="4365527">*</span><span class="ident" id="4365528">ast</span><span class="op" id="4365531">.</span><span class="ident" id="4365532">GenDecl</span><span class="op" id="4365539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365543">d</span><span class="op" id="4365544">.</span><span class="ident" id="4365545">Specs</span>&nbsp;<span class="op" id="4365551">=</span>&nbsp;<span class="ident" id="4365553">r</span><span class="op" id="4365554">.</span><span class="ident" id="4365555">filterSpecList</span><span class="op" id="4365569">(</span><span class="ident" id="4365570">d</span><span class="op" id="4365571">.</span><span class="ident" id="4365572">Specs</span><span class="op" id="4365577">,</span>&nbsp;<span class="ident" id="4365579">d</span><span class="op" id="4365580">.</span><span class="ident" id="4365581">Tok</span><span class="op" id="4365584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365588">return</span>&nbsp;<span class="builtinfunc" id="4365595">len</span><span class="op" id="4365598">(</span><span class="ident" id="4365599">d</span><span class="op" id="4365600">.</span><span class="ident" id="4365601">Specs</span><span class="op" id="4365606">)</span>&nbsp;<span class="op" id="4365608">&gt;</span>&nbsp;<span class="num" id="4365610">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365613">case</span>&nbsp;<span class="op" id="4365618">*</span><span class="ident" id="4365619">ast</span><span class="op" id="4365622">.</span><span class="ident" id="4365623">FuncDecl</span><span class="op" id="4365631">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365635">//&nbsp;ok&nbsp;to&nbsp;filter&nbsp;these&nbsp;methods&nbsp;early&nbsp;because&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365685">//&nbsp;conflicting&nbsp;method&nbsp;will&nbsp;be&nbsp;filtered&nbsp;here,&nbsp;too&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365738">//&nbsp;thus,&nbsp;removing&nbsp;these&nbsp;methods&nbsp;early&nbsp;will&nbsp;not&nbsp;lead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365792">//&nbsp;to&nbsp;the&nbsp;false&nbsp;removal&nbsp;of&nbsp;possible&nbsp;conflicts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365840">return</span>&nbsp;<span class="ident" id="4365847">ast</span><span class="op" id="4365850">.</span><span class="ident" id="4365851">IsExported</span><span class="op" id="4365861">(</span><span class="ident" id="4365862">d</span><span class="op" id="4365863">.</span><span class="ident" id="4365864">Name</span><span class="op" id="4365868">.</span><span class="ident" id="4365869">Name</span><span class="op" id="4365873">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365879">return</span>&nbsp;<span class="builtintype" id="4365886">false</span><br>
<span class="lineno"></span><span class="op" id="4365892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4365895">//&nbsp;fileExports&nbsp;removes&nbsp;unexported&nbsp;declarations&nbsp;from&nbsp;src&nbsp;in&nbsp;place.</span><br>
<span class="lineno">195</span><span class="comment" id="4365961">//</span><br>
<span class="lineno"></span><span class="keyword" id="4365964">func</span>&nbsp;<span class="op" id="4365969">(</span><span class="ident" id="4365970">r</span>&nbsp;<span class="op" id="4365972">*</span><span class="ident" id="4365973">reader</span><span class="op" id="4365979">)</span>&nbsp;<span class="ident" id="4365981">fileExports</span><span class="op" id="4365992">(</span><span class="ident" id="4365993">src</span>&nbsp;<span class="op" id="4365997">*</span><span class="ident" id="4365998">ast</span><span class="op" id="4366001">.</span><span class="ident" id="4366002">File</span><span class="op" id="4366006">)</span>&nbsp;<span class="op" id="4366008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366011">j</span>&nbsp;<span class="op" id="4366013">:=</span>&nbsp;<span class="num" id="4366016">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366019">for</span>&nbsp;<span class="ident" id="4366023">_</span><span class="op" id="4366024">,</span>&nbsp;<span class="ident" id="4366026">d</span>&nbsp;<span class="op" id="4366028">:=</span>&nbsp;<span class="keyword" id="4366031">range</span>&nbsp;<span class="ident" id="4366037">src</span><span class="op" id="4366040">.</span><span class="ident" id="4366041">Decls</span>&nbsp;<span class="op" id="4366047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366051">if</span>&nbsp;<span class="ident" id="4366054">r</span><span class="op" id="4366055">.</span><span class="ident" id="4366056">filterDecl</span><span class="op" id="4366066">(</span><span class="ident" id="4366067">d</span><span class="op" id="4366068">)</span>&nbsp;<span class="op" id="4366070">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366075">src</span><span class="op" id="4366078">.</span><span class="ident" id="4366079">Decls</span><span class="op" id="4366084">[</span><span class="ident" id="4366085">j</span><span class="op" id="4366086">]</span>&nbsp;<span class="op" id="4366088">=</span>&nbsp;<span class="ident" id="4366090">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366095">j</span><span class="op" id="4366096">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366107">src</span><span class="op" id="4366110">.</span><span class="ident" id="4366111">Decls</span>&nbsp;<span class="op" id="4366117">=</span>&nbsp;<span class="ident" id="4366119">src</span><span class="op" id="4366122">.</span><span class="ident" id="4366123">Decls</span><span class="op" id="4366128">[</span><span class="num" id="4366129">0</span><span class="op" id="4366130">:</span><span class="ident" id="4366131">j</span><span class="op" id="4366132">]</span><br>
<span class="lineno">205</span><span class="op" id="4366134">}</span>
</div>
</body>
</html>
