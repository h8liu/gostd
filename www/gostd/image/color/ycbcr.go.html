<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2954126">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2954181">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2954235">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2954286">package</span>&nbsp;<span class="ident" id="2954294">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2954301">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="2954358">func</span>&nbsp;<span class="ident" id="2954363">RGBToYCbCr</span><span class="op" id="2954373">(</span><span class="ident" id="2954374">r</span><span class="op" id="2954375">,</span>&nbsp;<span class="ident" id="2954377">g</span><span class="op" id="2954378">,</span>&nbsp;<span class="ident" id="2954380">b</span>&nbsp;<span class="builtintype" id="2954382">uint8</span><span class="op" id="2954387">)</span>&nbsp;<span class="op" id="2954389">(</span><span class="builtintype" id="2954390">uint8</span><span class="op" id="2954395">,</span>&nbsp;<span class="builtintype" id="2954397">uint8</span><span class="op" id="2954402">,</span>&nbsp;<span class="builtintype" id="2954404">uint8</span><span class="op" id="2954409">)</span>&nbsp;<span class="op" id="2954411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2954414">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2954447">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2954488">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2954535">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2954582">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954649">r1</span>&nbsp;<span class="op" id="2954652">:=</span>&nbsp;<span class="builtintype" id="2954655">int</span><span class="op" id="2954658">(</span><span class="ident" id="2954659">r</span><span class="op" id="2954660">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954663">g1</span>&nbsp;<span class="op" id="2954666">:=</span>&nbsp;<span class="builtintype" id="2954669">int</span><span class="op" id="2954672">(</span><span class="ident" id="2954673">g</span><span class="op" id="2954674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954677">b1</span>&nbsp;<span class="op" id="2954680">:=</span>&nbsp;<span class="builtintype" id="2954683">int</span><span class="op" id="2954686">(</span><span class="ident" id="2954687">b</span><span class="op" id="2954688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954691">yy</span>&nbsp;<span class="op" id="2954694">:=</span>&nbsp;<span class="op" id="2954697">(</span><span class="num" id="2954698">19595</span><span class="op" id="2954703">*</span><span class="ident" id="2954704">r1</span>&nbsp;<span class="op" id="2954707">+</span>&nbsp;<span class="num" id="2954709">38470</span><span class="op" id="2954714">*</span><span class="ident" id="2954715">g1</span>&nbsp;<span class="op" id="2954718">+</span>&nbsp;<span class="num" id="2954720">7471</span><span class="op" id="2954724">*</span><span class="ident" id="2954725">b1</span>&nbsp;<span class="op" id="2954728">+</span>&nbsp;<span class="num" id="2954730">1</span><span class="op" id="2954731">&lt;&lt;</span><span class="num" id="2954733">15</span><span class="op" id="2954735">)</span>&nbsp;<span class="op" id="2954737">&gt;&gt;</span>&nbsp;<span class="num" id="2954740">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954744">cb</span>&nbsp;<span class="op" id="2954747">:=</span>&nbsp;<span class="op" id="2954750">(</span><span class="op" id="2954751">-</span><span class="num" id="2954752">11056</span><span class="op" id="2954757">*</span><span class="ident" id="2954758">r1</span>&nbsp;<span class="op" id="2954761">-</span>&nbsp;<span class="num" id="2954763">21712</span><span class="op" id="2954768">*</span><span class="ident" id="2954769">g1</span>&nbsp;<span class="op" id="2954772">+</span>&nbsp;<span class="num" id="2954774">32768</span><span class="op" id="2954779">*</span><span class="ident" id="2954780">b1</span>&nbsp;<span class="op" id="2954783">+</span>&nbsp;<span class="num" id="2954785">257</span><span class="op" id="2954788">&lt;&lt;</span><span class="num" id="2954790">15</span><span class="op" id="2954792">)</span>&nbsp;<span class="op" id="2954794">&gt;&gt;</span>&nbsp;<span class="num" id="2954797">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954801">cr</span>&nbsp;<span class="op" id="2954804">:=</span>&nbsp;<span class="op" id="2954807">(</span><span class="num" id="2954808">32768</span><span class="op" id="2954813">*</span><span class="ident" id="2954814">r1</span>&nbsp;<span class="op" id="2954817">-</span>&nbsp;<span class="num" id="2954819">27440</span><span class="op" id="2954824">*</span><span class="ident" id="2954825">g1</span>&nbsp;<span class="op" id="2954828">-</span>&nbsp;<span class="num" id="2954830">5328</span><span class="op" id="2954834">*</span><span class="ident" id="2954835">b1</span>&nbsp;<span class="op" id="2954838">+</span>&nbsp;<span class="num" id="2954840">257</span><span class="op" id="2954843">&lt;&lt;</span><span class="num" id="2954845">15</span><span class="op" id="2954847">)</span>&nbsp;<span class="op" id="2954849">&gt;&gt;</span>&nbsp;<span class="num" id="2954852">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2954856">if</span>&nbsp;<span class="ident" id="2954859">yy</span>&nbsp;<span class="op" id="2954862">&lt;</span>&nbsp;<span class="num" id="2954864">0</span>&nbsp;<span class="op" id="2954866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954870">yy</span>&nbsp;<span class="op" id="2954873">=</span>&nbsp;<span class="num" id="2954875">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2954878">}</span>&nbsp;<span class="keyword" id="2954880">else</span>&nbsp;<span class="keyword" id="2954885">if</span>&nbsp;<span class="ident" id="2954888">yy</span>&nbsp;<span class="op" id="2954891">&gt;</span>&nbsp;<span class="num" id="2954893">255</span>&nbsp;<span class="op" id="2954897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954901">yy</span>&nbsp;<span class="op" id="2954904">=</span>&nbsp;<span class="num" id="2954906">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2954911">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2954914">if</span>&nbsp;<span class="ident" id="2954917">cb</span>&nbsp;<span class="op" id="2954920">&lt;</span>&nbsp;<span class="num" id="2954922">0</span>&nbsp;<span class="op" id="2954924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954928">cb</span>&nbsp;<span class="op" id="2954931">=</span>&nbsp;<span class="num" id="2954933">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2954936">}</span>&nbsp;<span class="keyword" id="2954938">else</span>&nbsp;<span class="keyword" id="2954943">if</span>&nbsp;<span class="ident" id="2954946">cb</span>&nbsp;<span class="op" id="2954949">&gt;</span>&nbsp;<span class="num" id="2954951">255</span>&nbsp;<span class="op" id="2954955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954959">cb</span>&nbsp;<span class="op" id="2954962">=</span>&nbsp;<span class="num" id="2954964">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2954969">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2954972">if</span>&nbsp;<span class="ident" id="2954975">cr</span>&nbsp;<span class="op" id="2954978">&lt;</span>&nbsp;<span class="num" id="2954980">0</span>&nbsp;<span class="op" id="2954982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2954986">cr</span>&nbsp;<span class="op" id="2954989">=</span>&nbsp;<span class="num" id="2954991">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2954994">}</span>&nbsp;<span class="keyword" id="2954996">else</span>&nbsp;<span class="keyword" id="2955001">if</span>&nbsp;<span class="ident" id="2955004">cr</span>&nbsp;<span class="op" id="2955007">&gt;</span>&nbsp;<span class="num" id="2955009">255</span>&nbsp;<span class="op" id="2955013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955017">cr</span>&nbsp;<span class="op" id="2955020">=</span>&nbsp;<span class="num" id="2955022">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955027">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2955030">return</span>&nbsp;<span class="builtintype" id="2955037">uint8</span><span class="op" id="2955042">(</span><span class="ident" id="2955043">yy</span><span class="op" id="2955045">)</span><span class="op" id="2955046">,</span>&nbsp;<span class="builtintype" id="2955048">uint8</span><span class="op" id="2955053">(</span><span class="ident" id="2955054">cb</span><span class="op" id="2955056">)</span><span class="op" id="2955057">,</span>&nbsp;<span class="builtintype" id="2955059">uint8</span><span class="op" id="2955064">(</span><span class="ident" id="2955065">cr</span><span class="op" id="2955067">)</span><br>
<span class="lineno"></span><span class="op" id="2955069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2955072">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="2955129">func</span>&nbsp;<span class="ident" id="2955134">YCbCrToRGB</span><span class="op" id="2955144">(</span><span class="ident" id="2955145">y</span><span class="op" id="2955146">,</span>&nbsp;<span class="ident" id="2955148">cb</span><span class="op" id="2955150">,</span>&nbsp;<span class="ident" id="2955152">cr</span>&nbsp;<span class="builtintype" id="2955155">uint8</span><span class="op" id="2955160">)</span>&nbsp;<span class="op" id="2955162">(</span><span class="builtintype" id="2955163">uint8</span><span class="op" id="2955168">,</span>&nbsp;<span class="builtintype" id="2955170">uint8</span><span class="op" id="2955175">,</span>&nbsp;<span class="builtintype" id="2955177">uint8</span><span class="op" id="2955182">)</span>&nbsp;<span class="op" id="2955184">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2955187">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2955220">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2955250">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2955299">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2955329">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955396">yy1</span>&nbsp;<span class="op" id="2955400">:=</span>&nbsp;<span class="builtintype" id="2955403">int</span><span class="op" id="2955406">(</span><span class="ident" id="2955407">y</span><span class="op" id="2955408">)</span><span class="op" id="2955409">&lt;&lt;</span><span class="num" id="2955411">16</span>&nbsp;<span class="op" id="2955414">+</span>&nbsp;<span class="num" id="2955416">1</span><span class="op" id="2955417">&lt;&lt;</span><span class="num" id="2955419">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955423">cb1</span>&nbsp;<span class="op" id="2955427">:=</span>&nbsp;<span class="builtintype" id="2955430">int</span><span class="op" id="2955433">(</span><span class="ident" id="2955434">cb</span><span class="op" id="2955436">)</span>&nbsp;<span class="op" id="2955438">-</span>&nbsp;<span class="num" id="2955440">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955445">cr1</span>&nbsp;<span class="op" id="2955449">:=</span>&nbsp;<span class="builtintype" id="2955452">int</span><span class="op" id="2955455">(</span><span class="ident" id="2955456">cr</span><span class="op" id="2955458">)</span>&nbsp;<span class="op" id="2955460">-</span>&nbsp;<span class="num" id="2955462">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955467">r</span>&nbsp;<span class="op" id="2955469">:=</span>&nbsp;<span class="op" id="2955472">(</span><span class="ident" id="2955473">yy1</span>&nbsp;<span class="op" id="2955477">+</span>&nbsp;<span class="num" id="2955479">91881</span><span class="op" id="2955484">*</span><span class="ident" id="2955485">cr1</span><span class="op" id="2955488">)</span>&nbsp;<span class="op" id="2955490">&gt;&gt;</span>&nbsp;<span class="num" id="2955493">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955497">g</span>&nbsp;<span class="op" id="2955499">:=</span>&nbsp;<span class="op" id="2955502">(</span><span class="ident" id="2955503">yy1</span>&nbsp;<span class="op" id="2955507">-</span>&nbsp;<span class="num" id="2955509">22554</span><span class="op" id="2955514">*</span><span class="ident" id="2955515">cb1</span>&nbsp;<span class="op" id="2955519">-</span>&nbsp;<span class="num" id="2955521">46802</span><span class="op" id="2955526">*</span><span class="ident" id="2955527">cr1</span><span class="op" id="2955530">)</span>&nbsp;<span class="op" id="2955532">&gt;&gt;</span>&nbsp;<span class="num" id="2955535">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955539">b</span>&nbsp;<span class="op" id="2955541">:=</span>&nbsp;<span class="op" id="2955544">(</span><span class="ident" id="2955545">yy1</span>&nbsp;<span class="op" id="2955549">+</span>&nbsp;<span class="num" id="2955551">116130</span><span class="op" id="2955557">*</span><span class="ident" id="2955558">cb1</span><span class="op" id="2955561">)</span>&nbsp;<span class="op" id="2955563">&gt;&gt;</span>&nbsp;<span class="num" id="2955566">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2955570">if</span>&nbsp;<span class="ident" id="2955573">r</span>&nbsp;<span class="op" id="2955575">&lt;</span>&nbsp;<span class="num" id="2955577">0</span>&nbsp;<span class="op" id="2955579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955583">r</span>&nbsp;<span class="op" id="2955585">=</span>&nbsp;<span class="num" id="2955587">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955590">}</span>&nbsp;<span class="keyword" id="2955592">else</span>&nbsp;<span class="keyword" id="2955597">if</span>&nbsp;<span class="ident" id="2955600">r</span>&nbsp;<span class="op" id="2955602">&gt;</span>&nbsp;<span class="num" id="2955604">255</span>&nbsp;<span class="op" id="2955608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955612">r</span>&nbsp;<span class="op" id="2955614">=</span>&nbsp;<span class="num" id="2955616">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2955624">if</span>&nbsp;<span class="ident" id="2955627">g</span>&nbsp;<span class="op" id="2955629">&lt;</span>&nbsp;<span class="num" id="2955631">0</span>&nbsp;<span class="op" id="2955633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955637">g</span>&nbsp;<span class="op" id="2955639">=</span>&nbsp;<span class="num" id="2955641">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955644">}</span>&nbsp;<span class="keyword" id="2955646">else</span>&nbsp;<span class="keyword" id="2955651">if</span>&nbsp;<span class="ident" id="2955654">g</span>&nbsp;<span class="op" id="2955656">&gt;</span>&nbsp;<span class="num" id="2955658">255</span>&nbsp;<span class="op" id="2955662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955666">g</span>&nbsp;<span class="op" id="2955668">=</span>&nbsp;<span class="num" id="2955670">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2955678">if</span>&nbsp;<span class="ident" id="2955681">b</span>&nbsp;<span class="op" id="2955683">&lt;</span>&nbsp;<span class="num" id="2955685">0</span>&nbsp;<span class="op" id="2955687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955691">b</span>&nbsp;<span class="op" id="2955693">=</span>&nbsp;<span class="num" id="2955695">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955698">}</span>&nbsp;<span class="keyword" id="2955700">else</span>&nbsp;<span class="keyword" id="2955705">if</span>&nbsp;<span class="ident" id="2955708">b</span>&nbsp;<span class="op" id="2955710">&gt;</span>&nbsp;<span class="num" id="2955712">255</span>&nbsp;<span class="op" id="2955716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2955720">b</span>&nbsp;<span class="op" id="2955722">=</span>&nbsp;<span class="num" id="2955724">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2955729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2955732">return</span>&nbsp;<span class="builtintype" id="2955739">uint8</span><span class="op" id="2955744">(</span><span class="ident" id="2955745">r</span><span class="op" id="2955746">)</span><span class="op" id="2955747">,</span>&nbsp;<span class="builtintype" id="2955749">uint8</span><span class="op" id="2955754">(</span><span class="ident" id="2955755">g</span><span class="op" id="2955756">)</span><span class="op" id="2955757">,</span>&nbsp;<span class="builtintype" id="2955759">uint8</span><span class="op" id="2955764">(</span><span class="ident" id="2955765">b</span><span class="op" id="2955766">)</span><br>
<span class="lineno"></span><span class="op" id="2955768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2955771">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="2955850">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="2955889">//</span><br>
<span class="lineno"></span><span class="comment" id="2955892">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="2955966">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="2956041">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="2956119">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="2956172">//</span><br>
<span class="lineno"></span><span class="comment" id="2956175">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="2956254">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="2956329">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="2956401">type</span>&nbsp;<span class="ident" id="2956406">YCbCr</span>&nbsp;<span class="keyword" id="2956412">struct</span>&nbsp;<span class="op" id="2956419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2956422">Y</span><span class="op" id="2956423">,</span>&nbsp;<span class="ident" id="2956425">Cb</span><span class="op" id="2956427">,</span>&nbsp;<span class="ident" id="2956429">Cr</span>&nbsp;<span class="builtintype" id="2956432">uint8</span><br>
<span class="lineno"></span><span class="op" id="2956438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2956441">func</span>&nbsp;<span class="op" id="2956446">(</span><span class="ident" id="2956447">c</span>&nbsp;<span class="ident" id="2956449">YCbCr</span><span class="op" id="2956454">)</span>&nbsp;<span class="ident" id="2956456">RGBA</span><span class="op" id="2956460">(</span><span class="op" id="2956461">)</span>&nbsp;<span class="op" id="2956463">(</span><span class="builtintype" id="2956464">uint32</span><span class="op" id="2956470">,</span>&nbsp;<span class="builtintype" id="2956472">uint32</span><span class="op" id="2956478">,</span>&nbsp;<span class="builtintype" id="2956480">uint32</span><span class="op" id="2956486">,</span>&nbsp;<span class="builtintype" id="2956488">uint32</span><span class="op" id="2956494">)</span>&nbsp;<span class="op" id="2956496">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2956499">r</span><span class="op" id="2956500">,</span>&nbsp;<span class="ident" id="2956502">g</span><span class="op" id="2956503">,</span>&nbsp;<span class="ident" id="2956505">b</span>&nbsp;<span class="op" id="2956507">:=</span>&nbsp;<span class="ident" id="2956510">YCbCrToRGB</span><span class="op" id="2956520">(</span><span class="ident" id="2956521">c</span><span class="op" id="2956522">.</span><span class="ident" id="2956523">Y</span><span class="op" id="2956524">,</span>&nbsp;<span class="ident" id="2956526">c</span><span class="op" id="2956527">.</span><span class="ident" id="2956528">Cb</span><span class="op" id="2956530">,</span>&nbsp;<span class="ident" id="2956532">c</span><span class="op" id="2956533">.</span><span class="ident" id="2956534">Cr</span><span class="op" id="2956536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2956539">return</span>&nbsp;<span class="builtintype" id="2956546">uint32</span><span class="op" id="2956552">(</span><span class="ident" id="2956553">r</span><span class="op" id="2956554">)</span>&nbsp;<span class="op" id="2956556">*</span>&nbsp;<span class="num" id="2956558">0x101</span><span class="op" id="2956563">,</span>&nbsp;<span class="builtintype" id="2956565">uint32</span><span class="op" id="2956571">(</span><span class="ident" id="2956572">g</span><span class="op" id="2956573">)</span>&nbsp;<span class="op" id="2956575">*</span>&nbsp;<span class="num" id="2956577">0x101</span><span class="op" id="2956582">,</span>&nbsp;<span class="builtintype" id="2956584">uint32</span><span class="op" id="2956590">(</span><span class="ident" id="2956591">b</span><span class="op" id="2956592">)</span>&nbsp;<span class="op" id="2956594">*</span>&nbsp;<span class="num" id="2956596">0x101</span><span class="op" id="2956601">,</span>&nbsp;<span class="num" id="2956603">0xffff</span><br>
<span class="lineno"></span><span class="op" id="2956610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2956613">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="2956659">var</span>&nbsp;<span class="ident" id="2956663">YCbCrModel</span>&nbsp;<span class="ident" id="2956674">Model</span>&nbsp;<span class="op" id="2956680">=</span>&nbsp;<span class="ident" id="2956682">ModelFunc</span><span class="op" id="2956691">(</span><span class="ident" id="2956692">yCbCrModel</span><span class="op" id="2956702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2956705">func</span>&nbsp;<span class="ident" id="2956710">yCbCrModel</span><span class="op" id="2956720">(</span><span class="ident" id="2956721">c</span>&nbsp;<span class="ident" id="2956723">Color</span><span class="op" id="2956728">)</span>&nbsp;<span class="ident" id="2956730">Color</span>&nbsp;<span class="op" id="2956736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2956739">if</span>&nbsp;<span class="ident" id="2956742">_</span><span class="op" id="2956743">,</span>&nbsp;<span class="ident" id="2956745">ok</span>&nbsp;<span class="op" id="2956748">:=</span>&nbsp;<span class="ident" id="2956751">c</span><span class="op" id="2956752">.</span><span class="op" id="2956753">(</span><span class="ident" id="2956754">YCbCr</span><span class="op" id="2956759">)</span><span class="op" id="2956760">;</span>&nbsp;<span class="ident" id="2956762">ok</span>&nbsp;<span class="op" id="2956765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2956769">return</span>&nbsp;<span class="ident" id="2956776">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2956779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2956782">r</span><span class="op" id="2956783">,</span>&nbsp;<span class="ident" id="2956785">g</span><span class="op" id="2956786">,</span>&nbsp;<span class="ident" id="2956788">b</span><span class="op" id="2956789">,</span>&nbsp;<span class="ident" id="2956791">_</span>&nbsp;<span class="op" id="2956793">:=</span>&nbsp;<span class="ident" id="2956796">c</span><span class="op" id="2956797">.</span><span class="ident" id="2956798">RGBA</span><span class="op" id="2956802">(</span><span class="op" id="2956803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2956806">y</span><span class="op" id="2956807">,</span>&nbsp;<span class="ident" id="2956809">u</span><span class="op" id="2956810">,</span>&nbsp;<span class="ident" id="2956812">v</span>&nbsp;<span class="op" id="2956814">:=</span>&nbsp;<span class="ident" id="2956817">RGBToYCbCr</span><span class="op" id="2956827">(</span><span class="builtintype" id="2956828">uint8</span><span class="op" id="2956833">(</span><span class="ident" id="2956834">r</span><span class="op" id="2956835">&gt;&gt;</span><span class="num" id="2956837">8</span><span class="op" id="2956838">)</span><span class="op" id="2956839">,</span>&nbsp;<span class="builtintype" id="2956841">uint8</span><span class="op" id="2956846">(</span><span class="ident" id="2956847">g</span><span class="op" id="2956848">&gt;&gt;</span><span class="num" id="2956850">8</span><span class="op" id="2956851">)</span><span class="op" id="2956852">,</span>&nbsp;<span class="builtintype" id="2956854">uint8</span><span class="op" id="2956859">(</span><span class="ident" id="2956860">b</span><span class="op" id="2956861">&gt;&gt;</span><span class="num" id="2956863">8</span><span class="op" id="2956864">)</span><span class="op" id="2956865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2956868">return</span>&nbsp;<span class="ident" id="2956875">YCbCr</span><span class="op" id="2956880">{</span><span class="ident" id="2956881">y</span><span class="op" id="2956882">,</span>&nbsp;<span class="ident" id="2956884">u</span><span class="op" id="2956885">,</span>&nbsp;<span class="ident" id="2956887">v</span><span class="op" id="2956888">}</span><br>
<span class="lineno"></span><span class="op" id="2956890">}</span>
</div>
</body>
</html>
