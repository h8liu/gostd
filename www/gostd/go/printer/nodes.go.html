<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html" class="current">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5024222">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5024277">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5024331">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5024382">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5024442">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5024503">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5024558">package</span>&nbsp;<span class="ident" id="5024566">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5024575">import</span>&nbsp;<span class="op" id="5024582">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5024585">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5024594">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5024604">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5024616">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5024631">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5024634">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5024656">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5024751">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5024846">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5024866">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5024902">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5024981">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5025057">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5025137">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5025159">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5025236">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5025314">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5025390">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5025442">//</span><br>
<span class="lineno"></span><span class="comment" id="5025445">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5025524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5025599">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5025677">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5025755">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5025834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5025909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5025980">//</span><br>
<span class="lineno"></span><span class="keyword" id="5025983">func</span>&nbsp;<span class="op" id="5025988">(</span><span class="ident" id="5025989">p</span>&nbsp;<span class="op" id="5025991">*</span><span class="ident" id="5025992">printer</span><span class="op" id="5025999">)</span>&nbsp;<span class="ident" id="5026001">linebreak</span><span class="op" id="5026010">(</span><span class="ident" id="5026011">line</span><span class="op" id="5026015">,</span>&nbsp;<span class="ident" id="5026017">min</span>&nbsp;<span class="builtintype" id="5026021">int</span><span class="op" id="5026024">,</span>&nbsp;<span class="ident" id="5026026">ws</span>&nbsp;<span class="ident" id="5026029">whiteSpace</span><span class="op" id="5026039">,</span>&nbsp;<span class="ident" id="5026041">newSection</span>&nbsp;<span class="builtintype" id="5026052">bool</span><span class="op" id="5026056">)</span>&nbsp;<span class="op" id="5026058">(</span><span class="ident" id="5026059">printedBreak</span>&nbsp;<span class="builtintype" id="5026072">bool</span><span class="op" id="5026076">)</span>&nbsp;<span class="op" id="5026078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026081">n</span>&nbsp;<span class="op" id="5026083">:=</span>&nbsp;<span class="ident" id="5026086">nlimit</span><span class="op" id="5026092">(</span><span class="ident" id="5026093">line</span>&nbsp;<span class="op" id="5026098">-</span>&nbsp;<span class="ident" id="5026100">p</span><span class="op" id="5026101">.</span><span class="ident" id="5026102">pos</span><span class="op" id="5026105">.</span><span class="ident" id="5026106">Line</span><span class="op" id="5026110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026113">if</span>&nbsp;<span class="ident" id="5026116">n</span>&nbsp;<span class="op" id="5026118">&lt;</span>&nbsp;<span class="ident" id="5026120">min</span>&nbsp;<span class="op" id="5026124">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026128">n</span>&nbsp;<span class="op" id="5026130">=</span>&nbsp;<span class="ident" id="5026132">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026140">if</span>&nbsp;<span class="ident" id="5026143">n</span>&nbsp;<span class="op" id="5026145">&gt;</span>&nbsp;<span class="num" id="5026147">0</span>&nbsp;<span class="op" id="5026149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026153">p</span><span class="op" id="5026154">.</span><span class="builtinfunc" id="5026155">print</span><span class="op" id="5026160">(</span><span class="ident" id="5026161">ws</span><span class="op" id="5026163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026167">if</span>&nbsp;<span class="ident" id="5026170">newSection</span>&nbsp;<span class="op" id="5026181">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026186">p</span><span class="op" id="5026187">.</span><span class="builtinfunc" id="5026188">print</span><span class="op" id="5026193">(</span><span class="ident" id="5026194">formfeed</span><span class="op" id="5026202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026207">n</span><span class="op" id="5026208">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026217">for</span>&nbsp;<span class="op" id="5026221">;</span>&nbsp;<span class="ident" id="5026223">n</span>&nbsp;<span class="op" id="5026225">&gt;</span>&nbsp;<span class="num" id="5026227">0</span><span class="op" id="5026228">;</span>&nbsp;<span class="ident" id="5026230">n</span><span class="op" id="5026231">--</span>&nbsp;<span class="op" id="5026234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026239">p</span><span class="op" id="5026240">.</span><span class="builtinfunc" id="5026241">print</span><span class="op" id="5026246">(</span><span class="ident" id="5026247">newline</span><span class="op" id="5026254">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026262">printedBreak</span>&nbsp;<span class="op" id="5026275">=</span>&nbsp;<span class="builtintype" id="5026277">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026286">return</span><br>
<span class="lineno"></span><span class="op" id="5026293">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5026296">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5026370">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5026446">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5026524">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5026583">func</span>&nbsp;<span class="op" id="5026588">(</span><span class="ident" id="5026589">p</span>&nbsp;<span class="op" id="5026591">*</span><span class="ident" id="5026592">printer</span><span class="op" id="5026599">)</span>&nbsp;<span class="ident" id="5026601">setComment</span><span class="op" id="5026611">(</span><span class="ident" id="5026612">g</span>&nbsp;<span class="op" id="5026614">*</span><span class="ident" id="5026615">ast</span><span class="op" id="5026618">.</span><span class="ident" id="5026619">CommentGroup</span><span class="op" id="5026631">)</span>&nbsp;<span class="op" id="5026633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026636">if</span>&nbsp;<span class="ident" id="5026639">g</span>&nbsp;<span class="op" id="5026641">==</span>&nbsp;<span class="builtintype" id="5026644">nil</span>&nbsp;<span class="op" id="5026648">||</span>&nbsp;<span class="op" id="5026651">!</span><span class="ident" id="5026652">p</span><span class="op" id="5026653">.</span><span class="ident" id="5026654">useNodeComments</span>&nbsp;<span class="op" id="5026670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5026685">if</span>&nbsp;<span class="ident" id="5026688">p</span><span class="op" id="5026689">.</span><span class="ident" id="5026690">comments</span>&nbsp;<span class="op" id="5026699">==</span>&nbsp;<span class="builtintype" id="5026702">nil</span>&nbsp;<span class="op" id="5026706">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5026710">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026744">p</span><span class="op" id="5026745">.</span><span class="ident" id="5026746">comments</span>&nbsp;<span class="op" id="5026755">=</span>&nbsp;<span class="builtinfunc" id="5026757">make</span><span class="op" id="5026761">(</span><span class="op" id="5026762">[</span><span class="op" id="5026763">]</span><span class="op" id="5026764">*</span><span class="ident" id="5026765">ast</span><span class="op" id="5026768">.</span><span class="ident" id="5026769">CommentGroup</span><span class="op" id="5026781">,</span>&nbsp;<span class="num" id="5026783">1</span><span class="op" id="5026784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5026787">}</span>&nbsp;<span class="keyword" id="5026789">else</span>&nbsp;<span class="keyword" id="5026794">if</span>&nbsp;<span class="ident" id="5026797">p</span><span class="op" id="5026798">.</span><span class="ident" id="5026799">cindex</span>&nbsp;<span class="op" id="5026806">&lt;</span>&nbsp;<span class="builtinfunc" id="5026808">len</span><span class="op" id="5026811">(</span><span class="ident" id="5026812">p</span><span class="op" id="5026813">.</span><span class="ident" id="5026814">comments</span><span class="op" id="5026822">)</span>&nbsp;<span class="op" id="5026824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5026828">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5026882">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5026937">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5026991">p</span><span class="op" id="5026992">.</span><span class="ident" id="5026993">flush</span><span class="op" id="5026998">(</span><span class="ident" id="5026999">p</span><span class="op" id="5027000">.</span><span class="ident" id="5027001">posFor</span><span class="op" id="5027007">(</span><span class="ident" id="5027008">g</span><span class="op" id="5027009">.</span><span class="ident" id="5027010">List</span><span class="op" id="5027014">[</span><span class="num" id="5027015">0</span><span class="op" id="5027016">]</span><span class="op" id="5027017">.</span><span class="ident" id="5027018">Pos</span><span class="op" id="5027021">(</span><span class="op" id="5027022">)</span><span class="op" id="5027023">)</span><span class="op" id="5027024">,</span>&nbsp;<span class="ident" id="5027026">token</span><span class="op" id="5027031">.</span><span class="ident" id="5027032">ILLEGAL</span><span class="op" id="5027039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027043">p</span><span class="op" id="5027044">.</span><span class="ident" id="5027045">comments</span>&nbsp;<span class="op" id="5027054">=</span>&nbsp;<span class="ident" id="5027056">p</span><span class="op" id="5027057">.</span><span class="ident" id="5027058">comments</span><span class="op" id="5027066">[</span><span class="num" id="5027067">0</span><span class="op" id="5027068">:</span><span class="num" id="5027069">1</span><span class="op" id="5027070">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027074">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027107">p</span><span class="op" id="5027108">.</span><span class="ident" id="5027109">internalError</span><span class="op" id="5027122">(</span><span class="string" id="5027123">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5027158">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5027161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027164">p</span><span class="op" id="5027165">.</span><span class="ident" id="5027166">comments</span><span class="op" id="5027174">[</span><span class="num" id="5027175">0</span><span class="op" id="5027176">]</span>&nbsp;<span class="op" id="5027178">=</span>&nbsp;<span class="ident" id="5027180">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027183">p</span><span class="op" id="5027184">.</span><span class="ident" id="5027185">cindex</span>&nbsp;<span class="op" id="5027192">=</span>&nbsp;<span class="num" id="5027194">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027197">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027260">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027319">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027376">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5027396">if</span>&nbsp;<span class="ident" id="5027399">p</span><span class="op" id="5027400">.</span><span class="ident" id="5027401">commentOffset</span>&nbsp;<span class="op" id="5027415">==</span>&nbsp;<span class="ident" id="5027418">infinity</span>&nbsp;<span class="op" id="5027427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027431">p</span><span class="op" id="5027432">.</span><span class="ident" id="5027433">nextComment</span><span class="op" id="5027444">(</span><span class="op" id="5027445">)</span>&nbsp;<span class="comment" id="5027447">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5027477">}</span><br>
<span class="lineno">90</span><span class="op" id="5027479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5027482">type</span>&nbsp;<span class="ident" id="5027487">exprListMode</span>&nbsp;<span class="builtintype" id="5027500">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5027506">const</span>&nbsp;<span class="op" id="5027512">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027515">commaTerm</span>&nbsp;<span class="ident" id="5027525">exprListMode</span>&nbsp;<span class="op" id="5027538">=</span>&nbsp;<span class="num" id="5027540">1</span>&nbsp;<span class="op" id="5027542">&lt;&lt;</span>&nbsp;<span class="ident" id="5027545">iota</span>&nbsp;<span class="comment" id="5027550">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027595">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027630">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5027674">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5027677">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5027749">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5027781">func</span>&nbsp;<span class="op" id="5027786">(</span><span class="ident" id="5027787">p</span>&nbsp;<span class="op" id="5027789">*</span><span class="ident" id="5027790">printer</span><span class="op" id="5027797">)</span>&nbsp;<span class="ident" id="5027799">identList</span><span class="op" id="5027808">(</span><span class="ident" id="5027809">list</span>&nbsp;<span class="op" id="5027814">[</span><span class="op" id="5027815">]</span><span class="op" id="5027816">*</span><span class="ident" id="5027817">ast</span><span class="op" id="5027820">.</span><span class="ident" id="5027821">Ident</span><span class="op" id="5027826">,</span>&nbsp;<span class="ident" id="5027828">indent</span>&nbsp;<span class="builtintype" id="5027835">bool</span><span class="op" id="5027839">)</span>&nbsp;<span class="op" id="5027841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5027844">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027917">xlist</span>&nbsp;<span class="op" id="5027923">:=</span>&nbsp;<span class="builtinfunc" id="5027926">make</span><span class="op" id="5027930">(</span><span class="op" id="5027931">[</span><span class="op" id="5027932">]</span><span class="ident" id="5027933">ast</span><span class="op" id="5027936">.</span><span class="ident" id="5027937">Expr</span><span class="op" id="5027941">,</span>&nbsp;<span class="builtinfunc" id="5027943">len</span><span class="op" id="5027946">(</span><span class="ident" id="5027947">list</span><span class="op" id="5027951">)</span><span class="op" id="5027952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5027955">for</span>&nbsp;<span class="ident" id="5027959">i</span><span class="op" id="5027960">,</span>&nbsp;<span class="ident" id="5027962">x</span>&nbsp;<span class="op" id="5027964">:=</span>&nbsp;<span class="keyword" id="5027967">range</span>&nbsp;<span class="ident" id="5027973">list</span>&nbsp;<span class="op" id="5027978">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5027982">xlist</span><span class="op" id="5027987">[</span><span class="ident" id="5027988">i</span><span class="op" id="5027989">]</span>&nbsp;<span class="op" id="5027991">=</span>&nbsp;<span class="ident" id="5027993">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5027996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5027999">var</span>&nbsp;<span class="ident" id="5028003">mode</span>&nbsp;<span class="ident" id="5028008">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028022">if</span>&nbsp;<span class="op" id="5028025">!</span><span class="ident" id="5028026">indent</span>&nbsp;<span class="op" id="5028033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028037">mode</span>&nbsp;<span class="op" id="5028042">=</span>&nbsp;<span class="ident" id="5028044">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5028054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028057">p</span><span class="op" id="5028058">.</span><span class="ident" id="5028059">exprList</span><span class="op" id="5028067">(</span><span class="ident" id="5028068">token</span><span class="op" id="5028073">.</span><span class="ident" id="5028074">NoPos</span><span class="op" id="5028079">,</span>&nbsp;<span class="ident" id="5028081">xlist</span><span class="op" id="5028086">,</span>&nbsp;<span class="num" id="5028088">1</span><span class="op" id="5028089">,</span>&nbsp;<span class="ident" id="5028091">mode</span><span class="op" id="5028095">,</span>&nbsp;<span class="ident" id="5028097">token</span><span class="op" id="5028102">.</span><span class="ident" id="5028103">NoPos</span><span class="op" id="5028108">)</span><br>
<span class="lineno"></span><span class="op" id="5028110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5028113">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5028172">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5028236">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5028252">//</span><br>
<span class="lineno"></span><span class="comment" id="5028255">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5028324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5028391">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5028457">func</span>&nbsp;<span class="op" id="5028462">(</span><span class="ident" id="5028463">p</span>&nbsp;<span class="op" id="5028465">*</span><span class="ident" id="5028466">printer</span><span class="op" id="5028473">)</span>&nbsp;<span class="ident" id="5028475">exprList</span><span class="op" id="5028483">(</span><span class="ident" id="5028484">prev0</span>&nbsp;<span class="ident" id="5028490">token</span><span class="op" id="5028495">.</span><span class="ident" id="5028496">Pos</span><span class="op" id="5028499">,</span>&nbsp;<span class="ident" id="5028501">list</span>&nbsp;<span class="op" id="5028506">[</span><span class="op" id="5028507">]</span><span class="ident" id="5028508">ast</span><span class="op" id="5028511">.</span><span class="ident" id="5028512">Expr</span><span class="op" id="5028516">,</span>&nbsp;<span class="ident" id="5028518">depth</span>&nbsp;<span class="builtintype" id="5028524">int</span><span class="op" id="5028527">,</span>&nbsp;<span class="ident" id="5028529">mode</span>&nbsp;<span class="ident" id="5028534">exprListMode</span><span class="op" id="5028546">,</span>&nbsp;<span class="ident" id="5028548">next0</span>&nbsp;<span class="ident" id="5028554">token</span><span class="op" id="5028559">.</span><span class="ident" id="5028560">Pos</span><span class="op" id="5028563">)</span>&nbsp;<span class="op" id="5028565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028568">if</span>&nbsp;<span class="builtinfunc" id="5028571">len</span><span class="op" id="5028574">(</span><span class="ident" id="5028575">list</span><span class="op" id="5028579">)</span>&nbsp;<span class="op" id="5028581">==</span>&nbsp;<span class="num" id="5028584">0</span>&nbsp;<span class="op" id="5028586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028590">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5028598">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028602">prev</span>&nbsp;<span class="op" id="5028607">:=</span>&nbsp;<span class="ident" id="5028610">p</span><span class="op" id="5028611">.</span><span class="ident" id="5028612">posFor</span><span class="op" id="5028618">(</span><span class="ident" id="5028619">prev0</span><span class="op" id="5028624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028627">next</span>&nbsp;<span class="op" id="5028632">:=</span>&nbsp;<span class="ident" id="5028635">p</span><span class="op" id="5028636">.</span><span class="ident" id="5028637">posFor</span><span class="op" id="5028643">(</span><span class="ident" id="5028644">next0</span><span class="op" id="5028649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028652">line</span>&nbsp;<span class="op" id="5028657">:=</span>&nbsp;<span class="ident" id="5028660">p</span><span class="op" id="5028661">.</span><span class="ident" id="5028662">lineFor</span><span class="op" id="5028669">(</span><span class="ident" id="5028670">list</span><span class="op" id="5028674">[</span><span class="num" id="5028675">0</span><span class="op" id="5028676">]</span><span class="op" id="5028677">.</span><span class="ident" id="5028678">Pos</span><span class="op" id="5028681">(</span><span class="op" id="5028682">)</span><span class="op" id="5028683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028686">endLine</span>&nbsp;<span class="op" id="5028694">:=</span>&nbsp;<span class="ident" id="5028697">p</span><span class="op" id="5028698">.</span><span class="ident" id="5028699">lineFor</span><span class="op" id="5028706">(</span><span class="ident" id="5028707">list</span><span class="op" id="5028711">[</span><span class="builtinfunc" id="5028712">len</span><span class="op" id="5028715">(</span><span class="ident" id="5028716">list</span><span class="op" id="5028720">)</span><span class="op" id="5028721">-</span><span class="num" id="5028722">1</span><span class="op" id="5028723">]</span><span class="op" id="5028724">.</span><span class="ident" id="5028725">End</span><span class="op" id="5028728">(</span><span class="op" id="5028729">)</span><span class="op" id="5028730">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028734">if</span>&nbsp;<span class="ident" id="5028737">prev</span><span class="op" id="5028741">.</span><span class="ident" id="5028742">IsValid</span><span class="op" id="5028749">(</span><span class="op" id="5028750">)</span>&nbsp;<span class="op" id="5028752">&amp;&amp;</span>&nbsp;<span class="ident" id="5028755">prev</span><span class="op" id="5028759">.</span><span class="ident" id="5028760">Line</span>&nbsp;<span class="op" id="5028765">==</span>&nbsp;<span class="ident" id="5028768">line</span>&nbsp;<span class="op" id="5028773">&amp;&amp;</span>&nbsp;<span class="ident" id="5028776">line</span>&nbsp;<span class="op" id="5028781">==</span>&nbsp;<span class="ident" id="5028784">endLine</span>&nbsp;<span class="op" id="5028792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028796">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028835">for</span>&nbsp;<span class="ident" id="5028839">i</span><span class="op" id="5028840">,</span>&nbsp;<span class="ident" id="5028842">x</span>&nbsp;<span class="op" id="5028844">:=</span>&nbsp;<span class="keyword" id="5028847">range</span>&nbsp;<span class="ident" id="5028853">list</span>&nbsp;<span class="op" id="5028858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5028863">if</span>&nbsp;<span class="ident" id="5028866">i</span>&nbsp;<span class="op" id="5028868">&gt;</span>&nbsp;<span class="num" id="5028870">0</span>&nbsp;<span class="op" id="5028872">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028878">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5028935">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5028987">p</span><span class="op" id="5028988">.</span><span class="builtinfunc" id="5028989">print</span><span class="op" id="5028994">(</span><span class="ident" id="5028995">x</span><span class="op" id="5028996">.</span><span class="ident" id="5028997">Pos</span><span class="op" id="5029000">(</span><span class="op" id="5029001">)</span><span class="op" id="5029002">,</span>&nbsp;<span class="ident" id="5029004">token</span><span class="op" id="5029009">.</span><span class="ident" id="5029010">COMMA</span><span class="op" id="5029015">,</span>&nbsp;<span class="ident" id="5029017">blank</span><span class="op" id="5029022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5029027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029032">p</span><span class="op" id="5029033">.</span><span class="ident" id="5029034">expr0</span><span class="op" id="5029039">(</span><span class="ident" id="5029040">x</span><span class="op" id="5029041">,</span>&nbsp;<span class="ident" id="5029043">depth</span><span class="op" id="5029048">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5029052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5029056">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5029064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029068">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029106">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029158">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029210">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029268">ws</span>&nbsp;<span class="op" id="5029271">:=</span>&nbsp;<span class="ident" id="5029274">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5029282">if</span>&nbsp;<span class="ident" id="5029285">mode</span><span class="op" id="5029289">&amp;</span><span class="ident" id="5029290">noIndent</span>&nbsp;<span class="op" id="5029299">==</span>&nbsp;<span class="num" id="5029302">0</span>&nbsp;<span class="op" id="5029304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029308">ws</span>&nbsp;<span class="op" id="5029311">=</span>&nbsp;<span class="ident" id="5029313">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5029321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029325">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029398">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029436">prevBreak</span>&nbsp;<span class="op" id="5029446">:=</span>&nbsp;<span class="op" id="5029449">-</span><span class="num" id="5029450">1</span>&nbsp;<span class="comment" id="5029452">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5029514">if</span>&nbsp;<span class="ident" id="5029517">prev</span><span class="op" id="5029521">.</span><span class="ident" id="5029522">IsValid</span><span class="op" id="5029529">(</span><span class="op" id="5029530">)</span>&nbsp;<span class="op" id="5029532">&amp;&amp;</span>&nbsp;<span class="ident" id="5029535">prev</span><span class="op" id="5029539">.</span><span class="ident" id="5029540">Line</span>&nbsp;<span class="op" id="5029545">&lt;</span>&nbsp;<span class="ident" id="5029547">line</span>&nbsp;<span class="op" id="5029552">&amp;&amp;</span>&nbsp;<span class="ident" id="5029555">p</span><span class="op" id="5029556">.</span><span class="ident" id="5029557">linebreak</span><span class="op" id="5029566">(</span><span class="ident" id="5029567">line</span><span class="op" id="5029571">,</span>&nbsp;<span class="num" id="5029573">0</span><span class="op" id="5029574">,</span>&nbsp;<span class="ident" id="5029576">ws</span><span class="op" id="5029578">,</span>&nbsp;<span class="builtintype" id="5029580">true</span><span class="op" id="5029584">)</span>&nbsp;<span class="op" id="5029586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029590">ws</span>&nbsp;<span class="op" id="5029593">=</span>&nbsp;<span class="ident" id="5029595">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029604">prevBreak</span>&nbsp;<span class="op" id="5029614">=</span>&nbsp;<span class="num" id="5029616">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5029619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029623">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029720">size</span>&nbsp;<span class="op" id="5029725">:=</span>&nbsp;<span class="num" id="5029728">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029732">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029760">prevLine</span>&nbsp;<span class="op" id="5029769">:=</span>&nbsp;<span class="ident" id="5029772">prev</span><span class="op" id="5029776">.</span><span class="ident" id="5029777">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5029783">for</span>&nbsp;<span class="ident" id="5029787">i</span><span class="op" id="5029788">,</span>&nbsp;<span class="ident" id="5029790">x</span>&nbsp;<span class="op" id="5029792">:=</span>&nbsp;<span class="keyword" id="5029795">range</span>&nbsp;<span class="ident" id="5029801">list</span>&nbsp;<span class="op" id="5029806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5029810">line</span>&nbsp;<span class="op" id="5029815">=</span>&nbsp;<span class="ident" id="5029817">p</span><span class="op" id="5029818">.</span><span class="ident" id="5029819">lineFor</span><span class="op" id="5029826">(</span><span class="ident" id="5029827">x</span><span class="op" id="5029828">.</span><span class="ident" id="5029829">Pos</span><span class="op" id="5029832">(</span><span class="op" id="5029833">)</span><span class="op" id="5029834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029839">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029908">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5029976">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030021">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030157">useFF</span>&nbsp;<span class="op" id="5030163">:=</span>&nbsp;<span class="builtintype" id="5030166">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030174">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030237">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030303">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030372">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030386">prevSize</span>&nbsp;<span class="op" id="5030395">:=</span>&nbsp;<span class="ident" id="5030398">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030405">const</span>&nbsp;<span class="ident" id="5030411">infinity</span>&nbsp;<span class="op" id="5030420">=</span>&nbsp;<span class="num" id="5030422">1e6</span>&nbsp;<span class="comment" id="5030426">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030459">size</span>&nbsp;<span class="op" id="5030464">=</span>&nbsp;<span class="ident" id="5030466">p</span><span class="op" id="5030467">.</span><span class="ident" id="5030468">nodeSize</span><span class="op" id="5030476">(</span><span class="ident" id="5030477">x</span><span class="op" id="5030478">,</span>&nbsp;<span class="ident" id="5030480">infinity</span><span class="op" id="5030488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030492">pair</span><span class="op" id="5030496">,</span>&nbsp;<span class="ident" id="5030498">isPair</span>&nbsp;<span class="op" id="5030505">:=</span>&nbsp;<span class="ident" id="5030508">x</span><span class="op" id="5030509">.</span><span class="op" id="5030510">(</span><span class="op" id="5030511">*</span><span class="ident" id="5030512">ast</span><span class="op" id="5030515">.</span><span class="ident" id="5030516">KeyValueExpr</span><span class="op" id="5030528">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030532">if</span>&nbsp;<span class="ident" id="5030535">size</span>&nbsp;<span class="op" id="5030540">&lt;=</span>&nbsp;<span class="ident" id="5030543">infinity</span>&nbsp;<span class="op" id="5030552">&amp;&amp;</span>&nbsp;<span class="ident" id="5030555">prev</span><span class="op" id="5030559">.</span><span class="ident" id="5030560">IsValid</span><span class="op" id="5030567">(</span><span class="op" id="5030568">)</span>&nbsp;<span class="op" id="5030570">&amp;&amp;</span>&nbsp;<span class="ident" id="5030573">next</span><span class="op" id="5030577">.</span><span class="ident" id="5030578">IsValid</span><span class="op" id="5030585">(</span><span class="op" id="5030586">)</span>&nbsp;<span class="op" id="5030588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030593">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5030623">if</span>&nbsp;<span class="ident" id="5030626">isPair</span>&nbsp;<span class="op" id="5030633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030639">size</span>&nbsp;<span class="op" id="5030644">=</span>&nbsp;<span class="ident" id="5030646">p</span><span class="op" id="5030647">.</span><span class="ident" id="5030648">nodeSize</span><span class="op" id="5030656">(</span><span class="ident" id="5030657">pair</span><span class="op" id="5030661">.</span><span class="ident" id="5030662">Key</span><span class="op" id="5030665">,</span>&nbsp;<span class="ident" id="5030667">infinity</span><span class="op" id="5030675">)</span>&nbsp;<span class="comment" id="5030677">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030700">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030704">}</span>&nbsp;<span class="keyword" id="5030706">else</span>&nbsp;<span class="op" id="5030711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030716">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5030778">size</span>&nbsp;<span class="op" id="5030783">=</span>&nbsp;<span class="num" id="5030785">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5030789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030794">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030853">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030910">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5030965">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031019">if</span>&nbsp;<span class="ident" id="5031022">prevSize</span>&nbsp;<span class="op" id="5031031">&gt;</span>&nbsp;<span class="num" id="5031033">0</span>&nbsp;<span class="op" id="5031035">&amp;&amp;</span>&nbsp;<span class="ident" id="5031038">size</span>&nbsp;<span class="op" id="5031043">&gt;</span>&nbsp;<span class="num" id="5031045">0</span>&nbsp;<span class="op" id="5031047">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031052">const</span>&nbsp;<span class="ident" id="5031058">smallSize</span>&nbsp;<span class="op" id="5031068">=</span>&nbsp;<span class="num" id="5031070">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031076">if</span>&nbsp;<span class="ident" id="5031079">prevSize</span>&nbsp;<span class="op" id="5031088">&lt;=</span>&nbsp;<span class="ident" id="5031091">smallSize</span>&nbsp;<span class="op" id="5031101">&amp;&amp;</span>&nbsp;<span class="ident" id="5031104">size</span>&nbsp;<span class="op" id="5031109">&lt;=</span>&nbsp;<span class="ident" id="5031112">smallSize</span>&nbsp;<span class="op" id="5031122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031128">useFF</span>&nbsp;<span class="op" id="5031134">=</span>&nbsp;<span class="builtintype" id="5031136">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031145">}</span>&nbsp;<span class="keyword" id="5031147">else</span>&nbsp;<span class="op" id="5031152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031158">const</span>&nbsp;<span class="ident" id="5031164">r</span>&nbsp;<span class="op" id="5031166">=</span>&nbsp;<span class="num" id="5031168">4</span>&nbsp;<span class="comment" id="5031170">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031187">ratio</span>&nbsp;<span class="op" id="5031193">:=</span>&nbsp;<span class="builtintype" id="5031196">float64</span><span class="op" id="5031203">(</span><span class="ident" id="5031204">size</span><span class="op" id="5031208">)</span>&nbsp;<span class="op" id="5031210">/</span>&nbsp;<span class="builtintype" id="5031212">float64</span><span class="op" id="5031219">(</span><span class="ident" id="5031220">prevSize</span><span class="op" id="5031228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031234">useFF</span>&nbsp;<span class="op" id="5031240">=</span>&nbsp;<span class="ident" id="5031242">ratio</span>&nbsp;<span class="op" id="5031248">&lt;=</span>&nbsp;<span class="num" id="5031251">1.0</span><span class="op" id="5031254">/</span><span class="ident" id="5031255">r</span>&nbsp;<span class="op" id="5031257">||</span>&nbsp;<span class="ident" id="5031260">r</span>&nbsp;<span class="op" id="5031262">&lt;=</span>&nbsp;<span class="ident" id="5031265">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031283">needsLinebreak</span>&nbsp;<span class="op" id="5031298">:=</span>&nbsp;<span class="num" id="5031301">0</span>&nbsp;<span class="op" id="5031303">&lt;</span>&nbsp;<span class="ident" id="5031305">prevLine</span>&nbsp;<span class="op" id="5031314">&amp;&amp;</span>&nbsp;<span class="ident" id="5031317">prevLine</span>&nbsp;<span class="op" id="5031326">&lt;</span>&nbsp;<span class="ident" id="5031328">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031335">if</span>&nbsp;<span class="ident" id="5031338">i</span>&nbsp;<span class="op" id="5031340">&gt;</span>&nbsp;<span class="num" id="5031342">0</span>&nbsp;<span class="op" id="5031344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031349">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031405">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031461">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031510">if</span>&nbsp;<span class="op" id="5031513">!</span><span class="ident" id="5031514">needsLinebreak</span>&nbsp;<span class="op" id="5031529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031535">p</span><span class="op" id="5031536">.</span><span class="builtinfunc" id="5031537">print</span><span class="op" id="5031542">(</span><span class="ident" id="5031543">x</span><span class="op" id="5031544">.</span><span class="ident" id="5031545">Pos</span><span class="op" id="5031548">(</span><span class="op" id="5031549">)</span><span class="op" id="5031550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031560">p</span><span class="op" id="5031561">.</span><span class="builtinfunc" id="5031562">print</span><span class="op" id="5031567">(</span><span class="ident" id="5031568">token</span><span class="op" id="5031573">.</span><span class="ident" id="5031574">COMMA</span><span class="op" id="5031579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031584">needsBlank</span>&nbsp;<span class="op" id="5031595">:=</span>&nbsp;<span class="builtintype" id="5031598">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031606">if</span>&nbsp;<span class="ident" id="5031609">needsLinebreak</span>&nbsp;<span class="op" id="5031624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031630">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031696">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5031762">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031814">if</span>&nbsp;<span class="ident" id="5031817">p</span><span class="op" id="5031818">.</span><span class="ident" id="5031819">linebreak</span><span class="op" id="5031828">(</span><span class="ident" id="5031829">line</span><span class="op" id="5031833">,</span>&nbsp;<span class="num" id="5031835">0</span><span class="op" id="5031836">,</span>&nbsp;<span class="ident" id="5031838">ws</span><span class="op" id="5031840">,</span>&nbsp;<span class="ident" id="5031842">useFF</span>&nbsp;<span class="op" id="5031848">||</span>&nbsp;<span class="ident" id="5031851">prevBreak</span><span class="op" id="5031860">+</span><span class="num" id="5031861">1</span>&nbsp;<span class="op" id="5031863">&lt;</span>&nbsp;<span class="ident" id="5031865">i</span><span class="op" id="5031866">)</span>&nbsp;<span class="op" id="5031868">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031875">ws</span>&nbsp;<span class="op" id="5031878">=</span>&nbsp;<span class="ident" id="5031880">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031892">prevBreak</span>&nbsp;<span class="op" id="5031902">=</span>&nbsp;<span class="ident" id="5031904">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031911">needsBlank</span>&nbsp;<span class="op" id="5031922">=</span>&nbsp;<span class="builtintype" id="5031924">false</span>&nbsp;<span class="comment" id="5031930">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5031970">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5031975">if</span>&nbsp;<span class="ident" id="5031978">needsBlank</span>&nbsp;<span class="op" id="5031989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5031995">p</span><span class="op" id="5031996">.</span><span class="builtinfunc" id="5031997">print</span><span class="op" id="5032002">(</span><span class="ident" id="5032003">blank</span><span class="op" id="5032008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032022">if</span>&nbsp;<span class="builtinfunc" id="5032025">len</span><span class="op" id="5032028">(</span><span class="ident" id="5032029">list</span><span class="op" id="5032033">)</span>&nbsp;<span class="op" id="5032035">&gt;</span>&nbsp;<span class="num" id="5032037">1</span>&nbsp;<span class="op" id="5032039">&amp;&amp;</span>&nbsp;<span class="ident" id="5032042">isPair</span>&nbsp;<span class="op" id="5032049">&amp;&amp;</span>&nbsp;<span class="ident" id="5032052">size</span>&nbsp;<span class="op" id="5032057">&gt;</span>&nbsp;<span class="num" id="5032059">0</span>&nbsp;<span class="op" id="5032061">&amp;&amp;</span>&nbsp;<span class="ident" id="5032064">needsLinebreak</span>&nbsp;<span class="op" id="5032079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032084">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032145">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032206">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032267">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032295">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032357">p</span><span class="op" id="5032358">.</span><span class="ident" id="5032359">expr</span><span class="op" id="5032363">(</span><span class="ident" id="5032364">pair</span><span class="op" id="5032368">.</span><span class="ident" id="5032369">Key</span><span class="op" id="5032372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032377">p</span><span class="op" id="5032378">.</span><span class="builtinfunc" id="5032379">print</span><span class="op" id="5032384">(</span><span class="ident" id="5032385">pair</span><span class="op" id="5032389">.</span><span class="ident" id="5032390">Colon</span><span class="op" id="5032395">,</span>&nbsp;<span class="ident" id="5032397">token</span><span class="op" id="5032402">.</span><span class="ident" id="5032403">COLON</span><span class="op" id="5032408">,</span>&nbsp;<span class="ident" id="5032410">vtab</span><span class="op" id="5032414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032419">p</span><span class="op" id="5032420">.</span><span class="ident" id="5032421">expr</span><span class="op" id="5032425">(</span><span class="ident" id="5032426">pair</span><span class="op" id="5032430">.</span><span class="ident" id="5032431">Value</span><span class="op" id="5032436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032440">}</span>&nbsp;<span class="keyword" id="5032442">else</span>&nbsp;<span class="op" id="5032447">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032452">p</span><span class="op" id="5032453">.</span><span class="ident" id="5032454">expr0</span><span class="op" id="5032459">(</span><span class="ident" id="5032460">x</span><span class="op" id="5032461">,</span>&nbsp;<span class="ident" id="5032463">depth</span><span class="op" id="5032468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032477">prevLine</span>&nbsp;<span class="op" id="5032486">=</span>&nbsp;<span class="ident" id="5032488">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032494">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032498">if</span>&nbsp;<span class="ident" id="5032501">mode</span><span class="op" id="5032505">&amp;</span><span class="ident" id="5032506">commaTerm</span>&nbsp;<span class="op" id="5032516">!=</span>&nbsp;<span class="num" id="5032519">0</span>&nbsp;<span class="op" id="5032521">&amp;&amp;</span>&nbsp;<span class="ident" id="5032524">next</span><span class="op" id="5032528">.</span><span class="ident" id="5032529">IsValid</span><span class="op" id="5032536">(</span><span class="op" id="5032537">)</span>&nbsp;<span class="op" id="5032539">&amp;&amp;</span>&nbsp;<span class="ident" id="5032542">p</span><span class="op" id="5032543">.</span><span class="ident" id="5032544">pos</span><span class="op" id="5032547">.</span><span class="ident" id="5032548">Line</span>&nbsp;<span class="op" id="5032553">&lt;</span>&nbsp;<span class="ident" id="5032555">next</span><span class="op" id="5032559">.</span><span class="ident" id="5032560">Line</span>&nbsp;<span class="op" id="5032565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032569">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032635">p</span><span class="op" id="5032636">.</span><span class="builtinfunc" id="5032637">print</span><span class="op" id="5032642">(</span><span class="ident" id="5032643">token</span><span class="op" id="5032648">.</span><span class="ident" id="5032649">COMMA</span><span class="op" id="5032654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032658">if</span>&nbsp;<span class="ident" id="5032661">ws</span>&nbsp;<span class="op" id="5032664">==</span>&nbsp;<span class="ident" id="5032667">ignore</span>&nbsp;<span class="op" id="5032674">&amp;&amp;</span>&nbsp;<span class="ident" id="5032677">mode</span><span class="op" id="5032681">&amp;</span><span class="ident" id="5032682">noIndent</span>&nbsp;<span class="op" id="5032691">==</span>&nbsp;<span class="num" id="5032694">0</span>&nbsp;<span class="op" id="5032696">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032701">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032731">p</span><span class="op" id="5032732">.</span><span class="builtinfunc" id="5032733">print</span><span class="op" id="5032738">(</span><span class="ident" id="5032739">unindent</span><span class="op" id="5032747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032755">p</span><span class="op" id="5032756">.</span><span class="builtinfunc" id="5032757">print</span><span class="op" id="5032762">(</span><span class="ident" id="5032763">formfeed</span><span class="op" id="5032771">)</span>&nbsp;<span class="comment" id="5032773">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032828">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5032840">if</span>&nbsp;<span class="ident" id="5032843">ws</span>&nbsp;<span class="op" id="5032846">==</span>&nbsp;<span class="ident" id="5032849">ignore</span>&nbsp;<span class="op" id="5032856">&amp;&amp;</span>&nbsp;<span class="ident" id="5032859">mode</span><span class="op" id="5032863">&amp;</span><span class="ident" id="5032864">noIndent</span>&nbsp;<span class="op" id="5032873">==</span>&nbsp;<span class="num" id="5032876">0</span>&nbsp;<span class="op" id="5032878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5032882">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032911">p</span><span class="op" id="5032912">.</span><span class="builtinfunc" id="5032913">print</span><span class="op" id="5032918">(</span><span class="ident" id="5032919">unindent</span><span class="op" id="5032927">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5032930">}</span><br>
<span class="lineno"></span><span class="op" id="5032932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5032935">func</span>&nbsp;<span class="op" id="5032940">(</span><span class="ident" id="5032941">p</span>&nbsp;<span class="op" id="5032943">*</span><span class="ident" id="5032944">printer</span><span class="op" id="5032951">)</span>&nbsp;<span class="ident" id="5032953">parameters</span><span class="op" id="5032963">(</span><span class="ident" id="5032964">fields</span>&nbsp;<span class="op" id="5032971">*</span><span class="ident" id="5032972">ast</span><span class="op" id="5032975">.</span><span class="ident" id="5032976">FieldList</span><span class="op" id="5032985">)</span>&nbsp;<span class="op" id="5032987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5032990">p</span><span class="op" id="5032991">.</span><span class="builtinfunc" id="5032992">print</span><span class="op" id="5032997">(</span><span class="ident" id="5032998">fields</span><span class="op" id="5033004">.</span><span class="ident" id="5033005">Opening</span><span class="op" id="5033012">,</span>&nbsp;<span class="ident" id="5033014">token</span><span class="op" id="5033019">.</span><span class="ident" id="5033020">LPAREN</span><span class="op" id="5033026">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033029">if</span>&nbsp;<span class="builtinfunc" id="5033032">len</span><span class="op" id="5033035">(</span><span class="ident" id="5033036">fields</span><span class="op" id="5033042">.</span><span class="ident" id="5033043">List</span><span class="op" id="5033047">)</span>&nbsp;<span class="op" id="5033049">&gt;</span>&nbsp;<span class="num" id="5033051">0</span>&nbsp;<span class="op" id="5033053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033057">prevLine</span>&nbsp;<span class="op" id="5033066">:=</span>&nbsp;<span class="ident" id="5033069">p</span><span class="op" id="5033070">.</span><span class="ident" id="5033071">lineFor</span><span class="op" id="5033078">(</span><span class="ident" id="5033079">fields</span><span class="op" id="5033085">.</span><span class="ident" id="5033086">Opening</span><span class="op" id="5033093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033097">ws</span>&nbsp;<span class="op" id="5033100">:=</span>&nbsp;<span class="ident" id="5033103">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033112">for</span>&nbsp;<span class="ident" id="5033116">i</span><span class="op" id="5033117">,</span>&nbsp;<span class="ident" id="5033119">par</span>&nbsp;<span class="op" id="5033123">:=</span>&nbsp;<span class="keyword" id="5033126">range</span>&nbsp;<span class="ident" id="5033132">fields</span><span class="op" id="5033138">.</span><span class="ident" id="5033139">List</span>&nbsp;<span class="op" id="5033144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033149">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033206">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033263">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033304">var</span>&nbsp;<span class="ident" id="5033308">parLineBeg</span>&nbsp;<span class="builtintype" id="5033319">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033326">if</span>&nbsp;<span class="builtinfunc" id="5033329">len</span><span class="op" id="5033332">(</span><span class="ident" id="5033333">par</span><span class="op" id="5033336">.</span><span class="ident" id="5033337">Names</span><span class="op" id="5033342">)</span>&nbsp;<span class="op" id="5033344">&gt;</span>&nbsp;<span class="num" id="5033346">0</span>&nbsp;<span class="op" id="5033348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033354">parLineBeg</span>&nbsp;<span class="op" id="5033365">=</span>&nbsp;<span class="ident" id="5033367">p</span><span class="op" id="5033368">.</span><span class="ident" id="5033369">lineFor</span><span class="op" id="5033376">(</span><span class="ident" id="5033377">par</span><span class="op" id="5033380">.</span><span class="ident" id="5033381">Names</span><span class="op" id="5033386">[</span><span class="num" id="5033387">0</span><span class="op" id="5033388">]</span><span class="op" id="5033389">.</span><span class="ident" id="5033390">Pos</span><span class="op" id="5033393">(</span><span class="op" id="5033394">)</span><span class="op" id="5033395">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5033400">}</span>&nbsp;<span class="keyword" id="5033402">else</span>&nbsp;<span class="op" id="5033407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033413">parLineBeg</span>&nbsp;<span class="op" id="5033424">=</span>&nbsp;<span class="ident" id="5033426">p</span><span class="op" id="5033427">.</span><span class="ident" id="5033428">lineFor</span><span class="op" id="5033435">(</span><span class="ident" id="5033436">par</span><span class="op" id="5033439">.</span><span class="ident" id="5033440">Type</span><span class="op" id="5033444">.</span><span class="ident" id="5033445">Pos</span><span class="op" id="5033448">(</span><span class="op" id="5033449">)</span><span class="op" id="5033450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5033455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033460">var</span>&nbsp;<span class="ident" id="5033464">parLineEnd</span>&nbsp;<span class="op" id="5033475">=</span>&nbsp;<span class="ident" id="5033477">p</span><span class="op" id="5033478">.</span><span class="ident" id="5033479">lineFor</span><span class="op" id="5033486">(</span><span class="ident" id="5033487">par</span><span class="op" id="5033490">.</span><span class="ident" id="5033491">Type</span><span class="op" id="5033495">.</span><span class="ident" id="5033496">End</span><span class="op" id="5033499">(</span><span class="op" id="5033500">)</span><span class="op" id="5033501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033506">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033537">needsLinebreak</span>&nbsp;<span class="op" id="5033552">:=</span>&nbsp;<span class="num" id="5033555">0</span>&nbsp;<span class="op" id="5033557">&lt;</span>&nbsp;<span class="ident" id="5033559">prevLine</span>&nbsp;<span class="op" id="5033568">&amp;&amp;</span>&nbsp;<span class="ident" id="5033571">prevLine</span>&nbsp;<span class="op" id="5033580">&lt;</span>&nbsp;<span class="ident" id="5033582">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033596">if</span>&nbsp;<span class="ident" id="5033599">i</span>&nbsp;<span class="op" id="5033601">&gt;</span>&nbsp;<span class="num" id="5033603">0</span>&nbsp;<span class="op" id="5033605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033611">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033667">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033722">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033776">if</span>&nbsp;<span class="op" id="5033779">!</span><span class="ident" id="5033780">needsLinebreak</span>&nbsp;<span class="op" id="5033795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033802">p</span><span class="op" id="5033803">.</span><span class="builtinfunc" id="5033804">print</span><span class="op" id="5033809">(</span><span class="ident" id="5033810">par</span><span class="op" id="5033813">.</span><span class="ident" id="5033814">Pos</span><span class="op" id="5033817">(</span><span class="op" id="5033818">)</span><span class="op" id="5033819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5033825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5033831">p</span><span class="op" id="5033832">.</span><span class="builtinfunc" id="5033833">print</span><span class="op" id="5033838">(</span><span class="ident" id="5033839">token</span><span class="op" id="5033844">.</span><span class="ident" id="5033845">COMMA</span><span class="op" id="5033850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5033855">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033860">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5033907">if</span>&nbsp;<span class="ident" id="5033910">needsLinebreak</span>&nbsp;<span class="op" id="5033925">&amp;&amp;</span>&nbsp;<span class="ident" id="5033928">p</span><span class="op" id="5033929">.</span><span class="ident" id="5033930">linebreak</span><span class="op" id="5033939">(</span><span class="ident" id="5033940">parLineBeg</span><span class="op" id="5033950">,</span>&nbsp;<span class="num" id="5033952">0</span><span class="op" id="5033953">,</span>&nbsp;<span class="ident" id="5033955">ws</span><span class="op" id="5033957">,</span>&nbsp;<span class="builtintype" id="5033959">true</span><span class="op" id="5033963">)</span>&nbsp;<span class="op" id="5033965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5033971">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034056">ws</span>&nbsp;<span class="op" id="5034059">=</span>&nbsp;<span class="ident" id="5034061">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034071">}</span>&nbsp;<span class="keyword" id="5034073">else</span>&nbsp;<span class="keyword" id="5034078">if</span>&nbsp;<span class="ident" id="5034081">i</span>&nbsp;<span class="op" id="5034083">&gt;</span>&nbsp;<span class="num" id="5034085">0</span>&nbsp;<span class="op" id="5034087">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034093">p</span><span class="op" id="5034094">.</span><span class="builtinfunc" id="5034095">print</span><span class="op" id="5034100">(</span><span class="ident" id="5034101">blank</span><span class="op" id="5034106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034116">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034138">if</span>&nbsp;<span class="builtinfunc" id="5034141">len</span><span class="op" id="5034144">(</span><span class="ident" id="5034145">par</span><span class="op" id="5034148">.</span><span class="ident" id="5034149">Names</span><span class="op" id="5034154">)</span>&nbsp;<span class="op" id="5034156">&gt;</span>&nbsp;<span class="num" id="5034158">0</span>&nbsp;<span class="op" id="5034160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034166">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034234">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034305">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034378">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034454">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034531">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034563">p</span><span class="op" id="5034564">.</span><span class="ident" id="5034565">identList</span><span class="op" id="5034574">(</span><span class="ident" id="5034575">par</span><span class="op" id="5034578">.</span><span class="ident" id="5034579">Names</span><span class="op" id="5034584">,</span>&nbsp;<span class="ident" id="5034586">ws</span>&nbsp;<span class="op" id="5034589">==</span>&nbsp;<span class="ident" id="5034592">indent</span><span class="op" id="5034598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034604">p</span><span class="op" id="5034605">.</span><span class="builtinfunc" id="5034606">print</span><span class="op" id="5034611">(</span><span class="ident" id="5034612">blank</span><span class="op" id="5034617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034627">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034648">p</span><span class="op" id="5034649">.</span><span class="ident" id="5034650">expr</span><span class="op" id="5034654">(</span><span class="ident" id="5034655">stripParensAlways</span><span class="op" id="5034672">(</span><span class="ident" id="5034673">par</span><span class="op" id="5034676">.</span><span class="ident" id="5034677">Type</span><span class="op" id="5034681">)</span><span class="op" id="5034682">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034687">prevLine</span>&nbsp;<span class="op" id="5034696">=</span>&nbsp;<span class="ident" id="5034698">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034715">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034786">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034830">if</span>&nbsp;<span class="ident" id="5034833">closing</span>&nbsp;<span class="op" id="5034841">:=</span>&nbsp;<span class="ident" id="5034844">p</span><span class="op" id="5034845">.</span><span class="ident" id="5034846">lineFor</span><span class="op" id="5034853">(</span><span class="ident" id="5034854">fields</span><span class="op" id="5034860">.</span><span class="ident" id="5034861">Closing</span><span class="op" id="5034868">)</span><span class="op" id="5034869">;</span>&nbsp;<span class="num" id="5034871">0</span>&nbsp;<span class="op" id="5034873">&lt;</span>&nbsp;<span class="ident" id="5034875">prevLine</span>&nbsp;<span class="op" id="5034884">&amp;&amp;</span>&nbsp;<span class="ident" id="5034887">prevLine</span>&nbsp;<span class="op" id="5034896">&lt;</span>&nbsp;<span class="ident" id="5034898">closing</span>&nbsp;<span class="op" id="5034906">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034911">p</span><span class="op" id="5034912">.</span><span class="builtinfunc" id="5034913">print</span><span class="op" id="5034918">(</span><span class="ident" id="5034919">token</span><span class="op" id="5034924">.</span><span class="ident" id="5034925">COMMA</span><span class="op" id="5034930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034935">p</span><span class="op" id="5034936">.</span><span class="ident" id="5034937">linebreak</span><span class="op" id="5034946">(</span><span class="ident" id="5034947">closing</span><span class="op" id="5034954">,</span>&nbsp;<span class="num" id="5034956">0</span><span class="op" id="5034957">,</span>&nbsp;<span class="ident" id="5034959">ignore</span><span class="op" id="5034965">,</span>&nbsp;<span class="builtintype" id="5034967">true</span><span class="op" id="5034971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5034979">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035008">if</span>&nbsp;<span class="ident" id="5035011">ws</span>&nbsp;<span class="op" id="5035014">==</span>&nbsp;<span class="ident" id="5035017">ignore</span>&nbsp;<span class="op" id="5035024">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035029">p</span><span class="op" id="5035030">.</span><span class="builtinfunc" id="5035031">print</span><span class="op" id="5035036">(</span><span class="ident" id="5035037">unindent</span><span class="op" id="5035045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035055">p</span><span class="op" id="5035056">.</span><span class="builtinfunc" id="5035057">print</span><span class="op" id="5035062">(</span><span class="ident" id="5035063">fields</span><span class="op" id="5035069">.</span><span class="ident" id="5035070">Closing</span><span class="op" id="5035077">,</span>&nbsp;<span class="ident" id="5035079">token</span><span class="op" id="5035084">.</span><span class="ident" id="5035085">RPAREN</span><span class="op" id="5035091">)</span><br>
<span class="lineno"></span><span class="op" id="5035093">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5035096">func</span>&nbsp;<span class="op" id="5035101">(</span><span class="ident" id="5035102">p</span>&nbsp;<span class="op" id="5035104">*</span><span class="ident" id="5035105">printer</span><span class="op" id="5035112">)</span>&nbsp;<span class="ident" id="5035114">signature</span><span class="op" id="5035123">(</span><span class="ident" id="5035124">params</span><span class="op" id="5035130">,</span>&nbsp;<span class="ident" id="5035132">result</span>&nbsp;<span class="op" id="5035139">*</span><span class="ident" id="5035140">ast</span><span class="op" id="5035143">.</span><span class="ident" id="5035144">FieldList</span><span class="op" id="5035153">)</span>&nbsp;<span class="op" id="5035155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035158">if</span>&nbsp;<span class="ident" id="5035161">params</span>&nbsp;<span class="op" id="5035168">!=</span>&nbsp;<span class="builtintype" id="5035171">nil</span>&nbsp;<span class="op" id="5035175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035179">p</span><span class="op" id="5035180">.</span><span class="ident" id="5035181">parameters</span><span class="op" id="5035191">(</span><span class="ident" id="5035192">params</span><span class="op" id="5035198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035201">}</span>&nbsp;<span class="keyword" id="5035203">else</span>&nbsp;<span class="op" id="5035208">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035212">p</span><span class="op" id="5035213">.</span><span class="builtinfunc" id="5035214">print</span><span class="op" id="5035219">(</span><span class="ident" id="5035220">token</span><span class="op" id="5035225">.</span><span class="ident" id="5035226">LPAREN</span><span class="op" id="5035232">,</span>&nbsp;<span class="ident" id="5035234">token</span><span class="op" id="5035239">.</span><span class="ident" id="5035240">RPAREN</span><span class="op" id="5035246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035252">n</span>&nbsp;<span class="op" id="5035254">:=</span>&nbsp;<span class="ident" id="5035257">result</span><span class="op" id="5035263">.</span><span class="ident" id="5035264">NumFields</span><span class="op" id="5035273">(</span><span class="op" id="5035274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035277">if</span>&nbsp;<span class="ident" id="5035280">n</span>&nbsp;<span class="op" id="5035282">&gt;</span>&nbsp;<span class="num" id="5035284">0</span>&nbsp;<span class="op" id="5035286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035290">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035309">p</span><span class="op" id="5035310">.</span><span class="builtinfunc" id="5035311">print</span><span class="op" id="5035316">(</span><span class="ident" id="5035317">blank</span><span class="op" id="5035322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035326">if</span>&nbsp;<span class="ident" id="5035329">n</span>&nbsp;<span class="op" id="5035331">==</span>&nbsp;<span class="num" id="5035334">1</span>&nbsp;<span class="op" id="5035336">&amp;&amp;</span>&nbsp;<span class="ident" id="5035339">result</span><span class="op" id="5035345">.</span><span class="ident" id="5035346">List</span><span class="op" id="5035350">[</span><span class="num" id="5035351">0</span><span class="op" id="5035352">]</span><span class="op" id="5035353">.</span><span class="ident" id="5035354">Names</span>&nbsp;<span class="op" id="5035360">==</span>&nbsp;<span class="builtintype" id="5035363">nil</span>&nbsp;<span class="op" id="5035367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035372">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035411">p</span><span class="op" id="5035412">.</span><span class="ident" id="5035413">expr</span><span class="op" id="5035417">(</span><span class="ident" id="5035418">stripParensAlways</span><span class="op" id="5035435">(</span><span class="ident" id="5035436">result</span><span class="op" id="5035442">.</span><span class="ident" id="5035443">List</span><span class="op" id="5035447">[</span><span class="num" id="5035448">0</span><span class="op" id="5035449">]</span><span class="op" id="5035450">.</span><span class="ident" id="5035451">Type</span><span class="op" id="5035455">)</span><span class="op" id="5035456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035461">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035474">p</span><span class="op" id="5035475">.</span><span class="ident" id="5035476">parameters</span><span class="op" id="5035486">(</span><span class="ident" id="5035487">result</span><span class="op" id="5035493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035496">}</span><br>
<span class="lineno"></span><span class="op" id="5035498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5035501">func</span>&nbsp;<span class="ident" id="5035506">identListSize</span><span class="op" id="5035519">(</span><span class="ident" id="5035520">list</span>&nbsp;<span class="op" id="5035525">[</span><span class="op" id="5035526">]</span><span class="op" id="5035527">*</span><span class="ident" id="5035528">ast</span><span class="op" id="5035531">.</span><span class="ident" id="5035532">Ident</span><span class="op" id="5035537">,</span>&nbsp;<span class="ident" id="5035539">maxSize</span>&nbsp;<span class="builtintype" id="5035547">int</span><span class="op" id="5035550">)</span>&nbsp;<span class="op" id="5035552">(</span><span class="ident" id="5035553">size</span>&nbsp;<span class="builtintype" id="5035558">int</span><span class="op" id="5035561">)</span>&nbsp;<span class="op" id="5035563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035566">for</span>&nbsp;<span class="ident" id="5035570">i</span><span class="op" id="5035571">,</span>&nbsp;<span class="ident" id="5035573">x</span>&nbsp;<span class="op" id="5035575">:=</span>&nbsp;<span class="keyword" id="5035578">range</span>&nbsp;<span class="ident" id="5035584">list</span>&nbsp;<span class="op" id="5035589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035593">if</span>&nbsp;<span class="ident" id="5035596">i</span>&nbsp;<span class="op" id="5035598">&gt;</span>&nbsp;<span class="num" id="5035600">0</span>&nbsp;<span class="op" id="5035602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035607">size</span>&nbsp;<span class="op" id="5035612">+=</span>&nbsp;<span class="builtinfunc" id="5035615">len</span><span class="op" id="5035618">(</span><span class="string" id="5035619">&#34;,&nbsp;&#34;</span><span class="op" id="5035623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035627">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035631">size</span>&nbsp;<span class="op" id="5035636">+=</span>&nbsp;<span class="ident" id="5035639">utf8</span><span class="op" id="5035643">.</span><span class="ident" id="5035644">RuneCountInString</span><span class="op" id="5035661">(</span><span class="ident" id="5035662">x</span><span class="op" id="5035663">.</span><span class="ident" id="5035664">Name</span><span class="op" id="5035668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035672">if</span>&nbsp;<span class="ident" id="5035675">size</span>&nbsp;<span class="op" id="5035680">&gt;=</span>&nbsp;<span class="ident" id="5035683">maxSize</span>&nbsp;<span class="op" id="5035691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035696">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035707">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035710">return</span><br>
<span class="lineno"></span><span class="op" id="5035717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5035720">func</span>&nbsp;<span class="op" id="5035725">(</span><span class="ident" id="5035726">p</span>&nbsp;<span class="op" id="5035728">*</span><span class="ident" id="5035729">printer</span><span class="op" id="5035736">)</span>&nbsp;<span class="ident" id="5035738">isOneLineFieldList</span><span class="op" id="5035756">(</span><span class="ident" id="5035757">list</span>&nbsp;<span class="op" id="5035762">[</span><span class="op" id="5035763">]</span><span class="op" id="5035764">*</span><span class="ident" id="5035765">ast</span><span class="op" id="5035768">.</span><span class="ident" id="5035769">Field</span><span class="op" id="5035774">)</span>&nbsp;<span class="builtintype" id="5035776">bool</span>&nbsp;<span class="op" id="5035781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035784">if</span>&nbsp;<span class="builtinfunc" id="5035787">len</span><span class="op" id="5035790">(</span><span class="ident" id="5035791">list</span><span class="op" id="5035795">)</span>&nbsp;<span class="op" id="5035797">!=</span>&nbsp;<span class="num" id="5035800">1</span>&nbsp;<span class="op" id="5035802">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035806">return</span>&nbsp;<span class="builtintype" id="5035813">false</span>&nbsp;<span class="comment" id="5035819">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035847">f</span>&nbsp;<span class="op" id="5035849">:=</span>&nbsp;<span class="ident" id="5035852">list</span><span class="op" id="5035856">[</span><span class="num" id="5035857">0</span><span class="op" id="5035858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035861">if</span>&nbsp;<span class="ident" id="5035864">f</span><span class="op" id="5035865">.</span><span class="ident" id="5035866">Tag</span>&nbsp;<span class="op" id="5035870">!=</span>&nbsp;<span class="builtintype" id="5035873">nil</span>&nbsp;<span class="op" id="5035877">||</span>&nbsp;<span class="ident" id="5035880">f</span><span class="op" id="5035881">.</span><span class="ident" id="5035882">Comment</span>&nbsp;<span class="op" id="5035890">!=</span>&nbsp;<span class="builtintype" id="5035893">nil</span>&nbsp;<span class="op" id="5035897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035901">return</span>&nbsp;<span class="builtintype" id="5035908">false</span>&nbsp;<span class="comment" id="5035914">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035950">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035976">const</span>&nbsp;<span class="ident" id="5035982">maxSize</span>&nbsp;<span class="op" id="5035990">=</span>&nbsp;<span class="num" id="5035992">30</span>&nbsp;<span class="comment" id="5035995">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036051">namesSize</span>&nbsp;<span class="op" id="5036061">:=</span>&nbsp;<span class="ident" id="5036064">identListSize</span><span class="op" id="5036077">(</span><span class="ident" id="5036078">f</span><span class="op" id="5036079">.</span><span class="ident" id="5036080">Names</span><span class="op" id="5036085">,</span>&nbsp;<span class="ident" id="5036087">maxSize</span><span class="op" id="5036094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036097">if</span>&nbsp;<span class="ident" id="5036100">namesSize</span>&nbsp;<span class="op" id="5036110">&gt;</span>&nbsp;<span class="num" id="5036112">0</span>&nbsp;<span class="op" id="5036114">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036118">namesSize</span>&nbsp;<span class="op" id="5036128">=</span>&nbsp;<span class="num" id="5036130">1</span>&nbsp;<span class="comment" id="5036132">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5036166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036169">typeSize</span>&nbsp;<span class="op" id="5036178">:=</span>&nbsp;<span class="ident" id="5036181">p</span><span class="op" id="5036182">.</span><span class="ident" id="5036183">nodeSize</span><span class="op" id="5036191">(</span><span class="ident" id="5036192">f</span><span class="op" id="5036193">.</span><span class="ident" id="5036194">Type</span><span class="op" id="5036198">,</span>&nbsp;<span class="ident" id="5036200">maxSize</span><span class="op" id="5036207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036210">return</span>&nbsp;<span class="ident" id="5036217">namesSize</span><span class="op" id="5036226">+</span><span class="ident" id="5036227">typeSize</span>&nbsp;<span class="op" id="5036236">&lt;=</span>&nbsp;<span class="ident" id="5036239">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5036247">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5036250">func</span>&nbsp;<span class="op" id="5036255">(</span><span class="ident" id="5036256">p</span>&nbsp;<span class="op" id="5036258">*</span><span class="ident" id="5036259">printer</span><span class="op" id="5036266">)</span>&nbsp;<span class="ident" id="5036268">setLineComment</span><span class="op" id="5036282">(</span><span class="ident" id="5036283">text</span>&nbsp;<span class="builtintype" id="5036288">string</span><span class="op" id="5036294">)</span>&nbsp;<span class="op" id="5036296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036299">p</span><span class="op" id="5036300">.</span><span class="ident" id="5036301">setComment</span><span class="op" id="5036311">(</span><span class="op" id="5036312">&amp;</span><span class="ident" id="5036313">ast</span><span class="op" id="5036316">.</span><span class="ident" id="5036317">CommentGroup</span><span class="op" id="5036329">{</span><span class="ident" id="5036330">List</span><span class="op" id="5036334">:</span>&nbsp;<span class="op" id="5036336">[</span><span class="op" id="5036337">]</span><span class="op" id="5036338">*</span><span class="ident" id="5036339">ast</span><span class="op" id="5036342">.</span><span class="ident" id="5036343">Comment</span><span class="op" id="5036350">{</span><span class="op" id="5036351">{</span><span class="ident" id="5036352">Slash</span><span class="op" id="5036357">:</span>&nbsp;<span class="ident" id="5036359">token</span><span class="op" id="5036364">.</span><span class="ident" id="5036365">NoPos</span><span class="op" id="5036370">,</span>&nbsp;<span class="ident" id="5036372">Text</span><span class="op" id="5036376">:</span>&nbsp;<span class="ident" id="5036378">text</span><span class="op" id="5036382">}</span><span class="op" id="5036383">}</span><span class="op" id="5036384">}</span><span class="op" id="5036385">)</span><br>
<span class="lineno"></span><span class="op" id="5036387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5036390">func</span>&nbsp;<span class="op" id="5036395">(</span><span class="ident" id="5036396">p</span>&nbsp;<span class="op" id="5036398">*</span><span class="ident" id="5036399">printer</span><span class="op" id="5036406">)</span>&nbsp;<span class="ident" id="5036408">fieldList</span><span class="op" id="5036417">(</span><span class="ident" id="5036418">fields</span>&nbsp;<span class="op" id="5036425">*</span><span class="ident" id="5036426">ast</span><span class="op" id="5036429">.</span><span class="ident" id="5036430">FieldList</span><span class="op" id="5036439">,</span>&nbsp;<span class="ident" id="5036441">isStruct</span><span class="op" id="5036449">,</span>&nbsp;<span class="ident" id="5036451">isIncomplete</span>&nbsp;<span class="builtintype" id="5036464">bool</span><span class="op" id="5036468">)</span>&nbsp;<span class="op" id="5036470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036473">lbrace</span>&nbsp;<span class="op" id="5036480">:=</span>&nbsp;<span class="ident" id="5036483">fields</span><span class="op" id="5036489">.</span><span class="ident" id="5036490">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036499">list</span>&nbsp;<span class="op" id="5036504">:=</span>&nbsp;<span class="ident" id="5036507">fields</span><span class="op" id="5036513">.</span><span class="ident" id="5036514">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036520">rbrace</span>&nbsp;<span class="op" id="5036527">:=</span>&nbsp;<span class="ident" id="5036530">fields</span><span class="op" id="5036536">.</span><span class="ident" id="5036537">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036546">hasComments</span>&nbsp;<span class="op" id="5036558">:=</span>&nbsp;<span class="ident" id="5036561">isIncomplete</span>&nbsp;<span class="op" id="5036574">||</span>&nbsp;<span class="ident" id="5036577">p</span><span class="op" id="5036578">.</span><span class="ident" id="5036579">commentBefore</span><span class="op" id="5036592">(</span><span class="ident" id="5036593">p</span><span class="op" id="5036594">.</span><span class="ident" id="5036595">posFor</span><span class="op" id="5036601">(</span><span class="ident" id="5036602">rbrace</span><span class="op" id="5036608">)</span><span class="op" id="5036609">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036612">srcIsOneLine</span>&nbsp;<span class="op" id="5036625">:=</span>&nbsp;<span class="ident" id="5036628">lbrace</span><span class="op" id="5036634">.</span><span class="ident" id="5036635">IsValid</span><span class="op" id="5036642">(</span><span class="op" id="5036643">)</span>&nbsp;<span class="op" id="5036645">&amp;&amp;</span>&nbsp;<span class="ident" id="5036648">rbrace</span><span class="op" id="5036654">.</span><span class="ident" id="5036655">IsValid</span><span class="op" id="5036662">(</span><span class="op" id="5036663">)</span>&nbsp;<span class="op" id="5036665">&amp;&amp;</span>&nbsp;<span class="ident" id="5036668">p</span><span class="op" id="5036669">.</span><span class="ident" id="5036670">lineFor</span><span class="op" id="5036677">(</span><span class="ident" id="5036678">lbrace</span><span class="op" id="5036684">)</span>&nbsp;<span class="op" id="5036686">==</span>&nbsp;<span class="ident" id="5036689">p</span><span class="op" id="5036690">.</span><span class="ident" id="5036691">lineFor</span><span class="op" id="5036698">(</span><span class="ident" id="5036699">rbrace</span><span class="op" id="5036705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036709">if</span>&nbsp;<span class="op" id="5036712">!</span><span class="ident" id="5036713">hasComments</span>&nbsp;<span class="op" id="5036725">&amp;&amp;</span>&nbsp;<span class="ident" id="5036728">srcIsOneLine</span>&nbsp;<span class="op" id="5036741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036745">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036787">if</span>&nbsp;<span class="builtinfunc" id="5036790">len</span><span class="op" id="5036793">(</span><span class="ident" id="5036794">list</span><span class="op" id="5036798">)</span>&nbsp;<span class="op" id="5036800">==</span>&nbsp;<span class="num" id="5036803">0</span>&nbsp;<span class="op" id="5036805">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036810">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036861">p</span><span class="op" id="5036862">.</span><span class="builtinfunc" id="5036863">print</span><span class="op" id="5036868">(</span><span class="ident" id="5036869">lbrace</span><span class="op" id="5036875">,</span>&nbsp;<span class="ident" id="5036877">token</span><span class="op" id="5036882">.</span><span class="ident" id="5036883">LBRACE</span><span class="op" id="5036889">,</span>&nbsp;<span class="ident" id="5036891">rbrace</span><span class="op" id="5036897">,</span>&nbsp;<span class="ident" id="5036899">token</span><span class="op" id="5036904">.</span><span class="ident" id="5036905">RBRACE</span><span class="op" id="5036911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036916">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5036925">}</span>&nbsp;<span class="keyword" id="5036927">else</span>&nbsp;<span class="keyword" id="5036932">if</span>&nbsp;<span class="ident" id="5036935">isStruct</span>&nbsp;<span class="op" id="5036944">&amp;&amp;</span>&nbsp;<span class="ident" id="5036947">p</span><span class="op" id="5036948">.</span><span class="ident" id="5036949">isOneLineFieldList</span><span class="op" id="5036967">(</span><span class="ident" id="5036968">list</span><span class="op" id="5036972">)</span>&nbsp;<span class="op" id="5036974">{</span>&nbsp;<span class="comment" id="5036976">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037008">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037047">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037105">p</span><span class="op" id="5037106">.</span><span class="builtinfunc" id="5037107">print</span><span class="op" id="5037112">(</span><span class="ident" id="5037113">lbrace</span><span class="op" id="5037119">,</span>&nbsp;<span class="ident" id="5037121">token</span><span class="op" id="5037126">.</span><span class="ident" id="5037127">LBRACE</span><span class="op" id="5037133">,</span>&nbsp;<span class="ident" id="5037135">blank</span><span class="op" id="5037140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037145">f</span>&nbsp;<span class="op" id="5037147">:=</span>&nbsp;<span class="ident" id="5037150">list</span><span class="op" id="5037154">[</span><span class="num" id="5037155">0</span><span class="op" id="5037156">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037161">for</span>&nbsp;<span class="ident" id="5037165">i</span><span class="op" id="5037166">,</span>&nbsp;<span class="ident" id="5037168">x</span>&nbsp;<span class="op" id="5037170">:=</span>&nbsp;<span class="keyword" id="5037173">range</span>&nbsp;<span class="ident" id="5037179">f</span><span class="op" id="5037180">.</span><span class="ident" id="5037181">Names</span>&nbsp;<span class="op" id="5037187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037193">if</span>&nbsp;<span class="ident" id="5037196">i</span>&nbsp;<span class="op" id="5037198">&gt;</span>&nbsp;<span class="num" id="5037200">0</span>&nbsp;<span class="op" id="5037202">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037209">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037259">p</span><span class="op" id="5037260">.</span><span class="builtinfunc" id="5037261">print</span><span class="op" id="5037266">(</span><span class="ident" id="5037267">token</span><span class="op" id="5037272">.</span><span class="ident" id="5037273">COMMA</span><span class="op" id="5037278">,</span>&nbsp;<span class="ident" id="5037280">blank</span><span class="op" id="5037285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037297">p</span><span class="op" id="5037298">.</span><span class="ident" id="5037299">expr</span><span class="op" id="5037303">(</span><span class="ident" id="5037304">x</span><span class="op" id="5037305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037310">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037315">if</span>&nbsp;<span class="builtinfunc" id="5037318">len</span><span class="op" id="5037321">(</span><span class="ident" id="5037322">f</span><span class="op" id="5037323">.</span><span class="ident" id="5037324">Names</span><span class="op" id="5037329">)</span>&nbsp;<span class="op" id="5037331">&gt;</span>&nbsp;<span class="num" id="5037333">0</span>&nbsp;<span class="op" id="5037335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037341">p</span><span class="op" id="5037342">.</span><span class="builtinfunc" id="5037343">print</span><span class="op" id="5037348">(</span><span class="ident" id="5037349">blank</span><span class="op" id="5037354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037364">p</span><span class="op" id="5037365">.</span><span class="ident" id="5037366">expr</span><span class="op" id="5037370">(</span><span class="ident" id="5037371">f</span><span class="op" id="5037372">.</span><span class="ident" id="5037373">Type</span><span class="op" id="5037377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037382">p</span><span class="op" id="5037383">.</span><span class="builtinfunc" id="5037384">print</span><span class="op" id="5037389">(</span><span class="ident" id="5037390">blank</span><span class="op" id="5037395">,</span>&nbsp;<span class="ident" id="5037397">rbrace</span><span class="op" id="5037403">,</span>&nbsp;<span class="ident" id="5037405">token</span><span class="op" id="5037410">.</span><span class="ident" id="5037411">RBRACE</span><span class="op" id="5037417">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037422">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037437">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037471">p</span><span class="op" id="5037472">.</span><span class="builtinfunc" id="5037473">print</span><span class="op" id="5037478">(</span><span class="ident" id="5037479">blank</span><span class="op" id="5037484">,</span>&nbsp;<span class="ident" id="5037486">lbrace</span><span class="op" id="5037492">,</span>&nbsp;<span class="ident" id="5037494">token</span><span class="op" id="5037499">.</span><span class="ident" id="5037500">LBRACE</span><span class="op" id="5037506">,</span>&nbsp;<span class="ident" id="5037508">indent</span><span class="op" id="5037514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037517">if</span>&nbsp;<span class="ident" id="5037520">hasComments</span>&nbsp;<span class="op" id="5037532">||</span>&nbsp;<span class="builtinfunc" id="5037535">len</span><span class="op" id="5037538">(</span><span class="ident" id="5037539">list</span><span class="op" id="5037543">)</span>&nbsp;<span class="op" id="5037545">&gt;</span>&nbsp;<span class="num" id="5037547">0</span>&nbsp;<span class="op" id="5037549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037553">p</span><span class="op" id="5037554">.</span><span class="builtinfunc" id="5037555">print</span><span class="op" id="5037560">(</span><span class="ident" id="5037561">formfeed</span><span class="op" id="5037569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037576">if</span>&nbsp;<span class="ident" id="5037579">isStruct</span>&nbsp;<span class="op" id="5037588">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037593">sep</span>&nbsp;<span class="op" id="5037597">:=</span>&nbsp;<span class="ident" id="5037600">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037607">if</span>&nbsp;<span class="builtinfunc" id="5037610">len</span><span class="op" id="5037613">(</span><span class="ident" id="5037614">list</span><span class="op" id="5037618">)</span>&nbsp;<span class="op" id="5037620">==</span>&nbsp;<span class="num" id="5037623">1</span>&nbsp;<span class="op" id="5037625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037630">sep</span>&nbsp;<span class="op" id="5037634">=</span>&nbsp;<span class="ident" id="5037636">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037648">var</span>&nbsp;<span class="ident" id="5037652">line</span>&nbsp;<span class="builtintype" id="5037657">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037663">for</span>&nbsp;<span class="ident" id="5037667">i</span><span class="op" id="5037668">,</span>&nbsp;<span class="ident" id="5037670">f</span>&nbsp;<span class="op" id="5037672">:=</span>&nbsp;<span class="keyword" id="5037675">range</span>&nbsp;<span class="ident" id="5037681">list</span>&nbsp;<span class="op" id="5037686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037691">if</span>&nbsp;<span class="ident" id="5037694">i</span>&nbsp;<span class="op" id="5037696">&gt;</span>&nbsp;<span class="num" id="5037698">0</span>&nbsp;<span class="op" id="5037700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037706">p</span><span class="op" id="5037707">.</span><span class="ident" id="5037708">linebreak</span><span class="op" id="5037717">(</span><span class="ident" id="5037718">p</span><span class="op" id="5037719">.</span><span class="ident" id="5037720">lineFor</span><span class="op" id="5037727">(</span><span class="ident" id="5037728">f</span><span class="op" id="5037729">.</span><span class="ident" id="5037730">Pos</span><span class="op" id="5037733">(</span><span class="op" id="5037734">)</span><span class="op" id="5037735">)</span><span class="op" id="5037736">,</span>&nbsp;<span class="num" id="5037738">1</span><span class="op" id="5037739">,</span>&nbsp;<span class="ident" id="5037741">ignore</span><span class="op" id="5037747">,</span>&nbsp;<span class="ident" id="5037749">p</span><span class="op" id="5037750">.</span><span class="ident" id="5037751">linesFrom</span><span class="op" id="5037760">(</span><span class="ident" id="5037761">line</span><span class="op" id="5037765">)</span>&nbsp;<span class="op" id="5037767">&gt;</span>&nbsp;<span class="num" id="5037769">0</span><span class="op" id="5037770">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037780">extraTabs</span>&nbsp;<span class="op" id="5037790">:=</span>&nbsp;<span class="num" id="5037793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037798">p</span><span class="op" id="5037799">.</span><span class="ident" id="5037800">setComment</span><span class="op" id="5037810">(</span><span class="ident" id="5037811">f</span><span class="op" id="5037812">.</span><span class="ident" id="5037813">Doc</span><span class="op" id="5037816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037821">p</span><span class="op" id="5037822">.</span><span class="ident" id="5037823">recordLine</span><span class="op" id="5037833">(</span><span class="op" id="5037834">&amp;</span><span class="ident" id="5037835">line</span><span class="op" id="5037839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037844">if</span>&nbsp;<span class="builtinfunc" id="5037847">len</span><span class="op" id="5037850">(</span><span class="ident" id="5037851">f</span><span class="op" id="5037852">.</span><span class="ident" id="5037853">Names</span><span class="op" id="5037858">)</span>&nbsp;<span class="op" id="5037860">&gt;</span>&nbsp;<span class="num" id="5037862">0</span>&nbsp;<span class="op" id="5037864">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037870">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037890">p</span><span class="op" id="5037891">.</span><span class="ident" id="5037892">identList</span><span class="op" id="5037901">(</span><span class="ident" id="5037902">f</span><span class="op" id="5037903">.</span><span class="ident" id="5037904">Names</span><span class="op" id="5037909">,</span>&nbsp;<span class="builtintype" id="5037911">false</span><span class="op" id="5037916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037922">p</span><span class="op" id="5037923">.</span><span class="builtinfunc" id="5037924">print</span><span class="op" id="5037929">(</span><span class="ident" id="5037930">sep</span><span class="op" id="5037933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037939">p</span><span class="op" id="5037940">.</span><span class="ident" id="5037941">expr</span><span class="op" id="5037945">(</span><span class="ident" id="5037946">f</span><span class="op" id="5037947">.</span><span class="ident" id="5037948">Type</span><span class="op" id="5037952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037958">extraTabs</span>&nbsp;<span class="op" id="5037968">=</span>&nbsp;<span class="num" id="5037970">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037975">}</span>&nbsp;<span class="keyword" id="5037977">else</span>&nbsp;<span class="op" id="5037982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037988">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038011">p</span><span class="op" id="5038012">.</span><span class="ident" id="5038013">expr</span><span class="op" id="5038017">(</span><span class="ident" id="5038018">f</span><span class="op" id="5038019">.</span><span class="ident" id="5038020">Type</span><span class="op" id="5038024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038030">extraTabs</span>&nbsp;<span class="op" id="5038040">=</span>&nbsp;<span class="num" id="5038042">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038047">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038052">if</span>&nbsp;<span class="ident" id="5038055">f</span><span class="op" id="5038056">.</span><span class="ident" id="5038057">Tag</span>&nbsp;<span class="op" id="5038061">!=</span>&nbsp;<span class="builtintype" id="5038064">nil</span>&nbsp;<span class="op" id="5038068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038074">if</span>&nbsp;<span class="builtinfunc" id="5038077">len</span><span class="op" id="5038080">(</span><span class="ident" id="5038081">f</span><span class="op" id="5038082">.</span><span class="ident" id="5038083">Names</span><span class="op" id="5038088">)</span>&nbsp;<span class="op" id="5038090">&gt;</span>&nbsp;<span class="num" id="5038092">0</span>&nbsp;<span class="op" id="5038094">&amp;&amp;</span>&nbsp;<span class="ident" id="5038097">sep</span>&nbsp;<span class="op" id="5038101">==</span>&nbsp;<span class="ident" id="5038104">vtab</span>&nbsp;<span class="op" id="5038109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038116">p</span><span class="op" id="5038117">.</span><span class="builtinfunc" id="5038118">print</span><span class="op" id="5038123">(</span><span class="ident" id="5038124">sep</span><span class="op" id="5038127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038139">p</span><span class="op" id="5038140">.</span><span class="builtinfunc" id="5038141">print</span><span class="op" id="5038146">(</span><span class="ident" id="5038147">sep</span><span class="op" id="5038150">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038156">p</span><span class="op" id="5038157">.</span><span class="ident" id="5038158">expr</span><span class="op" id="5038162">(</span><span class="ident" id="5038163">f</span><span class="op" id="5038164">.</span><span class="ident" id="5038165">Tag</span><span class="op" id="5038168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038174">extraTabs</span>&nbsp;<span class="op" id="5038184">=</span>&nbsp;<span class="num" id="5038186">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038196">if</span>&nbsp;<span class="ident" id="5038199">f</span><span class="op" id="5038200">.</span><span class="ident" id="5038201">Comment</span>&nbsp;<span class="op" id="5038209">!=</span>&nbsp;<span class="builtintype" id="5038212">nil</span>&nbsp;<span class="op" id="5038216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038222">for</span>&nbsp;<span class="op" id="5038226">;</span>&nbsp;<span class="ident" id="5038228">extraTabs</span>&nbsp;<span class="op" id="5038238">&gt;</span>&nbsp;<span class="num" id="5038240">0</span><span class="op" id="5038241">;</span>&nbsp;<span class="ident" id="5038243">extraTabs</span><span class="op" id="5038252">--</span>&nbsp;<span class="op" id="5038255">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038262">p</span><span class="op" id="5038263">.</span><span class="builtinfunc" id="5038264">print</span><span class="op" id="5038269">(</span><span class="ident" id="5038270">sep</span><span class="op" id="5038273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038285">p</span><span class="op" id="5038286">.</span><span class="ident" id="5038287">setComment</span><span class="op" id="5038297">(</span><span class="ident" id="5038298">f</span><span class="op" id="5038299">.</span><span class="ident" id="5038300">Comment</span><span class="op" id="5038307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038316">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038320">if</span>&nbsp;<span class="ident" id="5038323">isIncomplete</span>&nbsp;<span class="op" id="5038336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038341">if</span>&nbsp;<span class="builtinfunc" id="5038344">len</span><span class="op" id="5038347">(</span><span class="ident" id="5038348">list</span><span class="op" id="5038352">)</span>&nbsp;<span class="op" id="5038354">&gt;</span>&nbsp;<span class="num" id="5038356">0</span>&nbsp;<span class="op" id="5038358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038364">p</span><span class="op" id="5038365">.</span><span class="builtinfunc" id="5038366">print</span><span class="op" id="5038371">(</span><span class="ident" id="5038372">formfeed</span><span class="op" id="5038380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038390">p</span><span class="op" id="5038391">.</span><span class="ident" id="5038392">flush</span><span class="op" id="5038397">(</span><span class="ident" id="5038398">p</span><span class="op" id="5038399">.</span><span class="ident" id="5038400">posFor</span><span class="op" id="5038406">(</span><span class="ident" id="5038407">rbrace</span><span class="op" id="5038413">)</span><span class="op" id="5038414">,</span>&nbsp;<span class="ident" id="5038416">token</span><span class="op" id="5038421">.</span><span class="ident" id="5038422">RBRACE</span><span class="op" id="5038428">)</span>&nbsp;<span class="comment" id="5038430">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038482">p</span><span class="op" id="5038483">.</span><span class="ident" id="5038484">setLineComment</span><span class="op" id="5038498">(</span><span class="string" id="5038499">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5038542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038550">}</span>&nbsp;<span class="keyword" id="5038552">else</span>&nbsp;<span class="op" id="5038557">{</span>&nbsp;<span class="comment" id="5038559">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038575">var</span>&nbsp;<span class="ident" id="5038579">line</span>&nbsp;<span class="builtintype" id="5038584">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038590">for</span>&nbsp;<span class="ident" id="5038594">i</span><span class="op" id="5038595">,</span>&nbsp;<span class="ident" id="5038597">f</span>&nbsp;<span class="op" id="5038599">:=</span>&nbsp;<span class="keyword" id="5038602">range</span>&nbsp;<span class="ident" id="5038608">list</span>&nbsp;<span class="op" id="5038613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038618">if</span>&nbsp;<span class="ident" id="5038621">i</span>&nbsp;<span class="op" id="5038623">&gt;</span>&nbsp;<span class="num" id="5038625">0</span>&nbsp;<span class="op" id="5038627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038633">p</span><span class="op" id="5038634">.</span><span class="ident" id="5038635">linebreak</span><span class="op" id="5038644">(</span><span class="ident" id="5038645">p</span><span class="op" id="5038646">.</span><span class="ident" id="5038647">lineFor</span><span class="op" id="5038654">(</span><span class="ident" id="5038655">f</span><span class="op" id="5038656">.</span><span class="ident" id="5038657">Pos</span><span class="op" id="5038660">(</span><span class="op" id="5038661">)</span><span class="op" id="5038662">)</span><span class="op" id="5038663">,</span>&nbsp;<span class="num" id="5038665">1</span><span class="op" id="5038666">,</span>&nbsp;<span class="ident" id="5038668">ignore</span><span class="op" id="5038674">,</span>&nbsp;<span class="ident" id="5038676">p</span><span class="op" id="5038677">.</span><span class="ident" id="5038678">linesFrom</span><span class="op" id="5038687">(</span><span class="ident" id="5038688">line</span><span class="op" id="5038692">)</span>&nbsp;<span class="op" id="5038694">&gt;</span>&nbsp;<span class="num" id="5038696">0</span><span class="op" id="5038697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038702">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038707">p</span><span class="op" id="5038708">.</span><span class="ident" id="5038709">setComment</span><span class="op" id="5038719">(</span><span class="ident" id="5038720">f</span><span class="op" id="5038721">.</span><span class="ident" id="5038722">Doc</span><span class="op" id="5038725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038730">p</span><span class="op" id="5038731">.</span><span class="ident" id="5038732">recordLine</span><span class="op" id="5038742">(</span><span class="op" id="5038743">&amp;</span><span class="ident" id="5038744">line</span><span class="op" id="5038748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038753">if</span>&nbsp;<span class="ident" id="5038756">ftyp</span><span class="op" id="5038760">,</span>&nbsp;<span class="ident" id="5038762">isFtyp</span>&nbsp;<span class="op" id="5038769">:=</span>&nbsp;<span class="ident" id="5038772">f</span><span class="op" id="5038773">.</span><span class="ident" id="5038774">Type</span><span class="op" id="5038778">.</span><span class="op" id="5038779">(</span><span class="op" id="5038780">*</span><span class="ident" id="5038781">ast</span><span class="op" id="5038784">.</span><span class="ident" id="5038785">FuncType</span><span class="op" id="5038793">)</span><span class="op" id="5038794">;</span>&nbsp;<span class="ident" id="5038796">isFtyp</span>&nbsp;<span class="op" id="5038803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5038809">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038823">p</span><span class="op" id="5038824">.</span><span class="ident" id="5038825">expr</span><span class="op" id="5038829">(</span><span class="ident" id="5038830">f</span><span class="op" id="5038831">.</span><span class="ident" id="5038832">Names</span><span class="op" id="5038837">[</span><span class="num" id="5038838">0</span><span class="op" id="5038839">]</span><span class="op" id="5038840">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038846">p</span><span class="op" id="5038847">.</span><span class="ident" id="5038848">signature</span><span class="op" id="5038857">(</span><span class="ident" id="5038858">ftyp</span><span class="op" id="5038862">.</span><span class="ident" id="5038863">Params</span><span class="op" id="5038869">,</span>&nbsp;<span class="ident" id="5038871">ftyp</span><span class="op" id="5038875">.</span><span class="ident" id="5038876">Results</span><span class="op" id="5038883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038888">}</span>&nbsp;<span class="keyword" id="5038890">else</span>&nbsp;<span class="op" id="5038895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5038901">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038927">p</span><span class="op" id="5038928">.</span><span class="ident" id="5038929">expr</span><span class="op" id="5038933">(</span><span class="ident" id="5038934">f</span><span class="op" id="5038935">.</span><span class="ident" id="5038936">Type</span><span class="op" id="5038940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038945">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038950">p</span><span class="op" id="5038951">.</span><span class="ident" id="5038952">setComment</span><span class="op" id="5038962">(</span><span class="ident" id="5038963">f</span><span class="op" id="5038964">.</span><span class="ident" id="5038965">Comment</span><span class="op" id="5038972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038980">if</span>&nbsp;<span class="ident" id="5038983">isIncomplete</span>&nbsp;<span class="op" id="5038996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039001">if</span>&nbsp;<span class="builtinfunc" id="5039004">len</span><span class="op" id="5039007">(</span><span class="ident" id="5039008">list</span><span class="op" id="5039012">)</span>&nbsp;<span class="op" id="5039014">&gt;</span>&nbsp;<span class="num" id="5039016">0</span>&nbsp;<span class="op" id="5039018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039024">p</span><span class="op" id="5039025">.</span><span class="builtinfunc" id="5039026">print</span><span class="op" id="5039031">(</span><span class="ident" id="5039032">formfeed</span><span class="op" id="5039040">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039050">p</span><span class="op" id="5039051">.</span><span class="ident" id="5039052">flush</span><span class="op" id="5039057">(</span><span class="ident" id="5039058">p</span><span class="op" id="5039059">.</span><span class="ident" id="5039060">posFor</span><span class="op" id="5039066">(</span><span class="ident" id="5039067">rbrace</span><span class="op" id="5039073">)</span><span class="op" id="5039074">,</span>&nbsp;<span class="ident" id="5039076">token</span><span class="op" id="5039081">.</span><span class="ident" id="5039082">RBRACE</span><span class="op" id="5039088">)</span>&nbsp;<span class="comment" id="5039090">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039142">p</span><span class="op" id="5039143">.</span><span class="ident" id="5039144">setLineComment</span><span class="op" id="5039158">(</span><span class="string" id="5039159">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5039203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039214">p</span><span class="op" id="5039215">.</span><span class="builtinfunc" id="5039216">print</span><span class="op" id="5039221">(</span><span class="ident" id="5039222">unindent</span><span class="op" id="5039230">,</span>&nbsp;<span class="ident" id="5039232">formfeed</span><span class="op" id="5039240">,</span>&nbsp;<span class="ident" id="5039242">rbrace</span><span class="op" id="5039248">,</span>&nbsp;<span class="ident" id="5039250">token</span><span class="op" id="5039255">.</span><span class="ident" id="5039256">RBRACE</span><span class="op" id="5039262">)</span><br>
<span class="lineno"></span><span class="op" id="5039264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5039267">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5039347">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5039363">func</span>&nbsp;<span class="ident" id="5039368">walkBinary</span><span class="op" id="5039378">(</span><span class="ident" id="5039379">e</span>&nbsp;<span class="op" id="5039381">*</span><span class="ident" id="5039382">ast</span><span class="op" id="5039385">.</span><span class="ident" id="5039386">BinaryExpr</span><span class="op" id="5039396">)</span>&nbsp;<span class="op" id="5039398">(</span><span class="ident" id="5039399">has4</span><span class="op" id="5039403">,</span>&nbsp;<span class="ident" id="5039405">has5</span>&nbsp;<span class="builtintype" id="5039410">bool</span><span class="op" id="5039414">,</span>&nbsp;<span class="ident" id="5039416">maxProblem</span>&nbsp;<span class="builtintype" id="5039427">int</span><span class="op" id="5039430">)</span>&nbsp;<span class="op" id="5039432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039435">switch</span>&nbsp;<span class="ident" id="5039442">e</span><span class="op" id="5039443">.</span><span class="ident" id="5039444">Op</span><span class="op" id="5039446">.</span><span class="ident" id="5039447">Precedence</span><span class="op" id="5039457">(</span><span class="op" id="5039458">)</span>&nbsp;<span class="op" id="5039460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039463">case</span>&nbsp;<span class="num" id="5039468">4</span><span class="op" id="5039469">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039473">has4</span>&nbsp;<span class="op" id="5039478">=</span>&nbsp;<span class="builtintype" id="5039480">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039486">case</span>&nbsp;<span class="num" id="5039491">5</span><span class="op" id="5039492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039496">has5</span>&nbsp;<span class="op" id="5039501">=</span>&nbsp;<span class="builtintype" id="5039503">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039513">switch</span>&nbsp;<span class="ident" id="5039520">l</span>&nbsp;<span class="op" id="5039522">:=</span>&nbsp;<span class="ident" id="5039525">e</span><span class="op" id="5039526">.</span><span class="ident" id="5039527">X</span><span class="op" id="5039528">.</span><span class="op" id="5039529">(</span><span class="keyword" id="5039530">type</span><span class="op" id="5039534">)</span>&nbsp;<span class="op" id="5039536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039539">case</span>&nbsp;<span class="op" id="5039544">*</span><span class="ident" id="5039545">ast</span><span class="op" id="5039548">.</span><span class="ident" id="5039549">BinaryExpr</span><span class="op" id="5039559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039563">if</span>&nbsp;<span class="ident" id="5039566">l</span><span class="op" id="5039567">.</span><span class="ident" id="5039568">Op</span><span class="op" id="5039570">.</span><span class="ident" id="5039571">Precedence</span><span class="op" id="5039581">(</span><span class="op" id="5039582">)</span>&nbsp;<span class="op" id="5039584">&lt;</span>&nbsp;<span class="ident" id="5039586">e</span><span class="op" id="5039587">.</span><span class="ident" id="5039588">Op</span><span class="op" id="5039590">.</span><span class="ident" id="5039591">Precedence</span><span class="op" id="5039601">(</span><span class="op" id="5039602">)</span>&nbsp;<span class="op" id="5039604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039609">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039640">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039696">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039708">h4</span><span class="op" id="5039710">,</span>&nbsp;<span class="ident" id="5039712">h5</span><span class="op" id="5039714">,</span>&nbsp;<span class="ident" id="5039716">mp</span>&nbsp;<span class="op" id="5039719">:=</span>&nbsp;<span class="ident" id="5039722">walkBinary</span><span class="op" id="5039732">(</span><span class="ident" id="5039733">l</span><span class="op" id="5039734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039738">has4</span>&nbsp;<span class="op" id="5039743">=</span>&nbsp;<span class="ident" id="5039745">has4</span>&nbsp;<span class="op" id="5039750">||</span>&nbsp;<span class="ident" id="5039753">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039758">has5</span>&nbsp;<span class="op" id="5039763">=</span>&nbsp;<span class="ident" id="5039765">has5</span>&nbsp;<span class="op" id="5039770">||</span>&nbsp;<span class="ident" id="5039773">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039778">if</span>&nbsp;<span class="ident" id="5039781">maxProblem</span>&nbsp;<span class="op" id="5039792">&lt;</span>&nbsp;<span class="ident" id="5039794">mp</span>&nbsp;<span class="op" id="5039797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039802">maxProblem</span>&nbsp;<span class="op" id="5039813">=</span>&nbsp;<span class="ident" id="5039815">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039827">switch</span>&nbsp;<span class="ident" id="5039834">r</span>&nbsp;<span class="op" id="5039836">:=</span>&nbsp;<span class="ident" id="5039839">e</span><span class="op" id="5039840">.</span><span class="ident" id="5039841">Y</span><span class="op" id="5039842">.</span><span class="op" id="5039843">(</span><span class="keyword" id="5039844">type</span><span class="op" id="5039848">)</span>&nbsp;<span class="op" id="5039850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039853">case</span>&nbsp;<span class="op" id="5039858">*</span><span class="ident" id="5039859">ast</span><span class="op" id="5039862">.</span><span class="ident" id="5039863">BinaryExpr</span><span class="op" id="5039873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039877">if</span>&nbsp;<span class="ident" id="5039880">r</span><span class="op" id="5039881">.</span><span class="ident" id="5039882">Op</span><span class="op" id="5039884">.</span><span class="ident" id="5039885">Precedence</span><span class="op" id="5039895">(</span><span class="op" id="5039896">)</span>&nbsp;<span class="op" id="5039898">&lt;=</span>&nbsp;<span class="ident" id="5039901">e</span><span class="op" id="5039902">.</span><span class="ident" id="5039903">Op</span><span class="op" id="5039905">.</span><span class="ident" id="5039906">Precedence</span><span class="op" id="5039916">(</span><span class="op" id="5039917">)</span>&nbsp;<span class="op" id="5039919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039924">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039955">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040011">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040023">h4</span><span class="op" id="5040025">,</span>&nbsp;<span class="ident" id="5040027">h5</span><span class="op" id="5040029">,</span>&nbsp;<span class="ident" id="5040031">mp</span>&nbsp;<span class="op" id="5040034">:=</span>&nbsp;<span class="ident" id="5040037">walkBinary</span><span class="op" id="5040047">(</span><span class="ident" id="5040048">r</span><span class="op" id="5040049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040053">has4</span>&nbsp;<span class="op" id="5040058">=</span>&nbsp;<span class="ident" id="5040060">has4</span>&nbsp;<span class="op" id="5040065">||</span>&nbsp;<span class="ident" id="5040068">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040073">has5</span>&nbsp;<span class="op" id="5040078">=</span>&nbsp;<span class="ident" id="5040080">has5</span>&nbsp;<span class="op" id="5040085">||</span>&nbsp;<span class="ident" id="5040088">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040093">if</span>&nbsp;<span class="ident" id="5040096">maxProblem</span>&nbsp;<span class="op" id="5040107">&lt;</span>&nbsp;<span class="ident" id="5040109">mp</span>&nbsp;<span class="op" id="5040112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040117">maxProblem</span>&nbsp;<span class="op" id="5040128">=</span>&nbsp;<span class="ident" id="5040130">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040139">case</span>&nbsp;<span class="op" id="5040144">*</span><span class="ident" id="5040145">ast</span><span class="op" id="5040148">.</span><span class="ident" id="5040149">StarExpr</span><span class="op" id="5040157">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040161">if</span>&nbsp;<span class="ident" id="5040164">e</span><span class="op" id="5040165">.</span><span class="ident" id="5040166">Op</span>&nbsp;<span class="op" id="5040169">==</span>&nbsp;<span class="ident" id="5040172">token</span><span class="op" id="5040177">.</span><span class="ident" id="5040178">QUO</span>&nbsp;<span class="op" id="5040182">{</span>&nbsp;<span class="comment" id="5040184">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040195">maxProblem</span>&nbsp;<span class="op" id="5040206">=</span>&nbsp;<span class="num" id="5040208">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040216">case</span>&nbsp;<span class="op" id="5040221">*</span><span class="ident" id="5040222">ast</span><span class="op" id="5040225">.</span><span class="ident" id="5040226">UnaryExpr</span><span class="op" id="5040235">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040239">switch</span>&nbsp;<span class="ident" id="5040246">e</span><span class="op" id="5040247">.</span><span class="ident" id="5040248">Op</span><span class="op" id="5040250">.</span><span class="ident" id="5040251">String</span><span class="op" id="5040257">(</span><span class="op" id="5040258">)</span>&nbsp;<span class="op" id="5040260">+</span>&nbsp;<span class="ident" id="5040262">r</span><span class="op" id="5040263">.</span><span class="ident" id="5040264">Op</span><span class="op" id="5040266">.</span><span class="ident" id="5040267">String</span><span class="op" id="5040273">(</span><span class="op" id="5040274">)</span>&nbsp;<span class="op" id="5040276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040280">case</span>&nbsp;<span class="string" id="5040285">&#34;/*&#34;</span><span class="op" id="5040289">,</span>&nbsp;<span class="string" id="5040291">&#34;&amp;&amp;&#34;</span><span class="op" id="5040295">,</span>&nbsp;<span class="string" id="5040297">&#34;&amp;^&#34;</span><span class="op" id="5040301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040306">maxProblem</span>&nbsp;<span class="op" id="5040317">=</span>&nbsp;<span class="num" id="5040319">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040323">case</span>&nbsp;<span class="string" id="5040328">&#34;++&#34;</span><span class="op" id="5040332">,</span>&nbsp;<span class="string" id="5040334">&#34;--&#34;</span><span class="op" id="5040338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040343">if</span>&nbsp;<span class="ident" id="5040346">maxProblem</span>&nbsp;<span class="op" id="5040357">&lt;</span>&nbsp;<span class="num" id="5040359">4</span>&nbsp;<span class="op" id="5040361">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040367">maxProblem</span>&nbsp;<span class="op" id="5040378">=</span>&nbsp;<span class="num" id="5040380">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040395">return</span><br>
<span class="lineno">560</span><span class="op" id="5040402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5040405">func</span>&nbsp;<span class="ident" id="5040410">cutoff</span><span class="op" id="5040416">(</span><span class="ident" id="5040417">e</span>&nbsp;<span class="op" id="5040419">*</span><span class="ident" id="5040420">ast</span><span class="op" id="5040423">.</span><span class="ident" id="5040424">BinaryExpr</span><span class="op" id="5040434">,</span>&nbsp;<span class="ident" id="5040436">depth</span>&nbsp;<span class="builtintype" id="5040442">int</span><span class="op" id="5040445">)</span>&nbsp;<span class="builtintype" id="5040447">int</span>&nbsp;<span class="op" id="5040451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040454">has4</span><span class="op" id="5040458">,</span>&nbsp;<span class="ident" id="5040460">has5</span><span class="op" id="5040464">,</span>&nbsp;<span class="ident" id="5040466">maxProblem</span>&nbsp;<span class="op" id="5040477">:=</span>&nbsp;<span class="ident" id="5040480">walkBinary</span><span class="op" id="5040490">(</span><span class="ident" id="5040491">e</span><span class="op" id="5040492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040495">if</span>&nbsp;<span class="ident" id="5040498">maxProblem</span>&nbsp;<span class="op" id="5040509">&gt;</span>&nbsp;<span class="num" id="5040511">0</span>&nbsp;<span class="op" id="5040513">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040517">return</span>&nbsp;<span class="ident" id="5040524">maxProblem</span>&nbsp;<span class="op" id="5040535">+</span>&nbsp;<span class="num" id="5040537">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040543">if</span>&nbsp;<span class="ident" id="5040546">has4</span>&nbsp;<span class="op" id="5040551">&amp;&amp;</span>&nbsp;<span class="ident" id="5040554">has5</span>&nbsp;<span class="op" id="5040559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040563">if</span>&nbsp;<span class="ident" id="5040566">depth</span>&nbsp;<span class="op" id="5040572">==</span>&nbsp;<span class="num" id="5040575">1</span>&nbsp;<span class="op" id="5040577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040582">return</span>&nbsp;<span class="num" id="5040589">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040597">return</span>&nbsp;<span class="num" id="5040604">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040610">if</span>&nbsp;<span class="ident" id="5040613">depth</span>&nbsp;<span class="op" id="5040619">==</span>&nbsp;<span class="num" id="5040622">1</span>&nbsp;<span class="op" id="5040624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040628">return</span>&nbsp;<span class="num" id="5040635">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040641">return</span>&nbsp;<span class="num" id="5040648">4</span><br>
<span class="lineno"></span><span class="op" id="5040650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5040653">func</span>&nbsp;<span class="ident" id="5040658">diffPrec</span><span class="op" id="5040666">(</span><span class="ident" id="5040667">expr</span>&nbsp;<span class="ident" id="5040672">ast</span><span class="op" id="5040675">.</span><span class="ident" id="5040676">Expr</span><span class="op" id="5040680">,</span>&nbsp;<span class="ident" id="5040682">prec</span>&nbsp;<span class="builtintype" id="5040687">int</span><span class="op" id="5040690">)</span>&nbsp;<span class="builtintype" id="5040692">int</span>&nbsp;<span class="op" id="5040696">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040699">x</span><span class="op" id="5040700">,</span>&nbsp;<span class="ident" id="5040702">ok</span>&nbsp;<span class="op" id="5040705">:=</span>&nbsp;<span class="ident" id="5040708">expr</span><span class="op" id="5040712">.</span><span class="op" id="5040713">(</span><span class="op" id="5040714">*</span><span class="ident" id="5040715">ast</span><span class="op" id="5040718">.</span><span class="ident" id="5040719">BinaryExpr</span><span class="op" id="5040729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040732">if</span>&nbsp;<span class="op" id="5040735">!</span><span class="ident" id="5040736">ok</span>&nbsp;<span class="op" id="5040739">||</span>&nbsp;<span class="ident" id="5040742">prec</span>&nbsp;<span class="op" id="5040747">!=</span>&nbsp;<span class="ident" id="5040750">x</span><span class="op" id="5040751">.</span><span class="ident" id="5040752">Op</span><span class="op" id="5040754">.</span><span class="ident" id="5040755">Precedence</span><span class="op" id="5040765">(</span><span class="op" id="5040766">)</span>&nbsp;<span class="op" id="5040768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040772">return</span>&nbsp;<span class="num" id="5040779">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040785">return</span>&nbsp;<span class="num" id="5040792">0</span><br>
<span class="lineno">585</span><span class="op" id="5040794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5040797">func</span>&nbsp;<span class="ident" id="5040802">reduceDepth</span><span class="op" id="5040813">(</span><span class="ident" id="5040814">depth</span>&nbsp;<span class="builtintype" id="5040820">int</span><span class="op" id="5040823">)</span>&nbsp;<span class="builtintype" id="5040825">int</span>&nbsp;<span class="op" id="5040829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040832">depth</span><span class="op" id="5040837">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040841">if</span>&nbsp;<span class="ident" id="5040844">depth</span>&nbsp;<span class="op" id="5040850">&lt;</span>&nbsp;<span class="num" id="5040852">1</span>&nbsp;<span class="op" id="5040854">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040858">depth</span>&nbsp;<span class="op" id="5040864">=</span>&nbsp;<span class="num" id="5040866">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040872">return</span>&nbsp;<span class="ident" id="5040879">depth</span><br>
<span class="lineno"></span><span class="op" id="5040885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5040888">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5040956">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5041022">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5041061">//</span><br>
<span class="lineno"></span><span class="comment" id="5041064">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5041088">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5041128">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5041156">//&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5041194">//&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5041214">//&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5041234">//</span><br>
<span class="lineno"></span><span class="comment" id="5041237">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5041313">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5041400">//</span><br>
<span class="lineno"></span><span class="comment" id="5041403">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5041479">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5041556">//</span><br>
<span class="lineno"></span><span class="comment" id="5041559">//&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5041627">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5041698">//</span><br>
<span class="lineno">615</span><span class="comment" id="5041701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5041710">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5041719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;^&nbsp;&nbsp;&nbsp;&nbsp;6</span><br>
<span class="lineno"></span><span class="comment" id="5041728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++&nbsp;&nbsp;&nbsp;&nbsp;5</span><br>
<span class="lineno"></span><span class="comment" id="5041737">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;5</span><br>
<span class="lineno">620</span><span class="comment" id="5041746">//</span><br>
<span class="lineno"></span><span class="comment" id="5041749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5041815">//</span><br>
<span class="lineno"></span><span class="comment" id="5041818">//&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5041892">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5041957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5042005">//</span><br>
<span class="lineno"></span><span class="comment" id="5042008">//&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5042082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5042135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5042183">//</span><br>
<span class="lineno"></span><span class="keyword" id="5042186">func</span>&nbsp;<span class="op" id="5042191">(</span><span class="ident" id="5042192">p</span>&nbsp;<span class="op" id="5042194">*</span><span class="ident" id="5042195">printer</span><span class="op" id="5042202">)</span>&nbsp;<span class="ident" id="5042204">binaryExpr</span><span class="op" id="5042214">(</span><span class="ident" id="5042215">x</span>&nbsp;<span class="op" id="5042217">*</span><span class="ident" id="5042218">ast</span><span class="op" id="5042221">.</span><span class="ident" id="5042222">BinaryExpr</span><span class="op" id="5042232">,</span>&nbsp;<span class="ident" id="5042234">prec1</span><span class="op" id="5042239">,</span>&nbsp;<span class="ident" id="5042241">cutoff</span><span class="op" id="5042247">,</span>&nbsp;<span class="ident" id="5042249">depth</span>&nbsp;<span class="builtintype" id="5042255">int</span><span class="op" id="5042258">)</span>&nbsp;<span class="op" id="5042260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042263">prec</span>&nbsp;<span class="op" id="5042268">:=</span>&nbsp;<span class="ident" id="5042271">x</span><span class="op" id="5042272">.</span><span class="ident" id="5042273">Op</span><span class="op" id="5042275">.</span><span class="ident" id="5042276">Precedence</span><span class="op" id="5042286">(</span><span class="op" id="5042287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042290">if</span>&nbsp;<span class="ident" id="5042293">prec</span>&nbsp;<span class="op" id="5042298">&lt;</span>&nbsp;<span class="ident" id="5042300">prec1</span>&nbsp;<span class="op" id="5042306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042310">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042334">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042470">p</span><span class="op" id="5042471">.</span><span class="builtinfunc" id="5042472">print</span><span class="op" id="5042477">(</span><span class="ident" id="5042478">token</span><span class="op" id="5042483">.</span><span class="ident" id="5042484">LPAREN</span><span class="op" id="5042490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042494">p</span><span class="op" id="5042495">.</span><span class="ident" id="5042496">expr0</span><span class="op" id="5042501">(</span><span class="ident" id="5042502">x</span><span class="op" id="5042503">,</span>&nbsp;<span class="ident" id="5042505">reduceDepth</span><span class="op" id="5042516">(</span><span class="ident" id="5042517">depth</span><span class="op" id="5042522">)</span><span class="op" id="5042523">)</span>&nbsp;<span class="comment" id="5042525">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042566">p</span><span class="op" id="5042567">.</span><span class="builtinfunc" id="5042568">print</span><span class="op" id="5042573">(</span><span class="ident" id="5042574">token</span><span class="op" id="5042579">.</span><span class="ident" id="5042580">RPAREN</span><span class="op" id="5042586">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042590">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042602">printBlank</span>&nbsp;<span class="op" id="5042613">:=</span>&nbsp;<span class="ident" id="5042616">prec</span>&nbsp;<span class="op" id="5042621">&lt;</span>&nbsp;<span class="ident" id="5042623">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042632">ws</span>&nbsp;<span class="op" id="5042635">:=</span>&nbsp;<span class="ident" id="5042638">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042646">p</span><span class="op" id="5042647">.</span><span class="ident" id="5042648">expr1</span><span class="op" id="5042653">(</span><span class="ident" id="5042654">x</span><span class="op" id="5042655">.</span><span class="ident" id="5042656">X</span><span class="op" id="5042657">,</span>&nbsp;<span class="ident" id="5042659">prec</span><span class="op" id="5042663">,</span>&nbsp;<span class="ident" id="5042665">depth</span><span class="op" id="5042670">+</span><span class="ident" id="5042671">diffPrec</span><span class="op" id="5042679">(</span><span class="ident" id="5042680">x</span><span class="op" id="5042681">.</span><span class="ident" id="5042682">X</span><span class="op" id="5042683">,</span>&nbsp;<span class="ident" id="5042685">prec</span><span class="op" id="5042689">)</span><span class="op" id="5042690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042693">if</span>&nbsp;<span class="ident" id="5042696">printBlank</span>&nbsp;<span class="op" id="5042707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042711">p</span><span class="op" id="5042712">.</span><span class="builtinfunc" id="5042713">print</span><span class="op" id="5042718">(</span><span class="ident" id="5042719">blank</span><span class="op" id="5042724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042727">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042730">xline</span>&nbsp;<span class="op" id="5042736">:=</span>&nbsp;<span class="ident" id="5042739">p</span><span class="op" id="5042740">.</span><span class="ident" id="5042741">pos</span><span class="op" id="5042744">.</span><span class="ident" id="5042745">Line</span>&nbsp;<span class="comment" id="5042750">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042804">yline</span>&nbsp;<span class="op" id="5042810">:=</span>&nbsp;<span class="ident" id="5042813">p</span><span class="op" id="5042814">.</span><span class="ident" id="5042815">lineFor</span><span class="op" id="5042822">(</span><span class="ident" id="5042823">x</span><span class="op" id="5042824">.</span><span class="ident" id="5042825">Y</span><span class="op" id="5042826">.</span><span class="ident" id="5042827">Pos</span><span class="op" id="5042830">(</span><span class="op" id="5042831">)</span><span class="op" id="5042832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042835">p</span><span class="op" id="5042836">.</span><span class="builtinfunc" id="5042837">print</span><span class="op" id="5042842">(</span><span class="ident" id="5042843">x</span><span class="op" id="5042844">.</span><span class="ident" id="5042845">OpPos</span><span class="op" id="5042850">,</span>&nbsp;<span class="ident" id="5042852">x</span><span class="op" id="5042853">.</span><span class="ident" id="5042854">Op</span><span class="op" id="5042856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042859">if</span>&nbsp;<span class="ident" id="5042862">xline</span>&nbsp;<span class="op" id="5042868">!=</span>&nbsp;<span class="ident" id="5042871">yline</span>&nbsp;<span class="op" id="5042877">&amp;&amp;</span>&nbsp;<span class="ident" id="5042880">xline</span>&nbsp;<span class="op" id="5042886">&gt;</span>&nbsp;<span class="num" id="5042888">0</span>&nbsp;<span class="op" id="5042890">&amp;&amp;</span>&nbsp;<span class="ident" id="5042893">yline</span>&nbsp;<span class="op" id="5042899">&gt;</span>&nbsp;<span class="num" id="5042901">0</span>&nbsp;<span class="op" id="5042903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042907">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042969">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042988">if</span>&nbsp;<span class="ident" id="5042991">p</span><span class="op" id="5042992">.</span><span class="ident" id="5042993">linebreak</span><span class="op" id="5043002">(</span><span class="ident" id="5043003">yline</span><span class="op" id="5043008">,</span>&nbsp;<span class="num" id="5043010">1</span><span class="op" id="5043011">,</span>&nbsp;<span class="ident" id="5043013">ws</span><span class="op" id="5043015">,</span>&nbsp;<span class="builtintype" id="5043017">true</span><span class="op" id="5043021">)</span>&nbsp;<span class="op" id="5043023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043028">ws</span>&nbsp;<span class="op" id="5043031">=</span>&nbsp;<span class="ident" id="5043033">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043043">printBlank</span>&nbsp;<span class="op" id="5043054">=</span>&nbsp;<span class="builtintype" id="5043056">false</span>&nbsp;<span class="comment" id="5043062">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043093">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043099">if</span>&nbsp;<span class="ident" id="5043102">printBlank</span>&nbsp;<span class="op" id="5043113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043117">p</span><span class="op" id="5043118">.</span><span class="builtinfunc" id="5043119">print</span><span class="op" id="5043124">(</span><span class="ident" id="5043125">blank</span><span class="op" id="5043130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043136">p</span><span class="op" id="5043137">.</span><span class="ident" id="5043138">expr1</span><span class="op" id="5043143">(</span><span class="ident" id="5043144">x</span><span class="op" id="5043145">.</span><span class="ident" id="5043146">Y</span><span class="op" id="5043147">,</span>&nbsp;<span class="ident" id="5043149">prec</span><span class="op" id="5043153">+</span><span class="num" id="5043154">1</span><span class="op" id="5043155">,</span>&nbsp;<span class="ident" id="5043157">depth</span><span class="op" id="5043162">+</span><span class="num" id="5043163">1</span><span class="op" id="5043164">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043167">if</span>&nbsp;<span class="ident" id="5043170">ws</span>&nbsp;<span class="op" id="5043173">==</span>&nbsp;<span class="ident" id="5043176">ignore</span>&nbsp;<span class="op" id="5043183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043187">p</span><span class="op" id="5043188">.</span><span class="builtinfunc" id="5043189">print</span><span class="op" id="5043194">(</span><span class="ident" id="5043195">unindent</span><span class="op" id="5043203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043206">}</span><br>
<span class="lineno"></span><span class="op" id="5043208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5043211">func</span>&nbsp;<span class="ident" id="5043216">isBinary</span><span class="op" id="5043224">(</span><span class="ident" id="5043225">expr</span>&nbsp;<span class="ident" id="5043230">ast</span><span class="op" id="5043233">.</span><span class="ident" id="5043234">Expr</span><span class="op" id="5043238">)</span>&nbsp;<span class="builtintype" id="5043240">bool</span>&nbsp;<span class="op" id="5043245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043248">_</span><span class="op" id="5043249">,</span>&nbsp;<span class="ident" id="5043251">ok</span>&nbsp;<span class="op" id="5043254">:=</span>&nbsp;<span class="ident" id="5043257">expr</span><span class="op" id="5043261">.</span><span class="op" id="5043262">(</span><span class="op" id="5043263">*</span><span class="ident" id="5043264">ast</span><span class="op" id="5043267">.</span><span class="ident" id="5043268">BinaryExpr</span><span class="op" id="5043278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043281">return</span>&nbsp;<span class="ident" id="5043288">ok</span><br>
<span class="lineno"></span><span class="op" id="5043291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5043294">func</span>&nbsp;<span class="op" id="5043299">(</span><span class="ident" id="5043300">p</span>&nbsp;<span class="op" id="5043302">*</span><span class="ident" id="5043303">printer</span><span class="op" id="5043310">)</span>&nbsp;<span class="ident" id="5043312">expr1</span><span class="op" id="5043317">(</span><span class="ident" id="5043318">expr</span>&nbsp;<span class="ident" id="5043323">ast</span><span class="op" id="5043326">.</span><span class="ident" id="5043327">Expr</span><span class="op" id="5043331">,</span>&nbsp;<span class="ident" id="5043333">prec1</span><span class="op" id="5043338">,</span>&nbsp;<span class="ident" id="5043340">depth</span>&nbsp;<span class="builtintype" id="5043346">int</span><span class="op" id="5043349">)</span>&nbsp;<span class="op" id="5043351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043354">p</span><span class="op" id="5043355">.</span><span class="builtinfunc" id="5043356">print</span><span class="op" id="5043361">(</span><span class="ident" id="5043362">expr</span><span class="op" id="5043366">.</span><span class="ident" id="5043367">Pos</span><span class="op" id="5043370">(</span><span class="op" id="5043371">)</span><span class="op" id="5043372">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043376">switch</span>&nbsp;<span class="ident" id="5043383">x</span>&nbsp;<span class="op" id="5043385">:=</span>&nbsp;<span class="ident" id="5043388">expr</span><span class="op" id="5043392">.</span><span class="op" id="5043393">(</span><span class="keyword" id="5043394">type</span><span class="op" id="5043398">)</span>&nbsp;<span class="op" id="5043400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043403">case</span>&nbsp;<span class="op" id="5043408">*</span><span class="ident" id="5043409">ast</span><span class="op" id="5043412">.</span><span class="ident" id="5043413">BadExpr</span><span class="op" id="5043420">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043424">p</span><span class="op" id="5043425">.</span><span class="builtinfunc" id="5043426">print</span><span class="op" id="5043431">(</span><span class="string" id="5043432">&#34;BadExpr&#34;</span><span class="op" id="5043441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043445">case</span>&nbsp;<span class="op" id="5043450">*</span><span class="ident" id="5043451">ast</span><span class="op" id="5043454">.</span><span class="ident" id="5043455">Ident</span><span class="op" id="5043460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043464">p</span><span class="op" id="5043465">.</span><span class="builtinfunc" id="5043466">print</span><span class="op" id="5043471">(</span><span class="ident" id="5043472">x</span><span class="op" id="5043473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043477">case</span>&nbsp;<span class="op" id="5043482">*</span><span class="ident" id="5043483">ast</span><span class="op" id="5043486">.</span><span class="ident" id="5043487">BinaryExpr</span><span class="op" id="5043497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043501">if</span>&nbsp;<span class="ident" id="5043504">depth</span>&nbsp;<span class="op" id="5043510">&lt;</span>&nbsp;<span class="num" id="5043512">1</span>&nbsp;<span class="op" id="5043514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043519">p</span><span class="op" id="5043520">.</span><span class="ident" id="5043521">internalError</span><span class="op" id="5043534">(</span><span class="string" id="5043535">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5043547">,</span>&nbsp;<span class="ident" id="5043549">depth</span><span class="op" id="5043554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043559">depth</span>&nbsp;<span class="op" id="5043565">=</span>&nbsp;<span class="num" id="5043567">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043571">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043575">p</span><span class="op" id="5043576">.</span><span class="ident" id="5043577">binaryExpr</span><span class="op" id="5043587">(</span><span class="ident" id="5043588">x</span><span class="op" id="5043589">,</span>&nbsp;<span class="ident" id="5043591">prec1</span><span class="op" id="5043596">,</span>&nbsp;<span class="ident" id="5043598">cutoff</span><span class="op" id="5043604">(</span><span class="ident" id="5043605">x</span><span class="op" id="5043606">,</span>&nbsp;<span class="ident" id="5043608">depth</span><span class="op" id="5043613">)</span><span class="op" id="5043614">,</span>&nbsp;<span class="ident" id="5043616">depth</span><span class="op" id="5043621">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043625">case</span>&nbsp;<span class="op" id="5043630">*</span><span class="ident" id="5043631">ast</span><span class="op" id="5043634">.</span><span class="ident" id="5043635">KeyValueExpr</span><span class="op" id="5043647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043651">p</span><span class="op" id="5043652">.</span><span class="ident" id="5043653">expr</span><span class="op" id="5043657">(</span><span class="ident" id="5043658">x</span><span class="op" id="5043659">.</span><span class="ident" id="5043660">Key</span><span class="op" id="5043663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043667">p</span><span class="op" id="5043668">.</span><span class="builtinfunc" id="5043669">print</span><span class="op" id="5043674">(</span><span class="ident" id="5043675">x</span><span class="op" id="5043676">.</span><span class="ident" id="5043677">Colon</span><span class="op" id="5043682">,</span>&nbsp;<span class="ident" id="5043684">token</span><span class="op" id="5043689">.</span><span class="ident" id="5043690">COLON</span><span class="op" id="5043695">,</span>&nbsp;<span class="ident" id="5043697">blank</span><span class="op" id="5043702">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043706">p</span><span class="op" id="5043707">.</span><span class="ident" id="5043708">expr</span><span class="op" id="5043712">(</span><span class="ident" id="5043713">x</span><span class="op" id="5043714">.</span><span class="ident" id="5043715">Value</span><span class="op" id="5043720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043724">case</span>&nbsp;<span class="op" id="5043729">*</span><span class="ident" id="5043730">ast</span><span class="op" id="5043733">.</span><span class="ident" id="5043734">StarExpr</span><span class="op" id="5043742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043746">const</span>&nbsp;<span class="ident" id="5043752">prec</span>&nbsp;<span class="op" id="5043757">=</span>&nbsp;<span class="ident" id="5043759">token</span><span class="op" id="5043764">.</span><span class="ident" id="5043765">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043777">if</span>&nbsp;<span class="ident" id="5043780">prec</span>&nbsp;<span class="op" id="5043785">&lt;</span>&nbsp;<span class="ident" id="5043787">prec1</span>&nbsp;<span class="op" id="5043793">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5043798">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043823">p</span><span class="op" id="5043824">.</span><span class="builtinfunc" id="5043825">print</span><span class="op" id="5043830">(</span><span class="ident" id="5043831">token</span><span class="op" id="5043836">.</span><span class="ident" id="5043837">LPAREN</span><span class="op" id="5043843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043848">p</span><span class="op" id="5043849">.</span><span class="builtinfunc" id="5043850">print</span><span class="op" id="5043855">(</span><span class="ident" id="5043856">token</span><span class="op" id="5043861">.</span><span class="ident" id="5043862">MUL</span><span class="op" id="5043865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043870">p</span><span class="op" id="5043871">.</span><span class="ident" id="5043872">expr</span><span class="op" id="5043876">(</span><span class="ident" id="5043877">x</span><span class="op" id="5043878">.</span><span class="ident" id="5043879">X</span><span class="op" id="5043880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043885">p</span><span class="op" id="5043886">.</span><span class="builtinfunc" id="5043887">print</span><span class="op" id="5043892">(</span><span class="ident" id="5043893">token</span><span class="op" id="5043898">.</span><span class="ident" id="5043899">RPAREN</span><span class="op" id="5043905">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043909">}</span>&nbsp;<span class="keyword" id="5043911">else</span>&nbsp;<span class="op" id="5043916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5043921">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043949">p</span><span class="op" id="5043950">.</span><span class="builtinfunc" id="5043951">print</span><span class="op" id="5043956">(</span><span class="ident" id="5043957">token</span><span class="op" id="5043962">.</span><span class="ident" id="5043963">MUL</span><span class="op" id="5043966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5043971">p</span><span class="op" id="5043972">.</span><span class="ident" id="5043973">expr</span><span class="op" id="5043977">(</span><span class="ident" id="5043978">x</span><span class="op" id="5043979">.</span><span class="ident" id="5043980">X</span><span class="op" id="5043981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5043985">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5043989">case</span>&nbsp;<span class="op" id="5043994">*</span><span class="ident" id="5043995">ast</span><span class="op" id="5043998">.</span><span class="ident" id="5043999">UnaryExpr</span><span class="op" id="5044008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044012">const</span>&nbsp;<span class="ident" id="5044018">prec</span>&nbsp;<span class="op" id="5044023">=</span>&nbsp;<span class="ident" id="5044025">token</span><span class="op" id="5044030">.</span><span class="ident" id="5044031">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044043">if</span>&nbsp;<span class="ident" id="5044046">prec</span>&nbsp;<span class="op" id="5044051">&lt;</span>&nbsp;<span class="ident" id="5044053">prec1</span>&nbsp;<span class="op" id="5044059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5044064">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044089">p</span><span class="op" id="5044090">.</span><span class="builtinfunc" id="5044091">print</span><span class="op" id="5044096">(</span><span class="ident" id="5044097">token</span><span class="op" id="5044102">.</span><span class="ident" id="5044103">LPAREN</span><span class="op" id="5044109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044114">p</span><span class="op" id="5044115">.</span><span class="ident" id="5044116">expr</span><span class="op" id="5044120">(</span><span class="ident" id="5044121">x</span><span class="op" id="5044122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044127">p</span><span class="op" id="5044128">.</span><span class="builtinfunc" id="5044129">print</span><span class="op" id="5044134">(</span><span class="ident" id="5044135">token</span><span class="op" id="5044140">.</span><span class="ident" id="5044141">RPAREN</span><span class="op" id="5044147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5044151">}</span>&nbsp;<span class="keyword" id="5044153">else</span>&nbsp;<span class="op" id="5044158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5044163">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044191">p</span><span class="op" id="5044192">.</span><span class="builtinfunc" id="5044193">print</span><span class="op" id="5044198">(</span><span class="ident" id="5044199">x</span><span class="op" id="5044200">.</span><span class="ident" id="5044201">Op</span><span class="op" id="5044203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044208">if</span>&nbsp;<span class="ident" id="5044211">x</span><span class="op" id="5044212">.</span><span class="ident" id="5044213">Op</span>&nbsp;<span class="op" id="5044216">==</span>&nbsp;<span class="ident" id="5044219">token</span><span class="op" id="5044224">.</span><span class="ident" id="5044225">RANGE</span>&nbsp;<span class="op" id="5044231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5044237">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044296">p</span><span class="op" id="5044297">.</span><span class="builtinfunc" id="5044298">print</span><span class="op" id="5044303">(</span><span class="ident" id="5044304">blank</span><span class="op" id="5044309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5044314">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044319">p</span><span class="op" id="5044320">.</span><span class="ident" id="5044321">expr1</span><span class="op" id="5044326">(</span><span class="ident" id="5044327">x</span><span class="op" id="5044328">.</span><span class="ident" id="5044329">X</span><span class="op" id="5044330">,</span>&nbsp;<span class="ident" id="5044332">prec</span><span class="op" id="5044336">,</span>&nbsp;<span class="ident" id="5044338">depth</span><span class="op" id="5044343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5044347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044351">case</span>&nbsp;<span class="op" id="5044356">*</span><span class="ident" id="5044357">ast</span><span class="op" id="5044360">.</span><span class="ident" id="5044361">BasicLit</span><span class="op" id="5044369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044373">p</span><span class="op" id="5044374">.</span><span class="builtinfunc" id="5044375">print</span><span class="op" id="5044380">(</span><span class="ident" id="5044381">x</span><span class="op" id="5044382">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044386">case</span>&nbsp;<span class="op" id="5044391">*</span><span class="ident" id="5044392">ast</span><span class="op" id="5044395">.</span><span class="ident" id="5044396">FuncLit</span><span class="op" id="5044403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044407">p</span><span class="op" id="5044408">.</span><span class="ident" id="5044409">expr</span><span class="op" id="5044413">(</span><span class="ident" id="5044414">x</span><span class="op" id="5044415">.</span><span class="ident" id="5044416">Type</span><span class="op" id="5044420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044424">p</span><span class="op" id="5044425">.</span><span class="ident" id="5044426">adjBlock</span><span class="op" id="5044434">(</span><span class="ident" id="5044435">p</span><span class="op" id="5044436">.</span><span class="ident" id="5044437">distanceFrom</span><span class="op" id="5044449">(</span><span class="ident" id="5044450">x</span><span class="op" id="5044451">.</span><span class="ident" id="5044452">Type</span><span class="op" id="5044456">.</span><span class="ident" id="5044457">Pos</span><span class="op" id="5044460">(</span><span class="op" id="5044461">)</span><span class="op" id="5044462">)</span><span class="op" id="5044463">,</span>&nbsp;<span class="ident" id="5044465">blank</span><span class="op" id="5044470">,</span>&nbsp;<span class="ident" id="5044472">x</span><span class="op" id="5044473">.</span><span class="ident" id="5044474">Body</span><span class="op" id="5044478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044482">case</span>&nbsp;<span class="op" id="5044487">*</span><span class="ident" id="5044488">ast</span><span class="op" id="5044491">.</span><span class="ident" id="5044492">ParenExpr</span><span class="op" id="5044501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044505">if</span>&nbsp;<span class="ident" id="5044508">_</span><span class="op" id="5044509">,</span>&nbsp;<span class="ident" id="5044511">hasParens</span>&nbsp;<span class="op" id="5044521">:=</span>&nbsp;<span class="ident" id="5044524">x</span><span class="op" id="5044525">.</span><span class="ident" id="5044526">X</span><span class="op" id="5044527">.</span><span class="op" id="5044528">(</span><span class="op" id="5044529">*</span><span class="ident" id="5044530">ast</span><span class="op" id="5044533">.</span><span class="ident" id="5044534">ParenExpr</span><span class="op" id="5044543">)</span><span class="op" id="5044544">;</span>&nbsp;<span class="ident" id="5044546">hasParens</span>&nbsp;<span class="op" id="5044556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5044561">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5044634">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044718">p</span><span class="op" id="5044719">.</span><span class="ident" id="5044720">expr0</span><span class="op" id="5044725">(</span><span class="ident" id="5044726">x</span><span class="op" id="5044727">.</span><span class="ident" id="5044728">X</span><span class="op" id="5044729">,</span>&nbsp;<span class="ident" id="5044731">depth</span><span class="op" id="5044736">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5044740">}</span>&nbsp;<span class="keyword" id="5044742">else</span>&nbsp;<span class="op" id="5044747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044752">p</span><span class="op" id="5044753">.</span><span class="builtinfunc" id="5044754">print</span><span class="op" id="5044759">(</span><span class="ident" id="5044760">token</span><span class="op" id="5044765">.</span><span class="ident" id="5044766">LPAREN</span><span class="op" id="5044772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044777">p</span><span class="op" id="5044778">.</span><span class="ident" id="5044779">expr0</span><span class="op" id="5044784">(</span><span class="ident" id="5044785">x</span><span class="op" id="5044786">.</span><span class="ident" id="5044787">X</span><span class="op" id="5044788">,</span>&nbsp;<span class="ident" id="5044790">reduceDepth</span><span class="op" id="5044801">(</span><span class="ident" id="5044802">depth</span><span class="op" id="5044807">)</span><span class="op" id="5044808">)</span>&nbsp;<span class="comment" id="5044810">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044852">p</span><span class="op" id="5044853">.</span><span class="builtinfunc" id="5044854">print</span><span class="op" id="5044859">(</span><span class="ident" id="5044860">x</span><span class="op" id="5044861">.</span><span class="ident" id="5044862">Rparen</span><span class="op" id="5044868">,</span>&nbsp;<span class="ident" id="5044870">token</span><span class="op" id="5044875">.</span><span class="ident" id="5044876">RPAREN</span><span class="op" id="5044882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5044886">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044890">case</span>&nbsp;<span class="op" id="5044895">*</span><span class="ident" id="5044896">ast</span><span class="op" id="5044899">.</span><span class="ident" id="5044900">SelectorExpr</span><span class="op" id="5044912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044916">p</span><span class="op" id="5044917">.</span><span class="ident" id="5044918">expr1</span><span class="op" id="5044923">(</span><span class="ident" id="5044924">x</span><span class="op" id="5044925">.</span><span class="ident" id="5044926">X</span><span class="op" id="5044927">,</span>&nbsp;<span class="ident" id="5044929">token</span><span class="op" id="5044934">.</span><span class="ident" id="5044935">HighestPrec</span><span class="op" id="5044946">,</span>&nbsp;<span class="ident" id="5044948">depth</span><span class="op" id="5044953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5044957">p</span><span class="op" id="5044958">.</span><span class="builtinfunc" id="5044959">print</span><span class="op" id="5044964">(</span><span class="ident" id="5044965">token</span><span class="op" id="5044970">.</span><span class="ident" id="5044971">PERIOD</span><span class="op" id="5044977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5044981">if</span>&nbsp;<span class="ident" id="5044984">line</span>&nbsp;<span class="op" id="5044989">:=</span>&nbsp;<span class="ident" id="5044992">p</span><span class="op" id="5044993">.</span><span class="ident" id="5044994">lineFor</span><span class="op" id="5045001">(</span><span class="ident" id="5045002">x</span><span class="op" id="5045003">.</span><span class="ident" id="5045004">Sel</span><span class="op" id="5045007">.</span><span class="ident" id="5045008">Pos</span><span class="op" id="5045011">(</span><span class="op" id="5045012">)</span><span class="op" id="5045013">)</span><span class="op" id="5045014">;</span>&nbsp;<span class="ident" id="5045016">p</span><span class="op" id="5045017">.</span><span class="ident" id="5045018">pos</span><span class="op" id="5045021">.</span><span class="ident" id="5045022">IsValid</span><span class="op" id="5045029">(</span><span class="op" id="5045030">)</span>&nbsp;<span class="op" id="5045032">&amp;&amp;</span>&nbsp;<span class="ident" id="5045035">p</span><span class="op" id="5045036">.</span><span class="ident" id="5045037">pos</span><span class="op" id="5045040">.</span><span class="ident" id="5045041">Line</span>&nbsp;<span class="op" id="5045046">&lt;</span>&nbsp;<span class="ident" id="5045048">line</span>&nbsp;<span class="op" id="5045053">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045058">p</span><span class="op" id="5045059">.</span><span class="builtinfunc" id="5045060">print</span><span class="op" id="5045065">(</span><span class="ident" id="5045066">indent</span><span class="op" id="5045072">,</span>&nbsp;<span class="ident" id="5045074">newline</span><span class="op" id="5045081">,</span>&nbsp;<span class="ident" id="5045083">x</span><span class="op" id="5045084">.</span><span class="ident" id="5045085">Sel</span><span class="op" id="5045088">.</span><span class="ident" id="5045089">Pos</span><span class="op" id="5045092">(</span><span class="op" id="5045093">)</span><span class="op" id="5045094">,</span>&nbsp;<span class="ident" id="5045096">x</span><span class="op" id="5045097">.</span><span class="ident" id="5045098">Sel</span><span class="op" id="5045101">,</span>&nbsp;<span class="ident" id="5045103">unindent</span><span class="op" id="5045111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5045115">}</span>&nbsp;<span class="keyword" id="5045117">else</span>&nbsp;<span class="op" id="5045122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045127">p</span><span class="op" id="5045128">.</span><span class="builtinfunc" id="5045129">print</span><span class="op" id="5045134">(</span><span class="ident" id="5045135">x</span><span class="op" id="5045136">.</span><span class="ident" id="5045137">Sel</span><span class="op" id="5045140">.</span><span class="ident" id="5045141">Pos</span><span class="op" id="5045144">(</span><span class="op" id="5045145">)</span><span class="op" id="5045146">,</span>&nbsp;<span class="ident" id="5045148">x</span><span class="op" id="5045149">.</span><span class="ident" id="5045150">Sel</span><span class="op" id="5045153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5045157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045161">case</span>&nbsp;<span class="op" id="5045166">*</span><span class="ident" id="5045167">ast</span><span class="op" id="5045170">.</span><span class="ident" id="5045171">TypeAssertExpr</span><span class="op" id="5045185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045189">p</span><span class="op" id="5045190">.</span><span class="ident" id="5045191">expr1</span><span class="op" id="5045196">(</span><span class="ident" id="5045197">x</span><span class="op" id="5045198">.</span><span class="ident" id="5045199">X</span><span class="op" id="5045200">,</span>&nbsp;<span class="ident" id="5045202">token</span><span class="op" id="5045207">.</span><span class="ident" id="5045208">HighestPrec</span><span class="op" id="5045219">,</span>&nbsp;<span class="ident" id="5045221">depth</span><span class="op" id="5045226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045230">p</span><span class="op" id="5045231">.</span><span class="builtinfunc" id="5045232">print</span><span class="op" id="5045237">(</span><span class="ident" id="5045238">token</span><span class="op" id="5045243">.</span><span class="ident" id="5045244">PERIOD</span><span class="op" id="5045250">,</span>&nbsp;<span class="ident" id="5045252">x</span><span class="op" id="5045253">.</span><span class="ident" id="5045254">Lparen</span><span class="op" id="5045260">,</span>&nbsp;<span class="ident" id="5045262">token</span><span class="op" id="5045267">.</span><span class="ident" id="5045268">LPAREN</span><span class="op" id="5045274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045278">if</span>&nbsp;<span class="ident" id="5045281">x</span><span class="op" id="5045282">.</span><span class="ident" id="5045283">Type</span>&nbsp;<span class="op" id="5045288">!=</span>&nbsp;<span class="builtintype" id="5045291">nil</span>&nbsp;<span class="op" id="5045295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045300">p</span><span class="op" id="5045301">.</span><span class="ident" id="5045302">expr</span><span class="op" id="5045306">(</span><span class="ident" id="5045307">x</span><span class="op" id="5045308">.</span><span class="ident" id="5045309">Type</span><span class="op" id="5045313">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5045317">}</span>&nbsp;<span class="keyword" id="5045319">else</span>&nbsp;<span class="op" id="5045324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045329">p</span><span class="op" id="5045330">.</span><span class="builtinfunc" id="5045331">print</span><span class="op" id="5045336">(</span><span class="ident" id="5045337">token</span><span class="op" id="5045342">.</span><span class="ident" id="5045343">TYPE</span><span class="op" id="5045347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5045351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045355">p</span><span class="op" id="5045356">.</span><span class="builtinfunc" id="5045357">print</span><span class="op" id="5045362">(</span><span class="ident" id="5045363">x</span><span class="op" id="5045364">.</span><span class="ident" id="5045365">Rparen</span><span class="op" id="5045371">,</span>&nbsp;<span class="ident" id="5045373">token</span><span class="op" id="5045378">.</span><span class="ident" id="5045379">RPAREN</span><span class="op" id="5045385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045389">case</span>&nbsp;<span class="op" id="5045394">*</span><span class="ident" id="5045395">ast</span><span class="op" id="5045398">.</span><span class="ident" id="5045399">IndexExpr</span><span class="op" id="5045408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5045412">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045488">p</span><span class="op" id="5045489">.</span><span class="ident" id="5045490">expr1</span><span class="op" id="5045495">(</span><span class="ident" id="5045496">x</span><span class="op" id="5045497">.</span><span class="ident" id="5045498">X</span><span class="op" id="5045499">,</span>&nbsp;<span class="ident" id="5045501">token</span><span class="op" id="5045506">.</span><span class="ident" id="5045507">HighestPrec</span><span class="op" id="5045518">,</span>&nbsp;<span class="num" id="5045520">1</span><span class="op" id="5045521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045525">p</span><span class="op" id="5045526">.</span><span class="builtinfunc" id="5045527">print</span><span class="op" id="5045532">(</span><span class="ident" id="5045533">x</span><span class="op" id="5045534">.</span><span class="ident" id="5045535">Lbrack</span><span class="op" id="5045541">,</span>&nbsp;<span class="ident" id="5045543">token</span><span class="op" id="5045548">.</span><span class="ident" id="5045549">LBRACK</span><span class="op" id="5045555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045559">p</span><span class="op" id="5045560">.</span><span class="ident" id="5045561">expr0</span><span class="op" id="5045566">(</span><span class="ident" id="5045567">x</span><span class="op" id="5045568">.</span><span class="ident" id="5045569">Index</span><span class="op" id="5045574">,</span>&nbsp;<span class="ident" id="5045576">depth</span><span class="op" id="5045581">+</span><span class="num" id="5045582">1</span><span class="op" id="5045583">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045587">p</span><span class="op" id="5045588">.</span><span class="builtinfunc" id="5045589">print</span><span class="op" id="5045594">(</span><span class="ident" id="5045595">x</span><span class="op" id="5045596">.</span><span class="ident" id="5045597">Rbrack</span><span class="op" id="5045603">,</span>&nbsp;<span class="ident" id="5045605">token</span><span class="op" id="5045610">.</span><span class="ident" id="5045611">RBRACK</span><span class="op" id="5045617">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045621">case</span>&nbsp;<span class="op" id="5045626">*</span><span class="ident" id="5045627">ast</span><span class="op" id="5045630">.</span><span class="ident" id="5045631">SliceExpr</span><span class="op" id="5045640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5045644">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045720">p</span><span class="op" id="5045721">.</span><span class="ident" id="5045722">expr1</span><span class="op" id="5045727">(</span><span class="ident" id="5045728">x</span><span class="op" id="5045729">.</span><span class="ident" id="5045730">X</span><span class="op" id="5045731">,</span>&nbsp;<span class="ident" id="5045733">token</span><span class="op" id="5045738">.</span><span class="ident" id="5045739">HighestPrec</span><span class="op" id="5045750">,</span>&nbsp;<span class="num" id="5045752">1</span><span class="op" id="5045753">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045757">p</span><span class="op" id="5045758">.</span><span class="builtinfunc" id="5045759">print</span><span class="op" id="5045764">(</span><span class="ident" id="5045765">x</span><span class="op" id="5045766">.</span><span class="ident" id="5045767">Lbrack</span><span class="op" id="5045773">,</span>&nbsp;<span class="ident" id="5045775">token</span><span class="op" id="5045780">.</span><span class="ident" id="5045781">LBRACK</span><span class="op" id="5045787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045791">indices</span>&nbsp;<span class="op" id="5045799">:=</span>&nbsp;<span class="op" id="5045802">[</span><span class="op" id="5045803">]</span><span class="ident" id="5045804">ast</span><span class="op" id="5045807">.</span><span class="ident" id="5045808">Expr</span><span class="op" id="5045812">{</span><span class="ident" id="5045813">x</span><span class="op" id="5045814">.</span><span class="ident" id="5045815">Low</span><span class="op" id="5045818">,</span>&nbsp;<span class="ident" id="5045820">x</span><span class="op" id="5045821">.</span><span class="ident" id="5045822">High</span><span class="op" id="5045826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045830">if</span>&nbsp;<span class="ident" id="5045833">x</span><span class="op" id="5045834">.</span><span class="ident" id="5045835">Max</span>&nbsp;<span class="op" id="5045839">!=</span>&nbsp;<span class="builtintype" id="5045842">nil</span>&nbsp;<span class="op" id="5045846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5045851">indices</span>&nbsp;<span class="op" id="5045859">=</span>&nbsp;<span class="builtinfunc" id="5045861">append</span><span class="op" id="5045867">(</span><span class="ident" id="5045868">indices</span><span class="op" id="5045875">,</span>&nbsp;<span class="ident" id="5045877">x</span><span class="op" id="5045878">.</span><span class="ident" id="5045879">Max</span><span class="op" id="5045882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5045886">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045890">for</span>&nbsp;<span class="ident" id="5045894">i</span><span class="op" id="5045895">,</span>&nbsp;<span class="ident" id="5045897">y</span>&nbsp;<span class="op" id="5045899">:=</span>&nbsp;<span class="keyword" id="5045902">range</span>&nbsp;<span class="ident" id="5045908">indices</span>&nbsp;<span class="op" id="5045916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5045921">if</span>&nbsp;<span class="ident" id="5045924">i</span>&nbsp;<span class="op" id="5045926">&gt;</span>&nbsp;<span class="num" id="5045928">0</span>&nbsp;<span class="op" id="5045930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5045936">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5046020">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5046103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046145">x</span>&nbsp;<span class="op" id="5046147">:=</span>&nbsp;<span class="ident" id="5046150">indices</span><span class="op" id="5046157">[</span><span class="ident" id="5046158">i</span><span class="op" id="5046159">-</span><span class="num" id="5046160">1</span><span class="op" id="5046161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046167">if</span>&nbsp;<span class="ident" id="5046170">depth</span>&nbsp;<span class="op" id="5046176">&lt;=</span>&nbsp;<span class="num" id="5046179">1</span>&nbsp;<span class="op" id="5046181">&amp;&amp;</span>&nbsp;<span class="ident" id="5046184">x</span>&nbsp;<span class="op" id="5046186">!=</span>&nbsp;<span class="builtintype" id="5046189">nil</span>&nbsp;<span class="op" id="5046193">&amp;&amp;</span>&nbsp;<span class="ident" id="5046196">y</span>&nbsp;<span class="op" id="5046198">!=</span>&nbsp;<span class="builtintype" id="5046201">nil</span>&nbsp;<span class="op" id="5046205">&amp;&amp;</span>&nbsp;<span class="op" id="5046208">(</span><span class="ident" id="5046209">isBinary</span><span class="op" id="5046217">(</span><span class="ident" id="5046218">x</span><span class="op" id="5046219">)</span>&nbsp;<span class="op" id="5046221">||</span>&nbsp;<span class="ident" id="5046224">isBinary</span><span class="op" id="5046232">(</span><span class="ident" id="5046233">y</span><span class="op" id="5046234">)</span><span class="op" id="5046235">)</span>&nbsp;<span class="op" id="5046237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046244">p</span><span class="op" id="5046245">.</span><span class="builtinfunc" id="5046246">print</span><span class="op" id="5046251">(</span><span class="ident" id="5046252">blank</span><span class="op" id="5046257">,</span>&nbsp;<span class="ident" id="5046259">token</span><span class="op" id="5046264">.</span><span class="ident" id="5046265">COLON</span><span class="op" id="5046270">,</span>&nbsp;<span class="ident" id="5046272">blank</span><span class="op" id="5046277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046283">}</span>&nbsp;<span class="keyword" id="5046285">else</span>&nbsp;<span class="op" id="5046290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046297">p</span><span class="op" id="5046298">.</span><span class="builtinfunc" id="5046299">print</span><span class="op" id="5046304">(</span><span class="ident" id="5046305">token</span><span class="op" id="5046310">.</span><span class="ident" id="5046311">COLON</span><span class="op" id="5046316">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046332">if</span>&nbsp;<span class="ident" id="5046335">y</span>&nbsp;<span class="op" id="5046337">!=</span>&nbsp;<span class="builtintype" id="5046340">nil</span>&nbsp;<span class="op" id="5046344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046350">p</span><span class="op" id="5046351">.</span><span class="ident" id="5046352">expr0</span><span class="op" id="5046357">(</span><span class="ident" id="5046358">y</span><span class="op" id="5046359">,</span>&nbsp;<span class="ident" id="5046361">depth</span><span class="op" id="5046366">+</span><span class="num" id="5046367">1</span><span class="op" id="5046368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046373">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046381">p</span><span class="op" id="5046382">.</span><span class="builtinfunc" id="5046383">print</span><span class="op" id="5046388">(</span><span class="ident" id="5046389">x</span><span class="op" id="5046390">.</span><span class="ident" id="5046391">Rbrack</span><span class="op" id="5046397">,</span>&nbsp;<span class="ident" id="5046399">token</span><span class="op" id="5046404">.</span><span class="ident" id="5046405">RBRACK</span><span class="op" id="5046411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046415">case</span>&nbsp;<span class="op" id="5046420">*</span><span class="ident" id="5046421">ast</span><span class="op" id="5046424">.</span><span class="ident" id="5046425">CallExpr</span><span class="op" id="5046433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046437">if</span>&nbsp;<span class="builtinfunc" id="5046440">len</span><span class="op" id="5046443">(</span><span class="ident" id="5046444">x</span><span class="op" id="5046445">.</span><span class="ident" id="5046446">Args</span><span class="op" id="5046450">)</span>&nbsp;<span class="op" id="5046452">&gt;</span>&nbsp;<span class="num" id="5046454">1</span>&nbsp;<span class="op" id="5046456">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046461">depth</span><span class="op" id="5046466">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046475">if</span>&nbsp;<span class="ident" id="5046478">_</span><span class="op" id="5046479">,</span>&nbsp;<span class="ident" id="5046481">ok</span>&nbsp;<span class="op" id="5046484">:=</span>&nbsp;<span class="ident" id="5046487">x</span><span class="op" id="5046488">.</span><span class="ident" id="5046489">Fun</span><span class="op" id="5046492">.</span><span class="op" id="5046493">(</span><span class="op" id="5046494">*</span><span class="ident" id="5046495">ast</span><span class="op" id="5046498">.</span><span class="ident" id="5046499">FuncType</span><span class="op" id="5046507">)</span><span class="op" id="5046508">;</span>&nbsp;<span class="ident" id="5046510">ok</span>&nbsp;<span class="op" id="5046513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5046518">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046598">p</span><span class="op" id="5046599">.</span><span class="builtinfunc" id="5046600">print</span><span class="op" id="5046605">(</span><span class="ident" id="5046606">token</span><span class="op" id="5046611">.</span><span class="ident" id="5046612">LPAREN</span><span class="op" id="5046618">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046623">p</span><span class="op" id="5046624">.</span><span class="ident" id="5046625">expr1</span><span class="op" id="5046630">(</span><span class="ident" id="5046631">x</span><span class="op" id="5046632">.</span><span class="ident" id="5046633">Fun</span><span class="op" id="5046636">,</span>&nbsp;<span class="ident" id="5046638">token</span><span class="op" id="5046643">.</span><span class="ident" id="5046644">HighestPrec</span><span class="op" id="5046655">,</span>&nbsp;<span class="ident" id="5046657">depth</span><span class="op" id="5046662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046667">p</span><span class="op" id="5046668">.</span><span class="builtinfunc" id="5046669">print</span><span class="op" id="5046674">(</span><span class="ident" id="5046675">token</span><span class="op" id="5046680">.</span><span class="ident" id="5046681">RPAREN</span><span class="op" id="5046687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046691">}</span>&nbsp;<span class="keyword" id="5046693">else</span>&nbsp;<span class="op" id="5046698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046703">p</span><span class="op" id="5046704">.</span><span class="ident" id="5046705">expr1</span><span class="op" id="5046710">(</span><span class="ident" id="5046711">x</span><span class="op" id="5046712">.</span><span class="ident" id="5046713">Fun</span><span class="op" id="5046716">,</span>&nbsp;<span class="ident" id="5046718">token</span><span class="op" id="5046723">.</span><span class="ident" id="5046724">HighestPrec</span><span class="op" id="5046735">,</span>&nbsp;<span class="ident" id="5046737">depth</span><span class="op" id="5046742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5046746">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046750">p</span><span class="op" id="5046751">.</span><span class="builtinfunc" id="5046752">print</span><span class="op" id="5046757">(</span><span class="ident" id="5046758">x</span><span class="op" id="5046759">.</span><span class="ident" id="5046760">Lparen</span><span class="op" id="5046766">,</span>&nbsp;<span class="ident" id="5046768">token</span><span class="op" id="5046773">.</span><span class="ident" id="5046774">LPAREN</span><span class="op" id="5046780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046784">if</span>&nbsp;<span class="ident" id="5046787">x</span><span class="op" id="5046788">.</span><span class="ident" id="5046789">Ellipsis</span><span class="op" id="5046797">.</span><span class="ident" id="5046798">IsValid</span><span class="op" id="5046805">(</span><span class="op" id="5046806">)</span>&nbsp;<span class="op" id="5046808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046813">p</span><span class="op" id="5046814">.</span><span class="ident" id="5046815">exprList</span><span class="op" id="5046823">(</span><span class="ident" id="5046824">x</span><span class="op" id="5046825">.</span><span class="ident" id="5046826">Lparen</span><span class="op" id="5046832">,</span>&nbsp;<span class="ident" id="5046834">x</span><span class="op" id="5046835">.</span><span class="ident" id="5046836">Args</span><span class="op" id="5046840">,</span>&nbsp;<span class="ident" id="5046842">depth</span><span class="op" id="5046847">,</span>&nbsp;<span class="num" id="5046849">0</span><span class="op" id="5046850">,</span>&nbsp;<span class="ident" id="5046852">x</span><span class="op" id="5046853">.</span><span class="ident" id="5046854">Ellipsis</span><span class="op" id="5046862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046867">p</span><span class="op" id="5046868">.</span><span class="builtinfunc" id="5046869">print</span><span class="op" id="5046874">(</span><span class="ident" id="5046875">x</span><span class="op" id="5046876">.</span><span class="ident" id="5046877">Ellipsis</span><span class="op" id="5046885">,</span>&nbsp;<span class="ident" id="5046887">token</span><span class="op" id="5046892">.</span><span class="ident" id="5046893">ELLIPSIS</span><span class="op" id="5046901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5046906">if</span>&nbsp;<span class="ident" id="5046909">x</span><span class="op" id="5046910">.</span><span class="ident" id="5046911">Rparen</span><span class="op" id="5046917">.</span><span class="ident" id="5046918">IsValid</span><span class="op" id="5046925">(</span><span class="op" id="5046926">)</span>&nbsp;<span class="op" id="5046928">&amp;&amp;</span>&nbsp;<span class="ident" id="5046931">p</span><span class="op" id="5046932">.</span><span class="ident" id="5046933">lineFor</span><span class="op" id="5046940">(</span><span class="ident" id="5046941">x</span><span class="op" id="5046942">.</span><span class="ident" id="5046943">Ellipsis</span><span class="op" id="5046951">)</span>&nbsp;<span class="op" id="5046953">&lt;</span>&nbsp;<span class="ident" id="5046955">p</span><span class="op" id="5046956">.</span><span class="ident" id="5046957">lineFor</span><span class="op" id="5046964">(</span><span class="ident" id="5046965">x</span><span class="op" id="5046966">.</span><span class="ident" id="5046967">Rparen</span><span class="op" id="5046973">)</span>&nbsp;<span class="op" id="5046975">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5046981">p</span><span class="op" id="5046982">.</span><span class="builtinfunc" id="5046983">print</span><span class="op" id="5046988">(</span><span class="ident" id="5046989">token</span><span class="op" id="5046994">.</span><span class="ident" id="5046995">COMMA</span><span class="op" id="5047000">,</span>&nbsp;<span class="ident" id="5047002">formfeed</span><span class="op" id="5047010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047019">}</span>&nbsp;<span class="keyword" id="5047021">else</span>&nbsp;<span class="op" id="5047026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047031">p</span><span class="op" id="5047032">.</span><span class="ident" id="5047033">exprList</span><span class="op" id="5047041">(</span><span class="ident" id="5047042">x</span><span class="op" id="5047043">.</span><span class="ident" id="5047044">Lparen</span><span class="op" id="5047050">,</span>&nbsp;<span class="ident" id="5047052">x</span><span class="op" id="5047053">.</span><span class="ident" id="5047054">Args</span><span class="op" id="5047058">,</span>&nbsp;<span class="ident" id="5047060">depth</span><span class="op" id="5047065">,</span>&nbsp;<span class="ident" id="5047067">commaTerm</span><span class="op" id="5047076">,</span>&nbsp;<span class="ident" id="5047078">x</span><span class="op" id="5047079">.</span><span class="ident" id="5047080">Rparen</span><span class="op" id="5047086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047090">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047094">p</span><span class="op" id="5047095">.</span><span class="builtinfunc" id="5047096">print</span><span class="op" id="5047101">(</span><span class="ident" id="5047102">x</span><span class="op" id="5047103">.</span><span class="ident" id="5047104">Rparen</span><span class="op" id="5047110">,</span>&nbsp;<span class="ident" id="5047112">token</span><span class="op" id="5047117">.</span><span class="ident" id="5047118">RPAREN</span><span class="op" id="5047124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047128">case</span>&nbsp;<span class="op" id="5047133">*</span><span class="ident" id="5047134">ast</span><span class="op" id="5047137">.</span><span class="ident" id="5047138">CompositeLit</span><span class="op" id="5047150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047154">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047251">if</span>&nbsp;<span class="ident" id="5047254">x</span><span class="op" id="5047255">.</span><span class="ident" id="5047256">Type</span>&nbsp;<span class="op" id="5047261">!=</span>&nbsp;<span class="builtintype" id="5047264">nil</span>&nbsp;<span class="op" id="5047268">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047273">p</span><span class="op" id="5047274">.</span><span class="ident" id="5047275">expr1</span><span class="op" id="5047280">(</span><span class="ident" id="5047281">x</span><span class="op" id="5047282">.</span><span class="ident" id="5047283">Type</span><span class="op" id="5047287">,</span>&nbsp;<span class="ident" id="5047289">token</span><span class="op" id="5047294">.</span><span class="ident" id="5047295">HighestPrec</span><span class="op" id="5047306">,</span>&nbsp;<span class="ident" id="5047308">depth</span><span class="op" id="5047313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047321">p</span><span class="op" id="5047322">.</span><span class="builtinfunc" id="5047323">print</span><span class="op" id="5047328">(</span><span class="ident" id="5047329">x</span><span class="op" id="5047330">.</span><span class="ident" id="5047331">Lbrace</span><span class="op" id="5047337">,</span>&nbsp;<span class="ident" id="5047339">token</span><span class="op" id="5047344">.</span><span class="ident" id="5047345">LBRACE</span><span class="op" id="5047351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047355">p</span><span class="op" id="5047356">.</span><span class="ident" id="5047357">exprList</span><span class="op" id="5047365">(</span><span class="ident" id="5047366">x</span><span class="op" id="5047367">.</span><span class="ident" id="5047368">Lbrace</span><span class="op" id="5047374">,</span>&nbsp;<span class="ident" id="5047376">x</span><span class="op" id="5047377">.</span><span class="ident" id="5047378">Elts</span><span class="op" id="5047382">,</span>&nbsp;<span class="num" id="5047384">1</span><span class="op" id="5047385">,</span>&nbsp;<span class="ident" id="5047387">commaTerm</span><span class="op" id="5047396">,</span>&nbsp;<span class="ident" id="5047398">x</span><span class="op" id="5047399">.</span><span class="ident" id="5047400">Rbrace</span><span class="op" id="5047406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047410">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047475">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047539">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047563">mode</span>&nbsp;<span class="op" id="5047568">:=</span>&nbsp;<span class="ident" id="5047571">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047590">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5047650">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047706">if</span>&nbsp;<span class="builtinfunc" id="5047709">len</span><span class="op" id="5047712">(</span><span class="ident" id="5047713">x</span><span class="op" id="5047714">.</span><span class="ident" id="5047715">Elts</span><span class="op" id="5047719">)</span>&nbsp;<span class="op" id="5047721">&gt;</span>&nbsp;<span class="num" id="5047723">0</span>&nbsp;<span class="op" id="5047725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047730">mode</span>&nbsp;<span class="op" id="5047735">|=</span>&nbsp;<span class="ident" id="5047738">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047757">p</span><span class="op" id="5047758">.</span><span class="builtinfunc" id="5047759">print</span><span class="op" id="5047764">(</span><span class="ident" id="5047765">mode</span><span class="op" id="5047769">,</span>&nbsp;<span class="ident" id="5047771">x</span><span class="op" id="5047772">.</span><span class="ident" id="5047773">Rbrace</span><span class="op" id="5047779">,</span>&nbsp;<span class="ident" id="5047781">token</span><span class="op" id="5047786">.</span><span class="ident" id="5047787">RBRACE</span><span class="op" id="5047793">,</span>&nbsp;<span class="ident" id="5047795">mode</span><span class="op" id="5047799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047803">case</span>&nbsp;<span class="op" id="5047808">*</span><span class="ident" id="5047809">ast</span><span class="op" id="5047812">.</span><span class="ident" id="5047813">Ellipsis</span><span class="op" id="5047821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047825">p</span><span class="op" id="5047826">.</span><span class="builtinfunc" id="5047827">print</span><span class="op" id="5047832">(</span><span class="ident" id="5047833">token</span><span class="op" id="5047838">.</span><span class="ident" id="5047839">ELLIPSIS</span><span class="op" id="5047847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047851">if</span>&nbsp;<span class="ident" id="5047854">x</span><span class="op" id="5047855">.</span><span class="ident" id="5047856">Elt</span>&nbsp;<span class="op" id="5047860">!=</span>&nbsp;<span class="builtintype" id="5047863">nil</span>&nbsp;<span class="op" id="5047867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047872">p</span><span class="op" id="5047873">.</span><span class="ident" id="5047874">expr</span><span class="op" id="5047878">(</span><span class="ident" id="5047879">x</span><span class="op" id="5047880">.</span><span class="ident" id="5047881">Elt</span><span class="op" id="5047884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047888">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047892">case</span>&nbsp;<span class="op" id="5047897">*</span><span class="ident" id="5047898">ast</span><span class="op" id="5047901">.</span><span class="ident" id="5047902">ArrayType</span><span class="op" id="5047911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047915">p</span><span class="op" id="5047916">.</span><span class="builtinfunc" id="5047917">print</span><span class="op" id="5047922">(</span><span class="ident" id="5047923">token</span><span class="op" id="5047928">.</span><span class="ident" id="5047929">LBRACK</span><span class="op" id="5047935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5047939">if</span>&nbsp;<span class="ident" id="5047942">x</span><span class="op" id="5047943">.</span><span class="ident" id="5047944">Len</span>&nbsp;<span class="op" id="5047948">!=</span>&nbsp;<span class="builtintype" id="5047951">nil</span>&nbsp;<span class="op" id="5047955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047960">p</span><span class="op" id="5047961">.</span><span class="ident" id="5047962">expr</span><span class="op" id="5047966">(</span><span class="ident" id="5047967">x</span><span class="op" id="5047968">.</span><span class="ident" id="5047969">Len</span><span class="op" id="5047972">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5047976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5047980">p</span><span class="op" id="5047981">.</span><span class="builtinfunc" id="5047982">print</span><span class="op" id="5047987">(</span><span class="ident" id="5047988">token</span><span class="op" id="5047993">.</span><span class="ident" id="5047994">RBRACK</span><span class="op" id="5048000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048004">p</span><span class="op" id="5048005">.</span><span class="ident" id="5048006">expr</span><span class="op" id="5048010">(</span><span class="ident" id="5048011">x</span><span class="op" id="5048012">.</span><span class="ident" id="5048013">Elt</span><span class="op" id="5048016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048020">case</span>&nbsp;<span class="op" id="5048025">*</span><span class="ident" id="5048026">ast</span><span class="op" id="5048029">.</span><span class="ident" id="5048030">StructType</span><span class="op" id="5048040">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048044">p</span><span class="op" id="5048045">.</span><span class="builtinfunc" id="5048046">print</span><span class="op" id="5048051">(</span><span class="ident" id="5048052">token</span><span class="op" id="5048057">.</span><span class="ident" id="5048058">STRUCT</span><span class="op" id="5048064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048068">p</span><span class="op" id="5048069">.</span><span class="ident" id="5048070">fieldList</span><span class="op" id="5048079">(</span><span class="ident" id="5048080">x</span><span class="op" id="5048081">.</span><span class="ident" id="5048082">Fields</span><span class="op" id="5048088">,</span>&nbsp;<span class="builtintype" id="5048090">true</span><span class="op" id="5048094">,</span>&nbsp;<span class="ident" id="5048096">x</span><span class="op" id="5048097">.</span><span class="ident" id="5048098">Incomplete</span><span class="op" id="5048108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048112">case</span>&nbsp;<span class="op" id="5048117">*</span><span class="ident" id="5048118">ast</span><span class="op" id="5048121">.</span><span class="ident" id="5048122">FuncType</span><span class="op" id="5048130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048134">p</span><span class="op" id="5048135">.</span><span class="builtinfunc" id="5048136">print</span><span class="op" id="5048141">(</span><span class="ident" id="5048142">token</span><span class="op" id="5048147">.</span><span class="ident" id="5048148">FUNC</span><span class="op" id="5048152">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048156">p</span><span class="op" id="5048157">.</span><span class="ident" id="5048158">signature</span><span class="op" id="5048167">(</span><span class="ident" id="5048168">x</span><span class="op" id="5048169">.</span><span class="ident" id="5048170">Params</span><span class="op" id="5048176">,</span>&nbsp;<span class="ident" id="5048178">x</span><span class="op" id="5048179">.</span><span class="ident" id="5048180">Results</span><span class="op" id="5048187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048191">case</span>&nbsp;<span class="op" id="5048196">*</span><span class="ident" id="5048197">ast</span><span class="op" id="5048200">.</span><span class="ident" id="5048201">InterfaceType</span><span class="op" id="5048214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048218">p</span><span class="op" id="5048219">.</span><span class="builtinfunc" id="5048220">print</span><span class="op" id="5048225">(</span><span class="ident" id="5048226">token</span><span class="op" id="5048231">.</span><span class="ident" id="5048232">INTERFACE</span><span class="op" id="5048241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048245">p</span><span class="op" id="5048246">.</span><span class="ident" id="5048247">fieldList</span><span class="op" id="5048256">(</span><span class="ident" id="5048257">x</span><span class="op" id="5048258">.</span><span class="ident" id="5048259">Methods</span><span class="op" id="5048266">,</span>&nbsp;<span class="builtintype" id="5048268">false</span><span class="op" id="5048273">,</span>&nbsp;<span class="ident" id="5048275">x</span><span class="op" id="5048276">.</span><span class="ident" id="5048277">Incomplete</span><span class="op" id="5048287">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048291">case</span>&nbsp;<span class="op" id="5048296">*</span><span class="ident" id="5048297">ast</span><span class="op" id="5048300">.</span><span class="ident" id="5048301">MapType</span><span class="op" id="5048308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048312">p</span><span class="op" id="5048313">.</span><span class="builtinfunc" id="5048314">print</span><span class="op" id="5048319">(</span><span class="ident" id="5048320">token</span><span class="op" id="5048325">.</span><span class="ident" id="5048326">MAP</span><span class="op" id="5048329">,</span>&nbsp;<span class="ident" id="5048331">token</span><span class="op" id="5048336">.</span><span class="ident" id="5048337">LBRACK</span><span class="op" id="5048343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048347">p</span><span class="op" id="5048348">.</span><span class="ident" id="5048349">expr</span><span class="op" id="5048353">(</span><span class="ident" id="5048354">x</span><span class="op" id="5048355">.</span><span class="ident" id="5048356">Key</span><span class="op" id="5048359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048363">p</span><span class="op" id="5048364">.</span><span class="builtinfunc" id="5048365">print</span><span class="op" id="5048370">(</span><span class="ident" id="5048371">token</span><span class="op" id="5048376">.</span><span class="ident" id="5048377">RBRACK</span><span class="op" id="5048383">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048387">p</span><span class="op" id="5048388">.</span><span class="ident" id="5048389">expr</span><span class="op" id="5048393">(</span><span class="ident" id="5048394">x</span><span class="op" id="5048395">.</span><span class="ident" id="5048396">Value</span><span class="op" id="5048401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048405">case</span>&nbsp;<span class="op" id="5048410">*</span><span class="ident" id="5048411">ast</span><span class="op" id="5048414">.</span><span class="ident" id="5048415">ChanType</span><span class="op" id="5048423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048427">switch</span>&nbsp;<span class="ident" id="5048434">x</span><span class="op" id="5048435">.</span><span class="ident" id="5048436">Dir</span>&nbsp;<span class="op" id="5048440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048444">case</span>&nbsp;<span class="ident" id="5048449">ast</span><span class="op" id="5048452">.</span><span class="ident" id="5048453">SEND</span>&nbsp;<span class="op" id="5048458">|</span>&nbsp;<span class="ident" id="5048460">ast</span><span class="op" id="5048463">.</span><span class="ident" id="5048464">RECV</span><span class="op" id="5048468">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048473">p</span><span class="op" id="5048474">.</span><span class="builtinfunc" id="5048475">print</span><span class="op" id="5048480">(</span><span class="ident" id="5048481">token</span><span class="op" id="5048486">.</span><span class="ident" id="5048487">CHAN</span><span class="op" id="5048491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048495">case</span>&nbsp;<span class="ident" id="5048500">ast</span><span class="op" id="5048503">.</span><span class="ident" id="5048504">RECV</span><span class="op" id="5048508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048513">p</span><span class="op" id="5048514">.</span><span class="builtinfunc" id="5048515">print</span><span class="op" id="5048520">(</span><span class="ident" id="5048521">token</span><span class="op" id="5048526">.</span><span class="ident" id="5048527">ARROW</span><span class="op" id="5048532">,</span>&nbsp;<span class="ident" id="5048534">token</span><span class="op" id="5048539">.</span><span class="ident" id="5048540">CHAN</span><span class="op" id="5048544">)</span>&nbsp;<span class="comment" id="5048546">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048584">case</span>&nbsp;<span class="ident" id="5048589">ast</span><span class="op" id="5048592">.</span><span class="ident" id="5048593">SEND</span><span class="op" id="5048597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048602">p</span><span class="op" id="5048603">.</span><span class="builtinfunc" id="5048604">print</span><span class="op" id="5048609">(</span><span class="ident" id="5048610">token</span><span class="op" id="5048615">.</span><span class="ident" id="5048616">CHAN</span><span class="op" id="5048620">,</span>&nbsp;<span class="ident" id="5048622">x</span><span class="op" id="5048623">.</span><span class="ident" id="5048624">Arrow</span><span class="op" id="5048629">,</span>&nbsp;<span class="ident" id="5048631">token</span><span class="op" id="5048636">.</span><span class="ident" id="5048637">ARROW</span><span class="op" id="5048642">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5048646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048650">p</span><span class="op" id="5048651">.</span><span class="builtinfunc" id="5048652">print</span><span class="op" id="5048657">(</span><span class="ident" id="5048658">blank</span><span class="op" id="5048663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048667">p</span><span class="op" id="5048668">.</span><span class="ident" id="5048669">expr</span><span class="op" id="5048673">(</span><span class="ident" id="5048674">x</span><span class="op" id="5048675">.</span><span class="ident" id="5048676">Value</span><span class="op" id="5048681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048685">default</span><span class="op" id="5048692">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5048696">panic</span><span class="op" id="5048701">(</span><span class="string" id="5048702">&#34;unreachable&#34;</span><span class="op" id="5048715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5048718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048722">return</span><br>
<span class="lineno"></span><span class="op" id="5048729">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5048732">func</span>&nbsp;<span class="op" id="5048737">(</span><span class="ident" id="5048738">p</span>&nbsp;<span class="op" id="5048740">*</span><span class="ident" id="5048741">printer</span><span class="op" id="5048748">)</span>&nbsp;<span class="ident" id="5048750">expr0</span><span class="op" id="5048755">(</span><span class="ident" id="5048756">x</span>&nbsp;<span class="ident" id="5048758">ast</span><span class="op" id="5048761">.</span><span class="ident" id="5048762">Expr</span><span class="op" id="5048766">,</span>&nbsp;<span class="ident" id="5048768">depth</span>&nbsp;<span class="builtintype" id="5048774">int</span><span class="op" id="5048777">)</span>&nbsp;<span class="op" id="5048779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048782">p</span><span class="op" id="5048783">.</span><span class="ident" id="5048784">expr1</span><span class="op" id="5048789">(</span><span class="ident" id="5048790">x</span><span class="op" id="5048791">,</span>&nbsp;<span class="ident" id="5048793">token</span><span class="op" id="5048798">.</span><span class="ident" id="5048799">LowestPrec</span><span class="op" id="5048809">,</span>&nbsp;<span class="ident" id="5048811">depth</span><span class="op" id="5048816">)</span><br>
<span class="lineno"></span><span class="op" id="5048818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5048821">func</span>&nbsp;<span class="op" id="5048826">(</span><span class="ident" id="5048827">p</span>&nbsp;<span class="op" id="5048829">*</span><span class="ident" id="5048830">printer</span><span class="op" id="5048837">)</span>&nbsp;<span class="ident" id="5048839">expr</span><span class="op" id="5048843">(</span><span class="ident" id="5048844">x</span>&nbsp;<span class="ident" id="5048846">ast</span><span class="op" id="5048849">.</span><span class="ident" id="5048850">Expr</span><span class="op" id="5048854">)</span>&nbsp;<span class="op" id="5048856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5048859">const</span>&nbsp;<span class="ident" id="5048865">depth</span>&nbsp;<span class="op" id="5048871">=</span>&nbsp;<span class="num" id="5048873">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5048876">p</span><span class="op" id="5048877">.</span><span class="ident" id="5048878">expr1</span><span class="op" id="5048883">(</span><span class="ident" id="5048884">x</span><span class="op" id="5048885">,</span>&nbsp;<span class="ident" id="5048887">token</span><span class="op" id="5048892">.</span><span class="ident" id="5048893">LowestPrec</span><span class="op" id="5048903">,</span>&nbsp;<span class="ident" id="5048905">depth</span><span class="op" id="5048910">)</span><br>
<span class="lineno"></span><span class="op" id="5048912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5048915">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5048995">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5049010">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5049096">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5049180">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5049225">func</span>&nbsp;<span class="op" id="5049230">(</span><span class="ident" id="5049231">p</span>&nbsp;<span class="op" id="5049233">*</span><span class="ident" id="5049234">printer</span><span class="op" id="5049241">)</span>&nbsp;<span class="ident" id="5049243">stmtList</span><span class="op" id="5049251">(</span><span class="ident" id="5049252">list</span>&nbsp;<span class="op" id="5049257">[</span><span class="op" id="5049258">]</span><span class="ident" id="5049259">ast</span><span class="op" id="5049262">.</span><span class="ident" id="5049263">Stmt</span><span class="op" id="5049267">,</span>&nbsp;<span class="ident" id="5049269">nindent</span>&nbsp;<span class="builtintype" id="5049277">int</span><span class="op" id="5049280">,</span>&nbsp;<span class="ident" id="5049282">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5049295">bool</span><span class="op" id="5049299">)</span>&nbsp;<span class="op" id="5049301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5049304">if</span>&nbsp;<span class="ident" id="5049307">nindent</span>&nbsp;<span class="op" id="5049315">&gt;</span>&nbsp;<span class="num" id="5049317">0</span>&nbsp;<span class="op" id="5049319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5049323">p</span><span class="op" id="5049324">.</span><span class="builtinfunc" id="5049325">print</span><span class="op" id="5049330">(</span><span class="ident" id="5049331">indent</span><span class="op" id="5049337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5049340">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5049343">var</span>&nbsp;<span class="ident" id="5049347">line</span>&nbsp;<span class="builtintype" id="5049352">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5049357">i</span>&nbsp;<span class="op" id="5049359">:=</span>&nbsp;<span class="num" id="5049362">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5049365">for</span>&nbsp;<span class="ident" id="5049369">_</span><span class="op" id="5049370">,</span>&nbsp;<span class="ident" id="5049372">s</span>&nbsp;<span class="op" id="5049374">:=</span>&nbsp;<span class="keyword" id="5049377">range</span>&nbsp;<span class="ident" id="5049383">list</span>&nbsp;<span class="op" id="5049388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049392">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5049438">if</span>&nbsp;<span class="ident" id="5049441">_</span><span class="op" id="5049442">,</span>&nbsp;<span class="ident" id="5049444">isEmpty</span>&nbsp;<span class="op" id="5049452">:=</span>&nbsp;<span class="ident" id="5049455">s</span><span class="op" id="5049456">.</span><span class="op" id="5049457">(</span><span class="op" id="5049458">*</span><span class="ident" id="5049459">ast</span><span class="op" id="5049462">.</span><span class="ident" id="5049463">EmptyStmt</span><span class="op" id="5049472">)</span><span class="op" id="5049473">;</span>&nbsp;<span class="op" id="5049475">!</span><span class="ident" id="5049476">isEmpty</span>&nbsp;<span class="op" id="5049484">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049489">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049554">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5049604">if</span>&nbsp;<span class="builtinfunc" id="5049607">len</span><span class="op" id="5049610">(</span><span class="ident" id="5049611">p</span><span class="op" id="5049612">.</span><span class="ident" id="5049613">output</span><span class="op" id="5049619">)</span>&nbsp;<span class="op" id="5049621">&gt;</span>&nbsp;<span class="num" id="5049623">0</span>&nbsp;<span class="op" id="5049625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049631">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049705">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5049763">p</span><span class="op" id="5049764">.</span><span class="ident" id="5049765">linebreak</span><span class="op" id="5049774">(</span><span class="ident" id="5049775">p</span><span class="op" id="5049776">.</span><span class="ident" id="5049777">lineFor</span><span class="op" id="5049784">(</span><span class="ident" id="5049785">s</span><span class="op" id="5049786">.</span><span class="ident" id="5049787">Pos</span><span class="op" id="5049790">(</span><span class="op" id="5049791">)</span><span class="op" id="5049792">)</span><span class="op" id="5049793">,</span>&nbsp;<span class="num" id="5049795">1</span><span class="op" id="5049796">,</span>&nbsp;<span class="ident" id="5049798">ignore</span><span class="op" id="5049804">,</span>&nbsp;<span class="ident" id="5049806">i</span>&nbsp;<span class="op" id="5049808">==</span>&nbsp;<span class="num" id="5049811">0</span>&nbsp;<span class="op" id="5049813">||</span>&nbsp;<span class="ident" id="5049816">nindent</span>&nbsp;<span class="op" id="5049824">==</span>&nbsp;<span class="num" id="5049827">0</span>&nbsp;<span class="op" id="5049829">||</span>&nbsp;<span class="ident" id="5049832">p</span><span class="op" id="5049833">.</span><span class="ident" id="5049834">linesFrom</span><span class="op" id="5049843">(</span><span class="ident" id="5049844">line</span><span class="op" id="5049848">)</span>&nbsp;<span class="op" id="5049850">&gt;</span>&nbsp;<span class="num" id="5049852">0</span><span class="op" id="5049853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5049858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5049863">p</span><span class="op" id="5049864">.</span><span class="ident" id="5049865">recordLine</span><span class="op" id="5049875">(</span><span class="op" id="5049876">&amp;</span><span class="ident" id="5049877">line</span><span class="op" id="5049881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5049886">p</span><span class="op" id="5049887">.</span><span class="ident" id="5049888">stmt</span><span class="op" id="5049892">(</span><span class="ident" id="5049893">s</span><span class="op" id="5049894">,</span>&nbsp;<span class="ident" id="5049896">nextIsRBrace</span>&nbsp;<span class="op" id="5049909">&amp;&amp;</span>&nbsp;<span class="ident" id="5049912">i</span>&nbsp;<span class="op" id="5049914">==</span>&nbsp;<span class="builtinfunc" id="5049917">len</span><span class="op" id="5049920">(</span><span class="ident" id="5049921">list</span><span class="op" id="5049925">)</span><span class="op" id="5049926">-</span><span class="num" id="5049927">1</span><span class="op" id="5049928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049933">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5049998">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5050062">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050112">for</span>&nbsp;<span class="ident" id="5050116">t</span>&nbsp;<span class="op" id="5050118">:=</span>&nbsp;<span class="ident" id="5050121">s</span><span class="op" id="5050122">;</span>&nbsp;<span class="op" id="5050124">;</span>&nbsp;<span class="op" id="5050126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050132">lt</span><span class="op" id="5050134">,</span>&nbsp;<span class="ident" id="5050136">_</span>&nbsp;<span class="op" id="5050138">:=</span>&nbsp;<span class="ident" id="5050141">t</span><span class="op" id="5050142">.</span><span class="op" id="5050143">(</span><span class="op" id="5050144">*</span><span class="ident" id="5050145">ast</span><span class="op" id="5050148">.</span><span class="ident" id="5050149">LabeledStmt</span><span class="op" id="5050160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050166">if</span>&nbsp;<span class="ident" id="5050169">lt</span>&nbsp;<span class="op" id="5050172">==</span>&nbsp;<span class="builtintype" id="5050175">nil</span>&nbsp;<span class="op" id="5050179">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050186">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050202">line</span><span class="op" id="5050206">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050213">t</span>&nbsp;<span class="op" id="5050215">=</span>&nbsp;<span class="ident" id="5050217">lt</span><span class="op" id="5050219">.</span><span class="ident" id="5050220">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050228">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050233">i</span><span class="op" id="5050234">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050245">if</span>&nbsp;<span class="ident" id="5050248">nindent</span>&nbsp;<span class="op" id="5050256">&gt;</span>&nbsp;<span class="num" id="5050258">0</span>&nbsp;<span class="op" id="5050260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050264">p</span><span class="op" id="5050265">.</span><span class="builtinfunc" id="5050266">print</span><span class="op" id="5050271">(</span><span class="ident" id="5050272">unindent</span><span class="op" id="5050280">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050283">}</span><br>
<span class="lineno"></span><span class="op" id="5050285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5050288">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5050359">func</span>&nbsp;<span class="op" id="5050364">(</span><span class="ident" id="5050365">p</span>&nbsp;<span class="op" id="5050367">*</span><span class="ident" id="5050368">printer</span><span class="op" id="5050375">)</span>&nbsp;<span class="ident" id="5050377">block</span><span class="op" id="5050382">(</span><span class="ident" id="5050383">b</span>&nbsp;<span class="op" id="5050385">*</span><span class="ident" id="5050386">ast</span><span class="op" id="5050389">.</span><span class="ident" id="5050390">BlockStmt</span><span class="op" id="5050399">,</span>&nbsp;<span class="ident" id="5050401">nindent</span>&nbsp;<span class="builtintype" id="5050409">int</span><span class="op" id="5050412">)</span>&nbsp;<span class="op" id="5050414">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050417">p</span><span class="op" id="5050418">.</span><span class="builtinfunc" id="5050419">print</span><span class="op" id="5050424">(</span><span class="ident" id="5050425">b</span><span class="op" id="5050426">.</span><span class="ident" id="5050427">Lbrace</span><span class="op" id="5050433">,</span>&nbsp;<span class="ident" id="5050435">token</span><span class="op" id="5050440">.</span><span class="ident" id="5050441">LBRACE</span><span class="op" id="5050447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050450">p</span><span class="op" id="5050451">.</span><span class="ident" id="5050452">stmtList</span><span class="op" id="5050460">(</span><span class="ident" id="5050461">b</span><span class="op" id="5050462">.</span><span class="ident" id="5050463">List</span><span class="op" id="5050467">,</span>&nbsp;<span class="ident" id="5050469">nindent</span><span class="op" id="5050476">,</span>&nbsp;<span class="builtintype" id="5050478">true</span><span class="op" id="5050482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050485">p</span><span class="op" id="5050486">.</span><span class="ident" id="5050487">linebreak</span><span class="op" id="5050496">(</span><span class="ident" id="5050497">p</span><span class="op" id="5050498">.</span><span class="ident" id="5050499">lineFor</span><span class="op" id="5050506">(</span><span class="ident" id="5050507">b</span><span class="op" id="5050508">.</span><span class="ident" id="5050509">Rbrace</span><span class="op" id="5050515">)</span><span class="op" id="5050516">,</span>&nbsp;<span class="num" id="5050518">1</span><span class="op" id="5050519">,</span>&nbsp;<span class="ident" id="5050521">ignore</span><span class="op" id="5050527">,</span>&nbsp;<span class="builtintype" id="5050529">true</span><span class="op" id="5050533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050536">p</span><span class="op" id="5050537">.</span><span class="builtinfunc" id="5050538">print</span><span class="op" id="5050543">(</span><span class="ident" id="5050544">b</span><span class="op" id="5050545">.</span><span class="ident" id="5050546">Rbrace</span><span class="op" id="5050552">,</span>&nbsp;<span class="ident" id="5050554">token</span><span class="op" id="5050559">.</span><span class="ident" id="5050560">RBRACE</span><span class="op" id="5050566">)</span><br>
<span class="lineno"></span><span class="op" id="5050568">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5050571">func</span>&nbsp;<span class="ident" id="5050576">isTypeName</span><span class="op" id="5050586">(</span><span class="ident" id="5050587">x</span>&nbsp;<span class="ident" id="5050589">ast</span><span class="op" id="5050592">.</span><span class="ident" id="5050593">Expr</span><span class="op" id="5050597">)</span>&nbsp;<span class="builtintype" id="5050599">bool</span>&nbsp;<span class="op" id="5050604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050607">switch</span>&nbsp;<span class="ident" id="5050614">t</span>&nbsp;<span class="op" id="5050616">:=</span>&nbsp;<span class="ident" id="5050619">x</span><span class="op" id="5050620">.</span><span class="op" id="5050621">(</span><span class="keyword" id="5050622">type</span><span class="op" id="5050626">)</span>&nbsp;<span class="op" id="5050628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050631">case</span>&nbsp;<span class="op" id="5050636">*</span><span class="ident" id="5050637">ast</span><span class="op" id="5050640">.</span><span class="ident" id="5050641">Ident</span><span class="op" id="5050646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050650">return</span>&nbsp;<span class="builtintype" id="5050657">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050663">case</span>&nbsp;<span class="op" id="5050668">*</span><span class="ident" id="5050669">ast</span><span class="op" id="5050672">.</span><span class="ident" id="5050673">SelectorExpr</span><span class="op" id="5050685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050689">return</span>&nbsp;<span class="ident" id="5050696">isTypeName</span><span class="op" id="5050706">(</span><span class="ident" id="5050707">t</span><span class="op" id="5050708">.</span><span class="ident" id="5050709">X</span><span class="op" id="5050710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5050713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050716">return</span>&nbsp;<span class="builtintype" id="5050723">false</span><br>
<span class="lineno"></span><span class="op" id="5050729">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5050732">func</span>&nbsp;<span class="ident" id="5050737">stripParens</span><span class="op" id="5050748">(</span><span class="ident" id="5050749">x</span>&nbsp;<span class="ident" id="5050751">ast</span><span class="op" id="5050754">.</span><span class="ident" id="5050755">Expr</span><span class="op" id="5050759">)</span>&nbsp;<span class="ident" id="5050761">ast</span><span class="op" id="5050764">.</span><span class="ident" id="5050765">Expr</span>&nbsp;<span class="op" id="5050770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050773">if</span>&nbsp;<span class="ident" id="5050776">px</span><span class="op" id="5050778">,</span>&nbsp;<span class="ident" id="5050780">strip</span>&nbsp;<span class="op" id="5050786">:=</span>&nbsp;<span class="ident" id="5050789">x</span><span class="op" id="5050790">.</span><span class="op" id="5050791">(</span><span class="op" id="5050792">*</span><span class="ident" id="5050793">ast</span><span class="op" id="5050796">.</span><span class="ident" id="5050797">ParenExpr</span><span class="op" id="5050806">)</span><span class="op" id="5050807">;</span>&nbsp;<span class="ident" id="5050809">strip</span>&nbsp;<span class="op" id="5050815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5050819">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5050874">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5050928">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5050945">ast</span><span class="op" id="5050948">.</span><span class="ident" id="5050949">Inspect</span><span class="op" id="5050956">(</span><span class="ident" id="5050957">px</span><span class="op" id="5050959">.</span><span class="ident" id="5050960">X</span><span class="op" id="5050961">,</span>&nbsp;<span class="keyword" id="5050963">func</span><span class="op" id="5050967">(</span><span class="ident" id="5050968">node</span>&nbsp;<span class="ident" id="5050973">ast</span><span class="op" id="5050976">.</span><span class="ident" id="5050977">Node</span><span class="op" id="5050981">)</span>&nbsp;<span class="builtintype" id="5050983">bool</span>&nbsp;<span class="op" id="5050988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5050993">switch</span>&nbsp;<span class="ident" id="5051000">x</span>&nbsp;<span class="op" id="5051002">:=</span>&nbsp;<span class="ident" id="5051005">node</span><span class="op" id="5051009">.</span><span class="op" id="5051010">(</span><span class="keyword" id="5051011">type</span><span class="op" id="5051015">)</span>&nbsp;<span class="op" id="5051017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051022">case</span>&nbsp;<span class="op" id="5051027">*</span><span class="ident" id="5051028">ast</span><span class="op" id="5051031">.</span><span class="ident" id="5051032">ParenExpr</span><span class="op" id="5051041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5051047">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051102">return</span>&nbsp;<span class="builtintype" id="5051109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051118">case</span>&nbsp;<span class="op" id="5051123">*</span><span class="ident" id="5051124">ast</span><span class="op" id="5051127">.</span><span class="ident" id="5051128">CompositeLit</span><span class="op" id="5051140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051146">if</span>&nbsp;<span class="ident" id="5051149">isTypeName</span><span class="op" id="5051159">(</span><span class="ident" id="5051160">x</span><span class="op" id="5051161">.</span><span class="ident" id="5051162">Type</span><span class="op" id="5051166">)</span>&nbsp;<span class="op" id="5051168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051175">strip</span>&nbsp;<span class="op" id="5051181">=</span>&nbsp;<span class="builtintype" id="5051183">false</span>&nbsp;<span class="comment" id="5051189">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051221">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051227">return</span>&nbsp;<span class="builtintype" id="5051234">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5051248">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051290">return</span>&nbsp;<span class="builtintype" id="5051297">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051304">}</span><span class="op" id="5051305">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051309">if</span>&nbsp;<span class="ident" id="5051312">strip</span>&nbsp;<span class="op" id="5051318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051323">return</span>&nbsp;<span class="ident" id="5051330">stripParens</span><span class="op" id="5051341">(</span><span class="ident" id="5051342">px</span><span class="op" id="5051344">.</span><span class="ident" id="5051345">X</span><span class="op" id="5051346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051356">return</span>&nbsp;<span class="ident" id="5051363">x</span><br>
<span class="lineno">985</span><span class="op" id="5051365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5051368">func</span>&nbsp;<span class="ident" id="5051373">stripParensAlways</span><span class="op" id="5051390">(</span><span class="ident" id="5051391">x</span>&nbsp;<span class="ident" id="5051393">ast</span><span class="op" id="5051396">.</span><span class="ident" id="5051397">Expr</span><span class="op" id="5051401">)</span>&nbsp;<span class="ident" id="5051403">ast</span><span class="op" id="5051406">.</span><span class="ident" id="5051407">Expr</span>&nbsp;<span class="op" id="5051412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051415">if</span>&nbsp;<span class="ident" id="5051418">x</span><span class="op" id="5051419">,</span>&nbsp;<span class="ident" id="5051421">ok</span>&nbsp;<span class="op" id="5051424">:=</span>&nbsp;<span class="ident" id="5051427">x</span><span class="op" id="5051428">.</span><span class="op" id="5051429">(</span><span class="op" id="5051430">*</span><span class="ident" id="5051431">ast</span><span class="op" id="5051434">.</span><span class="ident" id="5051435">ParenExpr</span><span class="op" id="5051444">)</span><span class="op" id="5051445">;</span>&nbsp;<span class="ident" id="5051447">ok</span>&nbsp;<span class="op" id="5051450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051454">return</span>&nbsp;<span class="ident" id="5051461">stripParensAlways</span><span class="op" id="5051478">(</span><span class="ident" id="5051479">x</span><span class="op" id="5051480">.</span><span class="ident" id="5051481">X</span><span class="op" id="5051482">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051488">return</span>&nbsp;<span class="ident" id="5051495">x</span><br>
<span class="lineno"></span><span class="op" id="5051497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5051500">func</span>&nbsp;<span class="op" id="5051505">(</span><span class="ident" id="5051506">p</span>&nbsp;<span class="op" id="5051508">*</span><span class="ident" id="5051509">printer</span><span class="op" id="5051516">)</span>&nbsp;<span class="ident" id="5051518">controlClause</span><span class="op" id="5051531">(</span><span class="ident" id="5051532">isForStmt</span>&nbsp;<span class="builtintype" id="5051542">bool</span><span class="op" id="5051546">,</span>&nbsp;<span class="ident" id="5051548">init</span>&nbsp;<span class="ident" id="5051553">ast</span><span class="op" id="5051556">.</span><span class="ident" id="5051557">Stmt</span><span class="op" id="5051561">,</span>&nbsp;<span class="ident" id="5051563">expr</span>&nbsp;<span class="ident" id="5051568">ast</span><span class="op" id="5051571">.</span><span class="ident" id="5051572">Expr</span><span class="op" id="5051576">,</span>&nbsp;<span class="ident" id="5051578">post</span>&nbsp;<span class="ident" id="5051583">ast</span><span class="op" id="5051586">.</span><span class="ident" id="5051587">Stmt</span><span class="op" id="5051591">)</span>&nbsp;<span class="op" id="5051593">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051596">p</span><span class="op" id="5051597">.</span><span class="builtinfunc" id="5051598">print</span><span class="op" id="5051603">(</span><span class="ident" id="5051604">blank</span><span class="op" id="5051609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051612">needsBlank</span>&nbsp;<span class="op" id="5051623">:=</span>&nbsp;<span class="builtintype" id="5051626">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051633">if</span>&nbsp;<span class="ident" id="5051636">init</span>&nbsp;<span class="op" id="5051641">==</span>&nbsp;<span class="builtintype" id="5051644">nil</span>&nbsp;<span class="op" id="5051648">&amp;&amp;</span>&nbsp;<span class="ident" id="5051651">post</span>&nbsp;<span class="op" id="5051656">==</span>&nbsp;<span class="builtintype" id="5051659">nil</span>&nbsp;<span class="op" id="5051663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5051667">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051695">if</span>&nbsp;<span class="ident" id="5051698">expr</span>&nbsp;<span class="op" id="5051703">!=</span>&nbsp;<span class="builtintype" id="5051706">nil</span>&nbsp;<span class="op" id="5051710">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051715">p</span><span class="op" id="5051716">.</span><span class="ident" id="5051717">expr</span><span class="op" id="5051721">(</span><span class="ident" id="5051722">stripParens</span><span class="op" id="5051733">(</span><span class="ident" id="5051734">expr</span><span class="op" id="5051738">)</span><span class="op" id="5051739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051744">needsBlank</span>&nbsp;<span class="op" id="5051755">=</span>&nbsp;<span class="builtintype" id="5051757">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051767">}</span>&nbsp;<span class="keyword" id="5051769">else</span>&nbsp;<span class="op" id="5051774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5051778">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5051807">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051861">if</span>&nbsp;<span class="ident" id="5051864">init</span>&nbsp;<span class="op" id="5051869">!=</span>&nbsp;<span class="builtintype" id="5051872">nil</span>&nbsp;<span class="op" id="5051876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051881">p</span><span class="op" id="5051882">.</span><span class="ident" id="5051883">stmt</span><span class="op" id="5051887">(</span><span class="ident" id="5051888">init</span><span class="op" id="5051892">,</span>&nbsp;<span class="builtintype" id="5051894">false</span><span class="op" id="5051899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5051903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051907">p</span><span class="op" id="5051908">.</span><span class="builtinfunc" id="5051909">print</span><span class="op" id="5051914">(</span><span class="ident" id="5051915">token</span><span class="op" id="5051920">.</span><span class="ident" id="5051921">SEMICOLON</span><span class="op" id="5051930">,</span>&nbsp;<span class="ident" id="5051932">blank</span><span class="op" id="5051937">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5051941">if</span>&nbsp;<span class="ident" id="5051944">expr</span>&nbsp;<span class="op" id="5051949">!=</span>&nbsp;<span class="builtintype" id="5051952">nil</span>&nbsp;<span class="op" id="5051956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051961">p</span><span class="op" id="5051962">.</span><span class="ident" id="5051963">expr</span><span class="op" id="5051967">(</span><span class="ident" id="5051968">stripParens</span><span class="op" id="5051979">(</span><span class="ident" id="5051980">expr</span><span class="op" id="5051984">)</span><span class="op" id="5051985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5051990">needsBlank</span>&nbsp;<span class="op" id="5052001">=</span>&nbsp;<span class="builtintype" id="5052003">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5052010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052014">if</span>&nbsp;<span class="ident" id="5052017">isForStmt</span>&nbsp;<span class="op" id="5052027">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052032">p</span><span class="op" id="5052033">.</span><span class="builtinfunc" id="5052034">print</span><span class="op" id="5052039">(</span><span class="ident" id="5052040">token</span><span class="op" id="5052045">.</span><span class="ident" id="5052046">SEMICOLON</span><span class="op" id="5052055">,</span>&nbsp;<span class="ident" id="5052057">blank</span><span class="op" id="5052062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052067">needsBlank</span>&nbsp;<span class="op" id="5052078">=</span>&nbsp;<span class="builtintype" id="5052080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052089">if</span>&nbsp;<span class="ident" id="5052092">post</span>&nbsp;<span class="op" id="5052097">!=</span>&nbsp;<span class="builtintype" id="5052100">nil</span>&nbsp;<span class="op" id="5052104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052110">p</span><span class="op" id="5052111">.</span><span class="ident" id="5052112">stmt</span><span class="op" id="5052116">(</span><span class="ident" id="5052117">post</span><span class="op" id="5052121">,</span>&nbsp;<span class="builtintype" id="5052123">false</span><span class="op" id="5052128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052134">needsBlank</span>&nbsp;<span class="op" id="5052145">=</span>&nbsp;<span class="builtintype" id="5052147">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5052155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5052159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5052162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052165">if</span>&nbsp;<span class="ident" id="5052168">needsBlank</span>&nbsp;<span class="op" id="5052179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052183">p</span><span class="op" id="5052184">.</span><span class="builtinfunc" id="5052185">print</span><span class="op" id="5052190">(</span><span class="ident" id="5052191">blank</span><span class="op" id="5052196">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5052199">}</span><br>
<span class="lineno"></span><span class="op" id="5052201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5052204">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5052277">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5052350">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5052393">//</span><br>
<span class="lineno"></span><span class="keyword" id="5052396">func</span>&nbsp;<span class="op" id="5052401">(</span><span class="ident" id="5052402">p</span>&nbsp;<span class="op" id="5052404">*</span><span class="ident" id="5052405">printer</span><span class="op" id="5052412">)</span>&nbsp;<span class="ident" id="5052414">indentList</span><span class="op" id="5052424">(</span><span class="ident" id="5052425">list</span>&nbsp;<span class="op" id="5052430">[</span><span class="op" id="5052431">]</span><span class="ident" id="5052432">ast</span><span class="op" id="5052435">.</span><span class="ident" id="5052436">Expr</span><span class="op" id="5052440">)</span>&nbsp;<span class="builtintype" id="5052442">bool</span>&nbsp;<span class="op" id="5052447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5052450">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5052523">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5052592">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052648">if</span>&nbsp;<span class="builtinfunc" id="5052651">len</span><span class="op" id="5052654">(</span><span class="ident" id="5052655">list</span><span class="op" id="5052659">)</span>&nbsp;<span class="op" id="5052661">&gt;=</span>&nbsp;<span class="num" id="5052664">2</span>&nbsp;<span class="op" id="5052666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052670">var</span>&nbsp;<span class="ident" id="5052674">b</span>&nbsp;<span class="op" id="5052676">=</span>&nbsp;<span class="ident" id="5052678">p</span><span class="op" id="5052679">.</span><span class="ident" id="5052680">lineFor</span><span class="op" id="5052687">(</span><span class="ident" id="5052688">list</span><span class="op" id="5052692">[</span><span class="num" id="5052693">0</span><span class="op" id="5052694">]</span><span class="op" id="5052695">.</span><span class="ident" id="5052696">Pos</span><span class="op" id="5052699">(</span><span class="op" id="5052700">)</span><span class="op" id="5052701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052705">var</span>&nbsp;<span class="ident" id="5052709">e</span>&nbsp;<span class="op" id="5052711">=</span>&nbsp;<span class="ident" id="5052713">p</span><span class="op" id="5052714">.</span><span class="ident" id="5052715">lineFor</span><span class="op" id="5052722">(</span><span class="ident" id="5052723">list</span><span class="op" id="5052727">[</span><span class="builtinfunc" id="5052728">len</span><span class="op" id="5052731">(</span><span class="ident" id="5052732">list</span><span class="op" id="5052736">)</span><span class="op" id="5052737">-</span><span class="num" id="5052738">1</span><span class="op" id="5052739">]</span><span class="op" id="5052740">.</span><span class="ident" id="5052741">End</span><span class="op" id="5052744">(</span><span class="op" id="5052745">)</span><span class="op" id="5052746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052750">if</span>&nbsp;<span class="num" id="5052753">0</span>&nbsp;<span class="op" id="5052755">&lt;</span>&nbsp;<span class="ident" id="5052757">b</span>&nbsp;<span class="op" id="5052759">&amp;&amp;</span>&nbsp;<span class="ident" id="5052762">b</span>&nbsp;<span class="op" id="5052764">&lt;</span>&nbsp;<span class="ident" id="5052766">e</span>&nbsp;<span class="op" id="5052768">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5052773">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052805">n</span>&nbsp;<span class="op" id="5052807">:=</span>&nbsp;<span class="num" id="5052810">0</span>&nbsp;<span class="comment" id="5052812">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052843">line</span>&nbsp;<span class="op" id="5052848">:=</span>&nbsp;<span class="ident" id="5052851">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052856">for</span>&nbsp;<span class="ident" id="5052860">_</span><span class="op" id="5052861">,</span>&nbsp;<span class="ident" id="5052863">x</span>&nbsp;<span class="op" id="5052865">:=</span>&nbsp;<span class="keyword" id="5052868">range</span>&nbsp;<span class="ident" id="5052874">list</span>&nbsp;<span class="op" id="5052879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052885">xb</span>&nbsp;<span class="op" id="5052888">:=</span>&nbsp;<span class="ident" id="5052891">p</span><span class="op" id="5052892">.</span><span class="ident" id="5052893">lineFor</span><span class="op" id="5052900">(</span><span class="ident" id="5052901">x</span><span class="op" id="5052902">.</span><span class="ident" id="5052903">Pos</span><span class="op" id="5052906">(</span><span class="op" id="5052907">)</span><span class="op" id="5052908">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5052914">xe</span>&nbsp;<span class="op" id="5052917">:=</span>&nbsp;<span class="ident" id="5052920">p</span><span class="op" id="5052921">.</span><span class="ident" id="5052922">lineFor</span><span class="op" id="5052929">(</span><span class="ident" id="5052930">x</span><span class="op" id="5052931">.</span><span class="ident" id="5052932">End</span><span class="op" id="5052935">(</span><span class="op" id="5052936">)</span><span class="op" id="5052937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5052943">if</span>&nbsp;<span class="ident" id="5052946">line</span>&nbsp;<span class="op" id="5052951">&lt;</span>&nbsp;<span class="ident" id="5052953">xb</span>&nbsp;<span class="op" id="5052956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5052963">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053001">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053040">return</span>&nbsp;<span class="builtintype" id="5053047">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053062">if</span>&nbsp;<span class="ident" id="5053065">xb</span>&nbsp;<span class="op" id="5053068">&lt;</span>&nbsp;<span class="ident" id="5053070">xe</span>&nbsp;<span class="op" id="5053073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053080">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053114">n</span><span class="op" id="5053115">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053122">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053128">line</span>&nbsp;<span class="op" id="5053133">=</span>&nbsp;<span class="ident" id="5053135">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053146">return</span>&nbsp;<span class="ident" id="5053153">n</span>&nbsp;<span class="op" id="5053155">&gt;</span>&nbsp;<span class="num" id="5053157">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053164">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053167">return</span>&nbsp;<span class="builtintype" id="5053174">false</span><br>
<span class="lineno"></span><span class="op" id="5053180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5053183">func</span>&nbsp;<span class="op" id="5053188">(</span><span class="ident" id="5053189">p</span>&nbsp;<span class="op" id="5053191">*</span><span class="ident" id="5053192">printer</span><span class="op" id="5053199">)</span>&nbsp;<span class="ident" id="5053201">stmt</span><span class="op" id="5053205">(</span><span class="ident" id="5053206">stmt</span>&nbsp;<span class="ident" id="5053211">ast</span><span class="op" id="5053214">.</span><span class="ident" id="5053215">Stmt</span><span class="op" id="5053219">,</span>&nbsp;<span class="ident" id="5053221">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5053234">bool</span><span class="op" id="5053238">)</span>&nbsp;<span class="op" id="5053240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053243">p</span><span class="op" id="5053244">.</span><span class="builtinfunc" id="5053245">print</span><span class="op" id="5053250">(</span><span class="ident" id="5053251">stmt</span><span class="op" id="5053255">.</span><span class="ident" id="5053256">Pos</span><span class="op" id="5053259">(</span><span class="op" id="5053260">)</span><span class="op" id="5053261">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053265">switch</span>&nbsp;<span class="ident" id="5053272">s</span>&nbsp;<span class="op" id="5053274">:=</span>&nbsp;<span class="ident" id="5053277">stmt</span><span class="op" id="5053281">.</span><span class="op" id="5053282">(</span><span class="keyword" id="5053283">type</span><span class="op" id="5053287">)</span>&nbsp;<span class="op" id="5053289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053292">case</span>&nbsp;<span class="op" id="5053297">*</span><span class="ident" id="5053298">ast</span><span class="op" id="5053301">.</span><span class="ident" id="5053302">BadStmt</span><span class="op" id="5053309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053313">p</span><span class="op" id="5053314">.</span><span class="builtinfunc" id="5053315">print</span><span class="op" id="5053320">(</span><span class="string" id="5053321">&#34;BadStmt&#34;</span><span class="op" id="5053330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053334">case</span>&nbsp;<span class="op" id="5053339">*</span><span class="ident" id="5053340">ast</span><span class="op" id="5053343">.</span><span class="ident" id="5053344">DeclStmt</span><span class="op" id="5053352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053356">p</span><span class="op" id="5053357">.</span><span class="ident" id="5053358">decl</span><span class="op" id="5053362">(</span><span class="ident" id="5053363">s</span><span class="op" id="5053364">.</span><span class="ident" id="5053365">Decl</span><span class="op" id="5053369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053373">case</span>&nbsp;<span class="op" id="5053378">*</span><span class="ident" id="5053379">ast</span><span class="op" id="5053382">.</span><span class="ident" id="5053383">EmptyStmt</span><span class="op" id="5053392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053396">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053415">case</span>&nbsp;<span class="op" id="5053420">*</span><span class="ident" id="5053421">ast</span><span class="op" id="5053424">.</span><span class="ident" id="5053425">LabeledStmt</span><span class="op" id="5053436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053440">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053504">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5053565">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053600">p</span><span class="op" id="5053601">.</span><span class="builtinfunc" id="5053602">print</span><span class="op" id="5053607">(</span><span class="ident" id="5053608">unindent</span><span class="op" id="5053616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053620">p</span><span class="op" id="5053621">.</span><span class="ident" id="5053622">expr</span><span class="op" id="5053626">(</span><span class="ident" id="5053627">s</span><span class="op" id="5053628">.</span><span class="ident" id="5053629">Label</span><span class="op" id="5053634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053638">p</span><span class="op" id="5053639">.</span><span class="builtinfunc" id="5053640">print</span><span class="op" id="5053645">(</span><span class="ident" id="5053646">s</span><span class="op" id="5053647">.</span><span class="ident" id="5053648">Colon</span><span class="op" id="5053653">,</span>&nbsp;<span class="ident" id="5053655">token</span><span class="op" id="5053660">.</span><span class="ident" id="5053661">COLON</span><span class="op" id="5053666">,</span>&nbsp;<span class="ident" id="5053668">indent</span><span class="op" id="5053674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053678">if</span>&nbsp;<span class="ident" id="5053681">e</span><span class="op" id="5053682">,</span>&nbsp;<span class="ident" id="5053684">isEmpty</span>&nbsp;<span class="op" id="5053692">:=</span>&nbsp;<span class="ident" id="5053695">s</span><span class="op" id="5053696">.</span><span class="ident" id="5053697">Stmt</span><span class="op" id="5053701">.</span><span class="op" id="5053702">(</span><span class="op" id="5053703">*</span><span class="ident" id="5053704">ast</span><span class="op" id="5053707">.</span><span class="ident" id="5053708">EmptyStmt</span><span class="op" id="5053717">)</span><span class="op" id="5053718">;</span>&nbsp;<span class="ident" id="5053720">isEmpty</span>&nbsp;<span class="op" id="5053728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053733">if</span>&nbsp;<span class="op" id="5053736">!</span><span class="ident" id="5053737">nextIsRBrace</span>&nbsp;<span class="op" id="5053750">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053756">p</span><span class="op" id="5053757">.</span><span class="builtinfunc" id="5053758">print</span><span class="op" id="5053763">(</span><span class="ident" id="5053764">newline</span><span class="op" id="5053771">,</span>&nbsp;<span class="ident" id="5053773">e</span><span class="op" id="5053774">.</span><span class="ident" id="5053775">Pos</span><span class="op" id="5053778">(</span><span class="op" id="5053779">)</span><span class="op" id="5053780">,</span>&nbsp;<span class="ident" id="5053782">token</span><span class="op" id="5053787">.</span><span class="ident" id="5053788">SEMICOLON</span><span class="op" id="5053797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053803">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053816">}</span>&nbsp;<span class="keyword" id="5053818">else</span>&nbsp;<span class="op" id="5053823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053828">p</span><span class="op" id="5053829">.</span><span class="ident" id="5053830">linebreak</span><span class="op" id="5053839">(</span><span class="ident" id="5053840">p</span><span class="op" id="5053841">.</span><span class="ident" id="5053842">lineFor</span><span class="op" id="5053849">(</span><span class="ident" id="5053850">s</span><span class="op" id="5053851">.</span><span class="ident" id="5053852">Stmt</span><span class="op" id="5053856">.</span><span class="ident" id="5053857">Pos</span><span class="op" id="5053860">(</span><span class="op" id="5053861">)</span><span class="op" id="5053862">)</span><span class="op" id="5053863">,</span>&nbsp;<span class="num" id="5053865">1</span><span class="op" id="5053866">,</span>&nbsp;<span class="ident" id="5053868">ignore</span><span class="op" id="5053874">,</span>&nbsp;<span class="builtintype" id="5053876">true</span><span class="op" id="5053880">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5053884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053888">p</span><span class="op" id="5053889">.</span><span class="ident" id="5053890">stmt</span><span class="op" id="5053894">(</span><span class="ident" id="5053895">s</span><span class="op" id="5053896">.</span><span class="ident" id="5053897">Stmt</span><span class="op" id="5053901">,</span>&nbsp;<span class="ident" id="5053903">nextIsRBrace</span><span class="op" id="5053915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053919">case</span>&nbsp;<span class="op" id="5053924">*</span><span class="ident" id="5053925">ast</span><span class="op" id="5053928">.</span><span class="ident" id="5053929">ExprStmt</span><span class="op" id="5053937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053941">const</span>&nbsp;<span class="ident" id="5053947">depth</span>&nbsp;<span class="op" id="5053953">=</span>&nbsp;<span class="num" id="5053955">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5053959">p</span><span class="op" id="5053960">.</span><span class="ident" id="5053961">expr0</span><span class="op" id="5053966">(</span><span class="ident" id="5053967">s</span><span class="op" id="5053968">.</span><span class="ident" id="5053969">X</span><span class="op" id="5053970">,</span>&nbsp;<span class="ident" id="5053972">depth</span><span class="op" id="5053977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5053981">case</span>&nbsp;<span class="op" id="5053986">*</span><span class="ident" id="5053987">ast</span><span class="op" id="5053990">.</span><span class="ident" id="5053991">SendStmt</span><span class="op" id="5053999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054003">const</span>&nbsp;<span class="ident" id="5054009">depth</span>&nbsp;<span class="op" id="5054015">=</span>&nbsp;<span class="num" id="5054017">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054021">p</span><span class="op" id="5054022">.</span><span class="ident" id="5054023">expr0</span><span class="op" id="5054028">(</span><span class="ident" id="5054029">s</span><span class="op" id="5054030">.</span><span class="ident" id="5054031">Chan</span><span class="op" id="5054035">,</span>&nbsp;<span class="ident" id="5054037">depth</span><span class="op" id="5054042">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054046">p</span><span class="op" id="5054047">.</span><span class="builtinfunc" id="5054048">print</span><span class="op" id="5054053">(</span><span class="ident" id="5054054">blank</span><span class="op" id="5054059">,</span>&nbsp;<span class="ident" id="5054061">s</span><span class="op" id="5054062">.</span><span class="ident" id="5054063">Arrow</span><span class="op" id="5054068">,</span>&nbsp;<span class="ident" id="5054070">token</span><span class="op" id="5054075">.</span><span class="ident" id="5054076">ARROW</span><span class="op" id="5054081">,</span>&nbsp;<span class="ident" id="5054083">blank</span><span class="op" id="5054088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054092">p</span><span class="op" id="5054093">.</span><span class="ident" id="5054094">expr0</span><span class="op" id="5054099">(</span><span class="ident" id="5054100">s</span><span class="op" id="5054101">.</span><span class="ident" id="5054102">Value</span><span class="op" id="5054107">,</span>&nbsp;<span class="ident" id="5054109">depth</span><span class="op" id="5054114">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054118">case</span>&nbsp;<span class="op" id="5054123">*</span><span class="ident" id="5054124">ast</span><span class="op" id="5054127">.</span><span class="ident" id="5054128">IncDecStmt</span><span class="op" id="5054138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054142">const</span>&nbsp;<span class="ident" id="5054148">depth</span>&nbsp;<span class="op" id="5054154">=</span>&nbsp;<span class="num" id="5054156">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054160">p</span><span class="op" id="5054161">.</span><span class="ident" id="5054162">expr0</span><span class="op" id="5054167">(</span><span class="ident" id="5054168">s</span><span class="op" id="5054169">.</span><span class="ident" id="5054170">X</span><span class="op" id="5054171">,</span>&nbsp;<span class="ident" id="5054173">depth</span><span class="op" id="5054178">+</span><span class="num" id="5054179">1</span><span class="op" id="5054180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054184">p</span><span class="op" id="5054185">.</span><span class="builtinfunc" id="5054186">print</span><span class="op" id="5054191">(</span><span class="ident" id="5054192">s</span><span class="op" id="5054193">.</span><span class="ident" id="5054194">TokPos</span><span class="op" id="5054200">,</span>&nbsp;<span class="ident" id="5054202">s</span><span class="op" id="5054203">.</span><span class="ident" id="5054204">Tok</span><span class="op" id="5054207">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054211">case</span>&nbsp;<span class="op" id="5054216">*</span><span class="ident" id="5054217">ast</span><span class="op" id="5054220">.</span><span class="ident" id="5054221">AssignStmt</span><span class="op" id="5054231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054235">var</span>&nbsp;<span class="ident" id="5054239">depth</span>&nbsp;<span class="op" id="5054245">=</span>&nbsp;<span class="num" id="5054247">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054251">if</span>&nbsp;<span class="builtinfunc" id="5054254">len</span><span class="op" id="5054257">(</span><span class="ident" id="5054258">s</span><span class="op" id="5054259">.</span><span class="ident" id="5054260">Lhs</span><span class="op" id="5054263">)</span>&nbsp;<span class="op" id="5054265">&gt;</span>&nbsp;<span class="num" id="5054267">1</span>&nbsp;<span class="op" id="5054269">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5054272">len</span><span class="op" id="5054275">(</span><span class="ident" id="5054276">s</span><span class="op" id="5054277">.</span><span class="ident" id="5054278">Rhs</span><span class="op" id="5054281">)</span>&nbsp;<span class="op" id="5054283">&gt;</span>&nbsp;<span class="num" id="5054285">1</span>&nbsp;<span class="op" id="5054287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054292">depth</span><span class="op" id="5054297">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5054302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054306">p</span><span class="op" id="5054307">.</span><span class="ident" id="5054308">exprList</span><span class="op" id="5054316">(</span><span class="ident" id="5054317">s</span><span class="op" id="5054318">.</span><span class="ident" id="5054319">Pos</span><span class="op" id="5054322">(</span><span class="op" id="5054323">)</span><span class="op" id="5054324">,</span>&nbsp;<span class="ident" id="5054326">s</span><span class="op" id="5054327">.</span><span class="ident" id="5054328">Lhs</span><span class="op" id="5054331">,</span>&nbsp;<span class="ident" id="5054333">depth</span><span class="op" id="5054338">,</span>&nbsp;<span class="num" id="5054340">0</span><span class="op" id="5054341">,</span>&nbsp;<span class="ident" id="5054343">s</span><span class="op" id="5054344">.</span><span class="ident" id="5054345">TokPos</span><span class="op" id="5054351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054355">p</span><span class="op" id="5054356">.</span><span class="builtinfunc" id="5054357">print</span><span class="op" id="5054362">(</span><span class="ident" id="5054363">blank</span><span class="op" id="5054368">,</span>&nbsp;<span class="ident" id="5054370">s</span><span class="op" id="5054371">.</span><span class="ident" id="5054372">TokPos</span><span class="op" id="5054378">,</span>&nbsp;<span class="ident" id="5054380">s</span><span class="op" id="5054381">.</span><span class="ident" id="5054382">Tok</span><span class="op" id="5054385">,</span>&nbsp;<span class="ident" id="5054387">blank</span><span class="op" id="5054392">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054396">p</span><span class="op" id="5054397">.</span><span class="ident" id="5054398">exprList</span><span class="op" id="5054406">(</span><span class="ident" id="5054407">s</span><span class="op" id="5054408">.</span><span class="ident" id="5054409">TokPos</span><span class="op" id="5054415">,</span>&nbsp;<span class="ident" id="5054417">s</span><span class="op" id="5054418">.</span><span class="ident" id="5054419">Rhs</span><span class="op" id="5054422">,</span>&nbsp;<span class="ident" id="5054424">depth</span><span class="op" id="5054429">,</span>&nbsp;<span class="num" id="5054431">0</span><span class="op" id="5054432">,</span>&nbsp;<span class="ident" id="5054434">token</span><span class="op" id="5054439">.</span><span class="ident" id="5054440">NoPos</span><span class="op" id="5054445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054449">case</span>&nbsp;<span class="op" id="5054454">*</span><span class="ident" id="5054455">ast</span><span class="op" id="5054458">.</span><span class="ident" id="5054459">GoStmt</span><span class="op" id="5054465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054469">p</span><span class="op" id="5054470">.</span><span class="builtinfunc" id="5054471">print</span><span class="op" id="5054476">(</span><span class="ident" id="5054477">token</span><span class="op" id="5054482">.</span><span class="ident" id="5054483">GO</span><span class="op" id="5054485">,</span>&nbsp;<span class="ident" id="5054487">blank</span><span class="op" id="5054492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054496">p</span><span class="op" id="5054497">.</span><span class="ident" id="5054498">expr</span><span class="op" id="5054502">(</span><span class="ident" id="5054503">s</span><span class="op" id="5054504">.</span><span class="ident" id="5054505">Call</span><span class="op" id="5054509">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054513">case</span>&nbsp;<span class="op" id="5054518">*</span><span class="ident" id="5054519">ast</span><span class="op" id="5054522">.</span><span class="ident" id="5054523">DeferStmt</span><span class="op" id="5054532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054536">p</span><span class="op" id="5054537">.</span><span class="builtinfunc" id="5054538">print</span><span class="op" id="5054543">(</span><span class="ident" id="5054544">token</span><span class="op" id="5054549">.</span><span class="ident" id="5054550">DEFER</span><span class="op" id="5054555">,</span>&nbsp;<span class="ident" id="5054557">blank</span><span class="op" id="5054562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054566">p</span><span class="op" id="5054567">.</span><span class="ident" id="5054568">expr</span><span class="op" id="5054572">(</span><span class="ident" id="5054573">s</span><span class="op" id="5054574">.</span><span class="ident" id="5054575">Call</span><span class="op" id="5054579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054583">case</span>&nbsp;<span class="op" id="5054588">*</span><span class="ident" id="5054589">ast</span><span class="op" id="5054592">.</span><span class="ident" id="5054593">ReturnStmt</span><span class="op" id="5054603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054607">p</span><span class="op" id="5054608">.</span><span class="builtinfunc" id="5054609">print</span><span class="op" id="5054614">(</span><span class="ident" id="5054615">token</span><span class="op" id="5054620">.</span><span class="ident" id="5054621">RETURN</span><span class="op" id="5054627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054631">if</span>&nbsp;<span class="ident" id="5054634">s</span><span class="op" id="5054635">.</span><span class="ident" id="5054636">Results</span>&nbsp;<span class="op" id="5054644">!=</span>&nbsp;<span class="builtintype" id="5054647">nil</span>&nbsp;<span class="op" id="5054651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054656">p</span><span class="op" id="5054657">.</span><span class="builtinfunc" id="5054658">print</span><span class="op" id="5054663">(</span><span class="ident" id="5054664">blank</span><span class="op" id="5054669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5054674">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5054731">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5054791">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5054845">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5054901">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5054954">if</span>&nbsp;<span class="ident" id="5054957">p</span><span class="op" id="5054958">.</span><span class="ident" id="5054959">indentList</span><span class="op" id="5054969">(</span><span class="ident" id="5054970">s</span><span class="op" id="5054971">.</span><span class="ident" id="5054972">Results</span><span class="op" id="5054979">)</span>&nbsp;<span class="op" id="5054981">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5054987">p</span><span class="op" id="5054988">.</span><span class="builtinfunc" id="5054989">print</span><span class="op" id="5054994">(</span><span class="ident" id="5054995">indent</span><span class="op" id="5055001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055007">p</span><span class="op" id="5055008">.</span><span class="ident" id="5055009">exprList</span><span class="op" id="5055017">(</span><span class="ident" id="5055018">s</span><span class="op" id="5055019">.</span><span class="ident" id="5055020">Pos</span><span class="op" id="5055023">(</span><span class="op" id="5055024">)</span><span class="op" id="5055025">,</span>&nbsp;<span class="ident" id="5055027">s</span><span class="op" id="5055028">.</span><span class="ident" id="5055029">Results</span><span class="op" id="5055036">,</span>&nbsp;<span class="num" id="5055038">1</span><span class="op" id="5055039">,</span>&nbsp;<span class="ident" id="5055041">noIndent</span><span class="op" id="5055049">,</span>&nbsp;<span class="ident" id="5055051">token</span><span class="op" id="5055056">.</span><span class="ident" id="5055057">NoPos</span><span class="op" id="5055062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055068">p</span><span class="op" id="5055069">.</span><span class="builtinfunc" id="5055070">print</span><span class="op" id="5055075">(</span><span class="ident" id="5055076">unindent</span><span class="op" id="5055084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055089">}</span>&nbsp;<span class="keyword" id="5055091">else</span>&nbsp;<span class="op" id="5055096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055102">p</span><span class="op" id="5055103">.</span><span class="ident" id="5055104">exprList</span><span class="op" id="5055112">(</span><span class="ident" id="5055113">s</span><span class="op" id="5055114">.</span><span class="ident" id="5055115">Pos</span><span class="op" id="5055118">(</span><span class="op" id="5055119">)</span><span class="op" id="5055120">,</span>&nbsp;<span class="ident" id="5055122">s</span><span class="op" id="5055123">.</span><span class="ident" id="5055124">Results</span><span class="op" id="5055131">,</span>&nbsp;<span class="num" id="5055133">1</span><span class="op" id="5055134">,</span>&nbsp;<span class="num" id="5055136">0</span><span class="op" id="5055137">,</span>&nbsp;<span class="ident" id="5055139">token</span><span class="op" id="5055144">.</span><span class="ident" id="5055145">NoPos</span><span class="op" id="5055150">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055163">case</span>&nbsp;<span class="op" id="5055168">*</span><span class="ident" id="5055169">ast</span><span class="op" id="5055172">.</span><span class="ident" id="5055173">BranchStmt</span><span class="op" id="5055183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055187">p</span><span class="op" id="5055188">.</span><span class="builtinfunc" id="5055189">print</span><span class="op" id="5055194">(</span><span class="ident" id="5055195">s</span><span class="op" id="5055196">.</span><span class="ident" id="5055197">Tok</span><span class="op" id="5055200">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055204">if</span>&nbsp;<span class="ident" id="5055207">s</span><span class="op" id="5055208">.</span><span class="ident" id="5055209">Label</span>&nbsp;<span class="op" id="5055215">!=</span>&nbsp;<span class="builtintype" id="5055218">nil</span>&nbsp;<span class="op" id="5055222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055227">p</span><span class="op" id="5055228">.</span><span class="builtinfunc" id="5055229">print</span><span class="op" id="5055234">(</span><span class="ident" id="5055235">blank</span><span class="op" id="5055240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055245">p</span><span class="op" id="5055246">.</span><span class="ident" id="5055247">expr</span><span class="op" id="5055251">(</span><span class="ident" id="5055252">s</span><span class="op" id="5055253">.</span><span class="ident" id="5055254">Label</span><span class="op" id="5055259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055267">case</span>&nbsp;<span class="op" id="5055272">*</span><span class="ident" id="5055273">ast</span><span class="op" id="5055276">.</span><span class="ident" id="5055277">BlockStmt</span><span class="op" id="5055286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055290">p</span><span class="op" id="5055291">.</span><span class="ident" id="5055292">block</span><span class="op" id="5055297">(</span><span class="ident" id="5055298">s</span><span class="op" id="5055299">,</span>&nbsp;<span class="num" id="5055301">1</span><span class="op" id="5055302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055306">case</span>&nbsp;<span class="op" id="5055311">*</span><span class="ident" id="5055312">ast</span><span class="op" id="5055315">.</span><span class="ident" id="5055316">IfStmt</span><span class="op" id="5055322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055326">p</span><span class="op" id="5055327">.</span><span class="builtinfunc" id="5055328">print</span><span class="op" id="5055333">(</span><span class="ident" id="5055334">token</span><span class="op" id="5055339">.</span><span class="ident" id="5055340">IF</span><span class="op" id="5055342">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055346">p</span><span class="op" id="5055347">.</span><span class="ident" id="5055348">controlClause</span><span class="op" id="5055361">(</span><span class="builtintype" id="5055362">false</span><span class="op" id="5055367">,</span>&nbsp;<span class="ident" id="5055369">s</span><span class="op" id="5055370">.</span><span class="ident" id="5055371">Init</span><span class="op" id="5055375">,</span>&nbsp;<span class="ident" id="5055377">s</span><span class="op" id="5055378">.</span><span class="ident" id="5055379">Cond</span><span class="op" id="5055383">,</span>&nbsp;<span class="builtintype" id="5055385">nil</span><span class="op" id="5055388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055392">p</span><span class="op" id="5055393">.</span><span class="ident" id="5055394">block</span><span class="op" id="5055399">(</span><span class="ident" id="5055400">s</span><span class="op" id="5055401">.</span><span class="ident" id="5055402">Body</span><span class="op" id="5055406">,</span>&nbsp;<span class="num" id="5055408">1</span><span class="op" id="5055409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055413">if</span>&nbsp;<span class="ident" id="5055416">s</span><span class="op" id="5055417">.</span><span class="ident" id="5055418">Else</span>&nbsp;<span class="op" id="5055423">!=</span>&nbsp;<span class="builtintype" id="5055426">nil</span>&nbsp;<span class="op" id="5055430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055435">p</span><span class="op" id="5055436">.</span><span class="builtinfunc" id="5055437">print</span><span class="op" id="5055442">(</span><span class="ident" id="5055443">blank</span><span class="op" id="5055448">,</span>&nbsp;<span class="ident" id="5055450">token</span><span class="op" id="5055455">.</span><span class="ident" id="5055456">ELSE</span><span class="op" id="5055460">,</span>&nbsp;<span class="ident" id="5055462">blank</span><span class="op" id="5055467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055472">switch</span>&nbsp;<span class="ident" id="5055479">s</span><span class="op" id="5055480">.</span><span class="ident" id="5055481">Else</span><span class="op" id="5055485">.</span><span class="op" id="5055486">(</span><span class="keyword" id="5055487">type</span><span class="op" id="5055491">)</span>&nbsp;<span class="op" id="5055493">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055498">case</span>&nbsp;<span class="op" id="5055503">*</span><span class="ident" id="5055504">ast</span><span class="op" id="5055507">.</span><span class="ident" id="5055508">BlockStmt</span><span class="op" id="5055517">,</span>&nbsp;<span class="op" id="5055519">*</span><span class="ident" id="5055520">ast</span><span class="op" id="5055523">.</span><span class="ident" id="5055524">IfStmt</span><span class="op" id="5055530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055536">p</span><span class="op" id="5055537">.</span><span class="ident" id="5055538">stmt</span><span class="op" id="5055542">(</span><span class="ident" id="5055543">s</span><span class="op" id="5055544">.</span><span class="ident" id="5055545">Else</span><span class="op" id="5055549">,</span>&nbsp;<span class="ident" id="5055551">nextIsRBrace</span><span class="op" id="5055563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055568">default</span><span class="op" id="5055575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055581">p</span><span class="op" id="5055582">.</span><span class="builtinfunc" id="5055583">print</span><span class="op" id="5055588">(</span><span class="ident" id="5055589">token</span><span class="op" id="5055594">.</span><span class="ident" id="5055595">LBRACE</span><span class="op" id="5055601">,</span>&nbsp;<span class="ident" id="5055603">indent</span><span class="op" id="5055609">,</span>&nbsp;<span class="ident" id="5055611">formfeed</span><span class="op" id="5055619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055625">p</span><span class="op" id="5055626">.</span><span class="ident" id="5055627">stmt</span><span class="op" id="5055631">(</span><span class="ident" id="5055632">s</span><span class="op" id="5055633">.</span><span class="ident" id="5055634">Else</span><span class="op" id="5055638">,</span>&nbsp;<span class="builtintype" id="5055640">true</span><span class="op" id="5055644">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055650">p</span><span class="op" id="5055651">.</span><span class="builtinfunc" id="5055652">print</span><span class="op" id="5055657">(</span><span class="ident" id="5055658">unindent</span><span class="op" id="5055666">,</span>&nbsp;<span class="ident" id="5055668">formfeed</span><span class="op" id="5055676">,</span>&nbsp;<span class="ident" id="5055678">token</span><span class="op" id="5055683">.</span><span class="ident" id="5055684">RBRACE</span><span class="op" id="5055690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055703">case</span>&nbsp;<span class="op" id="5055708">*</span><span class="ident" id="5055709">ast</span><span class="op" id="5055712">.</span><span class="ident" id="5055713">CaseClause</span><span class="op" id="5055723">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055727">if</span>&nbsp;<span class="ident" id="5055730">s</span><span class="op" id="5055731">.</span><span class="ident" id="5055732">List</span>&nbsp;<span class="op" id="5055737">!=</span>&nbsp;<span class="builtintype" id="5055740">nil</span>&nbsp;<span class="op" id="5055744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055749">p</span><span class="op" id="5055750">.</span><span class="builtinfunc" id="5055751">print</span><span class="op" id="5055756">(</span><span class="ident" id="5055757">token</span><span class="op" id="5055762">.</span><span class="ident" id="5055763">CASE</span><span class="op" id="5055767">,</span>&nbsp;<span class="ident" id="5055769">blank</span><span class="op" id="5055774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055779">p</span><span class="op" id="5055780">.</span><span class="ident" id="5055781">exprList</span><span class="op" id="5055789">(</span><span class="ident" id="5055790">s</span><span class="op" id="5055791">.</span><span class="ident" id="5055792">Pos</span><span class="op" id="5055795">(</span><span class="op" id="5055796">)</span><span class="op" id="5055797">,</span>&nbsp;<span class="ident" id="5055799">s</span><span class="op" id="5055800">.</span><span class="ident" id="5055801">List</span><span class="op" id="5055805">,</span>&nbsp;<span class="num" id="5055807">1</span><span class="op" id="5055808">,</span>&nbsp;<span class="num" id="5055810">0</span><span class="op" id="5055811">,</span>&nbsp;<span class="ident" id="5055813">s</span><span class="op" id="5055814">.</span><span class="ident" id="5055815">Colon</span><span class="op" id="5055820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055824">}</span>&nbsp;<span class="keyword" id="5055826">else</span>&nbsp;<span class="op" id="5055831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055836">p</span><span class="op" id="5055837">.</span><span class="builtinfunc" id="5055838">print</span><span class="op" id="5055843">(</span><span class="ident" id="5055844">token</span><span class="op" id="5055849">.</span><span class="ident" id="5055850">DEFAULT</span><span class="op" id="5055857">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5055861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055865">p</span><span class="op" id="5055866">.</span><span class="builtinfunc" id="5055867">print</span><span class="op" id="5055872">(</span><span class="ident" id="5055873">s</span><span class="op" id="5055874">.</span><span class="ident" id="5055875">Colon</span><span class="op" id="5055880">,</span>&nbsp;<span class="ident" id="5055882">token</span><span class="op" id="5055887">.</span><span class="ident" id="5055888">COLON</span><span class="op" id="5055893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055897">p</span><span class="op" id="5055898">.</span><span class="ident" id="5055899">stmtList</span><span class="op" id="5055907">(</span><span class="ident" id="5055908">s</span><span class="op" id="5055909">.</span><span class="ident" id="5055910">Body</span><span class="op" id="5055914">,</span>&nbsp;<span class="num" id="5055916">1</span><span class="op" id="5055917">,</span>&nbsp;<span class="ident" id="5055919">nextIsRBrace</span><span class="op" id="5055931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5055935">case</span>&nbsp;<span class="op" id="5055940">*</span><span class="ident" id="5055941">ast</span><span class="op" id="5055944">.</span><span class="ident" id="5055945">SwitchStmt</span><span class="op" id="5055955">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055959">p</span><span class="op" id="5055960">.</span><span class="builtinfunc" id="5055961">print</span><span class="op" id="5055966">(</span><span class="ident" id="5055967">token</span><span class="op" id="5055972">.</span><span class="ident" id="5055973">SWITCH</span><span class="op" id="5055979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5055983">p</span><span class="op" id="5055984">.</span><span class="ident" id="5055985">controlClause</span><span class="op" id="5055998">(</span><span class="builtintype" id="5055999">false</span><span class="op" id="5056004">,</span>&nbsp;<span class="ident" id="5056006">s</span><span class="op" id="5056007">.</span><span class="ident" id="5056008">Init</span><span class="op" id="5056012">,</span>&nbsp;<span class="ident" id="5056014">s</span><span class="op" id="5056015">.</span><span class="ident" id="5056016">Tag</span><span class="op" id="5056019">,</span>&nbsp;<span class="builtintype" id="5056021">nil</span><span class="op" id="5056024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056028">p</span><span class="op" id="5056029">.</span><span class="ident" id="5056030">block</span><span class="op" id="5056035">(</span><span class="ident" id="5056036">s</span><span class="op" id="5056037">.</span><span class="ident" id="5056038">Body</span><span class="op" id="5056042">,</span>&nbsp;<span class="num" id="5056044">0</span><span class="op" id="5056045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056049">case</span>&nbsp;<span class="op" id="5056054">*</span><span class="ident" id="5056055">ast</span><span class="op" id="5056058">.</span><span class="ident" id="5056059">TypeSwitchStmt</span><span class="op" id="5056073">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056077">p</span><span class="op" id="5056078">.</span><span class="builtinfunc" id="5056079">print</span><span class="op" id="5056084">(</span><span class="ident" id="5056085">token</span><span class="op" id="5056090">.</span><span class="ident" id="5056091">SWITCH</span><span class="op" id="5056097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056101">if</span>&nbsp;<span class="ident" id="5056104">s</span><span class="op" id="5056105">.</span><span class="ident" id="5056106">Init</span>&nbsp;<span class="op" id="5056111">!=</span>&nbsp;<span class="builtintype" id="5056114">nil</span>&nbsp;<span class="op" id="5056118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056123">p</span><span class="op" id="5056124">.</span><span class="builtinfunc" id="5056125">print</span><span class="op" id="5056130">(</span><span class="ident" id="5056131">blank</span><span class="op" id="5056136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056141">p</span><span class="op" id="5056142">.</span><span class="ident" id="5056143">stmt</span><span class="op" id="5056147">(</span><span class="ident" id="5056148">s</span><span class="op" id="5056149">.</span><span class="ident" id="5056150">Init</span><span class="op" id="5056154">,</span>&nbsp;<span class="builtintype" id="5056156">false</span><span class="op" id="5056161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056166">p</span><span class="op" id="5056167">.</span><span class="builtinfunc" id="5056168">print</span><span class="op" id="5056173">(</span><span class="ident" id="5056174">token</span><span class="op" id="5056179">.</span><span class="ident" id="5056180">SEMICOLON</span><span class="op" id="5056189">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5056193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056197">p</span><span class="op" id="5056198">.</span><span class="builtinfunc" id="5056199">print</span><span class="op" id="5056204">(</span><span class="ident" id="5056205">blank</span><span class="op" id="5056210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056214">p</span><span class="op" id="5056215">.</span><span class="ident" id="5056216">stmt</span><span class="op" id="5056220">(</span><span class="ident" id="5056221">s</span><span class="op" id="5056222">.</span><span class="ident" id="5056223">Assign</span><span class="op" id="5056229">,</span>&nbsp;<span class="builtintype" id="5056231">false</span><span class="op" id="5056236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056240">p</span><span class="op" id="5056241">.</span><span class="builtinfunc" id="5056242">print</span><span class="op" id="5056247">(</span><span class="ident" id="5056248">blank</span><span class="op" id="5056253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056257">p</span><span class="op" id="5056258">.</span><span class="ident" id="5056259">block</span><span class="op" id="5056264">(</span><span class="ident" id="5056265">s</span><span class="op" id="5056266">.</span><span class="ident" id="5056267">Body</span><span class="op" id="5056271">,</span>&nbsp;<span class="num" id="5056273">0</span><span class="op" id="5056274">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056278">case</span>&nbsp;<span class="op" id="5056283">*</span><span class="ident" id="5056284">ast</span><span class="op" id="5056287">.</span><span class="ident" id="5056288">CommClause</span><span class="op" id="5056298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056302">if</span>&nbsp;<span class="ident" id="5056305">s</span><span class="op" id="5056306">.</span><span class="ident" id="5056307">Comm</span>&nbsp;<span class="op" id="5056312">!=</span>&nbsp;<span class="builtintype" id="5056315">nil</span>&nbsp;<span class="op" id="5056319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056324">p</span><span class="op" id="5056325">.</span><span class="builtinfunc" id="5056326">print</span><span class="op" id="5056331">(</span><span class="ident" id="5056332">token</span><span class="op" id="5056337">.</span><span class="ident" id="5056338">CASE</span><span class="op" id="5056342">,</span>&nbsp;<span class="ident" id="5056344">blank</span><span class="op" id="5056349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056354">p</span><span class="op" id="5056355">.</span><span class="ident" id="5056356">stmt</span><span class="op" id="5056360">(</span><span class="ident" id="5056361">s</span><span class="op" id="5056362">.</span><span class="ident" id="5056363">Comm</span><span class="op" id="5056367">,</span>&nbsp;<span class="builtintype" id="5056369">false</span><span class="op" id="5056374">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5056378">}</span>&nbsp;<span class="keyword" id="5056380">else</span>&nbsp;<span class="op" id="5056385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056390">p</span><span class="op" id="5056391">.</span><span class="builtinfunc" id="5056392">print</span><span class="op" id="5056397">(</span><span class="ident" id="5056398">token</span><span class="op" id="5056403">.</span><span class="ident" id="5056404">DEFAULT</span><span class="op" id="5056411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5056415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056419">p</span><span class="op" id="5056420">.</span><span class="builtinfunc" id="5056421">print</span><span class="op" id="5056426">(</span><span class="ident" id="5056427">s</span><span class="op" id="5056428">.</span><span class="ident" id="5056429">Colon</span><span class="op" id="5056434">,</span>&nbsp;<span class="ident" id="5056436">token</span><span class="op" id="5056441">.</span><span class="ident" id="5056442">COLON</span><span class="op" id="5056447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056451">p</span><span class="op" id="5056452">.</span><span class="ident" id="5056453">stmtList</span><span class="op" id="5056461">(</span><span class="ident" id="5056462">s</span><span class="op" id="5056463">.</span><span class="ident" id="5056464">Body</span><span class="op" id="5056468">,</span>&nbsp;<span class="num" id="5056470">1</span><span class="op" id="5056471">,</span>&nbsp;<span class="ident" id="5056473">nextIsRBrace</span><span class="op" id="5056485">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056489">case</span>&nbsp;<span class="op" id="5056494">*</span><span class="ident" id="5056495">ast</span><span class="op" id="5056498">.</span><span class="ident" id="5056499">SelectStmt</span><span class="op" id="5056509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056513">p</span><span class="op" id="5056514">.</span><span class="builtinfunc" id="5056515">print</span><span class="op" id="5056520">(</span><span class="ident" id="5056521">token</span><span class="op" id="5056526">.</span><span class="ident" id="5056527">SELECT</span><span class="op" id="5056533">,</span>&nbsp;<span class="ident" id="5056535">blank</span><span class="op" id="5056540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056544">body</span>&nbsp;<span class="op" id="5056549">:=</span>&nbsp;<span class="ident" id="5056552">s</span><span class="op" id="5056553">.</span><span class="ident" id="5056554">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056561">if</span>&nbsp;<span class="builtinfunc" id="5056564">len</span><span class="op" id="5056567">(</span><span class="ident" id="5056568">body</span><span class="op" id="5056572">.</span><span class="ident" id="5056573">List</span><span class="op" id="5056577">)</span>&nbsp;<span class="op" id="5056579">==</span>&nbsp;<span class="num" id="5056582">0</span>&nbsp;<span class="op" id="5056584">&amp;&amp;</span>&nbsp;<span class="op" id="5056587">!</span><span class="ident" id="5056588">p</span><span class="op" id="5056589">.</span><span class="ident" id="5056590">commentBefore</span><span class="op" id="5056603">(</span><span class="ident" id="5056604">p</span><span class="op" id="5056605">.</span><span class="ident" id="5056606">posFor</span><span class="op" id="5056612">(</span><span class="ident" id="5056613">body</span><span class="op" id="5056617">.</span><span class="ident" id="5056618">Rbrace</span><span class="op" id="5056624">)</span><span class="op" id="5056625">)</span>&nbsp;<span class="op" id="5056627">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5056632">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056692">p</span><span class="op" id="5056693">.</span><span class="builtinfunc" id="5056694">print</span><span class="op" id="5056699">(</span><span class="ident" id="5056700">body</span><span class="op" id="5056704">.</span><span class="ident" id="5056705">Lbrace</span><span class="op" id="5056711">,</span>&nbsp;<span class="ident" id="5056713">token</span><span class="op" id="5056718">.</span><span class="ident" id="5056719">LBRACE</span><span class="op" id="5056725">,</span>&nbsp;<span class="ident" id="5056727">body</span><span class="op" id="5056731">.</span><span class="ident" id="5056732">Rbrace</span><span class="op" id="5056738">,</span>&nbsp;<span class="ident" id="5056740">token</span><span class="op" id="5056745">.</span><span class="ident" id="5056746">RBRACE</span><span class="op" id="5056752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5056756">}</span>&nbsp;<span class="keyword" id="5056758">else</span>&nbsp;<span class="op" id="5056763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056768">p</span><span class="op" id="5056769">.</span><span class="ident" id="5056770">block</span><span class="op" id="5056775">(</span><span class="ident" id="5056776">body</span><span class="op" id="5056780">,</span>&nbsp;<span class="num" id="5056782">0</span><span class="op" id="5056783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5056787">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056791">case</span>&nbsp;<span class="op" id="5056796">*</span><span class="ident" id="5056797">ast</span><span class="op" id="5056800">.</span><span class="ident" id="5056801">ForStmt</span><span class="op" id="5056808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056812">p</span><span class="op" id="5056813">.</span><span class="builtinfunc" id="5056814">print</span><span class="op" id="5056819">(</span><span class="ident" id="5056820">token</span><span class="op" id="5056825">.</span><span class="ident" id="5056826">FOR</span><span class="op" id="5056829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056833">p</span><span class="op" id="5056834">.</span><span class="ident" id="5056835">controlClause</span><span class="op" id="5056848">(</span><span class="builtintype" id="5056849">true</span><span class="op" id="5056853">,</span>&nbsp;<span class="ident" id="5056855">s</span><span class="op" id="5056856">.</span><span class="ident" id="5056857">Init</span><span class="op" id="5056861">,</span>&nbsp;<span class="ident" id="5056863">s</span><span class="op" id="5056864">.</span><span class="ident" id="5056865">Cond</span><span class="op" id="5056869">,</span>&nbsp;<span class="ident" id="5056871">s</span><span class="op" id="5056872">.</span><span class="ident" id="5056873">Post</span><span class="op" id="5056877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056881">p</span><span class="op" id="5056882">.</span><span class="ident" id="5056883">block</span><span class="op" id="5056888">(</span><span class="ident" id="5056889">s</span><span class="op" id="5056890">.</span><span class="ident" id="5056891">Body</span><span class="op" id="5056895">,</span>&nbsp;<span class="num" id="5056897">1</span><span class="op" id="5056898">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056902">case</span>&nbsp;<span class="op" id="5056907">*</span><span class="ident" id="5056908">ast</span><span class="op" id="5056911">.</span><span class="ident" id="5056912">RangeStmt</span><span class="op" id="5056921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056925">p</span><span class="op" id="5056926">.</span><span class="builtinfunc" id="5056927">print</span><span class="op" id="5056932">(</span><span class="ident" id="5056933">token</span><span class="op" id="5056938">.</span><span class="ident" id="5056939">FOR</span><span class="op" id="5056942">,</span>&nbsp;<span class="ident" id="5056944">blank</span><span class="op" id="5056949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056953">if</span>&nbsp;<span class="ident" id="5056956">s</span><span class="op" id="5056957">.</span><span class="ident" id="5056958">Key</span>&nbsp;<span class="op" id="5056962">!=</span>&nbsp;<span class="builtintype" id="5056965">nil</span>&nbsp;<span class="op" id="5056969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5056974">p</span><span class="op" id="5056975">.</span><span class="ident" id="5056976">expr</span><span class="op" id="5056980">(</span><span class="ident" id="5056981">s</span><span class="op" id="5056982">.</span><span class="ident" id="5056983">Key</span><span class="op" id="5056986">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5056991">if</span>&nbsp;<span class="ident" id="5056994">s</span><span class="op" id="5056995">.</span><span class="ident" id="5056996">Value</span>&nbsp;<span class="op" id="5057002">!=</span>&nbsp;<span class="builtintype" id="5057005">nil</span>&nbsp;<span class="op" id="5057009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5057015">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5057067">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057119">p</span><span class="op" id="5057120">.</span><span class="builtinfunc" id="5057121">print</span><span class="op" id="5057126">(</span><span class="ident" id="5057127">s</span><span class="op" id="5057128">.</span><span class="ident" id="5057129">Value</span><span class="op" id="5057134">.</span><span class="ident" id="5057135">Pos</span><span class="op" id="5057138">(</span><span class="op" id="5057139">)</span><span class="op" id="5057140">,</span>&nbsp;<span class="ident" id="5057142">token</span><span class="op" id="5057147">.</span><span class="ident" id="5057148">COMMA</span><span class="op" id="5057153">,</span>&nbsp;<span class="ident" id="5057155">blank</span><span class="op" id="5057160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057166">p</span><span class="op" id="5057167">.</span><span class="ident" id="5057168">expr</span><span class="op" id="5057172">(</span><span class="ident" id="5057173">s</span><span class="op" id="5057174">.</span><span class="ident" id="5057175">Value</span><span class="op" id="5057180">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5057185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057190">p</span><span class="op" id="5057191">.</span><span class="builtinfunc" id="5057192">print</span><span class="op" id="5057197">(</span><span class="ident" id="5057198">blank</span><span class="op" id="5057203">,</span>&nbsp;<span class="ident" id="5057205">s</span><span class="op" id="5057206">.</span><span class="ident" id="5057207">TokPos</span><span class="op" id="5057213">,</span>&nbsp;<span class="ident" id="5057215">s</span><span class="op" id="5057216">.</span><span class="ident" id="5057217">Tok</span><span class="op" id="5057220">,</span>&nbsp;<span class="ident" id="5057222">blank</span><span class="op" id="5057227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5057231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057235">p</span><span class="op" id="5057236">.</span><span class="builtinfunc" id="5057237">print</span><span class="op" id="5057242">(</span><span class="ident" id="5057243">token</span><span class="op" id="5057248">.</span><span class="ident" id="5057249">RANGE</span><span class="op" id="5057254">,</span>&nbsp;<span class="ident" id="5057256">blank</span><span class="op" id="5057261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057265">p</span><span class="op" id="5057266">.</span><span class="ident" id="5057267">expr</span><span class="op" id="5057271">(</span><span class="ident" id="5057272">stripParens</span><span class="op" id="5057283">(</span><span class="ident" id="5057284">s</span><span class="op" id="5057285">.</span><span class="ident" id="5057286">X</span><span class="op" id="5057287">)</span><span class="op" id="5057288">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057292">p</span><span class="op" id="5057293">.</span><span class="builtinfunc" id="5057294">print</span><span class="op" id="5057299">(</span><span class="ident" id="5057300">blank</span><span class="op" id="5057305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5057309">p</span><span class="op" id="5057310">.</span><span class="ident" id="5057311">block</span><span class="op" id="5057316">(</span><span class="ident" id="5057317">s</span><span class="op" id="5057318">.</span><span class="ident" id="5057319">Body</span><span class="op" id="5057323">,</span>&nbsp;<span class="num" id="5057325">1</span><span class="op" id="5057326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5057330">default</span><span class="op" id="5057337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5057341">panic</span><span class="op" id="5057346">(</span><span class="string" id="5057347">&#34;unreachable&#34;</span><span class="op" id="5057360">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5057363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5057367">return</span><br>
<span class="lineno"></span><span class="op" id="5057374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5057377">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5057457">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5057474">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5057550">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5057626">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5057701">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5057776">//</span><br>
<span class="lineno"></span><span class="comment" id="5057779">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5057812">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5057815">//&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5057826">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5057857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5057888">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foo</span><br>
<span class="lineno"></span><span class="comment" id="5057896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5057922">//&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5057927">//</span><br>
<span class="lineno"></span><span class="comment" id="5057930">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5058003">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5058078">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5058155">//</span><br>
<span class="lineno"></span><span class="comment" id="5058158">//&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5058196">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5058225">//&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5058295">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5058356">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5058393">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5058459">//</span><br>
<span class="lineno"></span><span class="keyword" id="5058462">func</span>&nbsp;<span class="ident" id="5058467">keepTypeColumn</span><span class="op" id="5058481">(</span><span class="ident" id="5058482">specs</span>&nbsp;<span class="op" id="5058488">[</span><span class="op" id="5058489">]</span><span class="ident" id="5058490">ast</span><span class="op" id="5058493">.</span><span class="ident" id="5058494">Spec</span><span class="op" id="5058498">)</span>&nbsp;<span class="op" id="5058500">[</span><span class="op" id="5058501">]</span><span class="builtintype" id="5058502">bool</span>&nbsp;<span class="op" id="5058507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058510">m</span>&nbsp;<span class="op" id="5058512">:=</span>&nbsp;<span class="builtinfunc" id="5058515">make</span><span class="op" id="5058519">(</span><span class="op" id="5058520">[</span><span class="op" id="5058521">]</span><span class="builtintype" id="5058522">bool</span><span class="op" id="5058526">,</span>&nbsp;<span class="builtinfunc" id="5058528">len</span><span class="op" id="5058531">(</span><span class="ident" id="5058532">specs</span><span class="op" id="5058537">)</span><span class="op" id="5058538">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058542">populate</span>&nbsp;<span class="op" id="5058551">:=</span>&nbsp;<span class="keyword" id="5058554">func</span><span class="op" id="5058558">(</span><span class="ident" id="5058559">i</span><span class="op" id="5058560">,</span>&nbsp;<span class="ident" id="5058562">j</span>&nbsp;<span class="builtintype" id="5058564">int</span><span class="op" id="5058567">,</span>&nbsp;<span class="ident" id="5058569">keepType</span>&nbsp;<span class="builtintype" id="5058578">bool</span><span class="op" id="5058582">)</span>&nbsp;<span class="op" id="5058584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058588">if</span>&nbsp;<span class="ident" id="5058591">keepType</span>&nbsp;<span class="op" id="5058600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058605">for</span>&nbsp;<span class="op" id="5058609">;</span>&nbsp;<span class="ident" id="5058611">i</span>&nbsp;<span class="op" id="5058613">&lt;</span>&nbsp;<span class="ident" id="5058615">j</span><span class="op" id="5058616">;</span>&nbsp;<span class="ident" id="5058618">i</span><span class="op" id="5058619">++</span>&nbsp;<span class="op" id="5058622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058628">m</span><span class="op" id="5058629">[</span><span class="ident" id="5058630">i</span><span class="op" id="5058631">]</span>&nbsp;<span class="op" id="5058633">=</span>&nbsp;<span class="builtintype" id="5058635">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5058643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5058647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5058650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058654">i0</span>&nbsp;<span class="op" id="5058657">:=</span>&nbsp;<span class="op" id="5058660">-</span><span class="num" id="5058661">1</span>&nbsp;<span class="comment" id="5058663">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058725">var</span>&nbsp;<span class="ident" id="5058729">keepType</span>&nbsp;<span class="builtintype" id="5058738">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058744">for</span>&nbsp;<span class="ident" id="5058748">i</span><span class="op" id="5058749">,</span>&nbsp;<span class="ident" id="5058751">s</span>&nbsp;<span class="op" id="5058753">:=</span>&nbsp;<span class="keyword" id="5058756">range</span>&nbsp;<span class="ident" id="5058762">specs</span>&nbsp;<span class="op" id="5058768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058772">t</span>&nbsp;<span class="op" id="5058774">:=</span>&nbsp;<span class="ident" id="5058777">s</span><span class="op" id="5058778">.</span><span class="op" id="5058779">(</span><span class="op" id="5058780">*</span><span class="ident" id="5058781">ast</span><span class="op" id="5058784">.</span><span class="ident" id="5058785">ValueSpec</span><span class="op" id="5058794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058798">if</span>&nbsp;<span class="ident" id="5058801">t</span><span class="op" id="5058802">.</span><span class="ident" id="5058803">Values</span>&nbsp;<span class="op" id="5058810">!=</span>&nbsp;<span class="builtintype" id="5058813">nil</span>&nbsp;<span class="op" id="5058817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058822">if</span>&nbsp;<span class="ident" id="5058825">i0</span>&nbsp;<span class="op" id="5058828">&lt;</span>&nbsp;<span class="num" id="5058830">0</span>&nbsp;<span class="op" id="5058832">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5058838">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058894">i0</span>&nbsp;<span class="op" id="5058897">=</span>&nbsp;<span class="ident" id="5058899">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058905">keepType</span>&nbsp;<span class="op" id="5058914">=</span>&nbsp;<span class="builtintype" id="5058916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5058925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5058929">}</span>&nbsp;<span class="keyword" id="5058931">else</span>&nbsp;<span class="op" id="5058936">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5058941">if</span>&nbsp;<span class="ident" id="5058944">i0</span>&nbsp;<span class="op" id="5058947">&gt;=</span>&nbsp;<span class="num" id="5058950">0</span>&nbsp;<span class="op" id="5058952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5058958">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5058978">populate</span><span class="op" id="5058986">(</span><span class="ident" id="5058987">i0</span><span class="op" id="5058989">,</span>&nbsp;<span class="ident" id="5058991">i</span><span class="op" id="5058992">,</span>&nbsp;<span class="ident" id="5058994">keepType</span><span class="op" id="5059002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059008">i0</span>&nbsp;<span class="op" id="5059011">=</span>&nbsp;<span class="op" id="5059013">-</span><span class="num" id="5059014">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059019">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059027">if</span>&nbsp;<span class="ident" id="5059030">t</span><span class="op" id="5059031">.</span><span class="ident" id="5059032">Type</span>&nbsp;<span class="op" id="5059037">!=</span>&nbsp;<span class="builtintype" id="5059040">nil</span>&nbsp;<span class="op" id="5059044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059049">keepType</span>&nbsp;<span class="op" id="5059058">=</span>&nbsp;<span class="builtintype" id="5059060">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059070">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059073">if</span>&nbsp;<span class="ident" id="5059076">i0</span>&nbsp;<span class="op" id="5059079">&gt;=</span>&nbsp;<span class="num" id="5059082">0</span>&nbsp;<span class="op" id="5059084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5059088">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059106">populate</span><span class="op" id="5059114">(</span><span class="ident" id="5059115">i0</span><span class="op" id="5059117">,</span>&nbsp;<span class="builtinfunc" id="5059119">len</span><span class="op" id="5059122">(</span><span class="ident" id="5059123">specs</span><span class="op" id="5059128">)</span><span class="op" id="5059129">,</span>&nbsp;<span class="ident" id="5059131">keepType</span><span class="op" id="5059139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059146">return</span>&nbsp;<span class="ident" id="5059153">m</span><br>
<span class="lineno"></span><span class="op" id="5059155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059158">func</span>&nbsp;<span class="op" id="5059163">(</span><span class="ident" id="5059164">p</span>&nbsp;<span class="op" id="5059166">*</span><span class="ident" id="5059167">printer</span><span class="op" id="5059174">)</span>&nbsp;<span class="ident" id="5059176">valueSpec</span><span class="op" id="5059185">(</span><span class="ident" id="5059186">s</span>&nbsp;<span class="op" id="5059188">*</span><span class="ident" id="5059189">ast</span><span class="op" id="5059192">.</span><span class="ident" id="5059193">ValueSpec</span><span class="op" id="5059202">,</span>&nbsp;<span class="ident" id="5059204">keepType</span>&nbsp;<span class="builtintype" id="5059213">bool</span><span class="op" id="5059217">)</span>&nbsp;<span class="op" id="5059219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059222">p</span><span class="op" id="5059223">.</span><span class="ident" id="5059224">setComment</span><span class="op" id="5059234">(</span><span class="ident" id="5059235">s</span><span class="op" id="5059236">.</span><span class="ident" id="5059237">Doc</span><span class="op" id="5059240">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059243">p</span><span class="op" id="5059244">.</span><span class="ident" id="5059245">identList</span><span class="op" id="5059254">(</span><span class="ident" id="5059255">s</span><span class="op" id="5059256">.</span><span class="ident" id="5059257">Names</span><span class="op" id="5059262">,</span>&nbsp;<span class="builtintype" id="5059264">false</span><span class="op" id="5059269">)</span>&nbsp;<span class="comment" id="5059271">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059290">extraTabs</span>&nbsp;<span class="op" id="5059300">:=</span>&nbsp;<span class="num" id="5059303">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059306">if</span>&nbsp;<span class="ident" id="5059309">s</span><span class="op" id="5059310">.</span><span class="ident" id="5059311">Type</span>&nbsp;<span class="op" id="5059316">!=</span>&nbsp;<span class="builtintype" id="5059319">nil</span>&nbsp;<span class="op" id="5059323">||</span>&nbsp;<span class="ident" id="5059326">keepType</span>&nbsp;<span class="op" id="5059335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059339">p</span><span class="op" id="5059340">.</span><span class="builtinfunc" id="5059341">print</span><span class="op" id="5059346">(</span><span class="ident" id="5059347">vtab</span><span class="op" id="5059351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059355">extraTabs</span><span class="op" id="5059364">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059371">if</span>&nbsp;<span class="ident" id="5059374">s</span><span class="op" id="5059375">.</span><span class="ident" id="5059376">Type</span>&nbsp;<span class="op" id="5059381">!=</span>&nbsp;<span class="builtintype" id="5059384">nil</span>&nbsp;<span class="op" id="5059388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059392">p</span><span class="op" id="5059393">.</span><span class="ident" id="5059394">expr</span><span class="op" id="5059398">(</span><span class="ident" id="5059399">s</span><span class="op" id="5059400">.</span><span class="ident" id="5059401">Type</span><span class="op" id="5059405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059411">if</span>&nbsp;<span class="ident" id="5059414">s</span><span class="op" id="5059415">.</span><span class="ident" id="5059416">Values</span>&nbsp;<span class="op" id="5059423">!=</span>&nbsp;<span class="builtintype" id="5059426">nil</span>&nbsp;<span class="op" id="5059430">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059434">p</span><span class="op" id="5059435">.</span><span class="builtinfunc" id="5059436">print</span><span class="op" id="5059441">(</span><span class="ident" id="5059442">vtab</span><span class="op" id="5059446">,</span>&nbsp;<span class="ident" id="5059448">token</span><span class="op" id="5059453">.</span><span class="ident" id="5059454">ASSIGN</span><span class="op" id="5059460">,</span>&nbsp;<span class="ident" id="5059462">blank</span><span class="op" id="5059467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059471">p</span><span class="op" id="5059472">.</span><span class="ident" id="5059473">exprList</span><span class="op" id="5059481">(</span><span class="ident" id="5059482">token</span><span class="op" id="5059487">.</span><span class="ident" id="5059488">NoPos</span><span class="op" id="5059493">,</span>&nbsp;<span class="ident" id="5059495">s</span><span class="op" id="5059496">.</span><span class="ident" id="5059497">Values</span><span class="op" id="5059503">,</span>&nbsp;<span class="num" id="5059505">1</span><span class="op" id="5059506">,</span>&nbsp;<span class="num" id="5059508">0</span><span class="op" id="5059509">,</span>&nbsp;<span class="ident" id="5059511">token</span><span class="op" id="5059516">.</span><span class="ident" id="5059517">NoPos</span><span class="op" id="5059522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059526">extraTabs</span><span class="op" id="5059535">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059542">if</span>&nbsp;<span class="ident" id="5059545">s</span><span class="op" id="5059546">.</span><span class="ident" id="5059547">Comment</span>&nbsp;<span class="op" id="5059555">!=</span>&nbsp;<span class="builtintype" id="5059558">nil</span>&nbsp;<span class="op" id="5059562">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059566">for</span>&nbsp;<span class="op" id="5059570">;</span>&nbsp;<span class="ident" id="5059572">extraTabs</span>&nbsp;<span class="op" id="5059582">&gt;</span>&nbsp;<span class="num" id="5059584">0</span><span class="op" id="5059585">;</span>&nbsp;<span class="ident" id="5059587">extraTabs</span><span class="op" id="5059596">--</span>&nbsp;<span class="op" id="5059599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059604">p</span><span class="op" id="5059605">.</span><span class="builtinfunc" id="5059606">print</span><span class="op" id="5059611">(</span><span class="ident" id="5059612">vtab</span><span class="op" id="5059616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059624">p</span><span class="op" id="5059625">.</span><span class="ident" id="5059626">setComment</span><span class="op" id="5059636">(</span><span class="ident" id="5059637">s</span><span class="op" id="5059638">.</span><span class="ident" id="5059639">Comment</span><span class="op" id="5059646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5059649">}</span><br>
<span class="lineno">1335</span><span class="op" id="5059651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5059654">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5059730">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5059801">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5059830">//</span><br>
<span class="lineno"></span><span class="keyword" id="5059833">func</span>&nbsp;<span class="op" id="5059838">(</span><span class="ident" id="5059839">p</span>&nbsp;<span class="op" id="5059841">*</span><span class="ident" id="5059842">printer</span><span class="op" id="5059849">)</span>&nbsp;<span class="ident" id="5059851">spec</span><span class="op" id="5059855">(</span><span class="ident" id="5059856">spec</span>&nbsp;<span class="ident" id="5059861">ast</span><span class="op" id="5059864">.</span><span class="ident" id="5059865">Spec</span><span class="op" id="5059869">,</span>&nbsp;<span class="ident" id="5059871">n</span>&nbsp;<span class="builtintype" id="5059873">int</span><span class="op" id="5059876">,</span>&nbsp;<span class="ident" id="5059878">doIndent</span>&nbsp;<span class="builtintype" id="5059887">bool</span><span class="op" id="5059891">)</span>&nbsp;<span class="op" id="5059893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059896">switch</span>&nbsp;<span class="ident" id="5059903">s</span>&nbsp;<span class="op" id="5059905">:=</span>&nbsp;<span class="ident" id="5059908">spec</span><span class="op" id="5059912">.</span><span class="op" id="5059913">(</span><span class="keyword" id="5059914">type</span><span class="op" id="5059918">)</span>&nbsp;<span class="op" id="5059920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059923">case</span>&nbsp;<span class="op" id="5059928">*</span><span class="ident" id="5059929">ast</span><span class="op" id="5059932">.</span><span class="ident" id="5059933">ImportSpec</span><span class="op" id="5059943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059947">p</span><span class="op" id="5059948">.</span><span class="ident" id="5059949">setComment</span><span class="op" id="5059959">(</span><span class="ident" id="5059960">s</span><span class="op" id="5059961">.</span><span class="ident" id="5059962">Doc</span><span class="op" id="5059965">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5059969">if</span>&nbsp;<span class="ident" id="5059972">s</span><span class="op" id="5059973">.</span><span class="ident" id="5059974">Name</span>&nbsp;<span class="op" id="5059979">!=</span>&nbsp;<span class="builtintype" id="5059982">nil</span>&nbsp;<span class="op" id="5059986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5059991">p</span><span class="op" id="5059992">.</span><span class="ident" id="5059993">expr</span><span class="op" id="5059997">(</span><span class="ident" id="5059998">s</span><span class="op" id="5059999">.</span><span class="ident" id="5060000">Name</span><span class="op" id="5060004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060009">p</span><span class="op" id="5060010">.</span><span class="builtinfunc" id="5060011">print</span><span class="op" id="5060016">(</span><span class="ident" id="5060017">blank</span><span class="op" id="5060022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060030">p</span><span class="op" id="5060031">.</span><span class="ident" id="5060032">expr</span><span class="op" id="5060036">(</span><span class="ident" id="5060037">s</span><span class="op" id="5060038">.</span><span class="ident" id="5060039">Path</span><span class="op" id="5060043">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060047">p</span><span class="op" id="5060048">.</span><span class="ident" id="5060049">setComment</span><span class="op" id="5060059">(</span><span class="ident" id="5060060">s</span><span class="op" id="5060061">.</span><span class="ident" id="5060062">Comment</span><span class="op" id="5060069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060073">p</span><span class="op" id="5060074">.</span><span class="builtinfunc" id="5060075">print</span><span class="op" id="5060080">(</span><span class="ident" id="5060081">s</span><span class="op" id="5060082">.</span><span class="ident" id="5060083">EndPos</span><span class="op" id="5060089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060093">case</span>&nbsp;<span class="op" id="5060098">*</span><span class="ident" id="5060099">ast</span><span class="op" id="5060102">.</span><span class="ident" id="5060103">ValueSpec</span><span class="op" id="5060112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060116">if</span>&nbsp;<span class="ident" id="5060119">n</span>&nbsp;<span class="op" id="5060121">!=</span>&nbsp;<span class="num" id="5060124">1</span>&nbsp;<span class="op" id="5060126">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060131">p</span><span class="op" id="5060132">.</span><span class="ident" id="5060133">internalError</span><span class="op" id="5060146">(</span><span class="string" id="5060147">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5060168">,</span>&nbsp;<span class="ident" id="5060170">n</span><span class="op" id="5060171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060179">p</span><span class="op" id="5060180">.</span><span class="ident" id="5060181">setComment</span><span class="op" id="5060191">(</span><span class="ident" id="5060192">s</span><span class="op" id="5060193">.</span><span class="ident" id="5060194">Doc</span><span class="op" id="5060197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060201">p</span><span class="op" id="5060202">.</span><span class="ident" id="5060203">identList</span><span class="op" id="5060212">(</span><span class="ident" id="5060213">s</span><span class="op" id="5060214">.</span><span class="ident" id="5060215">Names</span><span class="op" id="5060220">,</span>&nbsp;<span class="ident" id="5060222">doIndent</span><span class="op" id="5060230">)</span>&nbsp;<span class="comment" id="5060232">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060252">if</span>&nbsp;<span class="ident" id="5060255">s</span><span class="op" id="5060256">.</span><span class="ident" id="5060257">Type</span>&nbsp;<span class="op" id="5060262">!=</span>&nbsp;<span class="builtintype" id="5060265">nil</span>&nbsp;<span class="op" id="5060269">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060274">p</span><span class="op" id="5060275">.</span><span class="builtinfunc" id="5060276">print</span><span class="op" id="5060281">(</span><span class="ident" id="5060282">blank</span><span class="op" id="5060287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060292">p</span><span class="op" id="5060293">.</span><span class="ident" id="5060294">expr</span><span class="op" id="5060298">(</span><span class="ident" id="5060299">s</span><span class="op" id="5060300">.</span><span class="ident" id="5060301">Type</span><span class="op" id="5060305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060313">if</span>&nbsp;<span class="ident" id="5060316">s</span><span class="op" id="5060317">.</span><span class="ident" id="5060318">Values</span>&nbsp;<span class="op" id="5060325">!=</span>&nbsp;<span class="builtintype" id="5060328">nil</span>&nbsp;<span class="op" id="5060332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060337">p</span><span class="op" id="5060338">.</span><span class="builtinfunc" id="5060339">print</span><span class="op" id="5060344">(</span><span class="ident" id="5060345">blank</span><span class="op" id="5060350">,</span>&nbsp;<span class="ident" id="5060352">token</span><span class="op" id="5060357">.</span><span class="ident" id="5060358">ASSIGN</span><span class="op" id="5060364">,</span>&nbsp;<span class="ident" id="5060366">blank</span><span class="op" id="5060371">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060376">p</span><span class="op" id="5060377">.</span><span class="ident" id="5060378">exprList</span><span class="op" id="5060386">(</span><span class="ident" id="5060387">token</span><span class="op" id="5060392">.</span><span class="ident" id="5060393">NoPos</span><span class="op" id="5060398">,</span>&nbsp;<span class="ident" id="5060400">s</span><span class="op" id="5060401">.</span><span class="ident" id="5060402">Values</span><span class="op" id="5060408">,</span>&nbsp;<span class="num" id="5060410">1</span><span class="op" id="5060411">,</span>&nbsp;<span class="num" id="5060413">0</span><span class="op" id="5060414">,</span>&nbsp;<span class="ident" id="5060416">token</span><span class="op" id="5060421">.</span><span class="ident" id="5060422">NoPos</span><span class="op" id="5060427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060435">p</span><span class="op" id="5060436">.</span><span class="ident" id="5060437">setComment</span><span class="op" id="5060447">(</span><span class="ident" id="5060448">s</span><span class="op" id="5060449">.</span><span class="ident" id="5060450">Comment</span><span class="op" id="5060457">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060461">case</span>&nbsp;<span class="op" id="5060466">*</span><span class="ident" id="5060467">ast</span><span class="op" id="5060470">.</span><span class="ident" id="5060471">TypeSpec</span><span class="op" id="5060479">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060483">p</span><span class="op" id="5060484">.</span><span class="ident" id="5060485">setComment</span><span class="op" id="5060495">(</span><span class="ident" id="5060496">s</span><span class="op" id="5060497">.</span><span class="ident" id="5060498">Doc</span><span class="op" id="5060501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060505">p</span><span class="op" id="5060506">.</span><span class="ident" id="5060507">expr</span><span class="op" id="5060511">(</span><span class="ident" id="5060512">s</span><span class="op" id="5060513">.</span><span class="ident" id="5060514">Name</span><span class="op" id="5060518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060522">if</span>&nbsp;<span class="ident" id="5060525">n</span>&nbsp;<span class="op" id="5060527">==</span>&nbsp;<span class="num" id="5060530">1</span>&nbsp;<span class="op" id="5060532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060537">p</span><span class="op" id="5060538">.</span><span class="builtinfunc" id="5060539">print</span><span class="op" id="5060544">(</span><span class="ident" id="5060545">blank</span><span class="op" id="5060550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060554">}</span>&nbsp;<span class="keyword" id="5060556">else</span>&nbsp;<span class="op" id="5060561">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060566">p</span><span class="op" id="5060567">.</span><span class="builtinfunc" id="5060568">print</span><span class="op" id="5060573">(</span><span class="ident" id="5060574">vtab</span><span class="op" id="5060578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060586">p</span><span class="op" id="5060587">.</span><span class="ident" id="5060588">expr</span><span class="op" id="5060592">(</span><span class="ident" id="5060593">s</span><span class="op" id="5060594">.</span><span class="ident" id="5060595">Type</span><span class="op" id="5060599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060603">p</span><span class="op" id="5060604">.</span><span class="ident" id="5060605">setComment</span><span class="op" id="5060615">(</span><span class="ident" id="5060616">s</span><span class="op" id="5060617">.</span><span class="ident" id="5060618">Comment</span><span class="op" id="5060625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060629">default</span><span class="op" id="5060636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5060640">panic</span><span class="op" id="5060645">(</span><span class="string" id="5060646">&#34;unreachable&#34;</span><span class="op" id="5060659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5060662">}</span><br>
<span class="lineno"></span><span class="op" id="5060664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5060667">func</span>&nbsp;<span class="op" id="5060672">(</span><span class="ident" id="5060673">p</span>&nbsp;<span class="op" id="5060675">*</span><span class="ident" id="5060676">printer</span><span class="op" id="5060683">)</span>&nbsp;<span class="ident" id="5060685">genDecl</span><span class="op" id="5060692">(</span><span class="ident" id="5060693">d</span>&nbsp;<span class="op" id="5060695">*</span><span class="ident" id="5060696">ast</span><span class="op" id="5060699">.</span><span class="ident" id="5060700">GenDecl</span><span class="op" id="5060707">)</span>&nbsp;<span class="op" id="5060709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060712">p</span><span class="op" id="5060713">.</span><span class="ident" id="5060714">setComment</span><span class="op" id="5060724">(</span><span class="ident" id="5060725">d</span><span class="op" id="5060726">.</span><span class="ident" id="5060727">Doc</span><span class="op" id="5060730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060733">p</span><span class="op" id="5060734">.</span><span class="builtinfunc" id="5060735">print</span><span class="op" id="5060740">(</span><span class="ident" id="5060741">d</span><span class="op" id="5060742">.</span><span class="ident" id="5060743">Pos</span><span class="op" id="5060746">(</span><span class="op" id="5060747">)</span><span class="op" id="5060748">,</span>&nbsp;<span class="ident" id="5060750">d</span><span class="op" id="5060751">.</span><span class="ident" id="5060752">Tok</span><span class="op" id="5060755">,</span>&nbsp;<span class="ident" id="5060757">blank</span><span class="op" id="5060762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060766">if</span>&nbsp;<span class="ident" id="5060769">d</span><span class="op" id="5060770">.</span><span class="ident" id="5060771">Lparen</span><span class="op" id="5060777">.</span><span class="ident" id="5060778">IsValid</span><span class="op" id="5060785">(</span><span class="op" id="5060786">)</span>&nbsp;<span class="op" id="5060788">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5060792">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060833">p</span><span class="op" id="5060834">.</span><span class="builtinfunc" id="5060835">print</span><span class="op" id="5060840">(</span><span class="ident" id="5060841">d</span><span class="op" id="5060842">.</span><span class="ident" id="5060843">Lparen</span><span class="op" id="5060849">,</span>&nbsp;<span class="ident" id="5060851">token</span><span class="op" id="5060856">.</span><span class="ident" id="5060857">LPAREN</span><span class="op" id="5060863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060867">if</span>&nbsp;<span class="ident" id="5060870">n</span>&nbsp;<span class="op" id="5060872">:=</span>&nbsp;<span class="builtinfunc" id="5060875">len</span><span class="op" id="5060878">(</span><span class="ident" id="5060879">d</span><span class="op" id="5060880">.</span><span class="ident" id="5060881">Specs</span><span class="op" id="5060886">)</span><span class="op" id="5060887">;</span>&nbsp;<span class="ident" id="5060889">n</span>&nbsp;<span class="op" id="5060891">&gt;</span>&nbsp;<span class="num" id="5060893">0</span>&nbsp;<span class="op" id="5060895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5060900">p</span><span class="op" id="5060901">.</span><span class="builtinfunc" id="5060902">print</span><span class="op" id="5060907">(</span><span class="ident" id="5060908">indent</span><span class="op" id="5060914">,</span>&nbsp;<span class="ident" id="5060916">formfeed</span><span class="op" id="5060924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5060929">if</span>&nbsp;<span class="ident" id="5060932">n</span>&nbsp;<span class="op" id="5060934">&gt;</span>&nbsp;<span class="num" id="5060936">1</span>&nbsp;<span class="op" id="5060938">&amp;&amp;</span>&nbsp;<span class="op" id="5060941">(</span><span class="ident" id="5060942">d</span><span class="op" id="5060943">.</span><span class="ident" id="5060944">Tok</span>&nbsp;<span class="op" id="5060948">==</span>&nbsp;<span class="ident" id="5060951">token</span><span class="op" id="5060956">.</span><span class="ident" id="5060957">CONST</span>&nbsp;<span class="op" id="5060963">||</span>&nbsp;<span class="ident" id="5060966">d</span><span class="op" id="5060967">.</span><span class="ident" id="5060968">Tok</span>&nbsp;<span class="op" id="5060972">==</span>&nbsp;<span class="ident" id="5060975">token</span><span class="op" id="5060980">.</span><span class="ident" id="5060981">VAR</span><span class="op" id="5060984">)</span>&nbsp;<span class="op" id="5060986">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5060992">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5061043">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061092">keepType</span>&nbsp;<span class="op" id="5061101">:=</span>&nbsp;<span class="ident" id="5061104">keepTypeColumn</span><span class="op" id="5061118">(</span><span class="ident" id="5061119">d</span><span class="op" id="5061120">.</span><span class="ident" id="5061121">Specs</span><span class="op" id="5061126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061132">var</span>&nbsp;<span class="ident" id="5061136">line</span>&nbsp;<span class="builtintype" id="5061141">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061149">for</span>&nbsp;<span class="ident" id="5061153">i</span><span class="op" id="5061154">,</span>&nbsp;<span class="ident" id="5061156">s</span>&nbsp;<span class="op" id="5061158">:=</span>&nbsp;<span class="keyword" id="5061161">range</span>&nbsp;<span class="ident" id="5061167">d</span><span class="op" id="5061168">.</span><span class="ident" id="5061169">Specs</span>&nbsp;<span class="op" id="5061175">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061182">if</span>&nbsp;<span class="ident" id="5061185">i</span>&nbsp;<span class="op" id="5061187">&gt;</span>&nbsp;<span class="num" id="5061189">0</span>&nbsp;<span class="op" id="5061191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061199">p</span><span class="op" id="5061200">.</span><span class="ident" id="5061201">linebreak</span><span class="op" id="5061210">(</span><span class="ident" id="5061211">p</span><span class="op" id="5061212">.</span><span class="ident" id="5061213">lineFor</span><span class="op" id="5061220">(</span><span class="ident" id="5061221">s</span><span class="op" id="5061222">.</span><span class="ident" id="5061223">Pos</span><span class="op" id="5061226">(</span><span class="op" id="5061227">)</span><span class="op" id="5061228">)</span><span class="op" id="5061229">,</span>&nbsp;<span class="num" id="5061231">1</span><span class="op" id="5061232">,</span>&nbsp;<span class="ident" id="5061234">ignore</span><span class="op" id="5061240">,</span>&nbsp;<span class="ident" id="5061242">p</span><span class="op" id="5061243">.</span><span class="ident" id="5061244">linesFrom</span><span class="op" id="5061253">(</span><span class="ident" id="5061254">line</span><span class="op" id="5061258">)</span>&nbsp;<span class="op" id="5061260">&gt;</span>&nbsp;<span class="num" id="5061262">0</span><span class="op" id="5061263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061277">p</span><span class="op" id="5061278">.</span><span class="ident" id="5061279">recordLine</span><span class="op" id="5061289">(</span><span class="op" id="5061290">&amp;</span><span class="ident" id="5061291">line</span><span class="op" id="5061295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061302">p</span><span class="op" id="5061303">.</span><span class="ident" id="5061304">valueSpec</span><span class="op" id="5061313">(</span><span class="ident" id="5061314">s</span><span class="op" id="5061315">.</span><span class="op" id="5061316">(</span><span class="op" id="5061317">*</span><span class="ident" id="5061318">ast</span><span class="op" id="5061321">.</span><span class="ident" id="5061322">ValueSpec</span><span class="op" id="5061331">)</span><span class="op" id="5061332">,</span>&nbsp;<span class="ident" id="5061334">keepType</span><span class="op" id="5061342">[</span><span class="ident" id="5061343">i</span><span class="op" id="5061344">]</span><span class="op" id="5061345">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061356">}</span>&nbsp;<span class="keyword" id="5061358">else</span>&nbsp;<span class="op" id="5061363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061369">var</span>&nbsp;<span class="ident" id="5061373">line</span>&nbsp;<span class="builtintype" id="5061378">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061386">for</span>&nbsp;<span class="ident" id="5061390">i</span><span class="op" id="5061391">,</span>&nbsp;<span class="ident" id="5061393">s</span>&nbsp;<span class="op" id="5061395">:=</span>&nbsp;<span class="keyword" id="5061398">range</span>&nbsp;<span class="ident" id="5061404">d</span><span class="op" id="5061405">.</span><span class="ident" id="5061406">Specs</span>&nbsp;<span class="op" id="5061412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5061419">if</span>&nbsp;<span class="ident" id="5061422">i</span>&nbsp;<span class="op" id="5061424">&gt;</span>&nbsp;<span class="num" id="5061426">0</span>&nbsp;<span class="op" id="5061428">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061436">p</span><span class="op" id="5061437">.</span><span class="ident" id="5061438">linebreak</span><span class="op" id="5061447">(</span><span class="ident" id="5061448">p</span><span class="op" id="5061449">.</span><span class="ident" id="5061450">lineFor</span><span class="op" id="5061457">(</span><span class="ident" id="5061458">s</span><span class="op" id="5061459">.</span><span class="ident" id="5061460">Pos</span><span class="op" id="5061463">(</span><span class="op" id="5061464">)</span><span class="op" id="5061465">)</span><span class="op" id="5061466">,</span>&nbsp;<span class="num" id="5061468">1</span><span class="op" id="5061469">,</span>&nbsp;<span class="ident" id="5061471">ignore</span><span class="op" id="5061477">,</span>&nbsp;<span class="ident" id="5061479">p</span><span class="op" id="5061480">.</span><span class="ident" id="5061481">linesFrom</span><span class="op" id="5061490">(</span><span class="ident" id="5061491">line</span><span class="op" id="5061495">)</span>&nbsp;<span class="op" id="5061497">&gt;</span>&nbsp;<span class="num" id="5061499">0</span><span class="op" id="5061500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061514">p</span><span class="op" id="5061515">.</span><span class="ident" id="5061516">recordLine</span><span class="op" id="5061526">(</span><span class="op" id="5061527">&amp;</span><span class="ident" id="5061528">line</span><span class="op" id="5061532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061539">p</span><span class="op" id="5061540">.</span><span class="ident" id="5061541">spec</span><span class="op" id="5061545">(</span><span class="ident" id="5061546">s</span><span class="op" id="5061547">,</span>&nbsp;<span class="ident" id="5061549">n</span><span class="op" id="5061550">,</span>&nbsp;<span class="builtintype" id="5061552">false</span><span class="op" id="5061557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061563">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061573">p</span><span class="op" id="5061574">.</span><span class="builtinfunc" id="5061575">print</span><span class="op" id="5061580">(</span><span class="ident" id="5061581">unindent</span><span class="op" id="5061589">,</span>&nbsp;<span class="ident" id="5061591">formfeed</span><span class="op" id="5061599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061607">p</span><span class="op" id="5061608">.</span><span class="builtinfunc" id="5061609">print</span><span class="op" id="5061614">(</span><span class="ident" id="5061615">d</span><span class="op" id="5061616">.</span><span class="ident" id="5061617">Rparen</span><span class="op" id="5061623">,</span>&nbsp;<span class="ident" id="5061625">token</span><span class="op" id="5061630">.</span><span class="ident" id="5061631">RPAREN</span><span class="op" id="5061637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061641">}</span>&nbsp;<span class="keyword" id="5061643">else</span>&nbsp;<span class="op" id="5061648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5061652">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5061676">p</span><span class="op" id="5061677">.</span><span class="ident" id="5061678">spec</span><span class="op" id="5061682">(</span><span class="ident" id="5061683">d</span><span class="op" id="5061684">.</span><span class="ident" id="5061685">Specs</span><span class="op" id="5061690">[</span><span class="num" id="5061691">0</span><span class="op" id="5061692">]</span><span class="op" id="5061693">,</span>&nbsp;<span class="num" id="5061695">1</span><span class="op" id="5061696">,</span>&nbsp;<span class="builtintype" id="5061698">true</span><span class="op" id="5061702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5061705">}</span><br>
<span class="lineno"></span><span class="op" id="5061707">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5061710">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5061774">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5061839">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5061902">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5061960">//</span><br>
<span class="lineno"></span><span class="keyword" id="5061963">func</span>&nbsp;<span class="op" id="5061968">(</span><span class="ident" id="5061969">p</span>&nbsp;<span class="op" id="5061971">*</span><span class="ident" id="5061972">printer</span><span class="op" id="5061979">)</span>&nbsp;<span class="ident" id="5061981">nodeSize</span><span class="op" id="5061989">(</span><span class="ident" id="5061990">n</span>&nbsp;<span class="ident" id="5061992">ast</span><span class="op" id="5061995">.</span><span class="ident" id="5061996">Node</span><span class="op" id="5062000">,</span>&nbsp;<span class="ident" id="5062002">maxSize</span>&nbsp;<span class="builtintype" id="5062010">int</span><span class="op" id="5062013">)</span>&nbsp;<span class="op" id="5062015">(</span><span class="ident" id="5062016">size</span>&nbsp;<span class="builtintype" id="5062021">int</span><span class="op" id="5062024">)</span>&nbsp;<span class="op" id="5062026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062029">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062089">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062149">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062205">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062258">if</span>&nbsp;<span class="ident" id="5062261">size</span><span class="op" id="5062265">,</span>&nbsp;<span class="ident" id="5062267">found</span>&nbsp;<span class="op" id="5062273">:=</span>&nbsp;<span class="ident" id="5062276">p</span><span class="op" id="5062277">.</span><span class="ident" id="5062278">nodeSizes</span><span class="op" id="5062287">[</span><span class="ident" id="5062288">n</span><span class="op" id="5062289">]</span><span class="op" id="5062290">;</span>&nbsp;<span class="ident" id="5062292">found</span>&nbsp;<span class="op" id="5062298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062302">return</span>&nbsp;<span class="ident" id="5062309">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5062315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062319">size</span>&nbsp;<span class="op" id="5062324">=</span>&nbsp;<span class="ident" id="5062326">maxSize</span>&nbsp;<span class="op" id="5062334">+</span>&nbsp;<span class="num" id="5062336">1</span>&nbsp;<span class="comment" id="5062338">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062363">p</span><span class="op" id="5062364">.</span><span class="ident" id="5062365">nodeSizes</span><span class="op" id="5062374">[</span><span class="ident" id="5062375">n</span><span class="op" id="5062376">]</span>&nbsp;<span class="op" id="5062378">=</span>&nbsp;<span class="ident" id="5062380">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062387">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062446">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5062503">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062520">cfg</span>&nbsp;<span class="op" id="5062524">:=</span>&nbsp;<span class="ident" id="5062527">Config</span><span class="op" id="5062533">{</span><span class="ident" id="5062534">Mode</span><span class="op" id="5062538">:</span>&nbsp;<span class="ident" id="5062540">RawFormat</span><span class="op" id="5062549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062552">var</span>&nbsp;<span class="ident" id="5062556">buf</span>&nbsp;<span class="ident" id="5062560">bytes</span><span class="op" id="5062565">.</span><span class="ident" id="5062566">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062574">if</span>&nbsp;<span class="ident" id="5062577">err</span>&nbsp;<span class="op" id="5062581">:=</span>&nbsp;<span class="ident" id="5062584">cfg</span><span class="op" id="5062587">.</span><span class="ident" id="5062588">fprint</span><span class="op" id="5062594">(</span><span class="op" id="5062595">&amp;</span><span class="ident" id="5062596">buf</span><span class="op" id="5062599">,</span>&nbsp;<span class="ident" id="5062601">p</span><span class="op" id="5062602">.</span><span class="ident" id="5062603">fset</span><span class="op" id="5062607">,</span>&nbsp;<span class="ident" id="5062609">n</span><span class="op" id="5062610">,</span>&nbsp;<span class="ident" id="5062612">p</span><span class="op" id="5062613">.</span><span class="ident" id="5062614">nodeSizes</span><span class="op" id="5062623">)</span><span class="op" id="5062624">;</span>&nbsp;<span class="ident" id="5062626">err</span>&nbsp;<span class="op" id="5062630">!=</span>&nbsp;<span class="builtintype" id="5062633">nil</span>&nbsp;<span class="op" id="5062637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062641">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5062649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062652">if</span>&nbsp;<span class="ident" id="5062655">buf</span><span class="op" id="5062658">.</span><span class="ident" id="5062659">Len</span><span class="op" id="5062662">(</span><span class="op" id="5062663">)</span>&nbsp;<span class="op" id="5062665">&lt;=</span>&nbsp;<span class="ident" id="5062668">maxSize</span>&nbsp;<span class="op" id="5062676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062680">for</span>&nbsp;<span class="ident" id="5062684">_</span><span class="op" id="5062685">,</span>&nbsp;<span class="ident" id="5062687">ch</span>&nbsp;<span class="op" id="5062690">:=</span>&nbsp;<span class="keyword" id="5062693">range</span>&nbsp;<span class="ident" id="5062699">buf</span><span class="op" id="5062702">.</span><span class="ident" id="5062703">Bytes</span><span class="op" id="5062708">(</span><span class="op" id="5062709">)</span>&nbsp;<span class="op" id="5062711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062716">if</span>&nbsp;<span class="ident" id="5062719">ch</span>&nbsp;<span class="op" id="5062722">&lt;</span>&nbsp;<span class="string" id="5062724">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5062728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062734">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5062744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5062748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062752">size</span>&nbsp;<span class="op" id="5062757">=</span>&nbsp;<span class="ident" id="5062759">buf</span><span class="op" id="5062762">.</span><span class="ident" id="5062763">Len</span><span class="op" id="5062766">(</span><span class="op" id="5062767">)</span>&nbsp;<span class="comment" id="5062769">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062781">p</span><span class="op" id="5062782">.</span><span class="ident" id="5062783">nodeSizes</span><span class="op" id="5062792">[</span><span class="ident" id="5062793">n</span><span class="op" id="5062794">]</span>&nbsp;<span class="op" id="5062796">=</span>&nbsp;<span class="ident" id="5062798">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5062804">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062807">return</span><br>
<span class="lineno"></span><span class="op" id="5062814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5062817">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5062890">func</span>&nbsp;<span class="op" id="5062895">(</span><span class="ident" id="5062896">p</span>&nbsp;<span class="op" id="5062898">*</span><span class="ident" id="5062899">printer</span><span class="op" id="5062906">)</span>&nbsp;<span class="ident" id="5062908">bodySize</span><span class="op" id="5062916">(</span><span class="ident" id="5062917">b</span>&nbsp;<span class="op" id="5062919">*</span><span class="ident" id="5062920">ast</span><span class="op" id="5062923">.</span><span class="ident" id="5062924">BlockStmt</span><span class="op" id="5062933">,</span>&nbsp;<span class="ident" id="5062935">maxSize</span>&nbsp;<span class="builtintype" id="5062943">int</span><span class="op" id="5062946">)</span>&nbsp;<span class="builtintype" id="5062948">int</span>&nbsp;<span class="op" id="5062952">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062955">pos1</span>&nbsp;<span class="op" id="5062960">:=</span>&nbsp;<span class="ident" id="5062963">b</span><span class="op" id="5062964">.</span><span class="ident" id="5062965">Pos</span><span class="op" id="5062968">(</span><span class="op" id="5062969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5062972">pos2</span>&nbsp;<span class="op" id="5062977">:=</span>&nbsp;<span class="ident" id="5062980">b</span><span class="op" id="5062981">.</span><span class="ident" id="5062982">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5062990">if</span>&nbsp;<span class="ident" id="5062993">pos1</span><span class="op" id="5062997">.</span><span class="ident" id="5062998">IsValid</span><span class="op" id="5063005">(</span><span class="op" id="5063006">)</span>&nbsp;<span class="op" id="5063008">&amp;&amp;</span>&nbsp;<span class="ident" id="5063011">pos2</span><span class="op" id="5063015">.</span><span class="ident" id="5063016">IsValid</span><span class="op" id="5063023">(</span><span class="op" id="5063024">)</span>&nbsp;<span class="op" id="5063026">&amp;&amp;</span>&nbsp;<span class="ident" id="5063029">p</span><span class="op" id="5063030">.</span><span class="ident" id="5063031">lineFor</span><span class="op" id="5063038">(</span><span class="ident" id="5063039">pos1</span><span class="op" id="5063043">)</span>&nbsp;<span class="op" id="5063045">!=</span>&nbsp;<span class="ident" id="5063048">p</span><span class="op" id="5063049">.</span><span class="ident" id="5063050">lineFor</span><span class="op" id="5063057">(</span><span class="ident" id="5063058">pos2</span><span class="op" id="5063062">)</span>&nbsp;<span class="op" id="5063064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5063068">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063150">return</span>&nbsp;<span class="ident" id="5063157">maxSize</span>&nbsp;<span class="op" id="5063165">+</span>&nbsp;<span class="num" id="5063167">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5063170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063173">if</span>&nbsp;<span class="builtinfunc" id="5063176">len</span><span class="op" id="5063179">(</span><span class="ident" id="5063180">b</span><span class="op" id="5063181">.</span><span class="ident" id="5063182">List</span><span class="op" id="5063186">)</span>&nbsp;<span class="op" id="5063188">&gt;</span>&nbsp;<span class="num" id="5063190">5</span>&nbsp;<span class="op" id="5063192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5063196">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063249">return</span>&nbsp;<span class="ident" id="5063256">maxSize</span>&nbsp;<span class="op" id="5063264">+</span>&nbsp;<span class="num" id="5063266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5063269">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5063272">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5063306">bodySize</span>&nbsp;<span class="op" id="5063315">:=</span>&nbsp;<span class="ident" id="5063318">p</span><span class="op" id="5063319">.</span><span class="ident" id="5063320">commentSizeBefore</span><span class="op" id="5063337">(</span><span class="ident" id="5063338">p</span><span class="op" id="5063339">.</span><span class="ident" id="5063340">posFor</span><span class="op" id="5063346">(</span><span class="ident" id="5063347">pos2</span><span class="op" id="5063351">)</span><span class="op" id="5063352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063355">for</span>&nbsp;<span class="ident" id="5063359">i</span><span class="op" id="5063360">,</span>&nbsp;<span class="ident" id="5063362">s</span>&nbsp;<span class="op" id="5063364">:=</span>&nbsp;<span class="keyword" id="5063367">range</span>&nbsp;<span class="ident" id="5063373">b</span><span class="op" id="5063374">.</span><span class="ident" id="5063375">List</span>&nbsp;<span class="op" id="5063380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063384">if</span>&nbsp;<span class="ident" id="5063387">bodySize</span>&nbsp;<span class="op" id="5063396">&gt;</span>&nbsp;<span class="ident" id="5063398">maxSize</span>&nbsp;<span class="op" id="5063406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063411">break</span>&nbsp;<span class="comment" id="5063417">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5063442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063446">if</span>&nbsp;<span class="ident" id="5063449">i</span>&nbsp;<span class="op" id="5063451">&gt;</span>&nbsp;<span class="num" id="5063453">0</span>&nbsp;<span class="op" id="5063455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5063460">bodySize</span>&nbsp;<span class="op" id="5063469">+=</span>&nbsp;<span class="num" id="5063472">2</span>&nbsp;<span class="comment" id="5063474">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5063511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5063515">bodySize</span>&nbsp;<span class="op" id="5063524">+=</span>&nbsp;<span class="ident" id="5063527">p</span><span class="op" id="5063528">.</span><span class="ident" id="5063529">nodeSize</span><span class="op" id="5063537">(</span><span class="ident" id="5063538">s</span><span class="op" id="5063539">,</span>&nbsp;<span class="ident" id="5063541">maxSize</span><span class="op" id="5063548">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5063551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5063554">return</span>&nbsp;<span class="ident" id="5063561">bodySize</span><br>
<span class="lineno"></span><span class="op" id="5063570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5063573">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="5063658">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="5063747">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5063836">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5063925">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5064014">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="5064071">//</span><br>
<span class="lineno"></span><span class="keyword" id="5064074">func</span>&nbsp;<span class="op" id="5064079">(</span><span class="ident" id="5064080">p</span>&nbsp;<span class="op" id="5064082">*</span><span class="ident" id="5064083">printer</span><span class="op" id="5064090">)</span>&nbsp;<span class="ident" id="5064092">adjBlock</span><span class="op" id="5064100">(</span><span class="ident" id="5064101">headerSize</span>&nbsp;<span class="builtintype" id="5064112">int</span><span class="op" id="5064115">,</span>&nbsp;<span class="ident" id="5064117">sep</span>&nbsp;<span class="ident" id="5064121">whiteSpace</span><span class="op" id="5064131">,</span>&nbsp;<span class="ident" id="5064133">b</span>&nbsp;<span class="op" id="5064135">*</span><span class="ident" id="5064136">ast</span><span class="op" id="5064139">.</span><span class="ident" id="5064140">BlockStmt</span><span class="op" id="5064149">)</span>&nbsp;<span class="op" id="5064151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064154">if</span>&nbsp;<span class="ident" id="5064157">b</span>&nbsp;<span class="op" id="5064159">==</span>&nbsp;<span class="builtintype" id="5064162">nil</span>&nbsp;<span class="op" id="5064166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064178">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064182">const</span>&nbsp;<span class="ident" id="5064188">maxSize</span>&nbsp;<span class="op" id="5064196">=</span>&nbsp;<span class="num" id="5064198">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064203">if</span>&nbsp;<span class="ident" id="5064206">headerSize</span><span class="op" id="5064216">+</span><span class="ident" id="5064217">p</span><span class="op" id="5064218">.</span><span class="ident" id="5064219">bodySize</span><span class="op" id="5064227">(</span><span class="ident" id="5064228">b</span><span class="op" id="5064229">,</span>&nbsp;<span class="ident" id="5064231">maxSize</span><span class="op" id="5064238">)</span>&nbsp;<span class="op" id="5064240">&lt;=</span>&nbsp;<span class="ident" id="5064243">maxSize</span>&nbsp;<span class="op" id="5064251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064255">p</span><span class="op" id="5064256">.</span><span class="builtinfunc" id="5064257">print</span><span class="op" id="5064262">(</span><span class="ident" id="5064263">sep</span><span class="op" id="5064266">,</span>&nbsp;<span class="ident" id="5064268">b</span><span class="op" id="5064269">.</span><span class="ident" id="5064270">Lbrace</span><span class="op" id="5064276">,</span>&nbsp;<span class="ident" id="5064278">token</span><span class="op" id="5064283">.</span><span class="ident" id="5064284">LBRACE</span><span class="op" id="5064290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064294">if</span>&nbsp;<span class="builtinfunc" id="5064297">len</span><span class="op" id="5064300">(</span><span class="ident" id="5064301">b</span><span class="op" id="5064302">.</span><span class="ident" id="5064303">List</span><span class="op" id="5064307">)</span>&nbsp;<span class="op" id="5064309">&gt;</span>&nbsp;<span class="num" id="5064311">0</span>&nbsp;<span class="op" id="5064313">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064318">p</span><span class="op" id="5064319">.</span><span class="builtinfunc" id="5064320">print</span><span class="op" id="5064325">(</span><span class="ident" id="5064326">blank</span><span class="op" id="5064331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064336">for</span>&nbsp;<span class="ident" id="5064340">i</span><span class="op" id="5064341">,</span>&nbsp;<span class="ident" id="5064343">s</span>&nbsp;<span class="op" id="5064345">:=</span>&nbsp;<span class="keyword" id="5064348">range</span>&nbsp;<span class="ident" id="5064354">b</span><span class="op" id="5064355">.</span><span class="ident" id="5064356">List</span>&nbsp;<span class="op" id="5064361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064367">if</span>&nbsp;<span class="ident" id="5064370">i</span>&nbsp;<span class="op" id="5064372">&gt;</span>&nbsp;<span class="num" id="5064374">0</span>&nbsp;<span class="op" id="5064376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064383">p</span><span class="op" id="5064384">.</span><span class="builtinfunc" id="5064385">print</span><span class="op" id="5064390">(</span><span class="ident" id="5064391">token</span><span class="op" id="5064396">.</span><span class="ident" id="5064397">SEMICOLON</span><span class="op" id="5064406">,</span>&nbsp;<span class="ident" id="5064408">blank</span><span class="op" id="5064413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064419">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064425">p</span><span class="op" id="5064426">.</span><span class="ident" id="5064427">stmt</span><span class="op" id="5064431">(</span><span class="ident" id="5064432">s</span><span class="op" id="5064433">,</span>&nbsp;<span class="ident" id="5064435">i</span>&nbsp;<span class="op" id="5064437">==</span>&nbsp;<span class="builtinfunc" id="5064440">len</span><span class="op" id="5064443">(</span><span class="ident" id="5064444">b</span><span class="op" id="5064445">.</span><span class="ident" id="5064446">List</span><span class="op" id="5064450">)</span><span class="op" id="5064451">-</span><span class="num" id="5064452">1</span><span class="op" id="5064453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064463">p</span><span class="op" id="5064464">.</span><span class="builtinfunc" id="5064465">print</span><span class="op" id="5064470">(</span><span class="ident" id="5064471">blank</span><span class="op" id="5064476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064484">p</span><span class="op" id="5064485">.</span><span class="builtinfunc" id="5064486">print</span><span class="op" id="5064491">(</span><span class="ident" id="5064492">noExtraLinebreak</span><span class="op" id="5064508">,</span>&nbsp;<span class="ident" id="5064510">b</span><span class="op" id="5064511">.</span><span class="ident" id="5064512">Rbrace</span><span class="op" id="5064518">,</span>&nbsp;<span class="ident" id="5064520">token</span><span class="op" id="5064525">.</span><span class="ident" id="5064526">RBRACE</span><span class="op" id="5064532">,</span>&nbsp;<span class="ident" id="5064534">noExtraLinebreak</span><span class="op" id="5064550">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064554">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064566">if</span>&nbsp;<span class="ident" id="5064569">sep</span>&nbsp;<span class="op" id="5064573">!=</span>&nbsp;<span class="ident" id="5064576">ignore</span>&nbsp;<span class="op" id="5064583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064587">p</span><span class="op" id="5064588">.</span><span class="builtinfunc" id="5064589">print</span><span class="op" id="5064594">(</span><span class="ident" id="5064595">blank</span><span class="op" id="5064600">)</span>&nbsp;<span class="comment" id="5064602">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5064623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5064626">p</span><span class="op" id="5064627">.</span><span class="ident" id="5064628">block</span><span class="op" id="5064633">(</span><span class="ident" id="5064634">b</span><span class="op" id="5064635">,</span>&nbsp;<span class="num" id="5064637">1</span><span class="op" id="5064638">)</span><br>
<span class="lineno"></span><span class="op" id="5064640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5064643">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="5064725">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="5064809">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="5064849">func</span>&nbsp;<span class="op" id="5064854">(</span><span class="ident" id="5064855">p</span>&nbsp;<span class="op" id="5064857">*</span><span class="ident" id="5064858">printer</span><span class="op" id="5064865">)</span>&nbsp;<span class="ident" id="5064867">distanceFrom</span><span class="op" id="5064879">(</span><span class="ident" id="5064880">from</span>&nbsp;<span class="ident" id="5064885">token</span><span class="op" id="5064890">.</span><span class="ident" id="5064891">Pos</span><span class="op" id="5064894">)</span>&nbsp;<span class="builtintype" id="5064896">int</span>&nbsp;<span class="op" id="5064900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064903">if</span>&nbsp;<span class="ident" id="5064906">from</span><span class="op" id="5064910">.</span><span class="ident" id="5064911">IsValid</span><span class="op" id="5064918">(</span><span class="op" id="5064919">)</span>&nbsp;<span class="op" id="5064921">&amp;&amp;</span>&nbsp;<span class="ident" id="5064924">p</span><span class="op" id="5064925">.</span><span class="ident" id="5064926">pos</span><span class="op" id="5064929">.</span><span class="ident" id="5064930">IsValid</span><span class="op" id="5064937">(</span><span class="op" id="5064938">)</span>&nbsp;<span class="op" id="5064940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064944">if</span>&nbsp;<span class="ident" id="5064947">f</span>&nbsp;<span class="op" id="5064949">:=</span>&nbsp;<span class="ident" id="5064952">p</span><span class="op" id="5064953">.</span><span class="ident" id="5064954">posFor</span><span class="op" id="5064960">(</span><span class="ident" id="5064961">from</span><span class="op" id="5064965">)</span><span class="op" id="5064966">;</span>&nbsp;<span class="ident" id="5064968">f</span><span class="op" id="5064969">.</span><span class="ident" id="5064970">Line</span>&nbsp;<span class="op" id="5064975">==</span>&nbsp;<span class="ident" id="5064978">p</span><span class="op" id="5064979">.</span><span class="ident" id="5064980">pos</span><span class="op" id="5064983">.</span><span class="ident" id="5064984">Line</span>&nbsp;<span class="op" id="5064989">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5064994">return</span>&nbsp;<span class="ident" id="5065001">p</span><span class="op" id="5065002">.</span><span class="ident" id="5065003">pos</span><span class="op" id="5065006">.</span><span class="ident" id="5065007">Column</span>&nbsp;<span class="op" id="5065014">-</span>&nbsp;<span class="ident" id="5065016">f</span><span class="op" id="5065017">.</span><span class="ident" id="5065018">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065033">return</span>&nbsp;<span class="ident" id="5065040">infinity</span><br>
<span class="lineno"></span><span class="op" id="5065049">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="5065052">func</span>&nbsp;<span class="op" id="5065057">(</span><span class="ident" id="5065058">p</span>&nbsp;<span class="op" id="5065060">*</span><span class="ident" id="5065061">printer</span><span class="op" id="5065068">)</span>&nbsp;<span class="ident" id="5065070">funcDecl</span><span class="op" id="5065078">(</span><span class="ident" id="5065079">d</span>&nbsp;<span class="op" id="5065081">*</span><span class="ident" id="5065082">ast</span><span class="op" id="5065085">.</span><span class="ident" id="5065086">FuncDecl</span><span class="op" id="5065094">)</span>&nbsp;<span class="op" id="5065096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065099">p</span><span class="op" id="5065100">.</span><span class="ident" id="5065101">setComment</span><span class="op" id="5065111">(</span><span class="ident" id="5065112">d</span><span class="op" id="5065113">.</span><span class="ident" id="5065114">Doc</span><span class="op" id="5065117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065120">p</span><span class="op" id="5065121">.</span><span class="builtinfunc" id="5065122">print</span><span class="op" id="5065127">(</span><span class="ident" id="5065128">d</span><span class="op" id="5065129">.</span><span class="ident" id="5065130">Pos</span><span class="op" id="5065133">(</span><span class="op" id="5065134">)</span><span class="op" id="5065135">,</span>&nbsp;<span class="ident" id="5065137">token</span><span class="op" id="5065142">.</span><span class="ident" id="5065143">FUNC</span><span class="op" id="5065147">,</span>&nbsp;<span class="ident" id="5065149">blank</span><span class="op" id="5065154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065157">if</span>&nbsp;<span class="ident" id="5065160">d</span><span class="op" id="5065161">.</span><span class="ident" id="5065162">Recv</span>&nbsp;<span class="op" id="5065167">!=</span>&nbsp;<span class="builtintype" id="5065170">nil</span>&nbsp;<span class="op" id="5065174">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065178">p</span><span class="op" id="5065179">.</span><span class="ident" id="5065180">parameters</span><span class="op" id="5065190">(</span><span class="ident" id="5065191">d</span><span class="op" id="5065192">.</span><span class="ident" id="5065193">Recv</span><span class="op" id="5065197">)</span>&nbsp;<span class="comment" id="5065199">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065227">p</span><span class="op" id="5065228">.</span><span class="builtinfunc" id="5065229">print</span><span class="op" id="5065234">(</span><span class="ident" id="5065235">blank</span><span class="op" id="5065240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065246">p</span><span class="op" id="5065247">.</span><span class="ident" id="5065248">expr</span><span class="op" id="5065252">(</span><span class="ident" id="5065253">d</span><span class="op" id="5065254">.</span><span class="ident" id="5065255">Name</span><span class="op" id="5065259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065262">p</span><span class="op" id="5065263">.</span><span class="ident" id="5065264">signature</span><span class="op" id="5065273">(</span><span class="ident" id="5065274">d</span><span class="op" id="5065275">.</span><span class="ident" id="5065276">Type</span><span class="op" id="5065280">.</span><span class="ident" id="5065281">Params</span><span class="op" id="5065287">,</span>&nbsp;<span class="ident" id="5065289">d</span><span class="op" id="5065290">.</span><span class="ident" id="5065291">Type</span><span class="op" id="5065295">.</span><span class="ident" id="5065296">Results</span><span class="op" id="5065303">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065306">p</span><span class="op" id="5065307">.</span><span class="ident" id="5065308">adjBlock</span><span class="op" id="5065316">(</span><span class="ident" id="5065317">p</span><span class="op" id="5065318">.</span><span class="ident" id="5065319">distanceFrom</span><span class="op" id="5065331">(</span><span class="ident" id="5065332">d</span><span class="op" id="5065333">.</span><span class="ident" id="5065334">Pos</span><span class="op" id="5065337">(</span><span class="op" id="5065338">)</span><span class="op" id="5065339">)</span><span class="op" id="5065340">,</span>&nbsp;<span class="ident" id="5065342">vtab</span><span class="op" id="5065346">,</span>&nbsp;<span class="ident" id="5065348">d</span><span class="op" id="5065349">.</span><span class="ident" id="5065350">Body</span><span class="op" id="5065354">)</span><br>
<span class="lineno"></span><span class="op" id="5065356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5065359">func</span>&nbsp;<span class="op" id="5065364">(</span><span class="ident" id="5065365">p</span>&nbsp;<span class="op" id="5065367">*</span><span class="ident" id="5065368">printer</span><span class="op" id="5065375">)</span>&nbsp;<span class="ident" id="5065377">decl</span><span class="op" id="5065381">(</span><span class="ident" id="5065382">decl</span>&nbsp;<span class="ident" id="5065387">ast</span><span class="op" id="5065390">.</span><span class="ident" id="5065391">Decl</span><span class="op" id="5065395">)</span>&nbsp;<span class="op" id="5065397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065400">switch</span>&nbsp;<span class="ident" id="5065407">d</span>&nbsp;<span class="op" id="5065409">:=</span>&nbsp;<span class="ident" id="5065412">decl</span><span class="op" id="5065416">.</span><span class="op" id="5065417">(</span><span class="keyword" id="5065418">type</span><span class="op" id="5065422">)</span>&nbsp;<span class="op" id="5065424">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065427">case</span>&nbsp;<span class="op" id="5065432">*</span><span class="ident" id="5065433">ast</span><span class="op" id="5065436">.</span><span class="ident" id="5065437">BadDecl</span><span class="op" id="5065444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065448">p</span><span class="op" id="5065449">.</span><span class="builtinfunc" id="5065450">print</span><span class="op" id="5065455">(</span><span class="ident" id="5065456">d</span><span class="op" id="5065457">.</span><span class="ident" id="5065458">Pos</span><span class="op" id="5065461">(</span><span class="op" id="5065462">)</span><span class="op" id="5065463">,</span>&nbsp;<span class="string" id="5065465">&#34;BadDecl&#34;</span><span class="op" id="5065474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065477">case</span>&nbsp;<span class="op" id="5065482">*</span><span class="ident" id="5065483">ast</span><span class="op" id="5065486">.</span><span class="ident" id="5065487">GenDecl</span><span class="op" id="5065494">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065498">p</span><span class="op" id="5065499">.</span><span class="ident" id="5065500">genDecl</span><span class="op" id="5065507">(</span><span class="ident" id="5065508">d</span><span class="op" id="5065509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065512">case</span>&nbsp;<span class="op" id="5065517">*</span><span class="ident" id="5065518">ast</span><span class="op" id="5065521">.</span><span class="ident" id="5065522">FuncDecl</span><span class="op" id="5065530">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065534">p</span><span class="op" id="5065535">.</span><span class="ident" id="5065536">funcDecl</span><span class="op" id="5065544">(</span><span class="ident" id="5065545">d</span><span class="op" id="5065546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065549">default</span><span class="op" id="5065556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5065560">panic</span><span class="op" id="5065565">(</span><span class="string" id="5065566">&#34;unreachable&#34;</span><span class="op" id="5065579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065582">}</span><br>
<span class="lineno"></span><span class="op" id="5065584">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="5065587">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5065667">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5065677">func</span>&nbsp;<span class="ident" id="5065682">declToken</span><span class="op" id="5065691">(</span><span class="ident" id="5065692">decl</span>&nbsp;<span class="ident" id="5065697">ast</span><span class="op" id="5065700">.</span><span class="ident" id="5065701">Decl</span><span class="op" id="5065705">)</span>&nbsp;<span class="op" id="5065707">(</span><span class="ident" id="5065708">tok</span>&nbsp;<span class="ident" id="5065712">token</span><span class="op" id="5065717">.</span><span class="ident" id="5065718">Token</span><span class="op" id="5065723">)</span>&nbsp;<span class="op" id="5065725">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065728">tok</span>&nbsp;<span class="op" id="5065732">=</span>&nbsp;<span class="ident" id="5065734">token</span><span class="op" id="5065739">.</span><span class="ident" id="5065740">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065749">switch</span>&nbsp;<span class="ident" id="5065756">d</span>&nbsp;<span class="op" id="5065758">:=</span>&nbsp;<span class="ident" id="5065761">decl</span><span class="op" id="5065765">.</span><span class="op" id="5065766">(</span><span class="keyword" id="5065767">type</span><span class="op" id="5065771">)</span>&nbsp;<span class="op" id="5065773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065776">case</span>&nbsp;<span class="op" id="5065781">*</span><span class="ident" id="5065782">ast</span><span class="op" id="5065785">.</span><span class="ident" id="5065786">GenDecl</span><span class="op" id="5065793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065797">tok</span>&nbsp;<span class="op" id="5065801">=</span>&nbsp;<span class="ident" id="5065803">d</span><span class="op" id="5065804">.</span><span class="ident" id="5065805">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065810">case</span>&nbsp;<span class="op" id="5065815">*</span><span class="ident" id="5065816">ast</span><span class="op" id="5065819">.</span><span class="ident" id="5065820">FuncDecl</span><span class="op" id="5065828">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065832">tok</span>&nbsp;<span class="op" id="5065836">=</span>&nbsp;<span class="ident" id="5065838">token</span><span class="op" id="5065843">.</span><span class="ident" id="5065844">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5065850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065853">return</span><br>
<span class="lineno"></span><span class="op" id="5065860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="5065863">func</span>&nbsp;<span class="op" id="5065868">(</span><span class="ident" id="5065869">p</span>&nbsp;<span class="op" id="5065871">*</span><span class="ident" id="5065872">printer</span><span class="op" id="5065879">)</span>&nbsp;<span class="ident" id="5065881">declList</span><span class="op" id="5065889">(</span><span class="ident" id="5065890">list</span>&nbsp;<span class="op" id="5065895">[</span><span class="op" id="5065896">]</span><span class="ident" id="5065897">ast</span><span class="op" id="5065900">.</span><span class="ident" id="5065901">Decl</span><span class="op" id="5065905">)</span>&nbsp;<span class="op" id="5065907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065910">tok</span>&nbsp;<span class="op" id="5065914">:=</span>&nbsp;<span class="ident" id="5065917">token</span><span class="op" id="5065922">.</span><span class="ident" id="5065923">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5065932">for</span>&nbsp;<span class="ident" id="5065936">_</span><span class="op" id="5065937">,</span>&nbsp;<span class="ident" id="5065939">d</span>&nbsp;<span class="op" id="5065941">:=</span>&nbsp;<span class="keyword" id="5065944">range</span>&nbsp;<span class="ident" id="5065950">list</span>&nbsp;<span class="op" id="5065955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065959">prev</span>&nbsp;<span class="op" id="5065964">:=</span>&nbsp;<span class="ident" id="5065967">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5065973">tok</span>&nbsp;<span class="op" id="5065977">=</span>&nbsp;<span class="ident" id="5065979">declToken</span><span class="op" id="5065988">(</span><span class="ident" id="5065989">d</span><span class="op" id="5065990">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5065994">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066059">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066126">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066183">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066249">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066318">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066385">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5066442">if</span>&nbsp;<span class="builtinfunc" id="5066445">len</span><span class="op" id="5066448">(</span><span class="ident" id="5066449">p</span><span class="op" id="5066450">.</span><span class="ident" id="5066451">output</span><span class="op" id="5066457">)</span>&nbsp;<span class="op" id="5066459">&gt;</span>&nbsp;<span class="num" id="5066461">0</span>&nbsp;<span class="op" id="5066463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066468">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5066541">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066598">min</span>&nbsp;<span class="op" id="5066602">:=</span>&nbsp;<span class="num" id="5066605">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5066610">if</span>&nbsp;<span class="ident" id="5066613">prev</span>&nbsp;<span class="op" id="5066618">!=</span>&nbsp;<span class="ident" id="5066621">tok</span>&nbsp;<span class="op" id="5066625">||</span>&nbsp;<span class="ident" id="5066628">getDoc</span><span class="op" id="5066634">(</span><span class="ident" id="5066635">d</span><span class="op" id="5066636">)</span>&nbsp;<span class="op" id="5066638">!=</span>&nbsp;<span class="builtintype" id="5066641">nil</span>&nbsp;<span class="op" id="5066645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066651">min</span>&nbsp;<span class="op" id="5066655">=</span>&nbsp;<span class="num" id="5066657">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5066662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066667">p</span><span class="op" id="5066668">.</span><span class="ident" id="5066669">linebreak</span><span class="op" id="5066678">(</span><span class="ident" id="5066679">p</span><span class="op" id="5066680">.</span><span class="ident" id="5066681">lineFor</span><span class="op" id="5066688">(</span><span class="ident" id="5066689">d</span><span class="op" id="5066690">.</span><span class="ident" id="5066691">Pos</span><span class="op" id="5066694">(</span><span class="op" id="5066695">)</span><span class="op" id="5066696">)</span><span class="op" id="5066697">,</span>&nbsp;<span class="ident" id="5066699">min</span><span class="op" id="5066702">,</span>&nbsp;<span class="ident" id="5066704">ignore</span><span class="op" id="5066710">,</span>&nbsp;<span class="builtintype" id="5066712">false</span><span class="op" id="5066717">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5066721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066725">p</span><span class="op" id="5066726">.</span><span class="ident" id="5066727">decl</span><span class="op" id="5066731">(</span><span class="ident" id="5066732">d</span><span class="op" id="5066733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5066736">}</span><br>
<span class="lineno"></span><span class="op" id="5066738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="5066741">func</span>&nbsp;<span class="op" id="5066746">(</span><span class="ident" id="5066747">p</span>&nbsp;<span class="op" id="5066749">*</span><span class="ident" id="5066750">printer</span><span class="op" id="5066757">)</span>&nbsp;<span class="ident" id="5066759">file</span><span class="op" id="5066763">(</span><span class="ident" id="5066764">src</span>&nbsp;<span class="op" id="5066768">*</span><span class="ident" id="5066769">ast</span><span class="op" id="5066772">.</span><span class="ident" id="5066773">File</span><span class="op" id="5066777">)</span>&nbsp;<span class="op" id="5066779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066782">p</span><span class="op" id="5066783">.</span><span class="ident" id="5066784">setComment</span><span class="op" id="5066794">(</span><span class="ident" id="5066795">src</span><span class="op" id="5066798">.</span><span class="ident" id="5066799">Doc</span><span class="op" id="5066802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066805">p</span><span class="op" id="5066806">.</span><span class="builtinfunc" id="5066807">print</span><span class="op" id="5066812">(</span><span class="ident" id="5066813">src</span><span class="op" id="5066816">.</span><span class="ident" id="5066817">Pos</span><span class="op" id="5066820">(</span><span class="op" id="5066821">)</span><span class="op" id="5066822">,</span>&nbsp;<span class="ident" id="5066824">token</span><span class="op" id="5066829">.</span><span class="ident" id="5066830">PACKAGE</span><span class="op" id="5066837">,</span>&nbsp;<span class="ident" id="5066839">blank</span><span class="op" id="5066844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066847">p</span><span class="op" id="5066848">.</span><span class="ident" id="5066849">expr</span><span class="op" id="5066853">(</span><span class="ident" id="5066854">src</span><span class="op" id="5066857">.</span><span class="ident" id="5066858">Name</span><span class="op" id="5066862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066865">p</span><span class="op" id="5066866">.</span><span class="ident" id="5066867">declList</span><span class="op" id="5066875">(</span><span class="ident" id="5066876">src</span><span class="op" id="5066879">.</span><span class="ident" id="5066880">Decls</span><span class="op" id="5066885">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5066888">p</span><span class="op" id="5066889">.</span><span class="builtinfunc" id="5066890">print</span><span class="op" id="5066895">(</span><span class="ident" id="5066896">newline</span><span class="op" id="5066903">)</span><br>
<span class="lineno"></span><span class="op" id="5066905">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
