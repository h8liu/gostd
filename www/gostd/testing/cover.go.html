<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html" class="current">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6148063">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6148118">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6148172">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6148223">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6148254">package</span>&nbsp;<span class="ident" id="6148262">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6148271">import</span>&nbsp;<span class="op" id="6148278">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6148281">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6148288">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6148294">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="6148308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6148311">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="6148377">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6148456">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6148521">type</span>&nbsp;<span class="ident" id="6148526">CoverBlock</span>&nbsp;<span class="keyword" id="6148537">struct</span>&nbsp;<span class="op" id="6148544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148547">Line0</span>&nbsp;<span class="builtintype" id="6148553">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148561">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="6148567">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148575">Line1</span>&nbsp;<span class="builtintype" id="6148581">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148589">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="6148595">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148603">Stmts</span>&nbsp;<span class="builtintype" id="6148609">uint16</span><br>
<span class="lineno"></span><span class="op" id="6148616">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6148619">var</span>&nbsp;<span class="ident" id="6148623">cover</span>&nbsp;<span class="ident" id="6148629">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6148636">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="6148695">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="6148774">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6148839">type</span>&nbsp;<span class="ident" id="6148844">Cover</span>&nbsp;<span class="keyword" id="6148850">struct</span>&nbsp;<span class="op" id="6148857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148860">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6148876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148884">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148900">map</span><span class="op" id="6148903">[</span><span class="builtintype" id="6148904">string</span><span class="op" id="6148910">]</span><span class="op" id="6148911">[</span><span class="op" id="6148912">]</span><span class="builtintype" id="6148913">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148921">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148937">map</span><span class="op" id="6148940">[</span><span class="builtintype" id="6148941">string</span><span class="op" id="6148947">]</span><span class="op" id="6148948">[</span><span class="op" id="6148949">]</span><span class="ident" id="6148950">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148962">CoveredPackages</span>&nbsp;<span class="builtintype" id="6148978">string</span><br>
<span class="lineno"></span><span class="op" id="6148985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6148988">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="6149069">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="6149120">//</span><br>
<span class="lineno"></span><span class="comment" id="6149123">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="6149210">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="6149285">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6149362">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="6149382">func</span>&nbsp;<span class="ident" id="6149387">Coverage</span><span class="op" id="6149395">(</span><span class="op" id="6149396">)</span>&nbsp;<span class="builtintype" id="6149398">float64</span>&nbsp;<span class="op" id="6149406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149409">var</span>&nbsp;<span class="ident" id="6149413">n</span><span class="op" id="6149414">,</span>&nbsp;<span class="ident" id="6149416">d</span>&nbsp;<span class="ident" id="6149418">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149425">for</span>&nbsp;<span class="ident" id="6149429">_</span><span class="op" id="6149430">,</span>&nbsp;<span class="ident" id="6149432">counters</span>&nbsp;<span class="op" id="6149441">:=</span>&nbsp;<span class="keyword" id="6149444">range</span>&nbsp;<span class="ident" id="6149450">cover</span><span class="op" id="6149455">.</span><span class="ident" id="6149456">Counters</span>&nbsp;<span class="op" id="6149465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149469">for</span>&nbsp;<span class="ident" id="6149473">i</span>&nbsp;<span class="op" id="6149475">:=</span>&nbsp;<span class="keyword" id="6149478">range</span>&nbsp;<span class="ident" id="6149484">counters</span>&nbsp;<span class="op" id="6149493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149498">if</span>&nbsp;<span class="ident" id="6149501">atomic</span><span class="op" id="6149507">.</span><span class="ident" id="6149508">LoadUint32</span><span class="op" id="6149518">(</span><span class="op" id="6149519">&amp;</span><span class="ident" id="6149520">counters</span><span class="op" id="6149528">[</span><span class="ident" id="6149529">i</span><span class="op" id="6149530">]</span><span class="op" id="6149531">)</span>&nbsp;<span class="op" id="6149533">&gt;</span>&nbsp;<span class="num" id="6149535">0</span>&nbsp;<span class="op" id="6149537">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149543">n</span><span class="op" id="6149544">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149555">d</span><span class="op" id="6149556">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149564">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149567">if</span>&nbsp;<span class="ident" id="6149570">d</span>&nbsp;<span class="op" id="6149572">==</span>&nbsp;<span class="num" id="6149575">0</span>&nbsp;<span class="op" id="6149577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149581">return</span>&nbsp;<span class="num" id="6149588">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149594">return</span>&nbsp;<span class="builtintype" id="6149601">float64</span><span class="op" id="6149608">(</span><span class="ident" id="6149609">n</span><span class="op" id="6149610">)</span>&nbsp;<span class="op" id="6149612">/</span>&nbsp;<span class="builtintype" id="6149614">float64</span><span class="op" id="6149621">(</span><span class="ident" id="6149622">d</span><span class="op" id="6149623">)</span><br>
<span class="lineno"></span><span class="op" id="6149625">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6149628">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="6149699">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6149780">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6149845">func</span>&nbsp;<span class="ident" id="6149850">RegisterCover</span><span class="op" id="6149863">(</span><span class="ident" id="6149864">c</span>&nbsp;<span class="ident" id="6149866">Cover</span><span class="op" id="6149871">)</span>&nbsp;<span class="op" id="6149873">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149876">cover</span>&nbsp;<span class="op" id="6149882">=</span>&nbsp;<span class="ident" id="6149884">c</span><br>
<span class="lineno"></span><span class="op" id="6149886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6149889">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="6149958">func</span>&nbsp;<span class="ident" id="6149963">mustBeNil</span><span class="op" id="6149972">(</span><span class="ident" id="6149973">err</span>&nbsp;<span class="builtintype" id="6149977">error</span><span class="op" id="6149982">)</span>&nbsp;<span class="op" id="6149984">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149987">if</span>&nbsp;<span class="ident" id="6149990">err</span>&nbsp;<span class="op" id="6149994">!=</span>&nbsp;<span class="builtintype" id="6149997">nil</span>&nbsp;<span class="op" id="6150001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150005">fmt</span><span class="op" id="6150008">.</span><span class="ident" id="6150009">Fprintf</span><span class="op" id="6150016">(</span><span class="ident" id="6150017">os</span><span class="op" id="6150019">.</span><span class="ident" id="6150020">Stderr</span><span class="op" id="6150026">,</span>&nbsp;<span class="string" id="6150028">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6150043">,</span>&nbsp;<span class="ident" id="6150045">err</span><span class="op" id="6150048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150052">os</span><span class="op" id="6150054">.</span><span class="ident" id="6150055">Exit</span><span class="op" id="6150059">(</span><span class="num" id="6150060">2</span><span class="op" id="6150061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150064">}</span><br>
<span class="lineno"></span><span class="op" id="6150066">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6150069">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6150160">func</span>&nbsp;<span class="ident" id="6150165">coverReport</span><span class="op" id="6150176">(</span><span class="op" id="6150177">)</span>&nbsp;<span class="op" id="6150179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150182">var</span>&nbsp;<span class="ident" id="6150186">f</span>&nbsp;<span class="op" id="6150188">*</span><span class="ident" id="6150189">os</span><span class="op" id="6150191">.</span><span class="ident" id="6150192">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150198">var</span>&nbsp;<span class="ident" id="6150202">err</span>&nbsp;<span class="builtintype" id="6150206">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150213">if</span>&nbsp;<span class="op" id="6150216">*</span><span class="ident" id="6150217">coverProfile</span>&nbsp;<span class="op" id="6150230">!=</span>&nbsp;<span class="string" id="6150233">&#34;&#34;</span>&nbsp;<span class="op" id="6150236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150240">f</span><span class="op" id="6150241">,</span>&nbsp;<span class="ident" id="6150243">err</span>&nbsp;<span class="op" id="6150247">=</span>&nbsp;<span class="ident" id="6150249">os</span><span class="op" id="6150251">.</span><span class="ident" id="6150252">Create</span><span class="op" id="6150258">(</span><span class="ident" id="6150259">toOutputDir</span><span class="op" id="6150270">(</span><span class="op" id="6150271">*</span><span class="ident" id="6150272">coverProfile</span><span class="op" id="6150284">)</span><span class="op" id="6150285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150289">mustBeNil</span><span class="op" id="6150298">(</span><span class="ident" id="6150299">err</span><span class="op" id="6150302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150306">fmt</span><span class="op" id="6150309">.</span><span class="ident" id="6150310">Fprintf</span><span class="op" id="6150317">(</span><span class="ident" id="6150318">f</span><span class="op" id="6150319">,</span>&nbsp;<span class="string" id="6150321">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="6150333">,</span>&nbsp;<span class="ident" id="6150335">cover</span><span class="op" id="6150340">.</span><span class="ident" id="6150341">Mode</span><span class="op" id="6150345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150349">defer</span>&nbsp;<span class="keyword" id="6150355">func</span><span class="op" id="6150359">(</span><span class="op" id="6150360">)</span>&nbsp;<span class="op" id="6150362">{</span>&nbsp;<span class="ident" id="6150364">mustBeNil</span><span class="op" id="6150373">(</span><span class="ident" id="6150374">f</span><span class="op" id="6150375">.</span><span class="ident" id="6150376">Close</span><span class="op" id="6150381">(</span><span class="op" id="6150382">)</span><span class="op" id="6150383">)</span>&nbsp;<span class="op" id="6150385">}</span><span class="op" id="6150386">(</span><span class="op" id="6150387">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150394">var</span>&nbsp;<span class="ident" id="6150398">active</span><span class="op" id="6150404">,</span>&nbsp;<span class="ident" id="6150406">total</span>&nbsp;<span class="ident" id="6150412">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150419">var</span>&nbsp;<span class="ident" id="6150423">count</span>&nbsp;<span class="builtintype" id="6150429">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150437">for</span>&nbsp;<span class="ident" id="6150441">name</span><span class="op" id="6150445">,</span>&nbsp;<span class="ident" id="6150447">counts</span>&nbsp;<span class="op" id="6150454">:=</span>&nbsp;<span class="keyword" id="6150457">range</span>&nbsp;<span class="ident" id="6150463">cover</span><span class="op" id="6150468">.</span><span class="ident" id="6150469">Counters</span>&nbsp;<span class="op" id="6150478">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150482">blocks</span>&nbsp;<span class="op" id="6150489">:=</span>&nbsp;<span class="ident" id="6150492">cover</span><span class="op" id="6150497">.</span><span class="ident" id="6150498">Blocks</span><span class="op" id="6150504">[</span><span class="ident" id="6150505">name</span><span class="op" id="6150509">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150513">for</span>&nbsp;<span class="ident" id="6150517">i</span>&nbsp;<span class="op" id="6150519">:=</span>&nbsp;<span class="keyword" id="6150522">range</span>&nbsp;<span class="ident" id="6150528">counts</span>&nbsp;<span class="op" id="6150535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150540">stmts</span>&nbsp;<span class="op" id="6150546">:=</span>&nbsp;<span class="ident" id="6150549">int64</span><span class="op" id="6150554">(</span><span class="ident" id="6150555">blocks</span><span class="op" id="6150561">[</span><span class="ident" id="6150562">i</span><span class="op" id="6150563">]</span><span class="op" id="6150564">.</span><span class="ident" id="6150565">Stmts</span><span class="op" id="6150570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150575">total</span>&nbsp;<span class="op" id="6150581">+=</span>&nbsp;<span class="ident" id="6150584">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150593">count</span>&nbsp;<span class="op" id="6150599">=</span>&nbsp;<span class="ident" id="6150601">atomic</span><span class="op" id="6150607">.</span><span class="ident" id="6150608">LoadUint32</span><span class="op" id="6150618">(</span><span class="op" id="6150619">&amp;</span><span class="ident" id="6150620">counts</span><span class="op" id="6150626">[</span><span class="ident" id="6150627">i</span><span class="op" id="6150628">]</span><span class="op" id="6150629">)</span>&nbsp;<span class="comment" id="6150631">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150655">if</span>&nbsp;<span class="ident" id="6150658">count</span>&nbsp;<span class="op" id="6150664">&gt;</span>&nbsp;<span class="num" id="6150666">0</span>&nbsp;<span class="op" id="6150668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150674">active</span>&nbsp;<span class="op" id="6150681">+=</span>&nbsp;<span class="ident" id="6150684">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150698">if</span>&nbsp;<span class="ident" id="6150701">f</span>&nbsp;<span class="op" id="6150703">!=</span>&nbsp;<span class="builtintype" id="6150706">nil</span>&nbsp;<span class="op" id="6150710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150716">_</span><span class="op" id="6150717">,</span>&nbsp;<span class="ident" id="6150719">err</span>&nbsp;<span class="op" id="6150723">:=</span>&nbsp;<span class="ident" id="6150726">fmt</span><span class="op" id="6150729">.</span><span class="ident" id="6150730">Fprintf</span><span class="op" id="6150737">(</span><span class="ident" id="6150738">f</span><span class="op" id="6150739">,</span>&nbsp;<span class="string" id="6150741">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="6150765">,</span>&nbsp;<span class="ident" id="6150767">name</span><span class="op" id="6150771">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150778">blocks</span><span class="op" id="6150784">[</span><span class="ident" id="6150785">i</span><span class="op" id="6150786">]</span><span class="op" id="6150787">.</span><span class="ident" id="6150788">Line0</span><span class="op" id="6150793">,</span>&nbsp;<span class="ident" id="6150795">blocks</span><span class="op" id="6150801">[</span><span class="ident" id="6150802">i</span><span class="op" id="6150803">]</span><span class="op" id="6150804">.</span><span class="ident" id="6150805">Col0</span><span class="op" id="6150809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150816">blocks</span><span class="op" id="6150822">[</span><span class="ident" id="6150823">i</span><span class="op" id="6150824">]</span><span class="op" id="6150825">.</span><span class="ident" id="6150826">Line1</span><span class="op" id="6150831">,</span>&nbsp;<span class="ident" id="6150833">blocks</span><span class="op" id="6150839">[</span><span class="ident" id="6150840">i</span><span class="op" id="6150841">]</span><span class="op" id="6150842">.</span><span class="ident" id="6150843">Col1</span><span class="op" id="6150847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150854">stmts</span><span class="op" id="6150859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150866">count</span><span class="op" id="6150871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150877">mustBeNil</span><span class="op" id="6150886">(</span><span class="ident" id="6150887">err</span><span class="op" id="6150890">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150905">if</span>&nbsp;<span class="ident" id="6150908">total</span>&nbsp;<span class="op" id="6150914">==</span>&nbsp;<span class="num" id="6150917">0</span>&nbsp;<span class="op" id="6150919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150923">total</span>&nbsp;<span class="op" id="6150929">=</span>&nbsp;<span class="num" id="6150931">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150937">fmt</span><span class="op" id="6150940">.</span><span class="ident" id="6150941">Printf</span><span class="op" id="6150947">(</span><span class="string" id="6150948">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="6150984">,</span>&nbsp;<span class="num" id="6150986">100</span><span class="op" id="6150989">*</span><span class="builtintype" id="6150990">float64</span><span class="op" id="6150997">(</span><span class="ident" id="6150998">active</span><span class="op" id="6151004">)</span><span class="op" id="6151005">/</span><span class="builtintype" id="6151006">float64</span><span class="op" id="6151013">(</span><span class="ident" id="6151014">total</span><span class="op" id="6151019">)</span><span class="op" id="6151020">,</span>&nbsp;<span class="ident" id="6151022">cover</span><span class="op" id="6151027">.</span><span class="ident" id="6151028">CoveredPackages</span><span class="op" id="6151043">)</span><br>
<span class="lineno"></span><span class="op" id="6151045">}</span>
</div>
</body>
</html>
