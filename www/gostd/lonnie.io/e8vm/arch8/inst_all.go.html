<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4783502">package</span>&nbsp;<span class="ident" id="4783510">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4783517">//&nbsp;InstArch8&nbsp;dispatches&nbsp;and&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="keyword" id="4783576">type</span>&nbsp;<span class="ident" id="4783581">instArch8</span>&nbsp;<span class="keyword" id="4783591">struct</span>&nbsp;<span class="op" id="4783598">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783601">reg</span>&nbsp;<span class="ident" id="4783605">instReg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783614">imm</span>&nbsp;<span class="ident" id="4783618">instImm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783627">br</span>&nbsp;&nbsp;<span class="ident" id="4783631">instBr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783639">sys</span>&nbsp;<span class="ident" id="4783643">instSys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783652">jmp</span>&nbsp;<span class="ident" id="4783656">instJmp</span><br>
<span class="lineno">10</span><span class="op" id="4783664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4783667">//&nbsp;I&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instructino</span><br>
<span class="lineno"></span><span class="keyword" id="4783702">func</span>&nbsp;<span class="op" id="4783707">(</span><span class="ident" id="4783708">i</span>&nbsp;<span class="op" id="4783710">*</span><span class="ident" id="4783711">instArch8</span><span class="op" id="4783720">)</span>&nbsp;<span class="ident" id="4783722">I</span><span class="op" id="4783723">(</span><span class="ident" id="4783724">cpu</span>&nbsp;<span class="op" id="4783728">*</span><span class="ident" id="4783729">cpu</span><span class="op" id="4783732">,</span>&nbsp;<span class="ident" id="4783734">in</span>&nbsp;<span class="builtintype" id="4783737">uint32</span><span class="op" id="4783743">)</span>&nbsp;<span class="op" id="4783745">*</span><span class="ident" id="4783746">Excep</span>&nbsp;<span class="op" id="4783752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783755">if</span>&nbsp;<span class="op" id="4783758">(</span><span class="ident" id="4783759">in</span>&nbsp;<span class="op" id="4783762">&gt;&gt;</span>&nbsp;<span class="num" id="4783765">31</span><span class="op" id="4783767">)</span>&nbsp;<span class="op" id="4783769">==</span>&nbsp;<span class="num" id="4783772">0</span>&nbsp;<span class="op" id="4783774">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4783778">op</span>&nbsp;<span class="op" id="4783781">:=</span>&nbsp;<span class="op" id="4783784">(</span><span class="ident" id="4783785">in</span>&nbsp;<span class="op" id="4783788">&gt;&gt;</span>&nbsp;<span class="num" id="4783791">24</span><span class="op" id="4783793">)</span>&nbsp;<span class="op" id="4783795">&amp;</span>&nbsp;<span class="num" id="4783797">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783804">switch</span>&nbsp;<span class="op" id="4783811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783815">case</span>&nbsp;<span class="ident" id="4783820">op</span>&nbsp;<span class="op" id="4783823">==</span>&nbsp;<span class="num" id="4783826">0</span><span class="op" id="4783827">:</span>&nbsp;<span class="comment" id="4783829">//&nbsp;op&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783843">return</span>&nbsp;<span class="ident" id="4783850">i</span><span class="op" id="4783851">.</span><span class="ident" id="4783852">reg</span><span class="op" id="4783855">.</span><span class="ident" id="4783856">I</span><span class="op" id="4783857">(</span><span class="ident" id="4783858">cpu</span><span class="op" id="4783861">,</span>&nbsp;<span class="ident" id="4783863">in</span><span class="op" id="4783865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783869">case</span>&nbsp;<span class="ident" id="4783874">op</span>&nbsp;<span class="op" id="4783877">&lt;</span>&nbsp;<span class="num" id="4783879">32</span><span class="op" id="4783881">:</span>&nbsp;<span class="comment" id="4783883">//&nbsp;op&nbsp;in&nbsp;(0,&nbsp;32)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783903">return</span>&nbsp;<span class="ident" id="4783910">i</span><span class="op" id="4783911">.</span><span class="ident" id="4783912">imm</span><span class="op" id="4783915">.</span><span class="ident" id="4783916">I</span><span class="op" id="4783917">(</span><span class="ident" id="4783918">cpu</span><span class="op" id="4783921">,</span>&nbsp;<span class="ident" id="4783923">in</span><span class="op" id="4783925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783929">case</span>&nbsp;<span class="ident" id="4783934">op</span>&nbsp;<span class="op" id="4783937">&lt;</span>&nbsp;<span class="num" id="4783939">64</span><span class="op" id="4783941">:</span>&nbsp;<span class="comment" id="4783943">//&nbsp;op&nbsp;in&nbsp;[32,&nbsp;64)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783964">return</span>&nbsp;<span class="ident" id="4783971">i</span><span class="op" id="4783972">.</span><span class="ident" id="4783973">br</span><span class="op" id="4783975">.</span><span class="ident" id="4783976">I</span><span class="op" id="4783977">(</span><span class="ident" id="4783978">cpu</span><span class="op" id="4783981">,</span>&nbsp;<span class="ident" id="4783983">in</span><span class="op" id="4783985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4783989">case</span>&nbsp;<span class="ident" id="4783994">op</span>&nbsp;<span class="op" id="4783997">&lt;</span>&nbsp;<span class="num" id="4783999">128</span><span class="op" id="4784002">:</span>&nbsp;<span class="comment" id="4784004">//&nbsp;op&nbsp;in&nbsp;[64,&nbsp;128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784026">return</span>&nbsp;<span class="ident" id="4784033">i</span><span class="op" id="4784034">.</span><span class="ident" id="4784035">sys</span><span class="op" id="4784038">.</span><span class="ident" id="4784039">I</span><span class="op" id="4784040">(</span><span class="ident" id="4784041">cpu</span><span class="op" id="4784044">,</span>&nbsp;<span class="ident" id="4784046">in</span><span class="op" id="4784048">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784052">default</span><span class="op" id="4784059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4784064">panic</span><span class="op" id="4784069">(</span><span class="string" id="4784070">&#34;bug&#34;</span><span class="op" id="4784075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4784082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4784086">return</span>&nbsp;<span class="ident" id="4784093">i</span><span class="op" id="4784094">.</span><span class="ident" id="4784095">jmp</span><span class="op" id="4784098">.</span><span class="ident" id="4784099">I</span><span class="op" id="4784100">(</span><span class="ident" id="4784101">cpu</span><span class="op" id="4784104">,</span>&nbsp;<span class="ident" id="4784106">in</span><span class="op" id="4784108">)</span><br>
<span class="lineno"></span><span class="op" id="4784110">}</span>
</div>
</body>
</html>
