<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4661861">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4661916">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4661970">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4662021">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4662096">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4662107">package</span>&nbsp;<span class="ident" id="4662115">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662125">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4662200">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4662275">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4662355">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4662430">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4662504">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4662569">import</span>&nbsp;<span class="op" id="4662576">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4662579">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4662585">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4662597">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4662604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662607">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4662671">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4662732">type</span>&nbsp;<span class="ident" id="4662737">Curve</span>&nbsp;<span class="keyword" id="4662743">interface</span>&nbsp;<span class="op" id="4662753">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662756">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662805">Params</span><span class="op" id="4662811">(</span><span class="op" id="4662812">)</span>&nbsp;<span class="op" id="4662814">*</span><span class="ident" id="4662815">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662828">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662893">IsOnCurve</span><span class="op" id="4662902">(</span><span class="ident" id="4662903">x</span><span class="op" id="4662904">,</span>&nbsp;<span class="ident" id="4662906">y</span>&nbsp;<span class="op" id="4662908">*</span><span class="ident" id="4662909">big</span><span class="op" id="4662912">.</span><span class="ident" id="4662913">Int</span><span class="op" id="4662916">)</span>&nbsp;<span class="builtintype" id="4662918">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662924">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662971">Add</span><span class="op" id="4662974">(</span><span class="ident" id="4662975">x1</span><span class="op" id="4662977">,</span>&nbsp;<span class="ident" id="4662979">y1</span><span class="op" id="4662981">,</span>&nbsp;<span class="ident" id="4662983">x2</span><span class="op" id="4662985">,</span>&nbsp;<span class="ident" id="4662987">y2</span>&nbsp;<span class="op" id="4662990">*</span><span class="ident" id="4662991">big</span><span class="op" id="4662994">.</span><span class="ident" id="4662995">Int</span><span class="op" id="4662998">)</span>&nbsp;<span class="op" id="4663000">(</span><span class="ident" id="4663001">x</span><span class="op" id="4663002">,</span>&nbsp;<span class="ident" id="4663004">y</span>&nbsp;<span class="op" id="4663006">*</span><span class="ident" id="4663007">big</span><span class="op" id="4663010">.</span><span class="ident" id="4663011">Int</span><span class="op" id="4663014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663017">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663044">Double</span><span class="op" id="4663050">(</span><span class="ident" id="4663051">x1</span><span class="op" id="4663053">,</span>&nbsp;<span class="ident" id="4663055">y1</span>&nbsp;<span class="op" id="4663058">*</span><span class="ident" id="4663059">big</span><span class="op" id="4663062">.</span><span class="ident" id="4663063">Int</span><span class="op" id="4663066">)</span>&nbsp;<span class="op" id="4663068">(</span><span class="ident" id="4663069">x</span><span class="op" id="4663070">,</span>&nbsp;<span class="ident" id="4663072">y</span>&nbsp;<span class="op" id="4663074">*</span><span class="ident" id="4663075">big</span><span class="op" id="4663078">.</span><span class="ident" id="4663079">Int</span><span class="op" id="4663082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663085">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663158">ScalarMult</span><span class="op" id="4663168">(</span><span class="ident" id="4663169">x1</span><span class="op" id="4663171">,</span>&nbsp;<span class="ident" id="4663173">y1</span>&nbsp;<span class="op" id="4663176">*</span><span class="ident" id="4663177">big</span><span class="op" id="4663180">.</span><span class="ident" id="4663181">Int</span><span class="op" id="4663184">,</span>&nbsp;<span class="ident" id="4663186">k</span>&nbsp;<span class="op" id="4663188">[</span><span class="op" id="4663189">]</span><span class="builtintype" id="4663190">byte</span><span class="op" id="4663194">)</span>&nbsp;<span class="op" id="4663196">(</span><span class="ident" id="4663197">x</span><span class="op" id="4663198">,</span>&nbsp;<span class="ident" id="4663200">y</span>&nbsp;<span class="op" id="4663202">*</span><span class="ident" id="4663203">big</span><span class="op" id="4663206">.</span><span class="ident" id="4663207">Int</span><span class="op" id="4663210">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663213">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663284">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663328">ScalarBaseMult</span><span class="op" id="4663342">(</span><span class="ident" id="4663343">k</span>&nbsp;<span class="op" id="4663345">[</span><span class="op" id="4663346">]</span><span class="builtintype" id="4663347">byte</span><span class="op" id="4663351">)</span>&nbsp;<span class="op" id="4663353">(</span><span class="ident" id="4663354">x</span><span class="op" id="4663355">,</span>&nbsp;<span class="ident" id="4663357">y</span>&nbsp;<span class="op" id="4663359">*</span><span class="ident" id="4663360">big</span><span class="op" id="4663363">.</span><span class="ident" id="4663364">Int</span><span class="op" id="4663367">)</span><br>
<span class="lineno"></span><span class="op" id="4663369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4663372">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4663450">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4663507">type</span>&nbsp;<span class="ident" id="4663512">CurveParams</span>&nbsp;<span class="keyword" id="4663524">struct</span>&nbsp;<span class="op" id="4663531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663534">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4663542">*</span><span class="ident" id="4663543">big</span><span class="op" id="4663546">.</span><span class="ident" id="4663547">Int</span>&nbsp;<span class="comment" id="4663551">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663589">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4663597">*</span><span class="ident" id="4663598">big</span><span class="op" id="4663601">.</span><span class="ident" id="4663602">Int</span>&nbsp;<span class="comment" id="4663606">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663638">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4663646">*</span><span class="ident" id="4663647">big</span><span class="op" id="4663650">.</span><span class="ident" id="4663651">Int</span>&nbsp;<span class="comment" id="4663655">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663694">Gx</span><span class="op" id="4663696">,</span>&nbsp;<span class="ident" id="4663698">Gy</span>&nbsp;&nbsp;<span class="op" id="4663702">*</span><span class="ident" id="4663703">big</span><span class="op" id="4663706">.</span><span class="ident" id="4663707">Int</span>&nbsp;<span class="comment" id="4663711">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663739">BitSize</span>&nbsp;<span class="builtintype" id="4663747">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663756">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4663792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4663795">func</span>&nbsp;<span class="op" id="4663800">(</span><span class="ident" id="4663801">curve</span>&nbsp;<span class="op" id="4663807">*</span><span class="ident" id="4663808">CurveParams</span><span class="op" id="4663819">)</span>&nbsp;<span class="ident" id="4663821">Params</span><span class="op" id="4663827">(</span><span class="op" id="4663828">)</span>&nbsp;<span class="op" id="4663830">*</span><span class="ident" id="4663831">CurveParams</span>&nbsp;<span class="op" id="4663843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4663846">return</span>&nbsp;<span class="ident" id="4663853">curve</span><br>
<span class="lineno"></span><span class="op" id="4663859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663862">func</span>&nbsp;<span class="op" id="4663867">(</span><span class="ident" id="4663868">curve</span>&nbsp;<span class="op" id="4663874">*</span><span class="ident" id="4663875">CurveParams</span><span class="op" id="4663886">)</span>&nbsp;<span class="ident" id="4663888">IsOnCurve</span><span class="op" id="4663897">(</span><span class="ident" id="4663898">x</span><span class="op" id="4663899">,</span>&nbsp;<span class="ident" id="4663901">y</span>&nbsp;<span class="op" id="4663903">*</span><span class="ident" id="4663904">big</span><span class="op" id="4663907">.</span><span class="ident" id="4663908">Int</span><span class="op" id="4663911">)</span>&nbsp;<span class="builtintype" id="4663913">bool</span>&nbsp;<span class="op" id="4663918">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663921">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663944">y2</span>&nbsp;<span class="op" id="4663947">:=</span>&nbsp;<span class="builtinfunc" id="4663950">new</span><span class="op" id="4663953">(</span><span class="ident" id="4663954">big</span><span class="op" id="4663957">.</span><span class="ident" id="4663958">Int</span><span class="op" id="4663961">)</span><span class="op" id="4663962">.</span><span class="ident" id="4663963">Mul</span><span class="op" id="4663966">(</span><span class="ident" id="4663967">y</span><span class="op" id="4663968">,</span>&nbsp;<span class="ident" id="4663970">y</span><span class="op" id="4663971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663974">y2</span><span class="op" id="4663976">.</span><span class="ident" id="4663977">Mod</span><span class="op" id="4663980">(</span><span class="ident" id="4663981">y2</span><span class="op" id="4663983">,</span>&nbsp;<span class="ident" id="4663985">curve</span><span class="op" id="4663990">.</span><span class="ident" id="4663991">P</span><span class="op" id="4663992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663996">x3</span>&nbsp;<span class="op" id="4663999">:=</span>&nbsp;<span class="builtinfunc" id="4664002">new</span><span class="op" id="4664005">(</span><span class="ident" id="4664006">big</span><span class="op" id="4664009">.</span><span class="ident" id="4664010">Int</span><span class="op" id="4664013">)</span><span class="op" id="4664014">.</span><span class="ident" id="4664015">Mul</span><span class="op" id="4664018">(</span><span class="ident" id="4664019">x</span><span class="op" id="4664020">,</span>&nbsp;<span class="ident" id="4664022">x</span><span class="op" id="4664023">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664026">x3</span><span class="op" id="4664028">.</span><span class="ident" id="4664029">Mul</span><span class="op" id="4664032">(</span><span class="ident" id="4664033">x3</span><span class="op" id="4664035">,</span>&nbsp;<span class="ident" id="4664037">x</span><span class="op" id="4664038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664042">threeX</span>&nbsp;<span class="op" id="4664049">:=</span>&nbsp;<span class="builtinfunc" id="4664052">new</span><span class="op" id="4664055">(</span><span class="ident" id="4664056">big</span><span class="op" id="4664059">.</span><span class="ident" id="4664060">Int</span><span class="op" id="4664063">)</span><span class="op" id="4664064">.</span><span class="ident" id="4664065">Lsh</span><span class="op" id="4664068">(</span><span class="ident" id="4664069">x</span><span class="op" id="4664070">,</span>&nbsp;<span class="num" id="4664072">1</span><span class="op" id="4664073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664076">threeX</span><span class="op" id="4664082">.</span><span class="ident" id="4664083">Add</span><span class="op" id="4664086">(</span><span class="ident" id="4664087">threeX</span><span class="op" id="4664093">,</span>&nbsp;<span class="ident" id="4664095">x</span><span class="op" id="4664096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664100">x3</span><span class="op" id="4664102">.</span><span class="ident" id="4664103">Sub</span><span class="op" id="4664106">(</span><span class="ident" id="4664107">x3</span><span class="op" id="4664109">,</span>&nbsp;<span class="ident" id="4664111">threeX</span><span class="op" id="4664117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664120">x3</span><span class="op" id="4664122">.</span><span class="ident" id="4664123">Add</span><span class="op" id="4664126">(</span><span class="ident" id="4664127">x3</span><span class="op" id="4664129">,</span>&nbsp;<span class="ident" id="4664131">curve</span><span class="op" id="4664136">.</span><span class="ident" id="4664137">B</span><span class="op" id="4664138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664141">x3</span><span class="op" id="4664143">.</span><span class="ident" id="4664144">Mod</span><span class="op" id="4664147">(</span><span class="ident" id="4664148">x3</span><span class="op" id="4664150">,</span>&nbsp;<span class="ident" id="4664152">curve</span><span class="op" id="4664157">.</span><span class="ident" id="4664158">P</span><span class="op" id="4664159">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4664163">return</span>&nbsp;<span class="ident" id="4664170">x3</span><span class="op" id="4664172">.</span><span class="ident" id="4664173">Cmp</span><span class="op" id="4664176">(</span><span class="ident" id="4664177">y2</span><span class="op" id="4664179">)</span>&nbsp;<span class="op" id="4664181">==</span>&nbsp;<span class="num" id="4664184">0</span><br>
<span class="lineno">70</span><span class="op" id="4664186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4664189">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4664268">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4664348">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4664400">func</span>&nbsp;<span class="ident" id="4664405">zForAffine</span><span class="op" id="4664415">(</span><span class="ident" id="4664416">x</span><span class="op" id="4664417">,</span>&nbsp;<span class="ident" id="4664419">y</span>&nbsp;<span class="op" id="4664421">*</span><span class="ident" id="4664422">big</span><span class="op" id="4664425">.</span><span class="ident" id="4664426">Int</span><span class="op" id="4664429">)</span>&nbsp;<span class="op" id="4664431">*</span><span class="ident" id="4664432">big</span><span class="op" id="4664435">.</span><span class="ident" id="4664436">Int</span>&nbsp;<span class="op" id="4664440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664443">z</span>&nbsp;<span class="op" id="4664445">:=</span>&nbsp;<span class="builtinfunc" id="4664448">new</span><span class="op" id="4664451">(</span><span class="ident" id="4664452">big</span><span class="op" id="4664455">.</span><span class="ident" id="4664456">Int</span><span class="op" id="4664459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4664462">if</span>&nbsp;<span class="ident" id="4664465">x</span><span class="op" id="4664466">.</span><span class="ident" id="4664467">Sign</span><span class="op" id="4664471">(</span><span class="op" id="4664472">)</span>&nbsp;<span class="op" id="4664474">!=</span>&nbsp;<span class="num" id="4664477">0</span>&nbsp;<span class="op" id="4664479">||</span>&nbsp;<span class="ident" id="4664482">y</span><span class="op" id="4664483">.</span><span class="ident" id="4664484">Sign</span><span class="op" id="4664488">(</span><span class="op" id="4664489">)</span>&nbsp;<span class="op" id="4664491">!=</span>&nbsp;<span class="num" id="4664494">0</span>&nbsp;<span class="op" id="4664496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664500">z</span><span class="op" id="4664501">.</span><span class="ident" id="4664502">SetInt64</span><span class="op" id="4664510">(</span><span class="num" id="4664511">1</span><span class="op" id="4664512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4664515">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4664518">return</span>&nbsp;<span class="ident" id="4664525">z</span><br>
<span class="lineno"></span><span class="op" id="4664527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4664530">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4664608">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4664665">func</span>&nbsp;<span class="op" id="4664670">(</span><span class="ident" id="4664671">curve</span>&nbsp;<span class="op" id="4664677">*</span><span class="ident" id="4664678">CurveParams</span><span class="op" id="4664689">)</span>&nbsp;<span class="ident" id="4664691">affineFromJacobian</span><span class="op" id="4664709">(</span><span class="ident" id="4664710">x</span><span class="op" id="4664711">,</span>&nbsp;<span class="ident" id="4664713">y</span><span class="op" id="4664714">,</span>&nbsp;<span class="ident" id="4664716">z</span>&nbsp;<span class="op" id="4664718">*</span><span class="ident" id="4664719">big</span><span class="op" id="4664722">.</span><span class="ident" id="4664723">Int</span><span class="op" id="4664726">)</span>&nbsp;<span class="op" id="4664728">(</span><span class="ident" id="4664729">xOut</span><span class="op" id="4664733">,</span>&nbsp;<span class="ident" id="4664735">yOut</span>&nbsp;<span class="op" id="4664740">*</span><span class="ident" id="4664741">big</span><span class="op" id="4664744">.</span><span class="ident" id="4664745">Int</span><span class="op" id="4664748">)</span>&nbsp;<span class="op" id="4664750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4664753">if</span>&nbsp;<span class="ident" id="4664756">z</span><span class="op" id="4664757">.</span><span class="ident" id="4664758">Sign</span><span class="op" id="4664762">(</span><span class="op" id="4664763">)</span>&nbsp;<span class="op" id="4664765">==</span>&nbsp;<span class="num" id="4664768">0</span>&nbsp;<span class="op" id="4664770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4664774">return</span>&nbsp;<span class="builtinfunc" id="4664781">new</span><span class="op" id="4664784">(</span><span class="ident" id="4664785">big</span><span class="op" id="4664788">.</span><span class="ident" id="4664789">Int</span><span class="op" id="4664792">)</span><span class="op" id="4664793">,</span>&nbsp;<span class="builtinfunc" id="4664795">new</span><span class="op" id="4664798">(</span><span class="ident" id="4664799">big</span><span class="op" id="4664802">.</span><span class="ident" id="4664803">Int</span><span class="op" id="4664806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4664809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664813">zinv</span>&nbsp;<span class="op" id="4664818">:=</span>&nbsp;<span class="builtinfunc" id="4664821">new</span><span class="op" id="4664824">(</span><span class="ident" id="4664825">big</span><span class="op" id="4664828">.</span><span class="ident" id="4664829">Int</span><span class="op" id="4664832">)</span><span class="op" id="4664833">.</span><span class="ident" id="4664834">ModInverse</span><span class="op" id="4664844">(</span><span class="ident" id="4664845">z</span><span class="op" id="4664846">,</span>&nbsp;<span class="ident" id="4664848">curve</span><span class="op" id="4664853">.</span><span class="ident" id="4664854">P</span><span class="op" id="4664855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664858">zinvsq</span>&nbsp;<span class="op" id="4664865">:=</span>&nbsp;<span class="builtinfunc" id="4664868">new</span><span class="op" id="4664871">(</span><span class="ident" id="4664872">big</span><span class="op" id="4664875">.</span><span class="ident" id="4664876">Int</span><span class="op" id="4664879">)</span><span class="op" id="4664880">.</span><span class="ident" id="4664881">Mul</span><span class="op" id="4664884">(</span><span class="ident" id="4664885">zinv</span><span class="op" id="4664889">,</span>&nbsp;<span class="ident" id="4664891">zinv</span><span class="op" id="4664895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664899">xOut</span>&nbsp;<span class="op" id="4664904">=</span>&nbsp;<span class="builtinfunc" id="4664906">new</span><span class="op" id="4664909">(</span><span class="ident" id="4664910">big</span><span class="op" id="4664913">.</span><span class="ident" id="4664914">Int</span><span class="op" id="4664917">)</span><span class="op" id="4664918">.</span><span class="ident" id="4664919">Mul</span><span class="op" id="4664922">(</span><span class="ident" id="4664923">x</span><span class="op" id="4664924">,</span>&nbsp;<span class="ident" id="4664926">zinvsq</span><span class="op" id="4664932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664935">xOut</span><span class="op" id="4664939">.</span><span class="ident" id="4664940">Mod</span><span class="op" id="4664943">(</span><span class="ident" id="4664944">xOut</span><span class="op" id="4664948">,</span>&nbsp;<span class="ident" id="4664950">curve</span><span class="op" id="4664955">.</span><span class="ident" id="4664956">P</span><span class="op" id="4664957">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664960">zinvsq</span><span class="op" id="4664966">.</span><span class="ident" id="4664967">Mul</span><span class="op" id="4664970">(</span><span class="ident" id="4664971">zinvsq</span><span class="op" id="4664977">,</span>&nbsp;<span class="ident" id="4664979">zinv</span><span class="op" id="4664983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664986">yOut</span>&nbsp;<span class="op" id="4664991">=</span>&nbsp;<span class="builtinfunc" id="4664993">new</span><span class="op" id="4664996">(</span><span class="ident" id="4664997">big</span><span class="op" id="4665000">.</span><span class="ident" id="4665001">Int</span><span class="op" id="4665004">)</span><span class="op" id="4665005">.</span><span class="ident" id="4665006">Mul</span><span class="op" id="4665009">(</span><span class="ident" id="4665010">y</span><span class="op" id="4665011">,</span>&nbsp;<span class="ident" id="4665013">zinvsq</span><span class="op" id="4665019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665022">yOut</span><span class="op" id="4665026">.</span><span class="ident" id="4665027">Mod</span><span class="op" id="4665030">(</span><span class="ident" id="4665031">yOut</span><span class="op" id="4665035">,</span>&nbsp;<span class="ident" id="4665037">curve</span><span class="op" id="4665042">.</span><span class="ident" id="4665043">P</span><span class="op" id="4665044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665047">return</span><br>
<span class="lineno"></span><span class="op" id="4665054">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4665057">func</span>&nbsp;<span class="op" id="4665062">(</span><span class="ident" id="4665063">curve</span>&nbsp;<span class="op" id="4665069">*</span><span class="ident" id="4665070">CurveParams</span><span class="op" id="4665081">)</span>&nbsp;<span class="ident" id="4665083">Add</span><span class="op" id="4665086">(</span><span class="ident" id="4665087">x1</span><span class="op" id="4665089">,</span>&nbsp;<span class="ident" id="4665091">y1</span><span class="op" id="4665093">,</span>&nbsp;<span class="ident" id="4665095">x2</span><span class="op" id="4665097">,</span>&nbsp;<span class="ident" id="4665099">y2</span>&nbsp;<span class="op" id="4665102">*</span><span class="ident" id="4665103">big</span><span class="op" id="4665106">.</span><span class="ident" id="4665107">Int</span><span class="op" id="4665110">)</span>&nbsp;<span class="op" id="4665112">(</span><span class="op" id="4665113">*</span><span class="ident" id="4665114">big</span><span class="op" id="4665117">.</span><span class="ident" id="4665118">Int</span><span class="op" id="4665121">,</span>&nbsp;<span class="op" id="4665123">*</span><span class="ident" id="4665124">big</span><span class="op" id="4665127">.</span><span class="ident" id="4665128">Int</span><span class="op" id="4665131">)</span>&nbsp;<span class="op" id="4665133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665136">z1</span>&nbsp;<span class="op" id="4665139">:=</span>&nbsp;<span class="ident" id="4665142">zForAffine</span><span class="op" id="4665152">(</span><span class="ident" id="4665153">x1</span><span class="op" id="4665155">,</span>&nbsp;<span class="ident" id="4665157">y1</span><span class="op" id="4665159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665162">z2</span>&nbsp;<span class="op" id="4665165">:=</span>&nbsp;<span class="ident" id="4665168">zForAffine</span><span class="op" id="4665178">(</span><span class="ident" id="4665179">x2</span><span class="op" id="4665181">,</span>&nbsp;<span class="ident" id="4665183">y2</span><span class="op" id="4665185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665188">return</span>&nbsp;<span class="ident" id="4665195">curve</span><span class="op" id="4665200">.</span><span class="ident" id="4665201">affineFromJacobian</span><span class="op" id="4665219">(</span><span class="ident" id="4665220">curve</span><span class="op" id="4665225">.</span><span class="ident" id="4665226">addJacobian</span><span class="op" id="4665237">(</span><span class="ident" id="4665238">x1</span><span class="op" id="4665240">,</span>&nbsp;<span class="ident" id="4665242">y1</span><span class="op" id="4665244">,</span>&nbsp;<span class="ident" id="4665246">z1</span><span class="op" id="4665248">,</span>&nbsp;<span class="ident" id="4665250">x2</span><span class="op" id="4665252">,</span>&nbsp;<span class="ident" id="4665254">y2</span><span class="op" id="4665256">,</span>&nbsp;<span class="ident" id="4665258">z2</span><span class="op" id="4665260">)</span><span class="op" id="4665261">)</span><br>
<span class="lineno">105</span><span class="op" id="4665263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4665266">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4665340">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4665402">func</span>&nbsp;<span class="op" id="4665407">(</span><span class="ident" id="4665408">curve</span>&nbsp;<span class="op" id="4665414">*</span><span class="ident" id="4665415">CurveParams</span><span class="op" id="4665426">)</span>&nbsp;<span class="ident" id="4665428">addJacobian</span><span class="op" id="4665439">(</span><span class="ident" id="4665440">x1</span><span class="op" id="4665442">,</span>&nbsp;<span class="ident" id="4665444">y1</span><span class="op" id="4665446">,</span>&nbsp;<span class="ident" id="4665448">z1</span><span class="op" id="4665450">,</span>&nbsp;<span class="ident" id="4665452">x2</span><span class="op" id="4665454">,</span>&nbsp;<span class="ident" id="4665456">y2</span><span class="op" id="4665458">,</span>&nbsp;<span class="ident" id="4665460">z2</span>&nbsp;<span class="op" id="4665463">*</span><span class="ident" id="4665464">big</span><span class="op" id="4665467">.</span><span class="ident" id="4665468">Int</span><span class="op" id="4665471">)</span>&nbsp;<span class="op" id="4665473">(</span><span class="op" id="4665474">*</span><span class="ident" id="4665475">big</span><span class="op" id="4665478">.</span><span class="ident" id="4665479">Int</span><span class="op" id="4665482">,</span>&nbsp;<span class="op" id="4665484">*</span><span class="ident" id="4665485">big</span><span class="op" id="4665488">.</span><span class="ident" id="4665489">Int</span><span class="op" id="4665492">,</span>&nbsp;<span class="op" id="4665494">*</span><span class="ident" id="4665495">big</span><span class="op" id="4665498">.</span><span class="ident" id="4665499">Int</span><span class="op" id="4665502">)</span>&nbsp;<span class="op" id="4665504">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665507">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665597">x3</span><span class="op" id="4665599">,</span>&nbsp;<span class="ident" id="4665601">y3</span><span class="op" id="4665603">,</span>&nbsp;<span class="ident" id="4665605">z3</span>&nbsp;<span class="op" id="4665608">:=</span>&nbsp;<span class="builtinfunc" id="4665611">new</span><span class="op" id="4665614">(</span><span class="ident" id="4665615">big</span><span class="op" id="4665618">.</span><span class="ident" id="4665619">Int</span><span class="op" id="4665622">)</span><span class="op" id="4665623">,</span>&nbsp;<span class="builtinfunc" id="4665625">new</span><span class="op" id="4665628">(</span><span class="ident" id="4665629">big</span><span class="op" id="4665632">.</span><span class="ident" id="4665633">Int</span><span class="op" id="4665636">)</span><span class="op" id="4665637">,</span>&nbsp;<span class="builtinfunc" id="4665639">new</span><span class="op" id="4665642">(</span><span class="ident" id="4665643">big</span><span class="op" id="4665646">.</span><span class="ident" id="4665647">Int</span><span class="op" id="4665650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665653">if</span>&nbsp;<span class="ident" id="4665656">z1</span><span class="op" id="4665658">.</span><span class="ident" id="4665659">Sign</span><span class="op" id="4665663">(</span><span class="op" id="4665664">)</span>&nbsp;<span class="op" id="4665666">==</span>&nbsp;<span class="num" id="4665669">0</span>&nbsp;<span class="op" id="4665671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665675">x3</span><span class="op" id="4665677">.</span><span class="ident" id="4665678">Set</span><span class="op" id="4665681">(</span><span class="ident" id="4665682">x2</span><span class="op" id="4665684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665688">y3</span><span class="op" id="4665690">.</span><span class="ident" id="4665691">Set</span><span class="op" id="4665694">(</span><span class="ident" id="4665695">y2</span><span class="op" id="4665697">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665701">z3</span><span class="op" id="4665703">.</span><span class="ident" id="4665704">Set</span><span class="op" id="4665707">(</span><span class="ident" id="4665708">z2</span><span class="op" id="4665710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665714">return</span>&nbsp;<span class="ident" id="4665721">x3</span><span class="op" id="4665723">,</span>&nbsp;<span class="ident" id="4665725">y3</span><span class="op" id="4665727">,</span>&nbsp;<span class="ident" id="4665729">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4665733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665736">if</span>&nbsp;<span class="ident" id="4665739">z2</span><span class="op" id="4665741">.</span><span class="ident" id="4665742">Sign</span><span class="op" id="4665746">(</span><span class="op" id="4665747">)</span>&nbsp;<span class="op" id="4665749">==</span>&nbsp;<span class="num" id="4665752">0</span>&nbsp;<span class="op" id="4665754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665758">x3</span><span class="op" id="4665760">.</span><span class="ident" id="4665761">Set</span><span class="op" id="4665764">(</span><span class="ident" id="4665765">x1</span><span class="op" id="4665767">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665771">y3</span><span class="op" id="4665773">.</span><span class="ident" id="4665774">Set</span><span class="op" id="4665777">(</span><span class="ident" id="4665778">y1</span><span class="op" id="4665780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665784">z3</span><span class="op" id="4665786">.</span><span class="ident" id="4665787">Set</span><span class="op" id="4665790">(</span><span class="ident" id="4665791">z1</span><span class="op" id="4665793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665797">return</span>&nbsp;<span class="ident" id="4665804">x3</span><span class="op" id="4665806">,</span>&nbsp;<span class="ident" id="4665808">y3</span><span class="op" id="4665810">,</span>&nbsp;<span class="ident" id="4665812">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4665816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665820">z1z1</span>&nbsp;<span class="op" id="4665825">:=</span>&nbsp;<span class="builtinfunc" id="4665828">new</span><span class="op" id="4665831">(</span><span class="ident" id="4665832">big</span><span class="op" id="4665835">.</span><span class="ident" id="4665836">Int</span><span class="op" id="4665839">)</span><span class="op" id="4665840">.</span><span class="ident" id="4665841">Mul</span><span class="op" id="4665844">(</span><span class="ident" id="4665845">z1</span><span class="op" id="4665847">,</span>&nbsp;<span class="ident" id="4665849">z1</span><span class="op" id="4665851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665854">z1z1</span><span class="op" id="4665858">.</span><span class="ident" id="4665859">Mod</span><span class="op" id="4665862">(</span><span class="ident" id="4665863">z1z1</span><span class="op" id="4665867">,</span>&nbsp;<span class="ident" id="4665869">curve</span><span class="op" id="4665874">.</span><span class="ident" id="4665875">P</span><span class="op" id="4665876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665879">z2z2</span>&nbsp;<span class="op" id="4665884">:=</span>&nbsp;<span class="builtinfunc" id="4665887">new</span><span class="op" id="4665890">(</span><span class="ident" id="4665891">big</span><span class="op" id="4665894">.</span><span class="ident" id="4665895">Int</span><span class="op" id="4665898">)</span><span class="op" id="4665899">.</span><span class="ident" id="4665900">Mul</span><span class="op" id="4665903">(</span><span class="ident" id="4665904">z2</span><span class="op" id="4665906">,</span>&nbsp;<span class="ident" id="4665908">z2</span><span class="op" id="4665910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665913">z2z2</span><span class="op" id="4665917">.</span><span class="ident" id="4665918">Mod</span><span class="op" id="4665921">(</span><span class="ident" id="4665922">z2z2</span><span class="op" id="4665926">,</span>&nbsp;<span class="ident" id="4665928">curve</span><span class="op" id="4665933">.</span><span class="ident" id="4665934">P</span><span class="op" id="4665935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665939">u1</span>&nbsp;<span class="op" id="4665942">:=</span>&nbsp;<span class="builtinfunc" id="4665945">new</span><span class="op" id="4665948">(</span><span class="ident" id="4665949">big</span><span class="op" id="4665952">.</span><span class="ident" id="4665953">Int</span><span class="op" id="4665956">)</span><span class="op" id="4665957">.</span><span class="ident" id="4665958">Mul</span><span class="op" id="4665961">(</span><span class="ident" id="4665962">x1</span><span class="op" id="4665964">,</span>&nbsp;<span class="ident" id="4665966">z2z2</span><span class="op" id="4665970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665973">u1</span><span class="op" id="4665975">.</span><span class="ident" id="4665976">Mod</span><span class="op" id="4665979">(</span><span class="ident" id="4665980">u1</span><span class="op" id="4665982">,</span>&nbsp;<span class="ident" id="4665984">curve</span><span class="op" id="4665989">.</span><span class="ident" id="4665990">P</span><span class="op" id="4665991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665994">u2</span>&nbsp;<span class="op" id="4665997">:=</span>&nbsp;<span class="builtinfunc" id="4666000">new</span><span class="op" id="4666003">(</span><span class="ident" id="4666004">big</span><span class="op" id="4666007">.</span><span class="ident" id="4666008">Int</span><span class="op" id="4666011">)</span><span class="op" id="4666012">.</span><span class="ident" id="4666013">Mul</span><span class="op" id="4666016">(</span><span class="ident" id="4666017">x2</span><span class="op" id="4666019">,</span>&nbsp;<span class="ident" id="4666021">z1z1</span><span class="op" id="4666025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666028">u2</span><span class="op" id="4666030">.</span><span class="ident" id="4666031">Mod</span><span class="op" id="4666034">(</span><span class="ident" id="4666035">u2</span><span class="op" id="4666037">,</span>&nbsp;<span class="ident" id="4666039">curve</span><span class="op" id="4666044">.</span><span class="ident" id="4666045">P</span><span class="op" id="4666046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666049">h</span>&nbsp;<span class="op" id="4666051">:=</span>&nbsp;<span class="builtinfunc" id="4666054">new</span><span class="op" id="4666057">(</span><span class="ident" id="4666058">big</span><span class="op" id="4666061">.</span><span class="ident" id="4666062">Int</span><span class="op" id="4666065">)</span><span class="op" id="4666066">.</span><span class="ident" id="4666067">Sub</span><span class="op" id="4666070">(</span><span class="ident" id="4666071">u2</span><span class="op" id="4666073">,</span>&nbsp;<span class="ident" id="4666075">u1</span><span class="op" id="4666077">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666080">xEqual</span>&nbsp;<span class="op" id="4666087">:=</span>&nbsp;<span class="ident" id="4666090">h</span><span class="op" id="4666091">.</span><span class="ident" id="4666092">Sign</span><span class="op" id="4666096">(</span><span class="op" id="4666097">)</span>&nbsp;<span class="op" id="4666099">==</span>&nbsp;<span class="num" id="4666102">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666105">if</span>&nbsp;<span class="ident" id="4666108">h</span><span class="op" id="4666109">.</span><span class="ident" id="4666110">Sign</span><span class="op" id="4666114">(</span><span class="op" id="4666115">)</span>&nbsp;<span class="op" id="4666117">==</span>&nbsp;<span class="op" id="4666120">-</span><span class="num" id="4666121">1</span>&nbsp;<span class="op" id="4666123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666127">h</span><span class="op" id="4666128">.</span><span class="ident" id="4666129">Add</span><span class="op" id="4666132">(</span><span class="ident" id="4666133">h</span><span class="op" id="4666134">,</span>&nbsp;<span class="ident" id="4666136">curve</span><span class="op" id="4666141">.</span><span class="ident" id="4666142">P</span><span class="op" id="4666143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666149">i</span>&nbsp;<span class="op" id="4666151">:=</span>&nbsp;<span class="builtinfunc" id="4666154">new</span><span class="op" id="4666157">(</span><span class="ident" id="4666158">big</span><span class="op" id="4666161">.</span><span class="ident" id="4666162">Int</span><span class="op" id="4666165">)</span><span class="op" id="4666166">.</span><span class="ident" id="4666167">Lsh</span><span class="op" id="4666170">(</span><span class="ident" id="4666171">h</span><span class="op" id="4666172">,</span>&nbsp;<span class="num" id="4666174">1</span><span class="op" id="4666175">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666178">i</span><span class="op" id="4666179">.</span><span class="ident" id="4666180">Mul</span><span class="op" id="4666183">(</span><span class="ident" id="4666184">i</span><span class="op" id="4666185">,</span>&nbsp;<span class="ident" id="4666187">i</span><span class="op" id="4666188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666191">j</span>&nbsp;<span class="op" id="4666193">:=</span>&nbsp;<span class="builtinfunc" id="4666196">new</span><span class="op" id="4666199">(</span><span class="ident" id="4666200">big</span><span class="op" id="4666203">.</span><span class="ident" id="4666204">Int</span><span class="op" id="4666207">)</span><span class="op" id="4666208">.</span><span class="ident" id="4666209">Mul</span><span class="op" id="4666212">(</span><span class="ident" id="4666213">h</span><span class="op" id="4666214">,</span>&nbsp;<span class="ident" id="4666216">i</span><span class="op" id="4666217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666221">s1</span>&nbsp;<span class="op" id="4666224">:=</span>&nbsp;<span class="builtinfunc" id="4666227">new</span><span class="op" id="4666230">(</span><span class="ident" id="4666231">big</span><span class="op" id="4666234">.</span><span class="ident" id="4666235">Int</span><span class="op" id="4666238">)</span><span class="op" id="4666239">.</span><span class="ident" id="4666240">Mul</span><span class="op" id="4666243">(</span><span class="ident" id="4666244">y1</span><span class="op" id="4666246">,</span>&nbsp;<span class="ident" id="4666248">z2</span><span class="op" id="4666250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666253">s1</span><span class="op" id="4666255">.</span><span class="ident" id="4666256">Mul</span><span class="op" id="4666259">(</span><span class="ident" id="4666260">s1</span><span class="op" id="4666262">,</span>&nbsp;<span class="ident" id="4666264">z2z2</span><span class="op" id="4666268">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666271">s1</span><span class="op" id="4666273">.</span><span class="ident" id="4666274">Mod</span><span class="op" id="4666277">(</span><span class="ident" id="4666278">s1</span><span class="op" id="4666280">,</span>&nbsp;<span class="ident" id="4666282">curve</span><span class="op" id="4666287">.</span><span class="ident" id="4666288">P</span><span class="op" id="4666289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666292">s2</span>&nbsp;<span class="op" id="4666295">:=</span>&nbsp;<span class="builtinfunc" id="4666298">new</span><span class="op" id="4666301">(</span><span class="ident" id="4666302">big</span><span class="op" id="4666305">.</span><span class="ident" id="4666306">Int</span><span class="op" id="4666309">)</span><span class="op" id="4666310">.</span><span class="ident" id="4666311">Mul</span><span class="op" id="4666314">(</span><span class="ident" id="4666315">y2</span><span class="op" id="4666317">,</span>&nbsp;<span class="ident" id="4666319">z1</span><span class="op" id="4666321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666324">s2</span><span class="op" id="4666326">.</span><span class="ident" id="4666327">Mul</span><span class="op" id="4666330">(</span><span class="ident" id="4666331">s2</span><span class="op" id="4666333">,</span>&nbsp;<span class="ident" id="4666335">z1z1</span><span class="op" id="4666339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666342">s2</span><span class="op" id="4666344">.</span><span class="ident" id="4666345">Mod</span><span class="op" id="4666348">(</span><span class="ident" id="4666349">s2</span><span class="op" id="4666351">,</span>&nbsp;<span class="ident" id="4666353">curve</span><span class="op" id="4666358">.</span><span class="ident" id="4666359">P</span><span class="op" id="4666360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666363">r</span>&nbsp;<span class="op" id="4666365">:=</span>&nbsp;<span class="builtinfunc" id="4666368">new</span><span class="op" id="4666371">(</span><span class="ident" id="4666372">big</span><span class="op" id="4666375">.</span><span class="ident" id="4666376">Int</span><span class="op" id="4666379">)</span><span class="op" id="4666380">.</span><span class="ident" id="4666381">Sub</span><span class="op" id="4666384">(</span><span class="ident" id="4666385">s2</span><span class="op" id="4666387">,</span>&nbsp;<span class="ident" id="4666389">s1</span><span class="op" id="4666391">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666394">if</span>&nbsp;<span class="ident" id="4666397">r</span><span class="op" id="4666398">.</span><span class="ident" id="4666399">Sign</span><span class="op" id="4666403">(</span><span class="op" id="4666404">)</span>&nbsp;<span class="op" id="4666406">==</span>&nbsp;<span class="op" id="4666409">-</span><span class="num" id="4666410">1</span>&nbsp;<span class="op" id="4666412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666416">r</span><span class="op" id="4666417">.</span><span class="ident" id="4666418">Add</span><span class="op" id="4666421">(</span><span class="ident" id="4666422">r</span><span class="op" id="4666423">,</span>&nbsp;<span class="ident" id="4666425">curve</span><span class="op" id="4666430">.</span><span class="ident" id="4666431">P</span><span class="op" id="4666432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666438">yEqual</span>&nbsp;<span class="op" id="4666445">:=</span>&nbsp;<span class="ident" id="4666448">r</span><span class="op" id="4666449">.</span><span class="ident" id="4666450">Sign</span><span class="op" id="4666454">(</span><span class="op" id="4666455">)</span>&nbsp;<span class="op" id="4666457">==</span>&nbsp;<span class="num" id="4666460">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666463">if</span>&nbsp;<span class="ident" id="4666466">xEqual</span>&nbsp;<span class="op" id="4666473">&amp;&amp;</span>&nbsp;<span class="ident" id="4666476">yEqual</span>&nbsp;<span class="op" id="4666483">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666487">return</span>&nbsp;<span class="ident" id="4666494">curve</span><span class="op" id="4666499">.</span><span class="ident" id="4666500">doubleJacobian</span><span class="op" id="4666514">(</span><span class="ident" id="4666515">x1</span><span class="op" id="4666517">,</span>&nbsp;<span class="ident" id="4666519">y1</span><span class="op" id="4666521">,</span>&nbsp;<span class="ident" id="4666523">z1</span><span class="op" id="4666525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666531">r</span><span class="op" id="4666532">.</span><span class="ident" id="4666533">Lsh</span><span class="op" id="4666536">(</span><span class="ident" id="4666537">r</span><span class="op" id="4666538">,</span>&nbsp;<span class="num" id="4666540">1</span><span class="op" id="4666541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666544">v</span>&nbsp;<span class="op" id="4666546">:=</span>&nbsp;<span class="builtinfunc" id="4666549">new</span><span class="op" id="4666552">(</span><span class="ident" id="4666553">big</span><span class="op" id="4666556">.</span><span class="ident" id="4666557">Int</span><span class="op" id="4666560">)</span><span class="op" id="4666561">.</span><span class="ident" id="4666562">Mul</span><span class="op" id="4666565">(</span><span class="ident" id="4666566">u1</span><span class="op" id="4666568">,</span>&nbsp;<span class="ident" id="4666570">i</span><span class="op" id="4666571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666575">x3</span><span class="op" id="4666577">.</span><span class="ident" id="4666578">Set</span><span class="op" id="4666581">(</span><span class="ident" id="4666582">r</span><span class="op" id="4666583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666586">x3</span><span class="op" id="4666588">.</span><span class="ident" id="4666589">Mul</span><span class="op" id="4666592">(</span><span class="ident" id="4666593">x3</span><span class="op" id="4666595">,</span>&nbsp;<span class="ident" id="4666597">x3</span><span class="op" id="4666599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666602">x3</span><span class="op" id="4666604">.</span><span class="ident" id="4666605">Sub</span><span class="op" id="4666608">(</span><span class="ident" id="4666609">x3</span><span class="op" id="4666611">,</span>&nbsp;<span class="ident" id="4666613">j</span><span class="op" id="4666614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666617">x3</span><span class="op" id="4666619">.</span><span class="ident" id="4666620">Sub</span><span class="op" id="4666623">(</span><span class="ident" id="4666624">x3</span><span class="op" id="4666626">,</span>&nbsp;<span class="ident" id="4666628">v</span><span class="op" id="4666629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666632">x3</span><span class="op" id="4666634">.</span><span class="ident" id="4666635">Sub</span><span class="op" id="4666638">(</span><span class="ident" id="4666639">x3</span><span class="op" id="4666641">,</span>&nbsp;<span class="ident" id="4666643">v</span><span class="op" id="4666644">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666647">x3</span><span class="op" id="4666649">.</span><span class="ident" id="4666650">Mod</span><span class="op" id="4666653">(</span><span class="ident" id="4666654">x3</span><span class="op" id="4666656">,</span>&nbsp;<span class="ident" id="4666658">curve</span><span class="op" id="4666663">.</span><span class="ident" id="4666664">P</span><span class="op" id="4666665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666669">y3</span><span class="op" id="4666671">.</span><span class="ident" id="4666672">Set</span><span class="op" id="4666675">(</span><span class="ident" id="4666676">r</span><span class="op" id="4666677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666680">v</span><span class="op" id="4666681">.</span><span class="ident" id="4666682">Sub</span><span class="op" id="4666685">(</span><span class="ident" id="4666686">v</span><span class="op" id="4666687">,</span>&nbsp;<span class="ident" id="4666689">x3</span><span class="op" id="4666691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666694">y3</span><span class="op" id="4666696">.</span><span class="ident" id="4666697">Mul</span><span class="op" id="4666700">(</span><span class="ident" id="4666701">y3</span><span class="op" id="4666703">,</span>&nbsp;<span class="ident" id="4666705">v</span><span class="op" id="4666706">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666709">s1</span><span class="op" id="4666711">.</span><span class="ident" id="4666712">Mul</span><span class="op" id="4666715">(</span><span class="ident" id="4666716">s1</span><span class="op" id="4666718">,</span>&nbsp;<span class="ident" id="4666720">j</span><span class="op" id="4666721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666724">s1</span><span class="op" id="4666726">.</span><span class="ident" id="4666727">Lsh</span><span class="op" id="4666730">(</span><span class="ident" id="4666731">s1</span><span class="op" id="4666733">,</span>&nbsp;<span class="num" id="4666735">1</span><span class="op" id="4666736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666739">y3</span><span class="op" id="4666741">.</span><span class="ident" id="4666742">Sub</span><span class="op" id="4666745">(</span><span class="ident" id="4666746">y3</span><span class="op" id="4666748">,</span>&nbsp;<span class="ident" id="4666750">s1</span><span class="op" id="4666752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666755">y3</span><span class="op" id="4666757">.</span><span class="ident" id="4666758">Mod</span><span class="op" id="4666761">(</span><span class="ident" id="4666762">y3</span><span class="op" id="4666764">,</span>&nbsp;<span class="ident" id="4666766">curve</span><span class="op" id="4666771">.</span><span class="ident" id="4666772">P</span><span class="op" id="4666773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666777">z3</span><span class="op" id="4666779">.</span><span class="ident" id="4666780">Add</span><span class="op" id="4666783">(</span><span class="ident" id="4666784">z1</span><span class="op" id="4666786">,</span>&nbsp;<span class="ident" id="4666788">z2</span><span class="op" id="4666790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666793">z3</span><span class="op" id="4666795">.</span><span class="ident" id="4666796">Mul</span><span class="op" id="4666799">(</span><span class="ident" id="4666800">z3</span><span class="op" id="4666802">,</span>&nbsp;<span class="ident" id="4666804">z3</span><span class="op" id="4666806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666809">z3</span><span class="op" id="4666811">.</span><span class="ident" id="4666812">Sub</span><span class="op" id="4666815">(</span><span class="ident" id="4666816">z3</span><span class="op" id="4666818">,</span>&nbsp;<span class="ident" id="4666820">z1z1</span><span class="op" id="4666824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666827">z3</span><span class="op" id="4666829">.</span><span class="ident" id="4666830">Sub</span><span class="op" id="4666833">(</span><span class="ident" id="4666834">z3</span><span class="op" id="4666836">,</span>&nbsp;<span class="ident" id="4666838">z2z2</span><span class="op" id="4666842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666845">z3</span><span class="op" id="4666847">.</span><span class="ident" id="4666848">Mul</span><span class="op" id="4666851">(</span><span class="ident" id="4666852">z3</span><span class="op" id="4666854">,</span>&nbsp;<span class="ident" id="4666856">h</span><span class="op" id="4666857">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666860">z3</span><span class="op" id="4666862">.</span><span class="ident" id="4666863">Mod</span><span class="op" id="4666866">(</span><span class="ident" id="4666867">z3</span><span class="op" id="4666869">,</span>&nbsp;<span class="ident" id="4666871">curve</span><span class="op" id="4666876">.</span><span class="ident" id="4666877">P</span><span class="op" id="4666878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666882">return</span>&nbsp;<span class="ident" id="4666889">x3</span><span class="op" id="4666891">,</span>&nbsp;<span class="ident" id="4666893">y3</span><span class="op" id="4666895">,</span>&nbsp;<span class="ident" id="4666897">z3</span><br>
<span class="lineno"></span><span class="op" id="4666900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4666903">func</span>&nbsp;<span class="op" id="4666908">(</span><span class="ident" id="4666909">curve</span>&nbsp;<span class="op" id="4666915">*</span><span class="ident" id="4666916">CurveParams</span><span class="op" id="4666927">)</span>&nbsp;<span class="ident" id="4666929">Double</span><span class="op" id="4666935">(</span><span class="ident" id="4666936">x1</span><span class="op" id="4666938">,</span>&nbsp;<span class="ident" id="4666940">y1</span>&nbsp;<span class="op" id="4666943">*</span><span class="ident" id="4666944">big</span><span class="op" id="4666947">.</span><span class="ident" id="4666948">Int</span><span class="op" id="4666951">)</span>&nbsp;<span class="op" id="4666953">(</span><span class="op" id="4666954">*</span><span class="ident" id="4666955">big</span><span class="op" id="4666958">.</span><span class="ident" id="4666959">Int</span><span class="op" id="4666962">,</span>&nbsp;<span class="op" id="4666964">*</span><span class="ident" id="4666965">big</span><span class="op" id="4666968">.</span><span class="ident" id="4666969">Int</span><span class="op" id="4666972">)</span>&nbsp;<span class="op" id="4666974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666977">z1</span>&nbsp;<span class="op" id="4666980">:=</span>&nbsp;<span class="ident" id="4666983">zForAffine</span><span class="op" id="4666993">(</span><span class="ident" id="4666994">x1</span><span class="op" id="4666996">,</span>&nbsp;<span class="ident" id="4666998">y1</span><span class="op" id="4667000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667003">return</span>&nbsp;<span class="ident" id="4667010">curve</span><span class="op" id="4667015">.</span><span class="ident" id="4667016">affineFromJacobian</span><span class="op" id="4667034">(</span><span class="ident" id="4667035">curve</span><span class="op" id="4667040">.</span><span class="ident" id="4667041">doubleJacobian</span><span class="op" id="4667055">(</span><span class="ident" id="4667056">x1</span><span class="op" id="4667058">,</span>&nbsp;<span class="ident" id="4667060">y1</span><span class="op" id="4667062">,</span>&nbsp;<span class="ident" id="4667064">z1</span><span class="op" id="4667066">)</span><span class="op" id="4667067">)</span><br>
<span class="lineno"></span><span class="op" id="4667069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4667072">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4667144">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4667190">func</span>&nbsp;<span class="op" id="4667195">(</span><span class="ident" id="4667196">curve</span>&nbsp;<span class="op" id="4667202">*</span><span class="ident" id="4667203">CurveParams</span><span class="op" id="4667214">)</span>&nbsp;<span class="ident" id="4667216">doubleJacobian</span><span class="op" id="4667230">(</span><span class="ident" id="4667231">x</span><span class="op" id="4667232">,</span>&nbsp;<span class="ident" id="4667234">y</span><span class="op" id="4667235">,</span>&nbsp;<span class="ident" id="4667237">z</span>&nbsp;<span class="op" id="4667239">*</span><span class="ident" id="4667240">big</span><span class="op" id="4667243">.</span><span class="ident" id="4667244">Int</span><span class="op" id="4667247">)</span>&nbsp;<span class="op" id="4667249">(</span><span class="op" id="4667250">*</span><span class="ident" id="4667251">big</span><span class="op" id="4667254">.</span><span class="ident" id="4667255">Int</span><span class="op" id="4667258">,</span>&nbsp;<span class="op" id="4667260">*</span><span class="ident" id="4667261">big</span><span class="op" id="4667264">.</span><span class="ident" id="4667265">Int</span><span class="op" id="4667268">,</span>&nbsp;<span class="op" id="4667270">*</span><span class="ident" id="4667271">big</span><span class="op" id="4667274">.</span><span class="ident" id="4667275">Int</span><span class="op" id="4667278">)</span>&nbsp;<span class="op" id="4667280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4667283">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667372">delta</span>&nbsp;<span class="op" id="4667378">:=</span>&nbsp;<span class="builtinfunc" id="4667381">new</span><span class="op" id="4667384">(</span><span class="ident" id="4667385">big</span><span class="op" id="4667388">.</span><span class="ident" id="4667389">Int</span><span class="op" id="4667392">)</span><span class="op" id="4667393">.</span><span class="ident" id="4667394">Mul</span><span class="op" id="4667397">(</span><span class="ident" id="4667398">z</span><span class="op" id="4667399">,</span>&nbsp;<span class="ident" id="4667401">z</span><span class="op" id="4667402">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667405">delta</span><span class="op" id="4667410">.</span><span class="ident" id="4667411">Mod</span><span class="op" id="4667414">(</span><span class="ident" id="4667415">delta</span><span class="op" id="4667420">,</span>&nbsp;<span class="ident" id="4667422">curve</span><span class="op" id="4667427">.</span><span class="ident" id="4667428">P</span><span class="op" id="4667429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667432">gamma</span>&nbsp;<span class="op" id="4667438">:=</span>&nbsp;<span class="builtinfunc" id="4667441">new</span><span class="op" id="4667444">(</span><span class="ident" id="4667445">big</span><span class="op" id="4667448">.</span><span class="ident" id="4667449">Int</span><span class="op" id="4667452">)</span><span class="op" id="4667453">.</span><span class="ident" id="4667454">Mul</span><span class="op" id="4667457">(</span><span class="ident" id="4667458">y</span><span class="op" id="4667459">,</span>&nbsp;<span class="ident" id="4667461">y</span><span class="op" id="4667462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667465">gamma</span><span class="op" id="4667470">.</span><span class="ident" id="4667471">Mod</span><span class="op" id="4667474">(</span><span class="ident" id="4667475">gamma</span><span class="op" id="4667480">,</span>&nbsp;<span class="ident" id="4667482">curve</span><span class="op" id="4667487">.</span><span class="ident" id="4667488">P</span><span class="op" id="4667489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667492">alpha</span>&nbsp;<span class="op" id="4667498">:=</span>&nbsp;<span class="builtinfunc" id="4667501">new</span><span class="op" id="4667504">(</span><span class="ident" id="4667505">big</span><span class="op" id="4667508">.</span><span class="ident" id="4667509">Int</span><span class="op" id="4667512">)</span><span class="op" id="4667513">.</span><span class="ident" id="4667514">Sub</span><span class="op" id="4667517">(</span><span class="ident" id="4667518">x</span><span class="op" id="4667519">,</span>&nbsp;<span class="ident" id="4667521">delta</span><span class="op" id="4667526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667529">if</span>&nbsp;<span class="ident" id="4667532">alpha</span><span class="op" id="4667537">.</span><span class="ident" id="4667538">Sign</span><span class="op" id="4667542">(</span><span class="op" id="4667543">)</span>&nbsp;<span class="op" id="4667545">==</span>&nbsp;<span class="op" id="4667548">-</span><span class="num" id="4667549">1</span>&nbsp;<span class="op" id="4667551">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667555">alpha</span><span class="op" id="4667560">.</span><span class="ident" id="4667561">Add</span><span class="op" id="4667564">(</span><span class="ident" id="4667565">alpha</span><span class="op" id="4667570">,</span>&nbsp;<span class="ident" id="4667572">curve</span><span class="op" id="4667577">.</span><span class="ident" id="4667578">P</span><span class="op" id="4667579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667585">alpha2</span>&nbsp;<span class="op" id="4667592">:=</span>&nbsp;<span class="builtinfunc" id="4667595">new</span><span class="op" id="4667598">(</span><span class="ident" id="4667599">big</span><span class="op" id="4667602">.</span><span class="ident" id="4667603">Int</span><span class="op" id="4667606">)</span><span class="op" id="4667607">.</span><span class="ident" id="4667608">Add</span><span class="op" id="4667611">(</span><span class="ident" id="4667612">x</span><span class="op" id="4667613">,</span>&nbsp;<span class="ident" id="4667615">delta</span><span class="op" id="4667620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667623">alpha</span><span class="op" id="4667628">.</span><span class="ident" id="4667629">Mul</span><span class="op" id="4667632">(</span><span class="ident" id="4667633">alpha</span><span class="op" id="4667638">,</span>&nbsp;<span class="ident" id="4667640">alpha2</span><span class="op" id="4667646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667649">alpha2</span><span class="op" id="4667655">.</span><span class="ident" id="4667656">Set</span><span class="op" id="4667659">(</span><span class="ident" id="4667660">alpha</span><span class="op" id="4667665">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667668">alpha</span><span class="op" id="4667673">.</span><span class="ident" id="4667674">Lsh</span><span class="op" id="4667677">(</span><span class="ident" id="4667678">alpha</span><span class="op" id="4667683">,</span>&nbsp;<span class="num" id="4667685">1</span><span class="op" id="4667686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667689">alpha</span><span class="op" id="4667694">.</span><span class="ident" id="4667695">Add</span><span class="op" id="4667698">(</span><span class="ident" id="4667699">alpha</span><span class="op" id="4667704">,</span>&nbsp;<span class="ident" id="4667706">alpha2</span><span class="op" id="4667712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667716">beta</span>&nbsp;<span class="op" id="4667721">:=</span>&nbsp;<span class="ident" id="4667724">alpha2</span><span class="op" id="4667730">.</span><span class="ident" id="4667731">Mul</span><span class="op" id="4667734">(</span><span class="ident" id="4667735">x</span><span class="op" id="4667736">,</span>&nbsp;<span class="ident" id="4667738">gamma</span><span class="op" id="4667743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667747">x3</span>&nbsp;<span class="op" id="4667750">:=</span>&nbsp;<span class="builtinfunc" id="4667753">new</span><span class="op" id="4667756">(</span><span class="ident" id="4667757">big</span><span class="op" id="4667760">.</span><span class="ident" id="4667761">Int</span><span class="op" id="4667764">)</span><span class="op" id="4667765">.</span><span class="ident" id="4667766">Mul</span><span class="op" id="4667769">(</span><span class="ident" id="4667770">alpha</span><span class="op" id="4667775">,</span>&nbsp;<span class="ident" id="4667777">alpha</span><span class="op" id="4667782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667785">beta8</span>&nbsp;<span class="op" id="4667791">:=</span>&nbsp;<span class="builtinfunc" id="4667794">new</span><span class="op" id="4667797">(</span><span class="ident" id="4667798">big</span><span class="op" id="4667801">.</span><span class="ident" id="4667802">Int</span><span class="op" id="4667805">)</span><span class="op" id="4667806">.</span><span class="ident" id="4667807">Lsh</span><span class="op" id="4667810">(</span><span class="ident" id="4667811">beta</span><span class="op" id="4667815">,</span>&nbsp;<span class="num" id="4667817">3</span><span class="op" id="4667818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667821">x3</span><span class="op" id="4667823">.</span><span class="ident" id="4667824">Sub</span><span class="op" id="4667827">(</span><span class="ident" id="4667828">x3</span><span class="op" id="4667830">,</span>&nbsp;<span class="ident" id="4667832">beta8</span><span class="op" id="4667837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667840">for</span>&nbsp;<span class="ident" id="4667844">x3</span><span class="op" id="4667846">.</span><span class="ident" id="4667847">Sign</span><span class="op" id="4667851">(</span><span class="op" id="4667852">)</span>&nbsp;<span class="op" id="4667854">==</span>&nbsp;<span class="op" id="4667857">-</span><span class="num" id="4667858">1</span>&nbsp;<span class="op" id="4667860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667864">x3</span><span class="op" id="4667866">.</span><span class="ident" id="4667867">Add</span><span class="op" id="4667870">(</span><span class="ident" id="4667871">x3</span><span class="op" id="4667873">,</span>&nbsp;<span class="ident" id="4667875">curve</span><span class="op" id="4667880">.</span><span class="ident" id="4667881">P</span><span class="op" id="4667882">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667888">x3</span><span class="op" id="4667890">.</span><span class="ident" id="4667891">Mod</span><span class="op" id="4667894">(</span><span class="ident" id="4667895">x3</span><span class="op" id="4667897">,</span>&nbsp;<span class="ident" id="4667899">curve</span><span class="op" id="4667904">.</span><span class="ident" id="4667905">P</span><span class="op" id="4667906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667910">z3</span>&nbsp;<span class="op" id="4667913">:=</span>&nbsp;<span class="builtinfunc" id="4667916">new</span><span class="op" id="4667919">(</span><span class="ident" id="4667920">big</span><span class="op" id="4667923">.</span><span class="ident" id="4667924">Int</span><span class="op" id="4667927">)</span><span class="op" id="4667928">.</span><span class="ident" id="4667929">Add</span><span class="op" id="4667932">(</span><span class="ident" id="4667933">y</span><span class="op" id="4667934">,</span>&nbsp;<span class="ident" id="4667936">z</span><span class="op" id="4667937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667940">z3</span><span class="op" id="4667942">.</span><span class="ident" id="4667943">Mul</span><span class="op" id="4667946">(</span><span class="ident" id="4667947">z3</span><span class="op" id="4667949">,</span>&nbsp;<span class="ident" id="4667951">z3</span><span class="op" id="4667953">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667956">z3</span><span class="op" id="4667958">.</span><span class="ident" id="4667959">Sub</span><span class="op" id="4667962">(</span><span class="ident" id="4667963">z3</span><span class="op" id="4667965">,</span>&nbsp;<span class="ident" id="4667967">gamma</span><span class="op" id="4667972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667975">if</span>&nbsp;<span class="ident" id="4667978">z3</span><span class="op" id="4667980">.</span><span class="ident" id="4667981">Sign</span><span class="op" id="4667985">(</span><span class="op" id="4667986">)</span>&nbsp;<span class="op" id="4667988">==</span>&nbsp;<span class="op" id="4667991">-</span><span class="num" id="4667992">1</span>&nbsp;<span class="op" id="4667994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667998">z3</span><span class="op" id="4668000">.</span><span class="ident" id="4668001">Add</span><span class="op" id="4668004">(</span><span class="ident" id="4668005">z3</span><span class="op" id="4668007">,</span>&nbsp;<span class="ident" id="4668009">curve</span><span class="op" id="4668014">.</span><span class="ident" id="4668015">P</span><span class="op" id="4668016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668022">z3</span><span class="op" id="4668024">.</span><span class="ident" id="4668025">Sub</span><span class="op" id="4668028">(</span><span class="ident" id="4668029">z3</span><span class="op" id="4668031">,</span>&nbsp;<span class="ident" id="4668033">delta</span><span class="op" id="4668038">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668041">if</span>&nbsp;<span class="ident" id="4668044">z3</span><span class="op" id="4668046">.</span><span class="ident" id="4668047">Sign</span><span class="op" id="4668051">(</span><span class="op" id="4668052">)</span>&nbsp;<span class="op" id="4668054">==</span>&nbsp;<span class="op" id="4668057">-</span><span class="num" id="4668058">1</span>&nbsp;<span class="op" id="4668060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668064">z3</span><span class="op" id="4668066">.</span><span class="ident" id="4668067">Add</span><span class="op" id="4668070">(</span><span class="ident" id="4668071">z3</span><span class="op" id="4668073">,</span>&nbsp;<span class="ident" id="4668075">curve</span><span class="op" id="4668080">.</span><span class="ident" id="4668081">P</span><span class="op" id="4668082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668088">z3</span><span class="op" id="4668090">.</span><span class="ident" id="4668091">Mod</span><span class="op" id="4668094">(</span><span class="ident" id="4668095">z3</span><span class="op" id="4668097">,</span>&nbsp;<span class="ident" id="4668099">curve</span><span class="op" id="4668104">.</span><span class="ident" id="4668105">P</span><span class="op" id="4668106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668110">beta</span><span class="op" id="4668114">.</span><span class="ident" id="4668115">Lsh</span><span class="op" id="4668118">(</span><span class="ident" id="4668119">beta</span><span class="op" id="4668123">,</span>&nbsp;<span class="num" id="4668125">2</span><span class="op" id="4668126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668129">beta</span><span class="op" id="4668133">.</span><span class="ident" id="4668134">Sub</span><span class="op" id="4668137">(</span><span class="ident" id="4668138">beta</span><span class="op" id="4668142">,</span>&nbsp;<span class="ident" id="4668144">x3</span><span class="op" id="4668146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668149">if</span>&nbsp;<span class="ident" id="4668152">beta</span><span class="op" id="4668156">.</span><span class="ident" id="4668157">Sign</span><span class="op" id="4668161">(</span><span class="op" id="4668162">)</span>&nbsp;<span class="op" id="4668164">==</span>&nbsp;<span class="op" id="4668167">-</span><span class="num" id="4668168">1</span>&nbsp;<span class="op" id="4668170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668174">beta</span><span class="op" id="4668178">.</span><span class="ident" id="4668179">Add</span><span class="op" id="4668182">(</span><span class="ident" id="4668183">beta</span><span class="op" id="4668187">,</span>&nbsp;<span class="ident" id="4668189">curve</span><span class="op" id="4668194">.</span><span class="ident" id="4668195">P</span><span class="op" id="4668196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668199">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668202">y3</span>&nbsp;<span class="op" id="4668205">:=</span>&nbsp;<span class="ident" id="4668208">alpha</span><span class="op" id="4668213">.</span><span class="ident" id="4668214">Mul</span><span class="op" id="4668217">(</span><span class="ident" id="4668218">alpha</span><span class="op" id="4668223">,</span>&nbsp;<span class="ident" id="4668225">beta</span><span class="op" id="4668229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668233">gamma</span><span class="op" id="4668238">.</span><span class="ident" id="4668239">Mul</span><span class="op" id="4668242">(</span><span class="ident" id="4668243">gamma</span><span class="op" id="4668248">,</span>&nbsp;<span class="ident" id="4668250">gamma</span><span class="op" id="4668255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668258">gamma</span><span class="op" id="4668263">.</span><span class="ident" id="4668264">Lsh</span><span class="op" id="4668267">(</span><span class="ident" id="4668268">gamma</span><span class="op" id="4668273">,</span>&nbsp;<span class="num" id="4668275">3</span><span class="op" id="4668276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668279">gamma</span><span class="op" id="4668284">.</span><span class="ident" id="4668285">Mod</span><span class="op" id="4668288">(</span><span class="ident" id="4668289">gamma</span><span class="op" id="4668294">,</span>&nbsp;<span class="ident" id="4668296">curve</span><span class="op" id="4668301">.</span><span class="ident" id="4668302">P</span><span class="op" id="4668303">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668307">y3</span><span class="op" id="4668309">.</span><span class="ident" id="4668310">Sub</span><span class="op" id="4668313">(</span><span class="ident" id="4668314">y3</span><span class="op" id="4668316">,</span>&nbsp;<span class="ident" id="4668318">gamma</span><span class="op" id="4668323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668326">if</span>&nbsp;<span class="ident" id="4668329">y3</span><span class="op" id="4668331">.</span><span class="ident" id="4668332">Sign</span><span class="op" id="4668336">(</span><span class="op" id="4668337">)</span>&nbsp;<span class="op" id="4668339">==</span>&nbsp;<span class="op" id="4668342">-</span><span class="num" id="4668343">1</span>&nbsp;<span class="op" id="4668345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668349">y3</span><span class="op" id="4668351">.</span><span class="ident" id="4668352">Add</span><span class="op" id="4668355">(</span><span class="ident" id="4668356">y3</span><span class="op" id="4668358">,</span>&nbsp;<span class="ident" id="4668360">curve</span><span class="op" id="4668365">.</span><span class="ident" id="4668366">P</span><span class="op" id="4668367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668370">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668373">y3</span><span class="op" id="4668375">.</span><span class="ident" id="4668376">Mod</span><span class="op" id="4668379">(</span><span class="ident" id="4668380">y3</span><span class="op" id="4668382">,</span>&nbsp;<span class="ident" id="4668384">curve</span><span class="op" id="4668389">.</span><span class="ident" id="4668390">P</span><span class="op" id="4668391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668395">return</span>&nbsp;<span class="ident" id="4668402">x3</span><span class="op" id="4668404">,</span>&nbsp;<span class="ident" id="4668406">y3</span><span class="op" id="4668408">,</span>&nbsp;<span class="ident" id="4668410">z3</span><br>
<span class="lineno"></span><span class="op" id="4668413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4668416">func</span>&nbsp;<span class="op" id="4668421">(</span><span class="ident" id="4668422">curve</span>&nbsp;<span class="op" id="4668428">*</span><span class="ident" id="4668429">CurveParams</span><span class="op" id="4668440">)</span>&nbsp;<span class="ident" id="4668442">ScalarMult</span><span class="op" id="4668452">(</span><span class="ident" id="4668453">Bx</span><span class="op" id="4668455">,</span>&nbsp;<span class="ident" id="4668457">By</span>&nbsp;<span class="op" id="4668460">*</span><span class="ident" id="4668461">big</span><span class="op" id="4668464">.</span><span class="ident" id="4668465">Int</span><span class="op" id="4668468">,</span>&nbsp;<span class="ident" id="4668470">k</span>&nbsp;<span class="op" id="4668472">[</span><span class="op" id="4668473">]</span><span class="builtintype" id="4668474">byte</span><span class="op" id="4668478">)</span>&nbsp;<span class="op" id="4668480">(</span><span class="op" id="4668481">*</span><span class="ident" id="4668482">big</span><span class="op" id="4668485">.</span><span class="ident" id="4668486">Int</span><span class="op" id="4668489">,</span>&nbsp;<span class="op" id="4668491">*</span><span class="ident" id="4668492">big</span><span class="op" id="4668495">.</span><span class="ident" id="4668496">Int</span><span class="op" id="4668499">)</span>&nbsp;<span class="op" id="4668501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668504">Bz</span>&nbsp;<span class="op" id="4668507">:=</span>&nbsp;<span class="builtinfunc" id="4668510">new</span><span class="op" id="4668513">(</span><span class="ident" id="4668514">big</span><span class="op" id="4668517">.</span><span class="ident" id="4668518">Int</span><span class="op" id="4668521">)</span><span class="op" id="4668522">.</span><span class="ident" id="4668523">SetInt64</span><span class="op" id="4668531">(</span><span class="num" id="4668532">1</span><span class="op" id="4668533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668536">x</span><span class="op" id="4668537">,</span>&nbsp;<span class="ident" id="4668539">y</span><span class="op" id="4668540">,</span>&nbsp;<span class="ident" id="4668542">z</span>&nbsp;<span class="op" id="4668544">:=</span>&nbsp;<span class="builtinfunc" id="4668547">new</span><span class="op" id="4668550">(</span><span class="ident" id="4668551">big</span><span class="op" id="4668554">.</span><span class="ident" id="4668555">Int</span><span class="op" id="4668558">)</span><span class="op" id="4668559">,</span>&nbsp;<span class="builtinfunc" id="4668561">new</span><span class="op" id="4668564">(</span><span class="ident" id="4668565">big</span><span class="op" id="4668568">.</span><span class="ident" id="4668569">Int</span><span class="op" id="4668572">)</span><span class="op" id="4668573">,</span>&nbsp;<span class="builtinfunc" id="4668575">new</span><span class="op" id="4668578">(</span><span class="ident" id="4668579">big</span><span class="op" id="4668582">.</span><span class="ident" id="4668583">Int</span><span class="op" id="4668586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668590">for</span>&nbsp;<span class="ident" id="4668594">_</span><span class="op" id="4668595">,</span>&nbsp;<span class="builtintype" id="4668597">byte</span>&nbsp;<span class="op" id="4668602">:=</span>&nbsp;<span class="keyword" id="4668605">range</span>&nbsp;<span class="ident" id="4668611">k</span>&nbsp;<span class="op" id="4668613">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668617">for</span>&nbsp;<span class="ident" id="4668621">bitNum</span>&nbsp;<span class="op" id="4668628">:=</span>&nbsp;<span class="num" id="4668631">0</span><span class="op" id="4668632">;</span>&nbsp;<span class="ident" id="4668634">bitNum</span>&nbsp;<span class="op" id="4668641">&lt;</span>&nbsp;<span class="num" id="4668643">8</span><span class="op" id="4668644">;</span>&nbsp;<span class="ident" id="4668646">bitNum</span><span class="op" id="4668652">++</span>&nbsp;<span class="op" id="4668655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668660">x</span><span class="op" id="4668661">,</span>&nbsp;<span class="ident" id="4668663">y</span><span class="op" id="4668664">,</span>&nbsp;<span class="ident" id="4668666">z</span>&nbsp;<span class="op" id="4668668">=</span>&nbsp;<span class="ident" id="4668670">curve</span><span class="op" id="4668675">.</span><span class="ident" id="4668676">doubleJacobian</span><span class="op" id="4668690">(</span><span class="ident" id="4668691">x</span><span class="op" id="4668692">,</span>&nbsp;<span class="ident" id="4668694">y</span><span class="op" id="4668695">,</span>&nbsp;<span class="ident" id="4668697">z</span><span class="op" id="4668698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668703">if</span>&nbsp;<span class="builtintype" id="4668706">byte</span><span class="op" id="4668710">&amp;</span><span class="num" id="4668711">0x80</span>&nbsp;<span class="op" id="4668716">==</span>&nbsp;<span class="num" id="4668719">0x80</span>&nbsp;<span class="op" id="4668724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668730">x</span><span class="op" id="4668731">,</span>&nbsp;<span class="ident" id="4668733">y</span><span class="op" id="4668734">,</span>&nbsp;<span class="ident" id="4668736">z</span>&nbsp;<span class="op" id="4668738">=</span>&nbsp;<span class="ident" id="4668740">curve</span><span class="op" id="4668745">.</span><span class="ident" id="4668746">addJacobian</span><span class="op" id="4668757">(</span><span class="ident" id="4668758">Bx</span><span class="op" id="4668760">,</span>&nbsp;<span class="ident" id="4668762">By</span><span class="op" id="4668764">,</span>&nbsp;<span class="ident" id="4668766">Bz</span><span class="op" id="4668768">,</span>&nbsp;<span class="ident" id="4668770">x</span><span class="op" id="4668771">,</span>&nbsp;<span class="ident" id="4668773">y</span><span class="op" id="4668774">,</span>&nbsp;<span class="ident" id="4668776">z</span><span class="op" id="4668777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668782">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4668787">byte</span>&nbsp;<span class="op" id="4668792">&lt;&lt;=</span>&nbsp;<span class="num" id="4668796">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668807">return</span>&nbsp;<span class="ident" id="4668814">curve</span><span class="op" id="4668819">.</span><span class="ident" id="4668820">affineFromJacobian</span><span class="op" id="4668838">(</span><span class="ident" id="4668839">x</span><span class="op" id="4668840">,</span>&nbsp;<span class="ident" id="4668842">y</span><span class="op" id="4668843">,</span>&nbsp;<span class="ident" id="4668845">z</span><span class="op" id="4668846">)</span><br>
<span class="lineno">265</span><span class="op" id="4668848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668851">func</span>&nbsp;<span class="op" id="4668856">(</span><span class="ident" id="4668857">curve</span>&nbsp;<span class="op" id="4668863">*</span><span class="ident" id="4668864">CurveParams</span><span class="op" id="4668875">)</span>&nbsp;<span class="ident" id="4668877">ScalarBaseMult</span><span class="op" id="4668891">(</span><span class="ident" id="4668892">k</span>&nbsp;<span class="op" id="4668894">[</span><span class="op" id="4668895">]</span><span class="builtintype" id="4668896">byte</span><span class="op" id="4668900">)</span>&nbsp;<span class="op" id="4668902">(</span><span class="op" id="4668903">*</span><span class="ident" id="4668904">big</span><span class="op" id="4668907">.</span><span class="ident" id="4668908">Int</span><span class="op" id="4668911">,</span>&nbsp;<span class="op" id="4668913">*</span><span class="ident" id="4668914">big</span><span class="op" id="4668917">.</span><span class="ident" id="4668918">Int</span><span class="op" id="4668921">)</span>&nbsp;<span class="op" id="4668923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668926">return</span>&nbsp;<span class="ident" id="4668933">curve</span><span class="op" id="4668938">.</span><span class="ident" id="4668939">ScalarMult</span><span class="op" id="4668949">(</span><span class="ident" id="4668950">curve</span><span class="op" id="4668955">.</span><span class="ident" id="4668956">Gx</span><span class="op" id="4668958">,</span>&nbsp;<span class="ident" id="4668960">curve</span><span class="op" id="4668965">.</span><span class="ident" id="4668966">Gy</span><span class="op" id="4668968">,</span>&nbsp;<span class="ident" id="4668970">k</span><span class="op" id="4668971">)</span><br>
<span class="lineno"></span><span class="op" id="4668973">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4668976">var</span>&nbsp;<span class="ident" id="4668980">mask</span>&nbsp;<span class="op" id="4668985">=</span>&nbsp;<span class="op" id="4668987">[</span><span class="op" id="4668988">]</span><span class="builtintype" id="4668989">byte</span><span class="op" id="4668993">{</span><span class="num" id="4668994">0xff</span><span class="op" id="4668998">,</span>&nbsp;<span class="num" id="4669000">0x1</span><span class="op" id="4669003">,</span>&nbsp;<span class="num" id="4669005">0x3</span><span class="op" id="4669008">,</span>&nbsp;<span class="num" id="4669010">0x7</span><span class="op" id="4669013">,</span>&nbsp;<span class="num" id="4669015">0xf</span><span class="op" id="4669018">,</span>&nbsp;<span class="num" id="4669020">0x1f</span><span class="op" id="4669024">,</span>&nbsp;<span class="num" id="4669026">0x3f</span><span class="op" id="4669030">,</span>&nbsp;<span class="num" id="4669032">0x7f</span><span class="op" id="4669036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4669039">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4669108">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4669176">func</span>&nbsp;<span class="ident" id="4669181">GenerateKey</span><span class="op" id="4669192">(</span><span class="ident" id="4669193">curve</span>&nbsp;<span class="ident" id="4669199">Curve</span><span class="op" id="4669204">,</span>&nbsp;<span class="ident" id="4669206">rand</span>&nbsp;<span class="ident" id="4669211">io</span><span class="op" id="4669213">.</span><span class="ident" id="4669214">Reader</span><span class="op" id="4669220">)</span>&nbsp;<span class="op" id="4669222">(</span><span class="ident" id="4669223">priv</span>&nbsp;<span class="op" id="4669228">[</span><span class="op" id="4669229">]</span><span class="builtintype" id="4669230">byte</span><span class="op" id="4669234">,</span>&nbsp;<span class="ident" id="4669236">x</span><span class="op" id="4669237">,</span>&nbsp;<span class="ident" id="4669239">y</span>&nbsp;<span class="op" id="4669241">*</span><span class="ident" id="4669242">big</span><span class="op" id="4669245">.</span><span class="ident" id="4669246">Int</span><span class="op" id="4669249">,</span>&nbsp;<span class="ident" id="4669251">err</span>&nbsp;<span class="builtintype" id="4669255">error</span><span class="op" id="4669260">)</span>&nbsp;<span class="op" id="4669262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669265">bitSize</span>&nbsp;<span class="op" id="4669273">:=</span>&nbsp;<span class="ident" id="4669276">curve</span><span class="op" id="4669281">.</span><span class="ident" id="4669282">Params</span><span class="op" id="4669288">(</span><span class="op" id="4669289">)</span><span class="op" id="4669290">.</span><span class="ident" id="4669291">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669300">byteLen</span>&nbsp;<span class="op" id="4669308">:=</span>&nbsp;<span class="op" id="4669311">(</span><span class="ident" id="4669312">bitSize</span>&nbsp;<span class="op" id="4669320">+</span>&nbsp;<span class="num" id="4669322">7</span><span class="op" id="4669323">)</span>&nbsp;<span class="op" id="4669325">&gt;&gt;</span>&nbsp;<span class="num" id="4669328">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669331">priv</span>&nbsp;<span class="op" id="4669336">=</span>&nbsp;<span class="builtinfunc" id="4669338">make</span><span class="op" id="4669342">(</span><span class="op" id="4669343">[</span><span class="op" id="4669344">]</span><span class="builtintype" id="4669345">byte</span><span class="op" id="4669349">,</span>&nbsp;<span class="ident" id="4669351">byteLen</span><span class="op" id="4669358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669362">for</span>&nbsp;<span class="ident" id="4669366">x</span>&nbsp;<span class="op" id="4669368">==</span>&nbsp;<span class="builtintype" id="4669371">nil</span>&nbsp;<span class="op" id="4669375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669379">_</span><span class="op" id="4669380">,</span>&nbsp;<span class="ident" id="4669382">err</span>&nbsp;<span class="op" id="4669386">=</span>&nbsp;<span class="ident" id="4669388">io</span><span class="op" id="4669390">.</span><span class="ident" id="4669391">ReadFull</span><span class="op" id="4669399">(</span><span class="ident" id="4669400">rand</span><span class="op" id="4669404">,</span>&nbsp;<span class="ident" id="4669406">priv</span><span class="op" id="4669410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669414">if</span>&nbsp;<span class="ident" id="4669417">err</span>&nbsp;<span class="op" id="4669421">!=</span>&nbsp;<span class="builtintype" id="4669424">nil</span>&nbsp;<span class="op" id="4669428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669433">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669442">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4669446">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4669520">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669574">priv</span><span class="op" id="4669578">[</span><span class="num" id="4669579">0</span><span class="op" id="4669580">]</span>&nbsp;<span class="op" id="4669582">&amp;=</span>&nbsp;<span class="ident" id="4669585">mask</span><span class="op" id="4669589">[</span><span class="ident" id="4669590">bitSize</span><span class="op" id="4669597">%</span><span class="num" id="4669598">8</span><span class="op" id="4669599">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4669603">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4669675">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669732">priv</span><span class="op" id="4669736">[</span><span class="num" id="4669737">1</span><span class="op" id="4669738">]</span>&nbsp;<span class="op" id="4669740">^=</span>&nbsp;<span class="num" id="4669743">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669750">x</span><span class="op" id="4669751">,</span>&nbsp;<span class="ident" id="4669753">y</span>&nbsp;<span class="op" id="4669755">=</span>&nbsp;<span class="ident" id="4669757">curve</span><span class="op" id="4669762">.</span><span class="ident" id="4669763">ScalarBaseMult</span><span class="op" id="4669777">(</span><span class="ident" id="4669778">priv</span><span class="op" id="4669782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669788">return</span><br>
<span class="lineno"></span><span class="op" id="4669795">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4669798">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4669882">func</span>&nbsp;<span class="ident" id="4669887">Marshal</span><span class="op" id="4669894">(</span><span class="ident" id="4669895">curve</span>&nbsp;<span class="ident" id="4669901">Curve</span><span class="op" id="4669906">,</span>&nbsp;<span class="ident" id="4669908">x</span><span class="op" id="4669909">,</span>&nbsp;<span class="ident" id="4669911">y</span>&nbsp;<span class="op" id="4669913">*</span><span class="ident" id="4669914">big</span><span class="op" id="4669917">.</span><span class="ident" id="4669918">Int</span><span class="op" id="4669921">)</span>&nbsp;<span class="op" id="4669923">[</span><span class="op" id="4669924">]</span><span class="builtintype" id="4669925">byte</span>&nbsp;<span class="op" id="4669930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669933">byteLen</span>&nbsp;<span class="op" id="4669941">:=</span>&nbsp;<span class="op" id="4669944">(</span><span class="ident" id="4669945">curve</span><span class="op" id="4669950">.</span><span class="ident" id="4669951">Params</span><span class="op" id="4669957">(</span><span class="op" id="4669958">)</span><span class="op" id="4669959">.</span><span class="ident" id="4669960">BitSize</span>&nbsp;<span class="op" id="4669968">+</span>&nbsp;<span class="num" id="4669970">7</span><span class="op" id="4669971">)</span>&nbsp;<span class="op" id="4669973">&gt;&gt;</span>&nbsp;<span class="num" id="4669976">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669980">ret</span>&nbsp;<span class="op" id="4669984">:=</span>&nbsp;<span class="builtinfunc" id="4669987">make</span><span class="op" id="4669991">(</span><span class="op" id="4669992">[</span><span class="op" id="4669993">]</span><span class="builtintype" id="4669994">byte</span><span class="op" id="4669998">,</span>&nbsp;<span class="num" id="4670000">1</span><span class="op" id="4670001">+</span><span class="num" id="4670002">2</span><span class="op" id="4670003">*</span><span class="ident" id="4670004">byteLen</span><span class="op" id="4670011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670014">ret</span><span class="op" id="4670017">[</span><span class="num" id="4670018">0</span><span class="op" id="4670019">]</span>&nbsp;<span class="op" id="4670021">=</span>&nbsp;<span class="num" id="4670023">4</span>&nbsp;<span class="comment" id="4670025">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670049">xBytes</span>&nbsp;<span class="op" id="4670056">:=</span>&nbsp;<span class="ident" id="4670059">x</span><span class="op" id="4670060">.</span><span class="ident" id="4670061">Bytes</span><span class="op" id="4670066">(</span><span class="op" id="4670067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4670070">copy</span><span class="op" id="4670074">(</span><span class="ident" id="4670075">ret</span><span class="op" id="4670078">[</span><span class="num" id="4670079">1</span><span class="op" id="4670080">+</span><span class="ident" id="4670081">byteLen</span><span class="op" id="4670088">-</span><span class="builtinfunc" id="4670089">len</span><span class="op" id="4670092">(</span><span class="ident" id="4670093">xBytes</span><span class="op" id="4670099">)</span><span class="op" id="4670100">:</span><span class="op" id="4670101">]</span><span class="op" id="4670102">,</span>&nbsp;<span class="ident" id="4670104">xBytes</span><span class="op" id="4670110">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670113">yBytes</span>&nbsp;<span class="op" id="4670120">:=</span>&nbsp;<span class="ident" id="4670123">y</span><span class="op" id="4670124">.</span><span class="ident" id="4670125">Bytes</span><span class="op" id="4670130">(</span><span class="op" id="4670131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4670134">copy</span><span class="op" id="4670138">(</span><span class="ident" id="4670139">ret</span><span class="op" id="4670142">[</span><span class="num" id="4670143">1</span><span class="op" id="4670144">+</span><span class="num" id="4670145">2</span><span class="op" id="4670146">*</span><span class="ident" id="4670147">byteLen</span><span class="op" id="4670154">-</span><span class="builtinfunc" id="4670155">len</span><span class="op" id="4670158">(</span><span class="ident" id="4670159">yBytes</span><span class="op" id="4670165">)</span><span class="op" id="4670166">:</span><span class="op" id="4670167">]</span><span class="op" id="4670168">,</span>&nbsp;<span class="ident" id="4670170">yBytes</span><span class="op" id="4670176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670179">return</span>&nbsp;<span class="ident" id="4670186">ret</span><br>
<span class="lineno"></span><span class="op" id="4670190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4670193">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4670285">func</span>&nbsp;<span class="ident" id="4670290">Unmarshal</span><span class="op" id="4670299">(</span><span class="ident" id="4670300">curve</span>&nbsp;<span class="ident" id="4670306">Curve</span><span class="op" id="4670311">,</span>&nbsp;<span class="ident" id="4670313">data</span>&nbsp;<span class="op" id="4670318">[</span><span class="op" id="4670319">]</span><span class="builtintype" id="4670320">byte</span><span class="op" id="4670324">)</span>&nbsp;<span class="op" id="4670326">(</span><span class="ident" id="4670327">x</span><span class="op" id="4670328">,</span>&nbsp;<span class="ident" id="4670330">y</span>&nbsp;<span class="op" id="4670332">*</span><span class="ident" id="4670333">big</span><span class="op" id="4670336">.</span><span class="ident" id="4670337">Int</span><span class="op" id="4670340">)</span>&nbsp;<span class="op" id="4670342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670345">byteLen</span>&nbsp;<span class="op" id="4670353">:=</span>&nbsp;<span class="op" id="4670356">(</span><span class="ident" id="4670357">curve</span><span class="op" id="4670362">.</span><span class="ident" id="4670363">Params</span><span class="op" id="4670369">(</span><span class="op" id="4670370">)</span><span class="op" id="4670371">.</span><span class="ident" id="4670372">BitSize</span>&nbsp;<span class="op" id="4670380">+</span>&nbsp;<span class="num" id="4670382">7</span><span class="op" id="4670383">)</span>&nbsp;<span class="op" id="4670385">&gt;&gt;</span>&nbsp;<span class="num" id="4670388">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670391">if</span>&nbsp;<span class="builtinfunc" id="4670394">len</span><span class="op" id="4670397">(</span><span class="ident" id="4670398">data</span><span class="op" id="4670402">)</span>&nbsp;<span class="op" id="4670404">!=</span>&nbsp;<span class="num" id="4670407">1</span><span class="op" id="4670408">+</span><span class="num" id="4670409">2</span><span class="op" id="4670410">*</span><span class="ident" id="4670411">byteLen</span>&nbsp;<span class="op" id="4670419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670423">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670434">if</span>&nbsp;<span class="ident" id="4670437">data</span><span class="op" id="4670441">[</span><span class="num" id="4670442">0</span><span class="op" id="4670443">]</span>&nbsp;<span class="op" id="4670445">!=</span>&nbsp;<span class="num" id="4670448">4</span>&nbsp;<span class="op" id="4670450">{</span>&nbsp;<span class="comment" id="4670452">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670475">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670486">x</span>&nbsp;<span class="op" id="4670488">=</span>&nbsp;<span class="builtinfunc" id="4670490">new</span><span class="op" id="4670493">(</span><span class="ident" id="4670494">big</span><span class="op" id="4670497">.</span><span class="ident" id="4670498">Int</span><span class="op" id="4670501">)</span><span class="op" id="4670502">.</span><span class="ident" id="4670503">SetBytes</span><span class="op" id="4670511">(</span><span class="ident" id="4670512">data</span><span class="op" id="4670516">[</span><span class="num" id="4670517">1</span>&nbsp;<span class="op" id="4670519">:</span>&nbsp;<span class="num" id="4670521">1</span><span class="op" id="4670522">+</span><span class="ident" id="4670523">byteLen</span><span class="op" id="4670530">]</span><span class="op" id="4670531">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670534">y</span>&nbsp;<span class="op" id="4670536">=</span>&nbsp;<span class="builtinfunc" id="4670538">new</span><span class="op" id="4670541">(</span><span class="ident" id="4670542">big</span><span class="op" id="4670545">.</span><span class="ident" id="4670546">Int</span><span class="op" id="4670549">)</span><span class="op" id="4670550">.</span><span class="ident" id="4670551">SetBytes</span><span class="op" id="4670559">(</span><span class="ident" id="4670560">data</span><span class="op" id="4670564">[</span><span class="num" id="4670565">1</span><span class="op" id="4670566">+</span><span class="ident" id="4670567">byteLen</span><span class="op" id="4670574">:</span><span class="op" id="4670575">]</span><span class="op" id="4670576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670579">return</span><br>
<span class="lineno"></span><span class="op" id="4670586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4670589">var</span>&nbsp;<span class="ident" id="4670593">initonce</span>&nbsp;<span class="ident" id="4670602">sync</span><span class="op" id="4670606">.</span><span class="ident" id="4670607">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4670612">var</span>&nbsp;<span class="ident" id="4670616">p384</span>&nbsp;<span class="op" id="4670621">*</span><span class="ident" id="4670622">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4670634">var</span>&nbsp;<span class="ident" id="4670638">p521</span>&nbsp;<span class="op" id="4670643">*</span><span class="ident" id="4670644">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4670657">func</span>&nbsp;<span class="ident" id="4670662">initAll</span><span class="op" id="4670669">(</span><span class="op" id="4670670">)</span>&nbsp;<span class="op" id="4670672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670675">initP224</span><span class="op" id="4670683">(</span><span class="op" id="4670684">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670687">initP256</span><span class="op" id="4670695">(</span><span class="op" id="4670696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670699">initP384</span><span class="op" id="4670707">(</span><span class="op" id="4670708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670711">initP521</span><span class="op" id="4670719">(</span><span class="op" id="4670720">)</span><br>
<span class="lineno"></span><span class="op" id="4670722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4670725">func</span>&nbsp;<span class="ident" id="4670730">initP384</span><span class="op" id="4670738">(</span><span class="op" id="4670739">)</span>&nbsp;<span class="op" id="4670741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670744">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670778">p384</span>&nbsp;<span class="op" id="4670783">=</span>&nbsp;<span class="builtinfunc" id="4670785">new</span><span class="op" id="4670788">(</span><span class="ident" id="4670789">CurveParams</span><span class="op" id="4670800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670803">p384</span><span class="op" id="4670807">.</span><span class="ident" id="4670808">P</span><span class="op" id="4670809">,</span>&nbsp;<span class="ident" id="4670811">_</span>&nbsp;<span class="op" id="4670813">=</span>&nbsp;<span class="builtinfunc" id="4670815">new</span><span class="op" id="4670818">(</span><span class="ident" id="4670819">big</span><span class="op" id="4670822">.</span><span class="ident" id="4670823">Int</span><span class="op" id="4670826">)</span><span class="op" id="4670827">.</span><span class="ident" id="4670828">SetString</span><span class="op" id="4670837">(</span><span class="string" id="4670838">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4670956">,</span>&nbsp;<span class="num" id="4670958">10</span><span class="op" id="4670960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670963">p384</span><span class="op" id="4670967">.</span><span class="ident" id="4670968">N</span><span class="op" id="4670969">,</span>&nbsp;<span class="ident" id="4670971">_</span>&nbsp;<span class="op" id="4670973">=</span>&nbsp;<span class="builtinfunc" id="4670975">new</span><span class="op" id="4670978">(</span><span class="ident" id="4670979">big</span><span class="op" id="4670982">.</span><span class="ident" id="4670983">Int</span><span class="op" id="4670986">)</span><span class="op" id="4670987">.</span><span class="ident" id="4670988">SetString</span><span class="op" id="4670997">(</span><span class="string" id="4670998">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4671116">,</span>&nbsp;<span class="num" id="4671118">10</span><span class="op" id="4671120">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671123">p384</span><span class="op" id="4671127">.</span><span class="ident" id="4671128">B</span><span class="op" id="4671129">,</span>&nbsp;<span class="ident" id="4671131">_</span>&nbsp;<span class="op" id="4671133">=</span>&nbsp;<span class="builtinfunc" id="4671135">new</span><span class="op" id="4671138">(</span><span class="ident" id="4671139">big</span><span class="op" id="4671142">.</span><span class="ident" id="4671143">Int</span><span class="op" id="4671146">)</span><span class="op" id="4671147">.</span><span class="ident" id="4671148">SetString</span><span class="op" id="4671157">(</span><span class="string" id="4671158">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4671256">,</span>&nbsp;<span class="num" id="4671258">16</span><span class="op" id="4671260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671263">p384</span><span class="op" id="4671267">.</span><span class="ident" id="4671268">Gx</span><span class="op" id="4671270">,</span>&nbsp;<span class="ident" id="4671272">_</span>&nbsp;<span class="op" id="4671274">=</span>&nbsp;<span class="builtinfunc" id="4671276">new</span><span class="op" id="4671279">(</span><span class="ident" id="4671280">big</span><span class="op" id="4671283">.</span><span class="ident" id="4671284">Int</span><span class="op" id="4671287">)</span><span class="op" id="4671288">.</span><span class="ident" id="4671289">SetString</span><span class="op" id="4671298">(</span><span class="string" id="4671299">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4671397">,</span>&nbsp;<span class="num" id="4671399">16</span><span class="op" id="4671401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671404">p384</span><span class="op" id="4671408">.</span><span class="ident" id="4671409">Gy</span><span class="op" id="4671411">,</span>&nbsp;<span class="ident" id="4671413">_</span>&nbsp;<span class="op" id="4671415">=</span>&nbsp;<span class="builtinfunc" id="4671417">new</span><span class="op" id="4671420">(</span><span class="ident" id="4671421">big</span><span class="op" id="4671424">.</span><span class="ident" id="4671425">Int</span><span class="op" id="4671428">)</span><span class="op" id="4671429">.</span><span class="ident" id="4671430">SetString</span><span class="op" id="4671439">(</span><span class="string" id="4671440">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4671538">,</span>&nbsp;<span class="num" id="4671540">16</span><span class="op" id="4671542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671545">p384</span><span class="op" id="4671549">.</span><span class="ident" id="4671550">BitSize</span>&nbsp;<span class="op" id="4671558">=</span>&nbsp;<span class="num" id="4671560">384</span><br>
<span class="lineno"></span><span class="op" id="4671564">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4671567">func</span>&nbsp;<span class="ident" id="4671572">initP521</span><span class="op" id="4671580">(</span><span class="op" id="4671581">)</span>&nbsp;<span class="op" id="4671583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671586">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671620">p521</span>&nbsp;<span class="op" id="4671625">=</span>&nbsp;<span class="builtinfunc" id="4671627">new</span><span class="op" id="4671630">(</span><span class="ident" id="4671631">CurveParams</span><span class="op" id="4671642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671645">p521</span><span class="op" id="4671649">.</span><span class="ident" id="4671650">P</span><span class="op" id="4671651">,</span>&nbsp;<span class="ident" id="4671653">_</span>&nbsp;<span class="op" id="4671655">=</span>&nbsp;<span class="builtinfunc" id="4671657">new</span><span class="op" id="4671660">(</span><span class="ident" id="4671661">big</span><span class="op" id="4671664">.</span><span class="ident" id="4671665">Int</span><span class="op" id="4671668">)</span><span class="op" id="4671669">.</span><span class="ident" id="4671670">SetString</span><span class="op" id="4671679">(</span><span class="string" id="4671680">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4671839">,</span>&nbsp;<span class="num" id="4671841">10</span><span class="op" id="4671843">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671846">p521</span><span class="op" id="4671850">.</span><span class="ident" id="4671851">N</span><span class="op" id="4671852">,</span>&nbsp;<span class="ident" id="4671854">_</span>&nbsp;<span class="op" id="4671856">=</span>&nbsp;<span class="builtinfunc" id="4671858">new</span><span class="op" id="4671861">(</span><span class="ident" id="4671862">big</span><span class="op" id="4671865">.</span><span class="ident" id="4671866">Int</span><span class="op" id="4671869">)</span><span class="op" id="4671870">.</span><span class="ident" id="4671871">SetString</span><span class="op" id="4671880">(</span><span class="string" id="4671881">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4672040">,</span>&nbsp;<span class="num" id="4672042">10</span><span class="op" id="4672044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672047">p521</span><span class="op" id="4672051">.</span><span class="ident" id="4672052">B</span><span class="op" id="4672053">,</span>&nbsp;<span class="ident" id="4672055">_</span>&nbsp;<span class="op" id="4672057">=</span>&nbsp;<span class="builtinfunc" id="4672059">new</span><span class="op" id="4672062">(</span><span class="ident" id="4672063">big</span><span class="op" id="4672066">.</span><span class="ident" id="4672067">Int</span><span class="op" id="4672070">)</span><span class="op" id="4672071">.</span><span class="ident" id="4672072">SetString</span><span class="op" id="4672081">(</span><span class="string" id="4672082">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4672215">,</span>&nbsp;<span class="num" id="4672217">16</span><span class="op" id="4672219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672222">p521</span><span class="op" id="4672226">.</span><span class="ident" id="4672227">Gx</span><span class="op" id="4672229">,</span>&nbsp;<span class="ident" id="4672231">_</span>&nbsp;<span class="op" id="4672233">=</span>&nbsp;<span class="builtinfunc" id="4672235">new</span><span class="op" id="4672238">(</span><span class="ident" id="4672239">big</span><span class="op" id="4672242">.</span><span class="ident" id="4672243">Int</span><span class="op" id="4672246">)</span><span class="op" id="4672247">.</span><span class="ident" id="4672248">SetString</span><span class="op" id="4672257">(</span><span class="string" id="4672258">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4672390">,</span>&nbsp;<span class="num" id="4672392">16</span><span class="op" id="4672394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672397">p521</span><span class="op" id="4672401">.</span><span class="ident" id="4672402">Gy</span><span class="op" id="4672404">,</span>&nbsp;<span class="ident" id="4672406">_</span>&nbsp;<span class="op" id="4672408">=</span>&nbsp;<span class="builtinfunc" id="4672410">new</span><span class="op" id="4672413">(</span><span class="ident" id="4672414">big</span><span class="op" id="4672417">.</span><span class="ident" id="4672418">Int</span><span class="op" id="4672421">)</span><span class="op" id="4672422">.</span><span class="ident" id="4672423">SetString</span><span class="op" id="4672432">(</span><span class="string" id="4672433">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4672566">,</span>&nbsp;<span class="num" id="4672568">16</span><span class="op" id="4672570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672573">p521</span><span class="op" id="4672577">.</span><span class="ident" id="4672578">BitSize</span>&nbsp;<span class="op" id="4672586">=</span>&nbsp;<span class="num" id="4672588">521</span><br>
<span class="lineno">355</span><span class="op" id="4672592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4672595">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4672674">func</span>&nbsp;<span class="ident" id="4672679">P256</span><span class="op" id="4672683">(</span><span class="op" id="4672684">)</span>&nbsp;<span class="ident" id="4672686">Curve</span>&nbsp;<span class="op" id="4672692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672695">initonce</span><span class="op" id="4672703">.</span><span class="ident" id="4672704">Do</span><span class="op" id="4672706">(</span><span class="ident" id="4672707">initAll</span><span class="op" id="4672714">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672717">return</span>&nbsp;<span class="ident" id="4672724">p256</span><br>
<span class="lineno"></span><span class="op" id="4672729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4672732">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4672811">func</span>&nbsp;<span class="ident" id="4672816">P384</span><span class="op" id="4672820">(</span><span class="op" id="4672821">)</span>&nbsp;<span class="ident" id="4672823">Curve</span>&nbsp;<span class="op" id="4672829">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672832">initonce</span><span class="op" id="4672840">.</span><span class="ident" id="4672841">Do</span><span class="op" id="4672843">(</span><span class="ident" id="4672844">initAll</span><span class="op" id="4672851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672854">return</span>&nbsp;<span class="ident" id="4672861">p384</span><br>
<span class="lineno"></span><span class="op" id="4672866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4672869">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4672948">func</span>&nbsp;<span class="ident" id="4672953">P521</span><span class="op" id="4672957">(</span><span class="op" id="4672958">)</span>&nbsp;<span class="ident" id="4672960">Curve</span>&nbsp;<span class="op" id="4672966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672969">initonce</span><span class="op" id="4672977">.</span><span class="ident" id="4672978">Do</span><span class="op" id="4672980">(</span><span class="ident" id="4672981">initAll</span><span class="op" id="4672988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672991">return</span>&nbsp;<span class="ident" id="4672998">p521</span><br>
<span class="lineno"></span><span class="op" id="4673003">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
