<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2526600">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2526655">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2526709">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2526760">package</span>&nbsp;<span class="ident" id="2526768">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2526773">import</span>&nbsp;<span class="op" id="2526780">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2526783">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2526796">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2526803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526806">//&nbsp;DNSError&nbsp;represents&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2526849">type</span>&nbsp;<span class="ident" id="2526854">DNSError</span>&nbsp;<span class="keyword" id="2526863">struct</span>&nbsp;<span class="op" id="2526870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526873">Err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2526883">string</span>&nbsp;<span class="comment" id="2526890">//&nbsp;description&nbsp;of&nbsp;the&nbsp;error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526919">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2526929">string</span>&nbsp;<span class="comment" id="2526936">//&nbsp;name&nbsp;looked&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526956">Server</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2526966">string</span>&nbsp;<span class="comment" id="2526973">//&nbsp;server&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526989">IsTimeout</span>&nbsp;<span class="builtintype" id="2526999">bool</span><br>
<span class="lineno"></span><span class="op" id="2527004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2527007">func</span>&nbsp;<span class="op" id="2527012">(</span><span class="ident" id="2527013">e</span>&nbsp;<span class="op" id="2527015">*</span><span class="ident" id="2527016"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2527024">)</span>&nbsp;<span class="ident" id="2527026">Error</span><span class="op" id="2527031">(</span><span class="op" id="2527032">)</span>&nbsp;<span class="builtintype" id="2527034">string</span>&nbsp;<span class="op" id="2527041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527044">if</span>&nbsp;<span class="ident" id="2527047"><a href="/net/dnsclient.go.html#2527013">e</a></span>&nbsp;<span class="op" id="2527049">==</span>&nbsp;<span class="ident" id="2527052">nil</span>&nbsp;<span class="op" id="2527056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527060">return</span>&nbsp;<span class="string" id="2527067">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527079">s</span>&nbsp;<span class="op" id="2527081">:=</span>&nbsp;<span class="string" id="2527084">&#34;lookup&nbsp;&#34;</span>&nbsp;<span class="op" id="2527094">+</span>&nbsp;<span class="ident" id="2527096"><a href="/net/dnsclient.go.html#2527013">e</a></span><span class="op" id="2527097">.</span><span class="ident" id="2527098">Name</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527104">if</span>&nbsp;<span class="ident" id="2527107"><a href="/net/dnsclient.go.html#2527013">e</a></span><span class="op" id="2527108">.</span><span class="ident" id="2527109">Server</span>&nbsp;<span class="op" id="2527116">!=</span>&nbsp;<span class="string" id="2527119">&#34;&#34;</span>&nbsp;<span class="op" id="2527122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527126"><a href="/net/dnsclient.go.html#2527079">s</a></span>&nbsp;<span class="op" id="2527128">+=</span>&nbsp;<span class="string" id="2527131">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op" id="2527138">+</span>&nbsp;<span class="ident" id="2527140"><a href="/net/dnsclient.go.html#2527013">e</a></span><span class="op" id="2527141">.</span><span class="ident" id="2527142">Server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527153"><a href="/net/dnsclient.go.html#2527079">s</a></span>&nbsp;<span class="op" id="2527155">+=</span>&nbsp;<span class="string" id="2527158">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2527163">+</span>&nbsp;<span class="ident" id="2527165"><a href="/net/dnsclient.go.html#2527013">e</a></span><span class="op" id="2527166">.</span><span class="ident" id="2527167">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527172">return</span>&nbsp;<span class="ident" id="2527179"><a href="/net/dnsclient.go.html#2527079">s</a></span><br>
<span class="lineno">30</span><span class="op" id="2527181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527184">func</span>&nbsp;<span class="op" id="2527189">(</span><span class="ident" id="2527190">e</span>&nbsp;<span class="op" id="2527192">*</span><span class="ident" id="2527193"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2527201">)</span>&nbsp;<span class="ident" id="2527203">Timeout</span><span class="op" id="2527210">(</span><span class="op" id="2527211">)</span>&nbsp;<span class="builtintype" id="2527213">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2527220">{</span>&nbsp;<span class="keyword" id="2527222">return</span>&nbsp;<span class="ident" id="2527229"><a href="/net/dnsclient.go.html#2527190">e</a></span><span class="op" id="2527230">.</span><span class="ident" id="2527231">IsTimeout</span>&nbsp;<span class="op" id="2527241">}</span><br>
<span class="lineno"></span><span class="keyword" id="2527243">func</span>&nbsp;<span class="op" id="2527248">(</span><span class="ident" id="2527249">e</span>&nbsp;<span class="op" id="2527251">*</span><span class="ident" id="2527252"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2527260">)</span>&nbsp;<span class="ident" id="2527262">Temporary</span><span class="op" id="2527271">(</span><span class="op" id="2527272">)</span>&nbsp;<span class="builtintype" id="2527274">bool</span>&nbsp;<span class="op" id="2527279">{</span>&nbsp;<span class="keyword" id="2527281">return</span>&nbsp;<span class="ident" id="2527288"><a href="/net/dnsclient.go.html#2527249">e</a></span><span class="op" id="2527289">.</span><span class="ident" id="2527290">IsTimeout</span>&nbsp;<span class="op" id="2527300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2527303">const</span>&nbsp;<span class="ident" id="2527309">noSuchHost</span>&nbsp;<span class="op" id="2527320">=</span>&nbsp;<span class="string" id="2527322">&#34;no&nbsp;such&nbsp;host&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2527338">//&nbsp;reverseaddr&nbsp;returns&nbsp;the&nbsp;in-addr.arpa.&nbsp;or&nbsp;ip6.arpa.&nbsp;hostname&nbsp;of&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="2527411">//&nbsp;address&nbsp;addr&nbsp;suitable&nbsp;for&nbsp;rDNS&nbsp;(PTR)&nbsp;record&nbsp;lookup&nbsp;or&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="2527489">//&nbsp;to&nbsp;parse&nbsp;the&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">40</span><span class="keyword" id="2527517">func</span>&nbsp;<span class="ident" id="2527522">reverseaddr</span><span class="op" id="2527533">(</span><span class="ident" id="2527534">addr</span>&nbsp;<span class="builtintype" id="2527539">string</span><span class="op" id="2527545">)</span>&nbsp;<span class="op" id="2527547">(</span><span class="ident" id="2527548">arpa</span>&nbsp;<span class="builtintype" id="2527553">string</span><span class="op" id="2527559">,</span>&nbsp;<span class="ident" id="2527561">err</span>&nbsp;<span class="builtintype" id="2527565">error</span><span class="op" id="2527570">)</span>&nbsp;<span class="op" id="2527572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527575">ip</span>&nbsp;<span class="op" id="2527578">:=</span>&nbsp;<span class="ident" id="2527581"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="2527588">(</span><span class="ident" id="2527589"><a href="/net/dnsclient.go.html#2527534">addr</a></span><span class="op" id="2527593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527596">if</span>&nbsp;<span class="ident" id="2527599"><a href="/net/dnsclient.go.html#2527575">ip</a></span>&nbsp;<span class="op" id="2527602">==</span>&nbsp;<span class="ident" id="2527605">nil</span>&nbsp;<span class="op" id="2527609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527613">return</span>&nbsp;<span class="string" id="2527620">&#34;&#34;</span><span class="op" id="2527622">,</span>&nbsp;<span class="op" id="2527624">&amp;</span><span class="ident" id="2527625"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2527633">{</span><span class="ident" id="2527634">Err</span><span class="op" id="2527637">:</span>&nbsp;<span class="string" id="2527639">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="2527661">,</span>&nbsp;<span class="ident" id="2527663">Name</span><span class="op" id="2527667">:</span>&nbsp;<span class="ident" id="2527669"><a href="/net/dnsclient.go.html#2527534">addr</a></span><span class="op" id="2527673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527676">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527679">if</span>&nbsp;<span class="ident" id="2527682"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527684">.</span><span class="ident" id="2527685">To4</span><span class="op" id="2527688">(</span><span class="op" id="2527689">)</span>&nbsp;<span class="op" id="2527691">!=</span>&nbsp;<span class="ident" id="2527694">nil</span>&nbsp;<span class="op" id="2527698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527702">return</span>&nbsp;<span class="ident" id="2527709"><a href="/net/parse.go.html#2666210">itoa</a></span><span class="op" id="2527713">(</span><span class="builtintype" id="2527714">int</span><span class="op" id="2527717">(</span><span class="ident" id="2527718"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527720">[</span><span class="num" id="2527721">15</span><span class="op" id="2527723">]</span><span class="op" id="2527724">)</span><span class="op" id="2527725">)</span>&nbsp;<span class="op" id="2527727">+</span>&nbsp;<span class="string" id="2527729">&#34;.&#34;</span>&nbsp;<span class="op" id="2527733">+</span>&nbsp;<span class="ident" id="2527735"><a href="/net/parse.go.html#2666210">itoa</a></span><span class="op" id="2527739">(</span><span class="builtintype" id="2527740">int</span><span class="op" id="2527743">(</span><span class="ident" id="2527744"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527746">[</span><span class="num" id="2527747">14</span><span class="op" id="2527749">]</span><span class="op" id="2527750">)</span><span class="op" id="2527751">)</span>&nbsp;<span class="op" id="2527753">+</span>&nbsp;<span class="string" id="2527755">&#34;.&#34;</span>&nbsp;<span class="op" id="2527759">+</span>&nbsp;<span class="ident" id="2527761"><a href="/net/parse.go.html#2666210">itoa</a></span><span class="op" id="2527765">(</span><span class="builtintype" id="2527766">int</span><span class="op" id="2527769">(</span><span class="ident" id="2527770"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527772">[</span><span class="num" id="2527773">13</span><span class="op" id="2527775">]</span><span class="op" id="2527776">)</span><span class="op" id="2527777">)</span>&nbsp;<span class="op" id="2527779">+</span>&nbsp;<span class="string" id="2527781">&#34;.&#34;</span>&nbsp;<span class="op" id="2527785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527790"><a href="/net/parse.go.html#2666210">itoa</a></span><span class="op" id="2527794">(</span><span class="builtintype" id="2527795">int</span><span class="op" id="2527798">(</span><span class="ident" id="2527799"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527801">[</span><span class="num" id="2527802">12</span><span class="op" id="2527804">]</span><span class="op" id="2527805">)</span><span class="op" id="2527806">)</span>&nbsp;<span class="op" id="2527808">+</span>&nbsp;<span class="string" id="2527810">&#34;.in-addr.arpa.&#34;</span><span class="op" id="2527826">,</span>&nbsp;<span class="ident" id="2527828">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527836">//&nbsp;Must&nbsp;be&nbsp;IPv6</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527853">buf</span>&nbsp;<span class="op" id="2527857">:=</span>&nbsp;<span class="builtinfunc" id="2527860">make</span><span class="op" id="2527864">(</span><span class="op" id="2527865">[</span><span class="op" id="2527866">]</span><span class="builtintype" id="2527867">byte</span><span class="op" id="2527871">,</span>&nbsp;<span class="num" id="2527873">0</span><span class="op" id="2527874">,</span>&nbsp;<span class="builtinfunc" id="2527876">len</span><span class="op" id="2527879">(</span><span class="ident" id="2527880"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527882">)</span><span class="op" id="2527883">*</span><span class="num" id="2527884">4</span><span class="op" id="2527885">+</span><span class="builtinfunc" id="2527886">len</span><span class="op" id="2527889">(</span><span class="string" id="2527890">&#34;ip6.arpa.&#34;</span><span class="op" id="2527901">)</span><span class="op" id="2527902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527905">//&nbsp;Add&nbsp;it,&nbsp;in&nbsp;reverse,&nbsp;to&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527943">for</span>&nbsp;<span class="ident" id="2527947">i</span>&nbsp;<span class="op" id="2527949">:=</span>&nbsp;<span class="builtinfunc" id="2527952">len</span><span class="op" id="2527955">(</span><span class="ident" id="2527956"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527958">)</span>&nbsp;<span class="op" id="2527960">-</span>&nbsp;<span class="num" id="2527962">1</span><span class="op" id="2527963">;</span>&nbsp;<span class="ident" id="2527965"><a href="/net/dnsclient.go.html#2527947">i</a></span>&nbsp;<span class="op" id="2527967">&gt;=</span>&nbsp;<span class="num" id="2527970">0</span><span class="op" id="2527971">;</span>&nbsp;<span class="ident" id="2527973"><a href="/net/dnsclient.go.html#2527947">i</a></span><span class="op" id="2527974">--</span>&nbsp;<span class="op" id="2527977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527981">v</span>&nbsp;<span class="op" id="2527983">:=</span>&nbsp;<span class="ident" id="2527986"><a href="/net/dnsclient.go.html#2527575">ip</a></span><span class="op" id="2527988">[</span><span class="ident" id="2527989"><a href="/net/dnsclient.go.html#2527947">i</a></span><span class="op" id="2527990">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527994"><a href="/net/dnsclient.go.html#2527853">buf</a></span>&nbsp;<span class="op" id="2527998">=</span>&nbsp;<span class="builtinfunc" id="2528000">append</span><span class="op" id="2528006">(</span><span class="ident" id="2528007"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528010">,</span>&nbsp;<span class="ident" id="2528012"><a href="/net/mac.go.html#2649509">hexDigit</a></span><span class="op" id="2528020">[</span><span class="ident" id="2528021"><a href="/net/dnsclient.go.html#2527981">v</a></span><span class="op" id="2528022">&amp;</span><span class="num" id="2528023">0xF</span><span class="op" id="2528026">]</span><span class="op" id="2528027">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528031"><a href="/net/dnsclient.go.html#2527853">buf</a></span>&nbsp;<span class="op" id="2528035">=</span>&nbsp;<span class="builtinfunc" id="2528037">append</span><span class="op" id="2528043">(</span><span class="ident" id="2528044"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528047">,</span>&nbsp;<span class="string" id="2528049">&#39;.&#39;</span><span class="op" id="2528052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528056"><a href="/net/dnsclient.go.html#2527853">buf</a></span>&nbsp;<span class="op" id="2528060">=</span>&nbsp;<span class="builtinfunc" id="2528062">append</span><span class="op" id="2528068">(</span><span class="ident" id="2528069"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528072">,</span>&nbsp;<span class="ident" id="2528074"><a href="/net/mac.go.html#2649509">hexDigit</a></span><span class="op" id="2528082">[</span><span class="ident" id="2528083"><a href="/net/dnsclient.go.html#2527981">v</a></span><span class="op" id="2528084">&gt;&gt;</span><span class="num" id="2528086">4</span><span class="op" id="2528087">]</span><span class="op" id="2528088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528092"><a href="/net/dnsclient.go.html#2527853">buf</a></span>&nbsp;<span class="op" id="2528096">=</span>&nbsp;<span class="builtinfunc" id="2528098">append</span><span class="op" id="2528104">(</span><span class="ident" id="2528105"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528108">,</span>&nbsp;<span class="string" id="2528110">&#39;.&#39;</span><span class="op" id="2528113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528119">//&nbsp;Append&nbsp;&#34;ip6.arpa.&#34;&nbsp;and&nbsp;return&nbsp;(buf&nbsp;already&nbsp;has&nbsp;the&nbsp;final&nbsp;.)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528183"><a href="/net/dnsclient.go.html#2527853">buf</a></span>&nbsp;<span class="op" id="2528187">=</span>&nbsp;<span class="builtinfunc" id="2528189">append</span><span class="op" id="2528195">(</span><span class="ident" id="2528196"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528199">,</span>&nbsp;<span class="string" id="2528201">&#34;ip6.arpa.&#34;</span><span class="op" id="2528212">...</span><span class="op" id="2528215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528218">return</span>&nbsp;<span class="builtintype" id="2528225">string</span><span class="op" id="2528231">(</span><span class="ident" id="2528232"><a href="/net/dnsclient.go.html#2527853">buf</a></span><span class="op" id="2528235">)</span><span class="op" id="2528236">,</span>&nbsp;<span class="ident" id="2528238">nil</span><br>
<span class="lineno"></span><span class="op" id="2528242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2528245">//&nbsp;Find&nbsp;answer&nbsp;for&nbsp;name&nbsp;in&nbsp;dns&nbsp;message.</span><br>
<span class="lineno">65</span><span class="comment" id="2528285">//&nbsp;On&nbsp;return,&nbsp;if&nbsp;err&nbsp;==&nbsp;nil,&nbsp;addrs&nbsp;!=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2528328">func</span>&nbsp;<span class="ident" id="2528333">answer</span><span class="op" id="2528339">(</span><span class="ident" id="2528340">name</span><span class="op" id="2528344">,</span>&nbsp;<span class="ident" id="2528346">server</span>&nbsp;<span class="builtintype" id="2528353">string</span><span class="op" id="2528359">,</span>&nbsp;<span class="ident" id="2528361">dns</span>&nbsp;<span class="op" id="2528365">*</span><span class="ident" id="2528366"><a href="/net/dnsmsg.go.html#2563931">dnsMsg</a></span><span class="op" id="2528372">,</span>&nbsp;<span class="ident" id="2528374">qtype</span>&nbsp;<span class="builtintype" id="2528380">uint16</span><span class="op" id="2528386">)</span>&nbsp;<span class="op" id="2528388">(</span><span class="ident" id="2528389">cname</span>&nbsp;<span class="builtintype" id="2528395">string</span><span class="op" id="2528401">,</span>&nbsp;<span class="ident" id="2528403">addrs</span>&nbsp;<span class="op" id="2528409">[</span><span class="op" id="2528410">]</span><span class="ident" id="2528411"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2528416">,</span>&nbsp;<span class="ident" id="2528418">err</span>&nbsp;<span class="builtintype" id="2528422">error</span><span class="op" id="2528427">)</span>&nbsp;<span class="op" id="2528429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528432"><a href="/net/dnsclient.go.html#2528403">addrs</a></span>&nbsp;<span class="op" id="2528438">=</span>&nbsp;<span class="builtinfunc" id="2528440">make</span><span class="op" id="2528444">(</span><span class="op" id="2528445">[</span><span class="op" id="2528446">]</span><span class="ident" id="2528447"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2528452">,</span>&nbsp;<span class="num" id="2528454">0</span><span class="op" id="2528455">,</span>&nbsp;<span class="builtinfunc" id="2528457">len</span><span class="op" id="2528460">(</span><span class="ident" id="2528461"><a href="/net/dnsclient.go.html#2528361">dns</a></span><span class="op" id="2528464">.</span><span class="ident" id="2528465">answer</span><span class="op" id="2528471">)</span><span class="op" id="2528472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528476">if</span>&nbsp;<span class="ident" id="2528479"><a href="/net/dnsclient.go.html#2528361">dns</a></span><span class="op" id="2528482">.</span><span class="ident" id="2528483">rcode</span>&nbsp;<span class="op" id="2528489">==</span>&nbsp;<span class="ident" id="2528492"><a href="/net/dnsmsg.go.html#2547526">dnsRcodeNameError</a></span>&nbsp;<span class="op" id="2528510">&amp;&amp;</span>&nbsp;<span class="ident" id="2528513"><a href="/net/dnsclient.go.html#2528361">dns</a></span><span class="op" id="2528516">.</span><span class="ident" id="2528517">recursion_available</span>&nbsp;<span class="op" id="2528537">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528541">return</span>&nbsp;<span class="string" id="2528548">&#34;&#34;</span><span class="op" id="2528550">,</span>&nbsp;<span class="ident" id="2528552">nil</span><span class="op" id="2528555">,</span>&nbsp;<span class="op" id="2528557">&amp;</span><span class="ident" id="2528558"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2528566">{</span><span class="ident" id="2528567">Err</span><span class="op" id="2528570">:</span>&nbsp;<span class="ident" id="2528572"><a href="/net/dnsclient.go.html#2527309">noSuchHost</a></span><span class="op" id="2528582">,</span>&nbsp;<span class="ident" id="2528584">Name</span><span class="op" id="2528588">:</span>&nbsp;<span class="ident" id="2528590"><a href="/net/dnsclient.go.html#2528340">name</a></span><span class="op" id="2528594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528600">if</span>&nbsp;<span class="ident" id="2528603"><a href="/net/dnsclient.go.html#2528361">dns</a></span><span class="op" id="2528606">.</span><span class="ident" id="2528607">rcode</span>&nbsp;<span class="op" id="2528613">!=</span>&nbsp;<span class="ident" id="2528616"><a href="/net/dnsmsg.go.html#2547442">dnsRcodeSuccess</a></span>&nbsp;<span class="op" id="2528632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528636">//&nbsp;None&nbsp;of&nbsp;the&nbsp;error&nbsp;codes&nbsp;make&nbsp;sense</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528676">//&nbsp;for&nbsp;the&nbsp;query&nbsp;we&nbsp;sent.&nbsp;&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;get</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528722">//&nbsp;a&nbsp;name&nbsp;error&nbsp;and&nbsp;we&nbsp;didn&#39;t&nbsp;get&nbsp;success,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528767">//&nbsp;the&nbsp;server&nbsp;is&nbsp;behaving&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528808">return</span>&nbsp;<span class="string" id="2528815">&#34;&#34;</span><span class="op" id="2528817">,</span>&nbsp;<span class="ident" id="2528819">nil</span><span class="op" id="2528822">,</span>&nbsp;<span class="op" id="2528824">&amp;</span><span class="ident" id="2528825"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2528833">{</span><span class="ident" id="2528834">Err</span><span class="op" id="2528837">:</span>&nbsp;<span class="string" id="2528839">&#34;server&nbsp;misbehaving&#34;</span><span class="op" id="2528859">,</span>&nbsp;<span class="ident" id="2528861">Name</span><span class="op" id="2528865">:</span>&nbsp;<span class="ident" id="2528867"><a href="/net/dnsclient.go.html#2528340">name</a></span><span class="op" id="2528871">,</span>&nbsp;<span class="ident" id="2528873">Server</span><span class="op" id="2528879">:</span>&nbsp;<span class="ident" id="2528881"><a href="/net/dnsclient.go.html#2528346">server</a></span><span class="op" id="2528887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528894">//&nbsp;Look&nbsp;for&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528917">//&nbsp;Presotto&nbsp;says&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;assume&nbsp;that&nbsp;servers&nbsp;listed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528978">//&nbsp;/etc/resolv.conf&nbsp;are&nbsp;recursive&nbsp;resolvers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529024">//&nbsp;We&nbsp;asked&nbsp;for&nbsp;recursion,&nbsp;so&nbsp;it&nbsp;should&nbsp;have&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529079">//&nbsp;all&nbsp;the&nbsp;answers&nbsp;we&nbsp;need&nbsp;in&nbsp;this&nbsp;one&nbsp;packet.</span><br>
<span class="lineno">85</span><span class="ident" id="2529126">Cname</span><span class="op" id="2529131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529134">for</span>&nbsp;<span class="ident" id="2529138">cnameloop</span>&nbsp;<span class="op" id="2529148">:=</span>&nbsp;<span class="num" id="2529151">0</span><span class="op" id="2529152">;</span>&nbsp;<span class="ident" id="2529154"><a href="/net/dnsclient.go.html#2529138">cnameloop</a></span>&nbsp;<span class="op" id="2529164">&lt;</span>&nbsp;<span class="num" id="2529166">10</span><span class="op" id="2529168">;</span>&nbsp;<span class="ident" id="2529170"><a href="/net/dnsclient.go.html#2529138">cnameloop</a></span><span class="op" id="2529179">++</span>&nbsp;<span class="op" id="2529182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529186"><a href="/net/dnsclient.go.html#2528403">addrs</a></span>&nbsp;<span class="op" id="2529192">=</span>&nbsp;<span class="ident" id="2529194"><a href="/net/dnsclient.go.html#2528403">addrs</a></span><span class="op" id="2529199">[</span><span class="num" id="2529200">0</span><span class="op" id="2529201">:</span><span class="num" id="2529202">0</span><span class="op" id="2529203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529207">for</span>&nbsp;<span class="ident" id="2529211">_</span><span class="op" id="2529212">,</span>&nbsp;<span class="ident" id="2529214">rr</span>&nbsp;<span class="op" id="2529217">:=</span>&nbsp;<span class="keyword" id="2529220">range</span>&nbsp;<span class="ident" id="2529226"><a href="/net/dnsclient.go.html#2528361">dns</a></span><span class="op" id="2529229">.</span><span class="ident" id="2529230">answer</span>&nbsp;<span class="op" id="2529237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529242">if</span>&nbsp;<span class="ident" id="2529245">_</span><span class="op" id="2529246">,</span>&nbsp;<span class="ident" id="2529248">justHeader</span>&nbsp;<span class="op" id="2529259">:=</span>&nbsp;<span class="ident" id="2529262"><a href="/net/dnsclient.go.html#2529214">rr</a></span><span class="op" id="2529264">.</span><span class="op" id="2529265">(</span><span class="op" id="2529266">*</span><span class="ident" id="2529267"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><span class="op" id="2529279">)</span><span class="op" id="2529280">;</span>&nbsp;<span class="ident" id="2529282"><a href="/net/dnsclient.go.html#2529248">justHeader</a></span>&nbsp;<span class="op" id="2529293">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529299">//&nbsp;Corrupt&nbsp;record:&nbsp;we&nbsp;only&nbsp;have&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529337">//&nbsp;header.&nbsp;That&nbsp;header&nbsp;might&nbsp;say&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529379">//&nbsp;of&nbsp;type&nbsp;qtype,&nbsp;but&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529414">//&nbsp;actually&nbsp;have&nbsp;it.&nbsp;Skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529445">continue</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529462">h</span>&nbsp;<span class="op" id="2529464">:=</span>&nbsp;<span class="ident" id="2529467"><a href="/net/dnsclient.go.html#2529214">rr</a></span><span class="op" id="2529469">.</span><span class="ident" id="2529470">Header</span><span class="op" id="2529476">(</span><span class="op" id="2529477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529482">if</span>&nbsp;<span class="ident" id="2529485"><a href="/net/dnsclient.go.html#2529462">h</a></span><span class="op" id="2529486">.</span><span class="ident" id="2529487">Class</span>&nbsp;<span class="op" id="2529493">==</span>&nbsp;<span class="ident" id="2529496"><a href="/net/dnsmsg.go.html#2547322">dnsClassINET</a></span>&nbsp;<span class="op" id="2529509">&amp;&amp;</span>&nbsp;<span class="ident" id="2529512"><a href="/net/dnsclient.go.html#2529462">h</a></span><span class="op" id="2529513">.</span><span class="ident" id="2529514">Name</span>&nbsp;<span class="op" id="2529519">==</span>&nbsp;<span class="ident" id="2529522"><a href="/net/dnsclient.go.html#2528340">name</a></span>&nbsp;<span class="op" id="2529527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529533">switch</span>&nbsp;<span class="ident" id="2529540"><a href="/net/dnsclient.go.html#2529462">h</a></span><span class="op" id="2529541">.</span><span class="ident" id="2529542">Rrtype</span>&nbsp;<span class="op" id="2529549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529555">case</span>&nbsp;<span class="ident" id="2529560"><a href="/net/dnsclient.go.html#2528374">qtype</a></span><span class="op" id="2529565">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529572"><a href="/net/dnsclient.go.html#2528403">addrs</a></span>&nbsp;<span class="op" id="2529578">=</span>&nbsp;<span class="builtinfunc" id="2529580">append</span><span class="op" id="2529586">(</span><span class="ident" id="2529587"><a href="/net/dnsclient.go.html#2528403">addrs</a></span><span class="op" id="2529592">,</span>&nbsp;<span class="ident" id="2529594"><a href="/net/dnsclient.go.html#2529214">rr</a></span><span class="op" id="2529596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529602">case</span>&nbsp;<span class="ident" id="2529607"><a href="/net/dnsmsg.go.html#2546917">dnsTypeCNAME</a></span><span class="op" id="2529619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529626">//&nbsp;redirect&nbsp;to&nbsp;cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529652"><a href="/net/dnsclient.go.html#2528340">name</a></span>&nbsp;<span class="op" id="2529657">=</span>&nbsp;<span class="ident" id="2529659"><a href="/net/dnsclient.go.html#2529214">rr</a></span><span class="op" id="2529661">.</span><span class="op" id="2529662">(</span><span class="op" id="2529663">*</span><span class="ident" id="2529664"><a href="/net/dnsmsg.go.html#2549953">dnsRR_CNAME</a></span><span class="op" id="2529675">)</span><span class="op" id="2529676">.</span><span class="ident" id="2529677">Cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529688">continue</span>&nbsp;<span class="ident" id="2529697">Cname</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529720">if</span>&nbsp;<span class="builtinfunc" id="2529723">len</span><span class="op" id="2529726">(</span><span class="ident" id="2529727"><a href="/net/dnsclient.go.html#2528403">addrs</a></span><span class="op" id="2529732">)</span>&nbsp;<span class="op" id="2529734">==</span>&nbsp;<span class="num" id="2529737">0</span>&nbsp;<span class="op" id="2529739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529744">return</span>&nbsp;<span class="string" id="2529751">&#34;&#34;</span><span class="op" id="2529753">,</span>&nbsp;<span class="ident" id="2529755">nil</span><span class="op" id="2529758">,</span>&nbsp;<span class="op" id="2529760">&amp;</span><span class="ident" id="2529761"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2529769">{</span><span class="ident" id="2529770">Err</span><span class="op" id="2529773">:</span>&nbsp;<span class="ident" id="2529775"><a href="/net/dnsclient.go.html#2527309">noSuchHost</a></span><span class="op" id="2529785">,</span>&nbsp;<span class="ident" id="2529787">Name</span><span class="op" id="2529791">:</span>&nbsp;<span class="ident" id="2529793"><a href="/net/dnsclient.go.html#2528340">name</a></span><span class="op" id="2529797">,</span>&nbsp;<span class="ident" id="2529799">Server</span><span class="op" id="2529805">:</span>&nbsp;<span class="ident" id="2529807"><a href="/net/dnsclient.go.html#2528346">server</a></span><span class="op" id="2529813">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529821">return</span>&nbsp;<span class="ident" id="2529828"><a href="/net/dnsclient.go.html#2528340">name</a></span><span class="op" id="2529832">,</span>&nbsp;<span class="ident" id="2529834"><a href="/net/dnsclient.go.html#2528403">addrs</a></span><span class="op" id="2529839">,</span>&nbsp;<span class="ident" id="2529841">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529850">return</span>&nbsp;<span class="string" id="2529857">&#34;&#34;</span><span class="op" id="2529859">,</span>&nbsp;<span class="ident" id="2529861">nil</span><span class="op" id="2529864">,</span>&nbsp;<span class="op" id="2529866">&amp;</span><span class="ident" id="2529867"><a href="/net/dnsclient.go.html#2526854">DNSError</a></span><span class="op" id="2529875">{</span><span class="ident" id="2529876">Err</span><span class="op" id="2529879">:</span>&nbsp;<span class="string" id="2529881">&#34;too&nbsp;many&nbsp;redirects&#34;</span><span class="op" id="2529901">,</span>&nbsp;<span class="ident" id="2529903">Name</span><span class="op" id="2529907">:</span>&nbsp;<span class="ident" id="2529909"><a href="/net/dnsclient.go.html#2528340">name</a></span><span class="op" id="2529913">,</span>&nbsp;<span class="ident" id="2529915">Server</span><span class="op" id="2529921">:</span>&nbsp;<span class="ident" id="2529923"><a href="/net/dnsclient.go.html#2528346">server</a></span><span class="op" id="2529929">}</span><br>
<span class="lineno">115</span><span class="op" id="2529931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2529934">func</span>&nbsp;<span class="ident" id="2529939">isDomainName</span><span class="op" id="2529951">(</span><span class="ident" id="2529952">s</span>&nbsp;<span class="builtintype" id="2529954">string</span><span class="op" id="2529960">)</span>&nbsp;<span class="builtintype" id="2529962">bool</span>&nbsp;<span class="op" id="2529967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529970">//&nbsp;See&nbsp;RFC&nbsp;1035,&nbsp;RFC&nbsp;3696.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529998">if</span>&nbsp;<span class="builtinfunc" id="2530001">len</span><span class="op" id="2530004">(</span><span class="ident" id="2530005"><a href="/net/dnsclient.go.html#2529952">s</a></span><span class="op" id="2530006">)</span>&nbsp;<span class="op" id="2530008">==</span>&nbsp;<span class="num" id="2530011">0</span>&nbsp;<span class="op" id="2530013">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530017">return</span>&nbsp;<span class="ident" id="2530024">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530034">if</span>&nbsp;<span class="builtinfunc" id="2530037">len</span><span class="op" id="2530040">(</span><span class="ident" id="2530041"><a href="/net/dnsclient.go.html#2529952">s</a></span><span class="op" id="2530042">)</span>&nbsp;<span class="op" id="2530044">&gt;</span>&nbsp;<span class="num" id="2530046">255</span>&nbsp;<span class="op" id="2530050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530054">return</span>&nbsp;<span class="ident" id="2530061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530068">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530072">last</span>&nbsp;<span class="op" id="2530077">:=</span>&nbsp;<span class="builtintype" id="2530080">byte</span><span class="op" id="2530084">(</span><span class="string" id="2530085">&#39;.&#39;</span><span class="op" id="2530088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530091">ok</span>&nbsp;<span class="op" id="2530094">:=</span>&nbsp;<span class="ident" id="2530097">false</span>&nbsp;<span class="comment" id="2530103">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530136">partlen</span>&nbsp;<span class="op" id="2530144">:=</span>&nbsp;<span class="num" id="2530147">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530150">for</span>&nbsp;<span class="ident" id="2530154">i</span>&nbsp;<span class="op" id="2530156">:=</span>&nbsp;<span class="num" id="2530159">0</span><span class="op" id="2530160">;</span>&nbsp;<span class="ident" id="2530162"><a href="/net/dnsclient.go.html#2530154">i</a></span>&nbsp;<span class="op" id="2530164">&lt;</span>&nbsp;<span class="builtinfunc" id="2530166">len</span><span class="op" id="2530169">(</span><span class="ident" id="2530170"><a href="/net/dnsclient.go.html#2529952">s</a></span><span class="op" id="2530171">)</span><span class="op" id="2530172">;</span>&nbsp;<span class="ident" id="2530174"><a href="/net/dnsclient.go.html#2530154">i</a></span><span class="op" id="2530175">++</span>&nbsp;<span class="op" id="2530178">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530182">c</span>&nbsp;<span class="op" id="2530184">:=</span>&nbsp;<span class="ident" id="2530187"><a href="/net/dnsclient.go.html#2529952">s</a></span><span class="op" id="2530188">[</span><span class="ident" id="2530189"><a href="/net/dnsclient.go.html#2530154">i</a></span><span class="op" id="2530190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530194">switch</span>&nbsp;<span class="op" id="2530201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530205">default</span><span class="op" id="2530212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530217">return</span>&nbsp;<span class="ident" id="2530224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530232">case</span>&nbsp;<span class="string" id="2530237">&#39;a&#39;</span>&nbsp;<span class="op" id="2530241">&lt;=</span>&nbsp;<span class="ident" id="2530244"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530246">&amp;&amp;</span>&nbsp;<span class="ident" id="2530249"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530251">&lt;=</span>&nbsp;<span class="string" id="2530254">&#39;z&#39;</span>&nbsp;<span class="op" id="2530258">||</span>&nbsp;<span class="string" id="2530261">&#39;A&#39;</span>&nbsp;<span class="op" id="2530265">&lt;=</span>&nbsp;<span class="ident" id="2530268"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530270">&amp;&amp;</span>&nbsp;<span class="ident" id="2530273"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530275">&lt;=</span>&nbsp;<span class="string" id="2530278">&#39;Z&#39;</span>&nbsp;<span class="op" id="2530282">||</span>&nbsp;<span class="ident" id="2530285"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530287">==</span>&nbsp;<span class="string" id="2530290">&#39;_&#39;</span><span class="op" id="2530293">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530298"><a href="/net/dnsclient.go.html#2530091">ok</a></span>&nbsp;<span class="op" id="2530301">=</span>&nbsp;<span class="ident" id="2530303">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530311"><a href="/net/dnsclient.go.html#2530136">partlen</a></span><span class="op" id="2530318">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530323">case</span>&nbsp;<span class="string" id="2530328">&#39;0&#39;</span>&nbsp;<span class="op" id="2530332">&lt;=</span>&nbsp;<span class="ident" id="2530335"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530337">&amp;&amp;</span>&nbsp;<span class="ident" id="2530340"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530342">&lt;=</span>&nbsp;<span class="string" id="2530345">&#39;9&#39;</span><span class="op" id="2530348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530353">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530364"><a href="/net/dnsclient.go.html#2530136">partlen</a></span><span class="op" id="2530371">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530376">case</span>&nbsp;<span class="ident" id="2530381"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530383">==</span>&nbsp;<span class="string" id="2530386">&#39;-&#39;</span><span class="op" id="2530389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530394">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530432">if</span>&nbsp;<span class="ident" id="2530435"><a href="/net/dnsclient.go.html#2530072">last</a></span>&nbsp;<span class="op" id="2530440">==</span>&nbsp;<span class="string" id="2530443">&#39;.&#39;</span>&nbsp;<span class="op" id="2530447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530453">return</span>&nbsp;<span class="ident" id="2530460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530469">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530474"><a href="/net/dnsclient.go.html#2530136">partlen</a></span><span class="op" id="2530481">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530486">case</span>&nbsp;<span class="ident" id="2530491"><a href="/net/dnsclient.go.html#2530182">c</a></span>&nbsp;<span class="op" id="2530493">==</span>&nbsp;<span class="string" id="2530496">&#39;.&#39;</span><span class="op" id="2530499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530504">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530547">if</span>&nbsp;<span class="ident" id="2530550"><a href="/net/dnsclient.go.html#2530072">last</a></span>&nbsp;<span class="op" id="2530555">==</span>&nbsp;<span class="string" id="2530558">&#39;.&#39;</span>&nbsp;<span class="op" id="2530562">||</span>&nbsp;<span class="ident" id="2530565"><a href="/net/dnsclient.go.html#2530072">last</a></span>&nbsp;<span class="op" id="2530570">==</span>&nbsp;<span class="string" id="2530573">&#39;-&#39;</span>&nbsp;<span class="op" id="2530577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530583">return</span>&nbsp;<span class="ident" id="2530590">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530604">if</span>&nbsp;<span class="ident" id="2530607"><a href="/net/dnsclient.go.html#2530136">partlen</a></span>&nbsp;<span class="op" id="2530615">&gt;</span>&nbsp;<span class="num" id="2530617">63</span>&nbsp;<span class="op" id="2530620">||</span>&nbsp;<span class="ident" id="2530623"><a href="/net/dnsclient.go.html#2530136">partlen</a></span>&nbsp;<span class="op" id="2530631">==</span>&nbsp;<span class="num" id="2530634">0</span>&nbsp;<span class="op" id="2530636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530642">return</span>&nbsp;<span class="ident" id="2530649">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530663"><a href="/net/dnsclient.go.html#2530136">partlen</a></span>&nbsp;<span class="op" id="2530671">=</span>&nbsp;<span class="num" id="2530673">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530681"><a href="/net/dnsclient.go.html#2530072">last</a></span>&nbsp;<span class="op" id="2530686">=</span>&nbsp;<span class="ident" id="2530688"><a href="/net/dnsclient.go.html#2530182">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530694">if</span>&nbsp;<span class="ident" id="2530697"><a href="/net/dnsclient.go.html#2530072">last</a></span>&nbsp;<span class="op" id="2530702">==</span>&nbsp;<span class="string" id="2530705">&#39;-&#39;</span>&nbsp;<span class="op" id="2530709">||</span>&nbsp;<span class="ident" id="2530712"><a href="/net/dnsclient.go.html#2530136">partlen</a></span>&nbsp;<span class="op" id="2530720">&gt;</span>&nbsp;<span class="num" id="2530722">63</span>&nbsp;<span class="op" id="2530725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530729">return</span>&nbsp;<span class="ident" id="2530736">false</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530747">return</span>&nbsp;<span class="ident" id="2530754"><a href="/net/dnsclient.go.html#2530091">ok</a></span><br>
<span class="lineno"></span><span class="op" id="2530757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2530760">//&nbsp;An&nbsp;SRV&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;SRV&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="2530806">type</span>&nbsp;<span class="ident" id="2530811">SRV</span>&nbsp;<span class="keyword" id="2530815">struct</span>&nbsp;<span class="op" id="2530822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530825">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2530834">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530842">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2530851">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530859">Priority</span>&nbsp;<span class="builtintype" id="2530868">uint16</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530876">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2530885">uint16</span><br>
<span class="lineno"></span><span class="op" id="2530892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2530895">//&nbsp;byPriorityWeight&nbsp;sorts&nbsp;SRV&nbsp;records&nbsp;by&nbsp;ascending&nbsp;priority&nbsp;and&nbsp;weight.</span><br>
<span class="lineno"></span><span class="keyword" id="2530967">type</span>&nbsp;<span class="ident" id="2530972">byPriorityWeight</span>&nbsp;<span class="op" id="2530989">[</span><span class="op" id="2530990">]</span><span class="op" id="2530991">*</span><span class="ident" id="2530992"><a href="/net/dnsclient.go.html#2530811">SRV</a></span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2530997">func</span>&nbsp;<span class="op" id="2531002">(</span><span class="ident" id="2531003">s</span>&nbsp;<span class="ident" id="2531005"><a href="/net/dnsclient.go.html#2530972">byPriorityWeight</a></span><span class="op" id="2531021">)</span>&nbsp;<span class="ident" id="2531023">Len</span><span class="op" id="2531026">(</span><span class="op" id="2531027">)</span>&nbsp;<span class="builtintype" id="2531029">int</span>&nbsp;<span class="op" id="2531033">{</span>&nbsp;<span class="keyword" id="2531035">return</span>&nbsp;<span class="builtinfunc" id="2531042">len</span><span class="op" id="2531045">(</span><span class="ident" id="2531046"><a href="/net/dnsclient.go.html#2531003">s</a></span><span class="op" id="2531047">)</span>&nbsp;<span class="op" id="2531049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2531052">func</span>&nbsp;<span class="op" id="2531057">(</span><span class="ident" id="2531058">s</span>&nbsp;<span class="ident" id="2531060"><a href="/net/dnsclient.go.html#2530972">byPriorityWeight</a></span><span class="op" id="2531076">)</span>&nbsp;<span class="ident" id="2531078">Swap</span><span class="op" id="2531082">(</span><span class="ident" id="2531083">i</span><span class="op" id="2531084">,</span>&nbsp;<span class="ident" id="2531086">j</span>&nbsp;<span class="builtintype" id="2531088">int</span><span class="op" id="2531091">)</span>&nbsp;<span class="op" id="2531093">{</span>&nbsp;<span class="ident" id="2531095"><a href="/net/dnsclient.go.html#2531058">s</a></span><span class="op" id="2531096">[</span><span class="ident" id="2531097"><a href="/net/dnsclient.go.html#2531083">i</a></span><span class="op" id="2531098">]</span><span class="op" id="2531099">,</span>&nbsp;<span class="ident" id="2531101"><a href="/net/dnsclient.go.html#2531058">s</a></span><span class="op" id="2531102">[</span><span class="ident" id="2531103"><a href="/net/dnsclient.go.html#2531086">j</a></span><span class="op" id="2531104">]</span>&nbsp;<span class="op" id="2531106">=</span>&nbsp;<span class="ident" id="2531108"><a href="/net/dnsclient.go.html#2531058">s</a></span><span class="op" id="2531109">[</span><span class="ident" id="2531110"><a href="/net/dnsclient.go.html#2531086">j</a></span><span class="op" id="2531111">]</span><span class="op" id="2531112">,</span>&nbsp;<span class="ident" id="2531114"><a href="/net/dnsclient.go.html#2531058">s</a></span><span class="op" id="2531115">[</span><span class="ident" id="2531116"><a href="/net/dnsclient.go.html#2531083">i</a></span><span class="op" id="2531117">]</span>&nbsp;<span class="op" id="2531119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="2531122">func</span>&nbsp;<span class="op" id="2531127">(</span><span class="ident" id="2531128">s</span>&nbsp;<span class="ident" id="2531130"><a href="/net/dnsclient.go.html#2530972">byPriorityWeight</a></span><span class="op" id="2531146">)</span>&nbsp;<span class="ident" id="2531148">Less</span><span class="op" id="2531152">(</span><span class="ident" id="2531153">i</span><span class="op" id="2531154">,</span>&nbsp;<span class="ident" id="2531156">j</span>&nbsp;<span class="builtintype" id="2531158">int</span><span class="op" id="2531161">)</span>&nbsp;<span class="builtintype" id="2531163">bool</span>&nbsp;<span class="op" id="2531168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531171">return</span>&nbsp;<span class="ident" id="2531178"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531179">[</span><span class="ident" id="2531180"><a href="/net/dnsclient.go.html#2531153">i</a></span><span class="op" id="2531181">]</span><span class="op" id="2531182">.</span><span class="ident" id="2531183">Priority</span>&nbsp;<span class="op" id="2531192">&lt;</span>&nbsp;<span class="ident" id="2531194"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531195">[</span><span class="ident" id="2531196"><a href="/net/dnsclient.go.html#2531156">j</a></span><span class="op" id="2531197">]</span><span class="op" id="2531198">.</span><span class="ident" id="2531199">Priority</span>&nbsp;<span class="op" id="2531208">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531213">(</span><span class="ident" id="2531214"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531215">[</span><span class="ident" id="2531216"><a href="/net/dnsclient.go.html#2531153">i</a></span><span class="op" id="2531217">]</span><span class="op" id="2531218">.</span><span class="ident" id="2531219">Priority</span>&nbsp;<span class="op" id="2531228">==</span>&nbsp;<span class="ident" id="2531231"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531232">[</span><span class="ident" id="2531233"><a href="/net/dnsclient.go.html#2531156">j</a></span><span class="op" id="2531234">]</span><span class="op" id="2531235">.</span><span class="ident" id="2531236">Priority</span>&nbsp;<span class="op" id="2531245">&amp;&amp;</span>&nbsp;<span class="ident" id="2531248"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531249">[</span><span class="ident" id="2531250"><a href="/net/dnsclient.go.html#2531153">i</a></span><span class="op" id="2531251">]</span><span class="op" id="2531252">.</span><span class="ident" id="2531253">Weight</span>&nbsp;<span class="op" id="2531260">&lt;</span>&nbsp;<span class="ident" id="2531262"><a href="/net/dnsclient.go.html#2531128">s</a></span><span class="op" id="2531263">[</span><span class="ident" id="2531264"><a href="/net/dnsclient.go.html#2531156">j</a></span><span class="op" id="2531265">]</span><span class="op" id="2531266">.</span><span class="ident" id="2531267">Weight</span><span class="op" id="2531273">)</span><br>
<span class="lineno"></span><span class="op" id="2531275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="2531278">//&nbsp;shuffleByWeight&nbsp;shuffles&nbsp;SRV&nbsp;records&nbsp;by&nbsp;weight&nbsp;using&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="2531348">//&nbsp;described&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno"></span><span class="keyword" id="2531374">func</span>&nbsp;<span class="op" id="2531379">(</span><span class="ident" id="2531380">addrs</span>&nbsp;<span class="ident" id="2531386"><a href="/net/dnsclient.go.html#2530972">byPriorityWeight</a></span><span class="op" id="2531402">)</span>&nbsp;<span class="ident" id="2531404">shuffleByWeight</span><span class="op" id="2531419">(</span><span class="op" id="2531420">)</span>&nbsp;<span class="op" id="2531422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531425">sum</span>&nbsp;<span class="op" id="2531429">:=</span>&nbsp;<span class="num" id="2531432">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531435">for</span>&nbsp;<span class="ident" id="2531439">_</span><span class="op" id="2531440">,</span>&nbsp;<span class="ident" id="2531442">addr</span>&nbsp;<span class="op" id="2531447">:=</span>&nbsp;<span class="keyword" id="2531450">range</span>&nbsp;<span class="ident" id="2531456"><a href="/net/dnsclient.go.html#2531380">addrs</a></span>&nbsp;<span class="op" id="2531462">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531466"><a href="/net/dnsclient.go.html#2531425">sum</a></span>&nbsp;<span class="op" id="2531470">+=</span>&nbsp;<span class="builtintype" id="2531473">int</span><span class="op" id="2531476">(</span><span class="ident" id="2531477"><a href="/net/dnsclient.go.html#2531442">addr</a></span><span class="op" id="2531481">.</span><span class="ident" id="2531482">Weight</span><span class="op" id="2531488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531494">for</span>&nbsp;<span class="ident" id="2531498"><a href="/net/dnsclient.go.html#2531425">sum</a></span>&nbsp;<span class="op" id="2531502">&gt;</span>&nbsp;<span class="num" id="2531504">0</span>&nbsp;<span class="op" id="2531506">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2531509">len</span><span class="op" id="2531512">(</span><span class="ident" id="2531513"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531518">)</span>&nbsp;<span class="op" id="2531520">&gt;</span>&nbsp;<span class="num" id="2531522">1</span>&nbsp;<span class="op" id="2531524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531528">s</span>&nbsp;<span class="op" id="2531530">:=</span>&nbsp;<span class="num" id="2531533">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531537">n</span>&nbsp;<span class="op" id="2531539">:=</span>&nbsp;<span class="ident" id="2531542"><a href="/net/dnsclient.go.html#2526783">rand</a></span><span class="op" id="2531546">.</span><span class="ident" id="2531547">Intn</span><span class="op" id="2531551">(</span><span class="ident" id="2531552"><a href="/net/dnsclient.go.html#2531425">sum</a></span><span class="op" id="2531555">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531559">for</span>&nbsp;<span class="ident" id="2531563">i</span>&nbsp;<span class="op" id="2531565">:=</span>&nbsp;<span class="keyword" id="2531568">range</span>&nbsp;<span class="ident" id="2531574"><a href="/net/dnsclient.go.html#2531380">addrs</a></span>&nbsp;<span class="op" id="2531580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531585"><a href="/net/dnsclient.go.html#2531528">s</a></span>&nbsp;<span class="op" id="2531587">+=</span>&nbsp;<span class="builtintype" id="2531590">int</span><span class="op" id="2531593">(</span><span class="ident" id="2531594"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531599">[</span><span class="ident" id="2531600"><a href="/net/dnsclient.go.html#2531563">i</a></span><span class="op" id="2531601">]</span><span class="op" id="2531602">.</span><span class="ident" id="2531603">Weight</span><span class="op" id="2531609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531614">if</span>&nbsp;<span class="ident" id="2531617"><a href="/net/dnsclient.go.html#2531528">s</a></span>&nbsp;<span class="op" id="2531619">&gt;</span>&nbsp;<span class="ident" id="2531621"><a href="/net/dnsclient.go.html#2531537">n</a></span>&nbsp;<span class="op" id="2531623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531629">if</span>&nbsp;<span class="ident" id="2531632"><a href="/net/dnsclient.go.html#2531563">i</a></span>&nbsp;<span class="op" id="2531634">&gt;</span>&nbsp;<span class="num" id="2531636">0</span>&nbsp;<span class="op" id="2531638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531645"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531650">[</span><span class="num" id="2531651">0</span><span class="op" id="2531652">]</span><span class="op" id="2531653">,</span>&nbsp;<span class="ident" id="2531655"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531660">[</span><span class="ident" id="2531661"><a href="/net/dnsclient.go.html#2531563">i</a></span><span class="op" id="2531662">]</span>&nbsp;<span class="op" id="2531664">=</span>&nbsp;<span class="ident" id="2531666"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531671">[</span><span class="ident" id="2531672"><a href="/net/dnsclient.go.html#2531563">i</a></span><span class="op" id="2531673">]</span><span class="op" id="2531674">,</span>&nbsp;<span class="ident" id="2531676"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531681">[</span><span class="num" id="2531682">0</span><span class="op" id="2531683">]</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531695">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531712"><a href="/net/dnsclient.go.html#2531425">sum</a></span>&nbsp;<span class="op" id="2531716">-=</span>&nbsp;<span class="builtintype" id="2531719">int</span><span class="op" id="2531722">(</span><span class="ident" id="2531723"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531728">[</span><span class="num" id="2531729">0</span><span class="op" id="2531730">]</span><span class="op" id="2531731">.</span><span class="ident" id="2531732">Weight</span><span class="op" id="2531738">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531742"><a href="/net/dnsclient.go.html#2531380">addrs</a></span>&nbsp;<span class="op" id="2531748">=</span>&nbsp;<span class="ident" id="2531750"><a href="/net/dnsclient.go.html#2531380">addrs</a></span><span class="op" id="2531755">[</span><span class="num" id="2531756">1</span><span class="op" id="2531757">:</span><span class="op" id="2531758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531761">}</span><br>
<span class="lineno"></span><span class="op" id="2531763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2531766">//&nbsp;sort&nbsp;reorders&nbsp;SRV&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno">210</span><span class="keyword" id="2531821">func</span>&nbsp;<span class="op" id="2531826">(</span><span class="ident" id="2531827">addrs</span>&nbsp;<span class="ident" id="2531833"><a href="/net/dnsclient.go.html#2530972">byPriorityWeight</a></span><span class="op" id="2531849">)</span>&nbsp;<span class="ident" id="2531851">sort</span><span class="op" id="2531855">(</span><span class="op" id="2531856">)</span>&nbsp;<span class="op" id="2531858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531861"><a href="/net/dnsclient.go.html#2526796">sort</a></span><span class="op" id="2531865">.</span><span class="ident" id="2531866">Sort</span><span class="op" id="2531870">(</span><span class="ident" id="2531871"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2531876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531879">i</span>&nbsp;<span class="op" id="2531881">:=</span>&nbsp;<span class="num" id="2531884">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531887">for</span>&nbsp;<span class="ident" id="2531891">j</span>&nbsp;<span class="op" id="2531893">:=</span>&nbsp;<span class="num" id="2531896">1</span><span class="op" id="2531897">;</span>&nbsp;<span class="ident" id="2531899"><a href="/net/dnsclient.go.html#2531891">j</a></span>&nbsp;<span class="op" id="2531901">&lt;</span>&nbsp;<span class="builtinfunc" id="2531903">len</span><span class="op" id="2531906">(</span><span class="ident" id="2531907"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2531912">)</span><span class="op" id="2531913">;</span>&nbsp;<span class="ident" id="2531915"><a href="/net/dnsclient.go.html#2531891">j</a></span><span class="op" id="2531916">++</span>&nbsp;<span class="op" id="2531919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531923">if</span>&nbsp;<span class="ident" id="2531926"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2531931">[</span><span class="ident" id="2531932"><a href="/net/dnsclient.go.html#2531879">i</a></span><span class="op" id="2531933">]</span><span class="op" id="2531934">.</span><span class="ident" id="2531935">Priority</span>&nbsp;<span class="op" id="2531944">!=</span>&nbsp;<span class="ident" id="2531947"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2531952">[</span><span class="ident" id="2531953"><a href="/net/dnsclient.go.html#2531891">j</a></span><span class="op" id="2531954">]</span><span class="op" id="2531955">.</span><span class="ident" id="2531956">Priority</span>&nbsp;<span class="op" id="2531965">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531970"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2531975">[</span><span class="ident" id="2531976"><a href="/net/dnsclient.go.html#2531879">i</a></span><span class="op" id="2531977">:</span><span class="ident" id="2531978"><a href="/net/dnsclient.go.html#2531891">j</a></span><span class="op" id="2531979">]</span><span class="op" id="2531980">.</span><span class="ident" id="2531981">shuffleByWeight</span><span class="op" id="2531996">(</span><span class="op" id="2531997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532002"><a href="/net/dnsclient.go.html#2531879">i</a></span>&nbsp;<span class="op" id="2532004">=</span>&nbsp;<span class="ident" id="2532006"><a href="/net/dnsclient.go.html#2531891">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532016"><a href="/net/dnsclient.go.html#2531827">addrs</a></span><span class="op" id="2532021">[</span><span class="ident" id="2532022"><a href="/net/dnsclient.go.html#2531879">i</a></span><span class="op" id="2532023">:</span><span class="op" id="2532024">]</span><span class="op" id="2532025">.</span><span class="ident" id="2532026">shuffleByWeight</span><span class="op" id="2532041">(</span><span class="op" id="2532042">)</span><br>
<span class="lineno">220</span><span class="op" id="2532044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532047">//&nbsp;An&nbsp;MX&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;MX&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="2532091">type</span>&nbsp;<span class="ident" id="2532096">MX</span>&nbsp;<span class="keyword" id="2532099">struct</span>&nbsp;<span class="op" id="2532106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532109">Host</span>&nbsp;<span class="builtintype" id="2532114">string</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532122">Pref</span>&nbsp;<span class="builtintype" id="2532127">uint16</span><br>
<span class="lineno"></span><span class="op" id="2532134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532137">//&nbsp;byPref&nbsp;implements&nbsp;sort.Interface&nbsp;to&nbsp;sort&nbsp;MX&nbsp;records&nbsp;by&nbsp;preference</span><br>
<span class="lineno"></span><span class="keyword" id="2532206">type</span>&nbsp;<span class="ident" id="2532211">byPref</span>&nbsp;<span class="op" id="2532218">[</span><span class="op" id="2532219">]</span><span class="op" id="2532220">*</span><span class="ident" id="2532221"><a href="/net/dnsclient.go.html#2532096">MX</a></span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2532225">func</span>&nbsp;<span class="op" id="2532230">(</span><span class="ident" id="2532231">s</span>&nbsp;<span class="ident" id="2532233"><a href="/net/dnsclient.go.html#2532211">byPref</a></span><span class="op" id="2532239">)</span>&nbsp;<span class="ident" id="2532241">Len</span><span class="op" id="2532244">(</span><span class="op" id="2532245">)</span>&nbsp;<span class="builtintype" id="2532247">int</span>&nbsp;<span class="op" id="2532251">{</span>&nbsp;<span class="keyword" id="2532253">return</span>&nbsp;<span class="builtinfunc" id="2532260">len</span><span class="op" id="2532263">(</span><span class="ident" id="2532264"><a href="/net/dnsclient.go.html#2532231">s</a></span><span class="op" id="2532265">)</span>&nbsp;<span class="op" id="2532267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2532270">func</span>&nbsp;<span class="op" id="2532275">(</span><span class="ident" id="2532276">s</span>&nbsp;<span class="ident" id="2532278"><a href="/net/dnsclient.go.html#2532211">byPref</a></span><span class="op" id="2532284">)</span>&nbsp;<span class="ident" id="2532286">Less</span><span class="op" id="2532290">(</span><span class="ident" id="2532291">i</span><span class="op" id="2532292">,</span>&nbsp;<span class="ident" id="2532294">j</span>&nbsp;<span class="builtintype" id="2532296">int</span><span class="op" id="2532299">)</span>&nbsp;<span class="builtintype" id="2532301">bool</span>&nbsp;<span class="op" id="2532306">{</span>&nbsp;<span class="keyword" id="2532308">return</span>&nbsp;<span class="ident" id="2532315"><a href="/net/dnsclient.go.html#2532276">s</a></span><span class="op" id="2532316">[</span><span class="ident" id="2532317"><a href="/net/dnsclient.go.html#2532291">i</a></span><span class="op" id="2532318">]</span><span class="op" id="2532319">.</span><span class="ident" id="2532320">Pref</span>&nbsp;<span class="op" id="2532325">&lt;</span>&nbsp;<span class="ident" id="2532327"><a href="/net/dnsclient.go.html#2532276">s</a></span><span class="op" id="2532328">[</span><span class="ident" id="2532329"><a href="/net/dnsclient.go.html#2532294">j</a></span><span class="op" id="2532330">]</span><span class="op" id="2532331">.</span><span class="ident" id="2532332">Pref</span>&nbsp;<span class="op" id="2532337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2532340">func</span>&nbsp;<span class="op" id="2532345">(</span><span class="ident" id="2532346">s</span>&nbsp;<span class="ident" id="2532348"><a href="/net/dnsclient.go.html#2532211">byPref</a></span><span class="op" id="2532354">)</span>&nbsp;<span class="ident" id="2532356">Swap</span><span class="op" id="2532360">(</span><span class="ident" id="2532361">i</span><span class="op" id="2532362">,</span>&nbsp;<span class="ident" id="2532364">j</span>&nbsp;<span class="builtintype" id="2532366">int</span><span class="op" id="2532369">)</span>&nbsp;<span class="op" id="2532371">{</span>&nbsp;<span class="ident" id="2532373"><a href="/net/dnsclient.go.html#2532346">s</a></span><span class="op" id="2532374">[</span><span class="ident" id="2532375"><a href="/net/dnsclient.go.html#2532361">i</a></span><span class="op" id="2532376">]</span><span class="op" id="2532377">,</span>&nbsp;<span class="ident" id="2532379"><a href="/net/dnsclient.go.html#2532346">s</a></span><span class="op" id="2532380">[</span><span class="ident" id="2532381"><a href="/net/dnsclient.go.html#2532364">j</a></span><span class="op" id="2532382">]</span>&nbsp;<span class="op" id="2532384">=</span>&nbsp;<span class="ident" id="2532386"><a href="/net/dnsclient.go.html#2532346">s</a></span><span class="op" id="2532387">[</span><span class="ident" id="2532388"><a href="/net/dnsclient.go.html#2532364">j</a></span><span class="op" id="2532389">]</span><span class="op" id="2532390">,</span>&nbsp;<span class="ident" id="2532392"><a href="/net/dnsclient.go.html#2532346">s</a></span><span class="op" id="2532393">[</span><span class="ident" id="2532394"><a href="/net/dnsclient.go.html#2532361">i</a></span><span class="op" id="2532395">]</span>&nbsp;<span class="op" id="2532397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532400">//&nbsp;sort&nbsp;reorders&nbsp;MX&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="keyword" id="2532454">func</span>&nbsp;<span class="op" id="2532459">(</span><span class="ident" id="2532460">s</span>&nbsp;<span class="ident" id="2532462"><a href="/net/dnsclient.go.html#2532211">byPref</a></span><span class="op" id="2532468">)</span>&nbsp;<span class="ident" id="2532470">sort</span><span class="op" id="2532474">(</span><span class="op" id="2532475">)</span>&nbsp;<span class="op" id="2532477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532480">for</span>&nbsp;<span class="ident" id="2532484">i</span>&nbsp;<span class="op" id="2532486">:=</span>&nbsp;<span class="keyword" id="2532489">range</span>&nbsp;<span class="ident" id="2532495"><a href="/net/dnsclient.go.html#2532460">s</a></span>&nbsp;<span class="op" id="2532497">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532501">j</span>&nbsp;<span class="op" id="2532503">:=</span>&nbsp;<span class="ident" id="2532506"><a href="/net/dnsclient.go.html#2526783">rand</a></span><span class="op" id="2532510">.</span><span class="ident" id="2532511">Intn</span><span class="op" id="2532515">(</span><span class="ident" id="2532516"><a href="/net/dnsclient.go.html#2532484">i</a></span>&nbsp;<span class="op" id="2532518">+</span>&nbsp;<span class="num" id="2532520">1</span><span class="op" id="2532521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532525"><a href="/net/dnsclient.go.html#2532460">s</a></span><span class="op" id="2532526">[</span><span class="ident" id="2532527"><a href="/net/dnsclient.go.html#2532484">i</a></span><span class="op" id="2532528">]</span><span class="op" id="2532529">,</span>&nbsp;<span class="ident" id="2532531"><a href="/net/dnsclient.go.html#2532460">s</a></span><span class="op" id="2532532">[</span><span class="ident" id="2532533"><a href="/net/dnsclient.go.html#2532501">j</a></span><span class="op" id="2532534">]</span>&nbsp;<span class="op" id="2532536">=</span>&nbsp;<span class="ident" id="2532538"><a href="/net/dnsclient.go.html#2532460">s</a></span><span class="op" id="2532539">[</span><span class="ident" id="2532540"><a href="/net/dnsclient.go.html#2532501">j</a></span><span class="op" id="2532541">]</span><span class="op" id="2532542">,</span>&nbsp;<span class="ident" id="2532544"><a href="/net/dnsclient.go.html#2532460">s</a></span><span class="op" id="2532545">[</span><span class="ident" id="2532546"><a href="/net/dnsclient.go.html#2532484">i</a></span><span class="op" id="2532547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532553"><a href="/net/dnsclient.go.html#2526796">sort</a></span><span class="op" id="2532557">.</span><span class="ident" id="2532558">Sort</span><span class="op" id="2532562">(</span><span class="ident" id="2532563"><a href="/net/dnsclient.go.html#2532460">s</a></span><span class="op" id="2532564">)</span><br>
<span class="lineno"></span><span class="op" id="2532566">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="2532569">//&nbsp;An&nbsp;NS&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;NS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="2532613">type</span>&nbsp;<span class="ident" id="2532618">NS</span>&nbsp;<span class="keyword" id="2532621">struct</span>&nbsp;<span class="op" id="2532628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532631">Host</span>&nbsp;<span class="builtintype" id="2532636">string</span><br>
<span class="lineno"></span><span class="op" id="2532643">}</span>
</div>
</body>
</html>
