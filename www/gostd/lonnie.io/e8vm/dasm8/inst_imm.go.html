<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/dasm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/dasm.go.html">dasm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/line.go.html">line.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/reg.go.html">reg.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3696409">package</span>&nbsp;<span class="ident" id="3696417">dasm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3696424">import</span>&nbsp;<span class="op" id="3696431">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3696434">&#34;fmt&#34;</span><br>
<span class="lineno">5</span><span class="op" id="3696440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3696443">var</span>&nbsp;<span class="op" id="3696447">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696450">opImsMap</span>&nbsp;<span class="op" id="3696459">=</span>&nbsp;<span class="keyword" id="3696461">map</span><span class="op" id="3696464">[</span><span class="builtintype" id="3696465">uint32</span><span class="op" id="3696471">]</span><span class="builtintype" id="3696472">string</span><span class="op" id="3696478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696482">1</span><span class="op" id="3696483">:</span>&nbsp;<span class="string" id="3696485">&#34;addi&#34;</span><span class="op" id="3696491">,</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696495">2</span><span class="op" id="3696496">:</span>&nbsp;<span class="string" id="3696498">&#34;slti&#34;</span><span class="op" id="3696504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696511">opMemMap</span>&nbsp;<span class="op" id="3696520">=</span>&nbsp;<span class="keyword" id="3696522">map</span><span class="op" id="3696525">[</span><span class="builtintype" id="3696526">uint32</span><span class="op" id="3696532">]</span><span class="builtintype" id="3696533">string</span><span class="op" id="3696539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696543">6</span><span class="op" id="3696544">:</span>&nbsp;&nbsp;<span class="string" id="3696547">&#34;lw&#34;</span><span class="op" id="3696551">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696555">7</span><span class="op" id="3696556">:</span>&nbsp;&nbsp;<span class="string" id="3696559">&#34;lb&#34;</span><span class="op" id="3696563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696567">8</span><span class="op" id="3696568">:</span>&nbsp;&nbsp;<span class="string" id="3696571">&#34;lbu&#34;</span><span class="op" id="3696576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696580">9</span><span class="op" id="3696581">:</span>&nbsp;&nbsp;<span class="string" id="3696584">&#34;sw&#34;</span><span class="op" id="3696588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696592">10</span><span class="op" id="3696594">:</span>&nbsp;<span class="string" id="3696596">&#34;sb&#34;</span><span class="op" id="3696600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696603">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696607">opImuMap</span>&nbsp;<span class="op" id="3696616">=</span>&nbsp;<span class="keyword" id="3696618">map</span><span class="op" id="3696621">[</span><span class="builtintype" id="3696622">uint32</span><span class="op" id="3696628">]</span><span class="builtintype" id="3696629">string</span><span class="op" id="3696635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696639">3</span><span class="op" id="3696640">:</span>&nbsp;<span class="string" id="3696642">&#34;andi&#34;</span><span class="op" id="3696648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696652">4</span><span class="op" id="3696653">:</span>&nbsp;<span class="string" id="3696655">&#34;ori&#34;</span><span class="op" id="3696660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696663">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696667">opImu2Map</span>&nbsp;<span class="op" id="3696677">=</span>&nbsp;<span class="keyword" id="3696679">map</span><span class="op" id="3696682">[</span><span class="builtintype" id="3696683">uint32</span><span class="op" id="3696689">]</span><span class="builtintype" id="3696690">string</span><span class="op" id="3696696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3696700">5</span><span class="op" id="3696701">:</span>&nbsp;<span class="string" id="3696703">&#34;lui&#34;</span><span class="op" id="3696708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696711">}</span><br>
<span class="lineno"></span><span class="op" id="3696713">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3696716">func</span>&nbsp;<span class="ident" id="3696721">instImm</span><span class="op" id="3696728">(</span><span class="ident" id="3696729">addr</span>&nbsp;<span class="builtintype" id="3696734">uint32</span><span class="op" id="3696740">,</span>&nbsp;<span class="ident" id="3696742">in</span>&nbsp;<span class="builtintype" id="3696745">uint32</span><span class="op" id="3696751">)</span>&nbsp;<span class="op" id="3696753">*</span><span class="ident" id="3696754">Line</span>&nbsp;<span class="op" id="3696759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696762">op</span>&nbsp;<span class="op" id="3696765">:=</span>&nbsp;<span class="op" id="3696768">(</span><span class="ident" id="3696769">in</span>&nbsp;<span class="op" id="3696772">&gt;&gt;</span>&nbsp;<span class="num" id="3696775">24</span><span class="op" id="3696777">)</span>&nbsp;<span class="op" id="3696779">&amp;</span>&nbsp;<span class="num" id="3696781">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696787">dest</span>&nbsp;<span class="op" id="3696792">:=</span>&nbsp;<span class="ident" id="3696795">regStr</span><span class="op" id="3696801">(</span><span class="op" id="3696802">(</span><span class="ident" id="3696803">in</span>&nbsp;<span class="op" id="3696806">&gt;&gt;</span>&nbsp;<span class="num" id="3696809">21</span><span class="op" id="3696811">)</span>&nbsp;<span class="op" id="3696813">&amp;</span>&nbsp;<span class="num" id="3696815">0x7</span><span class="op" id="3696818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696821">src</span>&nbsp;<span class="op" id="3696825">:=</span>&nbsp;<span class="ident" id="3696828">regStr</span><span class="op" id="3696834">(</span><span class="op" id="3696835">(</span><span class="ident" id="3696836">in</span>&nbsp;<span class="op" id="3696839">&gt;&gt;</span>&nbsp;<span class="num" id="3696842">18</span><span class="op" id="3696844">)</span>&nbsp;<span class="op" id="3696846">&amp;</span>&nbsp;<span class="num" id="3696848">0x7</span><span class="op" id="3696851">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696854">imu</span>&nbsp;<span class="op" id="3696858">:=</span>&nbsp;<span class="ident" id="3696861">in</span>&nbsp;<span class="op" id="3696864">&amp;</span>&nbsp;<span class="num" id="3696866">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696874">ims</span>&nbsp;<span class="op" id="3696878">:=</span>&nbsp;<span class="builtintype" id="3696881">int32</span><span class="op" id="3696886">(</span><span class="ident" id="3696887">imu</span><span class="op" id="3696890">&lt;&lt;</span><span class="num" id="3696892">16</span><span class="op" id="3696894">)</span>&nbsp;<span class="op" id="3696896">&gt;&gt;</span>&nbsp;<span class="num" id="3696899">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696904">var</span>&nbsp;<span class="ident" id="3696908">s</span>&nbsp;<span class="builtintype" id="3696910">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696918">if</span>&nbsp;<span class="ident" id="3696921">opStr</span><span class="op" id="3696926">,</span>&nbsp;<span class="ident" id="3696928">found</span>&nbsp;<span class="op" id="3696934">:=</span>&nbsp;<span class="ident" id="3696937">opImsMap</span><span class="op" id="3696945">[</span><span class="ident" id="3696946">op</span><span class="op" id="3696948">]</span><span class="op" id="3696949">;</span>&nbsp;<span class="ident" id="3696951">found</span>&nbsp;<span class="op" id="3696957">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696961">s</span>&nbsp;<span class="op" id="3696963">=</span>&nbsp;<span class="ident" id="3696965">fmt</span><span class="op" id="3696968">.</span><span class="ident" id="3696969">Sprintf</span><span class="op" id="3696976">(</span><span class="string" id="3696977">&#34;%s&nbsp;%s&nbsp;%s&nbsp;%d&#34;</span><span class="op" id="3696990">,</span>&nbsp;<span class="ident" id="3696992">opStr</span><span class="op" id="3696997">,</span>&nbsp;<span class="ident" id="3696999">dest</span><span class="op" id="3697003">,</span>&nbsp;<span class="ident" id="3697005">src</span><span class="op" id="3697008">,</span>&nbsp;<span class="ident" id="3697010">ims</span><span class="op" id="3697013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697016">}</span>&nbsp;<span class="keyword" id="3697018">else</span>&nbsp;<span class="keyword" id="3697023">if</span>&nbsp;<span class="ident" id="3697026">opStr</span><span class="op" id="3697031">,</span>&nbsp;<span class="ident" id="3697033">found</span>&nbsp;<span class="op" id="3697039">:=</span>&nbsp;<span class="ident" id="3697042">opMemMap</span><span class="op" id="3697050">[</span><span class="ident" id="3697051">op</span><span class="op" id="3697053">]</span><span class="op" id="3697054">;</span>&nbsp;<span class="ident" id="3697056">found</span>&nbsp;<span class="op" id="3697062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697066">if</span>&nbsp;<span class="ident" id="3697069">ims</span>&nbsp;<span class="op" id="3697073">==</span>&nbsp;<span class="num" id="3697076">0</span>&nbsp;<span class="op" id="3697078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697083">s</span>&nbsp;<span class="op" id="3697085">=</span>&nbsp;<span class="ident" id="3697087">fmt</span><span class="op" id="3697090">.</span><span class="ident" id="3697091">Sprintf</span><span class="op" id="3697098">(</span><span class="string" id="3697099">&#34;%s&nbsp;%s&nbsp;%s&#34;</span><span class="op" id="3697109">,</span>&nbsp;<span class="ident" id="3697111">opStr</span><span class="op" id="3697116">,</span>&nbsp;<span class="ident" id="3697118">dest</span><span class="op" id="3697122">,</span>&nbsp;<span class="ident" id="3697124">src</span><span class="op" id="3697127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697131">}</span>&nbsp;<span class="keyword" id="3697133">else</span>&nbsp;<span class="op" id="3697138">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697143">s</span>&nbsp;<span class="op" id="3697145">=</span>&nbsp;<span class="ident" id="3697147">fmt</span><span class="op" id="3697150">.</span><span class="ident" id="3697151">Sprintf</span><span class="op" id="3697158">(</span><span class="string" id="3697159">&#34;%s&nbsp;%s&nbsp;%s&nbsp;%d&#34;</span><span class="op" id="3697172">,</span>&nbsp;<span class="ident" id="3697174">opStr</span><span class="op" id="3697179">,</span>&nbsp;<span class="ident" id="3697181">dest</span><span class="op" id="3697185">,</span>&nbsp;<span class="ident" id="3697187">src</span><span class="op" id="3697190">,</span>&nbsp;<span class="ident" id="3697192">ims</span><span class="op" id="3697195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697202">}</span>&nbsp;<span class="keyword" id="3697204">else</span>&nbsp;<span class="keyword" id="3697209">if</span>&nbsp;<span class="ident" id="3697212">opStr</span><span class="op" id="3697217">,</span>&nbsp;<span class="ident" id="3697219">found</span>&nbsp;<span class="op" id="3697225">:=</span>&nbsp;<span class="ident" id="3697228">opImuMap</span><span class="op" id="3697236">[</span><span class="ident" id="3697237">op</span><span class="op" id="3697239">]</span><span class="op" id="3697240">;</span>&nbsp;<span class="ident" id="3697242">found</span>&nbsp;<span class="op" id="3697248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697252">s</span>&nbsp;<span class="op" id="3697254">=</span>&nbsp;<span class="ident" id="3697256">fmt</span><span class="op" id="3697259">.</span><span class="ident" id="3697260">Sprintf</span><span class="op" id="3697267">(</span><span class="string" id="3697268">&#34;%s&nbsp;%s&nbsp;%s&nbsp;0x%04x&#34;</span><span class="op" id="3697285">,</span>&nbsp;<span class="ident" id="3697287">opStr</span><span class="op" id="3697292">,</span>&nbsp;<span class="ident" id="3697294">dest</span><span class="op" id="3697298">,</span>&nbsp;<span class="ident" id="3697300">src</span><span class="op" id="3697303">,</span>&nbsp;<span class="ident" id="3697305">imu</span><span class="op" id="3697308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697311">}</span>&nbsp;<span class="keyword" id="3697313">else</span>&nbsp;<span class="keyword" id="3697318">if</span>&nbsp;<span class="ident" id="3697321">opStr</span><span class="op" id="3697326">,</span>&nbsp;<span class="ident" id="3697328">found</span>&nbsp;<span class="op" id="3697334">:=</span>&nbsp;<span class="ident" id="3697337">opImu2Map</span><span class="op" id="3697346">[</span><span class="ident" id="3697347">op</span><span class="op" id="3697349">]</span><span class="op" id="3697350">;</span>&nbsp;<span class="ident" id="3697352">found</span>&nbsp;<span class="op" id="3697358">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697362">s</span>&nbsp;<span class="op" id="3697364">=</span>&nbsp;<span class="ident" id="3697366">fmt</span><span class="op" id="3697369">.</span><span class="ident" id="3697370">Sprintf</span><span class="op" id="3697377">(</span><span class="string" id="3697378">&#34;%s&nbsp;%s&nbsp;0x%04x&#34;</span><span class="op" id="3697392">,</span>&nbsp;<span class="ident" id="3697394">opStr</span><span class="op" id="3697399">,</span>&nbsp;<span class="ident" id="3697401">dest</span><span class="op" id="3697405">,</span>&nbsp;<span class="ident" id="3697407">imu</span><span class="op" id="3697410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697417">ret</span>&nbsp;<span class="op" id="3697421">:=</span>&nbsp;<span class="ident" id="3697424">newLine</span><span class="op" id="3697431">(</span><span class="ident" id="3697432">addr</span><span class="op" id="3697436">,</span>&nbsp;<span class="ident" id="3697438">in</span><span class="op" id="3697440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697443">ret</span><span class="op" id="3697446">.</span><span class="ident" id="3697447">Str</span>&nbsp;<span class="op" id="3697451">=</span>&nbsp;<span class="ident" id="3697453">s</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697457">return</span>&nbsp;<span class="ident" id="3697464">ret</span><br>
<span class="lineno"></span><span class="op" id="3697468">}</span>
</div>
</body>
</html>
