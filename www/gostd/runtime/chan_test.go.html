<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html" class="current">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="847208">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="847263">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="847317">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="847368">package</span>&nbsp;<span class="ident" id="847376">runtime_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="847390">import</span>&nbsp;<span class="op" id="847397">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="847400">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="847411">&#34;sync&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="847419">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="847434">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="847445">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="847452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="847455">func</span>&nbsp;<span class="ident" id="847460">TestChan</span><span class="op" id="847468">(</span><span class="ident" id="847469">t</span>&nbsp;<span class="op" id="847471">*</span><span class="ident" id="847472">testing</span><span class="op" id="847479">.</span><span class="ident" id="847480">T</span><span class="op" id="847481">)</span>&nbsp;<span class="op" id="847483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847486">defer</span>&nbsp;<span class="ident" id="847492">runtime</span><span class="op" id="847499">.</span><span class="ident" id="847500">GOMAXPROCS</span><span class="op" id="847510">(</span><span class="ident" id="847511">runtime</span><span class="op" id="847518">.</span><span class="ident" id="847519">GOMAXPROCS</span><span class="op" id="847529">(</span><span class="num" id="847530">4</span><span class="op" id="847531">)</span><span class="op" id="847532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847535">N</span>&nbsp;<span class="op" id="847537">:=</span>&nbsp;<span class="num" id="847540">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847545">if</span>&nbsp;<span class="ident" id="847548">testing</span><span class="op" id="847555">.</span><span class="ident" id="847556">Short</span><span class="op" id="847561">(</span><span class="op" id="847562">)</span>&nbsp;<span class="op" id="847564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847568">N</span>&nbsp;<span class="op" id="847570">=</span>&nbsp;<span class="num" id="847572">20</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="847576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847579">for</span>&nbsp;<span class="ident" id="847583">chanCap</span>&nbsp;<span class="op" id="847591">:=</span>&nbsp;<span class="num" id="847594">0</span><span class="op" id="847595">;</span>&nbsp;<span class="ident" id="847597">chanCap</span>&nbsp;<span class="op" id="847605">&lt;</span>&nbsp;<span class="ident" id="847607">N</span><span class="op" id="847608">;</span>&nbsp;<span class="ident" id="847610">chanCap</span><span class="op" id="847617">++</span>&nbsp;<span class="op" id="847620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="847624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="847629">//&nbsp;Ensure&nbsp;that&nbsp;receive&nbsp;from&nbsp;empty&nbsp;chan&nbsp;blocks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847679">c</span>&nbsp;<span class="op" id="847681">:=</span>&nbsp;<span class="builtinfunc" id="847684">make</span><span class="op" id="847688">(</span><span class="keyword" id="847689">chan</span>&nbsp;<span class="builtintype" id="847694">int</span><span class="op" id="847697">,</span>&nbsp;<span class="ident" id="847699">chanCap</span><span class="op" id="847706">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847711">recv1</span>&nbsp;<span class="op" id="847717">:=</span>&nbsp;<span class="builtintype" id="847720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847729">go</span>&nbsp;<span class="keyword" id="847732">func</span><span class="op" id="847736">(</span><span class="op" id="847737">)</span>&nbsp;<span class="op" id="847739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847745">_</span>&nbsp;<span class="op" id="847747">=</span>&nbsp;<span class="op" id="847749">&lt;-</span><span class="ident" id="847751">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847757">recv1</span>&nbsp;<span class="op" id="847763">=</span>&nbsp;<span class="builtintype" id="847765">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="847773">}</span><span class="op" id="847774">(</span><span class="op" id="847775">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847780">recv2</span>&nbsp;<span class="op" id="847786">:=</span>&nbsp;<span class="builtintype" id="847789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847798">go</span>&nbsp;<span class="keyword" id="847801">func</span><span class="op" id="847805">(</span><span class="op" id="847806">)</span>&nbsp;<span class="op" id="847808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847814">_</span><span class="op" id="847815">,</span>&nbsp;<span class="ident" id="847817">_</span>&nbsp;<span class="op" id="847819">=</span>&nbsp;<span class="op" id="847821">&lt;-</span><span class="ident" id="847823">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847829">recv2</span>&nbsp;<span class="op" id="847835">=</span>&nbsp;<span class="builtintype" id="847837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="847845">}</span><span class="op" id="847846">(</span><span class="op" id="847847">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847852">time</span><span class="op" id="847856">.</span><span class="ident" id="847857">Sleep</span><span class="op" id="847862">(</span><span class="ident" id="847863">time</span><span class="op" id="847867">.</span><span class="ident" id="847868">Millisecond</span><span class="op" id="847879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="847884">if</span>&nbsp;<span class="ident" id="847887">recv1</span>&nbsp;<span class="op" id="847893">||</span>&nbsp;<span class="ident" id="847896">recv2</span>&nbsp;<span class="op" id="847902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="847908">t</span><span class="op" id="847909">.</span><span class="ident" id="847910">Fatalf</span><span class="op" id="847916">(</span><span class="string" id="847917">&#34;chan[%d]:&nbsp;receive&nbsp;from&nbsp;empty&nbsp;chan&#34;</span><span class="op" id="847952">,</span>&nbsp;<span class="ident" id="847954">chanCap</span><span class="op" id="847961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="847966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="847971">//&nbsp;Ensure&nbsp;that&nbsp;non-blocking&nbsp;receive&nbsp;does&nbsp;not&nbsp;block.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848026">select</span>&nbsp;<span class="op" id="848033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848038">case</span>&nbsp;<span class="ident" id="848043">_</span>&nbsp;<span class="op" id="848045">=</span>&nbsp;<span class="op" id="848047">&lt;-</span><span class="ident" id="848049">c</span><span class="op" id="848050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848056">t</span><span class="op" id="848057">.</span><span class="ident" id="848058">Fatalf</span><span class="op" id="848064">(</span><span class="string" id="848065">&#34;chan[%d]:&nbsp;receive&nbsp;from&nbsp;empty&nbsp;chan&#34;</span><span class="op" id="848100">,</span>&nbsp;<span class="ident" id="848102">chanCap</span><span class="op" id="848109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848114">default</span><span class="op" id="848121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848126">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848131">select</span>&nbsp;<span class="op" id="848138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848143">case</span>&nbsp;<span class="ident" id="848148">_</span><span class="op" id="848149">,</span>&nbsp;<span class="ident" id="848151">_</span>&nbsp;<span class="op" id="848153">=</span>&nbsp;<span class="op" id="848155">&lt;-</span><span class="ident" id="848157">c</span><span class="op" id="848158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848164">t</span><span class="op" id="848165">.</span><span class="ident" id="848166">Fatalf</span><span class="op" id="848172">(</span><span class="string" id="848173">&#34;chan[%d]:&nbsp;receive&nbsp;from&nbsp;empty&nbsp;chan&#34;</span><span class="op" id="848208">,</span>&nbsp;<span class="ident" id="848210">chanCap</span><span class="op" id="848217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848222">default</span><span class="op" id="848229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848234">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848239">c</span>&nbsp;<span class="op" id="848241">&lt;-</span>&nbsp;<span class="num" id="848244">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848249">c</span>&nbsp;<span class="op" id="848251">&lt;-</span>&nbsp;<span class="num" id="848254">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848263">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="848268">//&nbsp;Ensure&nbsp;that&nbsp;send&nbsp;to&nbsp;full&nbsp;chan&nbsp;blocks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848312">c</span>&nbsp;<span class="op" id="848314">:=</span>&nbsp;<span class="builtinfunc" id="848317">make</span><span class="op" id="848321">(</span><span class="keyword" id="848322">chan</span>&nbsp;<span class="builtintype" id="848327">int</span><span class="op" id="848330">,</span>&nbsp;<span class="ident" id="848332">chanCap</span><span class="op" id="848339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848344">for</span>&nbsp;<span class="ident" id="848348">i</span>&nbsp;<span class="op" id="848350">:=</span>&nbsp;<span class="num" id="848353">0</span><span class="op" id="848354">;</span>&nbsp;<span class="ident" id="848356">i</span>&nbsp;<span class="op" id="848358">&lt;</span>&nbsp;<span class="ident" id="848360">chanCap</span><span class="op" id="848367">;</span>&nbsp;<span class="ident" id="848369">i</span><span class="op" id="848370">++</span>&nbsp;<span class="op" id="848373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848379">c</span>&nbsp;<span class="op" id="848381">&lt;-</span>&nbsp;<span class="ident" id="848384">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848389">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848394">sent</span>&nbsp;<span class="op" id="848399">:=</span>&nbsp;<span class="builtintype" id="848402">uint32</span><span class="op" id="848408">(</span><span class="num" id="848409">0</span><span class="op" id="848410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848415">go</span>&nbsp;<span class="keyword" id="848418">func</span><span class="op" id="848422">(</span><span class="op" id="848423">)</span>&nbsp;<span class="op" id="848425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848431">c</span>&nbsp;<span class="op" id="848433">&lt;-</span>&nbsp;<span class="num" id="848436">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848442">atomic</span><span class="op" id="848448">.</span><span class="ident" id="848449">StoreUint32</span><span class="op" id="848460">(</span><span class="op" id="848461">&amp;</span><span class="ident" id="848462">sent</span><span class="op" id="848466">,</span>&nbsp;<span class="num" id="848468">1</span><span class="op" id="848469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848474">}</span><span class="op" id="848475">(</span><span class="op" id="848476">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848481">time</span><span class="op" id="848485">.</span><span class="ident" id="848486">Sleep</span><span class="op" id="848491">(</span><span class="ident" id="848492">time</span><span class="op" id="848496">.</span><span class="ident" id="848497">Millisecond</span><span class="op" id="848508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848513">if</span>&nbsp;<span class="ident" id="848516">atomic</span><span class="op" id="848522">.</span><span class="ident" id="848523">LoadUint32</span><span class="op" id="848533">(</span><span class="op" id="848534">&amp;</span><span class="ident" id="848535">sent</span><span class="op" id="848539">)</span>&nbsp;<span class="op" id="848541">!=</span>&nbsp;<span class="num" id="848544">0</span>&nbsp;<span class="op" id="848546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848552">t</span><span class="op" id="848553">.</span><span class="ident" id="848554">Fatalf</span><span class="op" id="848560">(</span><span class="string" id="848561">&#34;chan[%d]:&nbsp;send&nbsp;to&nbsp;full&nbsp;chan&#34;</span><span class="op" id="848590">,</span>&nbsp;<span class="ident" id="848592">chanCap</span><span class="op" id="848599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="848609">//&nbsp;Ensure&nbsp;that&nbsp;non-blocking&nbsp;send&nbsp;does&nbsp;not&nbsp;block.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848661">select</span>&nbsp;<span class="op" id="848668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848673">case</span>&nbsp;<span class="ident" id="848678">c</span>&nbsp;<span class="op" id="848680">&lt;-</span>&nbsp;<span class="num" id="848683">0</span><span class="op" id="848684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848690">t</span><span class="op" id="848691">.</span><span class="ident" id="848692">Fatalf</span><span class="op" id="848698">(</span><span class="string" id="848699">&#34;chan[%d]:&nbsp;send&nbsp;to&nbsp;full&nbsp;chan&#34;</span><span class="op" id="848728">,</span>&nbsp;<span class="ident" id="848730">chanCap</span><span class="op" id="848737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848742">default</span><span class="op" id="848749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848754">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848759">&lt;-</span><span class="ident" id="848761">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="848775">//&nbsp;Ensure&nbsp;that&nbsp;we&nbsp;receive&nbsp;0&nbsp;from&nbsp;closed&nbsp;chan.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848824">c</span>&nbsp;<span class="op" id="848826">:=</span>&nbsp;<span class="builtinfunc" id="848829">make</span><span class="op" id="848833">(</span><span class="keyword" id="848834">chan</span>&nbsp;<span class="builtintype" id="848839">int</span><span class="op" id="848842">,</span>&nbsp;<span class="ident" id="848844">chanCap</span><span class="op" id="848851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848856">for</span>&nbsp;<span class="ident" id="848860">i</span>&nbsp;<span class="op" id="848862">:=</span>&nbsp;<span class="num" id="848865">0</span><span class="op" id="848866">;</span>&nbsp;<span class="ident" id="848868">i</span>&nbsp;<span class="op" id="848870">&lt;</span>&nbsp;<span class="ident" id="848872">chanCap</span><span class="op" id="848879">;</span>&nbsp;<span class="ident" id="848881">i</span><span class="op" id="848882">++</span>&nbsp;<span class="op" id="848885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848891">c</span>&nbsp;<span class="op" id="848893">&lt;-</span>&nbsp;<span class="ident" id="848896">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="848901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="848906">close</span><span class="op" id="848911">(</span><span class="ident" id="848912">c</span><span class="op" id="848913">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848918">for</span>&nbsp;<span class="ident" id="848922">i</span>&nbsp;<span class="op" id="848924">:=</span>&nbsp;<span class="num" id="848927">0</span><span class="op" id="848928">;</span>&nbsp;<span class="ident" id="848930">i</span>&nbsp;<span class="op" id="848932">&lt;</span>&nbsp;<span class="ident" id="848934">chanCap</span><span class="op" id="848941">;</span>&nbsp;<span class="ident" id="848943">i</span><span class="op" id="848944">++</span>&nbsp;<span class="op" id="848947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848953">v</span>&nbsp;<span class="op" id="848955">:=</span>&nbsp;<span class="op" id="848958">&lt;-</span><span class="ident" id="848960">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="848966">if</span>&nbsp;<span class="ident" id="848969">v</span>&nbsp;<span class="op" id="848971">!=</span>&nbsp;<span class="ident" id="848974">i</span>&nbsp;<span class="op" id="848976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="848983">t</span><span class="op" id="848984">.</span><span class="ident" id="848985">Fatalf</span><span class="op" id="848991">(</span><span class="string" id="848992">&#34;chan[%d]:&nbsp;received&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="849028">,</span>&nbsp;<span class="ident" id="849030">chanCap</span><span class="op" id="849037">,</span>&nbsp;<span class="ident" id="849039">v</span><span class="op" id="849040">,</span>&nbsp;<span class="ident" id="849042">i</span><span class="op" id="849043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849049">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849059">if</span>&nbsp;<span class="ident" id="849062">v</span>&nbsp;<span class="op" id="849064">:=</span>&nbsp;<span class="op" id="849067">&lt;-</span><span class="ident" id="849069">c</span><span class="op" id="849070">;</span>&nbsp;<span class="ident" id="849072">v</span>&nbsp;<span class="op" id="849074">!=</span>&nbsp;<span class="num" id="849077">0</span>&nbsp;<span class="op" id="849079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849085">t</span><span class="op" id="849086">.</span><span class="ident" id="849087">Fatalf</span><span class="op" id="849093">(</span><span class="string" id="849094">&#34;chan[%d]:&nbsp;received&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="849130">,</span>&nbsp;<span class="ident" id="849132">chanCap</span><span class="op" id="849139">,</span>&nbsp;<span class="ident" id="849141">v</span><span class="op" id="849142">,</span>&nbsp;<span class="num" id="849144">0</span><span class="op" id="849145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849155">if</span>&nbsp;<span class="ident" id="849158">v</span><span class="op" id="849159">,</span>&nbsp;<span class="ident" id="849161">ok</span>&nbsp;<span class="op" id="849164">:=</span>&nbsp;<span class="op" id="849167">&lt;-</span><span class="ident" id="849169">c</span><span class="op" id="849170">;</span>&nbsp;<span class="ident" id="849172">v</span>&nbsp;<span class="op" id="849174">!=</span>&nbsp;<span class="num" id="849177">0</span>&nbsp;<span class="op" id="849179">||</span>&nbsp;<span class="ident" id="849182">ok</span>&nbsp;<span class="op" id="849185">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849191">t</span><span class="op" id="849192">.</span><span class="ident" id="849193">Fatalf</span><span class="op" id="849199">(</span><span class="string" id="849200">&#34;chan[%d]:&nbsp;received&nbsp;%v/%v,&nbsp;expected&nbsp;%v/%v&#34;</span><span class="op" id="849242">,</span>&nbsp;<span class="ident" id="849244">chanCap</span><span class="op" id="849251">,</span>&nbsp;<span class="ident" id="849253">v</span><span class="op" id="849254">,</span>&nbsp;<span class="ident" id="849256">ok</span><span class="op" id="849258">,</span>&nbsp;<span class="num" id="849260">0</span><span class="op" id="849261">,</span>&nbsp;<span class="builtintype" id="849263">false</span><span class="op" id="849268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849282">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="849287">//&nbsp;Ensure&nbsp;that&nbsp;close&nbsp;unblocks&nbsp;receive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849329">c</span>&nbsp;<span class="op" id="849331">:=</span>&nbsp;<span class="builtinfunc" id="849334">make</span><span class="op" id="849338">(</span><span class="keyword" id="849339">chan</span>&nbsp;<span class="builtintype" id="849344">int</span><span class="op" id="849347">,</span>&nbsp;<span class="ident" id="849349">chanCap</span><span class="op" id="849356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849361">done</span>&nbsp;<span class="op" id="849366">:=</span>&nbsp;<span class="builtinfunc" id="849369">make</span><span class="op" id="849373">(</span><span class="keyword" id="849374">chan</span>&nbsp;<span class="builtintype" id="849379">bool</span><span class="op" id="849383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849388">go</span>&nbsp;<span class="keyword" id="849391">func</span><span class="op" id="849395">(</span><span class="op" id="849396">)</span>&nbsp;<span class="op" id="849398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849404">v</span><span class="op" id="849405">,</span>&nbsp;<span class="ident" id="849407">ok</span>&nbsp;<span class="op" id="849410">:=</span>&nbsp;<span class="op" id="849413">&lt;-</span><span class="ident" id="849415">c</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849421">done</span>&nbsp;<span class="op" id="849426">&lt;-</span>&nbsp;<span class="ident" id="849429">v</span>&nbsp;<span class="op" id="849431">==</span>&nbsp;<span class="num" id="849434">0</span>&nbsp;<span class="op" id="849436">&amp;&amp;</span>&nbsp;<span class="ident" id="849439">ok</span>&nbsp;<span class="op" id="849442">==</span>&nbsp;<span class="builtintype" id="849445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849454">}</span><span class="op" id="849455">(</span><span class="op" id="849456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849461">time</span><span class="op" id="849465">.</span><span class="ident" id="849466">Sleep</span><span class="op" id="849471">(</span><span class="ident" id="849472">time</span><span class="op" id="849476">.</span><span class="ident" id="849477">Millisecond</span><span class="op" id="849488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="849493">close</span><span class="op" id="849498">(</span><span class="ident" id="849499">c</span><span class="op" id="849500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849505">if</span>&nbsp;<span class="op" id="849508">!</span><span class="op" id="849509">&lt;-</span><span class="ident" id="849511">done</span>&nbsp;<span class="op" id="849516">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849522">t</span><span class="op" id="849523">.</span><span class="ident" id="849524">Fatalf</span><span class="op" id="849530">(</span><span class="string" id="849531">&#34;chan[%d]:&nbsp;received&nbsp;non&nbsp;zero&nbsp;from&nbsp;closed&nbsp;chan&#34;</span><span class="op" id="849577">,</span>&nbsp;<span class="ident" id="849579">chanCap</span><span class="op" id="849586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849600">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="849605">//&nbsp;Send&nbsp;100&nbsp;integers,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="849630">//&nbsp;ensure&nbsp;that&nbsp;we&nbsp;receive&nbsp;them&nbsp;non-corrupted&nbsp;in&nbsp;FIFO&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849693">c</span>&nbsp;<span class="op" id="849695">:=</span>&nbsp;<span class="builtinfunc" id="849698">make</span><span class="op" id="849702">(</span><span class="keyword" id="849703">chan</span>&nbsp;<span class="builtintype" id="849708">int</span><span class="op" id="849711">,</span>&nbsp;<span class="ident" id="849713">chanCap</span><span class="op" id="849720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849725">go</span>&nbsp;<span class="keyword" id="849728">func</span><span class="op" id="849732">(</span><span class="op" id="849733">)</span>&nbsp;<span class="op" id="849735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849741">for</span>&nbsp;<span class="ident" id="849745">i</span>&nbsp;<span class="op" id="849747">:=</span>&nbsp;<span class="num" id="849750">0</span><span class="op" id="849751">;</span>&nbsp;<span class="ident" id="849753">i</span>&nbsp;<span class="op" id="849755">&lt;</span>&nbsp;<span class="num" id="849757">100</span><span class="op" id="849760">;</span>&nbsp;<span class="ident" id="849762">i</span><span class="op" id="849763">++</span>&nbsp;<span class="op" id="849766">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849773">c</span>&nbsp;<span class="op" id="849775">&lt;-</span>&nbsp;<span class="ident" id="849778">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849789">}</span><span class="op" id="849790">(</span><span class="op" id="849791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849796">for</span>&nbsp;<span class="ident" id="849800">i</span>&nbsp;<span class="op" id="849802">:=</span>&nbsp;<span class="num" id="849805">0</span><span class="op" id="849806">;</span>&nbsp;<span class="ident" id="849808">i</span>&nbsp;<span class="op" id="849810">&lt;</span>&nbsp;<span class="num" id="849812">100</span><span class="op" id="849815">;</span>&nbsp;<span class="ident" id="849817">i</span><span class="op" id="849818">++</span>&nbsp;<span class="op" id="849821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849827">v</span>&nbsp;<span class="op" id="849829">:=</span>&nbsp;<span class="op" id="849832">&lt;-</span><span class="ident" id="849834">c</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849840">if</span>&nbsp;<span class="ident" id="849843">v</span>&nbsp;<span class="op" id="849845">!=</span>&nbsp;<span class="ident" id="849848">i</span>&nbsp;<span class="op" id="849850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="849857">t</span><span class="op" id="849858">.</span><span class="ident" id="849859">Fatalf</span><span class="op" id="849865">(</span><span class="string" id="849866">&#34;chan[%d]:&nbsp;received&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="849902">,</span>&nbsp;<span class="ident" id="849904">chanCap</span><span class="op" id="849911">,</span>&nbsp;<span class="ident" id="849913">v</span><span class="op" id="849914">,</span>&nbsp;<span class="ident" id="849916">i</span><span class="op" id="849917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="849928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="849934">//&nbsp;Same,&nbsp;but&nbsp;using&nbsp;recv2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849963">go</span>&nbsp;<span class="keyword" id="849966">func</span><span class="op" id="849970">(</span><span class="op" id="849971">)</span>&nbsp;<span class="op" id="849973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="849979">for</span>&nbsp;<span class="ident" id="849983">i</span>&nbsp;<span class="op" id="849985">:=</span>&nbsp;<span class="num" id="849988">0</span><span class="op" id="849989">;</span>&nbsp;<span class="ident" id="849991">i</span>&nbsp;<span class="op" id="849993">&lt;</span>&nbsp;<span class="num" id="849995">100</span><span class="op" id="849998">;</span>&nbsp;<span class="ident" id="850000">i</span><span class="op" id="850001">++</span>&nbsp;<span class="op" id="850004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850011">c</span>&nbsp;<span class="op" id="850013">&lt;-</span>&nbsp;<span class="ident" id="850016">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850022">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850027">}</span><span class="op" id="850028">(</span><span class="op" id="850029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850034">for</span>&nbsp;<span class="ident" id="850038">i</span>&nbsp;<span class="op" id="850040">:=</span>&nbsp;<span class="num" id="850043">0</span><span class="op" id="850044">;</span>&nbsp;<span class="ident" id="850046">i</span>&nbsp;<span class="op" id="850048">&lt;</span>&nbsp;<span class="num" id="850050">100</span><span class="op" id="850053">;</span>&nbsp;<span class="ident" id="850055">i</span><span class="op" id="850056">++</span>&nbsp;<span class="op" id="850059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850065">v</span><span class="op" id="850066">,</span>&nbsp;<span class="ident" id="850068">ok</span>&nbsp;<span class="op" id="850071">:=</span>&nbsp;<span class="op" id="850074">&lt;-</span><span class="ident" id="850076">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850082">if</span>&nbsp;<span class="op" id="850085">!</span><span class="ident" id="850086">ok</span>&nbsp;<span class="op" id="850089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850096">t</span><span class="op" id="850097">.</span><span class="ident" id="850098">Fatalf</span><span class="op" id="850104">(</span><span class="string" id="850105">&#34;chan[%d]:&nbsp;receive&nbsp;failed,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="850144">,</span>&nbsp;<span class="ident" id="850146">chanCap</span><span class="op" id="850153">,</span>&nbsp;<span class="ident" id="850155">i</span><span class="op" id="850156">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850168">if</span>&nbsp;<span class="ident" id="850171">v</span>&nbsp;<span class="op" id="850173">!=</span>&nbsp;<span class="ident" id="850176">i</span>&nbsp;<span class="op" id="850178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850185">t</span><span class="op" id="850186">.</span><span class="ident" id="850187">Fatalf</span><span class="op" id="850193">(</span><span class="string" id="850194">&#34;chan[%d]:&nbsp;received&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="850230">,</span>&nbsp;<span class="ident" id="850232">chanCap</span><span class="op" id="850239">,</span>&nbsp;<span class="ident" id="850241">v</span><span class="op" id="850242">,</span>&nbsp;<span class="ident" id="850244">i</span><span class="op" id="850245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850256">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="850262">//&nbsp;Send&nbsp;1000&nbsp;integers&nbsp;in&nbsp;4&nbsp;goroutines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="850304">//&nbsp;ensure&nbsp;that&nbsp;we&nbsp;receive&nbsp;what&nbsp;we&nbsp;send.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850347">const</span>&nbsp;<span class="ident" id="850353">P</span>&nbsp;<span class="op" id="850355">=</span>&nbsp;<span class="num" id="850357">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850362">const</span>&nbsp;<span class="ident" id="850368">L</span>&nbsp;<span class="op" id="850370">=</span>&nbsp;<span class="num" id="850372">1000</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850380">for</span>&nbsp;<span class="ident" id="850384">p</span>&nbsp;<span class="op" id="850386">:=</span>&nbsp;<span class="num" id="850389">0</span><span class="op" id="850390">;</span>&nbsp;<span class="ident" id="850392">p</span>&nbsp;<span class="op" id="850394">&lt;</span>&nbsp;<span class="ident" id="850396">P</span><span class="op" id="850397">;</span>&nbsp;<span class="ident" id="850399">p</span><span class="op" id="850400">++</span>&nbsp;<span class="op" id="850403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850409">go</span>&nbsp;<span class="keyword" id="850412">func</span><span class="op" id="850416">(</span><span class="op" id="850417">)</span>&nbsp;<span class="op" id="850419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850426">for</span>&nbsp;<span class="ident" id="850430">i</span>&nbsp;<span class="op" id="850432">:=</span>&nbsp;<span class="num" id="850435">0</span><span class="op" id="850436">;</span>&nbsp;<span class="ident" id="850438">i</span>&nbsp;<span class="op" id="850440">&lt;</span>&nbsp;<span class="ident" id="850442">L</span><span class="op" id="850443">;</span>&nbsp;<span class="ident" id="850445">i</span><span class="op" id="850446">++</span>&nbsp;<span class="op" id="850449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850457">c</span>&nbsp;<span class="op" id="850459">&lt;-</span>&nbsp;<span class="ident" id="850462">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850469">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850475">}</span><span class="op" id="850476">(</span><span class="op" id="850477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850487">done</span>&nbsp;<span class="op" id="850492">:=</span>&nbsp;<span class="builtinfunc" id="850495">make</span><span class="op" id="850499">(</span><span class="keyword" id="850500">chan</span>&nbsp;<span class="keyword" id="850505">map</span><span class="op" id="850508">[</span><span class="builtintype" id="850509">int</span><span class="op" id="850512">]</span><span class="builtintype" id="850513">int</span><span class="op" id="850516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850521">for</span>&nbsp;<span class="ident" id="850525">p</span>&nbsp;<span class="op" id="850527">:=</span>&nbsp;<span class="num" id="850530">0</span><span class="op" id="850531">;</span>&nbsp;<span class="ident" id="850533">p</span>&nbsp;<span class="op" id="850535">&lt;</span>&nbsp;<span class="ident" id="850537">P</span><span class="op" id="850538">;</span>&nbsp;<span class="ident" id="850540">p</span><span class="op" id="850541">++</span>&nbsp;<span class="op" id="850544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850550">go</span>&nbsp;<span class="keyword" id="850553">func</span><span class="op" id="850557">(</span><span class="op" id="850558">)</span>&nbsp;<span class="op" id="850560">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850567">recv</span>&nbsp;<span class="op" id="850572">:=</span>&nbsp;<span class="builtinfunc" id="850575">make</span><span class="op" id="850579">(</span><span class="keyword" id="850580">map</span><span class="op" id="850583">[</span><span class="builtintype" id="850584">int</span><span class="op" id="850587">]</span><span class="builtintype" id="850588">int</span><span class="op" id="850591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850598">for</span>&nbsp;<span class="ident" id="850602">i</span>&nbsp;<span class="op" id="850604">:=</span>&nbsp;<span class="num" id="850607">0</span><span class="op" id="850608">;</span>&nbsp;<span class="ident" id="850610">i</span>&nbsp;<span class="op" id="850612">&lt;</span>&nbsp;<span class="ident" id="850614">L</span><span class="op" id="850615">;</span>&nbsp;<span class="ident" id="850617">i</span><span class="op" id="850618">++</span>&nbsp;<span class="op" id="850621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850629">v</span>&nbsp;<span class="op" id="850631">:=</span>&nbsp;<span class="op" id="850634">&lt;-</span><span class="ident" id="850636">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850644">recv</span><span class="op" id="850648">[</span><span class="ident" id="850649">v</span><span class="op" id="850650">]</span>&nbsp;<span class="op" id="850652">=</span>&nbsp;<span class="ident" id="850654">recv</span><span class="op" id="850658">[</span><span class="ident" id="850659">v</span><span class="op" id="850660">]</span>&nbsp;<span class="op" id="850662">+</span>&nbsp;<span class="num" id="850664">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850671">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850678">done</span>&nbsp;<span class="op" id="850683">&lt;-</span>&nbsp;<span class="ident" id="850686">recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850695">}</span><span class="op" id="850696">(</span><span class="op" id="850697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850707">recv</span>&nbsp;<span class="op" id="850712">:=</span>&nbsp;<span class="builtinfunc" id="850715">make</span><span class="op" id="850719">(</span><span class="keyword" id="850720">map</span><span class="op" id="850723">[</span><span class="builtintype" id="850724">int</span><span class="op" id="850727">]</span><span class="builtintype" id="850728">int</span><span class="op" id="850731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850736">for</span>&nbsp;<span class="ident" id="850740">p</span>&nbsp;<span class="op" id="850742">:=</span>&nbsp;<span class="num" id="850745">0</span><span class="op" id="850746">;</span>&nbsp;<span class="ident" id="850748">p</span>&nbsp;<span class="op" id="850750">&lt;</span>&nbsp;<span class="ident" id="850752">P</span><span class="op" id="850753">;</span>&nbsp;<span class="ident" id="850755">p</span><span class="op" id="850756">++</span>&nbsp;<span class="op" id="850759">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850765">for</span>&nbsp;<span class="ident" id="850769">k</span><span class="op" id="850770">,</span>&nbsp;<span class="ident" id="850772">v</span>&nbsp;<span class="op" id="850774">:=</span>&nbsp;<span class="keyword" id="850777">range</span>&nbsp;<span class="op" id="850783">&lt;-</span><span class="ident" id="850785">done</span>&nbsp;<span class="op" id="850790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850797">recv</span><span class="op" id="850801">[</span><span class="ident" id="850802">k</span><span class="op" id="850803">]</span>&nbsp;<span class="op" id="850805">=</span>&nbsp;<span class="ident" id="850807">recv</span><span class="op" id="850811">[</span><span class="ident" id="850812">k</span><span class="op" id="850813">]</span>&nbsp;<span class="op" id="850815">+</span>&nbsp;<span class="ident" id="850817">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850833">if</span>&nbsp;<span class="builtinfunc" id="850836">len</span><span class="op" id="850839">(</span><span class="ident" id="850840">recv</span><span class="op" id="850844">)</span>&nbsp;<span class="op" id="850846">!=</span>&nbsp;<span class="ident" id="850849">L</span>&nbsp;<span class="op" id="850851">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850857">t</span><span class="op" id="850858">.</span><span class="ident" id="850859">Fatalf</span><span class="op" id="850865">(</span><span class="string" id="850866">&#34;chan[%d]:&nbsp;received&nbsp;%v&nbsp;values,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="850909">,</span>&nbsp;<span class="ident" id="850911">chanCap</span><span class="op" id="850918">,</span>&nbsp;<span class="builtinfunc" id="850920">len</span><span class="op" id="850923">(</span><span class="ident" id="850924">recv</span><span class="op" id="850928">)</span><span class="op" id="850929">,</span>&nbsp;<span class="ident" id="850931">L</span><span class="op" id="850932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="850937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850942">for</span>&nbsp;<span class="ident" id="850946">_</span><span class="op" id="850947">,</span>&nbsp;<span class="ident" id="850949">v</span>&nbsp;<span class="op" id="850951">:=</span>&nbsp;<span class="keyword" id="850954">range</span>&nbsp;<span class="ident" id="850960">recv</span>&nbsp;<span class="op" id="850965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="850971">if</span>&nbsp;<span class="ident" id="850974">v</span>&nbsp;<span class="op" id="850976">!=</span>&nbsp;<span class="ident" id="850979">P</span>&nbsp;<span class="op" id="850981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="850988">t</span><span class="op" id="850989">.</span><span class="ident" id="850990">Fatalf</span><span class="op" id="850996">(</span><span class="string" id="850997">&#34;chan[%d]:&nbsp;received&nbsp;%v&nbsp;values,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="851040">,</span>&nbsp;<span class="ident" id="851042">chanCap</span><span class="op" id="851049">,</span>&nbsp;<span class="ident" id="851051">v</span><span class="op" id="851052">,</span>&nbsp;<span class="ident" id="851054">P</span><span class="op" id="851055">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851075">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="851080">//&nbsp;Test&nbsp;len/cap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851100">c</span>&nbsp;<span class="op" id="851102">:=</span>&nbsp;<span class="builtinfunc" id="851105">make</span><span class="op" id="851109">(</span><span class="keyword" id="851110">chan</span>&nbsp;<span class="builtintype" id="851115">int</span><span class="op" id="851118">,</span>&nbsp;<span class="ident" id="851120">chanCap</span><span class="op" id="851127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851132">if</span>&nbsp;<span class="builtinfunc" id="851135">len</span><span class="op" id="851138">(</span><span class="ident" id="851139">c</span><span class="op" id="851140">)</span>&nbsp;<span class="op" id="851142">!=</span>&nbsp;<span class="num" id="851145">0</span>&nbsp;<span class="op" id="851147">||</span>&nbsp;<span class="builtinfunc" id="851150">cap</span><span class="op" id="851153">(</span><span class="ident" id="851154">c</span><span class="op" id="851155">)</span>&nbsp;<span class="op" id="851157">!=</span>&nbsp;<span class="ident" id="851160">chanCap</span>&nbsp;<span class="op" id="851168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851174">t</span><span class="op" id="851175">.</span><span class="ident" id="851176">Fatalf</span><span class="op" id="851182">(</span><span class="string" id="851183">&#34;chan[%d]:&nbsp;bad&nbsp;len/cap,&nbsp;expect&nbsp;%v/%v,&nbsp;got&nbsp;%v/%v&#34;</span><span class="op" id="851231">,</span>&nbsp;<span class="ident" id="851233">chanCap</span><span class="op" id="851240">,</span>&nbsp;<span class="num" id="851242">0</span><span class="op" id="851243">,</span>&nbsp;<span class="ident" id="851245">chanCap</span><span class="op" id="851252">,</span>&nbsp;<span class="builtinfunc" id="851254">len</span><span class="op" id="851257">(</span><span class="ident" id="851258">c</span><span class="op" id="851259">)</span><span class="op" id="851260">,</span>&nbsp;<span class="builtinfunc" id="851262">cap</span><span class="op" id="851265">(</span><span class="ident" id="851266">c</span><span class="op" id="851267">)</span><span class="op" id="851268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851273">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851278">for</span>&nbsp;<span class="ident" id="851282">i</span>&nbsp;<span class="op" id="851284">:=</span>&nbsp;<span class="num" id="851287">0</span><span class="op" id="851288">;</span>&nbsp;<span class="ident" id="851290">i</span>&nbsp;<span class="op" id="851292">&lt;</span>&nbsp;<span class="ident" id="851294">chanCap</span><span class="op" id="851301">;</span>&nbsp;<span class="ident" id="851303">i</span><span class="op" id="851304">++</span>&nbsp;<span class="op" id="851307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851313">c</span>&nbsp;<span class="op" id="851315">&lt;-</span>&nbsp;<span class="ident" id="851318">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851328">if</span>&nbsp;<span class="builtinfunc" id="851331">len</span><span class="op" id="851334">(</span><span class="ident" id="851335">c</span><span class="op" id="851336">)</span>&nbsp;<span class="op" id="851338">!=</span>&nbsp;<span class="ident" id="851341">chanCap</span>&nbsp;<span class="op" id="851349">||</span>&nbsp;<span class="builtinfunc" id="851352">cap</span><span class="op" id="851355">(</span><span class="ident" id="851356">c</span><span class="op" id="851357">)</span>&nbsp;<span class="op" id="851359">!=</span>&nbsp;<span class="ident" id="851362">chanCap</span>&nbsp;<span class="op" id="851370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851376">t</span><span class="op" id="851377">.</span><span class="ident" id="851378">Fatalf</span><span class="op" id="851384">(</span><span class="string" id="851385">&#34;chan[%d]:&nbsp;bad&nbsp;len/cap,&nbsp;expect&nbsp;%v/%v,&nbsp;got&nbsp;%v/%v&#34;</span><span class="op" id="851433">,</span>&nbsp;<span class="ident" id="851435">chanCap</span><span class="op" id="851442">,</span>&nbsp;<span class="ident" id="851444">chanCap</span><span class="op" id="851451">,</span>&nbsp;<span class="ident" id="851453">chanCap</span><span class="op" id="851460">,</span>&nbsp;<span class="builtinfunc" id="851462">len</span><span class="op" id="851465">(</span><span class="ident" id="851466">c</span><span class="op" id="851467">)</span><span class="op" id="851468">,</span>&nbsp;<span class="builtinfunc" id="851470">cap</span><span class="op" id="851473">(</span><span class="ident" id="851474">c</span><span class="op" id="851475">)</span><span class="op" id="851476">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851489">}</span><br>
<span class="lineno"></span><span class="op" id="851491">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="851494">func</span>&nbsp;<span class="ident" id="851499">TestNonblockRecvRace</span><span class="op" id="851519">(</span><span class="ident" id="851520">t</span>&nbsp;<span class="op" id="851522">*</span><span class="ident" id="851523">testing</span><span class="op" id="851530">.</span><span class="ident" id="851531">T</span><span class="op" id="851532">)</span>&nbsp;<span class="op" id="851534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851537">n</span>&nbsp;<span class="op" id="851539">:=</span>&nbsp;<span class="num" id="851542">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851549">if</span>&nbsp;<span class="ident" id="851552">testing</span><span class="op" id="851559">.</span><span class="ident" id="851560">Short</span><span class="op" id="851565">(</span><span class="op" id="851566">)</span>&nbsp;<span class="op" id="851568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851572">n</span>&nbsp;<span class="op" id="851574">=</span>&nbsp;<span class="num" id="851576">100</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851584">for</span>&nbsp;<span class="ident" id="851588">i</span>&nbsp;<span class="op" id="851590">:=</span>&nbsp;<span class="num" id="851593">0</span><span class="op" id="851594">;</span>&nbsp;<span class="ident" id="851596">i</span>&nbsp;<span class="op" id="851598">&lt;</span>&nbsp;<span class="ident" id="851600">n</span><span class="op" id="851601">;</span>&nbsp;<span class="ident" id="851603">i</span><span class="op" id="851604">++</span>&nbsp;<span class="op" id="851607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851611">c</span>&nbsp;<span class="op" id="851613">:=</span>&nbsp;<span class="builtinfunc" id="851616">make</span><span class="op" id="851620">(</span><span class="keyword" id="851621">chan</span>&nbsp;<span class="builtintype" id="851626">int</span><span class="op" id="851629">,</span>&nbsp;<span class="num" id="851631">1</span><span class="op" id="851632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851636">c</span>&nbsp;<span class="op" id="851638">&lt;-</span>&nbsp;<span class="num" id="851641">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851645">go</span>&nbsp;<span class="keyword" id="851648">func</span><span class="op" id="851652">(</span><span class="op" id="851653">)</span>&nbsp;<span class="op" id="851655">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851660">select</span>&nbsp;<span class="op" id="851667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851672">case</span>&nbsp;<span class="op" id="851677">&lt;-</span><span class="ident" id="851679">c</span><span class="op" id="851680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851685">default</span><span class="op" id="851692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851698">t</span><span class="op" id="851699">.</span><span class="ident" id="851700">Fatal</span><span class="op" id="851705">(</span><span class="string" id="851706">&#34;chan&nbsp;is&nbsp;not&nbsp;ready&#34;</span><span class="op" id="851725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851730">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851734">}</span><span class="op" id="851735">(</span><span class="op" id="851736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="851740">close</span><span class="op" id="851745">(</span><span class="ident" id="851746">c</span><span class="op" id="851747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851751">&lt;-</span><span class="ident" id="851753">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="851756">}</span><br>
<span class="lineno"></span><span class="op" id="851758">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="851761">func</span>&nbsp;<span class="ident" id="851766">TestSelfSelect</span><span class="op" id="851780">(</span><span class="ident" id="851781">t</span>&nbsp;<span class="op" id="851783">*</span><span class="ident" id="851784">testing</span><span class="op" id="851791">.</span><span class="ident" id="851792">T</span><span class="op" id="851793">)</span>&nbsp;<span class="op" id="851795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="851798">//&nbsp;Ensure&nbsp;that&nbsp;send/recv&nbsp;on&nbsp;the&nbsp;same&nbsp;chan&nbsp;in&nbsp;select</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="851851">//&nbsp;does&nbsp;not&nbsp;crash&nbsp;nor&nbsp;deadlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851884">defer</span>&nbsp;<span class="ident" id="851890">runtime</span><span class="op" id="851897">.</span><span class="ident" id="851898">GOMAXPROCS</span><span class="op" id="851908">(</span><span class="ident" id="851909">runtime</span><span class="op" id="851916">.</span><span class="ident" id="851917">GOMAXPROCS</span><span class="op" id="851927">(</span><span class="num" id="851928">2</span><span class="op" id="851929">)</span><span class="op" id="851930">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851933">for</span>&nbsp;<span class="ident" id="851937">_</span><span class="op" id="851938">,</span>&nbsp;<span class="ident" id="851940">chanCap</span>&nbsp;<span class="op" id="851948">:=</span>&nbsp;<span class="keyword" id="851951">range</span>&nbsp;<span class="op" id="851957">[</span><span class="op" id="851958">]</span><span class="builtintype" id="851959">int</span><span class="op" id="851962">{</span><span class="num" id="851963">0</span><span class="op" id="851964">,</span>&nbsp;<span class="num" id="851966">10</span><span class="op" id="851968">}</span>&nbsp;<span class="op" id="851970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="851974">var</span>&nbsp;<span class="ident" id="851978">wg</span>&nbsp;<span class="ident" id="851981">sync</span><span class="op" id="851985">.</span><span class="ident" id="851986">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="851998">wg</span><span class="op" id="852000">.</span><span class="ident" id="852001">Add</span><span class="op" id="852004">(</span><span class="num" id="852005">2</span><span class="op" id="852006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852010">c</span>&nbsp;<span class="op" id="852012">:=</span>&nbsp;<span class="builtinfunc" id="852015">make</span><span class="op" id="852019">(</span><span class="keyword" id="852020">chan</span>&nbsp;<span class="builtintype" id="852025">int</span><span class="op" id="852028">,</span>&nbsp;<span class="ident" id="852030">chanCap</span><span class="op" id="852037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852041">for</span>&nbsp;<span class="ident" id="852045">p</span>&nbsp;<span class="op" id="852047">:=</span>&nbsp;<span class="num" id="852050">0</span><span class="op" id="852051">;</span>&nbsp;<span class="ident" id="852053">p</span>&nbsp;<span class="op" id="852055">&lt;</span>&nbsp;<span class="num" id="852057">2</span><span class="op" id="852058">;</span>&nbsp;<span class="ident" id="852060">p</span><span class="op" id="852061">++</span>&nbsp;<span class="op" id="852064">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852069">p</span>&nbsp;<span class="op" id="852071">:=</span>&nbsp;<span class="ident" id="852074">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852079">go</span>&nbsp;<span class="keyword" id="852082">func</span><span class="op" id="852086">(</span><span class="op" id="852087">)</span>&nbsp;<span class="op" id="852089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852095">defer</span>&nbsp;<span class="ident" id="852101">wg</span><span class="op" id="852103">.</span><span class="ident" id="852104">Done</span><span class="op" id="852108">(</span><span class="op" id="852109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852115">for</span>&nbsp;<span class="ident" id="852119">i</span>&nbsp;<span class="op" id="852121">:=</span>&nbsp;<span class="num" id="852124">0</span><span class="op" id="852125">;</span>&nbsp;<span class="ident" id="852127">i</span>&nbsp;<span class="op" id="852129">&lt;</span>&nbsp;<span class="num" id="852131">1000</span><span class="op" id="852135">;</span>&nbsp;<span class="ident" id="852137">i</span><span class="op" id="852138">++</span>&nbsp;<span class="op" id="852141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852148">if</span>&nbsp;<span class="ident" id="852151">p</span>&nbsp;<span class="op" id="852153">==</span>&nbsp;<span class="num" id="852156">0</span>&nbsp;<span class="op" id="852158">||</span>&nbsp;<span class="ident" id="852161">i</span><span class="op" id="852162">%</span><span class="num" id="852163">2</span>&nbsp;<span class="op" id="852165">==</span>&nbsp;<span class="num" id="852168">0</span>&nbsp;<span class="op" id="852170">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852178">select</span>&nbsp;<span class="op" id="852185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852193">case</span>&nbsp;<span class="ident" id="852198">c</span>&nbsp;<span class="op" id="852200">&lt;-</span>&nbsp;<span class="ident" id="852203">p</span><span class="op" id="852204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852212">case</span>&nbsp;<span class="ident" id="852217">v</span>&nbsp;<span class="op" id="852219">:=</span>&nbsp;<span class="op" id="852222">&lt;-</span><span class="ident" id="852224">c</span><span class="op" id="852225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852234">if</span>&nbsp;<span class="ident" id="852237">chanCap</span>&nbsp;<span class="op" id="852245">==</span>&nbsp;<span class="num" id="852248">0</span>&nbsp;<span class="op" id="852250">&amp;&amp;</span>&nbsp;<span class="ident" id="852253">v</span>&nbsp;<span class="op" id="852255">==</span>&nbsp;<span class="ident" id="852258">p</span>&nbsp;<span class="op" id="852260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852270">t</span><span class="op" id="852271">.</span><span class="ident" id="852272">Fatalf</span><span class="op" id="852278">(</span><span class="string" id="852279">&#34;self&nbsp;receive&#34;</span><span class="op" id="852293">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852317">}</span>&nbsp;<span class="keyword" id="852319">else</span>&nbsp;<span class="op" id="852324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852332">select</span>&nbsp;<span class="op" id="852339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852347">case</span>&nbsp;<span class="ident" id="852352">v</span>&nbsp;<span class="op" id="852354">:=</span>&nbsp;<span class="op" id="852357">&lt;-</span><span class="ident" id="852359">c</span><span class="op" id="852360">:</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852369">if</span>&nbsp;<span class="ident" id="852372">chanCap</span>&nbsp;<span class="op" id="852380">==</span>&nbsp;<span class="num" id="852383">0</span>&nbsp;<span class="op" id="852385">&amp;&amp;</span>&nbsp;<span class="ident" id="852388">v</span>&nbsp;<span class="op" id="852390">==</span>&nbsp;<span class="ident" id="852393">p</span>&nbsp;<span class="op" id="852395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852405">t</span><span class="op" id="852406">.</span><span class="ident" id="852407">Fatalf</span><span class="op" id="852413">(</span><span class="string" id="852414">&#34;self&nbsp;receive&#34;</span><span class="op" id="852428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852445">case</span>&nbsp;<span class="ident" id="852450">c</span>&nbsp;<span class="op" id="852452">&lt;-</span>&nbsp;<span class="ident" id="852455">p</span><span class="op" id="852456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852464">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852482">}</span><span class="op" id="852483">(</span><span class="op" id="852484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852492">wg</span><span class="op" id="852494">.</span><span class="ident" id="852495">Wait</span><span class="op" id="852499">(</span><span class="op" id="852500">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852503">}</span><br>
<span class="lineno"></span><span class="op" id="852505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="852508">func</span>&nbsp;<span class="ident" id="852513">TestSelectStress</span><span class="op" id="852529">(</span><span class="ident" id="852530">t</span>&nbsp;<span class="op" id="852532">*</span><span class="ident" id="852533">testing</span><span class="op" id="852540">.</span><span class="ident" id="852541">T</span><span class="op" id="852542">)</span>&nbsp;<span class="op" id="852544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852547">defer</span>&nbsp;<span class="ident" id="852553">runtime</span><span class="op" id="852560">.</span><span class="ident" id="852561">GOMAXPROCS</span><span class="op" id="852571">(</span><span class="ident" id="852572">runtime</span><span class="op" id="852579">.</span><span class="ident" id="852580">GOMAXPROCS</span><span class="op" id="852590">(</span><span class="num" id="852591">10</span><span class="op" id="852593">)</span><span class="op" id="852594">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852597">var</span>&nbsp;<span class="ident" id="852601">c</span>&nbsp;<span class="op" id="852603">[</span><span class="num" id="852604">4</span><span class="op" id="852605">]</span><span class="keyword" id="852606">chan</span>&nbsp;<span class="builtintype" id="852611">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852616">c</span><span class="op" id="852617">[</span><span class="num" id="852618">0</span><span class="op" id="852619">]</span>&nbsp;<span class="op" id="852621">=</span>&nbsp;<span class="builtinfunc" id="852623">make</span><span class="op" id="852627">(</span><span class="keyword" id="852628">chan</span>&nbsp;<span class="builtintype" id="852633">int</span><span class="op" id="852636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852639">c</span><span class="op" id="852640">[</span><span class="num" id="852641">1</span><span class="op" id="852642">]</span>&nbsp;<span class="op" id="852644">=</span>&nbsp;<span class="builtinfunc" id="852646">make</span><span class="op" id="852650">(</span><span class="keyword" id="852651">chan</span>&nbsp;<span class="builtintype" id="852656">int</span><span class="op" id="852659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852662">c</span><span class="op" id="852663">[</span><span class="num" id="852664">2</span><span class="op" id="852665">]</span>&nbsp;<span class="op" id="852667">=</span>&nbsp;<span class="builtinfunc" id="852669">make</span><span class="op" id="852673">(</span><span class="keyword" id="852674">chan</span>&nbsp;<span class="builtintype" id="852679">int</span><span class="op" id="852682">,</span>&nbsp;<span class="num" id="852684">2</span><span class="op" id="852685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852688">c</span><span class="op" id="852689">[</span><span class="num" id="852690">3</span><span class="op" id="852691">]</span>&nbsp;<span class="op" id="852693">=</span>&nbsp;<span class="builtinfunc" id="852695">make</span><span class="op" id="852699">(</span><span class="keyword" id="852700">chan</span>&nbsp;<span class="builtintype" id="852705">int</span><span class="op" id="852708">,</span>&nbsp;<span class="num" id="852710">3</span><span class="op" id="852711">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852714">N</span>&nbsp;<span class="op" id="852716">:=</span>&nbsp;<span class="builtintype" id="852719">int</span><span class="op" id="852722">(</span><span class="num" id="852723">1e5</span><span class="op" id="852726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="852729">if</span>&nbsp;<span class="ident" id="852732">testing</span><span class="op" id="852739">.</span><span class="ident" id="852740">Short</span><span class="op" id="852745">(</span><span class="op" id="852746">)</span>&nbsp;<span class="op" id="852748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="852752">N</span>&nbsp;<span class="op" id="852754">/=</span>&nbsp;<span class="num" id="852757">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="852761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="852764">//&nbsp;There&nbsp;are&nbsp;4&nbsp;goroutines&nbsp;that&nbsp;send&nbsp;N&nbsp;values&nbsp;on&nbsp;each&nbsp;of&nbsp;the&nbsp;chans,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="852832">//&nbsp;+&nbsp;4&nbsp;goroutines&nbsp;that&nbsp;receive&nbsp;N&nbsp;values&nbsp;on&nbsp;each&nbsp;of&nbsp;the&nbsp;chans,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="852895">//&nbsp;+&nbsp;1&nbsp;goroutine&nbsp;that&nbsp;sends&nbsp;N&nbsp;values&nbsp;on&nbsp;each&nbsp;of&nbsp;the&nbsp;chans&nbsp;in&nbsp;a&nbsp;single&nbsp;select,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="852974">//&nbsp;+&nbsp;1&nbsp;goroutine&nbsp;that&nbsp;receives&nbsp;N&nbsp;values&nbsp;on&nbsp;each&nbsp;of&nbsp;the&nbsp;chans&nbsp;in&nbsp;a&nbsp;single&nbsp;select.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="853056">//&nbsp;All&nbsp;these&nbsp;sends,&nbsp;receives&nbsp;and&nbsp;selects&nbsp;interact&nbsp;chaotically&nbsp;at&nbsp;runtime,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="853131">//&nbsp;but&nbsp;we&nbsp;are&nbsp;careful&nbsp;that&nbsp;this&nbsp;whole&nbsp;construct&nbsp;does&nbsp;not&nbsp;deadlock.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853199">var</span>&nbsp;<span class="ident" id="853203">wg</span>&nbsp;<span class="ident" id="853206">sync</span><span class="op" id="853210">.</span><span class="ident" id="853211">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853222">wg</span><span class="op" id="853224">.</span><span class="ident" id="853225">Add</span><span class="op" id="853228">(</span><span class="num" id="853229">10</span><span class="op" id="853231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853234">for</span>&nbsp;<span class="ident" id="853238">k</span>&nbsp;<span class="op" id="853240">:=</span>&nbsp;<span class="num" id="853243">0</span><span class="op" id="853244">;</span>&nbsp;<span class="ident" id="853246">k</span>&nbsp;<span class="op" id="853248">&lt;</span>&nbsp;<span class="num" id="853250">4</span><span class="op" id="853251">;</span>&nbsp;<span class="ident" id="853253">k</span><span class="op" id="853254">++</span>&nbsp;<span class="op" id="853257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853261">k</span>&nbsp;<span class="op" id="853263">:=</span>&nbsp;<span class="ident" id="853266">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853270">go</span>&nbsp;<span class="keyword" id="853273">func</span><span class="op" id="853277">(</span><span class="op" id="853278">)</span>&nbsp;<span class="op" id="853280">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853285">for</span>&nbsp;<span class="ident" id="853289">i</span>&nbsp;<span class="op" id="853291">:=</span>&nbsp;<span class="num" id="853294">0</span><span class="op" id="853295">;</span>&nbsp;<span class="ident" id="853297">i</span>&nbsp;<span class="op" id="853299">&lt;</span>&nbsp;<span class="ident" id="853301">N</span><span class="op" id="853302">;</span>&nbsp;<span class="ident" id="853304">i</span><span class="op" id="853305">++</span>&nbsp;<span class="op" id="853308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853314">c</span><span class="op" id="853315">[</span><span class="ident" id="853316">k</span><span class="op" id="853317">]</span>&nbsp;<span class="op" id="853319">&lt;-</span>&nbsp;<span class="num" id="853322">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853332">wg</span><span class="op" id="853334">.</span><span class="ident" id="853335">Done</span><span class="op" id="853339">(</span><span class="op" id="853340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853344">}</span><span class="op" id="853345">(</span><span class="op" id="853346">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853350">go</span>&nbsp;<span class="keyword" id="853353">func</span><span class="op" id="853357">(</span><span class="op" id="853358">)</span>&nbsp;<span class="op" id="853360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853365">for</span>&nbsp;<span class="ident" id="853369">i</span>&nbsp;<span class="op" id="853371">:=</span>&nbsp;<span class="num" id="853374">0</span><span class="op" id="853375">;</span>&nbsp;<span class="ident" id="853377">i</span>&nbsp;<span class="op" id="853379">&lt;</span>&nbsp;<span class="ident" id="853381">N</span><span class="op" id="853382">;</span>&nbsp;<span class="ident" id="853384">i</span><span class="op" id="853385">++</span>&nbsp;<span class="op" id="853388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853394">&lt;-</span><span class="ident" id="853396">c</span><span class="op" id="853397">[</span><span class="ident" id="853398">k</span><span class="op" id="853399">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853409">wg</span><span class="op" id="853411">.</span><span class="ident" id="853412">Done</span><span class="op" id="853416">(</span><span class="op" id="853417">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853421">}</span><span class="op" id="853422">(</span><span class="op" id="853423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853429">go</span>&nbsp;<span class="keyword" id="853432">func</span><span class="op" id="853436">(</span><span class="op" id="853437">)</span>&nbsp;<span class="op" id="853439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853443">var</span>&nbsp;<span class="ident" id="853447">n</span>&nbsp;<span class="op" id="853449">[</span><span class="num" id="853450">4</span><span class="op" id="853451">]</span><span class="builtintype" id="853452">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853458">c1</span>&nbsp;<span class="op" id="853461">:=</span>&nbsp;<span class="ident" id="853464">c</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853468">for</span>&nbsp;<span class="ident" id="853472">i</span>&nbsp;<span class="op" id="853474">:=</span>&nbsp;<span class="num" id="853477">0</span><span class="op" id="853478">;</span>&nbsp;<span class="ident" id="853480">i</span>&nbsp;<span class="op" id="853482">&lt;</span>&nbsp;<span class="num" id="853484">4</span><span class="op" id="853485">*</span><span class="ident" id="853486">N</span><span class="op" id="853487">;</span>&nbsp;<span class="ident" id="853489">i</span><span class="op" id="853490">++</span>&nbsp;<span class="op" id="853493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853498">select</span>&nbsp;<span class="op" id="853505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853510">case</span>&nbsp;<span class="ident" id="853515">c1</span><span class="op" id="853517">[</span><span class="num" id="853518">3</span><span class="op" id="853519">]</span>&nbsp;<span class="op" id="853521">&lt;-</span>&nbsp;<span class="num" id="853524">0</span><span class="op" id="853525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853531">n</span><span class="op" id="853532">[</span><span class="num" id="853533">3</span><span class="op" id="853534">]</span><span class="op" id="853535">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853542">if</span>&nbsp;<span class="ident" id="853545">n</span><span class="op" id="853546">[</span><span class="num" id="853547">3</span><span class="op" id="853548">]</span>&nbsp;<span class="op" id="853550">==</span>&nbsp;<span class="ident" id="853553">N</span>&nbsp;<span class="op" id="853555">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853562">c1</span><span class="op" id="853564">[</span><span class="num" id="853565">3</span><span class="op" id="853566">]</span>&nbsp;<span class="op" id="853568">=</span>&nbsp;<span class="ident" id="853570">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853583">case</span>&nbsp;<span class="ident" id="853588">c1</span><span class="op" id="853590">[</span><span class="num" id="853591">2</span><span class="op" id="853592">]</span>&nbsp;<span class="op" id="853594">&lt;-</span>&nbsp;<span class="num" id="853597">0</span><span class="op" id="853598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853604">n</span><span class="op" id="853605">[</span><span class="num" id="853606">2</span><span class="op" id="853607">]</span><span class="op" id="853608">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853615">if</span>&nbsp;<span class="ident" id="853618">n</span><span class="op" id="853619">[</span><span class="num" id="853620">2</span><span class="op" id="853621">]</span>&nbsp;<span class="op" id="853623">==</span>&nbsp;<span class="ident" id="853626">N</span>&nbsp;<span class="op" id="853628">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853635">c1</span><span class="op" id="853637">[</span><span class="num" id="853638">2</span><span class="op" id="853639">]</span>&nbsp;<span class="op" id="853641">=</span>&nbsp;<span class="ident" id="853643">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853656">case</span>&nbsp;<span class="ident" id="853661">c1</span><span class="op" id="853663">[</span><span class="num" id="853664">0</span><span class="op" id="853665">]</span>&nbsp;<span class="op" id="853667">&lt;-</span>&nbsp;<span class="num" id="853670">0</span><span class="op" id="853671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853677">n</span><span class="op" id="853678">[</span><span class="num" id="853679">0</span><span class="op" id="853680">]</span><span class="op" id="853681">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853688">if</span>&nbsp;<span class="ident" id="853691">n</span><span class="op" id="853692">[</span><span class="num" id="853693">0</span><span class="op" id="853694">]</span>&nbsp;<span class="op" id="853696">==</span>&nbsp;<span class="ident" id="853699">N</span>&nbsp;<span class="op" id="853701">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853708">c1</span><span class="op" id="853710">[</span><span class="num" id="853711">0</span><span class="op" id="853712">]</span>&nbsp;<span class="op" id="853714">=</span>&nbsp;<span class="ident" id="853716">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853729">case</span>&nbsp;<span class="ident" id="853734">c1</span><span class="op" id="853736">[</span><span class="num" id="853737">1</span><span class="op" id="853738">]</span>&nbsp;<span class="op" id="853740">&lt;-</span>&nbsp;<span class="num" id="853743">0</span><span class="op" id="853744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853750">n</span><span class="op" id="853751">[</span><span class="num" id="853752">1</span><span class="op" id="853753">]</span><span class="op" id="853754">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853761">if</span>&nbsp;<span class="ident" id="853764">n</span><span class="op" id="853765">[</span><span class="num" id="853766">1</span><span class="op" id="853767">]</span>&nbsp;<span class="op" id="853769">==</span>&nbsp;<span class="ident" id="853772">N</span>&nbsp;<span class="op" id="853774">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853781">c1</span><span class="op" id="853783">[</span><span class="num" id="853784">1</span><span class="op" id="853785">]</span>&nbsp;<span class="op" id="853787">=</span>&nbsp;<span class="ident" id="853789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853810">wg</span><span class="op" id="853812">.</span><span class="ident" id="853813">Done</span><span class="op" id="853817">(</span><span class="op" id="853818">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853821">}</span><span class="op" id="853822">(</span><span class="op" id="853823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853826">go</span>&nbsp;<span class="keyword" id="853829">func</span><span class="op" id="853833">(</span><span class="op" id="853834">)</span>&nbsp;<span class="op" id="853836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853840">var</span>&nbsp;<span class="ident" id="853844">n</span>&nbsp;<span class="op" id="853846">[</span><span class="num" id="853847">4</span><span class="op" id="853848">]</span><span class="builtintype" id="853849">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853855">c1</span>&nbsp;<span class="op" id="853858">:=</span>&nbsp;<span class="ident" id="853861">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853865">for</span>&nbsp;<span class="ident" id="853869">i</span>&nbsp;<span class="op" id="853871">:=</span>&nbsp;<span class="num" id="853874">0</span><span class="op" id="853875">;</span>&nbsp;<span class="ident" id="853877">i</span>&nbsp;<span class="op" id="853879">&lt;</span>&nbsp;<span class="num" id="853881">4</span><span class="op" id="853882">*</span><span class="ident" id="853883">N</span><span class="op" id="853884">;</span>&nbsp;<span class="ident" id="853886">i</span><span class="op" id="853887">++</span>&nbsp;<span class="op" id="853890">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853895">select</span>&nbsp;<span class="op" id="853902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853907">case</span>&nbsp;<span class="op" id="853912">&lt;-</span><span class="ident" id="853914">c1</span><span class="op" id="853916">[</span><span class="num" id="853917">0</span><span class="op" id="853918">]</span><span class="op" id="853919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853925">n</span><span class="op" id="853926">[</span><span class="num" id="853927">0</span><span class="op" id="853928">]</span><span class="op" id="853929">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853936">if</span>&nbsp;<span class="ident" id="853939">n</span><span class="op" id="853940">[</span><span class="num" id="853941">0</span><span class="op" id="853942">]</span>&nbsp;<span class="op" id="853944">==</span>&nbsp;<span class="ident" id="853947">N</span>&nbsp;<span class="op" id="853949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853956">c1</span><span class="op" id="853958">[</span><span class="num" id="853959">0</span><span class="op" id="853960">]</span>&nbsp;<span class="op" id="853962">=</span>&nbsp;<span class="ident" id="853964">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="853972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="853977">case</span>&nbsp;<span class="op" id="853982">&lt;-</span><span class="ident" id="853984">c1</span><span class="op" id="853986">[</span><span class="num" id="853987">1</span><span class="op" id="853988">]</span><span class="op" id="853989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="853995">n</span><span class="op" id="853996">[</span><span class="num" id="853997">1</span><span class="op" id="853998">]</span><span class="op" id="853999">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854006">if</span>&nbsp;<span class="ident" id="854009">n</span><span class="op" id="854010">[</span><span class="num" id="854011">1</span><span class="op" id="854012">]</span>&nbsp;<span class="op" id="854014">==</span>&nbsp;<span class="ident" id="854017">N</span>&nbsp;<span class="op" id="854019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854026">c1</span><span class="op" id="854028">[</span><span class="num" id="854029">1</span><span class="op" id="854030">]</span>&nbsp;<span class="op" id="854032">=</span>&nbsp;<span class="ident" id="854034">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854047">case</span>&nbsp;<span class="op" id="854052">&lt;-</span><span class="ident" id="854054">c1</span><span class="op" id="854056">[</span><span class="num" id="854057">2</span><span class="op" id="854058">]</span><span class="op" id="854059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854065">n</span><span class="op" id="854066">[</span><span class="num" id="854067">2</span><span class="op" id="854068">]</span><span class="op" id="854069">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854076">if</span>&nbsp;<span class="ident" id="854079">n</span><span class="op" id="854080">[</span><span class="num" id="854081">2</span><span class="op" id="854082">]</span>&nbsp;<span class="op" id="854084">==</span>&nbsp;<span class="ident" id="854087">N</span>&nbsp;<span class="op" id="854089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854096">c1</span><span class="op" id="854098">[</span><span class="num" id="854099">2</span><span class="op" id="854100">]</span>&nbsp;<span class="op" id="854102">=</span>&nbsp;<span class="ident" id="854104">nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854117">case</span>&nbsp;<span class="op" id="854122">&lt;-</span><span class="ident" id="854124">c1</span><span class="op" id="854126">[</span><span class="num" id="854127">3</span><span class="op" id="854128">]</span><span class="op" id="854129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854135">n</span><span class="op" id="854136">[</span><span class="num" id="854137">3</span><span class="op" id="854138">]</span><span class="op" id="854139">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854146">if</span>&nbsp;<span class="ident" id="854149">n</span><span class="op" id="854150">[</span><span class="num" id="854151">3</span><span class="op" id="854152">]</span>&nbsp;<span class="op" id="854154">==</span>&nbsp;<span class="ident" id="854157">N</span>&nbsp;<span class="op" id="854159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854166">c1</span><span class="op" id="854168">[</span><span class="num" id="854169">3</span><span class="op" id="854170">]</span>&nbsp;<span class="op" id="854172">=</span>&nbsp;<span class="ident" id="854174">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854195">wg</span><span class="op" id="854197">.</span><span class="ident" id="854198">Done</span><span class="op" id="854202">(</span><span class="op" id="854203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854206">}</span><span class="op" id="854207">(</span><span class="op" id="854208">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854211">wg</span><span class="op" id="854213">.</span><span class="ident" id="854214">Wait</span><span class="op" id="854218">(</span><span class="op" id="854219">)</span><br>
<span class="lineno"></span><span class="op" id="854221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="854224">func</span>&nbsp;<span class="ident" id="854229">TestChanSendInterface</span><span class="op" id="854250">(</span><span class="ident" id="854251">t</span>&nbsp;<span class="op" id="854253">*</span><span class="ident" id="854254">testing</span><span class="op" id="854261">.</span><span class="ident" id="854262">T</span><span class="op" id="854263">)</span>&nbsp;<span class="op" id="854265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854268">type</span>&nbsp;<span class="ident" id="854273">mt</span>&nbsp;<span class="keyword" id="854276">struct</span><span class="op" id="854282">{</span><span class="op" id="854283">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854286">m</span>&nbsp;<span class="op" id="854288">:=</span>&nbsp;<span class="op" id="854291">&amp;</span><span class="ident" id="854292">mt</span><span class="op" id="854294">{</span><span class="op" id="854295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854298">c</span>&nbsp;<span class="op" id="854300">:=</span>&nbsp;<span class="builtinfunc" id="854303">make</span><span class="op" id="854307">(</span><span class="keyword" id="854308">chan</span>&nbsp;<span class="keyword" id="854313">interface</span><span class="op" id="854322">{</span><span class="op" id="854323">}</span><span class="op" id="854324">,</span>&nbsp;<span class="num" id="854326">1</span><span class="op" id="854327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854330">c</span>&nbsp;<span class="op" id="854332">&lt;-</span>&nbsp;<span class="ident" id="854335">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854338">select</span>&nbsp;<span class="op" id="854345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854348">case</span>&nbsp;<span class="ident" id="854353">c</span>&nbsp;<span class="op" id="854355">&lt;-</span>&nbsp;<span class="ident" id="854358">m</span><span class="op" id="854359">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854362">default</span><span class="op" id="854369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854375">select</span>&nbsp;<span class="op" id="854382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854385">case</span>&nbsp;<span class="ident" id="854390">c</span>&nbsp;<span class="op" id="854392">&lt;-</span>&nbsp;<span class="ident" id="854395">m</span><span class="op" id="854396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854399">case</span>&nbsp;<span class="ident" id="854404">c</span>&nbsp;<span class="op" id="854406">&lt;-</span>&nbsp;<span class="op" id="854409">&amp;</span><span class="ident" id="854410">mt</span><span class="op" id="854412">{</span><span class="op" id="854413">}</span><span class="op" id="854414">:</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854417">default</span><span class="op" id="854424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854427">}</span><br>
<span class="lineno"></span><span class="op" id="854429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="854432">func</span>&nbsp;<span class="ident" id="854437">TestPseudoRandomSend</span><span class="op" id="854457">(</span><span class="ident" id="854458">t</span>&nbsp;<span class="op" id="854460">*</span><span class="ident" id="854461">testing</span><span class="op" id="854468">.</span><span class="ident" id="854469">T</span><span class="op" id="854470">)</span>&nbsp;<span class="op" id="854472">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854475">n</span>&nbsp;<span class="op" id="854477">:=</span>&nbsp;<span class="num" id="854480">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854485">for</span>&nbsp;<span class="ident" id="854489">_</span><span class="op" id="854490">,</span>&nbsp;<span class="ident" id="854492">chanCap</span>&nbsp;<span class="op" id="854500">:=</span>&nbsp;<span class="keyword" id="854503">range</span>&nbsp;<span class="op" id="854509">[</span><span class="op" id="854510">]</span><span class="builtintype" id="854511">int</span><span class="op" id="854514">{</span><span class="num" id="854515">0</span><span class="op" id="854516">,</span>&nbsp;<span class="ident" id="854518">n</span><span class="op" id="854519">}</span>&nbsp;<span class="op" id="854521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854525">c</span>&nbsp;<span class="op" id="854527">:=</span>&nbsp;<span class="builtinfunc" id="854530">make</span><span class="op" id="854534">(</span><span class="keyword" id="854535">chan</span>&nbsp;<span class="builtintype" id="854540">int</span><span class="op" id="854543">,</span>&nbsp;<span class="ident" id="854545">chanCap</span><span class="op" id="854552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854556">l</span>&nbsp;<span class="op" id="854558">:=</span>&nbsp;<span class="builtinfunc" id="854561">make</span><span class="op" id="854565">(</span><span class="op" id="854566">[</span><span class="op" id="854567">]</span><span class="builtintype" id="854568">int</span><span class="op" id="854571">,</span>&nbsp;<span class="ident" id="854573">n</span><span class="op" id="854574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854578">var</span>&nbsp;<span class="ident" id="854582">m</span>&nbsp;<span class="ident" id="854584">sync</span><span class="op" id="854588">.</span><span class="ident" id="854589">Mutex</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854597">m</span><span class="op" id="854598">.</span><span class="ident" id="854599">Lock</span><span class="op" id="854603">(</span><span class="op" id="854604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854608">go</span>&nbsp;<span class="keyword" id="854611">func</span><span class="op" id="854615">(</span><span class="op" id="854616">)</span>&nbsp;<span class="op" id="854618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854623">for</span>&nbsp;<span class="ident" id="854627">i</span>&nbsp;<span class="op" id="854629">:=</span>&nbsp;<span class="num" id="854632">0</span><span class="op" id="854633">;</span>&nbsp;<span class="ident" id="854635">i</span>&nbsp;<span class="op" id="854637">&lt;</span>&nbsp;<span class="ident" id="854639">n</span><span class="op" id="854640">;</span>&nbsp;<span class="ident" id="854642">i</span><span class="op" id="854643">++</span>&nbsp;<span class="op" id="854646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854652">runtime</span><span class="op" id="854659">.</span><span class="ident" id="854660">Gosched</span><span class="op" id="854667">(</span><span class="op" id="854668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854674">l</span><span class="op" id="854675">[</span><span class="ident" id="854676">i</span><span class="op" id="854677">]</span>&nbsp;<span class="op" id="854679">=</span>&nbsp;<span class="op" id="854681">&lt;-</span><span class="ident" id="854683">c</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854693">m</span><span class="op" id="854694">.</span><span class="ident" id="854695">Unlock</span><span class="op" id="854701">(</span><span class="op" id="854702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854706">}</span><span class="op" id="854707">(</span><span class="op" id="854708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854712">for</span>&nbsp;<span class="ident" id="854716">i</span>&nbsp;<span class="op" id="854718">:=</span>&nbsp;<span class="num" id="854721">0</span><span class="op" id="854722">;</span>&nbsp;<span class="ident" id="854724">i</span>&nbsp;<span class="op" id="854726">&lt;</span>&nbsp;<span class="ident" id="854728">n</span><span class="op" id="854729">;</span>&nbsp;<span class="ident" id="854731">i</span><span class="op" id="854732">++</span>&nbsp;<span class="op" id="854735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854740">select</span>&nbsp;<span class="op" id="854747">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854752">case</span>&nbsp;<span class="ident" id="854757">c</span>&nbsp;<span class="op" id="854759">&lt;-</span>&nbsp;<span class="num" id="854762">1</span><span class="op" id="854763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854768">case</span>&nbsp;<span class="ident" id="854773">c</span>&nbsp;<span class="op" id="854775">&lt;-</span>&nbsp;<span class="num" id="854778">0</span><span class="op" id="854779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854792">m</span><span class="op" id="854793">.</span><span class="ident" id="854794">Lock</span><span class="op" id="854798">(</span><span class="op" id="854799">)</span>&nbsp;<span class="comment" id="854801">//&nbsp;wait</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854811">n0</span>&nbsp;<span class="op" id="854814">:=</span>&nbsp;<span class="num" id="854817">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854821">n1</span>&nbsp;<span class="op" id="854824">:=</span>&nbsp;<span class="num" id="854827">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854831">for</span>&nbsp;<span class="ident" id="854835">_</span><span class="op" id="854836">,</span>&nbsp;<span class="ident" id="854838">i</span>&nbsp;<span class="op" id="854840">:=</span>&nbsp;<span class="keyword" id="854843">range</span>&nbsp;<span class="ident" id="854849">l</span>&nbsp;<span class="op" id="854851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854856">n0</span>&nbsp;<span class="op" id="854859">+=</span>&nbsp;<span class="op" id="854862">(</span><span class="ident" id="854863">i</span>&nbsp;<span class="op" id="854865">+</span>&nbsp;<span class="num" id="854867">1</span><span class="op" id="854868">)</span>&nbsp;<span class="op" id="854870">%</span>&nbsp;<span class="num" id="854872">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854877">n1</span>&nbsp;<span class="op" id="854880">+=</span>&nbsp;<span class="ident" id="854883">i</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="854887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="854891">if</span>&nbsp;<span class="ident" id="854894">n0</span>&nbsp;<span class="op" id="854897">&lt;=</span>&nbsp;<span class="ident" id="854900">n</span><span class="op" id="854901">/</span><span class="num" id="854902">10</span>&nbsp;<span class="op" id="854905">||</span>&nbsp;<span class="ident" id="854908">n1</span>&nbsp;<span class="op" id="854911">&lt;=</span>&nbsp;<span class="ident" id="854914">n</span><span class="op" id="854915">/</span><span class="num" id="854916">10</span>&nbsp;<span class="op" id="854919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="854924">t</span><span class="op" id="854925">.</span><span class="ident" id="854926">Errorf</span><span class="op" id="854932">(</span><span class="string" id="854933">&#34;Want&nbsp;pseudorandom,&nbsp;got&nbsp;%d&nbsp;zeros&nbsp;and&nbsp;%d&nbsp;ones&nbsp;(chan&nbsp;cap&nbsp;%d)&#34;</span><span class="op" id="854992">,</span>&nbsp;<span class="ident" id="854994">n0</span><span class="op" id="854996">,</span>&nbsp;<span class="ident" id="854998">n1</span><span class="op" id="855000">,</span>&nbsp;<span class="ident" id="855002">chanCap</span><span class="op" id="855009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855016">}</span><br>
<span class="lineno">400</span><span class="op" id="855018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="855021">func</span>&nbsp;<span class="ident" id="855026">TestMultiConsumer</span><span class="op" id="855043">(</span><span class="ident" id="855044">t</span>&nbsp;<span class="op" id="855046">*</span><span class="ident" id="855047">testing</span><span class="op" id="855054">.</span><span class="ident" id="855055">T</span><span class="op" id="855056">)</span>&nbsp;<span class="op" id="855058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855061">const</span>&nbsp;<span class="ident" id="855067">nwork</span>&nbsp;<span class="op" id="855073">=</span>&nbsp;<span class="num" id="855075">23</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855079">const</span>&nbsp;<span class="ident" id="855085">niter</span>&nbsp;<span class="op" id="855091">=</span>&nbsp;<span class="num" id="855093">271828</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855102">pn</span>&nbsp;<span class="op" id="855105">:=</span>&nbsp;<span class="op" id="855108">[</span><span class="op" id="855109">]</span><span class="builtintype" id="855110">int</span><span class="op" id="855113">{</span><span class="num" id="855114">2</span><span class="op" id="855115">,</span>&nbsp;<span class="num" id="855117">3</span><span class="op" id="855118">,</span>&nbsp;<span class="num" id="855120">7</span><span class="op" id="855121">,</span>&nbsp;<span class="num" id="855123">11</span><span class="op" id="855125">,</span>&nbsp;<span class="num" id="855127">13</span><span class="op" id="855129">,</span>&nbsp;<span class="num" id="855131">17</span><span class="op" id="855133">,</span>&nbsp;<span class="num" id="855135">19</span><span class="op" id="855137">,</span>&nbsp;<span class="num" id="855139">23</span><span class="op" id="855141">,</span>&nbsp;<span class="num" id="855143">27</span><span class="op" id="855145">,</span>&nbsp;<span class="num" id="855147">31</span><span class="op" id="855149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855153">q</span>&nbsp;<span class="op" id="855155">:=</span>&nbsp;<span class="builtinfunc" id="855158">make</span><span class="op" id="855162">(</span><span class="keyword" id="855163">chan</span>&nbsp;<span class="builtintype" id="855168">int</span><span class="op" id="855171">,</span>&nbsp;<span class="ident" id="855173">nwork</span><span class="op" id="855178">*</span><span class="num" id="855179">3</span><span class="op" id="855180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855183">r</span>&nbsp;<span class="op" id="855185">:=</span>&nbsp;<span class="builtinfunc" id="855188">make</span><span class="op" id="855192">(</span><span class="keyword" id="855193">chan</span>&nbsp;<span class="builtintype" id="855198">int</span><span class="op" id="855201">,</span>&nbsp;<span class="ident" id="855203">nwork</span><span class="op" id="855208">*</span><span class="num" id="855209">3</span><span class="op" id="855210">)</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="855214">//&nbsp;workers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855226">var</span>&nbsp;<span class="ident" id="855230">wg</span>&nbsp;<span class="ident" id="855233">sync</span><span class="op" id="855237">.</span><span class="ident" id="855238">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855249">for</span>&nbsp;<span class="ident" id="855253">i</span>&nbsp;<span class="op" id="855255">:=</span>&nbsp;<span class="num" id="855258">0</span><span class="op" id="855259">;</span>&nbsp;<span class="ident" id="855261">i</span>&nbsp;<span class="op" id="855263">&lt;</span>&nbsp;<span class="ident" id="855265">nwork</span><span class="op" id="855270">;</span>&nbsp;<span class="ident" id="855272">i</span><span class="op" id="855273">++</span>&nbsp;<span class="op" id="855276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855280">wg</span><span class="op" id="855282">.</span><span class="ident" id="855283">Add</span><span class="op" id="855286">(</span><span class="num" id="855287">1</span><span class="op" id="855288">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855292">go</span>&nbsp;<span class="keyword" id="855295">func</span><span class="op" id="855299">(</span><span class="ident" id="855300">w</span>&nbsp;<span class="builtintype" id="855302">int</span><span class="op" id="855305">)</span>&nbsp;<span class="op" id="855307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855312">for</span>&nbsp;<span class="ident" id="855316">v</span>&nbsp;<span class="op" id="855318">:=</span>&nbsp;<span class="keyword" id="855321">range</span>&nbsp;<span class="ident" id="855327">q</span>&nbsp;<span class="op" id="855329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="855335">//&nbsp;mess&nbsp;with&nbsp;the&nbsp;fifo-ish&nbsp;nature&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855381">if</span>&nbsp;<span class="ident" id="855384">pn</span><span class="op" id="855386">[</span><span class="ident" id="855387">w</span><span class="op" id="855388">%</span><span class="builtinfunc" id="855389">len</span><span class="op" id="855392">(</span><span class="ident" id="855393">pn</span><span class="op" id="855395">)</span><span class="op" id="855396">]</span>&nbsp;<span class="op" id="855398">==</span>&nbsp;<span class="ident" id="855401">v</span>&nbsp;<span class="op" id="855403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855410">runtime</span><span class="op" id="855417">.</span><span class="ident" id="855418">Gosched</span><span class="op" id="855425">(</span><span class="op" id="855426">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855438">r</span>&nbsp;<span class="op" id="855440">&lt;-</span>&nbsp;<span class="ident" id="855443">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855453">wg</span><span class="op" id="855455">.</span><span class="ident" id="855456">Done</span><span class="op" id="855460">(</span><span class="op" id="855461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855465">}</span><span class="op" id="855466">(</span><span class="ident" id="855467">i</span><span class="op" id="855468">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="855475">//&nbsp;feeder&nbsp;&amp;&nbsp;closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855495">expect</span>&nbsp;<span class="op" id="855502">:=</span>&nbsp;<span class="num" id="855505">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855508">go</span>&nbsp;<span class="keyword" id="855511">func</span><span class="op" id="855515">(</span><span class="op" id="855516">)</span>&nbsp;<span class="op" id="855518">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855522">for</span>&nbsp;<span class="ident" id="855526">i</span>&nbsp;<span class="op" id="855528">:=</span>&nbsp;<span class="num" id="855531">0</span><span class="op" id="855532">;</span>&nbsp;<span class="ident" id="855534">i</span>&nbsp;<span class="op" id="855536">&lt;</span>&nbsp;<span class="ident" id="855538">niter</span><span class="op" id="855543">;</span>&nbsp;<span class="ident" id="855545">i</span><span class="op" id="855546">++</span>&nbsp;<span class="op" id="855549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855554">v</span>&nbsp;<span class="op" id="855556">:=</span>&nbsp;<span class="ident" id="855559">pn</span><span class="op" id="855561">[</span><span class="ident" id="855562">i</span><span class="op" id="855563">%</span><span class="builtinfunc" id="855564">len</span><span class="op" id="855567">(</span><span class="ident" id="855568">pn</span><span class="op" id="855570">)</span><span class="op" id="855571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855576">expect</span>&nbsp;<span class="op" id="855583">+=</span>&nbsp;<span class="ident" id="855586">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855591">q</span>&nbsp;<span class="op" id="855593">&lt;-</span>&nbsp;<span class="ident" id="855596">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855600">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="855604">close</span><span class="op" id="855609">(</span><span class="ident" id="855610">q</span><span class="op" id="855611">)</span>&nbsp;&nbsp;<span class="comment" id="855614">//&nbsp;no&nbsp;more&nbsp;work</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855632">wg</span><span class="op" id="855634">.</span><span class="ident" id="855635">Wait</span><span class="op" id="855639">(</span><span class="op" id="855640">)</span>&nbsp;<span class="comment" id="855642">//&nbsp;workers&nbsp;done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="855660">close</span><span class="op" id="855665">(</span><span class="ident" id="855666">r</span><span class="op" id="855667">)</span>&nbsp;&nbsp;<span class="comment" id="855670">//&nbsp;...&nbsp;so&nbsp;there&nbsp;can&nbsp;be&nbsp;no&nbsp;more&nbsp;results</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855710">}</span><span class="op" id="855711">(</span><span class="op" id="855712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="855716">//&nbsp;consume&nbsp;&amp;&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855736">n</span>&nbsp;<span class="op" id="855738">:=</span>&nbsp;<span class="num" id="855741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855744">s</span>&nbsp;<span class="op" id="855746">:=</span>&nbsp;<span class="num" id="855749">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855752">for</span>&nbsp;<span class="ident" id="855756">v</span>&nbsp;<span class="op" id="855758">:=</span>&nbsp;<span class="keyword" id="855761">range</span>&nbsp;<span class="ident" id="855767">r</span>&nbsp;<span class="op" id="855769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855773">n</span><span class="op" id="855774">++</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855779">s</span>&nbsp;<span class="op" id="855781">+=</span>&nbsp;<span class="ident" id="855784">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="855790">if</span>&nbsp;<span class="ident" id="855793">n</span>&nbsp;<span class="op" id="855795">!=</span>&nbsp;<span class="ident" id="855798">niter</span>&nbsp;<span class="op" id="855804">||</span>&nbsp;<span class="ident" id="855807">s</span>&nbsp;<span class="op" id="855809">!=</span>&nbsp;<span class="ident" id="855812">expect</span>&nbsp;<span class="op" id="855819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855823">t</span><span class="op" id="855824">.</span><span class="ident" id="855825">Errorf</span><span class="op" id="855831">(</span><span class="string" id="855832">&#34;Expected&nbsp;sum&nbsp;%d&nbsp;(got&nbsp;%d)&nbsp;from&nbsp;%d&nbsp;iter&nbsp;(saw&nbsp;%d)&#34;</span><span class="op" id="855880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="855885">expect</span><span class="op" id="855891">,</span>&nbsp;<span class="ident" id="855893">s</span><span class="op" id="855894">,</span>&nbsp;<span class="ident" id="855896">niter</span><span class="op" id="855901">,</span>&nbsp;<span class="ident" id="855903">n</span><span class="op" id="855904">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="855907">}</span><br>
<span class="lineno"></span><span class="op" id="855909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="855912">func</span>&nbsp;<span class="ident" id="855917">TestShrinkStackDuringBlockedSend</span><span class="op" id="855949">(</span><span class="ident" id="855950">t</span>&nbsp;<span class="op" id="855952">*</span><span class="ident" id="855953">testing</span><span class="op" id="855960">.</span><span class="ident" id="855961">T</span><span class="op" id="855962">)</span>&nbsp;<span class="op" id="855964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="855967">//&nbsp;make&nbsp;sure&nbsp;that&nbsp;channel&nbsp;operations&nbsp;still&nbsp;work&nbsp;when&nbsp;we&nbsp;are</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856028">//&nbsp;blocked&nbsp;on&nbsp;a&nbsp;channel&nbsp;send&nbsp;and&nbsp;we&nbsp;shrink&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856083">//&nbsp;NOTE:&nbsp;this&nbsp;test&nbsp;probably&nbsp;won&#39;t&nbsp;fail&nbsp;unless&nbsp;stack.c:StackDebug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856149">//&nbsp;is&nbsp;set&nbsp;to&nbsp;&gt;=&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856169">const</span>&nbsp;<span class="ident" id="856175">n</span>&nbsp;<span class="op" id="856177">=</span>&nbsp;<span class="num" id="856179">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856183">c</span>&nbsp;<span class="op" id="856185">:=</span>&nbsp;<span class="builtinfunc" id="856188">make</span><span class="op" id="856192">(</span><span class="keyword" id="856193">chan</span>&nbsp;<span class="builtintype" id="856198">int</span><span class="op" id="856201">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856204">done</span>&nbsp;<span class="op" id="856209">:=</span>&nbsp;<span class="builtinfunc" id="856212">make</span><span class="op" id="856216">(</span><span class="keyword" id="856217">chan</span>&nbsp;<span class="keyword" id="856222">struct</span><span class="op" id="856228">{</span><span class="op" id="856229">}</span><span class="op" id="856230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856234">go</span>&nbsp;<span class="keyword" id="856237">func</span><span class="op" id="856241">(</span><span class="op" id="856242">)</span>&nbsp;<span class="op" id="856244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856248">for</span>&nbsp;<span class="ident" id="856252">i</span>&nbsp;<span class="op" id="856254">:=</span>&nbsp;<span class="num" id="856257">0</span><span class="op" id="856258">;</span>&nbsp;<span class="ident" id="856260">i</span>&nbsp;<span class="op" id="856262">&lt;</span>&nbsp;<span class="ident" id="856264">n</span><span class="op" id="856265">;</span>&nbsp;<span class="ident" id="856267">i</span><span class="op" id="856268">++</span>&nbsp;<span class="op" id="856271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856276">c</span>&nbsp;<span class="op" id="856278">&lt;-</span>&nbsp;<span class="ident" id="856281">i</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856286">//&nbsp;use&nbsp;lots&nbsp;of&nbsp;stack,&nbsp;briefly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856320">stackGrowthRecursive</span><span class="op" id="856340">(</span><span class="num" id="856341">20</span><span class="op" id="856343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856351">done</span>&nbsp;<span class="op" id="856356">&lt;-</span>&nbsp;<span class="keyword" id="856359">struct</span><span class="op" id="856365">{</span><span class="op" id="856366">}</span><span class="op" id="856367">{</span><span class="op" id="856368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856371">}</span><span class="op" id="856372">(</span><span class="op" id="856373">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856377">for</span>&nbsp;<span class="ident" id="856381">i</span>&nbsp;<span class="op" id="856383">:=</span>&nbsp;<span class="num" id="856386">0</span><span class="op" id="856387">;</span>&nbsp;<span class="ident" id="856389">i</span>&nbsp;<span class="op" id="856391">&lt;</span>&nbsp;<span class="ident" id="856393">n</span><span class="op" id="856394">;</span>&nbsp;<span class="ident" id="856396">i</span><span class="op" id="856397">++</span>&nbsp;<span class="op" id="856400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856404">x</span>&nbsp;<span class="op" id="856406">:=</span>&nbsp;<span class="op" id="856409">&lt;-</span><span class="ident" id="856411">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856415">if</span>&nbsp;<span class="ident" id="856418">x</span>&nbsp;<span class="op" id="856420">!=</span>&nbsp;<span class="ident" id="856423">i</span>&nbsp;<span class="op" id="856425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856430">t</span><span class="op" id="856431">.</span><span class="ident" id="856432">Errorf</span><span class="op" id="856438">(</span><span class="string" id="856439">&#34;bad&nbsp;channel&nbsp;read:&nbsp;want&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="856474">,</span>&nbsp;<span class="ident" id="856476">i</span><span class="op" id="856477">,</span>&nbsp;<span class="ident" id="856479">x</span><span class="op" id="856480">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856488">//&nbsp;Waste&nbsp;some&nbsp;time&nbsp;so&nbsp;sender&nbsp;can&nbsp;finish&nbsp;using&nbsp;lots&nbsp;of&nbsp;stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856550">//&nbsp;and&nbsp;block&nbsp;in&nbsp;channel&nbsp;send.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856582">time</span><span class="op" id="856586">.</span><span class="ident" id="856587">Sleep</span><span class="op" id="856592">(</span><span class="num" id="856593">1</span>&nbsp;<span class="op" id="856595">*</span>&nbsp;<span class="ident" id="856597">time</span><span class="op" id="856601">.</span><span class="ident" id="856602">Millisecond</span><span class="op" id="856613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856617">//&nbsp;trigger&nbsp;GC&nbsp;which&nbsp;will&nbsp;shrink&nbsp;the&nbsp;stack&nbsp;of&nbsp;the&nbsp;sender.</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856676">runtime</span><span class="op" id="856683">.</span><span class="ident" id="856684">GC</span><span class="op" id="856686">(</span><span class="op" id="856687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856693">&lt;-</span><span class="ident" id="856695">done</span><br>
<span class="lineno"></span><span class="op" id="856700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="856703">func</span>&nbsp;<span class="ident" id="856708">TestSelectDuplicateChannel</span><span class="op" id="856734">(</span><span class="ident" id="856735">t</span>&nbsp;<span class="op" id="856737">*</span><span class="ident" id="856738">testing</span><span class="op" id="856745">.</span><span class="ident" id="856746">T</span><span class="op" id="856747">)</span>&nbsp;<span class="op" id="856749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856752">//&nbsp;This&nbsp;test&nbsp;makes&nbsp;sure&nbsp;we&nbsp;can&nbsp;queue&nbsp;a&nbsp;G&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856797">//&nbsp;the&nbsp;same&nbsp;channel&nbsp;multiple&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856834">c</span>&nbsp;<span class="op" id="856836">:=</span>&nbsp;<span class="builtinfunc" id="856839">make</span><span class="op" id="856843">(</span><span class="keyword" id="856844">chan</span>&nbsp;<span class="builtintype" id="856849">int</span><span class="op" id="856852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856855">d</span>&nbsp;<span class="op" id="856857">:=</span>&nbsp;<span class="builtinfunc" id="856860">make</span><span class="op" id="856864">(</span><span class="keyword" id="856865">chan</span>&nbsp;<span class="builtintype" id="856870">int</span><span class="op" id="856873">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856876">e</span>&nbsp;<span class="op" id="856878">:=</span>&nbsp;<span class="builtinfunc" id="856881">make</span><span class="op" id="856885">(</span><span class="keyword" id="856886">chan</span>&nbsp;<span class="builtintype" id="856891">int</span><span class="op" id="856894">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="856898">//&nbsp;goroutine&nbsp;A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856914">go</span>&nbsp;<span class="keyword" id="856917">func</span><span class="op" id="856921">(</span><span class="op" id="856922">)</span>&nbsp;<span class="op" id="856924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856928">select</span>&nbsp;<span class="op" id="856935">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856939">case</span>&nbsp;<span class="op" id="856944">&lt;-</span><span class="ident" id="856946">c</span><span class="op" id="856947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856951">case</span>&nbsp;<span class="op" id="856956">&lt;-</span><span class="ident" id="856958">c</span><span class="op" id="856959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="856963">case</span>&nbsp;<span class="op" id="856968">&lt;-</span><span class="ident" id="856970">d</span><span class="op" id="856971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856979">e</span>&nbsp;<span class="op" id="856981">&lt;-</span>&nbsp;<span class="num" id="856984">9</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="856987">}</span><span class="op" id="856988">(</span><span class="op" id="856989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="856992">time</span><span class="op" id="856996">.</span><span class="ident" id="856997">Sleep</span><span class="op" id="857002">(</span><span class="ident" id="857003">time</span><span class="op" id="857007">.</span><span class="ident" id="857008">Millisecond</span><span class="op" id="857019">)</span>&nbsp;<span class="comment" id="857021">//&nbsp;make&nbsp;sure&nbsp;goroutine&nbsp;A&nbsp;gets&nbsp;qeueued&nbsp;first&nbsp;on&nbsp;c</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="857072">//&nbsp;goroutine&nbsp;B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857088">go</span>&nbsp;<span class="keyword" id="857091">func</span><span class="op" id="857095">(</span><span class="op" id="857096">)</span>&nbsp;<span class="op" id="857098">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857102">&lt;-</span><span class="ident" id="857104">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857107">}</span><span class="op" id="857108">(</span><span class="op" id="857109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857112">time</span><span class="op" id="857116">.</span><span class="ident" id="857117">Sleep</span><span class="op" id="857122">(</span><span class="ident" id="857123">time</span><span class="op" id="857127">.</span><span class="ident" id="857128">Millisecond</span><span class="op" id="857139">)</span>&nbsp;<span class="comment" id="857141">//&nbsp;make&nbsp;sure&nbsp;goroutine&nbsp;B&nbsp;gets&nbsp;queued&nbsp;on&nbsp;c&nbsp;before&nbsp;continuing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857203">d</span>&nbsp;<span class="op" id="857205">&lt;-</span>&nbsp;<span class="num" id="857208">7</span>&nbsp;<span class="comment" id="857210">//&nbsp;wake&nbsp;up&nbsp;A,&nbsp;it&nbsp;dequeues&nbsp;itself&nbsp;from&nbsp;c.&nbsp;&nbsp;This&nbsp;operation&nbsp;used&nbsp;to&nbsp;corrupt&nbsp;c.recvq.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857293">&lt;-</span><span class="ident" id="857295">e</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="857300">//&nbsp;A&nbsp;tells&nbsp;us&nbsp;it&#39;s&nbsp;done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857325">c</span>&nbsp;<span class="op" id="857327">&lt;-</span>&nbsp;<span class="num" id="857330">8</span>&nbsp;<span class="comment" id="857332">//&nbsp;wake&nbsp;up&nbsp;B.&nbsp;&nbsp;This&nbsp;operation&nbsp;used&nbsp;to&nbsp;fail&nbsp;because&nbsp;c.recvq&nbsp;was&nbsp;corrupted&nbsp;(it&nbsp;tries&nbsp;to&nbsp;wake&nbsp;up&nbsp;an&nbsp;already&nbsp;running&nbsp;G&nbsp;instead&nbsp;of&nbsp;B)</span><br>
<span class="lineno"></span><span class="op" id="857461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="857464">func</span>&nbsp;<span class="ident" id="857469">BenchmarkChanNonblocking</span><span class="op" id="857493">(</span><span class="ident" id="857494">b</span>&nbsp;<span class="op" id="857496">*</span><span class="ident" id="857497">testing</span><span class="op" id="857504">.</span><span class="ident" id="857505">B</span><span class="op" id="857506">)</span>&nbsp;<span class="op" id="857508">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857511">myc</span>&nbsp;<span class="op" id="857515">:=</span>&nbsp;<span class="builtinfunc" id="857518">make</span><span class="op" id="857522">(</span><span class="keyword" id="857523">chan</span>&nbsp;<span class="builtintype" id="857528">int</span><span class="op" id="857531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857534">b</span><span class="op" id="857535">.</span><span class="ident" id="857536">RunParallel</span><span class="op" id="857547">(</span><span class="keyword" id="857548">func</span><span class="op" id="857552">(</span><span class="ident" id="857553">pb</span>&nbsp;<span class="op" id="857556">*</span><span class="ident" id="857557">testing</span><span class="op" id="857564">.</span><span class="ident" id="857565">PB</span><span class="op" id="857567">)</span>&nbsp;<span class="op" id="857569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857573">for</span>&nbsp;<span class="ident" id="857577">pb</span><span class="op" id="857579">.</span><span class="ident" id="857580">Next</span><span class="op" id="857584">(</span><span class="op" id="857585">)</span>&nbsp;<span class="op" id="857587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857592">select</span>&nbsp;<span class="op" id="857599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857604">case</span>&nbsp;<span class="op" id="857609">&lt;-</span><span class="ident" id="857611">myc</span><span class="op" id="857614">:</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857619">default</span><span class="op" id="857626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857638">}</span><span class="op" id="857639">)</span><br>
<span class="lineno"></span><span class="op" id="857641">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="857644">func</span>&nbsp;<span class="ident" id="857649">BenchmarkSelectUncontended</span><span class="op" id="857675">(</span><span class="ident" id="857676">b</span>&nbsp;<span class="op" id="857678">*</span><span class="ident" id="857679">testing</span><span class="op" id="857686">.</span><span class="ident" id="857687">B</span><span class="op" id="857688">)</span>&nbsp;<span class="op" id="857690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857693">b</span><span class="op" id="857694">.</span><span class="ident" id="857695">RunParallel</span><span class="op" id="857706">(</span><span class="keyword" id="857707">func</span><span class="op" id="857711">(</span><span class="ident" id="857712">pb</span>&nbsp;<span class="op" id="857715">*</span><span class="ident" id="857716">testing</span><span class="op" id="857723">.</span><span class="ident" id="857724">PB</span><span class="op" id="857726">)</span>&nbsp;<span class="op" id="857728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857732">myc1</span>&nbsp;<span class="op" id="857737">:=</span>&nbsp;<span class="builtinfunc" id="857740">make</span><span class="op" id="857744">(</span><span class="keyword" id="857745">chan</span>&nbsp;<span class="builtintype" id="857750">int</span><span class="op" id="857753">,</span>&nbsp;<span class="num" id="857755">1</span><span class="op" id="857756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857760">myc2</span>&nbsp;<span class="op" id="857765">:=</span>&nbsp;<span class="builtinfunc" id="857768">make</span><span class="op" id="857772">(</span><span class="keyword" id="857773">chan</span>&nbsp;<span class="builtintype" id="857778">int</span><span class="op" id="857781">,</span>&nbsp;<span class="num" id="857783">1</span><span class="op" id="857784">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857788">myc1</span>&nbsp;<span class="op" id="857793">&lt;-</span>&nbsp;<span class="num" id="857796">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857800">for</span>&nbsp;<span class="ident" id="857804">pb</span><span class="op" id="857806">.</span><span class="ident" id="857807">Next</span><span class="op" id="857811">(</span><span class="op" id="857812">)</span>&nbsp;<span class="op" id="857814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857819">select</span>&nbsp;<span class="op" id="857826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857831">case</span>&nbsp;<span class="op" id="857836">&lt;-</span><span class="ident" id="857838">myc1</span><span class="op" id="857842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857848">myc2</span>&nbsp;<span class="op" id="857853">&lt;-</span>&nbsp;<span class="num" id="857856">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="857861">case</span>&nbsp;<span class="op" id="857866">&lt;-</span><span class="ident" id="857868">myc2</span><span class="op" id="857872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857878">myc1</span>&nbsp;<span class="op" id="857883">&lt;-</span>&nbsp;<span class="num" id="857886">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="857898">}</span><span class="op" id="857899">)</span><br>
<span class="lineno">540</span><span class="op" id="857901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="857904">func</span>&nbsp;<span class="ident" id="857909">BenchmarkSelectSyncContended</span><span class="op" id="857937">(</span><span class="ident" id="857938">b</span>&nbsp;<span class="op" id="857940">*</span><span class="ident" id="857941">testing</span><span class="op" id="857948">.</span><span class="ident" id="857949">B</span><span class="op" id="857950">)</span>&nbsp;<span class="op" id="857952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857955">myc1</span>&nbsp;<span class="op" id="857960">:=</span>&nbsp;<span class="builtinfunc" id="857963">make</span><span class="op" id="857967">(</span><span class="keyword" id="857968">chan</span>&nbsp;<span class="builtintype" id="857973">int</span><span class="op" id="857976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="857979">myc2</span>&nbsp;<span class="op" id="857984">:=</span>&nbsp;<span class="builtinfunc" id="857987">make</span><span class="op" id="857991">(</span><span class="keyword" id="857992">chan</span>&nbsp;<span class="builtintype" id="857997">int</span><span class="op" id="858000">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858003">myc3</span>&nbsp;<span class="op" id="858008">:=</span>&nbsp;<span class="builtinfunc" id="858011">make</span><span class="op" id="858015">(</span><span class="keyword" id="858016">chan</span>&nbsp;<span class="builtintype" id="858021">int</span><span class="op" id="858024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858027">done</span>&nbsp;<span class="op" id="858032">:=</span>&nbsp;<span class="builtinfunc" id="858035">make</span><span class="op" id="858039">(</span><span class="keyword" id="858040">chan</span>&nbsp;<span class="builtintype" id="858045">int</span><span class="op" id="858048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858051">b</span><span class="op" id="858052">.</span><span class="ident" id="858053">RunParallel</span><span class="op" id="858064">(</span><span class="keyword" id="858065">func</span><span class="op" id="858069">(</span><span class="ident" id="858070">pb</span>&nbsp;<span class="op" id="858073">*</span><span class="ident" id="858074">testing</span><span class="op" id="858081">.</span><span class="ident" id="858082">PB</span><span class="op" id="858084">)</span>&nbsp;<span class="op" id="858086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858090">go</span>&nbsp;<span class="keyword" id="858093">func</span><span class="op" id="858097">(</span><span class="op" id="858098">)</span>&nbsp;<span class="op" id="858100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858105">for</span>&nbsp;<span class="op" id="858109">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858115">select</span>&nbsp;<span class="op" id="858122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858128">case</span>&nbsp;<span class="ident" id="858133">myc1</span>&nbsp;<span class="op" id="858138">&lt;-</span>&nbsp;<span class="num" id="858141">0</span><span class="op" id="858142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858148">case</span>&nbsp;<span class="ident" id="858153">myc2</span>&nbsp;<span class="op" id="858158">&lt;-</span>&nbsp;<span class="num" id="858161">0</span><span class="op" id="858162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858168">case</span>&nbsp;<span class="ident" id="858173">myc3</span>&nbsp;<span class="op" id="858178">&lt;-</span>&nbsp;<span class="num" id="858181">0</span><span class="op" id="858182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858188">case</span>&nbsp;<span class="op" id="858193">&lt;-</span><span class="ident" id="858195">done</span><span class="op" id="858199">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858206">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858226">}</span><span class="op" id="858227">(</span><span class="op" id="858228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858232">for</span>&nbsp;<span class="ident" id="858236">pb</span><span class="op" id="858238">.</span><span class="ident" id="858239">Next</span><span class="op" id="858243">(</span><span class="op" id="858244">)</span>&nbsp;<span class="op" id="858246">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858251">select</span>&nbsp;<span class="op" id="858258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858263">case</span>&nbsp;<span class="op" id="858268">&lt;-</span><span class="ident" id="858270">myc1</span><span class="op" id="858274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858279">case</span>&nbsp;<span class="op" id="858284">&lt;-</span><span class="ident" id="858286">myc2</span><span class="op" id="858290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858295">case</span>&nbsp;<span class="op" id="858300">&lt;-</span><span class="ident" id="858302">myc3</span><span class="op" id="858306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858311">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858318">}</span><span class="op" id="858319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="858322">close</span><span class="op" id="858327">(</span><span class="ident" id="858328">done</span><span class="op" id="858332">)</span><br>
<span class="lineno"></span><span class="op" id="858334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="858337">func</span>&nbsp;<span class="ident" id="858342">BenchmarkSelectAsyncContended</span><span class="op" id="858371">(</span><span class="ident" id="858372">b</span>&nbsp;<span class="op" id="858374">*</span><span class="ident" id="858375">testing</span><span class="op" id="858382">.</span><span class="ident" id="858383">B</span><span class="op" id="858384">)</span>&nbsp;<span class="op" id="858386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858389">procs</span>&nbsp;<span class="op" id="858395">:=</span>&nbsp;<span class="ident" id="858398">runtime</span><span class="op" id="858405">.</span><span class="ident" id="858406">GOMAXPROCS</span><span class="op" id="858416">(</span><span class="num" id="858417">0</span><span class="op" id="858418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858421">myc1</span>&nbsp;<span class="op" id="858426">:=</span>&nbsp;<span class="builtinfunc" id="858429">make</span><span class="op" id="858433">(</span><span class="keyword" id="858434">chan</span>&nbsp;<span class="builtintype" id="858439">int</span><span class="op" id="858442">,</span>&nbsp;<span class="ident" id="858444">procs</span><span class="op" id="858449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858452">myc2</span>&nbsp;<span class="op" id="858457">:=</span>&nbsp;<span class="builtinfunc" id="858460">make</span><span class="op" id="858464">(</span><span class="keyword" id="858465">chan</span>&nbsp;<span class="builtintype" id="858470">int</span><span class="op" id="858473">,</span>&nbsp;<span class="ident" id="858475">procs</span><span class="op" id="858480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858483">b</span><span class="op" id="858484">.</span><span class="ident" id="858485">RunParallel</span><span class="op" id="858496">(</span><span class="keyword" id="858497">func</span><span class="op" id="858501">(</span><span class="ident" id="858502">pb</span>&nbsp;<span class="op" id="858505">*</span><span class="ident" id="858506">testing</span><span class="op" id="858513">.</span><span class="ident" id="858514">PB</span><span class="op" id="858516">)</span>&nbsp;<span class="op" id="858518">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858522">myc1</span>&nbsp;<span class="op" id="858527">&lt;-</span>&nbsp;<span class="num" id="858530">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858534">for</span>&nbsp;<span class="ident" id="858538">pb</span><span class="op" id="858540">.</span><span class="ident" id="858541">Next</span><span class="op" id="858545">(</span><span class="op" id="858546">)</span>&nbsp;<span class="op" id="858548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858553">select</span>&nbsp;<span class="op" id="858560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858565">case</span>&nbsp;<span class="op" id="858570">&lt;-</span><span class="ident" id="858572">myc1</span><span class="op" id="858576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858582">myc2</span>&nbsp;<span class="op" id="858587">&lt;-</span>&nbsp;<span class="num" id="858590">0</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858595">case</span>&nbsp;<span class="op" id="858600">&lt;-</span><span class="ident" id="858602">myc2</span><span class="op" id="858606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858612">myc1</span>&nbsp;<span class="op" id="858617">&lt;-</span>&nbsp;<span class="num" id="858620">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858632">}</span><span class="op" id="858633">)</span><br>
<span class="lineno">585</span><span class="op" id="858635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="858638">func</span>&nbsp;<span class="ident" id="858643">BenchmarkSelectNonblock</span><span class="op" id="858666">(</span><span class="ident" id="858667">b</span>&nbsp;<span class="op" id="858669">*</span><span class="ident" id="858670">testing</span><span class="op" id="858677">.</span><span class="ident" id="858678">B</span><span class="op" id="858679">)</span>&nbsp;<span class="op" id="858681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858684">myc1</span>&nbsp;<span class="op" id="858689">:=</span>&nbsp;<span class="builtinfunc" id="858692">make</span><span class="op" id="858696">(</span><span class="keyword" id="858697">chan</span>&nbsp;<span class="builtintype" id="858702">int</span><span class="op" id="858705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858708">myc2</span>&nbsp;<span class="op" id="858713">:=</span>&nbsp;<span class="builtinfunc" id="858716">make</span><span class="op" id="858720">(</span><span class="keyword" id="858721">chan</span>&nbsp;<span class="builtintype" id="858726">int</span><span class="op" id="858729">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858732">myc3</span>&nbsp;<span class="op" id="858737">:=</span>&nbsp;<span class="builtinfunc" id="858740">make</span><span class="op" id="858744">(</span><span class="keyword" id="858745">chan</span>&nbsp;<span class="builtintype" id="858750">int</span><span class="op" id="858753">,</span>&nbsp;<span class="num" id="858755">1</span><span class="op" id="858756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858759">myc4</span>&nbsp;<span class="op" id="858764">:=</span>&nbsp;<span class="builtinfunc" id="858767">make</span><span class="op" id="858771">(</span><span class="keyword" id="858772">chan</span>&nbsp;<span class="builtintype" id="858777">int</span><span class="op" id="858780">,</span>&nbsp;<span class="num" id="858782">1</span><span class="op" id="858783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="858786">b</span><span class="op" id="858787">.</span><span class="ident" id="858788">RunParallel</span><span class="op" id="858799">(</span><span class="keyword" id="858800">func</span><span class="op" id="858804">(</span><span class="ident" id="858805">pb</span>&nbsp;<span class="op" id="858808">*</span><span class="ident" id="858809">testing</span><span class="op" id="858816">.</span><span class="ident" id="858817">PB</span><span class="op" id="858819">)</span>&nbsp;<span class="op" id="858821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858825">for</span>&nbsp;<span class="ident" id="858829">pb</span><span class="op" id="858831">.</span><span class="ident" id="858832">Next</span><span class="op" id="858836">(</span><span class="op" id="858837">)</span>&nbsp;<span class="op" id="858839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858844">select</span>&nbsp;<span class="op" id="858851">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858856">case</span>&nbsp;<span class="op" id="858861">&lt;-</span><span class="ident" id="858863">myc1</span><span class="op" id="858867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858872">default</span><span class="op" id="858879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858889">select</span>&nbsp;<span class="op" id="858896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858901">case</span>&nbsp;<span class="ident" id="858906">myc2</span>&nbsp;<span class="op" id="858911">&lt;-</span>&nbsp;<span class="num" id="858914">0</span><span class="op" id="858915">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858920">default</span><span class="op" id="858927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858937">select</span>&nbsp;<span class="op" id="858944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858949">case</span>&nbsp;<span class="op" id="858954">&lt;-</span><span class="ident" id="858956">myc3</span><span class="op" id="858960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858965">default</span><span class="op" id="858972">:</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="858977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858982">select</span>&nbsp;<span class="op" id="858989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="858994">case</span>&nbsp;<span class="ident" id="858999">myc4</span>&nbsp;<span class="op" id="859004">&lt;-</span>&nbsp;<span class="num" id="859007">0</span><span class="op" id="859008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859013">default</span><span class="op" id="859020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859025">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859032">}</span><span class="op" id="859033">)</span><br>
<span class="lineno"></span><span class="op" id="859035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="859038">func</span>&nbsp;<span class="ident" id="859043">BenchmarkChanUncontended</span><span class="op" id="859067">(</span><span class="ident" id="859068">b</span>&nbsp;<span class="op" id="859070">*</span><span class="ident" id="859071">testing</span><span class="op" id="859078">.</span><span class="ident" id="859079">B</span><span class="op" id="859080">)</span>&nbsp;<span class="op" id="859082">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859085">const</span>&nbsp;<span class="ident" id="859091">C</span>&nbsp;<span class="op" id="859093">=</span>&nbsp;<span class="num" id="859095">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859100">b</span><span class="op" id="859101">.</span><span class="ident" id="859102">RunParallel</span><span class="op" id="859113">(</span><span class="keyword" id="859114">func</span><span class="op" id="859118">(</span><span class="ident" id="859119">pb</span>&nbsp;<span class="op" id="859122">*</span><span class="ident" id="859123">testing</span><span class="op" id="859130">.</span><span class="ident" id="859131">PB</span><span class="op" id="859133">)</span>&nbsp;<span class="op" id="859135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859139">myc</span>&nbsp;<span class="op" id="859143">:=</span>&nbsp;<span class="builtinfunc" id="859146">make</span><span class="op" id="859150">(</span><span class="keyword" id="859151">chan</span>&nbsp;<span class="builtintype" id="859156">int</span><span class="op" id="859159">,</span>&nbsp;<span class="ident" id="859161">C</span><span class="op" id="859162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859166">for</span>&nbsp;<span class="ident" id="859170">pb</span><span class="op" id="859172">.</span><span class="ident" id="859173">Next</span><span class="op" id="859177">(</span><span class="op" id="859178">)</span>&nbsp;<span class="op" id="859180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859185">for</span>&nbsp;<span class="ident" id="859189">i</span>&nbsp;<span class="op" id="859191">:=</span>&nbsp;<span class="num" id="859194">0</span><span class="op" id="859195">;</span>&nbsp;<span class="ident" id="859197">i</span>&nbsp;<span class="op" id="859199">&lt;</span>&nbsp;<span class="ident" id="859201">C</span><span class="op" id="859202">;</span>&nbsp;<span class="ident" id="859204">i</span><span class="op" id="859205">++</span>&nbsp;<span class="op" id="859208">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859214">myc</span>&nbsp;<span class="op" id="859218">&lt;-</span>&nbsp;<span class="num" id="859221">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859231">for</span>&nbsp;<span class="ident" id="859235">i</span>&nbsp;<span class="op" id="859237">:=</span>&nbsp;<span class="num" id="859240">0</span><span class="op" id="859241">;</span>&nbsp;<span class="ident" id="859243">i</span>&nbsp;<span class="op" id="859245">&lt;</span>&nbsp;<span class="ident" id="859247">C</span><span class="op" id="859248">;</span>&nbsp;<span class="ident" id="859250">i</span><span class="op" id="859251">++</span>&nbsp;<span class="op" id="859254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859260">&lt;-</span><span class="ident" id="859262">myc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859269">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859276">}</span><span class="op" id="859277">)</span><br>
<span class="lineno"></span><span class="op" id="859279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="859282">func</span>&nbsp;<span class="ident" id="859287">BenchmarkChanContended</span><span class="op" id="859309">(</span><span class="ident" id="859310">b</span>&nbsp;<span class="op" id="859312">*</span><span class="ident" id="859313">testing</span><span class="op" id="859320">.</span><span class="ident" id="859321">B</span><span class="op" id="859322">)</span>&nbsp;<span class="op" id="859324">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859327">const</span>&nbsp;<span class="ident" id="859333">C</span>&nbsp;<span class="op" id="859335">=</span>&nbsp;<span class="num" id="859337">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859342">myc</span>&nbsp;<span class="op" id="859346">:=</span>&nbsp;<span class="builtinfunc" id="859349">make</span><span class="op" id="859353">(</span><span class="keyword" id="859354">chan</span>&nbsp;<span class="builtintype" id="859359">int</span><span class="op" id="859362">,</span>&nbsp;<span class="ident" id="859364">C</span><span class="op" id="859365">*</span><span class="ident" id="859366">runtime</span><span class="op" id="859373">.</span><span class="ident" id="859374">GOMAXPROCS</span><span class="op" id="859384">(</span><span class="num" id="859385">0</span><span class="op" id="859386">)</span><span class="op" id="859387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859390">b</span><span class="op" id="859391">.</span><span class="ident" id="859392">RunParallel</span><span class="op" id="859403">(</span><span class="keyword" id="859404">func</span><span class="op" id="859408">(</span><span class="ident" id="859409">pb</span>&nbsp;<span class="op" id="859412">*</span><span class="ident" id="859413">testing</span><span class="op" id="859420">.</span><span class="ident" id="859421">PB</span><span class="op" id="859423">)</span>&nbsp;<span class="op" id="859425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859429">for</span>&nbsp;<span class="ident" id="859433">pb</span><span class="op" id="859435">.</span><span class="ident" id="859436">Next</span><span class="op" id="859440">(</span><span class="op" id="859441">)</span>&nbsp;<span class="op" id="859443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859448">for</span>&nbsp;<span class="ident" id="859452">i</span>&nbsp;<span class="op" id="859454">:=</span>&nbsp;<span class="num" id="859457">0</span><span class="op" id="859458">;</span>&nbsp;<span class="ident" id="859460">i</span>&nbsp;<span class="op" id="859462">&lt;</span>&nbsp;<span class="ident" id="859464">C</span><span class="op" id="859465">;</span>&nbsp;<span class="ident" id="859467">i</span><span class="op" id="859468">++</span>&nbsp;<span class="op" id="859471">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859477">myc</span>&nbsp;<span class="op" id="859481">&lt;-</span>&nbsp;<span class="num" id="859484">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859494">for</span>&nbsp;<span class="ident" id="859498">i</span>&nbsp;<span class="op" id="859500">:=</span>&nbsp;<span class="num" id="859503">0</span><span class="op" id="859504">;</span>&nbsp;<span class="ident" id="859506">i</span>&nbsp;<span class="op" id="859508">&lt;</span>&nbsp;<span class="ident" id="859510">C</span><span class="op" id="859511">;</span>&nbsp;<span class="ident" id="859513">i</span><span class="op" id="859514">++</span>&nbsp;<span class="op" id="859517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859523">&lt;-</span><span class="ident" id="859525">myc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859532">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859539">}</span><span class="op" id="859540">)</span><br>
<span class="lineno"></span><span class="op" id="859542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="859545">func</span>&nbsp;<span class="ident" id="859550">BenchmarkChanSync</span><span class="op" id="859567">(</span><span class="ident" id="859568">b</span>&nbsp;<span class="op" id="859570">*</span><span class="ident" id="859571">testing</span><span class="op" id="859578">.</span><span class="ident" id="859579">B</span><span class="op" id="859580">)</span>&nbsp;<span class="op" id="859582">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859585">const</span>&nbsp;<span class="ident" id="859591">CallsPerSched</span>&nbsp;<span class="op" id="859605">=</span>&nbsp;<span class="num" id="859607">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859613">procs</span>&nbsp;<span class="op" id="859619">:=</span>&nbsp;<span class="num" id="859622">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859625">N</span>&nbsp;<span class="op" id="859627">:=</span>&nbsp;<span class="builtintype" id="859630">int32</span><span class="op" id="859635">(</span><span class="ident" id="859636">b</span><span class="op" id="859637">.</span><span class="ident" id="859638">N</span>&nbsp;<span class="op" id="859640">/</span>&nbsp;<span class="ident" id="859642">CallsPerSched</span>&nbsp;<span class="op" id="859656">/</span>&nbsp;<span class="ident" id="859658">procs</span>&nbsp;<span class="op" id="859664">*</span>&nbsp;<span class="ident" id="859666">procs</span><span class="op" id="859671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859674">c</span>&nbsp;<span class="op" id="859676">:=</span>&nbsp;<span class="builtinfunc" id="859679">make</span><span class="op" id="859683">(</span><span class="keyword" id="859684">chan</span>&nbsp;<span class="builtintype" id="859689">bool</span><span class="op" id="859693">,</span>&nbsp;<span class="ident" id="859695">procs</span><span class="op" id="859700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859703">myc</span>&nbsp;<span class="op" id="859707">:=</span>&nbsp;<span class="builtinfunc" id="859710">make</span><span class="op" id="859714">(</span><span class="keyword" id="859715">chan</span>&nbsp;<span class="builtintype" id="859720">int</span><span class="op" id="859723">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859726">for</span>&nbsp;<span class="ident" id="859730">p</span>&nbsp;<span class="op" id="859732">:=</span>&nbsp;<span class="num" id="859735">0</span><span class="op" id="859736">;</span>&nbsp;<span class="ident" id="859738">p</span>&nbsp;<span class="op" id="859740">&lt;</span>&nbsp;<span class="ident" id="859742">procs</span><span class="op" id="859747">;</span>&nbsp;<span class="ident" id="859749">p</span><span class="op" id="859750">++</span>&nbsp;<span class="op" id="859753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859757">go</span>&nbsp;<span class="keyword" id="859760">func</span><span class="op" id="859764">(</span><span class="op" id="859765">)</span>&nbsp;<span class="op" id="859767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859772">for</span>&nbsp;<span class="op" id="859776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859782">i</span>&nbsp;<span class="op" id="859784">:=</span>&nbsp;<span class="ident" id="859787">atomic</span><span class="op" id="859793">.</span><span class="ident" id="859794">AddInt32</span><span class="op" id="859802">(</span><span class="op" id="859803">&amp;</span><span class="ident" id="859804">N</span><span class="op" id="859805">,</span>&nbsp;<span class="op" id="859807">-</span><span class="num" id="859808">1</span><span class="op" id="859809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859815">if</span>&nbsp;<span class="ident" id="859818">i</span>&nbsp;<span class="op" id="859820">&lt;</span>&nbsp;<span class="num" id="859822">0</span>&nbsp;<span class="op" id="859824">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859831">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859847">for</span>&nbsp;<span class="ident" id="859851">g</span>&nbsp;<span class="op" id="859853">:=</span>&nbsp;<span class="num" id="859856">0</span><span class="op" id="859857">;</span>&nbsp;<span class="ident" id="859859">g</span>&nbsp;<span class="op" id="859861">&lt;</span>&nbsp;<span class="ident" id="859863">CallsPerSched</span><span class="op" id="859876">;</span>&nbsp;<span class="ident" id="859878">g</span><span class="op" id="859879">++</span>&nbsp;<span class="op" id="859882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="859889">if</span>&nbsp;<span class="ident" id="859892">i</span><span class="op" id="859893">%</span><span class="num" id="859894">2</span>&nbsp;<span class="op" id="859896">==</span>&nbsp;<span class="num" id="859899">0</span>&nbsp;<span class="op" id="859901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859909">&lt;-</span><span class="ident" id="859911">myc</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859921">myc</span>&nbsp;<span class="op" id="859925">&lt;-</span>&nbsp;<span class="num" id="859928">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859935">}</span>&nbsp;<span class="keyword" id="859937">else</span>&nbsp;<span class="op" id="859942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859950">myc</span>&nbsp;<span class="op" id="859954">&lt;-</span>&nbsp;<span class="num" id="859957">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859965">&lt;-</span><span class="ident" id="859967">myc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859976">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="859987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="859992">c</span>&nbsp;<span class="op" id="859994">&lt;-</span>&nbsp;<span class="builtintype" id="859997">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860004">}</span><span class="op" id="860005">(</span><span class="op" id="860006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860009">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860012">for</span>&nbsp;<span class="ident" id="860016">p</span>&nbsp;<span class="op" id="860018">:=</span>&nbsp;<span class="num" id="860021">0</span><span class="op" id="860022">;</span>&nbsp;<span class="ident" id="860024">p</span>&nbsp;<span class="op" id="860026">&lt;</span>&nbsp;<span class="ident" id="860028">procs</span><span class="op" id="860033">;</span>&nbsp;<span class="ident" id="860035">p</span><span class="op" id="860036">++</span>&nbsp;<span class="op" id="860039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860043">&lt;-</span><span class="ident" id="860045">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860048">}</span><br>
<span class="lineno"></span><span class="op" id="860050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="860053">func</span>&nbsp;<span class="ident" id="860058">benchmarkChanProdCons</span><span class="op" id="860079">(</span><span class="ident" id="860080">b</span>&nbsp;<span class="op" id="860082">*</span><span class="ident" id="860083">testing</span><span class="op" id="860090">.</span><span class="ident" id="860091">B</span><span class="op" id="860092">,</span>&nbsp;<span class="ident" id="860094">chanSize</span><span class="op" id="860102">,</span>&nbsp;<span class="ident" id="860104">localWork</span>&nbsp;<span class="builtintype" id="860114">int</span><span class="op" id="860117">)</span>&nbsp;<span class="op" id="860119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860122">const</span>&nbsp;<span class="ident" id="860128">CallsPerSched</span>&nbsp;<span class="op" id="860142">=</span>&nbsp;<span class="num" id="860144">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860150">procs</span>&nbsp;<span class="op" id="860156">:=</span>&nbsp;<span class="ident" id="860159">runtime</span><span class="op" id="860166">.</span><span class="ident" id="860167">GOMAXPROCS</span><span class="op" id="860177">(</span><span class="op" id="860178">-</span><span class="num" id="860179">1</span><span class="op" id="860180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860183">N</span>&nbsp;<span class="op" id="860185">:=</span>&nbsp;<span class="builtintype" id="860188">int32</span><span class="op" id="860193">(</span><span class="ident" id="860194">b</span><span class="op" id="860195">.</span><span class="ident" id="860196">N</span>&nbsp;<span class="op" id="860198">/</span>&nbsp;<span class="ident" id="860200">CallsPerSched</span><span class="op" id="860213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860216">c</span>&nbsp;<span class="op" id="860218">:=</span>&nbsp;<span class="builtinfunc" id="860221">make</span><span class="op" id="860225">(</span><span class="keyword" id="860226">chan</span>&nbsp;<span class="builtintype" id="860231">bool</span><span class="op" id="860235">,</span>&nbsp;<span class="num" id="860237">2</span><span class="op" id="860238">*</span><span class="ident" id="860239">procs</span><span class="op" id="860244">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860247">myc</span>&nbsp;<span class="op" id="860251">:=</span>&nbsp;<span class="builtinfunc" id="860254">make</span><span class="op" id="860258">(</span><span class="keyword" id="860259">chan</span>&nbsp;<span class="builtintype" id="860264">int</span><span class="op" id="860267">,</span>&nbsp;<span class="ident" id="860269">chanSize</span><span class="op" id="860277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860280">for</span>&nbsp;<span class="ident" id="860284">p</span>&nbsp;<span class="op" id="860286">:=</span>&nbsp;<span class="num" id="860289">0</span><span class="op" id="860290">;</span>&nbsp;<span class="ident" id="860292">p</span>&nbsp;<span class="op" id="860294">&lt;</span>&nbsp;<span class="ident" id="860296">procs</span><span class="op" id="860301">;</span>&nbsp;<span class="ident" id="860303">p</span><span class="op" id="860304">++</span>&nbsp;<span class="op" id="860307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860311">go</span>&nbsp;<span class="keyword" id="860314">func</span><span class="op" id="860318">(</span><span class="op" id="860319">)</span>&nbsp;<span class="op" id="860321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860326">foo</span>&nbsp;<span class="op" id="860330">:=</span>&nbsp;<span class="num" id="860333">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860338">for</span>&nbsp;<span class="ident" id="860342">atomic</span><span class="op" id="860348">.</span><span class="ident" id="860349">AddInt32</span><span class="op" id="860357">(</span><span class="op" id="860358">&amp;</span><span class="ident" id="860359">N</span><span class="op" id="860360">,</span>&nbsp;<span class="op" id="860362">-</span><span class="num" id="860363">1</span><span class="op" id="860364">)</span>&nbsp;<span class="op" id="860366">&gt;=</span>&nbsp;<span class="num" id="860369">0</span>&nbsp;<span class="op" id="860371">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860377">for</span>&nbsp;<span class="ident" id="860381">g</span>&nbsp;<span class="op" id="860383">:=</span>&nbsp;<span class="num" id="860386">0</span><span class="op" id="860387">;</span>&nbsp;<span class="ident" id="860389">g</span>&nbsp;<span class="op" id="860391">&lt;</span>&nbsp;<span class="ident" id="860393">CallsPerSched</span><span class="op" id="860406">;</span>&nbsp;<span class="ident" id="860408">g</span><span class="op" id="860409">++</span>&nbsp;<span class="op" id="860412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860419">for</span>&nbsp;<span class="ident" id="860423">i</span>&nbsp;<span class="op" id="860425">:=</span>&nbsp;<span class="num" id="860428">0</span><span class="op" id="860429">;</span>&nbsp;<span class="ident" id="860431">i</span>&nbsp;<span class="op" id="860433">&lt;</span>&nbsp;<span class="ident" id="860435">localWork</span><span class="op" id="860444">;</span>&nbsp;<span class="ident" id="860446">i</span><span class="op" id="860447">++</span>&nbsp;<span class="op" id="860450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860458">foo</span>&nbsp;<span class="op" id="860462">*=</span>&nbsp;<span class="num" id="860465">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860473">foo</span>&nbsp;<span class="op" id="860477">/=</span>&nbsp;<span class="num" id="860480">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860487">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860494">myc</span>&nbsp;<span class="op" id="860498">&lt;-</span>&nbsp;<span class="num" id="860501">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860517">myc</span>&nbsp;<span class="op" id="860521">&lt;-</span>&nbsp;<span class="num" id="860524">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860529">c</span>&nbsp;<span class="op" id="860531">&lt;-</span>&nbsp;<span class="ident" id="860534">foo</span>&nbsp;<span class="op" id="860538">==</span>&nbsp;<span class="num" id="860541">42</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860546">}</span><span class="op" id="860547">(</span><span class="op" id="860548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860552">go</span>&nbsp;<span class="keyword" id="860555">func</span><span class="op" id="860559">(</span><span class="op" id="860560">)</span>&nbsp;<span class="op" id="860562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860567">foo</span>&nbsp;<span class="op" id="860571">:=</span>&nbsp;<span class="num" id="860574">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860579">for</span>&nbsp;<span class="op" id="860583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860589">v</span>&nbsp;<span class="op" id="860591">:=</span>&nbsp;<span class="op" id="860594">&lt;-</span><span class="ident" id="860596">myc</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860604">if</span>&nbsp;<span class="ident" id="860607">v</span>&nbsp;<span class="op" id="860609">==</span>&nbsp;<span class="num" id="860612">0</span>&nbsp;<span class="op" id="860614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860621">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860637">for</span>&nbsp;<span class="ident" id="860641">i</span>&nbsp;<span class="op" id="860643">:=</span>&nbsp;<span class="num" id="860646">0</span><span class="op" id="860647">;</span>&nbsp;<span class="ident" id="860649">i</span>&nbsp;<span class="op" id="860651">&lt;</span>&nbsp;<span class="ident" id="860653">localWork</span><span class="op" id="860662">;</span>&nbsp;<span class="ident" id="860664">i</span><span class="op" id="860665">++</span>&nbsp;<span class="op" id="860668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860675">foo</span>&nbsp;<span class="op" id="860679">*=</span>&nbsp;<span class="num" id="860682">2</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860689">foo</span>&nbsp;<span class="op" id="860693">/=</span>&nbsp;<span class="num" id="860696">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860712">c</span>&nbsp;<span class="op" id="860714">&lt;-</span>&nbsp;<span class="ident" id="860717">foo</span>&nbsp;<span class="op" id="860721">==</span>&nbsp;<span class="num" id="860724">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860729">}</span><span class="op" id="860730">(</span><span class="op" id="860731">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="860737">for</span>&nbsp;<span class="ident" id="860741">p</span>&nbsp;<span class="op" id="860743">:=</span>&nbsp;<span class="num" id="860746">0</span><span class="op" id="860747">;</span>&nbsp;<span class="ident" id="860749">p</span>&nbsp;<span class="op" id="860751">&lt;</span>&nbsp;<span class="ident" id="860753">procs</span><span class="op" id="860758">;</span>&nbsp;<span class="ident" id="860760">p</span><span class="op" id="860761">++</span>&nbsp;<span class="op" id="860764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860768">&lt;-</span><span class="ident" id="860770">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860774">&lt;-</span><span class="ident" id="860776">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="860779">}</span><br>
<span class="lineno">715</span><span class="op" id="860781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="860784">func</span>&nbsp;<span class="ident" id="860789">BenchmarkChanProdCons0</span><span class="op" id="860811">(</span><span class="ident" id="860812">b</span>&nbsp;<span class="op" id="860814">*</span><span class="ident" id="860815">testing</span><span class="op" id="860822">.</span><span class="ident" id="860823">B</span><span class="op" id="860824">)</span>&nbsp;<span class="op" id="860826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860829">benchmarkChanProdCons</span><span class="op" id="860850">(</span><span class="ident" id="860851">b</span><span class="op" id="860852">,</span>&nbsp;<span class="num" id="860854">0</span><span class="op" id="860855">,</span>&nbsp;<span class="num" id="860857">0</span><span class="op" id="860858">)</span><br>
<span class="lineno"></span><span class="op" id="860860">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="860863">func</span>&nbsp;<span class="ident" id="860868">BenchmarkChanProdCons10</span><span class="op" id="860891">(</span><span class="ident" id="860892">b</span>&nbsp;<span class="op" id="860894">*</span><span class="ident" id="860895">testing</span><span class="op" id="860902">.</span><span class="ident" id="860903">B</span><span class="op" id="860904">)</span>&nbsp;<span class="op" id="860906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860909">benchmarkChanProdCons</span><span class="op" id="860930">(</span><span class="ident" id="860931">b</span><span class="op" id="860932">,</span>&nbsp;<span class="num" id="860934">10</span><span class="op" id="860936">,</span>&nbsp;<span class="num" id="860938">0</span><span class="op" id="860939">)</span><br>
<span class="lineno"></span><span class="op" id="860941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="860944">func</span>&nbsp;<span class="ident" id="860949">BenchmarkChanProdCons100</span><span class="op" id="860973">(</span><span class="ident" id="860974">b</span>&nbsp;<span class="op" id="860976">*</span><span class="ident" id="860977">testing</span><span class="op" id="860984">.</span><span class="ident" id="860985">B</span><span class="op" id="860986">)</span>&nbsp;<span class="op" id="860988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="860991">benchmarkChanProdCons</span><span class="op" id="861012">(</span><span class="ident" id="861013">b</span><span class="op" id="861014">,</span>&nbsp;<span class="num" id="861016">100</span><span class="op" id="861019">,</span>&nbsp;<span class="num" id="861021">0</span><span class="op" id="861022">)</span><br>
<span class="lineno"></span><span class="op" id="861024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="861027">func</span>&nbsp;<span class="ident" id="861032">BenchmarkChanProdConsWork0</span><span class="op" id="861058">(</span><span class="ident" id="861059">b</span>&nbsp;<span class="op" id="861061">*</span><span class="ident" id="861062">testing</span><span class="op" id="861069">.</span><span class="ident" id="861070">B</span><span class="op" id="861071">)</span>&nbsp;<span class="op" id="861073">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861076">benchmarkChanProdCons</span><span class="op" id="861097">(</span><span class="ident" id="861098">b</span><span class="op" id="861099">,</span>&nbsp;<span class="num" id="861101">0</span><span class="op" id="861102">,</span>&nbsp;<span class="num" id="861104">100</span><span class="op" id="861107">)</span><br>
<span class="lineno"></span><span class="op" id="861109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="861112">func</span>&nbsp;<span class="ident" id="861117">BenchmarkChanProdConsWork10</span><span class="op" id="861144">(</span><span class="ident" id="861145">b</span>&nbsp;<span class="op" id="861147">*</span><span class="ident" id="861148">testing</span><span class="op" id="861155">.</span><span class="ident" id="861156">B</span><span class="op" id="861157">)</span>&nbsp;<span class="op" id="861159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861162">benchmarkChanProdCons</span><span class="op" id="861183">(</span><span class="ident" id="861184">b</span><span class="op" id="861185">,</span>&nbsp;<span class="num" id="861187">10</span><span class="op" id="861189">,</span>&nbsp;<span class="num" id="861191">100</span><span class="op" id="861194">)</span><br>
<span class="lineno">735</span><span class="op" id="861196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="861199">func</span>&nbsp;<span class="ident" id="861204">BenchmarkChanProdConsWork100</span><span class="op" id="861232">(</span><span class="ident" id="861233">b</span>&nbsp;<span class="op" id="861235">*</span><span class="ident" id="861236">testing</span><span class="op" id="861243">.</span><span class="ident" id="861244">B</span><span class="op" id="861245">)</span>&nbsp;<span class="op" id="861247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861250">benchmarkChanProdCons</span><span class="op" id="861271">(</span><span class="ident" id="861272">b</span><span class="op" id="861273">,</span>&nbsp;<span class="num" id="861275">100</span><span class="op" id="861278">,</span>&nbsp;<span class="num" id="861280">100</span><span class="op" id="861283">)</span><br>
<span class="lineno"></span><span class="op" id="861285">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="861288">func</span>&nbsp;<span class="ident" id="861293">BenchmarkSelectProdCons</span><span class="op" id="861316">(</span><span class="ident" id="861317">b</span>&nbsp;<span class="op" id="861319">*</span><span class="ident" id="861320">testing</span><span class="op" id="861327">.</span><span class="ident" id="861328">B</span><span class="op" id="861329">)</span>&nbsp;<span class="op" id="861331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861334">const</span>&nbsp;<span class="ident" id="861340">CallsPerSched</span>&nbsp;<span class="op" id="861354">=</span>&nbsp;<span class="num" id="861356">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861362">procs</span>&nbsp;<span class="op" id="861368">:=</span>&nbsp;<span class="ident" id="861371">runtime</span><span class="op" id="861378">.</span><span class="ident" id="861379">GOMAXPROCS</span><span class="op" id="861389">(</span><span class="op" id="861390">-</span><span class="num" id="861391">1</span><span class="op" id="861392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861395">N</span>&nbsp;<span class="op" id="861397">:=</span>&nbsp;<span class="builtintype" id="861400">int32</span><span class="op" id="861405">(</span><span class="ident" id="861406">b</span><span class="op" id="861407">.</span><span class="ident" id="861408">N</span>&nbsp;<span class="op" id="861410">/</span>&nbsp;<span class="ident" id="861412">CallsPerSched</span><span class="op" id="861425">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861428">c</span>&nbsp;<span class="op" id="861430">:=</span>&nbsp;<span class="builtinfunc" id="861433">make</span><span class="op" id="861437">(</span><span class="keyword" id="861438">chan</span>&nbsp;<span class="builtintype" id="861443">bool</span><span class="op" id="861447">,</span>&nbsp;<span class="num" id="861449">2</span><span class="op" id="861450">*</span><span class="ident" id="861451">procs</span><span class="op" id="861456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861459">myc</span>&nbsp;<span class="op" id="861463">:=</span>&nbsp;<span class="builtinfunc" id="861466">make</span><span class="op" id="861470">(</span><span class="keyword" id="861471">chan</span>&nbsp;<span class="builtintype" id="861476">int</span><span class="op" id="861479">,</span>&nbsp;<span class="num" id="861481">128</span><span class="op" id="861484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861487">myclose</span>&nbsp;<span class="op" id="861495">:=</span>&nbsp;<span class="builtinfunc" id="861498">make</span><span class="op" id="861502">(</span><span class="keyword" id="861503">chan</span>&nbsp;<span class="builtintype" id="861508">bool</span><span class="op" id="861512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861515">for</span>&nbsp;<span class="ident" id="861519">p</span>&nbsp;<span class="op" id="861521">:=</span>&nbsp;<span class="num" id="861524">0</span><span class="op" id="861525">;</span>&nbsp;<span class="ident" id="861527">p</span>&nbsp;<span class="op" id="861529">&lt;</span>&nbsp;<span class="ident" id="861531">procs</span><span class="op" id="861536">;</span>&nbsp;<span class="ident" id="861538">p</span><span class="op" id="861539">++</span>&nbsp;<span class="op" id="861542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861546">go</span>&nbsp;<span class="keyword" id="861549">func</span><span class="op" id="861553">(</span><span class="op" id="861554">)</span>&nbsp;<span class="op" id="861556">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="861561">//&nbsp;Producer:&nbsp;sends&nbsp;to&nbsp;myc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861591">foo</span>&nbsp;<span class="op" id="861595">:=</span>&nbsp;<span class="num" id="861598">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="861603">//&nbsp;Intended&nbsp;to&nbsp;not&nbsp;fire&nbsp;during&nbsp;benchmarking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861651">mytimer</span>&nbsp;<span class="op" id="861659">:=</span>&nbsp;<span class="ident" id="861662">time</span><span class="op" id="861666">.</span><span class="ident" id="861667">After</span><span class="op" id="861672">(</span><span class="ident" id="861673">time</span><span class="op" id="861677">.</span><span class="ident" id="861678">Hour</span><span class="op" id="861682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861687">for</span>&nbsp;<span class="ident" id="861691">atomic</span><span class="op" id="861697">.</span><span class="ident" id="861698">AddInt32</span><span class="op" id="861706">(</span><span class="op" id="861707">&amp;</span><span class="ident" id="861708">N</span><span class="op" id="861709">,</span>&nbsp;<span class="op" id="861711">-</span><span class="num" id="861712">1</span><span class="op" id="861713">)</span>&nbsp;<span class="op" id="861715">&gt;=</span>&nbsp;<span class="num" id="861718">0</span>&nbsp;<span class="op" id="861720">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861726">for</span>&nbsp;<span class="ident" id="861730">g</span>&nbsp;<span class="op" id="861732">:=</span>&nbsp;<span class="num" id="861735">0</span><span class="op" id="861736">;</span>&nbsp;<span class="ident" id="861738">g</span>&nbsp;<span class="op" id="861740">&lt;</span>&nbsp;<span class="ident" id="861742">CallsPerSched</span><span class="op" id="861755">;</span>&nbsp;<span class="ident" id="861757">g</span><span class="op" id="861758">++</span>&nbsp;<span class="op" id="861761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="861768">//&nbsp;Model&nbsp;some&nbsp;local&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861799">for</span>&nbsp;<span class="ident" id="861803">i</span>&nbsp;<span class="op" id="861805">:=</span>&nbsp;<span class="num" id="861808">0</span><span class="op" id="861809">;</span>&nbsp;<span class="ident" id="861811">i</span>&nbsp;<span class="op" id="861813">&lt;</span>&nbsp;<span class="num" id="861815">100</span><span class="op" id="861818">;</span>&nbsp;<span class="ident" id="861820">i</span><span class="op" id="861821">++</span>&nbsp;<span class="op" id="861824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861832">foo</span>&nbsp;<span class="op" id="861836">*=</span>&nbsp;<span class="num" id="861839">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861847">foo</span>&nbsp;<span class="op" id="861851">/=</span>&nbsp;<span class="num" id="861854">2</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="861861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861868">select</span>&nbsp;<span class="op" id="861875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861882">case</span>&nbsp;<span class="ident" id="861887">myc</span>&nbsp;<span class="op" id="861891">&lt;-</span>&nbsp;<span class="num" id="861894">1</span><span class="op" id="861895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861902">case</span>&nbsp;<span class="op" id="861907">&lt;-</span><span class="ident" id="861909">mytimer</span><span class="op" id="861916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861923">case</span>&nbsp;<span class="op" id="861928">&lt;-</span><span class="ident" id="861930">myclose</span><span class="op" id="861937">:</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="861944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="861950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="861955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861960">myc</span>&nbsp;<span class="op" id="861964">&lt;-</span>&nbsp;<span class="num" id="861967">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="861972">c</span>&nbsp;<span class="op" id="861974">&lt;-</span>&nbsp;<span class="ident" id="861977">foo</span>&nbsp;<span class="op" id="861981">==</span>&nbsp;<span class="num" id="861984">42</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="861989">}</span><span class="op" id="861990">(</span><span class="op" id="861991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="861995">go</span>&nbsp;<span class="keyword" id="861998">func</span><span class="op" id="862002">(</span><span class="op" id="862003">)</span>&nbsp;<span class="op" id="862005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="862010">//&nbsp;Consumer:&nbsp;receives&nbsp;from&nbsp;myc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862045">foo</span>&nbsp;<span class="op" id="862049">:=</span>&nbsp;<span class="num" id="862052">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="862057">//&nbsp;Intended&nbsp;to&nbsp;not&nbsp;fire&nbsp;during&nbsp;benchmarking.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862105">mytimer</span>&nbsp;<span class="op" id="862113">:=</span>&nbsp;<span class="ident" id="862116">time</span><span class="op" id="862120">.</span><span class="ident" id="862121">After</span><span class="op" id="862126">(</span><span class="ident" id="862127">time</span><span class="op" id="862131">.</span><span class="ident" id="862132">Hour</span><span class="op" id="862136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862140">loop</span><span class="op" id="862144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862149">for</span>&nbsp;<span class="op" id="862153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862159">select</span>&nbsp;<span class="op" id="862166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862172">case</span>&nbsp;<span class="ident" id="862177">v</span>&nbsp;<span class="op" id="862179">:=</span>&nbsp;<span class="op" id="862182">&lt;-</span><span class="ident" id="862184">myc</span><span class="op" id="862187">:</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862194">if</span>&nbsp;<span class="ident" id="862197">v</span>&nbsp;<span class="op" id="862199">==</span>&nbsp;<span class="num" id="862202">0</span>&nbsp;<span class="op" id="862204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862212">break</span>&nbsp;<span class="ident" id="862218">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862234">case</span>&nbsp;<span class="op" id="862239">&lt;-</span><span class="ident" id="862241">mytimer</span><span class="op" id="862248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862254">case</span>&nbsp;<span class="op" id="862259">&lt;-</span><span class="ident" id="862261">myclose</span><span class="op" id="862268">:</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="862280">//&nbsp;Model&nbsp;some&nbsp;local&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862310">for</span>&nbsp;<span class="ident" id="862314">i</span>&nbsp;<span class="op" id="862316">:=</span>&nbsp;<span class="num" id="862319">0</span><span class="op" id="862320">;</span>&nbsp;<span class="ident" id="862322">i</span>&nbsp;<span class="op" id="862324">&lt;</span>&nbsp;<span class="num" id="862326">100</span><span class="op" id="862329">;</span>&nbsp;<span class="ident" id="862331">i</span><span class="op" id="862332">++</span>&nbsp;<span class="op" id="862335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862342">foo</span>&nbsp;<span class="op" id="862346">*=</span>&nbsp;<span class="num" id="862349">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862356">foo</span>&nbsp;<span class="op" id="862360">/=</span>&nbsp;<span class="num" id="862363">2</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862379">c</span>&nbsp;<span class="op" id="862381">&lt;-</span>&nbsp;<span class="ident" id="862384">foo</span>&nbsp;<span class="op" id="862388">==</span>&nbsp;<span class="num" id="862391">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862396">}</span><span class="op" id="862397">(</span><span class="op" id="862398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862401">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862404">for</span>&nbsp;<span class="ident" id="862408">p</span>&nbsp;<span class="op" id="862410">:=</span>&nbsp;<span class="num" id="862413">0</span><span class="op" id="862414">;</span>&nbsp;<span class="ident" id="862416">p</span>&nbsp;<span class="op" id="862418">&lt;</span>&nbsp;<span class="ident" id="862420">procs</span><span class="op" id="862425">;</span>&nbsp;<span class="ident" id="862427">p</span><span class="op" id="862428">++</span>&nbsp;<span class="op" id="862431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862435">&lt;-</span><span class="ident" id="862437">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862441">&lt;-</span><span class="ident" id="862443">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862446">}</span><br>
<span class="lineno"></span><span class="op" id="862448">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span><span class="keyword" id="862451">func</span>&nbsp;<span class="ident" id="862456">BenchmarkChanCreation</span><span class="op" id="862477">(</span><span class="ident" id="862478">b</span>&nbsp;<span class="op" id="862480">*</span><span class="ident" id="862481">testing</span><span class="op" id="862488">.</span><span class="ident" id="862489">B</span><span class="op" id="862490">)</span>&nbsp;<span class="op" id="862492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862495">b</span><span class="op" id="862496">.</span><span class="ident" id="862497">RunParallel</span><span class="op" id="862508">(</span><span class="keyword" id="862509">func</span><span class="op" id="862513">(</span><span class="ident" id="862514">pb</span>&nbsp;<span class="op" id="862517">*</span><span class="ident" id="862518">testing</span><span class="op" id="862525">.</span><span class="ident" id="862526">PB</span><span class="op" id="862528">)</span>&nbsp;<span class="op" id="862530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862534">for</span>&nbsp;<span class="ident" id="862538">pb</span><span class="op" id="862540">.</span><span class="ident" id="862541">Next</span><span class="op" id="862545">(</span><span class="op" id="862546">)</span>&nbsp;<span class="op" id="862548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862553">myc</span>&nbsp;<span class="op" id="862557">:=</span>&nbsp;<span class="builtinfunc" id="862560">make</span><span class="op" id="862564">(</span><span class="keyword" id="862565">chan</span>&nbsp;<span class="builtintype" id="862570">int</span><span class="op" id="862573">,</span>&nbsp;<span class="num" id="862575">1</span><span class="op" id="862576">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862581">myc</span>&nbsp;<span class="op" id="862585">&lt;-</span>&nbsp;<span class="num" id="862588">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862593">&lt;-</span><span class="ident" id="862595">myc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862604">}</span><span class="op" id="862605">)</span><br>
<span class="lineno"></span><span class="op" id="862607">}</span><br>
<span class="lineno">810</span><br>
<span class="lineno"></span><span class="keyword" id="862610">func</span>&nbsp;<span class="ident" id="862615">BenchmarkChanSem</span><span class="op" id="862631">(</span><span class="ident" id="862632">b</span>&nbsp;<span class="op" id="862634">*</span><span class="ident" id="862635">testing</span><span class="op" id="862642">.</span><span class="ident" id="862643">B</span><span class="op" id="862644">)</span>&nbsp;<span class="op" id="862646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862649">type</span>&nbsp;<span class="ident" id="862654">Empty</span>&nbsp;<span class="keyword" id="862660">struct</span><span class="op" id="862666">{</span><span class="op" id="862667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862670">myc</span>&nbsp;<span class="op" id="862674">:=</span>&nbsp;<span class="builtinfunc" id="862677">make</span><span class="op" id="862681">(</span><span class="keyword" id="862682">chan</span>&nbsp;<span class="ident" id="862687">Empty</span><span class="op" id="862692">,</span>&nbsp;<span class="ident" id="862694">runtime</span><span class="op" id="862701">.</span><span class="ident" id="862702">GOMAXPROCS</span><span class="op" id="862712">(</span><span class="num" id="862713">0</span><span class="op" id="862714">)</span><span class="op" id="862715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862718">b</span><span class="op" id="862719">.</span><span class="ident" id="862720">RunParallel</span><span class="op" id="862731">(</span><span class="keyword" id="862732">func</span><span class="op" id="862736">(</span><span class="ident" id="862737">pb</span>&nbsp;<span class="op" id="862740">*</span><span class="ident" id="862741">testing</span><span class="op" id="862748">.</span><span class="ident" id="862749">PB</span><span class="op" id="862751">)</span>&nbsp;<span class="op" id="862753">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="862757">for</span>&nbsp;<span class="ident" id="862761">pb</span><span class="op" id="862763">.</span><span class="ident" id="862764">Next</span><span class="op" id="862768">(</span><span class="op" id="862769">)</span>&nbsp;<span class="op" id="862771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="862776">myc</span>&nbsp;<span class="op" id="862780">&lt;-</span>&nbsp;<span class="ident" id="862783">Empty</span><span class="op" id="862788">{</span><span class="op" id="862789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862794">&lt;-</span><span class="ident" id="862796">myc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="862805">}</span><span class="op" id="862806">)</span><br>
<span class="lineno">820</span><span class="op" id="862808">}</span>
</div>
</body>
</html>
