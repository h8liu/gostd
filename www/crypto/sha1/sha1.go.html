<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3988567">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3988622">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3988676">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3988727">//&nbsp;Package&nbsp;sha1&nbsp;implements&nbsp;the&nbsp;SHA1&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;3174.</span><br>
<span class="lineno"></span><span class="keyword" id="3988802">package</span>&nbsp;<span class="ident" id="3988810">sha1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3988816">import</span>&nbsp;<span class="op" id="3988823">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3988826">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3988836">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3988843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3988846">func</span>&nbsp;<span class="ident" id="3988851">init</span><span class="op" id="3988855">(</span><span class="op" id="3988856">)</span>&nbsp;<span class="op" id="3988858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3988861"><a href="/crypto/sha1/sha1.go.html#3988826">crypto</a></span><span class="op" id="3988867">.</span><span class="ident" id="3988868">RegisterHash</span><span class="op" id="3988880">(</span><span class="ident" id="3988881"><a href="/crypto/sha1/sha1.go.html#3988826">crypto</a></span><span class="op" id="3988887">.</span><span class="ident" id="3988888">SHA1</span><span class="op" id="3988892">,</span>&nbsp;<span class="ident" id="3988894"><a href="/crypto/sha1/sha1.go.html#3989472">New</a></span><span class="op" id="3988897">)</span><br>
<span class="lineno">15</span><span class="op" id="3988899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3988902">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA1&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3988943">const</span>&nbsp;<span class="ident" id="3988949">Size</span>&nbsp;<span class="op" id="3988954">=</span>&nbsp;<span class="num" id="3988956">20</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3988960">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA1&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3988995">const</span>&nbsp;<span class="ident" id="3989001">BlockSize</span>&nbsp;<span class="op" id="3989011">=</span>&nbsp;<span class="num" id="3989013">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3989017">const</span>&nbsp;<span class="op" id="3989023">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989026">chunk</span>&nbsp;<span class="op" id="3989032">=</span>&nbsp;<span class="num" id="3989034">64</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989038">init0</span>&nbsp;<span class="op" id="3989044">=</span>&nbsp;<span class="num" id="3989046">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989058">init1</span>&nbsp;<span class="op" id="3989064">=</span>&nbsp;<span class="num" id="3989066">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989078">init2</span>&nbsp;<span class="op" id="3989084">=</span>&nbsp;<span class="num" id="3989086">0x98BADCFE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989098">init3</span>&nbsp;<span class="op" id="3989104">=</span>&nbsp;<span class="num" id="3989106">0x10325476</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989118">init4</span>&nbsp;<span class="op" id="3989124">=</span>&nbsp;<span class="num" id="3989126">0xC3D2E1F0</span><br>
<span class="lineno">30</span><span class="op" id="3989137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3989140">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3989199">type</span>&nbsp;<span class="ident" id="3989204">digest</span>&nbsp;<span class="keyword" id="3989211">struct</span>&nbsp;<span class="op" id="3989218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989221">h</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3989225">[</span><span class="num" id="3989226">5</span><span class="op" id="3989227">]</span><span class="builtintype" id="3989228">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989236">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3989240">[</span><span class="ident" id="3989241"><a href="/crypto/sha1/sha1.go.html#3989026">chunk</a></span><span class="op" id="3989246">]</span><span class="builtintype" id="3989247">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989253">nx</span>&nbsp;&nbsp;<span class="builtintype" id="3989257">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3989262">len</span>&nbsp;<span class="ident" id="3989266">uint64</span><br>
<span class="lineno"></span><span class="op" id="3989273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3989276">func</span>&nbsp;<span class="op" id="3989281">(</span><span class="ident" id="3989282">d</span>&nbsp;<span class="op" id="3989284">*</span><span class="ident" id="3989285"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3989291">)</span>&nbsp;<span class="ident" id="3989293">Reset</span><span class="op" id="3989298">(</span><span class="op" id="3989299">)</span>&nbsp;<span class="op" id="3989301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989304"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989305">.</span><span class="ident" id="3989306">h</span><span class="op" id="3989307">[</span><span class="num" id="3989308">0</span><span class="op" id="3989309">]</span>&nbsp;<span class="op" id="3989311">=</span>&nbsp;<span class="ident" id="3989313"><a href="/crypto/sha1/sha1.go.html#3989038">init0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989320"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989321">.</span><span class="ident" id="3989322">h</span><span class="op" id="3989323">[</span><span class="num" id="3989324">1</span><span class="op" id="3989325">]</span>&nbsp;<span class="op" id="3989327">=</span>&nbsp;<span class="ident" id="3989329"><a href="/crypto/sha1/sha1.go.html#3989058">init1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989336"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989337">.</span><span class="ident" id="3989338">h</span><span class="op" id="3989339">[</span><span class="num" id="3989340">2</span><span class="op" id="3989341">]</span>&nbsp;<span class="op" id="3989343">=</span>&nbsp;<span class="ident" id="3989345"><a href="/crypto/sha1/sha1.go.html#3989078">init2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989352"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989353">.</span><span class="ident" id="3989354">h</span><span class="op" id="3989355">[</span><span class="num" id="3989356">3</span><span class="op" id="3989357">]</span>&nbsp;<span class="op" id="3989359">=</span>&nbsp;<span class="ident" id="3989361"><a href="/crypto/sha1/sha1.go.html#3989098">init3</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989368"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989369">.</span><span class="ident" id="3989370">h</span><span class="op" id="3989371">[</span><span class="num" id="3989372">4</span><span class="op" id="3989373">]</span>&nbsp;<span class="op" id="3989375">=</span>&nbsp;<span class="ident" id="3989377"><a href="/crypto/sha1/sha1.go.html#3989118">init4</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989384"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989385">.</span><span class="ident" id="3989386">nx</span>&nbsp;<span class="op" id="3989389">=</span>&nbsp;<span class="num" id="3989391">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989394"><a href="/crypto/sha1/sha1.go.html#3989282">d</a></span><span class="op" id="3989395">.</span><span class="builtinfunc" id="3989396">len</span>&nbsp;<span class="op" id="3989400">=</span>&nbsp;<span class="num" id="3989402">0</span><br>
<span class="lineno"></span><span class="op" id="3989404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3989407">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA1&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3989467">func</span>&nbsp;<span class="ident" id="3989472">New</span><span class="op" id="3989475">(</span><span class="op" id="3989476">)</span>&nbsp;<span class="ident" id="3989478"><a href="/crypto/sha1/sha1.go.html#3988836">hash</a></span><span class="op" id="3989482">.</span><span class="ident" id="3989483">Hash</span>&nbsp;<span class="op" id="3989488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989491">d</span>&nbsp;<span class="op" id="3989493">:=</span>&nbsp;<span class="builtinfunc" id="3989496">new</span><span class="op" id="3989499">(</span><span class="ident" id="3989500"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3989506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989509"><a href="/crypto/sha1/sha1.go.html#3989491">d</a></span><span class="op" id="3989510">.</span><span class="ident" id="3989511">Reset</span><span class="op" id="3989516">(</span><span class="op" id="3989517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989520">return</span>&nbsp;<span class="ident" id="3989527"><a href="/crypto/sha1/sha1.go.html#3989491">d</a></span><br>
<span class="lineno">55</span><span class="op" id="3989529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3989532">func</span>&nbsp;<span class="op" id="3989537">(</span><span class="ident" id="3989538">d</span>&nbsp;<span class="op" id="3989540">*</span><span class="ident" id="3989541"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3989547">)</span>&nbsp;<span class="ident" id="3989549">Size</span><span class="op" id="3989553">(</span><span class="op" id="3989554">)</span>&nbsp;<span class="builtintype" id="3989556">int</span>&nbsp;<span class="op" id="3989560">{</span>&nbsp;<span class="keyword" id="3989562">return</span>&nbsp;<span class="ident" id="3989569"><a href="/crypto/sha1/sha1.go.html#3988949">Size</a></span>&nbsp;<span class="op" id="3989574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3989577">func</span>&nbsp;<span class="op" id="3989582">(</span><span class="ident" id="3989583">d</span>&nbsp;<span class="op" id="3989585">*</span><span class="ident" id="3989586"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3989592">)</span>&nbsp;<span class="ident" id="3989594">BlockSize</span><span class="op" id="3989603">(</span><span class="op" id="3989604">)</span>&nbsp;<span class="builtintype" id="3989606">int</span>&nbsp;<span class="op" id="3989610">{</span>&nbsp;<span class="keyword" id="3989612">return</span>&nbsp;<span class="ident" id="3989619"><a href="/crypto/sha1/sha1.go.html#3989001">BlockSize</a></span>&nbsp;<span class="op" id="3989629">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3989632">func</span>&nbsp;<span class="op" id="3989637">(</span><span class="ident" id="3989638">d</span>&nbsp;<span class="op" id="3989640">*</span><span class="ident" id="3989641"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3989647">)</span>&nbsp;<span class="ident" id="3989649">Write</span><span class="op" id="3989654">(</span><span class="ident" id="3989655">p</span>&nbsp;<span class="op" id="3989657">[</span><span class="op" id="3989658">]</span><span class="builtintype" id="3989659">byte</span><span class="op" id="3989663">)</span>&nbsp;<span class="op" id="3989665">(</span><span class="ident" id="3989666">nn</span>&nbsp;<span class="builtintype" id="3989669">int</span><span class="op" id="3989672">,</span>&nbsp;<span class="ident" id="3989674">err</span>&nbsp;<span class="builtintype" id="3989678">error</span><span class="op" id="3989683">)</span>&nbsp;<span class="op" id="3989685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989688"><a href="/crypto/sha1/sha1.go.html#3989666">nn</a></span>&nbsp;<span class="op" id="3989691">=</span>&nbsp;<span class="builtinfunc" id="3989693">len</span><span class="op" id="3989696">(</span><span class="ident" id="3989697"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989701"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989702">.</span><span class="builtinfunc" id="3989703">len</span>&nbsp;<span class="op" id="3989707">+=</span>&nbsp;<span class="ident" id="3989710">uint64</span><span class="op" id="3989716">(</span><span class="ident" id="3989717"><a href="/crypto/sha1/sha1.go.html#3989666">nn</a></span><span class="op" id="3989719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989722">if</span>&nbsp;<span class="ident" id="3989725"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989726">.</span><span class="ident" id="3989727">nx</span>&nbsp;<span class="op" id="3989730">&gt;</span>&nbsp;<span class="num" id="3989732">0</span>&nbsp;<span class="op" id="3989734">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989738">n</span>&nbsp;<span class="op" id="3989740">:=</span>&nbsp;<span class="builtinfunc" id="3989743">copy</span><span class="op" id="3989747">(</span><span class="ident" id="3989748"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989749">.</span><span class="ident" id="3989750">x</span><span class="op" id="3989751">[</span><span class="ident" id="3989752"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989753">.</span><span class="ident" id="3989754">nx</span><span class="op" id="3989756">:</span><span class="op" id="3989757">]</span><span class="op" id="3989758">,</span>&nbsp;<span class="ident" id="3989760"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989765"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989766">.</span><span class="ident" id="3989767">nx</span>&nbsp;<span class="op" id="3989770">+=</span>&nbsp;<span class="ident" id="3989773"><a href="/crypto/sha1/sha1.go.html#3989738">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989777">if</span>&nbsp;<span class="ident" id="3989780"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989781">.</span><span class="ident" id="3989782">nx</span>&nbsp;<span class="op" id="3989785">==</span>&nbsp;<span class="ident" id="3989788"><a href="/crypto/sha1/sha1.go.html#3989026">chunk</a></span>&nbsp;<span class="op" id="3989794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989799"><a href="/crypto/sha1/sha1block_decl.go.html#3993483">block</a></span><span class="op" id="3989804">(</span><span class="ident" id="3989805"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989806">,</span>&nbsp;<span class="ident" id="3989808"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989809">.</span><span class="ident" id="3989810">x</span><span class="op" id="3989811">[</span><span class="op" id="3989812">:</span><span class="op" id="3989813">]</span><span class="op" id="3989814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989819"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989820">.</span><span class="ident" id="3989821">nx</span>&nbsp;<span class="op" id="3989824">=</span>&nbsp;<span class="num" id="3989826">0</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989834"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span>&nbsp;<span class="op" id="3989836">=</span>&nbsp;<span class="ident" id="3989838"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989839">[</span><span class="ident" id="3989840"><a href="/crypto/sha1/sha1.go.html#3989738">n</a></span><span class="op" id="3989841">:</span><span class="op" id="3989842">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989848">if</span>&nbsp;<span class="builtinfunc" id="3989851">len</span><span class="op" id="3989854">(</span><span class="ident" id="3989855"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989856">)</span>&nbsp;<span class="op" id="3989858">&gt;=</span>&nbsp;<span class="ident" id="3989861"><a href="/crypto/sha1/sha1.go.html#3989026">chunk</a></span>&nbsp;<span class="op" id="3989867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989871">n</span>&nbsp;<span class="op" id="3989873">:=</span>&nbsp;<span class="builtinfunc" id="3989876">len</span><span class="op" id="3989879">(</span><span class="ident" id="3989880"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989881">)</span>&nbsp;<span class="op" id="3989883">&amp;^</span>&nbsp;<span class="op" id="3989886">(</span><span class="ident" id="3989887"><a href="/crypto/sha1/sha1.go.html#3989026">chunk</a></span>&nbsp;<span class="op" id="3989893">-</span>&nbsp;<span class="num" id="3989895">1</span><span class="op" id="3989896">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989900"><a href="/crypto/sha1/sha1block_decl.go.html#3993483">block</a></span><span class="op" id="3989905">(</span><span class="ident" id="3989906"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989907">,</span>&nbsp;<span class="ident" id="3989909"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989910">[</span><span class="op" id="3989911">:</span><span class="ident" id="3989912"><a href="/crypto/sha1/sha1.go.html#3989871">n</a></span><span class="op" id="3989913">]</span><span class="op" id="3989914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989918"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span>&nbsp;<span class="op" id="3989920">=</span>&nbsp;<span class="ident" id="3989922"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989923">[</span><span class="ident" id="3989924"><a href="/crypto/sha1/sha1.go.html#3989871">n</a></span><span class="op" id="3989925">:</span><span class="op" id="3989926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989932">if</span>&nbsp;<span class="builtinfunc" id="3989935">len</span><span class="op" id="3989938">(</span><span class="ident" id="3989939"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989940">)</span>&nbsp;<span class="op" id="3989942">&gt;</span>&nbsp;<span class="num" id="3989944">0</span>&nbsp;<span class="op" id="3989946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3989950"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989951">.</span><span class="ident" id="3989952">nx</span>&nbsp;<span class="op" id="3989955">=</span>&nbsp;<span class="builtinfunc" id="3989957">copy</span><span class="op" id="3989961">(</span><span class="ident" id="3989962"><a href="/crypto/sha1/sha1.go.html#3989638">d</a></span><span class="op" id="3989963">.</span><span class="ident" id="3989964">x</span><span class="op" id="3989965">[</span><span class="op" id="3989966">:</span><span class="op" id="3989967">]</span><span class="op" id="3989968">,</span>&nbsp;<span class="ident" id="3989970"><a href="/crypto/sha1/sha1.go.html#3989655">p</a></span><span class="op" id="3989971">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3989974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3989977">return</span><br>
<span class="lineno"></span><span class="op" id="3989984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3989987">func</span>&nbsp;<span class="op" id="3989992">(</span><span class="ident" id="3989993">d0</span>&nbsp;<span class="op" id="3989996">*</span><span class="ident" id="3989997"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3990003">)</span>&nbsp;<span class="ident" id="3990005">Sum</span><span class="op" id="3990008">(</span><span class="ident" id="3990009">in</span>&nbsp;<span class="op" id="3990012">[</span><span class="op" id="3990013">]</span><span class="builtintype" id="3990014">byte</span><span class="op" id="3990018">)</span>&nbsp;<span class="op" id="3990020">[</span><span class="op" id="3990021">]</span><span class="builtintype" id="3990022">byte</span>&nbsp;<span class="op" id="3990027">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3990030">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990097">d</span>&nbsp;<span class="op" id="3990099">:=</span>&nbsp;<span class="op" id="3990102">*</span><span class="ident" id="3990103"><a href="/crypto/sha1/sha1.go.html#3989993">d0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990107">hash</span>&nbsp;<span class="op" id="3990112">:=</span>&nbsp;<span class="ident" id="3990115"><a href="/crypto/sha1/sha1.go.html#3990097">d</a></span><span class="op" id="3990116">.</span><span class="ident" id="3990117">checkSum</span><span class="op" id="3990125">(</span><span class="op" id="3990126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990129">return</span>&nbsp;<span class="builtinfunc" id="3990136">append</span><span class="op" id="3990142">(</span><span class="ident" id="3990143"><a href="/crypto/sha1/sha1.go.html#3990009">in</a></span><span class="op" id="3990145">,</span>&nbsp;<span class="ident" id="3990147"><a href="/crypto/sha1/sha1.go.html#3990107">hash</a></span><span class="op" id="3990151">[</span><span class="op" id="3990152">:</span><span class="op" id="3990153">]</span><span class="op" id="3990154">...</span><span class="op" id="3990157">)</span><br>
<span class="lineno"></span><span class="op" id="3990159">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="3990162">func</span>&nbsp;<span class="op" id="3990167">(</span><span class="ident" id="3990168">d</span>&nbsp;<span class="op" id="3990170">*</span><span class="ident" id="3990171"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><span class="op" id="3990177">)</span>&nbsp;<span class="ident" id="3990179">checkSum</span><span class="op" id="3990187">(</span><span class="op" id="3990188">)</span>&nbsp;<span class="op" id="3990190">[</span><span class="ident" id="3990191"><a href="/crypto/sha1/sha1.go.html#3988949">Size</a></span><span class="op" id="3990195">]</span><span class="builtintype" id="3990196">byte</span>&nbsp;<span class="op" id="3990201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3990204">len</span>&nbsp;<span class="op" id="3990208">:=</span>&nbsp;<span class="ident" id="3990211"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990212">.</span><span class="builtinfunc" id="3990213">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3990218">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990278">var</span>&nbsp;<span class="ident" id="3990282">tmp</span>&nbsp;<span class="op" id="3990286">[</span><span class="num" id="3990287">64</span><span class="op" id="3990289">]</span><span class="builtintype" id="3990290">byte</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990296"><a href="/crypto/sha1/sha1.go.html#3990282">tmp</a></span><span class="op" id="3990299">[</span><span class="num" id="3990300">0</span><span class="op" id="3990301">]</span>&nbsp;<span class="op" id="3990303">=</span>&nbsp;<span class="num" id="3990305">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990311">if</span>&nbsp;<span class="builtinfunc" id="3990314"><a href="/crypto/sha1/sha1.go.html#3990204">len</a></span><span class="op" id="3990317">%</span><span class="num" id="3990318">64</span>&nbsp;<span class="op" id="3990321">&lt;</span>&nbsp;<span class="num" id="3990323">56</span>&nbsp;<span class="op" id="3990326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990330"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990331">.</span><span class="ident" id="3990332">Write</span><span class="op" id="3990337">(</span><span class="ident" id="3990338"><a href="/crypto/sha1/sha1.go.html#3990282">tmp</a></span><span class="op" id="3990341">[</span><span class="num" id="3990342">0</span>&nbsp;<span class="op" id="3990344">:</span>&nbsp;<span class="num" id="3990346">56</span><span class="op" id="3990348">-</span><span class="builtinfunc" id="3990349"><a href="/crypto/sha1/sha1.go.html#3990204">len</a></span><span class="op" id="3990352">%</span><span class="num" id="3990353">64</span><span class="op" id="3990355">]</span><span class="op" id="3990356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990359">}</span>&nbsp;<span class="keyword" id="3990361">else</span>&nbsp;<span class="op" id="3990366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990370"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990371">.</span><span class="ident" id="3990372">Write</span><span class="op" id="3990377">(</span><span class="ident" id="3990378"><a href="/crypto/sha1/sha1.go.html#3990282">tmp</a></span><span class="op" id="3990381">[</span><span class="num" id="3990382">0</span>&nbsp;<span class="op" id="3990384">:</span>&nbsp;<span class="num" id="3990386">64</span><span class="op" id="3990388">+</span><span class="num" id="3990389">56</span><span class="op" id="3990391">-</span><span class="builtinfunc" id="3990392"><a href="/crypto/sha1/sha1.go.html#3990204">len</a></span><span class="op" id="3990395">%</span><span class="num" id="3990396">64</span><span class="op" id="3990398">]</span><span class="op" id="3990399">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3990406">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3990426"><a href="/crypto/sha1/sha1.go.html#3990204">len</a></span>&nbsp;<span class="op" id="3990430">&lt;&lt;=</span>&nbsp;<span class="num" id="3990434">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990437">for</span>&nbsp;<span class="ident" id="3990441">i</span>&nbsp;<span class="op" id="3990443">:=</span>&nbsp;<span class="builtintype" id="3990446">uint</span><span class="op" id="3990450">(</span><span class="num" id="3990451">0</span><span class="op" id="3990452">)</span><span class="op" id="3990453">;</span>&nbsp;<span class="ident" id="3990455"><a href="/crypto/sha1/sha1.go.html#3990441">i</a></span>&nbsp;<span class="op" id="3990457">&lt;</span>&nbsp;<span class="num" id="3990459">8</span><span class="op" id="3990460">;</span>&nbsp;<span class="ident" id="3990462"><a href="/crypto/sha1/sha1.go.html#3990441">i</a></span><span class="op" id="3990463">++</span>&nbsp;<span class="op" id="3990466">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990470"><a href="/crypto/sha1/sha1.go.html#3990282">tmp</a></span><span class="op" id="3990473">[</span><span class="ident" id="3990474"><a href="/crypto/sha1/sha1.go.html#3990441">i</a></span><span class="op" id="3990475">]</span>&nbsp;<span class="op" id="3990477">=</span>&nbsp;<span class="builtintype" id="3990479">byte</span><span class="op" id="3990483">(</span><span class="builtinfunc" id="3990484"><a href="/crypto/sha1/sha1.go.html#3990204">len</a></span>&nbsp;<span class="op" id="3990488">&gt;&gt;</span>&nbsp;<span class="op" id="3990491">(</span><span class="num" id="3990492">56</span>&nbsp;<span class="op" id="3990495">-</span>&nbsp;<span class="num" id="3990497">8</span><span class="op" id="3990498">*</span><span class="ident" id="3990499"><a href="/crypto/sha1/sha1.go.html#3990441">i</a></span><span class="op" id="3990500">)</span><span class="op" id="3990501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990507"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990508">.</span><span class="ident" id="3990509">Write</span><span class="op" id="3990514">(</span><span class="ident" id="3990515"><a href="/crypto/sha1/sha1.go.html#3990282">tmp</a></span><span class="op" id="3990518">[</span><span class="num" id="3990519">0</span><span class="op" id="3990520">:</span><span class="num" id="3990521">8</span><span class="op" id="3990522">]</span><span class="op" id="3990523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990527">if</span>&nbsp;<span class="ident" id="3990530"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990531">.</span><span class="ident" id="3990532">nx</span>&nbsp;<span class="op" id="3990535">!=</span>&nbsp;<span class="num" id="3990538">0</span>&nbsp;<span class="op" id="3990540">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3990544">panic</span><span class="op" id="3990549">(</span><span class="string" id="3990550">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="3990561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990568">var</span>&nbsp;<span class="ident" id="3990572">digest</span>&nbsp;<span class="op" id="3990579">[</span><span class="ident" id="3990580"><a href="/crypto/sha1/sha1.go.html#3988949">Size</a></span><span class="op" id="3990584">]</span><span class="builtintype" id="3990585">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990591">for</span>&nbsp;<span class="ident" id="3990595">i</span><span class="op" id="3990596">,</span>&nbsp;<span class="ident" id="3990598">s</span>&nbsp;<span class="op" id="3990600">:=</span>&nbsp;<span class="keyword" id="3990603">range</span>&nbsp;<span class="ident" id="3990609"><a href="/crypto/sha1/sha1.go.html#3990168">d</a></span><span class="op" id="3990610">.</span><span class="ident" id="3990611">h</span>&nbsp;<span class="op" id="3990613">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990617"><a href="/crypto/sha1/sha1.go.html#3990572">digest</a></span><span class="op" id="3990623">[</span><span class="ident" id="3990624"><a href="/crypto/sha1/sha1.go.html#3990595">i</a></span><span class="op" id="3990625">*</span><span class="num" id="3990626">4</span><span class="op" id="3990627">]</span>&nbsp;<span class="op" id="3990629">=</span>&nbsp;<span class="builtintype" id="3990631">byte</span><span class="op" id="3990635">(</span><span class="ident" id="3990636"><a href="/crypto/sha1/sha1.go.html#3990598">s</a></span>&nbsp;<span class="op" id="3990638">&gt;&gt;</span>&nbsp;<span class="num" id="3990641">24</span><span class="op" id="3990643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990647"><a href="/crypto/sha1/sha1.go.html#3990572">digest</a></span><span class="op" id="3990653">[</span><span class="ident" id="3990654"><a href="/crypto/sha1/sha1.go.html#3990595">i</a></span><span class="op" id="3990655">*</span><span class="num" id="3990656">4</span><span class="op" id="3990657">+</span><span class="num" id="3990658">1</span><span class="op" id="3990659">]</span>&nbsp;<span class="op" id="3990661">=</span>&nbsp;<span class="builtintype" id="3990663">byte</span><span class="op" id="3990667">(</span><span class="ident" id="3990668"><a href="/crypto/sha1/sha1.go.html#3990598">s</a></span>&nbsp;<span class="op" id="3990670">&gt;&gt;</span>&nbsp;<span class="num" id="3990673">16</span><span class="op" id="3990675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990679"><a href="/crypto/sha1/sha1.go.html#3990572">digest</a></span><span class="op" id="3990685">[</span><span class="ident" id="3990686"><a href="/crypto/sha1/sha1.go.html#3990595">i</a></span><span class="op" id="3990687">*</span><span class="num" id="3990688">4</span><span class="op" id="3990689">+</span><span class="num" id="3990690">2</span><span class="op" id="3990691">]</span>&nbsp;<span class="op" id="3990693">=</span>&nbsp;<span class="builtintype" id="3990695">byte</span><span class="op" id="3990699">(</span><span class="ident" id="3990700"><a href="/crypto/sha1/sha1.go.html#3990598">s</a></span>&nbsp;<span class="op" id="3990702">&gt;&gt;</span>&nbsp;<span class="num" id="3990705">8</span><span class="op" id="3990706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990710"><a href="/crypto/sha1/sha1.go.html#3990572">digest</a></span><span class="op" id="3990716">[</span><span class="ident" id="3990717"><a href="/crypto/sha1/sha1.go.html#3990595">i</a></span><span class="op" id="3990718">*</span><span class="num" id="3990719">4</span><span class="op" id="3990720">+</span><span class="num" id="3990721">3</span><span class="op" id="3990722">]</span>&nbsp;<span class="op" id="3990724">=</span>&nbsp;<span class="builtintype" id="3990726">byte</span><span class="op" id="3990730">(</span><span class="ident" id="3990731"><a href="/crypto/sha1/sha1.go.html#3990598">s</a></span><span class="op" id="3990732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3990735">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990739">return</span>&nbsp;<span class="ident" id="3990746"><a href="/crypto/sha1/sha1.go.html#3990572">digest</a></span><br>
<span class="lineno"></span><span class="op" id="3990753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3990756">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;SHA1&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">125</span><span class="keyword" id="3990802">func</span>&nbsp;<span class="ident" id="3990807">Sum</span><span class="op" id="3990810">(</span><span class="ident" id="3990811">data</span>&nbsp;<span class="op" id="3990816">[</span><span class="op" id="3990817">]</span><span class="builtintype" id="3990818">byte</span><span class="op" id="3990822">)</span>&nbsp;<span class="op" id="3990824">[</span><span class="ident" id="3990825"><a href="/crypto/sha1/sha1.go.html#3988949">Size</a></span><span class="op" id="3990829">]</span><span class="builtintype" id="3990830">byte</span>&nbsp;<span class="op" id="3990835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990838">var</span>&nbsp;<span class="ident" id="3990842">d</span>&nbsp;<span class="ident" id="3990844"><a href="/crypto/sha1/sha1.go.html#3989204">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990852"><a href="/crypto/sha1/sha1.go.html#3990842">d</a></span><span class="op" id="3990853">.</span><span class="ident" id="3990854">Reset</span><span class="op" id="3990859">(</span><span class="op" id="3990860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3990863"><a href="/crypto/sha1/sha1.go.html#3990842">d</a></span><span class="op" id="3990864">.</span><span class="ident" id="3990865">Write</span><span class="op" id="3990870">(</span><span class="ident" id="3990871"><a href="/crypto/sha1/sha1.go.html#3990811">data</a></span><span class="op" id="3990875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3990878">return</span>&nbsp;<span class="ident" id="3990885"><a href="/crypto/sha1/sha1.go.html#3990842">d</a></span><span class="op" id="3990886">.</span><span class="ident" id="3990887">checkSum</span><span class="op" id="3990895">(</span><span class="op" id="3990896">)</span><br>
<span class="lineno">130</span><span class="op" id="3990898">}</span>
</div>
</body>
</html>
