<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5125477">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5125532">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5125586">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5125637">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5125713">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="5125788">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5125860">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="5125936">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="5126012">//</span><br>
<span class="lineno"></span><span class="comment" id="5126015">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5126093">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5126161">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="5126237">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="5126289">//</span><br>
<span class="lineno"></span><span class="comment" id="5126292">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="5126316">//</span><br>
<span class="lineno"></span><span class="comment" id="5126319">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="5126344">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="5126359">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5126378">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5126406">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="5126435">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5126454">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="5126459">//</span><br>
<span class="lineno"></span><span class="keyword" id="5126462">package</span>&nbsp;<span class="ident" id="5126470">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5126479">import</span>&nbsp;<span class="op" id="5126486">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126489">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126498">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126505">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126511">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126517">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126528">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="5126543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5126546">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5126603">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="5126639">type</span>&nbsp;<span class="ident" id="5126644">Position</span>&nbsp;<span class="keyword" id="5126653">struct</span>&nbsp;<span class="op" id="5126660">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126663">Filename</span>&nbsp;<span class="builtintype" id="5126672">string</span>&nbsp;<span class="comment" id="5126679">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126700">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5126709">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126716">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126747">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5126756">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126763">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126794">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5126803">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126810">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="5126869">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5126872">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="5126922">func</span>&nbsp;<span class="op" id="5126927">(</span><span class="ident" id="5126928">pos</span>&nbsp;<span class="op" id="5126932">*</span><span class="ident" id="5126933">Position</span><span class="op" id="5126941">)</span>&nbsp;<span class="ident" id="5126943">IsValid</span><span class="op" id="5126950">(</span><span class="op" id="5126951">)</span>&nbsp;<span class="builtintype" id="5126953">bool</span>&nbsp;<span class="op" id="5126958">{</span>&nbsp;<span class="keyword" id="5126960">return</span>&nbsp;<span class="ident" id="5126967">pos</span><span class="op" id="5126970">.</span><span class="ident" id="5126971">Line</span>&nbsp;<span class="op" id="5126976">&gt;</span>&nbsp;<span class="num" id="5126978">0</span>&nbsp;<span class="op" id="5126980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5126983">func</span>&nbsp;<span class="op" id="5126988">(</span><span class="ident" id="5126989">pos</span>&nbsp;<span class="ident" id="5126993">Position</span><span class="op" id="5127001">)</span>&nbsp;<span class="ident" id="5127003">String</span><span class="op" id="5127009">(</span><span class="op" id="5127010">)</span>&nbsp;<span class="builtintype" id="5127012">string</span>&nbsp;<span class="op" id="5127019">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127022">s</span>&nbsp;<span class="op" id="5127024">:=</span>&nbsp;<span class="ident" id="5127027">pos</span><span class="op" id="5127030">.</span><span class="ident" id="5127031">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127041">if</span>&nbsp;<span class="ident" id="5127044">pos</span><span class="op" id="5127047">.</span><span class="ident" id="5127048">IsValid</span><span class="op" id="5127055">(</span><span class="op" id="5127056">)</span>&nbsp;<span class="op" id="5127058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127062">if</span>&nbsp;<span class="ident" id="5127065">s</span>&nbsp;<span class="op" id="5127067">!=</span>&nbsp;<span class="string" id="5127070">&#34;&#34;</span>&nbsp;<span class="op" id="5127073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127078">s</span>&nbsp;<span class="op" id="5127080">+=</span>&nbsp;<span class="string" id="5127083">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127089">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127093">s</span>&nbsp;<span class="op" id="5127095">+=</span>&nbsp;<span class="ident" id="5127098">fmt</span><span class="op" id="5127101">.</span><span class="ident" id="5127102">Sprintf</span><span class="op" id="5127109">(</span><span class="string" id="5127110">&#34;%d:%d&#34;</span><span class="op" id="5127117">,</span>&nbsp;<span class="ident" id="5127119">pos</span><span class="op" id="5127122">.</span><span class="ident" id="5127123">Line</span><span class="op" id="5127127">,</span>&nbsp;<span class="ident" id="5127129">pos</span><span class="op" id="5127132">.</span><span class="ident" id="5127133">Column</span><span class="op" id="5127139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127145">if</span>&nbsp;<span class="ident" id="5127148">s</span>&nbsp;<span class="op" id="5127150">==</span>&nbsp;<span class="string" id="5127153">&#34;&#34;</span>&nbsp;<span class="op" id="5127156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127160">s</span>&nbsp;<span class="op" id="5127162">=</span>&nbsp;<span class="string" id="5127164">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127171">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127174">return</span>&nbsp;<span class="ident" id="5127181">s</span><br>
<span class="lineno"></span><span class="op" id="5127183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5127186">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="5127258">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="5127331">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="5127397">//</span><br>
<span class="lineno"></span><span class="comment" id="5127400">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="5127440">//</span><br>
<span class="lineno"></span><span class="comment" id="5127443">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="5127516">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="5127589">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="5127663">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="5127736">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5127793">//</span><br>
<span class="lineno">75</span><span class="keyword" id="5127796">const</span>&nbsp;<span class="op" id="5127802">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127805">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127820">=</span>&nbsp;<span class="num" id="5127822">1</span>&nbsp;<span class="op" id="5127824">&lt;&lt;</span>&nbsp;<span class="op" id="5127827">-</span><span class="ident" id="5127828">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127835">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127850">=</span>&nbsp;<span class="num" id="5127852">1</span>&nbsp;<span class="op" id="5127854">&lt;&lt;</span>&nbsp;<span class="op" id="5127857">-</span><span class="ident" id="5127858">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127863">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127878">=</span>&nbsp;<span class="num" id="5127880">1</span>&nbsp;<span class="op" id="5127882">&lt;&lt;</span>&nbsp;<span class="op" id="5127885">-</span><span class="ident" id="5127886">Float</span>&nbsp;<span class="comment" id="5127892">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127910">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127925">=</span>&nbsp;<span class="num" id="5127927">1</span>&nbsp;<span class="op" id="5127929">&lt;&lt;</span>&nbsp;<span class="op" id="5127932">-</span><span class="ident" id="5127933">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127939">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127954">=</span>&nbsp;<span class="num" id="5127956">1</span>&nbsp;<span class="op" id="5127958">&lt;&lt;</span>&nbsp;<span class="op" id="5127961">-</span><span class="ident" id="5127962">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127970">ScanRawStrings</span>&nbsp;<span class="op" id="5127985">=</span>&nbsp;<span class="num" id="5127987">1</span>&nbsp;<span class="op" id="5127989">&lt;&lt;</span>&nbsp;<span class="op" id="5127992">-</span><span class="ident" id="5127993">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128004">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5128019">=</span>&nbsp;<span class="num" id="5128021">1</span>&nbsp;<span class="op" id="5128023">&lt;&lt;</span>&nbsp;<span class="op" id="5128026">-</span><span class="ident" id="5128027">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128036">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5128051">=</span>&nbsp;<span class="num" id="5128053">1</span>&nbsp;<span class="op" id="5128055">&lt;&lt;</span>&nbsp;<span class="op" id="5128058">-</span><span class="ident" id="5128059">skipComment</span>&nbsp;<span class="comment" id="5128071">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128129">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128144">=</span>&nbsp;<span class="ident" id="5128146">ScanIdents</span>&nbsp;<span class="op" id="5128157">|</span>&nbsp;<span class="ident" id="5128159">ScanFloats</span>&nbsp;<span class="op" id="5128170">|</span>&nbsp;<span class="ident" id="5128172">ScanChars</span>&nbsp;<span class="op" id="5128182">|</span>&nbsp;<span class="ident" id="5128184">ScanStrings</span>&nbsp;<span class="op" id="5128196">|</span>&nbsp;<span class="ident" id="5128198">ScanRawStrings</span>&nbsp;<span class="op" id="5128213">|</span>&nbsp;<span class="ident" id="5128215">ScanComments</span>&nbsp;<span class="op" id="5128228">|</span>&nbsp;<span class="ident" id="5128230">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="5128243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128246">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5128323">const</span>&nbsp;<span class="op" id="5128329">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128332">EOF</span>&nbsp;<span class="op" id="5128336">=</span>&nbsp;<span class="op" id="5128338">-</span><span class="op" id="5128339">(</span><span class="ident" id="5128340">iota</span>&nbsp;<span class="op" id="5128345">+</span>&nbsp;<span class="num" id="5128347">1</span><span class="op" id="5128348">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128351">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128358">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128363">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128370">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128376">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128384">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128395">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128404">skipComment</span><br>
<span class="lineno"></span><span class="op" id="5128416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5128419">var</span>&nbsp;<span class="ident" id="5128423">tokenString</span>&nbsp;<span class="op" id="5128435">=</span>&nbsp;<span class="keyword" id="5128437">map</span><span class="op" id="5128440">[</span><span class="builtintype" id="5128441">rune</span><span class="op" id="5128445">]</span><span class="builtintype" id="5128446">string</span><span class="op" id="5128452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128455">EOF</span><span class="op" id="5128458">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128466">&#34;EOF&#34;</span><span class="op" id="5128471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128474">Ident</span><span class="op" id="5128479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128485">&#34;Ident&#34;</span><span class="op" id="5128492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128495">Int</span><span class="op" id="5128498">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128506">&#34;Int&#34;</span><span class="op" id="5128511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128514">Float</span><span class="op" id="5128519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128525">&#34;Float&#34;</span><span class="op" id="5128532">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128535">Char</span><span class="op" id="5128539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128546">&#34;Char&#34;</span><span class="op" id="5128552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128555">String</span><span class="op" id="5128561">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128566">&#34;String&#34;</span><span class="op" id="5128574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128577">RawString</span><span class="op" id="5128586">:</span>&nbsp;<span class="string" id="5128588">&#34;RawString&#34;</span><span class="op" id="5128599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128602">Comment</span><span class="op" id="5128609">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5128613">&#34;Comment&#34;</span><span class="op" id="5128622">,</span><br>
<span class="lineno"></span><span class="op" id="5128624">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5128627">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5128703">func</span>&nbsp;<span class="ident" id="5128708">TokenString</span><span class="op" id="5128719">(</span><span class="ident" id="5128720">tok</span>&nbsp;<span class="builtintype" id="5128724">rune</span><span class="op" id="5128728">)</span>&nbsp;<span class="builtintype" id="5128730">string</span>&nbsp;<span class="op" id="5128737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128740">if</span>&nbsp;<span class="ident" id="5128743">s</span><span class="op" id="5128744">,</span>&nbsp;<span class="ident" id="5128746">found</span>&nbsp;<span class="op" id="5128752">:=</span>&nbsp;<span class="ident" id="5128755">tokenString</span><span class="op" id="5128766">[</span><span class="ident" id="5128767">tok</span><span class="op" id="5128770">]</span><span class="op" id="5128771">;</span>&nbsp;<span class="ident" id="5128773">found</span>&nbsp;<span class="op" id="5128779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128783">return</span>&nbsp;<span class="ident" id="5128790">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5128793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128796">return</span>&nbsp;<span class="ident" id="5128803">fmt</span><span class="op" id="5128806">.</span><span class="ident" id="5128807">Sprintf</span><span class="op" id="5128814">(</span><span class="string" id="5128815">&#34;%q&#34;</span><span class="op" id="5128819">,</span>&nbsp;<span class="builtintype" id="5128821">string</span><span class="op" id="5128827">(</span><span class="ident" id="5128828">tok</span><span class="op" id="5128831">)</span><span class="op" id="5128832">)</span><br>
<span class="lineno"></span><span class="op" id="5128834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128837">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="5128910">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="5128960">const</span>&nbsp;<span class="ident" id="5128966">GoWhitespace</span>&nbsp;<span class="op" id="5128979">=</span>&nbsp;<span class="num" id="5128981">1</span><span class="op" id="5128982">&lt;&lt;</span><span class="string" id="5128984">&#39;\t&#39;</span>&nbsp;<span class="op" id="5128989">|</span>&nbsp;<span class="num" id="5128991">1</span><span class="op" id="5128992">&lt;&lt;</span><span class="string" id="5128994">&#39;\n&#39;</span>&nbsp;<span class="op" id="5128999">|</span>&nbsp;<span class="num" id="5129001">1</span><span class="op" id="5129002">&lt;&lt;</span><span class="string" id="5129004">&#39;\r&#39;</span>&nbsp;<span class="op" id="5129009">|</span>&nbsp;<span class="num" id="5129011">1</span><span class="op" id="5129012">&lt;&lt;</span><span class="string" id="5129014">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5129019">const</span>&nbsp;<span class="ident" id="5129025">bufLen</span>&nbsp;<span class="op" id="5129032">=</span>&nbsp;<span class="num" id="5129034">1024</span>&nbsp;<span class="comment" id="5129039">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5129064">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5129148">type</span>&nbsp;<span class="ident" id="5129153">Scanner</span>&nbsp;<span class="keyword" id="5129161">struct</span>&nbsp;<span class="op" id="5129168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129171">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129181">src</span>&nbsp;<span class="ident" id="5129185">io</span><span class="op" id="5129187">.</span><span class="ident" id="5129188">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129197">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129215">srcBuf</span>&nbsp;<span class="op" id="5129222">[</span><span class="ident" id="5129223">bufLen</span>&nbsp;<span class="op" id="5129230">+</span>&nbsp;<span class="num" id="5129232">1</span><span class="op" id="5129233">]</span><span class="builtintype" id="5129234">byte</span>&nbsp;<span class="comment" id="5129239">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129287">srcPos</span>&nbsp;<span class="builtintype" id="5129294">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129311">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129347">srcEnd</span>&nbsp;<span class="builtintype" id="5129354">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129371">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129402">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129422">srcBufOffset</span>&nbsp;<span class="builtintype" id="5129435">int</span>&nbsp;<span class="comment" id="5129439">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129478">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5129491">int</span>&nbsp;<span class="comment" id="5129495">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129510">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5129523">int</span>&nbsp;<span class="comment" id="5129527">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129547">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="5129560">int</span>&nbsp;<span class="comment" id="5129564">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129633">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="5129646">int</span>&nbsp;<span class="comment" id="5129650">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129689">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129711">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129784">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129859">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129889">tokBuf</span>&nbsp;<span class="ident" id="5129896">bytes</span><span class="op" id="5129901">.</span><span class="ident" id="5129902">Buffer</span>&nbsp;<span class="comment" id="5129909">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129959">tokPos</span>&nbsp;<span class="builtintype" id="5129966">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129979">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130038">tokEnd</span>&nbsp;<span class="builtintype" id="5130045">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130058">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130098">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130127">ch</span>&nbsp;<span class="builtintype" id="5130130">rune</span>&nbsp;<span class="comment" id="5130135">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130172">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130232">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130289">Error</span>&nbsp;<span class="keyword" id="5130295">func</span><span class="op" id="5130299">(</span><span class="ident" id="5130300">s</span>&nbsp;<span class="op" id="5130302">*</span><span class="ident" id="5130303">Scanner</span><span class="op" id="5130310">,</span>&nbsp;<span class="ident" id="5130312">msg</span>&nbsp;<span class="builtintype" id="5130316">string</span><span class="op" id="5130322">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130326">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130391">ErrorCount</span>&nbsp;<span class="builtintype" id="5130402">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130408">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130479">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130549">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130574">Mode</span>&nbsp;<span class="builtintype" id="5130579">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130586">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130652">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130723">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130796">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130860">Whitespace</span>&nbsp;<span class="ident" id="5130871">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130880">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5130947">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131013">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131076">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131142">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131202">IsIdentRune</span>&nbsp;<span class="keyword" id="5131214">func</span><span class="op" id="5131218">(</span><span class="ident" id="5131219">ch</span>&nbsp;<span class="builtintype" id="5131222">rune</span><span class="op" id="5131226">,</span>&nbsp;<span class="ident" id="5131228">i</span>&nbsp;<span class="builtintype" id="5131230">int</span><span class="op" id="5131233">)</span>&nbsp;<span class="builtintype" id="5131235">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131242">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131306">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131369">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131433">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131498">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131565">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131592">Position</span><br>
<span class="lineno">185</span><span class="op" id="5131601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131604">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="5131667">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="5131740">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="5131782">func</span>&nbsp;<span class="op" id="5131787">(</span><span class="ident" id="5131788">s</span>&nbsp;<span class="op" id="5131790">*</span><span class="ident" id="5131791">Scanner</span><span class="op" id="5131798">)</span>&nbsp;<span class="ident" id="5131800">Init</span><span class="op" id="5131804">(</span><span class="ident" id="5131805">src</span>&nbsp;<span class="ident" id="5131809">io</span><span class="op" id="5131811">.</span><span class="ident" id="5131812">Reader</span><span class="op" id="5131818">)</span>&nbsp;<span class="op" id="5131820">*</span><span class="ident" id="5131821">Scanner</span>&nbsp;<span class="op" id="5131829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131832">s</span><span class="op" id="5131833">.</span><span class="ident" id="5131834">src</span>&nbsp;<span class="op" id="5131838">=</span>&nbsp;<span class="ident" id="5131840">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131846">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5131875">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131939">s</span><span class="op" id="5131940">.</span><span class="ident" id="5131941">srcBuf</span><span class="op" id="5131947">[</span><span class="num" id="5131948">0</span><span class="op" id="5131949">]</span>&nbsp;<span class="op" id="5131951">=</span>&nbsp;<span class="ident" id="5131953">utf8</span><span class="op" id="5131957">.</span><span class="ident" id="5131958">RuneSelf</span>&nbsp;<span class="comment" id="5131967">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131980">s</span><span class="op" id="5131981">.</span><span class="ident" id="5131982">srcPos</span>&nbsp;<span class="op" id="5131989">=</span>&nbsp;<span class="num" id="5131991">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131994">s</span><span class="op" id="5131995">.</span><span class="ident" id="5131996">srcEnd</span>&nbsp;<span class="op" id="5132003">=</span>&nbsp;<span class="num" id="5132005">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132009">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132040">s</span><span class="op" id="5132041">.</span><span class="ident" id="5132042">srcBufOffset</span>&nbsp;<span class="op" id="5132055">=</span>&nbsp;<span class="num" id="5132057">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132060">s</span><span class="op" id="5132061">.</span><span class="ident" id="5132062">line</span>&nbsp;<span class="op" id="5132067">=</span>&nbsp;<span class="num" id="5132069">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132072">s</span><span class="op" id="5132073">.</span><span class="ident" id="5132074">column</span>&nbsp;<span class="op" id="5132081">=</span>&nbsp;<span class="num" id="5132083">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132086">s</span><span class="op" id="5132087">.</span><span class="ident" id="5132088">lastLineLen</span>&nbsp;<span class="op" id="5132100">=</span>&nbsp;<span class="num" id="5132102">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132105">s</span><span class="op" id="5132106">.</span><span class="ident" id="5132107">lastCharLen</span>&nbsp;<span class="op" id="5132119">=</span>&nbsp;<span class="num" id="5132121">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132125">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132158">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132199">s</span><span class="op" id="5132200">.</span><span class="ident" id="5132201">tokPos</span>&nbsp;<span class="op" id="5132208">=</span>&nbsp;<span class="op" id="5132210">-</span><span class="num" id="5132211">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132215">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132255">s</span><span class="op" id="5132256">.</span><span class="ident" id="5132257">ch</span>&nbsp;<span class="op" id="5132260">=</span>&nbsp;<span class="op" id="5132262">-</span><span class="num" id="5132263">1</span>&nbsp;<span class="comment" id="5132265">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132287">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132316">s</span><span class="op" id="5132317">.</span><span class="ident" id="5132318">Error</span>&nbsp;<span class="op" id="5132324">=</span>&nbsp;<span class="ident" id="5132326">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132331">s</span><span class="op" id="5132332">.</span><span class="ident" id="5132333">ErrorCount</span>&nbsp;<span class="op" id="5132344">=</span>&nbsp;<span class="num" id="5132346">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132349">s</span><span class="op" id="5132350">.</span><span class="ident" id="5132351">Mode</span>&nbsp;<span class="op" id="5132356">=</span>&nbsp;<span class="ident" id="5132358">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132368">s</span><span class="op" id="5132369">.</span><span class="ident" id="5132370">Whitespace</span>&nbsp;<span class="op" id="5132381">=</span>&nbsp;<span class="ident" id="5132383">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132397">s</span><span class="op" id="5132398">.</span><span class="ident" id="5132399">Line</span>&nbsp;<span class="op" id="5132404">=</span>&nbsp;<span class="num" id="5132406">0</span>&nbsp;<span class="comment" id="5132408">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5132439">return</span>&nbsp;<span class="ident" id="5132446">s</span><br>
<span class="lineno"></span><span class="op" id="5132448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5132451">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5132525">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="5132600">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="5132674">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="5132701">func</span>&nbsp;<span class="op" id="5132706">(</span><span class="ident" id="5132707">s</span>&nbsp;<span class="op" id="5132709">*</span><span class="ident" id="5132710">Scanner</span><span class="op" id="5132717">)</span>&nbsp;<span class="ident" id="5132719">next</span><span class="op" id="5132723">(</span><span class="op" id="5132724">)</span>&nbsp;<span class="builtintype" id="5132726">rune</span>&nbsp;<span class="op" id="5132731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5132734">ch</span><span class="op" id="5132736">,</span>&nbsp;<span class="ident" id="5132738">width</span>&nbsp;<span class="op" id="5132744">:=</span>&nbsp;<span class="builtintype" id="5132747">rune</span><span class="op" id="5132751">(</span><span class="ident" id="5132752">s</span><span class="op" id="5132753">.</span><span class="ident" id="5132754">srcBuf</span><span class="op" id="5132760">[</span><span class="ident" id="5132761">s</span><span class="op" id="5132762">.</span><span class="ident" id="5132763">srcPos</span><span class="op" id="5132769">]</span><span class="op" id="5132770">)</span><span class="op" id="5132771">,</span>&nbsp;<span class="num" id="5132773">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5132777">if</span>&nbsp;<span class="ident" id="5132780">ch</span>&nbsp;<span class="op" id="5132783">&gt;=</span>&nbsp;<span class="ident" id="5132786">utf8</span><span class="op" id="5132790">.</span><span class="ident" id="5132791">RuneSelf</span>&nbsp;<span class="op" id="5132800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132804">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5132854">for</span>&nbsp;<span class="ident" id="5132858">s</span><span class="op" id="5132859">.</span><span class="ident" id="5132860">srcPos</span><span class="op" id="5132866">+</span><span class="ident" id="5132867">utf8</span><span class="op" id="5132871">.</span><span class="ident" id="5132872">UTFMax</span>&nbsp;<span class="op" id="5132879">&gt;</span>&nbsp;<span class="ident" id="5132881">s</span><span class="op" id="5132882">.</span><span class="ident" id="5132883">srcEnd</span>&nbsp;<span class="op" id="5132890">&amp;&amp;</span>&nbsp;<span class="op" id="5132893">!</span><span class="ident" id="5132894">utf8</span><span class="op" id="5132898">.</span><span class="ident" id="5132899">FullRune</span><span class="op" id="5132907">(</span><span class="ident" id="5132908">s</span><span class="op" id="5132909">.</span><span class="ident" id="5132910">srcBuf</span><span class="op" id="5132916">[</span><span class="ident" id="5132917">s</span><span class="op" id="5132918">.</span><span class="ident" id="5132919">srcPos</span><span class="op" id="5132925">:</span><span class="ident" id="5132926">s</span><span class="op" id="5132927">.</span><span class="ident" id="5132928">srcEnd</span><span class="op" id="5132934">]</span><span class="op" id="5132935">)</span>&nbsp;<span class="op" id="5132937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132942">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5132992">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133026">if</span>&nbsp;<span class="ident" id="5133029">s</span><span class="op" id="5133030">.</span><span class="ident" id="5133031">tokPos</span>&nbsp;<span class="op" id="5133038">&gt;=</span>&nbsp;<span class="num" id="5133041">0</span>&nbsp;<span class="op" id="5133043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133049">s</span><span class="op" id="5133050">.</span><span class="ident" id="5133051">tokBuf</span><span class="op" id="5133057">.</span><span class="ident" id="5133058">Write</span><span class="op" id="5133063">(</span><span class="ident" id="5133064">s</span><span class="op" id="5133065">.</span><span class="ident" id="5133066">srcBuf</span><span class="op" id="5133072">[</span><span class="ident" id="5133073">s</span><span class="op" id="5133074">.</span><span class="ident" id="5133075">tokPos</span><span class="op" id="5133081">:</span><span class="ident" id="5133082">s</span><span class="op" id="5133083">.</span><span class="ident" id="5133084">srcPos</span><span class="op" id="5133090">]</span><span class="op" id="5133091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133097">s</span><span class="op" id="5133098">.</span><span class="ident" id="5133099">tokPos</span>&nbsp;<span class="op" id="5133106">=</span>&nbsp;<span class="num" id="5133108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133114">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5133146">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133151">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5133198">copy</span><span class="op" id="5133202">(</span><span class="ident" id="5133203">s</span><span class="op" id="5133204">.</span><span class="ident" id="5133205">srcBuf</span><span class="op" id="5133211">[</span><span class="num" id="5133212">0</span><span class="op" id="5133213">:</span><span class="op" id="5133214">]</span><span class="op" id="5133215">,</span>&nbsp;<span class="ident" id="5133217">s</span><span class="op" id="5133218">.</span><span class="ident" id="5133219">srcBuf</span><span class="op" id="5133225">[</span><span class="ident" id="5133226">s</span><span class="op" id="5133227">.</span><span class="ident" id="5133228">srcPos</span><span class="op" id="5133234">:</span><span class="ident" id="5133235">s</span><span class="op" id="5133236">.</span><span class="ident" id="5133237">srcEnd</span><span class="op" id="5133243">]</span><span class="op" id="5133244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133249">s</span><span class="op" id="5133250">.</span><span class="ident" id="5133251">srcBufOffset</span>&nbsp;<span class="op" id="5133264">+=</span>&nbsp;<span class="ident" id="5133267">s</span><span class="op" id="5133268">.</span><span class="ident" id="5133269">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133279">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133301">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133356">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133411">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133467">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133525">i</span>&nbsp;<span class="op" id="5133527">:=</span>&nbsp;<span class="ident" id="5133530">s</span><span class="op" id="5133531">.</span><span class="ident" id="5133532">srcEnd</span>&nbsp;<span class="op" id="5133539">-</span>&nbsp;<span class="ident" id="5133541">s</span><span class="op" id="5133542">.</span><span class="ident" id="5133543">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133553">n</span><span class="op" id="5133554">,</span>&nbsp;<span class="ident" id="5133556">err</span>&nbsp;<span class="op" id="5133560">:=</span>&nbsp;<span class="ident" id="5133563">s</span><span class="op" id="5133564">.</span><span class="ident" id="5133565">src</span><span class="op" id="5133568">.</span><span class="ident" id="5133569">Read</span><span class="op" id="5133573">(</span><span class="ident" id="5133574">s</span><span class="op" id="5133575">.</span><span class="ident" id="5133576">srcBuf</span><span class="op" id="5133582">[</span><span class="ident" id="5133583">i</span><span class="op" id="5133584">:</span><span class="ident" id="5133585">bufLen</span><span class="op" id="5133591">]</span><span class="op" id="5133592">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133597">s</span><span class="op" id="5133598">.</span><span class="ident" id="5133599">srcPos</span>&nbsp;<span class="op" id="5133606">=</span>&nbsp;<span class="num" id="5133608">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133613">s</span><span class="op" id="5133614">.</span><span class="ident" id="5133615">srcEnd</span>&nbsp;<span class="op" id="5133622">=</span>&nbsp;<span class="ident" id="5133624">i</span>&nbsp;<span class="op" id="5133626">+</span>&nbsp;<span class="ident" id="5133628">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133633">s</span><span class="op" id="5133634">.</span><span class="ident" id="5133635">srcBuf</span><span class="op" id="5133641">[</span><span class="ident" id="5133642">s</span><span class="op" id="5133643">.</span><span class="ident" id="5133644">srcEnd</span><span class="op" id="5133650">]</span>&nbsp;<span class="op" id="5133652">=</span>&nbsp;<span class="ident" id="5133654">utf8</span><span class="op" id="5133658">.</span><span class="ident" id="5133659">RuneSelf</span>&nbsp;<span class="comment" id="5133668">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133683">if</span>&nbsp;<span class="ident" id="5133686">err</span>&nbsp;<span class="op" id="5133690">!=</span>&nbsp;<span class="ident" id="5133693">nil</span>&nbsp;<span class="op" id="5133697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133703">if</span>&nbsp;<span class="ident" id="5133706">err</span>&nbsp;<span class="op" id="5133710">!=</span>&nbsp;<span class="ident" id="5133713">io</span><span class="op" id="5133715">.</span><span class="ident" id="5133716">EOF</span>&nbsp;<span class="op" id="5133720">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133727">s</span><span class="op" id="5133728">.</span><span class="builtintype" id="5133729">error</span><span class="op" id="5133734">(</span><span class="ident" id="5133735">err</span><span class="op" id="5133738">.</span><span class="ident" id="5133739">Error</span><span class="op" id="5133744">(</span><span class="op" id="5133745">)</span><span class="op" id="5133746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5133752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133758">if</span>&nbsp;<span class="ident" id="5133761">s</span><span class="op" id="5133762">.</span><span class="ident" id="5133763">srcEnd</span>&nbsp;<span class="op" id="5133770">==</span>&nbsp;<span class="num" id="5133773">0</span>&nbsp;<span class="op" id="5133775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133782">if</span>&nbsp;<span class="ident" id="5133785">s</span><span class="op" id="5133786">.</span><span class="ident" id="5133787">lastCharLen</span>&nbsp;<span class="op" id="5133799">&gt;</span>&nbsp;<span class="num" id="5133801">0</span>&nbsp;<span class="op" id="5133803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133811">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133851">s</span><span class="op" id="5133852">.</span><span class="ident" id="5133853">column</span><span class="op" id="5133859">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5133867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5133874">s</span><span class="op" id="5133875">.</span><span class="ident" id="5133876">lastCharLen</span>&nbsp;<span class="op" id="5133888">=</span>&nbsp;<span class="num" id="5133890">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5133897">return</span>&nbsp;<span class="ident" id="5133904">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5133912">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133918">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5133965">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134012">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134059">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134106">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134123">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134146">ch</span>&nbsp;<span class="op" id="5134149">=</span>&nbsp;<span class="builtintype" id="5134151">rune</span><span class="op" id="5134155">(</span><span class="ident" id="5134156">s</span><span class="op" id="5134157">.</span><span class="ident" id="5134158">srcBuf</span><span class="op" id="5134164">[</span><span class="ident" id="5134165">s</span><span class="op" id="5134166">.</span><span class="ident" id="5134167">srcPos</span><span class="op" id="5134173">]</span><span class="op" id="5134174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134178">if</span>&nbsp;<span class="ident" id="5134181">ch</span>&nbsp;<span class="op" id="5134184">&gt;=</span>&nbsp;<span class="ident" id="5134187">utf8</span><span class="op" id="5134191">.</span><span class="ident" id="5134192">RuneSelf</span>&nbsp;<span class="op" id="5134201">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134206">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134237">ch</span><span class="op" id="5134239">,</span>&nbsp;<span class="ident" id="5134241">width</span>&nbsp;<span class="op" id="5134247">=</span>&nbsp;<span class="ident" id="5134249">utf8</span><span class="op" id="5134253">.</span><span class="ident" id="5134254">DecodeRune</span><span class="op" id="5134264">(</span><span class="ident" id="5134265">s</span><span class="op" id="5134266">.</span><span class="ident" id="5134267">srcBuf</span><span class="op" id="5134273">[</span><span class="ident" id="5134274">s</span><span class="op" id="5134275">.</span><span class="ident" id="5134276">srcPos</span><span class="op" id="5134282">:</span><span class="ident" id="5134283">s</span><span class="op" id="5134284">.</span><span class="ident" id="5134285">srcEnd</span><span class="op" id="5134291">]</span><span class="op" id="5134292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134297">if</span>&nbsp;<span class="ident" id="5134300">ch</span>&nbsp;<span class="op" id="5134303">==</span>&nbsp;<span class="ident" id="5134306">utf8</span><span class="op" id="5134310">.</span><span class="ident" id="5134311">RuneError</span>&nbsp;<span class="op" id="5134321">&amp;&amp;</span>&nbsp;<span class="ident" id="5134324">width</span>&nbsp;<span class="op" id="5134330">==</span>&nbsp;<span class="num" id="5134333">1</span>&nbsp;<span class="op" id="5134335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134341">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134383">s</span><span class="op" id="5134384">.</span><span class="ident" id="5134385">srcPos</span>&nbsp;<span class="op" id="5134392">+=</span>&nbsp;<span class="ident" id="5134395">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134405">s</span><span class="op" id="5134406">.</span><span class="ident" id="5134407">lastCharLen</span>&nbsp;<span class="op" id="5134419">=</span>&nbsp;<span class="ident" id="5134421">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134431">s</span><span class="op" id="5134432">.</span><span class="ident" id="5134433">column</span><span class="op" id="5134439">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134446">s</span><span class="op" id="5134447">.</span><span class="builtintype" id="5134448">error</span><span class="op" id="5134453">(</span><span class="string" id="5134454">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="5134478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134484">return</span>&nbsp;<span class="ident" id="5134491">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134497">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134508">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134520">s</span><span class="op" id="5134521">.</span><span class="ident" id="5134522">srcPos</span>&nbsp;<span class="op" id="5134529">+=</span>&nbsp;<span class="ident" id="5134532">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134539">s</span><span class="op" id="5134540">.</span><span class="ident" id="5134541">lastCharLen</span>&nbsp;<span class="op" id="5134553">=</span>&nbsp;<span class="ident" id="5134555">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134562">s</span><span class="op" id="5134563">.</span><span class="ident" id="5134564">column</span><span class="op" id="5134570">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134575">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134598">switch</span>&nbsp;<span class="ident" id="5134605">ch</span>&nbsp;<span class="op" id="5134608">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134611">case</span>&nbsp;<span class="num" id="5134616">0</span><span class="op" id="5134617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5134621">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134661">s</span><span class="op" id="5134662">.</span><span class="builtintype" id="5134663">error</span><span class="op" id="5134668">(</span><span class="string" id="5134669">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="5134692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134695">case</span>&nbsp;<span class="string" id="5134700">&#39;\n&#39;</span><span class="op" id="5134704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134708">s</span><span class="op" id="5134709">.</span><span class="ident" id="5134710">line</span><span class="op" id="5134714">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134719">s</span><span class="op" id="5134720">.</span><span class="ident" id="5134721">lastLineLen</span>&nbsp;<span class="op" id="5134733">=</span>&nbsp;<span class="ident" id="5134735">s</span><span class="op" id="5134736">.</span><span class="ident" id="5134737">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5134746">s</span><span class="op" id="5134747">.</span><span class="ident" id="5134748">column</span>&nbsp;<span class="op" id="5134755">=</span>&nbsp;<span class="num" id="5134757">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5134760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5134764">return</span>&nbsp;<span class="ident" id="5134771">ch</span><br>
<span class="lineno">305</span><span class="op" id="5134774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5134777">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="5134831">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="5134886">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="5134944">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5135002">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5135055">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5135084">func</span>&nbsp;<span class="op" id="5135089">(</span><span class="ident" id="5135090">s</span>&nbsp;<span class="op" id="5135092">*</span><span class="ident" id="5135093">Scanner</span><span class="op" id="5135100">)</span>&nbsp;<span class="ident" id="5135102">Next</span><span class="op" id="5135106">(</span><span class="op" id="5135107">)</span>&nbsp;<span class="builtintype" id="5135109">rune</span>&nbsp;<span class="op" id="5135114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135117">s</span><span class="op" id="5135118">.</span><span class="ident" id="5135119">tokPos</span>&nbsp;<span class="op" id="5135126">=</span>&nbsp;<span class="op" id="5135128">-</span><span class="num" id="5135129">1</span>&nbsp;<span class="comment" id="5135131">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135160">s</span><span class="op" id="5135161">.</span><span class="ident" id="5135162">Line</span>&nbsp;<span class="op" id="5135167">=</span>&nbsp;<span class="num" id="5135169">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5135174">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135204">ch</span>&nbsp;<span class="op" id="5135207">:=</span>&nbsp;<span class="ident" id="5135210">s</span><span class="op" id="5135211">.</span><span class="ident" id="5135212">Peek</span><span class="op" id="5135216">(</span><span class="op" id="5135217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135220">s</span><span class="op" id="5135221">.</span><span class="ident" id="5135222">ch</span>&nbsp;<span class="op" id="5135225">=</span>&nbsp;<span class="ident" id="5135227">s</span><span class="op" id="5135228">.</span><span class="ident" id="5135229">next</span><span class="op" id="5135233">(</span><span class="op" id="5135234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135237">return</span>&nbsp;<span class="ident" id="5135244">ch</span><br>
<span class="lineno"></span><span class="op" id="5135247">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5135250">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="5135325">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="5135397">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="5135425">func</span>&nbsp;<span class="op" id="5135430">(</span><span class="ident" id="5135431">s</span>&nbsp;<span class="op" id="5135433">*</span><span class="ident" id="5135434">Scanner</span><span class="op" id="5135441">)</span>&nbsp;<span class="ident" id="5135443">Peek</span><span class="op" id="5135447">(</span><span class="op" id="5135448">)</span>&nbsp;<span class="builtintype" id="5135450">rune</span>&nbsp;<span class="op" id="5135455">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135458">if</span>&nbsp;<span class="ident" id="5135461">s</span><span class="op" id="5135462">.</span><span class="ident" id="5135463">ch</span>&nbsp;<span class="op" id="5135466">&lt;</span>&nbsp;<span class="num" id="5135468">0</span>&nbsp;<span class="op" id="5135470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5135474">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135530">s</span><span class="op" id="5135531">.</span><span class="ident" id="5135532">ch</span>&nbsp;<span class="op" id="5135535">=</span>&nbsp;<span class="ident" id="5135537">s</span><span class="op" id="5135538">.</span><span class="ident" id="5135539">next</span><span class="op" id="5135543">(</span><span class="op" id="5135544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135548">if</span>&nbsp;<span class="ident" id="5135551">s</span><span class="op" id="5135552">.</span><span class="ident" id="5135553">ch</span>&nbsp;<span class="op" id="5135556">==</span>&nbsp;<span class="string" id="5135559">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="5135568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135573">s</span><span class="op" id="5135574">.</span><span class="ident" id="5135575">ch</span>&nbsp;<span class="op" id="5135578">=</span>&nbsp;<span class="ident" id="5135580">s</span><span class="op" id="5135581">.</span><span class="ident" id="5135582">next</span><span class="op" id="5135586">(</span><span class="op" id="5135587">)</span>&nbsp;<span class="comment" id="5135589">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135611">return</span>&nbsp;<span class="ident" id="5135618">s</span><span class="op" id="5135619">.</span><span class="ident" id="5135620">ch</span><br>
<span class="lineno"></span><span class="op" id="5135623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5135626">func</span>&nbsp;<span class="op" id="5135631">(</span><span class="ident" id="5135632">s</span>&nbsp;<span class="op" id="5135634">*</span><span class="ident" id="5135635">Scanner</span><span class="op" id="5135642">)</span>&nbsp;<span class="builtintype" id="5135644">error</span><span class="op" id="5135649">(</span><span class="ident" id="5135650">msg</span>&nbsp;<span class="builtintype" id="5135654">string</span><span class="op" id="5135660">)</span>&nbsp;<span class="op" id="5135662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135665">s</span><span class="op" id="5135666">.</span><span class="ident" id="5135667">ErrorCount</span><span class="op" id="5135677">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135681">if</span>&nbsp;<span class="ident" id="5135684">s</span><span class="op" id="5135685">.</span><span class="ident" id="5135686">Error</span>&nbsp;<span class="op" id="5135692">!=</span>&nbsp;<span class="ident" id="5135695">nil</span>&nbsp;<span class="op" id="5135699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135703">s</span><span class="op" id="5135704">.</span><span class="ident" id="5135705">Error</span><span class="op" id="5135710">(</span><span class="ident" id="5135711">s</span><span class="op" id="5135712">,</span>&nbsp;<span class="ident" id="5135714">msg</span><span class="op" id="5135717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135721">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135732">pos</span>&nbsp;<span class="op" id="5135736">:=</span>&nbsp;<span class="ident" id="5135739">s</span><span class="op" id="5135740">.</span><span class="ident" id="5135741">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135751">if</span>&nbsp;<span class="op" id="5135754">!</span><span class="ident" id="5135755">pos</span><span class="op" id="5135758">.</span><span class="ident" id="5135759">IsValid</span><span class="op" id="5135766">(</span><span class="op" id="5135767">)</span>&nbsp;<span class="op" id="5135769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135773">pos</span>&nbsp;<span class="op" id="5135777">=</span>&nbsp;<span class="ident" id="5135779">s</span><span class="op" id="5135780">.</span><span class="ident" id="5135781">Pos</span><span class="op" id="5135784">(</span><span class="op" id="5135785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135788">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135791">fmt</span><span class="op" id="5135794">.</span><span class="ident" id="5135795">Fprintf</span><span class="op" id="5135802">(</span><span class="ident" id="5135803">os</span><span class="op" id="5135805">.</span><span class="ident" id="5135806">Stderr</span><span class="op" id="5135812">,</span>&nbsp;<span class="string" id="5135814">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="5135824">,</span>&nbsp;<span class="ident" id="5135826">pos</span><span class="op" id="5135829">,</span>&nbsp;<span class="ident" id="5135831">msg</span><span class="op" id="5135834">)</span><br>
<span class="lineno"></span><span class="op" id="5135836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5135839">func</span>&nbsp;<span class="op" id="5135844">(</span><span class="ident" id="5135845">s</span>&nbsp;<span class="op" id="5135847">*</span><span class="ident" id="5135848">Scanner</span><span class="op" id="5135855">)</span>&nbsp;<span class="ident" id="5135857">isIdentRune</span><span class="op" id="5135868">(</span><span class="ident" id="5135869">ch</span>&nbsp;<span class="builtintype" id="5135872">rune</span><span class="op" id="5135876">,</span>&nbsp;<span class="ident" id="5135878">i</span>&nbsp;<span class="builtintype" id="5135880">int</span><span class="op" id="5135883">)</span>&nbsp;<span class="builtintype" id="5135885">bool</span>&nbsp;<span class="op" id="5135890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135893">if</span>&nbsp;<span class="ident" id="5135896">s</span><span class="op" id="5135897">.</span><span class="ident" id="5135898">IsIdentRune</span>&nbsp;<span class="op" id="5135910">!=</span>&nbsp;<span class="ident" id="5135913">nil</span>&nbsp;<span class="op" id="5135917">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135921">return</span>&nbsp;<span class="ident" id="5135928">s</span><span class="op" id="5135929">.</span><span class="ident" id="5135930">IsIdentRune</span><span class="op" id="5135941">(</span><span class="ident" id="5135942">ch</span><span class="op" id="5135944">,</span>&nbsp;<span class="ident" id="5135946">i</span><span class="op" id="5135947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135953">return</span>&nbsp;<span class="ident" id="5135960">ch</span>&nbsp;<span class="op" id="5135963">==</span>&nbsp;<span class="string" id="5135966">&#39;_&#39;</span>&nbsp;<span class="op" id="5135970">||</span>&nbsp;<span class="ident" id="5135973">unicode</span><span class="op" id="5135980">.</span><span class="ident" id="5135981">IsLetter</span><span class="op" id="5135989">(</span><span class="ident" id="5135990">ch</span><span class="op" id="5135992">)</span>&nbsp;<span class="op" id="5135994">||</span>&nbsp;<span class="ident" id="5135997">unicode</span><span class="op" id="5136004">.</span><span class="ident" id="5136005">IsDigit</span><span class="op" id="5136012">(</span><span class="ident" id="5136013">ch</span><span class="op" id="5136015">)</span>&nbsp;<span class="op" id="5136017">&amp;&amp;</span>&nbsp;<span class="ident" id="5136020">i</span>&nbsp;<span class="op" id="5136022">&gt;</span>&nbsp;<span class="num" id="5136024">0</span><br>
<span class="lineno"></span><span class="op" id="5136026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5136029">func</span>&nbsp;<span class="op" id="5136034">(</span><span class="ident" id="5136035">s</span>&nbsp;<span class="op" id="5136037">*</span><span class="ident" id="5136038">Scanner</span><span class="op" id="5136045">)</span>&nbsp;<span class="ident" id="5136047">scanIdentifier</span><span class="op" id="5136061">(</span><span class="op" id="5136062">)</span>&nbsp;<span class="builtintype" id="5136064">rune</span>&nbsp;<span class="op" id="5136069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5136072">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136139">ch</span>&nbsp;<span class="op" id="5136142">:=</span>&nbsp;<span class="ident" id="5136145">s</span><span class="op" id="5136146">.</span><span class="ident" id="5136147">next</span><span class="op" id="5136151">(</span><span class="op" id="5136152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136155">for</span>&nbsp;<span class="ident" id="5136159">i</span>&nbsp;<span class="op" id="5136161">:=</span>&nbsp;<span class="num" id="5136164">1</span><span class="op" id="5136165">;</span>&nbsp;<span class="ident" id="5136167">s</span><span class="op" id="5136168">.</span><span class="ident" id="5136169">isIdentRune</span><span class="op" id="5136180">(</span><span class="ident" id="5136181">ch</span><span class="op" id="5136183">,</span>&nbsp;<span class="ident" id="5136185">i</span><span class="op" id="5136186">)</span><span class="op" id="5136187">;</span>&nbsp;<span class="ident" id="5136189">i</span><span class="op" id="5136190">++</span>&nbsp;<span class="op" id="5136193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136197">ch</span>&nbsp;<span class="op" id="5136200">=</span>&nbsp;<span class="ident" id="5136202">s</span><span class="op" id="5136203">.</span><span class="ident" id="5136204">next</span><span class="op" id="5136208">(</span><span class="op" id="5136209">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136215">return</span>&nbsp;<span class="ident" id="5136222">ch</span><br>
<span class="lineno"></span><span class="op" id="5136225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5136228">func</span>&nbsp;<span class="ident" id="5136233">digitVal</span><span class="op" id="5136241">(</span><span class="ident" id="5136242">ch</span>&nbsp;<span class="builtintype" id="5136245">rune</span><span class="op" id="5136249">)</span>&nbsp;<span class="builtintype" id="5136251">int</span>&nbsp;<span class="op" id="5136255">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136258">switch</span>&nbsp;<span class="op" id="5136265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136268">case</span>&nbsp;<span class="string" id="5136273">&#39;0&#39;</span>&nbsp;<span class="op" id="5136277">&lt;=</span>&nbsp;<span class="ident" id="5136280">ch</span>&nbsp;<span class="op" id="5136283">&amp;&amp;</span>&nbsp;<span class="ident" id="5136286">ch</span>&nbsp;<span class="op" id="5136289">&lt;=</span>&nbsp;<span class="string" id="5136292">&#39;9&#39;</span><span class="op" id="5136295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136299">return</span>&nbsp;<span class="builtintype" id="5136306">int</span><span class="op" id="5136309">(</span><span class="ident" id="5136310">ch</span>&nbsp;<span class="op" id="5136313">-</span>&nbsp;<span class="string" id="5136315">&#39;0&#39;</span><span class="op" id="5136318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136321">case</span>&nbsp;<span class="string" id="5136326">&#39;a&#39;</span>&nbsp;<span class="op" id="5136330">&lt;=</span>&nbsp;<span class="ident" id="5136333">ch</span>&nbsp;<span class="op" id="5136336">&amp;&amp;</span>&nbsp;<span class="ident" id="5136339">ch</span>&nbsp;<span class="op" id="5136342">&lt;=</span>&nbsp;<span class="string" id="5136345">&#39;f&#39;</span><span class="op" id="5136348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136352">return</span>&nbsp;<span class="builtintype" id="5136359">int</span><span class="op" id="5136362">(</span><span class="ident" id="5136363">ch</span>&nbsp;<span class="op" id="5136366">-</span>&nbsp;<span class="string" id="5136368">&#39;a&#39;</span>&nbsp;<span class="op" id="5136372">+</span>&nbsp;<span class="num" id="5136374">10</span><span class="op" id="5136376">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136379">case</span>&nbsp;<span class="string" id="5136384">&#39;A&#39;</span>&nbsp;<span class="op" id="5136388">&lt;=</span>&nbsp;<span class="ident" id="5136391">ch</span>&nbsp;<span class="op" id="5136394">&amp;&amp;</span>&nbsp;<span class="ident" id="5136397">ch</span>&nbsp;<span class="op" id="5136400">&lt;=</span>&nbsp;<span class="string" id="5136403">&#39;F&#39;</span><span class="op" id="5136406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136410">return</span>&nbsp;<span class="builtintype" id="5136417">int</span><span class="op" id="5136420">(</span><span class="ident" id="5136421">ch</span>&nbsp;<span class="op" id="5136424">-</span>&nbsp;<span class="string" id="5136426">&#39;A&#39;</span>&nbsp;<span class="op" id="5136430">+</span>&nbsp;<span class="num" id="5136432">10</span><span class="op" id="5136434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136440">return</span>&nbsp;<span class="num" id="5136447">16</span>&nbsp;<span class="comment" id="5136450">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="5136485">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="5136488">func</span>&nbsp;<span class="ident" id="5136493">isDecimal</span><span class="op" id="5136502">(</span><span class="ident" id="5136503">ch</span>&nbsp;<span class="builtintype" id="5136506">rune</span><span class="op" id="5136510">)</span>&nbsp;<span class="builtintype" id="5136512">bool</span>&nbsp;<span class="op" id="5136517">{</span>&nbsp;<span class="keyword" id="5136519">return</span>&nbsp;<span class="string" id="5136526">&#39;0&#39;</span>&nbsp;<span class="op" id="5136530">&lt;=</span>&nbsp;<span class="ident" id="5136533">ch</span>&nbsp;<span class="op" id="5136536">&amp;&amp;</span>&nbsp;<span class="ident" id="5136539">ch</span>&nbsp;<span class="op" id="5136542">&lt;=</span>&nbsp;<span class="string" id="5136545">&#39;9&#39;</span>&nbsp;<span class="op" id="5136549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5136552">func</span>&nbsp;<span class="op" id="5136557">(</span><span class="ident" id="5136558">s</span>&nbsp;<span class="op" id="5136560">*</span><span class="ident" id="5136561">Scanner</span><span class="op" id="5136568">)</span>&nbsp;<span class="ident" id="5136570">scanMantissa</span><span class="op" id="5136582">(</span><span class="ident" id="5136583">ch</span>&nbsp;<span class="builtintype" id="5136586">rune</span><span class="op" id="5136590">)</span>&nbsp;<span class="builtintype" id="5136592">rune</span>&nbsp;<span class="op" id="5136597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136600">for</span>&nbsp;<span class="ident" id="5136604">isDecimal</span><span class="op" id="5136613">(</span><span class="ident" id="5136614">ch</span><span class="op" id="5136616">)</span>&nbsp;<span class="op" id="5136618">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136622">ch</span>&nbsp;<span class="op" id="5136625">=</span>&nbsp;<span class="ident" id="5136627">s</span><span class="op" id="5136628">.</span><span class="ident" id="5136629">next</span><span class="op" id="5136633">(</span><span class="op" id="5136634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136640">return</span>&nbsp;<span class="ident" id="5136647">ch</span><br>
<span class="lineno"></span><span class="op" id="5136650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5136653">func</span>&nbsp;<span class="op" id="5136658">(</span><span class="ident" id="5136659">s</span>&nbsp;<span class="op" id="5136661">*</span><span class="ident" id="5136662">Scanner</span><span class="op" id="5136669">)</span>&nbsp;<span class="ident" id="5136671">scanFraction</span><span class="op" id="5136683">(</span><span class="ident" id="5136684">ch</span>&nbsp;<span class="builtintype" id="5136687">rune</span><span class="op" id="5136691">)</span>&nbsp;<span class="builtintype" id="5136693">rune</span>&nbsp;<span class="op" id="5136698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136701">if</span>&nbsp;<span class="ident" id="5136704">ch</span>&nbsp;<span class="op" id="5136707">==</span>&nbsp;<span class="string" id="5136710">&#39;.&#39;</span>&nbsp;<span class="op" id="5136714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136718">ch</span>&nbsp;<span class="op" id="5136721">=</span>&nbsp;<span class="ident" id="5136723">s</span><span class="op" id="5136724">.</span><span class="ident" id="5136725">scanMantissa</span><span class="op" id="5136737">(</span><span class="ident" id="5136738">s</span><span class="op" id="5136739">.</span><span class="ident" id="5136740">next</span><span class="op" id="5136744">(</span><span class="op" id="5136745">)</span><span class="op" id="5136746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136752">return</span>&nbsp;<span class="ident" id="5136759">ch</span><br>
<span class="lineno">390</span><span class="op" id="5136762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5136765">func</span>&nbsp;<span class="op" id="5136770">(</span><span class="ident" id="5136771">s</span>&nbsp;<span class="op" id="5136773">*</span><span class="ident" id="5136774">Scanner</span><span class="op" id="5136781">)</span>&nbsp;<span class="ident" id="5136783">scanExponent</span><span class="op" id="5136795">(</span><span class="ident" id="5136796">ch</span>&nbsp;<span class="builtintype" id="5136799">rune</span><span class="op" id="5136803">)</span>&nbsp;<span class="builtintype" id="5136805">rune</span>&nbsp;<span class="op" id="5136810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136813">if</span>&nbsp;<span class="ident" id="5136816">ch</span>&nbsp;<span class="op" id="5136819">==</span>&nbsp;<span class="string" id="5136822">&#39;e&#39;</span>&nbsp;<span class="op" id="5136826">||</span>&nbsp;<span class="ident" id="5136829">ch</span>&nbsp;<span class="op" id="5136832">==</span>&nbsp;<span class="string" id="5136835">&#39;E&#39;</span>&nbsp;<span class="op" id="5136839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136843">ch</span>&nbsp;<span class="op" id="5136846">=</span>&nbsp;<span class="ident" id="5136848">s</span><span class="op" id="5136849">.</span><span class="ident" id="5136850">next</span><span class="op" id="5136854">(</span><span class="op" id="5136855">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136859">if</span>&nbsp;<span class="ident" id="5136862">ch</span>&nbsp;<span class="op" id="5136865">==</span>&nbsp;<span class="string" id="5136868">&#39;-&#39;</span>&nbsp;<span class="op" id="5136872">||</span>&nbsp;<span class="ident" id="5136875">ch</span>&nbsp;<span class="op" id="5136878">==</span>&nbsp;<span class="string" id="5136881">&#39;+&#39;</span>&nbsp;<span class="op" id="5136885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136890">ch</span>&nbsp;<span class="op" id="5136893">=</span>&nbsp;<span class="ident" id="5136895">s</span><span class="op" id="5136896">.</span><span class="ident" id="5136897">next</span><span class="op" id="5136901">(</span><span class="op" id="5136902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136910">ch</span>&nbsp;<span class="op" id="5136913">=</span>&nbsp;<span class="ident" id="5136915">s</span><span class="op" id="5136916">.</span><span class="ident" id="5136917">scanMantissa</span><span class="op" id="5136929">(</span><span class="ident" id="5136930">ch</span><span class="op" id="5136932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136935">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136938">return</span>&nbsp;<span class="ident" id="5136945">ch</span><br>
<span class="lineno"></span><span class="op" id="5136948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5136951">func</span>&nbsp;<span class="op" id="5136956">(</span><span class="ident" id="5136957">s</span>&nbsp;<span class="op" id="5136959">*</span><span class="ident" id="5136960">Scanner</span><span class="op" id="5136967">)</span>&nbsp;<span class="ident" id="5136969">scanNumber</span><span class="op" id="5136979">(</span><span class="ident" id="5136980">ch</span>&nbsp;<span class="builtintype" id="5136983">rune</span><span class="op" id="5136987">)</span>&nbsp;<span class="op" id="5136989">(</span><span class="builtintype" id="5136990">rune</span><span class="op" id="5136994">,</span>&nbsp;<span class="builtintype" id="5136996">rune</span><span class="op" id="5137000">)</span>&nbsp;<span class="op" id="5137002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137005">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137023">if</span>&nbsp;<span class="ident" id="5137026">ch</span>&nbsp;<span class="op" id="5137029">==</span>&nbsp;<span class="string" id="5137032">&#39;0&#39;</span>&nbsp;<span class="op" id="5137036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137040">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137058">ch</span>&nbsp;<span class="op" id="5137061">=</span>&nbsp;<span class="ident" id="5137063">s</span><span class="op" id="5137064">.</span><span class="ident" id="5137065">next</span><span class="op" id="5137069">(</span><span class="op" id="5137070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137074">if</span>&nbsp;<span class="ident" id="5137077">ch</span>&nbsp;<span class="op" id="5137080">==</span>&nbsp;<span class="string" id="5137083">&#39;x&#39;</span>&nbsp;<span class="op" id="5137087">||</span>&nbsp;<span class="ident" id="5137090">ch</span>&nbsp;<span class="op" id="5137093">==</span>&nbsp;<span class="string" id="5137096">&#39;X&#39;</span>&nbsp;<span class="op" id="5137100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137105">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137127">ch</span>&nbsp;<span class="op" id="5137130">=</span>&nbsp;<span class="ident" id="5137132">s</span><span class="op" id="5137133">.</span><span class="ident" id="5137134">next</span><span class="op" id="5137138">(</span><span class="op" id="5137139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137144">hasMantissa</span>&nbsp;<span class="op" id="5137156">:=</span>&nbsp;<span class="builtintype" id="5137159">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137168">for</span>&nbsp;<span class="ident" id="5137172">digitVal</span><span class="op" id="5137180">(</span><span class="ident" id="5137181">ch</span><span class="op" id="5137183">)</span>&nbsp;<span class="op" id="5137185">&lt;</span>&nbsp;<span class="num" id="5137187">16</span>&nbsp;<span class="op" id="5137190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137196">ch</span>&nbsp;<span class="op" id="5137199">=</span>&nbsp;<span class="ident" id="5137201">s</span><span class="op" id="5137202">.</span><span class="ident" id="5137203">next</span><span class="op" id="5137207">(</span><span class="op" id="5137208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137214">hasMantissa</span>&nbsp;<span class="op" id="5137226">=</span>&nbsp;<span class="builtintype" id="5137228">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137241">if</span>&nbsp;<span class="op" id="5137244">!</span><span class="ident" id="5137245">hasMantissa</span>&nbsp;<span class="op" id="5137257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137263">s</span><span class="op" id="5137264">.</span><span class="builtintype" id="5137265">error</span><span class="op" id="5137270">(</span><span class="string" id="5137271">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="5137299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137308">}</span>&nbsp;<span class="keyword" id="5137310">else</span>&nbsp;<span class="op" id="5137315">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137320">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137345">has8or9</span>&nbsp;<span class="op" id="5137353">:=</span>&nbsp;<span class="builtintype" id="5137356">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137365">for</span>&nbsp;<span class="ident" id="5137369">isDecimal</span><span class="op" id="5137378">(</span><span class="ident" id="5137379">ch</span><span class="op" id="5137381">)</span>&nbsp;<span class="op" id="5137383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137389">if</span>&nbsp;<span class="ident" id="5137392">ch</span>&nbsp;<span class="op" id="5137395">&gt;</span>&nbsp;<span class="string" id="5137397">&#39;7&#39;</span>&nbsp;<span class="op" id="5137401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137408">has8or9</span>&nbsp;<span class="op" id="5137416">=</span>&nbsp;<span class="builtintype" id="5137418">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137433">ch</span>&nbsp;<span class="op" id="5137436">=</span>&nbsp;<span class="ident" id="5137438">s</span><span class="op" id="5137439">.</span><span class="ident" id="5137440">next</span><span class="op" id="5137444">(</span><span class="op" id="5137445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137455">if</span>&nbsp;<span class="ident" id="5137458">s</span><span class="op" id="5137459">.</span><span class="ident" id="5137460">Mode</span><span class="op" id="5137464">&amp;</span><span class="ident" id="5137465">ScanFloats</span>&nbsp;<span class="op" id="5137476">!=</span>&nbsp;<span class="num" id="5137479">0</span>&nbsp;<span class="op" id="5137481">&amp;&amp;</span>&nbsp;<span class="op" id="5137484">(</span><span class="ident" id="5137485">ch</span>&nbsp;<span class="op" id="5137488">==</span>&nbsp;<span class="string" id="5137491">&#39;.&#39;</span>&nbsp;<span class="op" id="5137495">||</span>&nbsp;<span class="ident" id="5137498">ch</span>&nbsp;<span class="op" id="5137501">==</span>&nbsp;<span class="string" id="5137504">&#39;e&#39;</span>&nbsp;<span class="op" id="5137508">||</span>&nbsp;<span class="ident" id="5137511">ch</span>&nbsp;<span class="op" id="5137514">==</span>&nbsp;<span class="string" id="5137517">&#39;E&#39;</span><span class="op" id="5137520">)</span>&nbsp;<span class="op" id="5137522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137528">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137541">ch</span>&nbsp;<span class="op" id="5137544">=</span>&nbsp;<span class="ident" id="5137546">s</span><span class="op" id="5137547">.</span><span class="ident" id="5137548">scanFraction</span><span class="op" id="5137560">(</span><span class="ident" id="5137561">ch</span><span class="op" id="5137563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137569">ch</span>&nbsp;<span class="op" id="5137572">=</span>&nbsp;<span class="ident" id="5137574">s</span><span class="op" id="5137575">.</span><span class="ident" id="5137576">scanExponent</span><span class="op" id="5137588">(</span><span class="ident" id="5137589">ch</span><span class="op" id="5137591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137597">return</span>&nbsp;<span class="ident" id="5137604">Float</span><span class="op" id="5137609">,</span>&nbsp;<span class="ident" id="5137611">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137622">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137638">if</span>&nbsp;<span class="ident" id="5137641">has8or9</span>&nbsp;<span class="op" id="5137649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137655">s</span><span class="op" id="5137656">.</span><span class="builtintype" id="5137657">error</span><span class="op" id="5137662">(</span><span class="string" id="5137663">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="5137685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137698">return</span>&nbsp;<span class="ident" id="5137705">Int</span><span class="op" id="5137708">,</span>&nbsp;<span class="ident" id="5137710">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137717">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137742">ch</span>&nbsp;<span class="op" id="5137745">=</span>&nbsp;<span class="ident" id="5137747">s</span><span class="op" id="5137748">.</span><span class="ident" id="5137749">scanMantissa</span><span class="op" id="5137761">(</span><span class="ident" id="5137762">ch</span><span class="op" id="5137764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137767">if</span>&nbsp;<span class="ident" id="5137770">s</span><span class="op" id="5137771">.</span><span class="ident" id="5137772">Mode</span><span class="op" id="5137776">&amp;</span><span class="ident" id="5137777">ScanFloats</span>&nbsp;<span class="op" id="5137788">!=</span>&nbsp;<span class="num" id="5137791">0</span>&nbsp;<span class="op" id="5137793">&amp;&amp;</span>&nbsp;<span class="op" id="5137796">(</span><span class="ident" id="5137797">ch</span>&nbsp;<span class="op" id="5137800">==</span>&nbsp;<span class="string" id="5137803">&#39;.&#39;</span>&nbsp;<span class="op" id="5137807">||</span>&nbsp;<span class="ident" id="5137810">ch</span>&nbsp;<span class="op" id="5137813">==</span>&nbsp;<span class="string" id="5137816">&#39;e&#39;</span>&nbsp;<span class="op" id="5137820">||</span>&nbsp;<span class="ident" id="5137823">ch</span>&nbsp;<span class="op" id="5137826">==</span>&nbsp;<span class="string" id="5137829">&#39;E&#39;</span><span class="op" id="5137832">)</span>&nbsp;<span class="op" id="5137834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5137838">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137849">ch</span>&nbsp;<span class="op" id="5137852">=</span>&nbsp;<span class="ident" id="5137854">s</span><span class="op" id="5137855">.</span><span class="ident" id="5137856">scanFraction</span><span class="op" id="5137868">(</span><span class="ident" id="5137869">ch</span><span class="op" id="5137871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5137875">ch</span>&nbsp;<span class="op" id="5137878">=</span>&nbsp;<span class="ident" id="5137880">s</span><span class="op" id="5137881">.</span><span class="ident" id="5137882">scanExponent</span><span class="op" id="5137894">(</span><span class="ident" id="5137895">ch</span><span class="op" id="5137897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137901">return</span>&nbsp;<span class="ident" id="5137908">Float</span><span class="op" id="5137913">,</span>&nbsp;<span class="ident" id="5137915">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5137919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137922">return</span>&nbsp;<span class="ident" id="5137929">Int</span><span class="op" id="5137932">,</span>&nbsp;<span class="ident" id="5137934">ch</span><br>
<span class="lineno">450</span><span class="op" id="5137937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5137940">func</span>&nbsp;<span class="op" id="5137945">(</span><span class="ident" id="5137946">s</span>&nbsp;<span class="op" id="5137948">*</span><span class="ident" id="5137949">Scanner</span><span class="op" id="5137956">)</span>&nbsp;<span class="ident" id="5137958">scanDigits</span><span class="op" id="5137968">(</span><span class="ident" id="5137969">ch</span>&nbsp;<span class="builtintype" id="5137972">rune</span><span class="op" id="5137976">,</span>&nbsp;<span class="ident" id="5137978">base</span><span class="op" id="5137982">,</span>&nbsp;<span class="ident" id="5137984">n</span>&nbsp;<span class="builtintype" id="5137986">int</span><span class="op" id="5137989">)</span>&nbsp;<span class="builtintype" id="5137991">rune</span>&nbsp;<span class="op" id="5137996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5137999">for</span>&nbsp;<span class="ident" id="5138003">n</span>&nbsp;<span class="op" id="5138005">&gt;</span>&nbsp;<span class="num" id="5138007">0</span>&nbsp;<span class="op" id="5138009">&amp;&amp;</span>&nbsp;<span class="ident" id="5138012">digitVal</span><span class="op" id="5138020">(</span><span class="ident" id="5138021">ch</span><span class="op" id="5138023">)</span>&nbsp;<span class="op" id="5138025">&lt;</span>&nbsp;<span class="ident" id="5138027">base</span>&nbsp;<span class="op" id="5138032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138036">ch</span>&nbsp;<span class="op" id="5138039">=</span>&nbsp;<span class="ident" id="5138041">s</span><span class="op" id="5138042">.</span><span class="ident" id="5138043">next</span><span class="op" id="5138047">(</span><span class="op" id="5138048">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138052">n</span><span class="op" id="5138053">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138060">if</span>&nbsp;<span class="ident" id="5138063">n</span>&nbsp;<span class="op" id="5138065">&gt;</span>&nbsp;<span class="num" id="5138067">0</span>&nbsp;<span class="op" id="5138069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138073">s</span><span class="op" id="5138074">.</span><span class="builtintype" id="5138075">error</span><span class="op" id="5138080">(</span><span class="string" id="5138081">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5138102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138105">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138108">return</span>&nbsp;<span class="ident" id="5138115">ch</span><br>
<span class="lineno"></span><span class="op" id="5138118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5138121">func</span>&nbsp;<span class="op" id="5138126">(</span><span class="ident" id="5138127">s</span>&nbsp;<span class="op" id="5138129">*</span><span class="ident" id="5138130">Scanner</span><span class="op" id="5138137">)</span>&nbsp;<span class="ident" id="5138139">scanEscape</span><span class="op" id="5138149">(</span><span class="ident" id="5138150">quote</span>&nbsp;<span class="builtintype" id="5138156">rune</span><span class="op" id="5138160">)</span>&nbsp;<span class="builtintype" id="5138162">rune</span>&nbsp;<span class="op" id="5138167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138170">ch</span>&nbsp;<span class="op" id="5138173">:=</span>&nbsp;<span class="ident" id="5138176">s</span><span class="op" id="5138177">.</span><span class="ident" id="5138178">next</span><span class="op" id="5138182">(</span><span class="op" id="5138183">)</span>&nbsp;<span class="comment" id="5138185">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138214">switch</span>&nbsp;<span class="ident" id="5138221">ch</span>&nbsp;<span class="op" id="5138224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138227">case</span>&nbsp;<span class="string" id="5138232">&#39;a&#39;</span><span class="op" id="5138235">,</span>&nbsp;<span class="string" id="5138237">&#39;b&#39;</span><span class="op" id="5138240">,</span>&nbsp;<span class="string" id="5138242">&#39;f&#39;</span><span class="op" id="5138245">,</span>&nbsp;<span class="string" id="5138247">&#39;n&#39;</span><span class="op" id="5138250">,</span>&nbsp;<span class="string" id="5138252">&#39;r&#39;</span><span class="op" id="5138255">,</span>&nbsp;<span class="string" id="5138257">&#39;t&#39;</span><span class="op" id="5138260">,</span>&nbsp;<span class="string" id="5138262">&#39;v&#39;</span><span class="op" id="5138265">,</span>&nbsp;<span class="string" id="5138267">&#39;\\&#39;</span><span class="op" id="5138271">,</span>&nbsp;<span class="ident" id="5138273">quote</span><span class="op" id="5138278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5138282">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138301">ch</span>&nbsp;<span class="op" id="5138304">=</span>&nbsp;<span class="ident" id="5138306">s</span><span class="op" id="5138307">.</span><span class="ident" id="5138308">next</span><span class="op" id="5138312">(</span><span class="op" id="5138313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138316">case</span>&nbsp;<span class="string" id="5138321">&#39;0&#39;</span><span class="op" id="5138324">,</span>&nbsp;<span class="string" id="5138326">&#39;1&#39;</span><span class="op" id="5138329">,</span>&nbsp;<span class="string" id="5138331">&#39;2&#39;</span><span class="op" id="5138334">,</span>&nbsp;<span class="string" id="5138336">&#39;3&#39;</span><span class="op" id="5138339">,</span>&nbsp;<span class="string" id="5138341">&#39;4&#39;</span><span class="op" id="5138344">,</span>&nbsp;<span class="string" id="5138346">&#39;5&#39;</span><span class="op" id="5138349">,</span>&nbsp;<span class="string" id="5138351">&#39;6&#39;</span><span class="op" id="5138354">,</span>&nbsp;<span class="string" id="5138356">&#39;7&#39;</span><span class="op" id="5138359">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138363">ch</span>&nbsp;<span class="op" id="5138366">=</span>&nbsp;<span class="ident" id="5138368">s</span><span class="op" id="5138369">.</span><span class="ident" id="5138370">scanDigits</span><span class="op" id="5138380">(</span><span class="ident" id="5138381">ch</span><span class="op" id="5138383">,</span>&nbsp;<span class="num" id="5138385">8</span><span class="op" id="5138386">,</span>&nbsp;<span class="num" id="5138388">3</span><span class="op" id="5138389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138392">case</span>&nbsp;<span class="string" id="5138397">&#39;x&#39;</span><span class="op" id="5138400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138404">ch</span>&nbsp;<span class="op" id="5138407">=</span>&nbsp;<span class="ident" id="5138409">s</span><span class="op" id="5138410">.</span><span class="ident" id="5138411">scanDigits</span><span class="op" id="5138421">(</span><span class="ident" id="5138422">s</span><span class="op" id="5138423">.</span><span class="ident" id="5138424">next</span><span class="op" id="5138428">(</span><span class="op" id="5138429">)</span><span class="op" id="5138430">,</span>&nbsp;<span class="num" id="5138432">16</span><span class="op" id="5138434">,</span>&nbsp;<span class="num" id="5138436">2</span><span class="op" id="5138437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138440">case</span>&nbsp;<span class="string" id="5138445">&#39;u&#39;</span><span class="op" id="5138448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138452">ch</span>&nbsp;<span class="op" id="5138455">=</span>&nbsp;<span class="ident" id="5138457">s</span><span class="op" id="5138458">.</span><span class="ident" id="5138459">scanDigits</span><span class="op" id="5138469">(</span><span class="ident" id="5138470">s</span><span class="op" id="5138471">.</span><span class="ident" id="5138472">next</span><span class="op" id="5138476">(</span><span class="op" id="5138477">)</span><span class="op" id="5138478">,</span>&nbsp;<span class="num" id="5138480">16</span><span class="op" id="5138482">,</span>&nbsp;<span class="num" id="5138484">4</span><span class="op" id="5138485">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138488">case</span>&nbsp;<span class="string" id="5138493">&#39;U&#39;</span><span class="op" id="5138496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138500">ch</span>&nbsp;<span class="op" id="5138503">=</span>&nbsp;<span class="ident" id="5138505">s</span><span class="op" id="5138506">.</span><span class="ident" id="5138507">scanDigits</span><span class="op" id="5138517">(</span><span class="ident" id="5138518">s</span><span class="op" id="5138519">.</span><span class="ident" id="5138520">next</span><span class="op" id="5138524">(</span><span class="op" id="5138525">)</span><span class="op" id="5138526">,</span>&nbsp;<span class="num" id="5138528">16</span><span class="op" id="5138530">,</span>&nbsp;<span class="num" id="5138532">8</span><span class="op" id="5138533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138536">default</span><span class="op" id="5138543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138547">s</span><span class="op" id="5138548">.</span><span class="builtintype" id="5138549">error</span><span class="op" id="5138554">(</span><span class="string" id="5138555">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5138576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138579">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138582">return</span>&nbsp;<span class="ident" id="5138589">ch</span><br>
<span class="lineno"></span><span class="op" id="5138592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5138595">func</span>&nbsp;<span class="op" id="5138600">(</span><span class="ident" id="5138601">s</span>&nbsp;<span class="op" id="5138603">*</span><span class="ident" id="5138604">Scanner</span><span class="op" id="5138611">)</span>&nbsp;<span class="ident" id="5138613">scanString</span><span class="op" id="5138623">(</span><span class="ident" id="5138624">quote</span>&nbsp;<span class="builtintype" id="5138630">rune</span><span class="op" id="5138634">)</span>&nbsp;<span class="op" id="5138636">(</span><span class="ident" id="5138637">n</span>&nbsp;<span class="builtintype" id="5138639">int</span><span class="op" id="5138642">)</span>&nbsp;<span class="op" id="5138644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138647">ch</span>&nbsp;<span class="op" id="5138650">:=</span>&nbsp;<span class="ident" id="5138653">s</span><span class="op" id="5138654">.</span><span class="ident" id="5138655">next</span><span class="op" id="5138659">(</span><span class="op" id="5138660">)</span>&nbsp;<span class="comment" id="5138662">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138693">for</span>&nbsp;<span class="ident" id="5138697">ch</span>&nbsp;<span class="op" id="5138700">!=</span>&nbsp;<span class="ident" id="5138703">quote</span>&nbsp;<span class="op" id="5138709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138713">if</span>&nbsp;<span class="ident" id="5138716">ch</span>&nbsp;<span class="op" id="5138719">==</span>&nbsp;<span class="string" id="5138722">&#39;\n&#39;</span>&nbsp;<span class="op" id="5138727">||</span>&nbsp;<span class="ident" id="5138730">ch</span>&nbsp;<span class="op" id="5138733">&lt;</span>&nbsp;<span class="num" id="5138735">0</span>&nbsp;<span class="op" id="5138737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138742">s</span><span class="op" id="5138743">.</span><span class="builtintype" id="5138744">error</span><span class="op" id="5138749">(</span><span class="string" id="5138750">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5138774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138779">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138788">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138792">if</span>&nbsp;<span class="ident" id="5138795">ch</span>&nbsp;<span class="op" id="5138798">==</span>&nbsp;<span class="string" id="5138801">&#39;\\&#39;</span>&nbsp;<span class="op" id="5138806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138811">ch</span>&nbsp;<span class="op" id="5138814">=</span>&nbsp;<span class="ident" id="5138816">s</span><span class="op" id="5138817">.</span><span class="ident" id="5138818">scanEscape</span><span class="op" id="5138828">(</span><span class="ident" id="5138829">quote</span><span class="op" id="5138834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138838">}</span>&nbsp;<span class="keyword" id="5138840">else</span>&nbsp;<span class="op" id="5138845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138850">ch</span>&nbsp;<span class="op" id="5138853">=</span>&nbsp;<span class="ident" id="5138855">s</span><span class="op" id="5138856">.</span><span class="ident" id="5138857">next</span><span class="op" id="5138861">(</span><span class="op" id="5138862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138866">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138870">n</span><span class="op" id="5138871">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5138875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138878">return</span><br>
<span class="lineno"></span><span class="op" id="5138885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5138888">func</span>&nbsp;<span class="op" id="5138893">(</span><span class="ident" id="5138894">s</span>&nbsp;<span class="op" id="5138896">*</span><span class="ident" id="5138897">Scanner</span><span class="op" id="5138904">)</span>&nbsp;<span class="ident" id="5138906">scanRawString</span><span class="op" id="5138919">(</span><span class="op" id="5138920">)</span>&nbsp;<span class="op" id="5138922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138925">ch</span>&nbsp;<span class="op" id="5138928">:=</span>&nbsp;<span class="ident" id="5138931">s</span><span class="op" id="5138932">.</span><span class="ident" id="5138933">next</span><span class="op" id="5138937">(</span><span class="op" id="5138938">)</span>&nbsp;<span class="comment" id="5138940">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138969">for</span>&nbsp;<span class="ident" id="5138973">ch</span>&nbsp;<span class="op" id="5138976">!=</span>&nbsp;<span class="string" id="5138979">&#39;`&#39;</span>&nbsp;<span class="op" id="5138983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5138987">if</span>&nbsp;<span class="ident" id="5138990">ch</span>&nbsp;<span class="op" id="5138993">&lt;</span>&nbsp;<span class="num" id="5138995">0</span>&nbsp;<span class="op" id="5138997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139002">s</span><span class="op" id="5139003">.</span><span class="builtintype" id="5139004">error</span><span class="op" id="5139009">(</span><span class="string" id="5139010">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5139034">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139039">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139052">ch</span>&nbsp;<span class="op" id="5139055">=</span>&nbsp;<span class="ident" id="5139057">s</span><span class="op" id="5139058">.</span><span class="ident" id="5139059">next</span><span class="op" id="5139063">(</span><span class="op" id="5139064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139067">}</span><br>
<span class="lineno"></span><span class="op" id="5139069">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5139072">func</span>&nbsp;<span class="op" id="5139077">(</span><span class="ident" id="5139078">s</span>&nbsp;<span class="op" id="5139080">*</span><span class="ident" id="5139081">Scanner</span><span class="op" id="5139088">)</span>&nbsp;<span class="ident" id="5139090">scanChar</span><span class="op" id="5139098">(</span><span class="op" id="5139099">)</span>&nbsp;<span class="op" id="5139101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139104">if</span>&nbsp;<span class="ident" id="5139107">s</span><span class="op" id="5139108">.</span><span class="ident" id="5139109">scanString</span><span class="op" id="5139119">(</span><span class="string" id="5139120">&#39;\&#39;&#39;</span><span class="op" id="5139124">)</span>&nbsp;<span class="op" id="5139126">!=</span>&nbsp;<span class="num" id="5139129">1</span>&nbsp;<span class="op" id="5139131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139135">s</span><span class="op" id="5139136">.</span><span class="builtintype" id="5139137">error</span><span class="op" id="5139142">(</span><span class="string" id="5139143">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="5139165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139168">}</span><br>
<span class="lineno">515</span><span class="op" id="5139170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5139173">func</span>&nbsp;<span class="op" id="5139178">(</span><span class="ident" id="5139179">s</span>&nbsp;<span class="op" id="5139181">*</span><span class="ident" id="5139182">Scanner</span><span class="op" id="5139189">)</span>&nbsp;<span class="ident" id="5139191">scanComment</span><span class="op" id="5139202">(</span><span class="ident" id="5139203">ch</span>&nbsp;<span class="builtintype" id="5139206">rune</span><span class="op" id="5139210">)</span>&nbsp;<span class="builtintype" id="5139212">rune</span>&nbsp;<span class="op" id="5139217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139220">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139247">if</span>&nbsp;<span class="ident" id="5139250">ch</span>&nbsp;<span class="op" id="5139253">==</span>&nbsp;<span class="string" id="5139256">&#39;/&#39;</span>&nbsp;<span class="op" id="5139260">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139264">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139282">ch</span>&nbsp;<span class="op" id="5139285">=</span>&nbsp;<span class="ident" id="5139287">s</span><span class="op" id="5139288">.</span><span class="ident" id="5139289">next</span><span class="op" id="5139293">(</span><span class="op" id="5139294">)</span>&nbsp;<span class="comment" id="5139296">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139327">for</span>&nbsp;<span class="ident" id="5139331">ch</span>&nbsp;<span class="op" id="5139334">!=</span>&nbsp;<span class="string" id="5139337">&#39;\n&#39;</span>&nbsp;<span class="op" id="5139342">&amp;&amp;</span>&nbsp;<span class="ident" id="5139345">ch</span>&nbsp;<span class="op" id="5139348">&gt;=</span>&nbsp;<span class="num" id="5139351">0</span>&nbsp;<span class="op" id="5139353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139358">ch</span>&nbsp;<span class="op" id="5139361">=</span>&nbsp;<span class="ident" id="5139363">s</span><span class="op" id="5139364">.</span><span class="ident" id="5139365">next</span><span class="op" id="5139369">(</span><span class="op" id="5139370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139374">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139378">return</span>&nbsp;<span class="ident" id="5139385">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139393">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139413">ch</span>&nbsp;<span class="op" id="5139416">=</span>&nbsp;<span class="ident" id="5139418">s</span><span class="op" id="5139419">.</span><span class="ident" id="5139420">next</span><span class="op" id="5139424">(</span><span class="op" id="5139425">)</span>&nbsp;<span class="comment" id="5139427">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139457">for</span>&nbsp;<span class="op" id="5139461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139465">if</span>&nbsp;<span class="ident" id="5139468">ch</span>&nbsp;<span class="op" id="5139471">&lt;</span>&nbsp;<span class="num" id="5139473">0</span>&nbsp;<span class="op" id="5139475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139480">s</span><span class="op" id="5139481">.</span><span class="builtintype" id="5139482">error</span><span class="op" id="5139487">(</span><span class="string" id="5139488">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5139512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139517">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139525">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139529">ch0</span>&nbsp;<span class="op" id="5139533">:=</span>&nbsp;<span class="ident" id="5139536">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139541">ch</span>&nbsp;<span class="op" id="5139544">=</span>&nbsp;<span class="ident" id="5139546">s</span><span class="op" id="5139547">.</span><span class="ident" id="5139548">next</span><span class="op" id="5139552">(</span><span class="op" id="5139553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139557">if</span>&nbsp;<span class="ident" id="5139560">ch0</span>&nbsp;<span class="op" id="5139564">==</span>&nbsp;<span class="string" id="5139567">&#39;*&#39;</span>&nbsp;<span class="op" id="5139571">&amp;&amp;</span>&nbsp;<span class="ident" id="5139574">ch</span>&nbsp;<span class="op" id="5139577">==</span>&nbsp;<span class="string" id="5139580">&#39;/&#39;</span>&nbsp;<span class="op" id="5139584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139589">ch</span>&nbsp;<span class="op" id="5139592">=</span>&nbsp;<span class="ident" id="5139594">s</span><span class="op" id="5139595">.</span><span class="ident" id="5139596">next</span><span class="op" id="5139600">(</span><span class="op" id="5139601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139606">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139620">return</span>&nbsp;<span class="ident" id="5139627">ch</span><br>
<span class="lineno"></span><span class="op" id="5139630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="5139633">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5139711">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5139792">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5139872">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5139950">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="5139975">func</span>&nbsp;<span class="op" id="5139980">(</span><span class="ident" id="5139981">s</span>&nbsp;<span class="op" id="5139983">*</span><span class="ident" id="5139984">Scanner</span><span class="op" id="5139991">)</span>&nbsp;<span class="ident" id="5139993">Scan</span><span class="op" id="5139997">(</span><span class="op" id="5139998">)</span>&nbsp;<span class="builtintype" id="5140000">rune</span>&nbsp;<span class="op" id="5140005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140008">ch</span>&nbsp;<span class="op" id="5140011">:=</span>&nbsp;<span class="ident" id="5140014">s</span><span class="op" id="5140015">.</span><span class="ident" id="5140016">Peek</span><span class="op" id="5140020">(</span><span class="op" id="5140021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140025">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140055">s</span><span class="op" id="5140056">.</span><span class="ident" id="5140057">tokPos</span>&nbsp;<span class="op" id="5140064">=</span>&nbsp;<span class="op" id="5140066">-</span><span class="num" id="5140067">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140070">s</span><span class="op" id="5140071">.</span><span class="ident" id="5140072">Line</span>&nbsp;<span class="op" id="5140077">=</span>&nbsp;<span class="num" id="5140079">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5140082">redo</span><span class="op" id="5140086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140089">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140110">for</span>&nbsp;<span class="ident" id="5140114">s</span><span class="op" id="5140115">.</span><span class="ident" id="5140116">Whitespace</span><span class="op" id="5140126">&amp;</span><span class="op" id="5140127">(</span><span class="num" id="5140128">1</span><span class="op" id="5140129">&lt;&lt;</span><span class="builtintype" id="5140131">uint</span><span class="op" id="5140135">(</span><span class="ident" id="5140136">ch</span><span class="op" id="5140138">)</span><span class="op" id="5140139">)</span>&nbsp;<span class="op" id="5140141">!=</span>&nbsp;<span class="num" id="5140144">0</span>&nbsp;<span class="op" id="5140146">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140150">ch</span>&nbsp;<span class="op" id="5140153">=</span>&nbsp;<span class="ident" id="5140155">s</span><span class="op" id="5140156">.</span><span class="ident" id="5140157">next</span><span class="op" id="5140161">(</span><span class="op" id="5140162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140169">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140201">s</span><span class="op" id="5140202">.</span><span class="ident" id="5140203">tokBuf</span><span class="op" id="5140209">.</span><span class="ident" id="5140210">Reset</span><span class="op" id="5140215">(</span><span class="op" id="5140216">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140219">s</span><span class="op" id="5140220">.</span><span class="ident" id="5140221">tokPos</span>&nbsp;<span class="op" id="5140228">=</span>&nbsp;<span class="ident" id="5140230">s</span><span class="op" id="5140231">.</span><span class="ident" id="5140232">srcPos</span>&nbsp;<span class="op" id="5140239">-</span>&nbsp;<span class="ident" id="5140241">s</span><span class="op" id="5140242">.</span><span class="ident" id="5140243">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140257">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140280">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140344">s</span><span class="op" id="5140345">.</span><span class="ident" id="5140346">Offset</span>&nbsp;<span class="op" id="5140353">=</span>&nbsp;<span class="ident" id="5140355">s</span><span class="op" id="5140356">.</span><span class="ident" id="5140357">srcBufOffset</span>&nbsp;<span class="op" id="5140370">+</span>&nbsp;<span class="ident" id="5140372">s</span><span class="op" id="5140373">.</span><span class="ident" id="5140374">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140382">if</span>&nbsp;<span class="ident" id="5140385">s</span><span class="op" id="5140386">.</span><span class="ident" id="5140387">column</span>&nbsp;<span class="op" id="5140394">&gt;</span>&nbsp;<span class="num" id="5140396">0</span>&nbsp;<span class="op" id="5140398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140402">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140450">s</span><span class="op" id="5140451">.</span><span class="ident" id="5140452">Line</span>&nbsp;<span class="op" id="5140457">=</span>&nbsp;<span class="ident" id="5140459">s</span><span class="op" id="5140460">.</span><span class="ident" id="5140461">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140468">s</span><span class="op" id="5140469">.</span><span class="ident" id="5140470">Column</span>&nbsp;<span class="op" id="5140477">=</span>&nbsp;<span class="ident" id="5140479">s</span><span class="op" id="5140480">.</span><span class="ident" id="5140481">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140489">}</span>&nbsp;<span class="keyword" id="5140491">else</span>&nbsp;<span class="op" id="5140496">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140500">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140531">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140581">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140629">s</span><span class="op" id="5140630">.</span><span class="ident" id="5140631">Line</span>&nbsp;<span class="op" id="5140636">=</span>&nbsp;<span class="ident" id="5140638">s</span><span class="op" id="5140639">.</span><span class="ident" id="5140640">line</span>&nbsp;<span class="op" id="5140645">-</span>&nbsp;<span class="num" id="5140647">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140651">s</span><span class="op" id="5140652">.</span><span class="ident" id="5140653">Column</span>&nbsp;<span class="op" id="5140660">=</span>&nbsp;<span class="ident" id="5140662">s</span><span class="op" id="5140663">.</span><span class="ident" id="5140664">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140681">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140707">tok</span>&nbsp;<span class="op" id="5140711">:=</span>&nbsp;<span class="ident" id="5140714">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140718">switch</span>&nbsp;<span class="op" id="5140725">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140728">case</span>&nbsp;<span class="ident" id="5140733">s</span><span class="op" id="5140734">.</span><span class="ident" id="5140735">isIdentRune</span><span class="op" id="5140746">(</span><span class="ident" id="5140747">ch</span><span class="op" id="5140749">,</span>&nbsp;<span class="num" id="5140751">0</span><span class="op" id="5140752">)</span><span class="op" id="5140753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140757">if</span>&nbsp;<span class="ident" id="5140760">s</span><span class="op" id="5140761">.</span><span class="ident" id="5140762">Mode</span><span class="op" id="5140766">&amp;</span><span class="ident" id="5140767">ScanIdents</span>&nbsp;<span class="op" id="5140778">!=</span>&nbsp;<span class="num" id="5140781">0</span>&nbsp;<span class="op" id="5140783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140788">tok</span>&nbsp;<span class="op" id="5140792">=</span>&nbsp;<span class="ident" id="5140794">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140803">ch</span>&nbsp;<span class="op" id="5140806">=</span>&nbsp;<span class="ident" id="5140808">s</span><span class="op" id="5140809">.</span><span class="ident" id="5140810">scanIdentifier</span><span class="op" id="5140824">(</span><span class="op" id="5140825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140829">}</span>&nbsp;<span class="keyword" id="5140831">else</span>&nbsp;<span class="op" id="5140836">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140841">ch</span>&nbsp;<span class="op" id="5140844">=</span>&nbsp;<span class="ident" id="5140846">s</span><span class="op" id="5140847">.</span><span class="ident" id="5140848">next</span><span class="op" id="5140852">(</span><span class="op" id="5140853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140860">case</span>&nbsp;<span class="ident" id="5140865">isDecimal</span><span class="op" id="5140874">(</span><span class="ident" id="5140875">ch</span><span class="op" id="5140877">)</span><span class="op" id="5140878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140882">if</span>&nbsp;<span class="ident" id="5140885">s</span><span class="op" id="5140886">.</span><span class="ident" id="5140887">Mode</span><span class="op" id="5140891">&amp;</span><span class="op" id="5140892">(</span><span class="ident" id="5140893">ScanInts</span><span class="op" id="5140901">|</span><span class="ident" id="5140902">ScanFloats</span><span class="op" id="5140912">)</span>&nbsp;<span class="op" id="5140914">!=</span>&nbsp;<span class="num" id="5140917">0</span>&nbsp;<span class="op" id="5140919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140924">tok</span><span class="op" id="5140927">,</span>&nbsp;<span class="ident" id="5140929">ch</span>&nbsp;<span class="op" id="5140932">=</span>&nbsp;<span class="ident" id="5140934">s</span><span class="op" id="5140935">.</span><span class="ident" id="5140936">scanNumber</span><span class="op" id="5140946">(</span><span class="ident" id="5140947">ch</span><span class="op" id="5140949">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140953">}</span>&nbsp;<span class="keyword" id="5140955">else</span>&nbsp;<span class="op" id="5140960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140965">ch</span>&nbsp;<span class="op" id="5140968">=</span>&nbsp;<span class="ident" id="5140970">s</span><span class="op" id="5140971">.</span><span class="ident" id="5140972">next</span><span class="op" id="5140976">(</span><span class="op" id="5140977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140984">default</span><span class="op" id="5140991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140995">switch</span>&nbsp;<span class="ident" id="5141002">ch</span>&nbsp;<span class="op" id="5141005">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141009">case</span>&nbsp;<span class="string" id="5141014">&#39;&#34;&#39;</span><span class="op" id="5141017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141022">if</span>&nbsp;<span class="ident" id="5141025">s</span><span class="op" id="5141026">.</span><span class="ident" id="5141027">Mode</span><span class="op" id="5141031">&amp;</span><span class="ident" id="5141032">ScanStrings</span>&nbsp;<span class="op" id="5141044">!=</span>&nbsp;<span class="num" id="5141047">0</span>&nbsp;<span class="op" id="5141049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141055">s</span><span class="op" id="5141056">.</span><span class="ident" id="5141057">scanString</span><span class="op" id="5141067">(</span><span class="string" id="5141068">&#39;&#34;&#39;</span><span class="op" id="5141071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141077">tok</span>&nbsp;<span class="op" id="5141081">=</span>&nbsp;<span class="ident" id="5141083">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141093">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141098">ch</span>&nbsp;<span class="op" id="5141101">=</span>&nbsp;<span class="ident" id="5141103">s</span><span class="op" id="5141104">.</span><span class="ident" id="5141105">next</span><span class="op" id="5141109">(</span><span class="op" id="5141110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141114">case</span>&nbsp;<span class="string" id="5141119">&#39;\&#39;&#39;</span><span class="op" id="5141123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141128">if</span>&nbsp;<span class="ident" id="5141131">s</span><span class="op" id="5141132">.</span><span class="ident" id="5141133">Mode</span><span class="op" id="5141137">&amp;</span><span class="ident" id="5141138">ScanChars</span>&nbsp;<span class="op" id="5141148">!=</span>&nbsp;<span class="num" id="5141151">0</span>&nbsp;<span class="op" id="5141153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141159">s</span><span class="op" id="5141160">.</span><span class="ident" id="5141161">scanChar</span><span class="op" id="5141169">(</span><span class="op" id="5141170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141176">tok</span>&nbsp;<span class="op" id="5141180">=</span>&nbsp;<span class="ident" id="5141182">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141195">ch</span>&nbsp;<span class="op" id="5141198">=</span>&nbsp;<span class="ident" id="5141200">s</span><span class="op" id="5141201">.</span><span class="ident" id="5141202">next</span><span class="op" id="5141206">(</span><span class="op" id="5141207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141211">case</span>&nbsp;<span class="string" id="5141216">&#39;.&#39;</span><span class="op" id="5141219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141224">ch</span>&nbsp;<span class="op" id="5141227">=</span>&nbsp;<span class="ident" id="5141229">s</span><span class="op" id="5141230">.</span><span class="ident" id="5141231">next</span><span class="op" id="5141235">(</span><span class="op" id="5141236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141241">if</span>&nbsp;<span class="ident" id="5141244">isDecimal</span><span class="op" id="5141253">(</span><span class="ident" id="5141254">ch</span><span class="op" id="5141256">)</span>&nbsp;<span class="op" id="5141258">&amp;&amp;</span>&nbsp;<span class="ident" id="5141261">s</span><span class="op" id="5141262">.</span><span class="ident" id="5141263">Mode</span><span class="op" id="5141267">&amp;</span><span class="ident" id="5141268">ScanFloats</span>&nbsp;<span class="op" id="5141279">!=</span>&nbsp;<span class="num" id="5141282">0</span>&nbsp;<span class="op" id="5141284">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141290">tok</span>&nbsp;<span class="op" id="5141294">=</span>&nbsp;<span class="ident" id="5141296">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141306">ch</span>&nbsp;<span class="op" id="5141309">=</span>&nbsp;<span class="ident" id="5141311">s</span><span class="op" id="5141312">.</span><span class="ident" id="5141313">scanMantissa</span><span class="op" id="5141325">(</span><span class="ident" id="5141326">ch</span><span class="op" id="5141328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141334">ch</span>&nbsp;<span class="op" id="5141337">=</span>&nbsp;<span class="ident" id="5141339">s</span><span class="op" id="5141340">.</span><span class="ident" id="5141341">scanExponent</span><span class="op" id="5141353">(</span><span class="ident" id="5141354">ch</span><span class="op" id="5141356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141365">case</span>&nbsp;<span class="string" id="5141370">&#39;/&#39;</span><span class="op" id="5141373">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141378">ch</span>&nbsp;<span class="op" id="5141381">=</span>&nbsp;<span class="ident" id="5141383">s</span><span class="op" id="5141384">.</span><span class="ident" id="5141385">next</span><span class="op" id="5141389">(</span><span class="op" id="5141390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141395">if</span>&nbsp;<span class="op" id="5141398">(</span><span class="ident" id="5141399">ch</span>&nbsp;<span class="op" id="5141402">==</span>&nbsp;<span class="string" id="5141405">&#39;/&#39;</span>&nbsp;<span class="op" id="5141409">||</span>&nbsp;<span class="ident" id="5141412">ch</span>&nbsp;<span class="op" id="5141415">==</span>&nbsp;<span class="string" id="5141418">&#39;*&#39;</span><span class="op" id="5141421">)</span>&nbsp;<span class="op" id="5141423">&amp;&amp;</span>&nbsp;<span class="ident" id="5141426">s</span><span class="op" id="5141427">.</span><span class="ident" id="5141428">Mode</span><span class="op" id="5141432">&amp;</span><span class="ident" id="5141433">ScanComments</span>&nbsp;<span class="op" id="5141446">!=</span>&nbsp;<span class="num" id="5141449">0</span>&nbsp;<span class="op" id="5141451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141457">if</span>&nbsp;<span class="ident" id="5141460">s</span><span class="op" id="5141461">.</span><span class="ident" id="5141462">Mode</span><span class="op" id="5141466">&amp;</span><span class="ident" id="5141467">SkipComments</span>&nbsp;<span class="op" id="5141480">!=</span>&nbsp;<span class="num" id="5141483">0</span>&nbsp;<span class="op" id="5141485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141492">s</span><span class="op" id="5141493">.</span><span class="ident" id="5141494">tokPos</span>&nbsp;<span class="op" id="5141501">=</span>&nbsp;<span class="op" id="5141503">-</span><span class="num" id="5141504">1</span>&nbsp;<span class="comment" id="5141506">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141539">ch</span>&nbsp;<span class="op" id="5141542">=</span>&nbsp;<span class="ident" id="5141544">s</span><span class="op" id="5141545">.</span><span class="ident" id="5141546">scanComment</span><span class="op" id="5141557">(</span><span class="ident" id="5141558">ch</span><span class="op" id="5141560">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141567">goto</span>&nbsp;<span class="ident" id="5141572">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141587">ch</span>&nbsp;<span class="op" id="5141590">=</span>&nbsp;<span class="ident" id="5141592">s</span><span class="op" id="5141593">.</span><span class="ident" id="5141594">scanComment</span><span class="op" id="5141605">(</span><span class="ident" id="5141606">ch</span><span class="op" id="5141608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141614">tok</span>&nbsp;<span class="op" id="5141618">=</span>&nbsp;<span class="ident" id="5141620">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141631">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141635">case</span>&nbsp;<span class="string" id="5141640">&#39;`&#39;</span><span class="op" id="5141643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141648">if</span>&nbsp;<span class="ident" id="5141651">s</span><span class="op" id="5141652">.</span><span class="ident" id="5141653">Mode</span><span class="op" id="5141657">&amp;</span><span class="ident" id="5141658">ScanRawStrings</span>&nbsp;<span class="op" id="5141673">!=</span>&nbsp;<span class="num" id="5141676">0</span>&nbsp;<span class="op" id="5141678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141684">s</span><span class="op" id="5141685">.</span><span class="ident" id="5141686">scanRawString</span><span class="op" id="5141699">(</span><span class="op" id="5141700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141706">tok</span>&nbsp;<span class="op" id="5141710">=</span>&nbsp;<span class="ident" id="5141712">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141722">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141727">ch</span>&nbsp;<span class="op" id="5141730">=</span>&nbsp;<span class="ident" id="5141732">s</span><span class="op" id="5141733">.</span><span class="ident" id="5141734">next</span><span class="op" id="5141738">(</span><span class="op" id="5141739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141743">default</span><span class="op" id="5141750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141755">ch</span>&nbsp;<span class="op" id="5141758">=</span>&nbsp;<span class="ident" id="5141760">s</span><span class="op" id="5141761">.</span><span class="ident" id="5141762">next</span><span class="op" id="5141766">(</span><span class="op" id="5141767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141774">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141778">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141800">s</span><span class="op" id="5141801">.</span><span class="ident" id="5141802">tokEnd</span>&nbsp;<span class="op" id="5141809">=</span>&nbsp;<span class="ident" id="5141811">s</span><span class="op" id="5141812">.</span><span class="ident" id="5141813">srcPos</span>&nbsp;<span class="op" id="5141820">-</span>&nbsp;<span class="ident" id="5141822">s</span><span class="op" id="5141823">.</span><span class="ident" id="5141824">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141838">s</span><span class="op" id="5141839">.</span><span class="ident" id="5141840">ch</span>&nbsp;<span class="op" id="5141843">=</span>&nbsp;<span class="ident" id="5141845">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141849">return</span>&nbsp;<span class="ident" id="5141856">tok</span><br>
<span class="lineno"></span><span class="op" id="5141860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5141863">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="5141926">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="5141995">func</span>&nbsp;<span class="op" id="5142000">(</span><span class="ident" id="5142001">s</span>&nbsp;<span class="op" id="5142003">*</span><span class="ident" id="5142004">Scanner</span><span class="op" id="5142011">)</span>&nbsp;<span class="ident" id="5142013">Pos</span><span class="op" id="5142016">(</span><span class="op" id="5142017">)</span>&nbsp;<span class="op" id="5142019">(</span><span class="ident" id="5142020">pos</span>&nbsp;<span class="ident" id="5142024">Position</span><span class="op" id="5142032">)</span>&nbsp;<span class="op" id="5142034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142037">pos</span><span class="op" id="5142040">.</span><span class="ident" id="5142041">Filename</span>&nbsp;<span class="op" id="5142050">=</span>&nbsp;<span class="ident" id="5142052">s</span><span class="op" id="5142053">.</span><span class="ident" id="5142054">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142064">pos</span><span class="op" id="5142067">.</span><span class="ident" id="5142068">Offset</span>&nbsp;<span class="op" id="5142075">=</span>&nbsp;<span class="ident" id="5142077">s</span><span class="op" id="5142078">.</span><span class="ident" id="5142079">srcBufOffset</span>&nbsp;<span class="op" id="5142092">+</span>&nbsp;<span class="ident" id="5142094">s</span><span class="op" id="5142095">.</span><span class="ident" id="5142096">srcPos</span>&nbsp;<span class="op" id="5142103">-</span>&nbsp;<span class="ident" id="5142105">s</span><span class="op" id="5142106">.</span><span class="ident" id="5142107">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142120">switch</span>&nbsp;<span class="op" id="5142127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142130">case</span>&nbsp;<span class="ident" id="5142135">s</span><span class="op" id="5142136">.</span><span class="ident" id="5142137">column</span>&nbsp;<span class="op" id="5142144">&gt;</span>&nbsp;<span class="num" id="5142146">0</span><span class="op" id="5142147">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142151">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142199">pos</span><span class="op" id="5142202">.</span><span class="ident" id="5142203">Line</span>&nbsp;<span class="op" id="5142208">=</span>&nbsp;<span class="ident" id="5142210">s</span><span class="op" id="5142211">.</span><span class="ident" id="5142212">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142219">pos</span><span class="op" id="5142222">.</span><span class="ident" id="5142223">Column</span>&nbsp;<span class="op" id="5142230">=</span>&nbsp;<span class="ident" id="5142232">s</span><span class="op" id="5142233">.</span><span class="ident" id="5142234">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142242">case</span>&nbsp;<span class="ident" id="5142247">s</span><span class="op" id="5142248">.</span><span class="ident" id="5142249">lastLineLen</span>&nbsp;<span class="op" id="5142261">&gt;</span>&nbsp;<span class="num" id="5142263">0</span><span class="op" id="5142264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142268">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142299">pos</span><span class="op" id="5142302">.</span><span class="ident" id="5142303">Line</span>&nbsp;<span class="op" id="5142308">=</span>&nbsp;<span class="ident" id="5142310">s</span><span class="op" id="5142311">.</span><span class="ident" id="5142312">line</span>&nbsp;<span class="op" id="5142317">-</span>&nbsp;<span class="num" id="5142319">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142323">pos</span><span class="op" id="5142326">.</span><span class="ident" id="5142327">Column</span>&nbsp;<span class="op" id="5142334">=</span>&nbsp;<span class="ident" id="5142336">s</span><span class="op" id="5142337">.</span><span class="ident" id="5142338">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142351">default</span><span class="op" id="5142358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142362">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142398">pos</span><span class="op" id="5142401">.</span><span class="ident" id="5142402">Line</span>&nbsp;<span class="op" id="5142407">=</span>&nbsp;<span class="num" id="5142409">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142413">pos</span><span class="op" id="5142416">.</span><span class="ident" id="5142417">Column</span>&nbsp;<span class="op" id="5142424">=</span>&nbsp;<span class="num" id="5142426">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142432">return</span><br>
<span class="lineno"></span><span class="op" id="5142439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5142442">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="5142524">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="5142555">func</span>&nbsp;<span class="op" id="5142560">(</span><span class="ident" id="5142561">s</span>&nbsp;<span class="op" id="5142563">*</span><span class="ident" id="5142564">Scanner</span><span class="op" id="5142571">)</span>&nbsp;<span class="ident" id="5142573">TokenText</span><span class="op" id="5142582">(</span><span class="op" id="5142583">)</span>&nbsp;<span class="builtintype" id="5142585">string</span>&nbsp;<span class="op" id="5142592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142595">if</span>&nbsp;<span class="ident" id="5142598">s</span><span class="op" id="5142599">.</span><span class="ident" id="5142600">tokPos</span>&nbsp;<span class="op" id="5142607">&lt;</span>&nbsp;<span class="num" id="5142609">0</span>&nbsp;<span class="op" id="5142611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142615">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142634">return</span>&nbsp;<span class="string" id="5142641">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142649">if</span>&nbsp;<span class="ident" id="5142652">s</span><span class="op" id="5142653">.</span><span class="ident" id="5142654">tokEnd</span>&nbsp;<span class="op" id="5142661">&lt;</span>&nbsp;<span class="num" id="5142663">0</span>&nbsp;<span class="op" id="5142665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142669">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142732">s</span><span class="op" id="5142733">.</span><span class="ident" id="5142734">tokEnd</span>&nbsp;<span class="op" id="5142741">=</span>&nbsp;<span class="ident" id="5142743">s</span><span class="op" id="5142744">.</span><span class="ident" id="5142745">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142757">if</span>&nbsp;<span class="ident" id="5142760">s</span><span class="op" id="5142761">.</span><span class="ident" id="5142762">tokBuf</span><span class="op" id="5142768">.</span><span class="ident" id="5142769">Len</span><span class="op" id="5142772">(</span><span class="op" id="5142773">)</span>&nbsp;<span class="op" id="5142775">==</span>&nbsp;<span class="num" id="5142778">0</span>&nbsp;<span class="op" id="5142780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142784">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142843">return</span>&nbsp;<span class="builtintype" id="5142850">string</span><span class="op" id="5142856">(</span><span class="ident" id="5142857">s</span><span class="op" id="5142858">.</span><span class="ident" id="5142859">srcBuf</span><span class="op" id="5142865">[</span><span class="ident" id="5142866">s</span><span class="op" id="5142867">.</span><span class="ident" id="5142868">tokPos</span><span class="op" id="5142874">:</span><span class="ident" id="5142875">s</span><span class="op" id="5142876">.</span><span class="ident" id="5142877">tokEnd</span><span class="op" id="5142883">]</span><span class="op" id="5142884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142891">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142956">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142998">s</span><span class="op" id="5142999">.</span><span class="ident" id="5143000">tokBuf</span><span class="op" id="5143006">.</span><span class="ident" id="5143007">Write</span><span class="op" id="5143012">(</span><span class="ident" id="5143013">s</span><span class="op" id="5143014">.</span><span class="ident" id="5143015">srcBuf</span><span class="op" id="5143021">[</span><span class="ident" id="5143022">s</span><span class="op" id="5143023">.</span><span class="ident" id="5143024">tokPos</span><span class="op" id="5143030">:</span><span class="ident" id="5143031">s</span><span class="op" id="5143032">.</span><span class="ident" id="5143033">tokEnd</span><span class="op" id="5143039">]</span><span class="op" id="5143040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143043">s</span><span class="op" id="5143044">.</span><span class="ident" id="5143045">tokPos</span>&nbsp;<span class="op" id="5143052">=</span>&nbsp;<span class="ident" id="5143054">s</span><span class="op" id="5143055">.</span><span class="ident" id="5143056">tokEnd</span>&nbsp;<span class="comment" id="5143063">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143106">return</span>&nbsp;<span class="ident" id="5143113">s</span><span class="op" id="5143114">.</span><span class="ident" id="5143115">tokBuf</span><span class="op" id="5143121">.</span><span class="ident" id="5143122">String</span><span class="op" id="5143128">(</span><span class="op" id="5143129">)</span><br>
<span class="lineno"></span><span class="op" id="5143131">}</span>
</div>
</body>
</html>
