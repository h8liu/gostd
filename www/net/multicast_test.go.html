<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6868286">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6868341">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6868395">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6868446">package</span>&nbsp;<span class="ident" id="6868454">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6868459">import</span>&nbsp;<span class="op" id="6868466">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6868469">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6868476">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6868482">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6868493">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6868503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6868506">var</span>&nbsp;<span class="ident" id="6868510">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="6868537">=</span>&nbsp;<span class="op" id="6868539">[</span><span class="op" id="6868540">]</span><span class="keyword" id="6868541">struct</span>&nbsp;<span class="op" id="6868548">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868551">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6868557">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868565">gaddr</span>&nbsp;<span class="op" id="6868571">*</span><span class="ident" id="6868572"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span>&nbsp;<span class="comment" id="6868580">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6868596">}</span><span class="op" id="6868597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868600">{</span><span class="string" id="6868601">&#34;udp&#34;</span><span class="op" id="6868606">,</span>&nbsp;<span class="op" id="6868608">&amp;</span><span class="ident" id="6868609"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6868616">{</span><span class="ident" id="6868617">IP</span><span class="op" id="6868619">:</span>&nbsp;<span class="ident" id="6868621"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6868625">(</span><span class="num" id="6868626">224</span><span class="op" id="6868629">,</span>&nbsp;<span class="num" id="6868631">0</span><span class="op" id="6868632">,</span>&nbsp;<span class="num" id="6868634">0</span><span class="op" id="6868635">,</span>&nbsp;<span class="num" id="6868637">254</span><span class="op" id="6868640">)</span><span class="op" id="6868641">,</span>&nbsp;<span class="ident" id="6868643">Port</span><span class="op" id="6868647">:</span>&nbsp;<span class="num" id="6868649">12345</span><span class="op" id="6868654">}</span><span class="op" id="6868655">}</span><span class="op" id="6868656">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868660">{</span><span class="string" id="6868661">&#34;udp4&#34;</span><span class="op" id="6868667">,</span>&nbsp;<span class="op" id="6868669">&amp;</span><span class="ident" id="6868670"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6868677">{</span><span class="ident" id="6868678">IP</span><span class="op" id="6868680">:</span>&nbsp;<span class="ident" id="6868682"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="6868686">(</span><span class="num" id="6868687">224</span><span class="op" id="6868690">,</span>&nbsp;<span class="num" id="6868692">0</span><span class="op" id="6868693">,</span>&nbsp;<span class="num" id="6868695">0</span><span class="op" id="6868696">,</span>&nbsp;<span class="num" id="6868698">254</span><span class="op" id="6868701">)</span><span class="op" id="6868702">,</span>&nbsp;<span class="ident" id="6868704">Port</span><span class="op" id="6868708">:</span>&nbsp;<span class="num" id="6868710">12345</span><span class="op" id="6868715">}</span><span class="op" id="6868716">}</span><span class="op" id="6868717">,</span><br>
<span class="lineno"></span><span class="op" id="6868719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6868722">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6868792">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="6868863">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6868872">func</span>&nbsp;<span class="ident" id="6868877">TestIPv4MulticastListener</span><span class="op" id="6868902">(</span><span class="ident" id="6868903">t</span>&nbsp;<span class="op" id="6868905">*</span><span class="ident" id="6868906"><a href="/net/multicast_test.go.html#6868493">testing</a></span><span class="op" id="6868913">.</span><span class="ident" id="6868914">T</span><span class="op" id="6868915">)</span>&nbsp;<span class="op" id="6868917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868920">switch</span>&nbsp;<span class="ident" id="6868927"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6868934">.</span><span class="ident" id="6868935">GOOS</span>&nbsp;<span class="op" id="6868940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868943">case</span>&nbsp;<span class="string" id="6868948">&#34;android&#34;</span><span class="op" id="6868957">,</span>&nbsp;<span class="string" id="6868959">&#34;nacl&#34;</span><span class="op" id="6868965">,</span>&nbsp;<span class="string" id="6868967">&#34;plan9&#34;</span><span class="op" id="6868974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868978"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6868979">.</span><span class="ident" id="6868980">Skipf</span><span class="op" id="6868985">(</span><span class="string" id="6868986">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6869007">,</span>&nbsp;<span class="ident" id="6869009"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6869016">.</span><span class="ident" id="6869017">GOOS</span><span class="op" id="6869021">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869024">case</span>&nbsp;<span class="string" id="6869029">&#34;solaris&#34;</span><span class="op" id="6869038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869042"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6869043">.</span><span class="ident" id="6869044">Skipf</span><span class="op" id="6869049">(</span><span class="string" id="6869050">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6869092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869099">closer</span>&nbsp;<span class="op" id="6869106">:=</span>&nbsp;<span class="keyword" id="6869109">func</span><span class="op" id="6869113">(</span><span class="ident" id="6869114">cs</span>&nbsp;<span class="op" id="6869117">[</span><span class="op" id="6869118">]</span><span class="op" id="6869119">*</span><span class="ident" id="6869120"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6869127">)</span>&nbsp;<span class="op" id="6869129">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869133">for</span>&nbsp;<span class="ident" id="6869137">_</span><span class="op" id="6869138">,</span>&nbsp;<span class="ident" id="6869140">c</span>&nbsp;<span class="op" id="6869142">:=</span>&nbsp;<span class="keyword" id="6869145">range</span>&nbsp;<span class="ident" id="6869151"><a href="/net/multicast_test.go.html#6869114">cs</a></span>&nbsp;<span class="op" id="6869154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869159">if</span>&nbsp;<span class="ident" id="6869162"><a href="/net/multicast_test.go.html#6869140">c</a></span>&nbsp;<span class="op" id="6869164">!=</span>&nbsp;<span class="ident" id="6869167">nil</span>&nbsp;<span class="op" id="6869171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869177"><a href="/net/multicast_test.go.html#6869140">c</a></span><span class="op" id="6869178">.</span><span class="ident" id="6869179">Close</span><span class="op" id="6869184">(</span><span class="op" id="6869185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869194">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869201">for</span>&nbsp;<span class="ident" id="6869205">_</span><span class="op" id="6869206">,</span>&nbsp;<span class="ident" id="6869208">ifi</span>&nbsp;<span class="op" id="6869212">:=</span>&nbsp;<span class="keyword" id="6869215">range</span>&nbsp;<span class="op" id="6869221">[</span><span class="op" id="6869222">]</span><span class="op" id="6869223">*</span><span class="ident" id="6869224"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="6869233">{</span><span class="ident" id="6869234"><a href="/net/interface_test.go.html#6819206">loopbackInterface</a></span><span class="op" id="6869251">(</span><span class="op" id="6869252">)</span><span class="op" id="6869253">,</span>&nbsp;<span class="ident" id="6869255">nil</span><span class="op" id="6869258">}</span>&nbsp;<span class="op" id="6869260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6869264">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6869320">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6869373">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6869423">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6869475">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869493">if</span>&nbsp;<span class="ident" id="6869496"><a href="/net/multicast_test.go.html#6869208">ifi</a></span>&nbsp;<span class="op" id="6869500">==</span>&nbsp;<span class="ident" id="6869503">nil</span>&nbsp;<span class="op" id="6869507">&amp;&amp;</span>&nbsp;<span class="op" id="6869510">!</span><span class="op" id="6869511">*</span><span class="ident" id="6869512"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span>&nbsp;<span class="op" id="6869525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869530">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869545">for</span>&nbsp;<span class="ident" id="6869549">_</span><span class="op" id="6869550">,</span>&nbsp;<span class="ident" id="6869552">tt</span>&nbsp;<span class="op" id="6869555">:=</span>&nbsp;<span class="keyword" id="6869558">range</span>&nbsp;<span class="ident" id="6869564"><a href="/net/multicast_test.go.html#6868510">ipv4MulticastListenerTests</a></span>&nbsp;<span class="op" id="6869591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869596">var</span>&nbsp;<span class="ident" id="6869600">err</span>&nbsp;<span class="builtintype" id="6869604">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869613">cs</span>&nbsp;<span class="op" id="6869616">:=</span>&nbsp;<span class="builtinfunc" id="6869619">make</span><span class="op" id="6869623">(</span><span class="op" id="6869624">[</span><span class="op" id="6869625">]</span><span class="op" id="6869626">*</span><span class="ident" id="6869627"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6869634">,</span>&nbsp;<span class="num" id="6869636">2</span><span class="op" id="6869637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869642">if</span>&nbsp;<span class="ident" id="6869645"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6869647">[</span><span class="num" id="6869648">0</span><span class="op" id="6869649">]</span><span class="op" id="6869650">,</span>&nbsp;<span class="ident" id="6869652"><a href="/net/multicast_test.go.html#6869600">err</a></span>&nbsp;<span class="op" id="6869656">=</span>&nbsp;<span class="ident" id="6869658"><a href="/net/udpsock_posix.go.html#2711683">ListenMulticastUDP</a></span><span class="op" id="6869676">(</span><span class="ident" id="6869677"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6869679">.</span><span class="ident" id="6869680">net</span><span class="op" id="6869683">,</span>&nbsp;<span class="ident" id="6869685"><a href="/net/multicast_test.go.html#6869208">ifi</a></span><span class="op" id="6869688">,</span>&nbsp;<span class="ident" id="6869690"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6869692">.</span><span class="ident" id="6869693">gaddr</span><span class="op" id="6869698">)</span><span class="op" id="6869699">;</span>&nbsp;<span class="ident" id="6869701"><a href="/net/multicast_test.go.html#6869600">err</a></span>&nbsp;<span class="op" id="6869705">!=</span>&nbsp;<span class="ident" id="6869708">nil</span>&nbsp;<span class="op" id="6869712">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869718"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6869719">.</span><span class="ident" id="6869720">Fatalf</span><span class="op" id="6869726">(</span><span class="string" id="6869727">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6869770">,</span>&nbsp;<span class="ident" id="6869772"><a href="/net/multicast_test.go.html#6869208">ifi</a></span><span class="op" id="6869775">,</span>&nbsp;<span class="ident" id="6869777"><a href="/net/multicast_test.go.html#6869600">err</a></span><span class="op" id="6869780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869790">if</span>&nbsp;<span class="ident" id="6869793">err</span>&nbsp;<span class="op" id="6869797">:=</span>&nbsp;<span class="ident" id="6869800"><a href="/net/multicast_test.go.html#6872592">checkMulticastListener</a></span><span class="op" id="6869822">(</span><span class="ident" id="6869823"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6869825">[</span><span class="num" id="6869826">0</span><span class="op" id="6869827">]</span><span class="op" id="6869828">,</span>&nbsp;<span class="ident" id="6869830"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6869832">.</span><span class="ident" id="6869833">gaddr</span><span class="op" id="6869838">.</span><span class="ident" id="6869839">IP</span><span class="op" id="6869841">)</span><span class="op" id="6869842">;</span>&nbsp;<span class="ident" id="6869844"><a href="/net/multicast_test.go.html#6869793">err</a></span>&nbsp;<span class="op" id="6869848">!=</span>&nbsp;<span class="ident" id="6869851">nil</span>&nbsp;<span class="op" id="6869855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869861"><a href="/net/multicast_test.go.html#6869099">closer</a></span><span class="op" id="6869867">(</span><span class="ident" id="6869868"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6869870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869876"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6869877">.</span><span class="ident" id="6869878">Fatal</span><span class="op" id="6869883">(</span><span class="ident" id="6869884"><a href="/net/multicast_test.go.html#6869793">err</a></span><span class="op" id="6869887">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869897">if</span>&nbsp;<span class="ident" id="6869900"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6869902">[</span><span class="num" id="6869903">1</span><span class="op" id="6869904">]</span><span class="op" id="6869905">,</span>&nbsp;<span class="ident" id="6869907"><a href="/net/multicast_test.go.html#6869600">err</a></span>&nbsp;<span class="op" id="6869911">=</span>&nbsp;<span class="ident" id="6869913"><a href="/net/udpsock_posix.go.html#2711683">ListenMulticastUDP</a></span><span class="op" id="6869931">(</span><span class="ident" id="6869932"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6869934">.</span><span class="ident" id="6869935">net</span><span class="op" id="6869938">,</span>&nbsp;<span class="ident" id="6869940"><a href="/net/multicast_test.go.html#6869208">ifi</a></span><span class="op" id="6869943">,</span>&nbsp;<span class="ident" id="6869945"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6869947">.</span><span class="ident" id="6869948">gaddr</span><span class="op" id="6869953">)</span><span class="op" id="6869954">;</span>&nbsp;<span class="ident" id="6869956"><a href="/net/multicast_test.go.html#6869600">err</a></span>&nbsp;<span class="op" id="6869960">!=</span>&nbsp;<span class="ident" id="6869963">nil</span>&nbsp;<span class="op" id="6869967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869973"><a href="/net/multicast_test.go.html#6869099">closer</a></span><span class="op" id="6869979">(</span><span class="ident" id="6869980"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6869982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869988"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6869989">.</span><span class="ident" id="6869990">Fatalf</span><span class="op" id="6869996">(</span><span class="string" id="6869997">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6870041">,</span>&nbsp;<span class="ident" id="6870043"><a href="/net/multicast_test.go.html#6869208">ifi</a></span><span class="op" id="6870046">,</span>&nbsp;<span class="ident" id="6870048"><a href="/net/multicast_test.go.html#6869600">err</a></span><span class="op" id="6870051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870056">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870061">if</span>&nbsp;<span class="ident" id="6870064">err</span>&nbsp;<span class="op" id="6870068">:=</span>&nbsp;<span class="ident" id="6870071"><a href="/net/multicast_test.go.html#6872592">checkMulticastListener</a></span><span class="op" id="6870093">(</span><span class="ident" id="6870094"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6870096">[</span><span class="num" id="6870097">1</span><span class="op" id="6870098">]</span><span class="op" id="6870099">,</span>&nbsp;<span class="ident" id="6870101"><a href="/net/multicast_test.go.html#6869552">tt</a></span><span class="op" id="6870103">.</span><span class="ident" id="6870104">gaddr</span><span class="op" id="6870109">.</span><span class="ident" id="6870110">IP</span><span class="op" id="6870112">)</span><span class="op" id="6870113">;</span>&nbsp;<span class="ident" id="6870115"><a href="/net/multicast_test.go.html#6870064">err</a></span>&nbsp;<span class="op" id="6870119">!=</span>&nbsp;<span class="ident" id="6870122">nil</span>&nbsp;<span class="op" id="6870126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870132"><a href="/net/multicast_test.go.html#6869099">closer</a></span><span class="op" id="6870138">(</span><span class="ident" id="6870139"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6870141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870147"><a href="/net/multicast_test.go.html#6868903">t</a></span><span class="op" id="6870148">.</span><span class="ident" id="6870149">Fatal</span><span class="op" id="6870154">(</span><span class="ident" id="6870155"><a href="/net/multicast_test.go.html#6870064">err</a></span><span class="op" id="6870158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870168"><a href="/net/multicast_test.go.html#6869099">closer</a></span><span class="op" id="6870174">(</span><span class="ident" id="6870175"><a href="/net/multicast_test.go.html#6869613">cs</a></span><span class="op" id="6870177">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870184">}</span><br>
<span class="lineno"></span><span class="op" id="6870186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6870189">var</span>&nbsp;<span class="ident" id="6870193">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="6870220">=</span>&nbsp;<span class="op" id="6870222">[</span><span class="op" id="6870223">]</span><span class="keyword" id="6870224">struct</span>&nbsp;<span class="op" id="6870231">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870234">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6870240">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870248">gaddr</span>&nbsp;<span class="op" id="6870254">*</span><span class="ident" id="6870255"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span>&nbsp;<span class="comment" id="6870263">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6870279">}</span><span class="op" id="6870280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870283">{</span><span class="string" id="6870284">&#34;udp&#34;</span><span class="op" id="6870289">,</span>&nbsp;<span class="op" id="6870291">&amp;</span><span class="ident" id="6870292"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870299">{</span><span class="ident" id="6870300">IP</span><span class="op" id="6870302">:</span>&nbsp;<span class="ident" id="6870304"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870311">(</span><span class="string" id="6870312">&#34;ff01::114&#34;</span><span class="op" id="6870323">)</span><span class="op" id="6870324">,</span>&nbsp;<span class="ident" id="6870326">Port</span><span class="op" id="6870330">:</span>&nbsp;<span class="num" id="6870332">12345</span><span class="op" id="6870337">}</span><span class="op" id="6870338">}</span><span class="op" id="6870339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870342">{</span><span class="string" id="6870343">&#34;udp&#34;</span><span class="op" id="6870348">,</span>&nbsp;<span class="op" id="6870350">&amp;</span><span class="ident" id="6870351"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870358">{</span><span class="ident" id="6870359">IP</span><span class="op" id="6870361">:</span>&nbsp;<span class="ident" id="6870363"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870370">(</span><span class="string" id="6870371">&#34;ff02::114&#34;</span><span class="op" id="6870382">)</span><span class="op" id="6870383">,</span>&nbsp;<span class="ident" id="6870385">Port</span><span class="op" id="6870389">:</span>&nbsp;<span class="num" id="6870391">12345</span><span class="op" id="6870396">}</span><span class="op" id="6870397">}</span><span class="op" id="6870398">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870401">{</span><span class="string" id="6870402">&#34;udp&#34;</span><span class="op" id="6870407">,</span>&nbsp;<span class="op" id="6870409">&amp;</span><span class="ident" id="6870410"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870417">{</span><span class="ident" id="6870418">IP</span><span class="op" id="6870420">:</span>&nbsp;<span class="ident" id="6870422"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870429">(</span><span class="string" id="6870430">&#34;ff04::114&#34;</span><span class="op" id="6870441">)</span><span class="op" id="6870442">,</span>&nbsp;<span class="ident" id="6870444">Port</span><span class="op" id="6870448">:</span>&nbsp;<span class="num" id="6870450">12345</span><span class="op" id="6870455">}</span><span class="op" id="6870456">}</span><span class="op" id="6870457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870460">{</span><span class="string" id="6870461">&#34;udp&#34;</span><span class="op" id="6870466">,</span>&nbsp;<span class="op" id="6870468">&amp;</span><span class="ident" id="6870469"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870476">{</span><span class="ident" id="6870477">IP</span><span class="op" id="6870479">:</span>&nbsp;<span class="ident" id="6870481"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870488">(</span><span class="string" id="6870489">&#34;ff05::114&#34;</span><span class="op" id="6870500">)</span><span class="op" id="6870501">,</span>&nbsp;<span class="ident" id="6870503">Port</span><span class="op" id="6870507">:</span>&nbsp;<span class="num" id="6870509">12345</span><span class="op" id="6870514">}</span><span class="op" id="6870515">}</span><span class="op" id="6870516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870519">{</span><span class="string" id="6870520">&#34;udp&#34;</span><span class="op" id="6870525">,</span>&nbsp;<span class="op" id="6870527">&amp;</span><span class="ident" id="6870528"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870535">{</span><span class="ident" id="6870536">IP</span><span class="op" id="6870538">:</span>&nbsp;<span class="ident" id="6870540"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870547">(</span><span class="string" id="6870548">&#34;ff08::114&#34;</span><span class="op" id="6870559">)</span><span class="op" id="6870560">,</span>&nbsp;<span class="ident" id="6870562">Port</span><span class="op" id="6870566">:</span>&nbsp;<span class="num" id="6870568">12345</span><span class="op" id="6870573">}</span><span class="op" id="6870574">}</span><span class="op" id="6870575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870578">{</span><span class="string" id="6870579">&#34;udp&#34;</span><span class="op" id="6870584">,</span>&nbsp;<span class="op" id="6870586">&amp;</span><span class="ident" id="6870587"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870594">{</span><span class="ident" id="6870595">IP</span><span class="op" id="6870597">:</span>&nbsp;<span class="ident" id="6870599"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870606">(</span><span class="string" id="6870607">&#34;ff0e::114&#34;</span><span class="op" id="6870618">)</span><span class="op" id="6870619">,</span>&nbsp;<span class="ident" id="6870621">Port</span><span class="op" id="6870625">:</span>&nbsp;<span class="num" id="6870627">12345</span><span class="op" id="6870632">}</span><span class="op" id="6870633">}</span><span class="op" id="6870634">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870638">{</span><span class="string" id="6870639">&#34;udp6&#34;</span><span class="op" id="6870645">,</span>&nbsp;<span class="op" id="6870647">&amp;</span><span class="ident" id="6870648"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870655">{</span><span class="ident" id="6870656">IP</span><span class="op" id="6870658">:</span>&nbsp;<span class="ident" id="6870660"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870667">(</span><span class="string" id="6870668">&#34;ff01::114&#34;</span><span class="op" id="6870679">)</span><span class="op" id="6870680">,</span>&nbsp;<span class="ident" id="6870682">Port</span><span class="op" id="6870686">:</span>&nbsp;<span class="num" id="6870688">12345</span><span class="op" id="6870693">}</span><span class="op" id="6870694">}</span><span class="op" id="6870695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870698">{</span><span class="string" id="6870699">&#34;udp6&#34;</span><span class="op" id="6870705">,</span>&nbsp;<span class="op" id="6870707">&amp;</span><span class="ident" id="6870708"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870715">{</span><span class="ident" id="6870716">IP</span><span class="op" id="6870718">:</span>&nbsp;<span class="ident" id="6870720"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870727">(</span><span class="string" id="6870728">&#34;ff02::114&#34;</span><span class="op" id="6870739">)</span><span class="op" id="6870740">,</span>&nbsp;<span class="ident" id="6870742">Port</span><span class="op" id="6870746">:</span>&nbsp;<span class="num" id="6870748">12345</span><span class="op" id="6870753">}</span><span class="op" id="6870754">}</span><span class="op" id="6870755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870758">{</span><span class="string" id="6870759">&#34;udp6&#34;</span><span class="op" id="6870765">,</span>&nbsp;<span class="op" id="6870767">&amp;</span><span class="ident" id="6870768"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870775">{</span><span class="ident" id="6870776">IP</span><span class="op" id="6870778">:</span>&nbsp;<span class="ident" id="6870780"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870787">(</span><span class="string" id="6870788">&#34;ff04::114&#34;</span><span class="op" id="6870799">)</span><span class="op" id="6870800">,</span>&nbsp;<span class="ident" id="6870802">Port</span><span class="op" id="6870806">:</span>&nbsp;<span class="num" id="6870808">12345</span><span class="op" id="6870813">}</span><span class="op" id="6870814">}</span><span class="op" id="6870815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870818">{</span><span class="string" id="6870819">&#34;udp6&#34;</span><span class="op" id="6870825">,</span>&nbsp;<span class="op" id="6870827">&amp;</span><span class="ident" id="6870828"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870835">{</span><span class="ident" id="6870836">IP</span><span class="op" id="6870838">:</span>&nbsp;<span class="ident" id="6870840"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870847">(</span><span class="string" id="6870848">&#34;ff05::114&#34;</span><span class="op" id="6870859">)</span><span class="op" id="6870860">,</span>&nbsp;<span class="ident" id="6870862">Port</span><span class="op" id="6870866">:</span>&nbsp;<span class="num" id="6870868">12345</span><span class="op" id="6870873">}</span><span class="op" id="6870874">}</span><span class="op" id="6870875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870878">{</span><span class="string" id="6870879">&#34;udp6&#34;</span><span class="op" id="6870885">,</span>&nbsp;<span class="op" id="6870887">&amp;</span><span class="ident" id="6870888"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870895">{</span><span class="ident" id="6870896">IP</span><span class="op" id="6870898">:</span>&nbsp;<span class="ident" id="6870900"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870907">(</span><span class="string" id="6870908">&#34;ff08::114&#34;</span><span class="op" id="6870919">)</span><span class="op" id="6870920">,</span>&nbsp;<span class="ident" id="6870922">Port</span><span class="op" id="6870926">:</span>&nbsp;<span class="num" id="6870928">12345</span><span class="op" id="6870933">}</span><span class="op" id="6870934">}</span><span class="op" id="6870935">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870938">{</span><span class="string" id="6870939">&#34;udp6&#34;</span><span class="op" id="6870945">,</span>&nbsp;<span class="op" id="6870947">&amp;</span><span class="ident" id="6870948"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6870955">{</span><span class="ident" id="6870956">IP</span><span class="op" id="6870958">:</span>&nbsp;<span class="ident" id="6870960"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="6870967">(</span><span class="string" id="6870968">&#34;ff0e::114&#34;</span><span class="op" id="6870979">)</span><span class="op" id="6870980">,</span>&nbsp;<span class="ident" id="6870982">Port</span><span class="op" id="6870986">:</span>&nbsp;<span class="num" id="6870988">12345</span><span class="op" id="6870993">}</span><span class="op" id="6870994">}</span><span class="op" id="6870995">,</span><br>
<span class="lineno"></span><span class="op" id="6870997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6871000">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6871070">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="6871141">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6871150">func</span>&nbsp;<span class="ident" id="6871155">TestIPv6MulticastListener</span><span class="op" id="6871180">(</span><span class="ident" id="6871181">t</span>&nbsp;<span class="op" id="6871183">*</span><span class="ident" id="6871184"><a href="/net/multicast_test.go.html#6868493">testing</a></span><span class="op" id="6871191">.</span><span class="ident" id="6871192">T</span><span class="op" id="6871193">)</span>&nbsp;<span class="op" id="6871195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871198">switch</span>&nbsp;<span class="ident" id="6871205"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6871212">.</span><span class="ident" id="6871213">GOOS</span>&nbsp;<span class="op" id="6871218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871221">case</span>&nbsp;<span class="string" id="6871226">&#34;plan9&#34;</span><span class="op" id="6871233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871237"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6871238">.</span><span class="ident" id="6871239">Skipf</span><span class="op" id="6871244">(</span><span class="string" id="6871245">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6871266">,</span>&nbsp;<span class="ident" id="6871268"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6871275">.</span><span class="ident" id="6871276">GOOS</span><span class="op" id="6871280">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871283">case</span>&nbsp;<span class="string" id="6871288">&#34;solaris&#34;</span><span class="op" id="6871297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871301"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6871302">.</span><span class="ident" id="6871303">Skipf</span><span class="op" id="6871308">(</span><span class="string" id="6871309">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6871351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871357">if</span>&nbsp;<span class="op" id="6871360">!</span><span class="ident" id="6871361"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6871374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871378"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6871379">.</span><span class="ident" id="6871380">Skip</span><span class="op" id="6871384">(</span><span class="string" id="6871385">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6871408">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871414">if</span>&nbsp;<span class="ident" id="6871417"><a href="/net/multicast_test.go.html#6868476">os</a></span><span class="op" id="6871419">.</span><span class="ident" id="6871420">Getuid</span><span class="op" id="6871426">(</span><span class="op" id="6871427">)</span>&nbsp;<span class="op" id="6871429">!=</span>&nbsp;<span class="num" id="6871432">0</span>&nbsp;<span class="op" id="6871434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871438"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6871439">.</span><span class="ident" id="6871440">Skip</span><span class="op" id="6871444">(</span><span class="string" id="6871445">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6871474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871481">closer</span>&nbsp;<span class="op" id="6871488">:=</span>&nbsp;<span class="keyword" id="6871491">func</span><span class="op" id="6871495">(</span><span class="ident" id="6871496">cs</span>&nbsp;<span class="op" id="6871499">[</span><span class="op" id="6871500">]</span><span class="op" id="6871501">*</span><span class="ident" id="6871502"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6871509">)</span>&nbsp;<span class="op" id="6871511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871515">for</span>&nbsp;<span class="ident" id="6871519">_</span><span class="op" id="6871520">,</span>&nbsp;<span class="ident" id="6871522">c</span>&nbsp;<span class="op" id="6871524">:=</span>&nbsp;<span class="keyword" id="6871527">range</span>&nbsp;<span class="ident" id="6871533"><a href="/net/multicast_test.go.html#6871496">cs</a></span>&nbsp;<span class="op" id="6871536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871541">if</span>&nbsp;<span class="ident" id="6871544"><a href="/net/multicast_test.go.html#6871522">c</a></span>&nbsp;<span class="op" id="6871546">!=</span>&nbsp;<span class="ident" id="6871549">nil</span>&nbsp;<span class="op" id="6871553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871559"><a href="/net/multicast_test.go.html#6871522">c</a></span><span class="op" id="6871560">.</span><span class="ident" id="6871561">Close</span><span class="op" id="6871566">(</span><span class="op" id="6871567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871572">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871583">for</span>&nbsp;<span class="ident" id="6871587">_</span><span class="op" id="6871588">,</span>&nbsp;<span class="ident" id="6871590">ifi</span>&nbsp;<span class="op" id="6871594">:=</span>&nbsp;<span class="keyword" id="6871597">range</span>&nbsp;<span class="op" id="6871603">[</span><span class="op" id="6871604">]</span><span class="op" id="6871605">*</span><span class="ident" id="6871606"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="6871615">{</span><span class="ident" id="6871616"><a href="/net/interface_test.go.html#6819206">loopbackInterface</a></span><span class="op" id="6871633">(</span><span class="op" id="6871634">)</span><span class="op" id="6871635">,</span>&nbsp;<span class="ident" id="6871637">nil</span><span class="op" id="6871640">}</span>&nbsp;<span class="op" id="6871642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6871646">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6871702">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6871755">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6871805">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6871857">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871875">if</span>&nbsp;<span class="ident" id="6871878"><a href="/net/multicast_test.go.html#6871590">ifi</a></span>&nbsp;<span class="op" id="6871882">==</span>&nbsp;<span class="ident" id="6871885">nil</span>&nbsp;<span class="op" id="6871889">&amp;&amp;</span>&nbsp;<span class="op" id="6871892">(</span><span class="op" id="6871893">!</span><span class="op" id="6871894">*</span><span class="ident" id="6871895"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span>&nbsp;<span class="op" id="6871908">||</span>&nbsp;<span class="op" id="6871911">!</span><span class="op" id="6871912">*</span><span class="ident" id="6871913"><a href="/net/dialgoogle_test.go.html#6783920">testIPv6</a></span><span class="op" id="6871921">)</span>&nbsp;<span class="op" id="6871923">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871928">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871943">for</span>&nbsp;<span class="ident" id="6871947">_</span><span class="op" id="6871948">,</span>&nbsp;<span class="ident" id="6871950">tt</span>&nbsp;<span class="op" id="6871953">:=</span>&nbsp;<span class="keyword" id="6871956">range</span>&nbsp;<span class="ident" id="6871962"><a href="/net/multicast_test.go.html#6870193">ipv6MulticastListenerTests</a></span>&nbsp;<span class="op" id="6871989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871994">var</span>&nbsp;<span class="ident" id="6871998">err</span>&nbsp;<span class="builtintype" id="6872002">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872011">cs</span>&nbsp;<span class="op" id="6872014">:=</span>&nbsp;<span class="builtinfunc" id="6872017">make</span><span class="op" id="6872021">(</span><span class="op" id="6872022">[</span><span class="op" id="6872023">]</span><span class="op" id="6872024">*</span><span class="ident" id="6872025"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6872032">,</span>&nbsp;<span class="num" id="6872034">2</span><span class="op" id="6872035">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872040">if</span>&nbsp;<span class="ident" id="6872043"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872045">[</span><span class="num" id="6872046">0</span><span class="op" id="6872047">]</span><span class="op" id="6872048">,</span>&nbsp;<span class="ident" id="6872050"><a href="/net/multicast_test.go.html#6871998">err</a></span>&nbsp;<span class="op" id="6872054">=</span>&nbsp;<span class="ident" id="6872056"><a href="/net/udpsock_posix.go.html#2711683">ListenMulticastUDP</a></span><span class="op" id="6872074">(</span><span class="ident" id="6872075"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872077">.</span><span class="ident" id="6872078">net</span><span class="op" id="6872081">,</span>&nbsp;<span class="ident" id="6872083"><a href="/net/multicast_test.go.html#6871590">ifi</a></span><span class="op" id="6872086">,</span>&nbsp;<span class="ident" id="6872088"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872090">.</span><span class="ident" id="6872091">gaddr</span><span class="op" id="6872096">)</span><span class="op" id="6872097">;</span>&nbsp;<span class="ident" id="6872099"><a href="/net/multicast_test.go.html#6871998">err</a></span>&nbsp;<span class="op" id="6872103">!=</span>&nbsp;<span class="ident" id="6872106">nil</span>&nbsp;<span class="op" id="6872110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872116"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6872117">.</span><span class="ident" id="6872118">Fatalf</span><span class="op" id="6872124">(</span><span class="string" id="6872125">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6872168">,</span>&nbsp;<span class="ident" id="6872170"><a href="/net/multicast_test.go.html#6871590">ifi</a></span><span class="op" id="6872173">,</span>&nbsp;<span class="ident" id="6872175"><a href="/net/multicast_test.go.html#6871998">err</a></span><span class="op" id="6872178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872188">if</span>&nbsp;<span class="ident" id="6872191">err</span>&nbsp;<span class="op" id="6872195">:=</span>&nbsp;<span class="ident" id="6872198"><a href="/net/multicast_test.go.html#6872592">checkMulticastListener</a></span><span class="op" id="6872220">(</span><span class="ident" id="6872221"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872223">[</span><span class="num" id="6872224">0</span><span class="op" id="6872225">]</span><span class="op" id="6872226">,</span>&nbsp;<span class="ident" id="6872228"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872230">.</span><span class="ident" id="6872231">gaddr</span><span class="op" id="6872236">.</span><span class="ident" id="6872237">IP</span><span class="op" id="6872239">)</span><span class="op" id="6872240">;</span>&nbsp;<span class="ident" id="6872242"><a href="/net/multicast_test.go.html#6872191">err</a></span>&nbsp;<span class="op" id="6872246">!=</span>&nbsp;<span class="ident" id="6872249">nil</span>&nbsp;<span class="op" id="6872253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872259"><a href="/net/multicast_test.go.html#6871481">closer</a></span><span class="op" id="6872265">(</span><span class="ident" id="6872266"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872268">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872274"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6872275">.</span><span class="ident" id="6872276">Fatal</span><span class="op" id="6872281">(</span><span class="ident" id="6872282"><a href="/net/multicast_test.go.html#6872191">err</a></span><span class="op" id="6872285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872295">if</span>&nbsp;<span class="ident" id="6872298"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872300">[</span><span class="num" id="6872301">1</span><span class="op" id="6872302">]</span><span class="op" id="6872303">,</span>&nbsp;<span class="ident" id="6872305"><a href="/net/multicast_test.go.html#6871998">err</a></span>&nbsp;<span class="op" id="6872309">=</span>&nbsp;<span class="ident" id="6872311"><a href="/net/udpsock_posix.go.html#2711683">ListenMulticastUDP</a></span><span class="op" id="6872329">(</span><span class="ident" id="6872330"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872332">.</span><span class="ident" id="6872333">net</span><span class="op" id="6872336">,</span>&nbsp;<span class="ident" id="6872338"><a href="/net/multicast_test.go.html#6871590">ifi</a></span><span class="op" id="6872341">,</span>&nbsp;<span class="ident" id="6872343"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872345">.</span><span class="ident" id="6872346">gaddr</span><span class="op" id="6872351">)</span><span class="op" id="6872352">;</span>&nbsp;<span class="ident" id="6872354"><a href="/net/multicast_test.go.html#6871998">err</a></span>&nbsp;<span class="op" id="6872358">!=</span>&nbsp;<span class="ident" id="6872361">nil</span>&nbsp;<span class="op" id="6872365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872371"><a href="/net/multicast_test.go.html#6871481">closer</a></span><span class="op" id="6872377">(</span><span class="ident" id="6872378"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872386"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6872387">.</span><span class="ident" id="6872388">Fatalf</span><span class="op" id="6872394">(</span><span class="string" id="6872395">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6872439">,</span>&nbsp;<span class="ident" id="6872441"><a href="/net/multicast_test.go.html#6871590">ifi</a></span><span class="op" id="6872444">,</span>&nbsp;<span class="ident" id="6872446"><a href="/net/multicast_test.go.html#6871998">err</a></span><span class="op" id="6872449">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872459">if</span>&nbsp;<span class="ident" id="6872462">err</span>&nbsp;<span class="op" id="6872466">:=</span>&nbsp;<span class="ident" id="6872469"><a href="/net/multicast_test.go.html#6872592">checkMulticastListener</a></span><span class="op" id="6872491">(</span><span class="ident" id="6872492"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872494">[</span><span class="num" id="6872495">1</span><span class="op" id="6872496">]</span><span class="op" id="6872497">,</span>&nbsp;<span class="ident" id="6872499"><a href="/net/multicast_test.go.html#6871950">tt</a></span><span class="op" id="6872501">.</span><span class="ident" id="6872502">gaddr</span><span class="op" id="6872507">.</span><span class="ident" id="6872508">IP</span><span class="op" id="6872510">)</span><span class="op" id="6872511">;</span>&nbsp;<span class="ident" id="6872513"><a href="/net/multicast_test.go.html#6872462">err</a></span>&nbsp;<span class="op" id="6872517">!=</span>&nbsp;<span class="ident" id="6872520">nil</span>&nbsp;<span class="op" id="6872524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872530"><a href="/net/multicast_test.go.html#6871481">closer</a></span><span class="op" id="6872536">(</span><span class="ident" id="6872537"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872545"><a href="/net/multicast_test.go.html#6871181">t</a></span><span class="op" id="6872546">.</span><span class="ident" id="6872547">Fatal</span><span class="op" id="6872552">(</span><span class="ident" id="6872553"><a href="/net/multicast_test.go.html#6872462">err</a></span><span class="op" id="6872556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872561">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872566"><a href="/net/multicast_test.go.html#6871481">closer</a></span><span class="op" id="6872572">(</span><span class="ident" id="6872573"><a href="/net/multicast_test.go.html#6872011">cs</a></span><span class="op" id="6872575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872582">}</span><br>
<span class="lineno"></span><span class="op" id="6872584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6872587">func</span>&nbsp;<span class="ident" id="6872592">checkMulticastListener</span><span class="op" id="6872614">(</span><span class="ident" id="6872615">c</span>&nbsp;<span class="op" id="6872617">*</span><span class="ident" id="6872618"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6872625">,</span>&nbsp;<span class="ident" id="6872627">ip</span>&nbsp;<span class="ident" id="6872630"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="6872632">)</span>&nbsp;<span class="builtintype" id="6872634">error</span>&nbsp;<span class="op" id="6872640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872643">if</span>&nbsp;<span class="ident" id="6872646">ok</span><span class="op" id="6872648">,</span>&nbsp;<span class="ident" id="6872650">err</span>&nbsp;<span class="op" id="6872654">:=</span>&nbsp;<span class="ident" id="6872657"><a href="/net/multicast_test.go.html#6872977">multicastRIBContains</a></span><span class="op" id="6872677">(</span><span class="ident" id="6872678"><a href="/net/multicast_test.go.html#6872627">ip</a></span><span class="op" id="6872680">)</span><span class="op" id="6872681">;</span>&nbsp;<span class="ident" id="6872683"><a href="/net/multicast_test.go.html#6872650">err</a></span>&nbsp;<span class="op" id="6872687">!=</span>&nbsp;<span class="ident" id="6872690">nil</span>&nbsp;<span class="op" id="6872694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872698">return</span>&nbsp;<span class="ident" id="6872705"><a href="/net/multicast_test.go.html#6872650">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872710">}</span>&nbsp;<span class="keyword" id="6872712">else</span>&nbsp;<span class="keyword" id="6872717">if</span>&nbsp;<span class="op" id="6872720">!</span><span class="ident" id="6872721"><a href="/net/multicast_test.go.html#6872646">ok</a></span>&nbsp;<span class="op" id="6872724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872728">return</span>&nbsp;<span class="ident" id="6872735"><a href="/net/multicast_test.go.html#6868469">fmt</a></span><span class="op" id="6872738">.</span><span class="ident" id="6872739">Errorf</span><span class="op" id="6872745">(</span><span class="string" id="6872746">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="6872777">,</span>&nbsp;<span class="ident" id="6872779"><a href="/net/multicast_test.go.html#6872627">ip</a></span><span class="op" id="6872781">.</span><span class="ident" id="6872782">String</span><span class="op" id="6872788">(</span><span class="op" id="6872789">)</span><span class="op" id="6872790">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872796">la</span>&nbsp;<span class="op" id="6872799">:=</span>&nbsp;<span class="ident" id="6872802"><a href="/net/multicast_test.go.html#6872615">c</a></span><span class="op" id="6872803">.</span><span class="ident" id="6872804">LocalAddr</span><span class="op" id="6872813">(</span><span class="op" id="6872814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872817">if</span>&nbsp;<span class="ident" id="6872820">la</span><span class="op" id="6872822">,</span>&nbsp;<span class="ident" id="6872824">ok</span>&nbsp;<span class="op" id="6872827">:=</span>&nbsp;<span class="ident" id="6872830"><a href="/net/multicast_test.go.html#6872796">la</a></span><span class="op" id="6872832">.</span><span class="op" id="6872833">(</span><span class="op" id="6872834">*</span><span class="ident" id="6872835"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6872842">)</span><span class="op" id="6872843">;</span>&nbsp;<span class="op" id="6872845">!</span><span class="ident" id="6872846"><a href="/net/multicast_test.go.html#6872824">ok</a></span>&nbsp;<span class="op" id="6872849">||</span>&nbsp;<span class="ident" id="6872852"><a href="/net/multicast_test.go.html#6872820">la</a></span><span class="op" id="6872854">.</span><span class="ident" id="6872855">Port</span>&nbsp;<span class="op" id="6872860">==</span>&nbsp;<span class="num" id="6872863">0</span>&nbsp;<span class="op" id="6872865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872869">return</span>&nbsp;<span class="ident" id="6872876"><a href="/net/multicast_test.go.html#6868469">fmt</a></span><span class="op" id="6872879">.</span><span class="ident" id="6872880">Errorf</span><span class="op" id="6872886">(</span><span class="string" id="6872887">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6872948">,</span>&nbsp;<span class="ident" id="6872950"><a href="/net/multicast_test.go.html#6872820">la</a></span><span class="op" id="6872952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872955">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872958">return</span>&nbsp;<span class="ident" id="6872965">nil</span><br>
<span class="lineno"></span><span class="op" id="6872969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6872972">func</span>&nbsp;<span class="ident" id="6872977">multicastRIBContains</span><span class="op" id="6872997">(</span><span class="ident" id="6872998">ip</span>&nbsp;<span class="ident" id="6873001"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="6873003">)</span>&nbsp;<span class="op" id="6873005">(</span><span class="builtintype" id="6873006">bool</span><span class="op" id="6873010">,</span>&nbsp;<span class="builtintype" id="6873012">error</span><span class="op" id="6873017">)</span>&nbsp;<span class="op" id="6873019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873022">switch</span>&nbsp;<span class="ident" id="6873029"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6873036">.</span><span class="ident" id="6873037">GOOS</span>&nbsp;<span class="op" id="6873042">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873045">case</span>&nbsp;<span class="string" id="6873050">&#34;dragonfly&#34;</span><span class="op" id="6873061">,</span>&nbsp;<span class="string" id="6873063">&#34;netbsd&#34;</span><span class="op" id="6873071">,</span>&nbsp;<span class="string" id="6873073">&#34;openbsd&#34;</span><span class="op" id="6873082">,</span>&nbsp;<span class="string" id="6873084">&#34;plan9&#34;</span><span class="op" id="6873091">,</span>&nbsp;<span class="string" id="6873093">&#34;solaris&#34;</span><span class="op" id="6873102">,</span>&nbsp;<span class="string" id="6873104">&#34;windows&#34;</span><span class="op" id="6873113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873117">return</span>&nbsp;<span class="ident" id="6873124">true</span><span class="op" id="6873128">,</span>&nbsp;<span class="ident" id="6873130">nil</span>&nbsp;<span class="comment" id="6873134">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873158">case</span>&nbsp;<span class="string" id="6873163">&#34;linux&#34;</span><span class="op" id="6873170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873174">if</span>&nbsp;<span class="ident" id="6873177"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6873184">.</span><span class="ident" id="6873185">GOARCH</span>&nbsp;<span class="op" id="6873192">==</span>&nbsp;<span class="string" id="6873195">&#34;arm&#34;</span>&nbsp;<span class="op" id="6873201">||</span>&nbsp;<span class="ident" id="6873204"><a href="/net/multicast_test.go.html#6868482">runtime</a></span><span class="op" id="6873211">.</span><span class="ident" id="6873212">GOARCH</span>&nbsp;<span class="op" id="6873219">==</span>&nbsp;<span class="string" id="6873222">&#34;alpha&#34;</span>&nbsp;<span class="op" id="6873230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873235">return</span>&nbsp;<span class="ident" id="6873242">true</span><span class="op" id="6873246">,</span>&nbsp;<span class="ident" id="6873248">nil</span>&nbsp;<span class="comment" id="6873252">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873283">ift</span><span class="op" id="6873286">,</span>&nbsp;<span class="ident" id="6873288">err</span>&nbsp;<span class="op" id="6873292">:=</span>&nbsp;<span class="ident" id="6873295"><a href="/net/interface.go.html#2595102">Interfaces</a></span><span class="op" id="6873305">(</span><span class="op" id="6873306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873309">if</span>&nbsp;<span class="ident" id="6873312"><a href="/net/multicast_test.go.html#6873288">err</a></span>&nbsp;<span class="op" id="6873316">!=</span>&nbsp;<span class="ident" id="6873319">nil</span>&nbsp;<span class="op" id="6873323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873327">return</span>&nbsp;<span class="ident" id="6873334">false</span><span class="op" id="6873339">,</span>&nbsp;<span class="ident" id="6873341"><a href="/net/multicast_test.go.html#6873288">err</a></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873349">for</span>&nbsp;<span class="ident" id="6873353">_</span><span class="op" id="6873354">,</span>&nbsp;<span class="ident" id="6873356">ifi</span>&nbsp;<span class="op" id="6873360">:=</span>&nbsp;<span class="keyword" id="6873363">range</span>&nbsp;<span class="ident" id="6873369"><a href="/net/multicast_test.go.html#6873283">ift</a></span>&nbsp;<span class="op" id="6873373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873377">ifmat</span><span class="op" id="6873382">,</span>&nbsp;<span class="ident" id="6873384">err</span>&nbsp;<span class="op" id="6873388">:=</span>&nbsp;<span class="ident" id="6873391"><a href="/net/multicast_test.go.html#6873356">ifi</a></span><span class="op" id="6873394">.</span><span class="ident" id="6873395">MulticastAddrs</span><span class="op" id="6873409">(</span><span class="op" id="6873410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873414">if</span>&nbsp;<span class="ident" id="6873417"><a href="/net/multicast_test.go.html#6873384">err</a></span>&nbsp;<span class="op" id="6873421">!=</span>&nbsp;<span class="ident" id="6873424">nil</span>&nbsp;<span class="op" id="6873428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873433">return</span>&nbsp;<span class="ident" id="6873440">false</span><span class="op" id="6873445">,</span>&nbsp;<span class="ident" id="6873447"><a href="/net/multicast_test.go.html#6873384">err</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873457">for</span>&nbsp;<span class="ident" id="6873461">_</span><span class="op" id="6873462">,</span>&nbsp;<span class="ident" id="6873464">ifma</span>&nbsp;<span class="op" id="6873469">:=</span>&nbsp;<span class="keyword" id="6873472">range</span>&nbsp;<span class="ident" id="6873478"><a href="/net/multicast_test.go.html#6873377">ifmat</a></span>&nbsp;<span class="op" id="6873484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873489">if</span>&nbsp;<span class="ident" id="6873492"><a href="/net/multicast_test.go.html#6873464">ifma</a></span><span class="op" id="6873496">.</span><span class="op" id="6873497">(</span><span class="op" id="6873498">*</span><span class="ident" id="6873499"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="6873505">)</span><span class="op" id="6873506">.</span><span class="ident" id="6873507">IP</span><span class="op" id="6873509">.</span><span class="ident" id="6873510">Equal</span><span class="op" id="6873515">(</span><span class="ident" id="6873516"><a href="/net/multicast_test.go.html#6872998">ip</a></span><span class="op" id="6873518">)</span>&nbsp;<span class="op" id="6873520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873526">return</span>&nbsp;<span class="ident" id="6873533">true</span><span class="op" id="6873537">,</span>&nbsp;<span class="ident" id="6873539">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873546">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873556">return</span>&nbsp;<span class="ident" id="6873563">false</span><span class="op" id="6873568">,</span>&nbsp;<span class="ident" id="6873570">nil</span><br>
<span class="lineno"></span><span class="op" id="6873574">}</span>
</div>
</body>
</html>
