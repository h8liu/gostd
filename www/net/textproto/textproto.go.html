<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3779347">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3779403">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3779457">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3779508">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="3779588">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="3779639">//</span><br>
<span class="lineno"></span><span class="comment" id="3779642">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="3779667">//</span><br>
<span class="lineno">10</span><span class="comment" id="3779670">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3779727">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="3779740">//</span><br>
<span class="lineno"></span><span class="comment" id="3779743">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="3779799">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="3779815">//</span><br>
<span class="lineno"></span><span class="comment" id="3779818">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="3779866">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="3779923">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="3779978">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="3780013">//</span><br>
<span class="lineno"></span><span class="comment" id="3780016">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="3780061">//</span><br>
<span class="lineno"></span><span class="comment" id="3780064">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="3780136">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="3780173">//</span><br>
<span class="lineno"></span><span class="keyword" id="3780176">package</span>&nbsp;<span class="ident" id="3780184">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3780195">import</span>&nbsp;<span class="op" id="3780202">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3780205">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3780214">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3780221">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3780227">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="3780233">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3780236">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="3780299">type</span>&nbsp;<span class="ident" id="3780304">Error</span>&nbsp;<span class="keyword" id="3780310">struct</span>&nbsp;<span class="op" id="3780317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780320">Code</span>&nbsp;<span class="builtintype" id="3780325">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780330">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="3780335">string</span><br>
<span class="lineno"></span><span class="op" id="3780342">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3780345">func</span>&nbsp;<span class="op" id="3780350">(</span><span class="ident" id="3780351">e</span>&nbsp;<span class="op" id="3780353">*</span><span class="ident" id="3780354">Error</span><span class="op" id="3780359">)</span>&nbsp;<span class="ident" id="3780361">Error</span><span class="op" id="3780366">(</span><span class="op" id="3780367">)</span>&nbsp;<span class="builtintype" id="3780369">string</span>&nbsp;<span class="op" id="3780376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780379">return</span>&nbsp;<span class="ident" id="3780386">fmt</span><span class="op" id="3780389">.</span><span class="ident" id="3780390">Sprintf</span><span class="op" id="3780397">(</span><span class="string" id="3780398">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="3780407">,</span>&nbsp;<span class="ident" id="3780409">e</span><span class="op" id="3780410">.</span><span class="ident" id="3780411">Code</span><span class="op" id="3780415">,</span>&nbsp;<span class="ident" id="3780417">e</span><span class="op" id="3780418">.</span><span class="ident" id="3780419">Msg</span><span class="op" id="3780422">)</span><br>
<span class="lineno"></span><span class="op" id="3780424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3780427">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3780482">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3780533">type</span>&nbsp;<span class="ident" id="3780538">ProtocolError</span>&nbsp;<span class="builtintype" id="3780552">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3780560">func</span>&nbsp;<span class="op" id="3780565">(</span><span class="ident" id="3780566">p</span>&nbsp;<span class="ident" id="3780568">ProtocolError</span><span class="op" id="3780581">)</span>&nbsp;<span class="ident" id="3780583">Error</span><span class="op" id="3780588">(</span><span class="op" id="3780589">)</span>&nbsp;<span class="builtintype" id="3780591">string</span>&nbsp;<span class="op" id="3780598">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780601">return</span>&nbsp;<span class="builtintype" id="3780608">string</span><span class="op" id="3780614">(</span><span class="ident" id="3780615">p</span><span class="op" id="3780616">)</span><br>
<span class="lineno"></span><span class="op" id="3780618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3780621">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3780681">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="3780733">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3780802">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="3780851">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3780904">type</span>&nbsp;<span class="ident" id="3780909">Conn</span>&nbsp;<span class="keyword" id="3780914">struct</span>&nbsp;<span class="op" id="3780921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780924">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780932">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780940">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780950">conn</span>&nbsp;<span class="ident" id="3780955">io</span><span class="op" id="3780957">.</span><span class="ident" id="3780958">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3780974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3780977">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3781027">func</span>&nbsp;<span class="ident" id="3781032">NewConn</span><span class="op" id="3781039">(</span><span class="ident" id="3781040">conn</span>&nbsp;<span class="ident" id="3781045">io</span><span class="op" id="3781047">.</span><span class="ident" id="3781048">ReadWriteCloser</span><span class="op" id="3781063">)</span>&nbsp;<span class="op" id="3781065">*</span><span class="ident" id="3781066">Conn</span>&nbsp;<span class="op" id="3781071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781074">return</span>&nbsp;<span class="op" id="3781081">&amp;</span><span class="ident" id="3781082">Conn</span><span class="op" id="3781086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781090">Reader</span><span class="op" id="3781096">:</span>&nbsp;<span class="ident" id="3781098">Reader</span><span class="op" id="3781104">{</span><span class="ident" id="3781105">R</span><span class="op" id="3781106">:</span>&nbsp;<span class="ident" id="3781108">bufio</span><span class="op" id="3781113">.</span><span class="ident" id="3781114">NewReader</span><span class="op" id="3781123">(</span><span class="ident" id="3781124">conn</span><span class="op" id="3781128">)</span><span class="op" id="3781129">}</span><span class="op" id="3781130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781134">Writer</span><span class="op" id="3781140">:</span>&nbsp;<span class="ident" id="3781142">Writer</span><span class="op" id="3781148">{</span><span class="ident" id="3781149">W</span><span class="op" id="3781150">:</span>&nbsp;<span class="ident" id="3781152">bufio</span><span class="op" id="3781157">.</span><span class="ident" id="3781158">NewWriter</span><span class="op" id="3781167">(</span><span class="ident" id="3781168">conn</span><span class="op" id="3781172">)</span><span class="op" id="3781173">}</span><span class="op" id="3781174">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781178">conn</span><span class="op" id="3781182">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3781186">conn</span><span class="op" id="3781190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781193">}</span><br>
<span class="lineno"></span><span class="op" id="3781195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3781198">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3781230">func</span>&nbsp;<span class="op" id="3781235">(</span><span class="ident" id="3781236">c</span>&nbsp;<span class="op" id="3781238">*</span><span class="ident" id="3781239">Conn</span><span class="op" id="3781243">)</span>&nbsp;<span class="ident" id="3781245">Close</span><span class="op" id="3781250">(</span><span class="op" id="3781251">)</span>&nbsp;<span class="builtintype" id="3781253">error</span>&nbsp;<span class="op" id="3781259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781262">return</span>&nbsp;<span class="ident" id="3781269">c</span><span class="op" id="3781270">.</span><span class="ident" id="3781271">conn</span><span class="op" id="3781275">.</span><span class="ident" id="3781276">Close</span><span class="op" id="3781281">(</span><span class="op" id="3781282">)</span><br>
<span class="lineno"></span><span class="op" id="3781284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3781287">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3781361">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3781412">func</span>&nbsp;<span class="ident" id="3781417">Dial</span><span class="op" id="3781421">(</span><span class="ident" id="3781422">network</span><span class="op" id="3781429">,</span>&nbsp;<span class="ident" id="3781431">addr</span>&nbsp;<span class="builtintype" id="3781436">string</span><span class="op" id="3781442">)</span>&nbsp;<span class="op" id="3781444">(</span><span class="op" id="3781445">*</span><span class="ident" id="3781446">Conn</span><span class="op" id="3781450">,</span>&nbsp;<span class="builtintype" id="3781452">error</span><span class="op" id="3781457">)</span>&nbsp;<span class="op" id="3781459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781462">c</span><span class="op" id="3781463">,</span>&nbsp;<span class="ident" id="3781465">err</span>&nbsp;<span class="op" id="3781469">:=</span>&nbsp;<span class="ident" id="3781472">net</span><span class="op" id="3781475">.</span><span class="ident" id="3781476">Dial</span><span class="op" id="3781480">(</span><span class="ident" id="3781481">network</span><span class="op" id="3781488">,</span>&nbsp;<span class="ident" id="3781490">addr</span><span class="op" id="3781494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781497">if</span>&nbsp;<span class="ident" id="3781500">err</span>&nbsp;<span class="op" id="3781504">!=</span>&nbsp;<span class="ident" id="3781507">nil</span>&nbsp;<span class="op" id="3781511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781515">return</span>&nbsp;<span class="ident" id="3781522">nil</span><span class="op" id="3781525">,</span>&nbsp;<span class="ident" id="3781527">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781535">return</span>&nbsp;<span class="ident" id="3781542">NewConn</span><span class="op" id="3781549">(</span><span class="ident" id="3781550">c</span><span class="op" id="3781551">)</span><span class="op" id="3781552">,</span>&nbsp;<span class="ident" id="3781554">nil</span><br>
<span class="lineno"></span><span class="op" id="3781558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3781561">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3781619">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3781681">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3781742">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3781824">//</span><br>
<span class="lineno"></span><span class="comment" id="3781827">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3781901">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3781914">//</span><br>
<span class="lineno"></span><span class="comment" id="3781917">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3781945">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3781964">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3781984">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3781989">//</span><br>
<span class="lineno"></span><span class="comment" id="3781992">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3782015">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3782042">//</span><br>
<span class="lineno">105</span><span class="comment" id="3782045">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3782097">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3782117">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3782122">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3782155">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3782174">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3782194">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3782199">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3782229">//</span><br>
<span class="lineno"></span><span class="keyword" id="3782232">func</span>&nbsp;<span class="op" id="3782237">(</span><span class="ident" id="3782238">c</span>&nbsp;<span class="op" id="3782240">*</span><span class="ident" id="3782241">Conn</span><span class="op" id="3782245">)</span>&nbsp;<span class="ident" id="3782247">Cmd</span><span class="op" id="3782250">(</span><span class="ident" id="3782251">format</span>&nbsp;<span class="builtintype" id="3782258">string</span><span class="op" id="3782264">,</span>&nbsp;<span class="ident" id="3782266">args</span>&nbsp;<span class="op" id="3782271">...</span><span class="keyword" id="3782274">interface</span><span class="op" id="3782283">{</span><span class="op" id="3782284">}</span><span class="op" id="3782285">)</span>&nbsp;<span class="op" id="3782287">(</span><span class="ident" id="3782288">id</span>&nbsp;<span class="builtintype" id="3782291">uint</span><span class="op" id="3782295">,</span>&nbsp;<span class="ident" id="3782297">err</span>&nbsp;<span class="builtintype" id="3782301">error</span><span class="op" id="3782306">)</span>&nbsp;<span class="op" id="3782308">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782311">id</span>&nbsp;<span class="op" id="3782314">=</span>&nbsp;<span class="ident" id="3782316">c</span><span class="op" id="3782317">.</span><span class="ident" id="3782318">Next</span><span class="op" id="3782322">(</span><span class="op" id="3782323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782326">c</span><span class="op" id="3782327">.</span><span class="ident" id="3782328">StartRequest</span><span class="op" id="3782340">(</span><span class="ident" id="3782341">id</span><span class="op" id="3782343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782346">err</span>&nbsp;<span class="op" id="3782350">=</span>&nbsp;<span class="ident" id="3782352">c</span><span class="op" id="3782353">.</span><span class="ident" id="3782354">PrintfLine</span><span class="op" id="3782364">(</span><span class="ident" id="3782365">format</span><span class="op" id="3782371">,</span>&nbsp;<span class="ident" id="3782373">args</span><span class="op" id="3782377">...</span><span class="op" id="3782380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782383">c</span><span class="op" id="3782384">.</span><span class="ident" id="3782385">EndRequest</span><span class="op" id="3782395">(</span><span class="ident" id="3782396">id</span><span class="op" id="3782398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782401">if</span>&nbsp;<span class="ident" id="3782404">err</span>&nbsp;<span class="op" id="3782408">!=</span>&nbsp;<span class="ident" id="3782411">nil</span>&nbsp;<span class="op" id="3782415">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782419">return</span>&nbsp;<span class="num" id="3782426">0</span><span class="op" id="3782427">,</span>&nbsp;<span class="ident" id="3782429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782437">return</span>&nbsp;<span class="ident" id="3782444">id</span><span class="op" id="3782446">,</span>&nbsp;<span class="ident" id="3782448">nil</span><br>
<span class="lineno"></span><span class="op" id="3782452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3782455">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3782521">func</span>&nbsp;<span class="ident" id="3782526">TrimString</span><span class="op" id="3782536">(</span><span class="ident" id="3782537">s</span>&nbsp;<span class="builtintype" id="3782539">string</span><span class="op" id="3782545">)</span>&nbsp;<span class="builtintype" id="3782547">string</span>&nbsp;<span class="op" id="3782554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782557">for</span>&nbsp;<span class="builtinfunc" id="3782561">len</span><span class="op" id="3782564">(</span><span class="ident" id="3782565">s</span><span class="op" id="3782566">)</span>&nbsp;<span class="op" id="3782568">&gt;</span>&nbsp;<span class="num" id="3782570">0</span>&nbsp;<span class="op" id="3782572">&amp;&amp;</span>&nbsp;<span class="ident" id="3782575">isASCIISpace</span><span class="op" id="3782587">(</span><span class="ident" id="3782588">s</span><span class="op" id="3782589">[</span><span class="num" id="3782590">0</span><span class="op" id="3782591">]</span><span class="op" id="3782592">)</span>&nbsp;<span class="op" id="3782594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782598">s</span>&nbsp;<span class="op" id="3782600">=</span>&nbsp;<span class="ident" id="3782602">s</span><span class="op" id="3782603">[</span><span class="num" id="3782604">1</span><span class="op" id="3782605">:</span><span class="op" id="3782606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782609">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782612">for</span>&nbsp;<span class="builtinfunc" id="3782616">len</span><span class="op" id="3782619">(</span><span class="ident" id="3782620">s</span><span class="op" id="3782621">)</span>&nbsp;<span class="op" id="3782623">&gt;</span>&nbsp;<span class="num" id="3782625">0</span>&nbsp;<span class="op" id="3782627">&amp;&amp;</span>&nbsp;<span class="ident" id="3782630">isASCIISpace</span><span class="op" id="3782642">(</span><span class="ident" id="3782643">s</span><span class="op" id="3782644">[</span><span class="builtinfunc" id="3782645">len</span><span class="op" id="3782648">(</span><span class="ident" id="3782649">s</span><span class="op" id="3782650">)</span><span class="op" id="3782651">-</span><span class="num" id="3782652">1</span><span class="op" id="3782653">]</span><span class="op" id="3782654">)</span>&nbsp;<span class="op" id="3782656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782660">s</span>&nbsp;<span class="op" id="3782662">=</span>&nbsp;<span class="ident" id="3782664">s</span><span class="op" id="3782665">[</span><span class="op" id="3782666">:</span><span class="builtinfunc" id="3782667">len</span><span class="op" id="3782670">(</span><span class="ident" id="3782671">s</span><span class="op" id="3782672">)</span><span class="op" id="3782673">-</span><span class="num" id="3782674">1</span><span class="op" id="3782675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782681">return</span>&nbsp;<span class="ident" id="3782688">s</span><br>
<span class="lineno"></span><span class="op" id="3782690">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3782693">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3782758">func</span>&nbsp;<span class="ident" id="3782763">TrimBytes</span><span class="op" id="3782772">(</span><span class="ident" id="3782773">b</span>&nbsp;<span class="op" id="3782775">[</span><span class="op" id="3782776">]</span><span class="builtintype" id="3782777">byte</span><span class="op" id="3782781">)</span>&nbsp;<span class="op" id="3782783">[</span><span class="op" id="3782784">]</span><span class="builtintype" id="3782785">byte</span>&nbsp;<span class="op" id="3782790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782793">for</span>&nbsp;<span class="builtinfunc" id="3782797">len</span><span class="op" id="3782800">(</span><span class="ident" id="3782801">b</span><span class="op" id="3782802">)</span>&nbsp;<span class="op" id="3782804">&gt;</span>&nbsp;<span class="num" id="3782806">0</span>&nbsp;<span class="op" id="3782808">&amp;&amp;</span>&nbsp;<span class="ident" id="3782811">isASCIISpace</span><span class="op" id="3782823">(</span><span class="ident" id="3782824">b</span><span class="op" id="3782825">[</span><span class="num" id="3782826">0</span><span class="op" id="3782827">]</span><span class="op" id="3782828">)</span>&nbsp;<span class="op" id="3782830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782834">b</span>&nbsp;<span class="op" id="3782836">=</span>&nbsp;<span class="ident" id="3782838">b</span><span class="op" id="3782839">[</span><span class="num" id="3782840">1</span><span class="op" id="3782841">:</span><span class="op" id="3782842">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782848">for</span>&nbsp;<span class="builtinfunc" id="3782852">len</span><span class="op" id="3782855">(</span><span class="ident" id="3782856">b</span><span class="op" id="3782857">)</span>&nbsp;<span class="op" id="3782859">&gt;</span>&nbsp;<span class="num" id="3782861">0</span>&nbsp;<span class="op" id="3782863">&amp;&amp;</span>&nbsp;<span class="ident" id="3782866">isASCIISpace</span><span class="op" id="3782878">(</span><span class="ident" id="3782879">b</span><span class="op" id="3782880">[</span><span class="builtinfunc" id="3782881">len</span><span class="op" id="3782884">(</span><span class="ident" id="3782885">b</span><span class="op" id="3782886">)</span><span class="op" id="3782887">-</span><span class="num" id="3782888">1</span><span class="op" id="3782889">]</span><span class="op" id="3782890">)</span>&nbsp;<span class="op" id="3782892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782896">b</span>&nbsp;<span class="op" id="3782898">=</span>&nbsp;<span class="ident" id="3782900">b</span><span class="op" id="3782901">[</span><span class="op" id="3782902">:</span><span class="builtinfunc" id="3782903">len</span><span class="op" id="3782906">(</span><span class="ident" id="3782907">b</span><span class="op" id="3782908">)</span><span class="op" id="3782909">-</span><span class="num" id="3782910">1</span><span class="op" id="3782911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782917">return</span>&nbsp;<span class="ident" id="3782924">b</span><br>
<span class="lineno">145</span><span class="op" id="3782926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3782929">func</span>&nbsp;<span class="ident" id="3782934">isASCIISpace</span><span class="op" id="3782946">(</span><span class="ident" id="3782947">b</span>&nbsp;<span class="builtintype" id="3782949">byte</span><span class="op" id="3782953">)</span>&nbsp;<span class="builtintype" id="3782955">bool</span>&nbsp;<span class="op" id="3782960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782963">return</span>&nbsp;<span class="ident" id="3782970">b</span>&nbsp;<span class="op" id="3782972">==</span>&nbsp;<span class="string" id="3782975">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3782979">||</span>&nbsp;<span class="ident" id="3782982">b</span>&nbsp;<span class="op" id="3782984">==</span>&nbsp;<span class="string" id="3782987">&#39;\t&#39;</span>&nbsp;<span class="op" id="3782992">||</span>&nbsp;<span class="ident" id="3782995">b</span>&nbsp;<span class="op" id="3782997">==</span>&nbsp;<span class="string" id="3783000">&#39;\n&#39;</span>&nbsp;<span class="op" id="3783005">||</span>&nbsp;<span class="ident" id="3783008">b</span>&nbsp;<span class="op" id="3783010">==</span>&nbsp;<span class="string" id="3783013">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3783018">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3783021">func</span>&nbsp;<span class="ident" id="3783026">isASCIILetter</span><span class="op" id="3783039">(</span><span class="ident" id="3783040">b</span>&nbsp;<span class="builtintype" id="3783042">byte</span><span class="op" id="3783046">)</span>&nbsp;<span class="builtintype" id="3783048">bool</span>&nbsp;<span class="op" id="3783053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783056">b</span>&nbsp;<span class="op" id="3783058">|=</span>&nbsp;<span class="num" id="3783061">0x20</span>&nbsp;<span class="comment" id="3783066">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783086">return</span>&nbsp;<span class="string" id="3783093">&#39;a&#39;</span>&nbsp;<span class="op" id="3783097">&lt;=</span>&nbsp;<span class="ident" id="3783100">b</span>&nbsp;<span class="op" id="3783102">&amp;&amp;</span>&nbsp;<span class="ident" id="3783105">b</span>&nbsp;<span class="op" id="3783107">&lt;=</span>&nbsp;<span class="string" id="3783110">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3783114">}</span>
</div>
</body>
</html>
