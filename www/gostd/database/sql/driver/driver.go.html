<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html" class="current">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4659290">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4659345">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4659399">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4659450">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="4659517">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="4659552">//</span><br>
<span class="lineno"></span><span class="comment" id="4659555">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="4659592">package</span>&nbsp;<span class="ident" id="4659600">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4659608">import</span>&nbsp;<span class="string" id="4659615">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659625">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="4659682">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="4659740">//</span><br>
<span class="lineno"></span><span class="comment" id="4659743">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="4659754">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="4659767">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="4659777">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="4659789">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="4659841">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="4659856">type</span>&nbsp;<span class="ident" id="4659861">Value</span>&nbsp;<span class="keyword" id="4659867">interface</span><span class="op" id="4659876">{</span><span class="op" id="4659877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659880">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="4659946">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="4659957">type</span>&nbsp;<span class="ident" id="4659962">Driver</span>&nbsp;<span class="keyword" id="4659969">interface</span>&nbsp;<span class="op" id="4659979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659982">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660033">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660087">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660091">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660147">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660205">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660268">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660272">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660335">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660345">Open</span><span class="op" id="4660349">(</span><span class="ident" id="4660350">name</span>&nbsp;<span class="builtintype" id="4660355">string</span><span class="op" id="4660361">)</span>&nbsp;<span class="op" id="4660363">(</span><span class="ident" id="4660364">Conn</span><span class="op" id="4660368">,</span>&nbsp;<span class="builtintype" id="4660370">error</span><span class="op" id="4660375">)</span><br>
<span class="lineno"></span><span class="op" id="4660377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4660380">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="4660447">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="4660516">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4660580">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="4660639">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="4660654">var</span>&nbsp;<span class="ident" id="4660658">ErrSkip</span>&nbsp;<span class="op" id="4660666">=</span>&nbsp;<span class="ident" id="4660668">errors</span><span class="op" id="4660674">.</span><span class="ident" id="4660675">New</span><span class="op" id="4660678">(</span><span class="string" id="4660679">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="4660733">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="4660736">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="4660802">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="4660870">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="4660938">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="4660968">//</span><br>
<span class="lineno"></span><span class="comment" id="4660971">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="4661041">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4661105">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4661173">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="4661209">var</span>&nbsp;<span class="ident" id="4661213">ErrBadConn</span>&nbsp;<span class="op" id="4661224">=</span>&nbsp;<span class="ident" id="4661226">errors</span><span class="op" id="4661232">.</span><span class="ident" id="4661233">New</span><span class="op" id="4661236">(</span><span class="string" id="4661237">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="4661261">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661264">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="4661334">//</span><br>
<span class="lineno"></span><span class="comment" id="4661337">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="4661408">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4661476">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="4661490">//</span><br>
<span class="lineno"></span><span class="comment" id="4661493">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="4661521">type</span>&nbsp;<span class="ident" id="4661526">Execer</span>&nbsp;<span class="keyword" id="4661533">interface</span>&nbsp;<span class="op" id="4661543">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661546">Exec</span><span class="op" id="4661550">(</span><span class="ident" id="4661551">query</span>&nbsp;<span class="builtintype" id="4661557">string</span><span class="op" id="4661563">,</span>&nbsp;<span class="ident" id="4661565">args</span>&nbsp;<span class="op" id="4661570">[</span><span class="op" id="4661571">]</span><span class="ident" id="4661572">Value</span><span class="op" id="4661577">)</span>&nbsp;<span class="op" id="4661579">(</span><span class="ident" id="4661580">Result</span><span class="op" id="4661586">,</span>&nbsp;<span class="builtintype" id="4661588">error</span><span class="op" id="4661593">)</span><br>
<span class="lineno"></span><span class="op" id="4661595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661598">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="4661669">//</span><br>
<span class="lineno">70</span><span class="comment" id="4661672">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="4661745">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4661813">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="4661827">//</span><br>
<span class="lineno"></span><span class="comment" id="4661830">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="4661859">type</span>&nbsp;<span class="ident" id="4661864">Queryer</span>&nbsp;<span class="keyword" id="4661872">interface</span>&nbsp;<span class="op" id="4661882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661885">Query</span><span class="op" id="4661890">(</span><span class="ident" id="4661891">query</span>&nbsp;<span class="builtintype" id="4661897">string</span><span class="op" id="4661903">,</span>&nbsp;<span class="ident" id="4661905">args</span>&nbsp;<span class="op" id="4661910">[</span><span class="op" id="4661911">]</span><span class="ident" id="4661912">Value</span><span class="op" id="4661917">)</span>&nbsp;<span class="op" id="4661919">(</span><span class="ident" id="4661920">Rows</span><span class="op" id="4661924">,</span>&nbsp;<span class="builtintype" id="4661926">error</span><span class="op" id="4661931">)</span><br>
<span class="lineno"></span><span class="op" id="4661933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661936">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="4662003">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="4662030">//</span><br>
<span class="lineno"></span><span class="comment" id="4662033">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="4662068">type</span>&nbsp;<span class="ident" id="4662073">Conn</span>&nbsp;<span class="keyword" id="4662078">interface</span>&nbsp;<span class="op" id="4662088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662091">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662159">Prepare</span><span class="op" id="4662166">(</span><span class="ident" id="4662167">query</span>&nbsp;<span class="builtintype" id="4662173">string</span><span class="op" id="4662179">)</span>&nbsp;<span class="op" id="4662181">(</span><span class="ident" id="4662182">Stmt</span><span class="op" id="4662186">,</span>&nbsp;<span class="builtintype" id="4662188">error</span><span class="op" id="4662193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662197">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662253">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662308">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662344">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662348">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662401">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662464">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662527">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662564">Close</span><span class="op" id="4662569">(</span><span class="op" id="4662570">)</span>&nbsp;<span class="builtintype" id="4662572">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662580">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662628">Begin</span><span class="op" id="4662633">(</span><span class="op" id="4662634">)</span>&nbsp;<span class="op" id="4662636">(</span><span class="ident" id="4662637">Tx</span><span class="op" id="4662639">,</span>&nbsp;<span class="builtintype" id="4662641">error</span><span class="op" id="4662646">)</span><br>
<span class="lineno"></span><span class="op" id="4662648">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4662651">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="4662697">type</span>&nbsp;<span class="ident" id="4662702">Result</span>&nbsp;<span class="keyword" id="4662709">interface</span>&nbsp;<span class="op" id="4662719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662722">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662780">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662840">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662849">LastInsertId</span><span class="op" id="4662861">(</span><span class="op" id="4662862">)</span>&nbsp;<span class="op" id="4662864">(</span><span class="ident" id="4662865">int64</span><span class="op" id="4662870">,</span>&nbsp;<span class="builtintype" id="4662872">error</span><span class="op" id="4662877">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662881">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662941">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662952">RowsAffected</span><span class="op" id="4662964">(</span><span class="op" id="4662965">)</span>&nbsp;<span class="op" id="4662967">(</span><span class="ident" id="4662968">int64</span><span class="op" id="4662973">,</span>&nbsp;<span class="builtintype" id="4662975">error</span><span class="op" id="4662980">)</span><br>
<span class="lineno"></span><span class="op" id="4662982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662985">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4663048">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="4663093">type</span>&nbsp;<span class="ident" id="4663098">Stmt</span>&nbsp;<span class="keyword" id="4663103">interface</span>&nbsp;<span class="op" id="4663113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663116">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663148">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663152">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663211">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663231">Close</span><span class="op" id="4663236">(</span><span class="op" id="4663237">)</span>&nbsp;<span class="builtintype" id="4663239">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663247">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663306">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663310">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663374">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663439">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663500">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663504">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663564">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663626">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663683">NumInput</span><span class="op" id="4663691">(</span><span class="op" id="4663692">)</span>&nbsp;<span class="builtintype" id="4663694">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663700">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663757">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663785">Exec</span><span class="op" id="4663789">(</span><span class="ident" id="4663790">args</span>&nbsp;<span class="op" id="4663795">[</span><span class="op" id="4663796">]</span><span class="ident" id="4663797">Value</span><span class="op" id="4663802">)</span>&nbsp;<span class="op" id="4663804">(</span><span class="ident" id="4663805">Result</span><span class="op" id="4663811">,</span>&nbsp;<span class="builtintype" id="4663813">error</span><span class="op" id="4663818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663822">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663881">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4663893">Query</span><span class="op" id="4663898">(</span><span class="ident" id="4663899">args</span>&nbsp;<span class="op" id="4663904">[</span><span class="op" id="4663905">]</span><span class="ident" id="4663906">Value</span><span class="op" id="4663911">)</span>&nbsp;<span class="op" id="4663913">(</span><span class="ident" id="4663914">Rows</span><span class="op" id="4663918">,</span>&nbsp;<span class="builtintype" id="4663920">error</span><span class="op" id="4663925">)</span><br>
<span class="lineno">140</span><span class="op" id="4663927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663930">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4663994">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4664063">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="4664094">type</span>&nbsp;<span class="ident" id="4664099">ColumnConverter</span>&nbsp;<span class="keyword" id="4664115">interface</span>&nbsp;<span class="op" id="4664125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664128">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664190">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664254">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664315">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664336">ColumnConverter</span><span class="op" id="4664351">(</span><span class="ident" id="4664352">idx</span>&nbsp;<span class="builtintype" id="4664356">int</span><span class="op" id="4664359">)</span>&nbsp;<span class="ident" id="4664361">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="4664376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4664379">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="4664436">type</span>&nbsp;<span class="ident" id="4664441">Rows</span>&nbsp;<span class="keyword" id="4664446">interface</span>&nbsp;<span class="op" id="4664456">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664459">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664519">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664580">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664642">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664688">Columns</span><span class="op" id="4664695">(</span><span class="op" id="4664696">)</span>&nbsp;<span class="op" id="4664698">[</span><span class="op" id="4664699">]</span><span class="builtintype" id="4664700">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664709">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4664745">Close</span><span class="op" id="4664750">(</span><span class="op" id="4664751">)</span>&nbsp;<span class="builtintype" id="4664753">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664761">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664818">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664878">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664914">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664918">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4664964">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665011">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665062">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665066">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665125">Next</span><span class="op" id="4665129">(</span><span class="ident" id="4665130">dest</span>&nbsp;<span class="op" id="4665135">[</span><span class="op" id="4665136">]</span><span class="ident" id="4665137">Value</span><span class="op" id="4665142">)</span>&nbsp;<span class="builtintype" id="4665144">error</span><br>
<span class="lineno"></span><span class="op" id="4665150">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4665153">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="4665177">type</span>&nbsp;<span class="ident" id="4665182">Tx</span>&nbsp;<span class="keyword" id="4665185">interface</span>&nbsp;<span class="op" id="4665195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665198">Commit</span><span class="op" id="4665204">(</span><span class="op" id="4665205">)</span>&nbsp;<span class="builtintype" id="4665207">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665214">Rollback</span><span class="op" id="4665222">(</span><span class="op" id="4665223">)</span>&nbsp;<span class="builtintype" id="4665225">error</span><br>
<span class="lineno">180</span><span class="op" id="4665231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4665234">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="4665302">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="4665337">type</span>&nbsp;<span class="ident" id="4665342">RowsAffected</span>&nbsp;<span class="ident" id="4665355">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4665362">var</span>&nbsp;<span class="ident" id="4665366">_</span>&nbsp;<span class="ident" id="4665368">Result</span>&nbsp;<span class="op" id="4665375">=</span>&nbsp;<span class="ident" id="4665377">RowsAffected</span><span class="op" id="4665389">(</span><span class="num" id="4665390">0</span><span class="op" id="4665391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665394">func</span>&nbsp;<span class="op" id="4665399">(</span><span class="ident" id="4665400">RowsAffected</span><span class="op" id="4665412">)</span>&nbsp;<span class="ident" id="4665414">LastInsertId</span><span class="op" id="4665426">(</span><span class="op" id="4665427">)</span>&nbsp;<span class="op" id="4665429">(</span><span class="ident" id="4665430">int64</span><span class="op" id="4665435">,</span>&nbsp;<span class="builtintype" id="4665437">error</span><span class="op" id="4665442">)</span>&nbsp;<span class="op" id="4665444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665447">return</span>&nbsp;<span class="num" id="4665454">0</span><span class="op" id="4665455">,</span>&nbsp;<span class="ident" id="4665457">errors</span><span class="op" id="4665463">.</span><span class="ident" id="4665464">New</span><span class="op" id="4665467">(</span><span class="string" id="4665468">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="4665495">)</span><br>
<span class="lineno">190</span><span class="op" id="4665497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665500">func</span>&nbsp;<span class="op" id="4665505">(</span><span class="ident" id="4665506">v</span>&nbsp;<span class="ident" id="4665508">RowsAffected</span><span class="op" id="4665520">)</span>&nbsp;<span class="ident" id="4665522">RowsAffected</span><span class="op" id="4665534">(</span><span class="op" id="4665535">)</span>&nbsp;<span class="op" id="4665537">(</span><span class="ident" id="4665538">int64</span><span class="op" id="4665543">,</span>&nbsp;<span class="builtintype" id="4665545">error</span><span class="op" id="4665550">)</span>&nbsp;<span class="op" id="4665552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665555">return</span>&nbsp;<span class="ident" id="4665562">int64</span><span class="op" id="4665567">(</span><span class="ident" id="4665568">v</span><span class="op" id="4665569">)</span><span class="op" id="4665570">,</span>&nbsp;<span class="builtintype" id="4665572">nil</span><br>
<span class="lineno"></span><span class="op" id="4665576">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="4665579">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="4665652">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="4665727">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="4665761">var</span>&nbsp;<span class="ident" id="4665765">ResultNoRows</span>&nbsp;<span class="ident" id="4665778">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4665786">type</span>&nbsp;<span class="ident" id="4665791">noRows</span>&nbsp;<span class="keyword" id="4665798">struct</span><span class="op" id="4665804">{</span><span class="op" id="4665805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665808">var</span>&nbsp;<span class="ident" id="4665812">_</span>&nbsp;<span class="ident" id="4665814">Result</span>&nbsp;<span class="op" id="4665821">=</span>&nbsp;<span class="ident" id="4665823">noRows</span><span class="op" id="4665829">{</span><span class="op" id="4665830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="4665833">func</span>&nbsp;<span class="op" id="4665838">(</span><span class="ident" id="4665839">noRows</span><span class="op" id="4665845">)</span>&nbsp;<span class="ident" id="4665847">LastInsertId</span><span class="op" id="4665859">(</span><span class="op" id="4665860">)</span>&nbsp;<span class="op" id="4665862">(</span><span class="ident" id="4665863">int64</span><span class="op" id="4665868">,</span>&nbsp;<span class="builtintype" id="4665870">error</span><span class="op" id="4665875">)</span>&nbsp;<span class="op" id="4665877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665880">return</span>&nbsp;<span class="num" id="4665887">0</span><span class="op" id="4665888">,</span>&nbsp;<span class="ident" id="4665890">errors</span><span class="op" id="4665896">.</span><span class="ident" id="4665897">New</span><span class="op" id="4665900">(</span><span class="string" id="4665901">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="4665948">)</span><br>
<span class="lineno"></span><span class="op" id="4665950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665953">func</span>&nbsp;<span class="op" id="4665958">(</span><span class="ident" id="4665959">noRows</span><span class="op" id="4665965">)</span>&nbsp;<span class="ident" id="4665967">RowsAffected</span><span class="op" id="4665979">(</span><span class="op" id="4665980">)</span>&nbsp;<span class="op" id="4665982">(</span><span class="ident" id="4665983">int64</span><span class="op" id="4665988">,</span>&nbsp;<span class="builtintype" id="4665990">error</span><span class="op" id="4665995">)</span>&nbsp;<span class="op" id="4665997">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666000">return</span>&nbsp;<span class="num" id="4666007">0</span><span class="op" id="4666008">,</span>&nbsp;<span class="ident" id="4666010">errors</span><span class="op" id="4666016">.</span><span class="ident" id="4666017">New</span><span class="op" id="4666020">(</span><span class="string" id="4666021">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="4666068">)</span><br>
<span class="lineno"></span><span class="op" id="4666070">}</span>
</div>
</body>
</html>
