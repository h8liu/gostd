<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5158464">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5158520">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5158574">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5158625">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158695">package</span>&nbsp;<span class="ident" id="5158703">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158709">import</span>&nbsp;<span class="op" id="5158716">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5158719">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5158729">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5158735">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5158745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5158748">//&nbsp;ErrNotFound&nbsp;is&nbsp;the&nbsp;error&nbsp;resulting&nbsp;if&nbsp;a&nbsp;path&nbsp;search&nbsp;failed&nbsp;to&nbsp;find&nbsp;an&nbsp;executable&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5158838">var</span>&nbsp;<span class="ident" id="5158842">ErrNotFound</span>&nbsp;<span class="op" id="5158854">=</span>&nbsp;<span class="ident" id="5158856">errors</span><span class="op" id="5158862">.</span><span class="ident" id="5158863">New</span><span class="op" id="5158866">(</span><span class="string" id="5158867">&#34;executable&nbsp;file&nbsp;not&nbsp;found&nbsp;in&nbsp;$PATH&#34;</span><span class="op" id="5158903">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158906">func</span>&nbsp;<span class="ident" id="5158911">findExecutable</span><span class="op" id="5158925">(</span><span class="ident" id="5158926">file</span>&nbsp;<span class="builtintype" id="5158931">string</span><span class="op" id="5158937">)</span>&nbsp;<span class="builtintype" id="5158939">error</span>&nbsp;<span class="op" id="5158945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158948">d</span><span class="op" id="5158949">,</span>&nbsp;<span class="ident" id="5158951">err</span>&nbsp;<span class="op" id="5158955">:=</span>&nbsp;<span class="ident" id="5158958">os</span><span class="op" id="5158960">.</span><span class="ident" id="5158961">Stat</span><span class="op" id="5158965">(</span><span class="ident" id="5158966">file</span><span class="op" id="5158970">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158973">if</span>&nbsp;<span class="ident" id="5158976">err</span>&nbsp;<span class="op" id="5158980">!=</span>&nbsp;<span class="ident" id="5158983">nil</span>&nbsp;<span class="op" id="5158987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158991">return</span>&nbsp;<span class="ident" id="5158998">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159006">if</span>&nbsp;<span class="ident" id="5159009">m</span>&nbsp;<span class="op" id="5159011">:=</span>&nbsp;<span class="ident" id="5159014">d</span><span class="op" id="5159015">.</span><span class="ident" id="5159016">Mode</span><span class="op" id="5159020">(</span><span class="op" id="5159021">)</span><span class="op" id="5159022">;</span>&nbsp;<span class="op" id="5159024">!</span><span class="ident" id="5159025">m</span><span class="op" id="5159026">.</span><span class="ident" id="5159027">IsDir</span><span class="op" id="5159032">(</span><span class="op" id="5159033">)</span>&nbsp;<span class="op" id="5159035">&amp;&amp;</span>&nbsp;<span class="ident" id="5159038">m</span><span class="op" id="5159039">&amp;</span><span class="num" id="5159040">0111</span>&nbsp;<span class="op" id="5159045">!=</span>&nbsp;<span class="num" id="5159048">0</span>&nbsp;<span class="op" id="5159050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159054">return</span>&nbsp;<span class="ident" id="5159061">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159069">return</span>&nbsp;<span class="ident" id="5159076">os</span><span class="op" id="5159078">.</span><span class="ident" id="5159079">ErrPermission</span><br>
<span class="lineno"></span><span class="op" id="5159093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5159096">//&nbsp;LookPath&nbsp;searches&nbsp;for&nbsp;an&nbsp;executable&nbsp;binary&nbsp;named&nbsp;file</span><br>
<span class="lineno">30</span><span class="comment" id="5159153">//&nbsp;in&nbsp;the&nbsp;directories&nbsp;named&nbsp;by&nbsp;the&nbsp;PATH&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno"></span><span class="comment" id="5159215">//&nbsp;If&nbsp;file&nbsp;contains&nbsp;a&nbsp;slash,&nbsp;it&nbsp;is&nbsp;tried&nbsp;directly&nbsp;and&nbsp;the&nbsp;PATH&nbsp;is&nbsp;not&nbsp;consulted.</span><br>
<span class="lineno"></span><span class="comment" id="5159296">//&nbsp;The&nbsp;result&nbsp;may&nbsp;be&nbsp;an&nbsp;absolute&nbsp;path&nbsp;or&nbsp;a&nbsp;path&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="5159379">func</span>&nbsp;<span class="ident" id="5159384">LookPath</span><span class="op" id="5159392">(</span><span class="ident" id="5159393">file</span>&nbsp;<span class="builtintype" id="5159398">string</span><span class="op" id="5159404">)</span>&nbsp;<span class="op" id="5159406">(</span><span class="builtintype" id="5159407">string</span><span class="op" id="5159413">,</span>&nbsp;<span class="builtintype" id="5159415">error</span><span class="op" id="5159420">)</span>&nbsp;<span class="op" id="5159422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159425">//&nbsp;NOTE(rsc):&nbsp;I&nbsp;wish&nbsp;we&nbsp;could&nbsp;use&nbsp;the&nbsp;Plan&nbsp;9&nbsp;behavior&nbsp;here</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159485">//&nbsp;(only&nbsp;bypass&nbsp;the&nbsp;path&nbsp;if&nbsp;file&nbsp;begins&nbsp;with&nbsp;/&nbsp;or&nbsp;./&nbsp;or&nbsp;../)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159547">//&nbsp;but&nbsp;that&nbsp;would&nbsp;not&nbsp;match&nbsp;all&nbsp;the&nbsp;Unix&nbsp;shells.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159598">if</span>&nbsp;<span class="ident" id="5159601">strings</span><span class="op" id="5159608">.</span><span class="ident" id="5159609">Contains</span><span class="op" id="5159617">(</span><span class="ident" id="5159618">file</span><span class="op" id="5159622">,</span>&nbsp;<span class="string" id="5159624">&#34;/&#34;</span><span class="op" id="5159627">)</span>&nbsp;<span class="op" id="5159629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159633">err</span>&nbsp;<span class="op" id="5159637">:=</span>&nbsp;<span class="ident" id="5159640">findExecutable</span><span class="op" id="5159654">(</span><span class="ident" id="5159655">file</span><span class="op" id="5159659">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159663">if</span>&nbsp;<span class="ident" id="5159666">err</span>&nbsp;<span class="op" id="5159670">==</span>&nbsp;<span class="ident" id="5159673">nil</span>&nbsp;<span class="op" id="5159677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159682">return</span>&nbsp;<span class="ident" id="5159689">file</span><span class="op" id="5159693">,</span>&nbsp;<span class="ident" id="5159695">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159705">return</span>&nbsp;<span class="string" id="5159712">&#34;&#34;</span><span class="op" id="5159714">,</span>&nbsp;<span class="op" id="5159716">&amp;</span><span class="ident" id="5159717">Error</span><span class="op" id="5159722">{</span><span class="ident" id="5159723">file</span><span class="op" id="5159727">,</span>&nbsp;<span class="ident" id="5159729">err</span><span class="op" id="5159732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159735">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159738">pathenv</span>&nbsp;<span class="op" id="5159746">:=</span>&nbsp;<span class="ident" id="5159749">os</span><span class="op" id="5159751">.</span><span class="ident" id="5159752">Getenv</span><span class="op" id="5159758">(</span><span class="string" id="5159759">&#34;PATH&#34;</span><span class="op" id="5159765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159768">if</span>&nbsp;<span class="ident" id="5159771">pathenv</span>&nbsp;<span class="op" id="5159779">==</span>&nbsp;<span class="string" id="5159782">&#34;&#34;</span>&nbsp;<span class="op" id="5159785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159789">return</span>&nbsp;<span class="string" id="5159796">&#34;&#34;</span><span class="op" id="5159798">,</span>&nbsp;<span class="op" id="5159800">&amp;</span><span class="ident" id="5159801">Error</span><span class="op" id="5159806">{</span><span class="ident" id="5159807">file</span><span class="op" id="5159811">,</span>&nbsp;<span class="ident" id="5159813">ErrNotFound</span><span class="op" id="5159824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159830">for</span>&nbsp;<span class="ident" id="5159834">_</span><span class="op" id="5159835">,</span>&nbsp;<span class="ident" id="5159837">dir</span>&nbsp;<span class="op" id="5159841">:=</span>&nbsp;<span class="keyword" id="5159844">range</span>&nbsp;<span class="ident" id="5159850">strings</span><span class="op" id="5159857">.</span><span class="ident" id="5159858">Split</span><span class="op" id="5159863">(</span><span class="ident" id="5159864">pathenv</span><span class="op" id="5159871">,</span>&nbsp;<span class="string" id="5159873">&#34;:&#34;</span><span class="op" id="5159876">)</span>&nbsp;<span class="op" id="5159878">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159882">if</span>&nbsp;<span class="ident" id="5159885">dir</span>&nbsp;<span class="op" id="5159889">==</span>&nbsp;<span class="string" id="5159892">&#34;&#34;</span>&nbsp;<span class="op" id="5159895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159900">//&nbsp;Unix&nbsp;shell&nbsp;semantics:&nbsp;path&nbsp;element&nbsp;&#34;&#34;&nbsp;means&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159954">dir</span>&nbsp;<span class="op" id="5159958">=</span>&nbsp;<span class="string" id="5159960">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159970">path</span>&nbsp;<span class="op" id="5159975">:=</span>&nbsp;<span class="ident" id="5159978">dir</span>&nbsp;<span class="op" id="5159982">+</span>&nbsp;<span class="string" id="5159984">&#34;/&#34;</span>&nbsp;<span class="op" id="5159988">+</span>&nbsp;<span class="ident" id="5159990">file</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159997">if</span>&nbsp;<span class="ident" id="5160000">err</span>&nbsp;<span class="op" id="5160004">:=</span>&nbsp;<span class="ident" id="5160007">findExecutable</span><span class="op" id="5160021">(</span><span class="ident" id="5160022">path</span><span class="op" id="5160026">)</span><span class="op" id="5160027">;</span>&nbsp;<span class="ident" id="5160029">err</span>&nbsp;<span class="op" id="5160033">==</span>&nbsp;<span class="ident" id="5160036">nil</span>&nbsp;<span class="op" id="5160040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160045">return</span>&nbsp;<span class="ident" id="5160052">path</span><span class="op" id="5160056">,</span>&nbsp;<span class="ident" id="5160058">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160070">return</span>&nbsp;<span class="string" id="5160077">&#34;&#34;</span><span class="op" id="5160079">,</span>&nbsp;<span class="op" id="5160081">&amp;</span><span class="ident" id="5160082">Error</span><span class="op" id="5160087">{</span><span class="ident" id="5160088">file</span><span class="op" id="5160092">,</span>&nbsp;<span class="ident" id="5160094">ErrNotFound</span><span class="op" id="5160105">}</span><br>
<span class="lineno">60</span><span class="op" id="5160107">}</span>
</div>
</body>
</html>
